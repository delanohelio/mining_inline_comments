{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NTg2MDg5", "number": 244, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxMjo1OFrOEBYMCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNjowNTo0NVrOEBbHDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODgwMzMxOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxMjo1OFrOGdMA_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwODozNzoxOFrOGdnt4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI1ODc0OA==", "bodyText": "The user can add a line or a column at any position, not only at the end.\n@MalinaStefaniaStoicanescu Why do we only check the last cell ?", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433258748", "createdAt": "2020-06-01T14:12:58Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -255,19 +255,12 @@ public boolean performOk() {\n     for (int i = 0; i < linesNumber; i++) {\r\n       for (int j = 0; j < columnsNumber; j++) {\r\n         if (i == linesNumber - 1 && j == columnsNumber - 1) {\r\n-          if (tccMatrix.get(i).get(j).name.equals(EMPTY_STRING)\r\n-              || tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            createMessageBox(EDIT_ALL_CELLS, ERROR);\r\n-            return false;\r\n+          if (tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n+        \t  tccMatrix.get(i).get(j).content = \" \";\r\n           }\r\n           currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n               + tccMatrix.get(i).get(j).content;\r\n-        } else {\r\n-          if (tccMatrix.get(i).get(j).name.equals(EMPTY_STRING)\r\n-              || tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            createMessageBox(EDIT_ALL_CELLS, ERROR);\r\n-            return false;\r\n-          }\r\n+        } else {             \t \r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9313f210b3e566bada353773a9a974d545221288"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzcxMjYxMQ==", "bodyText": "If the last cell contains an empty content, when string is build, it will appear something like this: String s = \"...SEPARATORSEPARATOR\". When perform split on this string, it will create an array that will not contain the empty content of the last cell (and instead of 12 elements for example, it will contain only 11). Mostly for this is that check.", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433712611", "createdAt": "2020-06-02T08:37:18Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -255,19 +255,12 @@ public boolean performOk() {\n     for (int i = 0; i < linesNumber; i++) {\r\n       for (int j = 0; j < columnsNumber; j++) {\r\n         if (i == linesNumber - 1 && j == columnsNumber - 1) {\r\n-          if (tccMatrix.get(i).get(j).name.equals(EMPTY_STRING)\r\n-              || tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            createMessageBox(EDIT_ALL_CELLS, ERROR);\r\n-            return false;\r\n+          if (tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n+        \t  tccMatrix.get(i).get(j).content = \" \";\r\n           }\r\n           currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n               + tccMatrix.get(i).get(j).content;\r\n-        } else {\r\n-          if (tccMatrix.get(i).get(j).name.equals(EMPTY_STRING)\r\n-              || tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            createMessageBox(EDIT_ALL_CELLS, ERROR);\r\n-            return false;\r\n-          }\r\n+        } else {             \t \r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI1ODc0OA=="}, "originalCommit": {"oid": "9313f210b3e566bada353773a9a974d545221288"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODgxMzA4OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxNTo1NFrOGdMHKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxNTo1NFrOGdMHKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI2MDMyOA==", "bodyText": "Please use a StringBuilder for the currentTableContent.", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433260328", "createdAt": "2020-06-01T14:15:54Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -255,19 +255,12 @@ public boolean performOk() {\n     for (int i = 0; i < linesNumber; i++) {\r\n       for (int j = 0; j < columnsNumber; j++) {\r\n         if (i == linesNumber - 1 && j == columnsNumber - 1) {\r\n-          if (tccMatrix.get(i).get(j).name.equals(EMPTY_STRING)\r\n-              || tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            createMessageBox(EDIT_ALL_CELLS, ERROR);\r\n-            return false;\r\n+          if (tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n+        \t  tccMatrix.get(i).get(j).content = \" \";\r\n           }\r\n           currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9313f210b3e566bada353773a9a974d545221288"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODgyMzI4OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxODo1NlrOGdMNvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDoxODo1NlrOGdMNvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI2MjAxMg==", "bodyText": "Slight formatting issue ;)\nThere are others on this file so a global format should do the job.", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433262012", "createdAt": "2020-06-01T14:18:56Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -66,7 +69,7 @@ public TitleBlockCell(String name, String content) {\n \r\n     @Override\r\n     public String toString() {\r\n-      return name;\r\n+      return name+\"\\n\"+content; //$NON-NLS-1$\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1133bd0e7c852d17458bba7f1bdf6437e60afb99"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5OTA4MDg5OnYy", "diffSide": "LEFT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferenceField.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNToyODoyNFrOGdOxXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNToyODoyNFrOGdOxXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMwMzkwMQ==", "bodyText": "fixed by 4f40ea4#diff-24254bdb436064c4b318f9508990f052R269", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433303901", "createdAt": "2020-06-01T15:28:24Z", "author": {"login": "pdulth"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferenceField.java", "diffHunk": "@@ -208,24 +201,21 @@ protected void doLoadDefault() {\n \r\n   @Override\r\n   protected void doStore() {\r\n-    String currentTableContent = EMPTY_STRING;\r\n+    StringBuilder table = new StringBuilder();\r\n+    \r\n     for (int i = 0; i < linesNumber; i++) {\r\n       for (int j = 0; j < columnsNumber; j++) {\r\n-        if (i == linesNumber - 1 && j == columnsNumber - 1) {\r\n-          if (tccMatrix.get(i).get(j).content.equals(EMPTY_STRING)) {\r\n-            tccMatrix.get(i).get(j).content = \" \";\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f40ea4c31f5a8c3fa5c6781922be87f240bf43a"}, "originalPosition": 90}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5OTI4MjA1OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNjowNTo0NVrOGdQsNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNjowNTo0NVrOGdQsNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzNTM1MA==", "bodyText": "Just for reminder:\norg.polarsys.capella.core.commands.preferences.service.AbstractPreferencesInitializer are inconsistent and not working properly.\nputInt If the InstanceScope contains a value, at restart the default value will contains the previous instance value, not the one given in parameter. It will never set only the default value. always in instance scope.\nputBoolean and putString used in \n  \n    \n      capella/core/plugins/org.polarsys.capella.core.model.preferences/src/org/polarsys/capella/core/model/preferences/DeletePreferences.java\n    \n    \n         Line 35\n      in\n      6ef8e89\n    \n    \n    \n    \n\n        \n          \n           putBoolean(IDeletePreferences.PREFERENCE_CONFIRM_DELETE, true, DefaultScope.class); \n        \n    \n  \n\n do nothing if DefaultScope.\nIf ProjectScope, like used in initializer, as there is never a selected project at startup, its also weird.", "url": "https://github.com/eclipse/capella/pull/244#discussion_r433335350", "createdAt": "2020-06-01T16:05:45Z", "author": {"login": "pdulth"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "diffHunk": "@@ -14,73 +14,53 @@\n \r\n import org.eclipse.jface.preference.IPreferenceStore;\r\n import org.polarsys.capella.core.commands.preferences.service.AbstractPreferencesInitializer;\r\n+import org.polarsys.capella.core.commands.preferences.service.ScopedCapellaPreferencesStore;\r\n import org.polarsys.capella.core.platform.sirius.ui.actions.CapellaActionsActivator;\r\n-import org.polarsys.capella.core.preferences.Activator;\r\n \r\n public class TitleBlockPreferencesInitializer extends AbstractPreferencesInitializer {\r\n \r\n-  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n-  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n-  public static final String LINES_NUMBER_PREFERENCE_STORE = \"linesNumberTitleBlock\";\r\n-  public static final String DEFAULT_TITLEBLOCK_PREFERENCE_STORE = \"defaultTitleBlock\";\r\n-  public static final String SEPARATOR = \"SEPARATOR\";\r\n-  public static final String DEFAULT_TABLE = \"Name\" + SEPARATOR + \"feature:name\" + SEPARATOR + \"Synchronized\" \r\n-  + SEPARATOR + \"aql:self.representation.synchronized\" + SEPARATOR + \"Summary\" + SEPARATOR + \"aql:self.target.summary\" + SEPARATOR\r\n-  + \"Description\" + SEPARATOR + \"feature:documentation\";\r\n-\r\n-  \r\n   public TitleBlockPreferencesInitializer() {\r\n     super(CapellaActionsActivator.PLUGIN_ID);\r\n   }\r\n \r\n   @Override\r\n   public void initializeDefaultPreferences() {\r\n-    IPreferenceStore preferenceStore = doGetPreferenceStore();\r\n-    preferenceStore.setDefault(COLUMNS_NUMBER_PREFERENCE_STORE, 2);\r\n-    preferenceStore.setDefault(LINES_NUMBER_PREFERENCE_STORE, 2);\r\n-    preferenceStore.setDefault(TABEL_CONTENT_PREFERENCE_STORE, DEFAULT_TABLE);\r\n-\r\n-    preferenceStore.setDefault(DEFAULT_TITLEBLOCK_PREFERENCE_STORE, false);\r\n-  }\r\n-  \r\n-  \r\n-  /**\r\n-   * @return IPreferenceStore the default preference store instance\r\n-   */\r\n-  public static IPreferenceStore doGetPreferenceStore() {\r\n-    return Activator.getDefault().getPreferenceStore();\r\n+    IPreferenceStore preferenceStore = ScopedCapellaPreferencesStore.getInstance(CapellaActionsActivator.PLUGIN_ID);\r\n+    preferenceStore.setDefault(TitleBlockPreferencePage.COLUMNS_NUMBER_PREFERENCE_STORE, 2);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e45cc0c440da29415ef8838ec8daac5fface18be"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4270, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}