{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMjQxMzU2", "number": 70, "reviewThreads": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0MDozMFrODdwG7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowOTozMlrODkU46w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTIzNTAyOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0MDozMFrOFmiGgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0MDozMFrOFmiGgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk0ODkyOA==", "bodyText": "Typo?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r375948928", "createdAt": "2020-02-06T16:40:30Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,265 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.platform.sirius.ui.preferences;\r\n+\r\n+import org.eclipse.jface.preference.BooleanFieldEditor;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.preference.IntegerFieldEditor;\r\n+import org.eclipse.jface.viewers.ColumnLayoutData;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.TableLayout;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Button;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Group;\r\n+import org.eclipse.swt.widgets.Label;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.Menu;\r\n+import org.eclipse.swt.widgets.MenuItem;\r\n+import org.eclipse.swt.widgets.Table;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.eclipse.swt.widgets.TableItem;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+\r\n+  private IntegerFieldEditor _columnsFieldEditor;\r\n+\r\n+  private Table table;\r\n+\r\n+  Button add_button;\r\n+  Button edit_button;\r\n+  Button remove_button;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createGroupForNumberOfColumns();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+    createButtons(top);\r\n+  }\r\n+\r\n+  private Button createButton(Composite top, Composite container, String text, boolean enabled) {\r\n+    Button button = new Button(container, SWT.PUSH);\r\n+    button.setFont(top.getFont());\r\n+    button.setText(text);\r\n+    button.setEnabled(enabled);\r\n+    this.setButtonLayoutData(button);\r\n+    return button;\r\n+  }\r\n+\r\n+  private void createButtons(Composite top) {\r\n+\r\n+    Composite container = new Composite(top, SWT.NONE);\r\n+    GridLayout container_layout = new GridLayout();\r\n+    container_layout.marginHeight = 0;\r\n+    container_layout.marginWidth = 0;\r\n+    container.setLayout(container_layout);\r\n+    container.setLayoutData(new GridData(GridData.FILL_VERTICAL));\r\n+    container.setFont(top.getFont());\r\n+\r\n+    add_button = createButton(top, container, \"Add\", true);\r\n+\r\n+    edit_button = createButton(top, container, \"Edit\", false);\r\n+\r\n+    remove_button = createButton(top, container, \"Remove\", false);\r\n+\r\n+    add_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          dialog.setCurrentName(\"\");\r\n+          dialog.setCurrentContent(\"\");\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            TableItem item = new TableItem(table, SWT.NULL);\r\n+            item.setText(0, dialog.getName());\r\n+            item.setText(1, dialog.getContent());\r\n+          }\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+    remove_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          table.remove(table.getSelectionIndices());\r\n+          edit_button.setEnabled(false);\r\n+          remove_button.setEnabled(false);\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    edit_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+\r\n+          int index = table.getSelectionIndex();\r\n+          String currentName = table.getItem(index).getText(0);\r\n+          String currentContent = table.getItem(index).getText(1);\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+\r\n+          dialog.setCurrentName(currentName);\r\n+          dialog.setCurrentContent(currentContent);\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            table.getItem(index).setText(0, dialog.getName());\r\n+            table.getItem(index).setText(1, dialog.getContent());\r\n+            edit_button.setEnabled(false);\r\n+            remove_button.setEnabled(false);\r\n+          }\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    Menu menu = new Menu(getShell(), SWT.POP_UP);\r\n+    table.setMenu(menu);\r\n+    MenuItem menu_item = new MenuItem(menu, SWT.PUSH);\r\n+    menu_item.setText(\"Delete Selection\");\r\n+    menu_item.addListener(SWT.Selection, new Listener() {\r\n+\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        table.remove(table.getSelectionIndices());\r\n+      }\r\n+    });\r\n+\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    TableLayout tableLayout = new TableLayout();\r\n+\r\n+    table = new Table(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+    table.setLayout(tableLayout);\r\n+    table.setHeaderVisible(true);\r\n+    table.setLinesVisible(true);\r\n+    table.setFont(top.getFont());\r\n+\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.heightHint = table.getItemHeight();\r\n+    gridData.horizontalSpan = 1;\r\n+    table.setLayoutData(gridData);\r\n+    ColumnLayoutData[] fTableColumnLayouts = { new ColumnWeightData(165), new ColumnWeightData(165), };\r\n+\r\n+    TableColumn column;\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[0]);\r\n+    column = new TableColumn(table, SWT.NONE, 0);\r\n+    column.setResizable(fTableColumnLayouts[0].resizable);\r\n+    column.setText(\"Name\");\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[1]);\r\n+    column = new TableColumn(table, SWT.NONE, 1);\r\n+    column.setResizable(fTableColumnLayouts[1].resizable);\r\n+    column.setText(\"Content\");\r\n+\r\n+    String[] currentTableItems = doGetPreferenceStore().getString(\"tableTitleBlock\").split(\"#\");\r\n+    if (currentTableItems.length >= 2) {\r\n+      for (int i = 1; i < currentTableItems.length; i += 2) {\r\n+        TableItem item = new TableItem(table, SWT.NULL);\r\n+        item.setText(0, currentTableItems[i]);\r\n+        item.setText(1, currentTableItems[i + 1]);\r\n+      }\r\n+    }\r\n+\r\n+    table.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        int index = table.getSelectionIndex();\r\n+        if (index != -1) {\r\n+          edit_button.setEnabled(true);\r\n+          remove_button.setEnabled(true);\r\n+        }\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void createGroupForNumberOfColumns() {\r\n+    final Group group = createGroup(\"Number of columns in TitleBlock\", \"Tooltip grup\", getFieldEditorParent());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efc3f9190c9e625c6591eeadc92b787ab8f75"}, "originalPosition": 233}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTIzODQxOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0MToxM1rOFmiIeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0MToxM1rOFmiIeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk0OTQzMw==", "bodyText": "Could you avoid using _ in variable names to avoid Sonar issue?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r375949433", "createdAt": "2020-02-06T16:41:13Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,265 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.platform.sirius.ui.preferences;\r\n+\r\n+import org.eclipse.jface.preference.BooleanFieldEditor;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.preference.IntegerFieldEditor;\r\n+import org.eclipse.jface.viewers.ColumnLayoutData;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.TableLayout;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Button;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Group;\r\n+import org.eclipse.swt.widgets.Label;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.Menu;\r\n+import org.eclipse.swt.widgets.MenuItem;\r\n+import org.eclipse.swt.widgets.Table;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.eclipse.swt.widgets.TableItem;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+\r\n+  private IntegerFieldEditor _columnsFieldEditor;\r\n+\r\n+  private Table table;\r\n+\r\n+  Button add_button;\r\n+  Button edit_button;\r\n+  Button remove_button;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createGroupForNumberOfColumns();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+    createButtons(top);\r\n+  }\r\n+\r\n+  private Button createButton(Composite top, Composite container, String text, boolean enabled) {\r\n+    Button button = new Button(container, SWT.PUSH);\r\n+    button.setFont(top.getFont());\r\n+    button.setText(text);\r\n+    button.setEnabled(enabled);\r\n+    this.setButtonLayoutData(button);\r\n+    return button;\r\n+  }\r\n+\r\n+  private void createButtons(Composite top) {\r\n+\r\n+    Composite container = new Composite(top, SWT.NONE);\r\n+    GridLayout container_layout = new GridLayout();\r\n+    container_layout.marginHeight = 0;\r\n+    container_layout.marginWidth = 0;\r\n+    container.setLayout(container_layout);\r\n+    container.setLayoutData(new GridData(GridData.FILL_VERTICAL));\r\n+    container.setFont(top.getFont());\r\n+\r\n+    add_button = createButton(top, container, \"Add\", true);\r\n+\r\n+    edit_button = createButton(top, container, \"Edit\", false);\r\n+\r\n+    remove_button = createButton(top, container, \"Remove\", false);\r\n+\r\n+    add_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          dialog.setCurrentName(\"\");\r\n+          dialog.setCurrentContent(\"\");\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            TableItem item = new TableItem(table, SWT.NULL);\r\n+            item.setText(0, dialog.getName());\r\n+            item.setText(1, dialog.getContent());\r\n+          }\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+    remove_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          table.remove(table.getSelectionIndices());\r\n+          edit_button.setEnabled(false);\r\n+          remove_button.setEnabled(false);\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    edit_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+\r\n+          int index = table.getSelectionIndex();\r\n+          String currentName = table.getItem(index).getText(0);\r\n+          String currentContent = table.getItem(index).getText(1);\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+\r\n+          dialog.setCurrentName(currentName);\r\n+          dialog.setCurrentContent(currentContent);\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            table.getItem(index).setText(0, dialog.getName());\r\n+            table.getItem(index).setText(1, dialog.getContent());\r\n+            edit_button.setEnabled(false);\r\n+            remove_button.setEnabled(false);\r\n+          }\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    Menu menu = new Menu(getShell(), SWT.POP_UP);\r\n+    table.setMenu(menu);\r\n+    MenuItem menu_item = new MenuItem(menu, SWT.PUSH);\r\n+    menu_item.setText(\"Delete Selection\");\r\n+    menu_item.addListener(SWT.Selection, new Listener() {\r\n+\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        table.remove(table.getSelectionIndices());\r\n+      }\r\n+    });\r\n+\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    TableLayout tableLayout = new TableLayout();\r\n+\r\n+    table = new Table(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+    table.setLayout(tableLayout);\r\n+    table.setHeaderVisible(true);\r\n+    table.setLinesVisible(true);\r\n+    table.setFont(top.getFont());\r\n+\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.heightHint = table.getItemHeight();\r\n+    gridData.horizontalSpan = 1;\r\n+    table.setLayoutData(gridData);\r\n+    ColumnLayoutData[] fTableColumnLayouts = { new ColumnWeightData(165), new ColumnWeightData(165), };\r\n+\r\n+    TableColumn column;\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[0]);\r\n+    column = new TableColumn(table, SWT.NONE, 0);\r\n+    column.setResizable(fTableColumnLayouts[0].resizable);\r\n+    column.setText(\"Name\");\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[1]);\r\n+    column = new TableColumn(table, SWT.NONE, 1);\r\n+    column.setResizable(fTableColumnLayouts[1].resizable);\r\n+    column.setText(\"Content\");\r\n+\r\n+    String[] currentTableItems = doGetPreferenceStore().getString(\"tableTitleBlock\").split(\"#\");\r\n+    if (currentTableItems.length >= 2) {\r\n+      for (int i = 1; i < currentTableItems.length; i += 2) {\r\n+        TableItem item = new TableItem(table, SWT.NULL);\r\n+        item.setText(0, currentTableItems[i]);\r\n+        item.setText(1, currentTableItems[i + 1]);\r\n+      }\r\n+    }\r\n+\r\n+    table.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        int index = table.getSelectionIndex();\r\n+        if (index != -1) {\r\n+          edit_button.setEnabled(true);\r\n+          remove_button.setEnabled(true);\r\n+        }\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void createGroupForNumberOfColumns() {\r\n+    final Group group = createGroup(\"Number of columns in TitleBlock\", \"Tooltip grup\", getFieldEditorParent());\r\n+    BooleanFieldEditor enableMonitoringFieldEditor = new BooleanFieldEditor(\"Enable Editor\", \"Custom value\", group) {\r\n+      @SuppressWarnings(\"synthetic-access\")\r\n+      @Override\r\n+      protected void valueChanged(boolean oldValue_p, boolean newValue_p) {\r\n+        super.valueChanged(oldValue_p, newValue_p);\r\n+        _columnsFieldEditor.setEnabled(newValue_p, group);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efc3f9190c9e625c6591eeadc92b787ab8f75"}, "originalPosition": 239}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTI1OTgwOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockDialog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0Njo0NlrOFmiV3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0Njo0NlrOFmiV3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1Mjg2Mg==", "bodyText": "You can use org.eclipse.jface.dialogs.TitleAreaDialog.setErrorMessage(String) to show error message directly on the dialog.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r375952862", "createdAt": "2020-02-06T16:46:46Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockDialog.java", "diffHunk": "@@ -0,0 +1,128 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.platform.sirius.ui.preferences;\r\n+\r\n+import org.eclipse.jface.dialogs.MessageDialog;\r\n+import org.eclipse.jface.dialogs.TitleAreaDialog;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Control;\r\n+import org.eclipse.swt.widgets.Label;\r\n+import org.eclipse.swt.widgets.Shell;\r\n+import org.eclipse.swt.widgets.Text;\r\n+\r\n+public class TitleBlockDialog extends TitleAreaDialog {\r\n+  private final String TITLE_NAME = \"Add name and content\";\r\n+  private Text txtName;\r\n+  private Text txtContent;\r\n+\r\n+  private String name;\r\n+  private String content;\r\n+\r\n+  private String currentName;\r\n+  private String currentContent;\r\n+\r\n+  public TitleBlockDialog(Shell parentShell) {\r\n+\r\n+    super(parentShell);\r\n+  }\r\n+\r\n+  @Override\r\n+  public void create() {\r\n+    super.create();\r\n+    setTitle(TITLE_NAME);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected Control createDialogArea(Composite parent) {\r\n+    Composite area = (Composite) super.createDialogArea(parent);\r\n+    Composite container = new Composite(area, SWT.NONE);\r\n+    container.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));\r\n+    GridLayout layout = new GridLayout(2, false);\r\n+    container.setLayout(layout);\r\n+\r\n+    createName(container);\r\n+    createContent(container);\r\n+\r\n+    return area;\r\n+  }\r\n+\r\n+  private void createName(Composite container) {\r\n+    Label lbName = new Label(container, SWT.NONE);\r\n+    lbName.setText(\"Name\");\r\n+\r\n+    GridData dataName = new GridData();\r\n+    dataName.grabExcessHorizontalSpace = true;\r\n+    dataName.horizontalAlignment = GridData.FILL;\r\n+\r\n+    txtName = new Text(container, SWT.BORDER);\r\n+    txtName.setText(currentName);\r\n+    txtName.setLayoutData(dataName);\r\n+  }\r\n+\r\n+  private void createContent(Composite container) {\r\n+    Label lbContent = new Label(container, SWT.NONE);\r\n+    lbContent.setText(\"Content\");\r\n+\r\n+    GridData dataContent = new GridData();\r\n+    dataContent.grabExcessHorizontalSpace = true;\r\n+    dataContent.horizontalAlignment = GridData.FILL;\r\n+    txtContent = new Text(container, SWT.BORDER);\r\n+    txtContent.setText(currentContent);\r\n+\r\n+    txtContent.setLayoutData(dataContent);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected boolean isResizable() {\r\n+    return true;\r\n+  }\r\n+\r\n+  private boolean saveInput() {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efc3f9190c9e625c6591eeadc92b787ab8f75"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTI3MTU4OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0OTo0OFrOFmidLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo0OTo0OFrOFmidLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1NDczNA==", "bodyText": "Could you extract the string to a constant (same remark for below strings)?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r375954734", "createdAt": "2020-02-06T16:49:48Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,265 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.platform.sirius.ui.preferences;\r\n+\r\n+import org.eclipse.jface.preference.BooleanFieldEditor;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.preference.IntegerFieldEditor;\r\n+import org.eclipse.jface.viewers.ColumnLayoutData;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.TableLayout;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Button;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Group;\r\n+import org.eclipse.swt.widgets.Label;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.Menu;\r\n+import org.eclipse.swt.widgets.MenuItem;\r\n+import org.eclipse.swt.widgets.Table;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.eclipse.swt.widgets.TableItem;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+\r\n+  private IntegerFieldEditor _columnsFieldEditor;\r\n+\r\n+  private Table table;\r\n+\r\n+  Button add_button;\r\n+  Button edit_button;\r\n+  Button remove_button;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createGroupForNumberOfColumns();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+    createButtons(top);\r\n+  }\r\n+\r\n+  private Button createButton(Composite top, Composite container, String text, boolean enabled) {\r\n+    Button button = new Button(container, SWT.PUSH);\r\n+    button.setFont(top.getFont());\r\n+    button.setText(text);\r\n+    button.setEnabled(enabled);\r\n+    this.setButtonLayoutData(button);\r\n+    return button;\r\n+  }\r\n+\r\n+  private void createButtons(Composite top) {\r\n+\r\n+    Composite container = new Composite(top, SWT.NONE);\r\n+    GridLayout container_layout = new GridLayout();\r\n+    container_layout.marginHeight = 0;\r\n+    container_layout.marginWidth = 0;\r\n+    container.setLayout(container_layout);\r\n+    container.setLayoutData(new GridData(GridData.FILL_VERTICAL));\r\n+    container.setFont(top.getFont());\r\n+\r\n+    add_button = createButton(top, container, \"Add\", true);\r\n+\r\n+    edit_button = createButton(top, container, \"Edit\", false);\r\n+\r\n+    remove_button = createButton(top, container, \"Remove\", false);\r\n+\r\n+    add_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          dialog.setCurrentName(\"\");\r\n+          dialog.setCurrentContent(\"\");\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            TableItem item = new TableItem(table, SWT.NULL);\r\n+            item.setText(0, dialog.getName());\r\n+            item.setText(1, dialog.getContent());\r\n+          }\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+    remove_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          table.remove(table.getSelectionIndices());\r\n+          edit_button.setEnabled(false);\r\n+          remove_button.setEnabled(false);\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    edit_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+\r\n+          int index = table.getSelectionIndex();\r\n+          String currentName = table.getItem(index).getText(0);\r\n+          String currentContent = table.getItem(index).getText(1);\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+\r\n+          dialog.setCurrentName(currentName);\r\n+          dialog.setCurrentContent(currentContent);\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            table.getItem(index).setText(0, dialog.getName());\r\n+            table.getItem(index).setText(1, dialog.getContent());\r\n+            edit_button.setEnabled(false);\r\n+            remove_button.setEnabled(false);\r\n+          }\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    Menu menu = new Menu(getShell(), SWT.POP_UP);\r\n+    table.setMenu(menu);\r\n+    MenuItem menu_item = new MenuItem(menu, SWT.PUSH);\r\n+    menu_item.setText(\"Delete Selection\");\r\n+    menu_item.addListener(SWT.Selection, new Listener() {\r\n+\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        table.remove(table.getSelectionIndices());\r\n+      }\r\n+    });\r\n+\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    TableLayout tableLayout = new TableLayout();\r\n+\r\n+    table = new Table(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+    table.setLayout(tableLayout);\r\n+    table.setHeaderVisible(true);\r\n+    table.setLinesVisible(true);\r\n+    table.setFont(top.getFont());\r\n+\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.heightHint = table.getItemHeight();\r\n+    gridData.horizontalSpan = 1;\r\n+    table.setLayoutData(gridData);\r\n+    ColumnLayoutData[] fTableColumnLayouts = { new ColumnWeightData(165), new ColumnWeightData(165), };\r\n+\r\n+    TableColumn column;\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[0]);\r\n+    column = new TableColumn(table, SWT.NONE, 0);\r\n+    column.setResizable(fTableColumnLayouts[0].resizable);\r\n+    column.setText(\"Name\");\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[1]);\r\n+    column = new TableColumn(table, SWT.NONE, 1);\r\n+    column.setResizable(fTableColumnLayouts[1].resizable);\r\n+    column.setText(\"Content\");\r\n+\r\n+    String[] currentTableItems = doGetPreferenceStore().getString(\"tableTitleBlock\").split(\"#\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efc3f9190c9e625c6591eeadc92b787ab8f75"}, "originalPosition": 211}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTI5MTUwOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo1NToxNlrOFmippQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo1NToxNlrOFmippQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1NzkyNQ==", "bodyText": "This if is not necessary, isn't it?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r375957925", "createdAt": "2020-02-06T16:55:16Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,265 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.platform.sirius.ui.preferences;\r\n+\r\n+import org.eclipse.jface.preference.BooleanFieldEditor;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.preference.IntegerFieldEditor;\r\n+import org.eclipse.jface.viewers.ColumnLayoutData;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.TableLayout;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Button;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Group;\r\n+import org.eclipse.swt.widgets.Label;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.Menu;\r\n+import org.eclipse.swt.widgets.MenuItem;\r\n+import org.eclipse.swt.widgets.Table;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.eclipse.swt.widgets.TableItem;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+\r\n+  private IntegerFieldEditor _columnsFieldEditor;\r\n+\r\n+  private Table table;\r\n+\r\n+  Button add_button;\r\n+  Button edit_button;\r\n+  Button remove_button;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createGroupForNumberOfColumns();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+    createButtons(top);\r\n+  }\r\n+\r\n+  private Button createButton(Composite top, Composite container, String text, boolean enabled) {\r\n+    Button button = new Button(container, SWT.PUSH);\r\n+    button.setFont(top.getFont());\r\n+    button.setText(text);\r\n+    button.setEnabled(enabled);\r\n+    this.setButtonLayoutData(button);\r\n+    return button;\r\n+  }\r\n+\r\n+  private void createButtons(Composite top) {\r\n+\r\n+    Composite container = new Composite(top, SWT.NONE);\r\n+    GridLayout container_layout = new GridLayout();\r\n+    container_layout.marginHeight = 0;\r\n+    container_layout.marginWidth = 0;\r\n+    container.setLayout(container_layout);\r\n+    container.setLayoutData(new GridData(GridData.FILL_VERTICAL));\r\n+    container.setFont(top.getFont());\r\n+\r\n+    add_button = createButton(top, container, \"Add\", true);\r\n+\r\n+    edit_button = createButton(top, container, \"Edit\", false);\r\n+\r\n+    remove_button = createButton(top, container, \"Remove\", false);\r\n+\r\n+    add_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          dialog.setCurrentName(\"\");\r\n+          dialog.setCurrentContent(\"\");\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            TableItem item = new TableItem(table, SWT.NULL);\r\n+            item.setText(0, dialog.getName());\r\n+            item.setText(1, dialog.getContent());\r\n+          }\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+    remove_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+          table.remove(table.getSelectionIndices());\r\n+          edit_button.setEnabled(false);\r\n+          remove_button.setEnabled(false);\r\n+          break;\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    edit_button.addListener(SWT.Selection, new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event e) {\r\n+        switch (e.type) {\r\n+        case SWT.Selection:\r\n+\r\n+          int index = table.getSelectionIndex();\r\n+          String currentName = table.getItem(index).getText(0);\r\n+          String currentContent = table.getItem(index).getText(1);\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+\r\n+          dialog.setCurrentName(currentName);\r\n+          dialog.setCurrentContent(currentContent);\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            table.getItem(index).setText(0, dialog.getName());\r\n+            table.getItem(index).setText(1, dialog.getContent());\r\n+            edit_button.setEnabled(false);\r\n+            remove_button.setEnabled(false);\r\n+          }\r\n+        }\r\n+      }\r\n+    });\r\n+\r\n+    Menu menu = new Menu(getShell(), SWT.POP_UP);\r\n+    table.setMenu(menu);\r\n+    MenuItem menu_item = new MenuItem(menu, SWT.PUSH);\r\n+    menu_item.setText(\"Delete Selection\");\r\n+    menu_item.addListener(SWT.Selection, new Listener() {\r\n+\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        table.remove(table.getSelectionIndices());\r\n+      }\r\n+    });\r\n+\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    TableLayout tableLayout = new TableLayout();\r\n+\r\n+    table = new Table(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+    table.setLayout(tableLayout);\r\n+    table.setHeaderVisible(true);\r\n+    table.setLinesVisible(true);\r\n+    table.setFont(top.getFont());\r\n+\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.heightHint = table.getItemHeight();\r\n+    gridData.horizontalSpan = 1;\r\n+    table.setLayoutData(gridData);\r\n+    ColumnLayoutData[] fTableColumnLayouts = { new ColumnWeightData(165), new ColumnWeightData(165), };\r\n+\r\n+    TableColumn column;\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[0]);\r\n+    column = new TableColumn(table, SWT.NONE, 0);\r\n+    column.setResizable(fTableColumnLayouts[0].resizable);\r\n+    column.setText(\"Name\");\r\n+\r\n+    tableLayout.addColumnData(fTableColumnLayouts[1]);\r\n+    column = new TableColumn(table, SWT.NONE, 1);\r\n+    column.setResizable(fTableColumnLayouts[1].resizable);\r\n+    column.setText(\"Content\");\r\n+\r\n+    String[] currentTableItems = doGetPreferenceStore().getString(\"tableTitleBlock\").split(\"#\");\r\n+    if (currentTableItems.length >= 2) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efc3f9190c9e625c6591eeadc92b787ab8f75"}, "originalPosition": 212}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE2NzcxOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToxOTo1MlrOFv4h0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNTo0NzoxOVrOFv5jbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1MzU1Mg==", "bodyText": "Utilize constants instead of string keys (ex: \"tableTitleBlock\")", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385753552", "createdAt": "2020-02-28T15:19:52Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractPreferencesInitializer;\r\n+import org.polarsys.capella.core.platform.sirius.ui.actions.CapellaActionsActivator;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencesInitializer extends AbstractPreferencesInitializer {\r\n+\r\n+  public TitleBlockPreferencesInitializer() {\r\n+    super(CapellaActionsActivator.PLUGIN_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  public void initializeDefaultPreferences() {\r\n+    IPreferenceStore preferenceStore = Activator.getDefault().getPreferenceStore();\r\n+    preferenceStore.setDefault(\"columnFieldTitleBlock\", 2);\r\n+    preferenceStore.setDefault(\"rowFieldTitleBlock\", 2);\r\n+    preferenceStore.setDefault(\"tableTitleBlock\",\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc3MDM1MQ==", "bodyText": "Done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385770351", "createdAt": "2020-02-28T15:47:19Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractPreferencesInitializer;\r\n+import org.polarsys.capella.core.platform.sirius.ui.actions.CapellaActionsActivator;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencesInitializer extends AbstractPreferencesInitializer {\r\n+\r\n+  public TitleBlockPreferencesInitializer() {\r\n+    super(CapellaActionsActivator.PLUGIN_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  public void initializeDefaultPreferences() {\r\n+    IPreferenceStore preferenceStore = Activator.getDefault().getPreferenceStore();\r\n+    preferenceStore.setDefault(\"columnFieldTitleBlock\", 2);\r\n+    preferenceStore.setDefault(\"rowFieldTitleBlock\", 2);\r\n+    preferenceStore.setDefault(\"tableTitleBlock\",\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1MzU1Mg=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE3MTU5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMDo1M1rOFv4kDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNTozODoxN1rOFv5Nzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDEyNQ==", "bodyText": "Remove extra spaces", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385754125", "createdAt": "2020-02-28T15:20:53Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 180}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc2NDgxNQ==", "bodyText": "Done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385764815", "createdAt": "2020-02-28T15:38:17Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDEyNQ=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 180}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE3NTIzOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMTo0OVrOFv4mKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjo0MDoyOVrOFweFZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDY2NA==", "bodyText": "why rowsNumber is increased? maybe rename the method from refreshTableRows to addNewTableRow.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385754664", "createdAt": "2020-02-28T15:21:49Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 205}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2ODg3MQ==", "bodyText": "Done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386368871", "createdAt": "2020-03-02T12:40:29Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDY2NA=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 205}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE3NzA3OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMjoyMVrOFv4nSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMjoyMVrOFv4nSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NDk1Mw==", "bodyText": "give a meaningful name instead of \"s\"", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385754953", "createdAt": "2020-02-28T15:22:21Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 215}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE3ODIyOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMjozOFrOFv4n9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMjozOFrOFv4n9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NTEyNA==", "bodyText": "remove extra spaces (also in other places)", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385755124", "createdAt": "2020-02-28T15:22:38Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 224}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE4MTE4OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMzoyM1rOFv4ppA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNTozNzoyMVrOFv5LhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NTU1Ng==", "bodyText": "Use constants instead of inplace strings, but put an empty string in the constants instead o edit.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385755556", "createdAt": "2020-02-28T15:23:23Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 234}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc2NDIyOA==", "bodyText": "Done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385764228", "createdAt": "2020-02-28T15:37:21Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NTU1Ng=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 234}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE4MjU2OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyMzo0NlrOFv4qgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjo0MDo0NlrOFweF6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NTc3Ng==", "bodyText": "same, use constants (empty string)", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385755776", "createdAt": "2020-02-28T15:23:46Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 242}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2OTAwMg==", "bodyText": "done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386369002", "createdAt": "2020-03-02T12:40:46Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NTc3Ng=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 242}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE4NTA5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNDozNlrOFv4sPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwODo1MTo1NFrOFwXerA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NjIyMw==", "bodyText": "also create a constant SEPARATOR and put + in it.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385756223", "createdAt": "2020-02-28T15:24:36Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(\"\\\\+\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 264}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjI2MDY1Mg==", "bodyText": "Done", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386260652", "createdAt": "2020-03-02T08:51:54Z", "author": {"login": "MalinaStefaniaStoicanescu"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(\"\\\\+\");\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NjIyMw=="}, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 264}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE4NjM1OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNDo1N1rOFv4tEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNDo1N1rOFv4tEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NjQzNA==", "bodyText": "put bound 200 in a constant", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385756434", "createdAt": "2020-02-28T15:24:57Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(\"\\\\+\");\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, final int bound, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, 200);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 280}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE4OTIyOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNTozN1rOFv4uyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNTozN1rOFv4uyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1Njg3Mg==", "bodyText": "seems unnecessary, use a constant bounds instead.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385756872", "createdAt": "2020-02-28T15:25:37Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(\"\\\\+\");\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, final int bound, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, 200);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r\n+\r\n+      @Override\r\n+      public void afterEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void afterEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+        ViewerCell cell = (ViewerCell) event.getSource();\r\n+        viewer.getTable().showColumn(viewer.getTable().getColumn(cell.getColumnIndex()));\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+    });\r\n+  }\r\n+\r\n+  private void createColumns(TableViewer viewer, int nrColumns) {\r\n+    final int[] bounds = { 100, 100, 100, 100 };\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 375}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTE5MTA5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNjowNFrOFv4v3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNToyNjowNFrOFv4v3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTc1NzE1MQ==", "bodyText": "new ColumnWeightData - use bound constant maybe", "url": "https://github.com/eclipse/capella/pull/70#discussion_r385757151", "createdAt": "2020-02-28T15:26:04Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,496 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String ADD = \"Add\";\r\n+  public static final String EDIT = \"Edit\";\r\n+  public static final String REMOVE = \"Remove\";\r\n+  public static final String DELETE_SELECTION = \"Delete Selection\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String GROUP_LABEL = \"Number of columns in TitleBlock\";\r\n+  public static final String TOOLTIP_GROUP = \"Tooltip group\";\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(\"tableTitleBlock\");\r\n+    columnsNumber = doGetPreferenceStore().getInt(\"columnFieldTitleBlock\");\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowFieldTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+\r\n+          }\r\n+\r\n+        }\r\n+        }\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(\"columnFieldTitleBlock\", columnsNumber);\r\n+    doGetPreferenceStore().setValue(\"rowFieldTitleBlock\", rowsNumber);\r\n+    String s = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          s = s + tccMatrix.get(i).get(j).name + \"+\" + tccMatrix.get(i).get(j).content + \"+\";\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(\"tableTitleBlock\", s);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(\"\\\\+\");\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, final int bound, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, 200);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r\n+\r\n+      @Override\r\n+      public void afterEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void afterEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+        ViewerCell cell = (ViewerCell) event.getSource();\r\n+        viewer.getTable().showColumn(viewer.getTable().getColumn(cell.getColumnIndex()));\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+    });\r\n+  }\r\n+\r\n+  private void createColumns(TableViewer viewer, int nrColumns) {\r\n+    final int[] bounds = { 100, 100, 100, 100 };\r\n+    List<String> columnHeadings = new ArrayList<>();\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      columnHeadings.add(\"\");\r\n+      createColumn(viewer, columnHeadings.get(i), bounds[0], i);\r\n+    }\r\n+    testSelectCell(viewer);\r\n+    setColumnLayout(viewer, nrColumns);\r\n+  }\r\n+\r\n+  protected void setColumnLayout(TableViewer viewer, int nrColumns) {\r\n+    TableColumnLayout layout = new TableColumnLayout();\r\n+    viewer.getControl().getParent().setLayout(layout);\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      layout.setColumnData(viewer.getTable().getColumn(i), new ColumnWeightData(100));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fd2bf2d64f823c447488515b991db4f6c34c1b"}, "originalPosition": 389}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzY1MzMzOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDowMDowOFrOFwgeIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDowMDowOFrOFwgeIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQwNzk3MA==", "bodyText": "Also use constants here.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386407970", "createdAt": "2020-03-02T14:00:08Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencesInitializer.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractPreferencesInitializer;\r\n+import org.polarsys.capella.core.platform.sirius.ui.actions.CapellaActionsActivator;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencesInitializer extends AbstractPreferencesInitializer {\r\n+\r\n+  public TitleBlockPreferencesInitializer() {\r\n+    super(CapellaActionsActivator.PLUGIN_ID);\r\n+  }\r\n+\r\n+  @Override\r\n+  public void initializeDefaultPreferences() {\r\n+    IPreferenceStore preferenceStore = Activator.getDefault().getPreferenceStore();\r\n+    preferenceStore.setDefault(\"columnsNumberTitleBlock\", 2);\r\n+    preferenceStore.setDefault(\"rowsNumberTitleBlock\", 2);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzY1NTM0OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDowMDo0MFrOFwgfUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDowMDo0MFrOFwgfUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQwODI3NQ==", "bodyText": "Remove commented code in the file.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386408275", "createdAt": "2020-03-02T14:00:40Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 143}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5Mzk3MjM5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/plugin.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMjo0MVrOFwjgFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMjo0MVrOFwjgFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ1NzYyMw==", "bodyText": "Could you revert this change since there's no real change here?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386457623", "createdAt": "2020-03-02T15:22:41Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/plugin.xml", "diffHunk": "@@ -87,6 +87,7 @@\n             name=\"%ModelValidationPreferencePage_Name\">\n       </page>\n    </extension>\n+   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5Mzk3MzMzOnYy", "diffSide": "LEFT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/actions/CapellaActionsActivator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMjo1M1rOFwjgpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMjo1M1rOFwjgpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ1Nzc2NA==", "bodyText": "Could you revert this change since there's no real change here?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386457764", "createdAt": "2020-03-02T15:22:53Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/actions/CapellaActionsActivator.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2006, 2017 THALES GLOBAL SERVICES.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5Mzk3NDI1OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/messages.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMzowOFrOFwjhQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyMzowOFrOFwjhQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ1NzkyMg==", "bodyText": "Could you revert this change since there's no real change here?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386457922", "createdAt": "2020-03-02T15:23:08Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.platform.sirius.ui.actions/src/org/polarsys/capella/core/platform/sirius/ui/preferences/messages.properties", "diffHunk": "@@ -24,4 +24,3 @@ WizardPreferencePage_Description=Preferences related to Capella Editors\n WizardPreferencePage_Title=Editors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDAxNDQzOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozMjoyNVrOFwj5pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozMjoyNVrOFwj5pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ2NDE2Nw==", "bodyText": "Could you try to use private attributes and get/set methods instead of public attributes?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386464167", "createdAt": "2020-03-02T15:32:25Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDAxNzkzOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozMzoxM1rOFwj7uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozMzoxM1rOFwj7uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ2NDY5Nw==", "bodyText": "Could you use the constant instead?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386464697", "createdAt": "2020-03-02T15:33:13Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDAyMjQ4OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozNDoxOFrOFwj-aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTozNDoxOFrOFwj-aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ2NTM4NA==", "bodyText": "Use equals method instead.  There are many places like this in this class though.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386465384", "createdAt": "2020-03-02T15:34:18Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 169}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDA5NzgyOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTo1MTozMFrOFwkr0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTo1MTozMFrOFwkr0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ3NzAwOA==", "bodyText": "The method name is quite difficult to follow. It does not reflect what it really does. How about changing to something like: addNewEmptyColumn ? And since you have already class-level variables columnsNumber & rowsNumber, do we necessary need input variables here?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386477008", "createdAt": "2020-03-02T15:51:30Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 244}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDEyNDM5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNTo1NzoxNVrOFwk8Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMDozOToxMlrOFxoJ9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTIwNw==", "bodyText": "Have you tested the cell navigation? I don't see that it works. Using tab switches the selection to other buttons instead of other cells.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386481207", "createdAt": "2020-03-02T15:57:15Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 311}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU4MjQ1Mw==", "bodyText": "We can fix this next sprint, is ok?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r387582453", "createdAt": "2020-03-04T10:39:12Z", "author": {"login": "georgiana-ecobici"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTIwNw=="}, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 311}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDE2MDQ0OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowNTo0N1rOFwlSWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowNTo0N1rOFwlSWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4Njg3Mw==", "bodyText": "If there's no inline editor, you could just return false here.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386486873", "createdAt": "2020-03-02T16:05:47Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 353}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDE2ODYzOnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowNzo1MFrOFwlXfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowNzo1MFrOFwlXfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4ODE5MQ==", "bodyText": "If there's no inline editor, no need to listen to these events.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386488191", "createdAt": "2020-03-02T16:07:50Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 364}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDE3MzE5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowODo1MlrOFwlaPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowODo1MlrOFwlaPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4ODg5Mw==", "bodyText": "why try/catch here?", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386488893", "createdAt": "2020-03-02T16:08:52Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r\n+\r\n+      @Override\r\n+      public void afterEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void afterEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+        ViewerCell cell = (ViewerCell) event.getSource();\r\n+        viewer.getTable().showColumn(viewer.getTable().getColumn(cell.getColumnIndex()));\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+    });\r\n+  }\r\n+\r\n+  private void createColumns(TableViewer viewer, int nrColumns) {\r\n+    List<String> columnHeadings = new ArrayList<>();\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      columnHeadings.add(\"\");\r\n+      createColumn(viewer, columnHeadings.get(i), i);\r\n+    }\r\n+    testSelectCell(viewer);\r\n+    setColumnLayout(viewer, nrColumns);\r\n+  }\r\n+\r\n+  protected void setColumnLayout(TableViewer viewer, int nrColumns) {\r\n+    TableColumnLayout layout = new TableColumnLayout();\r\n+    viewer.getControl().getParent().setLayout(layout);\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      layout.setColumnData(viewer.getTable().getColumn(i), new ColumnWeightData(100));\r\n+    }\r\n+  }\r\n+\r\n+  private TableViewerColumn createTableViewerColumn(final TableViewer viewer, final String title, final int bound) {\r\n+    final TableViewerColumn viewerColumn = new TableViewerColumn(viewer, SWT.NONE);\r\n+    final TableColumn column = viewerColumn.getColumn();\r\n+    column.setText(title);\r\n+\r\n+    int wd = viewer.getTable().getClientArea().width;\r\n+    if (wd > 0) {\r\n+      column.setWidth(wd / columnsNumber);\r\n+    } else {\r\n+      column.setWidth(bound);\r\n+    }\r\n+    column.setResizable(true);\r\n+    return viewerColumn;\r\n+  }\r\n+\r\n+  private void addMenu(final TableViewer v) {\r\n+    final MenuManager mgr = new MenuManager();\r\n+\r\n+    final Action addRow = new Action(\"Add row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        refreshTableAddRows();\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    final Action addColumnAfter = new Action(\"Add column after\") {\r\n+      @Override\r\n+      public void run() {\r\n+        createColumn(v, \"\", v.getTable().getColumnCount());\r\n+        columnsNumber += 1;\r\n+        refreshTableColumns();\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeColumn = new Action(\"Remove column\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire column?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r\n+            int columnToDelete = v.getColumnViewerEditor().getFocusCell().getColumnIndex();\r\n+            disposeColumns();\r\n+            columnsNumber -= 1;\r\n+            createColumns(v, columnsNumber);\r\n+            v.setInput(updateModelColumnsDelete(columnToDelete));\r\n+          } catch (Exception e) {\r\n+\r\n+          }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeRow = new Action(\"Remove row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire row?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 472}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDE3NDU1OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowOToxM1rOFwlbFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowOToxM1rOFwlbFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4OTExMA==", "bodyText": "No need to return here", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386489110", "createdAt": "2020-03-02T16:09:13Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r\n+\r\n+      @Override\r\n+      public void afterEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void afterEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+        ViewerCell cell = (ViewerCell) event.getSource();\r\n+        viewer.getTable().showColumn(viewer.getTable().getColumn(cell.getColumnIndex()));\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+    });\r\n+  }\r\n+\r\n+  private void createColumns(TableViewer viewer, int nrColumns) {\r\n+    List<String> columnHeadings = new ArrayList<>();\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      columnHeadings.add(\"\");\r\n+      createColumn(viewer, columnHeadings.get(i), i);\r\n+    }\r\n+    testSelectCell(viewer);\r\n+    setColumnLayout(viewer, nrColumns);\r\n+  }\r\n+\r\n+  protected void setColumnLayout(TableViewer viewer, int nrColumns) {\r\n+    TableColumnLayout layout = new TableColumnLayout();\r\n+    viewer.getControl().getParent().setLayout(layout);\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      layout.setColumnData(viewer.getTable().getColumn(i), new ColumnWeightData(100));\r\n+    }\r\n+  }\r\n+\r\n+  private TableViewerColumn createTableViewerColumn(final TableViewer viewer, final String title, final int bound) {\r\n+    final TableViewerColumn viewerColumn = new TableViewerColumn(viewer, SWT.NONE);\r\n+    final TableColumn column = viewerColumn.getColumn();\r\n+    column.setText(title);\r\n+\r\n+    int wd = viewer.getTable().getClientArea().width;\r\n+    if (wd > 0) {\r\n+      column.setWidth(wd / columnsNumber);\r\n+    } else {\r\n+      column.setWidth(bound);\r\n+    }\r\n+    column.setResizable(true);\r\n+    return viewerColumn;\r\n+  }\r\n+\r\n+  private void addMenu(final TableViewer v) {\r\n+    final MenuManager mgr = new MenuManager();\r\n+\r\n+    final Action addRow = new Action(\"Add row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        refreshTableAddRows();\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    final Action addColumnAfter = new Action(\"Add column after\") {\r\n+      @Override\r\n+      public void run() {\r\n+        createColumn(v, \"\", v.getTable().getColumnCount());\r\n+        columnsNumber += 1;\r\n+        refreshTableColumns();\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeColumn = new Action(\"Remove column\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire column?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r\n+            int columnToDelete = v.getColumnViewerEditor().getFocusCell().getColumnIndex();\r\n+            disposeColumns();\r\n+            columnsNumber -= 1;\r\n+            createColumns(v, columnsNumber);\r\n+            v.setInput(updateModelColumnsDelete(columnToDelete));\r\n+          } catch (Exception e) {\r\n+\r\n+          }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeRow = new Action(\"Remove row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire row?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r\n+            refreshTableRemoveRow();\r\n+\r\n+          } catch (Exception e) {\r\n+\r\n+          }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    mgr.setRemoveAllWhenShown(true);\r\n+    mgr.addMenuListener(manager -> {\r\n+      if (v.getTable().getColumnCount() >= 1 && rowsNumber >= 1) {\r\n+        manager.add(addColumnAfter);\r\n+        manager.add(removeColumn);\r\n+        manager.add(addRow);\r\n+        manager.add(removeRow);\r\n+      }\r\n+    });\r\n+\r\n+    v.getControl().setMenu(mgr.createContextMenu(v.getControl()));\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void performDefaults() {\r\n+    super.performDefaults();\r\n+    columnsNumber = doGetPreferenceStore().getDefaultInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getDefaultInt(ROWS_NUMBER_PREFERENCE_STORE);\r\n+    tableContent = doGetPreferenceStore().getDefaultString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    // refreshTableColumns();\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+    performOk();\r\n+\r\n+    return;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 507}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDE3NTc5OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowOTozMlrOFwlb3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjowOTozMlrOFwlb3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4OTMwOQ==", "bodyText": "Remove obsolete code if possible.", "url": "https://github.com/eclipse/capella/pull/70#discussion_r386489309", "createdAt": "2020-03-02T16:09:32Z", "author": {"login": "minhtutonthat"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/preferences/TitleBlockPreferencePage.java", "diffHunk": "@@ -0,0 +1,510 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2020 THALES GLOBAL SERVICES.\r\n+ * All rights reserved. This program and the accompanying materials\r\n+ * are made available under the terms of the Eclipse Public License v1.0\r\n+ * which accompanies this distribution, and is available at\r\n+ * http://www.eclipse.org/legal/epl-v10.html\r\n+ *  \r\n+ * Contributors:\r\n+ *    Thales - initial API and implementation\r\n+ *******************************************************************************/\r\n+package org.polarsys.capella.core.sirius.analysis.preferences;\r\n+\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.core.resources.ProjectScope;\r\n+import org.eclipse.jface.action.Action;\r\n+import org.eclipse.jface.action.MenuManager;\r\n+import org.eclipse.jface.layout.TableColumnLayout;\r\n+import org.eclipse.jface.preference.IPreferenceStore;\r\n+import org.eclipse.jface.viewers.ArrayContentProvider;\r\n+import org.eclipse.jface.viewers.CellNavigationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewer;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditor;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationListener;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorActivationStrategy;\r\n+import org.eclipse.jface.viewers.ColumnViewerEditorDeactivationEvent;\r\n+import org.eclipse.jface.viewers.ColumnWeightData;\r\n+import org.eclipse.jface.viewers.FocusCellOwnerDrawHighlighter;\r\n+import org.eclipse.jface.viewers.StyledCellLabelProvider;\r\n+import org.eclipse.jface.viewers.TableViewer;\r\n+import org.eclipse.jface.viewers.TableViewerColumn;\r\n+import org.eclipse.jface.viewers.TableViewerEditor;\r\n+import org.eclipse.jface.viewers.TableViewerFocusCellManager;\r\n+import org.eclipse.jface.viewers.ViewerCell;\r\n+import org.eclipse.jface.window.Window;\r\n+import org.eclipse.swt.SWT;\r\n+import org.eclipse.swt.graphics.Point;\r\n+import org.eclipse.swt.layout.GridData;\r\n+import org.eclipse.swt.layout.GridLayout;\r\n+import org.eclipse.swt.widgets.Composite;\r\n+import org.eclipse.swt.widgets.Event;\r\n+import org.eclipse.swt.widgets.Listener;\r\n+import org.eclipse.swt.widgets.MessageBox;\r\n+import org.eclipse.swt.widgets.TableColumn;\r\n+import org.polarsys.capella.core.commands.preferences.service.AbstractDefaultPreferencePage;\r\n+import org.polarsys.capella.core.commands.preferences.service.PreferenceField;\r\n+import org.polarsys.capella.core.commands.preferences.service.UserProfileModeEnum;\r\n+import org.polarsys.capella.core.preferences.Activator;\r\n+\r\n+public class TitleBlockPreferencePage extends AbstractDefaultPreferencePage {\r\n+\r\n+  private class TitleBlockCell {\r\n+    public String name;\r\n+    public String content;\r\n+\r\n+    public TitleBlockCell(String name, String content) {\r\n+      this.name = name;\r\n+      this.content = content;\r\n+    }\r\n+\r\n+    @Override\r\n+    public String toString() {\r\n+      return name;\r\n+    }\r\n+  }\r\n+\r\n+  public static final String PAGE_ID = \"org.polarsys.capella.core.platform.sirius.ui.actions.preferences.TitleBlockPage\";\r\n+  public static final String NAME = \"Name\";\r\n+  public static final String CONTENT = \"Content\";\r\n+  public static final String TABEL_CONTENT_PREFERENCE_STORE = \"tableTitleBlock\";\r\n+  public static final String COLUMNS_NUMBER_PREFERENCE_STORE = \"columnsNumberTitleBlock\";\r\n+  public static final String ROWS_NUMBER_PREFERENCE_STORE = \"rowsNumberTitleBlock\";\r\n+  public static final String ESCAPED_SEPARATOR = \"\\\\+\";\r\n+  public static final String SEPARATOR = \"+\";\r\n+  public static final String EMPTY_STRING = \"\";\r\n+  public static final int BOUND = 200;\r\n+\r\n+  public\r\n+\r\n+  TableViewer v;\r\n+\r\n+  private PreferenceField defaultTitleBlockFieldEditor;\r\n+\r\n+  List<List<TitleBlockCell>> tccMatrix;\r\n+  int columnsNumber;\r\n+  int rowsNumber;\r\n+  String tableContent;\r\n+\r\n+  public TitleBlockPreferencePage() {\r\n+    super(PAGE_ID);\r\n+    tableContent = doGetPreferenceStore().getString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    columnsNumber = doGetPreferenceStore().getInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getInt(\"rowsNumberTitleBlock\");\r\n+  }\r\n+\r\n+  @Override\r\n+  protected IPreferenceStore doGetPreferenceStore() {\r\n+    return Activator.getDefault().getPreferenceStore();\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageTitle() {\r\n+    return Messages.TitleBlockPreferencePage_Title;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected String getPageDescription() {\r\n+    return Messages.TitleBlockPreferencePage_Description;\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void createFieldEditors() {\r\n+    createCheckBox();\r\n+\r\n+    Composite top = new Composite(getFieldEditorParent(), SWT.NONE);\r\n+    GridLayout top_layout = new GridLayout();\r\n+    top_layout.numColumns = 2;\r\n+    top_layout.marginHeight = 2;\r\n+    top_layout.marginWidth = 2;\r\n+    top.setLayout(top_layout);\r\n+    top.setLayoutData(new GridData(GridData.FILL_BOTH));\r\n+\r\n+    createTable(top);\r\n+\r\n+  }\r\n+\r\n+  private void createCheckBox() {\r\n+    defaultTitleBlockFieldEditor = new PreferenceField(\"defaultTitleBlock\", \"Add by default Diagram TitleBlock\",\r\n+        getFieldEditorParent());\r\n+    addField(defaultTitleBlockFieldEditor, UserProfileModeEnum.Expert, getFieldEditorParent(), ProjectScope.class);\r\n+  }\r\n+\r\n+  private void createTable(Composite top) {\r\n+    v = new TableViewer(top, SWT.MULTI | SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);\r\n+\r\n+    createColumns(v, columnsNumber);\r\n+    v.setContentProvider(ArrayContentProvider.getInstance());\r\n+    v.setInput(createModel(columnsNumber, rowsNumber));\r\n+\r\n+    v.getTable().setLinesVisible(true);\r\n+    // v.getTable().setBackground(getShell().getDisplay().getSystemColor(SWT.COLOR_GREEN));\r\n+    v.getTable().setHeaderVisible(true);\r\n+    GridData gridData = new GridData(GridData.FILL_BOTH);\r\n+    gridData.grabExcessVerticalSpace = true;\r\n+    gridData.grabExcessHorizontalSpace = true;\r\n+    gridData.verticalAlignment = GridData.FILL;\r\n+    gridData.horizontalAlignment = GridData.FILL;\r\n+    gridData.widthHint = 200;\r\n+    gridData.horizontalSpan = 1;\r\n+    v.getTable().setLayoutData(gridData);\r\n+\r\n+    addMenu(v);\r\n+\r\n+    Listener treeListener = new Listener() {\r\n+      @Override\r\n+      public void handleEvent(Event event) {\r\n+        switch (event.type) {\r\n+        case SWT.MouseDoubleClick: {\r\n+          Point coords = new Point(event.x, event.y);\r\n+\r\n+          ViewerCell cell = v.getCell(coords);\r\n+          int index = cell.getColumnIndex();\r\n+          List<TitleBlockCell> list = (List<TitleBlockCell>) cell.getElement();\r\n+          String name = list.get(index).name;\r\n+          String content = list.get(index).content;\r\n+          TitleBlockDialog dialog = new TitleBlockDialog(getShell());\r\n+          if (content == \"content\") {\r\n+            dialog.setCurrentName(\"\");\r\n+            dialog.setCurrentContent(\"\");\r\n+          } else {\r\n+            dialog.setCurrentName(name);\r\n+            dialog.setCurrentContent(content);\r\n+          }\r\n+          dialog.create();\r\n+          if (dialog.open() == Window.OK) {\r\n+            list.get(index).name = dialog.getName();\r\n+            list.get(index).content = dialog.getContent();\r\n+            cell.setText(dialog.getName());\r\n+          }\r\n+        }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    v.getTable().addListener(SWT.MouseDoubleClick, treeListener);\r\n+  }\r\n+\r\n+  private void disposeColumns() {\r\n+    TableColumn[] columns = v.getTable().getColumns();\r\n+    for (TableColumn tc : columns) {\r\n+      tc.dispose();\r\n+    }\r\n+  }\r\n+\r\n+  private void refreshTableColumns() {\r\n+    disposeColumns();\r\n+    createColumns(v, columnsNumber);\r\n+    v.setInput(updateModel(columnsNumber, rowsNumber));\r\n+\r\n+  }\r\n+\r\n+  private void refreshTableAddRows() {\r\n+    rowsNumber += 1;\r\n+    v.setInput(updateModelRows(columnsNumber, rowsNumber));\r\n+  }\r\n+\r\n+  private void refreshTableRemoveRow() {\r\n+    int rowToDelete = v.getTable().getSelectionIndex();\r\n+    v.setInput(updateModelRowsDelete(rowToDelete));\r\n+  }\r\n+\r\n+  @Override\r\n+  public boolean performOk() {\r\n+\r\n+    doGetPreferenceStore().setValue(\"defaultTitleBlock\", defaultTitleBlockFieldEditor.getBooleanValue());\r\n+    doGetPreferenceStore().setValue(COLUMNS_NUMBER_PREFERENCE_STORE, columnsNumber);\r\n+    doGetPreferenceStore().setValue(ROWS_NUMBER_PREFERENCE_STORE, rowsNumber);\r\n+    String currentTableContent = \"\";\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      for (int j = 0; j < columnsNumber; j++) {\r\n+        if (i == rowsNumber - 1 && j == columnsNumber - 1) {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content;\r\n+        } else {\r\n+          if (tccMatrix.get(i).get(j).name == \"\" || tccMatrix.get(i).get(j).content == \"\") {\r\n+            return false;\r\n+          }\r\n+          currentTableContent = currentTableContent + tccMatrix.get(i).get(j).name + SEPARATOR\r\n+              + tccMatrix.get(i).get(j).content + SEPARATOR;\r\n+\r\n+        }\r\n+\r\n+      }\r\n+    }\r\n+    doGetPreferenceStore().setValue(TABEL_CONTENT_PREFERENCE_STORE, currentTableContent);\r\n+    return super.performOk();\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModel(int nrCol, int nrRows) {\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = tccMatrix.get(i);\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRows(int nrCol, int nrRows) {\r\n+    List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+    for (int i = 0; i < nrCol; i++) {\r\n+      // tbcCell.add(new TitleBlockCell(\"Edit\", \"aql:edit\"));\r\n+      tbcCell.add(new TitleBlockCell(EMPTY_STRING, EMPTY_STRING));\r\n+    }\r\n+    tccMatrix.add(tbcCell);\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelRowsDelete(int rowToDelete) {\r\n+\r\n+    tccMatrix.remove(rowToDelete);\r\n+    rowsNumber -= 1;\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> updateModelColumnsDelete(int columnToDelete) {\r\n+\r\n+    for (int i = 0; i < rowsNumber; i++) {\r\n+      tccMatrix.get(i).remove(columnToDelete);\r\n+    }\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private List<List<TitleBlockCell>> createModel(int nrCol, int nrRows) {\r\n+    String[] cellsNameAndContent = tableContent.split(ESCAPED_SEPARATOR);\r\n+    int currentIndex = 0;\r\n+    tccMatrix = new ArrayList<>();\r\n+    for (int i = 0; i < nrRows; i++) {\r\n+      List<TitleBlockCell> tbcCell = new ArrayList<>();\r\n+      for (int j = 0; j < nrCol; j++) {\r\n+        tbcCell.add(new TitleBlockCell(cellsNameAndContent[currentIndex], cellsNameAndContent[currentIndex + 1]));\r\n+        currentIndex += 2;\r\n+      }\r\n+      tccMatrix.add(tbcCell);\r\n+    }\r\n+\r\n+    return tccMatrix;\r\n+  }\r\n+\r\n+  private void createColumn(TableViewer v, final String title, int index) {\r\n+    TableViewerColumn column = createTableViewerColumn(v, title, BOUND);\r\n+\r\n+    column.setLabelProvider(new StyledCellLabelProvider() {\r\n+      @Override\r\n+      public void update(final ViewerCell cell) {\r\n+        List<TitleBlockCell> lst = (List<TitleBlockCell>) cell.getElement();\r\n+\r\n+        final TitleBlockCell tbcell = lst.get(index);\r\n+        final String cellText = String.valueOf(tbcell);\r\n+        cell.setText(cellText);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+  private void testSelectCell(TableViewer viewer) {\r\n+    CellNavigationStrategy strategy = new CellNavigationStrategy() {\r\n+\r\n+      @Override\r\n+      public ViewerCell findSelectedCell(ColumnViewer cviewer, ViewerCell currentSelectedCell, Event event) {\r\n+        ViewerCell cell = null;\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          if (event.stateMask == 0) {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.RIGHT, true);\r\n+          } else {\r\n+            cell = currentSelectedCell.getNeighbor(ViewerCell.LEFT, true);\r\n+          }\r\n+          break;\r\n+        }\r\n+\r\n+        if (cell != null) {\r\n+          TableColumn t = viewer.getTable().getColumn(cell.getColumnIndex());\r\n+          viewer.getTable().showColumn(t);\r\n+        }\r\n+        return cell;\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public boolean isNavigationEvent(ColumnViewer viewer, Event event) {\r\n+        switch (event.keyCode) {\r\n+        case SWT.TAB:\r\n+          return true;\r\n+        default:\r\n+          return super.isNavigationEvent(viewer, event);\r\n+        }\r\n+      }\r\n+\r\n+    };\r\n+\r\n+    TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(viewer,\r\n+        new FocusCellOwnerDrawHighlighter(viewer), strategy);\r\n+\r\n+    ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(viewer) {\r\n+\r\n+      @Override\r\n+      protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {\r\n+        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION\r\n+            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.TAB)\r\n+            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;\r\n+      }\r\n+    };\r\n+\r\n+    TableViewerEditor.create(viewer, focusCellManager, actSupport,\r\n+        ColumnViewerEditor.TABBING_HORIZONTAL | ColumnViewerEditor.TABBING_MOVE_TO_ROW_NEIGHBOR\r\n+            | ColumnViewerEditor.TABBING_VERTICAL | ColumnViewerEditor.KEYBOARD_ACTIVATION);\r\n+\r\n+    viewer.getColumnViewerEditor().addEditorActivationListener(new ColumnViewerEditorActivationListener() {\r\n+\r\n+      @Override\r\n+      public void afterEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void afterEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorActivated(ColumnViewerEditorActivationEvent event) {\r\n+        ViewerCell cell = (ViewerCell) event.getSource();\r\n+        viewer.getTable().showColumn(viewer.getTable().getColumn(cell.getColumnIndex()));\r\n+      }\r\n+\r\n+      @Override\r\n+      public void beforeEditorDeactivated(ColumnViewerEditorDeactivationEvent event) {\r\n+\r\n+      }\r\n+\r\n+    });\r\n+  }\r\n+\r\n+  private void createColumns(TableViewer viewer, int nrColumns) {\r\n+    List<String> columnHeadings = new ArrayList<>();\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      columnHeadings.add(\"\");\r\n+      createColumn(viewer, columnHeadings.get(i), i);\r\n+    }\r\n+    testSelectCell(viewer);\r\n+    setColumnLayout(viewer, nrColumns);\r\n+  }\r\n+\r\n+  protected void setColumnLayout(TableViewer viewer, int nrColumns) {\r\n+    TableColumnLayout layout = new TableColumnLayout();\r\n+    viewer.getControl().getParent().setLayout(layout);\r\n+    for (int i = 0; i < nrColumns; i++) {\r\n+      layout.setColumnData(viewer.getTable().getColumn(i), new ColumnWeightData(100));\r\n+    }\r\n+  }\r\n+\r\n+  private TableViewerColumn createTableViewerColumn(final TableViewer viewer, final String title, final int bound) {\r\n+    final TableViewerColumn viewerColumn = new TableViewerColumn(viewer, SWT.NONE);\r\n+    final TableColumn column = viewerColumn.getColumn();\r\n+    column.setText(title);\r\n+\r\n+    int wd = viewer.getTable().getClientArea().width;\r\n+    if (wd > 0) {\r\n+      column.setWidth(wd / columnsNumber);\r\n+    } else {\r\n+      column.setWidth(bound);\r\n+    }\r\n+    column.setResizable(true);\r\n+    return viewerColumn;\r\n+  }\r\n+\r\n+  private void addMenu(final TableViewer v) {\r\n+    final MenuManager mgr = new MenuManager();\r\n+\r\n+    final Action addRow = new Action(\"Add row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        refreshTableAddRows();\r\n+\r\n+      }\r\n+    };\r\n+\r\n+    final Action addColumnAfter = new Action(\"Add column after\") {\r\n+      @Override\r\n+      public void run() {\r\n+        createColumn(v, \"\", v.getTable().getColumnCount());\r\n+        columnsNumber += 1;\r\n+        refreshTableColumns();\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeColumn = new Action(\"Remove column\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire column?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r\n+            int columnToDelete = v.getColumnViewerEditor().getFocusCell().getColumnIndex();\r\n+            disposeColumns();\r\n+            columnsNumber -= 1;\r\n+            createColumns(v, columnsNumber);\r\n+            v.setInput(updateModelColumnsDelete(columnToDelete));\r\n+          } catch (Exception e) {\r\n+\r\n+          }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    final Action removeRow = new Action(\"Remove row\") {\r\n+      @Override\r\n+      public void run() {\r\n+        MessageBox messageBox = new MessageBox(getShell(), SWT.ICON_QUESTION | SWT.YES | SWT.NO);\r\n+        messageBox.setMessage(\"Are you sure you want to delete the entire row?\");\r\n+        messageBox.setText(\"Confirm Delete\");\r\n+        int response = messageBox.open();\r\n+        if (response == SWT.YES) {\r\n+          try {\r\n+            refreshTableRemoveRow();\r\n+\r\n+          } catch (Exception e) {\r\n+\r\n+          }\r\n+        }\r\n+      }\r\n+    };\r\n+\r\n+    mgr.setRemoveAllWhenShown(true);\r\n+    mgr.addMenuListener(manager -> {\r\n+      if (v.getTable().getColumnCount() >= 1 && rowsNumber >= 1) {\r\n+        manager.add(addColumnAfter);\r\n+        manager.add(removeColumn);\r\n+        manager.add(addRow);\r\n+        manager.add(removeRow);\r\n+      }\r\n+    });\r\n+\r\n+    v.getControl().setMenu(mgr.createContextMenu(v.getControl()));\r\n+  }\r\n+\r\n+  @Override\r\n+  protected void performDefaults() {\r\n+    super.performDefaults();\r\n+    columnsNumber = doGetPreferenceStore().getDefaultInt(COLUMNS_NUMBER_PREFERENCE_STORE);\r\n+    rowsNumber = doGetPreferenceStore().getDefaultInt(ROWS_NUMBER_PREFERENCE_STORE);\r\n+    tableContent = doGetPreferenceStore().getDefaultString(TABEL_CONTENT_PREFERENCE_STORE);\r\n+    // refreshTableColumns();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34c8b9dc6ca9d7732080f1fbe05ecffecd5bc65"}, "originalPosition": 501}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4364, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}