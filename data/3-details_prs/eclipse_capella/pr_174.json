{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NjYwNTQ1", "number": 174, "title": "[559825] Rework on RefreshRepresentation Commandline", "bodyText": "Change-Id: Ia2adb056cfa1866a5290096723861184cf69ae49\nSigned-off-by: Yogaratnam YUGANSAN yugansan.yogaratnam@gmail.com", "createdAt": "2020-03-27T10:05:59Z", "url": "https://github.com/eclipse/capella/pull/174", "merged": true, "mergeCommit": {"oid": "268b78f6ace5155e17510ae4399347fb8a10ed3b"}, "closed": true, "closedAt": "2020-04-05T08:15:25Z", "author": {"login": "yugansan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRtp_JgH2gAyMzk0NjYwNTQ1OmE5NDcyZjMzZmJjNDJiNDJmYjllZWMyN2FlOWExZDVhMjRjOGJhMWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRyzn1AFqTM4Mjk4NTg3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c", "author": {"user": {"login": "yugansan", "name": "yugansan"}}, "url": "https://github.com/eclipse/capella/commit/a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c", "committedDate": "2020-03-27T09:54:23Z", "message": "Rework on RefreshRepresentation Commandline\n\nChange-Id: Ia2adb056cfa1866a5290096723861184cf69ae49\nSigned-off-by: Yogaratnam YUGANSAN <yugansan.yogaratnam@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTE5Nzky", "url": "https://github.com/eclipse/capella/pull/174#pullrequestreview-382919792", "createdAt": "2020-03-27T14:41:43Z", "commit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNDo0MTo0M1rOF80MuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNDo1OTo1MFrOF81BTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMxNDEwNQ==", "bodyText": "Wildcard new ArrayList<Job>()  -> new ArrayList<>()", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399314105", "createdAt": "2020-03-27T14:41:43Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyMTkxMQ==", "bodyText": "jobs", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399321911", "createdAt": "2020-03-27T14:52:12Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyMjk0MA==", "bodyText": "Can you do an optimized for loop?\nfor (IFile file: airdFiles) ...", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399322940", "createdAt": "2020-03-27T14:53:41Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyNDc3Nw==", "bodyText": "Job job = listJob.get(i)", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399324777", "createdAt": "2020-03-27T14:56:02Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r\n+    for (int i = 0; i < listJob.size(); i++) {\r\n+      int index = i;\r\n+      listJob.get(i).addJobChangeListener(new JobChangeAdapter() {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyNTA0Mg==", "bodyText": "Do we need this variable", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399325042", "createdAt": "2020-03-27T14:56:26Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r\n+    for (int i = 0; i < listJob.size(); i++) {\r\n+      int index = i;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyNjQ2NQ==", "bodyText": "airdFiles.get(index)) add a getter in RefreshDiagramJob that gives the file.\nThen obtain the job from the event, and the file from the job.", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399326465", "createdAt": "2020-03-27T14:58:22Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r\n+    for (int i = 0; i < listJob.size(); i++) {\r\n+      int index = i;\r\n+      listJob.get(i).addJobChangeListener(new JobChangeAdapter() {\r\n         @Override\r\n         public void done(IJobChangeEvent event) {\r\n-          URI selectedUri = EcoreUtil2.getURI(file);\r\n+          URI selectedUri = EcoreUtil2.getURI(airdFiles.get(index));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyNzAwOQ==", "bodyText": "Job nextJob = listJob.get(index + 1)", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399327009", "createdAt": "2020-03-27T14:59:06Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r\n+    for (int i = 0; i < listJob.size(); i++) {\r\n+      int index = i;\r\n+      listJob.get(i).addJobChangeListener(new JobChangeAdapter() {\r\n         @Override\r\n         public void done(IJobChangeEvent event) {\r\n-          URI selectedUri = EcoreUtil2.getURI(file);\r\n+          URI selectedUri = EcoreUtil2.getURI(airdFiles.get(index));\r\n           Session session = SessionManager.INSTANCE.getSession(selectedUri, new NullProgressMonitor());\r\n           session.save(new NullProgressMonitor());\r\n           try {\r\n             session.close(new NullProgressMonitor());\r\n           } catch (Exception e) {\r\n             e.printStackTrace();\r\n           }\r\n-          if (PlatformUI.getTestableObject() == null || PlatformUI.getTestableObject().getTestHarness() == null) {\r\n-            new CloseWorkbenchJob().schedule();\r\n+          if (index < listJob.size() - 1) {\r\n+            listJob.get(index + 1).schedule();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMyNzU2Ng==", "bodyText": "Job firstJob = listJob.get(0)", "url": "https://github.com/eclipse/capella/pull/174#discussion_r399327566", "createdAt": "2020-03-27T14:59:50Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.ui/src/org/polarsys/capella/core/sirius/ui/commandline/RefreshAirdCommandLine.java", "diffHunk": "@@ -33,29 +34,38 @@\n   public RefreshAirdCommandLine() {\r\n     super(true);\r\n   }\r\n-  \r\n+\r\n   protected IStatus executeWithinWorkbench() {\r\n     List<IFile> airdFiles = getAirdFilesFromInput();\r\n-    for (IFile file : airdFiles) {\r\n-      Job job = new RefreshDiagramJob(file);\r\n-      job.addJobChangeListener(new JobChangeAdapter() {\r\n-\r\n+    List<Job> listJob = new ArrayList<Job>();\r\n+    for (int i = 0; i < airdFiles.size(); i++) {\r\n+      listJob.add(new RefreshDiagramJob(airdFiles.get(i)));\r\n+    }\r\n+    for (int i = 0; i < listJob.size(); i++) {\r\n+      int index = i;\r\n+      listJob.get(i).addJobChangeListener(new JobChangeAdapter() {\r\n         @Override\r\n         public void done(IJobChangeEvent event) {\r\n-          URI selectedUri = EcoreUtil2.getURI(file);\r\n+          URI selectedUri = EcoreUtil2.getURI(airdFiles.get(index));\r\n           Session session = SessionManager.INSTANCE.getSession(selectedUri, new NullProgressMonitor());\r\n           session.save(new NullProgressMonitor());\r\n           try {\r\n             session.close(new NullProgressMonitor());\r\n           } catch (Exception e) {\r\n             e.printStackTrace();\r\n           }\r\n-          if (PlatformUI.getTestableObject() == null || PlatformUI.getTestableObject().getTestHarness() == null) {\r\n-            new CloseWorkbenchJob().schedule();\r\n+          if (index < listJob.size() - 1) {\r\n+            listJob.get(index + 1).schedule();\r\n+          } else {\r\n+            if (PlatformUI.getTestableObject() == null || PlatformUI.getTestableObject().getTestHarness() == null) {\r\n+              new CloseWorkbenchJob().schedule();\r\n+            }\r\n           }\r\n         }\r\n       });\r\n-      job.schedule();\r\n+    }\r\n+    if (!listJob.isEmpty()) {\r\n+      listJob.get(0).schedule();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9472f33fbc42b42fb9eec27ae9a1d5a24c8ba1c"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5079ed214035a1e8dbfce52409685797a1246c70", "author": {"user": {"login": "yugansan", "name": "yugansan"}}, "url": "https://github.com/eclipse/capella/commit/5079ed214035a1e8dbfce52409685797a1246c70", "committedDate": "2020-03-27T15:38:38Z", "message": "[559825] Rework on RefreshRepresentation Commandline\n\nChange-Id: I216f199798656cee56baccb48e87cf377581cf25"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTg1ODc2", "url": "https://github.com/eclipse/capella/pull/174#pullrequestreview-382985876", "createdAt": "2020-03-27T15:54:26Z", "commit": {"oid": "5079ed214035a1e8dbfce52409685797a1246c70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1447, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}