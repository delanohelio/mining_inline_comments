{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMDI1OTI2", "number": 296, "title": "[558032] Fix Show/Hide Title Block Tool", "bodyText": "Bug: 558032\nChange-Id: Ie3d9e523d9496ca57e64cfd8aaa001cd7a6f4002\nSigned-off-by: Sandu Postaru sandu.postaru@thalesgroup.com", "createdAt": "2020-06-30T13:23:18Z", "url": "https://github.com/eclipse/capella/pull/296", "merged": true, "mergeCommit": {"oid": "d7173b4dfa38d26f695ead79947fda3b73aa4c6e"}, "closed": true, "closedAt": "2020-06-30T15:56:38Z", "author": {"login": "sandupostaru"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwVkHVAH2gAyNDQyMDI1OTI2OjFiM2U5YmJkNWZjMTkwNWUzYzdkY2I3YTNhZTlmZTE1MGIwMTg0MmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwXxTdgFqTQ0MDE2MDU2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1b3e9bbd5fc1905e3c7dcb7a3ae9fe150b01842d", "author": {"user": {"login": "sandupostaru", "name": "Sandu Postaru"}}, "url": "https://github.com/eclipse/capella/commit/1b3e9bbd5fc1905e3c7dcb7a3ae9fe150b01842d", "committedDate": "2020-06-30T13:21:54Z", "message": "[558032] Fix Show/Hide Title Block Tool\n\nBug: 558032\nChange-Id: Ie3d9e523d9496ca57e64cfd8aaa001cd7a6f4002\nSigned-off-by: Sandu Postaru <sandu.postaru@thalesgroup.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMDExMjI2", "url": "https://github.com/eclipse/capella/pull/296#pullrequestreview-440011226", "createdAt": "2020-06-30T13:26:27Z", "commit": {"oid": "1b3e9bbd5fc1905e3c7dcb7a3ae9fe150b01842d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzoyNjoyN1rOGq8O1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzoyNjoyN1rOGq8O1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY4MDIxMw==", "bodyText": "We now extract all the DSemanticDecorators that have Title Blocks as target (Edges and Containers), so we properly hide everything.", "url": "https://github.com/eclipse/capella/pull/296#discussion_r447680213", "createdAt": "2020-06-30T13:26:27Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/src/org/polarsys/capella/core/sirius/analysis/TitleBlockServices.java", "diffHunk": "@@ -804,48 +807,89 @@ public String getTitleBockCellLabel(DAnnotation cell) {\n     return cell.getDetails().get(TitleBlockHelper.CONTENT);\r\n   }\r\n \r\n-  /**\r\n-   * show or hide a Title Block depending on given type (DIAGRAM_TITLE_BLOCK or ELEMENT_TITLE_BLOCK). selectedTypes are\r\n-   * the elements that shall be displayed\r\n-   * \r\n-   * @param elementView\r\n-   * @param selectedTitleBlocks\r\n-   * @param type\r\n-   * @return String the label of the content cell\r\n-   */\r\n-  public EObject showHideTitleBlocks(final EObject elementView, Collection<DAnnotation> selectedTitleBlocks) {\r\n-    DDiagram diagram = CapellaServices.getService().getDiagramContainer(elementView);\r\n-    Map<DAnnotation, DDiagramElement> existingTitleBlocks = new HashMap<>();\r\n-    if (elementView instanceof EdgeTarget) {\r\n-      // we want to show/hide the Title Block associated to elementView\r\n-      List<DAnnotation> elementTitleBlocks = getAssociatedElementTitleBlocks((EdgeTarget) elementView);\r\n-      elementTitleBlocks.stream().forEach(\r\n-          tb -> existingTitleBlocks.put(tb, DiagramServices.getDiagramServices().getDiagramElement(diagram, tb)));\r\n+  public EObject showHideTitleBlocks(EObject targetView, Collection<DAnnotation> titleBlockUserSelection) {\r\n+\r\n+    DDiagram diagram = CapellaServices.getService().getDiagramContainer(targetView);\r\n+    Map<DAnnotation, Collection<DSemanticDecorator>> existingTitleBlocksToViews = Collections.emptyMap();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b3e9bbd5fc1905e3c7dcb7a3ae9fe150b01842d"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d1f62e708754d2006296a24286016ba4ce1516d", "author": {"user": {"login": "pdulth", "name": "Philippe DUL"}}, "url": "https://github.com/eclipse/capella/commit/1d1f62e708754d2006296a24286016ba4ce1516d", "committedDate": "2020-06-30T15:09:45Z", "message": "[558032] Add refresh for create and insert/remove tools\n\nBug: 558032\nChange-Id: I12d75d3ab8fb3bc1fd9edc1f38a1c44c8e7fc4dc\nSigned-off-by: Philippe DUL <philippe.dul@thalesgroup.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTE3NTQx", "url": "https://github.com/eclipse/capella/pull/296#pullrequestreview-440117541", "createdAt": "2020-06-30T15:11:26Z", "commit": {"oid": "1d1f62e708754d2006296a24286016ba4ce1516d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNToxMToyN1rOGrBL3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNToxMToyN1rOGrBL3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc2MTM3Mw==", "bodyText": "like insert remove constraints above", "url": "https://github.com/eclipse/capella/pull/296#discussion_r447761373", "createdAt": "2020-06-30T15:11:27Z", "author": {"login": "pdulth"}, "path": "core/plugins/org.polarsys.capella.core.sirius.analysis/description/common.odesign", "diffHunk": "@@ -4715,6 +4717,7 @@\n                 </subModelOperations>\r\n                 <subModelOperations xsi:type=\"tool_1:If\" conditionExpression=\"aql:not (selectedTitleBlocks = 'WIZARD_CANCELED')\">\r\n                   <subModelOperations xsi:type=\"tool_1:ChangeContext\" browseExpression=\"aql:elementView.showHideTitleBlocks(selectedTitleBlocks)\"/>\r\n+                  <subModelOperations xsi:type=\"tool_1:ChangeContext\" browseExpression=\"aql:elementView.getDiagramContainer().forceRefresh()\"/>\r\n                 </subModelOperations>\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d1f62e708754d2006296a24286016ba4ce1516d"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTYwNTYy", "url": "https://github.com/eclipse/capella/pull/296#pullrequestreview-440160562", "createdAt": "2020-06-30T15:56:07Z", "commit": {"oid": "1d1f62e708754d2006296a24286016ba4ce1516d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1307, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}