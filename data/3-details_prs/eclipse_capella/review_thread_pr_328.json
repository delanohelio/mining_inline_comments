{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNjEzOTA2", "number": 328, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMTo0Mzo1MlrOEbh4Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMTo0Mzo1MlrOEbh4Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3MzAyMDI3OnYy", "diffSide": "RIGHT", "path": "core/plugins/org.polarsys.capella.core.model.helpers/src/org/polarsys/capella/core/model/helpers/BlockArchitectureExt.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMTo0Mzo1MlrOHFgtmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMTo0Mzo1MlrOHFgtmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU0MDg4OA==", "bodyText": "the getOrCreateSystem can still be dangerous on oa, as it will create always a new entity.\nmaybe we can replace oa.getSystem call by a getFirstEntity?\n\nDone.", "url": "https://github.com/eclipse/capella/pull/328#discussion_r475540888", "createdAt": "2020-08-24T11:43:52Z", "author": {"login": "sandupostaru"}, "path": "core/plugins/org.polarsys.capella.core.model.helpers/src/org/polarsys/capella/core/model/helpers/BlockArchitectureExt.java", "diffHunk": "@@ -684,15 +684,24 @@ public static boolean isDefaultNameRootFunction(AbstractNamedElement element) {\n    * @param architecture\n    * @param create\n    * @return\n+   * \n+   * @deprecated use {@link BlockArchitecture::getSystem} or {@link BlockArchitectureExt::getOrCreateComponent} instead.\n    */\n+  @Deprecated\n   public static Component getFirstComponent(BlockArchitecture architecture, boolean create) {\n     Component first = null;\n \n     if (architecture instanceof OperationalAnalysis) {\n-      first = ((OperationalAnalysis) architecture).getSystem();\n+      EntityPkg entityPkg = (EntityPkg) getComponentPkg(architecture, true);\n+      EList<Entity> ownedEntities = entityPkg.getOwnedEntities();\n+\n+      first = ownedEntities.stream().filter(x -> !x.isActor()).findFirst().orElse(null);\n+\n       if ((first == null) && create) {\n         first = OaFactory.eINSTANCE.createEntity(NamingConstants.CreateOaAnalysisCmd_entity_name);\n-        ((EntityPkg) getComponentPkg(architecture, true)).getOwnedEntities().add((Entity) first);\n+        ownedEntities.add((Entity) first);\n+\n+        CapellaElementExt.creationService(first);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "605561b88349aacdd379d1fdf30d45e5b6fa8302"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4232, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}