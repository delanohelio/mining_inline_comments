{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzODg1NTAw", "number": 1527, "title": "Complaints for Team Exercises", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I added multiple integration tests (Spring) related to the features\n Server: I added @PreAuthorize and check the course groups for all new REST Calls (security)\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n Client: I added authorities to all new routes and check the course groups for displaying navigation elements (links, buttons)\n Client: I documented the TypeScript code using JSDoc style.\n Client: I added multiple screenshots/screencasts of my UI changes\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\nComplaints and feedback requests have so far not been adapted for team-based exercises. This PR will allow teams to complain about the assessment of their submissions and to request more feedback. The complaint allowance in a course is separated for individual and team exercises. The instructor can set a max complaints limit per student that is valid for the individual exercises and a max complaints limit per team that is valid for the team exercises.\nExample: A student in EIST has up to X rejected complaints for his individual work and additionally shares up to Y rejected complaints with his team for their team submissions. Feedback requests are generally not limited (as is the status quo for individual exercises).\nThe handling of complaints and more feedback requests is different for team-based exercises: Both complaints and more feedback requests are handled by the team tutor himself who is also the original assessor of the submission.\nDescription\n\nAdd field maxTeamComplaints to course and update course form (default is 3, same as the default of maxComplaints)\nAdd field team to complaint (and generalize student/team on complaint into participant)\nCheck complaint allowance based on the exercise mode (limit for individual vs. team exercises)\nAdapt logic whether tutor is allowed to respond to complaints and feedback requests for the team exercise scenario (both client and server side)\n\nSteps for Testing\n\nLog in to Artemis as a Student\nParticipate in a Team Exercise\nLog in to Artemis as the Team Tutor\nAssess the submission\nLog in to Artemis as the Student\nComplain about the assessment (variant: request more feedback)\nLog in to Artemis as the Team Tutor\nRespond to the complaint (variant: respond to the more feedback request)\nLog in to Artemis as the Student\nCheck that the response to the complaint or more feedback request is shown\n\nScreenshots\nStudent view\n\n\n\nFlow: Complaint\n\n\n\n\nFlow: More Feedback", "createdAt": "2020-05-27T14:20:41Z", "url": "https://github.com/ls1intum/Artemis/pull/1527", "merged": true, "mergeCommit": {"oid": "6f185885cb265c9cd1bf82b9f5a02cd3e80268e9"}, "closed": true, "closedAt": "2020-06-02T10:10:03Z", "author": {"login": "madwau"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclZ0CqgH2gAyNDIzODg1NTAwOmUyZjY5M2E2NGJjNmQyYTU1NmQ1ODdkNTIxMGNjZjNiY2I4NzcxYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnSCQWgFqTQyMjUzMzE5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e2f693a64bc6d2a556d587d5210ccf3bcb8771af", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/e2f693a64bc6d2a556d587d5210ccf3bcb8771af", "committedDate": "2020-05-27T14:05:45Z", "message": "Initial version of complaints for teams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5eeca6a462e329122184bd4e93fef70ef28f7b28", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/5eeca6a462e329122184bd4e93fef70ef28f7b28", "committedDate": "2020-05-27T14:19:41Z", "message": "Adapt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad14b92d6660fa24eaa1cb1fe38a6f7d9105901f", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/ad14b92d6660fa24eaa1cb1fe38a6f7d9105901f", "committedDate": "2020-05-27T14:20:49Z", "message": "Merge branch 'develop' into feature/team-exercises/complaints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "927f3dbb505f321595e5ef42d72ef6a4b7ce71d1", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/927f3dbb505f321595e5ef42d72ef6a4b7ce71d1", "committedDate": "2020-05-27T14:33:16Z", "message": "Fix method in DatabaseUtilService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "126faf45302bfb0b849831cd1a50ba1624f52aec", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/126faf45302bfb0b849831cd1a50ba1624f52aec", "committedDate": "2020-05-27T14:35:46Z", "message": "Docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "615d8e12363e4e2dadd3fb0f125fe83092668940", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/615d8e12363e4e2dadd3fb0f125fe83092668940", "committedDate": "2020-05-27T15:14:49Z", "message": "Merge branch 'develop' into feature/team-exercises/complaints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67e0fe7d3e66de98efd33fb0cce26ee6a41404f8", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/67e0fe7d3e66de98efd33fb0cce26ee6a41404f8", "committedDate": "2020-05-27T15:34:35Z", "message": "Merge branch 'develop' into feature/team-exercises/complaints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ee73a17658b2c8cac474adc8f03f6e5556184e0", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/8ee73a17658b2c8cac474adc8f03f6e5556184e0", "committedDate": "2020-05-27T15:54:06Z", "message": "Fix error in repo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5626d82c94edbc1d1bf8c099485b5e67b0636b5e", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/5626d82c94edbc1d1bf8c099485b5e67b0636b5e", "committedDate": "2020-05-27T16:06:20Z", "message": "Default value for new request param"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bae5913af7a3d9a5d4c3b2e90d2035db97ea042", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/3bae5913af7a3d9a5d4c3b2e90d2035db97ea042", "committedDate": "2020-05-27T16:28:01Z", "message": "Json properties of complaint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83682498b78fd68cb02b62f1a96c2399b2aa15a5", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/83682498b78fd68cb02b62f1a96c2399b2aa15a5", "committedDate": "2020-05-27T19:22:41Z", "message": "Fix course reference"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ebc7da4d9405a2886fb6ad3574baa105c92e695", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/3ebc7da4d9405a2886fb6ad3574baa105c92e695", "committedDate": "2020-05-27T19:30:51Z", "message": "Presence issue of course"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52c73d71e3361b96e024905d05d457793251da01", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/52c73d71e3361b96e024905d05d457793251da01", "committedDate": "2020-05-27T19:52:27Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3df016de7c39ffd9a1456452ac1b56e07e3d3f23", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/3df016de7c39ffd9a1456452ac1b56e07e3d3f23", "committedDate": "2020-05-27T20:29:39Z", "message": "Fix client test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "038ce497088ebffb9bcdd972f9ce6be6fdc391c2", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/038ce497088ebffb9bcdd972f9ce6be6fdc391c2", "committedDate": "2020-05-30T11:08:47Z", "message": "Merge branch 'develop' into feature/team-exercises/complaints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "455141c9a44d92898386fc0313bbc381b5f397d3", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/455141c9a44d92898386fc0313bbc381b5f397d3", "committedDate": "2020-05-30T12:12:01Z", "message": "Improve migration and translations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1672749cf40f429be9f40d9342e71dbb90b53d4f", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/1672749cf40f429be9f40d9342e71dbb90b53d4f", "committedDate": "2020-05-30T13:19:33Z", "message": "Client and server logic whether a tutor can respond to a complaint or more feedback request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c96b6cd0fc7299ced55bc65479f4fc39b2a5f7e8", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/c96b6cd0fc7299ced55bc65479f4fc39b2a5f7e8", "committedDate": "2020-05-30T13:47:36Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b223374fa2eafa1902e882906f57a4fceafbef1", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/5b223374fa2eafa1902e882906f57a4fceafbef1", "committedDate": "2020-05-30T13:48:29Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4d36f73cc1cf32e20c5541138994e54ebb031e6", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/e4d36f73cc1cf32e20c5541138994e54ebb031e6", "committedDate": "2020-05-30T18:09:20Z", "message": "Add test for team complaint process"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDM2OTQ5", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421436949", "createdAt": "2020-05-30T19:18:37Z", "commit": {"oid": "e4d36f73cc1cf32e20c5541138994e54ebb031e6"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxOToxODozN1rOGc06Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxOTo0MjoxN1rOGc0_bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg4MDE2Mg==", "bodyText": "I'm not sure if we want to allow instructors to review every complaint, is that something you considered?", "url": "https://github.com/ls1intum/Artemis/pull/1527#discussion_r432880162", "createdAt": "2020-05-30T19:18:37Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ComplaintResponseService.java", "diffHunk": "@@ -96,4 +89,36 @@ else if (!assessor.equals(reviewer) && (originalComplaint.getComplaintType() !=\n         complaintResponse.setComplaint(originalComplaint);\n         return complaintResponseRepository.save(complaintResponse);\n     }\n+\n+    /**\n+     * Checks whether the reviewer is authorized to respond to this complaint\n+     *\n+     * 1. Team Exercises\n+     *    => The team tutor assesses the submissions and responds to complaints and more feedback requests\n+     *\n+     * 2. Individual Exercises\n+     *    => Complaints can only be handled by a tutor who is not the original assessor\n+     *    => More feedback requests are handled by the assessor himself\n+     *\n+     * @param participation Participation to which the complaint belongs to\n+     * @param complaint Complaint for which to check\n+     * @param assessor Assessor of the submission whose assessment was complained about\n+     * @param reviewer Reviewer who is trying to create a response to the complaint\n+     * @return true if the tutor is allowed to respond to the complaint, false otherwise\n+     */\n+    private boolean isUserAuthorizedToRespondToComplaint(StudentParticipation participation, Complaint complaint, User assessor, User reviewer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4d36f73cc1cf32e20c5541138994e54ebb031e6"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg4MTUwNg==", "bodyText": "The formatting here looks a bit weird, can you maybe check this again?", "url": "https://github.com/ls1intum/Artemis/pull/1527#discussion_r432881506", "createdAt": "2020-05-30T19:42:09Z", "author": {"login": "sleiss"}, "path": "src/main/webapp/app/course/manage/course-update.component.html", "diffHunk": "@@ -158,7 +158,9 @@ <h4 *ngIf=\"course.id\" id=\"jhi-course-heading-edit\" jhiTranslate=\"artemisApp.cour\n                     ></fa-icon>\n                 </div>\n                 <div class=\"form-group\" *ngIf=\"complaintsEnabled\">\n-                    <label class=\"form-control-label\" jhiTranslate=\"artemisApp.course.maxComplaints.title\" for=\"field_maxComplaints\">Maximum Number of Complaints</label>\n+                    <label class=\"form-control-label\" jhiTranslate=\"artemisApp.course.maxComplaints.title\" for=\"field_maxComplaints\"\n+                        >Maximum amount of complaints per student</label", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4d36f73cc1cf32e20c5541138994e54ebb031e6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg4MTUxNg==", "bodyText": "Same as above.", "url": "https://github.com/ls1intum/Artemis/pull/1527#discussion_r432881516", "createdAt": "2020-05-30T19:42:17Z", "author": {"login": "sleiss"}, "path": "src/main/webapp/app/course/manage/course-update.component.html", "diffHunk": "@@ -167,6 +169,18 @@ <h4 *ngIf=\"course.id\" id=\"jhi-course-heading-edit\" jhiTranslate=\"artemisApp.cour\n                     ></fa-icon>\n                     <input required type=\"number\" class=\"form-control\" name=\"maxComplaints\" id=\"field_maxComplaints\" formControlName=\"maxComplaints\" />\n                 </div>\n+                <div class=\"form-group\" *ngIf=\"complaintsEnabled\">\n+                    <label class=\"form-control-label\" jhiTranslate=\"artemisApp.course.maxTeamComplaints.title\" for=\"field_maxTeamComplaints\"\n+                        >Maximum amount of complaints per team</label", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4d36f73cc1cf32e20c5541138994e54ebb031e6"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f9584f91d6e0ec8eb51401a9aad1cbdefd8c24c", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/4f9584f91d6e0ec8eb51401a9aad1cbdefd8c24c", "committedDate": "2020-06-01T09:10:44Z", "message": "Merge branch 'develop' into feature/team-exercises/complaints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18cd86d290787606025b5c710cb109ae2c0a3561", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/18cd86d290787606025b5c710cb109ae2c0a3561", "committedDate": "2020-06-01T09:13:41Z", "message": "Fix formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzMxNTIz", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421731523", "createdAt": "2020-06-01T10:07:45Z", "commit": {"oid": "18cd86d290787606025b5c710cb109ae2c0a3561"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzM0MTU4", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421734158", "createdAt": "2020-06-01T10:12:22Z", "commit": {"oid": "18cd86d290787606025b5c710cb109ae2c0a3561"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDoxMjoyMlrOGdFcjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDoxMjoyMlrOGdFcjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE1MTExNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"descriptionTeam\": \"Ihr k\u00f6nnt ingesamt bis zu {{ maxComplaintNumber }} Beschwerden als Team in diesem Kurs einreichen.\",\n          \n          \n            \n                        \"descriptionTeam\": \"Ihr k\u00f6nnt insgesamt bis zu {{ maxComplaintNumber }} Beschwerden als Team in diesem Kurs einreichen.\",\n          \n      \n    \n    \n  \n\nsmall typo", "url": "https://github.com/ls1intum/Artemis/pull/1527#discussion_r433151117", "createdAt": "2020-06-01T10:12:22Z", "author": {"login": "filip-gregurevic"}, "path": "src/main/webapp/i18n/de/complaint.json", "diffHunk": "@@ -5,7 +5,10 @@\n             \"info\": \"Die Limitierung der Beschwerdenanzahl bezieht sich auf offene und abgelehnte Beschwerden. Wenn deine Beschwerde angenommen wird, wird sie nicht auf deine Gesamtzahl der Beschwerden angerechnet.\",\n             \"description\": \"Du kannst insgesamt bis zu {{ maxComplaintNumber }} Beschwerden in diesem Kurs einreichen.\",\n             \"descriptionExtended\": \"Jeder Student darf insgesamt bis zu {{ maxComplaintNumber }} Beschwerden in diesem Kurs einreichen. Du hast noch <strong style=color:red;>{{ allowedComplaints }}</strong> Beschwerden \u00fcbrig.\",\n+            \"descriptionTeam\": \"Ihr k\u00f6nnt ingesamt bis zu {{ maxComplaintNumber }} Beschwerden als Team in diesem Kurs einreichen.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18cd86d290787606025b5c710cb109ae2c0a3561"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b445ffdfea30e6b2abbeaf802560838b50649ba", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/4b445ffdfea30e6b2abbeaf802560838b50649ba", "committedDate": "2020-06-01T10:18:34Z", "message": "Fix typo\n\nCo-authored-by: Filip Gregurevic <51987021+filip-gregurevic@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzYyMzQy", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421762342", "createdAt": "2020-06-01T11:07:07Z", "commit": {"oid": "4b445ffdfea30e6b2abbeaf802560838b50649ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzgyOTM4", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421782938", "createdAt": "2020-06-01T11:48:13Z", "commit": {"oid": "4b445ffdfea30e6b2abbeaf802560838b50649ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxODk5Njkx", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-421899691", "createdAt": "2020-06-01T14:40:26Z", "commit": {"oid": "4b445ffdfea30e6b2abbeaf802560838b50649ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNTMzMTk1", "url": "https://github.com/ls1intum/Artemis/pull/1527#pullrequestreview-422533195", "createdAt": "2020-06-02T10:09:53Z", "commit": {"oid": "4b445ffdfea30e6b2abbeaf802560838b50649ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2704, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}