{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMzUyNTY4", "number": 1747, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjozMzoxMVrOEJ21Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMzoxMDoxOVrOELE9TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NzcxMDQyOnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjozMzoxMVrOGqkx_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNjozMTo0NFrOGqtoCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI5NTk5OA==", "bodyText": "There is another edge case. It could be that starting the exercise did not work properly and studentParticipations[0].initializationState is not yet set to INITIALIZED, but to any \"previous\" enum value.\nThen, we also need to call startExercise on the server. The server will automatically determine the right steps to make sure the participation initialization is finished properly.\nThis is also the case for the course dashboard. If a participation is not fully initialized, Artemis still shows the \"start exercise\" button. You can also check exercise-utils.ts, however it uses a rather complex calculation which should not be necessary here.", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r447295998", "createdAt": "2020-06-29T22:33:11Z", "author": {"login": "krusche"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -90,35 +97,17 @@ export class ExamParticipationComponent implements OnInit, OnDestroy {\n             // init studentExam and activeExercise\n             this.studentExam = studentExam;\n             this.activeExercise = studentExam.exercises[0];\n+            if (this.activeExercise.studentParticipations && this.activeExercise.studentParticipations.length === 0) {\n+                // subscribe to execute\n+                this.createParticipationForExercise(this.activeExercise).subscribe();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "187198922677accfbbee7e1f4b23f06a4456f05a"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ0MDkwNA==", "bodyText": "added a check for that", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r447440904", "createdAt": "2020-06-30T06:31:44Z", "author": {"login": "TobiasPr"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -90,35 +97,17 @@ export class ExamParticipationComponent implements OnInit, OnDestroy {\n             // init studentExam and activeExercise\n             this.studentExam = studentExam;\n             this.activeExercise = studentExam.exercises[0];\n+            if (this.activeExercise.studentParticipations && this.activeExercise.studentParticipations.length === 0) {\n+                // subscribe to execute\n+                this.createParticipationForExercise(this.activeExercise).subscribe();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI5NTk5OA=="}, "originalCommit": {"oid": "187198922677accfbbee7e1f4b23f06a4456f05a"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDM4MDg4OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exam/participate/summary/exam-participation-summary.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjowMDozNVrOGseK_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjowMDozNVrOGseK_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI4NDg2Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * checks collapse control of exercise cards depending on submissionId\n          \n          \n            \n                 * checks collapse control of exercise cards depending on exerciseId", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r449284863", "createdAt": "2020-07-02T22:00:35Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exam/participate/summary/exam-participation-summary.component.ts", "diffHunk": "@@ -34,44 +34,58 @@ export class ExamParticipationSummaryComponent {\n      */\n     printPDF() {\n         // expand all exercises before printing\n-        this.collapsedSubmissionIds = [];\n+        this.collapsedExerciseIds = [];\n         setTimeout(() => window.print());\n     }\n \n     /**\n      * @param exercise\n-     * returns the students submission for the specific exercise\n+     * returns the students submission for the exercise, null if no participation could be found\n      */\n-    getSubmissionForExercise(exercise: Exercise): Submission {\n-        return exercise.studentParticipations[0].submissions[0];\n+    getSubmissionForExercise(exercise: Exercise): Submission | null {\n+        if (\n+            exercise &&\n+            exercise.studentParticipations &&\n+            exercise.studentParticipations[0] &&\n+            exercise.studentParticipations[0].submissions &&\n+            exercise.studentParticipations[0].submissions[0]\n+        ) {\n+            return exercise.studentParticipations[0].submissions[0];\n+        } else {\n+            return null;\n+        }\n     }\n \n     /**\n      * @param exercise\n-     * returns the students submission for the specific exercise\n+     * returns the students submission for the exercise, null if no participation could be found\n      */\n-    getParticipationForProgrammingExercise(exercise: Exercise): Participation {\n-        return exercise.studentParticipations[0];\n+    getParticipationForExercise(exercise: Exercise): Participation | null {\n+        if (exercise.studentParticipations && exercise.studentParticipations[0]) {\n+            return exercise.studentParticipations[0];\n+        } else {\n+            return null;\n+        }\n     }\n \n     /**\n-     * @param submissionId\n+     * @param exerciseId\n      * checks collapse control of exercise cards depending on submissionId", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b7eafd1f2cf8465d4b5447c0f58627e99684fe"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDM4MTU1OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exam/participate/summary/exam-participation-summary.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjowMDo1NlrOGseLZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjowMDo1NlrOGseLZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI4NDk2Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * adds collapse control of exercise cards depending on submissionId\n          \n          \n            \n                 * adds collapse control of exercise cards depending on exerciseId", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r449284967", "createdAt": "2020-07-02T22:00:56Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exam/participate/summary/exam-participation-summary.component.ts", "diffHunk": "@@ -34,44 +34,58 @@ export class ExamParticipationSummaryComponent {\n      */\n     printPDF() {\n         // expand all exercises before printing\n-        this.collapsedSubmissionIds = [];\n+        this.collapsedExerciseIds = [];\n         setTimeout(() => window.print());\n     }\n \n     /**\n      * @param exercise\n-     * returns the students submission for the specific exercise\n+     * returns the students submission for the exercise, null if no participation could be found\n      */\n-    getSubmissionForExercise(exercise: Exercise): Submission {\n-        return exercise.studentParticipations[0].submissions[0];\n+    getSubmissionForExercise(exercise: Exercise): Submission | null {\n+        if (\n+            exercise &&\n+            exercise.studentParticipations &&\n+            exercise.studentParticipations[0] &&\n+            exercise.studentParticipations[0].submissions &&\n+            exercise.studentParticipations[0].submissions[0]\n+        ) {\n+            return exercise.studentParticipations[0].submissions[0];\n+        } else {\n+            return null;\n+        }\n     }\n \n     /**\n      * @param exercise\n-     * returns the students submission for the specific exercise\n+     * returns the students submission for the exercise, null if no participation could be found\n      */\n-    getParticipationForProgrammingExercise(exercise: Exercise): Participation {\n-        return exercise.studentParticipations[0];\n+    getParticipationForExercise(exercise: Exercise): Participation | null {\n+        if (exercise.studentParticipations && exercise.studentParticipations[0]) {\n+            return exercise.studentParticipations[0];\n+        } else {\n+            return null;\n+        }\n     }\n \n     /**\n-     * @param submissionId\n+     * @param exerciseId\n      * checks collapse control of exercise cards depending on submissionId\n      */\n-    isCollapsed(submissionId: number): boolean {\n-        return this.collapsedSubmissionIds.includes(submissionId);\n+    isCollapsed(exerciseId: number): boolean {\n+        return this.collapsedExerciseIds.includes(exerciseId);\n     }\n \n     /**\n-     * @param submissionId\n+     * @param exerciseId\n      * adds collapse control of exercise cards depending on submissionId", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b7eafd1f2cf8465d4b5447c0f58627e99684fe"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDUxMDIxOnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMzoxMDoxOVrOGsfV0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwODowMjo0NVrOGsniSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwNDAxOA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r449304018", "createdAt": "2020-07-02T23:10:19Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -27,6 +30,8 @@ import { throttleTime } from 'rxjs/operators';\n import * as moment from 'moment';\n import { Moment } from 'moment';\n \n+type GenerateParticipationStatus = 'generating' | 'failed' | 'success';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7ec4c5d81269a3ea390edb21cd1fd8df14ea703"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwNzIwOQ==", "bodyText": "not entirely sure if you mean that ironic :)", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r449307209", "createdAt": "2020-07-02T23:23:50Z", "author": {"login": "TobiasPr"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -27,6 +30,8 @@ import { throttleTime } from 'rxjs/operators';\n import * as moment from 'moment';\n import { Moment } from 'moment';\n \n+type GenerateParticipationStatus = 'generating' | 'failed' | 'success';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwNDAxOA=="}, "originalCommit": {"oid": "a7ec4c5d81269a3ea390edb21cd1fd8df14ea703"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQzODI4MQ==", "bodyText": "Nah, I like those \ud83d\ude42", "url": "https://github.com/ls1intum/Artemis/pull/1747#discussion_r449438281", "createdAt": "2020-07-03T08:02:45Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -27,6 +30,8 @@ import { throttleTime } from 'rxjs/operators';\n import * as moment from 'moment';\n import { Moment } from 'moment';\n \n+type GenerateParticipationStatus = 'generating' | 'failed' | 'success';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwNDAxOA=="}, "originalCommit": {"oid": "a7ec4c5d81269a3ea390edb21cd1fd8df14ea703"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4930, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}