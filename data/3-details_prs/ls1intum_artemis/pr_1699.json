{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NDk2NDkx", "number": 1699, "title": "[Exam] Improve Generate Participation", "bodyText": "Motivation and Context\n\n\n\n - #1684 was implemented using @Transactional. The goal of this pull request was to replace it with an implementation based on @EntityGraph\n  Show Success / Error Message\n\nSteps for Testing\n\nSame as #1684\nScreenshots", "createdAt": "2020-06-23T11:07:02Z", "url": "https://github.com/ls1intum/Artemis/pull/1699", "merged": true, "mergeCommit": {"oid": "44e6bd1f099230f86212b5ab86ac9f1c13ed80cc"}, "closed": true, "closedAt": "2020-06-26T12:45:38Z", "author": {"login": "stefanwaldhauser"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuDa61gH2gAyNDM4NDk2NDkxOjZhMGIzNTBhMjU1YjIyZjBjYTc1MmNkYTA2NWUyMTFkYWE3MWY2NzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvBNXzAH2gAyNDM4NDk2NDkxOjU3NTkwOTQzMzZiMTZlMzVjZGZjYjJkOWYzOTUzYTYyYTMxODQ0NjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6a0b350a255b22f0ca752cda065e211daa71f670", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6a0b350a255b22f0ca752cda065e211daa71f670", "committedDate": "2020-06-23T11:05:43Z", "message": "Removed Transactional by replacing with EntityGraph"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fa19ed6507eed363ccc10102edc14643c55ae05", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/7fa19ed6507eed363ccc10102edc14643c55ae05", "committedDate": "2020-06-23T11:06:23Z", "message": "Fixed IntegrationTests by manually resolving bidirectional relationship"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f35ae4e8483c05ad2552e2b00a32ad1d35b200c9", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f35ae4e8483c05ad2552e2b00a32ad1d35b200c9", "committedDate": "2020-06-23T19:43:25Z", "message": "Added correct success and error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c89d42e6f03cbefeb13304ce9c317d6a184b786", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/0c89d42e6f03cbefeb13304ce9c317d6a184b786", "committedDate": "2020-06-24T15:57:06Z", "message": "Implemented Loading Spinning functionality for buttons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9902d89e45283ed601f9ab161b019230f53be279", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/9902d89e45283ed601f9ab161b019230f53be279", "committedDate": "2020-06-24T16:12:11Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74166a21bd7d2aad2ee4a765fe07d9d605ed5680", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/74166a21bd7d2aad2ee4a765fe07d9d605ed5680", "committedDate": "2020-06-24T16:17:02Z", "message": "Kind of Blue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "678599990fbbe93288c473b388fdd44449713ead", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/678599990fbbe93288c473b388fdd44449713ead", "committedDate": "2020-06-24T16:24:49Z", "message": "Made StartExercises return only the number of generated participations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47d1ede79ad0cc2ee3de00ae66ac2e76ebc335ed", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/47d1ede79ad0cc2ee3de00ae66ac2e76ebc335ed", "committedDate": "2020-06-24T16:36:50Z", "message": "Deactivated Tests for the Moment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77b6d35f7c78156e559da86f457198bb692ab867", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/77b6d35f7c78156e559da86f457198bb692ab867", "committedDate": "2020-06-24T20:43:30Z", "message": "Removed faulty test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b2a3c9c118293d662a50daef5a6869c2edf9297", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5b2a3c9c118293d662a50daef5a6869c2edf9297", "committedDate": "2020-06-24T20:58:08Z", "message": "Removed unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e827889c35643414e817df236b0abf1cd9de1b56", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e827889c35643414e817df236b0abf1cd9de1b56", "committedDate": "2020-06-24T21:09:29Z", "message": "Rewrote tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e07c813444b8fb43f82ad1e0d304e0369bc1f5b1", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e07c813444b8fb43f82ad1e0d304e0369bc1f5b1", "committedDate": "2020-06-24T21:11:00Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d3991c3e7386413e5b37b6f7006fd1ca090f67e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3d3991c3e7386413e5b37b6f7006fd1ca090f67e", "committedDate": "2020-06-24T21:11:48Z", "message": "Fixed Merge Conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NTkxNTQ3", "url": "https://github.com/ls1intum/Artemis/pull/1699#pullrequestreview-437591547", "createdAt": "2020-06-25T15:09:00Z", "commit": {"oid": "3d3991c3e7386413e5b37b6f7006fd1ca090f67e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNTowOTowMFrOGo_MkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNTowOTowMFrOGo_MkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYzMTYzMg==", "bodyText": "This should be deleted :D", "url": "https://github.com/ls1intum/Artemis/pull/1699#discussion_r445631632", "createdAt": "2020-06-25T15:09:00Z", "author": {"login": "anditurdiu"}, "path": "src/test/java/de/tum/in/www1/artemis/ExamIntegrationTest.java", "diffHunk": "@@ -190,33 +189,46 @@ public void testStartExercisesWithTextExercise() throws Exception {\n         exam2.setVisibleDate(ZonedDateTime.now().plusHours(1));\n \n         // creating exercise\n-        TextExercise textExercise = ModelFactory.generateTextExerciseForExam(exam2.getStartDate(), exam2.getEndDate(), exam2.getEndDate().plusWeeks(2),\n-                exam2.getExerciseGroups().get(0));\n-        exam2.getExerciseGroups().get(0).addExercise(textExercise);\n-        exerciseGroupRepository.save(exam2.getExerciseGroups().get(0));\n+        ExerciseGroup exerciseGroup = exam2.getExerciseGroups().get(0);\n+\n+        TextExercise textExercise = ModelFactory.generateTextExerciseForExam(exam2.getStartDate(), exam2.getEndDate(), exam2.getEndDate().plusWeeks(2), exerciseGroup);\n+        exerciseGroup.addExercise(textExercise);\n+        exerciseGroupRepository.save(exerciseGroup);\n         textExercise = exerciseRepo.save(textExercise);\n \n+        List<StudentExam> createdStudentExams = new ArrayList<>();\n+\n         // creating student exams\n         for (User user : registeredUsers) {\n             StudentExam studentExam = new StudentExam();\n             studentExam.addExercise(textExercise);\n             studentExam.setUser(user);\n             exam2.addStudentExam(studentExam);\n-            studentExamRepository.save(studentExam);\n+            createdStudentExams.add(studentExamRepository.save(studentExam));\n         }\n \n         exam2 = examRepository.save(exam2);\n \n         // invoke start exercises\n-        List<Participation> participations = request.postListWithResponseBody(\"/api/courses/\" + course1.getId() + \"/exams/\" + exam2.getId() + \"/student-exams/start-exercises\",\n-                Optional.empty(), Participation.class, HttpStatus.OK);\n-        assertThat(participations).hasSize(exam2.getStudentExams().size());\n-        for (Participation participation : participations) {\n+        Integer noGeneratedParticipations = request.postWithResponseBody(\"/api/courses/\" + course1.getId() + \"/exams/\" + exam2.getId() + \"/student-exams/start-exercises\",\n+                Optional.empty(), Integer.class, HttpStatus.OK);\n+        assertThat(noGeneratedParticipations).isEqualTo(exam2.getStudentExams().size());\n+        List<Participation> studentParticipations = participationRepository.findAll();\n+\n+        for (Participation participation : studentParticipations) {\n             assertThat(participation.getExercise().equals(textExercise));\n             assertThat(participation.getExercise().getCourseViaExerciseGroupOrCourseMember() == null);\n             assertThat(participation.getExercise().getExerciseGroup() == exam2.getExerciseGroups().get(0));\n             // TODO: check that submissions have been created to the participations of text exercises\n         }\n+        System.out.println(\"Test\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d3991c3e7386413e5b37b6f7006fd1ca090f67e"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eece8575c379e3a135695b05c9033abaaab5a5e", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/0eece8575c379e3a135695b05c9033abaaab5a5e", "committedDate": "2020-06-25T15:25:15Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f73cd4cad580c93f4f688d52052519c7b75cab5f", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/f73cd4cad580c93f4f688d52052519c7b75cab5f", "committedDate": "2020-06-25T17:29:43Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NzM4NTQ5", "url": "https://github.com/ls1intum/Artemis/pull/1699#pullrequestreview-437738549", "createdAt": "2020-06-25T18:08:49Z", "commit": {"oid": "f73cd4cad580c93f4f688d52052519c7b75cab5f"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NzkyNDkx", "url": "https://github.com/ls1intum/Artemis/pull/1699#pullrequestreview-437792491", "createdAt": "2020-06-25T19:24:11Z", "commit": {"oid": "f73cd4cad580c93f4f688d52052519c7b75cab5f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63fbad5b6e46853b20823ab47ea99f8be575447b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/63fbad5b6e46853b20823ab47ea99f8be575447b", "committedDate": "2020-06-25T22:49:10Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16b3dcd0bd55567247a5c8e8e5d1725cccfa512b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/16b3dcd0bd55567247a5c8e8e5d1725cccfa512b", "committedDate": "2020-06-25T22:54:41Z", "message": "remove system out println"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3OTEzMTYz", "url": "https://github.com/ls1intum/Artemis/pull/1699#pullrequestreview-437913163", "createdAt": "2020-06-25T22:56:25Z", "commit": {"oid": "16b3dcd0bd55567247a5c8e8e5d1725cccfa512b"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30d2a27bec2d4dbb9168f38c8f80319500a5c817", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/30d2a27bec2d4dbb9168f38c8f80319500a5c817", "committedDate": "2020-06-25T23:20:14Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c882cd6cdb91248f66f7d541cee2d5ce47255383", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/c882cd6cdb91248f66f7d541cee2d5ce47255383", "committedDate": "2020-06-25T23:20:19Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8d3168bfecc8b90c1729ad725c2bdc857ecc467", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d8d3168bfecc8b90c1729ad725c2bdc857ecc467", "committedDate": "2020-06-25T23:28:54Z", "message": "fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MDk1NjY1", "url": "https://github.com/ls1intum/Artemis/pull/1699#pullrequestreview-438095665", "createdAt": "2020-06-26T08:08:29Z", "commit": {"oid": "d8d3168bfecc8b90c1729ad725c2bdc857ecc467"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e34987363c5749179460ac246ed4628634371ce9", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e34987363c5749179460ac246ed4628634371ce9", "committedDate": "2020-06-26T09:59:00Z", "message": "Merge branch 'develop' into exam/variants/remove-transactional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5759094336b16e35cdfcb2d9f3953a62a3184464", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5759094336b16e35cdfcb2d9f3953a62a3184464", "committedDate": "2020-06-26T11:05:02Z", "message": "Fixed error display"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2512, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}