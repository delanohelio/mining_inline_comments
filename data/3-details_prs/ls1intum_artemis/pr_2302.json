{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTY5NzE3", "number": 2302, "title": "Various Bugfixes in the Lecture Unit Feature", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I implemented the changes with a good performance and prevented too many database calls\n\nMotivation and Context\n\n\nThe Lecture Unit Feature introduced several small bugs and inconstancies that need to be fixed before the lecture period starts on Monday November 2nd 2020.\nDescription\n\nCommit 3ecd84d re-activates release date locking for regular lecture attachments.\nCommit 450d9cb ef450c2 fixed package structure not being equal to the folder structure\nCommit 83e4585 removes unnecessary @Cache annotation on subclasses of LectureUnit\nCommit b8fc707 makes exercise units behave exactly in the same way as in the course dashboard. NOTE: The implementation is rather naive and just uses the underlying for-dashboard call. This will be optimized in a follow up, but I think this quick is the most appropriate right now as the for-dashboard call is tested and covers all edge cases like quizzes and so on.\nCommit 80527dd is just refactoring to make it more clearer that these are exclusive options.\nSteps for Testing\n\n\nTest that the bugs described in the Description section are fixed\n\nTest Coverage\nNo changes as just bugfixes\nScreenshots\nNo changes as just bugfixes", "createdAt": "2020-10-30T17:32:07Z", "url": "https://github.com/ls1intum/Artemis/pull/2302", "merged": true, "mergeCommit": {"oid": "bc6f57fdbc614ae1bb31244a5113272026860c8c"}, "closed": true, "closedAt": "2020-11-02T23:38:13Z", "author": {"login": "stefanwaldhauser"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXqPqkgH2gAyNTEzMTY5NzE3OjNlY2Q4NGQ3ZGM3NWQ2ODcxNWE0NGRhODQzNmJiNTA1YjFmOWE0Y2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYtTF8AFqTUyMjEwNzU5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3ecd84d7dc75d68715a44da8436bb505b1f9a4cc", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/3ecd84d7dc75d68715a44da8436bb505b1f9a4cc", "committedDate": "2020-10-30T17:30:37Z", "message": "Fixed: Regular Attachments for Lecture were not release locked any more"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "450d9cb84e0cd7202bfbb545522eb8684be69595", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/450d9cb84e0cd7202bfbb545522eb8684be69595", "committedDate": "2020-10-30T18:07:05Z", "message": "Fixed: Package did not correspond to file path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef450c2898427ae905fa27993d8fd72040e5bd8e", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/ef450c2898427ae905fa27993d8fd72040e5bd8e", "committedDate": "2020-10-30T18:49:17Z", "message": "Fixed: Package did not correspond to file path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83e458521c10d309ae7fa652992da870a08bd18b", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/83e458521c10d309ae7fa652992da870a08bd18b", "committedDate": "2020-10-30T19:20:11Z", "message": "Fixed: Removed unnecessary @Cache annotation on subclasses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8fc707bc77bec64004069e1117a3501d7078931", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/b8fc707bc77bec64004069e1117a3501d7078931", "committedDate": "2020-10-31T15:15:00Z", "message": "Fixed: Information for Exercise Units not consistent with Course Overview"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80527dd9b4e99b16170bae32619ec542f89cd22a", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/80527dd9b4e99b16170bae32619ec542f89cd22a", "committedDate": "2020-10-31T15:57:26Z", "message": "Refactor: Made exclusive options more clear"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2", "committedDate": "2020-11-01T12:01:00Z", "message": "Merge branch 'develop' into fix/lecture-units/bugfixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjIxNjg5", "url": "https://github.com/ls1intum/Artemis/pull/2302#pullrequestreview-521221689", "createdAt": "2020-11-01T12:51:39Z", "commit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMzkzNzkz", "url": "https://github.com/ls1intum/Artemis/pull/2302#pullrequestreview-521393793", "createdAt": "2020-11-02T07:53:26Z", "commit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNzo1MzoyNlrOHr5V6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNzo1MzoyNlrOHr5V6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5MDMxNQ==", "bodyText": "Constants.FILEPATH_ID_PLACHEOLDER has a typo. Maybe we can fix it with your PR?", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515790315", "createdAt": "2020-11-02T07:53:26Z", "author": {"login": "derLalla"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Attachment.java", "diffHunk": "@@ -83,7 +83,7 @@ public void onLoad() {\n         if (attachmentType == AttachmentType.FILE && getLecture() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getLecture().getId().toString());\n         }\n-        if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n+        else if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getAttachmentUnit().getId().toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMzk2NzUw", "url": "https://github.com/ls1intum/Artemis/pull/2302#pullrequestreview-521396750", "createdAt": "2020-11-02T07:58:26Z", "commit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNDQwMzE0", "url": "https://github.com/ls1intum/Artemis/pull/2302#pullrequestreview-521440314", "createdAt": "2020-11-02T09:04:38Z", "commit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOTowNDozOFrOHr7hQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOTowNDozOFrOHr7hQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgyNTk4NQ==", "bodyText": "Casting three times doesn't look as performant as casting once, so I suggest doing something like:\nif (lectureUnit.type !== LectureUnitType.EXERCISE) {\n    return lectureUnit;\n}\nconst exercise = (lectureUnit as ExerciseUnit).exercise;\nexercise!.studentParticipations = undefinded;\nexercise!.tutorParticipations = undefined;\nreturn lectureUnit;", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515825985", "createdAt": "2020-11-02T09:04:38Z", "author": {"login": "FrankeLukas"}, "path": "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/lectureUnit.service.ts", "diffHunk": "@@ -21,6 +21,14 @@ export class LectureUnitService {\n     constructor(private httpClient: HttpClient, private attachmentService: AttachmentService, private exerciseService: ExerciseService) {}\n \n     updateOrder(lectureId: number, lectureUnits: LectureUnit[]): Observable<HttpResponse<LectureUnit[]>> {\n+        // need to remove participations from exercise units to prevent circular structure failure\n+        lectureUnits = lectureUnits.map((lectureUnit) => {\n+            if (lectureUnit.type === LectureUnitType.EXERCISE && (lectureUnit as ExerciseUnit).exercise) {\n+                (lectureUnit as ExerciseUnit).exercise!.studentParticipations = undefined;\n+                (lectureUnit as ExerciseUnit).exercise!.tutorParticipations = undefined;\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a0a229d1accaf5134471f4873deb07e83db44df", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/9a0a229d1accaf5134471f4873deb07e83db44df", "committedDate": "2020-11-02T09:11:07Z", "message": "Fixed Constants Name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ad7c3b0422bb4ee5efd297f95a078f1e1a11b6e", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/0ad7c3b0422bb4ee5efd297f95a078f1e1a11b6e", "committedDate": "2020-11-02T09:11:44Z", "message": "Merge remote-tracking branch 'origin/fix/lecture-units/bugfixes' into fix/lecture-units/bugfixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "476d673e86f9765781f6acc8c420e78e81229424", "author": {"user": {"login": "stefanwaldhauser", "name": "Stefan Waldhauser"}}, "url": "https://github.com/ls1intum/Artemis/commit/476d673e86f9765781f6acc8c420e78e81229424", "committedDate": "2020-11-02T22:44:51Z", "message": "Merge branch 'develop' into fix/lecture-units/bugfixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMTA3NTk5", "url": "https://github.com/ls1intum/Artemis/pull/2302#pullrequestreview-522107599", "createdAt": "2020-11-02T23:38:00Z", "commit": {"oid": "476d673e86f9765781f6acc8c420e78e81229424"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3542, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}