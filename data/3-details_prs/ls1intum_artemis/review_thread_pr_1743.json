{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMzI5MDU3", "number": 1743, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzowOTozN1rOEJpq4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzowOTozN1rOEJpq4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NTU1MzYxOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/config/websocket/WebsocketConfiguration.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzowOTozN1rOGqQJFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzoyOTo1N1rOGqRA3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk1Nzg0Nw==", "bodyText": "log.warn(\"Catcher an exception during SUBSCRIBE...\")", "url": "https://github.com/ls1intum/Artemis/pull/1743#discussion_r446957847", "createdAt": "2020-06-29T13:09:37Z", "author": {"login": "krusche"}, "path": "src/main/java/de/tum/in/www1/artemis/config/websocket/WebsocketConfiguration.java", "diffHunk": "@@ -262,9 +263,15 @@ protected Principal determineUser(ServerHttpRequest request, WebSocketHandler ws\n             String destination = headerAccessor.getDestination();\n \n             if (StompCommand.SUBSCRIBE.equals(headerAccessor.getCommand())) {\n-                if (!allowSubscription(principal, destination)) {\n-                    logUnauthorizedDestinationAccess(principal, destination);\n-                    return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                try {\n+                    if (!allowSubscription(principal, destination)) {\n+                        logUnauthorizedDestinationAccess(principal, destination);\n+                        return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                    }\n+                }\n+                catch (EntityNotFoundException e) {\n+                    // If the user is not found (e.g. because he is not logged in), he should not be able to subscribe to these topics", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aad2895de029805394e2bc4a77975536a0e60186"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3MjEyNg==", "bodyText": "I've added a log message.", "url": "https://github.com/ls1intum/Artemis/pull/1743#discussion_r446972126", "createdAt": "2020-06-29T13:29:57Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/config/websocket/WebsocketConfiguration.java", "diffHunk": "@@ -262,9 +263,15 @@ protected Principal determineUser(ServerHttpRequest request, WebSocketHandler ws\n             String destination = headerAccessor.getDestination();\n \n             if (StompCommand.SUBSCRIBE.equals(headerAccessor.getCommand())) {\n-                if (!allowSubscription(principal, destination)) {\n-                    logUnauthorizedDestinationAccess(principal, destination);\n-                    return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                try {\n+                    if (!allowSubscription(principal, destination)) {\n+                        logUnauthorizedDestinationAccess(principal, destination);\n+                        return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                    }\n+                }\n+                catch (EntityNotFoundException e) {\n+                    // If the user is not found (e.g. because he is not logged in), he should not be able to subscribe to these topics", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk1Nzg0Nw=="}, "originalCommit": {"oid": "aad2895de029805394e2bc4a77975536a0e60186"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4928, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}