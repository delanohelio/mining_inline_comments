{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2NjU3MTE1", "number": 2531, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDozOFrOFD-twQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMjozN1rOFEFx-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NzE3NTY5OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDozOFrOID4P2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQxNzoxMzowOVrOIElLkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODIwMw==", "bodyText": "Can you please add a reason why this is necessary. I guess the main reason is to speed up build times...", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938203", "createdAt": "2020-12-11T13:14:38Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY2NzU2Mw==", "bodyText": "Yes. It significantly speeds up build. Sady the dependencies cached in the docker image are frequently out of date. So we do the caching like that", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541667563", "createdAt": "2020-12-12T16:59:48Z", "author": {"login": "1-alex98"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODIwMw=="}, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NDM4NQ==", "bodyText": "I've added an explanation.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541674385", "createdAt": "2020-12-12T17:13:09Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODIwMw=="}, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NzE3NzAxOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDo1OVrOID4QrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQxNzoxMzozMFrOIElMPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODQxMw==", "bodyText": "you can reference artemis-java-testing-sandbox here, which can circumvent those issues", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938413", "createdAt": "2020-12-11T13:14:59Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.\n+\n+\n+.. code:: bash\n+\n+        agent {\n+            docker {\n+                image '#dockerImage'\n+                label 'docker'\n+                args '-v $HOME/maven-cache-docker:/var/maven'\n+            }\n+        }\n+        environment {\n+          JAVA_TOOL_OPTIONS = '-Duser.home=/var/maven'\n+        }\n+        stages {\n+            stage('Checkout') {\n+\n+\n+\n+You have to add permissions to the folder (which will be located at the $HOME folder of the user that jenkins uses), e.g. with ``sudo chmod 777 maven-cache-docker -R``.\n+\n+Note that this might allow students to access shared resources (e.g. jars used by Maven), and they might be able to overwrite them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NDU1OQ==", "bodyText": "I've added it.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541674559", "createdAt": "2020-12-12T17:13:30Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.\n+\n+\n+.. code:: bash\n+\n+        agent {\n+            docker {\n+                image '#dockerImage'\n+                label 'docker'\n+                args '-v $HOME/maven-cache-docker:/var/maven'\n+            }\n+        }\n+        environment {\n+          JAVA_TOOL_OPTIONS = '-Duser.home=/var/maven'\n+        }\n+        stages {\n+            stage('Checkout') {\n+\n+\n+\n+You have to add permissions to the folder (which will be located at the $HOME folder of the user that jenkins uses), e.g. with ``sudo chmod 777 maven-cache-docker -R``.\n+\n+Note that this might allow students to access shared resources (e.g. jars used by Maven), and they might be able to overwrite them.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODQxMw=="}, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NzE3OTc2OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/jenkins-gitlab.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNTo0N1rOID4SYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQxNzoxMzoyMFrOIElL5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODg1MA==", "bodyText": "add a new line to fix the GitHub action warning", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938850", "createdAt": "2020-12-11T13:15:47Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -418,42 +405,12 @@ Start Jenkins\n            continuous-integration:\n                user: your.chosen.username\n                password: your.chosen.password\n-\n-12. Setup JDK 15 in Jenkins Settings\n-\n-    Navigate in your browser into Jenkins \u2192 Manage Jenkins \u2192 Global Tool\n-    Configuration \u2192 JDK. Change the existing JDK installation or click\n-    on Add JDK.\n-\n-    Use ``OpenJDK 15`` as Name and\n-    ``/usr/lib/jvm/java-15-openjdk-amd64`` as JAVA_HOME\n-\n-   .. figure:: jenkins-gitlab/jenkins_jdk_config.png\n-      :align: center\n-\n Required Jenkins Plugins", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NDQ2OQ==", "bodyText": "Fixed", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541674469", "createdAt": "2020-12-12T17:13:20Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -418,42 +405,12 @@ Start Jenkins\n            continuous-integration:\n                user: your.chosen.username\n                password: your.chosen.password\n-\n-12. Setup JDK 15 in Jenkins Settings\n-\n-    Navigate in your browser into Jenkins \u2192 Manage Jenkins \u2192 Global Tool\n-    Configuration \u2192 JDK. Change the existing JDK installation or click\n-    on Add JDK.\n-\n-    Use ``OpenJDK 15`` as Name and\n-    ``/usr/lib/jvm/java-15-openjdk-amd64`` as JAVA_HOME\n-\n-   .. figure:: jenkins-gitlab/jenkins_jdk_config.png\n-      :align: center\n-\n Required Jenkins Plugins", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODg1MA=="}, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5ODMzMzM3OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/jenkins-gitlab.rst", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMjozN1rOIECzpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxOTo1NFrOIIaxaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA==", "bodyText": "It seems that disabling CSRF in Jenkins is no longer necessary. In Artemis support for it is enabled by default https://github.com/ls1intum/Artemis/blob/develop/src/main/resources/config/application-jenkins.yml and we are running a setup with it enabled without problems.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541111204", "createdAt": "2020-12-11T17:32:37Z", "author": {"login": "b-fein"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NTA4NA==", "bodyText": "@krusche Were you able to set it up locally without disabling this setting as you tried it yesterday?\nIf so, I would suggest removing this section.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541675084", "createdAt": "2020-12-12T17:14:30Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA=="}, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDEyNTU4MQ==", "bodyText": "I did not fully finish the setup locally, so I can't say it. Would be great if someone can try it out again. I think the issue with crumb being active occurs, when the URLs and the http scheme are not always the same, so this could still be an issue", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r544125581", "createdAt": "2020-12-16T09:02:52Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA=="}, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDEyNjA4MQ==", "bodyText": "This is no issue when you have certificates and \"official\" domains, but it rather can be an issue in the local setup with localhost or docker specific urls", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r544126081", "createdAt": "2020-12-16T09:03:43Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA=="}, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDE5NTI4OA==", "bodyText": "I seem to have missed the line above earlier where it states this is only for local setups. It\u2019s just above where Github cuts off the diff.\nI agree it might cause problems in some local docker setups. (I think it works in some cases, though, as I don\u2019t think I\u2019ve disabled CSRF in mine.) With this disclaimer that disabling CSRF should only be done for local setups and not in production this section should definitely stay.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r544195288", "createdAt": "2020-12-16T10:45:25Z", "author": {"login": "b-fein"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA=="}, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTY5ODE1NQ==", "bodyText": "I have the Jenkins/Gitlab set up on two machines and never got CSRF to work. I updated the docs (where the TODO is) so that they include steps on how to disable that locally.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r545698155", "createdAt": "2020-12-18T09:19:54Z", "author": {"login": "ivanchimeno"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA=="}, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4335, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}