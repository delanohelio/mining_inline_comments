{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyODI2NzIw", "number": 1228, "title": "Filter participations without submissions + add submission count to participations", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n Client: I documented the TypeScript code using JSDoc style.\n Client: I added multiple screenshots/screencasts of my UI changes\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\nAt the moment, it is possible to filter participations to find those with failed submissions (without result). With this PR, participations can also be filtered to find those with no submissions. Additionally, a new column \"Submissions\" shows how many submissions a participation has (as it is already the case on the exercise scores page).\nDescription\n\nMove transient property submissionCount from Result to Participation (submissionCount on Result is only used in one occurence and there the participation is also available. Also conceptually, it makes more sense that a Participation knows this information instead of a Result.)\nAdd  new query to the StudentParticipationRepository that counts the submissions per participation for an exercise and add a new service method that turns it into a mapping from participation id to submission count\nUse this mapping in the REST controller for /exercise/{exerciseId}/participations and set the transient property submissionCount accordingly\nIn frontend, add the new filter radio button for participations without submissions and add a new column \"Submissions\" that shows the submission count and links to the overview of these submissions\nFor consistency, also link the submission count on the Exercise Scores page to the submission overview page\nSmall design improvement: Fix unnecessarily wide columns in participations table that would require horizontal scrolling even for medium-large screen sizes\n\nSteps for Testing\n\nLog in to Artemis\nNavigate to Course Administration\nClick on Exercises for a course\nClick on Participations for an exercise\nCheck that new filter option \"Show No Submissions\" below headline exists and works as one would expect\nCheck that new column \"Submissions\" exists in table, that the value is correct, that sorting by it works and that it is linked to view these submissions\n\nScreenshots", "createdAt": "2020-02-09T13:07:10Z", "url": "https://github.com/ls1intum/Artemis/pull/1228", "merged": true, "mergeCommit": {"oid": "82a019e70fe68c11bcfc8baff5cfb418202ea0ef"}, "closed": true, "closedAt": "2020-02-11T16:22:23Z", "author": {"login": "madwau"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcCYSP1gH2gAyMzcyODI2NzIwOjUwMDg2ZDRjMjAxNmQ4ZWUzOTExNmYzODAxMjY4MzZhNGU2OWNkZGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDUObdgFqTM1Njc5NzkwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "50086d4c2016d8ee39116f380126836a4e69cddd", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/50086d4c2016d8ee39116f380126836a4e69cddd", "committedDate": "2020-02-08T18:31:35Z", "message": "Add participation filter for participations without submissions + add submission count column to participations table"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "116cbf9b1aa1a033eddf2eb5ab4a631b7c221569", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/116cbf9b1aa1a033eddf2eb5ab4a631b7c221569", "committedDate": "2020-02-09T13:09:48Z", "message": "Undo yarn.lock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d5e86e9fb7d073ddc7a5805cb0be433f20bd4c6", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/8d5e86e9fb7d073ddc7a5805cb0be433f20bd4c6", "committedDate": "2020-02-09T13:33:42Z", "message": "Center align head cells for submissionCount + specify width on columns for participations data table"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b62f0d91d3fcf4b84ea2f6cf5e579bcdc70760", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/75b62f0d91d3fcf4b84ea2f6cf5e579bcdc70760", "committedDate": "2020-02-09T14:06:38Z", "message": "Fix query"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14e86f825c2cf26a1c1e7bcf96e0d9da47e40d99", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/14e86f825c2cf26a1c1e7bcf96e0d9da47e40d99", "committedDate": "2020-02-09T14:59:29Z", "message": "Fix query"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8af073375e99440f8e300ccf1fe5b4912901ce0", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/c8af073375e99440f8e300ccf1fe5b4912901ce0", "committedDate": "2020-02-09T16:18:59Z", "message": "Get rid of very expensive query"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64e81cf313f6abe21ea6de09930fa67989f8b4d1", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/64e81cf313f6abe21ea6de09930fa67989f8b4d1", "committedDate": "2020-02-09T16:45:25Z", "message": "Center submissionCount table header cell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb0be2459aa31cd995fae509f6836be80af901d2", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/eb0be2459aa31cd995fae509f6836be80af901d2", "committedDate": "2020-02-09T16:52:34Z", "message": "Refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MTQ2OTI1", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356146925", "createdAt": "2020-02-10T18:02:37Z", "commit": {"oid": "eb0be2459aa31cd995fae509f6836be80af901d2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODowMjozN1rOFnwBSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODowNzo0OVrOFnwKsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNTU0NA==", "bodyText": "Can you use primitive types here for returned result and parameter? https://crunchify.com/java-tip-wherever-possible-try-to-use-primitive-types-instead-of-wrapper-classes/", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377225544", "createdAt": "2020-02-10T18:02:37Z", "author": {"login": "maxr96"}, "path": "src/main/java/de/tum/in/www1/artemis/repository/StudentParticipationRepository.java", "diffHunk": "@@ -110,4 +110,13 @@\n     @EntityGraph(attributePaths = { \"submissions\", \"submissions.result\", \"submissions.result.assessor\" })\n     @Query(\"select distinct p from StudentParticipation p left join fetch p.submissions s where p.exercise.id = :#{#exerciseId} and (s.result.assessor.id = :#{#assessorId} and s.id = (select max(id) from p.submissions) or s.id = null)\")\n     List<StudentParticipation> findWithLatestSubmissionByExerciseAndAssessor(@Param(\"exerciseId\") Long exerciseId, @Param(\"assessorId\") Long assessorId);\n+\n+    /**\n+     * Count the number of submissions for each participation in a given exercise.\n+     *\n+     * @param exerciseId the id of the exercise for which to consider participations\n+     * @return the number of submissions per participation\n+     */\n+    @Query(\"select participation.id, count(submissions) from StudentParticipation participation left join participation.submissions submissions where participation.exercise.id = :#{#exerciseId} group by participation.id\")\n+    List<Long[]> countSubmissionsPerParticipationByExerciseId(@Param(\"exerciseId\") Long exerciseId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb0be2459aa31cd995fae509f6836be80af901d2"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNzMxMQ==", "bodyText": "You probably can remove the div here and do ngIf right on the <a> tag to make the structure leaner", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377227311", "createdAt": "2020-02-10T18:06:23Z", "author": {"login": "maxr96"}, "path": "src/main/webapp/app/entities/participation/participation.component.html", "diffHunk": "@@ -130,7 +139,28 @@ <h2>\n                     </ng-template>\n                 </ngx-datatable-column>\n \n-                <ngx-datatable-column prop=\"student\" [minWidth]=\"120\">\n+                <ngx-datatable-column [minWidth]=\"100\" [width]=\"110\">\n+                    <ng-template ngx-datatable-header-template>\n+                        <span class=\"datatable-header-cell-wrapper d-inline-block w-100 text-center\" (click)=\"controls.onSort('submissionCount')\">\n+                            <span class=\"datatable-header-cell-label bold sortable\" jhiTranslate=\"artemisApp.exercise.submissionCount\">\n+                                Submissions\n+                            </span>\n+                            <fa-icon [icon]=\"controls.iconForSortPropField('submissionCount')\"></fa-icon>\n+                        </span>\n+                    </ng-template>\n+                    <ng-template ngx-datatable-cell-template let-value=\"row\">\n+                        <div class=\"text-center\">\n+                            <div *ngIf=\"exercise.isAtLeastInstructor; else displayTextOnly\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb0be2459aa31cd995fae509f6836be80af901d2"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNzk1NQ==", "bodyText": "This can also be a primitive type. The count should not be a null value, right?", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377227955", "createdAt": "2020-02-10T18:07:49Z", "author": {"login": "maxr96"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/participation/Participation.java", "diffHunk": "@@ -85,6 +85,22 @@\n     @Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)\n     private Set<Submission> submissions = new HashSet<>();\n \n+    /**\n+     * This property stores the total number of submissions in this participation. Not stored in the database, computed dynamically and used in showing statistics to the user in\n+     * the exercise view.\n+     */\n+    @Transient\n+    @JsonProperty\n+    private Integer submissionCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb0be2459aa31cd995fae509f6836be80af901d2"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0e49da5fd084cf83fe137c52fd6665ab87551ff", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/d0e49da5fd084cf83fe137c52fd6665ab87551ff", "committedDate": "2020-02-10T19:27:03Z", "message": "Feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/751685a00dd3d49640e74ad789d39d39ecdff5a4", "committedDate": "2020-02-10T19:27:59Z", "message": "Feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjY0MTc1", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356264175", "createdAt": "2020-02-10T21:08:36Z", "commit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMTowODozNlrOFn1nhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMToxMDo1OVrOFn1r5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxNzI1NA==", "bodyText": "I think this can be easier using .stream(toMap({})).", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377317254", "createdAt": "2020-02-10T21:08:36Z", "author": {"login": "jpbernius"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ParticipationService.java", "diffHunk": "@@ -1013,4 +1013,21 @@ private boolean userHasPermissions(StudentParticipation participation) {\n     public List<StudentParticipation> findWithSubmissionsWithResultByStudentIdAndExercise(Long studentId, Set<Exercise> exercises) {\n         return studentParticipationRepository.findByStudentIdAndExerciseWithEagerSubmissionsResult(studentId, exercises);\n     }\n+\n+    /**\n+     * Get a mapping of participation ids to the number of submission for each participation.\n+     *\n+     * @param exerciseId the id of the exercise for which to consider participations\n+     * @return the number of submissions per participation in the given exercise\n+     */\n+    public Map<Long, Integer> countSubmissionsPerParticipationByExerciseId(Long exerciseId) {\n+        List<long[]> submissionCountResults = studentParticipationRepository.countSubmissionsPerParticipationByExerciseId(exerciseId);\n+        Map<Long, Integer> map = new HashMap<Long, Integer>();\n+        submissionCountResults.forEach(submissionCountResult -> {\n+            Long participationId = submissionCountResult[0];\n+            Integer submissionCount = Math.toIntExact(submissionCountResult[1]);\n+            map.put(participationId, submissionCount);\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxNzk5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return the number of submissions per participation\n          \n          \n            \n                 * @return Tuples of participation ids and number of submissions per participation", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377317992", "createdAt": "2020-02-10T21:10:14Z", "author": {"login": "jpbernius"}, "path": "src/main/java/de/tum/in/www1/artemis/repository/StudentParticipationRepository.java", "diffHunk": "@@ -110,4 +110,13 @@\n     @EntityGraph(attributePaths = { \"submissions\", \"submissions.result\", \"submissions.result.assessor\" })\n     @Query(\"select distinct p from StudentParticipation p left join fetch p.submissions s where p.exercise.id = :#{#exerciseId} and (s.result.assessor.id = :#{#assessorId} and s.id = (select max(id) from p.submissions) or s.id = null)\")\n     List<StudentParticipation> findWithLatestSubmissionByExerciseAndAssessor(@Param(\"exerciseId\") Long exerciseId, @Param(\"assessorId\") Long assessorId);\n+\n+    /**\n+     * Count the number of submissions for each participation in a given exercise.\n+     *\n+     * @param exerciseId the id of the exercise for which to consider participations\n+     * @return the number of submissions per participation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxODM3Mg==", "bodyText": "This got refactored from Result. Should we also update toString?", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377318372", "createdAt": "2020-02-10T21:10:59Z", "author": {"login": "jpbernius"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/participation/Participation.java", "diffHunk": "@@ -85,6 +85,22 @@\n     @Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)\n     private Set<Submission> submissions = new HashSet<>();\n \n+    /**\n+     * This property stores the total number of submissions in this participation. Not stored in the database, computed dynamically and used in showing statistics to the user in\n+     * the exercise view.\n+     */\n+    @Transient\n+    @JsonProperty\n+    private int submissionCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MzA0ODQx", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356304841", "createdAt": "2020-02-10T22:15:33Z", "commit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjoxNTozM1rOFn3kVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjoxNTozM1rOFn3kVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM0OTIwNQ==", "bodyText": "Can you also change this Long exerciseId one to primitive type please?", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377349205", "createdAt": "2020-02-10T22:15:33Z", "author": {"login": "maxr96"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ParticipationService.java", "diffHunk": "@@ -1013,4 +1013,21 @@ private boolean userHasPermissions(StudentParticipation participation) {\n     public List<StudentParticipation> findWithSubmissionsWithResultByStudentIdAndExercise(Long studentId, Set<Exercise> exercises) {\n         return studentParticipationRepository.findByStudentIdAndExerciseWithEagerSubmissionsResult(studentId, exercises);\n     }\n+\n+    /**\n+     * Get a mapping of participation ids to the number of submission for each participation.\n+     *\n+     * @param exerciseId the id of the exercise for which to consider participations\n+     * @return the number of submissions per participation in the given exercise\n+     */\n+    public Map<Long, Integer> countSubmissionsPerParticipationByExerciseId(Long exerciseId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751685a00dd3d49640e74ad789d39d39ecdff5a4"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a05f13ab7dfe543ce17ceaaac3554f7d0470864c", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/a05f13ab7dfe543ce17ceaaac3554f7d0470864c", "committedDate": "2020-02-11T09:39:38Z", "message": "Merge branch 'develop' into feature/participations/filter-by-no-submissions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94dc23e20c06ade0686ec0b7436856f3dda91163", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/94dc23e20c06ade0686ec0b7436856f3dda91163", "committedDate": "2020-02-11T09:40:32Z", "message": "Primitive type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7bb31a5520e31c170189689cc1b9cc7b36535fc", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/f7bb31a5520e31c170189689cc1b9cc7b36535fc", "committedDate": "2020-02-11T09:42:17Z", "message": "Add submissionCount to toString for Participation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c21668eb3720f50b5dcd688648ae38c4b79a02a3", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/c21668eb3720f50b5dcd688648ae38c4b79a02a3", "committedDate": "2020-02-11T09:43:33Z", "message": "Update src/main/java/de/tum/in/www1/artemis/repository/StudentParticipationRepository.java\n\nCo-Authored-By: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "213a773e877a8ceac8b7a1f442c54ef985f7565a", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/213a773e877a8ceac8b7a1f442c54ef985f7565a", "committedDate": "2020-02-11T09:58:58Z", "message": "Refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NTI5MTY0", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356529164", "createdAt": "2020-02-11T09:59:58Z", "commit": {"oid": "213a773e877a8ceac8b7a1f442c54ef985f7565a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NTMxMjE1", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356531215", "createdAt": "2020-02-11T10:03:18Z", "commit": {"oid": "213a773e877a8ceac8b7a1f442c54ef985f7565a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba2703390b04706e565b29f8363ff19c2f647f0b", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/ba2703390b04706e565b29f8363ff19c2f647f0b", "committedDate": "2020-02-11T10:33:06Z", "message": "Fix sorting by submission count in exercise scores"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NjgxOTkx", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356681991", "createdAt": "2020-02-11T14:07:00Z", "commit": {"oid": "ba2703390b04706e565b29f8363ff19c2f647f0b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNDowNzowMVrOFoKMnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNDowNzowMVrOFoKMnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY1NDQyOQ==", "bodyText": "please use a better variable name than t and add one natural language comment before such asa\nconvert the list of arrays (with 2 values: participatoinId, submissionCount) into a Map <participationIid -> submissionCount>", "url": "https://github.com/ls1intum/Artemis/pull/1228#discussion_r377654429", "createdAt": "2020-02-11T14:07:01Z", "author": {"login": "krusche"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ParticipationService.java", "diffHunk": "@@ -1011,4 +1011,15 @@ private boolean userHasPermissions(StudentParticipation participation) {\n     public List<StudentParticipation> findWithSubmissionsWithResultByStudentIdAndExercise(Long studentId, Set<Exercise> exercises) {\n         return studentParticipationRepository.findByStudentIdAndExerciseWithEagerSubmissionsResult(studentId, exercises);\n     }\n+\n+    /**\n+     * Get a mapping of participation ids to the number of submission for each participation.\n+     *\n+     * @param exerciseId the id of the exercise for which to consider participations\n+     * @return the number of submissions per participation in the given exercise\n+     */\n+    public Map<Long, Integer> countSubmissionsPerParticipationByExerciseId(long exerciseId) {\n+        List<long[]> submissionCountTuples = studentParticipationRepository.countSubmissionsPerParticipationByExerciseId(exerciseId);\n+        return submissionCountTuples.stream().collect(Collectors.toMap(t -> t[0], t -> Math.toIntExact(t[1])));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2703390b04706e565b29f8363ff19c2f647f0b"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2Njg1MTM3", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356685137", "createdAt": "2020-02-11T14:10:58Z", "commit": {"oid": "ba2703390b04706e565b29f8363ff19c2f647f0b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c1fe95bb5dab594551a1df8a10eacff95a0552d", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/0c1fe95bb5dab594551a1df8a10eacff95a0552d", "committedDate": "2020-02-11T14:46:27Z", "message": "Use Integer instead of int for submissionCount (to be able to differentiate between zero and null where null means that the submission count is not available, i.e. has not been computed and set)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f255454bba6f7c82387a63437334a042b988065c", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/f255454bba6f7c82387a63437334a042b988065c", "committedDate": "2020-02-11T14:54:17Z", "message": "Rename variable + explanatory comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93ce2a3e64b3259ad9b2c452e621cfa80c499303", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/93ce2a3e64b3259ad9b2c452e621cfa80c499303", "committedDate": "2020-02-11T14:56:53Z", "message": "Merge branch 'develop' into feature/participations/filter-by-no-submissions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2Nzk3OTAw", "url": "https://github.com/ls1intum/Artemis/pull/1228#pullrequestreview-356797900", "createdAt": "2020-02-11T16:21:43Z", "commit": {"oid": "93ce2a3e64b3259ad9b2c452e621cfa80c499303"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3151, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}