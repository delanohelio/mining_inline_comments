{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNjQzMzky", "number": 2306, "reviewThreads": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDoyOTo0NlrOE0LjlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToxOTozN1rOE3RprA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMTUwNzQwOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDoyOTo0NlrOHrx4tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDoyNjoyM1rOHs_Q2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODE1MQ==", "bodyText": "GitHub Actions complains: docs/dev/setup/programming-exercises.rst#L1: document isn't included in any toctree", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r515668151", "createdAt": "2020-11-01T20:29:46Z", "author": {"login": "FrankeLukas"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,57 @@\n+Adjustments for programming exercises", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzNTg5OQ==", "bodyText": "Should be fixed now.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r516935899", "createdAt": "2020-11-03T20:26:23Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,57 @@\n+Adjustments for programming exercises", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODE1MQ=="}, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMTUxMDM2OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/DefaultJenkinsBuildPlanCreator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDozMzoxMVrOHrx6Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMToyODo1NFrOHryQkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODUwNw==", "bodyText": "Shouldn't this be jenkinsService.getDockerImageName(programmingLanguage) instead considering you removed the hardcoded \"c\" from resourcePath?", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r515668507", "createdAt": "2020-11-01T20:33:11Z", "author": {"login": "FrankeLukas"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/DefaultJenkinsBuildPlanCreator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package de.tum.in.www1.artemis.service.connectors.jenkins;\n+\n+import java.net.URL;\n+import java.util.Map;\n+\n+import org.springframework.context.annotation.Lazy;\n+import org.springframework.context.annotation.Profile;\n+import org.springframework.stereotype.Component;\n+\n+import de.tum.in.www1.artemis.ResourceLoaderService;\n+import de.tum.in.www1.artemis.config.Constants;\n+import de.tum.in.www1.artemis.domain.enumeration.ProgrammingLanguage;\n+\n+@Profile(\"jenkins\")\n+@Component\n+public class DefaultJenkinsBuildPlanCreator extends AbstractJenkinsBuildPlanCreator {\n+\n+    public DefaultJenkinsBuildPlanCreator(ResourceLoaderService resourceLoaderService, @Lazy JenkinsService jenkinsService) {\n+        super(resourceLoaderService, jenkinsService);\n+    }\n+\n+    @Override\n+    public String getPipelineScript(ProgrammingLanguage programmingLanguage, URL testRepositoryURL, URL assignmentRepositoryURL, boolean isStaticCodeAnalysisEnabled) {\n+        final var resourcePath = new String[] { \"templates\", \"jenkins\", programmingLanguage.name().toLowerCase(), \"Jenkinsfile\" };\n+\n+        final var replacements = Map.of(REPLACE_TEST_REPO, testRepositoryURL.toString(), REPLACE_ASSIGNMENT_REPO, assignmentRepositoryURL.toString(), REPLACE_GIT_CREDENTIALS,\n+                gitCredentialsKey, REPLACE_ASSIGNMENT_CHECKOUT_PATH, Constants.ASSIGNMENT_CHECKOUT_PATH, REPLACE_TESTS_CHECKOUT_PATH, Constants.TESTS_CHECKOUT_PATH,\n+                REPLACE_ARTEMIS_NOTIFICATION_URL, artemisNotificationUrl, REPLACE_NOTIFICATIONS_TOKEN, ARTEMIS_AUTHENTICATION_TOKEN_KEY, REPLACE_DOCKER_IMAGE_NAME,\n+                jenkinsService.getDockerImageName(ProgrammingLanguage.C));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY3NDI1OQ==", "bodyText": "Thanks, good catch!", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r515674259", "createdAt": "2020-11-01T21:28:54Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/DefaultJenkinsBuildPlanCreator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package de.tum.in.www1.artemis.service.connectors.jenkins;\n+\n+import java.net.URL;\n+import java.util.Map;\n+\n+import org.springframework.context.annotation.Lazy;\n+import org.springframework.context.annotation.Profile;\n+import org.springframework.stereotype.Component;\n+\n+import de.tum.in.www1.artemis.ResourceLoaderService;\n+import de.tum.in.www1.artemis.config.Constants;\n+import de.tum.in.www1.artemis.domain.enumeration.ProgrammingLanguage;\n+\n+@Profile(\"jenkins\")\n+@Component\n+public class DefaultJenkinsBuildPlanCreator extends AbstractJenkinsBuildPlanCreator {\n+\n+    public DefaultJenkinsBuildPlanCreator(ResourceLoaderService resourceLoaderService, @Lazy JenkinsService jenkinsService) {\n+        super(resourceLoaderService, jenkinsService);\n+    }\n+\n+    @Override\n+    public String getPipelineScript(ProgrammingLanguage programmingLanguage, URL testRepositoryURL, URL assignmentRepositoryURL, boolean isStaticCodeAnalysisEnabled) {\n+        final var resourcePath = new String[] { \"templates\", \"jenkins\", programmingLanguage.name().toLowerCase(), \"Jenkinsfile\" };\n+\n+        final var replacements = Map.of(REPLACE_TEST_REPO, testRepositoryURL.toString(), REPLACE_ASSIGNMENT_REPO, assignmentRepositoryURL.toString(), REPLACE_GIT_CREDENTIALS,\n+                gitCredentialsKey, REPLACE_ASSIGNMENT_CHECKOUT_PATH, Constants.ASSIGNMENT_CHECKOUT_PATH, REPLACE_TESTS_CHECKOUT_PATH, Constants.TESTS_CHECKOUT_PATH,\n+                REPLACE_ARTEMIS_NOTIFICATION_URL, artemisNotificationUrl, REPLACE_NOTIFICATIONS_TOKEN, ARTEMIS_AUTHENTICATION_TOKEN_KEY, REPLACE_DOCKER_IMAGE_NAME,\n+                jenkinsService.getDockerImageName(ProgrammingLanguage.C));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODUwNw=="}, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMTUxMjU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDozNTowMlrOHrx7Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNTowNTo0NFrOHuHlfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODc2Mg==", "bodyText": "Codacy is complaining here: These nested if statements could be combined", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r515668762", "createdAt": "2020-11-01T20:35:02Z", "author": {"login": "FrankeLukas"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +500,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2OTA4NQ==", "bodyText": "Fwiw, Imho this would be more readable as\nfor (Element elem : logHtml.children()) {\n    // Only pipeline-node-ID elements containing actual log entries with at least one child with a timestamp class\n    if (!elem.attributes().get(\"class\").contains(\"pipeline-node\") || !elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n        continue;\n    }\n\n    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n    [...]\n}\n\nbut that is personal preference.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r515669085", "createdAt": "2020-11-01T20:38:14Z", "author": {"login": "FrankeLukas"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +500,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODc2Mg=="}, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODExNjc5NA==", "bodyText": "Fwiw, this was not resolved.(?)", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518116794", "createdAt": "2020-11-05T15:00:12Z", "author": {"login": "FrankeLukas"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +500,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODc2Mg=="}, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODEyMDgzMA==", "bodyText": "Thanks for the reminder, I actually prefer the current version if that is also fine for you.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518120830", "createdAt": "2020-11-05T15:05:44Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +500,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODc2Mg=="}, "originalCommit": {"oid": "0ea2c4e20911de5fe5f3b10d9615225497e786cd"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0ODI5MzkwOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxODowODozMFrOHuQEAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxODoxMzowM1rOHuQOdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI1OTcxNA==", "bodyText": "This is the same as in line 13. Should it be artemis.repo-download-clone-path?", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518259714", "createdAt": "2020-11-05T18:08:30Z", "author": {"login": "b-fein"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-clone-path``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "560af7c15fd60bedd411d20e5d873fe766b0f6b3"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI2MjM4OQ==", "bodyText": "Good catch! Exactly, it should be artemis.repo-download-clone-path. I changed it", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518262389", "createdAt": "2020-11-05T18:13:03Z", "author": {"login": "sleiss"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-clone-path``", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI1OTcxNA=="}, "originalCommit": {"oid": "560af7c15fd60bedd411d20e5d873fe766b0f6b3"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTExMTc0OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMToyODo0MVrOHuqeSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMToyODo0MVrOHuqeSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5MjQyNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              Templates are available within Artemis. The templates should fit to most environment, but there might cases where one wants to change the templates.\n          \n          \n            \n              Templates are available within Artemis. The templates should fit to most environments, but there might be cases where one wants to change the templates.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518692424", "createdAt": "2020-11-06T11:28:41Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-download-clone-path``\n+\n+  Repositories that were downloaded from Artemis are stored in this directory.\n+\n+  Files in this directory can be removed without loss of data, if the downloaded repositories are still present at the VCS.\n+  No changes to the data in the VCS are stored in this directory (or they can be retrieved by performing the download-action again).\n+\n+- ``artemis.template-path``\n+\n+  Templates are available within Artemis. The templates should fit to most environment, but there might cases where one wants to change the templates.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTExODI3OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMDo0NVrOHuqiHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMDo0NVrOHuqiHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5MzQwNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              Note that this is the folder to the path where the `templates` folder is located, not the path to the `templates` folder itself.\n          \n          \n            \n              Note that this is the path to the folder where the `templates` folder is located, not the path to the `templates` folder itself.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518693405", "createdAt": "2020-11-06T11:30:45Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-download-clone-path``\n+\n+  Repositories that were downloaded from Artemis are stored in this directory.\n+\n+  Files in this directory can be removed without loss of data, if the downloaded repositories are still present at the VCS.\n+  No changes to the data in the VCS are stored in this directory (or they can be retrieved by performing the download-action again).\n+\n+- ``artemis.template-path``\n+\n+  Templates are available within Artemis. The templates should fit to most environment, but there might cases where one wants to change the templates.\n+\n+  This value specified the path were the templates that should be overwritten are stored.\n+  Note that this is the folder to the path where the `templates` folder is located, not the path to the `templates` folder itself.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTEyMjUzOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMjoyMVrOHuqk2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMjoyMVrOHuqk2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5NDEwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              This value specified the path were the templates that should be overwritten are stored.\n          \n          \n            \n              This value specifies the path to the templates which should overwrite the default ones.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518694107", "createdAt": "2020-11-06T11:32:21Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-download-clone-path``\n+\n+  Repositories that were downloaded from Artemis are stored in this directory.\n+\n+  Files in this directory can be removed without loss of data, if the downloaded repositories are still present at the VCS.\n+  No changes to the data in the VCS are stored in this directory (or they can be retrieved by performing the download-action again).\n+\n+- ``artemis.template-path``\n+\n+  Templates are available within Artemis. The templates should fit to most environment, but there might cases where one wants to change the templates.\n+\n+  This value specified the path were the templates that should be overwritten are stored.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTEyNTU2OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMzoyN1rOHuqm1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozMzoyN1rOHuqm1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5NDYxMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n          \n          \n            \n              Files in this directory are usually not critical, as the latest pushed version of these repositories are also stored at the VCS.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518694612", "createdAt": "2020-11-06T11:33:27Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTEyNzc1OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozNDoxMVrOHuqoIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozNDoxMVrOHuqoIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5NDk0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            They are present in this separate page to keep the 'normal' setup guide shorter.\n          \n          \n            \n            They are presented in this separate page to keep the 'normal' setup guide shorter.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518694945", "createdAt": "2020-11-06T11:34:11Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTEzNTAwOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/jenkins-gitlab.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozNjo0MVrOHuqsew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozNjo0MVrOHuqsew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5NjA1OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This setup guide is for setting up a remote agent on an Ubuntu virtual machine that supports docker builds.\n          \n          \n            \n            This guide explains setting up a remote agent on an Ubuntu virtual machine that supports docker builds.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518696059", "createdAt": "2020-11-06T11:36:41Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -646,6 +661,67 @@ the following steps:\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.\n \n+\n+Installing remote build agents\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+You might want to run the builds on additional Jenkins agents, especially if a large amount of students should use the system at the same time.\n+Jenkins supports remote build agents: The actual compilation of the students submissions happens on these other machines but the whole process is transparent to Artemis.\n+\n+This setup guide is for setting up a remote agent on an Ubuntu virtual machine that supports docker builds.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTE0MTg0OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozODo1MVrOHuqwiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTozODo1MVrOHuqwiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY5NzA5Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            These templates should fit well for many deployments, but one might to change some of them in special deployments.\n          \n          \n            \n            These templates should fit well for many deployments, but one might want to change some of them for special deployments.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518697097", "createdAt": "2020-11-06T11:38:51Z", "author": {"login": "kloessst"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are present in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories is also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n+\n+- ``artemis.repo-download-clone-path``\n+\n+  Repositories that were downloaded from Artemis are stored in this directory.\n+\n+  Files in this directory can be removed without loss of data, if the downloaded repositories are still present at the VCS.\n+  No changes to the data in the VCS are stored in this directory (or they can be retrieved by performing the download-action again).\n+\n+- ``artemis.template-path``\n+\n+  Templates are available within Artemis. The templates should fit to most environment, but there might cases where one wants to change the templates.\n+\n+  This value specified the path were the templates that should be overwritten are stored.\n+  Note that this is the folder to the path where the `templates` folder is located, not the path to the `templates` folder itself.\n+\n+\n+\n+Templates\n+#########\n+\n+Templates are shipped with Artemis (they can be found within the ``src/main/resources/templates`` folder in Github).\n+These templates should fit well for many deployments, but one might to change some of them in special deployments.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTMzMjA1OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/ResourceLoaderService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMjo0MToyOVrOHusjgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNToxMTowMVrOHux2rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcyNjUzMA==", "bodyText": "Is this variable always set? You could make this Optional and then check it if its empty in the methods.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518726530", "createdAt": "2020-11-06T12:41:29Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/ResourceLoaderService.java", "diffHunk": "@@ -0,0 +1,125 @@\n+package de.tum.in.www1.artemis;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.commons.lang.StringUtils;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.core.io.Resource;\n+import org.springframework.core.io.ResourceLoader;\n+import org.springframework.core.io.support.ResourcePatternUtils;\n+import org.springframework.stereotype.Service;\n+\n+/**\n+ * Service class to load resources from the file system (if possible) and the classpath (as fallback).\n+ */\n+@Service\n+public class ResourceLoaderService {\n+\n+    private final ResourceLoader resourceLoader;\n+\n+    @Value(\"${artemis.template-path:#{null}}\")\n+    private String templateFileSystemPath;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwMDc4MQ==", "bodyText": "I first tried it with Optionals, but it somehow was either an Optional with a value or null, never Optional.empty.\nI'll try it again.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518800781", "createdAt": "2020-11-06T14:51:59Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/ResourceLoaderService.java", "diffHunk": "@@ -0,0 +1,125 @@\n+package de.tum.in.www1.artemis;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.commons.lang.StringUtils;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.core.io.Resource;\n+import org.springframework.core.io.ResourceLoader;\n+import org.springframework.core.io.support.ResourcePatternUtils;\n+import org.springframework.stereotype.Service;\n+\n+/**\n+ * Service class to load resources from the file system (if possible) and the classpath (as fallback).\n+ */\n+@Service\n+public class ResourceLoaderService {\n+\n+    private final ResourceLoader resourceLoader;\n+\n+    @Value(\"${artemis.template-path:#{null}}\")\n+    private String templateFileSystemPath;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcyNjUzMA=="}, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgxMzM1Ng==", "bodyText": "I changed it to Optionals now.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518813356", "createdAt": "2020-11-06T15:11:01Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/ResourceLoaderService.java", "diffHunk": "@@ -0,0 +1,125 @@\n+package de.tum.in.www1.artemis;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.commons.lang.StringUtils;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.core.io.Resource;\n+import org.springframework.core.io.ResourceLoader;\n+import org.springframework.core.io.support.ResourcePatternUtils;\n+import org.springframework.stereotype.Service;\n+\n+/**\n+ * Service class to load resources from the file system (if possible) and the classpath (as fallback).\n+ */\n+@Service\n+public class ResourceLoaderService {\n+\n+    private final ResourceLoader resourceLoader;\n+\n+    @Value(\"${artemis.template-path:#{null}}\")\n+    private String templateFileSystemPath;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcyNjUzMA=="}, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTUyMTk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMzozODo0MlrOHuuWcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNzoyMzo0M1rOHu22Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NTk1Mg==", "bodyText": "Is it possible that there are multiple hidden elements?", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518755952", "createdAt": "2020-11-06T13:38:42Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +507,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n+                    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n+\n+                    while (nodeIterator.hasNext()) {\n+                        Node node = nodeIterator.next();\n+                        final String log;\n+                        if (node.attributes().get(\"class\").contains(\"timestamp\")) {\n+                            final var timeAsString = ((TextNode) node.childNode(0).childNode(0)).getWholeText();\n+                            final var time = ZonedDateTime.parse(timeAsString, DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\"));\n+                            var contentCandidate = nodeIterator.next();\n+\n+                            // Skip invisible entries (they contain only the timestamp, but we already got that above)\n+                            if (contentCandidate.attr(\"style\").contains(\"display: none\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 168}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNjM2MA==", "bodyText": "I'm not aware of that.\nI could change the if to a while, that would solve the issue, but I'm not sure if this causes any other issues.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518806360", "createdAt": "2020-11-06T15:00:21Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +507,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n+                    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n+\n+                    while (nodeIterator.hasNext()) {\n+                        Node node = nodeIterator.next();\n+                        final String log;\n+                        if (node.attributes().get(\"class\").contains(\"timestamp\")) {\n+                            final var timeAsString = ((TextNode) node.childNode(0).childNode(0)).getWholeText();\n+                            final var time = ZonedDateTime.parse(timeAsString, DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\"));\n+                            var contentCandidate = nodeIterator.next();\n+\n+                            // Skip invisible entries (they contain only the timestamp, but we already got that above)\n+                            if (contentCandidate.attr(\"style\").contains(\"display: none\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NTk1Mg=="}, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 168}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg5NTE1NA==", "bodyText": "I don't know the format, but I trust you on this \ud83d\ude04", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518895154", "createdAt": "2020-11-06T17:23:43Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +507,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n+                    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n+\n+                    while (nodeIterator.hasNext()) {\n+                        Node node = nodeIterator.next();\n+                        final String log;\n+                        if (node.attributes().get(\"class\").contains(\"timestamp\")) {\n+                            final var timeAsString = ((TextNode) node.childNode(0).childNode(0)).getWholeText();\n+                            final var time = ZonedDateTime.parse(timeAsString, DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\"));\n+                            var contentCandidate = nodeIterator.next();\n+\n+                            // Skip invisible entries (they contain only the timestamp, but we already got that above)\n+                            if (contentCandidate.attr(\"style\").contains(\"display: none\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NTk1Mg=="}, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 168}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTUyMzQ4OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMzozOTowN1rOHuuXag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1ODoyN1rOHuxWVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NjIwMg==", "bodyText": "DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\") could move this out of the loops.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518756202", "createdAt": "2020-11-06T13:39:07Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +507,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n+                    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n+\n+                    while (nodeIterator.hasNext()) {\n+                        Node node = nodeIterator.next();\n+                        final String log;\n+                        if (node.attributes().get(\"class\").contains(\"timestamp\")) {\n+                            final var timeAsString = ((TextNode) node.childNode(0).childNode(0)).getWholeText();\n+                            final var time = ZonedDateTime.parse(timeAsString, DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 164}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTA3OQ==", "bodyText": "Moved it into the class.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r518805079", "createdAt": "2020-11-06T14:58:27Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -465,6 +507,72 @@ private void addFeedbackToResult(Result result, TestResultsDTO report) {\n         }\n     }\n \n+    private List<BuildLogEntry> parsePipelineLogs(Element logHtml) throws IllegalArgumentException {\n+        final var buildLog = new LinkedList<BuildLogEntry>();\n+        if (logHtml.childNodes().stream().noneMatch(child -> child.attr(\"class\").contains(\"pipeline\"))) {\n+            throw new IllegalArgumentException(\"Log is not pipeline log\");\n+        }\n+        for (Element elem : logHtml.children()) {\n+            // Only pipeline-node-ID elements contain actual log entries\n+            if (elem.attributes().get(\"class\").contains(\"pipeline-node\")) {\n+                // At least one child must have a timestamp class\n+                if (elem.childNodes().stream().anyMatch(child -> child.attr(\"class\").contains(\"timestamp\"))) {\n+                    Iterator<Node> nodeIterator = elem.childNodes().iterator();\n+\n+                    while (nodeIterator.hasNext()) {\n+                        Node node = nodeIterator.next();\n+                        final String log;\n+                        if (node.attributes().get(\"class\").contains(\"timestamp\")) {\n+                            final var timeAsString = ((TextNode) node.childNode(0).childNode(0)).getWholeText();\n+                            final var time = ZonedDateTime.parse(timeAsString, DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NjIwMg=="}, "originalCommit": {"oid": "562f889c1603db1f44d0f39c3efd866b7fb08c0e"}, "originalPosition": 164}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODExNzA0OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMToyMDo0NVrOHvqDxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMToyMDo0NVrOHvqDxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTczNDIxMg==", "bodyText": "Is this just ISO_OFFSET_DATE_TIME?", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r519734212", "createdAt": "2020-11-09T11:20:45Z", "author": {"login": "MaisiKoleni"}, "path": "src/main/java/de/tum/in/www1/artemis/service/connectors/jenkins/JenkinsService.java", "diffHunk": "@@ -81,6 +82,9 @@\n \n     private final FeedbackService feedbackService;\n \n+    // Pattern of the DateTime that is included in the logs received from Jenkins\n+    private final DateTimeFormatter logDateTimeFormatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ssX\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a83adac52e4326dd2e6623e33c6d00267f8031d4"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzUyNzc0OnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/jenkins-gitlab.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0OTowM1rOHwdXYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0OTowM1rOHwdXYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU3NDgxNw==", "bodyText": "I think three ` are too much and only two are needed to highlight it as intended. The preview shows an extra `  surrounding the code fragment.\nThis needs to be changed in all below lines too.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            2. Add a new user to the remote machine that Jenkins will use: ```sudo adduser --disabled-password --gecos \"\" jenkins```\n          \n          \n            \n            2. Add a new user to the remote machine that Jenkins will use: ``sudo adduser --disabled-password --gecos \"\" jenkins``", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r520574817", "createdAt": "2020-11-10T13:49:03Z", "author": {"login": "derLalla"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -646,6 +661,67 @@ the following steps:\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.\n \n+\n+Installing remote build agents\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+You might want to run the builds on additional Jenkins agents, especially if a large amount of students should use the system at the same time.\n+Jenkins supports remote build agents: The actual compilation of the students submissions happens on these other machines but the whole process is transparent to Artemis.\n+\n+This guide explains setting up a remote agent on an Ubuntu virtual machine that supports docker builds.\n+\n+Prerequisites:\n+1. Install Docker on the remote machine: https://docs.docker.com/engine/install/ubuntu/\n+\n+2. Add a new user to the remote machine that Jenkins will use: ```sudo adduser --disabled-password --gecos \"\" jenkins```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a83adac52e4326dd2e6623e33c6d00267f8031d4"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2Mzk2MzMyOnYy", "diffSide": "RIGHT", "path": "docs/dev/setup/programming-exercises.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToxOTozN1rOHwhm3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToxOTozN1rOHwhm3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY0NDMxOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.\n          \n          \n            \n              However, changes that are saved in the online code editor but not yet commited will be lost when this folder is deleted.", "url": "https://github.com/ls1intum/Artemis/pull/2306#discussion_r520644319", "createdAt": "2020-11-10T15:19:37Z", "author": {"login": "derLalla"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+Adjustments for programming exercises\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+There are several variables that can be configured when using programming exercises.\n+They are presented in this separate page to keep the 'normal' setup guide shorter.\n+\n+\n+Path variables\n+##############\n+\n+There are variables for several paths:\n+\n+- ``artemis.repo-clone-path``\n+\n+  Repositories that the Artemis server needs are stored in this folder.\n+  This e.g. affects repositories from students which use the online code editor or the template/solution repositories of new exercises, as they are pushed to the VCS after modification.\n+\n+  Files in this directory are usually not critical, as the latest pushed version of these repositories are also stored at the VCS.\n+  However, changed that are saved in the online code editor but not yet commited will be lost when this folder is deleted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a83adac52e4326dd2e6623e33c6d00267f8031d4"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4382, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}