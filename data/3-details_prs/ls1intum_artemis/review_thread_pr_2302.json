{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTY5NzE3", "number": 2302, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNzo1MzoyNlrOE0Q7CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOTowNDozOFrOE0SX2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMjM4NjY1OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/domain/Attachment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNzo1MzoyNlrOHr5V6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOToxMjowOVrOHr7xPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5MDMxNQ==", "bodyText": "Constants.FILEPATH_ID_PLACHEOLDER has a typo. Maybe we can fix it with your PR?", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515790315", "createdAt": "2020-11-02T07:53:26Z", "author": {"login": "derLalla"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Attachment.java", "diffHunk": "@@ -83,7 +83,7 @@ public void onLoad() {\n         if (attachmentType == AttachmentType.FILE && getLecture() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getLecture().getId().toString());\n         }\n-        if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n+        else if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getAttachmentUnit().getId().toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgzMDA3OQ==", "bodyText": "Done in 9a0a229", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515830079", "createdAt": "2020-11-02T09:12:09Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Attachment.java", "diffHunk": "@@ -83,7 +83,7 @@ public void onLoad() {\n         if (attachmentType == AttachmentType.FILE && getLecture() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getLecture().getId().toString());\n         }\n-        if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n+        else if (attachmentType == AttachmentType.FILE && getAttachmentUnit() != null && link != null && link.contains(Constants.FILEPATH_ID_PLACHEOLDER)) {\n             link = link.replace(Constants.FILEPATH_ID_PLACHEOLDER, getAttachmentUnit().getId().toString());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5MDMxNQ=="}, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMjYyNDI0OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/lectureUnit.service.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOTowNDozOFrOHr7hQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwOTo0MToyMlrOHr803w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgyNTk4NQ==", "bodyText": "Casting three times doesn't look as performant as casting once, so I suggest doing something like:\nif (lectureUnit.type !== LectureUnitType.EXERCISE) {\n    return lectureUnit;\n}\nconst exercise = (lectureUnit as ExerciseUnit).exercise;\nexercise!.studentParticipations = undefinded;\nexercise!.tutorParticipations = undefined;\nreturn lectureUnit;", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515825985", "createdAt": "2020-11-02T09:04:38Z", "author": {"login": "FrankeLukas"}, "path": "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/lectureUnit.service.ts", "diffHunk": "@@ -21,6 +21,14 @@ export class LectureUnitService {\n     constructor(private httpClient: HttpClient, private attachmentService: AttachmentService, private exerciseService: ExerciseService) {}\n \n     updateOrder(lectureId: number, lectureUnits: LectureUnit[]): Observable<HttpResponse<LectureUnit[]>> {\n+        // need to remove participations from exercise units to prevent circular structure failure\n+        lectureUnits = lectureUnits.map((lectureUnit) => {\n+            if (lectureUnit.type === LectureUnitType.EXERCISE && (lectureUnit as ExerciseUnit).exercise) {\n+                (lectureUnit as ExerciseUnit).exercise!.studentParticipations = undefined;\n+                (lectureUnit as ExerciseUnit).exercise!.tutorParticipations = undefined;\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgzOTkwMQ==", "bodyText": "Do not agree the new variable is imo more of a performance hit than giving the compiler type assertions", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515839901", "createdAt": "2020-11-02T09:28:43Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/lectureUnit.service.ts", "diffHunk": "@@ -21,6 +21,14 @@ export class LectureUnitService {\n     constructor(private httpClient: HttpClient, private attachmentService: AttachmentService, private exerciseService: ExerciseService) {}\n \n     updateOrder(lectureId: number, lectureUnits: LectureUnit[]): Observable<HttpResponse<LectureUnit[]>> {\n+        // need to remove participations from exercise units to prevent circular structure failure\n+        lectureUnits = lectureUnits.map((lectureUnit) => {\n+            if (lectureUnit.type === LectureUnitType.EXERCISE && (lectureUnit as ExerciseUnit).exercise) {\n+                (lectureUnit as ExerciseUnit).exercise!.studentParticipations = undefined;\n+                (lectureUnit as ExerciseUnit).exercise!.tutorParticipations = undefined;\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgyNTk4NQ=="}, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTg0NzM5MQ==", "bodyText": "I see, that is just compile time casting, so you're right.", "url": "https://github.com/ls1intum/Artemis/pull/2302#discussion_r515847391", "createdAt": "2020-11-02T09:41:22Z", "author": {"login": "FrankeLukas"}, "path": "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/lectureUnit.service.ts", "diffHunk": "@@ -21,6 +21,14 @@ export class LectureUnitService {\n     constructor(private httpClient: HttpClient, private attachmentService: AttachmentService, private exerciseService: ExerciseService) {}\n \n     updateOrder(lectureId: number, lectureUnits: LectureUnit[]): Observable<HttpResponse<LectureUnit[]>> {\n+        // need to remove participations from exercise units to prevent circular structure failure\n+        lectureUnits = lectureUnits.map((lectureUnit) => {\n+            if (lectureUnit.type === LectureUnitType.EXERCISE && (lectureUnit as ExerciseUnit).exercise) {\n+                (lectureUnit as ExerciseUnit).exercise!.studentParticipations = undefined;\n+                (lectureUnit as ExerciseUnit).exercise!.tutorParticipations = undefined;\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTgyNTk4NQ=="}, "originalCommit": {"oid": "d03bf7794cd4b4d289194d8cd9ae18a7716f2ec2"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4377, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}