{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNTg5OTQ2", "number": 1719, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOToyMjozOFrOEMZ7aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOToyMjo1N1rOEMZ76Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNDQzMTc3OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOToyMjozOFrOGufl6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToxMDowNVrOGvIhZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwNTI5MA==", "bodyText": "This endpoint does not exist on Artemis. Would it make sense to send this to Athene directly?", "url": "https://github.com/ls1intum/Artemis/pull/1719#discussion_r451405290", "createdAt": "2020-07-08T09:22:38Z", "author": {"login": "krusche"}, "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "diffHunk": "@@ -167,4 +175,32 @@ export class TextAssessmentsService {\n                 ),\n         );\n     }\n+\n+    /**\n+     * Track the change of the Feedback in Athene\n+     *\n+     * @param submission - The submission object that holds the data that is tracked\n+     */\n+    public trackFeedback(submission: TextSubmission | null) {\n+        // clone submission and resolve circular json properties\n+        const submissionForSending = cloneDeep(submission);\n+        submissionForSending!.participation.submissions = [];\n+        submissionForSending!.participation.results.map((result) => {\n+            result.participation = null;\n+            result.submission = null;\n+        });\n+\n+        const sendObject = {\n+            textBlocks: submissionForSending?.blocks,\n+            participation: submissionForSending?.participation,\n+        };\n+\n+        if (submission!.participation?.trackingToken) {\n+            this.http\n+                .post(`${SERVER_API_URL}/athene-tracking/text-exercise-assessment}`, sendObject, {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acd37a853d9efa052dd41eb88a82863ff4a90e7e"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA3NTg3Ng==", "bodyText": "The idea is to route it via nginx directly to athene. I've added an inline comment to make this clear for every developer.", "url": "https://github.com/ls1intum/Artemis/pull/1719#discussion_r452075876", "createdAt": "2020-07-09T09:10:05Z", "author": {"login": "JonasPetry"}, "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "diffHunk": "@@ -167,4 +175,32 @@ export class TextAssessmentsService {\n                 ),\n         );\n     }\n+\n+    /**\n+     * Track the change of the Feedback in Athene\n+     *\n+     * @param submission - The submission object that holds the data that is tracked\n+     */\n+    public trackFeedback(submission: TextSubmission | null) {\n+        // clone submission and resolve circular json properties\n+        const submissionForSending = cloneDeep(submission);\n+        submissionForSending!.participation.submissions = [];\n+        submissionForSending!.participation.results.map((result) => {\n+            result.participation = null;\n+            result.submission = null;\n+        });\n+\n+        const sendObject = {\n+            textBlocks: submissionForSending?.blocks,\n+            participation: submissionForSending?.participation,\n+        };\n+\n+        if (submission!.participation?.trackingToken) {\n+            this.http\n+                .post(`${SERVER_API_URL}/athene-tracking/text-exercise-assessment}`, sendObject, {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwNTI5MA=="}, "originalCommit": {"oid": "acd37a853d9efa052dd41eb88a82863ff4a90e7e"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNDQzMzA1OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOToyMjo1N1rOGufmqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOTowOToyNFrOGvIfwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwNTQ4Mw==", "bodyText": "the if statement comes too late. I would check that first in this method", "url": "https://github.com/ls1intum/Artemis/pull/1719#discussion_r451405483", "createdAt": "2020-07-08T09:22:57Z", "author": {"login": "krusche"}, "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "diffHunk": "@@ -167,4 +175,32 @@ export class TextAssessmentsService {\n                 ),\n         );\n     }\n+\n+    /**\n+     * Track the change of the Feedback in Athene\n+     *\n+     * @param submission - The submission object that holds the data that is tracked\n+     */\n+    public trackFeedback(submission: TextSubmission | null) {\n+        // clone submission and resolve circular json properties\n+        const submissionForSending = cloneDeep(submission);\n+        submissionForSending!.participation.submissions = [];\n+        submissionForSending!.participation.results.map((result) => {\n+            result.participation = null;\n+            result.submission = null;\n+        });\n+\n+        const sendObject = {\n+            textBlocks: submissionForSending?.blocks,\n+            participation: submissionForSending?.participation,\n+        };\n+\n+        if (submission!.participation?.trackingToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acd37a853d9efa052dd41eb88a82863ff4a90e7e"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA3NTQ1Nw==", "bodyText": "Done", "url": "https://github.com/ls1intum/Artemis/pull/1719#discussion_r452075457", "createdAt": "2020-07-09T09:09:24Z", "author": {"login": "JonasPetry"}, "path": "src/main/webapp/app/exercises/text/assess/text-assessments.service.ts", "diffHunk": "@@ -167,4 +175,32 @@ export class TextAssessmentsService {\n                 ),\n         );\n     }\n+\n+    /**\n+     * Track the change of the Feedback in Athene\n+     *\n+     * @param submission - The submission object that holds the data that is tracked\n+     */\n+    public trackFeedback(submission: TextSubmission | null) {\n+        // clone submission and resolve circular json properties\n+        const submissionForSending = cloneDeep(submission);\n+        submissionForSending!.participation.submissions = [];\n+        submissionForSending!.participation.results.map((result) => {\n+            result.participation = null;\n+            result.submission = null;\n+        });\n+\n+        const sendObject = {\n+            textBlocks: submissionForSending?.blocks,\n+            participation: submissionForSending?.participation,\n+        };\n+\n+        if (submission!.participation?.trackingToken) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwNTQ4Mw=="}, "originalCommit": {"oid": "acd37a853d9efa052dd41eb88a82863ff4a90e7e"}, "originalPosition": 73}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4919, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}