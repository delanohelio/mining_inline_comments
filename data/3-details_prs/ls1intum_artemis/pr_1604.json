{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNjAwNTY1", "number": 1604, "title": "Chore/content version header", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I added multiple integration tests (Spring) related to the features\n Server: I added @PreAuthorize and check the course groups for all new REST Calls (security)\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n\nMotivation and Context\nAfter deploying new versions, we encounter some exceptions because old clients are still loaded with some users.\nDescription\nWith the PR, we expose the Server Artemis Version in the Content-Version header. We can use this in a second step to check in the client if it is up-to-date or needs to be reloaded.\nSteps for Testing\n\nLog in to Artemis\nOpen Web inspector and find headers of any http request to Artemis\nFind Artemis Version in Content-Version header", "createdAt": "2020-06-09T07:47:30Z", "url": "https://github.com/ls1intum/Artemis/pull/1604", "merged": true, "mergeCommit": {"oid": "24e3c9b9c46eca720f88ad3268f03a1afcb38b11"}, "closed": true, "closedAt": "2020-06-22T09:21:09Z", "author": {"login": "jpbernius"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpfvWOgH2gAyNDMxNjAwNTY1OjA1NTdhYTllODg4OWY2MmE2ZTFmNTRhMDhkZDVjMzRkMTJlZDAyNWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABctsdLXAFqTQzNDcwMTg3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0557aa9e8889f62a6e1f54a08dd5c34d12ed025f", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/0557aa9e8889f62a6e1f54a08dd5c34d12ed025f", "committedDate": "2020-06-09T07:15:45Z", "message": "Expose Artemis Version in Content-Version Header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78d6b27c0419154146e6893aea81b7027fedff25", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/78d6b27c0419154146e6893aea81b7027fedff25", "committedDate": "2020-06-09T07:15:45Z", "message": "Add Tests\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c9eddf2d8c8cadf20f17dfd6a95aedffbd34507", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/2c9eddf2d8c8cadf20f17dfd6a95aedffbd34507", "committedDate": "2020-06-09T07:44:13Z", "message": "Add documentation\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb67f419648c20bda260a96730393899f812edf", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/9eb67f419648c20bda260a96730393899f812edf", "committedDate": "2020-06-09T07:48:47Z", "message": "Merge branch 'develop' into chore/Content-Version-header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5293a79e8cb4d7b89f0a029cc9c3cabb02126ead", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/5293a79e8cb4d7b89f0a029cc9c3cabb02126ead", "committedDate": "2020-06-09T09:45:12Z", "message": "Add API Version filter before all other filters.\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "939b4ce510f268946c3bb22b53efde0200d1fc88", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/939b4ce510f268946c3bb22b53efde0200d1fc88", "committedDate": "2020-06-09T09:45:45Z", "message": "Merge branch 'develop' into chore/Content-Version-header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d0bdd24fb117531019313b603d1ad7f3cf857ba", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/3d0bdd24fb117531019313b603d1ad7f3cf857ba", "committedDate": "2020-06-16T11:44:58Z", "message": "Merge branch 'develop' into chore/Content-Version-header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75baa4712f32cf1a71e678a02acb15db1bd97ad8", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/75baa4712f32cf1a71e678a02acb15db1bd97ad8", "committedDate": "2020-06-16T18:32:14Z", "message": "Improve Tests & Simplify Config\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6268cced46c1158f1a1da45c9935b7ef788f463c", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/6268cced46c1158f1a1da45c9935b7ef788f463c", "committedDate": "2020-06-16T18:33:04Z", "message": "Merge branch 'develop' into chore/Content-Version-header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8024195cb5b5b5f6421068e4f758a21f8967057f", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/8024195cb5b5b5f6421068e4f758a21f8967057f", "committedDate": "2020-06-16T20:08:13Z", "message": "Show Outdated Warning in Client\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fee6b86613d8c3284f712bf1ad689912ab9c378", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/3fee6b86613d8c3284f712bf1ad689912ab9c378", "committedDate": "2020-06-16T20:28:08Z", "message": "Remove @Profile(\"artemis\")\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e27100c30b661e798dd1f5ac64d28712ce22e2f", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/2e27100c30b661e798dd1f5ac64d28712ce22e2f", "committedDate": "2020-06-16T20:28:37Z", "message": "Merge branch 'develop' into chore/Content-Version-header"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxOTA2OTIy", "url": "https://github.com/ls1intum/Artemis/pull/1604#pullrequestreview-431906922", "createdAt": "2020-06-16T21:31:21Z", "commit": {"oid": "2e27100c30b661e798dd1f5ac64d28712ce22e2f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQyMTozMToyMVrOGkt6Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQyMTozMToyMVrOGkt6Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE1NDExNA==", "bodyText": "Unfortunately, most Server Tests fail with the current implementation. When removing the conformance to the Filter interface, all tests pass al the sudden.\npublic class ApiVersionFilter {\n\nI cannot understand why this is the case. Maybe someone can help here?", "url": "https://github.com/ls1intum/Artemis/pull/1604#discussion_r441154114", "createdAt": "2020-06-16T21:31:21Z", "author": {"login": "jpbernius"}, "path": "src/main/java/de/tum/in/www1/artemis/config/ApiVersionFilter.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package de.tum.in.www1.artemis.config;\n+\n+import java.io.IOException;\n+\n+import javax.servlet.Filter;\n+import javax.servlet.FilterChain;\n+import javax.servlet.ServletException;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletResponse;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class ApiVersionFilter implements Filter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e27100c30b661e798dd1f5ac64d28712ce22e2f"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01a25c9d6a46c11d84e7696206d70bf68f9e7b7a", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/01a25c9d6a46c11d84e7696206d70bf68f9e7b7a", "committedDate": "2020-06-16T21:36:00Z", "message": "Maybe fix failing Tests\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMTg3OTUy", "url": "https://github.com/ls1intum/Artemis/pull/1604#pullrequestreview-433187952", "createdAt": "2020-06-18T11:25:48Z", "commit": {"oid": "c64a8c0e6662d68fea8dc8a16c937a8b612cf9e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMToyNTo0OFrOGlrEKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMToyNTo0OFrOGlrEKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE1NjA3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.showAlert.pipe(throttleTime(2000)).subscribe(() => alertService.addAlert({ type: 'info', msg: 'artemisApp.outdatedAlert', timeout: 30000 }, []));\n          \n          \n            \n                    this.showAlert.pipe(throttleTime(10000)).subscribe(() => alertService.addAlert({ type: 'info', msg: 'artemisApp.outdatedAlert', timeout: 30000 }, []));", "url": "https://github.com/ls1intum/Artemis/pull/1604#discussion_r442156074", "createdAt": "2020-06-18T11:25:48Z", "author": {"login": "krusche"}, "path": "src/main/webapp/app/core/interceptor/artemis-version.interceptor.ts", "diffHunk": "@@ -0,0 +1,28 @@\n+import { Injectable } from '@angular/core';\n+import { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest, HttpResponse } from '@angular/common/http';\n+import { Observable, Subject } from 'rxjs';\n+import { tap, throttleTime } from 'rxjs/operators';\n+import { ARTEMIS_VERSION_HEADER, VERSION } from 'app/app.constants';\n+import { AlertService } from 'app/core/alert/alert.service';\n+\n+@Injectable()\n+export class ArtemisVersionInterceptor implements HttpInterceptor {\n+    private showAlert = new Subject();\n+\n+    constructor(alertService: AlertService) {\n+        this.showAlert.pipe(throttleTime(2000)).subscribe(() => alertService.addAlert({ type: 'info', msg: 'artemisApp.outdatedAlert', timeout: 30000 }, []));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c64a8c0e6662d68fea8dc8a16c937a8b612cf9e2"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b744e95bd804fe5ec7b38da55e0d82c772237d96", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/b744e95bd804fe5ec7b38da55e0d82c772237d96", "committedDate": "2020-06-19T14:35:42Z", "message": "Merge branch 'develop' into chore/Content-Version-header\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34d61cab6f2881702c56ee8e6eaaa8dcd0e6a1cf", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/34d61cab6f2881702c56ee8e6eaaa8dcd0e6a1cf", "committedDate": "2020-06-19T14:55:50Z", "message": "Add Database Reset\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb91fa6abae0943bedbee05f71e4f793ca3fd380", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/fb91fa6abae0943bedbee05f71e4f793ca3fd380", "committedDate": "2020-06-19T11:39:02Z", "message": "Merge branch 'develop' into chore/Content-Version-header\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}, "afterCommit": {"oid": "34d61cab6f2881702c56ee8e6eaaa8dcd0e6a1cf", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/34d61cab6f2881702c56ee8e6eaaa8dcd0e6a1cf", "committedDate": "2020-06-19T14:55:50Z", "message": "Add Database Reset\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b936ddfdbdbeb41c39d95221e4ee478b3ed880ec", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/b936ddfdbdbeb41c39d95221e4ee478b3ed880ec", "committedDate": "2020-06-19T15:05:27Z", "message": "Update src/main/webapp/app/core/interceptor/artemis-version.interceptor.ts\n\nCo-authored-by: Stephan Krusche <krusche@in.tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4bf752f4ac442428dd85c2ba801c763a6d82e4e", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/a4bf752f4ac442428dd85c2ba801c763a6d82e4e", "committedDate": "2020-06-19T16:36:16Z", "message": "Remove unused import\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0Njk5NzU3", "url": "https://github.com/ls1intum/Artemis/pull/1604#pullrequestreview-434699757", "createdAt": "2020-06-22T08:17:29Z", "commit": {"oid": "a4bf752f4ac442428dd85c2ba801c763a6d82e4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwODoxNzoyOVrOGm2Y-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwODoxNzoyOVrOGm2Y-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM5MDIwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"outdatedAlert\": \"<b>Outdated Artemis Version:</b> You are using an outdated Artemis version. Please refresh the page to prevent incompatibilities.\"\n          \n          \n            \n                    \"outdatedAlert\": \"<b>Your Artemis version is outdated:</b> Please reload the browser page to prevent incompatibilities.\"", "url": "https://github.com/ls1intum/Artemis/pull/1604#discussion_r443390200", "createdAt": "2020-06-22T08:17:29Z", "author": {"login": "krusche"}, "path": "src/main/webapp/i18n/en/alert.json", "diffHunk": "@@ -4,6 +4,7 @@\n             \"alert\": \"Alert\",\n             \"disconnected\": \"You are not connected to the Artemis Server. Please check your internet connection.\",\n             \"reconnected\": \"You were reconnected to the Artemis Server.\"\n-        }\n+        },\n+        \"outdatedAlert\": \"<b>Outdated Artemis Version:</b> You are using an outdated Artemis version. Please refresh the page to prevent incompatibilities.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4bf752f4ac442428dd85c2ba801c763a6d82e4e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NzAxNTQ2", "url": "https://github.com/ls1intum/Artemis/pull/1604#pullrequestreview-434701546", "createdAt": "2020-06-22T08:19:54Z", "commit": {"oid": "a4bf752f4ac442428dd85c2ba801c763a6d82e4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwODoxOTo1NFrOGm2eAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwODoxOTo1NFrOGm2eAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM5MTQ5MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"outdatedAlert\": \"<b>Veraltete Artemis Version:</b> Du benutzt eine alte Artemis Version. Bitte aktualisiere die Seite um Inkompatibilit\u00e4ten zu vermeiden.\"\n          \n          \n            \n                    \"outdatedAlert\": \"<b>Deine Artemis Version ist veraltet:</b> Bitte lade die Browser Seite neu um Inkompatibilit\u00e4ten zu vermeiden.\"", "url": "https://github.com/ls1intum/Artemis/pull/1604#discussion_r443391491", "createdAt": "2020-06-22T08:19:54Z", "author": {"login": "krusche"}, "path": "src/main/webapp/i18n/de/alert.json", "diffHunk": "@@ -4,6 +4,7 @@\n             \"alert\": \"Achtung\",\n             \"disconnected\": \"Du bist nicht mehr mit dem Artemis Server verbunden. Bitte \u00fcberpr\u00fcfe deine Internet Verbindung.\",\n             \"reconnected\": \"Du bist wieder mit dem Artemis Server verbunden.\"\n-        }\n+        },\n+        \"outdatedAlert\": \"<b>Veraltete Artemis Version:</b> Du benutzt eine alte Artemis Version. Bitte aktualisiere die Seite um Inkompatibilit\u00e4ten zu vermeiden.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4bf752f4ac442428dd85c2ba801c763a6d82e4e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "319374f4faefa1133c2b5d6e925185b0b86b8f18", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/319374f4faefa1133c2b5d6e925185b0b86b8f18", "committedDate": "2020-06-22T08:20:15Z", "message": "improve alert message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NzAxODcz", "url": "https://github.com/ls1intum/Artemis/pull/1604#pullrequestreview-434701873", "createdAt": "2020-06-22T08:20:22Z", "commit": {"oid": "319374f4faefa1133c2b5d6e925185b0b86b8f18"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2780, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}