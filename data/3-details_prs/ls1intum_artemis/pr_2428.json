{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMzk3MTAx", "number": 2428, "title": "isolated modules should reduce testing time of client tests", "bodyText": "Description\n\nThis PR adds a new test script to packages.json to run on CI. In this test script some configs are enabled which increase the test performance.\nI also removed jasmine from the dependencies. Since we are using jest, we should not additionally require jasmine.\nWe used jasmine for the mock classes and sometimes to compare results to expected results. Jest also provides both these functionalities. The mock classes are now extending SinonStubs.\nisolatedModules:\n\nThis change drastically reduces the testing time, BUT we loose type checking capability.\nhttps://github.com/kulshekhar/ts-jest/blob/master/docs/user/config/isolatedModules.md\n\nreduces jest worker:\n\nw=1 seems to improve the performance on github actions by ~4min\n\nRelated jest issues:\n\nfacebook/jest#7874\n\nSteps for Testing\nReview the Code\nScreenshots", "createdAt": "2020-11-18T18:45:07Z", "url": "https://github.com/ls1intum/Artemis/pull/2428", "merged": true, "mergeCommit": {"oid": "b804f6f04d2410f3abb216660e728d0afe9c2739"}, "closed": true, "closedAt": "2020-11-26T17:07:22Z", "author": {"login": "TobiasPr"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddyFh-AH2gAyNTIzMzk3MTAxOjhkOGJhODk1ZmY1NTMzZWFhMDFlZDAyNTBkMGM2N2JmYTYzM2NlYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgWFA6AFqTUzOTQ3MDI4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8d8ba895ff5533eaa01ed0250d0c67bfa633ceaf", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/8d8ba895ff5533eaa01ed0250d0c67bfa633ceaf", "committedDate": "2020-11-18T18:02:20Z", "message": "isolated modules should reduce testing time of client tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38328214c3c69185e4598df5c0085a2c0e0c27c1", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/38328214c3c69185e4598df5c0085a2c0e0c27c1", "committedDate": "2020-11-19T08:36:32Z", "message": "test other configuration on bamboo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "469ce49e1b3ad6295042d94da2d40b88482dbeaa", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/469ce49e1b3ad6295042d94da2d40b88482dbeaa", "committedDate": "2020-11-19T09:10:18Z", "message": "Merge branch 'develop' into bugfix/client-test-performance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "badfaba94459ed146f5850596a9346e62a61a18c", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/badfaba94459ed146f5850596a9346e62a61a18c", "committedDate": "2020-11-22T15:13:45Z", "message": "remove jasmine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22e87bfe18122512666fcab4bb0c04321355ac08", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/22e87bfe18122512666fcab4bb0c04321355ac08", "committedDate": "2020-11-22T17:19:47Z", "message": "Merge branch 'develop' into bugfix/client-test-performance\n\n# Conflicts:\n#\tpackage.json\n#\tyarn.lock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a45fbaeb63f8ee100c9482c3ca69fd5b8d827d55", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/a45fbaeb63f8ee100c9482c3ca69fd5b8d827d55", "committedDate": "2020-11-22T17:27:59Z", "message": "remove ace.acequire from code -> faster execution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21945e6be452ec5aba2d7b8a8e4d88bb86dc67dc", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/21945e6be452ec5aba2d7b8a8e4d88bb86dc67dc", "committedDate": "2020-11-23T20:57:25Z", "message": "test run in band on bamboo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdca95546691b8069986d30cdd1dc097d32c5785", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/bdca95546691b8069986d30cdd1dc097d32c5785", "committedDate": "2020-11-23T21:19:14Z", "message": "test run in band on github"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8976e1c80ebed67faeba88f21d811603a38a5c15", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/8976e1c80ebed67faeba88f21d811603a38a5c15", "committedDate": "2020-11-23T21:22:54Z", "message": "test run in band on github"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca276f94fbc564f05f3977621ec7d415f935b0ce", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/ca276f94fbc564f05f3977621ec7d415f935b0ce", "committedDate": "2020-11-23T21:57:13Z", "message": "test without ace statement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97cf34d1c50d5293a795b613f137c4fa534a4f1c", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/97cf34d1c50d5293a795b613f137c4fa534a4f1c", "committedDate": "2020-11-24T10:44:31Z", "message": "add ci testing command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec2af0d14ad9df92c441b4f921dac7d287ec8678", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/ec2af0d14ad9df92c441b4f921dac7d287ec8678", "committedDate": "2020-11-24T10:49:47Z", "message": "use ci jest config when testing on ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b558ab8630a17a5c0084a447ba70fd208b390ea", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/4b558ab8630a17a5c0084a447ba70fd208b390ea", "committedDate": "2020-11-24T12:17:26Z", "message": "Merge branch 'develop' into bugfix/client-test-performance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "301f9172624e035033c6fe398c3116f5b948ec9f", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/301f9172624e035033c6fe398c3116f5b948ec9f", "committedDate": "2020-11-25T07:36:37Z", "message": "update jest-cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e4cd24a1ed8b767edd491565ab3a77c73638fad", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/9e4cd24a1ed8b767edd491565ab3a77c73638fad", "committedDate": "2020-11-25T07:39:50Z", "message": "Merge branch 'develop' into bugfix/client-test-performance\n\n# Conflicts:\n#\tpackage.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bb3473af1749f7eedc7485a4c10ddf33e09bf4f", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/9bb3473af1749f7eedc7485a4c10ddf33e09bf4f", "committedDate": "2020-11-25T07:52:31Z", "message": "test impact of test coverage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbdcb1dd8d7e6563c8565bd230ec15ea115806c8", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/dbdcb1dd8d7e6563c8565bd230ec15ea115806c8", "committedDate": "2020-11-25T07:57:35Z", "message": "revert changes to ace in integration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfc8c9c407d9158cc6e429faefaf1e14a126b182", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/dfc8c9c407d9158cc6e429faefaf1e14a126b182", "committedDate": "2020-11-25T08:05:58Z", "message": "revert changes to ace in integration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eff6103fc42da07059c9d465737bd7888cb1a165", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/eff6103fc42da07059c9d465737bd7888cb1a165", "committedDate": "2020-11-25T08:18:56Z", "message": "remove duplication from jest.config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7377dd8bf8bd30b713173b486569f06b02665ee", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/e7377dd8bf8bd30b713173b486569f06b02665ee", "committedDate": "2020-11-25T08:38:15Z", "message": "correct path in require"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae06c24989a9dc852f9f052d5ee846d40755ffa2", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/ae06c24989a9dc852f9f052d5ee846d40755ffa2", "committedDate": "2020-11-25T09:21:31Z", "message": "remove jest-cache from workflow as it did not work as expected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d6dfa96786dbdd7193019c808095c7114f8dd4d", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/9d6dfa96786dbdd7193019c808095c7114f8dd4d", "committedDate": "2020-11-25T10:17:20Z", "message": "update github actions - separate client-tests-fast from client-tests -> separate check is more visible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe9ecec078da63b572a34c8178d8880f4d0bb91a", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/fe9ecec078da63b572a34c8178d8880f4d0bb91a", "committedDate": "2020-11-25T11:20:47Z", "message": "update github actions - remove coverage report from second workflow (included in fast test)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b9c4f40f621c173a7033146ec7a53702e5dfc1f", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/8b9c4f40f621c173a7033146ec7a53702e5dfc1f", "committedDate": "2020-11-25T12:04:45Z", "message": "remove sinon imports from files in which it is not used"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NjAzMjMz", "url": "https://github.com/ls1intum/Artemis/pull/2428#pullrequestreview-538603233", "createdAt": "2020-11-25T15:18:24Z", "commit": {"oid": "8b9c4f40f621c173a7033146ec7a53702e5dfc1f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxNToxODoyNFrOH54Ifw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxNToxODoyNFrOH54Ifw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQ1MDU1OQ==", "bodyText": "This step shows failing tests in PRs in the Files Tab. Was this omitted on purpose?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      run: yarn test --ci\n          \n          \n            \n                      run: yarn test --ci\n          \n          \n            \n                    - name: Annotate Client Test Results\n          \n          \n            \n                       uses: ashley-taylor/junit-report-annotations-action@9ac2f823854c677f30e062dfe779445e33e5d380\n          \n          \n            \n                       if: always()\n          \n          \n            \n                       with:\n          \n          \n            \n                           access-token: ${{ secrets.GITHUB_TOKEN }}\n          \n          \n            \n                           path: junit.xml\n          \n          \n            \n                           numFailures: 99", "url": "https://github.com/ls1intum/Artemis/pull/2428#discussion_r530450559", "createdAt": "2020-11-25T15:18:24Z", "author": {"login": "jpbernius"}, "path": ".github/workflows/test.yml", "diffHunk": "@@ -77,38 +77,58 @@ jobs:\n       run: ./gradlew checkstyleMain -x yarn -x webpack\n       if: success() || failure()\n \n+  client-tests-fast:\n+    runs-on: ubuntu-latest\n+    steps:\n+        - name: Setup Node.js\n+          uses: actions/setup-node@v1\n+          with:\n+              node-version: '${{ env.node }}'\n+        - uses: actions/checkout@v2\n+        - name: Cache node modules\n+          uses: actions/cache@v2\n+          with:\n+              path: node_modules\n+              key: ${{ runner.os }}-node_modules-${{ hashFiles('**/yarn.lock') }}\n+              restore-keys: |\n+                  ${{ runner.os }}-node_modules-\n+        - name: Install Dependencies\n+          run: yarn install\n+        - name: Fast TypeScript Test without Typechecking\n+          run: yarn test:ci --ci\n+        - name: \"Codacy: Report coverage\"\n+          uses: codacy/codacy-coverage-reporter-action@master\n+          with:\n+              project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}\n+              coverage-reports: coverage/lcov.info\n+          if: (github.event.pull_request.head.repo.full_name == github.event.pull_request.base.repo.full_name) && (success() || failure())\n+        - name: Annotate Client Test Results\n+          uses: ashley-taylor/junit-report-annotations-action@9ac2f823854c677f30e062dfe779445e33e5d380\n+          if: always()\n+          with:\n+              access-token: ${{ secrets.GITHUB_TOKEN }}\n+              path: junit.xml\n+              numFailures: 99\n+\n   client-tests:\n     runs-on: ubuntu-latest\n     steps:\n-    - name: Setup Node.js\n-      uses: actions/setup-node@v1\n-      with:\n-        node-version: '${{ env.node }}'\n-    - uses: actions/checkout@v2\n-    - name: Cache node modules\n-      uses: actions/cache@v2\n-      with:\n-        path: node_modules\n-        key: ${{ runner.os }}-node_modules-${{ hashFiles('**/yarn.lock') }}\n-        restore-keys: |\n-          ${{ runner.os }}-node_modules-\n-    - name: Install Dependencies\n-      run: yarn install\n-    - name: TypeScript Tests\n-      run: yarn test:coverage --ci\n-    - name: \"Codacy: Report coverage\"\n-      uses: codacy/codacy-coverage-reporter-action@master\n-      with:\n-          project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}\n-          coverage-reports: coverage/lcov.info\n-      if: (github.event.pull_request.head.repo.full_name == github.event.pull_request.base.repo.full_name) && (success() || failure())\n-    - name: Annotate Client Test Results\n-      uses: ashley-taylor/junit-report-annotations-action@9ac2f823854c677f30e062dfe779445e33e5d380\n-      if: always()\n-      with:\n-        access-token: ${{ secrets.GITHUB_TOKEN }}\n-        path: junit.xml\n-        numFailures: 99\n+        - name: Setup Node.js\n+          uses: actions/setup-node@v1\n+          with:\n+              node-version: '${{ env.node }}'\n+        - uses: actions/checkout@v2\n+        - name: Cache node modules\n+          uses: actions/cache@v2\n+          with:\n+              path: node_modules\n+              key: ${{ runner.os }}-node_modules-${{ hashFiles('**/yarn.lock') }}\n+              restore-keys: |\n+                  ${{ runner.os }}-node_modules-\n+        - name: Install Dependencies\n+          run: yarn install\n+        - name: TypeScript Test With Typechecking\n+          run: yarn test --ci", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b9c4f40f621c173a7033146ec7a53702e5dfc1f"}, "originalPosition": 84}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a321a08bb9081214fa5cdf4a5e7934831e72515", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/2a321a08bb9081214fa5cdf4a5e7934831e72515", "committedDate": "2020-11-26T10:52:11Z", "message": "add test annotation to \"slow\" client test run\n\nCo-authored-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MjYwODEx", "url": "https://github.com/ls1intum/Artemis/pull/2428#pullrequestreview-539260811", "createdAt": "2020-11-26T12:11:50Z", "commit": {"oid": "2a321a08bb9081214fa5cdf4a5e7934831e72515"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e19642e1662dd783784bf6d68a8d6d928df09847", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/e19642e1662dd783784bf6d68a8d6d928df09847", "committedDate": "2020-11-26T15:58:46Z", "message": "reformat"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDU0ODE4", "url": "https://github.com/ls1intum/Artemis/pull/2428#pullrequestreview-539454818", "createdAt": "2020-11-26T16:38:32Z", "commit": {"oid": "e19642e1662dd783784bf6d68a8d6d928df09847"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDcwMjg5", "url": "https://github.com/ls1intum/Artemis/pull/2428#pullrequestreview-539470289", "createdAt": "2020-11-26T17:06:12Z", "commit": {"oid": "e19642e1662dd783784bf6d68a8d6d928df09847"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3683, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}