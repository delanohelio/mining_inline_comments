{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMjM5MDAy", "number": 2507, "title": "[Enhancement] multiple results for submissions in client", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I followed the coding and design guidelines.\n Server: I documented the Java code using JavaDoc style.\n Client: I followed the coding and design guidelines.\n Client: I documented the TypeScript code using JSDoc style.\n\nEDIT:\nThis PR does not contain the changes to remove the function calls of getLatestSubmissionResult() within the HTML. This will be resolved in another PR later next week. Please ignore it for now, thanks!\nMotivation and Context\nThis PR is a continuation of https://github.com/ls1intum/Artemis/pull/2481 where the relationship between Submission and Results was changed in the database. Here the change in relationship is inserted in the client too, but no functional change yet.\n\nto\n\nDescription\n\nChange the single result  in Submission(submission.model.ts) to an array:\n\nresult?: Result;-> results?: Result[];\n\n\nAdd getLatestSubmissionResult() to get the latest result from the results list, so no functionality is changed. At the moment, at any given place the list must only contain a maximum of one element.\nPerform the necessary code changes across the application to support the change in Submission\nPerform changes to methods in Submission.java: fixed setter and getter for JSON serialization and deserialization, refactoring all setResult(s) methods\n\nSteps for Testing\nThere are no functional changes. The goal is to have everything working as usual. Therefore, we must test every aspect of the application that was affected by these changes. These include:\n\n\nCreating Text-, Modeling-, File Upload-, Quiz-, and Programming Exercises\n\nAdd Example Submission with a solution for modeling exercises only! (for text exercises there is a bug unrelated to this PR)\n\n\n\nCreating Exam\n\nWith all exercise types\n\n\n\nParticipating in Text-, Modeling-, File Upload-, Quiz-, and Programming Exercises\n\nConfigure automatic programming assessment\n\n\n\nParticipating in Exam\n\n\nConducting a Test Run\n\nParticipate\n\n\n\nAssessing Text-, Modeling-, File Upload-, Quiz-, and Programming Exercises\n\nLocking\nOverriding\nSubmitting\nAlso for exam exercises\n\n\n\nComplaining about the Assessment\n\nComplaint\nMore Feedback Request\n\n\n\nReviewing Complaint\n\nAccepting Complaint\nRejecting Complaint\n\n\n\nTest Coverage\nThere are no changes on the test coverage.", "createdAt": "2020-12-06T17:57:53Z", "url": "https://github.com/ls1intum/Artemis/pull/2507", "merged": true, "mergeCommit": {"oid": "6eb5c9e16d175fa4466c5392ac4b232d375408cc"}, "closed": true, "closedAt": "2020-12-12T01:21:31Z", "author": {"login": "SimonEntholzer"}, "timelineItems": {"totalCount": 75, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi4GbfAH2gAyNTMzMjM5MDAyOjlkZWM4ZGFmZWU2MDAyNjgwNmI0ZDQ5MGJjYjE2MWE5N2UwZjAyMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlSJpuAFqTU1MDY3Mjg3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9dec8dafee60026806b4d490bcb161a97e0f0210", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/9dec8dafee60026806b4d490bcb161a97e0f0210", "committedDate": "2020-12-04T13:52:22Z", "message": "result \u2014> results\n\nalso add functions for getLatestResult and getLatestResult"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7eb926c754135104f0b40331971cc3ac6628595", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/a7eb926c754135104f0b40331971cc3ac6628595", "committedDate": "2020-12-06T09:56:40Z", "message": "fixed first files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "365150e4972a9769764a6f58133027e50985c130", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/365150e4972a9769764a6f58133027e50985c130", "committedDate": "2020-12-06T11:15:09Z", "message": "fixed some more tests, added testing check function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c4eabb7ebaccc9bbedaff2d6995e7197e381d3c", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/7c4eabb7ebaccc9bbedaff2d6995e7197e381d3c", "committedDate": "2020-12-06T11:49:31Z", "message": "fixed some more errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4575306e05490ff40f59bb09f139c8f3d4da9dc6", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/4575306e05490ff40f59bb09f139c8f3d4da9dc6", "committedDate": "2020-12-06T11:56:40Z", "message": "fixed some more errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fba7acdcda5f6aa5532e5fc6937d2f09770f120", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/8fba7acdcda5f6aa5532e5fc6937d2f09770f120", "committedDate": "2020-12-06T12:23:43Z", "message": "fixed errors in spec file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03b5a91f9bfae7776b635996834cdd37a6e34ec2", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/03b5a91f9bfae7776b635996834cdd37a6e34ec2", "committedDate": "2020-12-06T12:33:54Z", "message": "fixed errors in spec files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d158a8fd3a221fc40598ee1cec744683f2bbe22c", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/d158a8fd3a221fc40598ee1cec744683f2bbe22c", "committedDate": "2020-12-06T12:46:26Z", "message": "fixed errors in spec files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbab381ab9ebecdc08c886ed3677aefa8522ab12", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/fbab381ab9ebecdc08c886ed3677aefa8522ab12", "committedDate": "2020-12-06T12:46:37Z", "message": "first try at fixed occurrences of submission.result"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fdcbbdbfd8721abb5b34e3ef0be2c8c5f166c16", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/2fdcbbdbfd8721abb5b34e3ef0be2c8c5f166c16", "committedDate": "2020-12-06T12:46:58Z", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ee22031e26821868b04d7a8dbe06d2adae81c9a", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/1ee22031e26821868b04d7a8dbe06d2adae81c9a", "committedDate": "2020-12-06T13:02:26Z", "message": "fixed spec tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edde474f0ebe9a73047c7706f7dcc7a5a8785e49", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/edde474f0ebe9a73047c7706f7dcc7a5a8785e49", "committedDate": "2020-12-06T13:09:36Z", "message": "fixed bad condition in checkForResultsLength()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ae8ff5944940cb6c24967f607a871155e883916", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/0ae8ff5944940cb6c24967f607a871155e883916", "committedDate": "2020-12-06T13:11:14Z", "message": "typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51bee81bc076fb131cd4d8de4328dd8173e50201", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/51bee81bc076fb131cd4d8de4328dd8173e50201", "committedDate": "2020-12-06T13:46:28Z", "message": "fixed spec test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "640dead070589345a3645b68706b13c4736862f1", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/640dead070589345a3645b68706b13c4736862f1", "committedDate": "2020-12-06T18:37:56Z", "message": "Revert \"fixed some more errors\"\n\nThis reverts commit 4575306e05490ff40f59bb09f139c8f3d4da9dc6."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40707ce32c1c4f2e12f824aa96f7bac10f978633", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/40707ce32c1c4f2e12f824aa96f7bac10f978633", "committedDate": "2020-12-06T18:43:13Z", "message": "put changes back"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34767e6f13a9bbc0bcfa185058f4b75e48269b2e", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/34767e6f13a9bbc0bcfa185058f4b75e48269b2e", "committedDate": "2020-12-06T20:06:47Z", "message": "fixed last failing test in modeling-assessment-editor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf8db352966de339edc60ac550fde4fa9538e019", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/cf8db352966de339edc60ac550fde4fa9538e019", "committedDate": "2020-12-06T20:54:32Z", "message": "changes to meet client code style guidlines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86376bcb5bc53e40b20b9cfca2dbac11f894fac1", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/86376bcb5bc53e40b20b9cfca2dbac11f894fac1", "committedDate": "2020-12-06T21:01:44Z", "message": "Fix html issues by importing function to component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f98ba4737712820021b999e910f6d06971e1389a", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/f98ba4737712820021b999e910f6d06971e1389a", "committedDate": "2020-12-06T21:09:46Z", "message": "added missing import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9af55970679344ca9adf963d0872147cb504dbce", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/9af55970679344ca9adf963d0872147cb504dbce", "committedDate": "2020-12-06T21:42:57Z", "message": "fixed errors in html files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "428a22a3d37a8644a4323c96215dda05dede4a81", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/428a22a3d37a8644a4323c96215dda05dede4a81", "committedDate": "2020-12-06T21:43:32Z", "message": "fixed warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1674b2bfa71da77c782f28d9a0337f49df46fc6c", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/1674b2bfa71da77c782f28d9a0337f49df46fc6c", "committedDate": "2020-12-06T22:15:31Z", "message": "tried fixing build issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d559a1816231e5a7b33264b5c39c3f01e061a53f", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/d559a1816231e5a7b33264b5c39c3f01e061a53f", "committedDate": "2020-12-06T22:32:47Z", "message": "fixed last errors in html files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d40f85febb98261ab43bba0ea3b526316c2d30d7", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/d40f85febb98261ab43bba0ea3b526316c2d30d7", "committedDate": "2020-12-06T22:34:23Z", "message": "Revert \"fixed last errors in html files\"\n\nThis reverts commit d559a181"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068d4de4fa37ce1c44086eb83a0c1c68ddc3e226", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/068d4de4fa37ce1c44086eb83a0c1c68ddc3e226", "committedDate": "2020-12-08T01:01:19Z", "message": "changed JSON handling in Submission.java, and refactored getResult() to getLatestResult()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4f4667f6f14b128dd850d7b05aa9a45755748dc", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/e4f4667f6f14b128dd850d7b05aa9a45755748dc", "committedDate": "2020-12-08T08:05:23Z", "message": "changed JSON handling, to fix deserialization errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffe577edce65ae0662074b49e1482873ed7e96d5", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/ffe577edce65ae0662074b49e1482873ed7e96d5", "committedDate": "2020-12-08T10:27:30Z", "message": "fixed test fails because of missing 's' in result(s)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb65f4332f31736510c204315a058947fac4abf", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/9eb65f4332f31736510c204315a058947fac4abf", "committedDate": "2020-12-08T16:29:25Z", "message": "refactored setResult(s) Methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "761327180af3f764fce2cc6b89d6e5875930bb0d", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/761327180af3f764fce2cc6b89d6e5875930bb0d", "committedDate": "2020-12-08T17:24:16Z", "message": "refactored setResult to replaceLatestOrIfEmptyAddResult"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "063bd8a967ca4a83575c7c5ed307ba06b0ba4429", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/063bd8a967ca4a83575c7c5ed307ba06b0ba4429", "committedDate": "2020-12-08T18:43:08Z", "message": "fixed client issues with relations via method setLatestResultMethod"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d74f49716e468b2e43442094d34ece94698694c3", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/d74f49716e468b2e43442094d34ece94698694c3", "committedDate": "2020-12-08T22:56:52Z", "message": "added some documentation about function use, fixed inconsistencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db386a68561aa554e691063c5ecd49dbb476a3e1", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/db386a68561aa554e691063c5ecd49dbb476a3e1", "committedDate": "2020-12-09T07:52:48Z", "message": "fixed some javadocs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "committedDate": "2020-12-09T10:14:45Z", "message": "Merge branch 'develop' into feature/multiple-results-client"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTg0ODc1", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548184875", "createdAt": "2020-12-09T13:33:11Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTg1NzQ4", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548185748", "createdAt": "2020-12-09T13:34:12Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTg1NzY3", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548185767", "createdAt": "2020-12-09T13:34:13Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTg1NDg3", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548185487", "createdAt": "2020-12-09T13:33:54Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzozMzo1NFrOICU0Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzo1Mzo0M1rOICVtZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwOTE0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539309147", "createdAt": "2020-12-09T13:33:54Z", "author": {"login": "fde312"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMxMTc0Nw==", "bodyText": "I think something is odd in this method. I am not seeing where you are adding the result for the case when this.results == null", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539311747", "createdAt": "2020-12-09T13:37:29Z", "author": {"login": "fde312"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMDY5MA==", "bodyText": "I am not quire sure what is happening here. As far as I know we only have one result at the moment, therefore this would remove the last result (the one result at the moment) and then add the same result back, right? Or am I misunderstanding here something?", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539320690", "createdAt": "2020-12-09T13:49:31Z", "author": {"login": "fde312"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {\n+        if (this.results == null) {\n             this.results = new ArrayList<>();\n         }\n+        else if (!this.results.isEmpty()) {\n+            results.set(results.size() - 1, result);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMTY3Mg==", "bodyText": "I think that we should not delete any result at all except for special reasons", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539321672", "createdAt": "2020-12-09T13:50:55Z", "author": {"login": "fde312"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {\n+        if (this.results == null) {\n             this.results = new ArrayList<>();\n         }\n+        else if (!this.results.isEmpty()) {\n+            results.set(results.size() - 1, result);\n+            // TODO: Make sure the deletion is saved in the database too (SE, NR)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMzc0OA==", "bodyText": "this returns the result with the highest Id right?", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539323748", "createdAt": "2020-12-09T13:53:43Z", "author": {"login": "fde312"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -96,15 +96,14 @@ public Long getDurationInMinutes() {\n         return Duration.between(initilizationDate, submissionDate).toMinutes();\n     }\n \n-    // TODO Ruscher, Entholzer: Refactor to getLatestResult\n     /**\n      * Is used as a workaround for objects that expect submission to have 1 result\n      *\n      * @return the latest result\n      */\n     @Nullable\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.READ_ONLY)\n-    public Result getResult() {\n+    @JsonIgnore\n+    public Result getLatestResult() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d19f39ff648296564ec8aeeee402b517f45b04b1", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/d19f39ff648296564ec8aeeee402b517f45b04b1", "committedDate": "2020-12-09T14:00:31Z", "message": "Update src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\nCo-authored-by: Francisco De las Casas Young <41108487+fde312@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjE0NTc3", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548214577", "createdAt": "2020-12-09T14:05:14Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDowNToxNVrOICWQlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDowNToxNVrOICWQlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzMjc1Nw==", "bodyText": "I am not sure if it would be better to not export this function and rename it to getLatestResult then you can call this directly from a submission, e.g. const result = this.submission.getLatestResult()", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539332757", "createdAt": "2020-12-09T14:05:15Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/entities/submission.model.ts", "diffHunk": "@@ -40,3 +40,58 @@ export abstract class Submission implements BaseEntity {\n         this.submitted = false; // default value\n     }\n }\n+\n+/**\n+ * Used to access the correct submissions result\n+ *\n+ * @param submission\n+ */\n+export function getLatestSubmissionResult(submission: Submission | undefined): Result | undefined {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjE2ODc1", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548216875", "createdAt": "2020-12-09T14:07:40Z", "commit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDowNzo0MFrOICWX_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoxMzowNlrOICWojQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzNDY1Mw==", "bodyText": "It would be better to save the result in a global variable instead of using the method in the check. See also other places where you are doing this that way (e.g. line 57)", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539334653", "createdAt": "2020-12-09T14:07:40Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/exercises/file-upload/assess/file-upload-assessment-dashboard.component.html", "diffHunk": "@@ -53,7 +53,9 @@ <h4 jhiTranslate=\"artemisApp.fileUploadAssessment.dashboard.heading\" [translateV\n                         </ng-container>\n                     </td>\n                     <td>\n-                        <span *ngIf=\"submission.result && submission.result.score != null\">{{ submission.result.score }} %</span>\n+                        <span *ngIf=\"getLatestSubmissionResult(submission) && getLatestSubmissionResult(submission)!.score != null\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzNjc2NA==", "bodyText": "wuuut :D", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539336764", "createdAt": "2020-12-09T14:10:26Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/exercises/file-upload/assess/file-upload-assessment-dashboard.component.ts", "diffHunk": "@@ -23,6 +23,7 @@ export class FileUploadAssessmentDashboardComponent implements OnInit {\n     busy = false;\n     predicate = 'id';\n     reverse = false;\n+    getLatestSubmissionResult = getLatestSubmissionResult;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzNzEyMw==", "bodyText": "Please save the result in a local variable", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539337123", "createdAt": "2020-12-09T14:10:52Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/exercises/file-upload/assess/file-upload-assessment-dashboard.component.ts", "diffHunk": "@@ -73,11 +74,11 @@ export class FileUploadAssessmentDashboardComponent implements OnInit {\n                 .pipe(\n                     map((response: HttpResponse<FileUploadSubmission[]>) =>\n                         response.body!.map((submission: FileUploadSubmission) => {\n-                            if (submission.result) {\n+                            if (getLatestSubmissionResult(submission)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzODA3Mw==", "bodyText": "Please save the result in a local/global variable", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539338073", "createdAt": "2020-12-09T14:12:00Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/exercises/file-upload/participate/file-upload-submission.component.ts", "diffHunk": "@@ -74,16 +75,16 @@ export class FileUploadSubmissionComponent implements OnInit, ComponentCanDeacti\n         this.fileUploadSubmissionService.getDataForFileUploadEditor(participationId).subscribe(\n             (submission: FileUploadSubmission) => {\n                 // reconnect participation <--> result\n-                if (submission.result) {\n-                    submission.participation!.results = [submission.result];\n+                if (getLatestSubmissionResult(submission)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzODg5Mw==", "bodyText": "Please save the result in a global variable and change it also in the html accordingly", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539338893", "createdAt": "2020-12-09T14:13:06Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-dashboard.component.ts", "diffHunk": "@@ -116,18 +117,20 @@ export class ModelingAssessmentDashboardComponent implements OnInit, OnDestroy {\n                 // the server should have filtered these submissions already\n                 this.submissions = res.body!.filter((submission) => submission.submitted);\n                 this.submissions.forEach((submission) => {\n-                    if (submission.result) {\n+                    if (getLatestSubmissionResult(submission)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/6cc599e5bfaf04c2b194b48ea71030c92cca4c92", "committedDate": "2020-12-09T14:20:46Z", "message": "fixed replaceLatestOrIfEmptyAddResult to be easier understandable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjkwNTI2", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548290526", "createdAt": "2020-12-09T15:17:45Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjE0OTc2", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548614976", "createdAt": "2020-12-09T21:14:59Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMToxNDo1OVrOICpyKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMToxNDo1OVrOICpyKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY1MjY1MQ==", "bodyText": "Should the comment be removed since you renamed the ignored property?", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539652651", "createdAt": "2020-12-09T21:14:59Z", "author": {"login": "ivanchimeno"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -79,7 +79,7 @@\n     @ManyToOne(fetch = FetchType.LAZY)\n     @JsonView(QuizView.Before.class)\n     // TODO: rename ignored property to \"results\" after change in client", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48977a51f79a869997fcad85a664c22b2be9c8d9", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/48977a51f79a869997fcad85a664c22b2be9c8d9", "committedDate": "2020-12-09T21:27:36Z", "message": "refactored and cleaned up use of getLatestSubmissionResult()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjI2NDQ5", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548626449", "createdAt": "2020-12-09T21:31:18Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMToxOFrOICqZ7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMToxOFrOICqZ7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY2MjgzMA==", "bodyText": "Quick question: isn't !!getLatestSubmissionResult(submission) the same as getLatestSubmissionResult(submission) (so that we can simply omit the !!)?", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539662830", "createdAt": "2020-12-09T21:31:18Z", "author": {"login": "ivanchimeno"}, "path": "src/main/webapp/app/exam/participate/exam-participation.service.ts", "diffHunk": "@@ -129,9 +130,10 @@ export class ExamParticipationService {\n                     if (!!participation.submissions) {\n                         for (const submission of participation.submissions) {\n                             delete submission.participation;\n-                            if (!!submission.result) {\n-                                delete submission.result.participation;\n-                                delete submission.result.submission;\n+                            if (!!getLatestSubmissionResult(submission)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjI3NjU2", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548627656", "createdAt": "2020-12-09T21:32:58Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMjo1OFrOICqeGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMjo1OFrOICqeGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY2Mzg5Nw==", "bodyText": "@fde312 mentioned below that it might be better to refactor that into a variable so that we avoid long html", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539663897", "createdAt": "2020-12-09T21:32:58Z", "author": {"login": "ivanchimeno"}, "path": "src/main/webapp/app/assessment/assessment-locks/assessment-locks.component.html", "diffHunk": "@@ -37,7 +37,7 @@ <h2>\n                     <td>{{ submission.submissionDate | date: 'MMM d, y HH:mm:ss' }}</td>\n                     <td>{{ submission.participation.submissions?.length }}</td>\n                     <td>\n-                        <span *ngIf=\"submission.result.score != null\">{{ submission.result.score }}%</span>\n+                        <span *ngIf=\"getLatestSubmissionResult(submission)!.score != null\">{{ getLatestSubmissionResult(submission)!.score }}%</span>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjI3NzY4", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548627768", "createdAt": "2020-12-09T21:33:07Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMzowN1rOICqebQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMTozMzowN1rOICqebQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY2Mzk4MQ==", "bodyText": "@fde312 mentioned below that it might be better to refactor that into a variable so that we avoid long html", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539663981", "createdAt": "2020-12-09T21:33:07Z", "author": {"login": "ivanchimeno"}, "path": "src/main/webapp/app/assessment/assessment-locks/assessment-locks.component.html", "diffHunk": "@@ -57,7 +57,11 @@ <h2>\n                             </button>\n                         </span>\n                         <span>\n-                            <button *ngIf=\"!submission.result.completionDate\" (click)=\"cancelAssessment(submission)\" class=\"btn btn-outline-secondary btn-sm mb-1\">\n+                            <button\n+                                *ngIf=\"!getLatestSubmissionResult(submission)!.completionDate\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjM0MjU5", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548634259", "createdAt": "2020-12-09T21:42:29Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjcwMjQ4", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-548670248", "createdAt": "2020-12-09T22:33:37Z", "commit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMjozMzozN1rOICsmhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMjo1MToxNFrOICtJSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY5ODgyMg==", "bodyText": "You are saying that submission could be undefined but here your are asserting that submission is not undefined with the !.", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539698822", "createdAt": "2020-12-09T22:33:37Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/entities/submission.model.ts", "diffHunk": "@@ -40,3 +40,58 @@ export abstract class Submission implements BaseEntity {\n         this.submitted = false; // default value\n     }\n }\n+\n+/**\n+ * Used to access the correct submissions result\n+ *\n+ * @param submission\n+ */\n+export function getLatestSubmissionResult(submission: Submission | undefined): Result | undefined {\n+    checkForResultsLength(submission);\n+    if (submission?.results) {\n+        const length = submission.results.length;\n+        if (length > 0) {\n+            return submission.results[length - 1];\n+        }\n+    }\n+}\n+\n+/**\n+ * Used to set the correct submissions result\n+ *\n+ * @param submission\n+ * @param result\n+ *\n+ * @return the index of the latestSubmissionResult or undefined if any of the params was undefined\n+ */\n+export function setLatestSubmissionResult(submission: Submission | undefined, result: Result | undefined): number | undefined {\n+    checkForResultsLength(submission);\n+\n+    if (!submission || !result) {\n+        return undefined;\n+    }\n+\n+    if (submission.results) {\n+        submission.results[submission.results.length - 1] = result;\n+    } else {\n+        submission.results = [result];\n+    }\n+    return submission.results.length - 1;\n+}\n+\n+export function getFirstResult(submission: Submission | undefined): Result | undefined {\n+    checkForResultsLength(submission);\n+    if (submission?.results) {\n+        const length = submission.results.length;\n+        if (length > 0) {\n+            return submission.results[0];\n+        }\n+    }\n+}\n+\n+// todo NR/SE: remove after PR can be merged into develop\n+function checkForResultsLength(submission: Submission | undefined) {\n+    if (submission!.results && submission!.results?.length > 1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY5OTYwMg==", "bodyText": "What is the correct submissions result?", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539699602", "createdAt": "2020-12-09T22:35:07Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/entities/submission.model.ts", "diffHunk": "@@ -40,3 +40,58 @@ export abstract class Submission implements BaseEntity {\n         this.submitted = false; // default value\n     }\n }\n+\n+/**\n+ * Used to access the correct submissions result\n+ *\n+ * @param submission\n+ */\n+export function getLatestSubmissionResult(submission: Submission | undefined): Result | undefined {\n+    checkForResultsLength(submission);\n+    if (submission?.results) {\n+        const length = submission.results.length;\n+        if (length > 0) {\n+            return submission.results[length - 1];\n+        }\n+    }\n+}\n+\n+/**\n+ * Used to set the correct submissions result", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcwNjcxNg==", "bodyText": "I think this needs a little more elaboration :)", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539706716", "createdAt": "2020-12-09T22:49:06Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/entities/submission.model.ts", "diffHunk": "@@ -40,3 +40,58 @@ export abstract class Submission implements BaseEntity {\n         this.submitted = false; // default value\n     }\n }\n+\n+/**\n+ * Used to access the correct submissions result\n+ *\n+ * @param submission\n+ */\n+export function getLatestSubmissionResult(submission: Submission | undefined): Result | undefined {\n+    checkForResultsLength(submission);\n+    if (submission?.results) {\n+        const length = submission.results.length;\n+        if (length > 0) {\n+            return submission.results[length - 1];\n+        }\n+    }\n+}\n+\n+/**\n+ * Used to set the correct submissions result", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY5OTYwMg=="}, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcwNzcyMg==", "bodyText": "What happens with an empty array? Then you would set submission.results[-1] = result", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539707722", "createdAt": "2020-12-09T22:51:14Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/entities/submission.model.ts", "diffHunk": "@@ -40,3 +40,58 @@ export abstract class Submission implements BaseEntity {\n         this.submitted = false; // default value\n     }\n }\n+\n+/**\n+ * Used to access the correct submissions result\n+ *\n+ * @param submission\n+ */\n+export function getLatestSubmissionResult(submission: Submission | undefined): Result | undefined {\n+    checkForResultsLength(submission);\n+    if (submission?.results) {\n+        const length = submission.results.length;\n+        if (length > 0) {\n+            return submission.results[length - 1];\n+        }\n+    }\n+}\n+\n+/**\n+ * Used to set the correct submissions result\n+ *\n+ * @param submission\n+ * @param result\n+ *\n+ * @return the index of the latestSubmissionResult or undefined if any of the params was undefined\n+ */\n+export function setLatestSubmissionResult(submission: Submission | undefined, result: Result | undefined): number | undefined {\n+    checkForResultsLength(submission);\n+\n+    if (!submission || !result) {\n+        return undefined;\n+    }\n+\n+    if (submission.results) {\n+        submission.results[submission.results.length - 1] = result;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "497fb3098b6693b7c6a469c41d9c3d5945e838db", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/497fb3098b6693b7c6a469c41d9c3d5945e838db", "committedDate": "2020-12-10T08:38:53Z", "message": "small fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeb0945e150b3afb4bf64ad676954e0d681ceabf", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/aeb0945e150b3afb4bf64ad676954e0d681ceabf", "committedDate": "2020-12-10T09:02:54Z", "message": "reset renaming of setResults()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf74343639064b67f5ca967cf3f5e7245de804b3", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/bf74343639064b67f5ca967cf3f5e7245de804b3", "committedDate": "2020-12-10T13:01:45Z", "message": "re-refactored replaceLatestOrIfEmptyAddResult to addResult"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d4020b4fb47efe8600458d79645809507cfb80f", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/9d4020b4fb47efe8600458d79645809507cfb80f", "committedDate": "2020-12-10T20:53:04Z", "message": "refactored methods which didnt refactor automatically"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c9f2e2521c047ad8320f68b9c36b2d0a396df51", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/4c9f2e2521c047ad8320f68b9c36b2d0a396df51", "committedDate": "2020-12-11T01:09:35Z", "message": "removed a redundant second submission.addResult in DatabaseUtilService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5OTg2OTU4", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-549986958", "createdAt": "2020-12-11T10:42:34Z", "commit": {"oid": "4c9f2e2521c047ad8320f68b9c36b2d0a396df51"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMDo0MjozNFrOIDzJ_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMDo0MjozNFrOIDzJ_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg1NDc4Mg==", "bodyText": "It looks like this is mostly/only used for clearing results. Wouldn't it make more sense to add a dedicated clear method? (This way we also don't allocate a new ArrayList each time we just want to throw the old results away.)", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r540854782", "createdAt": "2020-12-11T10:42:34Z", "author": {"login": "FrankeLukas"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,19 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n-            this.results = new ArrayList<>();\n-        }\n-        else {\n-            // addResult\n-            this.results.add(result);\n-        }\n+    public void addResult(Result result) {\n+        this.results.add(result);\n+        // At the moment only one result in results is allowed\n+        assert results.size() < 2;\n     }\n \n-    // TODO Ruscher, Entholzer: refactor to setResults\n-    @JsonIgnore()\n-    public void setResultsList(List<Result> results) {\n+    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void setResults(List<Result> results) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c9f2e2521c047ad8320f68b9c36b2d0a396df51"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3cd8f73db26279c04c84573686095bf7d2059f9", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/c3cd8f73db26279c04c84573686095bf7d2059f9", "committedDate": "2020-12-11T12:16:36Z", "message": "Started refactoring of functions calls to getLatestSubmissionResult -> local property latestResultsBySubmissionMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07116d3076c4e54a8274cc903974daa7d5ab1dbd", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/07116d3076c4e54a8274cc903974daa7d5ab1dbd", "committedDate": "2020-12-11T12:42:21Z", "message": "fixed ExamQuizService, removed adding of a second result to a submission"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7912a787582bf5e678710f0615439dc66900c19", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/b7912a787582bf5e678710f0615439dc66900c19", "committedDate": "2020-12-11T12:43:53Z", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "146615f4e02d06308b1fe87b53036853797281bf", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/146615f4e02d06308b1fe87b53036853797281bf", "committedDate": "2020-12-11T13:00:13Z", "message": "fixed wrong test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6665dc5be697ea05c98a789800332cf4ac6a7a06", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/6665dc5be697ea05c98a789800332cf4ac6a7a06", "committedDate": "2020-12-11T13:08:54Z", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "484efdf8404ddf044cd1a6bb187b5cb19cc11279", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/484efdf8404ddf044cd1a6bb187b5cb19cc11279", "committedDate": "2020-12-11T13:59:24Z", "message": "Revert \"Started refactoring of functions calls to getLatestSubmissionResult -> local property latestResultsBySubmissionMap\"\n\nThis reverts commit c3cd8f73"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08642639dac984a58e9c5197ba91b6c57b800f60", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/08642639dac984a58e9c5197ba91b6c57b800f60", "committedDate": "2020-12-11T14:11:11Z", "message": "Merge branch 'develop' into feature/multiple-results-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c85ec83e3e6dc80451c09b93cd7b9d5b4d736be", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/8c85ec83e3e6dc80451c09b93cd7b9d5b4d736be", "committedDate": "2020-12-11T14:16:32Z", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7654dfaaf480b30a339c94684742e95fa994bfd6", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/7654dfaaf480b30a339c94684742e95fa994bfd6", "committedDate": "2020-12-11T14:48:31Z", "message": "fixed missing local function for getLatestSubmissionResult"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91f58a53f31e88139bad4be001cbc7f33fcebc01", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/91f58a53f31e88139bad4be001cbc7f33fcebc01", "committedDate": "2020-12-11T14:52:08Z", "message": "removed private from local function declaration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61eac52225fd2d62b41a640c3df8da3aea7f41f6", "author": {"user": {"login": "nicolasruscher", "name": "Nicolas Ruscher"}}, "url": "https://github.com/ls1intum/Artemis/commit/61eac52225fd2d62b41a640c3df8da3aea7f41f6", "committedDate": "2020-12-11T15:02:54Z", "message": "small fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/c6a1d84900e793a1689c8879d6601acd5a529cd7", "committedDate": "2020-12-11T16:42:03Z", "message": "Merge branch 'develop' into feature/multiple-results-client"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMzI2ODUz", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-550326853", "createdAt": "2020-12-11T17:24:29Z", "commit": {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMzM1NTQy", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-550335542", "createdAt": "2020-12-11T17:30:21Z", "commit": {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMDoyMVrOIECuMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMDoyMVrOIECuMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEwOTgwOQ==", "bodyText": "I have never seen this in production java code before. I also found this online. Could you maybe throw a normal Exception here? Or is there a specific reason you used assert here that I miss.\nhttps://en.wikibooks.org/wiki/Java_Programming/Keywords/assert#:~:text=assert%20is%20a%20Java%20keyword,runtime%20system%20throws%20an%20AssertionError%20.\nAssertions are usually used as a debugging aid. They should not be used instead of validating arguments to public methods, or in place of a more precise runtime error exception.", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r541109809", "createdAt": "2020-12-11T17:30:21Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -138,13 +138,9 @@ public Result getFirstResult() {\n      *\n      * @param result\n      */\n-    public void replaceLatestOrIfEmptyAddResult(Result result) {\n-        if (this.results.isEmpty()) {\n-            this.results.add(result);\n-        }\n-        else {\n-            results.set(results.size() - 1, result);\n-        }\n+    public void addResult(Result result) {\n+        this.results.add(result);\n+        // At the moment only one result in results is allowed\n         assert results.size() < 2;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMzQzMjg5", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-550343289", "createdAt": "2020-12-11T17:35:20Z", "commit": {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94c2f88ed5d080165277340ce26c78776839387e", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/94c2f88ed5d080165277340ce26c78776839387e", "committedDate": "2020-12-11T17:37:15Z", "message": "changed result to manual result in ProgrammingAssessmentIntegrationTest to fix build fail"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61e00e3342d93f03a0f01e48f40f3c4380742009", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/61e00e3342d93f03a0f01e48f40f3c4380742009", "committedDate": "2020-12-11T17:45:03Z", "message": "changed assert to Exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c5f9ebcf4e45a50a7f97a2e6a9f67400bf16c2f", "author": {"user": {"login": "SimonEntholzer", "name": "Simon Entholzer"}}, "url": "https://github.com/ls1intum/Artemis/commit/7c5f9ebcf4e45a50a7f97a2e6a9f67400bf16c2f", "committedDate": "2020-12-11T18:19:32Z", "message": "fixed Exception mistake"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwNjcyODc3", "url": "https://github.com/ls1intum/Artemis/pull/2507#pullrequestreview-550672877", "createdAt": "2020-12-12T01:21:16Z", "commit": {"oid": "7c5f9ebcf4e45a50a7f97a2e6a9f67400bf16c2f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3376, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}