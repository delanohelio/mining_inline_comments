{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2NjU3MTE1", "number": 2531, "title": "Improve Jenkins setup docu", "bodyText": "Motivation and Context\nAdjust Jenkins pipeline documentation (see #2306).\nAdded:\n\nLocal Docker agents\nCaching", "createdAt": "2020-12-11T08:34:08Z", "url": "https://github.com/ls1intum/Artemis/pull/2531", "merged": true, "mergeCommit": {"oid": "66627b694addcde082891f6d5732ab36ccdba16d"}, "closed": true, "closedAt": "2020-12-19T07:35:35Z", "author": {"login": "sleiss"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeUWNBgH2gAyNTM2NjU3MTE1OjUyMDI4MTc3YjMzMjNkOGI1NmIzNjkzMjAxZjVkMjc0ZDNiYTBiZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnnrchAFqTU1NTkyNDMxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "52028177b3323d8b56b3693201f5d274d3ba0bf2", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/52028177b3323d8b56b3693201f5d274d3ba0bf2", "committedDate": "2020-11-20T09:57:19Z", "message": "Start with adjustment of documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a1f9131a06bb2a35216153fe27c58d45979904", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/a8a1f9131a06bb2a35216153fe27c58d45979904", "committedDate": "2020-12-08T17:08:48Z", "message": "Merge branch 'develop' into docu/jenkins-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77bd9d73845a24499d74eea803012314701ecd4c", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/77bd9d73845a24499d74eea803012314701ecd4c", "committedDate": "2020-12-08T19:01:06Z", "message": "Add documentation regarding caching and local agents."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d43c65bf81d292644c700948541a5515a6de0ff8", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/d43c65bf81d292644c700948541a5515a6de0ff8", "committedDate": "2020-12-11T08:32:09Z", "message": "Make dind optional."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91a2795f634f854487214781fc81628f551ab1a7", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/91a2795f634f854487214781fc81628f551ab1a7", "committedDate": "2020-12-11T08:38:25Z", "message": "Add 'e.g.'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/2427e4a699f18aa6a521322611fcdec6f6b78a19", "committedDate": "2020-12-11T08:44:56Z", "message": "Merge branch 'develop' into docu/jenkins-pipeline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDg2NTMz", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-550086533", "createdAt": "2020-12-11T13:14:37Z", "commit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDozOFrOID4P2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDozOFrOID4P2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODIwMw==", "bodyText": "Can you please add a reason why this is necessary. I guess the main reason is to speed up build times...", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938203", "createdAt": "2020-12-11T13:14:38Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDg2Nzky", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-550086792", "createdAt": "2020-12-11T13:14:59Z", "commit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDo1OVrOID4QrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNDo1OVrOID4QrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODQxMw==", "bodyText": "you can reference artemis-java-testing-sandbox here, which can circumvent those issues", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938413", "createdAt": "2020-12-11T13:14:59Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/programming-exercises.rst", "diffHunk": "@@ -60,3 +60,30 @@ Note that the ``Jenkinsfile`` **must** start either\n The variables `#dockerImage`, `#testRepository`, `#assignmentRepository`, `#jenkinsNotificationToken` and `#notificationsUrl` will automatically be replaced (for the normal Jenkinsfile, within the Jenkinsfile-staticCodeAnalysis, #staticCodeAnalysisScript is also replaced).\n \n You should not need to touch any of these variables, except the `#dockerImage` variable, if you want to use a different agent setup (e.g. a Kubernetes setup).\n+\n+\n+Caching example for Maven\n+^^^^^^^^^^^^^^^^^^^^^^^^^\n+Adjust the agent-args and add the environment block.\n+\n+\n+.. code:: bash\n+\n+        agent {\n+            docker {\n+                image '#dockerImage'\n+                label 'docker'\n+                args '-v $HOME/maven-cache-docker:/var/maven'\n+            }\n+        }\n+        environment {\n+          JAVA_TOOL_OPTIONS = '-Duser.home=/var/maven'\n+        }\n+        stages {\n+            stage('Checkout') {\n+\n+\n+\n+You have to add permissions to the folder (which will be located at the $HOME folder of the user that jenkins uses), e.g. with ``sudo chmod 777 maven-cache-docker -R``.\n+\n+Note that this might allow students to access shared resources (e.g. jars used by Maven), and they might be able to overwrite them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDg3MzU5", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-550087359", "createdAt": "2020-12-11T13:15:47Z", "commit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNTo0N1rOID4SYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNTo0N1rOID4SYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzODg1MA==", "bodyText": "add a new line to fix the GitHub action warning", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r540938850", "createdAt": "2020-12-11T13:15:47Z", "author": {"login": "krusche"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -418,42 +405,12 @@ Start Jenkins\n            continuous-integration:\n                user: your.chosen.username\n                password: your.chosen.password\n-\n-12. Setup JDK 15 in Jenkins Settings\n-\n-    Navigate in your browser into Jenkins \u2192 Manage Jenkins \u2192 Global Tool\n-    Configuration \u2192 JDK. Change the existing JDK installation or click\n-    on Add JDK.\n-\n-    Use ``OpenJDK 15`` as Name and\n-    ``/usr/lib/jvm/java-15-openjdk-amd64`` as JAVA_HOME\n-\n-   .. figure:: jenkins-gitlab/jenkins_jdk_config.png\n-      :align: center\n-\n Required Jenkins Plugins", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2427e4a699f18aa6a521322611fcdec6f6b78a19"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1204b782a7cc9b3e953f74ce5affe667172f5152", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/1204b782a7cc9b3e953f74ce5affe667172f5152", "committedDate": "2020-12-11T13:48:09Z", "message": "Merge branch 'develop' into docu/jenkins-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/af8739d6e7e7b703e69b7c3b49c4df2fac96574f", "committedDate": "2020-12-11T13:50:42Z", "message": "small improvements\n\nwork in progress due to a TODO in the section with use-crumb"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMzM4NzQ1", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-550338745", "createdAt": "2020-12-11T17:32:36Z", "commit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMjozN1rOIECzpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzozMjozN1rOIECzpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExMTIwNA==", "bodyText": "It seems that disabling CSRF in Jenkins is no longer necessary. In Artemis support for it is enabled by default https://github.com/ls1intum/Artemis/blob/develop/src/main/resources/config/application-jenkins.yml and we are running a setup with it enabled without problems.", "url": "https://github.com/ls1intum/Artemis/pull/2531#discussion_r541111204", "createdAt": "2020-12-11T17:32:37Z", "author": {"login": "b-fein"}, "path": "docs/dev/setup/jenkins-gitlab.rst", "diffHunk": "@@ -658,10 +631,29 @@ the following steps:\n     Cross Site Request Forgery exploits\u201d. Also disable the option\n     ``use-crumb`` in ``application-jenkins.yml``.\n \n+    TODO: this seems to be outdated: Only ``Enable proxy compatibility`` is available\n+\n     Depending on the version this setting might not be available anymore.\n     Have a look `here <https://unix.stackexchange.com/questions/444177/how-to-disable-the-csrf-protection-in-jenkins-by-default>`__ on how you can disable CSRF protection.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8739d6e7e7b703e69b7c3b49c4df2fac96574f"}, "originalPosition": 322}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "203992e1ae3241c06f67fc6cbb309cfd4ffc17ae", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/203992e1ae3241c06f67fc6cbb309cfd4ffc17ae", "committedDate": "2020-12-12T17:12:16Z", "message": "Add details about caching, fix minor issues."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "206b8208dd300c861ac9ca2bea6f3a518fed31e0", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/206b8208dd300c861ac9ca2bea6f3a518fed31e0", "committedDate": "2020-12-12T17:12:50Z", "message": "Merge branch 'docu/jenkins-pipeline' of github.com:ls1intum/ArTEMiS into docu/jenkins-pipeline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMTY1OTY4", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-551165968", "createdAt": "2020-12-14T09:06:28Z", "commit": {"oid": "206b8208dd300c861ac9ca2bea6f3a518fed31e0"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNjUwNTM0", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-552650534", "createdAt": "2020-12-15T16:38:37Z", "commit": {"oid": "206b8208dd300c861ac9ca2bea6f3a518fed31e0"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNjQ1OTAw", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-553645900", "createdAt": "2020-12-16T12:38:16Z", "commit": {"oid": "206b8208dd300c861ac9ca2bea6f3a518fed31e0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a57896541c51c759f0d1f330fce2b4cbdb370142", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/a57896541c51c759f0d1f330fce2b4cbdb370142", "committedDate": "2020-12-17T11:19:02Z", "message": "Merge branch 'develop' into docu/jenkins-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23be766354e885c90826ccab7e590c0f979bf884", "author": {"user": {"login": "ivanchimeno", "name": "Ivan Chimeno"}}, "url": "https://github.com/ls1intum/Artemis/commit/23be766354e885c90826ccab7e590c0f979bf884", "committedDate": "2020-12-18T09:16:48Z", "message": "update jenkins docs to include how to disable csrf on a local environment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MzI4MzMw", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-555328330", "createdAt": "2020-12-18T09:27:57Z", "commit": {"oid": "23be766354e885c90826ccab7e590c0f979bf884"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be5358ada95d506f073220b96e17aaab8e96187b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/be5358ada95d506f073220b96e17aaab8e96187b", "committedDate": "2020-12-19T07:32:07Z", "message": "use unique ports for Artemis 8080, Gitlab 8081 and Jenkins 8082"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a51e823f0827849b571dc21c95d6aaf496a9879", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6a51e823f0827849b571dc21c95d6aaf496a9879", "committedDate": "2020-12-19T07:32:38Z", "message": "Merge branch 'develop' into docu/jenkins-pipeline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1OTI0MzEz", "url": "https://github.com/ls1intum/Artemis/pull/2531#pullrequestreview-555924313", "createdAt": "2020-12-19T07:34:02Z", "commit": {"oid": "6a51e823f0827849b571dc21c95d6aaf496a9879"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3443, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}