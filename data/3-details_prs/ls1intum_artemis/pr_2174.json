{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5MjAzNTQ5", "number": 2174, "title": "Improve registration: add more customization options", "bodyText": "Fixes #2165\nFixes #2148\nChecklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n Client: I documented the TypeScript code using JSDoc style.\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\nMore customization possibilities for other universities\nDescription\n\nCourse instructors can now add a message that students need to confirm\nSystem admins can now configure more options when it comes to the login screen and to the course registration\nThis PR also includes updates to server and client dependencies\n\nSteps for Testing\n\nLog in to Artemis using different options in the application-artemis.yml file and check that everything works properly / is displayed correctly\nCreate / edit courses with student registration enabled and a confirmation message\nTry to register for these courses with different accounts (following different patterns)\nCustomize more of the new settings in application-artemis.yml and verify that everything works properly", "createdAt": "2020-10-07T12:11:55Z", "url": "https://github.com/ls1intum/Artemis/pull/2174", "merged": true, "mergeCommit": {"oid": "f6cf7da8bd34692850406eecc87e8e0c199a3110"}, "closed": true, "closedAt": "2020-10-14T22:58:53Z", "author": {"login": "krusche"}, "timelineItems": {"totalCount": 47, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQH3iKgH2gAyNDk5MjAzNTQ5OmE4OWI4ZGYzNDEwYzY2MjUyZmE0NmUwZGRhMWFhNzc4NGZiN2VkOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSx9jPgFqTUwOTM5MDM2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a89b8df3410c66252fa46e0dda1aa7784fb7ed96", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a89b8df3410c66252fa46e0dda1aa7784fb7ed96", "committedDate": "2020-10-07T07:30:01Z", "message": "bump version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6e5264439e40b8f21ad12e65414d164f8b2d206", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d6e5264439e40b8f21ad12e65414d164f8b2d206", "committedDate": "2020-10-07T09:26:46Z", "message": "improve course registration\n\nimprove user login\nadd course registration message option\nimprove translations and add new explantions in course creation dialog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54d6ad54916a863c53ff0fc660a7558404e69dc8", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/54d6ad54916a863c53ff0fc660a7558404e69dc8", "committedDate": "2020-10-07T10:04:27Z", "message": "fix some issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/545d34efe31e539f093c751e00c0a039c9c51b15", "committedDate": "2020-10-07T12:02:15Z", "message": "also allow users to register for courses without startDate or endDate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzODI4ODI4", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-503828828", "createdAt": "2020-10-07T12:34:35Z", "commit": {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMjozNDozNVrOHdxE0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMjozNDozNVrOHdxE0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk3NDgwMA==", "bodyText": "Should we add that only users with a matching username (according to the regex) can register to the course to avoid confusion?", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r500974800", "createdAt": "2020-10-07T12:34:35Z", "author": {"login": "sleiss"}, "path": "src/main/webapp/i18n/en/course.json", "diffHunk": "@@ -54,8 +54,15 @@\n             \"startDate\": \"Start\",\n             \"endDate\": \"End\",\n             \"accessGroups\": \"Access Groups\",\n-            \"onlineCourse\": \"Online Course\",\n-            \"registrationEnabled\": \"Student Registration Enabled\",\n+            \"onlineCourse\": {\n+                \"title\": \"Online Course\",\n+                \"description\": \"Activate this checkbox for external online courses (e.g. on edX) so that students can use this Artemis course (via the LTI interface). This also allows automatic account creation if enabled by the Artemis system administrator.\"\n+            },\n+            \"registrationEnabled\": {\n+                \"title\": \"Student Course Registration Enabled\",\n+                \"description\": \"Activate this checkbox to allow students to register independently in the course if it is active (between start and end of the course). You can optionally enter a message that students have to confirm during registration.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzODM2NTcw", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-503836570", "createdAt": "2020-10-07T12:43:55Z", "commit": {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMjo0Mzo1NVrOHdxcew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMjo0Mzo1NVrOHdxcew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MDg1OQ==", "bodyText": "As this is also TUM specific (at least I guess so): Should we also make this configurable?", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r500980859", "createdAt": "2020-10-07T12:43:55Z", "author": {"login": "sleiss"}, "path": "src/main/java/de/tum/in/www1/artemis/config/Constants.java", "diffHunk": "@@ -51,10 +51,6 @@\n \n     public static final Pattern FILE_ENDING_PATTERN = Pattern.compile(FILE_ENDING_REGEX);\n \n-    public static final String TUM_USERNAME_REGEX = \"^([a-z]{2}\\\\d{2}[a-z]{3})\";\n-\n-    public static final Pattern TUM_USERNAME_PATTERN = Pattern.compile(TUM_USERNAME_REGEX);\n-\n     public static final Pattern TITLE_NAME_PATTERN = Pattern.compile(\"^[a-zA-Z0-9_\\\\-\\\\s]*\");\n \n     public static final String TUM_LDAP_MATRIKEL_NUMBER = \"imMatrikelNr\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17ec63471d0d6026fedaaf21e7588965dcdfa71f", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/17ec63471d0d6026fedaaf21e7588965dcdfa71f", "committedDate": "2020-10-07T12:57:26Z", "message": "use rest template interceptors for Bamboo and Bitbucket and prefer token based authentication if avilable\n\nrename secret to token for Gitlab config to be more consistent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b46c8097902d464230d04a4e865900f40e3aedea", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/b46c8097902d464230d04a4e865900f40e3aedea", "committedDate": "2020-10-07T13:04:02Z", "message": "improve comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a77af091379b0b2cc9c5f78a9f514fa6360a5229", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a77af091379b0b2cc9c5f78a9f514fa6360a5229", "committedDate": "2020-10-07T13:45:01Z", "message": "fix wrong config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42d848984cc65d096f11a3e0f6c95aa8ebd1a2af", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/42d848984cc65d096f11a3e0f6c95aa8ebd1a2af", "committedDate": "2020-10-07T13:50:30Z", "message": "fix config issues with new authorization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b10cbd899110c17786c72337bd9553666528e7d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3b10cbd899110c17786c72337bd9553666528e7d", "committedDate": "2020-10-07T19:02:26Z", "message": "fix javadoc issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ffb13bb5b8a58072f7c6e256b3996ac6b79c1b8", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/4ffb13bb5b8a58072f7c6e256b3996ac6b79c1b8", "committedDate": "2020-10-07T19:12:53Z", "message": "update dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1e6219ffa8ffc8ff8204e0be860cf4d87eff565", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d1e6219ffa8ffc8ff8204e0be860cf4d87eff565", "committedDate": "2020-10-07T20:27:02Z", "message": "consistent use of \u201c in build.gradle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2465cd32bb49a4deed0342d4f4d21925a941525e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/2465cd32bb49a4deed0342d4f4d21925a941525e", "committedDate": "2020-10-08T09:26:29Z", "message": "update client dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb436b940cea788a49d986223fa041ae9538dd5a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/eb436b940cea788a49d986223fa041ae9538dd5a", "committedDate": "2020-10-08T09:26:41Z", "message": "use basic auth to create projects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd0f8c47f73c403fefa877ff521928365eb96b18", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/fd0f8c47f73c403fefa877ff521928365eb96b18", "committedDate": "2020-10-11T13:05:49Z", "message": "Merge branch 'develop' into feature/improve-registration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db43b59d211dd6a0c66e537f95655f2272ba471c", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/db43b59d211dd6a0c66e537f95655f2272ba471c", "committedDate": "2020-10-11T13:11:23Z", "message": "Revert changes to continuous integration features that are not related to this PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f610da66073b5438f4a713a495866701b5eb2f24", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f610da66073b5438f4a713a495866701b5eb2f24", "committedDate": "2020-10-11T13:16:38Z", "message": "revert more changes related to continuous integration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dd9a162e7f1f023850945b90bb730c2384518b4", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/7dd9a162e7f1f023850945b90bb730c2384518b4", "committedDate": "2020-10-11T13:18:44Z", "message": "revert unrelated changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/031a09db400c0743bb637bd9382adfebcd9dfdaa", "committedDate": "2020-10-11T13:36:12Z", "message": "update dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTM0NDYz", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-506534463", "createdAt": "2020-10-12T11:27:53Z", "commit": {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMToyNzo1NFrOHf6ulA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMToyOTowOFrOHf6w4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDEwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"home.pleaseSignIn\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"home. pleaseSignInAccount\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230100", "createdAt": "2020-10-12T11:27:54Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/home/home.component.html", "diffHunk": "@@ -2,7 +2,8 @@\n     <div class=\"col-md-8 offset-md-2 text-center\">\n         <h1 jhiTranslate=\"home.title\">Welcome to Artemis!</h1>\n         <p class=\"lead\" jhiTranslate=\"home.subtitle\">Interactive Learning with Individual Feedback</p>\n-        <div class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n+        <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n+        <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDMxOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                signInMessage = 'home.pleaseSignIn'; // default, might be overridden based on profile info", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230319", "createdAt": "2020-10-12T11:28:21Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -35,9 +32,11 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     credentials: Credentials;\n     isRegistrationEnabled = false;\n \n-    usernameRegexPattern = TUM_USERNAME_REGEX; // default, might be overridden in ngOnInit\n-    signInMessage = 'home.pleaseSignInTUM'; // default, might be overridden in ngOnInit\n-    errorMesssageUsername = 'home.errors.tumWarning'; // default, might be overridden in ngOnInit\n+    // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n+    usernameRegexPattern = /^[a-z0-9_-]{3,50}$/; // default, might be overridden in ngOnInit\n+    signInMessage = 'home.pleaseSignIn'; // default, might be overridden based on profile info", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDY4OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (profileInfo.accountName) {\n          \n          \n            \n                                this.signInMessage = 'home.pleaseSignInAccount';\n          \n          \n            \n                            }", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230689", "createdAt": "2020-10-12T11:29:08Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -60,26 +59,28 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     ) {}\n \n     ngOnInit() {\n-        this.profileService\n-            .getProfileInfo()\n-            .pipe(\n-                filter(Boolean),\n-                tap((info: ProfileInfo) => {\n-                    if (!info.activeProfiles.includes('jira')) {\n-                        // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n-                        this.usernameRegexPattern = /^[a-z0-9_-]{3,100}$/;\n-                        this.signInMessage = 'home.pleaseSignIn';\n-                        this.errorMesssageUsername = 'home.errors.usernameIncorrect';\n-                        this.externalUserManagementActive = false;\n-                    } else {\n-                        this.externalUserManagementUrl = info.externalUserManagementURL;\n-                        this.externalUserManagementName = info.externalUserManagementName;\n+        this.profileService.getProfileInfo().subscribe((profileInfo) => {\n+            if (profileInfo) {\n+                if (profileInfo.activeProfiles.includes('jira')) {\n+                    this.externalUserManagementUrl = profileInfo.externalUserManagementURL;\n+                    this.externalUserManagementName = profileInfo.externalUserManagementName;\n+                    if (profileInfo.allowedLdapUsernamePattern) {\n+                        this.usernameRegexPattern = new RegExp(profileInfo.allowedLdapUsernamePattern);\n                     }\n-\n-                    this.isRegistrationEnabled = info.registrationEnabled || false;\n-                }),\n-            )\n-            .subscribe();\n+                } else {\n+                    // TODO: in the future we might also allow external user management for non jira profiles\n+                    this.externalUserManagementActive = false;\n+                }\n+                if (profileInfo.accountName) {\n+                    this.signInMessage = 'home.pleaseSignInAccount';\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dca717b1701dbdf9c6ba9122e8923fad90eeae1", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/8dca717b1701dbdf9c6ba9122e8923fad90eeae1", "committedDate": "2020-10-13T17:05:00Z", "message": "Merge branch 'develop' into feature/improve-registration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84778d9a84b741a904dec19bedcaeabb176c4d7d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/84778d9a84b741a904dec19bedcaeabb176c4d7d", "committedDate": "2020-10-13T17:13:30Z", "message": "update dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4310e7888b52f62b9dfb16d200dd5b982a60b133", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/4310e7888b52f62b9dfb16d200dd5b982a60b133", "committedDate": "2020-10-13T18:32:49Z", "message": "simplify based on feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3ODY0Nzg4", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-507864788", "createdAt": "2020-10-13T22:11:37Z", "commit": {"oid": "4310e7888b52f62b9dfb16d200dd5b982a60b133"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMjoxMTozN1rOHg7TWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMjoxNDo1OVrOHg7Y3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4ODA4OQ==", "bodyText": "I haven't seen code which truncates those messages to 255 characters on server side. Otherwise course creation could crash. Validation on client-side should also be done.", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504288089", "createdAt": "2020-10-13T22:11:37Z", "author": {"login": "kloessst"}, "path": "src/main/resources/config/liquibase/changelog/20201007105032_changelog.xml", "diffHunk": "@@ -0,0 +1,8 @@\n+<?xml version=\"1.1\" encoding=\"UTF-8\" standalone=\"no\"?>\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\" xmlns:ext=\"http://www.liquibase.org/xml/ns/dbchangelog-ext\" xmlns:pro=\"http://www.liquibase.org/xml/ns/pro\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-3.9.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.9.xsd\">\n+<changeSet author=\"krusche\" id=\"20201007105032\">\n+    <addColumn tableName=\"course\">\n+        <column name=\"registration_confirmation_message\" type=\"VARCHAR(255)\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4310e7888b52f62b9dfb16d200dd5b982a60b133"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4OTUwMA==", "bodyText": "Could add something like Validators.maxLength(255) here", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504289500", "createdAt": "2020-10-13T22:14:59Z", "author": {"login": "kloessst"}, "path": "src/main/webapp/app/course/manage/course-update.component.ts", "diffHunk": "@@ -113,6 +107,7 @@ export class CourseUpdateComponent implements OnInit {\n             }),\n             studentQuestionsEnabled: new FormControl(this.course.studentQuestionsEnabled),\n             registrationEnabled: new FormControl(this.course.registrationEnabled),\n+            registrationConfirmationMessage: new FormControl(this.course.registrationConfirmationMessage),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4310e7888b52f62b9dfb16d200dd5b982a60b133"}, "originalPosition": 72}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db047885f13cdc82bac7eface009aaa2ca4769de", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/db047885f13cdc82bac7eface009aaa2ca4769de", "committedDate": "2020-10-13T22:44:52Z", "message": "Merge branch 'develop' into feature/improve-registration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d71c584812c5949bb5101e3dd75fbd79d880187", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6d71c584812c5949bb5101e3dd75fbd79d880187", "committedDate": "2020-10-13T22:49:56Z", "message": "add basic validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c961b53905b3fb1a016312bc42a993277bb57ff", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5c961b53905b3fb1a016312bc42a993277bb57ff", "committedDate": "2020-10-14T13:22:00Z", "message": "fix small issues in client validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db0293f54c49eacbd3308583c6934666cebb97a1", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/db0293f54c49eacbd3308583c6934666cebb97a1", "committedDate": "2020-10-14T13:39:07Z", "message": "update client dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4Mzg5NTE5", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508389519", "createdAt": "2020-10-14T14:10:57Z", "commit": {"oid": "db0293f54c49eacbd3308583c6934666cebb97a1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDoxMDo1N1rOHhVDIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDoxMDo1N1rOHhVDIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwOTkyMg==", "bodyText": "An idea for a future PR might be to allow to customize this, so that other can also set specific warnings/error messages.(?)", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504709922", "createdAt": "2020-10-14T14:10:57Z", "author": {"login": "FrankeLukas"}, "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -60,26 +58,25 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     ) {}\n \n     ngOnInit() {\n-        this.profileService\n-            .getProfileInfo()\n-            .pipe(\n-                filter(Boolean),\n-                tap((info: ProfileInfo) => {\n-                    if (!info.activeProfiles.includes('jira')) {\n-                        // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n-                        this.usernameRegexPattern = /^[a-z0-9_-]{3,100}$/;\n-                        this.signInMessage = 'home.pleaseSignIn';\n-                        this.errorMesssageUsername = 'home.errors.usernameIncorrect';\n-                        this.externalUserManagementActive = false;\n-                    } else {\n-                        this.externalUserManagementUrl = info.externalUserManagementURL;\n-                        this.externalUserManagementName = info.externalUserManagementName;\n+        this.profileService.getProfileInfo().subscribe((profileInfo) => {\n+            if (profileInfo) {\n+                if (profileInfo.activeProfiles.includes('jira')) {\n+                    this.externalUserManagementUrl = profileInfo.externalUserManagementURL;\n+                    this.externalUserManagementName = profileInfo.externalUserManagementName;\n+                    if (profileInfo.allowedLdapUsernamePattern) {\n+                        this.usernameRegexPattern = new RegExp(profileInfo.allowedLdapUsernamePattern);\n                     }\n-\n-                    this.isRegistrationEnabled = info.registrationEnabled || false;\n-                }),\n-            )\n-            .subscribe();\n+                } else {\n+                    // TODO: in the future we might also allow external user management for non jira profiles\n+                    this.externalUserManagementActive = false;\n+                }\n+                this.accountName = profileInfo.accountName;\n+                if (this.accountName === 'TUM') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db0293f54c49eacbd3308583c6934666cebb97a1"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4Mzk5MTM3", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508399137", "createdAt": "2020-10-14T14:20:02Z", "commit": {"oid": "db0293f54c49eacbd3308583c6934666cebb97a1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDc4MTg0", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508478184", "createdAt": "2020-10-14T15:36:19Z", "commit": {"oid": "1bce51c36d706c9d5db3cfd6c2b98b4feea39b09"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDgyMTI4", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508482128", "createdAt": "2020-10-14T15:40:30Z", "commit": {"oid": "1bce51c36d706c9d5db3cfd6c2b98b4feea39b09"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo0MDozMFrOHhZW-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo0MDozMFrOHhZW-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MDUzOA==", "bodyText": "this can lead to a problem if a regex is specified with only a start or only a regex end e.g. ^[a-zA-Z0-9_\\-\\.\\+]+@(gmail.com) or [a-zA-Z0-9_\\-\\.\\+]+@(gmail.com)$\nwe would than wrap that again resulting in ^(^[a-zA-Z0-9_\\-\\.\\+]+@(gmail.com))$ or ^([a-zA-Z0-9_\\-\\.\\+]+@(gmail.com)$)$", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504780538", "createdAt": "2020-10-14T15:40:30Z", "author": {"login": "TobiasPr"}, "path": "src/main/webapp/app/overview/course-registration-selector/course-registration-selector.component.ts", "diffHunk": "@@ -31,8 +31,14 @@ export class CourseRegistrationSelectorComponent implements OnInit {\n             this.profileService.getProfileInfo().subscribe((profileInfo) => {\n                 if (profileInfo) {\n                     if (profileInfo.allowedCourseRegistrationUsernamePattern) {\n-                        const regex = new RegExp(profileInfo.allowedCourseRegistrationUsernamePattern);\n-                        this.userIsAllowedToRegister = !!user!.login!.match(regex);\n+                        // we want to test for a full match, so wrap the regex in ^ and $\n+                        let regex = profileInfo.allowedCourseRegistrationUsernamePattern;\n+                        if (!regex.startsWith('^') && !regex.endsWith('$')) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bce51c36d706c9d5db3cfd6c2b98b4feea39b09"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a", "author": {"user": {"login": "FrankeLukas", "name": "Lukas Franke"}}, "url": "https://github.com/ls1intum/Artemis/commit/3035a009cae399d232eaeec16b0498ec52d9aa2a", "committedDate": "2020-10-14T15:52:36Z", "message": "Make clientside course registration regex matching more robust"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1bce51c36d706c9d5db3cfd6c2b98b4feea39b09", "author": {"user": {"login": "FrankeLukas", "name": "Lukas Franke"}}, "url": "https://github.com/ls1intum/Artemis/commit/1bce51c36d706c9d5db3cfd6c2b98b4feea39b09", "committedDate": "2020-10-14T15:34:56Z", "message": "Make clientside course registration regex matching more robust"}, "afterCommit": {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a", "author": {"user": {"login": "FrankeLukas", "name": "Lukas Franke"}}, "url": "https://github.com/ls1intum/Artemis/commit/3035a009cae399d232eaeec16b0498ec52d9aa2a", "committedDate": "2020-10-14T15:52:36Z", "message": "Make clientside course registration regex matching more robust"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NTA5NzIz", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508509723", "createdAt": "2020-10-14T16:10:02Z", "commit": {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38dffc44867ffed2d970e1a41a176623a3e6f1e6", "author": {"user": {"login": "FrankeLukas", "name": "Lukas Franke"}}, "url": "https://github.com/ls1intum/Artemis/commit/38dffc44867ffed2d970e1a41a176623a3e6f1e6", "committedDate": "2020-10-14T16:23:11Z", "message": "Create a helper util for matching a regex fully"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NTIyMjI3", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508522227", "createdAt": "2020-10-14T16:24:47Z", "commit": {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f02c800a4ee2cef0db184cfd40a93610e2b44f2", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6f02c800a4ee2cef0db184cfd40a93610e2b44f2", "committedDate": "2020-10-14T16:29:58Z", "message": "fix undefined / null issue found in review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5188f6896619f244ce77b3746865abf144ee044", "author": {"user": {"login": "FrankeLukas", "name": "Lukas Franke"}}, "url": "https://github.com/ls1intum/Artemis/commit/a5188f6896619f244ce77b3746865abf144ee044", "committedDate": "2020-10-14T16:32:17Z", "message": "Don't add only one parenthesis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54f845c08e22ef9a8860a7941e02fb7b9373d33c", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/54f845c08e22ef9a8860a7941e02fb7b9373d33c", "committedDate": "2020-10-14T21:17:14Z", "message": "Merge branch 'develop' into feature/improve-registration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42f4c19a39934efd517e7d5589c966dddd5dde4a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/42f4c19a39934efd517e7d5589c966dddd5dde4a", "committedDate": "2020-10-14T21:44:12Z", "message": "add additional course validation so that online course and registration enabled cannot be active at the same time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf0d10af2ed6ee4396a1013cccf9d21cbdb0c2f3", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/bf0d10af2ed6ee4396a1013cccf9d21cbdb0c2f3", "committedDate": "2020-10-14T22:20:48Z", "message": "fix checkstyle issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3640b7b7b4f2c682df200542ca909dc91bffbae0", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3640b7b7b4f2c682df200542ca909dc91bffbae0", "committedDate": "2020-10-14T22:22:47Z", "message": "update client dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de7fd1cea6a1099995c640d16b25d338e2d15d08", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/de7fd1cea6a1099995c640d16b25d338e2d15d08", "committedDate": "2020-10-14T22:23:04Z", "message": "Merge branch 'develop' into feature/improve-registration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4ODE5NjU2", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-508819656", "createdAt": "2020-10-14T22:38:02Z", "commit": {"oid": "de7fd1cea6a1099995c640d16b25d338e2d15d08"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzkwMzYw", "url": "https://github.com/ls1intum/Artemis/pull/2174#pullrequestreview-509390360", "createdAt": "2020-10-15T13:40:27Z", "commit": {"oid": "de7fd1cea6a1099995c640d16b25d338e2d15d08"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo0MDoyN1rOHiIXCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo0MDoyN1rOHiIXCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU1MDYwMw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r505550603", "createdAt": "2020-10-15T13:40:27Z", "author": {"login": "1-alex98"}, "path": "src/main/webapp/app/overview/course-registration-selector/course-registration-selector.component.html", "diffHunk": "@@ -1,44 +1,49 @@\n <div *ngIf=\"courses\">\n-    <div class=\"col-12 col-sm-auto\" *ngIf=\"!showCourseSelection && !addedSuccessful && isTumStudent\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de7fd1cea6a1099995c640d16b25d338e2d15d08"}, "originalPosition": 2}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3764, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}