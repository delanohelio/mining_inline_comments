{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMjIxMzQ3", "number": 2415, "title": "[Enhancement] Align buttons in some Views and add lock mechanism for Programming Assessment and some refactoring", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I followed the coding and design guidelines.\n Server: I added multiple integration tests (Spring) related to the features (with a high test coverage)\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n Client: I followed the coding and design guidelines.\n Client: I documented the TypeScript code using JSDoc style.\n Client: I added multiple screenshots/screencasts of my UI changes\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\n\n\nDescription\n\n\nAligned buttons for programming assessment like other exercise types (exercise-assessment, exercise-scores, team-assessment)\nImplemented lock functionality for programming assessment, new submission and manual result are created during lock\nRefactored code-editor-tutor-assessment.container and ProgrammingAssessmenResource a bit\n\nSteps for Testing\n\nRepeat this for normal programming exercise, team exercise and exam with programming exercise\n\nLog in to Artemis\nNavigate to Course Administration\nCreate programming exercise and participate and go to exercise assessment dashboard\nClick on Start New Assessment button, student submission should be loaded and locked for you\n4.1 Navigate back (back button or browser) DO NOT CLICK ON CANCEL, verify that is says now Continue Assessment and click\n4.2 Click on cancel button, verify that it now says again Start New Assessment-> Submission is not locked anymore\n4.3 Save/Submit assessment, after submitting button should change to Open Assessment\nGo to scores page of the exercise and verify that for those submissions that have a manual assessment the button View Assessment is displayed\nManual assessment should work as always, check also if something is not working as it should\n\nNOTE: Test also quickly assessment for modeling and file upload (I changed remove @transactional from a call)\nTest Coverage\n\n\n\n\nScreenshots\n\n\nExercise Assessment (before, during and after assessing exercises)\n\nExercise Scores view assessment button is only displayed when exercise has a manual result:\n\nTeam Assessment:\nBefore assessing exercise teamProgramming2:\n\nDuring assessment of exercise teamProgramming2 (after assessing it displays open assessment see teamProgramming2):", "createdAt": "2020-11-17T08:06:50Z", "url": "https://github.com/ls1intum/Artemis/pull/2415", "merged": true, "mergeCommit": {"oid": "0995170b82db9dcfb836815e571cf7fe8f55bc7f"}, "closed": true, "closedAt": "2020-11-18T22:18:48Z", "author": {"login": "fde312"}, "timelineItems": {"totalCount": 50, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcWDMhgH2gAyNTIyMjIxMzQ3OmUwMzllNGJiNjA2MTMyN2I0NTE2YjI5ODRiODM5ZTg0MTllMjRlNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdd0hoNAFqTUzMzg2NjE0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e039e4bb6061327b4516b2984b839e8419e24e79", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e039e4bb6061327b4516b2984b839e8419e24e79", "committedDate": "2020-11-14T06:48:31Z", "message": "rename file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5df3408ed914393c324c908b6cf7b8b39fa4d59f", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5df3408ed914393c324c908b6cf7b8b39fa4d59f", "committedDate": "2020-11-14T11:58:00Z", "message": "use same buttons as other exercise types and use resolver for locking (locking is not enabled yet)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "325274ef7c01183ecb312a28ad46abc61eaa063e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/325274ef7c01183ecb312a28ad46abc61eaa063e", "committedDate": "2020-11-14T11:58:44Z", "message": "add locking functionality to server calls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef8afa616bb71fc21ac58a98f2ab3a335935527b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/ef8afa616bb71fc21ac58a98f2ab3a335935527b", "committedDate": "2020-11-14T12:35:22Z", "message": "make it work also for new assessments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76a82b2dfe63d7ba258aeef759379324faf1191a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/76a82b2dfe63d7ba258aeef759379324faf1191a", "committedDate": "2020-11-14T18:48:51Z", "message": "try to make locking work for programming exercises"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df118e3a58deab2d4a8d6e2531f3c417afbc822b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/df118e3a58deab2d4a8d6e2531f3c417afbc822b", "committedDate": "2020-11-15T10:31:02Z", "message": "add check and enable lock also for next submission and set result always rated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "032b7f42fa5c343f948953a14e324cf446a56a1f", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/032b7f42fa5c343f948953a14e324cf446a56a1f", "committedDate": "2020-11-15T10:31:56Z", "message": "use same buttons for team assessment and also for scores page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0f96da2acf79734a6b81f2982a419b888eb8a24", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d0f96da2acf79734a6b81f2982a419b888eb8a24", "committedDate": "2020-11-15T21:03:41Z", "message": "fix issue with router link and naming of button + run spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "937078ce9e3b84fb6553bba2ffbfce38ef450827", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/937078ce9e3b84fb6553bba2ffbfce38ef450827", "committedDate": "2020-11-15T21:59:42Z", "message": "delete not used component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d153d0e46bb0272b2c70a7cc120248b42cf0987a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d153d0e46bb0272b2c70a7cc120248b42cf0987a", "committedDate": "2020-11-15T23:55:48Z", "message": "copy the feedbacks during the lock into the new result.\nremove import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37e7c97ded58d849a56b088987c9486cc27c4d00", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/37e7c97ded58d849a56b088987c9486cc27c4d00", "committedDate": "2020-11-16T05:36:30Z", "message": "fix issue with copying the automatic feedback and change save/submit call as it is always ensured to have a manual result in the database"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3398eba135215314d8d10adf8a360b1f2f8bb826", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3398eba135215314d8d10adf8a360b1f2f8bb826", "committedDate": "2020-11-16T08:36:32Z", "message": "refactor to avoid not needed calls as automatic feedback is already included in manual feedback when locking the assessment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ba7d468d56dc176f8bbb4279eec2c804560e39d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6ba7d468d56dc176f8bbb4279eec2c804560e39d", "committedDate": "2020-11-16T11:40:51Z", "message": "fix cancel assessment and issue with no result string when creating manual result during the lock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "358baa55cbd51ff6b0564d476e764d863a62e03e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/358baa55cbd51ff6b0564d476e764d863a62e03e", "committedDate": "2020-11-16T12:11:00Z", "message": "removed commented out code and display view submission button in exercise score only when a manual result is available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d045e6ec1e7b320deab153f6598be4331796c4a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6d045e6ec1e7b320deab153f6598be4331796c4a", "committedDate": "2020-11-16T20:07:52Z", "message": "make sure that route for new assessment is triggered"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b257cee86333234d363246c32c9d4af1bf74a42", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/2b257cee86333234d363246c32c9d4af1bf74a42", "committedDate": "2020-11-16T20:09:55Z", "message": "add info about locklimit when reached"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef5ca7ac391190fafbe83d9a3ff7ba56c4a4abf3", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/ef5ca7ac391190fafbe83d9a3ff7ba56c4a4abf3", "committedDate": "2020-11-16T21:03:45Z", "message": "improve error handling for team assessment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4c3b53aee2d437bbc22391301a92e9b3863e1d9", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a4c3b53aee2d437bbc22391301a92e9b3863e1d9", "committedDate": "2020-11-16T21:05:26Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcff484772dbb205f716e1695fec59ffb650e6ba", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/fcff484772dbb205f716e1695fec59ffb650e6ba", "committedDate": "2020-11-17T07:53:55Z", "message": "rename to view assessment + add lock limit to 2 for testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4810cc1cd80689daf9106f8de5e6a2cc79be5f1a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/4810cc1cd80689daf9106f8de5e6a2cc79be5f1a", "committedDate": "2020-11-17T12:29:07Z", "message": "fix server tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNTAzMzI1", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-532503325", "createdAt": "2020-11-17T15:41:30Z", "commit": {"oid": "fcff484772dbb205f716e1695fec59ffb650e6ba"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6b9a84a9e96b70806b9d033d4cefe77f283841c", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f6b9a84a9e96b70806b9d033d4cefe77f283841c", "committedDate": "2020-11-17T19:45:49Z", "message": "add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08c15eb1fb18dbd6dbbb9cbbb5096d52257b711d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/08c15eb1fb18dbd6dbbb9cbbb5096d52257b711d", "committedDate": "2020-11-17T19:46:04Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e77a55ce63e8e98b16474f1009c6ab0bd4657f34", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e77a55ce63e8e98b16474f1009c6ab0bd4657f34", "committedDate": "2020-11-17T21:32:15Z", "message": "fix client tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "author": {"user": {"login": "fde312", "name": "Francisco De las Casas Young"}}, "url": "https://github.com/ls1intum/Artemis/commit/75c4457e82feb0829f19dfe84e2c47d8f84916ff", "committedDate": "2020-11-17T21:51:33Z", "message": "Merge branch 'develop' into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyODQ4MTU4", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-532848158", "createdAt": "2020-11-17T22:00:08Z", "commit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMjowMDowOFrOH1NNlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMjowMDowOFrOH1NNlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1MzA0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get a file upload submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n          \n          \n            \n                 * Get a programming exercise submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525553047", "createdAt": "2020-11-17T22:00:08Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a file upload submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyODYwNzIx", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-532860721", "createdAt": "2020-11-17T22:19:49Z", "commit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyODUxNjA4", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-532851608", "createdAt": "2020-11-17T22:05:11Z", "commit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMjowNToxMVrOH1NXuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMjo0NDowNVrOH1OiCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1NTY0Mw==", "bodyText": "I'd rename the variable to manualResult if because the statement just looks for the first manual result. I guess this is fine because only one manual result can exist now.", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525555643", "createdAt": "2020-11-17T22:05:11Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -120,13 +118,11 @@ public ProgrammingAssessmentResource(AuthorizationCheckService authCheckService,\n \n         User user = userService.getUserWithGroupsAndAuthorities();\n \n-        Optional<Result> latestExistingResult = participation.getResults().stream().filter(result -> result.isManualResult()).findFirst();\n-        if (latestExistingResult.isPresent()) {\n-            // prevent that tutors create multiple manual results\n-            newResult.setId(latestExistingResult.get().getId());\n-            // load assessor\n-            latestExistingResult = resultRepository.findWithEagerSubmissionAndFeedbackAndAssessorById(latestExistingResult.get().getId());\n-        }\n+        Result latestExistingResult = participation.getResults().stream().filter(result -> result.isManualResult()).findFirst().get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2NzE3OA==", "bodyText": "Is this call necessary? latestExistingResult should already have an safe submission fetched from the DB.", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525567178", "createdAt": "2020-11-17T22:28:27Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -168,18 +164,9 @@ else if (!newResult.getFeedbacks().isEmpty() && newResult.getFeedbacks().stream(\n             throw new BadRequestAlertException(\"In case feedback is present, a feedback must contain points.\", ENTITY_NAME, \"feedbackCreditsNull\");\n         }\n \n-        ProgrammingSubmission submission;\n-        if (latestExistingResult.isEmpty()) {\n-            // Create manual submission with last commit hash and current time stamp.\n-            submission = programmingSubmissionService.createSubmissionWithLastCommitHashForParticipation((ProgrammingExerciseStudentParticipation) participation,\n-                    SubmissionType.MANUAL);\n-            newResult.setSubmission(submission);\n-        }\n-        else {\n-            submission = programmingSubmissionService.findByIdWithEagerResultAndFeedback(latestExistingResult.get().getSubmission().getId());\n-            newResult.setSubmission(submission);\n-        }\n-\n+        // make sure that the submission cannot be manipulated on the client side\n+        ProgrammingSubmission submission = programmingSubmissionService.findByIdWithEagerResultAndFeedback(latestExistingResult.getSubmission().getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2NzYzNA==", "bodyText": "Add param lockSubmission to JavaDoc", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525567634", "createdAt": "2020-11-17T22:29:29Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingSubmissionResource.java", "diffHunk": "@@ -355,7 +355,8 @@ public ProgrammingSubmissionResource(ProgrammingSubmissionService programmingSub\n      */\n     @GetMapping(value = \"/exercises/{exerciseId}/programming-submission-without-assessment\")\n     @PreAuthorize(\"hasAnyRole('TA', 'INSTRUCTOR', 'ADMIN')\")\n-    public ResponseEntity<ProgrammingSubmission> getProgrammingSubmissionWithoutAssessment(@PathVariable Long exerciseId) {\n+    public ResponseEntity<ProgrammingSubmission> getProgrammingSubmissionWithoutAssessment(@PathVariable Long exerciseId,\n+            @RequestParam(value = \"lock\", defaultValue = \"false\") boolean lockSubmission) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2ODA2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                    // final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525568069", "createdAt": "2020-11-17T22:30:19Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingSubmissionResource.java", "diffHunk": "@@ -369,14 +370,24 @@ public ProgrammingSubmissionResource(ProgrammingSubmissionService programmingSub\n             return forbidden();\n         }\n \n-        // TODO: Handle lock limit.\n+        // Check if the limit of simultaneously locked submissions has been reached\n+        programmingSubmissionService.checkSubmissionLockLimit(programmingExercise.getCourseViaExerciseGroupOrCourseMember().getId());\n+\n+        final ProgrammingSubmission programmingSubmission;\n+        if (lockSubmission) {\n+            programmingSubmission = programmingSubmissionService.getLockedProgrammingSubmissionWithoutResult(programmingExercise);\n+        }\n+        else {\n+            Optional<ProgrammingSubmission> optionalProgrammingSubmission = programmingSubmissionService.getRandomProgrammingSubmissionEligibleForNewAssessment(programmingExercise,\n+                    programmingExercise.hasExerciseGroup());\n+            if (optionalProgrammingSubmission.isEmpty()) {\n+                return notFound();\n+            }\n+            programmingSubmission = optionalProgrammingSubmission.get();\n \n-        Optional<ProgrammingSubmission> optionalProgrammingSubmission = programmingSubmissionService.getRandomProgrammingSubmissionEligibleForNewAssessment(programmingExercise,\n-                programmingExercise.hasExerciseGroup());\n-        if (optionalProgrammingSubmission.isEmpty()) {\n-            return notFound();\n         }\n-        final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();\n+\n+        // final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU3NDY2Nw==", "bodyText": "I would rather check here, that no manual feedback exist.", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525574667", "createdAt": "2020-11-17T22:44:05Z", "author": {"login": "kloessst"}, "path": "src/main/webapp/app/exercises/programming/assess/code-editor-tutor-assessment-container.component.ts", "diffHunk": "@@ -386,19 +380,14 @@ export class CodeEditorTutorAssessmentContainerComponent implements OnInit, OnDe\n     }\n \n     private handleFeedback(): void {\n-        // Setup automatic feedback\n-        this.automaticFeedback = this.automaticResult?.feedbacks ?? [];\n-        this.automaticFeedback.forEach((feedback) => {\n-            feedback.id = undefined;\n-            if (!feedback.credits) {\n-                feedback.credits = 0;\n-            }\n-        });\n-\n-        // Setup not automatically generated feedbacks\n         const feedbacks = this.manualResult?.feedbacks || [];\n-        this.unreferencedFeedback = feedbacks.filter((feedbackElement) => feedbackElement.reference == undefined && feedbackElement.type === FeedbackType.MANUAL_UNREFERENCED);\n+        this.automaticFeedback = feedbacks.filter((feedback) => feedback.type === FeedbackType.AUTOMATIC);\n+        // When manual result only contains automatic feedback elements (when assessing for the first time), no manual assessment was yet saved or submitted.\n+        if (this.manualResult?.feedbacks && this.manualResult.feedbacks.length === this.automaticFeedback.length) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff"}, "originalPosition": 192}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcea2d2179f41eb89628b0c80da9ffea9df18288", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/fcea2d2179f41eb89628b0c80da9ffea9df18288", "committedDate": "2020-11-18T01:22:14Z", "message": "small fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyOTQ2ODY4", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-532946868", "createdAt": "2020-11-18T01:32:42Z", "commit": {"oid": "fcea2d2179f41eb89628b0c80da9ffea9df18288"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/8012d71bc5449d3be974749c61a10014a58a20c9", "committedDate": "2020-11-18T10:45:31Z", "message": "try to fix issue with hibernate exception, incorporate feedback and improve the check for isFirstAssessment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDEyMTU5", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533412159", "createdAt": "2020-11-18T12:50:09Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDEyNzAx", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533412701", "createdAt": "2020-11-18T12:50:54Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDEyODIw", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533412820", "createdAt": "2020-11-18T12:51:03Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMzg0Mjkx", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533384291", "createdAt": "2020-11-18T12:13:42Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjoxMzo0MlrOH1q8CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjoxMzo0MlrOH1q8CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA0MDA3Mw==", "bodyText": "A bit confusing method name, maybe LockAndGetProgrammingSubmissionWithoutResult makes more sense", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526040073", "createdAt": "2020-11-18T12:13:42Z", "author": {"login": "TobiasPr"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a programming submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n+     *\n+     * @param exercise the exercise the submission should belong to\n+     * @return a locked programming submission that needs an assessment\n+     */\n+    @Transactional\n+    public ProgrammingSubmission getLockedProgrammingSubmissionWithoutResult(ProgrammingExercise exercise) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDk3OTU0", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533497954", "createdAt": "2020-11-18T14:26:24Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDoyNjoyNFrOH1wSMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDoyNjoyNFrOH1wSMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzY2Ng==", "bodyText": "can we please remove this @Transactional here", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526127666", "createdAt": "2020-11-18T14:26:24Z", "author": {"login": "krusche"}, "path": "src/main/java/de/tum/in/www1/artemis/service/SubmissionService.java", "diffHunk": "@@ -163,19 +163,20 @@ public long countSubmissionLocks(long courseId) {\n      * No manual result means that no user has started an assessment for the corresponding submission yet.\n      * For exam exercises we should also remove the test run participations as these should not be graded by the tutors.\n      *\n-     * @param fileUploadExercise the exercise for which we want to retrieve a submission without manual result\n+     * @param exercise the exercise for which we want to retrieve a submission without manual result\n      * @param examMode flag to determine if test runs should be removed. This should be set to true for exam exercises\n      * @return a submission without any manual result or an empty Optional if no submission without manual result could be found\n      */\n     @Transactional(readOnly = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDk4MDY2", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533498066", "createdAt": "2020-11-18T14:26:31Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDoyNjozMVrOH1wSlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDoyNjozMVrOH1wSlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzc2NQ==", "bodyText": "please remove this @Transactional here", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526127765", "createdAt": "2020-11-18T14:26:31Z", "author": {"login": "krusche"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a programming submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n+     *\n+     * @param exercise the exercise the submission should belong to\n+     * @return a locked programming submission that needs an assessment\n+     */\n+    @Transactional", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d891c73f14c2776d74eb6a9d0fe95e8f4079f07", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/2d891c73f14c2776d74eb6a9d0fe95e8f4079f07", "committedDate": "2020-11-18T14:29:44Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjQ4NTE3", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533648517", "createdAt": "2020-11-18T16:48:31Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjU3NjEz", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533657613", "createdAt": "2020-11-18T16:57:00Z", "commit": {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc2f9d613a20195d6c2339d1eca0ea95950b888a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/dc2f9d613a20195d6c2339d1eca0ea95950b888a", "committedDate": "2020-11-18T20:04:50Z", "message": "removed transactional for lock call for exercise types and renamed method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e07926310e2ba21e8689c98fcc74a50d412f1fc8", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e07926310e2ba21e8689c98fcc74a50d412f1fc8", "committedDate": "2020-11-18T20:07:20Z", "message": "make codacy happier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70e24904a3279f8bfbdf2419cb221ba00071e486", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/70e24904a3279f8bfbdf2419cb221ba00071e486", "committedDate": "2020-11-18T20:08:29Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODM1NDQ1", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533835445", "createdAt": "2020-11-18T20:11:43Z", "commit": {"oid": "70e24904a3279f8bfbdf2419cb221ba00071e486"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7129488099e7c064fe01443a986d8d5aa7a4c11b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/7129488099e7c064fe01443a986d8d5aa7a4c11b", "committedDate": "2020-11-18T20:50:47Z", "message": "add check for 404 error no unassessed submissions left"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69daa9f71f5f6810537a14b7c61b0362a10b0f27", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/69daa9f71f5f6810537a14b7c61b0362a10b0f27", "committedDate": "2020-11-18T20:51:06Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODY1MzIy", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533865322", "createdAt": "2020-11-18T20:51:42Z", "commit": {"oid": "70e24904a3279f8bfbdf2419cb221ba00071e486"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODY1NTg0", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533865584", "createdAt": "2020-11-18T20:52:05Z", "commit": {"oid": "70e24904a3279f8bfbdf2419cb221ba00071e486"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODY1OTEx", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533865911", "createdAt": "2020-11-18T20:52:31Z", "commit": {"oid": "69daa9f71f5f6810537a14b7c61b0362a10b0f27"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODY2MTQ4", "url": "https://github.com/ls1intum/Artemis/pull/2415#pullrequestreview-533866148", "createdAt": "2020-11-18T20:52:50Z", "commit": {"oid": "69daa9f71f5f6810537a14b7c61b0362a10b0f27"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3679, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}