{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5OTk3Njcy", "number": 1497, "title": "Fix programming exercise template setup on Windows machines", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest2.ase.in.tum.de.\n\nMotivation and Context\nTemplates are not pushed to template, test and solution repositories when a new programming exercise is created on Windows machines. This makes working on programming exercises slow and tedious.\nAlso described in Issue 1494\nAdditionally, the code editor is not working properly on Windows.\nDescription\nFileService.replacePlaceholderSections throws an IOException(\"The process cannot access the file because it is being used by another process\") as streams are not properly closed before being accessed again.\nFileService.copyResources uses an URL representation of a Path. URLs use '/' as a File separator. Prefix is constructed using File.separator (\\ on Windows)\nOperations on the String URL will show unexpected behavior, because of the File separator mismatch.\n-> Template copy destination path won't match the set up local repository -> empty commit\nSteps for Testing\nBehavior of Artemis, running on MAC or Linux systems, should not change.\nRepositories for programming exercises should be set up correctly on Windows now.\nCode Editor should work on all systems.\nPlease test on Test Server 1 (Bitbucket + Bamboo) and Test Server 2 (Gitlab + Jenkins)\nTest repository setup\n\nLog in to Artemis\nNavigate to Course Management\nCreate a programming exercise, allowing the online code editor\nInspect created repositories\n--> Templates are correctly set up for the template, solution and test repository.\nNavigate to Course Management Exercise Details\nInspect template and solution results\n--> Template result is at 0% and solution result is at 100%\n\nTest code editor\n\nLog in to Artemis\nParticipate in a programming exercise with code editor enabled\nOpen the code editor\n-> Files starting with a dot are not displayed in the browser on the left side\nChange the content of a file and save it\n-> File is saved\nSubmit the changes\n-> Build process is triggered and the results are displayed", "createdAt": "2020-05-19T09:35:18Z", "url": "https://github.com/ls1intum/Artemis/pull/1497", "merged": true, "mergeCommit": {"oid": "8bc494fa4c22c8fba89305074f37da0016c0737d"}, "closed": true, "closedAt": "2020-05-21T07:03:38Z", "author": {"login": "kloessst"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciw6WWgH2gAyNDE5OTk3NjcyOjU1MDAyNDg2NzdkYzI0ODg4YWYwZjk3NmY2OTQyOGNiMDE1YjZjNTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjYLSegFqTQxNTkyMzQxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5500248677dc24888af0f976f69428cb015b6c50", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/5500248677dc24888af0f976f69428cb015b6c50", "committedDate": "2020-05-19T09:18:41Z", "message": "Close resources before files are accessed again. Switch from URL to Path representation of files to fix String operations on String path."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "012ba147da340f7d1c6b767a964cbeea98b8046b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/012ba147da340f7d1c6b767a964cbeea98b8046b", "committedDate": "2020-05-19T19:45:27Z", "message": "Make windows directories safe"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTEyMDAx", "url": "https://github.com/ls1intum/Artemis/pull/1497#pullrequestreview-415112001", "createdAt": "2020-05-20T08:36:53Z", "commit": {"oid": "012ba147da340f7d1c6b767a964cbeea98b8046b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTYzOTYy", "url": "https://github.com/ls1intum/Artemis/pull/1497#pullrequestreview-415163962", "createdAt": "2020-05-20T09:40:56Z", "commit": {"oid": "012ba147da340f7d1c6b767a964cbeea98b8046b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo0MDo1NlrOGYDkbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo0MDo1NlrOGYDkbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg3NzQ4Nw==", "bodyText": "This does not solve the issue for windows as we then execute string operations on the path. As a result the escape character \"\\\" and the following character are not counted as part of the string.", "url": "https://github.com/ls1intum/Artemis/pull/1497#discussion_r427877487", "createdAt": "2020-05-20T09:40:56Z", "author": {"login": "anditurdiu"}, "path": "src/main/java/de/tum/in/www1/artemis/service/FileService.java", "diffHunk": "@@ -294,10 +294,10 @@ public void copyResources(Resource[] resources, String prefix, String targetDire\n \n         for (Resource resource : resources) {\n \n-            String fileUrl = java.net.URLDecoder.decode(resource.getURL().toString(), \"UTF-8\");\n+            String filePath = resource.getFile().getAbsolutePath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "012ba147da340f7d1c6b767a964cbeea98b8046b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "122dfb992fbb7120a3e20e4a4fd00698564d241e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/122dfb992fbb7120a3e20e4a4fd00698564d241e", "committedDate": "2020-05-20T10:26:15Z", "message": "Replace File.separator with \"/\" for universal separator\nReplace the windows separator with \"/\" as java maps \"/\" to the windows separator internally.\nFix repos not being pushed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb61e1a2b8382d6502f4a32a7c6f95504c7c8942", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/bb61e1a2b8382d6502f4a32a7c6f95504c7c8942", "committedDate": "2020-05-20T14:09:03Z", "message": "Close InputStreams, throws error on windows as files are still in use"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58bc72ef5c0f0d94325000c5986a8e201bda7ec1", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/58bc72ef5c0f0d94325000c5986a8e201bda7ec1", "committedDate": "2020-05-20T14:13:18Z", "message": "fix gradlew spotlessCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c19289f0f01fb56f96b6a4200575dd192eecce94", "author": {"user": {"login": "anditurdiu", "name": "Andi Turdiu"}}, "url": "https://github.com/ls1intum/Artemis/commit/c19289f0f01fb56f96b6a4200575dd192eecce94", "committedDate": "2020-05-20T14:23:24Z", "message": "Remove inputStream.close() from Servlet stream\n\nThese should not be closed as it could interfere with the request lifecycle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c60cd3cb92c2a663927f1602e616f9737cf4e927", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/c60cd3cb92c2a663927f1602e616f9737cf4e927", "committedDate": "2020-05-20T16:26:29Z", "message": "Fix for files hidden files on windows\nWindows does not mark files starting with '.' as hidden. These must be excluded manually from being shown on the code editor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0c833387b1a8d1b990b38dcbf1378c4ba866fa7", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/b0c833387b1a8d1b990b38dcbf1378c4ba866fa7", "committedDate": "2020-05-20T16:28:17Z", "message": "gradlew spotlessApply"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1OTIzNDE0", "url": "https://github.com/ls1intum/Artemis/pull/1497#pullrequestreview-415923414", "createdAt": "2020-05-21T07:03:29Z", "commit": {"oid": "b0c833387b1a8d1b990b38dcbf1378c4ba866fa7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2680, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}