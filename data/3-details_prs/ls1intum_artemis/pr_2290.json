{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNzM1ODk2", "number": 2290, "title": "[Enhancement] Improve user interface for Manual Assessment of Programming Exercises", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I implemented the changes with a good performance and prevented too many database calls\n Server: I documented the Java code using JavaDoc style.\n Client: I documented the TypeScript code using JSDoc style.\n Client: I added multiple screenshots/screencasts of my UI changes\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\n\n\nWe want to improve the UI of the manual assessment of programming exercises and align it more to the other exercises.\nDescription\n\nComment from @krusche in #2223 :\n\n Only show 1 result (top right corner) at the same time based on the last automatic one, that automatically adapts to the manual assessment input. This means it should also be clickable and show the current manual and automatic feedback in the popup\n Remove the Grading Instructions below the code editor\n  Move the button Download repos to the upper right corner left to the result, rename it to \"Download repo\" on this page, because only one single repository will be downloaded\n  Also move the link \"Go to repository\" to the upper right corner left to the result\n The result should show the current score in percentage (in addition it can show the score in points in case this is helpful, but then both needs to be in sync)\n \u00a0In the exercise dashboard, change the buttons \"New Result\" and \"Update result\" to how they are named in other exercise types. This has to be consistent. -> Follow-up PR\n\nSteps for Testing\n\n\nLog in to Artemis\nNavigate to Course Administration\nCreate programming exercise with SCA and without SCA\nParticipate, Assess, Complain and Assess the Complain (everything should work as intended, try out different scenarios)\nTry also out the Configure Grading see PR test steps of #2223 (steps for programming exercise)\n\nTest Coverage\n\nScreenshots\n\n\nScreenshots are made with a SCA Programming Exercise with 100 maxScore and 10 bonus points, and deduction for code style issues each 1 point.\nNOTE: Do not wonder why the issues are not listed in the result string before the configure grading test case change. I used submissions, where adding the issue numbers into the result string, was not yet implemented.\nNew layout of assessment view:\n\n\nWhen changing the feedback elements, result string adapts automatically (did not press on save or submit)\n\nAlso displayed in the dialog:\n\nAfter clicking on save the preliminary assessment is visible. (still not visible for students)\n\nAfter submitting (tutor view):\n\nStudent sees the new result string:\n\nAfter Changing configure grading (1 extra point for correct bubbleSortTest), the result string adapts accordingly:\nNOTE: Now the issues are listed in the result string as well (were not before because of 'old' submission)\n\n\nAfter student complaint and assessing the complaint (adding 10 points in inline feedback and 10 points unreferenced)\n\n\n\nStudent view after assessing the complaint:", "createdAt": "2020-10-28T17:58:39Z", "url": "https://github.com/ls1intum/Artemis/pull/2290", "merged": true, "mergeCommit": {"oid": "19e41a5cbce43aec39a36b09c5e16c68049e7824"}, "closed": true, "closedAt": "2020-10-29T22:21:25Z", "author": {"login": "fde312"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWaE5bgH2gAyNTExNzM1ODk2OmUzYjdmMjgwNDM5YjljMmY3NzAzZTdjNGY5ODU4NDJiNTE2MzhlMGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXZIuZgFqTUyMDEwNTU1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e3b7f280439b9c2f7703e7c4f985842b51638e0d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e3b7f280439b9c2f7703e7c4f985842b51638e0d", "committedDate": "2020-10-26T20:06:27Z", "message": "change layout and remove not used components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02bd2f64cb15355fda4b711f38ecf3aa68a96de0", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/02bd2f64cb15355fda4b711f38ecf3aa68a96de0", "committedDate": "2020-10-27T11:51:07Z", "message": "adapt the result string to display the points of the assessment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e67f87577fc3a6275200ce8440224ae06f838fc8", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e67f87577fc3a6275200ce8440224ae06f838fc8", "committedDate": "2020-10-27T13:31:11Z", "message": "add more checks to REST CALL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a01732c4869f0dbb5e98571fb1a305a01831f61d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a01732c4869f0dbb5e98571fb1a305a01831f61d", "committedDate": "2020-10-27T13:35:08Z", "message": "adapt submit call from ProgrammingAssessmentService and setResultString from ProgrammingExerciseGradingService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d595d0b1b17277bc0beeb8b6dbe7b74c4fd1671e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d595d0b1b17277bc0beeb8b6dbe7b74c4fd1671e", "committedDate": "2020-10-27T19:13:21Z", "message": "fix tests of ProgrammingExerciseGradingService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5a270288dcf2d2f7ddbba2377db9d9fb0157bd3", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f5a270288dcf2d2f7ddbba2377db9d9fb0157bd3", "committedDate": "2020-10-27T21:59:07Z", "message": "fix issue with boolean check and set score and result string for result creation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3eb329df8209b6da562d1859638a1ba7658389ef", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3eb329df8209b6da562d1859638a1ba7658389ef", "committedDate": "2020-10-28T09:40:14Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface\n\n# Conflicts:\n#\tsrc/main/webapp/app/exercises/programming/assess/code-editor-tutor-assessment-container.component.html"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbd30ba3ec30d413a924439a42ff36a56d909bf3", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/bbd30ba3ec30d413a924439a42ff36a56d909bf3", "committedDate": "2020-10-28T14:22:13Z", "message": "adapt more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c159cd1dbc0afdb6184ff550e5487078d9dd007", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/4c159cd1dbc0afdb6184ff550e5487078d9dd007", "committedDate": "2020-10-28T15:54:22Z", "message": "improve code and add functionality for updateAfterComplaint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3729f60a8d37ca95ab097eefd46ae5a1b86e200e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3729f60a8d37ca95ab097eefd46ae5a1b86e200e", "committedDate": "2020-10-28T17:57:24Z", "message": "rename download repos button and run prettier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3868fd5c7c90764385e092d06429c0803600de8b", "committedDate": "2020-10-28T21:25:17Z", "message": "fix broken tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5Mjc3MjE3", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-519277217", "createdAt": "2020-10-29T01:57:07Z", "commit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMTo1NzowN1rOHqEWZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMjoxOTowMFrOHqE8wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3MzUxMQ==", "bodyText": "I don't think you need JsonIgnore for a method named \"create...\". Jackson should ignore this by default.", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513873511", "createdAt": "2020-10-29T01:57:07Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -137,6 +137,24 @@ public void setResultString(Double totalScore, @Nullable Double maxScore) {\n         }\n     }\n \n+    /**\n+     * Builds a part of the result string of manual results for programming exercises\n+     *\n+     * @param totalScore total amount of scored points\n+     * @param maxScore   maximum score reachable at corresponding exercise\n+     * @return String with result string for manual result of a progrmaming exercise\n+     */\n+    @JsonIgnore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3NDIxNA==", "bodyText": "This seems like a duplication of lines 130-138. You could call the create method within the set method.", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513874214", "createdAt": "2020-10-29T01:58:42Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -137,6 +137,24 @@ public void setResultString(Double totalScore, @Nullable Double maxScore) {\n         }\n     }\n \n+    /**\n+     * Builds a part of the result string of manual results for programming exercises\n+     *\n+     * @param totalScore total amount of scored points\n+     * @param maxScore   maximum score reachable at corresponding exercise\n+     * @return String with result string for manual result of a progrmaming exercise\n+     */\n+    @JsonIgnore\n+    public String createResultStringForManualResult(Double totalScore, @Nullable Double maxScore) {\n+        DecimalFormat formatter = new DecimalFormat(\"#.##\");\n+        if (maxScore == null) {\n+            return formatter.format(totalScore) + \" points\";\n+        }\n+        else {\n+            return formatter.format(totalScore) + \" of \" + formatter.format(maxScore) + \" points\";\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3OTM2OQ==", "bodyText": "Do we need the exercise type case distinction here? If ProgrammingAssessmentService inherits from AssessmentService, you should override updateAssessmentAfterComplaint and call it on the child class.", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513879369", "createdAt": "2020-10-29T02:10:23Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/service/AssessmentService.java", "diffHunk": "@@ -109,8 +109,22 @@ public Result updateAssessmentAfterComplaint(Result originalResult, Exercise exe\n \n         // Update the result that was complained about with the new feedback\n         originalResult.updateAllFeedbackItems(assessmentUpdate.getFeedbacks());\n-        Double calculatedScore = calculateTotalScore(originalResult.getFeedbacks());\n-        return submitResult(originalResult, exercise, calculatedScore);\n+        if (exercise instanceof ProgrammingExercise) {\n+            double points = ((ProgrammingAssessmentService) this).calculateTotalScore(originalResult);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg4MzMyOA==", "bodyText": "I'd suggest moving the validation of newResult as far up as possible in the method. Validation should be done before services are used.", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513883328", "createdAt": "2020-10-29T02:19:00Z", "author": {"login": "kloessst"}, "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -144,7 +144,19 @@ public ProgrammingAssessmentResource(AuthorizationCheckService authCheckService,\n             return forbidden();\n         }\n \n-        if (newResult.getScore() != null && newResult.getScore() < 100 && newResult.isSuccessful()) {\n+        if (Boolean.FALSE.equals(newResult.isRated())) {\n+            throw new BadRequestAlertException(\"Result is not rated\", ENTITY_NAME, \"resultNotRated\");\n+        }\n+        if (newResult.getResultString() == null) {\n+            throw new BadRequestAlertException(\"Result string is required.\", ENTITY_NAME, \"resultStringNull\");\n+        }\n+        else if (newResult.getResultString().length() > 255) {\n+            throw new BadRequestAlertException(\"Result string is too long.\", ENTITY_NAME, \"resultStringNull\");\n+        }\n+        else if (newResult.getScore() == null) {\n+            throw new BadRequestAlertException(\"Score is required.\", ENTITY_NAME, \"scoreNull\");\n+        }\n+        else if (newResult.getScore() < 100 && newResult.isSuccessful()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3868fd5c7c90764385e092d06429c0803600de8b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a49572771ae1435c8863f1c1ed23a874b999a89", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5a49572771ae1435c8863f1c1ed23a874b999a89", "committedDate": "2020-10-29T12:42:18Z", "message": "apply suggestions from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f866f20eeb7f7687943942b3d423192350667099", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f866f20eeb7f7687943942b3d423192350667099", "committedDate": "2020-10-29T12:42:27Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8408f590a85940a79aef410e992947bcc56139b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a8408f590a85940a79aef410e992947bcc56139b", "committedDate": "2020-10-29T19:24:16Z", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface\n\n# Conflicts:\n#\tsrc/main/java/de/tum/in/www1/artemis/service/AssessmentService.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMDM5OTA0", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-520039904", "createdAt": "2020-10-29T20:06:32Z", "commit": {"oid": "a8408f590a85940a79aef410e992947bcc56139b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6e4dfb94582bd405e6f397c49f7eacf1ba0e249", "author": {"user": {"login": "anditurdiu", "name": "Andi Turdiu"}}, "url": "https://github.com/ls1intum/Artemis/commit/a6e4dfb94582bd405e6f397c49f7eacf1ba0e249", "committedDate": "2020-10-29T21:17:51Z", "message": "Merge branch 'develop' into enhancement/programming-assessment/improve-user-interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMDk1Mzg0", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-520095384", "createdAt": "2020-10-29T21:18:47Z", "commit": {"oid": "a6e4dfb94582bd405e6f397c49f7eacf1ba0e249"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMDk2MjUz", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-520096253", "createdAt": "2020-10-29T21:20:17Z", "commit": {"oid": "a6e4dfb94582bd405e6f397c49f7eacf1ba0e249"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMTAyMTU2", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-520102156", "createdAt": "2020-10-29T21:28:40Z", "commit": {"oid": "a6e4dfb94582bd405e6f397c49f7eacf1ba0e249"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20bbf13cacea2640d03ac7fbd8f265a286586c8f", "author": {"user": {"login": "schultek", "name": "Kilian Schulte"}}, "url": "https://github.com/ls1intum/Artemis/commit/20bbf13cacea2640d03ac7fbd8f265a286586c8f", "committedDate": "2020-10-29T21:28:53Z", "message": "Merge branch 'develop' into enhancement/programming-assessment/improve-user-interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMTA1NTU1", "url": "https://github.com/ls1intum/Artemis/pull/2290#pullrequestreview-520105555", "createdAt": "2020-10-29T21:34:40Z", "commit": {"oid": "20bbf13cacea2640d03ac7fbd8f265a286586c8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3519, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}