{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MDE4NTA0", "number": 1447, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDoyNzozMVrOD_VudA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQyMDoxNTozNlrOD_drqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzQyODM2OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/tum/in/www1/artemis/service/AssessmentService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDoyNzozMVrOGZ8oHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDoyNzozMVrOGZ8oHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2MDg5Mg==", "bodyText": "Could you remove the whole method since it doesn't have a purpose anymore?", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r429860892", "createdAt": "2020-05-25T10:27:31Z", "author": {"login": "madwau"}, "path": "src/main/java/de/tum/in/www1/artemis/service/AssessmentService.java", "diffHunk": "@@ -155,9 +155,10 @@ public Submission getSubmissionOfExampleSubmissionWithResult(long submissionId)\n      */\n     void checkGeneralFeedback(List<Feedback> assessment) {\n         final long generalFeedbackCount = assessment.stream().filter(feedback -> feedback.getReference() == null).count();\n-        if (generalFeedbackCount > 1) {\n-            throw new BadRequestAlertException(\"There cannot be more than one general Feedback per Assessment\", \"assessment\", \"moreThanOneGeneralFeedback\");\n-        }\n+        // Hanya: this check is not relevant anymore as we allow unreferenced feedback for missing submission elements", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzQzNjc1OnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDozMDo1MVrOGZ8tdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDozMDo1MVrOGZ8tdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2MjI2MA==", "bodyText": "feedbackElement.reference == null should be redundant here, since FeedbackType.MANUAL_UNREFERENCED already implies that, right?", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r429862260", "createdAt": "2020-05-25T10:30:51Z", "author": {"login": "madwau"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "diffHunk": "@@ -200,13 +203,14 @@ export class ModelingAssessmentEditorComponent implements OnInit {\n             return;\n         }\n \n-        const generalFeedbackIndex = feedback.findIndex((feedbackElement) => feedbackElement.reference == null);\n+        const generalFeedbackIndex = feedback.findIndex((feedbackElement) => feedbackElement.reference == null && feedbackElement.type !== FeedbackType.MANUAL_UNREFERENCED);\n         if (generalFeedbackIndex >= 0) {\n             this.generalFeedback = feedback[generalFeedbackIndex] || new Feedback();\n             feedback.splice(generalFeedbackIndex, 1);\n         }\n \n-        this.referencedFeedback = feedback;\n+        this.referencedFeedback = feedback.filter((feedbackElement) => feedbackElement.reference != null);\n+        this.unreferencedFeedback = feedback.filter((feedbackElement) => feedbackElement.reference == null && feedbackElement.type === FeedbackType.MANUAL_UNREFERENCED);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzQ1NDgzOnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDozNzozOFrOGZ84eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxOTowNDo1OFrOGaIKBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2NTA4MA==", "bodyText": "The method calculateTotalScore could be shortened to:\nthis.totalScore = (this.feedback || []).reduce((totalScore, feedback) => totalScore + feedback.credits!)", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r429865080", "createdAt": "2020-05-25T10:37:38Z", "author": {"login": "madwau"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "diffHunk": "@@ -480,4 +486,21 @@ export class ModelingAssessmentEditorComponent implements OnInit {\n     private removeHighlightedFeedbackOfColor(highlightedElements: Map<string, string>, color: string) {\n         return new Map<string, string>([...highlightedElements].filter(([, value]) => value !== color));\n     }\n+    /**\n+     * Calculates the total score of the current assessment.\n+     * This function originally checked whether the total score is negative\n+     * or greater than the max. score, but we decided to remove the restriction\n+     * and instead set the score boundaries on the server.\n+     */\n+    calculateTotalScore() {\n+        if (!this.feedback || this.feedback.length === 0) {\n+            this.totalScore = 0;\n+            return;\n+        }\n+        let totalScore = 0;\n+        for (const feedback of this.feedback) {\n+            totalScore += feedback.credits!;\n+        }\n+        this.totalScore = totalScore;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxMzY0OA==", "bodyText": "I don't think this works, because inside reduce totalScore is of type feedback and not number.\nSo if we want to shorten it I will do something like that?\nconst credits = (this.feedback || []).map((feedback) => feedback.credits); this.totalScore = credits.reduce((a, b) => a + b, 0);", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r429913648", "createdAt": "2020-05-25T12:39:48Z", "author": {"login": "HanyaElhashemy"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "diffHunk": "@@ -480,4 +486,21 @@ export class ModelingAssessmentEditorComponent implements OnInit {\n     private removeHighlightedFeedbackOfColor(highlightedElements: Map<string, string>, color: string) {\n         return new Map<string, string>([...highlightedElements].filter(([, value]) => value !== color));\n     }\n+    /**\n+     * Calculates the total score of the current assessment.\n+     * This function originally checked whether the total score is negative\n+     * or greater than the max. score, but we decided to remove the restriction\n+     * and instead set the score boundaries on the server.\n+     */\n+    calculateTotalScore() {\n+        if (!this.feedback || this.feedback.length === 0) {\n+            this.totalScore = 0;\n+            return;\n+        }\n+        let totalScore = 0;\n+        for (const feedback of this.feedback) {\n+            totalScore += feedback.credits!;\n+        }\n+        this.totalScore = totalScore;\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2NTA4MA=="}, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0OTc5Nw==", "bodyText": "I didn't actually test it. Looks like it works if the initial value is set to 0:", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430049797", "createdAt": "2020-05-25T19:04:58Z", "author": {"login": "madwau"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment-editor/modeling-assessment-editor.component.ts", "diffHunk": "@@ -480,4 +486,21 @@ export class ModelingAssessmentEditorComponent implements OnInit {\n     private removeHighlightedFeedbackOfColor(highlightedElements: Map<string, string>, color: string) {\n         return new Map<string, string>([...highlightedElements].filter(([, value]) => value !== color));\n     }\n+    /**\n+     * Calculates the total score of the current assessment.\n+     * This function originally checked whether the total score is negative\n+     * or greater than the max. score, but we decided to remove the restriction\n+     * and instead set the score boundaries on the server.\n+     */\n+    calculateTotalScore() {\n+        if (!this.feedback || this.feedback.length === 0) {\n+            this.totalScore = 0;\n+            return;\n+        }\n+        let totalScore = 0;\n+        for (const feedback of this.feedback) {\n+            totalScore += feedback.credits!;\n+        }\n+        this.totalScore = totalScore;\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2NTA4MA=="}, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzQ1NzIwOnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDozODo0MFrOGZ855Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDozODo0MFrOGZ855Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg2NTQ0NQ==", "bodyText": "This case is already covered by the following if statement.", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r429865445", "createdAt": "2020-05-25T10:38:40Z", "author": {"login": "madwau"}, "path": "src/main/webapp/app/exercises/modeling/assess/modeling-assessment.component.ts", "diffHunk": "@@ -241,6 +245,10 @@ export class ModelingAssessmentComponent implements AfterViewInit, OnDestroy, On\n      * @param feedbacks the feedback list to convert and pass on to Apollon\n      */\n     private updateApollonAssessments(feedbacks: Feedback[]) {\n+        if (feedbacks === undefined) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f29abf96456f639f0fccbc7349ab4741234f21ab"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3ODczMTkyOnYy", "diffSide": "RIGHT", "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQyMDoxNTozNlrOGaJDZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQyMTo0NjoxM1rOGaKHDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2NDQ4NA==", "bodyText": "Should we rather show a box for each element?", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430064484", "createdAt": "2020-05-25T20:15:36Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "diffHunk": "@@ -61,7 +61,18 @@\n                     <jhi-text-result [result]=\"result\"></jhi-text-result>\n                     <hr />\n                 </div>\n-\n+                <div class=\"col-md-12 col-lg-10 col-xl-8 feedback-text mt-5 alert alert-info\" *ngIf=\"unreferencedFeedback\">\n+                    <b>\n+                        <fa-icon [icon]=\"['far', 'comment-dots']\"></fa-icon>&nbsp;<span jhiTranslate=\"artemisApp.assessment.unreferencedFeedback\">\n+                            Feedback for Missing Elements</span\n+                        >:</b\n+                    >\n+                    <br />\n+                    <div *ngFor=\"let feedback of unreferencedFeedback\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91cb508f40d9d2c639696493badb3f0bbd596d98"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2OTczMw==", "bodyText": "I am open to that! I did not put much thinking in the UI to be honest and just followed the general feedback style to keep the view looking consistent but if we go for a different style for unreferenced feedback then I don't mind and can adjust the code accordingly ^^", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430069733", "createdAt": "2020-05-25T20:41:34Z", "author": {"login": "HanyaElhashemy"}, "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "diffHunk": "@@ -61,7 +61,18 @@\n                     <jhi-text-result [result]=\"result\"></jhi-text-result>\n                     <hr />\n                 </div>\n-\n+                <div class=\"col-md-12 col-lg-10 col-xl-8 feedback-text mt-5 alert alert-info\" *ngIf=\"unreferencedFeedback\">\n+                    <b>\n+                        <fa-icon [icon]=\"['far', 'comment-dots']\"></fa-icon>&nbsp;<span jhiTranslate=\"artemisApp.assessment.unreferencedFeedback\">\n+                            Feedback for Missing Elements</span\n+                        >:</b\n+                    >\n+                    <br />\n+                    <div *ngFor=\"let feedback of unreferencedFeedback\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2NDQ4NA=="}, "originalCommit": {"oid": "91cb508f40d9d2c639696493badb3f0bbd596d98"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA3MDU0Ng==", "bodyText": "@jpbernius what about a table view just like for modeling exercises?\n\nOr do you suggest this same style (blue feedback box) but just for each feedback separately?\nI feel like the table might be more compact and view space efficient", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430070546", "createdAt": "2020-05-25T20:45:51Z", "author": {"login": "HanyaElhashemy"}, "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "diffHunk": "@@ -61,7 +61,18 @@\n                     <jhi-text-result [result]=\"result\"></jhi-text-result>\n                     <hr />\n                 </div>\n-\n+                <div class=\"col-md-12 col-lg-10 col-xl-8 feedback-text mt-5 alert alert-info\" *ngIf=\"unreferencedFeedback\">\n+                    <b>\n+                        <fa-icon [icon]=\"['far', 'comment-dots']\"></fa-icon>&nbsp;<span jhiTranslate=\"artemisApp.assessment.unreferencedFeedback\">\n+                            Feedback for Missing Elements</span\n+                        >:</b\n+                    >\n+                    <br />\n+                    <div *ngFor=\"let feedback of unreferencedFeedback\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2NDQ4NA=="}, "originalCommit": {"oid": "91cb508f40d9d2c639696493badb3f0bbd596d98"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA3MTU5NA==", "bodyText": "For text exercises, we do not have such a table, so this would be a new element. So I would follow this \"alert style\" boxes to keep it consistent. Maybe we can tinker with the margins to make it more space-efficient if this is a concern.\nFor modeling, maybe this is an option as the interface is different here.\nBut I see how we want to have one UI for this only.\n\nShould we move this to a follow-up? I feel like shipping this in its current form is an improvement, but we should follow up quickly with a new version.", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430071594", "createdAt": "2020-05-25T20:51:27Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "diffHunk": "@@ -61,7 +61,18 @@\n                     <jhi-text-result [result]=\"result\"></jhi-text-result>\n                     <hr />\n                 </div>\n-\n+                <div class=\"col-md-12 col-lg-10 col-xl-8 feedback-text mt-5 alert alert-info\" *ngIf=\"unreferencedFeedback\">\n+                    <b>\n+                        <fa-icon [icon]=\"['far', 'comment-dots']\"></fa-icon>&nbsp;<span jhiTranslate=\"artemisApp.assessment.unreferencedFeedback\">\n+                            Feedback for Missing Elements</span\n+                        >:</b\n+                    >\n+                    <br />\n+                    <div *ngFor=\"let feedback of unreferencedFeedback\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2NDQ4NA=="}, "originalCommit": {"oid": "91cb508f40d9d2c639696493badb3f0bbd596d98"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA4MTgwNQ==", "bodyText": "Sure!", "url": "https://github.com/ls1intum/Artemis/pull/1447#discussion_r430081805", "createdAt": "2020-05-25T21:46:13Z", "author": {"login": "HanyaElhashemy"}, "path": "src/main/webapp/app/exercises/text/participate/text-editor.component.html", "diffHunk": "@@ -61,7 +61,18 @@\n                     <jhi-text-result [result]=\"result\"></jhi-text-result>\n                     <hr />\n                 </div>\n-\n+                <div class=\"col-md-12 col-lg-10 col-xl-8 feedback-text mt-5 alert alert-info\" *ngIf=\"unreferencedFeedback\">\n+                    <b>\n+                        <fa-icon [icon]=\"['far', 'comment-dots']\"></fa-icon>&nbsp;<span jhiTranslate=\"artemisApp.assessment.unreferencedFeedback\">\n+                            Feedback for Missing Elements</span\n+                        >:</b\n+                    >\n+                    <br />\n+                    <div *ngFor=\"let feedback of unreferencedFeedback\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA2NDQ4NA=="}, "originalCommit": {"oid": "91cb508f40d9d2c639696493badb3f0bbd596d98"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 156, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}