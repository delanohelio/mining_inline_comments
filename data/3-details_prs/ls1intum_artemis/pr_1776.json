{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMjg1MDIy", "number": 1776, "title": "Fix exam quiz submissions not being saved properly", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Client: I documented the TypeScript code using JSDoc style.\n Client: I translated all the newly inserted strings into German and English\n\nMotivation and Context\nThis resolves #1770\nDescription\n\nforce save submission when the user clicks on save\nimplement can deactivate\nadd TODO for generic message\nsmall code refactoring\n\nSteps for Testing\nPrerequisite: An Exam was properly set up with multiple choice questions and is running.\n\n\nCheck that in the exam view, a warning is displayed when you try to reload the page.\n\n\nIf the network connection is lost and you try to save ...\n\nby waiting 60 seconds after a change\nby manually clicking on \"Safe and Continue\" (this will force a save, regardless of)\nby switching the exercise in the navigation bar\n\na warning shows up, that there submission could not be saved.\n\n\nif there is no sign of it being not saved, it is present after reload or the end of the exam (summary)\n\n\nScreenshots", "createdAt": "2020-06-30T20:48:09Z", "url": "https://github.com/ls1intum/Artemis/pull/1776", "merged": true, "mergeCommit": {"oid": "e043c84772f187aba7dbaff0b3accb316dd585ee"}, "closed": true, "closedAt": "2020-07-02T13:35:24Z", "author": {"login": "MaisiKoleni"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwb5_5AH2gAyNDQyMjg1MDIyOjc1MmYyNjZhNTgwMjA0MThlYTlkYTAwNTFmNTFjYjBiY2VkZGE5NTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcw-vN0AH2gAyNDQyMjg1MDIyOjljM2Q2MDA1NGU2ZTU0MmRhYTkxZTA5MWYzNjQ1YWI1NmZhYTIwNjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "752f266a58020418ea9da0051f51cb0bcedda957", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/752f266a58020418ea9da0051f51cb0bcedda957", "committedDate": "2020-06-30T20:45:14Z", "message": "force save submission when the user clicks on save\n\nimplement can deactivate\nadd TODO for generic message\nsmall code refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b90c662545dd26cfcc317e5f9e72ed9cd7eca41", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/8b90c662545dd26cfcc317e5f9e72ed9cd7eca41", "committedDate": "2020-06-30T21:57:02Z", "message": "Error message when saving submission fails"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2580299aa7c5a4a9b1bcbdedf46264b6c083dbeb", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/2580299aa7c5a4a9b1bcbdedf46264b6c083dbeb", "committedDate": "2020-06-30T22:06:20Z", "message": "Fix guard."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbc2db4787bfafee66756aac19503a457acf90e3", "author": {"user": {"login": "sleiss", "name": "Simon Lei\u00df"}}, "url": "https://github.com/ls1intum/Artemis/commit/fbc2db4787bfafee66756aac19503a457acf90e3", "committedDate": "2020-06-30T22:07:59Z", "message": "Merge remote-tracking branch 'origin/bugfix/exam-quiz-save' into bugfix/exam-quiz-save"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTg0ODE0", "url": "https://github.com/ls1intum/Artemis/pull/1776#pullrequestreview-440584814", "createdAt": "2020-07-01T06:41:16Z", "commit": {"oid": "fbc2db4787bfafee66756aac19503a457acf90e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjo0MToxNlrOGrYwXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjo0MToxNlrOGrYwXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE0NzU1MA==", "bodyText": "Suggestion: this.currentSubmissionComponent && force ||", "url": "https://github.com/ls1intum/Artemis/pull/1776#discussion_r448147550", "createdAt": "2020-07-01T06:41:16Z", "author": {"login": "TobiasPr"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -233,13 +255,15 @@ export class ExamParticipationComponent implements OnInit, OnDestroy {\n      *      --> in this case, we can even save all submissions with isSynced = true\n      *\n      * @param intervalSave is set to true, if the save was triggered from the interval timer\n+     * @param force is set to true, when the current exercise should be saved (even if there are no changes)\n      */\n-    triggerSave(intervalSave: boolean) {\n+    triggerSave(intervalSave: boolean, force: boolean) {\n         // before the request, we would mark the submission as isSynced = true\n         // right after the response - in case it was successful - we mark the submission as isSynced = false\n         this.autoSaveTimer = 0;\n \n-        if (this.currentSubmissionComponent?.hasUnsavedChanges()) {\n+        if (force || this.currentSubmissionComponent?.hasUnsavedChanges()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fbc2db4787bfafee66756aac19503a457acf90e3"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTg0ODU1", "url": "https://github.com/ls1intum/Artemis/pull/1776#pullrequestreview-440584855", "createdAt": "2020-07-01T06:41:20Z", "commit": {"oid": "fbc2db4787bfafee66756aac19503a457acf90e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjo0MToyMFrOGrYwgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjo0MToyMFrOGrYwgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE0NzU4Ng==", "bodyText": "why do we try to update? is the this.disconnected that unreliable?", "url": "https://github.com/ls1intum/Artemis/pull/1776#discussion_r448147586", "createdAt": "2020-07-01T06:41:20Z", "author": {"login": "TobiasPr"}, "path": "src/main/webapp/app/exam/participate/exam-participation.component.ts", "diffHunk": "@@ -256,31 +280,32 @@ export class ExamParticipationComponent implements OnInit, OnDestroy {\n         });\n \n         // if no connection available -> don't try to sync\n-        if (!this.disconnected) {\n+        if (force || !this.disconnected) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fbc2db4787bfafee66756aac19503a457acf90e3"}, "originalPosition": 105}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b779cf704d161a0a9812921af13d9d1bcaa2aef", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/6b779cf704d161a0a9812921af13d9d1bcaa2aef", "committedDate": "2020-07-01T13:26:06Z", "message": "Merge branch 'develop' into bugfix/exam-quiz-save\n\n# Conflicts:\n#\tsrc/main/webapp/app/exam/participate/exam-participation.component.ts\n#\tsrc/main/webapp/i18n/de/exam.json\n#\tsrc/main/webapp/i18n/en/exam.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "411f1b071db542071091bfcb1e15e0387a451f3a", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/411f1b071db542071091bfcb1e15e0387a451f3a", "committedDate": "2020-07-01T17:38:20Z", "message": "save when only 1 second is left\nthrottle synchronization errors\nlower synchronization timer 60s -> 30s\ndon't display error when exam request is still pending -> only loading indicator in artemis header bar\nchange location of errors -> below navigation bar / above summary page"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMDU4MTcz", "url": "https://github.com/ls1intum/Artemis/pull/1776#pullrequestreview-441058173", "createdAt": "2020-07-01T17:17:03Z", "commit": {"oid": "6b779cf704d161a0a9812921af13d9d1bcaa2aef"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzoxNzowM1rOGrur4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzoyMzo1MFrOGru5pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUwNjg0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"pendingChanges\": \"Alle ungespeicherten \u00c4nderungen gehen beim Verlassen der Klausur verloren. M\u00f6chtest du sicher fortfahren?\"\n          \n          \n            \n                        \"pendingChanges\": \"Alle ungespeicherten \u00c4nderungen gehen beim Verlassen der Klausur verloren. Bist du sicher, dass du fortfahren m\u00f6chtest?\"", "url": "https://github.com/ls1intum/Artemis/pull/1776#discussion_r448506848", "createdAt": "2020-07-01T17:17:03Z", "author": {"login": "MaisiKoleni"}, "path": "src/main/webapp/i18n/de/exam.json", "diffHunk": "@@ -49,7 +49,9 @@\n             \"submitOtherExercise\": \"Speichern & Weiter\",\n             \"submitLastExercise\": \"Speichern\",\n             \"greeting\": \"Hallo {{ fullName }}, willkommen zu \\\"{{ title }}\\\"\",\n-            \"points\": \"Punkte\"\n+            \"points\": \"Punkte\",\n+            \"saveSubmissionError\": \"Die \u00c4nderungen konnten nicht gespeichert werden! Bitte stelle sicher, dass du online bist und speichere nochmal.\",\n+            \"pendingChanges\": \"Alle ungespeicherten \u00c4nderungen gehen beim Verlassen der Klausur verloren. M\u00f6chtest du sicher fortfahren?\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b779cf704d161a0a9812921af13d9d1bcaa2aef"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxMDM3NA==", "bodyText": "I think the wording of M\u00f6chtest du sicher fortfahren? is strange or unusual (maybe even misleading because \"sicher\" seems to describe the way how we continue), I couldn't find out that this is common (using Google) and DeepL suggests something like Bist du sicher, dass du fortfahren willst? which also sounds much more familiar and clear to me.", "url": "https://github.com/ls1intum/Artemis/pull/1776#discussion_r448510374", "createdAt": "2020-07-01T17:23:50Z", "author": {"login": "MaisiKoleni"}, "path": "src/main/webapp/i18n/de/exam.json", "diffHunk": "@@ -49,7 +49,9 @@\n             \"submitOtherExercise\": \"Speichern & Weiter\",\n             \"submitLastExercise\": \"Speichern\",\n             \"greeting\": \"Hallo {{ fullName }}, willkommen zu \\\"{{ title }}\\\"\",\n-            \"points\": \"Punkte\"\n+            \"points\": \"Punkte\",\n+            \"saveSubmissionError\": \"Die \u00c4nderungen konnten nicht gespeichert werden! Bitte stelle sicher, dass du online bist und speichere nochmal.\",\n+            \"pendingChanges\": \"Alle ungespeicherten \u00c4nderungen gehen beim Verlassen der Klausur verloren. M\u00f6chtest du sicher fortfahren?\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUwNjg0OA=="}, "originalCommit": {"oid": "6b779cf704d161a0a9812921af13d9d1bcaa2aef"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "347332d2ad014d4a7d72ba10d61c33a352095c4b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/347332d2ad014d4a7d72ba10d61c33a352095c4b", "committedDate": "2020-07-01T19:52:50Z", "message": "simplify quiz isSynced/hasUnsavedChanges status change by using existing onSelectionChanged event of sub components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9bec99b3ab7e789cd9f04fad91472be57e66c88", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a9bec99b3ab7e789cd9f04fad91472be57e66c88", "committedDate": "2020-07-01T19:55:59Z", "message": "immediately show yellow isSynced state for text editor as well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0576d9f65e4050fa94205d65a80fc6505a705f4a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/0576d9f65e4050fa94205d65a80fc6505a705f4a", "committedDate": "2020-07-01T19:58:26Z", "message": "add TODO to change how modeling exercises handled changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3cb6a03a6f9d0a9f0125c5977b846d20feabd63", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a3cb6a03a6f9d0a9f0125c5977b846d20feabd63", "committedDate": "2020-07-01T20:06:02Z", "message": "show edit symbol if changes are not synced"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97cd3df6fd853e01dedea50b6b2f0ff2e8f17344", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/97cd3df6fd853e01dedea50b6b2f0ff2e8f17344", "committedDate": "2020-07-01T21:35:55Z", "message": "clear auto save interval after exam has ended"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ffdb58c748026e17c5383b08ec8d77d1c5074e", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/08ffdb58c748026e17c5383b08ec8d77d1c5074e", "committedDate": "2020-07-01T21:38:20Z", "message": "Better styling for error alert"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce983dcfef467ac7e4057a05d5c2c0efb91e2ee4", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/ce983dcfef467ac7e4057a05d5c2c0efb91e2ee4", "committedDate": "2020-07-01T22:06:01Z", "message": "Remove duplicated warning dialog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzgzMjE3", "url": "https://github.com/ls1intum/Artemis/pull/1776#pullrequestreview-441383217", "createdAt": "2020-07-02T06:29:42Z", "commit": {"oid": "ce983dcfef467ac7e4057a05d5c2c0efb91e2ee4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjoyOTo0MlrOGr_G9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjoyOTo0MlrOGr_G9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NTkyNA==", "bodyText": "Why do we need .bind(this) here? Is onSelectionChanged() not sufficient?", "url": "https://github.com/ls1intum/Artemis/pull/1776#discussion_r448775924", "createdAt": "2020-07-02T06:29:42Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/exam/participate/exercises/quiz/quiz-exam-submission.component.html", "diffHunk": "@@ -47,6 +47,7 @@ <h2>\n                 *ngIf=\"question.type === MULTIPLE_CHOICE\"\n                 [question]=\"question\"\n                 [(selectedAnswerOptions)]=\"selectedAnswerOptions[question.id]\"\n+                [fnOnSelection]=\"onSelectionChanged.bind(this)\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce983dcfef467ac7e4057a05d5c2c0efb91e2ee4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56cdd1e07034d0a7e116acbc183798204ce1f161", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/56cdd1e07034d0a7e116acbc183798204ce1f161", "committedDate": "2020-07-02T08:37:57Z", "message": "Code Editor: Set submission.isSynced === CommitState.CLEAN.\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15eb53913175f680d4bbe7a4ef400bce7efdbfef", "author": {"user": {"login": "jpbernius", "name": "Jan Philip Bernius"}}, "url": "https://github.com/ls1intum/Artemis/commit/15eb53913175f680d4bbe7a4ef400bce7efdbfef", "committedDate": "2020-07-02T09:26:15Z", "message": "isSynced = false on file change\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82c51e5147107e4e5bef81284c57235d0f974efa", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/82c51e5147107e4e5bef81284c57235d0f974efa", "committedDate": "2020-07-02T11:55:59Z", "message": "Merge branch 'develop' into bugfix/exam-quiz-save\n\n# Conflicts:\n#\tsrc/main/webapp/app/exam/participate/exam-participation.component.html\n#\tsrc/main/webapp/app/exam/participate/exam-participation.component.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb84a0917456c5b3d9024e9cb5bd86821e9294d9", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/fb84a0917456c5b3d9024e9cb5bd86821e9294d9", "committedDate": "2020-07-02T12:32:03Z", "message": "remove magic wait, because it blocks the user interface unnecessarily"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35262b309e951f08754e18132f4837010ad57c73", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/35262b309e951f08754e18132f4837010ad57c73", "committedDate": "2020-07-02T12:39:56Z", "message": "change pendingChanges translation -> Christians suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f02659b0e8fe7a12588d63d189d23ce0fc6dc60d", "author": {"user": {"login": "TobiasPr", "name": "Tobias Priesching"}}, "url": "https://github.com/ls1intum/Artemis/commit/f02659b0e8fe7a12588d63d189d23ce0fc6dc60d", "committedDate": "2020-07-02T12:40:09Z", "message": "Merge remote-tracking branch 'origin/bugfix/exam-quiz-save' into bugfix/exam-quiz-save"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b12ad874bd1a308f74a5a1fc2eb8c7d124490e5a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/b12ad874bd1a308f74a5a1fc2eb8c7d124490e5a", "committedDate": "2020-07-02T12:58:10Z", "message": "improve wording"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c3d60054e6e542daa91e091f3645ab56faa2063", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/9c3d60054e6e542daa91e091f3645ab56faa2063", "committedDate": "2020-07-02T13:20:08Z", "message": "Merge branch 'develop' into bugfix/exam-quiz-save"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2607, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}