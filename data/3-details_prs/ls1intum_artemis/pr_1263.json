{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMzI3MTg2", "number": 1263, "title": "No Mocking of Connector Services in Spring Tests", "bodyText": "Description\nThis PR removes all mocked connector (Bamboo, Bitbucket) methods and instead only mocks the actual request to the external service. I left one mock for the BambooService as this method only calls the GitService and performs checkout, commit and push operations. As Git commands are also mocked in other places, we might want to think about mocking actual VCS operations on a lower level in a future PR.\nWe still need the reference to the services in the AbstractSpringIntegrationTest in order to verify calls to specific methods (nr. of calls, equal parameters).", "createdAt": "2020-03-02T11:20:42Z", "url": "https://github.com/ls1intum/Artemis/pull/1263", "merged": true, "mergeCommit": {"oid": "b4c35adc7b951d2ba8aa6a222dc88745da51a803"}, "closed": true, "closedAt": "2020-03-03T14:14:03Z", "author": {"login": "ungaralex"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHz8xCgH2gAyMzgyMzI3MTg2OjhiNTNiODkyNGNhZGE3OTY5M2E1MDIxYjY4ZTQxOWJhYmNhNTI2YTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKC-bBgH2gAyMzgyMzI3MTg2OmUyNTcxN2IyMDBiZTE4ZjE2NzZlMDE1YzZkMjNjM2ViNDE4NTg2YTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8b53b8924cada79693a5021b68e419babca526a3", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/8b53b8924cada79693a5021b68e419babca526a3", "committedDate": "2020-02-25T15:35:05Z", "message": "Don't mock enablePlan and copyPlan for some Bamboo tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "835297a00c2dae9bd19c6c65ade081a80b37dc3c", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/835297a00c2dae9bd19c6c65ade081a80b37dc3c", "committedDate": "2020-02-25T16:37:47Z", "message": "Don't mock updateBuildPlan for some Bamboo tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0567095b60ce2057728ba567c81519c242dc31f", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/c0567095b60ce2057728ba567c81519c242dc31f", "committedDate": "2020-02-25T17:02:29Z", "message": "Don't mock Bamboo service in ProgrammingExerciseIntegrationTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4cd9b432ba149b7cd90bb99c878d3837191e049", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/b4cd9b432ba149b7cd90bb99c878d3837191e049", "committedDate": "2020-03-02T11:03:43Z", "message": "Remove connector mocking for participation trigger build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "879ecaef35e4481d9c1b90f6412bfa4bcd0f59d3", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/879ecaef35e4481d9c1b90f6412bfa4bcd0f59d3", "committedDate": "2020-03-02T11:09:22Z", "message": "Remove unnecessary mocks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfcd77d82035cbb25f9ad71085d0aa7cf310348b", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/cfcd77d82035cbb25f9ad71085d0aa7cf310348b", "committedDate": "2020-03-02T11:14:20Z", "message": "Remove Bamboo conenctor mocks from ProgrammingExerciseTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d2d95ff2bb38495917ff63fedb53de7d073b2cf", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/9d2d95ff2bb38495917ff63fedb53de7d073b2cf", "committedDate": "2020-03-02T11:17:14Z", "message": "Remove unnecessary Bamboo mocks from ProgrammingSubmissionAndResultIntegrationTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "702122d45e518bc2ac935fba7683a957d2a72363", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/702122d45e518bc2ac935fba7683a957d2a72363", "committedDate": "2020-03-02T13:07:42Z", "message": "Don't mock Bamboo build result notification\n\nCreate model builder for test result notification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99c4c1faebe7f393b5709edf079e9295e84ddd32", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/99c4c1faebe7f393b5709edf079e9295e84ddd32", "committedDate": "2020-03-02T13:54:57Z", "message": "Don't mock added webhooks to Bitbucket in Spring tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8694a1743de1211623dbc3a30bff8fe55c7e57a4", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/8694a1743de1211623dbc3a30bff8fe55c7e57a4", "committedDate": "2020-03-02T15:02:08Z", "message": "Remove Bitbucket mocks for deleting exercise"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b09988cac9f224a77fc1628255f9511af20f52", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/75b09988cac9f224a77fc1628255f9511af20f52", "committedDate": "2020-03-02T15:08:53Z", "message": "Remove Bitbucket mocks from ProgrammingExerciseTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcd389660844ab7ec6605be05eb66e65a632fc7e", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/bcd389660844ab7ec6605be05eb66e65a632fc7e", "committedDate": "2020-03-02T15:24:59Z", "message": "Remove Bitbucket copy repo mock from ProgrammingExerciseServiceIntegrationTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fae7765921885bfda6ce1e09efd717018934f545", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/fae7765921885bfda6ce1e09efd717018934f545", "committedDate": "2020-03-02T15:39:48Z", "message": "Remove Bitbucket mocks from ProgrammingExerciseScheduleServiceTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4489ad79d3e36f0dcd683e25ef47301c405f1b21", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/4489ad79d3e36f0dcd683e25ef47301c405f1b21", "committedDate": "2020-03-02T15:50:00Z", "message": "Fix trigger build server tests (instructor and tutor)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdc6c527ec5490b397fff007767f0fbafd6af210", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/fdc6c527ec5490b397fff007767f0fbafd6af210", "committedDate": "2020-03-02T16:34:12Z", "message": "Revert accidental comment removal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/5bf58c5c516ed3c4dfc666b4c690390f4ac01b26", "committedDate": "2020-03-02T16:40:00Z", "message": "Remove TODOs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDA5MDk4", "url": "https://github.com/ls1intum/Artemis/pull/1263#pullrequestreview-368009098", "createdAt": "2020-03-03T14:12:02Z", "commit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoxMjowM1rOFxHSeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoxMjowM1rOFxHSeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA0Mzk2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @SpyBean\n          \n          \n            \n                // please only use this to verify method calls using Mockito. Do not mock methods, instead mock the communication with Bamboo using the corresponding RestTemplate.\n          \n          \n            \n                @SpyBean", "url": "https://github.com/ls1intum/Artemis/pull/1263#discussion_r387043960", "createdAt": "2020-03-03T14:12:03Z", "author": {"login": "krusche"}, "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationTest.java", "diffHunk": "@@ -25,11 +25,9 @@\n     @SpyBean\n     protected LtiService ltiService;\n \n-    // TODO: we should not really mock BambooService, but only the API calls to Bamboo (e.g. based on the used RestTemplate)\n     @SpyBean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDA5MzUx", "url": "https://github.com/ls1intum/Artemis/pull/1263#pullrequestreview-368009351", "createdAt": "2020-03-03T14:12:21Z", "commit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoxMjoyMVrOFxHTPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoxMjoyMVrOFxHTPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA0NDE1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @SpyBean\n          \n          \n            \n                // please only use this to verify method calls using Mockito. Do not mock methods, instead mock the communication with Bitbucket using the corresponding RestTemplate.\n          \n          \n            \n                @SpyBean", "url": "https://github.com/ls1intum/Artemis/pull/1263#discussion_r387044158", "createdAt": "2020-03-03T14:12:21Z", "author": {"login": "krusche"}, "path": "src/test/java/de/tum/in/www1/artemis/AbstractSpringIntegrationTest.java", "diffHunk": "@@ -25,11 +25,9 @@\n     @SpyBean\n     protected LtiService ltiService;\n \n-    // TODO: we should not really mock BambooService, but only the API calls to Bamboo (e.g. based on the used RestTemplate)\n     @SpyBean\n     protected BambooService continuousIntegrationService;\n \n-    // TODO: we should not really mock BitbucketService, but only the API calls to Bitbucket (e.g. based on the used RestTemplate)\n     @SpyBean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDA5ODQz", "url": "https://github.com/ls1intum/Artemis/pull/1263#pullrequestreview-368009843", "createdAt": "2020-03-03T14:12:54Z", "commit": {"oid": "5bf58c5c516ed3c4dfc666b4c690390f4ac01b26"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e25717b200be18f1676e015c6d23c3eb418586a0", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/e25717b200be18f1676e015c6d23c3eb418586a0", "committedDate": "2020-03-03T14:13:19Z", "message": "Apply suggestions from code review"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3219, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}