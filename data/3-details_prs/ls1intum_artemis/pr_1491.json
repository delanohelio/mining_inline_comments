{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NjEyODI2", "number": 1491, "title": "Add course reload button and automatic quiz display (visible)", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n\nMotivation and Context\nThis is a performance improvement. Some students tend reload the whole Artemis application if they do not see certain exercises or lectures. However, this can lead to performance problems, especially when > 1000 students reload the browser in lectures at the same time.\nDescription\nThis PR adds a for dashboard REST call for a single course and adds a reload button that triggers this call. This should reduce the performance impact on the server significantly compared to a browser reload. In addition, quizzes should be displayed automatically (using web sockets), when they are set to visible\n\n A quiz which is visible, but not yet started (without start time), should be displayed at the top of the exercise list\n\nSteps for Testing\n\nLog in to Artemis\nNavigate to Course Overview. Double check that everything is shown correctly (and nothing is missing)\nNavigate into one course\nClick the reload button (student) --> nothing should change\nAdd a new exercises or lecture in a separate browser window / tab (instructor)\nClick on the reload button: the exercise or lecture should be shown now (student)\nSet a quiz without start time to visible (instructor)\nThe quiz should appear and be shown at the top (student)", "createdAt": "2020-05-18T16:32:11Z", "url": "https://github.com/ls1intum/Artemis/pull/1491", "merged": true, "mergeCommit": {"oid": "2841d1be4e1745c05ea7cc87f5c019ed3e9439f6"}, "closed": true, "closedAt": "2020-05-19T21:39:10Z", "author": {"login": "krusche"}, "timelineItems": {"totalCount": 36, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcifeabgH2gAyNDE5NjEyODI2OjJhMGM0NjA4MjYxMDE1OTUwN2JjYzRjMDI4ZGY2ZDQ5NzU4Njc2ZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABci6RxogH2gAyNDE5NjEyODI2OjYwYmRlOWYwMzRiZmU0NzE5NDc1MmQyYzAwNjQ0Y2RhZTk4ZDQ2MTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2a0c46082610159507bcc4c028df6d49758676d4", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/2a0c46082610159507bcc4c028df6d49758676d4", "committedDate": "2020-05-18T12:59:47Z", "message": "add new endpoint for getting one specific course with exercises and lectures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8e73ef7d6090891e5c45fed59f743d8a916f0c2", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a8e73ef7d6090891e5c45fed59f743d8a916f0c2", "committedDate": "2020-05-18T16:25:01Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf738944866f1ad7cbb49081240627b1f24d866a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/bf738944866f1ad7cbb49081240627b1f24d866a", "committedDate": "2020-05-18T16:28:00Z", "message": "fix documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d7f071efa5d5b62e91a85728e3bd6262668f3c6", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/4d7f071efa5d5b62e91a85728e3bd6262668f3c6", "committedDate": "2020-05-18T18:19:17Z", "message": "Refresh button for course"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1cbd2bad0089a4414b09c243b5bb333b60688fe", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e1cbd2bad0089a4414b09c243b5bb333b60688fe", "committedDate": "2020-05-18T19:22:49Z", "message": "automatically show quizzes when they are set to visible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57524fb1018ae4ac55e1ac51d872958fe0b50c11", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/57524fb1018ae4ac55e1ac51d872958fe0b50c11", "committedDate": "2020-05-18T20:40:55Z", "message": "Propagate course refresh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f14984d0dce0987a5633b65dc5fcc4839661617e", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/f14984d0dce0987a5633b65dc5fcc4839661617e", "committedDate": "2020-05-18T20:41:11Z", "message": "Merge remote-tracking branch 'origin/feature/course-overview-reload-button' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb63566ccd8002d60a253a809cf7dc9fcbd99b8d", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/cb63566ccd8002d60a253a809cf7dc9fcbd99b8d", "committedDate": "2020-05-18T22:23:37Z", "message": "properly reload quiz when set visible with new mechanism"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "006a35084e9ad6eac919870491e895157199ee81", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/006a35084e9ad6eac919870491e895157199ee81", "committedDate": "2020-05-18T22:53:02Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d64a89160e0bd92671d3dcb48a9b751c4ff1ad24", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d64a89160e0bd92671d3dcb48a9b751c4ff1ad24", "committedDate": "2020-05-18T23:10:45Z", "message": "fix docs and code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ab5737043cdda7d3290f944bbf7a7c2d6aa16ac", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/0ab5737043cdda7d3290f944bbf7a7c2d6aa16ac", "committedDate": "2020-05-19T07:47:59Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6561b1c063851ff836599a3c345cee1d371924ca", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/6561b1c063851ff836599a3c345cee1d371924ca", "committedDate": "2020-05-19T12:05:41Z", "message": "Show open quiz exercise at top of course overview"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3824d3b1c04d6d26d5f221e8e88088a5cbd73f9f", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/3824d3b1c04d6d26d5f221e8e88088a5cbd73f9f", "committedDate": "2020-05-19T12:19:43Z", "message": "Current exercise label without due date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "492a52cfc8c05f8d4860a86327c30e9ba3f815af", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/492a52cfc8c05f8d4860a86327c30e9ba3f815af", "committedDate": "2020-05-19T13:16:19Z", "message": "Fix ExpressionChangedAfterItHasBeenCheckedError, unsubscribe from course updates subscription on destroy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f88707973db704652922fa240cce9a75271a97c", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/7f88707973db704652922fa240cce9a75271a97c", "committedDate": "2020-05-19T14:10:18Z", "message": "fixed that already started quizzes are shown first"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8699a8402f707fe03c61ca09aee5df3f7cd90388", "author": {"user": {"login": "madwau", "name": "Martin Wauligmann"}}, "url": "https://github.com/ls1intum/Artemis/commit/8699a8402f707fe03c61ca09aee5df3f7cd90388", "committedDate": "2020-05-19T14:10:30Z", "message": "Compute exercise participation status in course-management.service.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d544b9622f9f59a8a76acb1878b95670b6ee0152", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d544b9622f9f59a8a76acb1878b95670b6ee0152", "committedDate": "2020-05-19T14:13:09Z", "message": "Merge branch 'feature/course-overview-reload-button' of https://github.com/ls1intum/Artemis into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29951acb32040baa70516a2a5ef0fa75b2672c6c", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/29951acb32040baa70516a2a5ef0fa75b2672c6c", "committedDate": "2020-05-19T15:21:49Z", "message": "fixed wrong displayed text on course dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6588af943ba71b7e776b3804626a36a1cf46aeed", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/6588af943ba71b7e776b3804626a36a1cf46aeed", "committedDate": "2020-05-19T15:47:04Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d504c1a4bfe294fd1f176201359608f4c66b0dab", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d504c1a4bfe294fd1f176201359608f4c66b0dab", "committedDate": "2020-05-19T15:48:16Z", "message": "Merge branch 'feature/course-overview-reload-button' of https://github.com/ls1intum/Artemis into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac96c44ec7e86e0695dc008e9f17b433d1e7fedb", "author": {"user": {"login": "F4lka", "name": null}}, "url": "https://github.com/ls1intum/Artemis/commit/ac96c44ec7e86e0695dc008e9f17b433d1e7fedb", "committedDate": "2020-05-19T15:59:52Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d59bceeb8e8c9c6cdc3b1c20eb2558f24b9e2d8a", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/d59bceeb8e8c9c6cdc3b1c20eb2558f24b9e2d8a", "committedDate": "2020-05-19T16:58:30Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1158ea9cc7bb224b4fec0eaec11ab59e8355f67", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f1158ea9cc7bb224b4fec0eaec11ab59e8355f67", "committedDate": "2020-05-19T17:07:54Z", "message": "fix typescript errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9938ce1b16f8fec6f26ac0199217b362c372c5d2", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/9938ce1b16f8fec6f26ac0199217b362c372c5d2", "committedDate": "2020-05-19T17:23:04Z", "message": "run prettier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f9ccc49ea53ecc1e2be4cb69f7f35a807a0c4f7", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/7f9ccc49ea53ecc1e2be4cb69f7f35a807a0c4f7", "committedDate": "2020-05-19T17:24:20Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50ac01e1aca9e1c0fc0d8cdcd967dae374c55bdf", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/50ac01e1aca9e1c0fc0d8cdcd967dae374c55bdf", "committedDate": "2020-05-19T17:43:05Z", "message": "send quiz updates per course"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89174c106b6dd6b4e02f9b64adcd9885840cb958", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/89174c106b6dd6b4e02f9b64adcd9885840cb958", "committedDate": "2020-05-19T17:43:27Z", "message": "Merge branch 'feature/course-overview-reload-button' of https://github.com/ls1intum/Artemis into feature/course-overview-reload-button"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0Njk5NTEy", "url": "https://github.com/ls1intum/Artemis/pull/1491#pullrequestreview-414699512", "createdAt": "2020-05-19T18:07:41Z", "commit": {"oid": "89174c106b6dd6b4e02f9b64adcd9885840cb958"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODowNzo0MVrOGXsiMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODowNzo0MVrOGXsiMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUwMDA4MA==", "bodyText": "This change broke something, no courses are displayed anymore", "url": "https://github.com/ls1intum/Artemis/pull/1491#discussion_r427500080", "createdAt": "2020-05-19T18:07:41Z", "author": {"login": "stefanwaldhauser"}, "path": "src/main/webapp/app/overview/courses.component.ts", "diffHunk": "@@ -38,7 +38,7 @@ export class CoursesComponent implements OnInit {\n     }\n \n     loadAndFilterCourses() {\n-        this.courseService.findAll().subscribe(\n+        this.courseService.findAllForDashboard().subscribe(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89174c106b6dd6b4e02f9b64adcd9885840cb958"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12f26283cde3a3942d9763278c75111dd4c49fbc", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/12f26283cde3a3942d9763278c75111dd4c49fbc", "committedDate": "2020-05-19T18:50:15Z", "message": "fix type script error when multiple relevant exercises are found and make sure quizzes are prioritized"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c715edd044f50b23033d0ecad842a2b13582119", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/3c715edd044f50b23033d0ecad842a2b13582119", "committedDate": "2020-05-19T19:03:51Z", "message": "fix priority active quiz before visible quiz"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e092ecd494f31ce76995b1bb0b2076bc3af3098e", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/e092ecd494f31ce76995b1bb0b2076bc3af3098e", "committedDate": "2020-05-19T19:04:14Z", "message": "Merge branch 'develop' into feature/course-overview-reload-button"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NzYyMzE3", "url": "https://github.com/ls1intum/Artemis/pull/1491#pullrequestreview-414762317", "createdAt": "2020-05-19T19:35:28Z", "commit": {"oid": "e092ecd494f31ce76995b1bb0b2076bc3af3098e"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65fc0e6c71b261902e25e4a191242080cb649c1a", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/65fc0e6c71b261902e25e4a191242080cb649c1a", "committedDate": "2020-05-19T19:56:28Z", "message": "fix space in WS topic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NzU5NzM4", "url": "https://github.com/ls1intum/Artemis/pull/1491#pullrequestreview-414759738", "createdAt": "2020-05-19T19:31:31Z", "commit": {"oid": "e092ecd494f31ce76995b1bb0b2076bc3af3098e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTozMTozMlrOGXviBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTozMTozMlrOGXviBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0OTE4OQ==", "bodyText": "should this not be relevantExercises[0] as the array contains only one item?", "url": "https://github.com/ls1intum/Artemis/pull/1491#discussion_r427549189", "createdAt": "2020-05-19T19:31:32Z", "author": {"login": "fde312"}, "path": "src/main/webapp/app/overview/courses.component.ts", "diffHunk": "@@ -52,22 +54,34 @@ export class CoursesComponent implements OnInit {\n         this.jhiAlertService.error('error.unexpectedError', { error }, undefined);\n     }\n \n-    get nextRelevantExercise(): Exercise | null {\n+    get nextRelevantExercise(): Exercise | undefined {\n+        const relevantExercises = new Array<Exercise>();\n         let relevantExercise: Exercise | null = null;\n         if (this.courses) {\n             this.courses.forEach((course) => {\n                 const relevantExerciseForCourse = this.exerciseService.getNextExerciseForHours(course.exercises);\n                 if (relevantExerciseForCourse) {\n-                    if (!relevantExercise) {\n-                        relevantExercise = relevantExerciseForCourse;\n-                        this.nextRelevantCourse = course;\n-                    } else if (relevantExerciseForCourse.dueDate!.isBefore(relevantExercise.dueDate!)) {\n-                        relevantExercise = relevantExerciseForCourse;\n-                        this.nextRelevantCourse = course;\n-                    }\n+                    relevantExerciseForCourse.course = course;\n+                    relevantExercises.push(relevantExerciseForCourse);\n                 }\n             });\n+            if (relevantExercises.length === 0) {\n+                return undefined;\n+            } else if (relevantExercises.length === 1) {\n+                relevantExercise = relevantExercises[1];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e092ecd494f31ce76995b1bb0b2076bc3af3098e"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2e3f74e07a98f3375d1ebe3b4076d7a7fc768ab", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/d2e3f74e07a98f3375d1ebe3b4076d7a7fc768ab", "committedDate": "2020-05-19T20:07:24Z", "message": "fix index"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60bde9f034bfe47194752d2c00644cdae98d4617", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/60bde9f034bfe47194752d2c00644cdae98d4617", "committedDate": "2020-05-19T20:13:25Z", "message": "fix TODO"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2670, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}