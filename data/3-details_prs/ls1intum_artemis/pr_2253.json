{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3NzEwNjA2", "number": 2253, "title": "[Bug] SCA categorization when build fails", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n Server: I added multiple integration tests (Spring) related to the features (with a high test coverage)\n Server: I documented the Java code using JavaDoc style.\n\nMotivation and Context\n\n\nPMD and Checkstyle are in some cases able to deliver feedback even if compilation fails (e.g. on a type error). In such a case the feedback was not properly categorized.\nDescription\n\n\nMove categorization functionality to StaticCodeAnalysisService\nCall categorization functionality even if no test case feedback exists\nFixed typos in some category mappings\nMove Spotbugs I18N ruleset (usage of locale and encodings) to category best practices\nFix the result String generation for Jenkins. Use the test case feedback to determine the String not all feedback.\nTests\n\nSteps for Testing\n\nTest the Bamboo and Jenkins setup\n\nLog in to Artemis\nCreate a programming exercise with static code analysis enabled\nParticipate in the exercise\nSubmit and check that feedback is properly categorized (in the default configuration, documentation issues should not show up)\nLet the build fail by submitting the following implementation for a sort algorithm and check that the static code analysis feedback is properly categorized.\n\nCollections.sort(input);\nint a = \"\";\n\nTest Coverage\n\nCoverage is at the same level as a method was just moved to another service and called at a slightly different spot. Added two more specialized tests which don't improve coverage.", "createdAt": "2020-10-21T16:51:16Z", "url": "https://github.com/ls1intum/Artemis/pull/2253", "merged": true, "mergeCommit": {"oid": "6a28744bc473a22b9bcfe36555b80f83a26f5dfa"}, "closed": true, "closedAt": "2020-10-22T23:39:37Z", "author": {"login": "kloessst"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUuam6gH2gAyNTA3NzEwNjA2OjRiYzI3YTMxNDY2YjhhMjkxMmIzMDUxOTQwMDFmYTdjOTIyNjFhNWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVKfjzAFqTUxNTE4NDEwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4bc27a31466b8a2912b305194001fa7c92261a5c", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/4bc27a31466b8a2912b305194001fa7c92261a5c", "committedDate": "2020-10-21T14:40:25Z", "message": "Move categorization to SCA service. It is called before the number of testCaseFeedbacks is checked. Otherwise SCA feedback won't get categorized when the build fails."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8c76607551e8bc0f0c084f9779132872a111af3", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/c8c76607551e8bc0f0c084f9779132872a111af3", "committedDate": "2020-10-21T16:21:31Z", "message": "Create getter of for static code analysis category"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7390cb2f6dcf5c48747363120b6802446b5bf824", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/7390cb2f6dcf5c48747363120b6802446b5bf824", "committedDate": "2020-10-21T16:22:05Z", "message": "Tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24a8cc63cdeebc6d6740b1e95f0445ef624801ba", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/24a8cc63cdeebc6d6740b1e95f0445ef624801ba", "committedDate": "2020-10-21T16:53:28Z", "message": "Merge branch 'develop' into bugfix/sca-categorization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f822a9c5958bb33b9cf92313bad1c5c723e63ed", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/4f822a9c5958bb33b9cf92313bad1c5c723e63ed", "committedDate": "2020-10-21T19:14:53Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b39c168c5ba25e0968078e4140c9ce3dfec2d75", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/7b39c168c5ba25e0968078e4140c9ce3dfec2d75", "committedDate": "2020-10-21T19:50:40Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c304227986d08cdd6f133efbf58032735278ed3", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/0c304227986d08cdd6f133efbf58032735278ed3", "committedDate": "2020-10-21T23:24:42Z", "message": "Fix category typos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c5014aa25564da2ae92ac41a562ed5ac0901307", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/2c5014aa25564da2ae92ac41a562ed5ac0901307", "committedDate": "2020-10-22T00:19:40Z", "message": "Move Spotbugs encoding and locale rules to Best practices"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/5bdbc98cbc34cceb7caef321a4005fe43f0e938c", "committedDate": "2020-10-22T13:22:26Z", "message": "Fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NzI1MDIw", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-514725020", "createdAt": "2020-10-22T13:28:08Z", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODowOFrOHmhwKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODowOFrOHmhwKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE2MDkzNw==", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "url": "https://github.com/ls1intum/Artemis/pull/2253#discussion_r510160937", "createdAt": "2020-10-22T13:28:08Z", "author": {"login": "artemis-bot"}, "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseResultTestService.java", "diffHunk": "@@ -69,23 +72,24 @@\n \n     private ProgrammingExerciseStudentParticipation programmingExerciseStudentParticipationStaticCodeAnalysis;\n \n-    public void setup() throws Exception {\n+    public void setup() {\n         database.addUsers(10, 2, 2);\n         Course course = database.addCourseWithOneProgrammingExercise();\n         programmingExercise = programmingExerciseRepository.findAll().get(0);\n         programmingExerciseWithStaticCodeAnalysis = database.addProgrammingExerciseToCourse(course, true);\n+        staticCodeAnalysisService.createDefaultCategories(programmingExerciseWithStaticCodeAnalysis);\n         // This is done to avoid an unproxy issue in the processNewResult method of the ResultService.\n         solutionParticipation = solutionProgrammingExerciseRepository.findWithEagerResultsAndSubmissionsByProgrammingExerciseId(programmingExercise.getId()).get();\n         programmingExerciseStudentParticipation = database.addStudentParticipationForProgrammingExercise(programmingExercise, \"student1\");\n         programmingExerciseStudentParticipationStaticCodeAnalysis = database.addStudentParticipationForProgrammingExercise(programmingExerciseWithStaticCodeAnalysis, \"student1\");\n     }\n \n-    public void tearDown() throws IOException {\n+    public void tearDown() {\n         database.resetDatabase();\n     }\n \n     // Test\n-    public void shouldUpdateTestCasesAndResultScoreFromSolutionParticipationResult(Object resultNotification) throws Exception {\n+    public void shouldUpdateTestCasesAndResultScoreFromSolutionParticipationResult(Object resultNotification) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NzI1MDQy", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-514725042", "createdAt": "2020-10-22T13:28:09Z", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODowOVrOHmhwNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODowOVrOHmhwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE2MDk1MQ==", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "url": "https://github.com/ls1intum/Artemis/pull/2253#discussion_r510160951", "createdAt": "2020-10-22T13:28:09Z", "author": {"login": "artemis-bot"}, "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseResultTestService.java", "diffHunk": "@@ -105,9 +109,7 @@ public void shouldUpdateTestCasesAndResultScoreFromSolutionParticipationResult(O\n     }\n \n     // Test\n-    public void shouldStoreFeedbackForResultWithStaticCodeAnalysisReport(Object resultNotification) throws Exception {\n-        final var staticCodeAnalysisFeedback = feedbackService\n-                .createFeedbackFromStaticCodeAnalysisReports(ModelFactory.generateStaticCodeAnalysisReports(programmingExerciseWithStaticCodeAnalysis.getProgrammingLanguage()));\n+    public void shouldStoreFeedbackForResultWithStaticCodeAnalysisReport(Object resultNotification) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NzI1MDU4", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-514725058", "createdAt": "2020-10-22T13:28:10Z", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODoxMFrOHmhwQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODoxMFrOHmhwQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE2MDk2MA==", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "url": "https://github.com/ls1intum/Artemis/pull/2253#discussion_r510160960", "createdAt": "2020-10-22T13:28:10Z", "author": {"login": "artemis-bot"}, "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseResultTestService.java", "diffHunk": "@@ -69,23 +72,24 @@\n \n     private ProgrammingExerciseStudentParticipation programmingExerciseStudentParticipationStaticCodeAnalysis;\n \n-    public void setup() throws Exception {\n+    public void setup() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NzI1MDcy", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-514725072", "createdAt": "2020-10-22T13:28:11Z", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODoxMVrOHmhwTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyODoxMVrOHmhwTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE2MDk3NQ==", "bodyText": "Codacy found an issue: Missing a Javadoc comment.", "url": "https://github.com/ls1intum/Artemis/pull/2253#discussion_r510160975", "createdAt": "2020-10-22T13:28:11Z", "author": {"login": "artemis-bot"}, "path": "src/test/java/de/tum/in/www1/artemis/util/ProgrammingExerciseResultTestService.java", "diffHunk": "@@ -125,12 +127,11 @@ public void shouldStoreFeedbackForResultWithStaticCodeAnalysisReport(Object resu\n         assertThat(optionalResult).isPresent();\n         var result = optionalResult.get();\n         assertThat(result.getFeedbacks()).usingElementComparator(scaFeedbackComparator).containsAll(savedResult.getFeedbacks());\n-        assertThat(savedResult.getFeedbacks()).usingElementComparator(scaFeedbackComparator).containsAll(staticCodeAnalysisFeedback);\n-        assertThat(result.getFeedbacks()).usingElementComparator(scaFeedbackComparator).containsAll(staticCodeAnalysisFeedback);\n+        assertThat(result.getFeedbacks().stream().filter(Feedback::isStaticCodeAnalysisFeedback).count()).isEqualTo(3);\n     }\n \n     // Test\n-    public void shouldStoreBuildLogsForSubmission(Object resultNotification) throws Exception {\n+    public void shouldStoreBuildLogsForSubmission(Object resultNotification) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0ODA3NzA3", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-514807707", "createdAt": "2020-10-22T14:44:12Z", "commit": {"oid": "5bdbc98cbc34cceb7caef321a4005fe43f0e938c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9bcd1bb91979ded95a27e7b111789f5a83871f2", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/e9bcd1bb91979ded95a27e7b111789f5a83871f2", "committedDate": "2020-10-22T20:15:47Z", "message": "Fix result string for Jenkins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10435dea2b291cfcb66c4fa3b70099e5f90b7a8c", "author": {"user": {"login": "kloessst", "name": "Stefan Kl\u00f6ss-Schuster"}}, "url": "https://github.com/ls1intum/Artemis/commit/10435dea2b291cfcb66c4fa3b70099e5f90b7a8c", "committedDate": "2020-10-22T20:20:44Z", "message": "Doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTgyOTMx", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-515182931", "createdAt": "2020-10-22T23:19:50Z", "commit": {"oid": "10435dea2b291cfcb66c4fa3b70099e5f90b7a8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTg0MTAw", "url": "https://github.com/ls1intum/Artemis/pull/2253#pullrequestreview-515184100", "createdAt": "2020-10-22T23:23:11Z", "commit": {"oid": "10435dea2b291cfcb66c4fa3b70099e5f90b7a8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3924, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}