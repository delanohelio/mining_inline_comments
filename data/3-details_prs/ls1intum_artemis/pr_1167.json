{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MjUxODgy", "number": 1167, "title": "Remove participation websocket subscription", "bodyText": "Checklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n\nMotivation and Context\nWe still use too many websocket subscriptions. In this PR, we remove the subscription for /topic/exercise/{exerciseId}/participation because it is not really necessary.\nDescription\nWhen participating in an exercise, the invoked REST call already returns the changed participation. It does not really make sense to additionally send it via websocket, therefore we removed the websocket communication and now use the response and update the participation cache.\nSteps for Testing\n\nLog in to Artemis\nNavigate to Course Administration\nCreate file-upload/modeling/text exercises\nStart the exercises\nNavigate back and forth in the course overview / exercise details / submission page: check that the submission/result state is correct\nCreate a submission and submit\nNavigate back and forth in the course overview / exercise details / submission page: check that the submission/result state is correct", "createdAt": "2020-01-04T22:15:49Z", "url": "https://github.com/ls1intum/Artemis/pull/1167", "merged": true, "mergeCommit": {"oid": "203d00eb1adc56411f7d2ec078bb8d34733be74c"}, "closed": true, "closedAt": "2020-01-10T15:07:24Z", "author": {"login": "krusche"}, "timelineItems": {"totalCount": 36, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbxRBpOAH2gAyMzU5MjUxODgyOjIwM2U3YTI1ZDA4MWIzYjBlZDdhODE0NWQwODVmOGE4OWEyYWFmOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4_DHxgH2gAyMzU5MjUxODgyOmRkYjczMDgzODdlODVkYmYzYTg4ZThiMjI0M2I3MzM2NzMyMjY2Mjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "203e7a25d081b3b0ed7a8145d085f8a89a2aaf8b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/203e7a25d081b3b0ed7a8145d085f8a89a2aaf8b", "committedDate": "2019-12-17T14:27:24Z", "message": "remove participation websocket for course overview and exericse details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae1daa1e4dcc35a5fbd40448247626da8c578994", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/ae1daa1e4dcc35a5fbd40448247626da8c578994", "committedDate": "2019-12-18T00:42:39Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e49f79fc69f17ca645dda872e0c8142755c3bda5", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e49f79fc69f17ca645dda872e0c8142755c3bda5", "committedDate": "2019-12-18T12:03:31Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "040a7f904059ee6f42dae90bbc65d66059a83b67", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/040a7f904059ee6f42dae90bbc65d66059a83b67", "committedDate": "2019-12-23T18:28:12Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1cc8dd6a7c0c13946e7342e06481ef1e960d447", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f1cc8dd6a7c0c13946e7342e06481ef1e960d447", "committedDate": "2019-12-31T16:56:35Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12f7086e0d958ed5572225dc21088ac85d5b77c8", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/12f7086e0d958ed5572225dc21088ac85d5b77c8", "committedDate": "2019-12-31T16:56:57Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c62436684a2c2906951ad7908198061948c6ed6", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/6c62436684a2c2906951ad7908198061948c6ed6", "committedDate": "2020-01-01T12:43:02Z", "message": "properly add participation to cache after submission"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "086484395a78e04fb588183f78712eb00ccb264b", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/086484395a78e04fb588183f78712eb00ccb264b", "committedDate": "2020-01-04T22:16:22Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76b4feb70a7fab6d2cfbbd6d4062368ad6f3e248", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/76b4feb70a7fab6d2cfbbd6d4062368ad6f3e248", "committedDate": "2020-01-06T03:39:47Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53c359a8056450b6f8419d6a58baff381f357703", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/53c359a8056450b6f8419d6a58baff381f357703", "committedDate": "2020-01-07T13:46:54Z", "message": "make sure the submission status is displayed properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf78c586acd6a08630d370e942d56ac2f128e18d", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/bf78c586acd6a08630d370e942d56ac2f128e18d", "committedDate": "2020-01-07T13:49:24Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c9d5658d8dcfbcab2ffd4ff6c3138d4864a70b5", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/2c9d5658d8dcfbcab2ffd4ff6c3138d4864a70b5", "committedDate": "2020-01-08T14:36:51Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba56ec23b154ad02d34a449abff78a2287491e9a", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/ba56ec23b154ad02d34a449abff78a2287491e9a", "committedDate": "2020-01-09T15:01:23Z", "message": "Only remove participation websocket subscription for inactive exercises"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cf6310e8c126cf843861080e0dcdfced54dd58e", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/1cf6310e8c126cf843861080e0dcdfced54dd58e", "committedDate": "2020-01-09T15:26:20Z", "message": "Remove root services from modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6423e96a26fd94615c5d7e77ca5add069fb68051", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/6423e96a26fd94615c5d7e77ca5add069fb68051", "committedDate": "2020-01-09T16:21:17Z", "message": "Fix client tests by unbarreling service references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74df938cd44fd8201bcd3a510819a22e3c1addd1", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/74df938cd44fd8201bcd3a510819a22e3c1addd1", "committedDate": "2020-01-09T16:50:14Z", "message": "Unbarrel CourseExerciseService\n\nAlso fix client tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2079c84e4b35654aa569775a2c368e6ca285c1ce", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/2079c84e4b35654aa569775a2c368e6ca285c1ce", "committedDate": "2020-01-09T16:56:16Z", "message": "Fix clien test by unbarreling IWebsocketService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f659fda6371fb3f7e61bb07251acf3e9fd34f915", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/f659fda6371fb3f7e61bb07251acf3e9fd34f915", "committedDate": "2020-01-09T17:59:21Z", "message": "Unbarrel services and components from participation index.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16de1c265b78cdf444266d26dd5e07576541dd6e", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/16de1c265b78cdf444266d26dd5e07576541dd6e", "committedDate": "2020-01-09T18:10:59Z", "message": "Unbarrel programming exercise services"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e282067e038b99758b4db04e4c61cf7b05f07eca", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/e282067e038b99758b4db04e4c61cf7b05f07eca", "committedDate": "2020-01-09T18:15:15Z", "message": "Unbarrel programming exercise components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad601b010cb89345ccb8dd1bcc69d84ac1d93e37", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/ad601b010cb89345ccb8dd1bcc69d84ac1d93e37", "committedDate": "2020-01-09T18:24:05Z", "message": "Fix wrong import in programming-exercise-instruction.spec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b67bfe16b4a8448772753e1ec8078ccaed2f2c6", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/1b67bfe16b4a8448772753e1ec8078ccaed2f2c6", "committedDate": "2020-01-09T18:25:20Z", "message": "Fix wrong import in programming-exercise-editable-instruction.spec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8364521e03828f93d61bcb10b4647709f74d5855", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/8364521e03828f93d61bcb10b4647709f74d5855", "committedDate": "2020-01-09T18:34:42Z", "message": "Fix programming exercise import and test cases client tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d08c5f74b08be5f5da8a40bf20e044301a27b54b", "author": {"user": {"login": "krusche", "name": "Stephan Krusche"}}, "url": "https://github.com/ls1intum/Artemis/commit/d08c5f74b08be5f5da8a40bf20e044301a27b54b", "committedDate": "2020-01-09T22:02:16Z", "message": "Merge branch 'develop' into feature/remove-participation-websocket"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a21863dc78a3b0d436f2e00757370b3a0df66bbe", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/a21863dc78a3b0d436f2e00757370b3a0df66bbe", "committedDate": "2020-01-09T23:17:31Z", "message": "prevent null pointer exception in the rare case that there are multiple submissions and one of them does not have a submission date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6c41dd5eaede632984cea184d5bcbb4c19a59b", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/1e6c41dd5eaede632984cea184d5bcbb4c19a59b", "committedDate": "2020-01-09T23:20:50Z", "message": "use updating result component again on the submission pages for text, modeling and file upload"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c485ac4740b5fa971434ba1a41d8e0cb50b5cea", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/4c485ac4740b5fa971434ba1a41d8e0cb50b5cea", "committedDate": "2020-01-10T00:18:58Z", "message": "fix jsdoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efac07c1894dba27c0ad4ba2f118d1eeee1b3201", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/efac07c1894dba27c0ad4ba2f118d1eeee1b3201", "committedDate": "2020-01-10T00:20:26Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06ea7c48401e1e7d6bccd14f86412f231f3d93c2", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/06ea7c48401e1e7d6bccd14f86412f231f3d93c2", "committedDate": "2020-01-10T00:29:37Z", "message": "fix logic error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/e15777da92e7fad0d38489a49647c6b433751761", "committedDate": "2020-01-10T01:11:32Z", "message": "pass exercise to updating result component"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMDg0NTAw", "url": "https://github.com/ls1intum/Artemis/pull/1167#pullrequestreview-341084500", "createdAt": "2020-01-10T10:45:24Z", "commit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMTA1NjQx", "url": "https://github.com/ls1intum/Artemis/pull/1167#pullrequestreview-341105641", "createdAt": "2020-01-10T11:28:30Z", "commit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMToyODozMVrOFcRhTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMTo0NDo1N1rOFcR3PA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE5MTUwMQ==", "bodyText": "This is not needed and can be removed.  Otherwise, use it in line 188.", "url": "https://github.com/ls1intum/Artemis/pull/1167#discussion_r365191501", "createdAt": "2020-01-10T11:28:31Z", "author": {"login": "jpbernius"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ParticipationService.java", "diffHunk": "@@ -178,13 +178,14 @@ public SolutionProgrammingExerciseParticipation save(SolutionProgrammingExercise\n      * repository / build plan related stuff for programming exercises. In the case of modeling or text exercises, it also initializes and stores the corresponding submission.\n      *\n      * @param exercise the exercise which is started\n-     * @param username the name of the user who starts the exercise\n+     * @param user the user who starts the exercise\n      * @return the participation connecting the given exercise and user\n      */\n-    public StudentParticipation startExercise(Exercise exercise, String username) {\n+    public StudentParticipation startExercise(Exercise exercise, User user) {\n         // common for all exercises\n         // Check if participation already exists\n-        Optional<StudentParticipation> optionalStudentParticipation = findOneByExerciseIdAndStudentLoginAnyState(exercise.getId(), username);\n+        var username = user.getLogin();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE5NzExNg==", "bodyText": "What do two !! mean? Is this meant to be a force unwrap, only needing one !?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            this.participationWebsocketService.unsubscribeForLatestResultOfParticipation(this.studentParticipation.id, this.exercise!!);\n          \n          \n            \n                            this.participationWebsocketService.unsubscribeForLatestResultOfParticipation(this.studentParticipation.id, this.exercise!);", "url": "https://github.com/ls1intum/Artemis/pull/1167#discussion_r365197116", "createdAt": "2020-01-10T11:44:57Z", "author": {"login": "jpbernius"}, "path": "src/main/webapp/app/overview/exercise-details/course-exercise-details.component.ts", "diffHunk": "@@ -87,7 +89,7 @@ export class CourseExerciseDetailsComponent implements OnInit, OnDestroy {\n         if (this.participationUpdateListener) {\n             this.participationUpdateListener.unsubscribe();\n             if (this.studentParticipation) {\n-                this.participationWebsocketService.unsubscribeForLatestResultOfParticipation(this.studentParticipation.id);\n+                this.participationWebsocketService.unsubscribeForLatestResultOfParticipation(this.studentParticipation.id, this.exercise!!);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMTM1OTIx", "url": "https://github.com/ls1intum/Artemis/pull/1167#pullrequestreview-341135921", "createdAt": "2020-01-10T12:36:55Z", "commit": {"oid": "e15777da92e7fad0d38489a49647c6b433751761"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f622ab2d6df7d946cd3ab2e27ecbaaae147f828e", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f622ab2d6df7d946cd3ab2e27ecbaaae147f828e", "committedDate": "2020-01-10T13:04:42Z", "message": "remove unused code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f692147a920deeac90dd6c92645a6ad92b0538cb", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/f692147a920deeac90dd6c92645a6ad92b0538cb", "committedDate": "2020-01-10T13:14:41Z", "message": "add check for the case when a model exercise sample solution is undefined"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddb7308387e85dbf3a88e8b2243b733673226628", "author": {"user": {"login": "ungaralex", "name": "Alexander Ungar"}}, "url": "https://github.com/ls1intum/Artemis/commit/ddb7308387e85dbf3a88e8b2243b733673226628", "committedDate": "2020-01-10T14:02:07Z", "message": "Update src/main/webapp/app/overview/exercise-details/course-exercise-details.component.ts\n\nCo-Authored-By: Jan Philip Bernius <janphilip.bernius@tum.de>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3044, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}