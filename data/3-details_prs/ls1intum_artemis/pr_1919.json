{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxNDYzOTI4", "number": 1919, "title": "Execute \"prepare exercise start\" in fork join pool with exactly 10 threads", "bodyText": "This makes the previously introduced parallelism more deterministic. At the moment, it depends which VM is used (4 CPUs --> 3 Threads in parallel, 12 CPUs --> 11 Threads in parallel). Some instructors might be out of luck and need to wait longer.\nWith this change, it should be independent which VM is chosen in production.\nChecklist\n\n I tested all changes and all related features with different users (student, tutor, instructor, admin) on the test server https://artemistest.ase.in.tum.de.\n\n\nCreate an exam with at least 1 programming exercise and at least 20 participants\nGenerate the individual student exams and click on \"prepare exercise start\"\nThis should be blazingly fast (10x faster than some days ago), because the server runs this task in 10 threads in parallel\nNavigate to the participations page of the programming exercise(s) and check that all are created with state active", "createdAt": "2020-07-17T21:04:33Z", "url": "https://github.com/ls1intum/Artemis/pull/1919", "merged": true, "mergeCommit": {"oid": "27697cdea95450e3c95d2f5af39a0b7328afed63"}, "closed": true, "closedAt": "2020-07-21T08:40:42Z", "author": {"login": "krusche"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc16UQKgH2gAyNDUxNDYzOTI4OjVhZmQxZDhjOWVjM2Y1ODMwODMwY2EwZmE0NjU5NTA4NzZlOTRkYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3CA5_gFqTQ1MjI0MDg0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5afd1d8c9ec3f5830830ca0fa465950876e94dac", "author": {"user": null}, "url": "https://github.com/ls1intum/Artemis/commit/5afd1d8c9ec3f5830830ca0fa465950876e94dac", "committedDate": "2020-07-17T21:00:41Z", "message": "execute in fork join pool with exactly 10 threads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "991b5993851f3a1560205ff0dbcb9433b741b8f3", "author": {"user": {"login": "MaisiKoleni", "name": "Christian Femers"}}, "url": "https://github.com/ls1intum/Artemis/commit/991b5993851f3a1560205ff0dbcb9433b741b8f3", "committedDate": "2020-07-17T21:29:06Z", "message": "Remove try catch as there is nothing to be caught"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e77f304d943464f0cb7337f2c45965842bdcb26e", "author": {"user": {"login": "MaisiKoleni", "name": "Christian Femers"}}, "url": "https://github.com/ls1intum/Artemis/commit/e77f304d943464f0cb7337f2c45965842bdcb26e", "committedDate": "2020-07-17T21:44:47Z", "message": "Wait for the concurrent task to complete"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDYyODQ2", "url": "https://github.com/ls1intum/Artemis/pull/1919#pullrequestreview-451062846", "createdAt": "2020-07-18T15:09:08Z", "commit": {"oid": "e77f304d943464f0cb7337f2c45965842bdcb26e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNTowOTowOFrOGzox-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNTowOTowOFrOGzox-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5ODcxNA==", "bodyText": "@MaisiKoleni can you comment in the Code why the shutdown is necessary here? It looks wrong to me here", "url": "https://github.com/ls1intum/Artemis/pull/1919#discussion_r456798714", "createdAt": "2020-07-18T15:09:08Z", "author": {"login": "krusche"}, "path": "src/main/java/de/tum/in/www1/artemis/service/ExamService.java", "diffHunk": "@@ -573,11 +576,28 @@ public Integer startExercises(Long examId) {\n                     }\n                 }\n             }\n-        });\n+        }));\n \n         return generatedParticipations.size();\n     }\n \n+    private void executeInParallel(Runnable task) {\n+        final int numberOfParallelThreads = 10;\n+        ForkJoinPool forkJoinPool = new ForkJoinPool(numberOfParallelThreads);\n+        Future<?> future = forkJoinPool.submit(task);\n+        forkJoinPool.shutdown();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e77f304d943464f0cb7337f2c45965842bdcb26e"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "686bf1c451ed0c227f71aa8f6cc7df321e8a85c8", "author": {"user": {"login": "MaisiKoleni", "name": "Christian Femers"}}, "url": "https://github.com/ls1intum/Artemis/commit/686bf1c451ed0c227f71aa8f6cc7df321e8a85c8", "committedDate": "2020-07-20T20:10:52Z", "message": "Move shutdown to the end of executeInParallel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMjM5NDM0", "url": "https://github.com/ls1intum/Artemis/pull/1919#pullrequestreview-452239434", "createdAt": "2020-07-21T08:30:53Z", "commit": {"oid": "686bf1c451ed0c227f71aa8f6cc7df321e8a85c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMjQwNTAw", "url": "https://github.com/ls1intum/Artemis/pull/1919#pullrequestreview-452240500", "createdAt": "2020-07-21T08:32:18Z", "commit": {"oid": "686bf1c451ed0c227f71aa8f6cc7df321e8a85c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMjQwODQ0", "url": "https://github.com/ls1intum/Artemis/pull/1919#pullrequestreview-452240844", "createdAt": "2020-07-21T08:32:43Z", "commit": {"oid": "686bf1c451ed0c227f71aa8f6cc7df321e8a85c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4386, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}