{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxOTQ3NDE3", "number": 5208, "title": "Remove pbj=1 parameter from YouYube urls in recaptcha activity", "bodyText": "What is it?\n\n Bugfix (user facing)\n Feature (user facing)\n Codebase improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\nThis PR removes the pbj=1 parameter from the URLs loaded in the reCAPTCHA webview, so that an actual HTML page is loaded instead of the ajax json requested by the extractor, which would render as a blank page.\nFixes the following issue(s)\nHopefully fixes #3714\nAPK testing\nThis apk throws a ReCaptchaException on every request, with the first request being the \"test\" search, always run on app opening.\napp-debug.zip\nDue diligence\n\n I read the contribution guidelines.", "createdAt": "2020-12-17T15:37:32Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5208", "merged": true, "mergeCommit": {"oid": "96862cbcb31678976b51b01bbb97e4638f1302e7"}, "closed": true, "closedAt": "2020-12-18T17:28:45Z", "author": {"login": "Stypox"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnGvt_AFqTU1NDgwMjk3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnS04aAFqTU1NTIxNzIyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0ODAyOTc2", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5208#pullrequestreview-554802976", "createdAt": "2020-12-17T17:01:45Z", "commit": {"oid": "fb1eb3176de1d9504a4b4a7897f5b1a71fbb21d5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzowMTo0NVrOIH_a4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzowMjowMlrOIH_btA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI1MDAxNw==", "bodyText": "The method should be renamed.\nFor me a getter should only get a value and not modify it in between. If you only read the line above final String url = getUrlFromIntent(); and not the implementation itself, it could cause confusion down the line", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5208#discussion_r545250017", "createdAt": "2020-12-17T17:01:45Z", "author": {"login": "XiangRongLin"}, "path": "app/src/main/java/org/schabi/newpipe/ReCaptchaActivity.java", "diffHunk": "@@ -155,6 +150,16 @@ public boolean onOptionsItemSelected(final MenuItem item) {\n         }\n     }\n \n+    private String getUrlFromIntent() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb1eb3176de1d9504a4b4a7897f5b1a71fbb21d5"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI1MDIyOA==", "bodyText": "This looks like it would break urls like www.host.com/?pbj=1&otherparam=2 by turning it to www.host.com/otherparam=2", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5208#discussion_r545250228", "createdAt": "2020-12-17T17:02:02Z", "author": {"login": "XiangRongLin"}, "path": "app/src/main/java/org/schabi/newpipe/ReCaptchaActivity.java", "diffHunk": "@@ -155,6 +150,16 @@ public boolean onOptionsItemSelected(final MenuItem item) {\n         }\n     }\n \n+    private String getUrlFromIntent() {\n+        final String url = getIntent().getStringExtra(RECAPTCHA_URL_EXTRA);\n+        if (url == null || url.isEmpty()) {\n+            return YT_URL; // YouTube is the most likely service to have thrown a recaptcha\n+        } else {\n+            // remove \"pbj=1\" parameter from YouYube urls, as it makes the page JSON and not HTML\n+            return url.replace(\"&pbj=1\", \"\").replace(\"?pbj=1&\", \"\").replace(\"?pbj=1\", \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb1eb3176de1d9504a4b4a7897f5b1a71fbb21d5"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10f79e13070b6e858b92a0bcfd55b32240e13197", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/10f79e13070b6e858b92a0bcfd55b32240e13197", "committedDate": "2020-12-17T20:02:13Z", "message": "Remove pbj=1 parameter from YouYube urls in recaptcha activity"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb1eb3176de1d9504a4b4a7897f5b1a71fbb21d5", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/fb1eb3176de1d9504a4b4a7897f5b1a71fbb21d5", "committedDate": "2020-12-17T15:32:03Z", "message": "Remove pbj=1 parameter from YouYube urls in recaptcha activity"}, "afterCommit": {"oid": "10f79e13070b6e858b92a0bcfd55b32240e13197", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/10f79e13070b6e858b92a0bcfd55b32240e13197", "committedDate": "2020-12-17T20:02:13Z", "message": "Remove pbj=1 parameter from YouYube urls in recaptcha activity"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MjE3MjIz", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5208#pullrequestreview-555217223", "createdAt": "2020-12-18T07:16:20Z", "commit": {"oid": "10f79e13070b6e858b92a0bcfd55b32240e13197"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4053, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}