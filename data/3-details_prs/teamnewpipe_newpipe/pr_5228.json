{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyOTkwOTkx", "number": 5228, "title": "Remove timestamp from share url for all services except youtube", "bodyText": "What is it?\n\n Bugfix (user facing)\n Feature (user facing)\n Codebase improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\n\nRemove timestamp from share url unless it's youtube.\nIt produced not found error for PeerTube, media.ccc.de, SoundCloud.\nIdeally we should implement this\n#4316 (comment)\n\nwe also shouldn't even use URL there client-side, but add an extractor-side API for getting an URL with timestamp.\n\nbut it has been three months and no one is willing to work on this, then I'd like to get this PR merged for the next release.\nFixes the following issue(s)\n\n\nfixes #4316\n\nAPK testing\n\napp-debug.zip\nDue diligence\n\n I read the contribution guidelines.", "createdAt": "2020-12-19T23:15:43Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5228", "merged": true, "mergeCommit": {"oid": "0c656abb8e1aab7b78e03562611e1729eae0bdbe"}, "closed": true, "closedAt": "2020-12-20T10:20:35Z", "author": {"login": "B0pol"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdn8VYCAFqTU1NTk5MjU5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdn-aXwAFqTU1NjAwMjg5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1OTkyNTk5", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5228#pullrequestreview-555992599", "createdAt": "2020-12-20T07:37:27Z", "commit": {"oid": "9436828d8c3c34274f8cba23344df7e4bb4333fe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQwNzozNzoyN1rOIJBsUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQwNzozNzoyN1rOIJBsUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMzNTgyNQ==", "bodyText": "Can't ServiceHelper.getSelectedService be used? It has the advantage of not relying on the specific format of the url.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5228#discussion_r546335825", "createdAt": "2020-12-20T07:37:27Z", "author": {"login": "XiangRongLin"}, "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayerImpl.java", "diffHunk": "@@ -889,10 +889,15 @@ private void onMoreOptionsClicked() {\n     private void onShareClicked() {\n         // share video at the current time (youtube.com/watch?v=ID&t=SECONDS)\n         // Timestamp doesn't make sense in a live stream so drop it\n-        final String ts = isLive() ? \"\" : (\"&t=\" + (getPlaybackSeekBar().getProgress() / 1000));\n+\n+        String videoUrl = getVideoUrl();\n+        final int ts = getPlaybackSeekBar().getProgress() / 1000;\n+        if (!isLive() && videoUrl.contains(\"https://www.youtube.com\") && ts >= 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9436828d8c3c34274f8cba23344df7e4bb4333fe"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9436828d8c3c34274f8cba23344df7e4bb4333fe", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/9436828d8c3c34274f8cba23344df7e4bb4333fe", "committedDate": "2020-12-19T23:03:19Z", "message": "remove timestamp from share url for all services except youtube\n\nIt produces not found error for PeerTube, media.ccc.de, SoundCloud"}, "afterCommit": {"oid": "b2b25dbebe0c50d311bd29e94bf3ade0d7bab4d7", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/b2b25dbebe0c50d311bd29e94bf3ade0d7bab4d7", "committedDate": "2020-12-20T09:51:22Z", "message": "remove timestamp from share url for all services except youtube\n\nIt produces not found error for PeerTube, media.ccc.de, SoundCloud"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a7a90bf79a613dad94fac4eea1af3747ccbb725", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/7a7a90bf79a613dad94fac4eea1af3747ccbb725", "committedDate": "2020-12-20T09:53:22Z", "message": "remove timestamp from share url for all services except youtube\n\nIt produces not found error for PeerTube, media.ccc.de, SoundCloud"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2b25dbebe0c50d311bd29e94bf3ade0d7bab4d7", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/b2b25dbebe0c50d311bd29e94bf3ade0d7bab4d7", "committedDate": "2020-12-20T09:51:22Z", "message": "remove timestamp from share url for all services except youtube\n\nIt produces not found error for PeerTube, media.ccc.de, SoundCloud"}, "afterCommit": {"oid": "7a7a90bf79a613dad94fac4eea1af3747ccbb725", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/7a7a90bf79a613dad94fac4eea1af3747ccbb725", "committedDate": "2020-12-20T09:53:22Z", "message": "remove timestamp from share url for all services except youtube\n\nIt produces not found error for PeerTube, media.ccc.de, SoundCloud"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MDAyODkw", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5228#pullrequestreview-556002890", "createdAt": "2020-12-20T10:03:12Z", "commit": {"oid": "7a7a90bf79a613dad94fac4eea1af3747ccbb725"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4054, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}