{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNzMyNDU5", "number": 5067, "title": "Add a workaround for a possible null offset ID.", "bodyText": "What is it?\n\n Bugfix (user facing)\n Feature (user facing)\n Codebase improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\n\n\nWorks around an issue reported by @opusforlife2 in which the ID of the UTC ZoneOffset might be null (even though its documentation explicitly says that a ZoneId's ID value is not null).\n\nAPK testing\n\napp-release.zip\nDue diligence\n\n I read the contribution guidelines.", "createdAt": "2020-12-02T04:15:26Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067", "merged": true, "mergeCommit": {"oid": "3c306a0971d0615ad451d7e1ab8063f372652f0d"}, "closed": true, "closedAt": "2020-12-10T10:37:18Z", "author": {"login": "Isira-Seneviratne"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdieHCdAFqTU0MzY3MzMyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkw53_AFqTU0OTA2MzE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzNjczMzI1", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#pullrequestreview-543673325", "createdAt": "2020-12-03T07:35:30Z", "commit": {"oid": "6c7a2165e64fda9ac576451771be2bc4f7bd5af6"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzOTA4Mzgx", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#pullrequestreview-543908381", "createdAt": "2020-12-03T12:34:40Z", "commit": {"oid": "eeee9ef08661774018fd32e302646fca24bdff8d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjozNDo0MVrOH-Ze1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjozNDo0MVrOH-Ze1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MTI1Mg==", "bodyText": "Don't make a private method public for the sake of testing.\nInstead you should test the methods thats using the private method or extract the method into it's own class (not 100% sure on the second part myself yet)\nIn this case i would write tests for public static String relativeTime(final OffsetDateTime offsetDateTime). If done this way you will provide the value of having regression test for when the workaround is removed. Because currently your tests will need to be removed, when the workaround ist removed.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#discussion_r535191252", "createdAt": "2020-12-03T12:34:41Z", "author": {"login": "XiangRongLin"}, "path": "app/src/main/java/org/schabi/newpipe/util/Localization.java", "diffHunk": "@@ -328,7 +328,7 @@ public static String relativeTime(final Calendar calendarTime) {\n     // This method is a modified version of GregorianCalendar.from(ZonedDateTime).\n     // Math.addExact() and Math.multiplyExact() are desugared even though lint displays a warning.\n     @SuppressWarnings(\"NewApi\")\n-    private static GregorianCalendar fromUTC(final OffsetDateTime offsetDateTime) {\n+    public static GregorianCalendar fromUTC(final OffsetDateTime offsetDateTime) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eeee9ef08661774018fd32e302646fca24bdff8d"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eeee9ef08661774018fd32e302646fca24bdff8d", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/eeee9ef08661774018fd32e302646fca24bdff8d", "committedDate": "2020-12-03T11:25:03Z", "message": "Add tests for workaround."}, "afterCommit": {"oid": "6c7a2165e64fda9ac576451771be2bc4f7bd5af6", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6c7a2165e64fda9ac576451771be2bc4f7bd5af6", "committedDate": "2020-12-02T04:09:40Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MTQ5ODQ1", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#pullrequestreview-545149845", "createdAt": "2020-12-04T17:19:43Z", "commit": {"oid": "c14e9ab349fd8070cf5aee31110ab881eb79a3c5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNzoxOTo0NFrOH_aUAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNzoxOTo0NFrOH_aUAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MzQ0MQ==", "bodyText": "The tests are not covering the bug that you fixed. I can change back this line and your tests still pass successfully\nnvm, i realised my mistake.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#discussion_r536253441", "createdAt": "2020-12-04T17:19:44Z", "author": {"login": "XiangRongLin"}, "path": "app/src/main/java/org/schabi/newpipe/util/Localization.java", "diffHunk": "@@ -314,13 +318,33 @@ private static void initPrettyTime(final Context context) {\n     }\n \n     public static String relativeTime(final OffsetDateTime offsetDateTime) {\n-        return relativeTime(GregorianCalendar.from(offsetDateTime.toZonedDateTime()));\n+        return relativeTime(fromUTC(offsetDateTime));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14e9ab349fd8070cf5aee31110ab881eb79a3c5"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c14e9ab349fd8070cf5aee31110ab881eb79a3c5", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c14e9ab349fd8070cf5aee31110ab881eb79a3c5", "committedDate": "2020-12-04T00:52:37Z", "message": "Add tests for workaround."}, "afterCommit": {"oid": "6bd01ead8b5050ef1e6b44749a6ac288a2cd323e", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6bd01ead8b5050ef1e6b44749a6ac288a2cd323e", "committedDate": "2020-12-10T09:21:38Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6bd01ead8b5050ef1e6b44749a6ac288a2cd323e", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6bd01ead8b5050ef1e6b44749a6ac288a2cd323e", "committedDate": "2020-12-10T09:21:38Z", "message": "Add a workaround for a possible null offset ID."}, "afterCommit": {"oid": "b9138bcc60bbacfde090e9737a41ac520822c284", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/b9138bcc60bbacfde090e9737a41ac520822c284", "committedDate": "2020-12-10T09:22:55Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9138bcc60bbacfde090e9737a41ac520822c284", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/b9138bcc60bbacfde090e9737a41ac520822c284", "committedDate": "2020-12-10T09:22:55Z", "message": "Add a workaround for a possible null offset ID."}, "afterCommit": {"oid": "ca30c7a1b075eae6c9c47170097b1fd4aced2842", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ca30c7a1b075eae6c9c47170097b1fd4aced2842", "committedDate": "2020-12-10T09:38:58Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0d6c8aeb37490d8a0274c33e5b1557842147342", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c0d6c8aeb37490d8a0274c33e5b1557842147342", "committedDate": "2020-12-10T09:53:30Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca30c7a1b075eae6c9c47170097b1fd4aced2842", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ca30c7a1b075eae6c9c47170097b1fd4aced2842", "committedDate": "2020-12-10T09:38:58Z", "message": "Add a workaround for a possible null offset ID."}, "afterCommit": {"oid": "c0d6c8aeb37490d8a0274c33e5b1557842147342", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c0d6c8aeb37490d8a0274c33e5b1557842147342", "committedDate": "2020-12-10T09:53:30Z", "message": "Add a workaround for a possible null offset ID."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MDYzMTQz", "url": "https://github.com/TeamNewPipe/NewPipe/pull/5067#pullrequestreview-549063143", "createdAt": "2020-12-10T10:37:10Z", "commit": {"oid": "c0d6c8aeb37490d8a0274c33e5b1557842147342"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4087, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}