{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MTg0OTky", "number": 4276, "title": "Use ContextCompat methods.", "bodyText": "What is it?\n\n Bug fix (user facing)\n Feature (user facing)\n Code base improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\n\n\nUse ContextCompat's getSystemService and startForegroundService methods.\n\nTesting apk\n\ndebug.zip\nAgreement\n\n I carefully read the contribution guidelines and agree to them.", "createdAt": "2020-09-13T13:51:17Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276", "merged": true, "mergeCommit": {"oid": "3c67df263c494ba437d4788f7208e41aaaabed43"}, "closed": true, "closedAt": "2020-10-10T19:51:34Z", "author": {"login": "Isira-Seneviratne"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIfIxWABqjM3NjA0NzU3MTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRQRQwgFqTUwNjEyMjM2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "884f5623331f0402918b9b510f2f324b58056c55", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/884f5623331f0402918b9b510f2f324b58056c55", "committedDate": "2020-09-13T11:53:16Z", "message": "Use ContextCompat.startForegroundService()."}, "afterCommit": {"oid": "14d89f98b1cd1dfba2788e90893c0bb3fe7bdeb0", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/14d89f98b1cd1dfba2788e90893c0bb3fe7bdeb0", "committedDate": "2020-09-13T14:05:03Z", "message": "Use ContextCompat.startForegroundService()."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14d89f98b1cd1dfba2788e90893c0bb3fe7bdeb0", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/14d89f98b1cd1dfba2788e90893c0bb3fe7bdeb0", "committedDate": "2020-09-13T14:05:03Z", "message": "Use ContextCompat.startForegroundService()."}, "afterCommit": {"oid": "f0925034993490c6a8baaf9ce215fa1cc71a441b", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/f0925034993490c6a8baaf9ce215fa1cc71a441b", "committedDate": "2020-09-13T14:13:24Z", "message": "Use ContextCompat.startForegroundService()."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec559e6e849496447c5bd14eb9171484262aa99f", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ec559e6e849496447c5bd14eb9171484262aa99f", "committedDate": "2020-09-16T13:33:15Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "34da1bdee91900e3b3e175705d19a03527cdc386", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/34da1bdee91900e3b3e175705d19a03527cdc386", "committedDate": "2020-09-16T14:32:23Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NzA1MTUy", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#pullrequestreview-489705152", "createdAt": "2020-09-16T14:47:47Z", "commit": {"oid": "34da1bdee91900e3b3e175705d19a03527cdc386"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34da1bdee91900e3b3e175705d19a03527cdc386", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/34da1bdee91900e3b3e175705d19a03527cdc386", "committedDate": "2020-09-16T14:32:23Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "811c790b0b49d749b0351b2786dbbba7a8fa50dd", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/811c790b0b49d749b0351b2786dbbba7a8fa50dd", "committedDate": "2020-09-21T02:50:59Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNzY2NDUy", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#pullrequestreview-492766452", "createdAt": "2020-09-21T16:03:42Z", "commit": {"oid": "811c790b0b49d749b0351b2786dbbba7a8fa50dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjowMzo0MlrOHVYFWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjowMzo0MlrOHVYFWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE3NjczMQ==", "bodyText": "Not ContextCompat here?", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#discussion_r492176731", "createdAt": "2020-09-21T16:03:42Z", "author": {"login": "Redirion"}, "path": "app/src/main/java/org/schabi/newpipe/util/DeviceUtils.java", "diffHunk": "@@ -32,15 +31,14 @@ public static boolean isTv(final Context context) {\n         final PackageManager pm = App.getApp().getPackageManager();\n \n         // from doc: https://developer.android.com/training/tv/start/hardware.html#runtime-check\n-        boolean isTv = ((UiModeManager) context.getSystemService(UI_MODE_SERVICE))\n+        boolean isTv = ContextCompat.getSystemService(context, UiModeManager.class)\n                 .getCurrentModeType() == Configuration.UI_MODE_TYPE_TELEVISION\n                 || pm.hasSystemFeature(AMAZON_FEATURE_FIRE_TV)\n                 || pm.hasSystemFeature(PackageManager.FEATURE_TELEVISION);\n \n         // from https://stackoverflow.com/a/58932366\n         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {\n-            final boolean isBatteryAbsent\n-                    = ((BatteryManager) context.getSystemService(BATTERY_SERVICE))\n+            final boolean isBatteryAbsent = context.getSystemService(BatteryManager.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "811c790b0b49d749b0351b2786dbbba7a8fa50dd"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "811c790b0b49d749b0351b2786dbbba7a8fa50dd", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/811c790b0b49d749b0351b2786dbbba7a8fa50dd", "committedDate": "2020-09-21T02:50:59Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "9d2f0a7d6346e41473f320e2e8cabb13afd1f64f", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/9d2f0a7d6346e41473f320e2e8cabb13afd1f64f", "committedDate": "2020-09-28T03:17:15Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9d2f0a7d6346e41473f320e2e8cabb13afd1f64f", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/9d2f0a7d6346e41473f320e2e8cabb13afd1f64f", "committedDate": "2020-09-28T03:17:15Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "4ea6aa69b2c0223ca75fdae72d07bb34ad07a493", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/4ea6aa69b2c0223ca75fdae72d07bb34ad07a493", "committedDate": "2020-09-29T23:21:16Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ea6aa69b2c0223ca75fdae72d07bb34ad07a493", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/4ea6aa69b2c0223ca75fdae72d07bb34ad07a493", "committedDate": "2020-09-29T23:21:16Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "05ef697b72d8b50527cfd47cfc56bdb90a01edc6", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/05ef697b72d8b50527cfd47cfc56bdb90a01edc6", "committedDate": "2020-10-04T02:53:13Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05ef697b72d8b50527cfd47cfc56bdb90a01edc6", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/05ef697b72d8b50527cfd47cfc56bdb90a01edc6", "committedDate": "2020-10-04T02:53:13Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "e3d1f750b15b6855a8cc39f9236e2c7129f06154", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/e3d1f750b15b6855a8cc39f9236e2c7129f06154", "committedDate": "2020-10-05T13:04:00Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e3d1f750b15b6855a8cc39f9236e2c7129f06154", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/e3d1f750b15b6855a8cc39f9236e2c7129f06154", "committedDate": "2020-10-05T13:04:00Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/61ae65a4a92575487ce2f8ca65ba1d2e89c34a74", "committedDate": "2020-10-07T00:18:38Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNTMwNDAz", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#pullrequestreview-503530403", "createdAt": "2020-10-07T05:15:31Z", "commit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwNToxNTozMVrOHdi4QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwNToyMDo1NFrOHdi9zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDc0MjIwOA==", "bodyText": "Why getApplicationContext()? Isn't context already enough, like the line below?", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#discussion_r500742208", "createdAt": "2020-10-07T05:15:31Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/player/helper/LockManager.java", "diffHunk": "@@ -18,10 +17,9 @@\n     private WifiManager.WifiLock wifiLock;\n \n     public LockManager(final Context context) {\n-        powerManager = ((PowerManager) context.getApplicationContext()\n-                .getSystemService(POWER_SERVICE));\n-        wifiManager = ((WifiManager) context.getApplicationContext()\n-                .getSystemService(WIFI_SERVICE));\n+        powerManager = ContextCompat.getSystemService(context.getApplicationContext(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDc0MzQ1Ng==", "bodyText": "Instead of adding this line to the lint suppressions, just split it in half", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#discussion_r500743456", "createdAt": "2020-10-07T05:20:14Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/App.java", "diffHunk": "@@ -219,49 +219,30 @@ protected void initACRA() {\n         }\n     }\n \n-    public void initNotificationChannel() {\n+    private void initNotificationChannels() {\n         if (Build.VERSION.SDK_INT < Build.VERSION_CODES.O) {\n             return;\n         }\n \n-        final String id = getString(R.string.notification_channel_id);\n-        final CharSequence name = getString(R.string.notification_channel_name);\n-        final String description = getString(R.string.notification_channel_description);\n+        String id = getString(R.string.notification_channel_id);\n+        String name = getString(R.string.notification_channel_name);\n+        String description = getString(R.string.notification_channel_description);\n \n         // Keep this below DEFAULT to avoid making noise on every notification update\n         final int importance = NotificationManager.IMPORTANCE_LOW;\n \n-        final NotificationChannel mChannel = new NotificationChannel(id, name, importance);\n-        mChannel.setDescription(description);\n+        final NotificationChannel mainChannel = new NotificationChannel(id, name, importance);\n+        mainChannel.setDescription(description);\n \n-        final NotificationManager mNotificationManager =\n-                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n-        mNotificationManager.createNotificationChannel(mChannel);\n+        id = getString(R.string.app_update_notification_channel_id);\n+        name = getString(R.string.app_update_notification_channel_name);\n+        description = getString(R.string.app_update_notification_channel_description);\n \n-        setUpUpdateNotificationChannel(importance);\n-    }\n+        final NotificationChannel appUpdateChannel = new NotificationChannel(id, name, importance);\n+        appUpdateChannel.setDescription(description);\n \n-    /**\n-     * Set up notification channel for app update.\n-     *\n-     * @param importance\n-     */\n-    @TargetApi(Build.VERSION_CODES.O)\n-    private void setUpUpdateNotificationChannel(final int importance) {\n-        final String appUpdateId\n-                = getString(R.string.app_update_notification_channel_id);\n-        final CharSequence appUpdateName\n-                = getString(R.string.app_update_notification_channel_name);\n-        final String appUpdateDescription\n-                = getString(R.string.app_update_notification_channel_description);\n-\n-        final NotificationChannel appUpdateChannel\n-                = new NotificationChannel(appUpdateId, appUpdateName, importance);\n-        appUpdateChannel.setDescription(appUpdateDescription);\n-\n-        final NotificationManager appUpdateNotificationManager\n-                = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n-        appUpdateNotificationManager.createNotificationChannel(appUpdateChannel);\n+        final NotificationManager notificationManager = getSystemService(NotificationManager.class);\n+        notificationManager.createNotificationChannels(Arrays.asList(mainChannel, appUpdateChannel));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDc0MzYyOA==", "bodyText": "So remove this\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n              <suppress checks=\"LineLength\"\n          \n          \n            \n                  files=\"App.java\"\n          \n          \n            \n                  lines=\"245\"/>", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#discussion_r500743628", "createdAt": "2020-10-07T05:20:54Z", "author": {"login": "Stypox"}, "path": "checkstyle-suppressions.xml", "diffHunk": "@@ -13,7 +13,11 @@\n \n   <suppress checks=\"FinalParameters\"\n       files=\"ListHelper.java\"\n-      lines=\"280,312\"/>\n+      lines=\"282,314\"/>\n+\n+  <suppress checks=\"LineLength\"\n+      files=\"App.java\"\n+      lines=\"245\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61ae65a4a92575487ce2f8ca65ba1d2e89c34a74", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/61ae65a4a92575487ce2f8ca65ba1d2e89c34a74", "committedDate": "2020-10-07T00:18:38Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "53e8e9f23a9adb9f80e3828723761d603a6e4339", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/53e8e9f23a9adb9f80e3828723761d603a6e4339", "committedDate": "2020-10-07T05:32:57Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b720b004485172f82762063b1754fe9d063ae6", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/58b720b004485172f82762063b1754fe9d063ae6", "committedDate": "2020-10-09T03:22:05Z", "message": "Use ContextCompat.getSystemService() and the Context.getSystemService() extension function."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4084c4f97b9fb1d4f40a268d4faf3f2486ae891", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c4084c4f97b9fb1d4f40a268d4faf3f2486ae891", "committedDate": "2020-10-09T03:22:05Z", "message": "Use ContextCompat.startForegroundService()."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f55381d689f3702ae084f3813cc286a65fd79aeb", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/f55381d689f3702ae084f3813cc286a65fd79aeb", "committedDate": "2020-10-09T03:22:05Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "53e8e9f23a9adb9f80e3828723761d603a6e4339", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/53e8e9f23a9adb9f80e3828723761d603a6e4339", "committedDate": "2020-10-07T05:32:57Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}, "afterCommit": {"oid": "f55381d689f3702ae084f3813cc286a65fd79aeb", "author": {"user": {"login": "Isira-Seneviratne", "name": "Isira Seneviratne"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/f55381d689f3702ae084f3813cc286a65fd79aeb", "committedDate": "2020-10-09T03:22:05Z", "message": "Combine initNotificationChannel() and setUpUpdateNotificationChannel() into a single method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTIyMzYz", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4276#pullrequestreview-506122363", "createdAt": "2020-10-10T19:51:17Z", "commit": {"oid": "f55381d689f3702ae084f3813cc286a65fd79aeb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4117, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}