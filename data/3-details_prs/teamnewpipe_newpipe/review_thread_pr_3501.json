{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwNjEzMzg4", "number": 3501, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMTowNToyNFrOD9v4Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo0ODozNlrOD9yFdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDc0MTQ3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMTowNToyNFrOGXbO_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjo1NToxNlrOGXpuuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIxNjYzNg==", "bodyText": "Maybe the title should be changed to something like \"Open in browser\"", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3501#discussion_r427216636", "createdAt": "2020-05-19T11:05:24Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -2,19 +2,77 @@\n \n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n import android.net.Uri;\n \n import org.schabi.newpipe.R;\n \n public final class ShareUtils {\n-    private ShareUtils() { }\n+    private ShareUtils() {\n+    }\n \n+    /**\n+     * Open the url with the system default browser.\n+     * <p>\n+     * If no browser is set as default, fallbacks to\n+     * {@link ShareUtils#openUrlBrowserChooser(Context, String)}\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n     public static void openUrlInBrowser(final Context context, final String url) {\n-        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(url));\n+\n+        final String defaultBrowserPackageName = getDefaultBrowserPackageName(context);\n+\n+        if (defaultBrowserPackageName.equals(\"android\")) {\n+            // no browser set as default\n+            openUrlBrowserChooser(context, url);\n+        } else {\n+            intent.setPackage(defaultBrowserPackageName);\n+            context.startActivity(intent);\n+        }\n+    }\n+\n+    /**\n+     * Open the url with application chooser, including browser and apps able to open url.\n+     * <p>\n+     * If any app (except browser, typically NewPipe) is set as default,\n+     * it will nor open in browser, neither open the chooser, but just the default app.\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n+    private static void openUrlBrowserChooser(final Context context, final String url) {\n+        final Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n         context.startActivity(Intent.createChooser(\n                 intent, context.getString(R.string.share_dialog_title)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7cd4d5989b8f1056366c98ed95f0afea6718033"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMzNTYzNg==", "bodyText": "Nope, that's why i did this PR: it doesn't open in browser, but in favorite / default app for the type of link (in NewPipe case, \"open in Browser\" doesn't open browser but newpipe, so it's pointless) , and if there is no default app set for this type of link, it opens a chooser (with browser and NewPipe).\nWhat about openInDefaultApp()?", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3501#discussion_r427335636", "createdAt": "2020-05-19T14:15:22Z", "author": {"login": "B0pol"}, "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -2,19 +2,77 @@\n \n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n import android.net.Uri;\n \n import org.schabi.newpipe.R;\n \n public final class ShareUtils {\n-    private ShareUtils() { }\n+    private ShareUtils() {\n+    }\n \n+    /**\n+     * Open the url with the system default browser.\n+     * <p>\n+     * If no browser is set as default, fallbacks to\n+     * {@link ShareUtils#openUrlBrowserChooser(Context, String)}\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n     public static void openUrlInBrowser(final Context context, final String url) {\n-        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(url));\n+\n+        final String defaultBrowserPackageName = getDefaultBrowserPackageName(context);\n+\n+        if (defaultBrowserPackageName.equals(\"android\")) {\n+            // no browser set as default\n+            openUrlBrowserChooser(context, url);\n+        } else {\n+            intent.setPackage(defaultBrowserPackageName);\n+            context.startActivity(intent);\n+        }\n+    }\n+\n+    /**\n+     * Open the url with application chooser, including browser and apps able to open url.\n+     * <p>\n+     * If any app (except browser, typically NewPipe) is set as default,\n+     * it will nor open in browser, neither open the chooser, but just the default app.\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n+    private static void openUrlBrowserChooser(final Context context, final String url) {\n+        final Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n         context.startActivity(Intent.createChooser(\n                 intent, context.getString(R.string.share_dialog_title)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIxNjYzNg=="}, "originalCommit": {"oid": "f7cd4d5989b8f1056366c98ed95f0afea6718033"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NDEzOQ==", "bodyText": "Oh right sorry ;-)\nYeah, openInDefaultApp() is maybe a better name", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3501#discussion_r427454139", "createdAt": "2020-05-19T16:55:16Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -2,19 +2,77 @@\n \n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n import android.net.Uri;\n \n import org.schabi.newpipe.R;\n \n public final class ShareUtils {\n-    private ShareUtils() { }\n+    private ShareUtils() {\n+    }\n \n+    /**\n+     * Open the url with the system default browser.\n+     * <p>\n+     * If no browser is set as default, fallbacks to\n+     * {@link ShareUtils#openUrlBrowserChooser(Context, String)}\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n     public static void openUrlInBrowser(final Context context, final String url) {\n-        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(url));\n+\n+        final String defaultBrowserPackageName = getDefaultBrowserPackageName(context);\n+\n+        if (defaultBrowserPackageName.equals(\"android\")) {\n+            // no browser set as default\n+            openUrlBrowserChooser(context, url);\n+        } else {\n+            intent.setPackage(defaultBrowserPackageName);\n+            context.startActivity(intent);\n+        }\n+    }\n+\n+    /**\n+     * Open the url with application chooser, including browser and apps able to open url.\n+     * <p>\n+     * If any app (except browser, typically NewPipe) is set as default,\n+     * it will nor open in browser, neither open the chooser, but just the default app.\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n+    private static void openUrlBrowserChooser(final Context context, final String url) {\n+        final Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n         context.startActivity(Intent.createChooser(\n                 intent, context.getString(R.string.share_dialog_title)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIxNjYzNg=="}, "originalCommit": {"oid": "f7cd4d5989b8f1056366c98ed95f0afea6718033"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTA3NTU5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo0MTo0NVrOGXegmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo0MTo0NVrOGXegmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI3MDI5OQ==", "bodyText": "Move the intent instantiation code inside the else branch, as it is not needed otherwise", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3501#discussion_r427270299", "createdAt": "2020-05-19T12:41:45Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -2,19 +2,77 @@\n \n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n import android.net.Uri;\n \n import org.schabi.newpipe.R;\n \n public final class ShareUtils {\n-    private ShareUtils() { }\n+    private ShareUtils() {\n+    }\n \n+    /**\n+     * Open the url with the system default browser.\n+     * <p>\n+     * If no browser is set as default, fallbacks to\n+     * {@link ShareUtils#openUrlBrowserChooser(Context, String)}\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n     public static void openUrlInBrowser(final Context context, final String url) {\n-        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(url));\n+\n+        final String defaultBrowserPackageName = getDefaultBrowserPackageName(context);\n+\n+        if (defaultBrowserPackageName.equals(\"android\")) {\n+            // no browser set as default\n+            openUrlBrowserChooser(context, url);\n+        } else {\n+            intent.setPackage(defaultBrowserPackageName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7cd4d5989b8f1056366c98ed95f0afea6718033"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTEwMzI0OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo0ODozNlrOGXex_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo0ODozNlrOGXex_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI3NDc0OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    final Intent intent = new Intent(Intent.ACTION_VIEW);\n          \n          \n            \n                    intent.setData(Uri.parse(url));\n          \n          \n            \n                    final Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3501#discussion_r427274748", "createdAt": "2020-05-19T12:48:36Z", "author": {"login": "Stypox"}, "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -2,19 +2,77 @@\n \n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n import android.net.Uri;\n \n import org.schabi.newpipe.R;\n \n public final class ShareUtils {\n-    private ShareUtils() { }\n+    private ShareUtils() {\n+    }\n \n+    /**\n+     * Open the url with the system default browser.\n+     * <p>\n+     * If no browser is set as default, fallbacks to\n+     * {@link ShareUtils#openUrlBrowserChooser(Context, String)}\n+     *\n+     * @param context the context to use\n+     * @param url     the url to browse\n+     */\n     public static void openUrlInBrowser(final Context context, final String url) {\n-        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));\n+        final Intent intent = new Intent(Intent.ACTION_VIEW);\n+        intent.setData(Uri.parse(url));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7cd4d5989b8f1056366c98ed95f0afea6718033"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3169, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}