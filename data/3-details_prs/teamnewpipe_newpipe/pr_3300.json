{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1NTUwNDgz", "number": 3300, "title": "handle ContentNotSupportedException", "bodyText": "What is it?\n\n Bug fix\n Feature\n improvement\n\nLong description of the changes in your PR\nSee TeamNewPipe/NewPipeExtractor#300 and TeamNewPipe/NewPipeExtractor#250\nCopy paste from TeamNewPipe/NewPipeExtractor#300\n\nFollows the discussion we had in TeamNewPipe/NewPipeExtractor#250\nIt will greatly improve SoundCloud usability, because instead of randomly crashing, it will show the error with an appropriated UI, not a crash report, then the average user will understand why, and he can go back to play another track.\nBefore, the user was confused, and it went back to main kiosk each time, so it was really annoying.\n\nHow to Test: use debug apk below, search for \"Dua Lipa\" in SoundCloud, go to her channel page, and play the newest track, or go to youtube music.\nScreenshots:\n \nRelies on the following changes\n\nTeamNewPipe/NewPipeExtractor#300\nTesting apk\nNewPipe_contentnotsupported-debug.zip\nAgreement\n\n I carefully read the contribution guidelines and agree to them.", "createdAt": "2020-03-30T10:16:10Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300", "merged": true, "mergeCommit": {"oid": "e51314b1047d7abe441c01e41568181bac190e2c"}, "closed": true, "closedAt": "2020-04-10T08:33:35Z", "author": {"login": "B0pol"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSsAxTgBqjMxNzc5NjkwOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWM41GgFqTM5MTMzMjI3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b6d9f3a385ab56405f03956d7684aceb49d951f", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/5b6d9f3a385ab56405f03956d7684aceb49d951f", "committedDate": "2020-03-30T10:09:53Z", "message": "handle ContentNotAvailableException"}, "afterCommit": {"oid": "c7497a4813cfdbfed1f512925e11fd5729dc3152", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c7497a4813cfdbfed1f512925e11fd5729dc3152", "committedDate": "2020-03-30T10:33:04Z", "message": "handle ContentNotAvailableException"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c7497a4813cfdbfed1f512925e11fd5729dc3152", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c7497a4813cfdbfed1f512925e11fd5729dc3152", "committedDate": "2020-03-30T10:33:04Z", "message": "handle ContentNotAvailableException"}, "afterCommit": {"oid": "9191f26e4865ef767d5c974859b548c9a41e005a", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/9191f26e4865ef767d5c974859b548c9a41e005a", "committedDate": "2020-03-30T10:34:19Z", "message": "handle ContentNotSupportedException"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9191f26e4865ef767d5c974859b548c9a41e005a", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/9191f26e4865ef767d5c974859b548c9a41e005a", "committedDate": "2020-03-30T10:34:19Z", "message": "handle ContentNotSupportedException"}, "afterCommit": {"oid": "ee41e1d28bb6accced853fe9f87f5557a92bbd8d", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ee41e1d28bb6accced853fe9f87f5557a92bbd8d", "committedDate": "2020-03-30T10:38:42Z", "message": "handle ContentNotSupportedException"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee41e1d28bb6accced853fe9f87f5557a92bbd8d", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ee41e1d28bb6accced853fe9f87f5557a92bbd8d", "committedDate": "2020-03-30T10:38:42Z", "message": "handle ContentNotSupportedException"}, "afterCommit": {"oid": "7c508ce568e3ed6c71075e3a3f5f673126d38d2e", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/7c508ce568e3ed6c71075e3a3f5f673126d38d2e", "committedDate": "2020-04-01T20:52:23Z", "message": "use 2 \\n instead of 1 for content not supported message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1OTQ1Mzg5", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-385945389", "createdAt": "2020-04-01T21:00:25Z", "commit": {"oid": "7c508ce568e3ed6c71075e3a3f5f673126d38d2e"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c508ce568e3ed6c71075e3a3f5f673126d38d2e", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/7c508ce568e3ed6c71075e3a3f5f673126d38d2e", "committedDate": "2020-04-01T20:52:23Z", "message": "use 2 \\n instead of 1 for content not supported message"}, "afterCommit": {"oid": "47aa4eae3b0f4d9ee19d3ad1ca3b0bc610a97ba4", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/47aa4eae3b0f4d9ee19d3ad1ca3b0bc610a97ba4", "committedDate": "2020-04-07T12:54:49Z", "message": "handle ContentNotSupportedException in ExtractorHelper.handleGeneralException()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTY4Nzg1", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-389968785", "createdAt": "2020-04-08T13:23:15Z", "commit": {"oid": "a91d197dcd11ab568a2d3da0aba7cbcdc67ac0da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMjAwNjUy", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-390200652", "createdAt": "2020-04-08T17:52:59Z", "commit": {"oid": "a91d197dcd11ab568a2d3da0aba7cbcdc67ac0da"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNTM5NDA2", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-390539406", "createdAt": "2020-04-09T07:07:57Z", "commit": {"oid": "7012fba665e7d749d8f069b2c953b6789535f27b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzowNzo1N1rOGDMLTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzowNzo1N1rOGDMLTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5ODQxNQ==", "bodyText": "Rename this function to showContentNotSupported.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#discussion_r405998415", "createdAt": "2020-04-09T07:07:57Z", "author": {"login": "wb9688"}, "path": "app/src/main/java/org/schabi/newpipe/fragments/list/channel/ChannelFragment.java", "diffHunk": "@@ -439,6 +468,13 @@ public void handleResult(@NonNull final ChannelInfo result) {\n                 .playOnBackgroundPlayer(activity, getPlayQueue(), false));\n     }\n \n+    private void updateNoVideoDisplay() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7012fba665e7d749d8f069b2c953b6789535f27b"}, "originalPosition": 90}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNTU2NjY5", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-390556669", "createdAt": "2020-04-09T07:37:47Z", "commit": {"oid": "7012fba665e7d749d8f069b2c953b6789535f27b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzozNzo0N1rOGDNDCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzozNzo0N1rOGDNDCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAxMjY4Mg==", "bodyText": "Can't you just use for (Throwable throwable : errors)? I.e.:\n        List<Throwable> errors = new ArrayList<>(result.getErrors());\n\n        // handling ContentNotSupportedException not to show the error but an appropriate string\n        // so that crashes won't be sent uselessly and the user will understand what happened\n        for (Throwable throwable : errors) {\n            if (throwable instanceof ContentNotSupportedException) {\n                showContentNotSupported();\n                errors.remove(throwable);\n            }\n        }\n\n        if (!errors.isEmpty()) {\n            showSnackBarError(result.getErrors(), UserAction.REQUESTED_CHANNEL,\n                    NewPipe.getNameOfService(result.getServiceId()), result.getUrl(), 0);\n        }", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#discussion_r406012682", "createdAt": "2020-04-09T07:37:47Z", "author": {"login": "wb9688"}, "path": "app/src/main/java/org/schabi/newpipe/fragments/list/channel/ChannelFragment.java", "diffHunk": "@@ -417,9 +431,24 @@ public void handleResult(@NonNull final ChannelInfo result) {\n \n         playlistCtrl.setVisibility(View.VISIBLE);\n \n-        if (!result.getErrors().isEmpty()) {\n-            showSnackBarError(result.getErrors(), UserAction.REQUESTED_CHANNEL,\n-                    NewPipe.getNameOfService(result.getServiceId()), result.getUrl(), 0);\n+        List<Throwable> errors = result.getErrors();\n+        if (!errors.isEmpty()) {\n+\n+            // handling ContentNotSupportedException not to show the error but an appropriate string\n+            // so that crashes won't be sent uselessly and the user will understand what happened\n+            Iterator<Throwable> it = errors.iterator();\n+            while (it.hasNext()) {\n+                Throwable throwable = it.next();\n+                if (throwable instanceof ContentNotSupportedException) {\n+                    updateNoVideoDisplay();\n+                    it.remove();\n+                }\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7012fba665e7d749d8f069b2c953b6789535f27b"}, "originalPosition": 77}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5eba4e31f8727130e66d7c86329149b739d96a88", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/5eba4e31f8727130e66d7c86329149b739d96a88", "committedDate": "2020-04-09T07:45:21Z", "message": "fix ContentNotSupportedError not showing if cached and rename function"}, "afterCommit": {"oid": "073119ce8ec9715873cd1e1bb3c3921bdda3b304", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/073119ce8ec9715873cd1e1bb3c3921bdda3b304", "committedDate": "2020-04-09T21:56:24Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc7a25d9ce8a4546e981d438e6b32125f3eac160", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/cc7a25d9ce8a4546e981d438e6b32125f3eac160", "committedDate": "2020-04-09T21:58:01Z", "message": "handle ContentNotSupportedException in BaseStateFragment\n\nthus not supported soundcloud streams (e.g. hls streams) don't crash\nanyore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c392804f47e9fe2ac0c3f86ac9726fe63ed51751", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/c392804f47e9fe2ac0c3f86ac9726fe63ed51751", "committedDate": "2020-04-09T21:58:01Z", "message": "handle ContentNotSupportedException in ExtractorHelper.handleGeneralException()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "073119ce8ec9715873cd1e1bb3c3921bdda3b304", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/073119ce8ec9715873cd1e1bb3c3921bdda3b304", "committedDate": "2020-04-09T21:56:24Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}, "afterCommit": {"oid": "769ebe20d9a263e6d668671047e9ed5d3bde019b", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/769ebe20d9a263e6d668671047e9ed5d3bde019b", "committedDate": "2020-04-09T21:58:02Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c128d837cbf778fcd5f1f7e1154e3f95da0aa4c", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/4c128d837cbf778fcd5f1f7e1154e3f95da0aa4c", "committedDate": "2020-04-10T07:12:29Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "769ebe20d9a263e6d668671047e9ed5d3bde019b", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/769ebe20d9a263e6d668671047e9ed5d3bde019b", "committedDate": "2020-04-09T21:58:02Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}, "afterCommit": {"oid": "4c128d837cbf778fcd5f1f7e1154e3f95da0aa4c", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/4c128d837cbf778fcd5f1f7e1154e3f95da0aa4c", "committedDate": "2020-04-10T07:12:29Z", "message": "handle ContentNotSupportedException for Channel Fragment (when an user has no video tab)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzMyMjcx", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3300#pullrequestreview-391332271", "createdAt": "2020-04-10T08:33:21Z", "commit": {"oid": "4c128d837cbf778fcd5f1f7e1154e3f95da0aa4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4132, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}