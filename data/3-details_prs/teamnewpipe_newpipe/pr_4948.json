{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1MTE0Njcx", "number": 4948, "title": "Fix crash on startup when there is no internet connection", "bodyText": "What is it?\n\n Bugfix (user facing)\n Feature (user facing)\n Codebase improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\nThe crash was caused by an Observable's Callable returning null when fetching the latest available app version without internet connection, but RxJava's Observables do not accept null results. So I used a Maybe instead, and removed a null check inside the subscriber since nullity is already taken care of by the Maybe. I also did some refactoring in the CheckForNewAppVersion file.\nA further crash was caused by the onError() interface not being implemented. That produced a crash instead of handling the connectivity error.\nFixes the following issue(s)\nFixes #4920\nAPK testing\napp-debug.zip\nDue diligence\n\n I read the contribution guidelines.", "createdAt": "2020-11-21T11:03:55Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4948", "merged": true, "mergeCommit": {"oid": "c88b4032ef6cd4e17fa63bfdacbf37b84b438cb4"}, "closed": true, "closedAt": "2020-11-22T13:00:37Z", "author": {"login": "Stypox"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdep30_gH2gAyNTI1MTE0NjcxOjhkYzRlNmRjMmFkNjkyZDRiYTU2Zjg4NTEzZjY1MmM1ZjExMGE0NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfAKpZgFqTUzNjA2MDAyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8dc4e6dc2ad692d4ba56f88513f652c5f110a454", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/8dc4e6dc2ad692d4ba56f88513f652c5f110a454", "committedDate": "2020-11-21T11:02:03Z", "message": "Fix crash on startup without internet: Cbservable callable returning null\n\nUse Maybe instead"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17866c29aea4b17771faf2d81671bd2de2d9bdca", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/17866c29aea4b17771faf2d81671bd2de2d9bdca", "committedDate": "2020-11-21T11:02:08Z", "message": "Refactor CheckForNewAppVersion"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d3c1652bd86fc5726e0b80e4acee2a8ae512bea9", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/d3c1652bd86fc5726e0b80e4acee2a8ae512bea9", "committedDate": "2020-11-21T10:45:38Z", "message": "Refactor CheckForNewAppVersion"}, "afterCommit": {"oid": "17866c29aea4b17771faf2d81671bd2de2d9bdca", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/17866c29aea4b17771faf2d81671bd2de2d9bdca", "committedDate": "2020-11-21T11:02:08Z", "message": "Refactor CheckForNewAppVersion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd4c37e9b38c1f75f6e91d6e9cc1137890223c6c", "author": {"user": {"login": "TobiGr", "name": "Tobi"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/fd4c37e9b38c1f75f6e91d6e9cc1137890223c6c", "committedDate": "2020-11-22T10:46:24Z", "message": "Fix crash on startup caused by no implementation of onError() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5e99be6fa382ef40ddec3529f7fcf86e0ca0c8", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6f5e99be6fa382ef40ddec3529f7fcf86e0ca0c8", "committedDate": "2020-11-22T12:27:51Z", "message": "Handle CheckForNewAppVersion exceptions in one place"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDU4OTY5", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4948#pullrequestreview-536058969", "createdAt": "2020-11-22T12:47:50Z", "commit": {"oid": "6f5e99be6fa382ef40ddec3529f7fcf86e0ca0c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQxMjo0Nzo1MFrOH32wgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQxMjo0Nzo1MFrOH32wgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMzMDg4MQ==", "bodyText": "i just thought about checking whether there was really a network problem by calling ExceptionUtils.isNetworkRelated(e)", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4948#discussion_r528330881", "createdAt": "2020-11-22T12:47:50Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/CheckForNewAppVersion.java", "diffHunk": "@@ -218,15 +208,14 @@ public static Disposable checkNewVersion(@NonNull final App app) {\n                             } catch (final JsonParserException e) {\n                                 // connectivity problems, do not alarm user and fail silently\n                                 if (DEBUG) {\n-                                    Log.w(TAG, Log.getStackTraceString(e));\n+                                    Log.w(TAG, \"Could not get NewPipe API: invalid json\", e);\n                                 }\n                             }\n                         },\n-                        throwable -> {\n+                        e -> {\n                             // connectivity problems, do not alarm user and fail silently\n                             if (DEBUG) {\n-                                Log.i(TAG, \"Could not get NewPipe API: network problem\");\n-                                Log.i(TAG, Log.getStackTraceString(throwable));\n+                                Log.w(TAG, \"Could not get NewPipe API: network problem\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f5e99be6fa382ef40ddec3529f7fcf86e0ca0c8"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDYwMDIw", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4948#pullrequestreview-536060020", "createdAt": "2020-11-22T13:00:31Z", "commit": {"oid": "6f5e99be6fa382ef40ddec3529f7fcf86e0ca0c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4078, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}