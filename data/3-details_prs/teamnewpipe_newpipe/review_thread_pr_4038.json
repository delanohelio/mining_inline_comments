{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwOTQyNTA1", "number": 4038, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMDo1Nzo1NFrOEUR7_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNVQxMzozNDo0MlrOEYs9pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NzAwODYxOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMDo1Nzo1NFrOG6dTUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMDo1Nzo1NFrOG6dTUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk1MDY3NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String defaultMedia = prefs.getString(getString(R.string.last_used_download_type),\n          \n          \n            \n                    final String defaultMedia = prefs.getString(getString(R.string.last_used_download_type),", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4038#discussion_r463950675", "createdAt": "2020-08-01T10:57:54Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "diffHunk": "@@ -515,7 +515,22 @@ protected void setupDownloadOptions() {\n         videoButton.setVisibility(isVideoStreamsAvailable ? View.VISIBLE : View.GONE);\n         subtitleButton.setVisibility(isSubtitleStreamsAvailable ? View.VISIBLE : View.GONE);\n \n-        if (isVideoStreamsAvailable) {\n+        prefs = PreferenceManager.getDefaultSharedPreferences(getContext());\n+        String defaultMedia = prefs.getString(getString(R.string.last_used_download_type),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f82955d5c8356b79bae20c0bb2050be4a63f6d4a"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NzAxMjY1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMTowMzo0N1rOG6dVHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMTowMzo0N1rOG6dVHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk1MTEzMw==", "bodyText": "(defaultMedia.equals(getString(R.string.video)) this will fail to detect the last used type when the user changed tha pplication language. Please create three keys in settings_keys.xml to avoid that.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4038#discussion_r463951133", "createdAt": "2020-08-01T11:03:47Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "diffHunk": "@@ -515,7 +515,22 @@ protected void setupDownloadOptions() {\n         videoButton.setVisibility(isVideoStreamsAvailable ? View.VISIBLE : View.GONE);\n         subtitleButton.setVisibility(isSubtitleStreamsAvailable ? View.VISIBLE : View.GONE);\n \n-        if (isVideoStreamsAvailable) {\n+        prefs = PreferenceManager.getDefaultSharedPreferences(getContext());\n+        String defaultMedia = prefs.getString(getString(R.string.last_used_download_type),\n+                    getString(R.string.video));\n+\n+        assert defaultMedia != null;\n+        if (isVideoStreamsAvailable && (defaultMedia.equals(getString(R.string.video)))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f82955d5c8356b79bae20c0bb2050be4a63f6d4a"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NzAyMjg3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMToxOTowOFrOG6dZ7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQxMToxOTowOFrOG6dZ7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk1MjM2NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    SharedPreferences.Editor editor = prefs.edit();\n          \n          \n            \n                    final SharedPreferences.Editor editor = prefs.edit();", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4038#discussion_r463952364", "createdAt": "2020-08-01T11:19:08Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "diffHunk": "@@ -663,6 +682,11 @@ private void prepareSelectedDownload() {\n \n         // check for existing file with the same name\n         checkSelectedDownload(mainStorage, mainStorage.findFile(filename), filename, mime);\n+\n+        // remember the last media type downloaded by the user\n+        SharedPreferences.Editor editor = prefs.edit();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f82955d5c8356b79bae20c0bb2050be4a63f6d4a"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0MzM3OTU3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNVQxMzozNDo0MlrOHBKf2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNVQxMzozNDo0MlrOHBKf2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk4MjYxOQ==", "bodyText": "According to the docs, getString(resInt) cannot be null, thus defaultMedia cannot be null (as long as we don't put anything stupid into the preferences, which we clearly do not). I think, the assertion can be removed.", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4038#discussion_r470982619", "createdAt": "2020-08-15T13:34:42Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/download/DownloadDialog.java", "diffHunk": "@@ -515,7 +515,24 @@ protected void setupDownloadOptions() {\n         videoButton.setVisibility(isVideoStreamsAvailable ? View.VISIBLE : View.GONE);\n         subtitleButton.setVisibility(isSubtitleStreamsAvailable ? View.VISIBLE : View.GONE);\n \n-        if (isVideoStreamsAvailable) {\n+        prefs = PreferenceManager.getDefaultSharedPreferences(getContext());\n+        final String defaultMedia = prefs.getString(getString(R.string.last_used_download_type),\n+                    getString(R.string.last_download_type_video_key));\n+\n+        assert defaultMedia != null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f40bd6ae58c9d8732f8ba2f3c842a2a8b3264bf"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3042, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}