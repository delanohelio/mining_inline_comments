{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUyMzMxOTk1", "number": 3909, "title": "Deprecations and cleanup", "bodyText": "What is it?\n\n Bug fix (user facing)\n Feature (user facing)\n Code base improvement (dev facing)\n Meta improvement to the project (dev facing)\n\nDescription of the changes in your PR\n\n\nFixes a bunch of deprecations\nA little bit of code cleanup\n\nFixes the following issue(s)\n\n\nFixes some deprecations in code\n\nTesting apk\n\nnewpipe-deprecationsandcleanup.zip\nAgreement\n\n I carefully read the contribution guidelines and agree to them.", "createdAt": "2020-07-19T04:38:34Z", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909", "merged": true, "mergeCommit": {"oid": "14486782dcfb3ac99965b995c1e45c6368c05ce5"}, "closed": true, "closedAt": "2020-09-07T18:51:24Z", "author": {"login": "TacoTheDank"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDAW_NgFqTQ3NjcxNDM4Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGnGWigFqTQ4MzY4MjU5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzE0Mzg2", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#pullrequestreview-476714386", "createdAt": "2020-08-27T13:22:22Z", "commit": {"oid": "0e8964227bcf437e2d701f41ff0b575c5f4cb678"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzoyMjoyMlrOHIQH2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzoyMjo0NlrOHIQI1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDgxMA==", "bodyText": "No need for the double (( and ))", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478414810", "createdAt": "2020-08-27T13:22:22Z", "author": {"login": "wb9688"}, "path": "app/src/main/java/org/schabi/newpipe/util/TLSSocketFactoryCompat.java", "diffHunk": "@@ -106,7 +106,7 @@ public Socket createSocket(final InetAddress address, final int port,\n     }\n \n     private Socket enableTLSOnSocket(final Socket socket) {\n-        if (socket != null && (socket instanceof SSLSocket)) {\n+        if ((socket instanceof SSLSocket)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e8964227bcf437e2d701f41ff0b575c5f4cb678"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDk5Mw==", "bodyText": "Why was this changed?", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478414993", "createdAt": "2020-08-27T13:22:40Z", "author": {"login": "wb9688"}, "path": "app/src/main/java/org/schabi/newpipe/RouterActivity.java", "diffHunk": "@@ -572,7 +568,7 @@ private String trim(final String input) {\n                 }\n             }\n         }\n-        return result.toArray(new String[result.size()]);\n+        return result.toArray(new String[0]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e8964227bcf437e2d701f41ff0b575c5f4cb678"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNTA2MQ==", "bodyText": "Why was this changed?", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478415061", "createdAt": "2020-08-27T13:22:46Z", "author": {"login": "wb9688"}, "path": "app/src/main/java/org/schabi/newpipe/player/resolver/VideoPlaybackResolver.java", "diffHunk": "@@ -115,7 +115,7 @@ public MediaSource resolve(@NonNull final StreamInfo info) {\n             return mediaSources.get(0);\n         } else {\n             return new MergingMediaSource(mediaSources.toArray(\n-                    new MediaSource[mediaSources.size()]));\n+                    new MediaSource[0]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e8964227bcf437e2d701f41ff0b575c5f4cb678"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDA2NTI4", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#pullrequestreview-482006528", "createdAt": "2020-09-03T16:23:26Z", "commit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDE0ODgy", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#pullrequestreview-482014882", "createdAt": "2020-09-03T16:33:59Z", "commit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "state": "COMMENTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNjozMzo1OVrOHMuuhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNjo0Nzo0MFrOHMvPTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDUzMg==", "bodyText": "Heads up @friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110532", "createdAt": "2020-09-03T16:33:59Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/MainPlayer.java", "diffHunk": "@@ -307,9 +307,7 @@ void resetNotification() {\n             setLockScreenThumbnail(builder);\n         }\n \n-        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN) {\n-            builder.setPriority(NotificationCompat.PRIORITY_MAX);\n-        }\n+        builder.setPriority(NotificationCompat.PRIORITY_MAX);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDgyMg==", "bodyText": "Heads up @friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110822", "createdAt": "2020-09-03T16:34:27Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/helper/PlayerHelper.java", "diffHunk": "@@ -303,10 +302,6 @@ public static int getTossFlingVelocity(@NonNull final Context context) {\n \n     @NonNull\n     public static CaptionStyleCompat getCaptionStyle(@NonNull final Context context) {\n-        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.KITKAT) {\n-            return CaptionStyleCompat.DEFAULT;\n-        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDk3NA==", "bodyText": "Heads up @friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110974", "createdAt": "2020-09-03T16:34:41Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/helper/PlayerHelper.java", "diffHunk": "@@ -331,10 +326,6 @@ public static CaptionStyleCompat getCaptionStyle(@NonNull final Context context)\n      * @return caption scaling\n      */\n     public static float getCaptionScale(@NonNull final Context context) {\n-        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.KITKAT) {\n-            return 1f;\n-        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMTMxMg==", "bodyText": "@friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483111312", "createdAt": "2020-09-03T16:35:13Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/util/PermissionHelper.java", "diffHunk": "@@ -26,10 +26,8 @@\n     private PermissionHelper() { }\n \n     public static boolean checkStoragePermissions(final Activity activity, final int requestCode) {\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            if (!checkReadStoragePermissions(activity, requestCode)) {\n-                return false;\n-            }\n+        if (!checkReadStoragePermissions(activity, requestCode)) {\n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMTcxNQ==", "bodyText": "Heads up @friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483111715", "createdAt": "2020-09-03T16:35:49Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -1105,7 +1105,7 @@ private void openBackgroundPlayer(final boolean append) {\n             player.toggleFullscreen();\n         }\n \n-        if (!useExternalAudioPlayer && android.os.Build.VERSION.SDK_INT >= 16) {\n+        if (!useExternalAudioPlayer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNjU2NA==", "bodyText": "@friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483116564", "createdAt": "2020-09-03T16:43:36Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -1302,16 +1302,9 @@ private void prepareDescription(final Description description) {\n \n         if (description.getType() == Description.HTML) {\n             disposables.add(Single.just(description.getContent())\n-                    .map((@NonNull String descriptionText) -> {\n-                        final Spanned parsedDescription;\n-                        if (Build.VERSION.SDK_INT >= 24) {\n-                            parsedDescription = Html.fromHtml(descriptionText, 0);\n-                        } else {\n-                            //noinspection deprecation\n-                            parsedDescription = Html.fromHtml(descriptionText);\n-                        }\n-                        return parsedDescription;\n-                    })\n+                    .map((@NonNull String descriptionText) ->\n+                            HtmlCompat.fromHtml(descriptionText,\n+                                    HtmlCompat.FROM_HTML_MODE_LEGACY))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzU2MA==", "bodyText": "@friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117560", "createdAt": "2020-09-03T16:45:11Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -476,11 +474,8 @@ public void onPlaying() {\n         showAndAnimateControl(-1, true);\n \n         playbackSeekBar.setEnabled(true);\n-        // Bug on lower api, disabling and enabling the seekBar resets the thumb color -.-,\n-        // so sets the color again\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzcyMA==", "bodyText": "@friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117720", "createdAt": "2020-09-03T16:45:26Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -456,11 +457,8 @@ public void onBlocked() {\n         animateView(controlsRoot, false, DEFAULT_CONTROLS_DURATION);\n \n         playbackSeekBar.setEnabled(false);\n-        // Bug on lower api, disabling and enabling the seekBar resets the thumb color -.-,\n-        // so sets the color again\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzkxMQ==", "bodyText": "@friendlyanon", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117911", "createdAt": "2020-09-03T16:45:47Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -210,18 +211,18 @@ public void initViews(final View view) {\n \n         this.captionTextView = view.findViewById(R.id.captionTextView);\n \n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n-        this.playbackSeekBar.getProgressDrawable().\n-                setColorFilter(Color.RED, PorterDuff.Mode.MULTIPLY);\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExODkyNw==", "bodyText": "@friendlyanon StandardCharsets was added with API 19", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483118927", "createdAt": "2020-09-03T16:47:40Z", "author": {"login": "TobiGr"}, "path": "app/src/main/java/org/schabi/newpipe/streams/Mp4DashReader.java", "diffHunk": "@@ -259,11 +259,7 @@ private String boxName(final Box ref) {\n     }\n \n     private String boxName(final int type) {\n-        try {\n-            return new String(ByteBuffer.allocate(4).putInt(type).array(), \"UTF-8\");\n-        } catch (final UnsupportedEncodingException e) {\n-            return \"0x\" + Integer.toHexString(type);\n-        }\n+        return new String(ByteBuffer.allocate(4).putInt(type).array(), StandardCharsets.UTF_8);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79e2bb382f83b8fe53c261cf482735ae0df30b7b", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/79e2bb382f83b8fe53c261cf482735ae0df30b7b", "committedDate": "2020-09-06T10:48:35Z", "message": "Update ExoPlayer, OkHttp, use Kotlin JDK8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba6c7de35a87c92f65a3b5d9f0f65d3c0aaa22c7", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/ba6c7de35a87c92f65a3b5d9f0f65d3c0aaa22c7", "committedDate": "2020-09-06T10:52:42Z", "message": "Use AndroidX preference"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4feb3fc09b734d4365bc498ed0289c7dc3558cf", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/a4feb3fc09b734d4365bc498ed0289c7dc3558cf", "committedDate": "2020-09-06T10:52:43Z", "message": "Fix some deprecations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cb16be5dfad60d0d5333d6b789affdd524a73af", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6cb16be5dfad60d0d5333d6b789affdd524a73af", "committedDate": "2020-09-06T10:52:43Z", "message": "Use enhanced 'for' loops"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "273c287fbf7c6306ab6f3b4ec15be7dbf63b6bbd", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/273c287fbf7c6306ab6f3b4ec15be7dbf63b6bbd", "committedDate": "2020-09-06T10:52:43Z", "message": "Fix some lambdas"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f86b40302d35915ed9d058de6d37a2ba291117da", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/f86b40302d35915ed9d058de6d37a2ba291117da", "committedDate": "2020-09-06T10:55:26Z", "message": "Some general-purpose lint cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c5ef567edecbc084aa6919fdeea21b757ed1b3a", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/6c5ef567edecbc084aa6919fdeea21b757ed1b3a", "committedDate": "2020-09-06T10:55:30Z", "message": "Replace deprecated Html#fromHtml with HtmlCompat#fromHtml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06d54ef77ea33117237cd89aa5fc10fc4d2a0e23", "author": {"user": {"login": "TacoTheDank", "name": "Taco"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/06d54ef77ea33117237cd89aa5fc10fc4d2a0e23", "committedDate": "2020-09-06T10:55:30Z", "message": "Clean up SDK version checks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b631e0387140a396ce2d1f465a0d04366b004bf", "author": {"user": {"login": "Stypox", "name": "Stypox"}}, "url": "https://github.com/TeamNewPipe/NewPipe/commit/5b631e0387140a396ce2d1f465a0d04366b004bf", "committedDate": "2020-09-06T12:02:25Z", "message": "Revert to deprecated BEHAVIOR_SET_USER_VISIBLE_HINT in TabAdapter\n\nAlso added comment explaining why"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMTM3NjUy", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#pullrequestreview-483137652", "createdAt": "2020-09-06T12:07:50Z", "commit": {"oid": "5b631e0387140a396ce2d1f465a0d04366b004bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNjgyNTk0", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#pullrequestreview-483682594", "createdAt": "2020-09-07T18:14:01Z", "commit": {"oid": "5b631e0387140a396ce2d1f465a0d04366b004bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4098, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}