{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MjgyNTcz", "number": 5627, "title": "fix(TUP-29693): Fix migrating jarname to maven uri if jar name contai\u2026", "bodyText": "\u2026ns context\nWhat is the current behavior? (You can also link to an open issue here)\nhttps://jira.talendforge.org/browse/TUP-29693\nWhat is the new behavior?\n1 - If jarname contains context, then migrate the value as it is, otherwise replace value with maven uri.\n2 - If wrong maven uri was set because of R2020-11 patch, then reset the maven uri back to context.\nPlease check if the PR fulfills these requirements\n\n The commit message follows Talend standard\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features) ?\n The code coverage on new code >75%\n The new code does not introduce new technical issues (sonar / eslint)\n\nWhat kind of change does this PR introduce?\n\n Bugfix\n Feature\n Code style update (formatting, local variables)\n Refactoring (no functional changes, no api changes)\n Build / CI related changes\n Other... Please describe:\n\nDoes this PR introduce a breaking change?\n\n Yes\n No\n\nIf this PR contains a breaking change, please describe the impact and migration path for existing applications: ...\nOther information:", "createdAt": "2020-12-14T09:05:18Z", "url": "https://github.com/Talend/tdi-studio-se/pull/5627", "merged": true, "mergeCommit": {"oid": "e80c5726e10610438784c26c69a335a3cd6e58f7"}, "closed": true, "closedAt": "2020-12-14T12:54:55Z", "author": {"login": "bhe-talendbj"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmB8cagH2gAyNTM5MjgyNTczOmVlMDU2ZGY1YWE3Y2ZhMDFlNmI5ZDI4ZjVjNjdiMDcxY2U2MWRhNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmFRQiAFqTU1MTMzNzMyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ee056df5aa7cfa01e6b9d28f5c67b071ce61da5a", "author": {"user": {"login": "bhe-talendbj", "name": null}}, "url": "https://github.com/Talend/tdi-studio-se/commit/ee056df5aa7cfa01e6b9d28f5c67b071ce61da5a", "committedDate": "2020-12-14T09:02:17Z", "message": "fix(TUP-29693): Fix migrating jarname to maven uri if jar name contains context"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMjYwNzE2", "url": "https://github.com/Talend/tdi-studio-se/pull/5627#pullrequestreview-551260716", "createdAt": "2020-12-14T11:02:10Z", "commit": {"oid": "ee056df5aa7cfa01e6b9d28f5c67b071ce61da5a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMTowMjoxMFrOIFLKwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMTowMjoxMFrOIFLKwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjI5Njc3MA==", "bodyText": "why need execute migrateProjectSettings in the loop ?\nIt will try to check the project migration many times . It should be a one time check migration.", "url": "https://github.com/Talend/tdi-studio-se/pull/5627#discussion_r542296770", "createdAt": "2020-12-14T11:02:10Z", "author": {"login": "wchen-talend"}, "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/utils/UpdateModuleListInComponentsMigrationTask.java", "diffHunk": "@@ -69,6 +80,73 @@\n         return toReturn;\r\n     }\r\n \r\n+    @Override\r\n+    public ExecutionResult execute(Project project) {\r\n+        setProject(project);\r\n+        IRepositoryService service = (IRepositoryService) GlobalServiceRegister.getDefault().getService(IRepositoryService.class);\r\n+        IProxyRepositoryFactory factory = service.getProxyRepositoryFactory();\r\n+        ExecutionResult executeFinal = null;\r\n+        List<IRepositoryViewObject> list = new ArrayList<IRepositoryViewObject>();\r\n+\r\n+        try {\r\n+            for (ERepositoryObjectType curTyp : getAllTypes()) {\r\n+                if (curTyp != null && curTyp.isResourceItem()) {\r\n+                    /* specific project so that on svn model it will migrate all ref projects,bug 17295 */\r\n+                    list.addAll(factory.getAll(project, curTyp, true, true));\r\n+                }\r\n+            }\r\n+\r\n+            if (list.isEmpty()) {\r\n+                return ExecutionResult.NOTHING_TO_DO;\r\n+            }\r\n+\r\n+            for (IRepositoryViewObject object : list) {\r\n+                ExecutionResult execute = null;\r\n+                // in case the resource has been modified (see MergeTosMetadataMigrationTask for example)\r\n+                if ((object.getProperty().eResource() == null || object.getProperty().getItem().eResource() == null)\r\n+                        && (object instanceof RepositoryObject)) {\r\n+                    Property updatedProperty = factory.reload(object.getProperty());\r\n+                    ((RepositoryObject) object).setProperty(updatedProperty);\r\n+                }\r\n+\r\n+                execute = this.migrateProjectSettings(project);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee056df5aa7cfa01e6b9d28f5c67b071ce61da5a"}, "originalPosition": 77}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "907e72821cd4e686d0c096f54b23a7e1de5a2c09", "author": {"user": {"login": "bhe-talendbj", "name": null}}, "url": "https://github.com/Talend/tdi-studio-se/commit/907e72821cd4e686d0c096f54b23a7e1de5a2c09", "committedDate": "2020-12-14T12:35:00Z", "message": "fix(TUP-29693): Kepp main logic unchanged"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMzM3MzI1", "url": "https://github.com/Talend/tdi-studio-se/pull/5627#pullrequestreview-551337325", "createdAt": "2020-12-14T12:54:44Z", "commit": {"oid": "907e72821cd4e686d0c096f54b23a7e1de5a2c09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4702, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}