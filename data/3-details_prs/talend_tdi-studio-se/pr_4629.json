{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MDg0NjQ4", "number": 4629, "title": "Fix(TDI-30505): Do not log if no autocommit.", "bodyText": "What is the current behavior? (You can also link to an open issue here)\nWhat is the new behavior?\nPlease check if the PR fulfills these requirements\n\n The commit message follows Talend standard\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features) ?\n The code coverage on new code >75%\n The new code does not introduce new technical issues (sonar / eslint)\n\nWhat kind of change does this PR introduce?\n\n Bugfix\n Feature\n Code style update (formatting, local variables)\n Refactoring (no functional changes, no api changes)\n Build / CI related changes\n Other... Please describe:\n\nDoes this PR introduce a breaking change?\n\n Yes\n No\n\nIf this PR contains a breaking change, please describe the impact and migration path for existing applications: ...\nOther information:", "createdAt": "2020-04-20T14:03:49Z", "url": "https://github.com/Talend/tdi-studio-se/pull/4629", "merged": true, "mergeCommit": {"oid": "c5493904687cf6c1bd106f45118911955fcb9cdd"}, "closed": true, "closedAt": "2020-05-27T08:21:23Z", "author": {"login": "dmytrogrygorenko"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZxBoRgFqTM5NzE5MzUwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclUyGLAFqTQxODk1NzA5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MTkzNTAy", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-397193502", "createdAt": "2020-04-21T10:21:19Z", "commit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyMToxOVrOGI-OeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyMToxOVrOGI-OeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2MTMwNQ==", "bodyText": "IMO it is good idea to put break here", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r412061305", "createdAt": "2020-04-21T10:21:19Z", "author": {"login": "dmytro-sylaiev"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/tDB2Output/tDB2Output_end.javajet", "diffHunk": "@@ -30,6 +34,16 @@ imports=\"\n         IConnection rejectConn = rejectConns.get(0);\n         rejectConnName = rejectConn.getName();\n     }\n+\t\n+    String connection = ElementParameterParser.getValue(node,\"__CONNECTION__\");\n+    if(useExistingConn) {\n+        List<? extends INode> nodes = process.getNodesOfType(\"tDB2Connection\");\n+        for (INode ne:nodes) {\n+            if (connection.equals(ne.getUniqueName())) {\n+                setAutoCommit = \"true\".equals(ElementParameterParser.getValue(ne, \"__AUTO_COMMIT__\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MTkzODAw", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-397193800", "createdAt": "2020-04-21T10:21:44Z", "commit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyMTo0NFrOGI-Pdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyMzo0MVrOGI-Uig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2MTU1OA==", "bodyText": "indentation is broken", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r412061558", "createdAt": "2020-04-21T10:21:44Z", "author": {"login": "dmytro-sylaiev"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/tEXAOutput/tEXAOutput_end.javajet", "diffHunk": "@@ -5,6 +5,7 @@ imports=\"\n     org.talend.core.model.process.INode\n     org.talend.core.model.process.ElementParameterParser\n     org.talend.core.model.process.IConnection\n+\torg.talend.core.model.process.IProcess", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2MjYzMA==", "bodyText": "Maybe need to remove extra %><% here", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r412062630", "createdAt": "2020-04-21T10:23:18Z", "author": {"login": "dmytro-sylaiev"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/templates/DB/Output/DBOutputEndGlobalVars.javajet", "diffHunk": "@@ -47,21 +47,30 @@ imports=\"\n         globalMap.put(\"<%=cid %>_NB_LINE_DELETED\",nb_line_deleted_<%=cid%>);\n         globalMap.put(\"<%=cid %>_NB_LINE_REJECTED\", nb_line_rejected_<%=cid%>);\n     \n+    <%\n+    }\n+    %>\n+\n+\t<%\n+\tif(!useExistingConnection || (useExistingConnection && setAutoCommit)){\n+\t\t%>\n+\t\t<%", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2Mjc3MQ==", "bodyText": "and here also", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r412062771", "createdAt": "2020-04-21T10:23:31Z", "author": {"login": "dmytro-sylaiev"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/templates/DB/Output/DBOutputEndGlobalVars.javajet", "diffHunk": "@@ -47,21 +47,30 @@ imports=\"\n         globalMap.put(\"<%=cid %>_NB_LINE_DELETED\",nb_line_deleted_<%=cid%>);\n         globalMap.put(\"<%=cid %>_NB_LINE_REJECTED\", nb_line_rejected_<%=cid%>);\n     \n+    <%\n+    }\n+    %>\n+\n+\t<%\n+\tif(!useExistingConnection || (useExistingConnection && setAutoCommit)){\n+\t\t%>\n+\t\t<%\n+\t\tif ((\"INSERT\").equals(dataAction)) {\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t}else if ((\"UPDATE\").equals(dataAction)) {\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t}else if ((\"DELETE\").equals(dataAction)) {\n+\t\t\tdbLog.state().logDeletedLines(dbLog.var(\"nb_line_deleted\"));\n+\t\t}else if(\"UPDATE_OR_INSERT\".equals(dataAction)){\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t}else if(\"INSERT_OR_UPDATE\".equals(dataAction)){\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t}%>\n+\t<%", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2Mjg1OA==", "bodyText": "and here", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r412062858", "createdAt": "2020-04-21T10:23:41Z", "author": {"login": "dmytro-sylaiev"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/templates/DB/Output/DBOutputEndGlobalVars.javajet", "diffHunk": "@@ -47,21 +47,30 @@ imports=\"\n         globalMap.put(\"<%=cid %>_NB_LINE_DELETED\",nb_line_deleted_<%=cid%>);\n         globalMap.put(\"<%=cid %>_NB_LINE_REJECTED\", nb_line_rejected_<%=cid%>);\n     \n+    <%\n+    }\n+    %>\n+\n+\t<%\n+\tif(!useExistingConnection || (useExistingConnection && setAutoCommit)){\n+\t\t%>\n+\t\t<%\n+\t\tif ((\"INSERT\").equals(dataAction)) {\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t}else if ((\"UPDATE\").equals(dataAction)) {\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t}else if ((\"DELETE\").equals(dataAction)) {\n+\t\t\tdbLog.state().logDeletedLines(dbLog.var(\"nb_line_deleted\"));\n+\t\t}else if(\"UPDATE_OR_INSERT\".equals(dataAction)){\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t}else if(\"INSERT_OR_UPDATE\".equals(dataAction)){\n+\t\t\tdbLog.state().logInsertedLines(dbLog.var(\"nb_line_inserted\"));\n+\t\t\tdbLog.state().logUpdatedLines(dbLog.var(\"nb_line_update\"));\n+\t\t}%>\n+\t<%\n+\t}%>\n \t<%", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ae467c51c2e049b79de8b8c580d6e5613239d5"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MjkwMDQ1", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-397290045", "createdAt": "2020-04-21T12:42:32Z", "commit": {"oid": "2c502237f79d8dc94846a57d38792d9bf5c54a2f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b4ff6f0eb4249436aca73e2beadb8b8dba48227", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/1b4ff6f0eb4249436aca73e2beadb8b8dba48227", "committedDate": "2020-04-27T08:38:32Z", "message": "Fix(TDI-30505): Typo fixed."}, "afterCommit": {"oid": "3314cbb73fa2dd3818416a0a0e829534ce96abcb", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/3314cbb73fa2dd3818416a0a0e829534ce96abcb", "committedDate": "2020-04-27T08:49:23Z", "message": "Fix(TDI-30505): Typo fixed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNjgxNDI3", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-401681427", "createdAt": "2020-04-28T09:58:25Z", "commit": {"oid": "7eec8e684f24bbb86375957d0bd1a1f9f1f2f941"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7eec8e684f24bbb86375957d0bd1a1f9f1f2f941", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/7eec8e684f24bbb86375957d0bd1a1f9f1f2f941", "committedDate": "2020-04-27T15:03:59Z", "message": "Fix(TDI-30505): Some more corrections"}, "afterCommit": {"oid": "e6c62ea082cecf78a9cb7869242d819f0609e425", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/e6c62ea082cecf78a9cb7869242d819f0609e425", "committedDate": "2020-05-05T05:02:45Z", "message": "Fix(TDI-30505): Some more corrections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1ODM4NjEy", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-415838612", "createdAt": "2020-05-21T02:29:24Z", "commit": {"oid": "e6c62ea082cecf78a9cb7869242d819f0609e425"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1ODY3OTE1", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-415867915", "createdAt": "2020-05-21T04:17:29Z", "commit": {"oid": "e6c62ea082cecf78a9cb7869242d819f0609e425"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNDoxNzoyOVrOGYlqtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNDoxNzoyOVrOGYlqtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQzNjE1MA==", "bodyText": "LGTM, some other about the jira:\nif we remove the log for commit, it will never appear if not auto commit, yes, is expected, but some customer may don't like it.", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#discussion_r428436150", "createdAt": "2020-05-21T04:17:29Z", "author": {"login": "wwang-talend"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/templates/DB/Output/DBOutputEndGlobalVars.javajet", "diffHunk": "@@ -47,20 +47,25 @@ imports=\"\n         globalMap.put(\"<%=cid %>_NB_LINE_DELETED\",nb_line_deleted_<%=cid%>);\n         globalMap.put(\"<%=cid %>_NB_LINE_REJECTED\", nb_line_rejected_<%=cid%>);\n     \n+    <%\n+    }\n+    %>\n+\n \t<%\n-\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6c62ea082cecf78a9cb7869242d819f0609e425"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "137ef2b282d21e509a9de6a229cd87266acf01a8", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/137ef2b282d21e509a9de6a229cd87266acf01a8", "committedDate": "2020-05-21T15:43:52Z", "message": "Fix(TDI-30505): Do not log if no autocommit."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7f43419c3cf079dc9732b14579d385a1f634917", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/f7f43419c3cf079dc9732b14579d385a1f634917", "committedDate": "2020-05-21T15:43:53Z", "message": "Fix(TDI-30505): Change by request of code reviewer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "369955dd008c0333b9d379b4f9092bb1c5737528", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/369955dd008c0333b9d379b4f9092bb1c5737528", "committedDate": "2020-05-21T15:43:53Z", "message": "Fix(TDI-30505): Missed comps added, var name fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03efa9c79d1a7f4eef3aebafc9f1518159ab5446", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/03efa9c79d1a7f4eef3aebafc9f1518159ab5446", "committedDate": "2020-05-21T15:43:54Z", "message": "Fix(TDI-30505): Typo fixed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c71e7a7f49a3ca21e4104a7c4d17a587a9c98749", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/c71e7a7f49a3ca21e4104a7c4d17a587a9c98749", "committedDate": "2020-05-21T15:43:54Z", "message": "Fix(TDI-30505): Some more corrections"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6c62ea082cecf78a9cb7869242d819f0609e425", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/e6c62ea082cecf78a9cb7869242d819f0609e425", "committedDate": "2020-05-05T05:02:45Z", "message": "Fix(TDI-30505): Some more corrections"}, "afterCommit": {"oid": "c71e7a7f49a3ca21e4104a7c4d17a587a9c98749", "author": {"user": {"login": "dmytrogrygorenko", "name": "Dmytro Grygorenko"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/c71e7a7f49a3ca21e4104a7c4d17a587a9c98749", "committedDate": "2020-05-21T15:43:54Z", "message": "Fix(TDI-30505): Some more corrections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4OTU3MDky", "url": "https://github.com/Talend/tdi-studio-se/pull/4629#pullrequestreview-418957092", "createdAt": "2020-05-27T08:14:06Z", "commit": {"oid": "c71e7a7f49a3ca21e4104a7c4d17a587a9c98749"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4607, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}