{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNzU2ODU2", "number": 4725, "title": "Wwang talend/tdi 44172", "bodyText": "What is the current behavior? (You can also link to an open issue here)\nWhat is the new behavior?\nPlease check if the PR fulfills these requirements\n\n The commit message follows Talend standard\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features) ?\n The code coverage on new code >75%\n The new code does not introduce new technical issues (sonar / eslint)\n\nWhat kind of change does this PR introduce?\n\n Bugfix\n Feature\n Code style update (formatting, local variables)\n Refactoring (no functional changes, no api changes)\n Build / CI related changes\n Other... Please describe:\n\nDoes this PR introduce a breaking change?\n\n Yes\n No\n\nIf this PR contains a breaking change, please describe the impact and migration path for existing applications: ...\nOther information:", "createdAt": "2020-05-22T07:13:57Z", "url": "https://github.com/Talend/tdi-studio-se/pull/4725", "merged": true, "mergeCommit": {"oid": "86bf10380f70763eaa9b23c102e694c84aec280a"}, "closed": true, "closedAt": "2020-06-10T08:29:52Z", "author": {"login": "wwang-talend"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgF4r5AH2gAyNDIxNzU2ODU2OjIzYjhkYjE3ZDNlNjIwN2U2OGJjN2MzN2U3MGI2YmIwM2JmMTdkM2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpwPWNgFqTQyNzY2OTA1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "23b8db17d3e6207e68bc7c37e70b6bb03bf17d3a", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/23b8db17d3e6207e68bc7c37e70b6bb03bf17d3a", "committedDate": "2020-05-11T02:03:06Z", "message": "fix(TDI-44171): Observability: Add \"Component\" label to\ncomponent-related events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "267695182ad036837109f1fb5812b9c16b99cbcb", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/267695182ad036837109f1fb5812b9c16b99cbcb", "committedDate": "2020-05-12T07:15:17Z", "message": "fix(TDI-44172): Observability: Create new \"component execution\" event\nand emit it frequently"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9ec4d8fbf5d55b0fa716ebf42b60ec62d3db95b", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/f9ec4d8fbf5d55b0fa716ebf42b60ec62d3db95b", "committedDate": "2020-05-12T07:30:25Z", "message": "fix(TDI-44172): correct name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78ae0eaf9360c946f62e2bfdecb9c61937ac5cac", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/78ae0eaf9360c946f62e2bfdecb9c61937ac5cac", "committedDate": "2020-05-13T02:51:04Z", "message": "fix(TDI-44172): fix some issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/2c27cad17d2808054c81a2856a7075cc404c27b3", "committedDate": "2020-05-26T02:24:35Z", "message": "Merge remote-tracking branch 'origin/master' into wwang-talend/TDI-44172"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4ODIwNzkx", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#pullrequestreview-418820791", "createdAt": "2020-05-27T02:45:56Z", "commit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzAxMDgz", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#pullrequestreview-421701083", "createdAt": "2020-06-01T09:13:08Z", "commit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOToxMzowOFrOGdD69Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOToxODo0OVrOGdEEnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzEyNjEzMw==", "bodyText": "Could you rename the context key \"sourceConnectorName\" to \"sourceConnectorType\" to keep the same vocabulary as for \"connectorType\" please? \ud83d\ude42", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#discussion_r433126133", "createdAt": "2020-06-01T09:13:08Z", "author": {"login": "elogeart"}, "path": "main/plugins/org.talend.designer.components.libs/libs_src/talend-job-monitoring/src/main/java/org/talend/job/audit/JobContextBuilder.java", "diffHunk": "@@ -86,5 +96,59 @@ public JobContextBuilder status(String status) {\n     public Context build() {\n         return builder.build();\n     }\n-\n+    \n+    /**\n+     * source connector id\n+     * @return\n+     */\n+    public JobContextBuilder sourceId(String sourceId) {\n+        builder.with(\"sourceId\", sourceId);\n+        return this;\n+    }\n+    \n+    /**\n+     * source connector label\n+     * @return\n+     */\n+    public JobContextBuilder sourceLabel(String sourceLabel) {\n+        builder.with(\"sourceLabel\", sourceLabel);\n+        return this;\n+    }\n+    \n+    /**\n+     * source connector name\n+     * @return\n+     */\n+    public JobContextBuilder sourceConnectorName(String sourceConnectorName) {\n+        builder.with(\"sourceConnectorName\", sourceConnectorName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzEyNjI5Mg==", "bodyText": "Could you rename the context key \"targetConnectorName\" to \"targetConnectorType\" to keep the same vocabulary as for \"connectorType\" please? \ud83d\ude42", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#discussion_r433126292", "createdAt": "2020-06-01T09:13:29Z", "author": {"login": "elogeart"}, "path": "main/plugins/org.talend.designer.components.libs/libs_src/talend-job-monitoring/src/main/java/org/talend/job/audit/JobContextBuilder.java", "diffHunk": "@@ -86,5 +96,59 @@ public JobContextBuilder status(String status) {\n     public Context build() {\n         return builder.build();\n     }\n-\n+    \n+    /**\n+     * source connector id\n+     * @return\n+     */\n+    public JobContextBuilder sourceId(String sourceId) {\n+        builder.with(\"sourceId\", sourceId);\n+        return this;\n+    }\n+    \n+    /**\n+     * source connector label\n+     * @return\n+     */\n+    public JobContextBuilder sourceLabel(String sourceLabel) {\n+        builder.with(\"sourceLabel\", sourceLabel);\n+        return this;\n+    }\n+    \n+    /**\n+     * source connector name\n+     * @return\n+     */\n+    public JobContextBuilder sourceConnectorName(String sourceConnectorName) {\n+        builder.with(\"sourceConnectorName\", sourceConnectorName);\n+        return this;\n+    }\n+    \n+    /**\n+     * target connector id\n+     * @return\n+     */\n+    public JobContextBuilder targetId(String targetId) {\n+        builder.with(\"targetId\", targetId);\n+        return this;\n+    }\n+    \n+    /**\n+     * target connector label\n+     * @return\n+     */\n+    public JobContextBuilder targetLabel(String targetLabel) {\n+        builder.with(\"targetLabel\", targetLabel);\n+        return this;\n+    }\n+    \n+    /**\n+     * target connector name\n+     * @return\n+     */\n+    public JobContextBuilder targetConnectorName(String targetConnectorName) {\n+        builder.with(\"targetConnectorName\", targetConnectorName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzEyODYwNQ==", "bodyText": "I think we forget to ask you but we need some (little) changes in this interface: could you change all category attributes to the name of the corresponding method please ? \ud83d\ude42\nI mean, current code is:\n@AuditEvent(category = \"connection\" ... ) {\n    void flowExecution(...);\n}\n\nand we need instead:\n@AuditEvent(category = \"flowExecution\" ... ) {\n    void flowExecution(...);\n}\n\nand so on for each @AuditEvent.", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#discussion_r433128605", "createdAt": "2020-06-01T09:18:49Z", "author": {"login": "elogeart"}, "path": "main/plugins/org.talend.designer.components.libs/libs_src/talend-job-monitoring/src/main/java/org/talend/job/audit/JobAuditLogger.java", "diffHunk": "@@ -13,13 +13,16 @@\n \t@AuditEvent(category = \"job\", message = \"Job stop : job_name:{jobName}, job_version:{jobVersion}, job_id:{jobId}, timestamp:{timestamp}, status:{status}, duration:{duration}\", level = LogLevel.INFO)\n     void jobstop(Context context);\n \t\n-\t@AuditEvent(category = \"connector\", message = \"Component run : job_name:{jobName}, job_version:{jobVersion}, job_id:{jobId}, connector_type:{connectorType}, connector_id:{connectorId}\", level = LogLevel.INFO)\n+\t@AuditEvent(category = \"connector\", message = \"Component run : job_name:{jobName}, job_version:{jobVersion}, job_id:{jobId}, connector_type:{connectorType}, connector_id:{connectorId}, connector_label:{connectorLabel}\", level = LogLevel.INFO)\n     void runcomponent(Context context);\n \n-    @AuditEvent(category = \"connection\", message = \"Component {connectorType} {connectionType} {rows} rows in {duration} with {connectionName} line\", level = LogLevel.INFO)\n+    @AuditEvent(category = \"connection\", message = \"Component {connectorType} {connectorLabel} {connectionType} {rows} rows in {duration} with {connectionName} line\", level = LogLevel.INFO)\n     void flowOutput(Context context);\n     \n-    @AuditEvent(category = \"connection\", message = \"Component {connectorType} received {rows} rows in {duration} with {connectionName} line\", level = LogLevel.INFO)\n+    @AuditEvent(category = \"connection\", message = \"Component {connectorType} {connectorLabel} received {rows} rows in {duration} with {connectionName} line\", level = LogLevel.INFO)\n     void flowInput(Context context);\n+    \n+    @AuditEvent(category = \"connection\", message = \"connection : {connectionName}, row : {rows}, cost : {duration}\", level = LogLevel.INFO)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c27cad17d2808054c81a2856a7075cc404c27b3"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77babb4eb5024990b0ec363aba8130bb440835ab", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/77babb4eb5024990b0ec363aba8130bb440835ab", "committedDate": "2020-06-01T09:36:26Z", "message": "fix(TDI-44306): adjust the audit event log integration in studio"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c87de94de416cb4825dbb01c627bfe0e3f662be", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/8c87de94de416cb4825dbb01c627bfe0e3f662be", "committedDate": "2020-06-02T02:54:44Z", "message": "fix(TDI-44306): fix the build on javac of java 11"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "272d6bea3cde8d1fd329b74c819d651db8fc528f", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/272d6bea3cde8d1fd329b74c819d651db8fc528f", "committedDate": "2020-06-02T03:54:33Z", "message": "use a more clear method name and context name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7232fb5e4ef96b6a2d60d77ea48ae0d611db07d", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/a7232fb5e4ef96b6a2d60d77ea48ae0d611db07d", "committedDate": "2020-06-02T06:50:50Z", "message": "fix(TDI-44306): adjust the audit event log integration in studio"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMzk2ODMy", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#pullrequestreview-422396832", "createdAt": "2020-06-02T07:07:11Z", "commit": {"oid": "a7232fb5e4ef96b6a2d60d77ea48ae0d611db07d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDc2NzQ0", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#pullrequestreview-422476744", "createdAt": "2020-06-02T08:56:51Z", "commit": {"oid": "a7232fb5e4ef96b6a2d60d77ea48ae0d611db07d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3412452c33c1f82d0a5b4cf66587a20cc6857783", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/3412452c33c1f82d0a5b4cf66587a20cc6857783", "committedDate": "2020-06-03T02:32:50Z", "message": "fix(TDI-44172): not use camel name way for context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "925752d8cafb7aadce7f782d5c9832280007e091", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/925752d8cafb7aadce7f782d5c9832280007e091", "committedDate": "2020-06-08T01:53:05Z", "message": "Merge remote-tracking branch 'origin/master' into wwang-talend/TDI-44172"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "486505fcc0d96ee5f7ab1118c59e4b85023ab604", "author": {"user": {"login": "wwang-talend", "name": "wang wei"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/486505fcc0d96ee5f7ab1118c59e4b85023ab604", "committedDate": "2020-06-09T06:05:15Z", "message": "fix the group name to avoid tuj down risk"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NjY5MDU0", "url": "https://github.com/Talend/tdi-studio-se/pull/4725#pullrequestreview-427669054", "createdAt": "2020-06-10T02:29:11Z", "commit": {"oid": "486505fcc0d96ee5f7ab1118c59e4b85023ab604"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4695, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}