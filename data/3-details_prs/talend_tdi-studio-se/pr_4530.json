{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4ODg4ODMy", "number": 4530, "title": "fix(TUP-26231)Relative path not working in Talend v721", "bodyText": "https://jira.talendforge.org/browse/TUP-26231\nWhat is the current behavior? (You can also link to an open issue here)\nWhat is the new behavior?\nPlease check if the PR fulfills these requirements\n\n The commit message follows Talend standard\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features) ?\n The code coverage on new code >75%\n The new code does not introduce new technical issues (sonar / eslint)\n\nWhat kind of change does this PR introduce?\n\n Bugfix\n Feature\n Code style update (formatting, local variables)\n Refactoring (no functional changes, no api changes)\n Build / CI related changes\n Other... Please describe:\n\nDoes this PR introduce a breaking change?\n\n Yes\n No\n\nIf this PR contains a breaking change, please describe the impact and migration path for existing applications: ...\nOther information:", "createdAt": "2020-03-16T00:22:06Z", "url": "https://github.com/Talend/tdi-studio-se/pull/4530", "merged": true, "mergeCommit": {"oid": "03528cf6a648e0def5c777f702b6628be2a1dfc7"}, "closed": true, "closedAt": "2020-03-23T06:32:22Z", "author": {"login": "jding-tlnd"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOCxdHgH2gAyMzg4ODg4ODMyOmNkNzA2ZGZjNDBlMjdkZTBhMmNlMWYxNzNhMzYzMThkNDNhMGVlNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQYXWnAFqTM3OTE1OTU3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cd706dfc40e27de0a2ce1f173a36318d43a0ee45", "author": {"user": {"login": "jding-tlnd", "name": "Jane Ding"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/cd706dfc40e27de0a2ce1f173a36318d43a0ee45", "committedDate": "2020-03-16T00:14:51Z", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62c842532639398ae40a1c876a99209b7cabee9a", "author": {"user": {"login": "jding-tlnd", "name": "Jane Ding"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/62c842532639398ae40a1c876a99209b7cabee9a", "committedDate": "2020-03-17T17:13:36Z", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDcyOTU2", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#pullrequestreview-377472956", "createdAt": "2020-03-19T07:24:14Z", "commit": {"oid": "62c842532639398ae40a1c876a99209b7cabee9a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyNDoxNVrOF4imiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyNToxMlrOF4inxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTQ5Nw==", "bodyText": "missing one caller of BigDataCodeGenerator, can move the isExportConfig to resourceService.getResourcePathForContext, no need add another api getFullResourcePathForContext", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r394831497", "createdAt": "2020-03-19T07:24:15Z", "author": {"login": "zwxue"}, "path": "main/plugins/org.talend.designer.codegen/src/main/java/org/talend/designer/codegen/CodeGenerator.java", "diffHunk": "@@ -353,8 +354,14 @@ public String generateContextCode(IContext designerContext) throws CodeGenerator\n                                     .getDefault().getService(IResourcesDependenciesService.class);\n                             String resourcePathForContext = null;\n                             if (process instanceof IProcess2) {\n-                                resourcePathForContext = resourceService.getResourcePathForContext(process,\n-                                        contextPar.getValue());\n+                                String value = contextPar.getValue();\n+                                // for runtime\n+                                if (!ProcessorUtilities.isExportConfig()) {\n+                                    contextPar.setType(JavaTypesManager.FILE.getId());\n+                                    resourcePathForContext = resourceService.getFullResourcePathForContext(process, value);\n+                                } else {\n+                                    resourcePathForContext = resourceService.getResourcePathForContext(process, value);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62c842532639398ae40a1c876a99209b7cabee9a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTgxMg==", "bodyText": "can use RunprocessService.getTalendJobJavaProject.getExtsourceFolder() here", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r394831812", "createdAt": "2020-03-19T07:25:12Z", "author": {"login": "zwxue"}, "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/dependencies/util/ResourceDependenciesUtil.java", "diffHunk": "@@ -310,6 +310,21 @@ public static void copyToExtResourceFolder(JobResourceDependencyModel model, Str\n         }\r\n     }\r\n \r\n+    public static String getJobExecuteResourceFilePath(JobResourceDependencyModel model, IRepositoryViewObject jobObject,\r\n+            String jobLabel,\r\n+            String resourceVersion) {\r\n+        String path = null;\r\n+        String extResPath = getProcessFolder(jobObject) + jobLabel.toLowerCase() + SRC_EXTRESOURCE_FOLDER;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62c842532639398ae40a1c876a99209b7cabee9a"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ead8edcd482077270bd04905a48de5107c1de7d7", "author": {"user": {"login": "jding-tlnd", "name": "Jane Ding"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/ead8edcd482077270bd04905a48de5107c1de7d7", "committedDate": "2020-03-20T01:07:10Z", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MjA1ODEw", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#pullrequestreview-378205810", "createdAt": "2020-03-20T02:32:12Z", "commit": {"oid": "ead8edcd482077270bd04905a48de5107c1de7d7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c918e647d731c33c22d8e6d919e08d62b1490fb", "author": {"user": {"login": "jding-tlnd", "name": "Jane Ding"}}, "url": "https://github.com/Talend/tdi-studio-se/commit/9c918e647d731c33c22d8e6d919e08d62b1490fb", "committedDate": "2020-03-20T08:48:01Z", "message": "fix(TUP-26231):Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTgwMDYy", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#pullrequestreview-378980062", "createdAt": "2020-03-22T07:55:57Z", "commit": {"oid": "9c918e647d731c33c22d8e6d919e08d62b1490fb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwNzo1NTo1OFrOF5t4bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwNzo1NTo1OFrOF5t4bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA2NDg3Nw==", "bodyText": "if(!ProcessorUtilities.isExportConfig())  ?", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r396064877", "createdAt": "2020-03-22T07:55:58Z", "author": {"login": "zwxue"}, "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/dependencies/service/ResourcesDependenciesService.java", "diffHunk": "@@ -89,12 +91,12 @@ public String getResourcePathForContext(IProcess process, String resourceContext\n                     if (repoObject != null) {\r\n                         JobResourceDependencyModel model = new JobResourceDependencyModel(\r\n                                 (ResourceItem) repoObject.getProperty().getItem());\r\n-                        StringBuffer joblabel = new StringBuffer();\r\n-                        if (StringUtils.isNotBlank(property.getItem().getState().getPath())) {\r\n-                            joblabel.append(property.getItem().getState().getPath() + \"/\");\r\n+                        String jobLabel = JavaResourcesHelper.getJobFolderName(property.getLabel(), property.getVersion());\r\n+                        if (ProcessorUtilities.isExportConfig()) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c918e647d731c33c22d8e6d919e08d62b1490fb"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MTU5NTc3", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#pullrequestreview-379159577", "createdAt": "2020-03-23T06:32:06Z", "commit": {"oid": "9c918e647d731c33c22d8e6d919e08d62b1490fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4614, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}