{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNjk2NTMx", "number": 5038, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxNjo1NlrOEaImLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxNjo1NlrOEaImLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODM5Mjc2OnYy", "diffSide": "RIGHT", "path": "main/plugins/org.talend.designer.components.localprovider/components/tSSH/tSSH_begin.javajet", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxNjo1NlrOHDXi1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxNjo1NlrOHDXi1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzI5MzUyNg==", "bodyText": "hardcoded value. create a regression", "url": "https://github.com/Talend/tdi-studio-se/pull/5038#discussion_r473293526", "createdAt": "2020-08-19T20:16:56Z", "author": {"login": "pteyssier"}, "path": "main/plugins/org.talend.designer.components.localprovider/components/tSSH/tSSH_begin.javajet", "diffHunk": "@@ -83,104 +47,95 @@ if ((metadatas!=null)&&(metadatas.size()>0)) {\n \t\t<%if(isLog4jEnabled){%>\n \t\t\tlog.info(\"<%=cid%> - Connection attempt to '\" +hostname_<%=cid%> + \"' on the port '\"+<%=port%>+\"' as '\" + username_<%=cid%> + \"'.\");\n \t\t<%}%>\n-<%\n-        if((\"\").equals(port)){\n-%>\n-\t\t\t  ch.ethz.ssh2.Connection conn_<%=cid%> = new ch.ethz.ssh2.Connection(hostname_<%=cid%>);\n-<%\n-        } else {\n-%>\n-\t\t\t  ch.ethz.ssh2.Connection conn_<%=cid%> = new ch.ethz.ssh2.Connection(hostname_<%=cid%>,Integer.parseInt(<%=port %> + \"\"));\n-<%\n-        }\n-%>\n-\t\t/* Create a session */\n-\t\tch.ethz.ssh2.Session sess_<%=cid%> = null;\n-              /* Now connect */\n-<%\n-        if((\"true\").equals(useTimeout)){\n-%>\n-\t\t\t  conn_<%=cid%>.connect(null,0,<%=timeout%>*1000);\n-<%\n-        } else {\n-%>\n-\t\t\t  conn_<%=cid%>.connect();\n-<%\n-        }\n-        \n+\t\torg.apache.sshd.client.SshClient client_<%=cid%> = org.apache.sshd.client.SshClient.setUpDefaultClient();\n+\t\t\n+\t\t<%\n         if ((\"PUBLICKEY\").equals(authMethod)) {\n-%>\n-\t\t<%if(isLog4jEnabled){%>\n-\t\t\tlog.info(\"<%=cid%> - Authentication using a public key.\");\n-\t\t<%}%>\n-        java.io.File keyfile_<%=cid%> = new java.io.File(<%=privatekey%>); \n-        \n-        <%\n-        String passwordFieldName = \"__PASSPHRASE__\";\n         %>\n-        \n-        <%@ include file=\"@{org.talend.designer.components.localprovider}/components/templates/password.javajet\"%>        \n-        \n-\t\t    boolean isAuthenticated_<%=cid%> = conn_<%=cid%>.authenticateWithPublicKey(username_<%=cid%>, keyfile_<%=cid%>, decryptedPassword_<%=cid%>);\n-\t\t\t  if (isAuthenticated_<%=cid%> == false){\n-\t\t\t      throw new RuntimeException(\"Authentication failed.\");\n-\t\t\t  }\n-<%\n-        }\n-        if ((\"PASSWORD\").equals(authMethod)) {\n-%>\n \t\t<%if(isLog4jEnabled){%>\n-\t\t\tlog.info(\"<%=cid%> - Authentication using a password.\");\n+\t\t\tlog.info(\"<%=cid%> - Authentication using a public key.\");\n \t\t<%}%>\n+\t\tclient_<%=cid%>.setUserAuthFactories(java.util.Collections.singletonList(org.apache.sshd.client.auth.pubkey.UserAuthPublicKeyFactory.INSTANCE));\n+\t\tjava.nio.file.Path privateKey_<%=cid%> = java.nio.file.Paths.get(<%=privatekey%>);\n+\t\tjava.util.List<String> lines_<%=cid%> = java.nio.file.Files.readAllLines(privateKey_tSSH_1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "749091b5cad8c0c92e7789bd0c44e2df185c23e6"}, "originalPosition": 120}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4693, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}