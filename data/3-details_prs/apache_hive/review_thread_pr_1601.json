{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NjQwOTEx", "number": 1601, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozNDowMFrOEyrpEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozODo1NFrOEyrumw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxNTc5MjgzOnYy", "diffSide": "RIGHT", "path": "serde/src/java/org/apache/hadoop/hive/serde2/avro/SchemaToTypeInfo.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozNDowMFrOHpdF2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNDo0Mjo1MFrOHr2Hbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMDI5OQ==", "bodyText": "Nit: Instead of using a try-catch block, you could use StringUtils.isNumeric() to determine if a string is a positive decimal number.", "url": "https://github.com/apache/hive/pull/1601#discussion_r513230299", "createdAt": "2020-10-28T07:34:00Z", "author": {"login": "lcspinter"}, "path": "serde/src/java/org/apache/hadoop/hive/serde2/avro/SchemaToTypeInfo.java", "diffHunk": "@@ -186,6 +188,20 @@ public static TypeInfo generateTypeInfo(Schema schema,\n     return typeInfoCache.retrieve(schema, seenSchemas);\n   }\n \n+  private static int getIntValue(JsonNode jsonNode) {\n+    int value = 0;\n+    if (jsonNode instanceof TextNode) {\n+      try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTczNzQ1NA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1601#discussion_r515737454", "createdAt": "2020-11-02T04:42:50Z", "author": {"login": "nareshpr"}, "path": "serde/src/java/org/apache/hadoop/hive/serde2/avro/SchemaToTypeInfo.java", "diffHunk": "@@ -186,6 +188,20 @@ public static TypeInfo generateTypeInfo(Schema schema,\n     return typeInfoCache.retrieve(schema, seenSchemas);\n   }\n \n+  private static int getIntValue(JsonNode jsonNode) {\n+    int value = 0;\n+    if (jsonNode instanceof TextNode) {\n+      try {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMDI5OQ=="}, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxNTgwNjk5OnYy", "diffSide": "RIGHT", "path": "ql/src/test/queries/clientnegative/avro_decimal.q", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozODo1NFrOHpdORQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwNDo0MjoyMlrOHr2HFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMjQ1Mw==", "bodyText": "What happens if the precision or scale numbers are negative? Could you please add some q tests to cover that scenario as well?", "url": "https://github.com/apache/hive/pull/1601#discussion_r513232453", "createdAt": "2020-10-28T07:38:54Z", "author": {"login": "lcspinter"}, "path": "ql/src/test/queries/clientnegative/avro_decimal.q", "diffHunk": "@@ -12,6 +12,6 @@ OUTPUTFORMAT\n   'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'\n TBLPROPERTIES (\n   'numFiles'='1',\n-  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"5\",\\\"scale\\\":\"2\"}}]}'\n+  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"a\",\\\"scale\\\":\"b\"}}]}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTczNzM2Nw==", "bodyText": "I added testcase with negative integer, it throws exception same as string input", "url": "https://github.com/apache/hive/pull/1601#discussion_r515737367", "createdAt": "2020-11-02T04:42:22Z", "author": {"login": "nareshpr"}, "path": "ql/src/test/queries/clientnegative/avro_decimal.q", "diffHunk": "@@ -12,6 +12,6 @@ OUTPUTFORMAT\n   'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'\n TBLPROPERTIES (\n   'numFiles'='1',\n-  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"5\",\\\"scale\\\":\"2\"}}]}'\n+  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"a\",\\\"scale\\\":\"b\"}}]}'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMjQ1Mw=="}, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 363, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}