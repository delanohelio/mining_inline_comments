{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MzI2MTEx", "number": 1555, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMjo0Nzo0MVrOE0ypAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMjo0ODoyM1rOE0yp5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzkxMTA1OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMjo0Nzo0MVrOHstPxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNDowNDo1NFrOHswMsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MDcwOA==", "bodyText": "Could we say instead or something like this?\n\"EXCEPT and INTERSECT operations are only supported with Cost Based Optimizations enabled. Please set 'hive.cbo.enable' to true\"", "url": "https://github.com/apache/hive/pull/1555#discussion_r516640708", "createdAt": "2020-11-03T12:47:41Z", "author": {"login": "pvary"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java", "diffHunk": "@@ -11628,6 +11628,11 @@ private void setupStats(TableScanDesc tsDesc, QBParseInfo qbp, Table tab, String\n   }\n \n   private Operator genPlan(QB parent, QBExpr qbexpr) throws SemanticException {\n+    if (qbexpr.getOpcode() == QBExpr.Opcode.EXCEPT || qbexpr.getOpcode() == QBExpr.Opcode.EXCEPTALL\n+        || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECT || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECTALL) {\n+      throw new SemanticException(\n+          \"Except and intersect operations are only supported with Cost Based Optimizations enabled. Turn on hive.cbo.enable\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be11c59a36c7040a846a55a6e1463d8396316281"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY4OTA3NA==", "bodyText": "Fixed", "url": "https://github.com/apache/hive/pull/1555#discussion_r516689074", "createdAt": "2020-11-03T14:04:54Z", "author": {"login": "pvargacl"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java", "diffHunk": "@@ -11628,6 +11628,11 @@ private void setupStats(TableScanDesc tsDesc, QBParseInfo qbp, Table tab, String\n   }\n \n   private Operator genPlan(QB parent, QBExpr qbexpr) throws SemanticException {\n+    if (qbexpr.getOpcode() == QBExpr.Opcode.EXCEPT || qbexpr.getOpcode() == QBExpr.Opcode.EXCEPTALL\n+        || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECT || qbexpr.getOpcode() == QBExpr.Opcode.INTERSECTALL) {\n+      throw new SemanticException(\n+          \"Except and intersect operations are only supported with Cost Based Optimizations enabled. Turn on hive.cbo.enable\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MDcwOA=="}, "originalCommit": {"oid": "be11c59a36c7040a846a55a6e1463d8396316281"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzkxMzMyOnYy", "diffSide": "RIGHT", "path": "ql/src/test/queries/clientnegative/except_cbooff.q", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMjo0ODoyM1rOHstRLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNDowNTozMFrOHswOUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MTA3MA==", "bodyText": "Do we have positive tests?", "url": "https://github.com/apache/hive/pull/1555#discussion_r516641070", "createdAt": "2020-11-03T12:48:23Z", "author": {"login": "pvary"}, "path": "ql/src/test/queries/clientnegative/except_cbooff.q", "diffHunk": "@@ -0,0 +1,5 @@\n+set hive.cbo.enable=false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be11c59a36c7040a846a55a6e1463d8396316281"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY4OTQ4OA==", "bodyText": "Yes there are, they were added when the original feature was developed.", "url": "https://github.com/apache/hive/pull/1555#discussion_r516689488", "createdAt": "2020-11-03T14:05:30Z", "author": {"login": "pvargacl"}, "path": "ql/src/test/queries/clientnegative/except_cbooff.q", "diffHunk": "@@ -0,0 +1,5 @@\n+set hive.cbo.enable=false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY0MTA3MA=="}, "originalCommit": {"oid": "be11c59a36c7040a846a55a6e1463d8396316281"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 327, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}