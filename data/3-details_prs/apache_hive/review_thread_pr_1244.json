{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTk5ODAx", "number": 1244, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNDozM1rOEPFMqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMToxNzozM1rOEPFcJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MjQ5MjU5OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNDozM1rOGymDRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNDozM1rOGymDRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTQxMw==", "bodyText": "could we use forEach here?", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705413", "createdAt": "2020-07-16T11:04:33Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MjQ5NDE0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNTowNVrOGymEQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNTowNVrOGymEQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTY2Ng==", "bodyText": "same", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705666", "createdAt": "2020-07-16T11:05:05Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {\n+      for (FileSinkOperator fs : OperatorUtils.findOperators(rootOp, FileSinkOperator.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MjUzMjIwOnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMToxNzozM1rOGymbiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTo1NTozMFrOGynmpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcxMTYyNQ==", "bodyText": "I think, it can be extracted to base. In MapWork and ReduceWork , for example, you can do same, at least for FileSinkOperator - iterate over getAllRootOperators() and call configureJobConf", "url": "https://github.com/apache/hive/pull/1244#discussion_r455711625", "createdAt": "2020-07-16T11:17:33Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTczMDg1NA==", "bodyText": "Done", "url": "https://github.com/apache/hive/pull/1244#discussion_r455730854", "createdAt": "2020-07-16T11:55:30Z", "author": {"login": "pvargacl"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcxMTYyNQ=="}, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 570, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}