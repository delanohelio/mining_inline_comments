{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwODMwMDEx", "number": 1186, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNzoyMjowMFrOEJ9z_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMToyMjo0OVrOEKSBxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4ODg1MzcyOnYy", "diffSide": "LEFT", "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNzoyMjowMFrOGqvGNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwOTozNzoxNVrOGq0StA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTAxNA==", "bodyText": "Sorry, I am bit confused looking at this diff. So, the original issue seems to be - \"Metastore's update service wrongly strips partition column stats from the cache in an attempt to update them.\" . How are we fixing this issue by not updating the stats in the cache ? Wouldn't the right fix for this is to to ensure sharedCache.alterTableInCache and sharedCache.alterPartitionInCache methods do the right thing and not incorrectly remove partition column stats ?", "url": "https://github.com/apache/hive/pull/1186#discussion_r447465014", "createdAt": "2020-06-30T07:22:00Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -851,8 +851,6 @@ private void updateTableColStats(RawStore rawStore, String catName, String dbNam\n             sharedCache.refreshTableColStatsInCache(StringUtils.normalizeIdentifier(catName),\n                 StringUtils.normalizeIdentifier(dbName), StringUtils.normalizeIdentifier(tblName),\n                 tableColStats.getStatsObj());\n-            // Update the table to get consistent stats state.\n-            sharedCache.alterTableInCache(catName, dbName, tblName, table);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU1MDEzMg==", "bodyText": "If my understanding is correct the cache is already updated by the time we arrive here. Check my comment regarding alterPartitionsInCache and if something is not clear I can elaborate more.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447550132", "createdAt": "2020-06-30T09:37:15Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -851,8 +851,6 @@ private void updateTableColStats(RawStore rawStore, String catName, String dbNam\n             sharedCache.refreshTableColStatsInCache(StringUtils.normalizeIdentifier(catName),\n                 StringUtils.normalizeIdentifier(dbName), StringUtils.normalizeIdentifier(tblName),\n                 tableColStats.getStatsObj());\n-            // Update the table to get consistent stats state.\n-            sharedCache.alterTableInCache(catName, dbName, tblName, table);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTAxNA=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4ODg1NjkzOnYy", "diffSide": "LEFT", "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNzoyMjo1MFrOGqvIMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMToxOToyMlrOGrO3YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg==", "bodyText": "Same concern here as previous. How do we fix this issue by not updating the cache at all ?", "url": "https://github.com/apache/hive/pull/1186#discussion_r447465522", "createdAt": "2020-06-30T07:22:50Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU0Nzg2OQ==", "bodyText": "The explanation is hidden in the commit message :)\nUsing alterPartitionInCache is problematic:\n\nIt empties all relevant stats about partitions even those updated just now.\nIt is not necessary since partitions were updated/refreshed just before calling the method updateTablePartitionColStats via updateTablePartitions.\nIt is not meant to be used for syncing the cache but rather handle updates in partitions.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447547869", "createdAt": "2020-06-30T09:33:33Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg5MjMyNA==", "bodyText": "Ok, thanks for the explanation. Would you need below lines, since you no longer use List [Partition]  ?\n      Deadline.startTimer(\"getPartitionsByNames\");\n      List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);", "url": "https://github.com/apache/hive/pull/1186#discussion_r447892324", "createdAt": "2020-06-30T18:25:12Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4MzE0NA==", "bodyText": "They are already removed aren't they? Maybe, I didn't understand what you mean.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447983144", "createdAt": "2020-06-30T21:14:35Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NDEwNg==", "bodyText": "Ok, in review mode, only last two lines appear. I can see that they are removed in \"Files changed\" tab.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447984106", "createdAt": "2020-06-30T21:16:29Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NTUwNA==", "bodyText": "Indeed some times its confusing :)", "url": "https://github.com/apache/hive/pull/1186#discussion_r447985504", "createdAt": "2020-06-30T21:19:22Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -900,13 +898,6 @@ private void updateTablePartitionColStats(RawStore rawStore, String catName, Str\n               rawStore.getPartitionColumnStatistics(catName, dbName, tblName, partNames, colNames, CacheUtils.HIVE_ENGINE);\n           Deadline.stopTimer();\n           sharedCache.refreshPartitionColStatsInCache(catName, dbName, tblName, partitionColStats);\n-          Deadline.startTimer(\"getPartitionsByNames\");\n-          List<Partition> parts = rawStore.getPartitionsByNames(catName, dbName, tblName, partNames);\n-          Deadline.stopTimer();\n-          // Also save partitions for consistency as they have the stats state.\n-          for (Partition part : parts) {\n-            sharedCache.alterPartitionInCache(catName, dbName, tblName, part.getValues(), part);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTUyMg=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4ODg1ODk3OnYy", "diffSide": "RIGHT", "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNzoyMzoyNVrOGqvJdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMToxODo0OVrOGrO2WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTg0Nw==", "bodyText": "Please create a JIRA for this TODO and add a reference in the comment.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447465847", "createdAt": "2020-06-30T07:23:25Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -2264,6 +2255,8 @@ private MergedColumnStatsForPartitions mergeColStatsForPartitions(String catName\n       if (colStatsMap.size() < 1) {\n         LOG.debug(\"No stats data found for: dbName={} tblName= {} partNames= {} colNames= \", dbName, tblName, partNames,\n             colNames);\n+        // TODO: If we don't find any stats then most likely we should return null. Returning an empty object will not\n+        // trigger the lookup in the raw store and we will end up with missing stats.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NDM1MA==", "bodyText": "Did you create a JIRA for this ?", "url": "https://github.com/apache/hive/pull/1186#discussion_r447984350", "createdAt": "2020-06-30T21:16:56Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -2264,6 +2255,8 @@ private MergedColumnStatsForPartitions mergeColStatsForPartitions(String catName\n       if (colStatsMap.size() < 1) {\n         LOG.debug(\"No stats data found for: dbName={} tblName= {} partNames= {} colNames= \", dbName, tblName, partNames,\n             colNames);\n+        // TODO: If we don't find any stats then most likely we should return null. Returning an empty object will not\n+        // trigger the lookup in the raw store and we will end up with missing stats.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTg0Nw=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NTI0MA==", "bodyText": "Yeap, check https://issues.apache.org/jira/browse/HIVE-23781. I was planning to push a new commit now to update the comment.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447985240", "createdAt": "2020-06-30T21:18:49Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/cache/CachedStore.java", "diffHunk": "@@ -2264,6 +2255,8 @@ private MergedColumnStatsForPartitions mergeColStatsForPartitions(String catName\n       if (colStatsMap.size() < 1) {\n         LOG.debug(\"No stats data found for: dbName={} tblName= {} partNames= {} colNames= \", dbName, tblName, partNames,\n             colNames);\n+        // TODO: If we don't find any stats then most likely we should return null. Returning an empty object will not\n+        // trigger the lookup in the raw store and we will end up with missing stats.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ2NTg0Nw=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MjE1NTM3OnYy", "diffSide": "RIGHT", "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMToxOToxNVrOGrO3Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMjo1MzoyNFrOGrRKLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NTQzOQ==", "bodyText": "Why is this change required ? I think in the test case, it's preferable to explicitly add drop statements , so that we know what's going on.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447985439", "createdAt": "2020-06-30T21:19:15Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -136,17 +129,19 @@\n     MetaStoreTestUtils.setConfForStandloneMode(conf);\n     ObjectStore objectStore = new ObjectStore();\n     objectStore.setConf(conf);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Utbl1.getDbName(), db1Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName(), db1Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName());\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Utbl1.getDbName(), db2Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName(), db2Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db1.getName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db2.getName());\n+    for (String clg : objectStore.getCatalogs()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk5OTExOA==", "bodyText": "The setUp method adds things in the Metastore that are not necessarily needed by every test and this was the case even before my changes. In the new test, I added some more tables/columns cause I think it made things easier to understand at least for me. If I was to follow the current pattern I would have to add the tables, cols, partitions, etc., in the setUp method and then drop them in the teardown method but then they would be visible to all other tests as well.\nI like the philosophy where unit tests are minimal (least possible state) thus I would prefer if every test starts with a clean Metastore and ends with a clean Metastore. I didn't change the setUp in order not to introduce too many unrelated changes but I made one step forward in the teardown.\nIf every test in this class was using the same state then I would definitely agree that the setUp and teardown methods should be the way they are right now.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447999118", "createdAt": "2020-06-30T21:49:03Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -136,17 +129,19 @@\n     MetaStoreTestUtils.setConfForStandloneMode(conf);\n     ObjectStore objectStore = new ObjectStore();\n     objectStore.setConf(conf);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Utbl1.getDbName(), db1Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName(), db1Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName());\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Utbl1.getDbName(), db2Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName(), db2Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db1.getName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db2.getName());\n+    for (String clg : objectStore.getCatalogs()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NTQzOQ=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyMzA4NQ==", "bodyText": "Sounds good.", "url": "https://github.com/apache/hive/pull/1186#discussion_r448023085", "createdAt": "2020-06-30T22:53:24Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -136,17 +129,19 @@\n     MetaStoreTestUtils.setConfForStandloneMode(conf);\n     ObjectStore objectStore = new ObjectStore();\n     objectStore.setConf(conf);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Utbl1.getDbName(), db1Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName(), db1Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db1Ptbl1.getDbName(), db1Ptbl1.getTableName());\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Utbl1.getDbName(), db2Utbl1.getTableName());\n-    Deadline.startTimer(\"\");\n-    objectStore.dropPartitions(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName(), db2Ptbl1PtnNames);\n-    objectStore.dropTable(DEFAULT_CATALOG_NAME, db2Ptbl1.getDbName(), db2Ptbl1.getTableName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db1.getName());\n-    objectStore.dropDatabase(DEFAULT_CATALOG_NAME, db2.getName());\n+    for (String clg : objectStore.getCatalogs()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NTQzOQ=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MjE2NTgwOnYy", "diffSide": "LEFT", "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMToyMjo0OVrOGrO9rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMjo1MzoxNVrOGrRKEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NzExNw==", "bodyText": "Why is this test case being removed ?", "url": "https://github.com/apache/hive/pull/1186#discussion_r447987117", "createdAt": "2020-06-30T21:22:49Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -1566,160 +1643,6 @@ private Table createUnpartitionedTableObject(Database db) {\n     return tbl;\n   }\n \n-  private TableAndColStats createUnpartitionedTableObjectWithColStats(Database db) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 227}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk5OTYzNA==", "bodyText": "This is not a test case it is just a private unused method.", "url": "https://github.com/apache/hive/pull/1186#discussion_r447999634", "createdAt": "2020-06-30T21:50:17Z", "author": {"login": "zabetak"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -1566,160 +1643,6 @@ private Table createUnpartitionedTableObject(Database db) {\n     return tbl;\n   }\n \n-  private TableAndColStats createUnpartitionedTableObjectWithColStats(Database db) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NzExNw=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 227}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyMzA1Ng==", "bodyText": "Ok, thanks for the cleanup.", "url": "https://github.com/apache/hive/pull/1186#discussion_r448023056", "createdAt": "2020-06-30T22:53:15Z", "author": {"login": "kishendas"}, "path": "standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStore.java", "diffHunk": "@@ -1566,160 +1643,6 @@ private Table createUnpartitionedTableObject(Database db) {\n     return tbl;\n   }\n \n-  private TableAndColStats createUnpartitionedTableObjectWithColStats(Database db) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk4NzExNw=="}, "originalCommit": {"oid": "ccfc6d94538d49d8bb56f5767ace5fc0132e322f"}, "originalPosition": 227}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 691, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}