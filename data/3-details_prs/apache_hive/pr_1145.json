{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MjM5MjI5", "number": 1145, "title": "HIVE-23722: Show the operation's drilldown link to client", "bodyText": "NOTICE\nPlease create an issue in ASF JIRA before opening a pull request,\nand you need to set the title of the pull request which starts with\nthe corresponding JIRA issue number. (e.g. HIVE-XXXXX: Fix a typo in YYY)\nFor more details, please see https://cwiki.apache.org/confluence/display/Hive/HowToContribute", "createdAt": "2020-06-18T05:35:09Z", "url": "https://github.com/apache/hive/pull/1145", "merged": true, "mergeCommit": {"oid": "4942a7c0b4be3a5b0c889a89b903e9a70c57d494"}, "closed": true, "closedAt": "2020-07-01T16:42:24Z", "author": {"login": "dengzhhu653"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsq4dhAH2gAyNDM2MjM5MjI5OjNlMmJkZjUzZWJhMTZiYjg4ZWQ4MzYyMGU4Njc1YjVlOGFjZGJkNmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwpE-FgFqTQ0MDgwNzI3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "committedDate": "2020-06-19T03:56:26Z", "message": "HIVE-23722: Show the operation's drilldown link to client"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e6e26b0f30dee0f2f925d197581be9705447b6e", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/9e6e26b0f30dee0f2f925d197581be9705447b6e", "committedDate": "2020-06-18T05:38:07Z", "message": "refactor code"}, "afterCommit": {"oid": "3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/3e2bdf53eba16bb88ed83620e8675b5e8acdbd6b", "committedDate": "2020-06-19T03:56:26Z", "message": "HIVE-23722: Show the operation's drilldown link to client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/a5b5fa5b94b5a6cca2deb497343203a70c04094c", "committedDate": "2020-06-19T07:23:44Z", "message": "ssl enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MDc0ODc0", "url": "https://github.com/apache/hive/pull/1145#pullrequestreview-434074874", "createdAt": "2020-06-19T13:25:20Z", "commit": {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMzoyNToyMFrOGmUvBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMzozOTo0MVrOGmVNIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjgzODc4OQ==", "bodyText": "I don't feel that this method should be closely connected to this interface", "url": "https://github.com/apache/hive/pull/1145#discussion_r442838789", "createdAt": "2020-06-19T13:25:20Z", "author": {"login": "kgyrtkirk"}, "path": "service/src/java/org/apache/hive/service/cli/operation/Operation.java", "diffHunk": "@@ -452,4 +452,8 @@ public String getQueryTag() {\n   public String getQueryId() {\n     return queryState.getQueryId();\n   }\n+\n+  public boolean showOperationDrilldownLink() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0MzM1MQ==", "bodyText": "instead of giving access to the HiveServer2 object: how about a method like getWebServerUrl() ?", "url": "https://github.com/apache/hive/pull/1145#discussion_r442843351", "createdAt": "2020-06-19T13:34:01Z", "author": {"login": "kgyrtkirk"}, "path": "service/src/java/org/apache/hive/service/cli/CLIService.java", "diffHunk": "@@ -149,6 +149,10 @@ public UserGroupInformation getHttpUGI() {\n     return this.httpUGI;\n   }\n \n+  public HiveServer2 getHiveServer2() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg0NjQ5OQ==", "bodyText": "I think this should be moved to somewhere around CliService#executeStatement", "url": "https://github.com/apache/hive/pull/1145#discussion_r442846499", "createdAt": "2020-06-19T13:39:41Z", "author": {"login": "kgyrtkirk"}, "path": "service/src/java/org/apache/hive/service/cli/thrift/ThriftCLIService.java", "diffHunk": "@@ -569,7 +569,19 @@ public TExecuteStatementResp ExecuteStatement(TExecuteStatementReq req) throws T\n               queryTimeout) : cliService.executeStatement(sessionHandle, statement, confOverlay,\n               queryTimeout);\n       resp.setOperationHandle(operationHandle.toTOperationHandle());\n-      resp.setStatus(OK_STATUS);\n+      Operation operation = cliService.getSessionManager().getOperationManager()\n+          .getOperation(operationHandle);\n+      if (operation.showOperationDrilldownLink() && cliService.getHiveServer2().getWebServerUrl() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5b5fa5b94b5a6cca2deb497343203a70c04094c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a34eba0f04ea4b4392974cbff5121a59e17ce25", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/1a34eba0f04ea4b4392974cbff5121a59e17ce25", "committedDate": "2020-06-20T00:46:24Z", "message": "Refine codes and reduce class dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "880b348cd5d67dc1ee0c12a27e80f867ad569d87", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/880b348cd5d67dc1ee0c12a27e80f867ad569d87", "committedDate": "2020-06-22T03:54:08Z", "message": "remove HiveServer2 changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6d63bdb752f3eb8cf1626a1d046e3e9b1015596", "author": {"user": {"login": "dengzhhu653", "name": "dengzh"}}, "url": "https://github.com/apache/hive/commit/f6d63bdb752f3eb8cf1626a1d046e3e9b1015596", "committedDate": "2020-06-22T04:43:05Z", "message": "refine codes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODA3Mjc5", "url": "https://github.com/apache/hive/pull/1145#pullrequestreview-440807279", "createdAt": "2020-07-01T12:05:59Z", "commit": {"oid": "f6d63bdb752f3eb8cf1626a1d046e3e9b1015596"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3665, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}