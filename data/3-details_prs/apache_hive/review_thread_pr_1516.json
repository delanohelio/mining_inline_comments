{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNjkxODU4", "number": 1516, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNToyNTo0N1rOEmX-GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNToyOTo0M1rOEmYBFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4Njc0MDczOnYy", "diffSide": "RIGHT", "path": "ql/src/test/results/clientpositive/llap/create_like2.q.out", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNToyNTo0N1rOHWW2vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzowNDo1MVrOHWZOOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNTE4Mw==", "bodyText": "This is a bit counterintuitive to me. Why is this table property set to insert only whereas in the other case it is default?", "url": "https://github.com/apache/hive/pull/1516#discussion_r493205183", "createdAt": "2020-09-23T05:25:47Z", "author": {"login": "pvary"}, "path": "ql/src/test/results/clientpositive/llap/create_like2.q.out", "diffHunk": "@@ -59,3 +59,285 @@ Bucket Columns:     \t[]\n Sort Columns:       \t[]                  \t \n Storage Desc Params:\t \t \n \tserialization.format\t1                   \n+PREHOOK: query: create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default')\n+PREHOOK: type: CREATETABLE\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_mm\n+POSTHOOK: query: create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default')\n+POSTHOOK: type: CREATETABLE\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_mm\n+PREHOOK: query: desc formatted test_mm\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_mm\n+POSTHOOK: query: desc formatted test_mm\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_mm\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tMANAGED_TABLE       \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tbucketing_version   \t2                   \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+\ttransactional       \ttrue                \n+\ttransactional_properties\tdefault             \n+#### A masked pattern was here ####\n+\t \t \n+# Storage Information\t \t \n+SerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \n+InputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \n+OutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \n+Compressed:         \tNo                  \t \n+Num Buckets:        \t-1                  \t \n+Bucket Columns:     \t[]                  \t \n+Sort Columns:       \t[]                  \t \n+#### A masked pattern was here ####\n+PREHOOK: type: CREATETABLE\n+#### A masked pattern was here ####\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_external\n+#### A masked pattern was here ####\n+POSTHOOK: type: CREATETABLE\n+#### A masked pattern was here ####\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_external\n+PREHOOK: query: desc formatted test_external\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_external\n+POSTHOOK: query: desc formatted test_external\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_external\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tEXTERNAL_TABLE      \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tEXTERNAL            \tTRUE                \n+\tbucketing_version   \t2                   \n+\tdiscover.partitions \ttrue                \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+#### A masked pattern was here ####\n+\t \t \n+# Storage Information\t \t \n+SerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \n+InputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \n+OutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \n+Compressed:         \tNo                  \t \n+Num Buckets:        \t-1                  \t \n+Bucket Columns:     \t[]                  \t \n+Sort Columns:       \t[]                  \t \n+PREHOOK: query: create table test_mm1 like test_external\n+PREHOOK: type: CREATETABLE\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_mm1\n+POSTHOOK: query: create table test_mm1 like test_external\n+POSTHOOK: type: CREATETABLE\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_mm1\n+PREHOOK: query: desc formatted test_mm1\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_mm1\n+POSTHOOK: query: desc formatted test_mm1\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_mm1\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tMANAGED_TABLE       \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tbucketing_version   \t2                   \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+\ttransactional       \ttrue                \n+\ttransactional_properties\tinsert_only         ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI0Mzk2MA==", "bodyText": "In SemanticAnalyzer, if there is no UserSpecifiedFormat in CTLT, while adding all default properties we are using TextFile Input/Output classes because default hive.default.fileformat.managed is TextFile. But org.apache.hadoop.hive.ql.ddl.table.create.like.CreateTableLikeOperation#createTableLikeTable is validating whether any UserSpecifiedFormat, if not its using same table object which is set as ORC. I will change my testcase to set hive.default.fileformat.managed=ORC which should convert it to default & will try to fix that issue in another jira.", "url": "https://github.com/apache/hive/pull/1516#discussion_r493243960", "createdAt": "2020-09-23T07:04:51Z", "author": {"login": "nareshpr"}, "path": "ql/src/test/results/clientpositive/llap/create_like2.q.out", "diffHunk": "@@ -59,3 +59,285 @@ Bucket Columns:     \t[]\n Sort Columns:       \t[]                  \t \n Storage Desc Params:\t \t \n \tserialization.format\t1                   \n+PREHOOK: query: create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default')\n+PREHOOK: type: CREATETABLE\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_mm\n+POSTHOOK: query: create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default')\n+POSTHOOK: type: CREATETABLE\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_mm\n+PREHOOK: query: desc formatted test_mm\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_mm\n+POSTHOOK: query: desc formatted test_mm\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_mm\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tMANAGED_TABLE       \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tbucketing_version   \t2                   \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+\ttransactional       \ttrue                \n+\ttransactional_properties\tdefault             \n+#### A masked pattern was here ####\n+\t \t \n+# Storage Information\t \t \n+SerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \n+InputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \n+OutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \n+Compressed:         \tNo                  \t \n+Num Buckets:        \t-1                  \t \n+Bucket Columns:     \t[]                  \t \n+Sort Columns:       \t[]                  \t \n+#### A masked pattern was here ####\n+PREHOOK: type: CREATETABLE\n+#### A masked pattern was here ####\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_external\n+#### A masked pattern was here ####\n+POSTHOOK: type: CREATETABLE\n+#### A masked pattern was here ####\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_external\n+PREHOOK: query: desc formatted test_external\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_external\n+POSTHOOK: query: desc formatted test_external\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_external\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tEXTERNAL_TABLE      \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tEXTERNAL            \tTRUE                \n+\tbucketing_version   \t2                   \n+\tdiscover.partitions \ttrue                \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+#### A masked pattern was here ####\n+\t \t \n+# Storage Information\t \t \n+SerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \n+InputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \n+OutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \n+Compressed:         \tNo                  \t \n+Num Buckets:        \t-1                  \t \n+Bucket Columns:     \t[]                  \t \n+Sort Columns:       \t[]                  \t \n+PREHOOK: query: create table test_mm1 like test_external\n+PREHOOK: type: CREATETABLE\n+PREHOOK: Output: database:default\n+PREHOOK: Output: default@test_mm1\n+POSTHOOK: query: create table test_mm1 like test_external\n+POSTHOOK: type: CREATETABLE\n+POSTHOOK: Output: database:default\n+POSTHOOK: Output: default@test_mm1\n+PREHOOK: query: desc formatted test_mm1\n+PREHOOK: type: DESCTABLE\n+PREHOOK: Input: default@test_mm1\n+POSTHOOK: query: desc formatted test_mm1\n+POSTHOOK: type: DESCTABLE\n+POSTHOOK: Input: default@test_mm1\n+# col_name            \tdata_type           \tcomment             \n+empno               \tint                 \t                    \n+name                \tstring              \t                    \n+\t \t \n+# Partition Information\t \t \n+# col_name            \tdata_type           \tcomment             \n+dept                \tstring              \t                    \n+\t \t \n+# Detailed Table Information\t \t \n+Database:           \tdefault             \t \n+#### A masked pattern was here ####\n+Retention:          \t0                   \t \n+#### A masked pattern was here ####\n+Table Type:         \tMANAGED_TABLE       \t \n+Table Parameters:\t \t \n+\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n+\tbucketing_version   \t2                   \n+\tnumFiles            \t0                   \n+\tnumPartitions       \t0                   \n+\tnumRows             \t0                   \n+\trawDataSize         \t0                   \n+\ttotalSize           \t0                   \n+\ttransactional       \ttrue                \n+\ttransactional_properties\tinsert_only         ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNTE4Mw=="}, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4Njc0ODM2OnYy", "diffSide": "RIGHT", "path": "ql/src/test/queries/clientpositive/create_like2.q", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNToyOTo0M1rOHWW7Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzoyNDo0OVrOHWZ31A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjMyNw==", "bodyText": "The pull request title says that we have a problem with converting from mm to external tables. The tests convert from external tables to mm. Maybe fix the jira description?  Or add more tests?", "url": "https://github.com/apache/hive/pull/1516#discussion_r493206327", "createdAt": "2020-09-23T05:29:43Z", "author": {"login": "pvary"}, "path": "ql/src/test/queries/clientpositive/create_like2.q", "diffHunk": "@@ -7,3 +7,34 @@ ALTER TABLE table1_n20 SET TBLPROPERTIES ('a'='1', 'b'='2', 'c'='3', 'd' = '4');\n SET hive.ddl.createtablelike.properties.whitelist=a,c,D;\n CREATE TABLE table2_n14 LIKE table1_n20;\n DESC FORMATTED table2_n14;\n+\n+set hive.support.concurrency=true;\n+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;\n+set hive.strict.managed.tables=true;\n+set hive.create.as.acid=true;\n+set hive.create.as.insert.only=true;\n+\n+create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default');\n+desc formatted test_mm;\n+\n+-- Conversion from MM to External\n+create external table test_external like test_mm LOCATION '${system:test.tmp.dir}/create_like_mm_to_external';\n+desc formatted test_external;\n+\n+-- Conversion from External to MM\n+create table test_mm1 like test_external;\n+desc formatted test_mm1;\n+\n+-- Conversion from External to External\n+create external table test_external1 like test_external;\n+desc formatted test_external1;\n+\n+-- Conversion from mm to mm\n+create table test_mm2 like test_mm;\n+desc formatted test_mm2;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI0NDQ2Nw==", "bodyText": "I will change the title, both MM to External & External to MM are failing.", "url": "https://github.com/apache/hive/pull/1516#discussion_r493244467", "createdAt": "2020-09-23T07:05:55Z", "author": {"login": "nareshpr"}, "path": "ql/src/test/queries/clientpositive/create_like2.q", "diffHunk": "@@ -7,3 +7,34 @@ ALTER TABLE table1_n20 SET TBLPROPERTIES ('a'='1', 'b'='2', 'c'='3', 'd' = '4');\n SET hive.ddl.createtablelike.properties.whitelist=a,c,D;\n CREATE TABLE table2_n14 LIKE table1_n20;\n DESC FORMATTED table2_n14;\n+\n+set hive.support.concurrency=true;\n+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;\n+set hive.strict.managed.tables=true;\n+set hive.create.as.acid=true;\n+set hive.create.as.insert.only=true;\n+\n+create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default');\n+desc formatted test_mm;\n+\n+-- Conversion from MM to External\n+create external table test_external like test_mm LOCATION '${system:test.tmp.dir}/create_like_mm_to_external';\n+desc formatted test_external;\n+\n+-- Conversion from External to MM\n+create table test_mm1 like test_external;\n+desc formatted test_mm1;\n+\n+-- Conversion from External to External\n+create external table test_external1 like test_external;\n+desc formatted test_external1;\n+\n+-- Conversion from mm to mm\n+create table test_mm2 like test_mm;\n+desc formatted test_mm2;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjMyNw=="}, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MjA2Mw==", "bodyText": "Last question: What happens when we run:\ncreate external table test_external2 like test_mm;\n\nThanks,\nPeter", "url": "https://github.com/apache/hive/pull/1516#discussion_r493252063", "createdAt": "2020-09-23T07:20:23Z", "author": {"login": "pvary"}, "path": "ql/src/test/queries/clientpositive/create_like2.q", "diffHunk": "@@ -7,3 +7,34 @@ ALTER TABLE table1_n20 SET TBLPROPERTIES ('a'='1', 'b'='2', 'c'='3', 'd' = '4');\n SET hive.ddl.createtablelike.properties.whitelist=a,c,D;\n CREATE TABLE table2_n14 LIKE table1_n20;\n DESC FORMATTED table2_n14;\n+\n+set hive.support.concurrency=true;\n+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;\n+set hive.strict.managed.tables=true;\n+set hive.create.as.acid=true;\n+set hive.create.as.insert.only=true;\n+\n+create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default');\n+desc formatted test_mm;\n+\n+-- Conversion from MM to External\n+create external table test_external like test_mm LOCATION '${system:test.tmp.dir}/create_like_mm_to_external';\n+desc formatted test_external;\n+\n+-- Conversion from External to MM\n+create table test_mm1 like test_external;\n+desc formatted test_mm1;\n+\n+-- Conversion from External to External\n+create external table test_external1 like test_external;\n+desc formatted test_external1;\n+\n+-- Conversion from mm to mm\n+create table test_mm2 like test_mm;\n+desc formatted test_mm2;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjMyNw=="}, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1NDYxMg==", "bodyText": "We are removing \"EXTERNAL\" from tblproperties, but not setting TableType as managed, so it fails with same exception. That is fixed in this patch @ CreateTableLikeOperation\nError: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:default.test_external2 cannot be declared transactional because it's an external table) (state=08S01,code=1)", "url": "https://github.com/apache/hive/pull/1516#discussion_r493254612", "createdAt": "2020-09-23T07:24:49Z", "author": {"login": "nareshpr"}, "path": "ql/src/test/queries/clientpositive/create_like2.q", "diffHunk": "@@ -7,3 +7,34 @@ ALTER TABLE table1_n20 SET TBLPROPERTIES ('a'='1', 'b'='2', 'c'='3', 'd' = '4');\n SET hive.ddl.createtablelike.properties.whitelist=a,c,D;\n CREATE TABLE table2_n14 LIKE table1_n20;\n DESC FORMATTED table2_n14;\n+\n+set hive.support.concurrency=true;\n+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;\n+set hive.strict.managed.tables=true;\n+set hive.create.as.acid=true;\n+set hive.create.as.insert.only=true;\n+\n+create table test_mm(empno int, name string) partitioned by(dept string) stored as orc tblproperties('transactional'='true', 'transactional_properties'='default');\n+desc formatted test_mm;\n+\n+-- Conversion from MM to External\n+create external table test_external like test_mm LOCATION '${system:test.tmp.dir}/create_like_mm_to_external';\n+desc formatted test_external;\n+\n+-- Conversion from External to MM\n+create table test_mm1 like test_external;\n+desc formatted test_mm1;\n+\n+-- Conversion from External to External\n+create external table test_external1 like test_external;\n+desc formatted test_external1;\n+\n+-- Conversion from mm to mm\n+create table test_mm2 like test_mm;\n+desc formatted test_mm2;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIwNjMyNw=="}, "originalCommit": {"oid": "9cbe05374a6aa77e0a10a794946872130d0c2c2d"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 284, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}