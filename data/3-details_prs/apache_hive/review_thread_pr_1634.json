{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTE4NzY5", "number": 1634, "reviewThreads": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzoyODo1OFrOFEvdlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo1ODozMFrOFEvvRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2MjQ1OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzoyODo1OFrOIE68sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxMDozOVrOIGM1Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTAyNg==", "bodyText": "Nit: please rename tt_desc so that it follows the java naming conventions.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031026", "createdAt": "2020-12-13T23:28:58Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java", "diffHunk": "@@ -775,7 +775,7 @@ public static void setTaskPlan(Path path, String alias,\n     if (topOp instanceof TableScanOperator) {\n       try {\n         Utilities.addSchemaEvolutionToTableScanOperator(\n-          (StructObjectInspector) tt_desc.getDeserializer().getObjectInspector(),\n+          (StructObjectInspector) tt_desc.getSerDe().getObjectInspector(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3MjU3NA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543372574", "createdAt": "2020-12-15T14:10:39Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java", "diffHunk": "@@ -775,7 +775,7 @@ public static void setTaskPlan(Path path, String alias,\n     if (topOp instanceof TableScanOperator) {\n       try {\n         Utilities.addSchemaEvolutionToTableScanOperator(\n-          (StructObjectInspector) tt_desc.getDeserializer().getObjectInspector(),\n+          (StructObjectInspector) tt_desc.getSerDe().getObjectInspector(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTAyNg=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2Mjk5OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/TablePropertyEnrichmentOptimizer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzoyOToyMFrOIE688A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxOToyNFrOIGNgjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTA4OA==", "bodyText": "Please call the variable serDe.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031088", "createdAt": "2020-12-13T23:29:20Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/TablePropertyEnrichmentOptimizer.java", "diffHunk": "@@ -115,13 +115,13 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx, Obje\n       String deserializerClassName = null;\n       try {\n         deserializerClassName = tableScanDesc.getTableMetadata().getSd().getSerdeInfo().getSerializationLib();\n-        Deserializer deserializer = ReflectionUtil.newInstance(\n+        AbstractSerDe deserializer = ReflectionUtil.newInstance(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM4MzY5NQ==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543383695", "createdAt": "2020-12-15T14:19:24Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/optimizer/TablePropertyEnrichmentOptimizer.java", "diffHunk": "@@ -115,13 +115,13 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx, Obje\n       String deserializerClassName = null;\n       try {\n         deserializerClassName = tableScanDesc.getTableMetadata().getSd().getSerdeInfo().getSerializationLib();\n-        Deserializer deserializer = ReflectionUtil.newInstance(\n+        AbstractSerDe deserializer = ReflectionUtil.newInstance(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTA4OA=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2Mzc3OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzoyOTozOFrOIE69Rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxMTo1MFrOIGM6qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTE3NQ==", "bodyText": "Please call the variable serDe, and the function getSerDeClass, to be consistent with TableDesc.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031175", "createdAt": "2020-12-13T23:29:38Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java", "diffHunk": "@@ -171,9 +171,9 @@ public String getDeserializerClassName() {\n   public Deserializer getDeserializer(Configuration conf) throws Exception {\n     Properties schema = getProperties();\n     String clazzName = getDeserializerClassName();\n-    Deserializer deserializer = ReflectionUtil.newInstance(conf.getClassByName(clazzName)\n-        .asSubclass(Deserializer.class), conf);\n-    SerDeUtils.initializeSerDe(deserializer, conf, getTableDesc().getProperties(), schema);\n+    AbstractSerDe deserializer = ReflectionUtil.newInstance(conf.getClassByName(clazzName)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3Mzk5Mw==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543373993", "createdAt": "2020-12-15T14:11:50Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java", "diffHunk": "@@ -171,9 +171,9 @@ public String getDeserializerClassName() {\n   public Deserializer getDeserializer(Configuration conf) throws Exception {\n     Properties schema = getProperties();\n     String clazzName = getDeserializerClassName();\n-    Deserializer deserializer = ReflectionUtil.newInstance(conf.getClassByName(clazzName)\n-        .asSubclass(Deserializer.class), conf);\n-    SerDeUtils.initializeSerDe(deserializer, conf, getTableDesc().getProperties(), schema);\n+    AbstractSerDe deserializer = ReflectionUtil.newInstance(conf.getClassByName(clazzName)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTE3NQ=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2NzkxOnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozMjoyMVrOIE6_Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyMzo1OFrOIGN3EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTY2Mw==", "bodyText": "I suggest to call it inputKeySerDe, and it can be created under this name, no need to call it serde for an interim time.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031663", "createdAt": "2020-12-13T23:32:21Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "diffHunk": "@@ -152,10 +152,11 @@ void init(JobConf jconf, Operator<?> reducer, boolean vectorized, TableDesc keyT\n     this.tag = tag;\n \n     try {\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n-      keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n+      AbstractSerDe serde = ReflectionUtils.newInstance(keyTableDesc.getSerDeClass(), null);\n+      serde.initialize(null, keyTableDesc.getProperties(), null);\n+\n+      inputKeyDeserializer = serde; ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM4OTQ1Ng==", "bodyText": "Done.  I had it this way because inputKeyDeserializer is a Deserializer class which does not have an 'initialize' method.  However, I change the type to be AbstractSerDe to address your comments here.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543389456", "createdAt": "2020-12-15T14:23:58Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "diffHunk": "@@ -152,10 +152,11 @@ void init(JobConf jconf, Operator<?> reducer, boolean vectorized, TableDesc keyT\n     this.tag = tag;\n \n     try {\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n-      keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n+      AbstractSerDe serde = ReflectionUtils.newInstance(keyTableDesc.getSerDeClass(), null);\n+      serde.initialize(null, keyTableDesc.getProperties(), null);\n+\n+      inputKeyDeserializer = serde; ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTY2Mw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2ODI2OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozMjozM1rOIE6_VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxMjozM1rOIGM-dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTcwMQ==", "bodyText": "Please call this inputValueSerDe", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031701", "createdAt": "2020-12-13T23:32:33Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "diffHunk": "@@ -164,10 +165,8 @@ void init(JobConf jconf, Operator<?> reducer, boolean vectorized, TableDesc keyT\n \n       // We should initialize the SerDe with the TypeInfo when available.\n       this.valueTableDesc = valueTableDesc;\n-      inputValueDeserializer = (AbstractSerDe) ReflectionUtils.newInstance(\n-          valueTableDesc.getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputValueDeserializer, null,\n-          valueTableDesc.getProperties(), null);\n+      inputValueDeserializer = (AbstractSerDe) ReflectionUtils.newInstance(valueTableDesc.getSerDeClass(), null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3NDk2Ng==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543374966", "createdAt": "2020-12-15T14:12:33Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/ReduceRecordSource.java", "diffHunk": "@@ -164,10 +165,8 @@ void init(JobConf jconf, Operator<?> reducer, boolean vectorized, TableDesc keyT\n \n       // We should initialize the SerDe with the TypeInfo when available.\n       this.valueTableDesc = valueTableDesc;\n-      inputValueDeserializer = (AbstractSerDe) ReflectionUtils.newInstance(\n-          valueTableDesc.getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputValueDeserializer, null,\n-          valueTableDesc.getProperties(), null);\n+      inputValueDeserializer = (AbstractSerDe) ReflectionUtils.newInstance(valueTableDesc.getSerDeClass(), null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTcwMQ=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE2ODg0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicValueRegistryTez.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozMjo0NFrOIE6_kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyNDo0MlrOIGN5dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTc2Mg==", "bodyText": "Please call this serDe.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542031762", "createdAt": "2020-12-13T23:32:44Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicValueRegistryTez.java", "diffHunk": "@@ -104,8 +105,8 @@ public void init(RegistryConf conf) throws Exception {\n       RuntimeValuesInfo runtimeValuesInfo = rct.baseWork.getInputSourceToRuntimeValuesInfo().get(inputSourceName);\n \n       // Setup deserializer/obj inspectors for the incoming data source\n-      Deserializer deserializer = ReflectionUtils.newInstance(runtimeValuesInfo.getTableDesc().getDeserializerClass(), null);\n-      deserializer.initialize(rct.conf, runtimeValuesInfo.getTableDesc().getProperties());\n+      AbstractSerDe deserializer = ReflectionUtils.newInstance(runtimeValuesInfo.getTableDesc().getSerDeClass(), null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5MDA3MQ==", "bodyText": "Resolved.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543390071", "createdAt": "2020-12-15T14:24:42Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicValueRegistryTez.java", "diffHunk": "@@ -104,8 +105,8 @@ public void init(RegistryConf conf) throws Exception {\n       RuntimeValuesInfo runtimeValuesInfo = rct.baseWork.getInputSourceToRuntimeValuesInfo().get(inputSourceName);\n \n       // Setup deserializer/obj inspectors for the incoming data source\n-      Deserializer deserializer = ReflectionUtils.newInstance(runtimeValuesInfo.getTableDesc().getDeserializerClass(), null);\n-      deserializer.initialize(rct.conf, runtimeValuesInfo.getTableDesc().getProperties());\n+      AbstractSerDe deserializer = ReflectionUtils.newInstance(runtimeValuesInfo.getTableDesc().getSerDeClass(), null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMTc2Mg=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE3MzI0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozNjowNFrOIE7Bmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyODoyMFrOIGOGZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjI4Mw==", "bodyText": "Please call this inputValueSerDe.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542032283", "createdAt": "2020-12-13T23:36:04Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "diffHunk": "@@ -154,10 +157,11 @@ public void init(JobConf job, OutputCollector output, Reporter reporter) throws\n       for (int tag = 0; tag < gWork.getTagToValueDesc().size(); tag++) {\n         // We should initialize the SerDe with the TypeInfo when available.\n         valueTableDesc[tag] = gWork.getTagToValueDesc().get(tag);\n-        inputValueDeserializer[tag] = ReflectionUtils.newInstance(\n-            valueTableDesc[tag].getDeserializerClass(), null);\n-        SerDeUtils.initializeSerDe(inputValueDeserializer[tag], null,\n-            valueTableDesc[tag].getProperties(), null);\n+\n+        AbstractSerDe sd = ReflectionUtils.newInstance(valueTableDesc[tag].getSerDeClass(), null);\n+        sd.initialize(null, valueTableDesc[tag].getProperties(), null);\n+\n+        inputValueDeserializer[tag] = sd;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5MzM4MA==", "bodyText": "Done", "url": "https://github.com/apache/hive/pull/1634#discussion_r543393380", "createdAt": "2020-12-15T14:28:20Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "diffHunk": "@@ -154,10 +157,11 @@ public void init(JobConf job, OutputCollector output, Reporter reporter) throws\n       for (int tag = 0; tag < gWork.getTagToValueDesc().size(); tag++) {\n         // We should initialize the SerDe with the TypeInfo when available.\n         valueTableDesc[tag] = gWork.getTagToValueDesc().get(tag);\n-        inputValueDeserializer[tag] = ReflectionUtils.newInstance(\n-            valueTableDesc[tag].getDeserializerClass(), null);\n-        SerDeUtils.initializeSerDe(inputValueDeserializer[tag], null,\n-            valueTableDesc[tag].getProperties(), null);\n+\n+        AbstractSerDe sd = ReflectionUtils.newInstance(valueTableDesc[tag].getSerDeClass(), null);\n+        sd.initialize(null, valueTableDesc[tag].getProperties(), null);\n+\n+        inputValueDeserializer[tag] = sd;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjI4Mw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE3NjE0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozNzo1M1rOIE7C9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyNjo0MlrOIGOAuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjYyOA==", "bodyText": "Please call this inputKeySerDe. Also no need to create a variable called serde for an interim time.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542032628", "createdAt": "2020-12-13T23:37:53Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "diffHunk": "@@ -132,10 +133,12 @@ public void init(JobConf job, OutputCollector output, Reporter reporter) throws\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-        .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n-      keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n+      AbstractSerDe serde = ReflectionUtils.newInstance(keyTableDesc\n+        .getSerDeClass(), null);\n+      serde.initialize(null, keyTableDesc.getProperties(), null);\n+      keyObjectInspector = serde.getObjectInspector();\n+\n+      inputKeyDeserializer = serde;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5MTkzMQ==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543391931", "createdAt": "2020-12-15T14:26:42Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkReduceRecordHandler.java", "diffHunk": "@@ -132,10 +133,12 @@ public void init(JobConf job, OutputCollector output, Reporter reporter) throws\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-        .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n-      keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n+      AbstractSerDe serde = ReflectionUtils.newInstance(keyTableDesc\n+        .getSerDeClass(), null);\n+      serde.initialize(null, keyTableDesc.getProperties(), null);\n+      keyObjectInspector = serde.getObjectInspector();\n+\n+      inputKeyDeserializer = serde;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjYyOA=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE3NzYyOnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozOTowMVrOIE7Dpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDozMjo0N1rOIGOU-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjgwNw==", "bodyText": "Please call this inputKeySerDe, also no need for the interim serde variable.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542032807", "createdAt": "2020-12-13T23:39:01Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "diffHunk": "@@ -100,20 +101,19 @@ public void configure(JobConf job) {\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n+      AbstractSerDe serDe = ReflectionUtils.newInstance(keyTableDesc\n+          .getSerDeClass(), null);\n+      serDe.initialize(null, keyTableDesc.getProperties(), null);\n+      inputKeyDeserializer = serDe;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5NzExMg==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543397112", "createdAt": "2020-12-15T14:32:47Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "diffHunk": "@@ -100,20 +101,19 @@ public void configure(JobConf job) {\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n+      AbstractSerDe serDe = ReflectionUtils.newInstance(keyTableDesc\n+          .getSerDeClass(), null);\n+      serDe.initialize(null, keyTableDesc.getProperties(), null);\n+      inputKeyDeserializer = serDe;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjgwNw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE3Nzk0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzozOToxNlrOIE7Dyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyODo1OVrOIGOIPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjg0Mw==", "bodyText": "Please call this valueObjectSerDe", "url": "https://github.com/apache/hive/pull/1634#discussion_r542032843", "createdAt": "2020-12-13T23:39:16Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "diffHunk": "@@ -100,20 +101,19 @@ public void configure(JobConf job) {\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n+      AbstractSerDe serDe = ReflectionUtils.newInstance(keyTableDesc\n+          .getSerDeClass(), null);\n+      serDe.initialize(null, keyTableDesc.getProperties(), null);\n+      inputKeyDeserializer = serDe;\n       keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n       valueTableDesc = new TableDesc[gWork.getTagToValueDesc().size()];\n       for (int tag = 0; tag < gWork.getTagToValueDesc().size(); tag++) {\n         // We should initialize the SerDe with the TypeInfo when available.\n         valueTableDesc[tag] = gWork.getTagToValueDesc().get(tag);\n-        inputValueDeserializer[tag] = ReflectionUtils.newInstance(\n-            valueTableDesc[tag].getDeserializerClass(), null);\n-        SerDeUtils.initializeSerDe(inputValueDeserializer[tag], null,\n-                                   valueTableDesc[tag].getProperties(), null);\n-        valueObjectInspector[tag] = inputValueDeserializer[tag]\n-            .getObjectInspector();\n+        AbstractSerDe sd = ReflectionUtils.newInstance(valueTableDesc[tag].getSerDeClass(), null);\n+        sd.initialize(null, valueTableDesc[tag].getProperties(), null);\n+        inputValueDeserializer[tag] = sd;\n+        valueObjectInspector[tag] = inputValueDeserializer[tag].getObjectInspector();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5Mzg1NA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543393854", "createdAt": "2020-12-15T14:28:59Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java", "diffHunk": "@@ -100,20 +101,19 @@ public void configure(JobConf job) {\n     isTagged = gWork.getNeedsTagging();\n     try {\n       keyTableDesc = gWork.getKeyDesc();\n-      inputKeyDeserializer = ReflectionUtils.newInstance(keyTableDesc\n-          .getDeserializerClass(), null);\n-      SerDeUtils.initializeSerDe(inputKeyDeserializer, null, keyTableDesc.getProperties(), null);\n+      AbstractSerDe serDe = ReflectionUtils.newInstance(keyTableDesc\n+          .getSerDeClass(), null);\n+      serDe.initialize(null, keyTableDesc.getProperties(), null);\n+      inputKeyDeserializer = serDe;\n       keyObjectInspector = inputKeyDeserializer.getObjectInspector();\n       valueTableDesc = new TableDesc[gWork.getTagToValueDesc().size()];\n       for (int tag = 0; tag < gWork.getTagToValueDesc().size(); tag++) {\n         // We should initialize the SerDe with the TypeInfo when available.\n         valueTableDesc[tag] = gWork.getTagToValueDesc().get(tag);\n-        inputValueDeserializer[tag] = ReflectionUtils.newInstance(\n-            valueTableDesc[tag].getDeserializerClass(), null);\n-        SerDeUtils.initializeSerDe(inputValueDeserializer[tag], null,\n-                                   valueTableDesc[tag].getProperties(), null);\n-        valueObjectInspector[tag] = inputValueDeserializer[tag]\n-            .getObjectInspector();\n+        AbstractSerDe sd = ReflectionUtils.newInstance(valueTableDesc[tag].getSerDeClass(), null);\n+        sd.initialize(null, valueTableDesc[tag].getProperties(), null);\n+        inputValueDeserializer[tag] = sd;\n+        valueObjectInspector[tag] = inputValueDeserializer[tag].getObjectInspector();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMjg0Mw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE3OTQzOnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0MDoxMVrOIE7EeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoyOTo0M1rOIGOKlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzAxNw==", "bodyText": "Nit: outputSerDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033017", "createdAt": "2020-12-13T23:40:11Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "diffHunk": "@@ -273,15 +273,14 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     try {\n       this.hconf = hconf;\n \n-      scriptOutputDeserializer = conf.getScriptOutputInfo()\n-          .getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(scriptOutputDeserializer, hconf,\n-                                 conf.getScriptOutputInfo().getProperties(), null);\n+      AbstractSerDe outputSerde = conf.getScriptOutputInfo().getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5NDQ1NQ==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543394455", "createdAt": "2020-12-15T14:29:43Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "diffHunk": "@@ -273,15 +273,14 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     try {\n       this.hconf = hconf;\n \n-      scriptOutputDeserializer = conf.getScriptOutputInfo()\n-          .getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(scriptOutputDeserializer, hconf,\n-                                 conf.getScriptOutputInfo().getProperties(), null);\n+      AbstractSerDe outputSerde = conf.getScriptOutputInfo().getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzAxNw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4MDE0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0MDo0MFrOIE7Exg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDozMTowNlrOIGOPZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzA5NA==", "bodyText": "Nit: inputSerDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033094", "createdAt": "2020-12-13T23:40:40Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "diffHunk": "@@ -273,15 +273,14 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     try {\n       this.hconf = hconf;\n \n-      scriptOutputDeserializer = conf.getScriptOutputInfo()\n-          .getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(scriptOutputDeserializer, hconf,\n-                                 conf.getScriptOutputInfo().getProperties(), null);\n+      AbstractSerDe outputSerde = conf.getScriptOutputInfo().getSerDeClass().newInstance();\n+      outputSerde.initialize(hconf, conf.getScriptOutputInfo().getProperties(), null);\n \n-      scriptInputSerializer = (Serializer) conf.getScriptInputInfo()\n-          .getDeserializerClass().newInstance();\n-      scriptInputSerializer.initialize(hconf, conf.getScriptInputInfo()\n-          .getProperties());\n+      AbstractSerDe inputSerde = conf.getScriptInputInfo().getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5NTY4NQ==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543395685", "createdAt": "2020-12-15T14:31:06Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java", "diffHunk": "@@ -273,15 +273,14 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     try {\n       this.hconf = hconf;\n \n-      scriptOutputDeserializer = conf.getScriptOutputInfo()\n-          .getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(scriptOutputDeserializer, hconf,\n-                                 conf.getScriptOutputInfo().getProperties(), null);\n+      AbstractSerDe outputSerde = conf.getScriptOutputInfo().getSerDeClass().newInstance();\n+      outputSerde.initialize(hconf, conf.getScriptOutputInfo().getProperties(), null);\n \n-      scriptInputSerializer = (Serializer) conf.getScriptInputInfo()\n-          .getDeserializerClass().newInstance();\n-      scriptInputSerializer.initialize(hconf, conf.getScriptInputInfo()\n-          .getProperties());\n+      AbstractSerDe inputSerde = conf.getScriptInputInfo().getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzA5NA=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4MTg5OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0MTo0NlrOIE7Fkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDozMToxNFrOIGOP2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzI5OA==", "bodyText": "Nit: AbstractSerDe serDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033298", "createdAt": "2020-12-13T23:41:46Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java", "diffHunk": "@@ -407,7 +407,7 @@ public void initEmptyInputChildren(List<Operator<?>> children, Configuration hco\n       StructObjectInspector soi = null;\n       PartitionDesc partDesc = conf.getAliasToPartnInfo().get(tsOp.getConf().getAlias());\n       Configuration newConf = tableNameToConf.get(partDesc.getTableDesc().getTableName());\n-      Deserializer serde = partDesc.getTableDesc().getDeserializer();\n+      Deserializer serde = partDesc.getTableDesc().getSerDe();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM5NTgwMw==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543395803", "createdAt": "2020-12-15T14:31:14Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java", "diffHunk": "@@ -407,7 +407,7 @@ public void initEmptyInputChildren(List<Operator<?>> children, Configuration hco\n       StructObjectInspector soi = null;\n       PartitionDesc partDesc = conf.getAliasToPartnInfo().get(tsOp.getConf().getAlias());\n       Configuration newConf = tableNameToConf.get(partDesc.getTableDesc().getTableName());\n-      Deserializer serde = partDesc.getTableDesc().getDeserializer();\n+      Deserializer serde = partDesc.getTableDesc().getSerDe();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzI5OA=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4MjMxOnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0MjowM1rOIE7Fxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxMzoxOFrOIGNB_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzM1MA==", "bodyText": "Please call this keySerDe", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033350", "createdAt": "2020-12-13T23:42:03Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java", "diffHunk": "@@ -352,8 +351,8 @@ public void generateMapMetaData() throws HiveException {\n     try {\n       TableDesc keyTableDesc = conf.getKeyTblDesc();\n       AbstractSerDe keySerializer = (AbstractSerDe) ReflectionUtil.newInstance(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3NTg3MA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543375870", "createdAt": "2020-12-15T14:13:18Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java", "diffHunk": "@@ -352,8 +351,8 @@ public void generateMapMetaData() throws HiveException {\n     try {\n       TableDesc keyTableDesc = conf.getKeyTblDesc();\n       AbstractSerDe keySerializer = (AbstractSerDe) ReflectionUtil.newInstance(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzM1MA=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4MzI5OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0MjozMlrOIE7GNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxMzo1N1rOIGNFJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzQ2Mg==", "bodyText": "Nit: please call this keySerDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033462", "createdAt": "2020-12-13T23:42:32Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java", "diffHunk": "@@ -179,18 +178,18 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     }\n     try {\n       TableDesc keyTableDesc = conf.getKeyTblDesc();\n-      AbstractSerDe keySerde = (AbstractSerDe) ReflectionUtils.newInstance(keyTableDesc.getDeserializerClass(),\n+      AbstractSerDe keySerde = (AbstractSerDe) ReflectionUtils.newInstance(keyTableDesc.getSerDeClass(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3NjY3OA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543376678", "createdAt": "2020-12-15T14:13:57Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java", "diffHunk": "@@ -179,18 +178,18 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     }\n     try {\n       TableDesc keyTableDesc = conf.getKeyTblDesc();\n-      AbstractSerDe keySerde = (AbstractSerDe) ReflectionUtils.newInstance(keyTableDesc.getDeserializerClass(),\n+      AbstractSerDe keySerde = (AbstractSerDe) ReflectionUtils.newInstance(keyTableDesc.getSerDeClass(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzQ2Mg=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4Mzk0OnYy", "diffSide": "RIGHT", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0Mjo0OVrOIE7Gfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxNTowNlrOIGNK0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzUzNQ==", "bodyText": "Nit: please call this serDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033535", "createdAt": "2020-12-13T23:42:49Z", "author": {"login": "miklosgergely"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java", "diffHunk": "@@ -45,8 +44,8 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     super.initializeOp(hconf);\n     TableDesc tbl = this.getConf().getTbl();\n     try {\n-      Deserializer serde = tbl.getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(serde, hconf, tbl.getProperties(), null);\n+      AbstractSerDe serde = tbl.getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3ODEyOA==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543378128", "createdAt": "2020-12-15T14:15:06Z", "author": {"login": "belugabehr"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java", "diffHunk": "@@ -45,8 +44,8 @@ protected void initializeOp(Configuration hconf) throws HiveException {\n     super.initializeOp(hconf);\n     TableDesc tbl = this.getConf().getTbl();\n     try {\n-      Deserializer serde = tbl.getDeserializerClass().newInstance();\n-      SerDeUtils.initializeSerDe(serde, hconf, tbl.getProperties(), null);\n+      AbstractSerDe serde = tbl.getSerDeClass().newInstance();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzUzNQ=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTE4NjE4OnYy", "diffSide": "RIGHT", "path": "hcatalog/core/src/main/java/org/apache/hive/hcatalog/mapreduce/InternalUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo0NDoyNVrOIE7HlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxNDozNVrOIGNIKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzgxMw==", "bodyText": "Nit: please call this serDe for consistency.", "url": "https://github.com/apache/hive/pull/1634#discussion_r542033813", "createdAt": "2020-12-13T23:44:25Z", "author": {"login": "miklosgergely"}, "path": "hcatalog/core/src/main/java/org/apache/hive/hcatalog/mapreduce/InternalUtil.java", "diffHunk": "@@ -143,18 +142,16 @@ private static ObjectInspector getObjectInspector(TypeInfo type) throws IOExcept\n   //TODO this has to find a better home, it's also hardcoded as default in hive would be nice\n   // if the default was decided by the serde\n   static void initializeOutputSerDe(AbstractSerDe serDe, Configuration conf, OutputJobInfo jobInfo)\n-    throws SerDeException {\n-    SerDeUtils.initializeSerDe(serDe, conf,\n-                               getSerdeProperties(jobInfo.getTableInfo(),\n-                                                  jobInfo.getOutputSchema()),\n-                               null);\n+      throws SerDeException {\n+    serDe.initialize(conf, getSerdeProperties(jobInfo.getTableInfo(), jobInfo.getOutputSchema()), null);\n   }\n \n   static void initializeDeserializer(Deserializer deserializer, Configuration conf,\n                      HCatTableInfo info, HCatSchema schema) throws SerDeException {\n     Properties props = getSerdeProperties(info, schema);\n     LOG.info(\"Initializing \" + deserializer.getClass().getName() + \" with properties \" + props);\n-    SerDeUtils.initializeSerDe(deserializer, conf, props, null);\n+    AbstractSerDe serde = (AbstractSerDe)deserializer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3NzQ0OQ==", "bodyText": "Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543377449", "createdAt": "2020-12-15T14:14:35Z", "author": {"login": "belugabehr"}, "path": "hcatalog/core/src/main/java/org/apache/hive/hcatalog/mapreduce/InternalUtil.java", "diffHunk": "@@ -143,18 +142,16 @@ private static ObjectInspector getObjectInspector(TypeInfo type) throws IOExcept\n   //TODO this has to find a better home, it's also hardcoded as default in hive would be nice\n   // if the default was decided by the serde\n   static void initializeOutputSerDe(AbstractSerDe serDe, Configuration conf, OutputJobInfo jobInfo)\n-    throws SerDeException {\n-    SerDeUtils.initializeSerDe(serDe, conf,\n-                               getSerdeProperties(jobInfo.getTableInfo(),\n-                                                  jobInfo.getOutputSchema()),\n-                               null);\n+      throws SerDeException {\n+    serDe.initialize(conf, getSerdeProperties(jobInfo.getTableInfo(), jobInfo.getOutputSchema()), null);\n   }\n \n   static void initializeDeserializer(Deserializer deserializer, Configuration conf,\n                      HCatTableInfo info, HCatSchema schema) throws SerDeException {\n     Properties props = getSerdeProperties(info, schema);\n     LOG.info(\"Initializing \" + deserializer.getClass().getName() + \" with properties \" + props);\n-    SerDeUtils.initializeSerDe(deserializer, conf, props, null);\n+    AbstractSerDe serde = (AbstractSerDe)deserializer;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzMzgxMw=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNTIwNzczOnYy", "diffSide": "RIGHT", "path": "serde/src/java/org/apache/hadoop/hive/serde2/SerDe.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QyMzo1ODozMFrOIE7ROg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNDoxNjoxMFrOIGNQWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzNjI4Mg==", "bodyText": "Modify comment to \"(de)serializing\"", "url": "https://github.com/apache/hive/pull/1634#discussion_r542036282", "createdAt": "2020-12-13T23:58:30Z", "author": {"login": "miklosgergely"}, "path": "serde/src/java/org/apache/hadoop/hive/serde2/SerDe.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hive.serde2;\n+\n+/**\n+ * A Hive Serializer/Deserializer.\n+ */\n+public interface SerDe {\n+\n+  /**\n+   * Returns statistics collected when serializing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM3OTU0Ng==", "bodyText": "Thanks. Done.", "url": "https://github.com/apache/hive/pull/1634#discussion_r543379546", "createdAt": "2020-12-15T14:16:10Z", "author": {"login": "belugabehr"}, "path": "serde/src/java/org/apache/hadoop/hive/serde2/SerDe.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hive.serde2;\n+\n+/**\n+ * A Hive Serializer/Deserializer.\n+ */\n+public interface SerDe {\n+\n+  /**\n+   * Returns statistics collected when serializing", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjAzNjI4Mg=="}, "originalCommit": {"oid": "b3d1d6b73c535f089cad3bd4878a68242550aede"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 215, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}