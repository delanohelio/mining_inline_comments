{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NjI0NDI5", "number": 1541, "title": "HIVE-21375 initial commit", "bodyText": "", "createdAt": "2020-09-30T16:12:57Z", "url": "https://github.com/apache/hive/pull/1541", "merged": true, "mergeCommit": {"oid": "26be5e8bd21d066fb9e90c8936c4b79a058ec0ec"}, "closed": true, "closedAt": "2020-10-02T08:19:43Z", "author": {"login": "szlta"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdN_Hy1gH2gAyNDk1NjI0NDI5OmQ5MWFmZWE3NGQ1OTcxYTc0YjNlODkyZTU4NTk0MDlkMmU0Zjk0ZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOhdq5gBqjM4MzI4NTc2NDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8", "author": {"user": {"login": "szlta", "name": "Adam Szita"}}, "url": "https://github.com/apache/hive/commit/d91afea74d5971a74b3e892e5859409d2e4f94d8", "committedDate": "2020-09-30T16:10:47Z", "message": "HIVE-21375 initial commit\n\nChange-Id: I8676cd99ca36ddd4ddc66194b6e4223cefd2c003"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjE3OTE5", "url": "https://github.com/apache/hive/pull/1541#pullrequestreview-499617919", "createdAt": "2020-09-30T16:37:14Z", "commit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjozNzoxNVrOHamIVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjozNzoxNVrOHamIVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY0OTc0OQ==", "bodyText": "nit: indent", "url": "https://github.com/apache/hive/pull/1541#discussion_r497649749", "createdAt": "2020-09-30T16:37:15Z", "author": {"login": "pvary"}, "path": "hcatalog/streaming/src/java/org/apache/hive/hcatalog/streaming/HiveEndPoint.java", "diffHunk": "@@ -394,10 +404,12 @@ public Void run() throws Exception {\n                 return null;\n               }\n             });\n-        try {\n-          FileSystem.closeAllForUGI(ugi);\n-        } catch (IOException exception) {\n-          LOG.error(\"Could not clean up file-system handles for UGI: \" + ugi, exception);\n+        if (decRefForUgi(ugi) == 0) {\n+          try {\n+              FileSystem.closeAllForUGI(ugi);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjE5MDk0", "url": "https://github.com/apache/hive/pull/1541#pullrequestreview-499619094", "createdAt": "2020-09-30T16:38:38Z", "commit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjozODozOFrOHamL4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjozODozOFrOHamL4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY1MDY1Ng==", "bodyText": "How can this be null?", "url": "https://github.com/apache/hive/pull/1541#discussion_r497650656", "createdAt": "2020-09-30T16:38:38Z", "author": {"login": "pvary"}, "path": "hcatalog/streaming/src/java/org/apache/hive/hcatalog/streaming/HiveEndPoint.java", "diffHunk": "@@ -1107,4 +1114,37 @@ private static void setHiveConf(HiveConf conf, HiveConf.ConfVars var, boolean va\n     conf.setBoolVar(var, value);\n   }\n \n+  private static void incRefForUgi(UserGroupInformation ugi) {\n+    refCountLock.lock();\n+    try {\n+      Long prevCount = ugiConnectionRefCount.putIfAbsent(ugi, 1L);\n+      if (prevCount != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjIxMTcx", "url": "https://github.com/apache/hive/pull/1541#pullrequestreview-499621171", "createdAt": "2020-09-30T16:41:20Z", "commit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9492b40035128253b1fe393677e61002552204bf", "author": {"user": {"login": "sunchao", "name": "Chao Sun"}}, "url": "https://github.com/apache/hive/commit/9492b40035128253b1fe393677e61002552204bf", "committedDate": "2020-10-01T09:53:10Z", "message": "HIVE-24035: Add Jenkinsfile for branch-2.3 (#1398)\n\n(cherry picked from commit 940ee46d3a7a9300a47e5beae7c3ca6eb32fd759)\n\nChange-Id: I5d7bc5b63f87dd3c9ed4cfa547d93b2c2dd64c1a"}, "afterCommit": {"oid": "d91afea74d5971a74b3e892e5859409d2e4f94d8", "author": {"user": {"login": "szlta", "name": "Adam Szita"}}, "url": "https://github.com/apache/hive/commit/d91afea74d5971a74b3e892e5859409d2e4f94d8", "committedDate": "2020-09-30T16:10:47Z", "message": "HIVE-21375 initial commit\n\nChange-Id: I8676cd99ca36ddd4ddc66194b6e4223cefd2c003"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3123, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}