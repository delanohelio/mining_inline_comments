{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MzM3MTA4", "number": 1808, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo1MTowMVrOFITDWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo1MToyM1rOFITDwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MjQ1MDgwOnYy", "diffSide": "RIGHT", "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo1MTowMVrOIKI2Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMToyMzoxMVrOIKJlGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTYzOA==", "bodyText": "Even the dbName can be same across multiple tests, which can get cleaned up. Would it be a good idea to use the current timestamp or generate a random number and prepend that to dbName and use that for the temporary directory ?", "url": "https://github.com/apache/hive/pull/1808#discussion_r547501638", "createdAt": "2020-12-22T20:51:01Z", "author": {"login": "kishendas"}, "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -82,9 +84,9 @@ public void setUp() throws Exception {\n     HiveMetaStore.HMSHandler.createDefaultCatalog(rawStore, new Warehouse(conf));\n   }\n \n-  private Database createTestDb(String dbName, String dbOwner) {\n+  private Database createTestDb(String dbName, String dbOwner) throws IOException {\n     String dbDescription = dbName;\n-    String dbLocation = \"file:/tmp\";\n+    String dbLocation = Files.createTempDirectory(dbName).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxMzYyNA==", "bodyText": "yeah, the Files.createTempDirectory creates a temp directory by appending the timestamp. DbName is just used as a prefix for the directory name.", "url": "https://github.com/apache/hive/pull/1808#discussion_r547513624", "createdAt": "2020-12-22T21:23:11Z", "author": {"login": "vihangk1"}, "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -82,9 +84,9 @@ public void setUp() throws Exception {\n     HiveMetaStore.HMSHandler.createDefaultCatalog(rawStore, new Warehouse(conf));\n   }\n \n-  private Database createTestDb(String dbName, String dbOwner) {\n+  private Database createTestDb(String dbName, String dbOwner) throws IOException {\n     String dbDescription = dbName;\n-    String dbLocation = \"file:/tmp\";\n+    String dbLocation = Files.createTempDirectory(dbName).toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTYzOA=="}, "originalCommit": {"oid": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MjQ1MTg0OnYy", "diffSide": "RIGHT", "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo1MToyM1rOIKI25g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMToyNDozN1rOIKJnLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTc5OA==", "bodyText": "Even the dbName and tblName can be same across multiple tests, which can get cleaned up. Would it be a good idea to use the current timestamp or generate a random number and prepend that to dbName and use that for the temporary directory ?", "url": "https://github.com/apache/hive/pull/1808#discussion_r547501798", "createdAt": "2020-12-22T20:51:23Z", "author": {"login": "kishendas"}, "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -94,8 +96,9 @@ private Database createTestDb(String dbName, String dbOwner) {\n   }\n \n   private Table createTestTblParam(String dbName, String tblName, String tblOwner,\n-                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams) {\n-    String serdeLocation = \"file:/tmp\";\n+                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams)\n+      throws IOException {\n+    String serdeLocation = Files.createTempDirectory(dbName + \"_\" + tblName).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUxNDE1Ng==", "bodyText": "same comment as above. Based on the documentation of Files.createTempDirectory it returns \"the path to the newly created directory that did not exist before this method was invoked\"", "url": "https://github.com/apache/hive/pull/1808#discussion_r547514156", "createdAt": "2020-12-22T21:24:37Z", "author": {"login": "vihangk1"}, "path": "itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/cache/TestCachedStoreUpdateUsingEvents.java", "diffHunk": "@@ -94,8 +96,9 @@ private Database createTestDb(String dbName, String dbOwner) {\n   }\n \n   private Table createTestTblParam(String dbName, String tblName, String tblOwner,\n-                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams) {\n-    String serdeLocation = \"file:/tmp\";\n+                              List<FieldSchema> cols, List<FieldSchema> ptnCols, Map<String, String> tblParams)\n+      throws IOException {\n+    String serdeLocation = Files.createTempDirectory(dbName + \"_\" + tblName).toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwMTc5OA=="}, "originalCommit": {"oid": "942c6ea777e04ed2c6c9a74741f5dafefd75f7d1"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 192, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}