{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4NDMwMjg1", "number": 1063, "title": "HIVE-23617: Fixing storage-api FindBug issues", "bodyText": "Change-Id: I077246ec60b59ba6c65fd86e416040a6fab7d12c", "createdAt": "2020-06-05T12:51:23Z", "url": "https://github.com/apache/hive/pull/1063", "merged": true, "mergeCommit": {"oid": "3419dafd9159f5f2dd2333dd6e816480992954b6"}, "closed": true, "closedAt": "2020-06-12T09:47:29Z", "author": {"login": "pgaref"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoVuAxgFqTQyNTQ3MTUwNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqS4DWgBqjM0MzU1MDQ2MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NDcxNTA2", "url": "https://github.com/apache/hive/pull/1063#pullrequestreview-425471506", "createdAt": "2020-06-05T17:01:18Z", "commit": {"oid": "ed084759cc57675eaecc774ffbd5633099a2771e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNzowMToxOFrOGf2Qwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNzowMToxOFrOGf2Qwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjA0ODA2Ng==", "bodyText": "Isn't there a SuppressFBWarnings annotation in findbugs package? Why do we need to introduce our own annotation?", "url": "https://github.com/apache/hive/pull/1063#discussion_r436048066", "createdAt": "2020-06-05T17:01:18Z", "author": {"login": "mustafaiman"}, "path": "storage-api/src/java/org/apache/hive/common/util/SuppressFBWarnings.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package org.apache.hive.common.util;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+\n+@Retention(RetentionPolicy.CLASS)\n+public @interface SuppressFBWarnings {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed084759cc57675eaecc774ffbd5633099a2771e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NTE3NjU2", "url": "https://github.com/apache/hive/pull/1063#pullrequestreview-425517656", "createdAt": "2020-06-05T18:06:37Z", "commit": {"oid": "ed084759cc57675eaecc774ffbd5633099a2771e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NTYyNzA5", "url": "https://github.com/apache/hive/pull/1063#pullrequestreview-425562709", "createdAt": "2020-06-05T19:20:24Z", "commit": {"oid": "ed084759cc57675eaecc774ffbd5633099a2771e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxOToyMDoyNVrOGf6iQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxOToyMDoyNVrOGf6iQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjExODA4MQ==", "bodyText": "I think it's a little bit more than this.  There shouldn't be any \"+\" concatenation.  Should all be .append()\nI already proposed to addressed this issue (HIVE-23540), but happy to defer to this PR\nhttps://issues.apache.org/jira/browse/HIVE-23540", "url": "https://github.com/apache/hive/pull/1063#discussion_r436118081", "createdAt": "2020-06-05T19:20:25Z", "author": {"login": "belugabehr"}, "path": "storage-api/src/java/org/apache/hadoop/hive/common/io/encoded/EncodedColumnBatch.java", "diffHunk": "@@ -78,13 +78,13 @@ public void setIndexBaseOffset(int indexBaseOffset) {\n \n     @Override\n     public String toString() {\n-      String bufStr = \"\";\n+      StringBuffer bufStr = new StringBuffer();\n       if (cacheBuffers != null) {\n         for (MemoryBuffer mb : cacheBuffers) {\n-          bufStr += mb.getClass().getSimpleName() + \" with \" + mb.getByteBufferRaw().remaining() + \" bytes, \";\n+          bufStr.append(mb.getClass().getSimpleName() + \" with \" + mb.getByteBufferRaw().remaining() + \" bytes, \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed084759cc57675eaecc774ffbd5633099a2771e"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NTg5MTIz", "url": "https://github.com/apache/hive/pull/1063#pullrequestreview-425589123", "createdAt": "2020-06-05T19:57:48Z", "commit": {"oid": "36a933bb1e5eda6b73bcfe73b8302eb3956ac1e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxOTo1Nzo0OFrOGf7qhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxOTo1Nzo0OFrOGf7qhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEzNjU4MQ==", "bodyText": "Will have to check this.  I think from my own patch experience, that this change might break a bunch of unit tests because they are checking the output of toString() which previously always adds a comma, even if it's not really needed.  I'm not 100%, but just FYI.", "url": "https://github.com/apache/hive/pull/1063#discussion_r436136581", "createdAt": "2020-06-05T19:57:48Z", "author": {"login": "belugabehr"}, "path": "storage-api/src/java/org/apache/hadoop/hive/common/io/encoded/EncodedColumnBatch.java", "diffHunk": "@@ -78,13 +79,21 @@ public void setIndexBaseOffset(int indexBaseOffset) {\n \n     @Override\n     public String toString() {\n-      String bufStr = \"\";\n+      StringBuilder sb = new StringBuilder();\n       if (cacheBuffers != null) {\n-        for (MemoryBuffer mb : cacheBuffers) {\n-          bufStr += mb.getClass().getSimpleName() + \" with \" + mb.getByteBufferRaw().remaining() + \" bytes, \";\n+        Iterator<MemoryBuffer> iter = cacheBuffers.iterator();\n+        while (iter.hasNext()) {\n+          MemoryBuffer mb = iter.next();\n+          sb.append(mb.getClass().getSimpleName());\n+          sb.append(\" with \");\n+          sb.append(mb.getByteBufferRaw().remaining());\n+          sb.append(\" bytes\");\n+          if (iter.hasNext()) {\n+            sb.append(\", \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a933bb1e5eda6b73bcfe73b8302eb3956ac1e8"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTIyNzQ4", "url": "https://github.com/apache/hive/pull/1063#pullrequestreview-426122748", "createdAt": "2020-06-08T11:02:15Z", "commit": {"oid": "36a933bb1e5eda6b73bcfe73b8302eb3956ac1e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMTowMjoxNVrOGgY54Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMTowMjoxNVrOGgY54Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYxNTY0OQ==", "bodyText": "this equals doesn't care about next/prev fields", "url": "https://github.com/apache/hive/pull/1063#discussion_r436615649", "createdAt": "2020-06-08T11:02:15Z", "author": {"login": "kgyrtkirk"}, "path": "storage-api/src/java/org/apache/hadoop/hive/common/io/DiskRangeList.java", "diffHunk": "@@ -228,6 +228,16 @@ public long getTotalLength() {\n     return result;\n   }\n \n+  @Override\n+  public int hashCode() {\n+    return super.hashCode();\n+  }\n+\n+  @Override\n+  public boolean equals(Object other) {\n+    return super.equals(other);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a933bb1e5eda6b73bcfe73b8302eb3956ac1e8"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed7ffa709d8c844fc15e6661c91aad214d47f64f", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/ed7ffa709d8c844fc15e6661c91aad214d47f64f", "committedDate": "2020-06-11T18:44:56Z", "message": "Cleaning storage-api FindBug issues\n\nChange-Id: I077246ec60b59ba6c65fd86e416040a6fab7d12c"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90f25f7e4c5558613ada71f5932fbc9eccfa770e", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/90f25f7e4c5558613ada71f5932fbc9eccfa770e", "committedDate": "2020-06-11T18:44:56Z", "message": "Up HiveIntervalDayTime\n\nChange-Id: Idbd68bd39ca0f9f57f507679da461667b985f016"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bcfcc34c2ea1215a58f697f1c547619e80c2d15", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/6bcfcc34c2ea1215a58f697f1c547619e80c2d15", "committedDate": "2020-06-11T18:44:57Z", "message": "Addressing comment regarding HIVE-23540\n\nChange-Id: I9814b6d5eea37e1c055b58b70f81d522b4def687"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba037554a83d2ef8e6417216349351cc6c650bfd", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/ba037554a83d2ef8e6417216349351cc6c650bfd", "committedDate": "2020-06-11T18:44:57Z", "message": "Addressing equals/hashcode comment to take into account class field (next, prev).\nLets make sure we update such methods across hive packages.\n\nChange-Id: I6be369010f581ab08d2b9d574b5495e754e132ee"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2fea99781094ccb6f31b8fe2a3f17d0952794dc", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/d2fea99781094ccb6f31b8fe2a3f17d0952794dc", "committedDate": "2020-06-11T18:44:57Z", "message": "Fix DiskRangeList equals/hashcode. This class provides just a simplistic iterator interface (check javadoc).\nThus, for equality/hashcode just check the actual DiskRange (super) content.\n\nChange-Id: I49f9cf0a632a485075a438d838765232167d0e41"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e925bc94e2a3d1217cb6011041ac745c456cd99", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/6e925bc94e2a3d1217cb6011041ac745c456cd99", "committedDate": "2020-06-11T18:49:03Z", "message": "Adding storage-api to Precheck findbugProjects\n\nChange-Id: I0cd289cc06f86b8d8e9c3ac66cad38c1854043a1"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad30c7fba07497147e0e02740bd1e6af4f62df28", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/ad30c7fba07497147e0e02740bd1e6af4f62df28", "committedDate": "2020-06-08T19:10:56Z", "message": "Fix DiskRangeList equals/hashcode. This class provides just a simplistic iterator interface (check javadoc).\nThus, for equality/hashcode just check the actual DiskRange (super) content.\n\nChange-Id: I49f9cf0a632a485075a438d838765232167d0e41"}, "afterCommit": {"oid": "6e925bc94e2a3d1217cb6011041ac745c456cd99", "author": {"user": {"login": "pgaref", "name": "Panagiotis Garefalakis"}}, "url": "https://github.com/apache/hive/commit/6e925bc94e2a3d1217cb6011041ac745c456cd99", "committedDate": "2020-06-11T18:49:03Z", "message": "Adding storage-api to Precheck findbugProjects\n\nChange-Id: I0cd289cc06f86b8d8e9c3ac66cad38c1854043a1"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3803, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}