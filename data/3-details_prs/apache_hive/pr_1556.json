{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NDExNjA4", "number": 1556, "title": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly", "bodyText": "Change-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911\nWhat changes were proposed in this pull request?\nUsing an object cache, LimitOperator/VectorLimitOperator/TezProcessor can exit quickly if a limit is already reached.\nWhy are the changes needed?\nPerformance benefit.\nDoes this PR introduce any user-facing change?\nNo.\nHow was this patch tested?\nTested on cluster.", "createdAt": "2020-10-06T09:50:04Z", "url": "https://github.com/apache/hive/pull/1556", "merged": true, "mergeCommit": {"oid": "00fb0ef0dd1af6afc30ecc3a9fd23e2b5e84382f"}, "closed": true, "closedAt": "2020-12-11T07:48:48Z", "author": {"login": "abstractdog"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP1UxCgBqjM4NDQ1MjQxMzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkx2SMgFqTU0OTExMzkxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e81edb80bcebf27eba534d3fdbd55d60e22fb85", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/2e81edb80bcebf27eba534d3fdbd55d60e22fb85", "committedDate": "2020-10-06T09:19:35Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "857601d696d3692e735f81d285910d31ff06c195", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/857601d696d3692e735f81d285910d31ff06c195", "committedDate": "2020-10-06T09:53:35Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "857601d696d3692e735f81d285910d31ff06c195", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/857601d696d3692e735f81d285910d31ff06c195", "committedDate": "2020-10-06T09:53:35Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "45b1ea298efe61e9de2a7b3086387b5a6c25e71b", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/45b1ea298efe61e9de2a7b3086387b5a6c25e71b", "committedDate": "2020-10-08T15:28:59Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45b1ea298efe61e9de2a7b3086387b5a6c25e71b", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/45b1ea298efe61e9de2a7b3086387b5a6c25e71b", "committedDate": "2020-10-08T15:28:59Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "f4d6864e9183fecf4b24f2d951cfe572b7d23737", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/f4d6864e9183fecf4b24f2d951cfe572b7d23737", "committedDate": "2020-10-12T11:11:50Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4d6864e9183fecf4b24f2d951cfe572b7d23737", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/f4d6864e9183fecf4b24f2d951cfe572b7d23737", "committedDate": "2020-10-12T11:11:50Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "75a741124b80f4787c7819d1f79ecdb96cfa684e", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/75a741124b80f4787c7819d1f79ecdb96cfa684e", "committedDate": "2020-10-14T08:28:37Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "75a741124b80f4787c7819d1f79ecdb96cfa684e", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/75a741124b80f4787c7819d1f79ecdb96cfa684e", "committedDate": "2020-10-14T08:28:37Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "b8e0f9256227165db2b0f6208af80e3362c75e3f", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/b8e0f9256227165db2b0f6208af80e3362c75e3f", "committedDate": "2020-10-28T22:31:08Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8e0f9256227165db2b0f6208af80e3362c75e3f", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/b8e0f9256227165db2b0f6208af80e3362c75e3f", "committedDate": "2020-10-28T22:31:08Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "a6253b8c08ed326811fb3135e584ba6c227ff96d", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/a6253b8c08ed326811fb3135e584ba6c227ff96d", "committedDate": "2020-10-29T06:42:56Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a6253b8c08ed326811fb3135e584ba6c227ff96d", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/a6253b8c08ed326811fb3135e584ba6c227ff96d", "committedDate": "2020-10-29T06:42:56Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "76ed4e64fb90c152bd14164bb01b3d654fa3256c", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/76ed4e64fb90c152bd14164bb01b3d654fa3256c", "committedDate": "2020-10-30T11:59:52Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "76ed4e64fb90c152bd14164bb01b3d654fa3256c", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/76ed4e64fb90c152bd14164bb01b3d654fa3256c", "committedDate": "2020-10-30T11:59:52Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "bc964fe9add5cfe986c8bfabbf6a384549ac5274", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/bc964fe9add5cfe986c8bfabbf6a384549ac5274", "committedDate": "2020-12-02T08:32:00Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc964fe9add5cfe986c8bfabbf6a384549ac5274", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/bc964fe9add5cfe986c8bfabbf6a384549ac5274", "committedDate": "2020-12-02T08:32:00Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "2c0c58512528d61fa863b5c232e7fac61ffccfb5", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/2c0c58512528d61fa863b5c232e7fac61ffccfb5", "committedDate": "2020-12-04T08:53:02Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c0c58512528d61fa863b5c232e7fac61ffccfb5", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/2c0c58512528d61fa863b5c232e7fac61ffccfb5", "committedDate": "2020-12-04T08:53:02Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "bade21136ecc07d5a6bbcc253e933c24691a278e", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/bade21136ecc07d5a6bbcc253e933c24691a278e", "committedDate": "2020-12-07T09:31:57Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bade21136ecc07d5a6bbcc253e933c24691a278e", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/bade21136ecc07d5a6bbcc253e933c24691a278e", "committedDate": "2020-12-07T09:31:57Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/a43064fc9f668b39385f048f5649384803fe7b5b", "committedDate": "2020-12-08T10:40:43Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MDI3NjYw", "url": "https://github.com/apache/hive/pull/1556#pullrequestreview-548027660", "createdAt": "2020-12-09T10:11:40Z", "commit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMDoxMTo0MFrOICMuWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMDoxMTo0MFrOICMuWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE3NjUzNg==", "bodyText": "Any reason for changing this?", "url": "https://github.com/apache/hive/pull/1556#discussion_r539176536", "createdAt": "2020-12-09T10:11:40Z", "author": {"login": "rbalamohan"}, "path": "ql/src/test/queries/clientpositive/authorization_view_1.q", "diffHunk": "@@ -1,5 +1,6 @@\n --! qt:dataset:src\n set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.DefaultHiveAuthorizationProvider;\n+set hive.exec.reducers.max=1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NzkzMDIy", "url": "https://github.com/apache/hive/pull/1556#pullrequestreview-548793022", "createdAt": "2020-12-10T03:31:07Z", "commit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMzozMTowN1rOICz5rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMzozNjozNVrOIC0BUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgxODQxNA==", "bodyText": "remove this?", "url": "https://github.com/apache/hive/pull/1556#discussion_r539818414", "createdAt": "2020-12-10T03:31:07Z", "author": {"login": "rbalamohan"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/LimitOperator.java", "diffHunk": "@@ -19,11 +19,18 @@\n package org.apache.hadoop.hive.ql.exec;\n \n import java.io.Serializable;\n+import java.util.concurrent.Callable;\n+import java.util.concurrent.atomic.AtomicBoolean;\n+import java.util.concurrent.atomic.AtomicInteger;\n \n import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hive.conf.HiveConf;\n import org.apache.hadoop.hive.ql.CompilationOpContext;\n+import org.apache.hadoop.hive.ql.exec.tez.DagUtils;\n+import org.apache.hadoop.hive.ql.exec.tez.LlapObjectCache;\n import org.apache.hadoop.hive.ql.metadata.HiveException;\n import org.apache.hadoop.hive.ql.plan.LimitDesc;\n+import org.apache.hadoop.hive.ql.plan.OperatorDesc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMDM3MA==", "bodyText": "Move this in TezProcessor itself? It is not DAG specific and is needed mainly for logging purposes. Having it within TezProcessor will make it easier to read and not confuse anyone trying to walk through DagUtils.", "url": "https://github.com/apache/hive/pull/1556#discussion_r539820370", "createdAt": "2020-12-10T03:36:35Z", "author": {"login": "rbalamohan"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java", "diffHunk": "@@ -1811,4 +1819,11 @@ static long parseRightmostXmx(String javaOpts) {\n     }\n     return allNonAppFileResources;\n   }\n+\n+  public static void initTezAttributes(Configuration conf, ProcessorContext context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25f8f8aec4b03003eb2dc4ac8e305d72e2a973a2", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/25f8f8aec4b03003eb2dc4ac8e305d72e2a973a2", "committedDate": "2020-12-10T11:11:01Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a43064fc9f668b39385f048f5649384803fe7b5b", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/a43064fc9f668b39385f048f5649384803fe7b5b", "committedDate": "2020-12-08T10:40:43Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}, "afterCommit": {"oid": "25f8f8aec4b03003eb2dc4ac8e305d72e2a973a2", "author": {"user": {"login": "abstractdog", "name": "Bodor Laszlo"}}, "url": "https://github.com/apache/hive/commit/25f8f8aec4b03003eb2dc4ac8e305d72e2a973a2", "committedDate": "2020-12-10T11:11:01Z", "message": "HIVE-24207: LimitOperator can leverage ObjectCache to bail out quickly\n\nChange-Id: I12d2719acdf80ffa3a5c14b1c3fce2d4cbe00911"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MTEzOTE5", "url": "https://github.com/apache/hive/pull/1556#pullrequestreview-549113919", "createdAt": "2020-12-10T11:43:09Z", "commit": {"oid": "25f8f8aec4b03003eb2dc4ac8e305d72e2a973a2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3143, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}