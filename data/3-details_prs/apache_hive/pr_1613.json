{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNjY1MDYz", "number": 1613, "title": "HIVE-24314: compactor.Cleaner should not set state mark cleaned if it didn't remove any files", "bodyText": "What changes were proposed in this pull request?\nIf the Cleaner didn't remove any files, don't mark the compaction queue entry as \"succeeded\" but instead leave it in \"ready for cleaning\" state for later cleaning. If it removed at least one, then the compaction queue entry as \"succeeded\".", "createdAt": "2020-10-27T11:03:43Z", "url": "https://github.com/apache/hive/pull/1613", "merged": true, "mergeCommit": {"oid": "96aacdc50043fa442c2277b7629812e69241a507"}, "closed": true, "closedAt": "2020-11-03T09:19:30Z", "author": {"login": "klcopp"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXOa25AFqTUxOTQ1NjkyNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYmBSagBqjM5NDg1ODMwMTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDU2OTI0", "url": "https://github.com/apache/hive/pull/1613#pullrequestreview-519456924", "createdAt": "2020-10-29T09:05:30Z", "commit": {"oid": "57615ae80154e618edd3c5802d13597654fc2cb7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwOTowNTozMFrOHqSVeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwOTowNTozMFrOHqSVeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEwMjY0OA==", "bodyText": "You can use org.apache.hive.common.util.Ref for this", "url": "https://github.com/apache/hive/pull/1613#discussion_r514102648", "createdAt": "2020-10-29T09:05:30Z", "author": {"login": "pvargacl"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/Cleaner.java", "diffHunk": "@@ -201,16 +201,17 @@ private void clean(CompactionInfo ci, long minOpenTxnGLB) throws MetaException {\n         LOG.debug(\"Cleaning based on writeIdList: \" + validWriteIdList);\n       }\n \n+      final boolean[] removedFiles = new boolean[1];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57615ae80154e618edd3c5802d13597654fc2cb7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NTI3Njgz", "url": "https://github.com/apache/hive/pull/1613#pullrequestreview-519527683", "createdAt": "2020-10-29T10:31:04Z", "commit": {"oid": "c52ece070474bb8e0c587f4ba6949caec8d7fa97"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "681c37ea2fa8c4fd9135c7b94294499521400b80", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/681c37ea2fa8c4fd9135c7b94294499521400b80", "committedDate": "2020-11-02T15:08:55Z", "message": "HIVE-24314: compactor.Cleaner should not set state mark cleaned if it didn't remove any files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3c2309cccf6e77e4a4d209d4e15d3fd3ba598b5", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/b3c2309cccf6e77e4a4d209d4e15d3fd3ba598b5", "committedDate": "2020-11-02T15:08:55Z", "message": "Addressed review comments, ignored tests that will be fixed in #1618"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca37ae3fd8fbfc6f67521b03dd050c5f4eb7dfc5", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/ca37ae3fd8fbfc6f67521b03dd050c5f4eb7dfc5", "committedDate": "2020-11-02T15:08:55Z", "message": "Additional logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c1ce0b9f071aad4f1ed70a82c6c0270b48fc0ec", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/3c1ce0b9f071aad4f1ed70a82c6c0270b48fc0ec", "committedDate": "2020-11-02T15:08:55Z", "message": "Ignored wrong test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "462f3e356721c54495ded96d2728a6aa0a1b3e98", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/462f3e356721c54495ded96d2728a6aa0a1b3e98", "committedDate": "2020-10-29T17:41:09Z", "message": "Ignored wrong test"}, "afterCommit": {"oid": "3c1ce0b9f071aad4f1ed70a82c6c0270b48fc0ec", "author": {"user": null}, "url": "https://github.com/apache/hive/commit/3c1ce0b9f071aad4f1ed70a82c6c0270b48fc0ec", "committedDate": "2020-11-02T15:08:55Z", "message": "Ignored wrong test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2969, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}