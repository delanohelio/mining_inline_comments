{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NjQwOTEx", "number": 1601, "title": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote", "bodyText": "", "createdAt": "2020-10-23T01:18:06Z", "url": "https://github.com/apache/hive/pull/1601", "merged": true, "mergeCommit": {"oid": "90ae3c894722363ffce26c7f189e2accefdfec9a"}, "closed": true, "closedAt": "2020-11-06T07:07:37Z", "author": {"login": "nareshpr"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVReCBABqjM5MTI1MDk5Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZGWOhgBqjM5NTU3OTk2MzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3efba4d6903a0fa4cdb532cea610d86eaba8381", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/c3efba4d6903a0fa4cdb532cea610d86eaba8381", "committedDate": "2020-10-23T01:17:27Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "dd636fa93d4744f67bcc9a3c68b1c94ecd7d2805", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/dd636fa93d4744f67bcc9a3c68b1c94ecd7d2805", "committedDate": "2020-10-23T07:29:54Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd636fa93d4744f67bcc9a3c68b1c94ecd7d2805", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/dd636fa93d4744f67bcc9a3c68b1c94ecd7d2805", "committedDate": "2020-10-23T07:29:54Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/7ab8c06af65279b66b89f90d2a9903a02ee50e12", "committedDate": "2020-10-23T18:25:07Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4Mzg0MDk3", "url": "https://github.com/apache/hive/pull/1601#pullrequestreview-518384097", "createdAt": "2020-10-28T07:32:59Z", "commit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozNDowMFrOHpdF2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozODo1NFrOHpdORQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMDI5OQ==", "bodyText": "Nit: Instead of using a try-catch block, you could use StringUtils.isNumeric() to determine if a string is a positive decimal number.", "url": "https://github.com/apache/hive/pull/1601#discussion_r513230299", "createdAt": "2020-10-28T07:34:00Z", "author": {"login": "lcspinter"}, "path": "serde/src/java/org/apache/hadoop/hive/serde2/avro/SchemaToTypeInfo.java", "diffHunk": "@@ -186,6 +188,20 @@ public static TypeInfo generateTypeInfo(Schema schema,\n     return typeInfoCache.retrieve(schema, seenSchemas);\n   }\n \n+  private static int getIntValue(JsonNode jsonNode) {\n+    int value = 0;\n+    if (jsonNode instanceof TextNode) {\n+      try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMjQ1Mw==", "bodyText": "What happens if the precision or scale numbers are negative? Could you please add some q tests to cover that scenario as well?", "url": "https://github.com/apache/hive/pull/1601#discussion_r513232453", "createdAt": "2020-10-28T07:38:54Z", "author": {"login": "lcspinter"}, "path": "ql/src/test/queries/clientnegative/avro_decimal.q", "diffHunk": "@@ -12,6 +12,6 @@ OUTPUTFORMAT\n   'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'\n TBLPROPERTIES (\n   'numFiles'='1',\n-  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"5\",\\\"scale\\\":\"2\"}}]}'\n+  'avro.schema.literal'='{\\\"namespace\\\":\\\"com.howdy\\\",\\\"name\\\":\\\"some_schema\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"value\\\",\\\"type\\\":{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":\"a\",\\\"scale\\\":\"b\"}}]}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ab8c06af65279b66b89f90d2a9903a02ee50e12", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/7ab8c06af65279b66b89f90d2a9903a02ee50e12", "committedDate": "2020-10-23T18:25:07Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "00464bcf6f5b76c1248d9096354819921cf778c6", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/00464bcf6f5b76c1248d9096354819921cf778c6", "committedDate": "2020-10-30T05:57:32Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00464bcf6f5b76c1248d9096354819921cf778c6", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/00464bcf6f5b76c1248d9096354819921cf778c6", "committedDate": "2020-10-30T05:57:32Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "446fcda02f8294b385d4041bcf61c69c31e5a789", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/446fcda02f8294b385d4041bcf61c69c31e5a789", "committedDate": "2020-11-01T05:56:10Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "446fcda02f8294b385d4041bcf61c69c31e5a789", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/446fcda02f8294b385d4041bcf61c69c31e5a789", "committedDate": "2020-11-01T05:56:10Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "2cb83b8abc440ac9b93445691e94804a259e5c6f", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/2cb83b8abc440ac9b93445691e94804a259e5c6f", "committedDate": "2020-11-02T04:43:04Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2cb83b8abc440ac9b93445691e94804a259e5c6f", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/2cb83b8abc440ac9b93445691e94804a259e5c6f", "committedDate": "2020-11-02T04:43:04Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "dfaca95b9b22177f78b0888fcae80e4fa80d1c8a", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/dfaca95b9b22177f78b0888fcae80e4fa80d1c8a", "committedDate": "2020-11-02T18:43:55Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxOTU0NTIy", "url": "https://github.com/apache/hive/pull/1601#pullrequestreview-521954522", "createdAt": "2020-11-02T20:04:22Z", "commit": {"oid": "dfaca95b9b22177f78b0888fcae80e4fa80d1c8a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dfaca95b9b22177f78b0888fcae80e4fa80d1c8a", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/dfaca95b9b22177f78b0888fcae80e4fa80d1c8a", "committedDate": "2020-11-02T18:43:55Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "51255ec90320a576f597f4912ce6d39412111fd1", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/51255ec90320a576f597f4912ce6d39412111fd1", "committedDate": "2020-11-03T04:39:33Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfe8a0f793821f26e61b8494eb244c6aca3a9d66", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/cfe8a0f793821f26e61b8494eb244c6aca3a9d66", "committedDate": "2020-11-04T04:26:18Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51255ec90320a576f597f4912ce6d39412111fd1", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/51255ec90320a576f597f4912ce6d39412111fd1", "committedDate": "2020-11-03T04:39:33Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}, "afterCommit": {"oid": "cfe8a0f793821f26e61b8494eb244c6aca3a9d66", "author": {"user": {"login": "nareshpr", "name": "Naresh P R"}}, "url": "https://github.com/apache/hive/commit/cfe8a0f793821f26e61b8494eb244c6aca3a9d66", "committedDate": "2020-11-04T04:26:18Z", "message": "HIVE-24305: avro decimal schema is not properly populating scale/precision if value is enclosed in quote"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3211, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}