{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTk5ODAx", "number": 1244, "title": "HIVE-23837: Configure StorageHandlers if FileSinkOperator is child of MergeJoinWork", "bodyText": "", "createdAt": "2020-07-13T11:38:56Z", "url": "https://github.com/apache/hive/pull/1244", "merged": true, "mergeCommit": {"oid": "8719afaec7f30fa7bb4c9c1fea974f8228ea1e03"}, "closed": true, "closedAt": "2020-07-17T07:36:33Z", "author": {"login": "pvargacl"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0f3jmgH2gAyNDQ4MTk5ODAxOjU5NTZhNjg2YjAwZjA0NmMyZDI2NjY1ZjIyNjIwYjE4Y2UyMjM5OGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1eDaigFqTQ0OTc4MTg4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b", "author": {"user": {"login": "pvargacl", "name": "Peter Varga"}}, "url": "https://github.com/apache/hive/commit/5956a686b00f046c2d26665f22620b18ce22398b", "committedDate": "2020-07-13T11:37:53Z", "message": "HIVE-23837: Configure StorageHandlers if FileSinkOperator is child of MergeJoinWork"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzQzNzQ0", "url": "https://github.com/apache/hive/pull/1244#pullrequestreview-449743744", "createdAt": "2020-07-16T11:04:33Z", "commit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNDozM1rOGymDRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNDozM1rOGymDRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTQxMw==", "bodyText": "could we use forEach here?", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705413", "createdAt": "2020-07-16T11:04:33Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzQ0MDU0", "url": "https://github.com/apache/hive/pull/1244#pullrequestreview-449744054", "createdAt": "2020-07-16T11:05:05Z", "commit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNTowNVrOGymEQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMTowNTowNVrOGymEQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTY2Ng==", "bodyText": "same", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705666", "createdAt": "2020-07-16T11:05:05Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {\n+      for (FileSinkOperator fs : OperatorUtils.findOperators(rootOp, FileSinkOperator.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzUxODAx", "url": "https://github.com/apache/hive/pull/1244#pullrequestreview-449751801", "createdAt": "2020-07-16T11:17:33Z", "commit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMToxNzozM1rOGymbiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMToxNzozM1rOGymbiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcxMTYyNQ==", "bodyText": "I think, it can be extracted to base. In MapWork and ReduceWork , for example, you can do same, at least for FileSinkOperator - iterate over getAllRootOperators() and call configureJobConf", "url": "https://github.com/apache/hive/pull/1244#discussion_r455711625", "createdAt": "2020-07-16T11:17:33Z", "author": {"login": "deniskuzZ"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956a686b00f046c2d26665f22620b18ce22398b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f65401e1e45fa18b5a51e77a24b0441bdd769e97", "author": {"user": {"login": "pvargacl", "name": "Peter Varga"}}, "url": "https://github.com/apache/hive/commit/f65401e1e45fa18b5a51e77a24b0441bdd769e97", "committedDate": "2020-07-16T11:48:20Z", "message": "Extract confJobConf to BaseWork"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzgxODg1", "url": "https://github.com/apache/hive/pull/1244#pullrequestreview-449781885", "createdAt": "2020-07-16T12:04:57Z", "commit": {"oid": "f65401e1e45fa18b5a51e77a24b0441bdd769e97"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3531, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}