{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MzgxOTUz", "number": 1166, "title": "HIVE-20890: ACID: Allow whole table ReadLocks to skip all partition l\u2026", "bodyText": "\u2026ocks\nNOTICE\nPlease create an issue in ASF JIRA before opening a pull request,\nand you need to set the title of the pull request which starts with\nthe corresponding JIRA issue number. (e.g. HIVE-XXXXX: Fix a typo in YYY)\nFor more details, please see https://cwiki.apache.org/confluence/display/Hive/HowToContribute", "createdAt": "2020-06-23T07:41:04Z", "url": "https://github.com/apache/hive/pull/1166", "merged": true, "mergeCommit": {"oid": "21cb4ecab478ff7d4b1a6380864178fc97abd6bf"}, "closed": true, "closedAt": "2020-06-24T12:05:23Z", "author": {"login": "deniskuzZ"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuAd5LgH2gAyNDM4MzgxOTUzOmY0N2VmYjI1ZDdhOTE1MjU0YTAxYjE1MGE4MzZmNzJhN2Y1NTgzZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuYGhxgFqTQzNjU0Nzg5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6", "author": {"user": {"login": "deniskuzZ", "name": "Denys Kuzmenko"}}, "url": "https://github.com/apache/hive/commit/f47efb25d7a915254a01b150a836f72a7f5583d6", "committedDate": "2020-06-23T07:39:15Z", "message": "HIVE-20890: ACID: Allow whole table ReadLocks to skip all partition locks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDQ1ODQ5", "url": "https://github.com/apache/hive/pull/1166#pullrequestreview-436445849", "createdAt": "2020-06-24T08:45:55Z", "commit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwODo0NTo1NVrOGoIzMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwODo0NTo1NVrOGoIzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc0MDQwMA==", "bodyText": "Is the table.equals will work correctly here, as expected? I have seen another PR where we started to create special equals method for table comparison: #1095 - might be conflicting later", "url": "https://github.com/apache/hive/pull/1166#discussion_r444740400", "createdAt": "2020-06-24T08:45:55Z", "author": {"login": "pvary"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java", "diffHunk": "@@ -2863,6 +2868,9 @@ private static boolean isLockableTable(Table t) {\n \n         case TABLE:\n           t = input.getTable();\n+          if (!fullTableLock.contains(t)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDQ2ODI3", "url": "https://github.com/apache/hive/pull/1166#pullrequestreview-436446827", "createdAt": "2020-06-24T08:47:07Z", "commit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwODo0NzowOFrOGoI2Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwODo0NzowOFrOGoI2Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc0MTE1OQ==", "bodyText": "With using 'continue' we do not execute the code after the case statement. Is this intentional?", "url": "https://github.com/apache/hive/pull/1166#discussion_r444741159", "createdAt": "2020-06-24T08:47:08Z", "author": {"login": "pvary"}, "path": "ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java", "diffHunk": "@@ -2994,12 +3005,13 @@ Seems much cleaner if each stmt is identified as a particular HiveOperation (whi\n         break;\n       case DDL_SHARED:\n         compBuilder.setSharedRead();\n-        if (!output.isTxnAnalyze()) {\n+        if (output.isTxnAnalyze()) {\n           // Analyze needs txn components to be present, otherwise an aborted analyze write ID\n           // might be rolled under the watermark by compactor while stats written by it are\n           // still present.\n-          compBuilder.setOperationType(DataOperationType.NO_TXN);\n+          continue;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NTQ3ODk0", "url": "https://github.com/apache/hive/pull/1166#pullrequestreview-436547894", "createdAt": "2020-06-24T11:11:27Z", "commit": {"oid": "f47efb25d7a915254a01b150a836f72a7f5583d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3694, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}