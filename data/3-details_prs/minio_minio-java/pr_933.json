{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3OTI3MTEw", "number": 933, "title": "add arg builder to {set,get,delete}BucketPolicy APIs", "bodyText": "", "createdAt": "2020-05-14T11:17:13Z", "url": "https://github.com/minio/minio-java/pull/933", "merged": true, "mergeCommit": {"oid": "19b2011521008c18d3064ed66db9ad9ef1be198d"}, "closed": true, "closedAt": "2020-05-28T19:23:39Z", "author": {"login": "balamurugana"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchM9j0gBqjMzMzY0NTQ2MjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclyqa2AFqTQyMDQwNDY1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "42be3d63731b9efda8f2cb3befdf14ff52f04f30", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/42be3d63731b9efda8f2cb3befdf14ff52f04f30", "committedDate": "2020-05-14T12:44:13Z", "message": "add deleteBucketPolicy() API"}, "afterCommit": {"oid": "e5b2b63f5ba4a89259aaf032de6c0799f614dab4", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/e5b2b63f5ba4a89259aaf032de6c0799f614dab4", "committedDate": "2020-05-14T12:51:22Z", "message": "add deleteBucketPolicy() API"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5b2b63f5ba4a89259aaf032de6c0799f614dab4", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/e5b2b63f5ba4a89259aaf032de6c0799f614dab4", "committedDate": "2020-05-14T12:51:22Z", "message": "add deleteBucketPolicy() API"}, "afterCommit": {"oid": "6daad63fbb4f3ea97139372f02a2f63dc487f33a", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/6daad63fbb4f3ea97139372f02a2f63dc487f33a", "committedDate": "2020-05-19T14:37:55Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6daad63fbb4f3ea97139372f02a2f63dc487f33a", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/6daad63fbb4f3ea97139372f02a2f63dc487f33a", "committedDate": "2020-05-19T14:37:55Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "885df55c18c13447684ed881a486a6b764e0912d", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/885df55c18c13447684ed881a486a6b764e0912d", "committedDate": "2020-05-21T10:20:31Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "885df55c18c13447684ed881a486a6b764e0912d", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/885df55c18c13447684ed881a486a6b764e0912d", "committedDate": "2020-05-21T10:20:31Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "86ba11e6350239a66aa0e2741192b1f7d80db660", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/86ba11e6350239a66aa0e2741192b1f7d80db660", "committedDate": "2020-05-21T10:27:23Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86ba11e6350239a66aa0e2741192b1f7d80db660", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/86ba11e6350239a66aa0e2741192b1f7d80db660", "committedDate": "2020-05-21T10:27:23Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "9e830b2415e96c0addedf131378f8f32d5fec5c5", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/9e830b2415e96c0addedf131378f8f32d5fec5c5", "committedDate": "2020-05-22T06:53:20Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e830b2415e96c0addedf131378f8f32d5fec5c5", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/9e830b2415e96c0addedf131378f8f32d5fec5c5", "committedDate": "2020-05-22T06:53:20Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/d27af9b457f32f5094863474d4a1ceaf554da1da", "committedDate": "2020-05-26T09:16:16Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MTE4NDc3", "url": "https://github.com/minio/minio-java/pull/933#pullrequestreview-419118477", "createdAt": "2020-05-27T11:57:09Z", "commit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMTo1NzowOVrOGbF30A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMzoyMzoyOVrOGbJ5uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA2MDk0NA==", "bodyText": "Add @Override annotation to this method", "url": "https://github.com/minio/minio-java/pull/933#discussion_r431060944", "createdAt": "2020-05-27T11:57:09Z", "author": {"login": "anjalshireesh"}, "path": "api/src/main/java/io/minio/SetBucketPolicyArgs.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * MinIO Java SDK for Amazon S3 Compatible Cloud Storage, (C) 2020 MinIO, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.minio;\n+\n+/** Argument class of MinioClient.setBucketPolicy(). */\n+public class SetBucketPolicyArgs extends BucketArgs {\n+  private String config;\n+\n+  public String config() {\n+    return config;\n+  }\n+\n+  public static Builder builder() {\n+    return new Builder();\n+  }\n+\n+  /** Argument builder of {@link SetBucketPolicyArgs}. */\n+  public static final class Builder extends BucketArgs.Builder<Builder, SetBucketPolicyArgs> {\n+    private void validateConfig(String config) {\n+      if (config == null) {\n+        throw new IllegalArgumentException(\"null policy configuration\");\n+      }\n+    }\n+\n+    protected void validate(SetBucketPolicyArgs args) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTExMDU0NA==", "bodyText": "This can be replaced with checkArgs(args); after rebasing with latest master branch", "url": "https://github.com/minio/minio-java/pull/933#discussion_r431110544", "createdAt": "2020-05-27T13:09:47Z", "author": {"login": "anjalshireesh"}, "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -4295,20 +4295,53 @@ public void putObject(\n    * @throws NoSuchAlgorithmException thrown to indicate missing of MD5 or SHA-256 digest library.\n    * @throws XmlParserException thrown to indicate XML parsing error.\n    */\n+  @Deprecated\n   public String getBucketPolicy(String bucketName)\n       throws BucketPolicyTooLargeException, ErrorResponseException, IllegalArgumentException,\n           InsufficientDataException, InternalException, InvalidBucketNameException,\n           InvalidKeyException, InvalidResponseException, IOException, NoSuchAlgorithmException,\n           XmlParserException {\n+    return getBucketPolicy(GetBucketPolicyArgs.builder().bucket(bucketName).build());\n+  }\n+\n+  /**\n+   * Gets bucket policy configuration of a bucket.\n+   *\n+   * <pre>Example:{@code\n+   * String config =\n+   *     minioClient.getBucketPolicy(GetBucketPolicyArgs.builder().bucket(\"my-bucketname\").build());\n+   * }</pre>\n+   *\n+   * @param args {@link GetBucketPolicyArgs} object.\n+   * @return String - Bucket policy configuration as JSON string.\n+   * @throws BucketPolicyTooLargeException thrown to indicate returned bucket policy is too large.\n+   * @throws ErrorResponseException thrown to indicate S3 service returned an error response.\n+   * @throws IllegalArgumentException throws to indicate invalid argument passed.\n+   * @throws InsufficientDataException thrown to indicate not enough data available in InputStream.\n+   * @throws InternalException thrown to indicate internal library error.\n+   * @throws InvalidBucketNameException thrown to indicate invalid bucket name passed.\n+   * @throws InvalidKeyException thrown to indicate missing of HMAC SHA-256 library.\n+   * @throws InvalidResponseException thrown to indicate S3 service returned invalid or no error\n+   *     response.\n+   * @throws IOException thrown to indicate I/O error on S3 operation.\n+   * @throws NoSuchAlgorithmException thrown to indicate missing of MD5 or SHA-256 digest library.\n+   * @throws XmlParserException thrown to indicate XML parsing error.\n+   */\n+  public String getBucketPolicy(GetBucketPolicyArgs args)\n+      throws BucketPolicyTooLargeException, ErrorResponseException, IllegalArgumentException,\n+          InsufficientDataException, InternalException, InvalidBucketNameException,\n+          InvalidKeyException, InvalidResponseException, IOException, NoSuchAlgorithmException,\n+          XmlParserException {\n+    if (args == null) {\n+      throw new IllegalArgumentException(\"null arguments\");\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTExMjQ0Mw==", "bodyText": "Good to add a javadoc comment with @deprecated also providing link to the alternate method to be used", "url": "https://github.com/minio/minio-java/pull/933#discussion_r431112443", "createdAt": "2020-05-27T13:11:18Z", "author": {"login": "anjalshireesh"}, "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -4295,20 +4295,53 @@ public void putObject(\n    * @throws NoSuchAlgorithmException thrown to indicate missing of MD5 or SHA-256 digest library.\n    * @throws XmlParserException thrown to indicate XML parsing error.\n    */\n+  @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTEyNjk2OQ==", "bodyText": "Maybe we should verify that the value returned by getBucketPolicy matches what was set in the previous step?", "url": "https://github.com/minio/minio-java/pull/933#discussion_r431126969", "createdAt": "2020-05-27T13:23:29Z", "author": {"login": "anjalshireesh"}, "path": "functional/FunctionalTest.java", "diffHunk": "@@ -3798,35 +3795,20 @@ public static void getBucketPolicy_test1() throws Exception {\n               + \"\\\"Principal\\\":{\\\"AWS\\\":[\\\"*\\\"]},\\\"Resource\\\":[\\\"arn:aws:s3:::\"\n               + bucketName\n               + \"/myobject*\\\"],\\\"Sid\\\":\\\"\\\"}]}\";\n-      client.setBucketPolicy(bucketName, policy);\n-      client.getBucketPolicy(bucketName);\n-      mintSuccessLog(\"getBucketPolicy(String bucketName)\", null, startTime);\n+      client.setBucketPolicy(\n+          SetBucketPolicyArgs.builder().bucket(bucketName).config(policy).build());\n+      client.getBucketPolicy(GetBucketPolicyArgs.builder().bucket(bucketName).build());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da"}, "originalPosition": 89}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d27af9b457f32f5094863474d4a1ceaf554da1da", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/d27af9b457f32f5094863474d4a1ceaf554da1da", "committedDate": "2020-05-26T09:16:16Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "62a8600ee7728f08c71a8d4c9668332039d1f2cf", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/62a8600ee7728f08c71a8d4c9668332039d1f2cf", "committedDate": "2020-05-27T15:24:48Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "259e09106f15e1ce8007b696e1c2a0253016bb24", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/259e09106f15e1ce8007b696e1c2a0253016bb24", "committedDate": "2020-05-28T04:09:17Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62a8600ee7728f08c71a8d4c9668332039d1f2cf", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/62a8600ee7728f08c71a8d4c9668332039d1f2cf", "committedDate": "2020-05-27T15:24:48Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}, "afterCommit": {"oid": "259e09106f15e1ce8007b696e1c2a0253016bb24", "author": {"user": {"login": "balamurugana", "name": "Bala FA"}}, "url": "https://github.com/minio/minio-java/commit/259e09106f15e1ce8007b696e1c2a0253016bb24", "committedDate": "2020-05-28T04:09:17Z", "message": "add arg builder to {set,get,delete}BucketPolicy APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMDUxOTI3", "url": "https://github.com/minio/minio-java/pull/933#pullrequestreview-420051927", "createdAt": "2020-05-28T12:22:19Z", "commit": {"oid": "259e09106f15e1ce8007b696e1c2a0253016bb24"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDA0NjU3", "url": "https://github.com/minio/minio-java/pull/933#pullrequestreview-420404657", "createdAt": "2020-05-28T19:02:52Z", "commit": {"oid": "259e09106f15e1ce8007b696e1c2a0253016bb24"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1871, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}