{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNzU1MjE0", "number": 953, "title": "Add arg builder to legal hold APIs", "bodyText": "", "createdAt": "2020-05-25T13:34:44Z", "url": "https://github.com/minio/minio-java/pull/953", "merged": true, "mergeCommit": {"oid": "ad41b8f470dda19c510421117fd615121c7b65a1"}, "closed": true, "closedAt": "2020-05-31T01:29:54Z", "author": {"login": "sinhaashish"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABck_3aZAFqTQxODA0Mzc1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmhZR4gFqTQyMTQ1NDUxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDQzNzU5", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-418043759", "createdAt": "2020-05-26T07:40:26Z", "commit": {"oid": "82a4892cde13e29e1af708a6e6eeb1f267f750b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNzo0MDoyNlrOGaSOhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNzo0MDoyNlrOGaSOhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIxNDc4OQ==", "bodyText": "Was the condition && !versionId.isEmpty() removed intentionally? Seems like a useful validation.\nMight be a good idea to add it as a validation (must be non-empty if non-null) in the args builder.", "url": "https://github.com/minio/minio-java/pull/953#discussion_r430214789", "createdAt": "2020-05-26T07:40:26Z", "author": {"login": "anjalshireesh"}, "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -3927,15 +3927,52 @@ public void enableObjectLegalHold(String bucketName, String objectName, String v\n       throws ErrorResponseException, IllegalArgumentException, InsufficientDataException,\n           InternalException, InvalidBucketNameException, InvalidKeyException,\n           InvalidResponseException, IOException, NoSuchAlgorithmException, XmlParserException {\n+    this.enableObjectLegalHold(\n+        EnableObjectLegalHoldArgs.builder()\n+            .bucket(bucketName)\n+            .object(objectName)\n+            .versionId(versionId)\n+            .build());\n+  }\n+\n+  /**\n+   * Enables legal hold on an object.\n+   *\n+   * <pre>Example:{@code\n+   * minioClient.enableObjectLegalHold(\n+   *    EnableObjectLegalHoldArgs.builder()\n+   *        .bucket(\"my-bucketname\")\n+   *        .object(\"my-objectname\")\n+   *        .versionId(\"object-versionId\")\n+   *        .build());\n+   * }</pre>\n+   *\n+   * @param args {@link EnableObjectLegalHoldArgs} object.\n+   * @throws ErrorResponseException thrown to indicate S3 service returned an error response.\n+   * @throws IllegalArgumentException throws to indicate invalid argument passed.\n+   * @throws InsufficientDataException thrown to indicate not enough data available in InputStream.\n+   * @throws InternalException thrown to indicate internal library error.\n+   * @throws InvalidBucketNameException thrown to indicate invalid bucket name passed.\n+   * @throws InvalidKeyException thrown to indicate missing of HMAC SHA-256 library.\n+   * @throws InvalidResponseException thrown to indicate S3 service returned invalid or no error\n+   *     response.\n+   * @throws IOException thrown to indicate I/O error on S3 operation.\n+   * @throws NoSuchAlgorithmException thrown to indicate missing of MD5 or SHA-256 digest library.\n+   * @throws XmlParserException thrown to indicate XML parsing error.\n+   */\n+  public void enableObjectLegalHold(EnableObjectLegalHoldArgs args)\n+      throws ErrorResponseException, IllegalArgumentException, InsufficientDataException,\n+          InternalException, InvalidBucketNameException, InvalidKeyException,\n+          InvalidResponseException, IOException, NoSuchAlgorithmException, XmlParserException {\n     Map<String, String> queryParamMap = new HashMap<>();\n     queryParamMap.put(\"legal-hold\", \"\");\n \n-    if (versionId != null && !versionId.isEmpty()) {\n-      queryParamMap.put(\"versionId\", versionId);\n+    if (args.versionId() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82a4892cde13e29e1af708a6e6eeb1f267f750b8"}, "originalPosition": 46}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82a4892cde13e29e1af708a6e6eeb1f267f750b8", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/82a4892cde13e29e1af708a6e6eeb1f267f750b8", "committedDate": "2020-05-25T13:33:48Z", "message": "add arg builder to legal hold APIs"}, "afterCommit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/78e922f9f94539e347ff4ecb4fa28329932e6245", "committedDate": "2020-05-28T15:42:12Z", "message": "add arg builder to legal hold APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjgxNDYz", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-420281463", "createdAt": "2020-05-28T16:20:46Z", "commit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjoyMDo0NlrOGb87aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjoyNjo1NFrOGb9LQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2Mjk4Nw==", "bodyText": "It supposes to be disabled or not?", "url": "https://github.com/minio/minio-java/pull/953#discussion_r431962987", "createdAt": "2020-05-28T16:20:46Z", "author": {"login": "balamurugana"}, "path": "examples/DisableObjectLegalHold.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * MinIO Java SDK for Amazon S3 Compatible Cloud Storage, (C) 2020 MinIO, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.minio.DisableObjectLegalHoldArgs;\n+import io.minio.IsObjectLegalHoldEnabledArgs;\n+import io.minio.MinioClient;\n+import io.minio.errors.MinioException;\n+import java.io.IOException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+\n+public class DisableObjectLegalHold {\n+  /** MinioClient.disableObjectLegalHold() example. */\n+  public static void main(String[] args)\n+      throws IOException, NoSuchAlgorithmException, InvalidKeyException, IllegalArgumentException {\n+    try {\n+\n+      /* play.min.io for test and development. */\n+      MinioClient minioClient =\n+          new MinioClient(\n+              \"https://play.min.io\",\n+              \"Q3AM3UQ867SPQQA43P2F\",\n+              \"zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG\");\n+\n+      // Disable object legal hold.\n+      minioClient.disableObjectLegalHold(\n+          DisableObjectLegalHoldArgs.builder()\n+              .bucket(\"my-bucketname\")\n+              .object(\"my-objectname\")\n+              .build());\n+\n+      // Check if the object legal hold is enabled or not.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2NTIwMg==", "bodyText": "We supposes to error out if its not disabled?", "url": "https://github.com/minio/minio-java/pull/953#discussion_r431965202", "createdAt": "2020-05-28T16:24:03Z", "author": {"login": "balamurugana"}, "path": "examples/DisableObjectLegalHold.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * MinIO Java SDK for Amazon S3 Compatible Cloud Storage, (C) 2020 MinIO, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.minio.DisableObjectLegalHoldArgs;\n+import io.minio.IsObjectLegalHoldEnabledArgs;\n+import io.minio.MinioClient;\n+import io.minio.errors.MinioException;\n+import java.io.IOException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+\n+public class DisableObjectLegalHold {\n+  /** MinioClient.disableObjectLegalHold() example. */\n+  public static void main(String[] args)\n+      throws IOException, NoSuchAlgorithmException, InvalidKeyException, IllegalArgumentException {\n+    try {\n+\n+      /* play.min.io for test and development. */\n+      MinioClient minioClient =\n+          new MinioClient(\n+              \"https://play.min.io\",\n+              \"Q3AM3UQ867SPQQA43P2F\",\n+              \"zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG\");\n+\n+      // Disable object legal hold.\n+      minioClient.disableObjectLegalHold(\n+          DisableObjectLegalHoldArgs.builder()\n+              .bucket(\"my-bucketname\")\n+              .object(\"my-objectname\")\n+              .build());\n+\n+      // Check if the object legal hold is enabled or not.\n+      System.out.println(\n+          \" Is object legal hold is enabled \"\n+              + minioClient.isObjectLegalHoldEnabled(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2NTg5Mg==", "bodyText": "same as comments in examples/DisableObjectLegalHold.java", "url": "https://github.com/minio/minio-java/pull/953#discussion_r431965892", "createdAt": "2020-05-28T16:25:06Z", "author": {"login": "balamurugana"}, "path": "examples/EnableObjectLegalHold.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * MinIO Java SDK for Amazon S3 Compatible Cloud Storage, (C) 2020 MinIO, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.minio.EnableObjectLegalHoldArgs;\n+import io.minio.IsObjectLegalHoldEnabledArgs;\n+import io.minio.MinioClient;\n+import io.minio.errors.MinioException;\n+import java.io.IOException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+\n+public class EnableObjectLegalHold {\n+  /** MinioClient.enableObjectLegalHold() example. */\n+  public static void main(String[] args)\n+      throws IOException, NoSuchAlgorithmException, InvalidKeyException, IllegalArgumentException {\n+    try {\n+\n+      /* play.min.io for test and development. */\n+      MinioClient minioClient =\n+          new MinioClient(\n+              \"https://play.min.io\",\n+              \"Q3AM3UQ867SPQQA43P2F\",\n+              \"zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG\");\n+\n+      // Enable object legal hold.\n+      minioClient.enableObjectLegalHold(\n+          EnableObjectLegalHoldArgs.builder()\n+              .bucket(\"my-bucketname\")\n+              .object(\"my-objectname\")\n+              .versionId(\"object-versionId\")\n+              .build());\n+\n+      // Check if the object legal hold is enabled or not.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2NzA0MA==", "bodyText": "You would need to use handleException() in all modifed tests.", "url": "https://github.com/minio/minio-java/pull/953#discussion_r431967040", "createdAt": "2020-05-28T16:26:54Z", "author": {"login": "balamurugana"}, "path": "functional/FunctionalTest.java", "diffHunk": "@@ -3588,15 +3590,15 @@ public static void enableObjectLegalHold_test() throws Exception {\n           client.putObject(bucketName, objectName, is, new PutObjectOptions(1 * KB, -1));\n         }\n \n-        client.enableObjectLegalHold(bucketName, objectName, null);\n-        if (!client.isObjectLegalHoldEnabled(bucketName, objectName, null)) {\n+        client.enableObjectLegalHold(\n+            EnableObjectLegalHoldArgs.builder().bucket(bucketName).object(objectName).build());\n+        if (!client.isObjectLegalHoldEnabled(\n+            IsObjectLegalHoldEnabledArgs.builder().bucket(bucketName).object(objectName).build())) {\n           throw new Exception(\"[FAILED] isObjectLegalHoldEnabled(): expected: true, got: false\");\n         }\n-        client.disableObjectLegalHold(bucketName, objectName, null);\n-        mintSuccessLog(\n-            \"enableObjectLegalHold(String bucketName, String objectName, String versionId)\",\n-            null,\n-            startTime);\n+        client.disableObjectLegalHold(\n+            DisableObjectLegalHoldArgs.builder().bucket(bucketName).object(objectName).build());\n+        mintSuccessLog(\"enableObjectLegalHold(EnableObjectLegalHoldArgs args)\", null, startTime);\n       } finally {\n         client.removeObject(\n             RemoveObjectArgs.builder().bucket(bucketName).object(objectName).build());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e922f9f94539e347ff4ecb4fa28329932e6245"}, "originalPosition": 54}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "821da42ed726d3a9474e5b3f27d9dc7a6d91f8de", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/821da42ed726d3a9474e5b3f27d9dc7a6d91f8de", "committedDate": "2020-05-28T19:27:55Z", "message": "Address bala's comment"}, "afterCommit": {"oid": "7745bfa773312237d6343039c6a67777449f3b01", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/7745bfa773312237d6343039c6a67777449f3b01", "committedDate": "2020-05-28T19:30:38Z", "message": "Address bala's comment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7745bfa773312237d6343039c6a67777449f3b01", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/7745bfa773312237d6343039c6a67777449f3b01", "committedDate": "2020-05-28T19:30:38Z", "message": "Address bala's comment"}, "afterCommit": {"oid": "305c1f331515a5c0c35aaf7fb292766c5211b0b2", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/305c1f331515a5c0c35aaf7fb292766c5211b0b2", "committedDate": "2020-05-29T12:22:02Z", "message": "Address bala's comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwOTM5NTY3", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-420939567", "createdAt": "2020-05-29T13:15:37Z", "commit": {"oid": "305c1f331515a5c0c35aaf7fb292766c5211b0b2"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxMzoxNTozOFrOGccJwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxMzoxNTozOFrOGccJwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ3NDU2MQ==", "bodyText": "It'll be good to add the deprecation javadoc comment also along with a link to the new method to be used", "url": "https://github.com/minio/minio-java/pull/953#discussion_r432474561", "createdAt": "2020-05-29T13:15:38Z", "author": {"login": "anjalshireesh"}, "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -4211,18 +4289,66 @@ public void disableObjectLegalHold(String bucketName, String objectName, String\n    * @throws NoSuchAlgorithmException thrown to indicate missing of MD5 or SHA-256 digest library.\n    * @throws XmlParserException thrown to indicate XML parsing error.\n    */\n+  @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305c1f331515a5c0c35aaf7fb292766c5211b0b2"}, "originalPosition": 130}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzc2MTU4", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-421376158", "createdAt": "2020-05-30T04:12:34Z", "commit": {"oid": "7bb87770d1134657033b650ba03067c4580c1b62"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzc2MzQ3", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-421376347", "createdAt": "2020-05-30T04:15:59Z", "commit": {"oid": "7bb87770d1134657033b650ba03067c4580c1b62"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "441f55db607a2d8ae3436a266e6e2759d012f1d8", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/441f55db607a2d8ae3436a266e6e2759d012f1d8", "committedDate": "2020-05-30T20:41:59Z", "message": "add arg builder to legal hold APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe692c75eed9929cf39c0d62bf2c3ac13b66aca5", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/fe692c75eed9929cf39c0d62bf2c3ac13b66aca5", "committedDate": "2020-05-30T20:41:59Z", "message": "Address bala's comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ee54f4b5e33eb946b69c00e8f5a6c3af7ed69a8", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/7ee54f4b5e33eb946b69c00e8f5a6c3af7ed69a8", "committedDate": "2020-05-30T20:41:59Z", "message": "add comment for deprecation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45ab0950d938a2325062fd2c04fe852651255c37", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/45ab0950d938a2325062fd2c04fe852651255c37", "committedDate": "2020-05-30T20:43:58Z", "message": "Add example for isObjectLegalHoldEnabled"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7bb87770d1134657033b650ba03067c4580c1b62", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/7bb87770d1134657033b650ba03067c4580c1b62", "committedDate": "2020-05-29T14:49:01Z", "message": "Add example for isObjectLegalHoldEnabled"}, "afterCommit": {"oid": "45ab0950d938a2325062fd2c04fe852651255c37", "author": {"user": {"login": "sinhaashish", "name": "Ashish Kumar Sinha"}}, "url": "https://github.com/minio/minio-java/commit/45ab0950d938a2325062fd2c04fe852651255c37", "committedDate": "2020-05-30T20:43:58Z", "message": "Add example for isObjectLegalHoldEnabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDU0NTEz", "url": "https://github.com/minio/minio-java/pull/953#pullrequestreview-421454513", "createdAt": "2020-05-31T01:29:41Z", "commit": {"oid": "45ab0950d938a2325062fd2c04fe852651255c37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1901, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}