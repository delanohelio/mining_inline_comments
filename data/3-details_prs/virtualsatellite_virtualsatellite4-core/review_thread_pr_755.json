{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NDM1MDg5", "number": 755, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTowNzo1NFrOEqyUPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjowOTo0MlrOEq0UEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzAwMDMxOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.graphiti.ui/src/de/dlr/sc/virsat/graphiti/ui/diagram/feature/VirSatChangeColorFeature.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTowNzo1NFrOHdMONw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzozODozN1rOHeRr4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM3MDk5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate void changeColorGenericPictorgramElement(PictogramElement pe, Color color) {\n          \n          \n            \n            \tprivate void changeColorGenericPictogramElement(PictogramElement pe, Color color) {\n          \n          \n            \n            \n          \n      \n    \n    \n  \n\nGuess this change will require some further refactoring...", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/755#discussion_r500370999", "createdAt": "2020-10-06T15:07:54Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.graphiti.ui/src/de/dlr/sc/virsat/graphiti/ui/diagram/feature/VirSatChangeColorFeature.java", "diffHunk": "@@ -65,22 +69,53 @@ public void execute(ICustomContext context) {\n \t\ts.setLocation(context.getX(), context.getY());\r\n \t\tColorDialog colorDialog = new ColorDialog(s);\r\n \t\tRGB rgbColor = colorDialog.open();\r\n-\t\tif (colorDialog != null && rgbColor != null) {\r\n-\t\t\tIColorConstant color =\r\n+\t\tif (rgbColor != null) {\r\n+\t\t\tIColorConstant colorConstant =\r\n \t\t\t\t\tnew ColorConstant(rgbColor.red, rgbColor.green, rgbColor.blue);\r\n+\t\t\tColor color = manageColor(colorConstant);\r\n \t\t\tPictogramElement[] pes = context.getPictogramElements();\r\n \t\t\tif (pes != null && pes.length == 1) {\r\n \t\t\t\tfor (PictogramElement pe : pes) {\r\n-\t\t\t\t\tGraphicsAlgorithm ga = pe.getGraphicsAlgorithm();\r\n-\t\t\t\t\tga.setBackground(manageColor(color));\r\n-\t\t\t\t\tfor (GraphicsAlgorithm childGa : ga.getGraphicsAlgorithmChildren()) {\r\n-\t\t\t\t\t\tif (childGa instanceof RoundedRectangle || childGa instanceof Rectangle) {\r\n-\t\t\t\t\t\t\tchildGa.setBackground(manageColor(color));\r\n-\t\t\t\t\t\t}\r\n+\t\t\t\t\tif (pe instanceof Connection) {\r\n+\t\t\t\t\t\tchangeColorConnection((Connection) pe, color);\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\tchangeColorGenericPictorgramElement(pe, color);\r\n \t\t\t\t\t}\r\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\t\r\n \t}\r\n+\t\r\n+\t/**\r\n+\t * Changes the color of a generic pictorgram element\r\n+\t * @param pe the pictogram element\r\n+\t * @param color the target color\r\n+\t */\r\n+\tprivate void changeColorGenericPictorgramElement(PictogramElement pe, Color color) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5521da4039d970280638a9a37e5faee72205ee51"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUwOTA4OQ==", "bodyText": "I now also changed it to changeGenericPictogramElementColor to make it fit with the other suggestion.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/755#discussion_r501509089", "createdAt": "2020-10-08T07:38:37Z", "author": {"login": "SaMuellerDLR"}, "path": "de.dlr.sc.virsat.graphiti.ui/src/de/dlr/sc/virsat/graphiti/ui/diagram/feature/VirSatChangeColorFeature.java", "diffHunk": "@@ -65,22 +69,53 @@ public void execute(ICustomContext context) {\n \t\ts.setLocation(context.getX(), context.getY());\r\n \t\tColorDialog colorDialog = new ColorDialog(s);\r\n \t\tRGB rgbColor = colorDialog.open();\r\n-\t\tif (colorDialog != null && rgbColor != null) {\r\n-\t\t\tIColorConstant color =\r\n+\t\tif (rgbColor != null) {\r\n+\t\t\tIColorConstant colorConstant =\r\n \t\t\t\t\tnew ColorConstant(rgbColor.red, rgbColor.green, rgbColor.blue);\r\n+\t\t\tColor color = manageColor(colorConstant);\r\n \t\t\tPictogramElement[] pes = context.getPictogramElements();\r\n \t\t\tif (pes != null && pes.length == 1) {\r\n \t\t\t\tfor (PictogramElement pe : pes) {\r\n-\t\t\t\t\tGraphicsAlgorithm ga = pe.getGraphicsAlgorithm();\r\n-\t\t\t\t\tga.setBackground(manageColor(color));\r\n-\t\t\t\t\tfor (GraphicsAlgorithm childGa : ga.getGraphicsAlgorithmChildren()) {\r\n-\t\t\t\t\t\tif (childGa instanceof RoundedRectangle || childGa instanceof Rectangle) {\r\n-\t\t\t\t\t\t\tchildGa.setBackground(manageColor(color));\r\n-\t\t\t\t\t\t}\r\n+\t\t\t\t\tif (pe instanceof Connection) {\r\n+\t\t\t\t\t\tchangeColorConnection((Connection) pe, color);\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\tchangeColorGenericPictorgramElement(pe, color);\r\n \t\t\t\t\t}\r\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\t\r\n \t}\r\n+\t\r\n+\t/**\r\n+\t * Changes the color of a generic pictorgram element\r\n+\t * @param pe the pictogram element\r\n+\t * @param color the target color\r\n+\t */\r\n+\tprivate void changeColorGenericPictorgramElement(PictogramElement pe, Color color) {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM3MDk5OQ=="}, "originalCommit": {"oid": "5521da4039d970280638a9a37e5faee72205ee51"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzAxMzYwOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.graphiti.ui/src/de/dlr/sc/virsat/graphiti/ui/diagram/feature/VirSatChangeColorFeature.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNToxMDowNVrOHdMWxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNToxMDowNVrOHdMWxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM3MzE4OA==", "bodyText": "Wouldn't changeConnectionColor(...) be more intiutive?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/755#discussion_r500373188", "createdAt": "2020-10-06T15:10:05Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.graphiti.ui/src/de/dlr/sc/virsat/graphiti/ui/diagram/feature/VirSatChangeColorFeature.java", "diffHunk": "@@ -65,22 +69,53 @@ public void execute(ICustomContext context) {\n \t\ts.setLocation(context.getX(), context.getY());\r\n \t\tColorDialog colorDialog = new ColorDialog(s);\r\n \t\tRGB rgbColor = colorDialog.open();\r\n-\t\tif (colorDialog != null && rgbColor != null) {\r\n-\t\t\tIColorConstant color =\r\n+\t\tif (rgbColor != null) {\r\n+\t\t\tIColorConstant colorConstant =\r\n \t\t\t\t\tnew ColorConstant(rgbColor.red, rgbColor.green, rgbColor.blue);\r\n+\t\t\tColor color = manageColor(colorConstant);\r\n \t\t\tPictogramElement[] pes = context.getPictogramElements();\r\n \t\t\tif (pes != null && pes.length == 1) {\r\n \t\t\t\tfor (PictogramElement pe : pes) {\r\n-\t\t\t\t\tGraphicsAlgorithm ga = pe.getGraphicsAlgorithm();\r\n-\t\t\t\t\tga.setBackground(manageColor(color));\r\n-\t\t\t\t\tfor (GraphicsAlgorithm childGa : ga.getGraphicsAlgorithmChildren()) {\r\n-\t\t\t\t\t\tif (childGa instanceof RoundedRectangle || childGa instanceof Rectangle) {\r\n-\t\t\t\t\t\t\tchildGa.setBackground(manageColor(color));\r\n-\t\t\t\t\t\t}\r\n+\t\t\t\t\tif (pe instanceof Connection) {\r\n+\t\t\t\t\t\tchangeColorConnection((Connection) pe, color);\r\n+\t\t\t\t\t} else {\r\n+\t\t\t\t\t\tchangeColorGenericPictorgramElement(pe, color);\r\n \t\t\t\t\t}\r\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\t\r\n \t}\r\n+\t\r\n+\t/**\r\n+\t * Changes the color of a generic pictorgram element\r\n+\t * @param pe the pictogram element\r\n+\t * @param color the target color\r\n+\t */\r\n+\tprivate void changeColorGenericPictorgramElement(PictogramElement pe, Color color) {\r\n+\t\tGraphicsAlgorithm ga = pe.getGraphicsAlgorithm();\r\n+\t\tga.setBackground(color);\r\n+\t\tfor (GraphicsAlgorithm childGa : ga.getGraphicsAlgorithmChildren()) {\r\n+\t\t\tif (childGa instanceof RoundedRectangle || childGa instanceof Rectangle) {\r\n+\t\t\t\tchildGa.setBackground(color);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * Changes the color of a connection\r\n+\t * @param connection the connection\r\n+\t * @param color the target color\r\n+\t */\r\n+\tprivate void changeColorConnection(Connection connection, Color color) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5521da4039d970280638a9a37e5faee72205ee51"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzMyNzU1OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.funcelectrical.ui/src/de/dlr/sc/virsat/model/extension/funcelectrical/ui/diagram/features/InterfaceDiagramFeatureProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjowOTo0MlrOHdPY6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzo0MjoxOFrOHeR0LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyMjg4OA==", "bodyText": "In the previous code we returned super features as a fallback, but now we don't. Does it make any difference?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/755#discussion_r500422888", "createdAt": "2020-10-06T16:09:42Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.funcelectrical.ui/src/de/dlr/sc/virsat/model/extension/funcelectrical/ui/diagram/features/InterfaceDiagramFeatureProvider.java", "diffHunk": "@@ -230,18 +234,22 @@ public IMoveShapeFeature getMoveShapeFeature(IMoveShapeContext context) {\n \t\r\n \t@Override\r\n \tpublic ICustomFeature[] getCustomFeatures(ICustomContext context) {\r\n-\t    \r\n \t    PictogramElement[] pictogramElements = context.getPictogramElements();\r\n \t\tObject object = getBusinessObjectForPictogramElement(pictogramElements[0]);\r\n \t\t\r\n-\t\tif (object instanceof ABeanStructuralElementInstance) {\r\n-\t\t\treturn new ICustomFeature[] {  new VirSatChangeColorFeature(this)};\r\n-\t\t}\r\n+\t\tList<ICustomFeature> customFeatures = new ArrayList<>();\r\n \t\t\r\n \t\tif (object instanceof InterfaceEnd) {\r\n-\t\t\treturn new ICustomFeature[] { new VirsatCategoryAssignmentOpenEditorFeature(this), new InterfaceEndChangeColorFeature(this)};\r\n+\t\t\tcustomFeatures.add(new InterfaceEndChangeColorFeature(this));\r\n+\t\t} else {\r\n+\t\t\tcustomFeatures.add(new VirSatChangeColorFeature(this));\r\n \t\t}\r\n-\t\treturn super.getCustomFeatures(context);\r\n+\t\t\r\n+\t\tif (object instanceof IBeanCategoryAssignment) {\r\n+\t\t\tcustomFeatures.add(new VirsatCategoryAssignmentOpenEditorFeature(this));\r\n+\t\t}\r\n+\t\t\r\n+\t\treturn customFeatures.toArray(new ICustomFeature[0]);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5521da4039d970280638a9a37e5faee72205ee51"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUxMTIxMw==", "bodyText": "In didnt have any effect right now, but I think it could lead to issues down the road, if somebody were to add a custom feature in the base virsat feature provider.\nI changed it to also add all custom features from the parent class.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/755#discussion_r501511213", "createdAt": "2020-10-08T07:42:18Z", "author": {"login": "SaMuellerDLR"}, "path": "de.dlr.sc.virsat.model.extension.funcelectrical.ui/src/de/dlr/sc/virsat/model/extension/funcelectrical/ui/diagram/features/InterfaceDiagramFeatureProvider.java", "diffHunk": "@@ -230,18 +234,22 @@ public IMoveShapeFeature getMoveShapeFeature(IMoveShapeContext context) {\n \t\r\n \t@Override\r\n \tpublic ICustomFeature[] getCustomFeatures(ICustomContext context) {\r\n-\t    \r\n \t    PictogramElement[] pictogramElements = context.getPictogramElements();\r\n \t\tObject object = getBusinessObjectForPictogramElement(pictogramElements[0]);\r\n \t\t\r\n-\t\tif (object instanceof ABeanStructuralElementInstance) {\r\n-\t\t\treturn new ICustomFeature[] {  new VirSatChangeColorFeature(this)};\r\n-\t\t}\r\n+\t\tList<ICustomFeature> customFeatures = new ArrayList<>();\r\n \t\t\r\n \t\tif (object instanceof InterfaceEnd) {\r\n-\t\t\treturn new ICustomFeature[] { new VirsatCategoryAssignmentOpenEditorFeature(this), new InterfaceEndChangeColorFeature(this)};\r\n+\t\t\tcustomFeatures.add(new InterfaceEndChangeColorFeature(this));\r\n+\t\t} else {\r\n+\t\t\tcustomFeatures.add(new VirSatChangeColorFeature(this));\r\n \t\t}\r\n-\t\treturn super.getCustomFeatures(context);\r\n+\t\t\r\n+\t\tif (object instanceof IBeanCategoryAssignment) {\r\n+\t\t\tcustomFeatures.add(new VirsatCategoryAssignmentOpenEditorFeature(this));\r\n+\t\t}\r\n+\t\t\r\n+\t\treturn customFeatures.toArray(new ICustomFeature[0]);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyMjg4OA=="}, "originalCommit": {"oid": "5521da4039d970280638a9a37e5faee72205ee51"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 626, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}