{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1Mzk2NDA0", "number": 470, "title": "SWTBot Fix 3: Improved Workspace Synchronization ", "bodyText": "Fixed issue with creating new projects not being correctly\nsynchronized with workspace locking.\nRemoved SaveJob since it is not needed anymore.\nRefactored workspace locked execution in editing domain not to use\ncode from Command Stack anymore. The command stack is checking for a\nsave trigger to be set, and tries to issue a save. Deadlocks may happen\nor race conditions when not correctly setting the save trigger.\nImproved logging in command stack.\nImproved save trigger handling in command stack.\n\n\nTask #460: Try to improve SWTBot stability", "createdAt": "2020-02-14T13:47:21Z", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470", "merged": true, "mergeCommit": {"oid": "e21c30f96de23f15e3e09a815a09d1559a3ef8ef"}, "closed": true, "closedAt": "2020-02-18T14:25:54Z", "author": {"login": "PhilMFischer"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEPo36AH2gAyMzc1Mzk2NDA0OjAxNTRmMDM5ZTFlZjY2OTdiZTAxZmI2YTVhNWI1MjdkNDhiMjVjNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFiwqtAFqTM2MDM3ODY4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0154f039e1ef6697be01fb6a5a5b527d48b25c79", "author": {"user": {"login": "PhilMFischer", "name": "Philipp M. Fischer"}}, "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/0154f039e1ef6697be01fb6a5a5b527d48b25c79", "committedDate": "2020-02-14T13:35:00Z", "message": "Improved Workspace Synchronization - (Task #460)\n\n- Fixed issue with creating new projects not being correctly\nsynchronized with workspace locking.\n- Removed SaveJob since it is not needed anymore.\n- Refactored workspace locked execution in editing domain not to use\ncode from Command Stack anymore. The command stack is checking for a\nsave trigger to be set, and tries to issue a save. Deadlocks may happen\nor race conditions when not correctly setting the save trigger.\n- Improved logging in command stack.\n- Improved save trigger handling in command stack.\n\n---\nTask #460: Try to improve SWTBot stability"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NTUyMTEw", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#pullrequestreview-359552110", "createdAt": "2020-02-17T08:21:25Z", "commit": {"oid": "0154f039e1ef6697be01fb6a5a5b527d48b25c79"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwODoyMToyNlrOFqbkIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwODoyMToyNlrOFqbkIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAzNjEyOQ==", "bodyText": "Which boolean are we talking about in this comment?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#discussion_r380036129", "createdAt": "2020-02-17T08:21:26Z", "author": {"login": "SaMuellerDLR"}, "path": "de.dlr.sc.virsat.project/src/de/dlr/sc/virsat/project/editingDomain/VirSatWorkspaceCommandStack.java", "diffHunk": "@@ -224,20 +227,22 @@ public void setEditingDomain(VirSatTransactionalEditingDomain editingDomain) {\n \t/**\r\n \t * Trigger a save all upon completion of the executing command\r\n \t */\r\n-\tpublic void triggerSaveAll() {\r\n+\tpublic synchronized void triggerSaveAll() {\r\n+\t\tActivator.getDefault().getLog().log(new Status(Status.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Save all Triggered by Thread: \" + Thread.currentThread().getName()));\r\n \t\ttriggerSave = true;\r\n \t}\r\n \t\r\n \t/**\r\n \t * Check if the triggerSave flag has been set. If so, ask the editing domain to save everything\r\n \t * and reset the flag.\r\n \t */\r\n-\tprivate void checkTriggerSaveAll() {\r\n+\tprivate synchronized void checkTriggerSaveAll() {\r\n+\t\tActivator.getDefault().getLog().log(new Status(Status.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Check for save trigger\"));\r\n \t\tif (triggerSave) {\r\n-\t\t\tActivator.getDefault().getLog().log(new Status(IStatus.INFO, Activator.getPluginId(), \"Executed command triggered save all on editing domain\"));\r\n-\t\t\tVirSatSaveJob saveJob = new VirSatSaveJob(editingDomain, true);\r\n-\t\t\tsaveJob.scheduleIfNoSaveJobPending();\r\n-\t\t\ttriggerSave = false;\r\n+\t\t\tActivator.getDefault().getLog().log(new Status(IStatus.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Save tiggered Scheduling Save Job.\"));\r\n+\t\t\t// This boolean has to be reset first, otherwise the save all will be executed in\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0154f039e1ef6697be01fb6a5a5b527d48b25c79"}, "originalPosition": 106}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb992fd5bfb35ddcf58af78bac6ddda47e35efa9", "author": {"user": {"login": "SaMuellerDLR", "name": null}}, "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/eb992fd5bfb35ddcf58af78bac6ddda47e35efa9", "committedDate": "2020-02-17T12:31:38Z", "message": "Merge branch 'development' into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "111d36fbd54d183475877365719693a0812ae228", "author": {"user": {"login": "PhilMFischer", "name": "Philipp M. Fischer"}}, "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/111d36fbd54d183475877365719693a0812ae228", "committedDate": "2020-02-17T12:54:25Z", "message": "Updated comment due to review - (Task #460)\n\n---\nTask #460: Try to improve SWTBot stability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0178b11f00dd9fd1085215cf693016104b354811", "author": {"user": {"login": "PhilMFischer", "name": "Philipp M. Fischer"}}, "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/0178b11f00dd9fd1085215cf693016104b354811", "committedDate": "2020-02-17T12:54:52Z", "message": "Merge branch 'development' of https://github.com/virtualsatellite/VirtualSatellite4-Core.git into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bc9e593f3fd4e7270d8bf778040bbec74942bcb", "author": {"user": {"login": "PhilMFischer", "name": "Philipp M. Fischer"}}, "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/4bc9e593f3fd4e7270d8bf778040bbec74942bcb", "committedDate": "2020-02-18T07:56:46Z", "message": "Merge branch 'feature/task_460-Try_to_improve_SWTBot_III_SaveHandling_Bad' into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMTQzNzM5", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#pullrequestreview-360143739", "createdAt": "2020-02-18T08:27:42Z", "commit": {"oid": "4bc9e593f3fd4e7270d8bf778040bbec74942bcb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMzc4Njg3", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#pullrequestreview-360378687", "createdAt": "2020-02-18T14:25:38Z", "commit": {"oid": "4bc9e593f3fd4e7270d8bf778040bbec74942bcb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 594, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}