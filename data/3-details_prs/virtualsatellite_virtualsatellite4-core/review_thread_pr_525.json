{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NzA5MjA3", "number": 525, "reviewThreads": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTo0NjowMFrODopgJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozODoxOFrODp3vaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQ5NjA2OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTo0NjowMFrOF3Uryw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzozMjoyM1rOF3cXcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU1NDg5MQ==", "bodyText": "What is this uncommented code here? Do we still need it?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393554891", "createdAt": "2020-03-17T09:46:00Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY4MDc1Mw==", "bodyText": "It is deleted now.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393680753", "createdAt": "2020-03-17T13:32:23Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU1NDg5MQ=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 145}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTU0MzgzOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTo1ODo1MVrOF3VJ-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzo0NTo1NlrOF4jHeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2MjYxNg==", "bodyText": "Did you check what happens if you import a string value here which doesn't correspond to any Enum Literal?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393562616", "createdAt": "2020-03-17T09:58:51Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 332}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY5MDMxNw==", "bodyText": "It sets the Value null.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393690317", "createdAt": "2020-03-17T13:46:34Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2MjYxNg=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 332}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzOTkyOA==", "bodyText": "If there was a value set and you want to import a new value which doesn't correspond to any Enum Literal, it will set the value to null.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394839928", "createdAt": "2020-03-19T07:45:56Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2MjYxNg=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 332}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTU3MzU2OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMDowNzozNVrOF3VdPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzo0NjozMFrOF4jIbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2NzU0OQ==", "bodyText": "Is this unspecified 'createURI' creating the right type of URI?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393567549", "createdAt": "2020-03-17T10:07:35Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r\n+\t\t\tbpe.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ResourcePropertyInstance\r\n+\t * \r\n+\t * updates uri\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(ResourcePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ResourceProperty) {\r\n+\t\t\tBeanPropertyResource bpr = new BeanPropertyResource(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpr.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpr.setValue(URI.createURI(shorter(struct.get(MatHelper.URI).toString()), true));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 351}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg0MDE3Mg==", "bodyText": "It is.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394840172", "createdAt": "2020-03-19T07:46:30Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r\n+\t\t\tbpe.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ResourcePropertyInstance\r\n+\t * \r\n+\t * updates uri\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(ResourcePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ResourceProperty) {\r\n+\t\t\tBeanPropertyResource bpr = new BeanPropertyResource(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpr.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpr.setValue(URI.createURI(shorter(struct.get(MatHelper.URI).toString()), true));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2NzU0OQ=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 351}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTU5OTEwOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMDoxNToyMFrOF3Vt3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzozNTo1N1rOF3cg_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU3MTgwNQ==", "bodyText": "Why do you remove the element of index 0 here? Could you add a comment? Do you assume the type and UUID are always on top? Why don't you remove these elements explicitly then?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393571805", "createdAt": "2020-03-17T10:15:20Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r\n+\t\t\tbpe.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ResourcePropertyInstance\r\n+\t * \r\n+\t * updates uri\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(ResourcePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ResourceProperty) {\r\n+\t\t\tBeanPropertyResource bpr = new BeanPropertyResource(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpr.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpr.setValue(URI.createURI(shorter(struct.get(MatHelper.URI).toString()), true));\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given UnitValuePropertyInstance\r\n+\t * \r\n+\t * updates value and unit\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(UnitValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof FloatProperty) {\r\n+\t\t\tBeanPropertyFloat bpf = new BeanPropertyFloat(element);\r\n+\t\t\tbpf.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t\tif (\"NaN\".equals(struct.get(MatHelper.VALUE).toString()) || \"''\".equals(struct.get(MatHelper.VALUE).toString())) {\r\n+\t\t\t\tbpf.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpf.setValue(Double.valueOf(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof IntProperty) {\r\n+\t\t\tBeanPropertyInt bpi = new BeanPropertyInt(element);\r\n+\t\t\tbpi.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t\tif (\"NaN\".equals(struct.get(MatHelper.VALUE).toString()) || \"''\".equals(struct.get(MatHelper.VALUE).toString())) {\r\n+\t\t\t\tbpi.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tdouble value = Double.valueOf(struct.get(MatHelper.VALUE).toString());\r\n+\t\t\t\tbpi.setValue((long) value);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * hands back boolean that represents if the MatFile and the sei are equal\r\n+\t * @param sei StructuralElementInstance to test\r\n+\t * @param mat MatFile to test\r\n+\t */\r\n+\tpublic boolean checkIfCorrectSei(StructuralElementInstance sei, MatFile mat) {\r\n+\t\ttry {\r\n+\t\t\tStruct seiStruct = mat.getStruct(sei.getName());\r\n+\t\t\treturn checkIfCorrectSei(sei, seiStruct);\r\n+\t\t} catch (Exception e) {\r\n+\t\t\treturn false;\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * hands back boolean that represents if the struct and the sei are equal\r\n+\t * @param sei StructuralElementInstance to test\r\n+\t * @param seiStruct Struct to test\r\n+\t */\r\n+\tprivate boolean checkIfCorrectSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\tList<String> structFields = seiStruct.getFieldNames();\r\n+\r\n+\t\t//check Type and Uuid\r\n+\t\tif (structFields.contains(\"type\") && structFields.contains(\"uuid\")) {\r\n+\t\t\tString matSeiType = shorter(seiStruct.getChar(\"type\").toString()); \r\n+\t\t\tString matSeiUUID = shorter(seiStruct.getChar(\"uuid\").toString());\r\n+\t\t\tstructFields.remove(0);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 413}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY4MzE5Ng==", "bodyText": "I can remove them explicity. I changed this.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393683196", "createdAt": "2020-03-17T13:35:57Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.edit/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporter.java", "diffHunk": "@@ -0,0 +1,451 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import java.io.IOException;\r\n+import java.util.ArrayList;\r\n+import java.util.List;\r\n+\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.EObject;\r\n+import org.eclipse.emf.ecore.resource.Resource;\r\n+import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;\r\n+\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyBoolean;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEReference;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyEnum;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyFloat;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyInt;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyResource;\r\n+import de.dlr.sc.virsat.model.concept.types.property.BeanPropertyString;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.ATypeInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.CategoryAssignment;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.BooleanProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.EnumProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.FloatProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.IntProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ReferenceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.ResourceProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertydefinitions.StringProperty;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ArrayInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ComposedPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.EnumUnitPropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ReferencePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ResourcePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.UnitValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.ValuePropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.impl.ArrayInstanceImpl;\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.util.PropertyinstancesSwitch;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+import us.hebi.matlab.mat.types.Cell;\r\n+ \r\n+/**\r\n+ * Class for exporting data to .mat\r\n+ */\r\n+public class MatImporter {\r\n+\tStructuralElementInstance sei;\r\n+\t\r\n+\t/**\r\n+\t * checks if mat and sei fit together\r\n+\t * @param sei sei which should be changed\r\n+\t * @param matFile MatFile that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, MatFile mat) throws IOException {\r\n+\t\tthis.sei = sei;\r\n+\t\tif (checkIfCorrectSei(sei, mat)) {\r\n+\t\t\tStruct struct = mat.getStruct(sei.getName());\r\n+\t\t\timportSei(sei, struct);\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up children and CategoryAssinments\r\n+\t * @param sei sei which should be changed\r\n+\t * @param seiStruct MatStruct that includes all Information\r\n+\t */\r\n+\tpublic void importSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tif (seiStruct.getFieldNames().contains(MatHelper.CHILDREN)) {\r\n+\t\t\tStruct matChildren = seiStruct.getStruct(MatHelper.CHILDREN);\r\n+\t\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\t\tfor (StructuralElementInstance seiChild : seiChildren) {\r\n+\t\t\t\timportSei(seiChild, matChildren.getStruct(seiChild.getName()));\r\n+\t\t\t}\r\n+\t\t\tseiStruct.remove(MatHelper.CHILDREN);\r\n+\t\t}\r\n+\t\tEList<CategoryAssignment> seiCas = sei.getCategoryAssignments();\r\n+\t\timportCas(seiCas, seiStruct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * split up CategoryAssinment\r\n+\t * @param seiCas List of CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importCas(EList<CategoryAssignment> seiCas, Struct struct) {\r\n+\t\t\r\n+\t\tList<String> nameMatCas = struct.getFieldNames();\r\n+\t\tList<String> nameSeiCas = new ArrayList<String>();\r\n+\t\tfor (CategoryAssignment seiCa : seiCas) {\r\n+\t\t\tnameSeiCas.add(seiCa.getName());\r\n+\t\t}\r\n+\r\n+\t\tfor (int i = 0; i < seiCas.size();) {\r\n+\t\t\tif (nameMatCas.contains(seiCas.get(i).getName())) { //import all given CategoryAssinments\r\n+\t\t\t\timportGivenCa(seiCas.get(i), struct.get(seiCas.get(i).getName()));\r\n+\t\t\t\tnameMatCas.remove(seiCas.get(i).getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiCas.remove(i);\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new CategoryAssinments\r\n+\t\t//for (String nameMatCa : nameMatCas) {\r\n+\t\t//\tseiCas.add(importNewCa(struct.get(nameMatCa),nameMatCa));\r\n+\t\t//}\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * split up PropertyInstances\r\n+\t * @param seiCa CategoryAssinments which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenCa(CategoryAssignment seiCa, Struct struct) {\r\n+\t\tEList<APropertyInstance> seiAPIs = seiCa.getPropertyInstances();\r\n+\t\tList<String> nameMatAPIs = struct.getFieldNames();\r\n+\t\t\r\n+\t\t//import all given APropertyInstances\r\n+\t\tfor (int i = 0; i < seiAPIs.size();) {\r\n+\t\t\tif (nameMatAPIs.contains(seiAPIs.get(i).getType().getName())) {\r\n+\t\t\t\tif (!(seiAPIs instanceof ArrayInstanceImpl)) {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct.get(seiAPIs.get(i).getType().getName()));\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\timportGivenAPI(seiAPIs.get(i), struct);\r\n+\t\t\t\t}\r\n+\t\t\t\tnameMatAPIs.remove(seiAPIs.get(i).getType().getName());\r\n+\t\t\t\ti++;\r\n+\t\t\t} else {\r\n+\t\t\t\tseiAPIs.remove(seiAPIs.get(i));\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+\t\t//import all new APropertyInstances\r\n+\t\t//for (String nameMatAPI : nameMatAPIs) {\r\n+\t\t//\tseiAPIs.add(importNewAPI(struct.get(nameMatAPI)));\r\n+\t\t//}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property\r\n+\t * @param seiAPI PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate void importGivenAPI(APropertyInstance seiAPI, Struct struct) {\r\n+\t\tgetRightPropertyBySei(seiAPI, struct);\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given Property as Instance of\r\n+\t * \r\n+\t * return value is not needed or used\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean getRightPropertyBySei(APropertyInstance element, Struct struct) {\r\n+\t\tBoolean done = new PropertyinstancesSwitch<Boolean>() {\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseUnitValuePropertyInstance(UnitValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseResourcePropertyInstance(ResourcePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEnumUnitPropertyInstance(EnumUnitPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseValuePropertyInstance(ValuePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseReferencePropertyInstance(ReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseEReferencePropertyInstance(EReferencePropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseComposedPropertyInstance(ComposedPropertyInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct);\r\n+\t\t\t}\r\n+\r\n+\t\t\t@Override\r\n+\t\t\tpublic Boolean caseArrayInstance(ArrayInstance object) {\r\n+\t\t\t\treturn contentOfProperty(object, struct.getCell(object.getType().getName()));\r\n+\t\t\t}\r\n+\r\n+\t\t}.doSwitch(element);\r\n+\t\treturn done;\r\n+\t}\r\n+\t\r\n+\t/**\r\n+\t * import a given ArrayInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param cell MatCell that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ArrayInstance element, Cell cell) {\r\n+\t\tEList<APropertyInstance> propertyInstances = element.getArrayInstances();\r\n+\t\tint [] dims = cell.getDimensions();\r\n+\t\tfor (int i = 0; i < dims[0]; i++) {\r\n+\t\t\timportGivenAPI(propertyInstances.get(i), cell.get(i));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ComposedPropertyInstance\r\n+\t * \r\n+\t * updates everything inside it\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ComposedPropertyInstance element, Struct struct) {\r\n+\t\tCategoryAssignment ca = element.getTypeInstance();\t\r\n+\t\timportGivenCa(ca, struct);\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EReferencePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(EReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EReferenceProperty) {\r\n+\t\t\tBeanPropertyEReference<EReferenceProperty> bpe = new BeanPropertyEReference<EReferenceProperty>(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpe.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tURI uri = URI.createPlatformPluginURI(shorter(struct.get(MatHelper.URI).toString()), true);\r\n+\t\t\t\tResource res = new ResourceSetImpl().getResource(uri, true);\r\n+\t\t\t\tEObject eReferenceValue = res.getEObject(uri.fragment());\r\n+\t\t\t\telement.setReference(eReferenceValue);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ReferencePropertyInstance\r\n+\t * \r\n+\t * updates reference\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ReferencePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ReferenceProperty) {\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.UUID).toString())) {\r\n+\t\t\t\telement.setReference(null);\r\n+\t\t\t} else {\r\n+\t\t\t\t//StructuralElementInstance sei2 = sei;\r\n+\t\t\t\tEList<Resource> res = sei.eResource().getResourceSet().getResources();\r\n+\t\t\t\tfor (Resource re : res) {\r\n+\t\t\t\t\tEObject ref = re.getEObject(shorter(struct.get(MatHelper.UUID).toString()));\r\n+\t\t\t\t\tif (ref != null) {\r\n+\t\t\t\t\t\tif (ref instanceof ATypeInstance) {\r\n+\t\t\t\t\t\t\telement.setReference((ATypeInstance) ref);\r\n+\t\t\t\t\t\t} \r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ValuePropertyInstance\r\n+\t * \r\n+\t * updates value\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprotected Boolean contentOfProperty(ValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof BooleanProperty) {\r\n+\t\t\tBeanPropertyBoolean bpb = new BeanPropertyBoolean(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tif (struct.get(MatHelper.VALUE).toString().equals(\"true\")) {\r\n+\t\t\t\t\tbpb.setValue(true);\r\n+\t\t\t\t} else {\r\n+\t\t\t\t\tbpb.setValue(false);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tbpb.unset();\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof StringProperty) {\r\n+\t\t\tBeanPropertyString bps = new BeanPropertyString(element);\r\n+\t\t\tif (!struct.get(MatHelper.VALUE).toString().equals(\"''\")) {\r\n+\t\t\t\tbps.setValue(shorter(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t} else {\r\n+\t\t\t\tbps.unset();\r\n+\t\t\t}\r\n+\t\t\t\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given EnumUnitPropertyInstance\r\n+\t * \r\n+\t * updates name and unit. value is updates automatically\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(EnumUnitPropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof EnumProperty) {\r\n+\t\t\tBeanPropertyEnum bpe = new BeanPropertyEnum(element);\r\n+\t\t\tbpe.setValue(shorter(struct.get(MatHelper.NAME).toString()));\r\n+\t\t\tbpe.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given ResourcePropertyInstance\r\n+\t * \r\n+\t * updates uri\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(ResourcePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof ResourceProperty) {\r\n+\t\t\tBeanPropertyResource bpr = new BeanPropertyResource(element);\r\n+\t\t\tif (\"''\".equals(struct.get(MatHelper.URI).toString())) {\r\n+\t\t\t\tbpr.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpr.setValue(URI.createURI(shorter(struct.get(MatHelper.URI).toString()), true));\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * import a given UnitValuePropertyInstance\r\n+\t * \r\n+\t * updates value and unit\r\n+\t * @param element PropertyInstance which should be changed\r\n+\t * @param struct MatStruct that includes all Information\r\n+\t */\r\n+\tprivate Boolean contentOfProperty(UnitValuePropertyInstance element, Struct struct) {\r\n+\t\tif (element.getType() instanceof FloatProperty) {\r\n+\t\t\tBeanPropertyFloat bpf = new BeanPropertyFloat(element);\r\n+\t\t\tbpf.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t\tif (\"NaN\".equals(struct.get(MatHelper.VALUE).toString()) || \"''\".equals(struct.get(MatHelper.VALUE).toString())) {\r\n+\t\t\t\tbpf.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tbpf.setValue(Double.valueOf(struct.get(MatHelper.VALUE).toString()));\r\n+\t\t\t}\r\n+\t\t} else if (element.getType() instanceof IntProperty) {\r\n+\t\t\tBeanPropertyInt bpi = new BeanPropertyInt(element);\r\n+\t\t\tbpi.setUnit(shorter(struct.get(MatHelper.UNIT).toString()));\r\n+\t\t\tif (\"NaN\".equals(struct.get(MatHelper.VALUE).toString()) || \"''\".equals(struct.get(MatHelper.VALUE).toString())) {\r\n+\t\t\t\tbpi.unset();\r\n+\t\t\t} else {\r\n+\t\t\t\tdouble value = Double.valueOf(struct.get(MatHelper.VALUE).toString());\r\n+\t\t\t\tbpi.setValue((long) value);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn true;\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * hands back boolean that represents if the MatFile and the sei are equal\r\n+\t * @param sei StructuralElementInstance to test\r\n+\t * @param mat MatFile to test\r\n+\t */\r\n+\tpublic boolean checkIfCorrectSei(StructuralElementInstance sei, MatFile mat) {\r\n+\t\ttry {\r\n+\t\t\tStruct seiStruct = mat.getStruct(sei.getName());\r\n+\t\t\treturn checkIfCorrectSei(sei, seiStruct);\r\n+\t\t} catch (Exception e) {\r\n+\t\t\treturn false;\r\n+\t\t}\r\n+\t}\r\n+\r\n+\t/**\r\n+\t * hands back boolean that represents if the struct and the sei are equal\r\n+\t * @param sei StructuralElementInstance to test\r\n+\t * @param seiStruct Struct to test\r\n+\t */\r\n+\tprivate boolean checkIfCorrectSei(StructuralElementInstance sei, Struct seiStruct) {\r\n+\t\tEList<StructuralElementInstance> seiChildren = sei.getChildren();\r\n+\t\tList<String> structFields = seiStruct.getFieldNames();\r\n+\r\n+\t\t//check Type and Uuid\r\n+\t\tif (structFields.contains(\"type\") && structFields.contains(\"uuid\")) {\r\n+\t\t\tString matSeiType = shorter(seiStruct.getChar(\"type\").toString()); \r\n+\t\t\tString matSeiUUID = shorter(seiStruct.getChar(\"uuid\").toString());\r\n+\t\t\tstructFields.remove(0);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU3MTgwNQ=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 413}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTY1NTQxOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMDozMTo1MVrOF3WSjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzo0Nzo1MlrOF4jKjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU4MTE5Ng==", "bodyText": "Just for clearification... Can't a SEI still be the 'correct' one if the number of childrean is different? What does correct mean? It's for mapping the imported data to  a corresponding SEI in the model, ins't it? Isn't it sufficient to compare the UUID here?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393581196", "createdAt": "2020-03-17T10:31:51Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg0MDcxNw==", "bodyText": "I changed it that way it is checking UUID and Type. Now children can be added and it will get the sei as a fitting one. Correct means that the sei and the one in the .mat fit to each other.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394840717", "createdAt": "2020-03-19T07:47:52Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU4MTE5Ng=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTc1NTU3OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTowMjoyOVrOF3XTVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyNjo1M1rOF5Tl2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU5Nzc4Mg==", "bodyText": "Could we also have one test that doesn't use the exporter to test the importer? By creating this matlab-string manually for example? Because like this, if the exporter might have a bug, we would maybe also miss bugs in the importer test", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393597782", "createdAt": "2020-03-17T11:02:29Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNDEzNw==", "bodyText": "Nice \ud83d\udc4d Thanks :)", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395634137", "createdAt": "2020-03-20T13:26:53Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU5Nzc4Mg=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTc2MjQ4OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTowNDo0OVrOF3XYAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTowNDo0OVrOF3XYAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU5ODk3OQ==", "bodyText": "It's reletively hard to follow this test as someone from the outside... All this index handling and the connection of tsei and sei are hard to understand... Could you add som comments in your tests?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393598979", "createdAt": "2020-03-17T11:04:49Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 132}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTg1MzEzOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTozMzozMVrOF3YRfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNzoxNjo0NFrOF34oOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxMzY5NQ==", "bodyText": "You mixed up expected and actual here, didn't you? You expect that all values of tc1 are overwritten by the import of tc? Then it the order in the assert statement should be the other way around... This way it is confusing because you think that tc should have change to the values you set to tc1.... And please also add a comment here or a more meaningful name of the test case", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393613695", "createdAt": "2020-03-17T11:33:31Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 165}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE0MzgwMQ==", "bodyText": "I changed the order and added some comments.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394143801", "createdAt": "2020-03-18T07:16:44Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxMzY5NQ=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 165}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTg2MzEwOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTozNjoxN1rOF3YXmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNzoxNTo1OVrOF34nSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxNTI1Nw==", "bodyText": "Could you create these values as contants and then assert against these constants? As it is write now it might happen that tc changes for some reason and then the assert statements are invalid..\nSomething like:\nfinal String TEST_STRING = \"TestString\";\ntc.setTestString(TEST_STRING);\n...\nassert(\"Some comment\", TEST_STRING, tc1.getTestString());", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393615257", "createdAt": "2020-03-17T11:36:17Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE0MzU2MA==", "bodyText": "Changed it.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394143560", "createdAt": "2020-03-18T07:15:59Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxNTI1Nw=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 175}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTg4NDcxOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTo0Mjo1N1rOF3YlBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNzoxNDo0NVrOF34lrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxODY5NQ==", "bodyText": "ChangeNothingValues? TestCase with no updates?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393618695", "createdAt": "2020-03-17T11:42:57Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 230}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE0MzE0OQ==", "bodyText": "A TestCase with no Values is exported and than imported. The test check if the sei doesn't change by this.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r394143149", "createdAt": "2020-03-18T07:14:45Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxODY5NQ=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 230}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTg5NDA1OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTo0NTo1MlrOF3Yqsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTo0NzoxOVrOF3YteQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMDE0Nw==", "bodyText": "This method just returns you a command... which is not executed as long as you don't invoke its execution...\nCommand cmd = tsei.add(edetingDomain, tc);\nedetingDomain.execute(cmd);", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393620147", "createdAt": "2020-03-17T11:45:52Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(true);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRef() throws IOException {\r\n+\t\t//empty and import empty\r\n+\t\tTestCategoryReference tc = new TestCategoryReference(testConcept);\r\n+\t\ttsei.add(editingDomain, tc);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 271}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMDg1Nw==", "bodyText": "Looks like this test isn't doing anything till now, is it? If values are not set then this CA is still empty", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393620857", "createdAt": "2020-03-17T11:47:19Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(true);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRef() throws IOException {\r\n+\t\t//empty and import empty\r\n+\t\tTestCategoryReference tc = new TestCategoryReference(testConcept);\r\n+\t\ttsei.add(editingDomain, tc);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMDE0Nw=="}, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 271}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTkyODA5OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTo1NjozMFrOF3ZAWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTo1NjozMFrOF3ZAWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyNTY4OA==", "bodyText": "I think it makes more sense to test the value of an EReference here... rather than comparing the property...", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r393625688", "createdAt": "2020-03-17T11:56:30Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,343 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final int NUMBEROFELEMENTS = 6;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(\"testsei\");\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongNumberOfChildren() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tassertFalse(\"Not the same number of children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongChildren() {\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setParent(sei);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElementOther tsei3 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei3 = tsei3.getStructuralElementInstance();\r\n+\t\tsei3.setName(\"testseiChild\");\r\n+\t\tTestStructuralElementOther tsei4 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei4 = tsei4.getStructuralElementInstance();\r\n+\t\tsei4.setName(\"testseiChild2\");\r\n+\t\tsei2.setParent(sei3);\r\n+\t\tsei4.setParent(sei);\r\n+\t\tassertFalse(\"Not the same children\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportCasDeleteCas() throws IOException {\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestCategoryComposition tc1 = new TestCategoryComposition(testConcept);\r\n+\t\ttsei.add(tc1);\r\n+\t\tassertTrue(\"Sei has two CategoryAssinments\", sei.getCategoryAssignments().size() == 2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Only one CategoryAssinment\", sei.getCategoryAssignments().size() == 1);\r\n+\t\tassertTrue(\"Right CategoryAssinment included\",\r\n+\t\t\t\tsei.getCategoryAssignments().get(0).getName().equals(tc2.getName()));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportAPIDeleteAPI() throws IOException {\r\n+\t\tEReferenceTest tc2 = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(tc2);\r\n+\t\tTestCategoryAllProperty tc3 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc3);\r\n+\t\tAPropertyInstance nInstance = sei.getCategoryAssignments().get(0).getPropertyInstances().get(0);\r\n+\t\tsei.getCategoryAssignments().remove(0);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tsei.getCategoryAssignments().get(0).getPropertyInstances().add(nInstance);\r\n+\t\tassertEquals(\"CategoryAssinment has seven PropertyInstances\", sei.getCategoryAssignments().get(0).getPropertyInstances().size(), NUMBEROFELEMENTS + 1);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertTrue(\"Instance deleted\", sei.getCategoryAssignments().get(0).getPropertyInstances().size() == NUMBEROFELEMENTS);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(false);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(true);\r\n+\t\ttc.setTestFloat(2);\r\n+\t\ttc.setTestEnum(\"HIGH\");\r\n+\t\ttc.setTestString(\"test\");\r\n+\t\ttc.setTestInt(1);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(true);\r\n+\t\ttc1.setTestFloat(2);\r\n+\t\ttc1.setTestEnum(\"HIGH\");\r\n+\t\ttc1.setTestString(\"test\");\r\n+\t\ttc1.setTestInt(1);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\ttsei2.add(tc1);\r\n+\t\timporter.importSei(sei2, mat);\r\n+\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc1.getTestString(), tc.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc1.getTestBool(), tc.getTestBool());\r\n+\t\tassertEquals(tc1.getTestFloat(), tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc1.getTestResource(), tc.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc1.getTestEnum(), tc.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", tc1.getTestInt(), tc.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRef() throws IOException {\r\n+\t\t//empty and import empty\r\n+\t\tTestCategoryReference tc = new TestCategoryReference(testConcept);\r\n+\t\ttsei.add(editingDomain, tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tMatFile mat1 = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryReference tc1 = new TestCategoryReference(testConcept);\r\n+\t\ttsei2.add(editingDomain, tc1);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\timporter.importSei(sei2, mat);\r\n+\t\tassertEquals(\"same EReference from empty to empty\", tc1.getTestRefCategory(), tc.getTestRefCategory()); //empty to empty\r\n+\r\n+\t\t//values and import empty\r\n+\t\tTestCategoryAllProperty tc2 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestRefCategory(editingDomain, tc2);\r\n+\t\timporter.importSei(sei2, mat1);\r\n+\t\tassertEquals(\"same EReference from value to empty\", tc1.getTestRefCategory(), tc.getTestRefCategory());\r\n+\r\n+\t\t//empty and import values\r\n+\t\ttc1.setTestRefCategory(editingDomain, tc2);\r\n+\t\teditingDomain.saveAll();\r\n+\t\tmat = exporter.exportSei(sei2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertEquals(\"same Reference from empty to value\", tc1.getTestRefCategory(), tc.getTestRefCategory());\r\n+\r\n+\t\t//values and import values\r\n+\t\ttc.setTestRefCategory(editingDomain, tc2);\r\n+\t\ttc1.setTestRefCategory(editingDomain, tc2);\r\n+\t\teditingDomain.saveAll();\r\n+\t\tmat = exporter.exportSei(sei2);\r\n+\t\timporter.importSei(sei, mat);\r\n+\t\tassertEquals(\"same Reference from value to value\", tc1.getTestRefCategory(), tc.getTestRefCategory());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesERef() throws IOException {\r\n+\t\tExternalTestType testERef = de.dlr.sc.virsat.model.external.tests.TestsFactory.eINSTANCE.createExternalTestType();\r\n+\t\t\r\n+\t\t//empty and import empty\r\n+\t\tEReferenceTest tc = new EReferenceTest(testConcept);\r\n+\t\ttsei.add(editingDomain, tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tMatFile mat1 = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tEReferenceTest tc1 = new EReferenceTest(testConcept);\r\n+\t\ttsei2.add(editingDomain, tc1);\r\n+\t\tsei2.setName(\"testsei\");\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\timporter.importSei(sei2, mat);\r\n+\t\tassertEquals(\"same Reference from empty to empty\", tc1.getEReferenceTest(), tc.getEReferenceTest());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426646f6e8ebc74ec09dca899c48c568bf9c7e0d"}, "originalPosition": 321}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjI4MzQzOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyOTo1NFrOF5Tsuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo0NjoyN1rOF5UUvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNTg5OQ==", "bodyText": "So we prevent renaming of SEIs? Why? Aren't UUIDs itendfier enough?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395635899", "createdAt": "2020-03-20T13:29:54Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NjE0MA==", "bodyText": "Right now yes. The name is used to take the right Entry of the .mat. So if it is the wrong name, it will not work yet", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395646140", "createdAt": "2020-03-20T13:46:27Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNTg5OQ=="}, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 128}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjI4ODI2OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozMToxMVrOF5Tv1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo0NTowNlrOF5URIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNjY5Mw==", "bodyText": "That test is legacy or? It doesn't do anything else than the upper test? Or am I missing something?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395636693", "createdAt": "2020-03-20T13:31:11Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NTIxOA==", "bodyText": "One checks for UUID, one for TYPE", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395645218", "createdAt": "2020-03-20T13:45:06Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNjY5Mw=="}, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 143}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjI5NzA3OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozMzozNVrOF5T1fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo0OToyOVrOF5Ucrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzODE0MQ==", "bodyText": "Would be nice if the Unit would be in a constant as well... :)\nfinal String UNIT_NAME = \"Kilogram\";", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395638141", "createdAt": "2020-03-20T13:33:35Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 154}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0ODE3NQ==", "bodyText": "Done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395648175", "createdAt": "2020-03-20T13:49:29Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzODE0MQ=="}, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 154}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjMwMDUzOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozNDozNFrOF5T3rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo0ODo1NFrOF5UbRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzODcwMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(\"Unit set\", \"Kilogram\", tc1.getTestFloatBean().getUnit());\n          \n          \n            \n            \t\tassertEquals(\"Unit set\", UNIT_NAME, tc1.getTestFloatBean().getUnit());", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395638702", "createdAt": "2020-03-20T13:34:34Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\t\tassertEquals(\"Unit set\", \"Kilogram\", tc1.getTestFloatBean().getUnit());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 163}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzgxMw==", "bodyText": "Done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395647813", "createdAt": "2020-03-20T13:48:54Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\t\tassertEquals(\"Unit set\", \"Kilogram\", tc1.getTestFloatBean().getUnit());\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzODcwMg=="}, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 163}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjMxNDY0OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozODoxOFrOF5UAnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo0ODo0N1rOF5Ua9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0MDk4OA==", "bodyText": "Missleading comment... Test is further down. Rather \"Prepare test data\" or remove it", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395640988", "createdAt": "2020-03-20T13:38:18Z", "author": {"login": "franzTobiasDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\t\tassertEquals(\"Unit set\", \"Kilogram\", tc1.getTestFloatBean().getUnit());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(TEST_BOOL);\r\n+\t\ttc1.setTestFloat(TEST_FLOAT);\r\n+\t\ttc1.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc1.setTestString(TEST_STRING);\r\n+\t\ttc1.setTestInt(TEST_INT);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\r\n+\t\t//checks if the import deletes all values\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc.getTestString(), tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc.getTestBool(), tc1.getTestBool());\r\n+\t\tassertEquals(tc.getTestFloat(), tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc.getTestEnum(), tc1.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(TEST_BOOL);\r\n+\t\ttc.setTestFloat(TEST_FLOAT);\r\n+\t\ttc.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc.setTestString(TEST_STRING);\r\n+\t\ttc.setTestInt(TEST_INT);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\r\n+\t\t//checks if the import adds all Values\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", TEST_STRING, tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", TEST_BOOL, tc1.getTestBool());\r\n+\t\tassertEquals(TEST_FLOAT, tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", TEST_ENUM_VALUE, tc1.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", TEST_INT, tc1.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei, mat));\r\n+\r\n+\t\t//checks that if the same sei is imported and everything is empty, it stays empty\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc.getTestString(), tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc.getTestBool(), tc1.getTestBool());\r\n+\t\tassertEquals(tc.getTestFloat(), tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc.getTestEnum(), tc1.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(TEST_BOOL);\r\n+\t\ttc.setTestFloat(TEST_FLOAT);\r\n+\t\ttc.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc.setTestString(TEST_STRING);\r\n+\t\ttc.setTestInt(TEST_INT);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(TEST_BOOL);\r\n+\t\ttc1.setTestFloat(TEST_FLOAT);\r\n+\t\ttc1.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc1.setTestString(TEST_STRING);\r\n+\t\ttc1.setTestInt(TEST_INT);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei, mat));\r\n+\r\n+\t\t//checks if the same seiis imported and everything has a value, the value doesnt change\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", TEST_STRING, tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", TEST_BOOL, tc1.getTestBool());\r\n+\t\tassertEquals(TEST_FLOAT, tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnumValue\", tc.getTestEnumBean().getValue(), tc1.getTestEnumBean().getValue());\r\n+\t\tassertEquals(\"same testEnumValue\", tc.getTestEnumBean().getUnit(), tc1.getTestEnumBean().getUnit());\r\n+\t\tassertEquals(\"same testInt\", TEST_INT, tc1.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRef() throws IOException {\r\n+\t\t//Reference test target\r\n+\t\tfinal TestCategoryAllProperty TEST_REFERENCE_TARGET = new TestCategoryAllProperty(testConcept);\r\n+\t\t\r\n+\t\t//empty and import empty\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 302}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzczMg==", "bodyText": "Done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/525#discussion_r395647732", "createdAt": "2020-03-20T13:48:47Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.tests.test/src/de/dlr/sc/virsat/model/dvlm/mat/MatImporterTest.java", "diffHunk": "@@ -0,0 +1,464 @@\n+/*******************************************************************************\r\n+ * Copyright (c) 2008-2020 German Aerospace Center (DLR), Simulation and Software Technology, Germany.\r\n+ *\r\n+ * This program and the accompanying materials are made available under the\r\n+ * terms of the Eclipse Public License 2.0 which is available at\r\n+ * http://www.eclipse.org/legal/epl-2.0.\r\n+ *\r\n+ * SPDX-License-Identifier: EPL-2.0\r\n+ *******************************************************************************/\r\n+package de.dlr.sc.virsat.model.dvlm.mat;\r\n+\r\n+import static org.junit.Assert.assertEquals;\r\n+import static org.junit.Assert.assertFalse;\r\n+import static org.junit.Assert.assertNotNull;\r\n+import static org.junit.Assert.assertNull;\r\n+import static org.junit.Assert.assertTrue;\r\n+\r\n+import java.io.IOException;\r\n+\r\n+import org.eclipse.core.runtime.CoreException;\r\n+import org.eclipse.emf.common.command.Command;\r\n+import org.eclipse.emf.common.util.EList;\r\n+import org.eclipse.emf.common.util.URI;\r\n+import org.eclipse.emf.ecore.util.EcoreUtil;\r\n+import org.junit.Before;\r\n+import org.junit.Test;\r\n+\r\n+import de.dlr.sc.virsat.model.dvlm.categories.propertyinstances.APropertyInstance;\r\n+import de.dlr.sc.virsat.model.dvlm.structural.StructuralElementInstance;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.EReferenceTest;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryAllProperty;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryComposition;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryCompositionArray;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestCategoryReference;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElement;\r\n+import de.dlr.sc.virsat.model.extension.tests.model.TestStructuralElementOther;\r\n+import de.dlr.sc.virsat.model.extension.tests.test.ATestConceptTestCase;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalModelTestHelper;\r\n+import de.dlr.sc.virsat.model.external.tests.ExternalTestType;\r\n+import de.dlr.sc.virsat.project.resources.command.CreateSeiResourceAndFileCommand;\r\n+import us.hebi.matlab.mat.format.Mat5;\r\n+import us.hebi.matlab.mat.types.MatFile;\r\n+import us.hebi.matlab.mat.types.Struct;\r\n+\r\n+public class MatImporterTest extends ATestConceptTestCase {\r\n+\r\n+\tprivate StructuralElementInstance sei;\r\n+\tprivate TestStructuralElement tsei;\r\n+\tprivate MatExporter exporter;\r\n+\tprivate MatImporter importer;\r\n+\tprivate MatFile mat;\r\n+\tprivate static final String TEST_STRING = \"testString\";\r\n+\tprivate static final int TEST_INT = 1;\r\n+\tprivate static final float TEST_FLOAT = 2;\r\n+\tprivate static final String TEST_ENUM_VALUE = \"HIGH\";\r\n+\tprivate static final String TEST_SEI = \"testsei\";\r\n+\tprivate static final Boolean TEST_BOOL = true;\r\n+\r\n+\t@Before\r\n+\tpublic void setUp() throws CoreException {\r\n+\t\texporter = new MatExporter();\r\n+\t\timporter = new MatImporter();\r\n+\t\tsuper.setUp();\r\n+\t\taddEditingDomainAndRepository();\r\n+\t\texecuteAsCommand(() -> loadTestConcept());\r\n+\t\ttsei = new TestStructuralElement(testConcept);\r\n+\t\tsei = tsei.getStructuralElementInstance();\r\n+\t\tsei.setName(TEST_SEI);\r\n+\t\texecuteAsCommand(() -> repository.getRootEntities().add(sei));\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testWithoutExport() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\t//Create Mat\r\n+\t\tMatFile matfile = Mat5.newMatFile();\r\n+\t\t\r\n+\t\tStruct boolPropertyStruct = Mat5.newStruct();\r\n+\t\tboolPropertyStruct.set(MatHelper.VALUE, Mat5.newLogicalScalar(TEST_BOOL));\r\n+\t\t\r\n+\t\tStruct stringPropertyStruct = Mat5.newStruct();\r\n+\t\tstringPropertyStruct.set(MatHelper.VALUE, Mat5.newString(TEST_STRING));\r\n+\t\t\r\n+\t\tStruct intPropertyStruct = Mat5.newStruct();\r\n+\t\tintPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tintPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_INT));\r\n+\t\t\r\n+\t\tStruct floatPropertyStruct = Mat5.newStruct();\r\n+\t\tfloatPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"\"));\r\n+\t\tfloatPropertyStruct.set(MatHelper.VALUE, Mat5.newScalar(TEST_FLOAT));\r\n+\t\t\r\n+\t\tStruct enumPropertyStruct = Mat5.newStruct();\r\n+\t\tenumPropertyStruct.set(MatHelper.UNIT, Mat5.newString(\"Kilogram\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.VALUE, Mat5.newString(\"25\"));\r\n+\t\tenumPropertyStruct.set(MatHelper.NAME, Mat5.newString(TEST_ENUM_VALUE));\r\n+\r\n+\t\tStruct resourcePropertyStruct = Mat5.newStruct();\r\n+\t\tresourcePropertyStruct.set(MatHelper.URI, Mat5.newString(\"\"));\r\n+\t\t\r\n+\t\tStruct caStruct = Mat5.newStruct();\r\n+\t\tcaStruct.set(\"testString\", stringPropertyStruct);\r\n+\t\tcaStruct.set(\"testInt\", intPropertyStruct);\r\n+\t\tcaStruct.set(\"testFloat\", floatPropertyStruct);\r\n+\t\tcaStruct.set(\"testResource\", resourcePropertyStruct);\r\n+\t\tcaStruct.set(\"testEnum\", enumPropertyStruct);\r\n+\t\tcaStruct.set(\"testBool\", boolPropertyStruct);\r\n+\t\t\r\n+\t\tStruct struct = Mat5.newStruct();\r\n+\t\tstruct.set(MatHelper.TYPE, Mat5.newString(sei.getType().getName()))\r\n+\t\t\t  .set(MatHelper.UUID, Mat5.newString(sei.getUuid().toString()));\r\n+\t\tstruct.set(tc.getName(), caStruct);\r\n+\t\tmatfile.addArray(sei.getName(), struct);\r\n+\t\tCommand cmd = importer.importSei(editingDomain, sei, matfile);\r\n+\t\teditingDomain.getCommandStack().execute(cmd);\r\n+\t\tassertEquals(\"Is the same\", TEST_STRING, tc.getTestString());\r\n+\t\tassertEquals(\"Is the same\", TEST_ENUM_VALUE, tc.getTestEnum());\r\n+\t\tassertEquals(\"Is the same\", TEST_BOOL, tc.getTestBool());\r\n+\t\tassertEquals(\"Is the same\", TEST_INT, tc.getTestInt());\r\n+\t\tassertEquals(TEST_FLOAT, tc.getTestFloat(), 0);\r\n+\t\tassertEquals(\"Is the same\", null, tc.getTestResource());\r\n+\t}\r\n+\t\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiCorrect() {\r\n+\t\tassertTrue(\"Is the same\", importer.checkIfCorrectSei(sei, mat));\r\n+\t\tsei.setName(\"Testsein\");\r\n+\t\tassertFalse(\"Not the same name\", importer.checkIfCorrectSei(sei, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongUUID() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setType(sei.getType());\r\n+\t\tassertFalse(\"Not the same uuid\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testCheckIfCorrectSeiWrongType() {\r\n+\t\tTestStructuralElementOther tsei2 = new TestStructuralElementOther(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tassertFalse(\"Not the same type\", importer.checkIfCorrectSei(sei2, mat));\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportUnit() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.getTestFloatBean().setUnit(\"Kilogram\");\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\t\tassertEquals(\"Unit set\", \"Kilogram\", tc1.getTestFloatBean().getUnit());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRemoveAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\t\t\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(TEST_BOOL);\r\n+\t\ttc1.setTestFloat(TEST_FLOAT);\r\n+\t\ttc1.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc1.setTestString(TEST_STRING);\r\n+\t\ttc1.setTestInt(TEST_INT);\r\n+\t\tURI testUri =  URI.createPlatformResourceURI(\"Testresource\", false);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\r\n+\t\t//checks if the import deletes all values\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc.getTestString(), tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc.getTestBool(), tc1.getTestBool());\r\n+\t\tassertEquals(tc.getTestFloat(), tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc.getTestEnum(), tc1.getTestEnum());\r\n+\t\t\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesAddAll() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(TEST_BOOL);\r\n+\t\ttc.setTestFloat(TEST_FLOAT);\r\n+\t\ttc.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc.setTestString(TEST_STRING);\r\n+\t\ttc.setTestInt(TEST_INT);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei2, mat));\r\n+\r\n+\t\t//checks if the import adds all Values\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", TEST_STRING, tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", TEST_BOOL, tc1.getTestBool());\r\n+\t\tassertEquals(TEST_FLOAT, tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", TEST_ENUM_VALUE, tc1.getTestEnum());\r\n+\t\tassertEquals(\"same testInt\", TEST_INT, tc1.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingEmpty() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei, mat));\r\n+\r\n+\t\t//checks that if the same sei is imported and everything is empty, it stays empty\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", tc.getTestString(), tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", tc.getTestBool(), tc1.getTestBool());\r\n+\t\tassertEquals(tc.getTestFloat(), tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnum\", tc.getTestEnum(), tc1.getTestEnum());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesChangeNothingValues() throws IOException {\r\n+\t\tTestCategoryAllProperty tc = new TestCategoryAllProperty(testConcept);\r\n+\t\ttsei.add(tc);\r\n+\t\ttc.setTestBool(TEST_BOOL);\r\n+\t\ttc.setTestFloat(TEST_FLOAT);\r\n+\t\ttc.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc.setTestString(TEST_STRING);\r\n+\t\ttc.setTestInt(TEST_INT);\r\n+\t\tURI testUri = URI.createPlatformPluginURI(\"Testresource\", true);\r\n+\t\ttc.setTestResource(testUri);\r\n+\t\tmat = exporter.exportSei(sei);\r\n+\r\n+\t\tTestStructuralElement tsei2 = new TestStructuralElement(testConcept);\r\n+\t\tStructuralElementInstance sei2 = tsei2.getStructuralElementInstance();\r\n+\t\tsei2.setName(TEST_SEI);\r\n+\t\tsei2.setUuid(sei.getUuid());\r\n+\t\tTestCategoryAllProperty tc1 = new TestCategoryAllProperty(testConcept);\r\n+\t\ttc1.setTestBool(TEST_BOOL);\r\n+\t\ttc1.setTestFloat(TEST_FLOAT);\r\n+\t\ttc1.setTestEnum(TEST_ENUM_VALUE);\r\n+\t\ttc1.setTestString(TEST_STRING);\r\n+\t\ttc1.setTestInt(TEST_INT);\r\n+\t\ttc1.setTestResource(testUri);\r\n+\t\ttsei2.add(tc1);\r\n+\t\teditingDomain.getCommandStack().execute(importer.importSei(editingDomain, sei, mat));\r\n+\r\n+\t\t//checks if the same seiis imported and everything has a value, the value doesnt change\r\n+\t\tEList<APropertyInstance> caSei = sei.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tEList<APropertyInstance> caSei2 = sei2.getCategoryAssignments().get(0).getPropertyInstances();\r\n+\t\tassertTrue(\"same number of elements\", caSei.size() == caSei2.size());\r\n+\t\tassertEquals(\"same testString\", TEST_STRING, tc1.getTestString());\r\n+\t\tassertEquals(\"same testBool\", TEST_BOOL, tc1.getTestBool());\r\n+\t\tassertEquals(TEST_FLOAT, tc1.getTestFloat(), 0);\r\n+\t\tassertEquals(\"same testResource\", tc.getTestResource(), tc1.getTestResource());\r\n+\t\tassertEquals(\"same testEnumValue\", tc.getTestEnumBean().getValue(), tc1.getTestEnumBean().getValue());\r\n+\t\tassertEquals(\"same testEnumValue\", tc.getTestEnumBean().getUnit(), tc1.getTestEnumBean().getUnit());\r\n+\t\tassertEquals(\"same testInt\", TEST_INT, tc1.getTestInt());\r\n+\t}\r\n+\r\n+\t@Test\r\n+\tpublic void testImportOfValuesRef() throws IOException {\r\n+\t\t//Reference test target\r\n+\t\tfinal TestCategoryAllProperty TEST_REFERENCE_TARGET = new TestCategoryAllProperty(testConcept);\r\n+\t\t\r\n+\t\t//empty and import empty\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0MDk4OA=="}, "originalCommit": {"oid": "a9848b2573d5eaba26964959168c25c5473aaa51"}, "originalPosition": 302}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 701, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}