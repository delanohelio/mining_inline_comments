{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1MTM0MDYx", "number": 433, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODoyNjozMFrODayz2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo1MDozMVrODc90Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDIyMDQzOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.excel.test/src/de/dlr/sc/virsat/excel/test/ExcelTestActivator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODoyNjozMFrOFh6pbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODoyNjozMFrOFh6pbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEwODIwNg==", "bodyText": "We could make this into URL url = new URL(\"platform:/plugin/\" + FRAGMENT_ID + resourcePath);", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r371108206", "createdAt": "2020-01-27T08:26:30Z", "author": {"login": "SaMuellerDLR"}, "path": "de.dlr.sc.virsat.excel.test/src/de/dlr/sc/virsat/excel/test/ExcelTestActivator.java", "diffHunk": "@@ -39,7 +37,6 @@ public static InputStream getResourceContentAsString(String resourcePath) throws\n \t\tURL url;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f536a6ecee5eedf66ea0de7cff34670a39bc9f99"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDM1MjgxOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.funcelectrical.test/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/importer/FuncElecImporterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwOToxNjoxNlrOFh73dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwOToxNjoxNlrOFh73dA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEyODE4MA==", "bodyText": "We use _ for separating single words in constant names. So NUMBEROFINTERFACES should be NUMBER_OF_INTERFACES.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r371128180", "createdAt": "2020-01-27T09:16:16Z", "author": {"login": "SaMuellerDLR"}, "path": "de.dlr.sc.virsat.model.extension.funcelectrical.test/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/importer/FuncElecImporterTest.java", "diffHunk": "@@ -31,51 +31,48 @@\n \r\n /**\r\n  * Test Case for Importing from Excel\r\n- * \r\n- * @author bell_er\r\n- *\r\n  */\r\n public class FuncElecImporterTest extends ExcelTestCase {\r\n \r\n \t@Before\r\n \tpublic void setUp() throws CoreException {\r\n \t\tsuper.setUp();\r\n \t\tiface.getTypeInstance().setUuid(new VirSatUuid(\"dc928367-36b7-479c-8aaf-38291f394902\"));\r\n-\t\tec.add(iface2);\r\n+\t\telementConf.add(iface2);\r\n \t}\r\n \r\n \t@Test\r\n \tpublic void testImportInterfaceTypeCollection() throws IOException {\r\n-\t\tInputStream is = Activator.getResourceContentAsString(\"/resources/ImportInterfaceTypeCollectionTest.xlsx\");\r\n-\t\tXSSFWorkbook wb = new XSSFWorkbook(is);\r\n+\t\tInputStream iStream = Activator.getResourceContentAsString(\"/resources/ImportInterfaceTypeCollectionTest.xlsx\");\r\n+\t\tXSSFWorkbook wb = new XSSFWorkbook(iStream);\r\n+\r\n+\t\tFuncElecImporter feImporter = new FuncElecImporter();\r\n \r\n-\t\tFuncElecImporter ei = new FuncElecImporter();\r\n-\t\t\r\n-\t\tList<Fault> faults = ei.validate(itc.getStructuralElementInstance(), wb);\r\n+\t\tList<Fault> faults = feImporter.validate(ifaceTypeCollection.getStructuralElementInstance(), wb);\r\n \t\tassertTrue(\"Succesfully called the validator\", faults.isEmpty());\r\n-\t\t\r\n-\t\tei.importExcel(itc.getStructuralElementInstance(), repository, wb);\r\n-\t\tassertEquals(THREE, itc.getStructuralElementInstance().getCategoryAssignments().size());\r\n-\t\tassertEquals(\"FILL\", itc.getStructuralElementInstance().getCategoryAssignments().get(0).getName());\r\n-\t\tassertEquals(\"HILL\", itc.getStructuralElementInstance().getCategoryAssignments().get(1).getName());\r\n-\t\tassertEquals(\"PILL\", itc.getStructuralElementInstance().getCategoryAssignments().get(2).getName());\r\n+\r\n+\t\tfeImporter.importExcel(ifaceTypeCollection.getStructuralElementInstance(), repository, wb);\r\n+\t\tassertEquals(NUMBEROFINTERFACES, ifaceTypeCollection.getStructuralElementInstance().getCategoryAssignments().size());\r\n+\t\tassertEquals(\"FILL\", ifaceTypeCollection.getStructuralElementInstance().getCategoryAssignments().get(0).getName());\r\n+\t\tassertEquals(\"HILL\", ifaceTypeCollection.getStructuralElementInstance().getCategoryAssignments().get(1).getName());\r\n+\t\tassertEquals(\"PILL\", ifaceTypeCollection.getStructuralElementInstance().getCategoryAssignments().get(2).getName());\r\n \t}\r\n \r\n \t@Test\r\n \tpublic void testImportInterfaceEnds() throws IOException {\r\n-\t\tInputStream is = Activator.getResourceContentAsString(\"/resources/ImportElementDefinitionTest.xlsx\");\r\n-\t\tXSSFWorkbook wb = new XSSFWorkbook(is);\r\n+\t\tInputStream iStream = Activator.getResourceContentAsString(\"/resources/ImportElementDefinitionTest.xlsx\");\r\n+\t\tXSSFWorkbook wb = new XSSFWorkbook(iStream);\r\n+\r\n+\t\trepository.getRootEntities().add(ifaceTypeCollection.getStructuralElementInstance());\r\n+\t\tFuncElecImporter feImporter = new FuncElecImporter();\r\n \r\n-\t\trepository.getRootEntities().add(itc.getStructuralElementInstance());\r\n-\t\tFuncElecImporter ei = new FuncElecImporter();\r\n-\t\t\r\n-\t\tList<Fault> faults = ei.validate(ed.getStructuralElementInstance(), wb);\r\n+\t\tList<Fault> faults = feImporter.validate(elementDef.getStructuralElementInstance(), wb);\r\n \t\tassertTrue(\"Succesfully called the validator\", faults.isEmpty());\r\n-\t\t\r\n-\t\tei.importExcel(ed.getStructuralElementInstance(), repository, wb);\r\n+\r\n+\t\tfeImporter.importExcel(elementDef.getStructuralElementInstance(), repository, wb);\r\n \t\tBeanCategoryAssignmentHelper bCaHelper = new BeanCategoryAssignmentHelper();\r\n-\t\tList<InterfaceEnd> seiInterfaceEnds = bCaHelper.getAllBeanCategories(ed.getStructuralElementInstance(), InterfaceEnd.class);\r\n-\t\tassertEquals(THREE, ed.getStructuralElementInstance().getCategoryAssignments().size());\r\n+\t\tList<InterfaceEnd> seiInterfaceEnds = bCaHelper.getAllBeanCategories(elementDef.getStructuralElementInstance(), InterfaceEnd.class);\r\n+\t\tassertEquals(NUMBEROFINTERFACES, elementDef.getStructuralElementInstance().getCategoryAssignments().size());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f536a6ecee5eedf66ea0de7cff34670a39bc9f99"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMTQ4MzA0OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.excel.ui/src/de/dlr/sc/virsat/excel/ui/wizards/ExportPage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODoyMjoxN1rOFi_4Sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxMTo0ODo0MlrOFjFqww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI0MjUwNg==", "bodyText": "Tabs/spaces inconsistency. I think we decided on using spaces a while time ago, so let's at least not change it back to tabs.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372242506", "createdAt": "2020-01-29T08:22:17Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.excel.ui/src/de/dlr/sc/virsat/excel/ui/wizards/ExportPage.java", "diffHunk": "@@ -188,18 +181,18 @@ private void createTemplateUI() {\n \t\tcomposite1.setLayout(new GridLayout(ROWS, false));\r\n \t\tGridData data = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r\n \t\tcomposite1.setLayoutData(data);\r\n-\t\t\r\n+\r\n \t\tlabel2 = new Label(composite1, SWT.SHADOW_IN);\r\n \t\tlabel2.setText(\"Select the template \");\r\n \t\tnew Label(composite1, SWT.NONE);\r\n \t\tnew Label(composite1, SWT.NONE);\r\n-\t\t\r\n+\r\n \t\tlabel1 = new Label(composite1, SWT.NONE);\r\n-\t\tlabel1.setText(\"Template\");\t\t\r\n-\t\t\r\n-        // destination name entry field\r\n+\t\tlabel1.setText(\"Template\");\r\n+\r\n+\t\t// destination name entry field\r\n \t\ttemplateField = new Combo(composite1, SWT.SINGLE | SWT.BORDER);\r\n-        data = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r\n+\t\tdata = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjMzNzM0Nw==", "bodyText": "done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372337347", "createdAt": "2020-01-29T11:48:42Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.excel.ui/src/de/dlr/sc/virsat/excel/ui/wizards/ExportPage.java", "diffHunk": "@@ -188,18 +181,18 @@ private void createTemplateUI() {\n \t\tcomposite1.setLayout(new GridLayout(ROWS, false));\r\n \t\tGridData data = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r\n \t\tcomposite1.setLayoutData(data);\r\n-\t\t\r\n+\r\n \t\tlabel2 = new Label(composite1, SWT.SHADOW_IN);\r\n \t\tlabel2.setText(\"Select the template \");\r\n \t\tnew Label(composite1, SWT.NONE);\r\n \t\tnew Label(composite1, SWT.NONE);\r\n-\t\t\r\n+\r\n \t\tlabel1 = new Label(composite1, SWT.NONE);\r\n-\t\tlabel1.setText(\"Template\");\t\t\r\n-\t\t\r\n-        // destination name entry field\r\n+\t\tlabel1.setText(\"Template\");\r\n+\r\n+\t\t// destination name entry field\r\n \t\ttemplateField = new Combo(composite1, SWT.SINGLE | SWT.BORDER);\r\n-        data = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r\n+\t\tdata = new GridData(GridData.HORIZONTAL_ALIGN_FILL | GridData.GRAB_HORIZONTAL);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI0MjUwNg=="}, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMTUwNjgyOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.funcelectrical/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/exporter/FuncElecExporter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODozMToyOVrOFjAGnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODozMToyOVrOFjAGnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI0NjE3Mw==", "bodyText": "I think we will get the error message printed anyways because we are passing the exception.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372246173", "createdAt": "2020-01-29T08:31:29Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.funcelectrical/src/de/dlr/sc/virsat/model/extension/funcelectrical/excel/exporter/FuncElecExporter.java", "diffHunk": "@@ -42,69 +42,60 @@\n import de.dlr.sc.virsat.model.extension.ps.model.ElementOccurence;\r\n import de.dlr.sc.virsat.model.extension.ps.model.ElementRealization;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class FuncElecExporter implements IExport {\r\n \tprivate final String defaultTemplatePath = \"/resources/ExcelExportTemplate.xlsx\";\r\n \tprivate ExcelExportHelper helper;\r\n \r\n-\tpublic static final String[] EXPORTABLE_SEIS = { \r\n+\tpublic static final String[] EXPORTABLE_SEIS = {\r\n \t\t\tElementDefinition.class.getSimpleName(),\r\n-\t\t\tElementConfiguration.class.getSimpleName(), \r\n-\t\t\tInterfaceTypeCollection.class.getSimpleName(), \r\n+\t\t\tElementConfiguration.class.getSimpleName(),\r\n+\t\t\tInterfaceTypeCollection.class.getSimpleName(),\r\n \t\t\tElementRealization.class.getSimpleName(),\r\n \t\t\tElementOccurence.class.getSimpleName()\r\n \t};\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n \t\tStructuralElementInstance parentSc = (StructuralElementInstance) eObject;\r\n-\t\tArrayList <StructuralElementInstance> allSei = new ArrayList<StructuralElementInstance>();\r\n-\t\tallSei.add(parentSc);\r\n-\t\tallSei.addAll(parentSc.getDeepChildren());\r\n-\t\tfor (StructuralElementInstance sc : allSei) {\r\n-\t\t\tString selectedSEIType = sc.getType().getName();\r\n+\t\tArrayList <StructuralElementInstance> seiList = new ArrayList<StructuralElementInstance>();\r\n+\t\tseiList.add(parentSc);\r\n+\t\tseiList.addAll(parentSc.getDeepChildren());\r\n+\t\tfor (StructuralElementInstance sei : seiList) {\r\n+\t\t\tString selectedSEIType = sei.getType().getName();\r\n \t\t\tif (Stream.of(EXPORTABLE_SEIS).anyMatch(exportable -> exportable.equals(selectedSEIType))) {\r\n-\t\t\t\tInputStream is = null;\r\n+\t\t\t\tInputStream iStream = null;\r\n \t\t\t\ttry {\r\n \t\t\t\t\tif (useDefaultTemplate) {\r\n-\t\t\t\t\t\tis = Activator.getResourceContentAsString(defaultTemplatePath);\r\n+\t\t\t\t\t\tiStream = Activator.getResourceContentAsString(defaultTemplatePath);\r\n \t\t\t\t\t} else {\r\n-\t\t\t\t\t\tis = Activator.getResourceContentAsString(templatePath);\r\n+\t\t\t\t\t\tiStream = Activator.getResourceContentAsString(templatePath);\r\n \t\t\t\t\t}\r\n-\t\t\t\t} catch (IOException e) {\r\n-\t\t\t\t\tActivator.getDefault().getLog().log(new Status(Status.WARNING, Activator.getPluginId(), \"Could not locate the template file\"));\r\n-\t\t\t\t}\r\n-\t\t\t\texport(sc, is);\r\n-\r\n-\t\t\t\tFile file = new File(path + \"/\" + sc.getFullQualifiedInstanceName() + \".xlsx\");\r\n-\t\t\t\ttry {\r\n+\t\t\t\t\texport(sei, iStream);\r\n+\t\t\t\t\tFile file = new File(path + \"/\" + sei.getFullQualifiedInstanceName() + \".xlsx\");\r\n \t\t\t\t\tFileOutputStream out = new FileOutputStream(file);\r\n \t\t\t\t\thelper.getWb().write(out);\r\n \t\t\t\t} catch (IOException e) {\r\n-\t\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \", e);\r\n+\t\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \\n\" + e.getMessage(), e);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMTUyNTQwOnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.statemachines.test/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/ExcelImporterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODozODozNFrOFjARzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxMTo0ODo1M1rOFjFrDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI0OTAzOQ==", "bodyText": "Let's maybe rename it to elementDefinition instead of aBeanSei?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372249039", "createdAt": "2020-01-29T08:38:34Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.statemachines.test/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/ExcelImporterTest.java", "diffHunk": "@@ -37,37 +37,33 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Test Case for Importing from Excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class ExcelImporterTest {\r\n \tprivate static final String CONCEPT_ID_MACHINES = \"de.dlr.sc.virsat.model.extension.statemachines\";\r\n \r\n-\tprivate static final int FIVE = 5;\r\n-\tprivate static final int FOUR = 4;\r\n-\tprivate static final int EXPECTEDSTATECOUNT = 4;\r\n-\tprivate static final int EXPECTEDTRANSITIONCOUNT = 4;\r\n-\t\r\n-\tABeanStructuralElementInstance ed;\r\n+\tprivate static final int STATE_NOT_EXISTING = 6;\r\n+\tprivate static final int STATE_WITHOUT_UUID = 5;\r\n+\tprivate static final int STATE_WITHOUT_NAME = 3;\r\n+\tprivate static final int EXPECTED_STATECOUNT = 4;\r\n+\tprivate static final int EXPECTED_TRANSITIONCOUNT = 4;\r\n+\r\n+\tABeanStructuralElementInstance aBeanSei;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjMzNzQyMw==", "bodyText": "done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372337423", "createdAt": "2020-01-29T11:48:53Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.statemachines.test/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/ExcelImporterTest.java", "diffHunk": "@@ -37,37 +37,33 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Test Case for Importing from Excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class ExcelImporterTest {\r\n \tprivate static final String CONCEPT_ID_MACHINES = \"de.dlr.sc.virsat.model.extension.statemachines\";\r\n \r\n-\tprivate static final int FIVE = 5;\r\n-\tprivate static final int FOUR = 4;\r\n-\tprivate static final int EXPECTEDSTATECOUNT = 4;\r\n-\tprivate static final int EXPECTEDTRANSITIONCOUNT = 4;\r\n-\t\r\n-\tABeanStructuralElementInstance ed;\r\n+\tprivate static final int STATE_NOT_EXISTING = 6;\r\n+\tprivate static final int STATE_WITHOUT_UUID = 5;\r\n+\tprivate static final int STATE_WITHOUT_NAME = 3;\r\n+\tprivate static final int EXPECTED_STATECOUNT = 4;\r\n+\tprivate static final int EXPECTED_TRANSITIONCOUNT = 4;\r\n+\r\n+\tABeanStructuralElementInstance aBeanSei;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI0OTAzOQ=="}, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMTUzMTk0OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/exporter/StateMachineExporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODo0MToxM1rOFjAVtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxMjowNDo0M1rOFjGFHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI1MDAzOQ==", "bodyText": "I think the error message will be printed anyways, so we can remove it from our message.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372250039", "createdAt": "2020-01-29T08:41:13Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/exporter/StateMachineExporter.java", "diffHunk": "@@ -34,57 +34,45 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class StateMachineExporter extends ExcelExportHelper implements IExport {\r\n-\t\r\n+\r\n \tCategoryAssignment exportCa;\r\n-\t\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n-\t\tif (eObject instanceof CategoryAssignment) {\t\t\r\n+\t\tif (eObject instanceof CategoryAssignment) {\r\n \t\t\tCategoryAssignment ca = (CategoryAssignment) eObject;\r\n \t\t\tfinal String defaultTemplatePath = \"/resources/StateMachineExportTemplate.xlsx\";\r\n \t\t\t// find the export template\r\n \t\t\ttry {\r\n-\t\t\t\tInputStream is = null;\r\n+\t\t\t\tInputStream iStream = null;\r\n \t\t\t\tif (useDefaultTemplate) {\r\n-\t\t\t\t\tis = Activator.getResourceContentAsString(defaultTemplatePath);\r\n+\t\t\t\t\tiStream = Activator.getResourceContentAsString(defaultTemplatePath);\r\n \t\t\t\t} else {\r\n-\t\t\t\t\tis = new FileInputStream(templatePath);\r\n+\t\t\t\t\tiStream = new FileInputStream(templatePath);\r\n \t\t\t\t}\r\n-\t\t\t\twb = new XSSFWorkbook(is);\r\n-\t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to find the Template!\", e);\r\n-\t\t\t\tActivator.getDefault().getLog().log(status);\r\n-\t\t\t}\r\n-\t\t\t\r\n-\t\t\texportData(ca);\r\n-\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n-\t\t\t// and write the results\t\r\n-\t\t\tFile file = new File(newPath);\r\n-\t\t\ttry {\r\n+\t\t\t\twb = new XSSFWorkbook(iStream);\r\n+\t\t\t\texportData(ca);\r\n+\t\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n+\t\t\t\t// and write the results\r\n+\t\t\t\tFile file = new File(newPath);\r\n+\t\t\t\t// find the export destination\r\n \t\t\t\tFileOutputStream out = new FileOutputStream(file);\r\n \t\t\t\twb.write(out);\r\n \t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation!\", e);\r\n+\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \\n\" + e.getMessage(), e);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjM0NDA5Mg==", "bodyText": "There are two different Errors and I wanted to show the User where the problem is in the Dialogbox.", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372344092", "createdAt": "2020-01-29T12:04:43Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/exporter/StateMachineExporter.java", "diffHunk": "@@ -34,57 +34,45 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for exporting excel\r\n- * @author bell_er\r\n- *\r\n  */\r\n public class StateMachineExporter extends ExcelExportHelper implements IExport {\r\n-\t\r\n+\r\n \tCategoryAssignment exportCa;\r\n-\t\r\n+\r\n \t@Override\r\n \tpublic void export(EObject eObject, String path, boolean useDefaultTemplate, String templatePath) {\r\n-\t\tif (eObject instanceof CategoryAssignment) {\t\t\r\n+\t\tif (eObject instanceof CategoryAssignment) {\r\n \t\t\tCategoryAssignment ca = (CategoryAssignment) eObject;\r\n \t\t\tfinal String defaultTemplatePath = \"/resources/StateMachineExportTemplate.xlsx\";\r\n \t\t\t// find the export template\r\n \t\t\ttry {\r\n-\t\t\t\tInputStream is = null;\r\n+\t\t\t\tInputStream iStream = null;\r\n \t\t\t\tif (useDefaultTemplate) {\r\n-\t\t\t\t\tis = Activator.getResourceContentAsString(defaultTemplatePath);\r\n+\t\t\t\t\tiStream = Activator.getResourceContentAsString(defaultTemplatePath);\r\n \t\t\t\t} else {\r\n-\t\t\t\t\tis = new FileInputStream(templatePath);\r\n+\t\t\t\t\tiStream = new FileInputStream(templatePath);\r\n \t\t\t\t}\r\n-\t\t\t\twb = new XSSFWorkbook(is);\r\n-\t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to find the Template!\", e);\r\n-\t\t\t\tActivator.getDefault().getLog().log(status);\r\n-\t\t\t}\r\n-\t\t\t\r\n-\t\t\texportData(ca);\r\n-\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n-\t\t\t// and write the results\t\r\n-\t\t\tFile file = new File(newPath);\r\n-\t\t\ttry {\r\n+\t\t\t\twb = new XSSFWorkbook(iStream);\r\n+\t\t\t\texportData(ca);\r\n+\t\t\t\tString newPath = path + \"/\" + ca.getFullQualifiedInstanceName() + \".xlsx\";\r\n+\t\t\t\t// and write the results\r\n+\t\t\t\tFile file = new File(newPath);\r\n+\t\t\t\t// find the export destination\r\n \t\t\t\tFileOutputStream out = new FileOutputStream(file);\r\n \t\t\t\twb.write(out);\r\n \t\t\t} catch (IOException e) {\r\n-\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation!\", e);\r\n+\t\t\t\tStatus status = new Status(Status.ERROR, Activator.getPluginId(), \"Failed to perform an export operation! \\n\" + e.getMessage(), e);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI1MDAzOQ=="}, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMTUzNzE3OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/SMImporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwODo0MzoxMlrOFjAY1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxMTo1MDoyOFrOFjFtpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI1MDgzNg==", "bodyText": "Looks like there is a wrong line ending here, let's fix it", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372250836", "createdAt": "2020-01-29T08:43:12Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/SMImporter.java", "diffHunk": "@@ -28,59 +28,51 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for Importing Excel files.\r\n- * \r\n- * @author bell_er\r\n- *\r\n  */\r\n public class SMImporter implements IImport {\r\n \tprivate XSSFWorkbook wb;\r\n-\tprivate StateMachine sm;\r\n+\tprivate StateMachine stateMaschine;\r\n \tprivate Concept concept;\r\n-\t\r\n+\r\n \t@Override\r\n \tpublic void importExcel(EObject eObject, Repository repository, XSSFWorkbook wb) {\r\n \t\tinit(eObject, repository, wb);\r\n \t\timportStates();\r\n \t\timportTransitions();\r\n \t}\r\n-\t\r\n+\r\n \t/**\r\n-\t * imports the transitions \r\n-\t * \r\n-\t * @author  Bell_er\r\n+\t * imports the transitions\r\n \t */\r\tprivate void importTransitions() {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjMzODA4NQ==", "bodyText": "hopefully done", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r372338085", "createdAt": "2020-01-29T11:50:28Z", "author": {"login": "ALEhmerDLR"}, "path": "de.dlr.sc.virsat.model.extension.statemachines/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/SMImporter.java", "diffHunk": "@@ -28,59 +28,51 @@\n import de.dlr.sc.virsat.model.extension.statemachines.model.StateMachine;\r\n import de.dlr.sc.virsat.model.extension.statemachines.model.Transition;\r\n \r\n-\r\n-\r\n-\r\n /**\r\n  * Class for Importing Excel files.\r\n- * \r\n- * @author bell_er\r\n- *\r\n  */\r\n public class SMImporter implements IImport {\r\n \tprivate XSSFWorkbook wb;\r\n-\tprivate StateMachine sm;\r\n+\tprivate StateMachine stateMaschine;\r\n \tprivate Concept concept;\r\n-\t\r\n+\r\n \t@Override\r\n \tpublic void importExcel(EObject eObject, Repository repository, XSSFWorkbook wb) {\r\n \t\tinit(eObject, repository, wb);\r\n \t\timportStates();\r\n \t\timportTransitions();\r\n \t}\r\n-\t\r\n+\r\n \t/**\r\n-\t * imports the transitions \r\n-\t * \r\n-\t * @author  Bell_er\r\n+\t * imports the transitions\r\n \t */\r\tprivate void importTransitions() {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI1MDgzNg=="}, "originalCommit": {"oid": "1cd339fa093b6fd32c3fd4c6299ae2839aff1209"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNjk5Mjc2OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.model.extension.statemachines.test/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/ExcelImporterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo0OTozMlrOFlS5CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo0OTozMlrOFlS5CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY1MTE0NA==", "bodyText": "Inconsistent whitespace", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r374651144", "createdAt": "2020-02-04T12:49:32Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.model.extension.statemachines.test/src/de/dlr/sc/virsat/model/extension/statemachines/excel/importer/ExcelImporterTest.java", "diffHunk": "@@ -60,9 +60,9 @@ public void setUp() throws Exception {\n \r\n \t\tUserRegistry.getInstance().setSuperUser(true);\r\n \r\n-\t\tconceptStateMachines = ConceptXmiLoader.loadConceptFromPlugin(CONCEPT_ID_MACHINES + \"/concept/concept.xmi\");\r\n+\t    conceptStateMachines = ConceptXmiLoader.loadConceptFromPlugin(CONCEPT_ID_MACHINES + \"/concept/concept.xmi\");\r\n \r\n-\t\tstateMaschine = new StateMachine(conceptStateMachines);\r\n+\t    stateMaschine = new StateMachine(conceptStateMachines);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b519ba1ec1cbc3f5d70fd6e85d229c8c2deb9ae"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNjk5NTE1OnYy", "diffSide": "RIGHT", "path": "de.dlr.sc.virsat.excel.ui/src/de/dlr/sc/virsat/excel/ui/wizards/ExportPage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo1MDozMVrOFlS6gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo1MDozMVrOFlS6gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY1MTUyMg==", "bodyText": "The whole file is a whitespace mess. Let's maybe reformat everything in this file to tabs for now?", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/433#discussion_r374651522", "createdAt": "2020-02-04T12:50:31Z", "author": {"login": "andriikovalov-dlr"}, "path": "de.dlr.sc.virsat.excel.ui/src/de/dlr/sc/virsat/excel/ui/wizards/ExportPage.java", "diffHunk": "@@ -190,9 +190,9 @@ private void createTemplateUI() {\n \t\tlabel1 = new Label(composite1, SWT.NONE);\r\n \t\tlabel1.setText(\"Template\");\r\n \r\n-\t\t// destination name entry field\r\n+        // destination name entry field\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b519ba1ec1cbc3f5d70fd6e85d229c8c2deb9ae"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 662, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}