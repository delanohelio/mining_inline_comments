{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyOTAwMDUw", "number": 101, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMTo0Njo1NlrODknjsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowODo0MVrODkn8vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NzIzNDQyOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirMedicationDaoImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMTo0Njo1NlrOFxCneA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMTo0Njo1NlrOFxCneA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk2NzQxNg==", "bodyText": "Add private modifier", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/101#discussion_r386967416", "createdAt": "2020-03-03T11:46:56Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/impl/FhirMedicationDaoImpl.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.dao.impl;\n+\n+import static org.hibernate.criterion.Restrictions.eq;\n+\n+import javax.inject.Inject;\n+import javax.inject.Named;\n+\n+import lombok.AccessLevel;\n+import lombok.Setter;\n+import org.hibernate.SessionFactory;\n+import org.openmrs.Drug;\n+import org.openmrs.module.fhir2.api.dao.FhirMedicationDao;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+@Setter(AccessLevel.PACKAGE)\n+public class FhirMedicationDaoImpl implements FhirMedicationDao {\n+\t\n+\t@Inject\n+\t@Named(\"sessionFactory\")\n+\tSessionFactory sessionFactory;\n+\t", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8b6a5166fad4c324bb039d09fca3d24652d6a0"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NzI2NjMzOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirMedicationServiceImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMTo1NzozNFrOFxC65Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMTo1NzozNFrOFxC65Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk3MjM4OQ==", "bodyText": "@Transactional(readOnly = true)", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/101#discussion_r386972389", "createdAt": "2020-03-03T11:57:34Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirMedicationServiceImpl.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.impl;\n+\n+import javax.inject.Inject;\n+\n+import lombok.AccessLevel;\n+import lombok.Setter;\n+import org.hl7.fhir.r4.model.Medication;\n+import org.openmrs.module.fhir2.api.FhirMedicationService;\n+import org.openmrs.module.fhir2.api.dao.FhirMedicationDao;\n+import org.openmrs.module.fhir2.api.translators.MedicationTranslator;\n+import org.springframework.stereotype.Component;\n+import org.springframework.transaction.annotation.Transactional;\n+\n+@Component\n+@Transactional\n+@Setter(AccessLevel.PACKAGE)\n+public class FhirMedicationServiceImpl implements FhirMedicationService {\n+\t\n+\t@Inject\n+\tprivate MedicationTranslator medicationTranslator;\n+\t\n+\t@Inject\n+\tprivate FhirMedicationDao medicationDao;\n+\t\n+\t@Override\n+\t@Transactional\n+\tpublic Medication getMedicationByUuid(String uuid) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8b6a5166fad4c324bb039d09fca3d24652d6a0"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NzI5MDIyOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/MedicationTranslatorImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowNTo0NFrOFxDJOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowNTo0NFrOFxDJOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk3NjA1OA==", "bodyText": "Instead of this, use conceptTranslator\n@Inject\nprivate ConceptTranslator conceptTranslator;\n\nexistingDrug.setConcept(conceptTranslator.toOpenmrsType(med.getCode()));", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/101#discussion_r386976058", "createdAt": "2020-03-03T12:05:44Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/MedicationTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import javax.inject.Inject;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+\n+import lombok.AccessLevel;\n+import lombok.Setter;\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Coding;\n+import org.hl7.fhir.r4.model.Medication;\n+import org.openmrs.Drug;\n+import org.openmrs.DrugIngredient;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.FhirConceptService;\n+import org.openmrs.module.fhir2.api.translators.MedicationTranslator;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+@Setter(AccessLevel.PACKAGE)\n+public class MedicationTranslatorImpl implements MedicationTranslator {\n+\t\n+\t@Inject\n+\tprivate FhirConceptService conceptService;\n+\t\n+\t@Override\n+\tpublic Medication toFhirResource(Drug drug) {\n+\t\tif (drug == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\t\n+\t\tMedication medication = new Medication();\n+\t\tmedication.setId(drug.getUuid());\n+\t\tmedication.setCode(new CodeableConcept().addCoding(new Coding(FhirConstants.MEDICATION_CODES_VALUE_SET_URI,\n+\t\t        drug.getConcept().getUuid(), drug.getConcept().getDisplayString())));\n+\t\tmedication.setForm(new CodeableConcept().addCoding(new Coding(FhirConstants.MEDICATION_FORM_VALUE_SET_URI,\n+\t\t        drug.getDosageForm().getUuid(), drug.getDosageForm().getDisplayString())));\n+\t\t\n+\t\tMedication.MedicationIngredientComponent ingredient = new Medication.MedicationIngredientComponent();\n+\t\tCodeableConcept ingredientCode = new CodeableConcept();\n+\t\tfor (DrugIngredient val : drug.getIngredients()) {\n+\t\t\tingredientCode.addCoding(new Coding(FhirConstants.MEDICATION_INGREDIENT_VALUE_SET_URI,\n+\t\t\t        val.getIngredient().getUuid(), val.getIngredient().getDisplayString()));\n+\t\t\t\n+\t\t\tingredient.setItem(ingredientCode);\n+\t\t}\n+\t\tmedication.addIngredient(ingredient);\n+\t\t\n+\t\treturn medication;\n+\t}\n+\t\n+\t@Override\n+\tpublic Drug toOpenmrsType(Drug existingDrug, Medication med) {\n+\t\tif (med == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\texistingDrug.setUuid(med.getId());\n+\t\t\n+\t\tif (med.hasCode()) {\n+\t\t\texistingDrug\n+\t\t\t        .setConcept(conceptService.getConceptByUuid(med.getCode().getCoding().get(0).getCode()).orElse(null));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8b6a5166fad4c324bb039d09fca3d24652d6a0"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NzI5MTM3OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/MedicationTranslatorImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowNjowM1rOFxDJ5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowNjowM1rOFxDJ5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk3NjIzMQ==", "bodyText": "Ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/101#discussion_r386976231", "createdAt": "2020-03-03T12:06:03Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/MedicationTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import javax.inject.Inject;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+\n+import lombok.AccessLevel;\n+import lombok.Setter;\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Coding;\n+import org.hl7.fhir.r4.model.Medication;\n+import org.openmrs.Drug;\n+import org.openmrs.DrugIngredient;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.FhirConceptService;\n+import org.openmrs.module.fhir2.api.translators.MedicationTranslator;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+@Setter(AccessLevel.PACKAGE)\n+public class MedicationTranslatorImpl implements MedicationTranslator {\n+\t\n+\t@Inject\n+\tprivate FhirConceptService conceptService;\n+\t\n+\t@Override\n+\tpublic Medication toFhirResource(Drug drug) {\n+\t\tif (drug == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\t\n+\t\tMedication medication = new Medication();\n+\t\tmedication.setId(drug.getUuid());\n+\t\tmedication.setCode(new CodeableConcept().addCoding(new Coding(FhirConstants.MEDICATION_CODES_VALUE_SET_URI,\n+\t\t        drug.getConcept().getUuid(), drug.getConcept().getDisplayString())));\n+\t\tmedication.setForm(new CodeableConcept().addCoding(new Coding(FhirConstants.MEDICATION_FORM_VALUE_SET_URI,\n+\t\t        drug.getDosageForm().getUuid(), drug.getDosageForm().getDisplayString())));\n+\t\t\n+\t\tMedication.MedicationIngredientComponent ingredient = new Medication.MedicationIngredientComponent();\n+\t\tCodeableConcept ingredientCode = new CodeableConcept();\n+\t\tfor (DrugIngredient val : drug.getIngredients()) {\n+\t\t\tingredientCode.addCoding(new Coding(FhirConstants.MEDICATION_INGREDIENT_VALUE_SET_URI,\n+\t\t\t        val.getIngredient().getUuid(), val.getIngredient().getDisplayString()));\n+\t\t\t\n+\t\t\tingredient.setItem(ingredientCode);\n+\t\t}\n+\t\tmedication.addIngredient(ingredient);\n+\t\t\n+\t\treturn medication;\n+\t}\n+\t\n+\t@Override\n+\tpublic Drug toOpenmrsType(Drug existingDrug, Medication med) {\n+\t\tif (med == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\texistingDrug.setUuid(med.getId());\n+\t\t\n+\t\tif (med.hasCode()) {\n+\t\t\texistingDrug\n+\t\t\t        .setConcept(conceptService.getConceptByUuid(med.getCode().getCoding().get(0).getCode()).orElse(null));\n+\t\t}\n+\t\t\n+\t\tif (med.hasForm()) {\n+\t\t\texistingDrug\n+\t\t\t        .setDosageForm(conceptService.getConceptByUuid(med.getForm().getCoding().get(0).getCode()).orElse(null));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8b6a5166fad4c324bb039d09fca3d24652d6a0"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NzI5ODUzOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/MedicationTranslator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowODo0MVrOFxDOUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjowODo0MVrOFxDOUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk3NzM2Mg==", "bodyText": "Document this param", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/101#discussion_r386977362", "createdAt": "2020-03-03T12:08:41Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/MedicationTranslator.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators;\n+\n+import org.hl7.fhir.r4.model.Medication;\n+import org.openmrs.Drug;\n+\n+public interface MedicationTranslator extends ToFhirTranslator<Drug, Medication>, UpdatableOpenmrsTranslator<Drug, Medication> {\n+\t\n+\t/**\n+\t * Maps {@link org.openmrs.Drug} to {@link org.hl7.fhir.r4.model.Medication}\n+\t *\n+\t * @param drug the OpenMRS data element to translate\n+\t * @return the corresponding FHIR Medication resource\n+\t */\n+\t@Override\n+\tMedication toFhirResource(Drug drug);\n+\t\n+\t/**\n+\t * Maps {@link org.hl7.fhir.r4.model.Medication} to {@link org.openmrs.Drug}\n+\t *\n+\t * @param existingDrug", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8b6a5166fad4c324bb039d09fca3d24652d6a0"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1109, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}