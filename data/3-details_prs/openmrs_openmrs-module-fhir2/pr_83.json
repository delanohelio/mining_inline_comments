{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MzU1MTU3", "number": 83, "title": "FM2-76: Implement Observation.hasMember", "bodyText": "Description of what I changed\n\n\nCurrently, observations of a group are returned as individual components, this PR aims to return these observations as hasMember fields instead.\nIssue I worked on\n\n\n\n\nsee https://issues.openmrs.org/browse/FM2-76\nChecklist: I completed these to help reviewers :)\n\n\n\n\n My pull request only contains ONE single commit.\nNo? -> read here on how to squash multiple commits into one\n\n\n My IDE is configured to follow the code style of this project.\nNo? Unsure? -> configure your IDE, format the code and add the changes with git add . && git commit --amend\n\n\n I have added tests to cover my changes. (If you refactored\nexisting code that was well tested you do not have to add tests)\nNo? -> write tests and add them to this commit git add . && git commit --amend\n\n\n I ran mvn clean package right before creating this pull request and\nadded all formatting changes to my commit.\nNo? -> execute above command\n\n\n All new and existing tests passed.\nNo? -> figure out why and add the fix to your commit. It is your responsibility to make sure your code works.\n\n\n My pull request is based on the latest changes of the master branch.\nNo? Unsure? -> execute command git pull --rebase upstream master", "createdAt": "2020-02-21T16:04:24Z", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83", "merged": true, "mergeCommit": {"oid": "865dd5253e1b472aaa8b0bfebd09ab7f77b399ea"}, "closed": true, "closedAt": "2020-02-21T19:11:01Z", "author": {"login": "CaptainDaVinci"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGidioAFqTM2Mjc1OTI4NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGkFspAFqTM2MjgzMTAwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNzU5Mjg1", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83#pullrequestreview-362759285", "createdAt": "2020-02-21T16:34:58Z", "commit": {"oid": "b107fd02011723957755112c786495f1f98570ec"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNjozNDo1OVrOFs9Fqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNjozNzo0N1rOFs9Ljw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4MjUzOA==", "bodyText": "This should look something like this:\nreference.setType(\"Observation\").setReference(\"Observation/\" + OBS_UUID);\nI.e., the reference id is not the Obs uuid (since the reference is a different entity for the observation itself).", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83#discussion_r382682538", "createdAt": "2020-02-21T16:34:59Z", "author": {"login": "ibacher"}, "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationTranslatorImplTest.java", "diffHunk": "@@ -199,21 +198,21 @@ public void toFhirResource_shouldConvertObsValueToValue() {\n \t}\n \t\n \t@Test\n-\tpublic void toFhirResource_shouldConvertObsGroupToComponent() {\n+\tpublic void toFhirResource_shouldConvertObsGroupToHasMemberReferences() {\n \t\tObs observation = new Obs();\n \t\tObs childObs = new Obs();\n \t\tchildObs.setUuid(OBS_UUID);\n \t\tobservation.addGroupMember(childObs);\n \t\t\n-\t\tObservation.ObservationComponentComponent component = new Observation.ObservationComponentComponent();\n-\t\tcomponent.setId(OBS_UUID);\n-\t\twhen(observationComponentTranslator.toFhirResource(childObs)).thenReturn(component);\n+\t\tReference reference = new Reference();\n+\t\treference.setId(OBS_UUID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b107fd02011723957755112c786495f1f98570ec"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4MzA0Mg==", "bodyText": "See above.", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83#discussion_r382683042", "createdAt": "2020-02-21T16:35:52Z", "author": {"login": "ibacher"}, "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationTranslatorImplTest.java", "diffHunk": "@@ -252,13 +251,13 @@ public void toOpenmrsType_shouldTranslateCodeToConcept() {\n \t}\n \t\n \t@Test\n-\tpublic void toOpenmrsType_shouldTranslateComponentsToGroupObs() {\n+\tpublic void toOpenmrsType_shouldTranslateHasMemberReferencesToGroupObs() {\n \t\tObservation observation = new Observation();\n-\t\tObservation.ObservationComponentComponent component = observation.addComponent();\n-\t\tcomponent.setId(OBS_UUID);\n+\t\tReference reference = observation.addHasMember();\n+\t\treference.setId(OBS_UUID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b107fd02011723957755112c786495f1f98570ec"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NDA0Nw==", "bodyText": "It's preferable, IMO to use hasItem instead of contains. The test here will also need to be updated to ensure that the type and reference values have been properly set.", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83#discussion_r382684047", "createdAt": "2020-02-21T16:37:47Z", "author": {"login": "ibacher"}, "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationTranslatorImplTest.java", "diffHunk": "@@ -199,21 +198,21 @@ public void toFhirResource_shouldConvertObsValueToValue() {\n \t}\n \t\n \t@Test\n-\tpublic void toFhirResource_shouldConvertObsGroupToComponent() {\n+\tpublic void toFhirResource_shouldConvertObsGroupToHasMemberReferences() {\n \t\tObs observation = new Obs();\n \t\tObs childObs = new Obs();\n \t\tchildObs.setUuid(OBS_UUID);\n \t\tobservation.addGroupMember(childObs);\n \t\t\n-\t\tObservation.ObservationComponentComponent component = new Observation.ObservationComponentComponent();\n-\t\tcomponent.setId(OBS_UUID);\n-\t\twhen(observationComponentTranslator.toFhirResource(childObs)).thenReturn(component);\n+\t\tReference reference = new Reference();\n+\t\treference.setId(OBS_UUID);\n+\t\twhen(observationReferenceTranslator.toFhirResource(childObs)).thenReturn(reference);\n \t\t\n \t\tObservation result = observationTranslator.toFhirResource(observation);\n \t\t\n-\t\tassertThat(result.getComponent(), notNullValue());\n-\t\tassertThat(result.getComponent().size(), equalTo(1));\n-\t\tassertThat(result.getComponent(), contains(hasProperty(\"id\", equalTo(OBS_UUID))));\n+\t\tassertThat(result.getHasMember(), notNullValue());\n+\t\tassertThat(result.getHasMember().size(), equalTo(1));\n+\t\tassertThat(result.getHasMember(), contains(hasProperty(\"id\", equalTo(OBS_UUID))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b107fd02011723957755112c786495f1f98570ec"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cafe6bb791bfe9bfc45b4e69f397c16e093005e7", "author": {"user": {"login": "CaptainDaVinci", "name": "Yash  Kothari"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/cafe6bb791bfe9bfc45b4e69f397c16e093005e7", "committedDate": "2020-02-21T17:39:12Z", "message": "FM2-76: Implement Observation.hasMember"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b107fd02011723957755112c786495f1f98570ec", "author": {"user": {"login": "CaptainDaVinci", "name": "Yash  Kothari"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/b107fd02011723957755112c786495f1f98570ec", "committedDate": "2020-02-21T15:52:24Z", "message": "FM2-76: Implement Observation.hasMember"}, "afterCommit": {"oid": "cafe6bb791bfe9bfc45b4e69f397c16e093005e7", "author": {"user": {"login": "CaptainDaVinci", "name": "Yash  Kothari"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/cafe6bb791bfe9bfc45b4e69f397c16e093005e7", "committedDate": "2020-02-21T17:39:12Z", "message": "FM2-76: Implement Observation.hasMember"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eaa972e91d0efb38b11b986218660423f35ca52c", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/eaa972e91d0efb38b11b986218660423f35ca52c", "committedDate": "2020-02-21T18:32:21Z", "message": "Merge branch 'master' into FM2-76"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODMxMDA0", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/83#pullrequestreview-362831004", "createdAt": "2020-02-21T18:32:26Z", "commit": {"oid": "cafe6bb791bfe9bfc45b4e69f397c16e093005e7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4206, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}