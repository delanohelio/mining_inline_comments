{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMzQzNTI5", "number": 16, "title": "Added search by name for location resource", "bodyText": "Description of what I changed\nAdded ability to search a location using location name\n\n\nIssue I worked on\n\n\n\n\nsee https://issues.openmrs.org/browse/FM2-24\nChecklist: I completed these to help reviewers :)\n\n\n\n\n My pull request only contains ONE single commit.\nNo? -> read here on how to squash multiple commits into one\n\n\n My IDE is configured to follow the code style of this project.\nNo? Unsure? -> configure your IDE, format the code and add the changes with git add . && git commit --amend\n\n\n I have added tests to cover my changes. (If you refactored\nexisting code that was well tested you do not have to add tests)\nNo? -> write tests and add them to this commit git add . && git commit --amend\n\n\n I ran mvn clean package right before creating this pull request and\nadded all formatting changes to my commit.\nNo? -> execute above command\n\n\n All new and existing tests passed.\nNo? -> figure out why and add the fix to your commit. It is your responsibility to make sure your code works.\n\n\n My pull request is based on the latest changes of the master branch.\nNo? Unsure? -> execute command git pull --rebase upstream master", "createdAt": "2020-01-10T09:01:54Z", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16", "merged": true, "mergeCommit": {"oid": "038dbbebed6ed5ba717d9457ff6f861e9f0c298b"}, "closed": true, "closedAt": "2020-01-10T13:32:25Z", "author": {"login": "jecihjoy"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb466zwgBqjI5Mzc4MDkzNzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4-ndRAFqTM0MTE2MjMxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "97711349e3863f7375c40fb7794063064188b64f", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/97711349e3863f7375c40fb7794063064188b64f", "committedDate": "2020-01-10T08:58:22Z", "message": "Added search by name for location resource"}, "afterCommit": {"oid": "2444c0e95760449293fdaeb5c33234fd87413e78", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/2444c0e95760449293fdaeb5c33234fd87413e78", "committedDate": "2020-01-10T09:12:57Z", "message": "Added search by name for location resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2444c0e95760449293fdaeb5c33234fd87413e78", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/2444c0e95760449293fdaeb5c33234fd87413e78", "committedDate": "2020-01-10T09:12:57Z", "message": "Added search by name for location resource"}, "afterCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/a124b26b5b646247a67e6b0ace7745ef0def1ce0", "committedDate": "2020-01-10T09:27:19Z", "message": "Added search by name for location resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMDgyOTAw", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#pullrequestreview-341082900", "createdAt": "2020-01-10T10:42:24Z", "commit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMDo0MjoyNFrOFcQcvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMTowNjowNFrOFcRBzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE3Mzk1MA==", "bodyText": "The method name doesn't match the test", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365173950", "createdAt": "2020-01-10T10:42:24Z", "author": {"login": "corneliouzbett"}, "path": "api/src/test/java/org/openmrs/module/fhir2/api/impl/FhirLocationServiceImplTest.java", "diffHunk": "@@ -62,4 +62,19 @@ public void shouldGetLocationByUuid() {\n \t\torg.hl7.fhir.r4.model.Location result = fhirLocationService.getLocationByUuid(LOCATION_UUID);\n \t\tassertNotNull(location);\n \t}\n+\n+\t@Test\n+\tpublic void shouldGetLocationByName() {\n+\t\tLocation location = new Location();\n+\t\tlocation.setUuid(LOCATION_UUID);\n+\t\tlocation.setName(LOCATION_NAME);\n+\t\tlocation.setDescription(LOCATION_DESCRIPTION);\n+\t\tlocation.setDateCreated(new Date());\n+\t\tlocation.setRetired(false);\n+\n+\t\twhen(locationDao.getLocationByName(LOCATION_UUID)).thenReturn(location);\n+\n+\t\torg.hl7.fhir.r4.model.Location result = fhirLocationService.getLocationByUuid(LOCATION_UUID);\n+\t\tassertNotNull(location);\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE3NTEyMw==", "bodyText": "Also, add more assertions to check if it returns location with the correct name and even Id", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365175123", "createdAt": "2020-01-10T10:45:05Z", "author": {"login": "corneliouzbett"}, "path": "api/src/test/java/org/openmrs/module/fhir2/api/impl/FhirLocationServiceImplTest.java", "diffHunk": "@@ -62,4 +62,19 @@ public void shouldGetLocationByUuid() {\n \t\torg.hl7.fhir.r4.model.Location result = fhirLocationService.getLocationByUuid(LOCATION_UUID);\n \t\tassertNotNull(location);\n \t}\n+\n+\t@Test\n+\tpublic void shouldGetLocationByName() {\n+\t\tLocation location = new Location();\n+\t\tlocation.setUuid(LOCATION_UUID);\n+\t\tlocation.setName(LOCATION_NAME);\n+\t\tlocation.setDescription(LOCATION_DESCRIPTION);\n+\t\tlocation.setDateCreated(new Date());\n+\t\tlocation.setRetired(false);\n+\n+\t\twhen(locationDao.getLocationByName(LOCATION_UUID)).thenReturn(location);\n+\n+\t\torg.hl7.fhir.r4.model.Location result = fhirLocationService.getLocationByUuid(LOCATION_UUID);\n+\t\tassertNotNull(location);\n+\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE3Mzk1MA=="}, "originalCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE4MDI5Mw==", "bodyText": "Search operations should return a list or collection. In this case, It should be returning a bundle.", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365180293", "createdAt": "2020-01-10T10:58:04Z", "author": {"login": "corneliouzbett"}, "path": "omod/src/main/java/org/openmrs/module/fhir2/providers/LocationFhirResourceProvider.java", "diffHunk": "@@ -47,4 +50,14 @@ public Location getLocationById(@IdParam @NotNull IdType id) {\n \t\t}\n \t\treturn location;\n \t}\n+\n+\t@Search\n+\t@SuppressWarnings(\"unused\")\n+\tpublic Location getLocationByName(@RequiredParam(name = Location.SP_NAME) StringParam name) {\n+\t\tLocation location = fhirLocationService.getLocationByName(name.getValue());\n+\t\tif (location == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find location with location name \" + name.getValue());\n+\t\t}\n+\t\treturn location;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE4MzQzNg==", "bodyText": "I understand that the name is unique from the database.\nSo this qualifies to be a Read operation @Read", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365183436", "createdAt": "2020-01-10T11:06:04Z", "author": {"login": "corneliouzbett"}, "path": "omod/src/main/java/org/openmrs/module/fhir2/providers/LocationFhirResourceProvider.java", "diffHunk": "@@ -47,4 +50,14 @@ public Location getLocationById(@IdParam @NotNull IdType id) {\n \t\t}\n \t\treturn location;\n \t}\n+\n+\t@Search\n+\t@SuppressWarnings(\"unused\")\n+\tpublic Location getLocationByName(@RequiredParam(name = Location.SP_NAME) StringParam name) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a124b26b5b646247a67e6b0ace7745ef0def1ce0", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/a124b26b5b646247a67e6b0ace7745ef0def1ce0", "committedDate": "2020-01-10T09:27:19Z", "message": "Added search by name for location resource"}, "afterCommit": {"oid": "9fef1e8aab9e3452b8417b79caa1bde2a045f5f9", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9fef1e8aab9e3452b8417b79caa1bde2a045f5f9", "committedDate": "2020-01-10T11:44:18Z", "message": "Added search by name for location resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fef1e8aab9e3452b8417b79caa1bde2a045f5f9", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9fef1e8aab9e3452b8417b79caa1bde2a045f5f9", "committedDate": "2020-01-10T11:44:18Z", "message": "Added search by name for location resource"}, "afterCommit": {"oid": "78bc0b3fc38738d52bba3e259242d9616fbb7ab5", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/78bc0b3fc38738d52bba3e259242d9616fbb7ab5", "committedDate": "2020-01-10T12:41:43Z", "message": "FM2-24 : Added search by name for location resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78bc0b3fc38738d52bba3e259242d9616fbb7ab5", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/78bc0b3fc38738d52bba3e259242d9616fbb7ab5", "committedDate": "2020-01-10T12:41:43Z", "message": "FM2-24 : Added search by name for location resource"}, "afterCommit": {"oid": "d30cc8c62bcdb68060367b810fe3e4d47fc31c0c", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/d30cc8c62bcdb68060367b810fe3e4d47fc31c0c", "committedDate": "2020-01-10T12:45:01Z", "message": "FM2-24 : Added search by name for location resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d30cc8c62bcdb68060367b810fe3e4d47fc31c0c", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/d30cc8c62bcdb68060367b810fe3e4d47fc31c0c", "committedDate": "2020-01-10T12:45:01Z", "message": "FM2-24 : Added search by name for location resource"}, "afterCommit": {"oid": "318240a789be7eae320f18274931984ee4dc4a6f", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/318240a789be7eae320f18274931984ee4dc4a6f", "committedDate": "2020-01-10T12:52:43Z", "message": "FM2-24 : Added search by name for location resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMTUxNjYx", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#pullrequestreview-341151661", "createdAt": "2020-01-10T13:10:43Z", "commit": {"oid": "318240a789be7eae320f18274931984ee4dc4a6f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMzoxMDo0NFrOFcTo6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMzoxMjoyNlrOFcTrUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyNjIxNg==", "bodyText": "You should change the method name to\n\nfindLocationByName", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365226216", "createdAt": "2020-01-10T13:10:44Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/FhirLocationService.java", "diffHunk": "@@ -12,8 +12,11 @@\n import org.hl7.fhir.r4.model.Location;\n \n import javax.validation.constraints.NotNull;\n+import java.util.Collection;\n \n public interface FhirLocationService {\n \t\n \tLocation getLocationByUuid(@NotNull String uuid);\n+\t\n+\tCollection<Location> getLocationByName(@NotNull String name);\n }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "318240a789be7eae320f18274931984ee4dc4a6f"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyNjgzNQ==", "bodyText": "Ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#discussion_r365226835", "createdAt": "2020-01-10T13:12:26Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirLocationDao.java", "diffHunk": "@@ -12,8 +12,11 @@\n import org.openmrs.Location;\n \n import javax.validation.constraints.NotNull;\n+import java.util.Collection;\n \n public interface FhirLocationDao {\n \t\n \tLocation getLocationByUuid(@NotNull String uuid);\n+\t\n+\tCollection<Location> getLocationByName(@NotNull String name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "318240a789be7eae320f18274931984ee4dc4a6f"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ae801d68832c678c0c89381b1b51abd6a3288b", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/08ae801d68832c678c0c89381b1b51abd6a3288b", "committedDate": "2020-01-10T13:17:52Z", "message": "FM2-24 : Added search by name for location resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "318240a789be7eae320f18274931984ee4dc4a6f", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/318240a789be7eae320f18274931984ee4dc4a6f", "committedDate": "2020-01-10T12:52:43Z", "message": "FM2-24 : Added search by name for location resource"}, "afterCommit": {"oid": "08ae801d68832c678c0c89381b1b51abd6a3288b", "author": {"user": {"login": "jecihjoy", "name": "Jacinta Gichuhi"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/08ae801d68832c678c0c89381b1b51abd6a3288b", "committedDate": "2020-01-10T13:17:52Z", "message": "FM2-24 : Added search by name for location resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMTYyMzE2", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/16#pullrequestreview-341162316", "createdAt": "2020-01-10T13:31:54Z", "commit": {"oid": "08ae801d68832c678c0c89381b1b51abd6a3288b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4341, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}