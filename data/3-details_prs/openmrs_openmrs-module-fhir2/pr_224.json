{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3ODk2ODky", "number": 224, "title": "FM2-222: Add create, update, and delete methods for Practitioner", "bodyText": "link:https://issues.openmrs.org/browse/FM2-222", "createdAt": "2020-06-22T12:07:13Z", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224", "merged": true, "mergeCommit": {"oid": "370f2591f2ac0d30a89fbed5ed652ad726562027"}, "closed": true, "closedAt": "2020-07-13T19:26:03Z", "author": {"login": "gitcliff"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuamDvAFqTQzNjY4MDIwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0mjWggFqTQ0NzUzNTY1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NjgwMjAy", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-436680202", "createdAt": "2020-06-24T14:05:32Z", "commit": {"oid": "bd7adee4b57da9b8bf37bde730239ea875cc2669"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDowNTozMlrOGoTsPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDowNTozMlrOGoTsPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDkxODg0Nw==", "bodyText": "Why is there a need to use this annotation ? You have anyways used these methods in your unit tests. Please find this useful throughout the PR.", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r444918847", "createdAt": "2020-06-24T14:05:32Z", "author": {"login": "varung-31"}, "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProvider.java", "diffHunk": "@@ -55,6 +59,38 @@ public Practitioner getPractitionerById(@IdParam @NotNull IdType id) {\n \t\treturn Practitioner30_40.convertPractitioner(practitioner);\n \t}\n \t\n+\n+\t@Create\n+\tpublic MethodOutcome createPractitioner(@ResourceParam Practitioner practitioner) {\n+\t\treturn FhirProviderUtils.buildCreate(practitionerService.create(Practitioner30_40.convertPractitioner(practitioner)));\n+\t} \n+\t\n+\t@Update\n+\t@SuppressWarnings(\"unused\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd7adee4b57da9b8bf37bde730239ea875cc2669"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3Mzg3MzM2", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437387336", "createdAt": "2020-06-25T11:02:54Z", "commit": {"oid": "bd7adee4b57da9b8bf37bde730239ea875cc2669"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMTowMjo1NFrOGo1zXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMjowOTozMlrOGo3wlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3NzcyNA==", "bodyText": "Add a newline at the end of each file", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445477724", "createdAt": "2020-06-25T11:02:54Z", "author": {"login": "corneliouzbett"}, "path": "omod/src/test/resources/org/openmrs/module/fhir2/providers/PractitionerWebTest_UpdateWithWrongId.json", "diffHunk": "@@ -0,0 +1,4 @@\n+{\n+  \"resourceType\": \"Practitioner\",\n+  \"id\": \"a0938123-1691-11df-97a5-7038c432aabc\"\n+}  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd7adee4b57da9b8bf37bde730239ea875cc2669"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUwOTc4Mw==", "bodyText": "Make use of util from FhirProviderUtils.buildDelete introduced here #214", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445509783", "createdAt": "2020-06-25T12:09:32Z", "author": {"login": "corneliouzbett"}, "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProvider.java", "diffHunk": "@@ -55,6 +59,38 @@ public Practitioner getPractitionerById(@IdParam @NotNull IdType id) {\n \t\treturn Practitioner30_40.convertPractitioner(practitioner);\n \t}\n \t\n+\n+\t@Create\n+\tpublic MethodOutcome createPractitioner(@ResourceParam Practitioner practitioner) {\n+\t\treturn FhirProviderUtils.buildCreate(practitionerService.create(Practitioner30_40.convertPractitioner(practitioner)));\n+\t} \n+\t\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePractitioner(@IdParam IdType id, @ResourceParam Practitioner practitioner) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tpractitioner.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(practitionerService.update(id.getIdPart(),\n+\t\t\t\tPractitioner30_40.convertPractitioner(practitioner)));\n+\t}\n+\t\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePractitioner(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = practitionerService.delete(id.getIdPart());\n+\t\tif (practitioner == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find practitioner to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(id.getIdPart());\n+\t\tretVal.getText().setDivAsString(\"Deleted successfully\");\n+\t\treturn retVal;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd7adee4b57da9b8bf37bde730239ea875cc2669"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM4NzI4", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437838728", "createdAt": "2020-06-25T20:35:19Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNToxOVrOGpK2iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNToxOVrOGpK2iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMjYwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);\n          \n          \n            \n            \t\t}", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445822603", "createdAt": "2020-06-25T20:35:19Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +344,93 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource(), notNullValue());\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n+\t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5MDU5", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839059", "createdAt": "2020-06-25T20:35:47Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNTo0N1rOGpK3kA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNTo0N1rOGpK3kA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMjg2NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445822864", "createdAt": "2020-06-25T20:35:47Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +344,93 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource(), notNullValue());\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n+\t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5MjE1", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839215", "createdAt": "2020-06-25T20:36:00Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjowMFrOGpK4Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjowMFrOGpK4Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMjk4Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445822986", "createdAt": "2020-06-25T20:36:00Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +344,93 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource(), notNullValue());\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n+\t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(anyString(), any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_NO_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 98}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5Mzkw", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839390", "createdAt": "2020-06-25T20:36:15Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjoxNVrOGpK4mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjoxNVrOGpK4mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMzEyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445823128", "createdAt": "2020-06-25T20:36:15Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +344,93 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource(), notNullValue());\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n+\t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(anyString(), any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_NO_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element for update\"));\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForIdMissMatch() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader()\n+\t\t\t\t.getResourceAsStream(JSON_UPDATE_PRACTITIONER_WRONG_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 114}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5NTY1", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839565", "createdAt": "2020-06-25T20:36:31Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjozMVrOGpK5KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjozMVrOGpK5KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMzI3Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445823273", "createdAt": "2020-06-25T20:36:31Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +346,89 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n \t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5Njgy", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839682", "createdAt": "2020-06-25T20:36:40Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo0MFrOGpK5gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo0MFrOGpK5gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMzM2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445823363", "createdAt": "2020-06-25T20:36:40Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +346,89 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n \t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 84}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5Nzkx", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839791", "createdAt": "2020-06-25T20:36:50Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo1MFrOGpK53A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo1MFrOGpK53A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMzQ1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445823452", "createdAt": "2020-06-25T20:36:50Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +346,89 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n \t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(anyString(), any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_NO_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 102}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODM5ODkx", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-437839891", "createdAt": "2020-06-25T20:36:59Z", "commit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo1OVrOGpK6Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMDozNjo1OVrOGpK6Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTgyMzU0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is);\n          \n          \n            \n            \t\t\tObjects.requireNonNull(is);\n          \n          \n            \n            \t\t\tjsonPractitioner = IOUtils.toString(is, StandardCharsets.UTF_8);", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r445823543", "createdAt": "2020-06-25T20:36:59Z", "author": {"login": "ibacher"}, "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderWebTest.java", "diffHunk": "@@ -330,4 +346,89 @@ private void verifyUri(String uri) throws Exception {\n \t\tassertThat(results.getEntry().get(0).getResource().getIdElement().getIdPart(), equalTo(PRACTITIONER_UUID));\n \t}\n \t\n+\t@Test\n+\tpublic void createPractitioner_shouldCreatePractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PRACTITIONER_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.create(any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = post(\"/Practitioner\").jsonContent(jsonPractitioner)\n+\t\t        .accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdateExistingPractitioner() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_PATH )) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = new org.hl7.fhir.r4.model.Practitioner();\n+\t\tpractitioner.setId(PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(anyString(), any(org.hl7.fhir.r4.model.Practitioner.class))).thenReturn(practitioner);\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PRACTITIONER_NO_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Practitioner/\" + PRACTITIONER_UUID).jsonContent(jsonPractitioner)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element for update\"));\n+\t}\n+\n+\t@Test\n+\tpublic void updatePractitioner_shouldErrorForIdMissMatch() throws Exception {\n+\t\tString jsonPractitioner;\n+\t\ttry (InputStream is = this.getClass().getClassLoader()\n+\t\t\t\t.getResourceAsStream(JSON_UPDATE_PRACTITIONER_WRONG_ID_PATH)) {\n+\t\t\tjsonPractitioner = IOUtils.toString(is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e"}, "originalPosition": 118}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "49d123b458b27cd7429f034c0e7a961e7543bc3e", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/49d123b458b27cd7429f034c0e7a961e7543bc3e", "committedDate": "2020-06-25T20:34:29Z", "message": "Merge branch 'master' into FM2-222"}, "afterCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/32af4bebdc0df9362dc627eef38ce9b1636d2b82", "committedDate": "2020-06-26T09:05:24Z", "message": "FM2-222:Add create,update, and delete methods for Practitioner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NjkyNjc3", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-438692677", "createdAt": "2020-06-27T11:55:50Z", "commit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxMTo1NTo1MFrOGp1QSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxMTo1Nzo0MVrOGp1Q5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzMyMA==", "bodyText": "ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517320", "createdAt": "2020-06-27T11:55:50Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProvider.java", "diffHunk": "@@ -55,6 +59,38 @@ public Practitioner getPractitionerById(@IdParam @NotNull IdType id) {\n \t\treturn Practitioner30_40.convertPractitioner(practitioner);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPractitioner(@ResourceParam Practitioner practitioner) {\n+\t\treturn FhirProviderUtils.buildCreate(practitionerService.create(Practitioner30_40.convertPractitioner(practitioner)));\n+\t} \n+\t\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePractitioner(@IdParam IdType id, @ResourceParam Practitioner practitioner) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tpractitioner.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(practitionerService.update(id.getIdPart(),\n+\t\t\t\tPractitioner30_40.convertPractitioner(practitioner)));\n+\t}\n+\t\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic org.hl7.fhir.r4.model.OperationOutcome deletePractitioner(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = practitionerService.delete(id.getIdPart());\n+\t\tif (practitioner == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find practitioner to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(id.getIdPart());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzMyOA==", "bodyText": "ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517328", "createdAt": "2020-06-27T11:56:01Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProvider.java", "diffHunk": "@@ -57,6 +65,36 @@ public Practitioner getPractitionerById(@IdParam @NotNull IdType id) {\n \t\treturn practitioner;\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPractitioner(@ResourceParam Practitioner practitioner) {\n+\t\treturn FhirProviderUtils.buildCreate(practitionerService.create(practitioner));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePractitioner(@IdParam IdType id, @ResourceParam Practitioner practitioner) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tpractitioner.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(practitionerService.update(id.getIdPart(),practitioner));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePractitioner(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = practitionerService.delete(id.getIdPart());\n+\t\tif (practitioner == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find practitioner to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzM0Ng==", "bodyText": "ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517346", "createdAt": "2020-06-27T11:56:18Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderTest.java", "diffHunk": "@@ -452,4 +457,64 @@ public void getPractitionerHistoryByWithWrongId_shouldThrowResourceNotFoundExcep\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).isEmpty(), Matchers.is(true));\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).size(), Matchers.equalTo(0));\n \t}\n+\t\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdatePractitioner() {\n+\t\tPractitioner newPractitioner = practitioner;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzM4Mw==", "bodyText": "ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517383", "createdAt": "2020-06-27T11:56:32Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderTest.java", "diffHunk": "@@ -452,4 +457,64 @@ public void getPractitionerHistoryByWithWrongId_shouldThrowResourceNotFoundExcep\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).isEmpty(), Matchers.is(true));\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).size(), Matchers.equalTo(0));\n \t}\n+\t\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdatePractitioner() {\n+\t\tPractitioner newPractitioner = practitioner;\n+\n+\t\twhen(practitionerService.update(PRACTITIONER_UUID, practitioner)).thenReturn(newPractitioner);\n+\n+\t\tMethodOutcome result = resourceProvider.updatePractitioner(new IdType().setValue(PRACTITIONER_UUID), practitioner);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(newPractitioner));\n+\t}\n+\n+\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePractitioner_shouldThrowInvalidRequestExceptionForWrongPractitionerUuid() {\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, practitioner)).thenThrow(InvalidRequestException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), practitioner);\n+\t}\n+\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updateAllergyShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\tPractitioner wrongPractitioner = new Practitioner();\n+\n+\t\twrongPractitioner.setId(WRONG_PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, wrongPractitioner)).thenThrow(MethodNotAllowedException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), wrongPractitioner);\n+\t}\n+\n+\t@Test\n+\tpublic void deletePractitioner_shouldDeletePractitioner() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzQxMA==", "bodyText": "ditto", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517410", "createdAt": "2020-06-27T11:56:50Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderTest.java", "diffHunk": "@@ -452,4 +457,64 @@ public void getPractitionerHistoryByWithWrongId_shouldThrowResourceNotFoundExcep\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).isEmpty(), Matchers.is(true));\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).size(), Matchers.equalTo(0));\n \t}\n+\t\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdatePractitioner() {\n+\t\tPractitioner newPractitioner = practitioner;\n+\n+\t\twhen(practitionerService.update(PRACTITIONER_UUID, practitioner)).thenReturn(newPractitioner);\n+\n+\t\tMethodOutcome result = resourceProvider.updatePractitioner(new IdType().setValue(PRACTITIONER_UUID), practitioner);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(newPractitioner));\n+\t}\n+\n+\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePractitioner_shouldThrowInvalidRequestExceptionForWrongPractitionerUuid() {\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, practitioner)).thenThrow(InvalidRequestException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), practitioner);\n+\t}\n+\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updateAllergyShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\tPractitioner wrongPractitioner = new Practitioner();\n+\n+\t\twrongPractitioner.setId(WRONG_PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, wrongPractitioner)).thenThrow(MethodNotAllowedException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), wrongPractitioner);\n+\t}\n+\n+\t@Test\n+\tpublic void deletePractitioner_shouldDeletePractitioner() {\n+\t\tPractitioner newPractitioner = new Practitioner();\n+\n+\t\twhen(practitionerService.delete(PRACTITIONER_UUID)).thenReturn(newPractitioner);\n+\n+\t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePractitioner(new IdType().setValue(PRACTITIONER_UUID));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzQ3OQ==", "bodyText": "ditto ===== previously mentioned \ud83d\ude03\ud83d\ude03", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r446517479", "createdAt": "2020-06-27T11:57:41Z", "author": {"login": "Akayeshmantha"}, "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PractitionerFhirResourceProviderTest.java", "diffHunk": "@@ -452,4 +457,64 @@ public void getPractitionerHistoryByWithWrongId_shouldThrowResourceNotFoundExcep\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).isEmpty(), Matchers.is(true));\n \t\tassertThat(resourceProvider.getPractitionerHistoryById(idType).size(), Matchers.equalTo(0));\n \t}\n+\t\n+\t@Test\n+\tpublic void updatePractitioner_shouldUpdatePractitioner() {\n+\t\tPractitioner newPractitioner = practitioner;\n+\n+\t\twhen(practitionerService.update(PRACTITIONER_UUID, practitioner)).thenReturn(newPractitioner);\n+\n+\t\tMethodOutcome result = resourceProvider.updatePractitioner(new IdType().setValue(PRACTITIONER_UUID), practitioner);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(newPractitioner));\n+\t}\n+\n+\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePractitioner_shouldThrowInvalidRequestExceptionForWrongPractitionerUuid() {\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, practitioner)).thenThrow(InvalidRequestException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), practitioner);\n+\t}\n+\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updateAllergyShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\tPractitioner wrongPractitioner = new Practitioner();\n+\n+\t\twrongPractitioner.setId(WRONG_PRACTITIONER_UUID);\n+\n+\t\twhen(practitionerService.update(WRONG_PRACTITIONER_UUID, wrongPractitioner)).thenThrow(MethodNotAllowedException.class);\n+\n+\t\tresourceProvider.updatePractitioner(new IdType().setValue(WRONG_PRACTITIONER_UUID), wrongPractitioner);\n+\t}\n+\n+\t@Test\n+\tpublic void deletePractitioner_shouldDeletePractitioner() {\n+\t\tPractitioner newPractitioner = new Practitioner();\n+\n+\t\twhen(practitionerService.delete(PRACTITIONER_UUID)).thenReturn(newPractitioner);\n+\n+\t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePractitioner(new IdType().setValue(PRACTITIONER_UUID));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzQxMA=="}, "originalCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32af4bebdc0df9362dc627eef38ce9b1636d2b82", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/32af4bebdc0df9362dc627eef38ce9b1636d2b82", "committedDate": "2020-06-26T09:05:24Z", "message": "FM2-222:Add create,update, and delete methods for Practitioner"}, "afterCommit": {"oid": "57891dac24275e9b8a318c3e21c49ded31e14074", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/57891dac24275e9b8a318c3e21c49ded31e14074", "committedDate": "2020-07-01T11:03:43Z", "message": "FM2-222:Add create,update, and delete methods for Practitioner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MjMyMDI3", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-447232027", "createdAt": "2020-07-13T13:07:00Z", "commit": {"oid": "ce302fb2e0c8d62de3f94de39af68786a4d61949"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMzowNzowMFrOGwnsZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMzowNzowMFrOGwnsZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzYzNTE3Mw==", "bodyText": "please rewrite this as FhirProviderUtils.buildDelete(Practitioner30_40.convertPractitioner(practitioner));", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r453635173", "createdAt": "2020-07-13T13:07:00Z", "author": {"login": "varung-31"}, "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PractitionerFhirResourceProvider.java", "diffHunk": "@@ -60,6 +70,35 @@ public Practitioner getPractitionerById(@IdParam @NotNull IdType id) {\n \t\treturn Practitioner30_40.convertPractitioner(practitioner);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPractitioner(@ResourceParam Practitioner practitioner) {\n+\t\treturn FhirProviderUtils.buildCreate(practitionerService.create(Practitioner30_40.convertPractitioner(practitioner)));\n+\t} \n+\t\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePractitioner(@IdParam IdType id, @ResourceParam Practitioner practitioner) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tpractitioner.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(practitionerService.update(id.getIdPart(),\n+\t\t\t\tPractitioner30_40.convertPractitioner(practitioner)));\n+\t}\n+\t\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePractitioner(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Practitioner practitioner = practitionerService.delete(id.getIdPart());\n+\t\tif (practitioner == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find practitioner to delete with id \" + id.getIdPart());\n+\t\t}\n+\n+\t\treturn OperationOutcome30_40.convertOperationOutcome(FhirProviderUtils.buildDelete(practitioner));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce302fb2e0c8d62de3f94de39af68786a4d61949"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MjMzNzU5", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-447233759", "createdAt": "2020-07-13T13:09:19Z", "commit": {"oid": "ce302fb2e0c8d62de3f94de39af68786a4d61949"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMzowOToxOVrOGwnxTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMzowOToxOVrOGwnxTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzYzNjQzMA==", "bodyText": "Could you please add some more fields to the json files?", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#discussion_r453636430", "createdAt": "2020-07-13T13:09:19Z", "author": {"login": "varung-31"}, "path": "omod/src/test/resources/org/openmrs/module/fhir2/providers/PractitionerWebTest_UpdateWithWrongId.json", "diffHunk": "@@ -0,0 +1,8 @@\n+{\n+  \"resourceType\": \"Practitioner\",\n+  \"id\": \"a0938123-1691-11df-97a5-7038c432aabc\"\n+  \n+}   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce302fb2e0c8d62de3f94de39af68786a4d61949"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de3637c1f754e7850a106112457a174a4cfb4778", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/de3637c1f754e7850a106112457a174a4cfb4778", "committedDate": "2020-07-13T18:06:03Z", "message": "FM2-222:Add create,update, and delete methods for Practitioner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5ad9c357956b7f6c4da007e4ab5f08acd72c4ee", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/b5ad9c357956b7f6c4da007e4ab5f08acd72c4ee", "committedDate": "2020-07-13T18:35:32Z", "message": "FM2-222:Add create.delete,update,and delete methods for practitioner"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce302fb2e0c8d62de3f94de39af68786a4d61949", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/ce302fb2e0c8d62de3f94de39af68786a4d61949", "committedDate": "2020-07-13T12:57:48Z", "message": "Merge branch 'master' into FM2-222"}, "afterCommit": {"oid": "b5ad9c357956b7f6c4da007e4ab5f08acd72c4ee", "author": {"user": {"login": "gitcliff", "name": null}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/b5ad9c357956b7f6c4da007e4ab5f08acd72c4ee", "committedDate": "2020-07-13T18:35:32Z", "message": "FM2-222:Add create.delete,update,and delete methods for practitioner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5a9841ac987c0fd85afcec7b12becb9e96f2c5f", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c5a9841ac987c0fd85afcec7b12becb9e96f2c5f", "committedDate": "2020-07-13T18:53:19Z", "message": "Remove whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "898934f31fd75bfae95242a2cc23722a4d4e8a2c", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/898934f31fd75bfae95242a2cc23722a4d4e8a2c", "committedDate": "2020-07-13T18:53:52Z", "message": "Remove unnecessary whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55f90d428e0f9cd45d9e3a1f98adf01e9ee70edb", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/55f90d428e0f9cd45d9e3a1f98adf01e9ee70edb", "committedDate": "2020-07-13T18:54:12Z", "message": "Remove unnecessary whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e48de148a7994951985cfa32f10a8e8baf01228", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/4e48de148a7994951985cfa32f10a8e8baf01228", "committedDate": "2020-07-13T18:54:36Z", "message": "Remove unnecessary whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b2699266b8d99e4774d4f89a79aff7bb2656526", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/5b2699266b8d99e4774d4f89a79aff7bb2656526", "committedDate": "2020-07-13T18:55:12Z", "message": "Remove unnecessary whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6ad5be8a1b09c53245b66a96b3a8a698c30e31f", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/e6ad5be8a1b09c53245b66a96b3a8a698c30e31f", "committedDate": "2020-07-13T18:58:07Z", "message": "Formatting fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NTM1NjUy", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/224#pullrequestreview-447535652", "createdAt": "2020-07-13T19:25:09Z", "commit": {"oid": "e6ad5be8a1b09c53245b66a96b3a8a698c30e31f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4096, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}