{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0ODgwODE5", "number": 7675, "title": "CB-6318 - Image change image should log progress", "bodyText": "", "createdAt": "2020-03-27T17:25:48Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7675", "merged": true, "mergeCommit": {"oid": "178e2b91047df9e8825e39c4fcdb38e7751e209f"}, "closed": true, "closedAt": "2020-03-30T16:26:13Z", "author": {"login": "pdarvasi"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcR-hGoAFqTM4MzI4NTY0OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcSxDmcAFqTM4NDAyNDk0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMjg1NjQ4", "url": "https://github.com/hortonworks/cloudbreak/pull/7675#pullrequestreview-383285648", "createdAt": "2020-03-28T05:33:03Z", "commit": {"oid": "28e585d0bfc267e73ddf660b847a32d8797edf39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQwNTozMzowNFrOF9HCsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQwNTozMzowNFrOF9HCsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTYyMjgzNA==", "bodyText": "why not log anyway?", "url": "https://github.com/hortonworks/cloudbreak/pull/7675#discussion_r399622834", "createdAt": "2020-03-28T05:33:04Z", "author": {"login": "lacikaaa"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/core/flow2/stack/image/update/StackImageUpdateService.java", "diffHunk": "@@ -213,8 +213,25 @@ public boolean isValidImage(Stack stack, String newImageId, String imageCatalogN\n             try {\n                 Image currentImage = getCurrentImage(stack);\n                 StatedImage newImage = getNewImage(newImageId, imageCatalogName, imageCatalogUrl, currentImage);\n-                return isCloudPlatformMatches(stack, newImage) && isOsVersionsMatch(currentImage, newImage) && isStackMatchIfPrewarmed(stack, newImage)\n-                        && checkPackageVersions(stack, newImage).getStatus() == EventStatus.OK;\n+                boolean cloudPlatformMatches = isCloudPlatformMatches(stack, newImage);\n+                boolean osVersionsMatch = isOsVersionsMatch(currentImage, newImage);\n+                boolean stackMatchIfPrewarmed = isStackMatchIfPrewarmed(stack, newImage);\n+                CheckResult status = checkPackageVersions(stack, newImage);\n+                boolean aggregatedValidationResult = cloudPlatformMatches && osVersionsMatch && stackMatchIfPrewarmed\n+                        && status.getStatus() == EventStatus.OK;\n+                if (!aggregatedValidationResult) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e585d0bfc267e73ddf660b847a32d8797edf39"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNDMxODk2", "url": "https://github.com/hortonworks/cloudbreak/pull/7675#pullrequestreview-383431896", "createdAt": "2020-03-29T16:55:09Z", "commit": {"oid": "28e585d0bfc267e73ddf660b847a32d8797edf39"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eba777a32184b84b67425a065c4d493a746359f5", "author": {"user": {"login": "pdarvasi", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/eba777a32184b84b67425a065c4d493a746359f5", "committedDate": "2020-03-30T09:52:00Z", "message": "CB-6318 - Image change image should log progress"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28e585d0bfc267e73ddf660b847a32d8797edf39", "author": {"user": {"login": "pdarvasi", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/28e585d0bfc267e73ddf660b847a32d8797edf39", "committedDate": "2020-03-27T17:24:42Z", "message": "CB-6318 - Image change image should log progress"}, "afterCommit": {"oid": "eba777a32184b84b67425a065c4d493a746359f5", "author": {"user": {"login": "pdarvasi", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/eba777a32184b84b67425a065c4d493a746359f5", "committedDate": "2020-03-30T09:52:00Z", "message": "CB-6318 - Image change image should log progress"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MDI0OTQ1", "url": "https://github.com/hortonworks/cloudbreak/pull/7675#pullrequestreview-384024945", "createdAt": "2020-03-30T16:26:00Z", "commit": {"oid": "eba777a32184b84b67425a065c4d493a746359f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2383, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}