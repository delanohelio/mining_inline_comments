{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5ODE5Njk1", "number": 9046, "title": "CB-8636 move cloud related validation into a flow step which improves\u2026", "bodyText": "\u2026 the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation.\nSee detailed description in the commit message.", "createdAt": "2020-09-19T20:29:37Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9046", "merged": true, "mergeCommit": {"oid": "5b5dc97b32ea483a413be328c08bee1129d3e6f2"}, "closed": true, "closedAt": "2020-10-07T06:57:06Z", "author": {"login": "doktoric"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLETwUABqjM3ODg5OTAxNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQHZSngFqTUwMzU3NDQ3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9779c833ddaa822818bc412102a0f48e11b8009", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e9779c833ddaa822818bc412102a0f48e11b8009", "committedDate": "2020-09-19T20:27:39Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "ea3baa01d32ff160a3c6a07ed1bfae94adf85912", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ea3baa01d32ff160a3c6a07ed1bfae94adf85912", "committedDate": "2020-09-21T14:16:39Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea3baa01d32ff160a3c6a07ed1bfae94adf85912", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ea3baa01d32ff160a3c6a07ed1bfae94adf85912", "committedDate": "2020-09-21T14:16:39Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "d421a1a39fee6d48aab23a0a3f83f933bbb64c8f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d421a1a39fee6d48aab23a0a3f83f933bbb64c8f", "committedDate": "2020-09-22T07:11:48Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d421a1a39fee6d48aab23a0a3f83f933bbb64c8f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d421a1a39fee6d48aab23a0a3f83f933bbb64c8f", "committedDate": "2020-09-22T07:11:48Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "ff97e9c297ea665a4c408a1b84586a617615636c", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ff97e9c297ea665a4c408a1b84586a617615636c", "committedDate": "2020-09-22T13:55:04Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff97e9c297ea665a4c408a1b84586a617615636c", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ff97e9c297ea665a4c408a1b84586a617615636c", "committedDate": "2020-09-22T13:55:04Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "40a0e10f463eba9b9482f6f65c4e9d33670f458f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/40a0e10f463eba9b9482f6f65c4e9d33670f458f", "committedDate": "2020-09-23T10:22:32Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "40a0e10f463eba9b9482f6f65c4e9d33670f458f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/40a0e10f463eba9b9482f6f65c4e9d33670f458f", "committedDate": "2020-09-23T10:22:32Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "0913fbf35d85e3f97ea8c37de736a5e236e36c96", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0913fbf35d85e3f97ea8c37de736a5e236e36c96", "committedDate": "2020-09-23T10:24:39Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0913fbf35d85e3f97ea8c37de736a5e236e36c96", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0913fbf35d85e3f97ea8c37de736a5e236e36c96", "committedDate": "2020-09-23T10:24:39Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "e61d288657a1531dfe87d4a1083808fa3f1be8fd", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e61d288657a1531dfe87d4a1083808fa3f1be8fd", "committedDate": "2020-09-23T21:51:02Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e61d288657a1531dfe87d4a1083808fa3f1be8fd", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e61d288657a1531dfe87d4a1083808fa3f1be8fd", "committedDate": "2020-09-23T21:51:02Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "9c7cb06003fd86190f5383ba0ccf8202e4c96d03", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9c7cb06003fd86190f5383ba0ccf8202e4c96d03", "committedDate": "2020-09-24T06:56:18Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c7cb06003fd86190f5383ba0ccf8202e4c96d03", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9c7cb06003fd86190f5383ba0ccf8202e4c96d03", "committedDate": "2020-09-24T06:56:18Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c04365b2d399769cc8f16fb088b52e4ea0d4610e", "committedDate": "2020-09-24T14:53:20Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MzI2NjQ2", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#pullrequestreview-495326646", "createdAt": "2020-09-24T08:17:46Z", "commit": {"oid": "9c7cb06003fd86190f5383ba0ccf8202e4c96d03"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwODoxNzo0NlrOHXPC3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNToyNzo0NlrOHYu40Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDEyNTc4OQ==", "bodyText": "is it need?", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r494125789", "createdAt": "2020-09-24T08:17:46Z", "author": {"login": "topolyai5"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/controller/StackCreatorService.java", "diffHunk": "@@ -406,15 +360,14 @@ private void createClusterIfNeed(User user, StackV4Request stackRequest, Stack s\n     }\n \n     private void ensureStackDoesNotExists(String stackName, Workspace workspace) {\n-        try {\n-            stackService.getIdByNameInWorkspace(stackName, workspace.getId());\n-        } catch (NotFoundException e) {\n-            return;\n+        Optional<StackView> byName = stackViewService.findByName(stackName, workspace.getId());\n+        if (byName.isPresent()) {\n+            throw new BadRequestException(\"Cluster already exists: \" + stackName);\n         }\n-        throw new BadRequestException(\"Cluster already exists: \" + stackName);\n     }\n \n     private Blueprint determineBlueprint(StackV4Request stackRequest, Workspace workspace) {\n+        //blueprintService.updateDefaultBlueprintCollection(workspace.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c7cb06003fd86190f5383ba0ccf8202e4c96d03"}, "originalPosition": 436}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5MjQ3Mg==", "bodyText": "what kind of grpc call?", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495692472", "createdAt": "2020-09-28T05:12:54Z", "author": {"login": "topolyai5"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/controller/StackCreatorService.java", "diffHunk": "@@ -301,23 +273,12 @@ public StackV4Response createStack(User user, Workspace workspace, StackV4Reques\n     }\n \n     private void assignOwnerRoleOnDataHub(User user, StackV4Request stackRequest, Stack newStack) {\n+        // TODO grpc call", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 381}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5Mjk0MQ==", "bodyText": "Maybe this validation runs in the flow", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495692941", "createdAt": "2020-09-28T05:14:59Z", "author": {"login": "topolyai5"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/controller/validation/template/InstanceTemplateValidator.java", "diffHunk": "@@ -4,23 +4,22 @@\n \n import org.springframework.stereotype.Component;\n \n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.instancegroup.template.InstanceTemplateV4Request;\n+import com.sequenceiq.cloudbreak.domain.Template;\n import com.sequenceiq.cloudbreak.validation.ValidationResult;\n import com.sequenceiq.cloudbreak.validation.ValidationResult.ValidationResultBuilder;\n import com.sequenceiq.cloudbreak.validation.Validator;\n \n @Component\n-public class InstanceTemplateV4RequestValidator implements Validator<InstanceTemplateV4Request> {\n+public class InstanceTemplateValidator implements Validator<Template> {\n \n     @Override\n-    public ValidationResult validate(InstanceTemplateV4Request subject) {\n+    public ValidationResult validate(Template subject) {\n         ValidationResultBuilder resultBuilder = ValidationResult.builder();\n         if (Objects.isNull(subject)) {\n             resultBuilder.error(\"Template request cannot be null in the instance group request.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5MzI4Ng==", "bodyText": "Please rename the test class, and check all the test names in the PR", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495693286", "createdAt": "2020-09-28T05:16:27Z", "author": {"login": "topolyai5"}, "path": "core/src/test/java/com/sequenceiq/cloudbreak/controller/validation/stack/StackV4RequestValidatorTest.java", "diffHunk": "@@ -14,25 +15,21 @@\n import org.mockito.junit.MockitoJUnitRunner;\n import org.slf4j.LoggerFactory;\n \n-import com.sequenceiq.cloudbreak.api.endpoint.v4.database.base.DatabaseType;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.StackV4Request;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.cluster.ClusterV4Request;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.environment.placement.PlacementSettingsV4Request;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.instancegroup.InstanceGroupV4Request;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.instancegroup.template.InstanceTemplateV4Request;\n-import com.sequenceiq.cloudbreak.api.endpoint.v4.stacks.request.instancegroup.template.volume.VolumeV4Request;\n+import com.google.common.collect.Sets;\n import com.sequenceiq.cloudbreak.cloud.model.CloudRegions;\n-import com.sequenceiq.cloudbreak.controller.validation.template.InstanceTemplateV4RequestValidator;\n+import com.sequenceiq.cloudbreak.controller.validation.template.InstanceTemplateValidator;\n import com.sequenceiq.cloudbreak.domain.Blueprint;\n-import com.sequenceiq.cloudbreak.domain.RDSConfig;\n+import com.sequenceiq.cloudbreak.domain.Template;\n+import com.sequenceiq.cloudbreak.domain.stack.Stack;\n+import com.sequenceiq.cloudbreak.domain.stack.cluster.Cluster;\n+import com.sequenceiq.cloudbreak.domain.stack.instance.InstanceGroup;\n import com.sequenceiq.cloudbreak.dto.credential.Credential;\n import com.sequenceiq.cloudbreak.ldap.LdapConfigService;\n-import com.sequenceiq.cloudbreak.structuredevent.CloudbreakRestRequestThreadLocalService;\n import com.sequenceiq.cloudbreak.service.blueprint.BlueprintService;\n import com.sequenceiq.cloudbreak.service.environment.EnvironmentClientService;\n import com.sequenceiq.cloudbreak.service.rdsconfig.RdsConfigService;\n+import com.sequenceiq.cloudbreak.structuredevent.CloudbreakRestRequestThreadLocalService;\n import com.sequenceiq.cloudbreak.validation.ValidationResult;\n-import com.sequenceiq.cloudbreak.validation.ValidationResult.State;\n \n @RunWith(MockitoJUnitRunner.class)\n public class StackV4RequestValidatorTest extends StackRequestValidatorTestBase {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5MzUzOQ==", "bodyText": "please rename the field", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495693539", "createdAt": "2020-09-28T05:17:31Z", "author": {"login": "topolyai5"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/core/flow2/validate/cloud/CloudConfigValidationActions.java", "diffHunk": "@@ -0,0 +1,181 @@\n+package com.sequenceiq.cloudbreak.core.flow2.validate.cloud;\n+\n+import static com.sequenceiq.cloudbreak.util.Benchmark.measure;\n+import static com.sequenceiq.common.api.type.CdpResourceType.fromStackType;\n+\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import javax.inject.Inject;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.statemachine.StateContext;\n+import org.springframework.statemachine.action.Action;\n+\n+import com.sequenceiq.cloudbreak.api.endpoint.v4.common.DetailedStackStatus;\n+import com.sequenceiq.cloudbreak.api.endpoint.v4.common.StackType;\n+import com.sequenceiq.cloudbreak.cloud.event.validation.ParametersValidationRequest;\n+import com.sequenceiq.cloudbreak.cloud.model.CloudCredential;\n+import com.sequenceiq.cloudbreak.common.event.Selectable;\n+import com.sequenceiq.cloudbreak.controller.validation.ParametersValidator;\n+import com.sequenceiq.cloudbreak.controller.validation.datalake.DataLakeValidator;\n+import com.sequenceiq.cloudbreak.controller.validation.environment.ClusterCreationEnvironmentValidator;\n+import com.sequenceiq.cloudbreak.controller.validation.stack.StackValidator;\n+import com.sequenceiq.cloudbreak.controller.validation.template.TemplateValidator;\n+import com.sequenceiq.cloudbreak.converter.spi.CredentialToCloudCredentialConverter;\n+import com.sequenceiq.cloudbreak.core.flow2.externaldatabase.StackUpdaterService;\n+import com.sequenceiq.cloudbreak.core.flow2.stack.AbstractStackFailureAction;\n+import com.sequenceiq.cloudbreak.core.flow2.stack.StackContext;\n+import com.sequenceiq.cloudbreak.core.flow2.stack.StackFailureContext;\n+import com.sequenceiq.cloudbreak.core.flow2.stack.provision.action.AbstractStackCreationAction;\n+import com.sequenceiq.cloudbreak.core.flow2.validate.cloud.config.CloudConfigValidationEvent;\n+import com.sequenceiq.cloudbreak.core.flow2.validate.cloud.config.CloudConfigValidationState;\n+import com.sequenceiq.cloudbreak.domain.stack.Stack;\n+import com.sequenceiq.cloudbreak.domain.stack.instance.InstanceGroup;\n+import com.sequenceiq.cloudbreak.domain.view.StackView;\n+import com.sequenceiq.cloudbreak.dto.credential.Credential;\n+import com.sequenceiq.cloudbreak.event.ResourceEvent;\n+import com.sequenceiq.cloudbreak.logger.MDCBuilder;\n+import com.sequenceiq.cloudbreak.reactor.api.event.StackEvent;\n+import com.sequenceiq.cloudbreak.reactor.api.event.StackFailureEvent;\n+import com.sequenceiq.cloudbreak.service.environment.EnvironmentClientService;\n+import com.sequenceiq.cloudbreak.service.environment.credential.CredentialConverter;\n+import com.sequenceiq.cloudbreak.service.stack.StackViewService;\n+import com.sequenceiq.cloudbreak.validation.ValidationResult;\n+import com.sequenceiq.environment.api.v1.environment.model.response.DetailedEnvironmentResponse;\n+import com.sequenceiq.flow.core.Flow;\n+import com.sequenceiq.flow.core.FlowParameters;\n+\n+@Configuration\n+public class CloudConfigValidationActions {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(CloudConfigValidationActions.class);\n+\n+    @Inject\n+    private StackUpdaterService stackUpdaterService;\n+\n+    @Inject\n+    private EnvironmentClientService environmentClientService;\n+\n+    @Inject\n+    private CredentialToCloudCredentialConverter credentialToCloudCredentialConverter;\n+\n+    @Inject\n+    private CredentialConverter credentialConverter;\n+\n+    @Inject\n+    private StackViewService stackViewService;\n+\n+    @Inject\n+    private ParametersValidator parametersValidator;\n+\n+    @Inject\n+    private StackValidator stackRequestValidator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5NTAxOA==", "bodyText": "please remove the slash or delete the code", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495695018", "createdAt": "2020-09-28T05:23:48Z", "author": {"login": "topolyai5"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/blueprint/BlueprintService.java", "diffHunk": "@@ -206,7 +206,7 @@ public ScaleRecommendation getScaleRecommendation(Long workspaceId, String bluep\n     }\n \n     public Set<Blueprint> getAllAvailableInWorkspace(Workspace workspace) {\n-        updateDefaultBlueprintCollection(workspace);\n+        //updateDefaultBlueprintCollection(workspace);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY5NjA4MQ==", "bodyText": "remove comment section", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r495696081", "createdAt": "2020-09-28T05:27:46Z", "author": {"login": "topolyai5"}, "path": "core/src/test/java/com/sequenceiq/cloudbreak/controller/StackCreatorServiceTest.java", "diffHunk": "@@ -201,8 +183,8 @@ public void shouldThrowBadRequestWhenRecipeIsMissing() {\n         instanceGroupV4Request.setRecipeNames(Set.of(RECIPE_NAME));\n         stackRequest.setInstanceGroups(List.of(instanceGroupV4Request));\n \n-        when(validationResult.getState()).thenReturn(State.VALID);\n-        when(stackRequestValidator.validate(stackRequest)).thenReturn(validationResult);\n+        //when(validationResult.getState()).thenReturn(State.VALID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e"}, "originalPosition": 90}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c04365b2d399769cc8f16fb088b52e4ea0d4610e", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c04365b2d399769cc8f16fb088b52e4ea0d4610e", "committedDate": "2020-09-24T14:53:20Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "fcd12314171be2fdd8197c93a0e11ff027023ce7", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fcd12314171be2fdd8197c93a0e11ff027023ce7", "committedDate": "2020-09-28T06:40:05Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fcd12314171be2fdd8197c93a0e11ff027023ce7", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fcd12314171be2fdd8197c93a0e11ff027023ce7", "committedDate": "2020-09-28T06:40:05Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "85b0ec7b70c53a02a5c959738b72385361028728", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/85b0ec7b70c53a02a5c959738b72385361028728", "committedDate": "2020-09-28T14:37:56Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "85b0ec7b70c53a02a5c959738b72385361028728", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/85b0ec7b70c53a02a5c959738b72385361028728", "committedDate": "2020-09-28T14:37:56Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "e006cfc44e6af90c7cdbb42070ad17c190175495", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e006cfc44e6af90c7cdbb42070ad17c190175495", "committedDate": "2020-10-02T15:21:43Z", "message": "init"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMjc3MjQ3", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#pullrequestreview-501277247", "createdAt": "2020-10-02T16:25:10Z", "commit": {"oid": "e006cfc44e6af90c7cdbb42070ad17c190175495"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjoyNToxMFrOHbz33Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjoyNToxMFrOHbz33Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkyMzQ4NQ==", "bodyText": "it will conflict with my change", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#discussion_r498923485", "createdAt": "2020-10-02T16:25:10Z", "author": {"login": "topolyai5"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/converter/stack/CreateFreeIpaRequestToStackConverter.java", "diffHunk": "@@ -218,7 +218,7 @@ private Json getTags(CreateFreeIpaRequest source, Stack stack, String userCrn, S\n             // userdefined tags comming from environment service\n             return new Json(new StackTags(userDefined, new HashMap<>(), getDefaultTags(stack, userCrn, userName)));\n         } catch (Exception ignored) {\n-            throw new BadRequestException(\"Failed to convert dynamic tags.\");\n+            throw new BadRequestException(\"Failed to convert dynamic tags.\" + ignored.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e006cfc44e6af90c7cdbb42070ad17c190175495"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e006cfc44e6af90c7cdbb42070ad17c190175495", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e006cfc44e6af90c7cdbb42070ad17c190175495", "committedDate": "2020-10-02T15:21:43Z", "message": "init"}, "afterCommit": {"oid": "3824946636c197e050b1d4f91d736ab420c56056", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/3824946636c197e050b1d4f91d736ab420c56056", "committedDate": "2020-10-03T10:44:51Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3824946636c197e050b1d4f91d736ab420c56056", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/3824946636c197e050b1d4f91d736ab420c56056", "committedDate": "2020-10-03T10:44:51Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "aaa2074e0580f601d5c131a072f6e79488de96f6", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/aaa2074e0580f601d5c131a072f6e79488de96f6", "committedDate": "2020-10-05T20:07:35Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1763169d91ed3c8030c3264d4fe7008b39078377", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1763169d91ed3c8030c3264d4fe7008b39078377", "committedDate": "2020-10-06T22:47:03Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aaa2074e0580f601d5c131a072f6e79488de96f6", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/aaa2074e0580f601d5c131a072f6e79488de96f6", "committedDate": "2020-10-05T20:07:35Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}, "afterCommit": {"oid": "1763169d91ed3c8030c3264d4fe7008b39078377", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1763169d91ed3c8030c3264d4fe7008b39078377", "committedDate": "2020-10-06T22:47:03Z", "message": "CB-8636 move cloud related validation into a flow step which improves the request response times. Moved group validation, template validation, parameters like encryption keys, DL and ENV validation. Also moved kerberos config generation under the kerberos validation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNTc0NDc0", "url": "https://github.com/hortonworks/cloudbreak/pull/9046#pullrequestreview-503574474", "createdAt": "2020-10-07T06:56:59Z", "commit": {"oid": "1763169d91ed3c8030c3264d4fe7008b39078377"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2208, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}