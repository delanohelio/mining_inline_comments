{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NzY3NTQy", "number": 9391, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxMzoxOVrOE2yNXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxMzoxOVrOE2yNXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODgxMTgwOnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/schema/app/20201027161305_CB-9127_optimize_cluster_template_load_time.sql", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxMzoxOVrOHvwsww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoyOTowM1rOHvxZkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ==", "bodyText": "you have to set default value in a separate step to avoid table lock when adding a column:\nsee: https://github.com/hortonworks/cloudbreak/blob/master/freeipa/src/main/resources/schema/app/20200406095012_CB-6385_add_version_to_stack.sql", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519843011", "createdAt": "2020-11-09T14:13:19Z", "author": {"login": "lacikaaa"}, "path": "core/src/main/resources/schema/app/20201027161305_CB-9127_optimize_cluster_template_load_time.sql", "diffHunk": "@@ -4,8 +4,9 @@\n DELETE FROM clustertemplate WHERE status='DEFAULT';\n ALTER TABLE clustertemplate ADD COLUMN IF NOT EXISTS clouderaRuntimeVersion VARCHAR(255);\n \n-ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER;\n+ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER DEFAULT 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0NDk2Ng==", "bodyText": "https://dba.stackexchange.com/questions/211221/add-column-with-default-in-postgresql-without-table-level-lock", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519844966", "createdAt": "2020-11-09T14:15:57Z", "author": {"login": "lacikaaa"}, "path": "core/src/main/resources/schema/app/20201027161305_CB-9127_optimize_cluster_template_load_time.sql", "diffHunk": "@@ -4,8 +4,9 @@\n DELETE FROM clustertemplate WHERE status='DEFAULT';\n ALTER TABLE clustertemplate ADD COLUMN IF NOT EXISTS clouderaRuntimeVersion VARCHAR(255);\n \n-ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER;\n+ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER DEFAULT 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ=="}, "originalCommit": {"oid": "f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1NDQ4Mg==", "bodyText": "done", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519854482", "createdAt": "2020-11-09T14:29:03Z", "author": {"login": "doktoric"}, "path": "core/src/main/resources/schema/app/20201027161305_CB-9127_optimize_cluster_template_load_time.sql", "diffHunk": "@@ -4,8 +4,9 @@\n DELETE FROM clustertemplate WHERE status='DEFAULT';\n ALTER TABLE clustertemplate ADD COLUMN IF NOT EXISTS clouderaRuntimeVersion VARCHAR(255);\n \n-ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER;\n+ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER DEFAULT 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ=="}, "originalCommit": {"oid": "f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3565, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}