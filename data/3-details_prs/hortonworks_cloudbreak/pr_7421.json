{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMzU1NjI5", "number": 7421, "title": "Npe fix azure get network", "bodyText": "Unit tests will be submitted to master .", "createdAt": "2020-02-28T12:02:02Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7421", "merged": true, "mergeCommit": {"oid": "6061ebe185377251bba9b7fa3fdc4873afa838dc"}, "closed": true, "closedAt": "2020-02-28T15:32:45Z", "author": {"login": "doktoric"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIuu1gABqjMwODE2OTc2Mjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIwDyBgFqTM2NjQwMDY1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "070d348222a8adc0d83d33beae4dea484398c1a6", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/070d348222a8adc0d83d33beae4dea484398c1a6", "committedDate": "2020-02-28T12:01:17Z", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side"}, "afterCommit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f5caf5a51c83fac9c0601688094e5c1a64aef87b", "committedDate": "2020-02-28T12:03:37Z", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MzgxNDQ2", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#pullrequestreview-366381446", "createdAt": "2020-02-28T13:04:27Z", "commit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNDoyN1rOFv0RPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNDoyN1rOFv0RPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4Mzc3NQ==", "bodyText": "Minor: does in resource group, not sure what we're trying to say", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385683775", "createdAt": "2020-02-28T13:04:27Z", "author": {"login": "keyki"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -96,8 +97,15 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n         String networkId = filters.get(\"networkId\");\n         String resourceGroupName = filters.get(\"resourceGroupName\");\n         if (!StringUtils.isEmpty(networkId) && !StringUtils.isEmpty(resourceGroupName)) {\n+            LOGGER.info(\"Query Network with id '{}' does in resource group {}\", networkId, resourceGroupName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MzgxNzU3", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#pullrequestreview-366381757", "createdAt": "2020-02-28T13:05:00Z", "commit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNTowMFrOFv0SCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNTowMFrOFv0SCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4Mzk3Nw==", "bodyText": "Same", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385683977", "createdAt": "2020-02-28T13:05:00Z", "author": {"login": "keyki"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -96,8 +97,15 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n         String networkId = filters.get(\"networkId\");\n         String resourceGroupName = filters.get(\"resourceGroupName\");\n         if (!StringUtils.isEmpty(networkId) && !StringUtils.isEmpty(resourceGroupName)) {\n+            LOGGER.info(\"Query Network with id '{}' does in resource group {}\", networkId, resourceGroupName);\n             Network network = client.getNetworkByResourceGroup(resourceGroupName, networkId);\n-            addToResultIfRegionsAreMatch(region, result, network);\n+            if (network != null) {\n+                LOGGER.info(\"Network was successfully queried for  Network with id '{}' does in resource group {}: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MzgyMjM3", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#pullrequestreview-366382237", "createdAt": "2020-02-28T13:05:51Z", "commit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNTo1MVrOFv0TWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzowNTo1MVrOFv0TWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY4NDMxNQ==", "bodyText": "%s does not work here.", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#discussion_r385684315", "createdAt": "2020-02-28T13:05:51Z", "author": {"login": "keyki"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzurePlatformResources.java", "diffHunk": "@@ -110,13 +118,22 @@ public CloudNetworks networks(CloudCredential cloudCredential, Region region, Ma\n     }\n \n     private void addToResultIfRegionsAreMatch(Region region, Map<String, Set<CloudNetwork>> result, Network network) {\n-        String actualRegionLabel = network.region().label();\n-        String actualRegionName = network.region().name();\n-\n-        if (regionMatch(actualRegionLabel, region) || regionMatch(actualRegionName, region)) {\n-            CloudNetwork cloudNetwork = convertToCloudNetwork(network);\n-            result.computeIfAbsent(actualRegionLabel, s -> new HashSet<>()).add(cloudNetwork);\n-            result.computeIfAbsent(actualRegionName, s -> new HashSet<>()).add(cloudNetwork);\n+        if (network.region() != null) {\n+            String actualRegionLabel = network.region().label();\n+            String actualRegionName = network.region().name();\n+\n+            LOGGER.info(\"The region label '{}' and the region name '{}' are for Azure network id: {} name: {}\",\n+                    actualRegionLabel, actualRegionName, network.id(), network.name());\n+            if (regionMatch(actualRegionLabel, region) || regionMatch(actualRegionName, region)) {\n+                CloudNetwork cloudNetwork = convertToCloudNetwork(network);\n+                result.computeIfAbsent(actualRegionLabel, s -> new HashSet<>()).add(cloudNetwork);\n+                result.computeIfAbsent(actualRegionName, s -> new HashSet<>()).add(cloudNetwork);\n+            }\n+        } else {\n+            LOGGER.info(\"Network with id %s and name %s has no region which is not supported by CDP: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87a1e69409f76603d534b24c93ca6f7c38931d38", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/87a1e69409f76603d534b24c93ca6f7c38931d38", "committedDate": "2020-02-28T13:32:45Z", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f5caf5a51c83fac9c0601688094e5c1a64aef87b", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f5caf5a51c83fac9c0601688094e5c1a64aef87b", "committedDate": "2020-02-28T12:03:37Z", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side"}, "afterCommit": {"oid": "87a1e69409f76603d534b24c93ca6f7c38931d38", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/87a1e69409f76603d534b24c93ca6f7c38931d38", "committedDate": "2020-02-28T13:32:45Z", "message": "CB-5832 handle null pointer in case of azure get network return null so the subnet does not exist on provide side"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NDAwNjU3", "url": "https://github.com/hortonworks/cloudbreak/pull/7421#pullrequestreview-366400657", "createdAt": "2020-02-28T13:37:03Z", "commit": {"oid": "87a1e69409f76603d534b24c93ca6f7c38931d38"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2617, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}