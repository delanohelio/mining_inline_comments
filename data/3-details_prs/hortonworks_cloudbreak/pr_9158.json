{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NzU1MTI5", "number": 9158, "title": "CB-8982 Indefinitely long loop when deleting environment. When we fet\u2026", "bodyText": "\u2026ched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only.\nSee detailed description in the commit message.", "createdAt": "2020-10-06T18:38:21Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9158", "merged": true, "mergeCommit": {"oid": "0cea0a7f0a7e1c98b410c9b4873128d878cc1178"}, "closed": true, "closedAt": "2020-10-20T13:16:38Z", "author": {"login": "topolyai5"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP9VBOAFqTUwMzI3NjUwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUVJVDgBqjM4OTc1NjA1MTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMjc2NTA5", "url": "https://github.com/hortonworks/cloudbreak/pull/9158#pullrequestreview-503276509", "createdAt": "2020-10-06T19:08:15Z", "commit": {"oid": "0467a61aae16e616e13c6e4145f3fb2a614d2324"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxOTowODoxNlrOHdWHTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxOToxMjozMlrOHdWQxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzMzA3MA==", "bodyText": "why do we need to introduce another endpoint for this? the env crn is a query param which can be empty (seemingly). If this param would be missing, the call would go to the simple list endpoint (line 47).\nIMO we shouldn't introduce this endpoint, we just need to extend the original list endpoint with this query param. since the param itself is not a mandatory field, this endpoint extension shouldn't break the compatibility", "url": "https://github.com/hortonworks/cloudbreak/pull/9158#discussion_r500533070", "createdAt": "2020-10-06T19:08:16Z", "author": {"login": "gregito"}, "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/clustertemplate/ClusterTemplateV4Endpoint.java", "diffHunk": "@@ -46,6 +46,13 @@\n             nickname = \"listClusterTemplatesByWorkspace\")\n     ClusterTemplateViewV4Responses list(@PathParam(\"workspaceId\") Long workspaceId);\n \n+    @GET\n+    @Path(\"get_by_env\")\n+    @Produces(MediaType.APPLICATION_JSON)\n+    @ApiOperation(value = ClusterTemplateOpDescription.LIST_BY_ENV, produces = MediaType.APPLICATION_JSON,\n+            notes = CLUSTER_TEMPLATE_NOTES, nickname = \"listClusterTemplatesByEnv\")\n+    ClusterTemplateViewV4Responses listByEnv(@PathParam(\"workspaceId\") Long workspaceId, @QueryParam(\"environmentCrn\") String environmentCrn);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0467a61aae16e616e13c6e4145f3fb2a614d2324"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzNTQ5Mw==", "bodyText": "if you remove the input-independent solution (the usage of the NameOrCrn object) then please remove the unused environmentName arg also from the method arguments", "url": "https://github.com/hortonworks/cloudbreak/pull/9158#discussion_r500535493", "createdAt": "2020-10-06T19:12:32Z", "author": {"login": "gregito"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/controller/v4/ClusterTemplateV4Controller.java", "diffHunk": "@@ -139,9 +148,8 @@ public ClusterTemplateV4Responses deleteMultiple(Long workspaceId, @ResourceName\n         if (Objects.nonNull(names) && !names.isEmpty()) {\n             clusterTemplates = clusterTemplateService.deleteMultiple(names, workspaceId);\n         } else {\n-            NameOrCrn environmentNameOrCrn = NameOrCrn.ofCrn(environmentCrn);\n             Set<String> namesByEnv = clusterTemplateService\n-                    .findAllByEnvironment(environmentNameOrCrn)\n+                    .findAllByEnvironment(environmentCrn)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0467a61aae16e616e13c6e4145f3fb2a614d2324"}, "originalPosition": 41}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0467a61aae16e616e13c6e4145f3fb2a614d2324", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0467a61aae16e616e13c6e4145f3fb2a614d2324", "committedDate": "2020-10-06T18:36:52Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "99cbd1ab03d23dd8ed532e74e593996c94b9e9d8", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/99cbd1ab03d23dd8ed532e74e593996c94b9e9d8", "committedDate": "2020-10-07T12:05:57Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99cbd1ab03d23dd8ed532e74e593996c94b9e9d8", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/99cbd1ab03d23dd8ed532e74e593996c94b9e9d8", "committedDate": "2020-10-07T12:05:57Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "dd1e0ec6133ee6cf930023406d9f16f3007bceb4", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/dd1e0ec6133ee6cf930023406d9f16f3007bceb4", "committedDate": "2020-10-12T11:41:31Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd1e0ec6133ee6cf930023406d9f16f3007bceb4", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/dd1e0ec6133ee6cf930023406d9f16f3007bceb4", "committedDate": "2020-10-12T11:41:31Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "6a8f20e898874a48c9f91c8686cf280c79e5b88b", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6a8f20e898874a48c9f91c8686cf280c79e5b88b", "committedDate": "2020-10-12T14:05:03Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExMTYyMTIw", "url": "https://github.com/hortonworks/cloudbreak/pull/9158#pullrequestreview-511162120", "createdAt": "2020-10-18T16:55:04Z", "commit": {"oid": "6a8f20e898874a48c9f91c8686cf280c79e5b88b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a8f20e898874a48c9f91c8686cf280c79e5b88b", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6a8f20e898874a48c9f91c8686cf280c79e5b88b", "committedDate": "2020-10-12T14:05:03Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "a10aefbaea040ee77fe9cd775c964d7f76123a3d", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a10aefbaea040ee77fe9cd775c964d7f76123a3d", "committedDate": "2020-10-19T16:31:45Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a10aefbaea040ee77fe9cd775c964d7f76123a3d", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a10aefbaea040ee77fe9cd775c964d7f76123a3d", "committedDate": "2020-10-19T16:31:45Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "6d24189bd4710f56c7bdace49e17ab3aad0ef337", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6d24189bd4710f56c7bdace49e17ab3aad0ef337", "committedDate": "2020-10-19T18:14:30Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d24189bd4710f56c7bdace49e17ab3aad0ef337", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6d24189bd4710f56c7bdace49e17ab3aad0ef337", "committedDate": "2020-10-19T18:14:30Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "b54f6915fb6a2ac316bea880fa4f4753beb8b46f", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b54f6915fb6a2ac316bea880fa4f4753beb8b46f", "committedDate": "2020-10-19T18:22:24Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b54f6915fb6a2ac316bea880fa4f4753beb8b46f", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b54f6915fb6a2ac316bea880fa4f4753beb8b46f", "committedDate": "2020-10-19T18:22:24Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "1b22ead6bf16e0c28a05abcc3f111d2e920844db", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1b22ead6bf16e0c28a05abcc3f111d2e920844db", "committedDate": "2020-10-19T18:23:26Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b22ead6bf16e0c28a05abcc3f111d2e920844db", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1b22ead6bf16e0c28a05abcc3f111d2e920844db", "committedDate": "2020-10-19T18:23:26Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "2a7294e67fd347c57c11b9ad4f98b5d27e647198", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a7294e67fd347c57c11b9ad4f98b5d27e647198", "committedDate": "2020-10-19T18:45:09Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a7294e67fd347c57c11b9ad4f98b5d27e647198", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a7294e67fd347c57c11b9ad4f98b5d27e647198", "committedDate": "2020-10-19T18:45:09Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "f08bc7b2d3db7650427a0a20edc9aa7b237a0fa5", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f08bc7b2d3db7650427a0a20edc9aa7b237a0fa5", "committedDate": "2020-10-19T19:58:23Z", "message": "test commit"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f08bc7b2d3db7650427a0a20edc9aa7b237a0fa5", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f08bc7b2d3db7650427a0a20edc9aa7b237a0fa5", "committedDate": "2020-10-19T19:58:23Z", "message": "test commit"}, "afterCommit": {"oid": "580bdc86945b0153facd889e77b0e586188e14ec", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/580bdc86945b0153facd889e77b0e586188e14ec", "committedDate": "2020-10-19T20:43:39Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "580bdc86945b0153facd889e77b0e586188e14ec", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/580bdc86945b0153facd889e77b0e586188e14ec", "committedDate": "2020-10-19T20:43:39Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "6dd5e9e763107c5ba964f8ca301f2e480e463aa7", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6dd5e9e763107c5ba964f8ca301f2e480e463aa7", "committedDate": "2020-10-20T06:52:41Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6dd5e9e763107c5ba964f8ca301f2e480e463aa7", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6dd5e9e763107c5ba964f8ca301f2e480e463aa7", "committedDate": "2020-10-20T06:52:41Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "da54eea04091a16b81a02ece426afbc7a533019f", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/da54eea04091a16b81a02ece426afbc7a533019f", "committedDate": "2020-10-20T07:53:02Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f616a4b658c87161737103c2600898253254493", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0f616a4b658c87161737103c2600898253254493", "committedDate": "2020-10-20T09:13:37Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da54eea04091a16b81a02ece426afbc7a533019f", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/da54eea04091a16b81a02ece426afbc7a533019f", "committedDate": "2020-10-20T07:53:02Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}, "afterCommit": {"oid": "0f616a4b658c87161737103c2600898253254493", "author": {"user": {"login": "topolyai5", "name": "Gergely Topolyai"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0f616a4b658c87161737103c2600898253254493", "committedDate": "2020-10-20T09:13:37Z", "message": "CB-8982 Indefinitely long loop when deleting environment. When we fetched the cluster definition, we checked the default templates but this step was unnecessary, because we should delete the user managed only."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2110, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}