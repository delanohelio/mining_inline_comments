{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExMzUyNzYz", "number": 9308, "title": "CB-9243 AWS PlacementGroup Support", "bodyText": "Placement Group Configuration support for AWS Clusters via Cluster Definitions. The PlacementGroup configuration for AWS is done similar to existing AvailabilitySet Configuration for Azure Clusters.\n\nTested multiple DH Cluster launches with PG strategy as NONE, SPREAD, CLUSTER, PARTITION.\nTested multiple DH Cluster launches without any PG Configuration.\nTested default DH templates launched successfully and were configured with correct PG when PG Config was added.\nTested successful AWS Environment\\DL launches without any PG Configuration.", "createdAt": "2020-10-28T07:53:10Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9308", "merged": true, "mergeCommit": {"oid": "5af37bd8c49896a30f091b41aa509be025814376"}, "closed": true, "closedAt": "2020-10-30T14:10:00Z", "author": {"login": "smaniraju"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdW8cIaAFqTUxODU5MTgwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXnXz-AFqTUyMDcwNDM5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTkxODAz", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-518591803", "createdAt": "2020-10-28T12:08:35Z", "commit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowODozNlrOHpm7og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowODozNlrOHpm7og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTUyMg==", "bodyText": "else branch should be great here which maps to none", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391522", "createdAt": "2020-10-28T12:08:36Z", "author": {"login": "doktoric"}, "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/stacks/base/parameter/template/AwsInstanceTemplateV4Parameters.java", "diffHunk": "@@ -99,5 +115,11 @@ public void parse(Map<String, Object> parameters) {\n         if (type != null) {\n             encryption.setType(EncryptionType.valueOf(type));\n         }\n+\n+        String placementGroupStrategy = getParameterOrNull(parameters, AwsInstanceTemplate.PLACEMENT_GROUP_STRATEGY);\n+        if (placementGroupStrategy != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTkyMDQ0", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-518592044", "createdAt": "2020-10-28T12:08:55Z", "commit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowODo1NVrOHpm8Sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowODo1NVrOHpm8Sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTY5MA==", "bodyText": "if null put none into the map", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391690", "createdAt": "2020-10-28T12:08:55Z", "author": {"login": "doktoric"}, "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/stacks/base/parameter/template/AwsInstanceTemplateV4Parameters.java", "diffHunk": "@@ -60,6 +73,9 @@ public void setEncryption(AwsEncryptionV4Parameters encryption) {\n             putIfValueNotNull(map, InstanceTemplate.VOLUME_ENCRYPTION_KEY_TYPE, encryption.getType());\n             putIfValueNotNull(map, AwsInstanceTemplate.EBS_ENCRYPTION_ENABLED, encryption.getType() != EncryptionType.NONE);\n         }\n+        if (placementGroup != null) {\n+            putIfValueNotNull(map, AwsInstanceTemplate.PLACEMENT_GROUP_STRATEGY, placementGroup.getStrategy().name());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTkyMzY2", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-518592366", "createdAt": "2020-10-28T12:09:18Z", "commit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowOToxOVrOHpm9Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowOToxOVrOHpm9Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTkzOQ==", "bodyText": "why we dont put lower in the java code side ?", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391939", "createdAt": "2020-10-28T12:09:19Z", "author": {"login": "doktoric"}, "path": "cloud-aws/src/main/resources/templates/aws-cf-stack.ftl", "diffHunk": "@@ -384,6 +387,15 @@\n       }\n     }\n \n+    <#if group.placementGroupStrategy?has_content && group.placementGroupStrategy != \"NONE\">,\n+    \"PlacementGroup${group.groupName?replace('_', '')}\" : {\n+\t  \"Type\" : \"AWS::EC2::PlacementGroup\",\n+      \"Properties\" : {\n+        \"Strategy\" : \"${group.placementGroupStrategy?lower_case}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTkyNzcy", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-518592772", "createdAt": "2020-10-28T12:09:51Z", "commit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowOTo1MlrOHpm-bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMjowOTo1MlrOHpm-bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MjIzNw==", "bodyText": "use placementgroupname  here and generate in java code", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513392237", "createdAt": "2020-10-28T12:09:52Z", "author": {"login": "doktoric"}, "path": "cloud-aws/src/main/resources/templates/aws-cf-stack.ftl", "diffHunk": "@@ -368,6 +368,9 @@\n           </#if>\n           \"InstanceType\"   : \"${group.flavor}\",\n           \"KeyName\"        : { \"Ref\" : \"KeyName\" },\n+          <#if group.placementGroupStrategy?has_content && group.placementGroupStrategy != \"NONE\">\n+          \"Placement\" : { \"GroupName\" : { \"Ref\" : \"PlacementGroup${group.groupName?replace('_', '')}\" } },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dab2ca293760add9f0ba6ea0015f0537482d3497", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/dab2ca293760add9f0ba6ea0015f0537482d3497", "committedDate": "2020-10-27T16:40:48Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}, "afterCommit": {"oid": "1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "committedDate": "2020-10-29T09:27:58Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "committedDate": "2020-10-29T09:27:58Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}, "afterCommit": {"oid": "c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "committedDate": "2020-10-29T10:47:34Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "committedDate": "2020-10-29T10:47:34Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}, "afterCommit": {"oid": "d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "committedDate": "2020-10-29T10:58:28Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/feae00a84c34f25460af1e419a83e462b7be96d7", "committedDate": "2020-10-29T11:21:09Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "committedDate": "2020-10-29T10:58:28Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}, "afterCommit": {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/feae00a84c34f25460af1e419a83e462b7be96d7", "committedDate": "2020-10-29T11:21:09Z", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNDk4OTk4", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-520498998", "createdAt": "2020-10-30T09:29:40Z", "commit": {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNzA0Mzky", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#pullrequestreview-520704392", "createdAt": "2020-10-30T14:09:48Z", "commit": {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2077, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}