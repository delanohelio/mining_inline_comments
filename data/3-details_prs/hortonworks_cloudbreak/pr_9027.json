{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MTgyMTU0", "number": 9027, "title": "CB-8825 MockUMS fixes for thunderhead DatalakeApi service custom DL", "bodyText": "Contents:\n\nImprove MockUserManagementService.getAccount():\n\nGrant entitlement CDP_CM_ADMIN_CREDENTIALS\nSet accountId in response (as per request)\nSet externalAccountId in response\n\n\nImplement MockUserManagementService.listTerms() (empty dummy response only)\nUpdate existing unit tests & add some new cases", "createdAt": "2020-09-16T18:52:39Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9027", "merged": true, "mergeCommit": {"oid": "d932f5f698277798e2648b44ad3942b15ae4a060"}, "closed": true, "closedAt": "2020-09-21T14:32:55Z", "author": {"login": "lajosrodek"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJyD1sAH2gAyNDg4MTgyMTU0OmI5Y2U3ZjA4ZTQxYTMyOTA1Y2U5MThiZDM4NWQzNjc1YzA5Njg3MGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKDEDMgFqTQ5MTM0MjczMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b9ce7f08e41a32905ce918bd385d3675c096870d", "committedDate": "2020-09-17T14:42:00Z", "message": "CB-8825 MockUMS fixes for thunderhead DatalakeApi service custom DL\n\nContents:\n* Improve MockUserManagementService.getAccount():\n  * Grant entitlement CDP_CM_ADMIN_CREDENTIALS\n  * Set accountId in response (as per request)\n  * Set externalAccountId in response\n* Implement MockUserManagementService.listTerms()\n  (empty dummy response only)\n* Update existing unit tests & add some new cases"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db2f10058536e64fcbec7590d7cb9c9952b64ea0", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/db2f10058536e64fcbec7590d7cb9c9952b64ea0", "committedDate": "2020-09-16T18:47:41Z", "message": "CB-8825 MockUMS fixes for thunderhead DatalakeApi service custom DL\n\nContents:\n* Improve MockUserManagementService.getAccount():\n  * Grant entitlement CDP_CM_ADMIN_CREDENTIALS\n  * Set accountId in response (as per request)\n  * Set externalAccountId in response\n* Implement MockUserManagementService.listTerms()\n  (empty dummy response only)\n* Update existing unit tests & add some new cases"}, "afterCommit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b9ce7f08e41a32905ce918bd385d3675c096870d", "committedDate": "2020-09-17T14:42:00Z", "message": "CB-8825 MockUMS fixes for thunderhead DatalakeApi service custom DL\n\nContents:\n* Improve MockUserManagementService.getAccount():\n  * Grant entitlement CDP_CM_ADMIN_CREDENTIALS\n  * Set accountId in response (as per request)\n  * Set externalAccountId in response\n* Implement MockUserManagementService.listTerms()\n  (empty dummy response only)\n* Update existing unit tests & add some new cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzExOTYz", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#pullrequestreview-491311963", "createdAt": "2020-09-18T09:43:39Z", "commit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzM0NTg2", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#pullrequestreview-491334586", "createdAt": "2020-09-18T10:17:27Z", "commit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDoxNzoyN1rOHUG-GA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDoxNzoyN1rOHUG-GA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg0Nzc2OA==", "bodyText": "bit strange that the variable name is different from the value. would this mean CDP_CM_ADMIN_CREDENTIALS has the right to use/create custom templates?", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#discussion_r490847768", "createdAt": "2020-09-18T10:17:27Z", "author": {"login": "lacikaaa"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -210,6 +212,9 @@\n \n     private static final String CDP_ALLOW_INTERNAL_REPOSITORY_FOR_UPGRADE = \"CDP_ALLOW_INTERNAL_REPOSITORY_FOR_UPGRADE\";\n \n+    // See com.cloudera.thunderhead.service.common.entitlements.CdpEntitlements.CDP_CP_CUSTOM_DL_TEMPLATE\n+    private static final String CDP_CP_CUSTOM_DL_TEMPLATE = \"CDP_CM_ADMIN_CREDENTIALS\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzQxODU1", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#pullrequestreview-491341855", "createdAt": "2020-09-18T10:29:07Z", "commit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDoyOTowOFrOHUHWFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDoyOTowOFrOHUHWFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg1MzkwOQ==", "bodyText": "is this ok to using a fixed external name here?", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#discussion_r490853909", "createdAt": "2020-09-18T10:29:08Z", "author": {"login": "doktoric"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -590,7 +595,10 @@ public void getAccount(GetAccountRequest request, StreamObserver<GetAccountRespo\n                                 .addEntitlements(createEntitlement(DATAHUB_AZURE_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(DATAHUB_AWS_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(LOCAL_DEV))\n+                                .addEntitlements(createEntitlement(CDP_CP_CUSTOM_DL_TEMPLATE))\n                                 .setPasswordPolicy(workloadPasswordPolicy)\n+                                .setAccountId(request.getAccountId())\n+                                .setExternalAccountId(\"external-\" + request.getAccountId())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzQyNzMx", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#pullrequestreview-491342731", "createdAt": "2020-09-18T10:30:37Z", "commit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDozMDozN1rOHUHY3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDozMDozN1rOHUHY3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg1NDYyMA==", "bodyText": "the import order in your intellij is somehow different that ours please check", "url": "https://github.com/hortonworks/cloudbreak/pull/9027#discussion_r490854620", "createdAt": "2020-09-18T10:30:37Z", "author": {"login": "doktoric"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -85,10 +85,12 @@\n import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListMachineUsersResponse;\n import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListResourceAssigneesRequest;\n import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListResourceAssigneesResponse;\n-import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListServicePrincipalCloudIdentitiesRequest;\n-import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListServicePrincipalCloudIdentitiesResponse;\n import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListRolesRequest;\n import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListRolesResponse;\n+import com.cloudera.thunderhead.service.usermanagement.UserManagementProto.ListServicePrincipalCloudIdentitiesRequest;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9ce7f08e41a32905ce918bd385d3675c096870d"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2345, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}