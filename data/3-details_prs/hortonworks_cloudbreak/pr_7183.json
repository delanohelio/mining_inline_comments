{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MzI5ODAy", "number": 7183, "title": "CB-5371. Feature refactor & (E2E) remove use shared credential from the API (request)", "bodyText": "remove use shared credential from the API\n\nWHY?\nRight now, it's not enough to set use altus credential globally in order to use a shared altus credential instead of communicate with UMS, you also need to provide this \"ask\" in the request.\nThat works fine for e2e tests but not for the GUI test, as that option should be always hidden.\nSo make sense to remove from the API - at least the request part. (respone is kept so we can see on the API if that is used)\nalso refactor features object to set wrapper objects more easily", "createdAt": "2020-01-30T22:56:14Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7183", "merged": true, "mergeCommit": {"oid": "56f8afcb6ff3b861257e88cdbc2b1709f4cb282b"}, "closed": true, "closedAt": "2020-01-31T13:20:29Z", "author": {"login": "oleewere"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_jFdgABqjI5OTUyODg4NzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_t2bQAFqTM1MTQ1ODg0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "376481a1a8a941cacc31b516ec7374c005019164", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/376481a1a8a941cacc31b516ec7374c005019164", "committedDate": "2020-01-30T22:53:48Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}, "afterCommit": {"oid": "14d68a4488fb7954ef87a559442370d4f8e0da79", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/14d68a4488fb7954ef87a559442370d4f8e0da79", "committedDate": "2020-01-30T23:24:29Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14d68a4488fb7954ef87a559442370d4f8e0da79", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/14d68a4488fb7954ef87a559442370d4f8e0da79", "committedDate": "2020-01-30T23:24:29Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}, "afterCommit": {"oid": "319cef120d18f0b9eb0dae0a2c11961e7b738427", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/319cef120d18f0b9eb0dae0a2c11961e7b738427", "committedDate": "2020-01-31T00:35:46Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "319cef120d18f0b9eb0dae0a2c11961e7b738427", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/319cef120d18f0b9eb0dae0a2c11961e7b738427", "committedDate": "2020-01-31T00:35:46Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}, "afterCommit": {"oid": "fa6461cb97ca2770a8eb28fbe580b0e8bc317e53", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fa6461cb97ca2770a8eb28fbe580b0e8bc317e53", "committedDate": "2020-01-31T09:47:28Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDEzMzgy", "url": "https://github.com/hortonworks/cloudbreak/pull/7183#pullrequestreview-351413382", "createdAt": "2020-01-31T10:25:50Z", "commit": {"oid": "fa6461cb97ca2770a8eb28fbe580b0e8bc317e53"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMDoyNTo1MFrOFkHKDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMDoyNTo1MFrOFkHKDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQxMDMxNw==", "bodyText": "this logic occurs three times in this PR, maybe it is worth to extract it into some static class and call it everywhere", "url": "https://github.com/hortonworks/cloudbreak/pull/7183#discussion_r373410317", "createdAt": "2020-01-31T10:25:50Z", "author": {"login": "horadla23"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/TelemetryConverter.java", "diffHunk": "@@ -367,10 +364,12 @@ private void setReportDeploymentLogs(TelemetryRequest request, Features features\n         }\n     }\n \n-    private void setUseSharedAltusCredential(TelemetryRequest request, Features features) {\n-        if (useSharedAltusCredential && request.getFeatures() != null && request.getFeatures().getUseSharedAltusCredential() != null) {\n-            LOGGER.debug(\"Fill shared altus credential setting from telemetry feature request\");\n-            features.setUseSharedAltusCredential(request.getFeatures().getUseSharedAltusCredential());\n+    private void setUseSharedAltusCredential(Features features) {\n+        if (useSharedAltusCredential) {\n+            LOGGER.debug(\"Fill shared altus credential setting as that is enabled globally\");\n+            FeatureSetting useSharedAltusCredentialFeature = new FeatureSetting();\n+            useSharedAltusCredentialFeature.setEnabled(true);\n+            features.setUseSharedAltusCredential(useSharedAltusCredentialFeature);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa6461cb97ca2770a8eb28fbe580b0e8bc317e53"}, "originalPosition": 39}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa6461cb97ca2770a8eb28fbe580b0e8bc317e53", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fa6461cb97ca2770a8eb28fbe580b0e8bc317e53", "committedDate": "2020-01-31T09:47:28Z", "message": "CB-5371. E2E tests: remove use shared credential from the API (request)"}, "afterCommit": {"oid": "9a4723a06a16b90a9d93effb72aa2573c827a1d1", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9a4723a06a16b90a9d93effb72aa2573c827a1d1", "committedDate": "2020-01-31T11:10:35Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a4723a06a16b90a9d93effb72aa2573c827a1d1", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9a4723a06a16b90a9d93effb72aa2573c827a1d1", "committedDate": "2020-01-31T11:10:35Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}, "afterCommit": {"oid": "9a99404c1c454db6ef32ba600a2288bf4dda2eaf", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9a99404c1c454db6ef32ba600a2288bf4dda2eaf", "committedDate": "2020-01-31T11:16:00Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b20934dc06ceec246155519c9173120de1d0909a", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b20934dc06ceec246155519c9173120de1d0909a", "committedDate": "2020-01-31T11:30:42Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a99404c1c454db6ef32ba600a2288bf4dda2eaf", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9a99404c1c454db6ef32ba600a2288bf4dda2eaf", "committedDate": "2020-01-31T11:16:00Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}, "afterCommit": {"oid": "b20934dc06ceec246155519c9173120de1d0909a", "author": {"user": {"login": "oleewere", "name": "Oliv\u00e9r Szabo"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b20934dc06ceec246155519c9173120de1d0909a", "committedDate": "2020-01-31T11:30:42Z", "message": "CB-5371. Feature refactor and remove use shared credential from the API (request)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDU1MDYx", "url": "https://github.com/hortonworks/cloudbreak/pull/7183#pullrequestreview-351455061", "createdAt": "2020-01-31T11:49:11Z", "commit": {"oid": "b20934dc06ceec246155519c9173120de1d0909a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDU4ODQ5", "url": "https://github.com/hortonworks/cloudbreak/pull/7183#pullrequestreview-351458849", "createdAt": "2020-01-31T11:57:20Z", "commit": {"oid": "b20934dc06ceec246155519c9173120de1d0909a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1927, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}