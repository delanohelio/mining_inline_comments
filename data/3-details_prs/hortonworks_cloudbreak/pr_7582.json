{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3ODU0MzAw", "number": 7582, "title": "CB-5768 Add entitlement and enable feature flag for IDBroker mapping validation", "bodyText": "Adds IDBroker mapping validation as an entitlement and defaults the feature flag of environment request to true for IDBroker mapping validation. This lays the way to enable this per tenant in CDP in case there are issues with SimulatePrincipalPolicy due to IAM limits or other AWS issues (altus found that SimulatePrincipalPolicy is not always accurate).", "createdAt": "2020-03-13T15:57:06Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7582", "merged": true, "mergeCommit": {"oid": "bd72afe8a8753788c954e73e4f7d6caac909480f"}, "closed": true, "closedAt": "2020-03-18T07:38:24Z", "author": {"login": "risdenk"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOPClKgBqjMxMzM0NjQwMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOnmpeABqjMxMzg2OTE5NTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "230893bcc8b99c7253acd25f7c3efdb15060782c", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/230893bcc8b99c7253acd25f7c3efdb15060782c", "committedDate": "2020-03-13T15:55:16Z", "message": "CB-5678 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}, "afterCommit": {"oid": "6e5a163f248ff1192010fdd55f5330e3cd8d3a05", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6e5a163f248ff1192010fdd55f5330e3cd8d3a05", "committedDate": "2020-03-16T14:32:12Z", "message": "CB-5678 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e5a163f248ff1192010fdd55f5330e3cd8d3a05", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6e5a163f248ff1192010fdd55f5330e3cd8d3a05", "committedDate": "2020-03-16T14:32:12Z", "message": "CB-5678 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}, "afterCommit": {"oid": "be47de6823bea31e8f661c757f90602df1d52b13", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/be47de6823bea31e8f661c757f90602df1d52b13", "committedDate": "2020-03-16T14:32:33Z", "message": "CB-5768 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Mzg0MjQ0", "url": "https://github.com/hortonworks/cloudbreak/pull/7582#pullrequestreview-375384244", "createdAt": "2020-03-16T16:32:48Z", "commit": {"oid": "be47de6823bea31e8f661c757f90602df1d52b13"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNjozMjo0OFrOF28PZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNjozMjo0OFrOF28PZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1NDQwNA==", "bodyText": "You may need to use the IAM service rather than DATALAKE in order to get the internal actor CRN to validate in the UMS. See #7481 (comment).", "url": "https://github.com/hortonworks/cloudbreak/pull/7582#discussion_r393154404", "createdAt": "2020-03-16T16:32:48Z", "author": {"login": "jamisonbennett"}, "path": "datalake/src/main/java/com/sequenceiq/datalake/service/validation/cloudstorage/CloudStorageValidator.java", "diffHunk": "@@ -21,28 +26,42 @@\n @Component\n public class CloudStorageValidator {\n \n+    private static final String DATALAKE_INTERNAL_ACTOR_CRN = new InternalCrnBuilder(Crn.Service.DATALAKE).getInternalCrnForServiceAsString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be47de6823bea31e8f661c757f90602df1d52b13"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43d041b8b3a7d6210cd5208a999506edd8347345", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/43d041b8b3a7d6210cd5208a999506edd8347345", "committedDate": "2020-03-17T19:09:20Z", "message": "CB-5768 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be47de6823bea31e8f661c757f90602df1d52b13", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/be47de6823bea31e8f661c757f90602df1d52b13", "committedDate": "2020-03-16T14:32:33Z", "message": "CB-5768 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}, "afterCommit": {"oid": "43d041b8b3a7d6210cd5208a999506edd8347345", "author": {"user": {"login": "risdenk", "name": "Kevin Risden"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/43d041b8b3a7d6210cd5208a999506edd8347345", "committedDate": "2020-03-17T19:09:20Z", "message": "CB-5768 Add entitlement and enable feature flag for IDBroker mapping validation\n\nSigned-off-by: Kevin Risden <krisden@cloudera.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2446, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}