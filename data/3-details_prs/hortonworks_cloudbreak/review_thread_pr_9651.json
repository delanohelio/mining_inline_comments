{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5ODQzMDgw", "number": 9651, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMzo1NDozM1rOFFUW2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNjoxMToyMFrOFFrPpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxMTIwNzMxOnYy", "diffSide": "RIGHT", "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMzo1NDozM1rOIFx-IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNjoyMDoyMlrOIGT2SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjkzMjUxMw==", "bodyText": "Is this enabled for all runtime versions? Is there a way to enable this only for 7.2.7 and above?", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r542932513", "createdAt": "2020-12-14T23:54:33Z", "author": {"login": "kmanamcheri"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ4NzU2MQ==", "bodyText": "All run times, knox should ignore it if it's not supported.  There's no way to make it 7.2.7+ only.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543487561", "createdAt": "2020-12-15T16:20:22Z", "author": {"login": "frozenwizard"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjkzMjUxMw=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxMzU3MzgzOnYy", "diffSide": "RIGHT", "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMTo0MToxMlrOIGGsbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMDo0MjozOFrOIGfHcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI3MjA0NA==", "bodyText": "Why are we not this for HIVE? Hive would be one to benefit the most.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543272044", "createdAt": "2020-12-15T11:41:12Z", "author": {"login": "moresandeep"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'CM-API' in exposed and 'CM-API' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>CM-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>CM-UI</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'HIVE' in exposed and 'HIVESERVER2' in salt['pillar.get']('gateway:location') -%}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ3MzcxOA==", "bodyText": "Hive is connected to by the compute engines, so it shouldn't need this?  Or should it?  I've only done this for the ui/api services.\nAlso it's possible that the datahub would use those configurations as well, I'm not sure if they should be supported?", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543473718", "createdAt": "2020-12-15T16:03:06Z", "author": {"login": "frozenwizard"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'CM-API' in exposed and 'CM-API' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>CM-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>CM-UI</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'HIVE' in exposed and 'HIVESERVER2' in salt['pillar.get']('gateway:location') -%}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI3MjA0NA=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ4MTIyMg==", "bodyText": "The original bug was opened for Hive and I tested this, like dev tested it using beeline for hive.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543481222", "createdAt": "2020-12-15T16:12:26Z", "author": {"login": "moresandeep"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'CM-API' in exposed and 'CM-API' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>CM-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>CM-UI</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'HIVE' in exposed and 'HIVESERVER2' in salt['pillar.get']('gateway:location') -%}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI3MjA0NA=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ4NzAwOA==", "bodyText": "@orngejaket We want to change only for Datalake right? Is the current code change applicable for Datalake or Datahubs as well?\n@moresandeep I understand that the original one was opened for Hive, but we'd like to use it for Atlas/Ranger and the other components in the datalake.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543487008", "createdAt": "2020-12-15T16:19:35Z", "author": {"login": "kmanamcheri"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'CM-API' in exposed and 'CM-API' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>CM-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>CM-UI</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'HIVE' in exposed and 'HIVESERVER2' in salt['pillar.get']('gateway:location') -%}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI3MjA0NA=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY3MjE3OA==", "bodyText": "We should be careful with this, there are some edge cases that could cause issues with retries.\nAlso, Atlas is active/passive so HA will not work there.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543672178", "createdAt": "2020-12-15T20:42:38Z", "author": {"login": "moresandeep"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'CM-API' in exposed and 'CM-API' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>CM-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>CM-UI</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              {%- endif %}\n              {% if 'HIVE' in exposed and 'HIVESERVER2' in salt['pillar.get']('gateway:location') -%}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI3MjA0NA=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxNDk1NzE4OnYy", "diffSide": "RIGHT", "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNjoxMToyMFrOIGTZ-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxOToyNjoxNVrOIN-DYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ4MDMxMw==", "bodyText": "This would break Atlas, we should not be using Knox HA for atlas since it is active-passive. adding stickysession would break it badly.", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r543480313", "createdAt": "2020-12-15T16:11:20Z", "author": {"login": "moresandeep"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTUxOTA3NA==", "bodyText": "Ok so no changes to Atlas then?", "url": "https://github.com/hortonworks/cloudbreak/pull/9651#discussion_r551519074", "createdAt": "2021-01-04T19:26:15Z", "author": {"login": "frozenwizard"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -198,21 +198,21 @@\n              {% if 'ATLAS' in exposed and 'ATLAS_SERVER' in salt['pillar.get']('gateway:location') -%}\n              <param>\n                  <name>ATLAS</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>\n              </param>\n              <param>\n                  <name>ATLAS-API</name>\n-                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000</value>\n+                 <value>enabled=true;maxFailoverAttempts=3;failoverSleep=1000;enableStickySessions=true</value>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ4MDMxMw=="}, "originalCommit": {"oid": "af32c982e4af3d664049d4dae3996ec518ef12de"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3470, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}