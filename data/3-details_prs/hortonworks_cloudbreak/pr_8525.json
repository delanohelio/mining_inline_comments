{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODE1MDA2", "number": 8525, "title": "DISTX-478-Introduce Config Change History Event", "bodyText": "Introduce History Event for Cluster Autoscale Config Change.\nIntroduce History Event for Schedule-Based Autoscaling.\nAdditonal Validations for Autoscaling Requests.", "createdAt": "2020-07-09T12:01:17Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8525", "merged": true, "mergeCommit": {"oid": "bede33547eb74ebefaee11a1160dfa0924487447"}, "closed": true, "closedAt": "2020-07-14T19:22:56Z", "author": {"login": "smaniraju"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczh75xgBqjM1MzM1MDIzMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc07HJcgFqTQ0ODM5Njg0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28263e9d229d637694bd4f92c66d2b1b7d27a541", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/28263e9d229d637694bd4f92c66d2b1b7d27a541", "committedDate": "2020-07-09T11:57:34Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce history event for Cluster Autoscale Config Change."}, "afterCommit": {"oid": "f37d50f941ba025dbcbb6504de99c54c7e142494", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f37d50f941ba025dbcbb6504de99c54c7e142494", "committedDate": "2020-07-10T11:27:04Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce history event for Cluster Autoscale Config Change."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1OTA5Nzcz", "url": "https://github.com/hortonworks/cloudbreak/pull/8525#pullrequestreview-445909773", "createdAt": "2020-07-09T19:32:49Z", "commit": {"oid": "28263e9d229d637694bd4f92c66d2b1b7d27a541"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTozMjo0OVrOGve-vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTozMjo0OVrOGve-vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0MzgzOA==", "bodyText": "Can we add more details here? i.e. Switched from load based to schedule, etc etc?\nNext question would be whether autoscaling events go in the regular Activity tab or a separate tab altogether. Also - this will get very noisy while the UI updates configs on each change. That may not matter since this is not displayed on the UI at the moment?", "url": "https://github.com/hortonworks/cloudbreak/pull/8525#discussion_r452443838", "createdAt": "2020-07-09T19:32:49Z", "author": {"login": "sidseth"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/controller/DistroXAutoScaleClusterV1Controller.java", "diffHunk": "@@ -119,10 +129,18 @@ private DistroXAutoscaleClusterResponse updateClusterAutoScaleConfig(Long cluste\n                 alertController.createTimeAlerts(clusterId, autoscaleClusterRequest.getTimeAlertRequests());\n                 asClusterCommonService.setAutoscaleState(clusterId, autoscaleClusterRequest.getEnableAutoscaling());\n             });\n+            createHistoryAndNotifyConfigChange(clusterId);\n         } catch (TransactionService.TransactionExecutionException e) {\n             throw e.getCause();\n         }\n \n         return createClusterJsonResponse(clusterService.findById(clusterId));\n     }\n+\n+    private void createHistoryAndNotifyConfigChange(long clusterId) {\n+        Cluster cluster = clusterService.findById(clusterId);\n+        History history = historyService.createEntry(ScalingStatus.CONFIG_UPDATED,\n+                \"Autoscaling config has been updated for the cluster.\", cluster);\n+        notificationSender.send(cluster, history);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28263e9d229d637694bd4f92c66d2b1b7d27a541"}, "originalPosition": 50}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f37d50f941ba025dbcbb6504de99c54c7e142494", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f37d50f941ba025dbcbb6504de99c54c7e142494", "committedDate": "2020-07-10T11:27:04Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce history event for Cluster Autoscale Config Change."}, "afterCommit": {"oid": "b2065a2832b3dac1a8d19aa3cde0d48be664ce28", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b2065a2832b3dac1a8d19aa3cde0d48be664ce28", "committedDate": "2020-07-14T09:38:36Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce History Event for Cluster Autoscale Config Change.\nIntroduce History Event for Schedule-Based Autoscaling.\nAdditonal Validations for Autoscaling Requests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f55447ff030cb540bac2ee260f2009595b07adab", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f55447ff030cb540bac2ee260f2009595b07adab", "committedDate": "2020-07-14T11:56:12Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce History Event for Cluster Autoscale Config Change.\nIntroduce History Event for Schedule-Based Autoscaling.\nAdditonal Validations for Autoscaling Requests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2065a2832b3dac1a8d19aa3cde0d48be664ce28", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b2065a2832b3dac1a8d19aa3cde0d48be664ce28", "committedDate": "2020-07-14T09:38:36Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce History Event for Cluster Autoscale Config Change.\nIntroduce History Event for Schedule-Based Autoscaling.\nAdditonal Validations for Autoscaling Requests."}, "afterCommit": {"oid": "f55447ff030cb540bac2ee260f2009595b07adab", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f55447ff030cb540bac2ee260f2009595b07adab", "committedDate": "2020-07-14T11:56:12Z", "message": "DISTX-478-Introduce Config Change History Event\n\nIntroduce History Event for Cluster Autoscale Config Change.\nIntroduce History Event for Schedule-Based Autoscaling.\nAdditonal Validations for Autoscaling Requests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4Mzk2ODQ5", "url": "https://github.com/hortonworks/cloudbreak/pull/8525#pullrequestreview-448396849", "createdAt": "2020-07-14T19:22:21Z", "commit": {"oid": "f55447ff030cb540bac2ee260f2009595b07adab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2699, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}