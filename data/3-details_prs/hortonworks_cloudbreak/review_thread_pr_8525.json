{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODE1MDA2", "number": 8525, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTozMjo0OVrOENB0YA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTozMjo0OVrOENB0YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyMDk2NzM2OnYy", "diffSide": "RIGHT", "path": "autoscale/src/main/java/com/sequenceiq/periscope/controller/DistroXAutoScaleClusterV1Controller.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTozMjo0OVrOGve-vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOTo0NDo0NFrOGxMUeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0MzgzOA==", "bodyText": "Can we add more details here? i.e. Switched from load based to schedule, etc etc?\nNext question would be whether autoscaling events go in the regular Activity tab or a separate tab altogether. Also - this will get very noisy while the UI updates configs on each change. That may not matter since this is not displayed on the UI at the moment?", "url": "https://github.com/hortonworks/cloudbreak/pull/8525#discussion_r452443838", "createdAt": "2020-07-09T19:32:49Z", "author": {"login": "sidseth"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/controller/DistroXAutoScaleClusterV1Controller.java", "diffHunk": "@@ -119,10 +129,18 @@ private DistroXAutoscaleClusterResponse updateClusterAutoScaleConfig(Long cluste\n                 alertController.createTimeAlerts(clusterId, autoscaleClusterRequest.getTimeAlertRequests());\n                 asClusterCommonService.setAutoscaleState(clusterId, autoscaleClusterRequest.getEnableAutoscaling());\n             });\n+            createHistoryAndNotifyConfigChange(clusterId);\n         } catch (TransactionService.TransactionExecutionException e) {\n             throw e.getCause();\n         }\n \n         return createClusterJsonResponse(clusterService.findById(clusterId));\n     }\n+\n+    private void createHistoryAndNotifyConfigChange(long clusterId) {\n+        Cluster cluster = clusterService.findById(clusterId);\n+        History history = historyService.createEntry(ScalingStatus.CONFIG_UPDATED,\n+                \"Autoscaling config has been updated for the cluster.\", cluster);\n+        notificationSender.send(cluster, history);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28263e9d229d637694bd4f92c66d2b1b7d27a541"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzNTI1Nw==", "bodyText": "Updated to include HostGroup and ScalingType in the historyEvent for CONFIG_UPDATED.  This is a valid history event along with Enabling\\Disabling Autoscaling and would be required in case of support issues and to avoid customer confusion as to current Autoscaling Config.\nThere is little noise because UI updates on each change basically for Load-Based Autoscaling, specific event CONFIG_UPDATED can be filtered out while showing in UI if it becomes too noisy.", "url": "https://github.com/hortonworks/cloudbreak/pull/8525#discussion_r454235257", "createdAt": "2020-07-14T09:44:44Z", "author": {"login": "smaniraju"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/controller/DistroXAutoScaleClusterV1Controller.java", "diffHunk": "@@ -119,10 +129,18 @@ private DistroXAutoscaleClusterResponse updateClusterAutoScaleConfig(Long cluste\n                 alertController.createTimeAlerts(clusterId, autoscaleClusterRequest.getTimeAlertRequests());\n                 asClusterCommonService.setAutoscaleState(clusterId, autoscaleClusterRequest.getEnableAutoscaling());\n             });\n+            createHistoryAndNotifyConfigChange(clusterId);\n         } catch (TransactionService.TransactionExecutionException e) {\n             throw e.getCause();\n         }\n \n         return createClusterJsonResponse(clusterService.findById(clusterId));\n     }\n+\n+    private void createHistoryAndNotifyConfigChange(long clusterId) {\n+        Cluster cluster = clusterService.findById(clusterId);\n+        History history = historyService.createEntry(ScalingStatus.CONFIG_UPDATED,\n+                \"Autoscaling config has been updated for the cluster.\", cluster);\n+        notificationSender.send(cluster, history);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0MzgzOA=="}, "originalCommit": {"oid": "28263e9d229d637694bd4f92c66d2b1b7d27a541"}, "originalPosition": 50}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3132, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}