{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNDk1NjQy", "number": 9084, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxMDoxNlrOEnM7LQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxNDoyOVrOEnNAdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5NTQxNjc3OnYy", "diffSide": "RIGHT", "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxMDoxNlrOHXq5Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxMDowMzowM1rOHX9V7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4MjA3OA==", "bodyText": "Shouldn't the DATAHUB_DEFAULT_SCALING should also be added here?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494582078", "createdAt": "2020-09-24T20:10:16Z", "author": {"login": "biharitomi"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -594,6 +598,8 @@ public void getAccount(GetAccountRequest request, StreamObserver<GetAccountRespo\n                                 .addEntitlements(createEntitlement(DATAHUB_AZURE_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(DATAHUB_AWS_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(LOCAL_DEV))\n+                                .addEntitlements(createEntitlement(DATAHUB_FLOW_SCALING))\n+                                .addEntitlements(createEntitlement(DATAHUB_STREAMING_SCALING))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc5NzQxNA==", "bodyText": "I dont want to enable that one yet", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494797414", "createdAt": "2020-09-25T07:24:18Z", "author": {"login": "doktoric"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -594,6 +598,8 @@ public void getAccount(GetAccountRequest request, StreamObserver<GetAccountRespo\n                                 .addEntitlements(createEntitlement(DATAHUB_AZURE_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(DATAHUB_AWS_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(LOCAL_DEV))\n+                                .addEntitlements(createEntitlement(DATAHUB_FLOW_SCALING))\n+                                .addEntitlements(createEntitlement(DATAHUB_STREAMING_SCALING))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4MjA3OA=="}, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg4NDMzMw==", "bodyText": "ok", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494884333", "createdAt": "2020-09-25T10:03:03Z", "author": {"login": "biharitomi"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -594,6 +598,8 @@ public void getAccount(GetAccountRequest request, StreamObserver<GetAccountRespo\n                                 .addEntitlements(createEntitlement(DATAHUB_AZURE_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(DATAHUB_AWS_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(LOCAL_DEV))\n+                                .addEntitlements(createEntitlement(DATAHUB_FLOW_SCALING))\n+                                .addEntitlements(createEntitlement(DATAHUB_STREAMING_SCALING))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4MjA3OA=="}, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5NTQyOTY3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/ClusterCommonService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxNDoyMVrOHXrBKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxMDowMzo1NlrOHX9XnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDEwNg==", "bodyText": "Shouldn't we gather and check the user who initiated this scaling operation?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494584106", "createdAt": "2020-09-24T20:14:21Z", "author": {"login": "biharitomi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/ClusterCommonService.java", "diffHunk": "@@ -127,7 +129,14 @@ private FlowIdentifier clusterHostgroupAdjustmentChange(Long stackId, UpdateClus\n                     updateJson.getHostGroupAdjustment().getHostGroup(), stack.getName()));\n         }\n         if (blueprintService.isClouderaManagerTemplate(blueprint)) {\n-            cmTemplateValidator.validateHostGroupScalingRequest(blueprint, hostGroup.get(),\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc5Nzg0OA==", "bodyText": "I think what we want to check is the account entitlement. It does not matter who initiated this", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494797848", "createdAt": "2020-09-25T07:25:15Z", "author": {"login": "doktoric"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/ClusterCommonService.java", "diffHunk": "@@ -127,7 +129,14 @@ private FlowIdentifier clusterHostgroupAdjustmentChange(Long stackId, UpdateClus\n                     updateJson.getHostGroupAdjustment().getHostGroup(), stack.getName()));\n         }\n         if (blueprintService.isClouderaManagerTemplate(blueprint)) {\n-            cmTemplateValidator.validateHostGroupScalingRequest(blueprint, hostGroup.get(),\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDEwNg=="}, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg4NDc2NQ==", "bodyText": "Yet, but probably it we should consider it later, I am ok with that, but I said :)", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494884765", "createdAt": "2020-09-25T10:03:56Z", "author": {"login": "biharitomi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/ClusterCommonService.java", "diffHunk": "@@ -127,7 +129,14 @@ private FlowIdentifier clusterHostgroupAdjustmentChange(Long stackId, UpdateClus\n                     updateJson.getHostGroupAdjustment().getHostGroup(), stack.getName()));\n         }\n         if (blueprintService.isClouderaManagerTemplate(blueprint)) {\n-            cmTemplateValidator.validateHostGroupScalingRequest(blueprint, hostGroup.get(),\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDEwNg=="}, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5NTQzMDMxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/stack/flow/UpdateNodeCountValidator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxNDoyOVrOHXrBiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNzoyNTozN1rOHX4Ezw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDIwMA==", "bodyText": "Shouldn't we gather and check the user who initiated this scaling operation?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494584200", "createdAt": "2020-09-24T20:14:29Z", "author": {"login": "biharitomi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/stack/flow/UpdateNodeCountValidator.java", "diffHunk": "@@ -80,7 +81,12 @@ public void validateServiceRoles(Stack stack, InstanceGroupAdjustmentV4Request i\n                 .filter(e -> e.getName().equals(instanceGroup))\n                 .findFirst();\n         if (hostGroup.isPresent()) {\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc5ODAzMQ==", "bodyText": "nope", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494798031", "createdAt": "2020-09-25T07:25:37Z", "author": {"login": "doktoric"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/stack/flow/UpdateNodeCountValidator.java", "diffHunk": "@@ -80,7 +81,12 @@ public void validateServiceRoles(Stack stack, InstanceGroupAdjustmentV4Request i\n                 .filter(e -> e.getName().equals(instanceGroup))\n                 .findFirst();\n         if (hostGroup.isPresent()) {\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDIwMA=="}, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2209, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}