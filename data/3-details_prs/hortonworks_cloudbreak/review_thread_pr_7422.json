{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMzkxMzI3", "number": 7422, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNDozNToxMVrODj1Vew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNDozNToxMVrODj1Vew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTAwNjAzOnYy", "diffSide": "RIGHT", "path": "environment/src/main/java/com/sequenceiq/environment/environment/validation/network/AzureEnvironmentNetworkValidator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNDozNToxMVrOFv2-tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNjo1NjoxMFrOFv741g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTcyODE4MQ==", "bodyText": "What if the number of subnets listed is right but one subnet contains a typo?", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#discussion_r385728181", "createdAt": "2020-02-28T14:35:11Z", "author": {"login": "gergopapi2"}, "path": "environment/src/main/java/com/sequenceiq/environment/environment/validation/network/AzureEnvironmentNetworkValidator.java", "diffHunk": "@@ -50,14 +50,22 @@ public void validateDuringRequest(NetworkDto networkDto, Map<String, CloudSubnet\n         }\n     }\n \n-    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder,\n+    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder, NetworkDto network,\n             AzureParams azureParams, Map<String, CloudSubnet> subnetMetas) {\n-        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())\n-                && MapUtils.isEmpty(subnetMetas)) {\n-            String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n-                    azureParams.getNetworkId(), azureParams.getResourceGroupName());\n-            LOGGER.info(message);\n-            resultBuilder.error(message);\n+        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())) {\n+            if (CollectionUtils.isEmpty(network.getSubnetIds())) {\n+                String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n+                        azureParams.getNetworkId(), azureParams.getResourceGroupName());\n+                LOGGER.info(message);\n+                resultBuilder.error(message);\n+            } else if (subnetMetas.size() != network.getSubnetIds().size()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgwODU5OA==", "bodyText": "Ah, my mistake, this is right.", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#discussion_r385808598", "createdAt": "2020-02-28T16:56:10Z", "author": {"login": "gergopapi2"}, "path": "environment/src/main/java/com/sequenceiq/environment/environment/validation/network/AzureEnvironmentNetworkValidator.java", "diffHunk": "@@ -50,14 +50,22 @@ public void validateDuringRequest(NetworkDto networkDto, Map<String, CloudSubnet\n         }\n     }\n \n-    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder,\n+    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder, NetworkDto network,\n             AzureParams azureParams, Map<String, CloudSubnet> subnetMetas) {\n-        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())\n-                && MapUtils.isEmpty(subnetMetas)) {\n-            String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n-                    azureParams.getNetworkId(), azureParams.getResourceGroupName());\n-            LOGGER.info(message);\n-            resultBuilder.error(message);\n+        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())) {\n+            if (CollectionUtils.isEmpty(network.getSubnetIds())) {\n+                String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n+                        azureParams.getNetworkId(), azureParams.getResourceGroupName());\n+                LOGGER.info(message);\n+                resultBuilder.error(message);\n+            } else if (subnetMetas.size() != network.getSubnetIds().size()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTcyODE4MQ=="}, "originalCommit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2810, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}