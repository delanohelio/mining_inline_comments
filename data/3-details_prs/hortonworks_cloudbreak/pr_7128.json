{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MjYyMDI2", "number": 7128, "title": "CB-5235 Refactor ResourceAccessDto", "bodyText": "This is the first step of refactorings.\nCurrent PR contains Step 1 described under solution.\nProblem\nMany operations work as byName or byCrn. There are separate implementations for byName and byCrn, although the difference is usually in 1 line (and +1 log line). This is a duplication and should be removed.\nSolution\nStep 1: refactor String name and String Crn into one class: NameOrCrn. The class should be instantiable only from either crn or name, never both and never none (thus a NameXorCrn would be a better name).\nStep 2: methods that exist in byName and byCrn flavor should get NameOrCrn as parameter and pass it on to a getEntity method in an underlying service (but not repository).", "createdAt": "2020-01-23T09:27:20Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7128", "merged": true, "mergeCommit": {"oid": "dc6a71e655a54cad62751f3eee72d90f4534fa26"}, "closed": true, "closedAt": "2020-02-03T08:01:29Z", "author": {"login": "gergopapi2"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9HaS7ABqjI5NzMxMTc4ODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_zOPKAFqTM1MTY4MzYwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a4c87dbdfedd709c291eceeb18201cbcb58794a", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0a4c87dbdfedd709c291eceeb18201cbcb58794a", "committedDate": "2020-01-23T09:25:48Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "ff59d83bc03d5af364191304f9ec5a7ec22e490d", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ff59d83bc03d5af364191304f9ec5a7ec22e490d", "committedDate": "2020-01-23T10:02:00Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff59d83bc03d5af364191304f9ec5a7ec22e490d", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ff59d83bc03d5af364191304f9ec5a7ec22e490d", "committedDate": "2020-01-23T10:02:00Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "bb777b3f2f0c99992c7c4b7953d65e4ea0901157", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bb777b3f2f0c99992c7c4b7953d65e4ea0901157", "committedDate": "2020-01-24T20:58:28Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb777b3f2f0c99992c7c4b7953d65e4ea0901157", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bb777b3f2f0c99992c7c4b7953d65e4ea0901157", "committedDate": "2020-01-24T20:58:28Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b", "committedDate": "2020-01-27T08:16:30Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NjM4NDY2", "url": "https://github.com/hortonworks/cloudbreak/pull/7128#pullrequestreview-348638466", "createdAt": "2020-01-27T12:51:39Z", "commit": {"oid": "b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMjo1MTozOVrOFiBoBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMjo1MTozOVrOFiBoBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTIyMjUzNA==", "bodyText": "Why not moving the methods if this inner class to the original class, and remove NameOrCrnReader? Why would we bother instantiating this to be able to read the NameOrCrn class?", "url": "https://github.com/hortonworks/cloudbreak/pull/7128#discussion_r371222534", "createdAt": "2020-01-27T12:51:39Z", "author": {"login": "attilapalfi92"}, "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/dto/NameOrCrn.java", "diffHunk": "@@ -0,0 +1,87 @@\n+package com.sequenceiq.cloudbreak.api.endpoint.v4.dto;\n+\n+import static com.sequenceiq.cloudbreak.util.NullUtil.throwIfNull;\n+import static org.apache.commons.lang3.StringUtils.isNotEmpty;\n+\n+import org.apache.commons.lang3.StringUtils;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+\n+public class NameOrCrn {\n+\n+    private static final String NULL_DTO_EXCEPTION_MESSAGE = \"Name or crn should not be null.\";\n+\n+    private static final String NAME_MUST_BE_PROVIDED_EXCEPTION_MESSAGE = \"Name must be provided.\";\n+\n+    private static final String CRN_MUST_BE_PROVIDED_EXCEPTION_MESSAGE = \"Crn must be provided.\";\n+\n+    @VisibleForTesting\n+    final String name;\n+\n+    @VisibleForTesting\n+    final String crn;\n+\n+    private NameOrCrn(String name, String crn) {\n+        this.name = name;\n+        this.crn = crn;\n+    }\n+\n+    public static NameOrCrn ofName(String name) {\n+        if (StringUtils.isEmpty(name)) {\n+            throw new IllegalArgumentException(NAME_MUST_BE_PROVIDED_EXCEPTION_MESSAGE);\n+        }\n+        return new NameOrCrn(name, null);\n+    }\n+\n+    public static NameOrCrn ofCrn(String crn) {\n+        if (StringUtils.isEmpty(crn)) {\n+            throw new IllegalArgumentException(CRN_MUST_BE_PROVIDED_EXCEPTION_MESSAGE);\n+        }\n+        return new NameOrCrn(null, crn);\n+    }\n+\n+    @Override\n+    public String toString() {\n+        StringBuilder toString = new StringBuilder();\n+        toString.append(\"[NameOrCrn\");\n+        if (isNotEmpty(name)) {\n+            toString.append(\" of name: '\");\n+            toString.append(name);\n+        } else {\n+            toString.append(\" of crn: '\");\n+            toString.append(crn);\n+        }\n+        toString.append(\"']\");\n+        return toString.toString();\n+    }\n+\n+    public static class NameOrCrnReader {\n+\n+        private final NameOrCrn nameOrCrn;\n+\n+        private NameOrCrnReader(NameOrCrn nameOrCrn) {\n+            this.nameOrCrn = nameOrCrn;\n+        }\n+\n+        public static NameOrCrnReader create(NameOrCrn nameOrCrn) {\n+            throwIfNull(nameOrCrn, () -> new IllegalArgumentException(NULL_DTO_EXCEPTION_MESSAGE));\n+            return new NameOrCrnReader(nameOrCrn);\n+        }\n+\n+        public boolean hasName() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b"}, "originalPosition": 71}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b08a16a0ed6e205b37cd7ba7aa08e46a615ea69b", "committedDate": "2020-01-27T08:16:30Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "f1ba414fc3fd24ff52b03f7563c992f4f3df0f2f", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f1ba414fc3fd24ff52b03f7563c992f4f3df0f2f", "committedDate": "2020-01-30T12:52:43Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1ba414fc3fd24ff52b03f7563c992f4f3df0f2f", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f1ba414fc3fd24ff52b03f7563c992f4f3df0f2f", "committedDate": "2020-01-30T12:52:43Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "0a8457e738ecfad335bb98fa16bbf1df9e5c0c90", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0a8457e738ecfad335bb98fa16bbf1df9e5c0c90", "committedDate": "2020-01-30T13:16:40Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c59a2b146fd3c7159579bbc494d6116f199f02ea", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c59a2b146fd3c7159579bbc494d6116f199f02ea", "committedDate": "2020-01-30T13:43:13Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a8457e738ecfad335bb98fa16bbf1df9e5c0c90", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0a8457e738ecfad335bb98fa16bbf1df9e5c0c90", "committedDate": "2020-01-30T13:16:40Z", "message": "CB-5235 Refactor ResourceAccessDto"}, "afterCommit": {"oid": "c59a2b146fd3c7159579bbc494d6116f199f02ea", "author": {"user": {"login": "gergopapi2", "name": "Gergely Papp"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c59a2b146fd3c7159579bbc494d6116f199f02ea", "committedDate": "2020-01-30T13:43:13Z", "message": "CB-5235 Refactor ResourceAccessDto"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNjE3MTM1", "url": "https://github.com/hortonworks/cloudbreak/pull/7128#pullrequestreview-351617135", "createdAt": "2020-01-31T16:19:40Z", "commit": {"oid": "c59a2b146fd3c7159579bbc494d6116f199f02ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNjgzNjAx", "url": "https://github.com/hortonworks/cloudbreak/pull/7128#pullrequestreview-351683601", "createdAt": "2020-01-31T18:12:53Z", "commit": {"oid": "c59a2b146fd3c7159579bbc494d6116f199f02ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1996, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}