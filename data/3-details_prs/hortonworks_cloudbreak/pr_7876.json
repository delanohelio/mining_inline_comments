{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NDc5OTk2", "number": 7876, "title": "CB-6497: Update Nginx config and other setup for freeipa healthagent", "bodyText": "This patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n(cherry picked from commit afeb8f6)\nRemoved the separate script for unless and included the check in the freeipa_healthagent_setup.sh itself.", "createdAt": "2020-04-22T19:04:22Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7876", "merged": true, "mergeCommit": {"oid": "bb5ebdf54b0f987e232e381960cf6dc2d66ea8ed"}, "closed": true, "closedAt": "2020-04-28T16:02:49Z", "author": {"login": "holleyism"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaWe2JgFqTM5ODc4MDM5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccGGmWAFqTQwMTk4Njc2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NzgwMzk1", "url": "https://github.com/hortonworks/cloudbreak/pull/7876#pullrequestreview-398780395", "createdAt": "2020-04-23T05:59:42Z", "commit": {"oid": "453867c1b31eb30d364d63d52cc9d01dedf2e6f4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNTo1OTo0MlrOGKX7jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNTo1OTo0MlrOGKX7jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzUzMTAyMQ==", "bodyText": "shouldn't this state have any onlyif/unless option, so we won't run it if not necessary?", "url": "https://github.com/hortonworks/cloudbreak/pull/7876#discussion_r413531021", "createdAt": "2020-04-23T05:59:42Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/resources/freeipa-salt/salt/freeipa/common-install.sls", "diffHunk": "@@ -65,3 +65,19 @@ restart_httpd:\n     - watch:\n       - file: /etc/httpd/conf.d/ipa-rewrite.conf\n \n+install-healthagent:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "453867c1b31eb30d364d63d52cc9d01dedf2e6f4"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "453867c1b31eb30d364d63d52cc9d01dedf2e6f4", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/453867c1b31eb30d364d63d52cc9d01dedf2e6f4", "committedDate": "2020-04-22T19:02:48Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}, "afterCommit": {"oid": "fa79344f8f011641252225b07f8080673c409fcf", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fa79344f8f011641252225b07f8080673c409fcf", "committedDate": "2020-04-23T21:51:48Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa79344f8f011641252225b07f8080673c409fcf", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fa79344f8f011641252225b07f8080673c409fcf", "committedDate": "2020-04-23T21:51:48Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}, "afterCommit": {"oid": "eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8", "committedDate": "2020-04-27T18:49:56Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNjQ0Mjc0", "url": "https://github.com/hortonworks/cloudbreak/pull/7876#pullrequestreview-401644274", "createdAt": "2020-04-28T09:10:24Z", "commit": {"oid": "eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwOToxMDoyNFrOGNKcew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwOToxMDoyNFrOGNKcew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjQ1NTgwMw==", "bodyText": "I just noticed that this duplicates the content of freeipa_check_replication.sh. could you update this to have it only in one place, eg. like a method and use that in both place?", "url": "https://github.com/hortonworks/cloudbreak/pull/7876#discussion_r416455803", "createdAt": "2020-04-28T09:10:24Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/resources/freeipa-salt/salt/freeipa/scripts/freeipa_healthagent_setup.sh", "diffHunk": "@@ -0,0 +1,19 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Add anonymous access only for replication agreements\n+#\n+\n+export HOSTCN=`hostname -d| sed -E 's/^|\\./,dc=/g' | sed 's/^,//g'`\n+\n+ldapsearch -x -h localhost -D \"cn=directory manager\" -w $FPW -b \"$HOSTCN\" -s base \"(objectclass=*)\"\n+status=$?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b369d80174ff3381ac24ae2437d217800bcb63c4", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b369d80174ff3381ac24ae2437d217800bcb63c4", "committedDate": "2020-04-28T12:46:03Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/eb2b0b3e05f18dceb2ba192adf6ca165bd1fb6d8", "committedDate": "2020-04-27T18:49:56Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}, "afterCommit": {"oid": "b369d80174ff3381ac24ae2437d217800bcb63c4", "author": {"user": {"login": "holleyism", "name": "Adam Holley"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b369d80174ff3381ac24ae2437d217800bcb63c4", "committedDate": "2020-04-28T12:46:03Z", "message": "CB-6497: Update Nginx config and other setup for freeipa healthagent\n\nThis patch adds a new Nginx config, and several salt setup scripts\nto enable the new FreeIpa health agent to run.  The agent will\nbe installed as an RPM and will be a separate code review. CB-6399\n\n(cherry picked from commit afeb8f6cc2c695818a3335ae324bbb08688b8e9d)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxOTg2NzY0", "url": "https://github.com/hortonworks/cloudbreak/pull/7876#pullrequestreview-401986764", "createdAt": "2020-04-28T16:02:36Z", "commit": {"oid": "b369d80174ff3381ac24ae2437d217800bcb63c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2235, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}