{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzMjcxMTc4", "number": 8262, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMjo1NDo1MlrOEFhhlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo1MTozOVrOEF3alw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MjI3NjA0OnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/task/networkinterface/NetworkInterfaceDetachChecker.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMjo1NDo1MlrOGjw5fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMjo1NDo1MlrOGjw5fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE1NDQ5Mg==", "bodyText": "This part could maybe go into AzureUtils or even AzureClient as findNetworkInterfacesByName", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440154492", "createdAt": "2020-06-15T12:54:52Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/task/networkinterface/NetworkInterfaceDetachChecker.java", "diffHunk": "@@ -38,26 +35,20 @@ public NetworkInterfaceDetachChecker(AuthenticatedContext authenticatedContext,\n     @Override\n     protected Boolean doCall() {\n         LOGGER.info(\"Waiting for network interfaces to be detached: {}\", attachedNetworkInterfaces);\n-        List<Completable> networkInterfacesCompletables = new ArrayList<>();\n-        List<NetworkInterface> networkInterfaces = new ArrayList<>();\n-        List<String> failedToRetriveNetworkInterfaces = new ArrayList<>();\n-        for (String networkInterfaceName : attachedNetworkInterfaces) {\n-            networkInterfacesCompletables.add(Completable.fromObservable(\n-                    context.getAzureClient().getNetworkInterfaceAsync(context.getResourceGroupName(), networkInterfaceName)\n-                            .doOnError(throwable -> {\n-                                LOGGER.error(\"Error happened on azure network interface retrieval: {}\", networkInterfaceName, throwable);\n-                                failedToRetriveNetworkInterfaces.add(networkInterfaceName);\n-                            })\n-                            .doOnNext(ni -> networkInterfaces.add(ni))\n-                            .subscribeOn(Schedulers.io())));\n-        }\n-        Completable.merge(networkInterfacesCompletables).await();\n-        if (!failedToRetriveNetworkInterfaces.isEmpty()) {\n-            LOGGER.error(\"Can't retrieve the following network interfaces: {}\", failedToRetriveNetworkInterfaces);\n-            throw new CloudbreakServiceException(\"Can't retrieve the following network interfaces: \" + failedToRetriveNetworkInterfaces);\n-        }\n-        attachedNetworkInterfaces = networkInterfaces.stream()\n-                .filter(ni -> ni.virtualMachineId() != null).map(NetworkInterface::name).collect(Collectors.toSet());\n+\n+        PagedList<NetworkInterface> networkInterfaces = context.getAzureClient().getNetworkInterfaces(context.getResourceGroupName());\n+        networkInterfaces.loadAll();\n+        List<NetworkInterface> filteredNetworkInterfaces = networkInterfaces\n+                .stream()\n+                .filter(networkInterface -> attachedNetworkInterfaces\n+                        .contains(networkInterface.name()))\n+                .collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0Mjg4NDQ1OnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureTerminationHelperService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNToxNzozNVrOGj23yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNToxNzozNVrOGj23yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MjM2MQ==", "bodyText": "I would move this to a separate method", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440252361", "createdAt": "2020-06-15T15:17:35Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureTerminationHelperService.java", "diffHunk": "@@ -0,0 +1,153 @@\n+package com.sequenceiq.cloudbreak.cloud.azure;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+import javax.inject.Inject;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Service;\n+\n+import com.microsoft.azure.management.compute.VirtualMachine;\n+import com.sequenceiq.cloudbreak.cloud.azure.client.AzureClient;\n+import com.sequenceiq.cloudbreak.cloud.azure.connector.resource.AzureComputeResourceService;\n+import com.sequenceiq.cloudbreak.cloud.context.AuthenticatedContext;\n+import com.sequenceiq.cloudbreak.cloud.exception.CloudConnectorException;\n+import com.sequenceiq.cloudbreak.cloud.model.CloudInstance;\n+import com.sequenceiq.cloudbreak.cloud.model.CloudResource;\n+import com.sequenceiq.cloudbreak.cloud.model.CloudResourceStatus;\n+import com.sequenceiq.cloudbreak.cloud.model.CloudStack;\n+import com.sequenceiq.cloudbreak.cloud.notification.PersistenceNotifier;\n+import com.sequenceiq.common.api.type.ResourceType;\n+\n+@Service\n+public class AzureTerminationHelperService {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(AzureTerminationHelperService.class);\n+\n+    @Inject\n+    private AzureResourceGroupMetadataProvider azureResourceGroupMetadataProvider;\n+\n+    @Inject\n+    private AzureVirtualMachineService azureVirtualMachineService;\n+\n+    @Inject\n+    private AzureUtils azureUtils;\n+\n+    @Inject\n+    private AzureComputeResourceService azureComputeResourceService;\n+\n+    @Inject\n+    private AzureResourceConnector azureResourceConnector;\n+\n+    @Inject\n+    private AzureCloudResourceService azureCloudResourceService;\n+\n+    @Inject\n+    private PersistenceNotifier resourceNotifier;\n+\n+    public List<CloudResourceStatus> downscale(AuthenticatedContext ac, CloudStack stack, List<CloudInstance> vms,\n+            List<CloudResource> allResources, List<CloudResource> resourcesToRemove) {\n+        List<CloudResource> networkResources = azureCloudResourceService.getNetworkResources(allResources);\n+        return terminateResources(ac, stack, vms, resourcesToRemove, networkResources, false);\n+    }\n+\n+    public List<CloudResourceStatus> terminate(AuthenticatedContext ac, CloudStack stack, List<CloudResource> resourcesToRemove) {\n+        List<CloudInstance> vms = new ArrayList<>();\n+        stack.getGroups().forEach(group -> vms.addAll(group.getInstances()));\n+        List<CloudResource> networkResources = azureCloudResourceService.getNetworkResources(resourcesToRemove);\n+        return terminateResources(ac, stack, vms, resourcesToRemove, networkResources, true);\n+    }\n+\n+    private List<CloudResourceStatus> terminateResources(AuthenticatedContext ac, CloudStack stack, List<CloudInstance> vms,\n+            List<CloudResource> resourcesToRemove, List<CloudResource> networkResources, boolean deleteWholeDeployment) {\n+        LOGGER.debug(\"Terminating the following resources: {}\", resourcesToRemove);\n+        LOGGER.debug(\"Operation is: {}\", deleteWholeDeployment ? \"terminate\" : \"downscale\");\n+        AzureClient client = ac.getParameter(AzureClient.class);\n+\n+        String resourceGroupName = azureResourceGroupMetadataProvider.getResourceGroupName(ac.getCloudContext(), stack);\n+\n+        Map<String, VirtualMachine> vmsFromAzure = azureVirtualMachineService.getVmsFromAzureAndFillStatuses(ac, vms, new ArrayList<>());\n+        List<CloudInstance> cloudInstancesSyncedWithAzure = vms.stream()\n+                .filter(cloudInstance -> vmsFromAzure.containsKey(cloudInstance.getInstanceId()))\n+                .collect(Collectors.toList());\n+        azureUtils.deleteInstances(ac, cloudInstancesSyncedWithAzure);\n+        deleteCloudResourceList(ac, resourcesToRemove, ResourceType.AZURE_INSTANCE);\n+\n+        List<String> networkInterfaceNames = getResourceNamesByResourceType(resourcesToRemove, ResourceType.AZURE_NETWORK_INTERFACE);\n+        azureUtils.waitForDetachNetworkInterfaces(ac, client, resourceGroupName, networkInterfaceNames);\n+        azureUtils.deleteNetworkInterfaces(client, resourceGroupName, networkInterfaceNames);\n+        deleteCloudResourceList(ac, resourcesToRemove, ResourceType.AZURE_INSTANCE);\n+\n+\n+        List<String> publicAddressNames = getResourceNamesByResourceType(resourcesToRemove, ResourceType.AZURE_PUBLIC_IP);\n+        azureUtils.deletePublicIps(client, resourceGroupName, publicAddressNames);\n+        deleteCloudResourceList(ac, resourcesToRemove, ResourceType.AZURE_PUBLIC_IP);\n+\n+        List<String> managedDiskIds = getResourceIdsByResourceType(resourcesToRemove, ResourceType.AZURE_DISK);\n+        azureUtils.deleteManagedDisks(client, managedDiskIds);\n+        deleteCloudResourceList(ac, resourcesToRemove, ResourceType.AZURE_DISK);\n+\n+        try {\n+            List<CloudResource> volumeSetsToDelete =\n+                    resourcesToRemove.stream()\n+                            .filter(cloudResource -> cloudResource.getType().equals(ResourceType.AZURE_VOLUMESET))\n+                            .collect(Collectors.toList());\n+            azureComputeResourceService.deleteComputeResources(ac, stack, volumeSetsToDelete, networkResources);\n+        } catch (CloudConnectorException e) {\n+            throw e;\n+        } catch (RuntimeException e) {\n+            throw new CloudConnectorException(String.format(\"Failed to delete resources during downscale: %s\", resourceGroupName), e);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 105}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTMwNzk2OnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwNzoyMjo0OVrOGkOblQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMjo0MzoxMVrOGkZdsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDYzODM1Nw==", "bodyText": "An Observable comes back from the Collection deletion, that is, one String in exchange for a collection of Strings. What is the output of the log line, what is disk?", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440638357", "createdAt": "2020-06-16T07:22:49Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureUtils.java", "diffHunk": "@@ -401,4 +433,21 @@ public void deleteManagedDisks(AzureClient azureClient, Collection<String> manag\n                     resourceType, resourceId, errorCode, cloudError.message(), details));\n         }\n     }\n+\n+    @Retryable(backoff = @Backoff(delay = 1000, multiplier = 2, maxDelay = 10000), maxAttempts = 5)\n+    public void deleteManagedDisks(AzureClient azureClient, Collection<String> managedDiskIds) {\n+        if (CollectionUtils.isNotEmpty(managedDiskIds)) {\n+            LOGGER.info(\"Delete managed disks with id-s: {}\", managedDiskIds);\n+\n+            Observable<String> deletionObservable = azureClient.deleteManagedDiskAsync(managedDiskIds)\n+                    .doOnError(throwable -> {\n+                        LOGGER.error(\"Error happened during the deletion of the managed disks \", throwable);\n+                        throw new CloudbreakServiceException(\"Can't delete all managed disks: \", throwable);\n+                    })\n+                    .doOnCompleted(() -> LOGGER.debug(\"Delete managed disks completed successfully\"))\n+                    .subscribeOn(Schedulers.io());\n+            deletionObservable.subscribe(disk -> LOGGER.debug(\"Deleting {}\", disk));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 158}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgxOTEyMw==", "bodyText": "From SupportsBatchDeletion interface: \"@return a representation of the deferred computation of this call returning the resource ID of each successfully deleted resource\"", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440819123", "createdAt": "2020-06-16T12:43:11Z", "author": {"login": "pdarvasi"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureUtils.java", "diffHunk": "@@ -401,4 +433,21 @@ public void deleteManagedDisks(AzureClient azureClient, Collection<String> manag\n                     resourceType, resourceId, errorCode, cloudError.message(), details));\n         }\n     }\n+\n+    @Retryable(backoff = @Backoff(delay = 1000, multiplier = 2, maxDelay = 10000), maxAttempts = 5)\n+    public void deleteManagedDisks(AzureClient azureClient, Collection<String> managedDiskIds) {\n+        if (CollectionUtils.isNotEmpty(managedDiskIds)) {\n+            LOGGER.info(\"Delete managed disks with id-s: {}\", managedDiskIds);\n+\n+            Observable<String> deletionObservable = azureClient.deleteManagedDiskAsync(managedDiskIds)\n+                    .doOnError(throwable -> {\n+                        LOGGER.error(\"Error happened during the deletion of the managed disks \", throwable);\n+                        throw new CloudbreakServiceException(\"Can't delete all managed disks: \", throwable);\n+                    })\n+                    .doOnCompleted(() -> LOGGER.debug(\"Delete managed disks completed successfully\"))\n+                    .subscribeOn(Schedulers.io());\n+            deletionObservable.subscribe(disk -> LOGGER.debug(\"Deleting {}\", disk));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDYzODM1Nw=="}, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 158}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTMxNjQxOnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureVirtualMachineService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwNzoyNToyOVrOGkOhFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMjo1Njo0NlrOGkZ_RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDYzOTc2Nw==", "bodyText": "If possible, I would get rid of the double negation.", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440639767", "createdAt": "2020-06-16T07:25:29Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureVirtualMachineService.java", "diffHunk": "@@ -76,8 +76,15 @@ public void refreshInstanceViews(Map<String, VirtualMachine> virtualMachines) {\n     }\n \n     private boolean hasMissingVm(PagedList<VirtualMachine> virtualMachines, Collection<String> privateInstanceIds) {\n-        Set<String> virtualMachineNames = virtualMachines.stream().map(VirtualMachine::name).collect(Collectors.toSet());\n-        return !virtualMachineNames.containsAll(privateInstanceIds);\n+        Set<String> virtualMachineNames = virtualMachines\n+                .stream()\n+                .map(VirtualMachine::name)\n+                .collect(Collectors.toSet());\n+        boolean hasMissingVm = !virtualMachineNames.containsAll(privateInstanceIds);\n+        if (hasMissingVm) {\n+            LOGGER.info(\"Fetched VM id-s ({}) do not contain one of the following id-s: {}\", virtualMachineNames, privateInstanceIds);\n+        }\n+        return !hasMissingVm;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgyNzcxNw==", "bodyText": "Nice catch!", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440827717", "createdAt": "2020-06-16T12:56:46Z", "author": {"login": "pdarvasi"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureVirtualMachineService.java", "diffHunk": "@@ -76,8 +76,15 @@ public void refreshInstanceViews(Map<String, VirtualMachine> virtualMachines) {\n     }\n \n     private boolean hasMissingVm(PagedList<VirtualMachine> virtualMachines, Collection<String> privateInstanceIds) {\n-        Set<String> virtualMachineNames = virtualMachines.stream().map(VirtualMachine::name).collect(Collectors.toSet());\n-        return !virtualMachineNames.containsAll(privateInstanceIds);\n+        Set<String> virtualMachineNames = virtualMachines\n+                .stream()\n+                .map(VirtualMachine::name)\n+                .collect(Collectors.toSet());\n+        boolean hasMissingVm = !virtualMachineNames.containsAll(privateInstanceIds);\n+        if (hasMissingVm) {\n+            LOGGER.info(\"Fetched VM id-s ({}) do not contain one of the following id-s: {}\", virtualMachineNames, privateInstanceIds);\n+        }\n+        return !hasMissingVm;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDYzOTc2Nw=="}, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTgzNzE1OnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo0NDozOFrOGkTqaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo0NDozOFrOGkTqaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcyNDA3Mw==", "bodyText": "This part could go into AzureUtils.", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440724073", "createdAt": "2020-06-16T09:44:38Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "diffHunk": "@@ -236,35 +210,35 @@ private void checkTemplateDeployment(List<CloudResourceStatus> result, AzureClie\n     public List<CloudResourceStatus> terminate(AuthenticatedContext ac, CloudStack stack, List<CloudResource> resources) {\n         AzureClient client = ac.getParameter(AzureClient.class);\n         String resourceGroupName = azureResourceGroupMetadataProvider.getResourceGroupName(ac.getCloudContext(), stack);\n-        try {\n+        Boolean singleResourceGroup = azureResourceGroupMetadataProvider.useSingleResourceGroup(stack);\n+\n+        if (singleResourceGroup) {\n+            List<CloudResource> cloudResourceList = collectResourcesToRemove(ac, stack, resources, azureUtils.getInstanceList(stack));\n+            resources.addAll(cloudResourceList);\n+            azureTerminationHelperService.terminate(ac, stack, resources);\n+            return check(ac, Collections.emptyList());\n+        } else {\n             try {\n-                retryService.testWith2SecDelayMax5Times(() -> {\n-                    if (!client.resourceGroupExists(resourceGroupName)) {\n-                        throw new ActionFailedException(\"Resource group not exists\");\n-                    }\n-                    return true;\n-                });\n-                client.deleteResourceGroup(resourceGroupName);\n-            } catch (ActionFailedException ignored) {\n-                LOGGER.debug(\"Resource group not found with name: {}\", resourceGroupName);\n-            }\n-            if (azureStorage.isPersistentStorage(azureStorage.getPersistentStorageName(stack))) {\n-                CloudContext cloudCtx = ac.getCloudContext();\n-                AzureCredentialView azureCredentialView = new AzureCredentialView(ac.getCloudCredential());\n-\n-                String imageStorageName = azureStorage.getImageStorageName(azureCredentialView, cloudCtx, stack);\n-                String imageResourceGroupName = azureResourceGroupMetadataProvider.getImageResourceGroupName(cloudCtx, stack);\n-                String diskContainer = azureStorage.getDiskContainerName(cloudCtx);\n-                deleteContainer(client, imageResourceGroupName, imageStorageName, diskContainer);\n-            }\n-        } catch (CloudException e) {\n-            if (e.response().code() != AzureConstants.NOT_FOUND) {\n-                throw new CloudConnectorException(String.format(\"Could not delete resource group: %s\", resourceGroupName), e);\n-            } else {\n-                return check(ac, Collections.emptyList());\n+                try {\n+                    retryService.testWith2SecDelayMax5Times(() -> {\n+                        if (!client.resourceGroupExists(resourceGroupName)) {\n+                            throw new ActionFailedException(\"Resource group not exists\");\n+                        }\n+                        return true;\n+                    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 171}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTg1ODExOnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo1MDoyMlrOGkT3wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo1MDoyMlrOGkT3wQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcyNzQ4OQ==", "bodyText": "StartDatabaseServer and StopDatabaseServer are identical to the base implementation (NotImplemented), can be deleted.", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440727489", "createdAt": "2020-06-16T09:50:22Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "diffHunk": "@@ -45,32 +34,22 @@\n import com.sequenceiq.cloudbreak.cloud.model.CloudStack;\n import com.sequenceiq.cloudbreak.cloud.model.DatabaseStack;\n import com.sequenceiq.cloudbreak.cloud.model.ExternalDatabaseStatus;\n-import com.sequenceiq.cloudbreak.cloud.model.Group;\n import com.sequenceiq.cloudbreak.cloud.model.ResourceStatus;\n import com.sequenceiq.cloudbreak.cloud.model.TlsInfo;\n import com.sequenceiq.cloudbreak.cloud.notification.PersistenceNotifier;\n+import com.sequenceiq.cloudbreak.cloud.template.AbstractResourceConnector;\n import com.sequenceiq.cloudbreak.service.Retry;\n import com.sequenceiq.cloudbreak.service.Retry.ActionFailedException;\n import com.sequenceiq.common.api.type.AdjustmentType;\n import com.sequenceiq.common.api.type.ResourceType;\n \n @Service\n-public class AzureResourceConnector implements ResourceConnector<Map<String, Map<String, Object>>> {\n+public class AzureResourceConnector extends AbstractResourceConnector {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTg2MjYzOnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo1MTozOVrOGkT6pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo1MTozOVrOGkT6pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcyODIzMA==", "bodyText": "Can be package private.", "url": "https://github.com/hortonworks/cloudbreak/pull/8262#discussion_r440728230", "createdAt": "2020-06-16T09:51:39Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/AzureResourceConnector.java", "diffHunk": "@@ -45,32 +34,22 @@\n import com.sequenceiq.cloudbreak.cloud.model.CloudStack;\n import com.sequenceiq.cloudbreak.cloud.model.DatabaseStack;\n import com.sequenceiq.cloudbreak.cloud.model.ExternalDatabaseStatus;\n-import com.sequenceiq.cloudbreak.cloud.model.Group;\n import com.sequenceiq.cloudbreak.cloud.model.ResourceStatus;\n import com.sequenceiq.cloudbreak.cloud.model.TlsInfo;\n import com.sequenceiq.cloudbreak.cloud.notification.PersistenceNotifier;\n+import com.sequenceiq.cloudbreak.cloud.template.AbstractResourceConnector;\n import com.sequenceiq.cloudbreak.service.Retry;\n import com.sequenceiq.cloudbreak.service.Retry.ActionFailedException;\n import com.sequenceiq.common.api.type.AdjustmentType;\n import com.sequenceiq.common.api.type.ResourceType;\n \n @Service\n-public class AzureResourceConnector implements ResourceConnector<Map<String, Map<String, Object>>> {\n+public class AzureResourceConnector extends AbstractResourceConnector {\n \n     public static final String RESOURCE_GROUP_NAME = \"resourceGroupName\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acfa07fc0612211936da040dba47fd3144efd01f"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3200, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}