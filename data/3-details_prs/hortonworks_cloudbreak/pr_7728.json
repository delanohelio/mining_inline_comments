{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MDUwODg4", "number": 7728, "title": "CB-874 Make FreeIPA and RDS provisioning parallel", "bodyText": "", "createdAt": "2020-04-03T09:01:55Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7728", "merged": true, "mergeCommit": {"oid": "75e11e61cbbc3f6f783c75726a926ddb2abacc64"}, "closed": true, "closedAt": "2020-04-17T16:06:42Z", "author": {"login": "nadamdb"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcU_QFGgFqTM4ODI4MzYxMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYhowfgBqjMyNDQ0ODcxNjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MjgzNjEy", "url": "https://github.com/hortonworks/cloudbreak/pull/7728#pullrequestreview-388283612", "createdAt": "2020-04-06T14:06:08Z", "commit": {"oid": "4f728f1773226271ad8e3165a386272633f4cb38"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNDowNjowOFrOGBZZzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNDowNjowOFrOGBZZzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDExNzk2Ng==", "bodyText": "passing this response along is not necessary. If I'm not mistaken it's used in ProvisionerService#startStackProvisioning, but that info is already in SdxCluster, so I would drop it entirely if possible", "url": "https://github.com/hortonworks/cloudbreak/pull/7728#discussion_r404117966", "createdAt": "2020-04-06T14:06:08Z", "author": {"login": "lacikaaa"}, "path": "datalake/src/main/java/com/sequenceiq/datalake/flow/create/event/EnvWaitRequest.java", "diffHunk": "@@ -2,19 +2,27 @@\n \n import com.sequenceiq.datalake.flow.SdxContext;\n import com.sequenceiq.datalake.flow.SdxEvent;\n+import com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.responses.DatabaseServerStatusV4Response;\n \n public class EnvWaitRequest extends SdxEvent {\n \n-    public EnvWaitRequest(Long sdxId, String userId) {\n+    private DatabaseServerStatusV4Response databaseServerResponse;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f728f1773226271ad8e3165a386272633f4cb38"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4Mjg1OTM3", "url": "https://github.com/hortonworks/cloudbreak/pull/7728#pullrequestreview-388285937", "createdAt": "2020-04-06T14:08:38Z", "commit": {"oid": "4f728f1773226271ad8e3165a386272633f4cb38"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNDowODozOFrOGBZg0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNDowODozOFrOGBZg0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDExOTc2Mg==", "bodyText": "I think it's possible that we have the old version running, and it's in SDX_CREATION_WAIT_ENV_STATE. We shut it down and fire up this new version. When it's finished with the SDX_CREATION_WAIT_ENV_STATE the new version will move to SDX_CREATION_START_STATE and will skip SDX_CREATION_WAIT_RDS_STATE. Could you check?", "url": "https://github.com/hortonworks/cloudbreak/pull/7728#discussion_r404119762", "createdAt": "2020-04-06T14:08:38Z", "author": {"login": "lacikaaa"}, "path": "datalake/src/main/java/com/sequenceiq/datalake/flow/create/SdxCreateFlowConfig.java", "diffHunk": "@@ -24,24 +24,35 @@\n \n     private static final List<Transition<SdxCreateState, SdxCreateEvent>> TRANSITIONS = new Builder<SdxCreateState, SdxCreateEvent>()\n             .defaultFailureEvent(SDX_CREATE_FAILED_EVENT)\n+\n             .from(INIT_STATE)\n-            .to(SDX_CREATION_WAIT_ENV_STATE)\n+            .to(SDX_CREATION_WAIT_RDS_STATE)\n             .event(SdxCreateEvent.ENV_WAIT_EVENT).defaultFailureEvent()\n-            .from(SDX_CREATION_WAIT_ENV_STATE)\n+\n+            .from(INIT_STATE)\n             .to(SDX_CREATION_WAIT_RDS_STATE)\n-            .event(SdxCreateEvent.ENV_WAIT_SUCCESS_EVENT).defaultFailureEvent()\n+            .event(SdxCreateEvent.RDS_WAIT_EVENT).defaultFailureEvent()\n+\n             .from(SDX_CREATION_WAIT_RDS_STATE)\n-            .to(SDX_CREATION_START_STATE)\n+            .to(SDX_CREATION_WAIT_ENV_STATE)\n             .event(SdxCreateEvent.RDS_WAIT_SUCCESS_EVENT).defaultFailureEvent()\n+\n+            .from(SDX_CREATION_WAIT_ENV_STATE)\n+            .to(SDX_CREATION_START_STATE)\n+            .event(SdxCreateEvent.ENV_WAIT_SUCCESS_EVENT).defaultFailureEvent()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f728f1773226271ad8e3165a386272633f4cb38"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f728f1773226271ad8e3165a386272633f4cb38", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/4f728f1773226271ad8e3165a386272633f4cb38", "committedDate": "2020-04-03T08:58:45Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}, "afterCommit": {"oid": "a5e9e19262e8e3af60c299d9ceedda37916896d2", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a5e9e19262e8e3af60c299d9ceedda37916896d2", "committedDate": "2020-04-16T14:34:11Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5e9e19262e8e3af60c299d9ceedda37916896d2", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a5e9e19262e8e3af60c299d9ceedda37916896d2", "committedDate": "2020-04-16T14:34:11Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}, "afterCommit": {"oid": "d249a4f29bbc484d5dcdb02fb6959cb49ec97a15", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d249a4f29bbc484d5dcdb02fb6959cb49ec97a15", "committedDate": "2020-04-16T15:09:13Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d249a4f29bbc484d5dcdb02fb6959cb49ec97a15", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d249a4f29bbc484d5dcdb02fb6959cb49ec97a15", "committedDate": "2020-04-16T15:09:13Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}, "afterCommit": {"oid": "afb62ad9bc48138c16172086ff1da368700e3bba", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/afb62ad9bc48138c16172086ff1da368700e3bba", "committedDate": "2020-04-16T15:34:26Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "afb62ad9bc48138c16172086ff1da368700e3bba", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/afb62ad9bc48138c16172086ff1da368700e3bba", "committedDate": "2020-04-16T15:34:26Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}, "afterCommit": {"oid": "fff27436bd124400d9b75f102830f58ff6138e53", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fff27436bd124400d9b75f102830f58ff6138e53", "committedDate": "2020-04-17T13:20:28Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NDUxMDcx", "url": "https://github.com/hortonworks/cloudbreak/pull/7728#pullrequestreview-395451071", "createdAt": "2020-04-17T13:26:13Z", "commit": {"oid": "fff27436bd124400d9b75f102830f58ff6138e53"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a1a78fc0f70396dd5acbab55a21ac4c0f026729", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a1a78fc0f70396dd5acbab55a21ac4c0f026729", "committedDate": "2020-04-17T13:51:18Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fff27436bd124400d9b75f102830f58ff6138e53", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fff27436bd124400d9b75f102830f58ff6138e53", "committedDate": "2020-04-17T13:20:28Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}, "afterCommit": {"oid": "2a1a78fc0f70396dd5acbab55a21ac4c0f026729", "author": {"user": {"login": "nadamdb", "name": "Adam Nagy"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a1a78fc0f70396dd5acbab55a21ac4c0f026729", "committedDate": "2020-04-17T13:51:18Z", "message": "CB-874 Make FreeIPA and RDS provisioning parallel"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2416, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}