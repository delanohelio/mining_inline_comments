{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3OTM4OTAz", "number": 9023, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyMjowN1rOEkB2qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyMjowN1rOEkB2qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MjE0NTY4OnYy", "diffSide": "RIGHT", "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/sdx/SdxInternalTestDto.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyMjowN1rOHSuNHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNDowNzo1MFrOHSypvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MzQzNg==", "bodyText": "If we can have a crn in the response but not stackresponse, it means that the response could have other useful info in it. So I think a better solution would be to handle the possible NPE in the hasSpotTermination assignment, something like this:\nboolean hasSpotTermination = Optional.ofNullable(getResponse().getStackV4Response()) .map(stack -> stack.getInstanceGroups()) .stream() .flatMap(ig -> ig.getMetadata().stream()) .anyMatch(metadata -> InstanceStatus.DELETED_BY_PROVIDER == metadata.getInstanceStatus());\nThis way we could add the response to the report without an NPE. Also it is possible that other Investigables have this issue, please check them too.", "url": "https://github.com/hortonworks/cloudbreak/pull/9023#discussion_r489393436", "createdAt": "2020-09-16T12:22:07Z", "author": {"login": "Bajzathd"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/sdx/SdxInternalTestDto.java", "diffHunk": "@@ -423,7 +423,7 @@ public SdxRepairRequest getSdxRepairRequest() {\n \n     @Override\n     public Clue investigate() {\n-        if (getResponse() == null || getResponse().getCrn() == null) {\n+        if (getResponse() == null || getResponse().getCrn() == null || getResponse().getStackV4Response() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be0497fce84c737284161583168331a8598c7c6c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQzODMwOQ==", "bodyText": "so you mean audit info still useful, whether stackresponse is null? is that what you meant?", "url": "https://github.com/hortonworks/cloudbreak/pull/9023#discussion_r489438309", "createdAt": "2020-09-16T13:30:18Z", "author": {"login": "afarsang"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/sdx/SdxInternalTestDto.java", "diffHunk": "@@ -423,7 +423,7 @@ public SdxRepairRequest getSdxRepairRequest() {\n \n     @Override\n     public Clue investigate() {\n-        if (getResponse() == null || getResponse().getCrn() == null) {\n+        if (getResponse() == null || getResponse().getCrn() == null || getResponse().getStackV4Response() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MzQzNg=="}, "originalCommit": {"oid": "be0497fce84c737284161583168331a8598c7c6c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQ1NzM5Ng==", "bodyText": "I think it can be as it already had a crn, because without it could not have caused an NPE.", "url": "https://github.com/hortonworks/cloudbreak/pull/9023#discussion_r489457396", "createdAt": "2020-09-16T13:55:52Z", "author": {"login": "Bajzathd"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/sdx/SdxInternalTestDto.java", "diffHunk": "@@ -423,7 +423,7 @@ public SdxRepairRequest getSdxRepairRequest() {\n \n     @Override\n     public Clue investigate() {\n-        if (getResponse() == null || getResponse().getCrn() == null) {\n+        if (getResponse() == null || getResponse().getCrn() == null || getResponse().getStackV4Response() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MzQzNg=="}, "originalCommit": {"oid": "be0497fce84c737284161583168331a8598c7c6c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQ2NjMwMg==", "bodyText": "other testdtos had the potential issue too, it was a good idea to check them. Thanks", "url": "https://github.com/hortonworks/cloudbreak/pull/9023#discussion_r489466302", "createdAt": "2020-09-16T14:07:50Z", "author": {"login": "afarsang"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/sdx/SdxInternalTestDto.java", "diffHunk": "@@ -423,7 +423,7 @@ public SdxRepairRequest getSdxRepairRequest() {\n \n     @Override\n     public Clue investigate() {\n-        if (getResponse() == null || getResponse().getCrn() == null) {\n+        if (getResponse() == null || getResponse().getCrn() == null || getResponse().getStackV4Response() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MzQzNg=="}, "originalCommit": {"oid": "be0497fce84c737284161583168331a8598c7c6c"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2290, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}