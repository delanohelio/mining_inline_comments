{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzczMzc4", "number": 7530, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNDo1NlrODqS1ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzoxNTozNlrODqXyvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1Njc1MzY1OnYy", "diffSide": "RIGHT", "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNDo1NlrOF583OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNDo1NlrOF583OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMxMDMyOQ==", "bodyText": "I think ACLs are missing from the topology.", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396310329", "createdAt": "2020-03-23T09:24:56Z", "author": {"login": "keyki"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -480,6 +480,17 @@\n     {%- endif %}\n     {%- endif %}\n \n+    {% if 'SPARK3_YARN_HISTORY_SERVER' in salt['pillar.get']('gateway:location') -%}\n+    {% if 'SPARK3HISTORYUI' in exposed -%}\n+    <service>\n+        <role>SPARK3HISTORYUI</role>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzU2NjA1OnYy", "diffSide": "RIGHT", "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzoxNTozNlrOF6E1eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNTowMDo1NlrOF6Jdsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDk1Mw==", "bodyText": "I thought we were moving away from safety valves? This uses another one?", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396440953", "createdAt": "2020-03-23T13:15:36Z", "author": {"login": "risdenk"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.sequenceiq.cloudbreak.cmtemplate.configproviders.spark;\n+\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils.config;\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.hive.HiveMetastoreCloudStorageServiceConfigProvider.HMS_METASTORE_EXTERNAL_DIR;\n+\n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.cloudera.api.swagger.model.ApiClusterTemplateConfig;\n+import com.sequenceiq.cloudbreak.cmtemplate.CmTemplateProcessor;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.AbstractRoleConfigProvider;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils;\n+import com.sequenceiq.cloudbreak.template.TemplatePreparationObject;\n+\n+@Component\n+public class Spark3OnYarnRoleConfigProvider extends AbstractRoleConfigProvider {\n+\n+    private static final String SPARK3_CONF_CLIENT_SAFETY_VALVE = \"spark-conf/spark-defaults.conf_client_config_safety_valve\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4NTg4Nw==", "bodyText": "@risdenk unfortunately we can only moving aways if we have fix property in CM side", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396485887", "createdAt": "2020-03-23T14:20:28Z", "author": {"login": "doktoric"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.sequenceiq.cloudbreak.cmtemplate.configproviders.spark;\n+\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils.config;\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.hive.HiveMetastoreCloudStorageServiceConfigProvider.HMS_METASTORE_EXTERNAL_DIR;\n+\n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.cloudera.api.swagger.model.ApiClusterTemplateConfig;\n+import com.sequenceiq.cloudbreak.cmtemplate.CmTemplateProcessor;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.AbstractRoleConfigProvider;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils;\n+import com.sequenceiq.cloudbreak.template.TemplatePreparationObject;\n+\n+@Component\n+public class Spark3OnYarnRoleConfigProvider extends AbstractRoleConfigProvider {\n+\n+    private static final String SPARK3_CONF_CLIENT_SAFETY_VALVE = \"spark-conf/spark-defaults.conf_client_config_safety_valve\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDk1Mw=="}, "originalCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ5NDM5Mw==", "bodyText": "Yea agreed - CB-4191 is being used to track a bunch of this. Is there a CM jira to add a specific property and a CB one to remove this use of safety valve? Otherwise we are going to keep fighting up a hill.\nThis looks like a new Spark CSD so it should be possible to add the specific config and then CB wouldn't need to deal w/ this safety valve.", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396494393", "createdAt": "2020-03-23T14:31:54Z", "author": {"login": "risdenk"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.sequenceiq.cloudbreak.cmtemplate.configproviders.spark;\n+\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils.config;\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.hive.HiveMetastoreCloudStorageServiceConfigProvider.HMS_METASTORE_EXTERNAL_DIR;\n+\n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.cloudera.api.swagger.model.ApiClusterTemplateConfig;\n+import com.sequenceiq.cloudbreak.cmtemplate.CmTemplateProcessor;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.AbstractRoleConfigProvider;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils;\n+import com.sequenceiq.cloudbreak.template.TemplatePreparationObject;\n+\n+@Component\n+public class Spark3OnYarnRoleConfigProvider extends AbstractRoleConfigProvider {\n+\n+    private static final String SPARK3_CONF_CLIENT_SAFETY_VALVE = \"spark-conf/spark-defaults.conf_client_config_safety_valve\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDk1Mw=="}, "originalCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUxNjc4Ng==", "bodyText": "@risdenk this is https://jira.cloudera.com/browse/OPSAPS-55172", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396516786", "createdAt": "2020-03-23T15:00:56Z", "author": {"login": "doktoric"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.sequenceiq.cloudbreak.cmtemplate.configproviders.spark;\n+\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils.config;\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.hive.HiveMetastoreCloudStorageServiceConfigProvider.HMS_METASTORE_EXTERNAL_DIR;\n+\n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.cloudera.api.swagger.model.ApiClusterTemplateConfig;\n+import com.sequenceiq.cloudbreak.cmtemplate.CmTemplateProcessor;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.AbstractRoleConfigProvider;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils;\n+import com.sequenceiq.cloudbreak.template.TemplatePreparationObject;\n+\n+@Component\n+public class Spark3OnYarnRoleConfigProvider extends AbstractRoleConfigProvider {\n+\n+    private static final String SPARK3_CONF_CLIENT_SAFETY_VALVE = \"spark-conf/spark-defaults.conf_client_config_safety_valve\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDk1Mw=="}, "originalCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2752, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}