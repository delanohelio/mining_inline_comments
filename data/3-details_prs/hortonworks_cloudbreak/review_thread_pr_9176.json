{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5ODg1MDI2", "number": 9176, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoxNzoyMVrOEsCzzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoxNzoyMVrOEsCzzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0NjE4ODMwOnYy", "diffSide": "RIGHT", "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/image/AzureImageSetupService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoxNzoyMVrOHfJShw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoxNzoyMVrOHfJShw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQyMDEwMw==", "bodyText": "This piece is present already in class AzureImageService. It might make sense to extract them.", "url": "https://github.com/hortonworks/cloudbreak/pull/9176#discussion_r502420103", "createdAt": "2020-10-09T13:17:21Z", "author": {"login": "gergopapi2"}, "path": "cloud-azure/src/main/java/com/sequenceiq/cloudbreak/cloud/azure/image/AzureImageSetupService.java", "diffHunk": "@@ -96,8 +97,15 @@ public ImageStatusResult checkImageStatus(AuthenticatedContext ac, CloudStack st\n         }\n     }\n \n-    private Optional<VirtualMachineCustomImage> findVirtualMachineCustomImage(Image image, String imageResourceGroupName, AzureClient client) {\n-        return azureManagedImageService.findVirtualMachineCustomImage(imageResourceGroupName, image.getImageName(), client);\n+    private Optional<VirtualMachineCustomImage> findVirtualMachineCustomImage(Image image, String imageResourceGroupName, AzureClient client,\n+            AuthenticatedContext ac) {\n+        String imageName = getImageName(image.getImageName(), ac.getCloudContext().getLocation().getRegion().getRegionName());\n+        return azureManagedImageService.findVirtualMachineCustomImage(imageResourceGroupName, imageName, client);\n+    }\n+\n+    private String getImageName(String fromVhdUri, String region) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0218f620007a9a7d6afdd215812720a3d6d5ef3a"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2114, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}