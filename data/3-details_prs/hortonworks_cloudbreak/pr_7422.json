{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMzkxMzI3", "number": 7422, "title": "CB-5795 Azure subnet validation improvement: given subnets must exist on azure side", "bodyText": "@gergopapi2 pls review", "createdAt": "2020-02-28T13:31:15Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7422", "merged": true, "mergeCommit": {"oid": "761c1b7f40aff54e4e6cb1b2c478f54df8971d82"}, "closed": true, "closedAt": "2020-03-03T11:12:40Z", "author": {"login": "schfeca75"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIv6lKAH2gAyMzgxMzkxMzI3OjdiZjE2YmY5N2EyZjcyNzE1YTJlOGQ3MzgwMTQ0ZDEzMjk3MzBiYjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKAWl0AFqTM2Nzg5MDQ1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7", "author": {"user": {"login": "schfeca75", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7bf16bf97a2f72715a2e8d7380144d1329730bb7", "committedDate": "2020-02-28T13:27:00Z", "message": "CB-5795 Azure subnet validation improvement: given subnets must exist on azure side"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NDQwMTY2", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#pullrequestreview-366440166", "createdAt": "2020-02-28T14:35:11Z", "commit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNDozNToxMVrOFv2-tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNDozNToxMVrOFv2-tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTcyODE4MQ==", "bodyText": "What if the number of subnets listed is right but one subnet contains a typo?", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#discussion_r385728181", "createdAt": "2020-02-28T14:35:11Z", "author": {"login": "gergopapi2"}, "path": "environment/src/main/java/com/sequenceiq/environment/environment/validation/network/AzureEnvironmentNetworkValidator.java", "diffHunk": "@@ -50,14 +50,22 @@ public void validateDuringRequest(NetworkDto networkDto, Map<String, CloudSubnet\n         }\n     }\n \n-    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder,\n+    private void checkSubnetsProvidedWhenExistingNetwork(ValidationResult.ValidationResultBuilder resultBuilder, NetworkDto network,\n             AzureParams azureParams, Map<String, CloudSubnet> subnetMetas) {\n-        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())\n-                && MapUtils.isEmpty(subnetMetas)) {\n-            String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n-                    azureParams.getNetworkId(), azureParams.getResourceGroupName());\n-            LOGGER.info(message);\n-            resultBuilder.error(message);\n+        if (StringUtils.isNotEmpty(azureParams.getNetworkId()) && StringUtils.isNotEmpty(azureParams.getResourceGroupName())) {\n+            if (CollectionUtils.isEmpty(network.getSubnetIds())) {\n+                String message = String.format(\"If networkId (%s) and resourceGroupName (%s) are specified then subnet ids must be specified as well.\",\n+                        azureParams.getNetworkId(), azureParams.getResourceGroupName());\n+                LOGGER.info(message);\n+                resultBuilder.error(message);\n+            } else if (subnetMetas.size() != network.getSubnetIds().size()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NTQ1NDEx", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#pullrequestreview-366545411", "createdAt": "2020-02-28T16:58:07Z", "commit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3ODkwNDU2", "url": "https://github.com/hortonworks/cloudbreak/pull/7422#pullrequestreview-367890456", "createdAt": "2020-03-03T11:10:00Z", "commit": {"oid": "7bf16bf97a2f72715a2e8d7380144d1329730bb7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2620, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}