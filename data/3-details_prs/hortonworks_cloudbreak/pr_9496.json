{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1ODYwMjEz", "number": 9496, "title": "CB-9443 adding freeipa health check polling to freeipa start process", "bodyText": "See detailed description in the commit message.", "createdAt": "2020-11-23T16:44:10Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9496", "merged": true, "mergeCommit": {"oid": "99a3d0019a986ce95cedb27c0c8459e29c8da63c"}, "closed": true, "closedAt": "2020-11-25T21:39:48Z", "author": {"login": "afarsang"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfaqtQAFqTUzNjc5NzcxMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgDB7bAFqTUzODc3MzY1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2Nzk3NzEw", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#pullrequestreview-536797710", "createdAt": "2020-11-23T19:53:04Z", "commit": {"oid": "7a1f2f8ec27e91f25bbb4b886a10c331d5ec4626"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a1f2f8ec27e91f25bbb4b886a10c331d5ec4626", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7a1f2f8ec27e91f25bbb4b886a10c331d5ec4626", "committedDate": "2020-11-23T16:43:07Z", "message": "CB 9443 adding freeipa health check polling to freeipa start process"}, "afterCommit": {"oid": "4db89f5062dd338c4bce2544b9891b03abcca483", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/4db89f5062dd338c4bce2544b9891b03abcca483", "committedDate": "2020-11-24T09:15:43Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailble"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4db89f5062dd338c4bce2544b9891b03abcca483", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/4db89f5062dd338c4bce2544b9891b03abcca483", "committedDate": "2020-11-24T09:15:43Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailble"}, "afterCommit": {"oid": "83f2b6343055340df03da8b884715d6727e6d1cb", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/83f2b6343055340df03da8b884715d6727e6d1cb", "committedDate": "2020-11-24T10:03:28Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3MzMzMTQy", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#pullrequestreview-537333142", "createdAt": "2020-11-24T10:08:57Z", "commit": {"oid": "83f2b6343055340df03da8b884715d6727e6d1cb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMDowODo1N1rOH43tSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMDowODo1N1rOH43tSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM5NTAxOQ==", "bodyText": "You can check this in the constructor or in the factory.", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#discussion_r529395019", "createdAt": "2020-11-24T10:08:57Z", "author": {"login": "topolyai5"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/flow/stack/start/OneFreeIpaReachableAttempt.java", "diffHunk": "@@ -0,0 +1,62 @@\n+package com.sequenceiq.freeipa.flow.stack.start;\n+\n+import static com.sequenceiq.cloudbreak.util.Benchmark.checkedMeasure;\n+\n+import java.util.Optional;\n+import java.util.Set;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.dyngr.core.AttemptMaker;\n+import com.dyngr.core.AttemptResult;\n+import com.dyngr.core.AttemptResults;\n+import com.sequenceiq.cloudbreak.cloud.scheduler.PollGroup;\n+import com.sequenceiq.cloudbreak.cloud.store.InMemoryStateStore;\n+import com.sequenceiq.freeipa.client.model.RPCResponse;\n+import com.sequenceiq.freeipa.entity.InstanceMetaData;\n+import com.sequenceiq.freeipa.entity.Stack;\n+import com.sequenceiq.freeipa.service.stack.FreeIpaHealthDetailsService;\n+\n+public class OneFreeIpaReachableAttempt implements AttemptMaker<Void> {\n+    private static final Logger LOGGER = LoggerFactory.getLogger(OneFreeIpaReachableAttempt.class);\n+\n+    private final FreeIpaHealthDetailsService freeIpaHealthDetailsService;\n+\n+    private final Stack stack;\n+\n+    private final Set<InstanceMetaData> instanceMetaDataSet;\n+\n+    public OneFreeIpaReachableAttempt(FreeIpaHealthDetailsService freeIpaHealthDetailsService, Stack stack, Set<InstanceMetaData> instanceMetaDataSet) {\n+        this.freeIpaHealthDetailsService = freeIpaHealthDetailsService;\n+        this.stack = stack;\n+        this.instanceMetaDataSet = instanceMetaDataSet;\n+    }\n+\n+    @Override\n+    public AttemptResult<Void> process() {\n+        if (stack == null || instanceMetaDataSet == null || instanceMetaDataSet.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83f2b6343055340df03da8b884715d6727e6d1cb"}, "originalPosition": 38}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83f2b6343055340df03da8b884715d6727e6d1cb", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/83f2b6343055340df03da8b884715d6727e6d1cb", "committedDate": "2020-11-24T10:03:28Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "935c07a3dbf27099510f754283597fb8d7e2b616", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/935c07a3dbf27099510f754283597fb8d7e2b616", "committedDate": "2020-11-24T10:33:27Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "935c07a3dbf27099510f754283597fb8d7e2b616", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/935c07a3dbf27099510f754283597fb8d7e2b616", "committedDate": "2020-11-24T10:33:27Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "committedDate": "2020-11-24T10:55:42Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "committedDate": "2020-11-24T10:55:42Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "f67a28b2acf0d908b3be1d1166c91630cfa432c9", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f67a28b2acf0d908b3be1d1166c91630cfa432c9", "committedDate": "2020-11-24T12:46:57Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f67a28b2acf0d908b3be1d1166c91630cfa432c9", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f67a28b2acf0d908b3be1d1166c91630cfa432c9", "committedDate": "2020-11-24T12:46:57Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "2d15f10be8787aea4af1068383ae78f07da300b3", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2d15f10be8787aea4af1068383ae78f07da300b3", "committedDate": "2020-11-24T14:56:24Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NjAyMTE1", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#pullrequestreview-537602115", "createdAt": "2020-11-24T15:14:42Z", "commit": {"oid": "2d15f10be8787aea4af1068383ae78f07da300b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2d15f10be8787aea4af1068383ae78f07da300b3", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2d15f10be8787aea4af1068383ae78f07da300b3", "committedDate": "2020-11-24T14:56:24Z", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "cecbda2b6aa755787b3b3746622ffb45373f547f", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cecbda2b6aa755787b3b3746622ffb45373f547f", "committedDate": "2020-11-25T13:41:42Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cecbda2b6aa755787b3b3746622ffb45373f547f", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cecbda2b6aa755787b3b3746622ffb45373f547f", "committedDate": "2020-11-25T13:41:42Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "15c118c5db11545e605d07961977e4273d3df0cb", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/15c118c5db11545e605d07961977e4273d3df0cb", "committedDate": "2020-11-25T16:24:03Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "committedDate": "2020-11-25T18:44:21Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "15c118c5db11545e605d07961977e4273d3df0cb", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/15c118c5db11545e605d07961977e4273d3df0cb", "committedDate": "2020-11-25T16:24:03Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}, "afterCommit": {"oid": "5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "author": {"user": {"login": "afarsang", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "committedDate": "2020-11-25T18:44:21Z", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NzczNjU0", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#pullrequestreview-538773654", "createdAt": "2020-11-25T18:54:38Z", "commit": {"oid": "5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2034, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}