{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NjI5ODc4", "number": 9116, "title": "CB-9055: Put NO HDFS feature under entitlement", "bodyText": "We should put the code change to remove HDFS from Data Lake behind entitlement. So customer can enable this feature for new SDX cluster, and existing SDX cluster upgrade does not hit this feature by accident.\nThe flag is committed in thunderhead at https://github.infra.cloudera.com/thunderhead/thunderhead/commit/aefabb467c204d196a3a421aa015e8895800137d#diff-78fd6bd58147c45d045cc080c7400665", "createdAt": "2020-09-30T16:21:55Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9116", "merged": true, "mergeCommit": {"oid": "b1f5b8a9ccb2c2b8b7e78c99fa52d640917faade"}, "closed": true, "closedAt": "2020-10-01T06:35:02Z", "author": {"login": "LinaAtAustin"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOBIr3AFqTQ5OTcwNTM2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOLe5sgFqTUwMDA0MzA1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NzA1MzYw", "url": "https://github.com/hortonworks/cloudbreak/pull/9116#pullrequestreview-499705360", "createdAt": "2020-09-30T18:31:34Z", "commit": {"oid": "7e00ad53fb5b66c175c7233dd1f5377f3af1ff66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozMTozNFrOHaqSmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozMTozNFrOHaqSmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxNzkxMw==", "bodyText": "I don't think the EntitlementService can be null.", "url": "https://github.com/hortonworks/cloudbreak/pull/9116#discussion_r497717913", "createdAt": "2020-09-30T18:31:34Z", "author": {"login": "keyki"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hbase/HbaseCloudStorageServiceConfigProvider.java", "diffHunk": "@@ -48,9 +55,12 @@ public boolean isConfigurationNeeded(CmTemplateProcessor cmTemplateProcessor, Te\n                 .orElse(false);\n         String cdhVersion = getCdhVersion(source);\n         boolean is722OrNewer = isVersionNewerOrEqualThanLimited(cdhVersion, CLOUDERAMANAGER_VERSION_7_2_2);\n+        GeneralClusterConfigs generalClusterConfigs = source.getGeneralClusterConfigs();\n+        boolean sdxHbaseCloudStorageEnabled = entitlementService == null ? true :", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e00ad53fb5b66c175c7233dd1f5377f3af1ff66"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NzA4MTAz", "url": "https://github.com/hortonworks/cloudbreak/pull/9116#pullrequestreview-499708103", "createdAt": "2020-09-30T18:35:18Z", "commit": {"oid": "7e00ad53fb5b66c175c7233dd1f5377f3af1ff66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozNToxOFrOHaqa9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozNToxOFrOHaqa9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcyMDA1NQ==", "bodyText": "I don't think it will work with the environment crn. The stack has a creator crn instead, but I still recommend to use the com.sequenceiq.cloudbreak.auth.ThreadBasedUserCrnProvider.INTERNAL_ACTOR_CRN here and we don't need the usercrn then.", "url": "https://github.com/hortonworks/cloudbreak/pull/9116#discussion_r497720055", "createdAt": "2020-09-30T18:35:18Z", "author": {"login": "keyki"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/general/GeneralClusterConfigsProvider.java", "diffHunk": "@@ -53,6 +54,9 @@ public GeneralClusterConfigs generalClusterConfigs(Stack stack, Cluster cluster)\n         generalClusterConfigs.setKnoxUserFacingCertConfigured(userFacingCertHasBeenGenerated);\n         generalClusterConfigs.setExternalFQDN(cluster.getFqdn());\n         generalClusterConfigs.setEnableRangerRaz(cluster.isRangerRazEnabled());\n+        generalClusterConfigs.setUserCrn(stack.getEnvironmentCrn());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e00ad53fb5b66c175c7233dd1f5377f3af1ff66"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db23ea543839cdfb7c7c74907cc4cf1e25766574", "author": {"user": {"login": "LinaAtAustin", "name": "Na Li"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/db23ea543839cdfb7c7c74907cc4cf1e25766574", "committedDate": "2020-09-30T21:28:37Z", "message": "CB-9055: Put NO HDFS feature under entitlement"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e00ad53fb5b66c175c7233dd1f5377f3af1ff66", "author": {"user": {"login": "LinaAtAustin", "name": "Na Li"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7e00ad53fb5b66c175c7233dd1f5377f3af1ff66", "committedDate": "2020-09-30T16:16:05Z", "message": "CB-9055: Put NO HDFS feature under entitlement"}, "afterCommit": {"oid": "db23ea543839cdfb7c7c74907cc4cf1e25766574", "author": {"user": {"login": "LinaAtAustin", "name": "Na Li"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/db23ea543839cdfb7c7c74907cc4cf1e25766574", "committedDate": "2020-09-30T21:28:37Z", "message": "CB-9055: Put NO HDFS feature under entitlement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMDQzMDU5", "url": "https://github.com/hortonworks/cloudbreak/pull/9116#pullrequestreview-500043059", "createdAt": "2020-10-01T06:34:53Z", "commit": {"oid": "db23ea543839cdfb7c7c74907cc4cf1e25766574"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2263, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}