{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwOTYzNDgx", "number": 9556, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzoyMjo1MFrOE_ndcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTo0OToyN1rOFAMp_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MTQyMjU5OnYy", "diffSide": "RIGHT", "path": "secret-engine/src/main/java/com/sequenceiq/cloudbreak/service/secret/service/SecretAspectService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzoyMjo1MFrOH9arug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzoyMjo1MFrOH9arug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE2MjM2Mg==", "bodyText": "Nit: Perhaps replace the hardwired class name with AccountIdAwareResource.class.getSimpleName() like a few lines below in findAccountId().", "url": "https://github.com/hortonworks/cloudbreak/pull/9556#discussion_r534162362", "createdAt": "2020-12-02T13:22:50Z", "author": {"login": "lajosrodek"}, "path": "secret-engine/src/main/java/com/sequenceiq/cloudbreak/service/secret/service/SecretAspectService.java", "diffHunk": "@@ -52,7 +52,7 @@ public Object proceedSave(ProceedingJoinPoint proceedingJoinPoint) {\n                     }\n                 }\n             } catch (IllegalArgumentException e) {\n-                LOGGER.error(\"Given entity isn't instance of TenantAwareResource. Secret is not deleted!\", e);\n+                LOGGER.error(\"Given entity isn't instance of AccountIdAwareResource. Secret is not deleted!\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed8abaed5d7e8a5c9b5fa137f0cc1f249b0ee94a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MTQyNDE3OnYy", "diffSide": "RIGHT", "path": "secret-engine/src/main/java/com/sequenceiq/cloudbreak/service/secret/service/SecretAspectService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzoyMzoxNlrOH9as0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzoyMzoxNlrOH9as0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE2MjY0Mg==", "bodyText": "Same here.", "url": "https://github.com/hortonworks/cloudbreak/pull/9556#discussion_r534162642", "createdAt": "2020-12-02T13:23:16Z", "author": {"login": "lajosrodek"}, "path": "secret-engine/src/main/java/com/sequenceiq/cloudbreak/service/secret/service/SecretAspectService.java", "diffHunk": "@@ -92,7 +92,7 @@ public Object proceedDelete(ProceedingJoinPoint proceedingJoinPoint) {\n                     }\n                 }\n             } catch (IllegalArgumentException e) {\n-                LOGGER.error(\"Given entity isn't instance of TenantAwareResource. Secret is not deleted!\", e);\n+                LOGGER.error(\"Given entity isn't instance of AccountIdAwareResource. Secret is not deleted!\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed8abaed5d7e8a5c9b5fa137f0cc1f249b0ee94a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1NzUxNjc4OnYy", "diffSide": "RIGHT", "path": "freeipa/src/main/resources/schema/app/20201203102940_CB-10140_add_accountId_to_freeipa_SaltSecurityConfig.sql", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTo0OToyN1rOH-XNtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTo1NTowNVrOH-Xh0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE1NDEwMg==", "bodyText": "Default value shouldn't be added like this. It will block the whole table.\nSee https://dba.stackexchange.com/questions/60965/does-postgresql-optimize-adding-columns-with-non-null-defaults/216153#216153\nExample: https://github.com/hortonworks/cloudbreak/blob/master/core/src/main/resources/schema/app/20201130155647_CB-9580_new_field_on_cluster:_embedded_db_is_configured_on_attached_disk_or_not.sql\nAlso I think we should set it to null.", "url": "https://github.com/hortonworks/cloudbreak/pull/9556#discussion_r535154102", "createdAt": "2020-12-03T11:49:27Z", "author": {"login": "keyki"}, "path": "freeipa/src/main/resources/schema/app/20201203102940_CB-10140_add_accountId_to_freeipa_SaltSecurityConfig.sql", "diffHunk": "@@ -0,0 +1,11 @@\n+-- // CB-10140 add accountId to freeipa SaltSecurityConfig\n+-- Migration SQL that makes the change goes here.\n+\n+ALTER TABLE saltsecurityconfig ADD COLUMN IF NOT EXISTS accountid VARCHAR(255) DEFAULT 'undefined';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89c6d9b330ad1a2f43184e1d72eea522fe2b4263"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE1OTI0OQ==", "bodyText": "done", "url": "https://github.com/hortonworks/cloudbreak/pull/9556#discussion_r535159249", "createdAt": "2020-12-03T11:55:05Z", "author": {"login": "doktoric"}, "path": "freeipa/src/main/resources/schema/app/20201203102940_CB-10140_add_accountId_to_freeipa_SaltSecurityConfig.sql", "diffHunk": "@@ -0,0 +1,11 @@\n+-- // CB-10140 add accountId to freeipa SaltSecurityConfig\n+-- Migration SQL that makes the change goes here.\n+\n+ALTER TABLE saltsecurityconfig ADD COLUMN IF NOT EXISTS accountid VARCHAR(255) DEFAULT 'undefined';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE1NDEwMg=="}, "originalCommit": {"oid": "89c6d9b330ad1a2f43184e1d72eea522fe2b4263"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3399, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}