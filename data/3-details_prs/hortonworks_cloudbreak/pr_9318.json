{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNTk5Njk3", "number": 9318, "title": "CB-8979 - added tracing for salt api calls", "bodyText": "", "createdAt": "2020-10-28T14:40:40Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9318", "merged": true, "mergeCommit": {"oid": "7391e8fb0935fb7b28743e2112de95db31e981ed"}, "closed": true, "closedAt": "2020-10-29T13:58:37Z", "author": {"login": "attilapalfi92"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdW-4fPgFqTUxODc1OTM0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXPR2bABqjM5MzU0NjA3MTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NzU5MzQ3", "url": "https://github.com/hortonworks/cloudbreak/pull/9318#pullrequestreview-518759347", "createdAt": "2020-10-28T14:59:22Z", "commit": {"oid": "1ee5729ef857c1f5cbd1e771e55ce18e7c2d3b31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNDo1OToyMlrOHpueUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNDo1OToyMlrOHpueUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNTA5MA==", "bodyText": "most salt calls happens using /saltapi/run. see SaltEndpoint#SALT_RUN\nthis way StringUtils.substringAfterLast will return an empty string", "url": "https://github.com/hortonworks/cloudbreak/pull/9318#discussion_r513515090", "createdAt": "2020-10-28T14:59:22Z", "author": {"login": "lacikaaa"}, "path": "orchestrator-salt/src/main/java/com/sequenceiq/cloudbreak/orchestrator/salt/client/TracingClientSpanDecorator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.sequenceiq.cloudbreak.orchestrator.salt.client;\n+\n+import javax.ws.rs.client.ClientRequestContext;\n+import javax.ws.rs.client.ClientResponseContext;\n+\n+import org.apache.commons.lang3.StringUtils;\n+\n+import com.sequenceiq.cloudbreak.orchestrator.salt.domain.Pillar;\n+import com.sequenceiq.cloudbreak.tracing.TracingUtil;\n+\n+import io.opentracing.Span;\n+import io.opentracing.contrib.jaxrs2.client.ClientSpanDecorator;\n+\n+public class TracingClientSpanDecorator implements ClientSpanDecorator {\n+\n+    @Override\n+    public void decorateRequest(ClientRequestContext requestContext, Span span) {\n+        String uri = requestContext.getUri().toString();\n+        String saltPath = StringUtils.substringAfterLast(uri, \"/saltboot/\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ee5729ef857c1f5cbd1e771e55ce18e7c2d3b31"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ee5729ef857c1f5cbd1e771e55ce18e7c2d3b31", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1ee5729ef857c1f5cbd1e771e55ce18e7c2d3b31", "committedDate": "2020-10-28T14:39:56Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "07f2ba386574fd492034f95082b7da5841ec51e3", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/07f2ba386574fd492034f95082b7da5841ec51e3", "committedDate": "2020-10-28T17:15:47Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07f2ba386574fd492034f95082b7da5841ec51e3", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/07f2ba386574fd492034f95082b7da5841ec51e3", "committedDate": "2020-10-28T17:15:47Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "428687aa9fb2349a0b695c1519b3b422c8abd44f", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/428687aa9fb2349a0b695c1519b3b422c8abd44f", "committedDate": "2020-10-28T17:41:28Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "428687aa9fb2349a0b695c1519b3b422c8abd44f", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/428687aa9fb2349a0b695c1519b3b422c8abd44f", "committedDate": "2020-10-28T17:41:28Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "6274b82c728ca6c4d78bcc984d5b68235e947497", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6274b82c728ca6c4d78bcc984d5b68235e947497", "committedDate": "2020-10-28T17:52:33Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6274b82c728ca6c4d78bcc984d5b68235e947497", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6274b82c728ca6c4d78bcc984d5b68235e947497", "committedDate": "2020-10-28T17:52:33Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "05b846e7c7358b394203da44c04c36581d5644e5", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/05b846e7c7358b394203da44c04c36581d5644e5", "committedDate": "2020-10-28T19:46:59Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDAzOTAz", "url": "https://github.com/hortonworks/cloudbreak/pull/9318#pullrequestreview-519403903", "createdAt": "2020-10-29T07:49:53Z", "commit": {"oid": "05b846e7c7358b394203da44c04c36581d5644e5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05b846e7c7358b394203da44c04c36581d5644e5", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/05b846e7c7358b394203da44c04c36581d5644e5", "committedDate": "2020-10-28T19:46:59Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "7859efad55bae5e502c70e7dd729fba5ee7f02f3", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7859efad55bae5e502c70e7dd729fba5ee7f02f3", "committedDate": "2020-10-29T08:57:51Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e22870f877b16e4d27c4662688769687ca18813e", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e22870f877b16e4d27c4662688769687ca18813e", "committedDate": "2020-10-29T10:04:08Z", "message": "CB-8979 - added tracing for salt api calls"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7859efad55bae5e502c70e7dd729fba5ee7f02f3", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7859efad55bae5e502c70e7dd729fba5ee7f02f3", "committedDate": "2020-10-29T08:57:51Z", "message": "CB-8979 - added tracing for salt api calls"}, "afterCommit": {"oid": "e22870f877b16e4d27c4662688769687ca18813e", "author": {"user": {"login": "attilapalfi92", "name": "Attila P\u00e1lfi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e22870f877b16e4d27c4662688769687ca18813e", "committedDate": "2020-10-29T10:04:08Z", "message": "CB-8979 - added tracing for salt api calls"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2080, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}