{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MzYwMzQz", "number": 7668, "title": "CDPCP-1735. Error message when getting user keytab on older FreeIPA", "bodyText": "The user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this.", "createdAt": "2020-03-26T18:57:38Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7668", "merged": true, "mergeCommit": {"oid": "f0fa2078cae2e519ec764f767442651e51ef6391"}, "closed": true, "closedAt": "2020-04-03T14:49:34Z", "author": {"login": "aarman-cloudera"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRhJiogFqTM4MjMzOTMzOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRwiGWgFqTM4Mjg0NTA2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMzM5MzM4", "url": "https://github.com/hortonworks/cloudbreak/pull/7668#pullrequestreview-382339338", "createdAt": "2020-03-26T19:20:06Z", "commit": {"oid": "514d68cdcf37fa63b957476e37d688b1d333ba64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "514d68cdcf37fa63b957476e37d688b1d333ba64", "author": {"user": {"login": "aarman-cloudera", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/514d68cdcf37fa63b957476e37d688b1d333ba64", "committedDate": "2020-03-26T18:55:57Z", "message": "CDPCP-1735. Error message when getting user keytab on older FreeIPA\n\nThe user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this."}, "afterCommit": {"oid": "9b08f40d3ed3b418ab3ef978a96f6322dc0ab164", "author": {"user": {"login": "aarman-cloudera", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9b08f40d3ed3b418ab3ef978a96f6322dc0ab164", "committedDate": "2020-03-27T04:00:37Z", "message": "CDPCP-1735. Error message when getting user keytab on older FreeIPA\n\nThe user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNjQyMjYz", "url": "https://github.com/hortonworks/cloudbreak/pull/7668#pullrequestreview-382642263", "createdAt": "2020-03-27T07:58:58Z", "commit": {"oid": "9b08f40d3ed3b418ab3ef978a96f6322dc0ab164"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwNzo1ODo1OFrOF8mffA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwNzo1ODo1OFrOF8mffA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTA4OTUzMg==", "bodyText": "could you change IPA to FreeIPA?", "url": "https://github.com/hortonworks/cloudbreak/pull/7668#discussion_r399089532", "createdAt": "2020-03-27T07:58:58Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/kerberosmgmt/v1/UserKeytabService.java", "diffHunk": "@@ -57,11 +59,14 @@ private void validateSameAccount(String userAccountId, String environmentCrn) {\n         }\n     }\n \n-    private void validateWorkloadUserInEnvironment(String workloadUsername, String environmentCrn) {\n+    private void validateFreeIPAState(String workloadUsername, String environmentCrn) {\n         String accountId = Crn.safeFromString(environmentCrn).getAccountId();\n         FreeIpaClient freeIpaClient;\n         try {\n             freeIpaClient = freeIpaClientFactory.getFreeIpaClientByAccountAndEnvironment(environmentCrn, accountId);\n+            if (!FreeIpaCapabilities.hasSetPasswordHashSupport(freeIpaClient.getConfig())) {\n+                throw new UnsupportedException(\"User keytab retrieval requires a newer environment and IPA version\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b08f40d3ed3b418ab3ef978a96f6322dc0ab164"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23a89c0d198f0865587bfd39fb33e660986e19d1", "author": {"user": {"login": "aarman-cloudera", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/23a89c0d198f0865587bfd39fb33e660986e19d1", "committedDate": "2020-03-27T08:03:55Z", "message": "CDPCP-1735. Error message when getting user keytab on older FreeIPA\n\nThe user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b08f40d3ed3b418ab3ef978a96f6322dc0ab164", "author": {"user": {"login": "aarman-cloudera", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9b08f40d3ed3b418ab3ef978a96f6322dc0ab164", "committedDate": "2020-03-27T04:00:37Z", "message": "CDPCP-1735. Error message when getting user keytab on older FreeIPA\n\nThe user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this."}, "afterCommit": {"oid": "23a89c0d198f0865587bfd39fb33e660986e19d1", "author": {"user": {"login": "aarman-cloudera", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/23a89c0d198f0865587bfd39fb33e660986e19d1", "committedDate": "2020-03-27T08:03:55Z", "message": "CDPCP-1735. Error message when getting user keytab on older FreeIPA\n\nThe user keytabs we generate are only valid on FreeIPAs that have password\nhash support. This change returns an appropriate error based on this."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyODQ1MDY4", "url": "https://github.com/hortonworks/cloudbreak/pull/7668#pullrequestreview-382845068", "createdAt": "2020-03-27T13:15:29Z", "commit": {"oid": "23a89c0d198f0865587bfd39fb33e660986e19d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2378, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}