{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5OTE3NzY5", "number": 8934, "title": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup", "bodyText": "Introduce withSkipOnFail(false)) to all the TestDtos' cleanUp\n\nAlong with the previous change introduce testDto.setResponse to all the related DeleteActions\n\n\nUpdate and standardised all the TestDtos' not implemented cleanUp with: LOGGER.warn(String.format(\"Cleanup WARN: 'cleanUp' is not implemented for TestDto: %s with name: %s\", this, getName()));\nMake deletedResources MultiValueMap CleanupUtil class global\nSome additional changes for Integration Tests:\n\nFlowUtil: Thread.currentThread().interrupt()\nEnvironmentChildTest: checkEnvsAreNotListedByName", "createdAt": "2020-09-04T17:39:59Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8934", "merged": true, "mergeCommit": {"oid": "7c39406a383b065369f194bf7c4f943fd27df13a"}, "closed": true, "closedAt": "2020-09-10T07:38:08Z", "author": {"login": "aszegedi"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFrruYABqjM3MzE1ODE2OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHa8CkgBqjM3NDkyMzY2NzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb5cc716d5e5a56d9151815381be65e34aaae11b", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fb5cc716d5e5a56d9151815381be65e34aaae11b", "committedDate": "2020-09-04T17:10:17Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "b6d5e8e3c38184f2481aaa43513d0a3e8b3a54b7", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b6d5e8e3c38184f2481aaa43513d0a3e8b3a54b7", "committedDate": "2020-09-04T21:00:08Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6d5e8e3c38184f2481aaa43513d0a3e8b3a54b7", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b6d5e8e3c38184f2481aaa43513d0a3e8b3a54b7", "committedDate": "2020-09-04T21:00:08Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d830d9d7a71df8a15e80993d6cacda2f109c6cd3", "committedDate": "2020-09-05T05:17:37Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMzUyNjY0", "url": "https://github.com/hortonworks/cloudbreak/pull/8934#pullrequestreview-483352664", "createdAt": "2020-09-07T08:24:30Z", "commit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNDozMFrOHN1lxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNDozMFrOHN1lxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI3MTU1OQ==", "bodyText": "I think in this case we should simply not override the default cleanUp", "url": "https://github.com/hortonworks/cloudbreak/pull/8934#discussion_r484271559", "createdAt": "2020-09-07T08:24:30Z", "author": {"login": "Bajzathd"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/dto/connector/PlatformAccessConfigsTestDto.java", "diffHunk": "@@ -72,7 +72,7 @@ public PlatformAccessConfigsTestDto withAvailabilityZone(String availabilityZone\n \n     @Override\n     public void cleanUp(TestContext context, CloudbreakClient cloudbreakClient) {\n-        LOGGER.debug(\"this entry point does not have any clean up operation\");\n+        LOGGER.warn(String.format(\"Cleanup WARN: 'cleanUp' is not implemented for TestDto: %s with name: %s\", this, getName()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMzU1MDYx", "url": "https://github.com/hortonworks/cloudbreak/pull/8934#pullrequestreview-483355061", "createdAt": "2020-09-07T08:27:38Z", "commit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzozOFrOHN1tJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzozOFrOHN1tJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI3MzQ0NA==", "bodyText": "From the message we can not tell which env was listed - the parent or the child.\nI have also refactored this test case in my PR, see here: https://github.com/hortonworks/cloudbreak/pull/8923/files#diff-68f3ed9be95a1bffc91d2b7ec253c58c\nI think we should merge these somehow here", "url": "https://github.com/hortonworks/cloudbreak/pull/8934#discussion_r484273444", "createdAt": "2020-09-07T08:27:38Z", "author": {"login": "Bajzathd"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/testcase/mock/EnvironmentChildTest.java", "diffHunk": "@@ -231,4 +238,21 @@ private boolean parentNameEquals(EnvironmentTestDto environment, SimpleEnvironme\n                                 .bodyContains(method)\n                                 .exactTimes(times));\n     }\n+\n+    private Assertion<EnvironmentTestDto, EnvironmentClient> checkEnvsAreNotListedByName(List<String> environmentNames) {\n+        return (testContext, environmentTestDto, environmentClient) -> {\n+            Collection<SimpleEnvironmentResponse> simpleEnvironmentV4Respons = environmentTestDto.getResponseSimpleEnvSet();\n+            if (isNull(simpleEnvironmentV4Respons)) {\n+                throw new TestFailException(\"Environment list response is missing.\");\n+            }\n+            List<String> listedEnvironmentNames = simpleEnvironmentV4Respons.stream()\n+                    .filter(response -> !response.getEnvironmentStatus().equals(EnvironmentStatus.ARCHIVED))\n+                    .map(EnvironmentBaseResponse::getName)\n+                    .collect(Collectors.toList());\n+            if (listedEnvironmentNames.stream().anyMatch(environmentNames::contains)) {\n+                throw new TestFailException(\"Environment is listed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3"}, "originalPosition": 66}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d830d9d7a71df8a15e80993d6cacda2f109c6cd3", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d830d9d7a71df8a15e80993d6cacda2f109c6cd3", "committedDate": "2020-09-05T05:17:37Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "e9ccef581856a4e96c9b75c431f0c93cbc5a7da4", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e9ccef581856a4e96c9b75c431f0c93cbc5a7da4", "committedDate": "2020-09-07T10:30:36Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9ccef581856a4e96c9b75c431f0c93cbc5a7da4", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e9ccef581856a4e96c9b75c431f0c93cbc5a7da4", "committedDate": "2020-09-07T10:30:36Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "73c7e3326d6e548bf9e6763e7dbefdb487f40dee", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/73c7e3326d6e548bf9e6763e7dbefdb487f40dee", "committedDate": "2020-09-07T10:31:27Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73c7e3326d6e548bf9e6763e7dbefdb487f40dee", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/73c7e3326d6e548bf9e6763e7dbefdb487f40dee", "committedDate": "2020-09-07T10:31:27Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "b9fc5bc7e5d7f41b96c3dea3d4ce89ddd4bc9071", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b9fc5bc7e5d7f41b96c3dea3d4ce89ddd4bc9071", "committedDate": "2020-09-07T10:42:56Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9fc5bc7e5d7f41b96c3dea3d4ce89ddd4bc9071", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b9fc5bc7e5d7f41b96c3dea3d4ce89ddd4bc9071", "committedDate": "2020-09-07T10:42:56Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "e8eb469fde7561b9af8d9568f077fe9e32fb988a", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e8eb469fde7561b9af8d9568f077fe9e32fb988a", "committedDate": "2020-09-07T14:00:58Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNTk2ODcw", "url": "https://github.com/hortonworks/cloudbreak/pull/8934#pullrequestreview-483596870", "createdAt": "2020-09-07T14:28:25Z", "commit": {"oid": "e8eb469fde7561b9af8d9568f077fe9e32fb988a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8eb469fde7561b9af8d9568f077fe9e32fb988a", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e8eb469fde7561b9af8d9568f077fe9e32fb988a", "committedDate": "2020-09-07T14:00:58Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "48bea8a8d516a27499e52c8b33ba75e3efde1686", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/48bea8a8d516a27499e52c8b33ba75e3efde1686", "committedDate": "2020-09-08T05:26:20Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "48bea8a8d516a27499e52c8b33ba75e3efde1686", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/48bea8a8d516a27499e52c8b33ba75e3efde1686", "committedDate": "2020-09-08T05:26:20Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "68cec5cb0bdbc42a9b09e7005ef5c8a215f02b0b", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/68cec5cb0bdbc42a9b09e7005ef5c8a215f02b0b", "committedDate": "2020-09-08T11:44:12Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68cec5cb0bdbc42a9b09e7005ef5c8a215f02b0b", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/68cec5cb0bdbc42a9b09e7005ef5c8a215f02b0b", "committedDate": "2020-09-08T11:44:12Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "00c01ddbc5a151d2c85c16f7838b535d2103b598", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/00c01ddbc5a151d2c85c16f7838b535d2103b598", "committedDate": "2020-09-08T11:44:43Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00c01ddbc5a151d2c85c16f7838b535d2103b598", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/00c01ddbc5a151d2c85c16f7838b535d2103b598", "committedDate": "2020-09-08T11:44:43Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "6a7ea01c0a62a2a8942a05735a243a4f460c8825", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6a7ea01c0a62a2a8942a05735a243a4f460c8825", "committedDate": "2020-09-08T12:30:10Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1402b75abd30867098e6e019f3c61b65f2245792", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1402b75abd30867098e6e019f3c61b65f2245792", "committedDate": "2020-09-08T16:05:36Z", "message": "Additional fixes"}, "afterCommit": {"oid": "8bbc175248644cede7a21e397d551274e690a29f", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8bbc175248644cede7a21e397d551274e690a29f", "committedDate": "2020-09-08T16:54:47Z", "message": "Additional fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8bbc175248644cede7a21e397d551274e690a29f", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8bbc175248644cede7a21e397d551274e690a29f", "committedDate": "2020-09-08T16:54:47Z", "message": "Additional fixes"}, "afterCommit": {"oid": "2157120f0fbc406720722d3fcdb037345c8023cb", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2157120f0fbc406720722d3fcdb037345c8023cb", "committedDate": "2020-09-08T17:44:02Z", "message": "Additional fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2157120f0fbc406720722d3fcdb037345c8023cb", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2157120f0fbc406720722d3fcdb037345c8023cb", "committedDate": "2020-09-08T17:44:02Z", "message": "Additional fixes"}, "afterCommit": {"oid": "d9187f6a3a436230080646dd28b3c27e08141791", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d9187f6a3a436230080646dd28b3c27e08141791", "committedDate": "2020-09-08T17:50:16Z", "message": "Additional fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9187f6a3a436230080646dd28b3c27e08141791", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d9187f6a3a436230080646dd28b3c27e08141791", "committedDate": "2020-09-08T17:50:16Z", "message": "Additional fixes"}, "afterCommit": {"oid": "1b74d74ca508cb13c48254f45e4745372ff31208", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1b74d74ca508cb13c48254f45e4745372ff31208", "committedDate": "2020-09-08T19:42:32Z", "message": "Additional fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b74d74ca508cb13c48254f45e4745372ff31208", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1b74d74ca508cb13c48254f45e4745372ff31208", "committedDate": "2020-09-08T19:42:32Z", "message": "Additional fixes"}, "afterCommit": {"oid": "c25f297a20edd975e7a08e36a7a7f21354f7b4fd", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c25f297a20edd975e7a08e36a7a7f21354f7b4fd", "committedDate": "2020-09-08T20:46:25Z", "message": "Additional fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c25f297a20edd975e7a08e36a7a7f21354f7b4fd", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c25f297a20edd975e7a08e36a7a7f21354f7b4fd", "committedDate": "2020-09-08T20:46:25Z", "message": "Additional fixes"}, "afterCommit": {"oid": "a6e228b8b4512fe917b842cb8e40ef79ce996201", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a6e228b8b4512fe917b842cb8e40ef79ce996201", "committedDate": "2020-09-10T04:41:28Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a6e228b8b4512fe917b842cb8e40ef79ce996201", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a6e228b8b4512fe917b842cb8e40ef79ce996201", "committedDate": "2020-09-10T04:41:28Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "043670c113476c79a9540ea9024025821657d466", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/043670c113476c79a9540ea9024025821657d466", "committedDate": "2020-09-10T04:43:35Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ef2c17aa21d951abe09fe9a05fcbbd5005a6311", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1ef2c17aa21d951abe09fe9a05fcbbd5005a6311", "committedDate": "2020-09-10T06:37:33Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "043670c113476c79a9540ea9024025821657d466", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/043670c113476c79a9540ea9024025821657d466", "committedDate": "2020-09-10T04:43:35Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}, "afterCommit": {"oid": "1ef2c17aa21d951abe09fe9a05fcbbd5005a6311", "author": {"user": {"login": "aszegedi", "name": "Annamaria Szegedi"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1ef2c17aa21d951abe09fe9a05fcbbd5005a6311", "committedDate": "2020-09-10T06:37:33Z", "message": "CB-8670 Introduce withSkipOnFail to TestDTO cleanup"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2418, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}