{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0ODQ5NDQ0", "number": 7500, "title": "CB-5556 second attempt at making Sdx Repair internals better, introdu\u2026", "bodyText": "", "createdAt": "2020-03-06T14:27:22Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7500", "merged": true, "mergeCommit": {"oid": "48d2af7a0fb6fbbe13d7843244bc105f19886a98"}, "closed": true, "closedAt": "2020-03-13T15:33:38Z", "author": {"login": "lnardai"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLYwH2AFqTM3MDc4MDYwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcM33dsAFqTM3MzM3MzU0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNzgwNjA3", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#pullrequestreview-370780607", "createdAt": "2020-03-07T18:09:32Z", "commit": {"oid": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODowOTozMlrOFzRDQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODowOTozMlrOFzRDQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMTA1OA==", "bodyText": "I think this statement shall be in the else clause of the if above, otherwise settings.hostGroupNames might get overwritten (with null or whatever is passed in request.getHostGroupNames()) even if a single host group was to be repaired. Alternatively, the statement can be also moved before the if, whichever approach you prefer. \ud83d\ude04", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#discussion_r389301058", "createdAt": "2020-03-07T18:09:32Z", "author": {"login": "lajosrodek"}, "path": "datalake/src/main/java/com/sequenceiq/datalake/settings/SdxRepairSettings.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.sequenceiq.datalake.settings;\n+\n+import java.util.List;\n+\n+import javax.ws.rs.BadRequestException;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.logging.log4j.util.Strings;\n+\n+import com.sequenceiq.sdx.api.model.SdxRepairRequest;\n+\n+public class SdxRepairSettings {\n+\n+    private List<String> hostGroupNames;\n+\n+    private SdxRepairSettings() {\n+    }\n+\n+    public static SdxRepairSettings from(SdxRepairRequest request) {\n+        if (StringUtils.isNotBlank(request.getHostGroupName()) && CollectionUtils.isNotEmpty(request.getHostGroupNames())) {\n+            throw new BadRequestException(\"Please send only one hostGroupName in the 'hostGroupName' field \" +\n+                    \"or multiple hostGroups in the 'hostGroupNames' fields\");\n+        }\n+        SdxRepairSettings settings = new SdxRepairSettings();\n+        if (Strings.isNotEmpty(request.getHostGroupName())) {\n+            settings.hostGroupNames = List.of(request.getHostGroupName());\n+        }\n+        settings.hostGroupNames = request.getHostGroupNames();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNzgwODM3", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#pullrequestreview-370780837", "createdAt": "2020-03-07T18:15:09Z", "commit": {"oid": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODoxNTowOVrOFzREfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODoxNTowOVrOFzREfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMTM3Mg==", "bodyText": "Minor: rename repairRequest to repairSettings. Similarly in the other two changes below.", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#discussion_r389301372", "createdAt": "2020-03-07T18:15:09Z", "author": {"login": "lajosrodek"}, "path": "datalake/src/main/java/com/sequenceiq/datalake/service/sdx/SdxRepairService.java", "diffHunk": "@@ -76,15 +75,15 @@ public FlowIdentifier triggerRepairByName(String userCrn, String clusterName, Sd\n         return sdxReactorFlowManager.triggerSdxRepairFlow(cluster.getId(), clusterRepairRequest);\n     }\n \n-    public void startSdxRepair(Long id, SdxRepairRequest repairRequest) {\n+    public void startSdxRepair(Long id, SdxRepairSettings repairRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "385b8f4a856b7e49071249db02aa6e1f320ee66c", "author": {"user": {"login": "lnardai", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/385b8f4a856b7e49071249db02aa6e1f320ee66c", "committedDate": "2020-03-09T11:31:35Z", "message": "CB-5556 second attempt at making Sdx Repair internals better, introduced RepairSettings, maybe there's a better name for it."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf", "author": {"user": {"login": "lnardai", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/504f5a0649bfe5e692c50bd7a4d38c9ae922cabf", "committedDate": "2020-03-06T14:26:13Z", "message": "CB-5556 second attempt at making Sdx Repair internals better, introduced RepairSettings, maybe there's a better name for it."}, "afterCommit": {"oid": "385b8f4a856b7e49071249db02aa6e1f320ee66c", "author": {"user": {"login": "lnardai", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/385b8f4a856b7e49071249db02aa6e1f320ee66c", "committedDate": "2020-03-09T11:31:35Z", "message": "CB-5556 second attempt at making Sdx Repair internals better, introduced RepairSettings, maybe there's a better name for it."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzczNTQ2", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#pullrequestreview-373373546", "createdAt": "2020-03-12T08:58:32Z", "commit": {"oid": "385b8f4a856b7e49071249db02aa6e1f320ee66c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2541, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}