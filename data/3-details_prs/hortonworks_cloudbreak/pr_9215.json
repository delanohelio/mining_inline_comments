{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyODQ2MTM4", "number": 9215, "title": "CB-5073 Use wire encryption (TLS) for SDX DB - Phase 1", "bodyText": "\u2026d certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario\nSee detailed description in the commit message.", "createdAt": "2020-10-13T21:10:07Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9215", "merged": true, "mergeCommit": {"oid": "f5aeb066359286673dc41d7d65ffb7fb1002d096"}, "closed": true, "closedAt": "2020-10-28T19:23:15Z", "author": {"login": "doktoric"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSPkdIABqjM4NzM2NzMyMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXCkczgFqTUxOTAwNTU2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ee3c40ec6cb20fde02139826cb2ed42a9cf6ceb", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1ee3c40ec6cb20fde02139826cb2ed42a9cf6ceb", "committedDate": "2020-10-13T21:00:53Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}, "afterCommit": {"oid": "6b7acbeac07e3963978a2d056a9bf90c871ecd76", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6b7acbeac07e3963978a2d056a9bf90c871ecd76", "committedDate": "2020-10-13T21:35:55Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b7acbeac07e3963978a2d056a9bf90c871ecd76", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6b7acbeac07e3963978a2d056a9bf90c871ecd76", "committedDate": "2020-10-13T21:35:55Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}, "afterCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a51b73b22d0f716cb69ff4b69e887de9f159567f", "committedDate": "2020-10-14T09:32:43Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MTg5ODIx", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#pullrequestreview-508189821", "createdAt": "2020-10-14T10:03:37Z", "commit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMDowMzozN1rOHhLrAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMDozNzowN1rOHhM0Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU1NjI4OA==", "bodyText": "I suggest renaming this to sslCertificateType along with the getter/setter.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504556288", "createdAt": "2020-10-14T10:03:37Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/domain/stack/SslConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package com.sequenceiq.redbeams.domain.stack;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Convert;\n+import javax.persistence.ElementCollection;\n+import javax.persistence.Entity;\n+import javax.persistence.FetchType;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.SequenceGenerator;\n+import javax.persistence.Table;\n+\n+import com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.responses.SslCertificateType;\n+import com.sequenceiq.redbeams.repository.converter.SslCertificateTypeConverter;\n+\n+@Entity\n+@Table\n+public class SslConfig {\n+\n+    @Id\n+    @GeneratedValue(strategy = GenerationType.AUTO, generator = \"sslconfig_generator\")\n+    @SequenceGenerator(name = \"sslconfig_generator\", sequenceName = \"sslconfig_id_seq\", allocationSize = 1)\n+    private Long id;\n+\n+    @ElementCollection(fetch = FetchType.EAGER)\n+    @Column(name = \"sslcertificate_value\")\n+    private Set<String> sslCertificates = new HashSet<>();\n+\n+    @Convert(converter = SslCertificateTypeConverter.class)\n+    private SslCertificateType type = SslCertificateType.NONE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU1NzgwNQ==", "bodyText": "So we are storing the whole certificate text in the DB? Would not it be better to just store some internal cert ID for CLOUD_PROVIDER_OWNED certs to save storage space?", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504557805", "createdAt": "2020-10-14T10:06:12Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/converter/stack/AllocateDatabaseServerV4RequestToDBStackConverter.java", "diffHunk": "@@ -160,9 +170,19 @@ public DBStack convert(AllocateDatabaseServerV4Request source, String ownerCrnSt\n         dbStack.setDBStackStatus(new DBStackStatus(dbStack, DetailedDBStackStatus.PROVISION_REQUESTED, now.toEpochMilli()));\n         dbStack.setResourceCrn(crnService.createCrn(dbStack));\n         dbStack.setTags(getTags(dbStack, source.getClusterCrn(), environment));\n+        dbStack.setSslConfig(getSslConfig(source, dbStack));\n         return dbStack;\n     }\n \n+    public SslConfig getSslConfig(AllocateDatabaseServerV4Request source, DBStack dbStack) {\n+        SslConfig sslConfig = new SslConfig();\n+        if (sslEnabled && source.getSslConfiguration() != null && SslMode.isEnabled(source.getSslConfiguration().getMode())) {\n+            sslConfig.setSslCertificates(databaseServerSSlCertificateConfig.getCertsByPlatform(dbStack.getCloudPlatform()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU2MjI4Nw==", "bodyText": "I suggest renaming this to SslConfigurationV4Request to be consistent with other request classes.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504562287", "createdAt": "2020-10-14T10:13:51Z", "author": {"login": "lajosrodek"}, "path": "redbeams-api/src/main/java/com/sequenceiq/redbeams/api/endpoint/v4/databaseserver/requests/SslConfigurationRequest.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.requests;\n+\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.sequenceiq.redbeams.doc.ModelDescriptions;\n+\n+import io.swagger.annotations.ApiModel;\n+\n+@ApiModel(description = ModelDescriptions.SSL_CONFIGURATION_REQUEST)\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class SslConfigurationRequest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU2MjY5MA==", "bodyText": "Please rename this to sslMode, along with the getter/setter.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504562690", "createdAt": "2020-10-14T10:14:35Z", "author": {"login": "lajosrodek"}, "path": "redbeams-api/src/main/java/com/sequenceiq/redbeams/api/endpoint/v4/databaseserver/requests/SslConfigurationRequest.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.requests;\n+\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.sequenceiq.redbeams.doc.ModelDescriptions;\n+\n+import io.swagger.annotations.ApiModel;\n+\n+@ApiModel(description = ModelDescriptions.SSL_CONFIGURATION_REQUEST)\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class SslConfigurationRequest {\n+\n+    private SslMode mode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU2NDY5Nw==", "bodyText": "I suggest renaming this to SslConfigV4Response to be consistent with other request/response classes.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504564697", "createdAt": "2020-10-14T10:18:11Z", "author": {"login": "lajosrodek"}, "path": "redbeams-api/src/main/java/com/sequenceiq/redbeams/api/endpoint/v4/databaseserver/responses/SslConfigResponse.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.responses;\n+\n+import java.util.Set;\n+\n+import com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.requests.SslMode;\n+import com.sequenceiq.redbeams.doc.ModelDescriptions;\n+\n+import io.swagger.annotations.ApiModel;\n+import io.swagger.annotations.ApiModelProperty;\n+\n+@ApiModel(description = ModelDescriptions.SSL_CONFIG_RESPONSE)\n+public class SslConfigResponse {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU2NTI2Mw==", "bodyText": "SSL.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504565263", "createdAt": "2020-10-14T10:19:08Z", "author": {"login": "lajosrodek"}, "path": "redbeams-api/src/main/java/com/sequenceiq/redbeams/doc/ModelDescriptions.java", "diffHunk": "@@ -3,6 +3,7 @@\n public final class ModelDescriptions {\n \n     public static final String ALLOCATE_DATABASE_SERVER_REQUEST = \"Request for allocating a new database server in a provider\";\n+    public static final String SSL_CONFIGURATION_REQUEST = \"Request for ssl configuration\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU2NTM0OQ==", "bodyText": "SSL.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504565349", "createdAt": "2020-10-14T10:19:18Z", "author": {"login": "lajosrodek"}, "path": "redbeams-api/src/main/java/com/sequenceiq/redbeams/doc/ModelDescriptions.java", "diffHunk": "@@ -13,6 +14,7 @@\n     public static final String DATABASE_SERVER_RESPONSE = \"Response containing information about a database server that was acted upon, e.g., retrieved, \"\n         + \"deleted, listed\";\n     public static final String DATABASE_SERVER_RESPONSES = \"A set of multiple database server responses\";\n+    public static final String SSL_CONFIG_RESPONSE = \"Ssl Config response\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU3MDY5Mg==", "bodyText": "I think this column is part of the sslconfig table;  please move it there.\nPlease rename it to sslcertificatetype.\nWhy not restrict it to NOT NULL (and then DEFAULT would not be necessary)?", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504570692", "createdAt": "2020-10-14T10:29:19Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/resources/schema/app/20201013110628_CB-9289_ssl_certificate_added_to_db_stack.sql", "diffHunk": "@@ -0,0 +1,30 @@\n+-- // CB-9289 ssl certificate added to db stack\n+-- Migration SQL that makes the change goes here.\n+\n+CREATE TABLE sslconfig\n+(\n+    id BIGINT NOT NULL,\n+    PRIMARY KEY (id)\n+);\n+\n+CREATE SEQUENCE sslconfig_id_seq START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE CACHE 1;\n+\n+CREATE UNIQUE INDEX IF NOT EXISTS sslconfig_id_idx ON sslconfig(id);\n+\n+CREATE TABLE sslconfig_sslcertificates (\n+    sslconfig_id bigint NOT NULL REFERENCES sslconfig (id),\n+    sslcertificate_value text,\n+    type VARCHAR(255) DEFAULT 'CLOUD_PROVIDER_OWNED'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU3MjI1MA==", "bodyText": "Not sure this is a safe default for unknown DB values. Would not NONE be a better choice?", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504572250", "createdAt": "2020-10-14T10:32:02Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/repository/converter/SslCertificateTypeConverter.java", "diffHunk": "@@ -0,0 +1,12 @@\n+package com.sequenceiq.redbeams.repository.converter;\n+\n+import com.sequenceiq.cloudbreak.converter.DefaultEnumConverter;\n+import com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.responses.SslCertificateType;\n+\n+public class SslCertificateTypeConverter extends DefaultEnumConverter<SslCertificateType> {\n+\n+    @Override\n+    public SslCertificateType getDefault() {\n+        return SslCertificateType.CLOUD_PROVIDER_OWNED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU3MzcyMQ==", "bodyText": "Nit: ADD COLUMN IF NOT EXISTS.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504573721", "createdAt": "2020-10-14T10:34:40Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/resources/schema/app/20201013110628_CB-9289_ssl_certificate_added_to_db_stack.sql", "diffHunk": "@@ -0,0 +1,30 @@\n+-- // CB-9289 ssl certificate added to db stack\n+-- Migration SQL that makes the change goes here.\n+\n+CREATE TABLE sslconfig\n+(\n+    id BIGINT NOT NULL,\n+    PRIMARY KEY (id)\n+);\n+\n+CREATE SEQUENCE sslconfig_id_seq START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE CACHE 1;\n+\n+CREATE UNIQUE INDEX IF NOT EXISTS sslconfig_id_idx ON sslconfig(id);\n+\n+CREATE TABLE sslconfig_sslcertificates (\n+    sslconfig_id bigint NOT NULL REFERENCES sslconfig (id),\n+    sslcertificate_value text,\n+    type VARCHAR(255) DEFAULT 'CLOUD_PROVIDER_OWNED'\n+);\n+\n+ALTER TABLE dbstack ADD COLUMN sslconfig_id BIGINT REFERENCES sslconfig(id);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU3NTA3NA==", "bodyText": "Add: ALTER TABLE dbstack DROP COLUMN IF EXISTS sslconfig_id;.", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504575074", "createdAt": "2020-10-14T10:37:07Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/resources/schema/app/20201013110628_CB-9289_ssl_certificate_added_to_db_stack.sql", "diffHunk": "@@ -0,0 +1,30 @@\n+-- // CB-9289 ssl certificate added to db stack\n+-- Migration SQL that makes the change goes here.\n+\n+CREATE TABLE sslconfig\n+(\n+    id BIGINT NOT NULL,\n+    PRIMARY KEY (id)\n+);\n+\n+CREATE SEQUENCE sslconfig_id_seq START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE CACHE 1;\n+\n+CREATE UNIQUE INDEX IF NOT EXISTS sslconfig_id_idx ON sslconfig(id);\n+\n+CREATE TABLE sslconfig_sslcertificates (\n+    sslconfig_id bigint NOT NULL REFERENCES sslconfig (id),\n+    sslcertificate_value text,\n+    type VARCHAR(255) DEFAULT 'CLOUD_PROVIDER_OWNED'\n+);\n+\n+ALTER TABLE dbstack ADD COLUMN sslconfig_id BIGINT REFERENCES sslconfig(id);\n+\n+-- //@UNDO\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MjE4MTY4", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#pullrequestreview-508218168", "createdAt": "2020-10-14T10:42:52Z", "commit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMDo0Mjo1MlrOHhNANQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMDo0Mjo1MlrOHhNANQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDU3ODEwMQ==", "bodyText": "In accordance with the DB schema change, if you agree, this should be extended with @Column(nullable = false).", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r504578101", "createdAt": "2020-10-14T10:42:52Z", "author": {"login": "lajosrodek"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/domain/stack/SslConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package com.sequenceiq.redbeams.domain.stack;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Convert;\n+import javax.persistence.ElementCollection;\n+import javax.persistence.Entity;\n+import javax.persistence.FetchType;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.SequenceGenerator;\n+import javax.persistence.Table;\n+\n+import com.sequenceiq.redbeams.api.endpoint.v4.databaseserver.responses.SslCertificateType;\n+import com.sequenceiq.redbeams.repository.converter.SslCertificateTypeConverter;\n+\n+@Entity\n+@Table\n+public class SslConfig {\n+\n+    @Id\n+    @GeneratedValue(strategy = GenerationType.AUTO, generator = \"sslconfig_generator\")\n+    @SequenceGenerator(name = \"sslconfig_generator\", sequenceName = \"sslconfig_id_seq\", allocationSize = 1)\n+    private Long id;\n+\n+    @ElementCollection(fetch = FetchType.EAGER)\n+    @Column(name = \"sslcertificate_value\")\n+    private Set<String> sslCertificates = new HashSet<>();\n+\n+    @Convert(converter = SslCertificateTypeConverter.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f"}, "originalPosition": 33}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a51b73b22d0f716cb69ff4b69e887de9f159567f", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a51b73b22d0f716cb69ff4b69e887de9f159567f", "committedDate": "2020-10-14T09:32:43Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}, "afterCommit": {"oid": "cdbf51bc9acce988260909f8b4dfe3fd37811d6a", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cdbf51bc9acce988260909f8b4dfe3fd37811d6a", "committedDate": "2020-10-14T11:35:24Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdbf51bc9acce988260909f8b4dfe3fd37811d6a", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cdbf51bc9acce988260909f8b4dfe3fd37811d6a", "committedDate": "2020-10-14T11:35:24Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}, "afterCommit": {"oid": "1bd08a0a2b229e215feed231e6a6aba23b52cc78", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1bd08a0a2b229e215feed231e6a6aba23b52cc78", "committedDate": "2020-10-14T11:43:32Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f477eccf9c2a2690c29737b9cfdd56c28b17e5d", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9f477eccf9c2a2690c29737b9cfdd56c28b17e5d", "committedDate": "2020-10-20T13:23:10Z", "message": "CB-8107 CB-8108 Check for DB param group only when using SSL enforcement"}, "afterCommit": {"oid": "6f7173b38675ff676574920ec9728afeae0ce3f9", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6f7173b38675ff676574920ec9728afeae0ce3f9", "committedDate": "2020-10-20T16:32:33Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyOTQ0NzU4", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#pullrequestreview-512944758", "createdAt": "2020-10-20T16:56:32Z", "commit": {"oid": "6f7173b38675ff676574920ec9728afeae0ce3f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjo1NjozMlrOHlH_FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjo1NjozMlrOHlH_FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY5MDE5Nw==", "bodyText": "@gergopapi2  I have also catch null pointers here as @lajosrodek's tests triggered them here:\nhttps://github.com/hortonworks/cloudbreak/pull/9215/files#diff-e423493453802c8a45d0f78a802ad3b997f9905f5a473ea9641185d1e17e3ea6R93-R103", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#discussion_r508690197", "createdAt": "2020-10-20T16:56:32Z", "author": {"login": "biharitomi"}, "path": "common-model/src/main/java/com/sequenceiq/common/model/EndpointType.java", "diffHunk": "@@ -22,7 +22,7 @@\n     public static EndpointType safeValueOf(String value) {\n         try {\n             return valueOf(value);\n-        } catch (IllegalArgumentException e) {\n+        } catch (IllegalArgumentException | NullPointerException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f7173b38675ff676574920ec9728afeae0ce3f9"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f7173b38675ff676574920ec9728afeae0ce3f9", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/6f7173b38675ff676574920ec9728afeae0ce3f9", "committedDate": "2020-10-20T16:32:33Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}, "afterCommit": {"oid": "58a095edc223774db97905e65988053db2371c16", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/58a095edc223774db97905e65988053db2371c16", "committedDate": "2020-10-20T17:04:23Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58a095edc223774db97905e65988053db2371c16", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/58a095edc223774db97905e65988053db2371c16", "committedDate": "2020-10-20T17:04:23Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}, "afterCommit": {"oid": "f9a1df878d70fe42448c0894710284775edc6ae8", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f9a1df878d70fe42448c0894710284775edc6ae8", "committedDate": "2020-10-21T07:26:54Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c168a549187a85bbe6e9b7a2476ff294710b3da5", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c168a549187a85bbe6e9b7a2476ff294710b3da5", "committedDate": "2020-10-27T11:28:46Z", "message": "CB-8789 Configure DB TLS for DL cluster services & DH HMS\n\n* Persist DB SSL status in RDSConfig\n  * Currently populated for external DBs only\n* Return DB SSL status in RDSDetails\n* Additions to RdsView:\n  * DB SSL status\n  * SSL certificate file path; empty when not using SSL\n  * ConnectionURL extended wit SSL options as necessary\n* Add new compile dependency to\n  template-manager-cmtemplate/build.gradle:\n  org.apache.commons:commons-text:1.5\n* Inject DB SSL configs for HMS and Ranger Admin\n* Honor custom HMS DB settings in cluster template\n* Add new unit tests and migrate existing ones to JUnit 5 & AssertJ"}, "afterCommit": {"oid": "cb2beb0dc074eb44599ffb565817ce93f263f0e3", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cb2beb0dc074eb44599ffb565817ce93f263f0e3", "committedDate": "2020-10-27T13:29:51Z", "message": "CB-8789 Configure DB TLS for DL cluster services & DH HMS\n\n* Persist DB SSL status in RDSConfig\n  * Currently populated for external DBs only\n* Return DB SSL status in RDSDetails\n* Additions to RdsView:\n  * DB SSL status\n  * SSL certificate file path; empty when not using SSL\n  * ConnectionURL extended wit SSL options as necessary\n* Add new compile dependency to\n  template-manager-cmtemplate/build.gradle:\n  org.apache.commons:commons-text:1.5\n* Inject DB SSL configs for HMS and Ranger Admin\n* Honor custom HMS DB settings in cluster template\n* Add new unit tests and migrate existing ones to JUnit 5 & AssertJ"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc15cebb9ec113f16005bee640c9c2435753b249", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fc15cebb9ec113f16005bee640c9c2435753b249", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-9289 Redbeams ssl integration for supporting cloud provider related certs. This PR also helps to identify that customer would like to use the offical provider cert or they preffer BYO scenario"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b255adff19f9a4583fd0b90dce1b4b75e46f8f8", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/3b255adff19f9a4583fd0b90dce1b4b75e46f8f8", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8107 CB-8108 Enable SSL enforcement for AWS & Azure DL external DB\n\n* Rebased onto #9215\n* Enable SSL enforcement for the external DB of data lakes. The list of\n  cloud platforms where this is applied is controlled by the new\n  Datalake service property\n  datalake.supported.externaldb.sslenforcement.platform (see\n  PlatformConfig.dbServiceSslEnforcementSupportedPlatforms).\n  * In AWS, the CF stack is extended with a new\n    AWS::RDS::DBParameterGroup resource that has rds.force_ssl=1.\n    Supported engine versions: 9.5, 9.6, 10.x, 11.x, 12.x, 13.x.\n  * In Azure, the Microsoft.DBforPostgreSQL/servers resource will\n    have sslEnforcement=Enabled and minimalTlsVersion=TLS1_2.\n* Data hub DBs and embedded DBs of any cluster type are not affected.\n* Added new unit tests and updated existing ones to use JUnit 5 and\n  AssertJ."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0abe1b974ef36b9398b9274df72386a68b098228", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0abe1b974ef36b9398b9274df72386a68b098228", "committedDate": "2020-10-28T10:50:43Z", "message": "Fix of SQL migration scripts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2cacf276625f963bfe8c3ca174336aeeab29321", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d2cacf276625f963bfe8c3ca174336aeeab29321", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8114 save related remote databases' root SSL certificates to cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa3839b31a1637945394c5a26f54c581d95d751d", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fa3839b31a1637945394c5a26f54c581d95d751d", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8114 save gathered certs into separated pillar and save it to file on every node"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b59c0b817451c6f8bb18163931dbabec69a9290", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/7b59c0b817451c6f8bb18163931dbabec69a9290", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8107 CB-8108 Apply DL external DB SSL enforcement only for >= 7.2.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8ee4cbaa42a934c1407f8a2c89abbf831c6a843", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d8ee4cbaa42a934c1407f8a2c89abbf831c6a843", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8788 replace/append CM's JDBC connection URL in db.properties in case of client side remote database root certificate validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8450af25d06dad443acf659eddca5b49a9b2953", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d8450af25d06dad443acf659eddca5b49a9b2953", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8107 CB-8108 Check for DB param group only when using SSL enforcement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd8fd3ba7cb749baaa2a608149dfdf4b984eb5b0", "author": {"user": {"login": "biharitomi", "name": "Tamas Bihari"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bd8fd3ba7cb749baaa2a608149dfdf4b984eb5b0", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8114 unit tests for RedbeamsDbCertificateProvider.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b1e5dcef548f112a2ee573e6baf5434dc3ed1a2", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/1b1e5dcef548f112a2ee573e6baf5434dc3ed1a2", "committedDate": "2020-10-28T10:50:43Z", "message": "CB-8789 Configure DB TLS for DL cluster services & DH HMS\n\n* Persist DB SSL status in RDSConfig\n  * Currently populated for external DBs only\n* Return DB SSL status in RDSDetails\n* Additions to RdsView:\n  * DB SSL status\n  * SSL certificate file path; empty when not using SSL\n  * ConnectionURL extended wit SSL options as necessary\n* Add new compile dependency to\n  template-manager-cmtemplate/build.gradle:\n  org.apache.commons:commons-text:1.5\n* Inject DB SSL configs for HMS and Ranger Admin\n* Honor custom HMS DB settings in cluster template\n* Add new unit tests and migrate existing ones to JUnit 5 & AssertJ"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "740ef72b79c971ebf1c2bf25a823d62e857ded4e", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/740ef72b79c971ebf1c2bf25a823d62e857ded4e", "committedDate": "2020-10-28T10:50:44Z", "message": "CB-9434 CB-9437 Entitlement check for DB TLS\n\n* Apply DL external DB SSL enforcement only if entitlement\n  CDP_CB_DATABASE_WIRE_ENCRYPTION has been granted.\n* The presence of CDP_CB_DATABASE_WIRE_ENCRYPTION in\n  MockUserManagementService.getAccount() is conditional, depending on\n  the app system property auth.mock.database.wire.encryption.enable .\n* Minor Redbeams SSL API cleanup: SslConfigurationV4Request renamed to\n  SslConfigV4Request, AllocateDatabaseServerV4Request.sslConfiguration\n  renamed to sslConfig, correct field / type descriptions.\n* Add & enhance unit tests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b849d68d8df8f989cf371846294117ac09db03f", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0b849d68d8df8f989cf371846294117ac09db03f", "committedDate": "2020-10-28T00:06:55Z", "message": "CB-9434 CB-9437 Entitlement check for DB TLS\n\n* Apply DL external DB SSL enforcement only if entitlement\n  CDP_CB_DATABASE_WIRE_ENCRYPTION has been granted.\n* The presence of CDP_CB_DATABASE_WIRE_ENCRYPTION in\n  MockUserManagementService.getAccount() is conditional, depending on\n  the app system property auth.mock.database.wire.encryption.enable .\n* Minor Redbeams SSL API cleanup: SslConfigurationV4Request renamed to\n  SslConfigV4Request, AllocateDatabaseServerV4Request.sslConfiguration\n  renamed to sslConfig, correct field / type descriptions.\n* Add & enhance unit tests."}, "afterCommit": {"oid": "740ef72b79c971ebf1c2bf25a823d62e857ded4e", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/740ef72b79c971ebf1c2bf25a823d62e857ded4e", "committedDate": "2020-10-28T10:50:44Z", "message": "CB-9434 CB-9437 Entitlement check for DB TLS\n\n* Apply DL external DB SSL enforcement only if entitlement\n  CDP_CB_DATABASE_WIRE_ENCRYPTION has been granted.\n* The presence of CDP_CB_DATABASE_WIRE_ENCRYPTION in\n  MockUserManagementService.getAccount() is conditional, depending on\n  the app system property auth.mock.database.wire.encryption.enable .\n* Minor Redbeams SSL API cleanup: SslConfigurationV4Request renamed to\n  SslConfigV4Request, AllocateDatabaseServerV4Request.sslConfiguration\n  renamed to sslConfig, correct field / type descriptions.\n* Add & enhance unit tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MDA1NTYx", "url": "https://github.com/hortonworks/cloudbreak/pull/9215#pullrequestreview-519005561", "createdAt": "2020-10-28T19:17:07Z", "commit": {"oid": "740ef72b79c971ebf1c2bf25a823d62e857ded4e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2169, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}