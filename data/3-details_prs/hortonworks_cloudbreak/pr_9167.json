{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NTU2NTI5", "number": 9167, "title": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries", "bodyText": "We accept the subnet name from the user for GCP.\nWhen we fetch the subnet information back from GCP, it gives the internal subnet id.\nSo make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\nWe saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n    $ ipa dnszone-find\n      Zone name: 114.10.in-addr.arpa.\n      Active zone: TRUE\n      Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n      Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n      SOA serial: 1602118320\n      SOA refresh: 3600\n      SOA retry: 900\n      SOA expire: 1209600\n      SOA minimum: 3600\n      Allow query: any;\n      Allow transfer: none;\n    \n      Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n      Active zone: TRUE\n      Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n      Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n      SOA serial: 1602118320\n      SOA refresh: 3600\n      SOA retry: 900\n      SOA expire: 1209600\n      SOA minimum: 3600\n      Allow query: any;\n      Allow transfer: none;\n    ----------------------------\n    Number of entries returned 2\n    ----------------------------", "createdAt": "2020-10-07T22:44:50Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9167", "merged": true, "mergeCommit": {"oid": "3fcf83f6491e48a9563a72193b0ad62b04ac96ec"}, "closed": true, "closedAt": "2020-10-10T05:13:10Z", "author": {"login": "cegganesh84"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQcFlgAFqTUwNDQ3NzgzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQ9nvBAFqTUwNjAxMTc2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDc3ODM2", "url": "https://github.com/hortonworks/cloudbreak/pull/9167#pullrequestreview-504477836", "createdAt": "2020-10-08T06:58:27Z", "commit": {"oid": "f5aa03fefa9f80d84f7d1697ffa28475af7ad917"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNjo1ODoyN1rOHeQdMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNjo1ODoyN1rOHeQdMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQ4ODk0NA==", "bodyText": "please remove these 2 comments, your commit message should be enough to identify why it's there", "url": "https://github.com/hortonworks/cloudbreak/pull/9167#discussion_r501488944", "createdAt": "2020-10-08T06:58:27Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/service/stack/NetworkService.java", "diffHunk": "@@ -57,11 +57,13 @@\n                     // support for azure\n                     String[] splittedNetworkId = cloudNetwork.getId().split(\"/\");\n                     String cloudNetworkId = splittedNetworkId[splittedNetworkId.length - 1];\n-                    return networkId.equals(cloudNetworkId);\n+                    // CB-9180 For GCP user can pass network name as id", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5aa03fefa9f80d84f7d1697ffa28475af7ad917"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f5aa03fefa9f80d84f7d1697ffa28475af7ad917", "author": {"user": null}, "url": "https://github.com/hortonworks/cloudbreak/commit/f5aa03fefa9f80d84f7d1697ffa28475af7ad917", "committedDate": "2020-10-08T01:05:46Z", "message": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries\n\n1. We accept the subnet name from the user for GCP.\n2. When we fetch the subnet information back from GCP, it gives internal subnet id.\n3. So make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\n4. We saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n\n```\n$ ipa dnszone-find\n  Zone name: 114.10.in-addr.arpa.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n\n  Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n----------------------------\nNumber of entries returned 2\n----------------------------\n```"}, "afterCommit": {"oid": "433ca87ad196c0081ad6253b9c3c0e34678d9569", "author": {"user": null}, "url": "https://github.com/hortonworks/cloudbreak/commit/433ca87ad196c0081ad6253b9c3c0e34678d9569", "committedDate": "2020-10-09T17:26:48Z", "message": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries\n\n1. We accept the subnet name from the user for GCP.\n2. When we fetch the subnet information back from GCP, it gives internal subnet id.\n3. So make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\n4. We saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n\n```\n$ ipa dnszone-find\n  Zone name: 114.10.in-addr.arpa.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n\n  Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n----------------------------\nNumber of entries returned 2\n----------------------------\n```"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4623418856b3d6fdd24f6e3925213275f00be86", "author": {"user": null}, "url": "https://github.com/hortonworks/cloudbreak/commit/b4623418856b3d6fdd24f6e3925213275f00be86", "committedDate": "2020-10-09T17:33:45Z", "message": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries\n\n1. We accept the subnet name from the user for GCP.\n2. When we fetch the subnet information back from GCP, it gives internal subnet id.\n3. So make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\n4. We saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n\n```\n$ ipa dnszone-find\n  Zone name: 114.10.in-addr.arpa.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n\n  Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n----------------------------\nNumber of entries returned 2\n----------------------------\n```"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "433ca87ad196c0081ad6253b9c3c0e34678d9569", "author": {"user": null}, "url": "https://github.com/hortonworks/cloudbreak/commit/433ca87ad196c0081ad6253b9c3c0e34678d9569", "committedDate": "2020-10-09T17:26:48Z", "message": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries\n\n1. We accept the subnet name from the user for GCP.\n2. When we fetch the subnet information back from GCP, it gives internal subnet id.\n3. So make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\n4. We saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n\n```\n$ ipa dnszone-find\n  Zone name: 114.10.in-addr.arpa.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n\n  Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n----------------------------\nNumber of entries returned 2\n----------------------------\n```"}, "afterCommit": {"oid": "b4623418856b3d6fdd24f6e3925213275f00be86", "author": {"user": null}, "url": "https://github.com/hortonworks/cloudbreak/commit/b4623418856b3d6fdd24f6e3925213275f00be86", "committedDate": "2020-10-09T17:33:45Z", "message": "CB-9180 Freeipa install in GCP does not populate reverse DNS entries\n\n1. We accept the subnet name from the user for GCP.\n2. When we fetch the subnet information back from GCP, it gives internal subnet id.\n3. So make the subnet filtering logic in NetworkService similar to CloudNetworkService https://github.com/hortonworks/cloudbreak/blob/master/environment/src/main/java/com/sequenceiq/environment/network/CloudNetworkService.java#L130\n4. We saw that the jinja2 template picked the next argument as the reverse zone value if the zones is an empty list, fixed that part also.\n\nTested in private stack\n\n```\n$ ipa dnszone-find\n  Zone name: 114.10.in-addr.arpa.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n\n  Zone name: demo5.r6zv-kv2u.dev.cldr.work.\n  Active zone: TRUE\n  Authoritative nameserver: ipaserver0.demo5.r6zv-kv2u.dev.cldr.work.\n  Administrator e-mail address: hostmaster.demo5.r6zv-kv2u.dev.cldr.work.\n  SOA serial: 1602118320\n  SOA refresh: 3600\n  SOA retry: 900\n  SOA expire: 1209600\n  SOA minimum: 3600\n  Allow query: any;\n  Allow transfer: none;\n----------------------------\nNumber of entries returned 2\n----------------------------\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDExNzYy", "url": "https://github.com/hortonworks/cloudbreak/pull/9167#pullrequestreview-506011762", "createdAt": "2020-10-09T22:07:38Z", "commit": {"oid": "b4623418856b3d6fdd24f6e3925213275f00be86"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2119, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}