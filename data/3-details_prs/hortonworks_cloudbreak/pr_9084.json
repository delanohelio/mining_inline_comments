{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNDk1NjQy", "number": 9084, "title": "CB-8970 entitlement based upscale and downscale on specific services.\u2026", "bodyText": "\u2026 We need to request new ums entitlements as well for this feature to use. Mostly for nifi team to use but I prepared for streaming and other scenarios as well.\nSee detailed description in the commit message.", "createdAt": "2020-09-24T14:38:57Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9084", "merged": true, "mergeCommit": {"oid": "da3102df38cc556cbcc3a1e1f76a25e201a19e4b"}, "closed": true, "closedAt": "2020-09-28T06:26:41Z", "author": {"login": "doktoric"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMCLn9AH2gAyNDkyNDk1NjQyOjg1MWRmZWY1YjM1ZjAxYWJkNWFmYzhlM2ZkMTdjMGY1ODEzMmQwMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMS4VagFqTQ5NjI4NDc1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/851dfef5b35f01abd5afc8e3fd17c0f58132d02a", "committedDate": "2020-09-24T14:36:50Z", "message": "CB-8970 entitlement based upscale and downscale on specific services. We need to request new ums entitlements as well for this feature to use. Mostly for nifi team to use but I prepared for streaming and other scenarios as well."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1OTE0ODI5", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#pullrequestreview-495914829", "createdAt": "2020-09-24T20:10:16Z", "commit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxMDoxNlrOHXq5Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoxNDoyOVrOHXrBiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4MjA3OA==", "bodyText": "Shouldn't the DATAHUB_DEFAULT_SCALING should also be added here?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494582078", "createdAt": "2020-09-24T20:10:16Z", "author": {"login": "biharitomi"}, "path": "mock-thunderhead/src/main/java/com/sequenceiq/thunderhead/grpc/service/auth/MockUserManagementService.java", "diffHunk": "@@ -594,6 +598,8 @@ public void getAccount(GetAccountRequest request, StreamObserver<GetAccountRespo\n                                 .addEntitlements(createEntitlement(DATAHUB_AZURE_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(DATAHUB_AWS_AUTOSCALING))\n                                 .addEntitlements(createEntitlement(LOCAL_DEV))\n+                                .addEntitlements(createEntitlement(DATAHUB_FLOW_SCALING))\n+                                .addEntitlements(createEntitlement(DATAHUB_STREAMING_SCALING))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDEwNg==", "bodyText": "Shouldn't we gather and check the user who initiated this scaling operation?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494584106", "createdAt": "2020-09-24T20:14:21Z", "author": {"login": "biharitomi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/ClusterCommonService.java", "diffHunk": "@@ -127,7 +129,14 @@ private FlowIdentifier clusterHostgroupAdjustmentChange(Long stackId, UpdateClus\n                     updateJson.getHostGroupAdjustment().getHostGroup(), stack.getName()));\n         }\n         if (blueprintService.isClouderaManagerTemplate(blueprint)) {\n-            cmTemplateValidator.validateHostGroupScalingRequest(blueprint, hostGroup.get(),\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDIwMA==", "bodyText": "Shouldn't we gather and check the user who initiated this scaling operation?", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#discussion_r494584200", "createdAt": "2020-09-24T20:14:29Z", "author": {"login": "biharitomi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/stack/flow/UpdateNodeCountValidator.java", "diffHunk": "@@ -80,7 +81,12 @@ public void validateServiceRoles(Stack stack, InstanceGroupAdjustmentV4Request i\n                 .filter(e -> e.getName().equals(instanceGroup))\n                 .findFirst();\n         if (hostGroup.isPresent()) {\n+            User creator = stack.getCreator();\n+            String userCrn = creator.getUserCrn();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2Mjg0NzUz", "url": "https://github.com/hortonworks/cloudbreak/pull/9084#pullrequestreview-496284753", "createdAt": "2020-09-25T10:04:09Z", "commit": {"oid": "851dfef5b35f01abd5afc8e3fd17c0f58132d02a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2245, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}