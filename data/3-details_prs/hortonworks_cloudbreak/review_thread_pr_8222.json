{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4Mzk3MTY1", "number": 8222, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMjowNDo1M1rOEC7c1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNTo0MzozMVrOEDAXtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNTA2NjQ3OnYy", "diffSide": "RIGHT", "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMjowNDo1M1rOGfryBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMjowNDo1M1rOGfryBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg3NjM1Nw==", "bodyText": "We should not log the last message if it is null", "url": "https://github.com/hortonworks/cloudbreak/pull/8222#discussion_r435876357", "createdAt": "2020-06-05T12:04:53Z", "author": {"login": "keyki"}, "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "diffHunk": "@@ -157,9 +157,9 @@ private Boolean checkResult(Boolean success, int retryCount, Exception actualExc\n             nodesWithErrors = ((CloudbreakOrchestratorException) actualException).getNodesWithErrors();\n         }\n         if (retryCount >= maxRetryCount) {\n-            throw new CloudbreakOrchestratorTimeoutException(cause, nodesWithErrors, elapsedTimeRounded);\n+            throw new CloudbreakOrchestratorTimeoutException(errorMessage, nodesWithErrors, elapsedTimeRounded);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89d4ace4312983fa11227e8cdb90794a44efe4ea"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNTg3MjUyOnYy", "diffSide": "RIGHT", "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNTo0MzozMVrOGfzvHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNTo1ODoyM1rOGf0QPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAwNjY4Nw==", "bodyText": "What happens if the template requires 1 param when the actualException is null, but we pass 2 params with the cause to String.format?", "url": "https://github.com/hortonworks/cloudbreak/pull/8222#discussion_r436006687", "createdAt": "2020-06-05T15:43:31Z", "author": {"login": "keyki"}, "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "diffHunk": "@@ -143,23 +143,28 @@ private Boolean checkResult(Boolean success, int retryCount, Exception actualExc\n         }\n \n         String cause = null;\n+        String messageTemplate;\n+        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         if (actualException != null) {\n             cause = actualException.getMessage();\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n+        } else {\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s)\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s)\";\n         }\n-        String messageTemplate = success == null\n-                ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n-                : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n-        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         String errorMessage = String.format(messageTemplate, elapsedTimeRounded, cause);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63be897e0dece2e7abaf23635ff15f3bc4526687"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAxMjU4Nw==", "bodyText": "According to the Java Doc: If there are more arguments than format specifiers, the extra arguments are ignored.", "url": "https://github.com/hortonworks/cloudbreak/pull/8222#discussion_r436012587", "createdAt": "2020-06-05T15:53:55Z", "author": {"login": "tiborpopovics"}, "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "diffHunk": "@@ -143,23 +143,28 @@ private Boolean checkResult(Boolean success, int retryCount, Exception actualExc\n         }\n \n         String cause = null;\n+        String messageTemplate;\n+        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         if (actualException != null) {\n             cause = actualException.getMessage();\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n+        } else {\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s)\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s)\";\n         }\n-        String messageTemplate = success == null\n-                ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n-                : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n-        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         String errorMessage = String.format(messageTemplate, elapsedTimeRounded, cause);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAwNjY4Nw=="}, "originalCommit": {"oid": "63be897e0dece2e7abaf23635ff15f3bc4526687"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAxNTE2Nw==", "bodyText": "Cool.", "url": "https://github.com/hortonworks/cloudbreak/pull/8222#discussion_r436015167", "createdAt": "2020-06-05T15:58:23Z", "author": {"login": "keyki"}, "path": "orchestrator-api/src/main/java/com/sequenceiq/cloudbreak/orchestrator/OrchestratorBootstrapRunner.java", "diffHunk": "@@ -143,23 +143,28 @@ private Boolean checkResult(Boolean success, int retryCount, Exception actualExc\n         }\n \n         String cause = null;\n+        String messageTemplate;\n+        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         if (actualException != null) {\n             cause = actualException.getMessage();\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n+        } else {\n+            messageTemplate = success == null\n+                    ? \"Timeout: Orchestrator component failed to finish in %d min(s)\"\n+                    : \"Failed: Orchestrator component went failed in %d min(s)\";\n         }\n-        String messageTemplate = success == null\n-                ? \"Timeout: Orchestrator component failed to finish in %d min(s), last message: %s\"\n-                : \"Failed: Orchestrator component went failed in %d min(s), message: %s\";\n-        long elapsedTimeRounded = Math.max(Math.round((double) retryCount * SLEEP_TIME / MS_IN_SEC / SEC_IN_MIN), MINIMUM_DISPLAYED_TIME_IN_MIN);\n         String errorMessage = String.format(messageTemplate, elapsedTimeRounded, cause);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjAwNjY4Nw=="}, "originalCommit": {"oid": "63be897e0dece2e7abaf23635ff15f3bc4526687"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3293, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}