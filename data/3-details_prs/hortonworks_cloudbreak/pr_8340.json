{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MDIzODgy", "number": 8340, "title": "CB-7365 Extract magic string literals in AwsInstanceView", "bodyText": "Extract AWS magic strings as constants in the new class AwsInstanceTemplate in cloud-api\n\nThe similar magic strings used for Azure & GCP encryption scenarios have not been touched. The only exceptions are the strings \"type\" and \"key\" that are common to AWS & GCP (and might be used later for Azure as well for customer-managed encryption keys); these have been added as constants to the superclass InstanceTemplate.\n\n\nReplace raw strings (\"NONE\", \"DEFAULT\", \"CUSTOM\") with EncryptionType enum constant names", "createdAt": "2020-06-19T10:32:37Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8340", "merged": true, "mergeCommit": {"oid": "707bfa57f8aa818bd7368abc27f384b3966e22b2"}, "closed": true, "closedAt": "2020-06-22T21:37:32Z", "author": {"login": "lajosrodek"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctqAk5gFqTQzNDYxMjE2OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABct0gBjgBqjM0Njk1MDI3NzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjEyMTY5", "url": "https://github.com/hortonworks/cloudbreak/pull/8340#pullrequestreview-434612169", "createdAt": "2020-06-22T05:29:12Z", "commit": {"oid": "27e40e8db17b425e50b26dc5a4422b135084bc9d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNToyOToxM1rOGmyXJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNToyOToxM1rOGmyXJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNDE5OQ==", "bodyText": "As it is used in case of GCP we could move this constant one layer upper to the provider generic InstanceTemplate class.", "url": "https://github.com/hortonworks/cloudbreak/pull/8340#discussion_r443324199", "createdAt": "2020-06-22T05:29:13Z", "author": {"login": "biharitomi"}, "path": "cloud-api/src/main/java/com/sequenceiq/cloudbreak/cloud/model/instance/AwsInstanceTemplate.java", "diffHunk": "@@ -0,0 +1,90 @@\n+package com.sequenceiq.cloudbreak.cloud.model.instance;\n+\n+import java.util.Collection;\n+import java.util.Map;\n+\n+import com.sequenceiq.cloudbreak.cloud.model.InstanceStatus;\n+import com.sequenceiq.cloudbreak.cloud.model.InstanceTemplate;\n+import com.sequenceiq.cloudbreak.cloud.model.Volume;\n+import com.sequenceiq.common.api.type.EncryptionType;\n+\n+public class AwsInstanceTemplate extends InstanceTemplate {\n+\n+    /**\n+     * Key of the optional dynamic parameter denoting whether EBS encryption is enabled or not. This applies to both root & attached (data) volumes.\n+     *\n+     * <p>\n+     *     Permitted values:\n+     *     <ul>\n+     *         <li>{@code Boolean.TRUE} instance, {@code \"true\"} (ignoring case): Encryption is enabled.</li>\n+     *         <li>{@code Boolean.FALSE} instance, {@code \"false\"} (or any other {@code String} not equal to {@code \"true\"} ignoring case), {@code null}:\n+     *         Encryption is disabled.</li>\n+     *     </ul>\n+     * </p>\n+     *\n+     * @see #putParameter(String, Object)\n+     * @see Boolean#parseBoolean(String)\n+     */\n+    public static final String EBS_ENCRYPTION_ENABLED = \"encrypted\";\n+\n+    /**\n+     * Key of the optional dynamic parameter denoting the type of AWS KMS encryption key to use for EBS encryption. Relevant only when encryption has been\n+     * enabled via parameter {@link #EBS_ENCRYPTION_ENABLED}.\n+     *\n+     * <p>\n+     *     Permitted values are the names of enum constants in {@link EncryptionType}:\n+     *     <ul>\n+     *         <li>{@code \"NONE\"}, {@code null}: No KMS key. Since EBS encryption always needs some KMS key, this setting essentially disables encryption.</li>\n+     *         <li>{@code \"DEFAULT\"}: Use the <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#EBSEncryption_key_mgmt\">default\n+     *         key for EBS encryption</a> in the target Region. This can actually point to the AWS-managed KMS key with alias {@code alias/aws/ebs}, or\n+     *         some customer-managed symmetric KMS key.</li>\n+     *         <li>{@code \"CUSTOM\"}: Use the customer-managed symmetric KMS key specified in {@link #EBS_ENCRYPTION_KMS_KEY_ARN}.</li>\n+     *     </ul>\n+     * </p>\n+     *\n+     * @see #EBS_ENCRYPTION_ENABLED\n+     * @see #EBS_ENCRYPTION_KMS_KEY_ARN\n+     * @see #putParameter(String, Object)\n+     * @see EncryptionType\n+     */\n+    public static final String EBS_ENCRYPTION_KMS_KEY_TYPE = \"type\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27e40e8db17b425e50b26dc5a4422b135084bc9d"}, "originalPosition": 50}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "27e40e8db17b425e50b26dc5a4422b135084bc9d", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/27e40e8db17b425e50b26dc5a4422b135084bc9d", "committedDate": "2020-06-19T10:25:32Z", "message": "CB-7365 Extract magic string literals in AwsInstanceView\n\nAlso replace raw strings with EncryptionType enum constant names"}, "afterCommit": {"oid": "839362c278eee5e3e8daa4f484a8f9f5b29922b2", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/839362c278eee5e3e8daa4f484a8f9f5b29922b2", "committedDate": "2020-06-22T14:19:49Z", "message": "CB-7365 Extract magic string literals in AwsInstanceView\n\nAlso replace raw strings with EncryptionType enum constant names.\n\nSquashed commits:\n\nCB-7365 Move EBS_ENCRYPTION_KMS_KEY_TYPE and EBS_ENCRYPTION_KMS_KEY_ARN\n        to superclass InstanceTemplate, renaming them to\n        VOLUME_ENCRYPTION_KEY_TYPE and VOLUME_ENCRYPTION_KEY_ID,\n        respectively. Replace occurrences of these magic strings in GCP\n        classes & tests as well."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0OTk0NjQ2", "url": "https://github.com/hortonworks/cloudbreak/pull/8340#pullrequestreview-434994646", "createdAt": "2020-06-22T14:44:24Z", "commit": {"oid": "839362c278eee5e3e8daa4f484a8f9f5b29922b2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51786faa3d45581e23e69e515ed3d4d61173fd0c", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/51786faa3d45581e23e69e515ed3d4d61173fd0c", "committedDate": "2020-06-22T17:41:49Z", "message": "CB-7365 Extract magic string literals in AwsInstanceView\n\nAlso replace raw strings with EncryptionType enum constant names.\n\nSquashed commits:\n\nCB-7365 Move EBS_ENCRYPTION_KMS_KEY_TYPE and EBS_ENCRYPTION_KMS_KEY_ARN\n        to superclass InstanceTemplate, renaming them to\n        VOLUME_ENCRYPTION_KEY_TYPE and VOLUME_ENCRYPTION_KEY_ID,\n        respectively. Replace occurrences of these magic strings in GCP\n        classes & tests as well."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "839362c278eee5e3e8daa4f484a8f9f5b29922b2", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/839362c278eee5e3e8daa4f484a8f9f5b29922b2", "committedDate": "2020-06-22T14:19:49Z", "message": "CB-7365 Extract magic string literals in AwsInstanceView\n\nAlso replace raw strings with EncryptionType enum constant names.\n\nSquashed commits:\n\nCB-7365 Move EBS_ENCRYPTION_KMS_KEY_TYPE and EBS_ENCRYPTION_KMS_KEY_ARN\n        to superclass InstanceTemplate, renaming them to\n        VOLUME_ENCRYPTION_KEY_TYPE and VOLUME_ENCRYPTION_KEY_ID,\n        respectively. Replace occurrences of these magic strings in GCP\n        classes & tests as well."}, "afterCommit": {"oid": "51786faa3d45581e23e69e515ed3d4d61173fd0c", "author": {"user": {"login": "lajosrodek", "name": "Lajos Rodek"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/51786faa3d45581e23e69e515ed3d4d61173fd0c", "committedDate": "2020-06-22T17:41:49Z", "message": "CB-7365 Extract magic string literals in AwsInstanceView\n\nAlso replace raw strings with EncryptionType enum constant names.\n\nSquashed commits:\n\nCB-7365 Move EBS_ENCRYPTION_KMS_KEY_TYPE and EBS_ENCRYPTION_KMS_KEY_ARN\n        to superclass InstanceTemplate, renaming them to\n        VOLUME_ENCRYPTION_KEY_TYPE and VOLUME_ENCRYPTION_KEY_ID,\n        respectively. Replace occurrences of these magic strings in GCP\n        classes & tests as well."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1746, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}