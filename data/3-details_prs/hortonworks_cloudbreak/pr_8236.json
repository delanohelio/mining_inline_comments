{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMTE1MzU0", "number": 8236, "title": "CB-7105 Add resource based Auth for Redbeams api", "bodyText": "", "createdAt": "2020-06-08T12:54:37Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8236", "merged": true, "mergeCommit": {"oid": "6f72f654f21b1638dcb04c746f8fe12ae2f73fc7"}, "closed": true, "closedAt": "2020-06-12T09:37:51Z", "author": {"login": "horadla23"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpQKZigBqjM0MTk5NTg4NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqfL8KAFqTQyOTU4NDcyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "908806af3974b18b29fd740b50f00ae69c553b95", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/908806af3974b18b29fd740b50f00ae69c553b95", "committedDate": "2020-06-08T12:54:09Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "8198a4633cbfd858557a6d52c9e96550d42e8378", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8198a4633cbfd858557a6d52c9e96550d42e8378", "committedDate": "2020-06-08T13:06:10Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8198a4633cbfd858557a6d52c9e96550d42e8378", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8198a4633cbfd858557a6d52c9e96550d42e8378", "committedDate": "2020-06-08T13:06:10Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "163dde1f1716c7d9e34f7fb673861b635b518151", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/163dde1f1716c7d9e34f7fb673861b635b518151", "committedDate": "2020-06-08T13:11:38Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "163dde1f1716c7d9e34f7fb673861b635b518151", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/163dde1f1716c7d9e34f7fb673861b635b518151", "committedDate": "2020-06-08T13:11:38Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "0b04a76387b63fd297d65e1068b985f65199ed2b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0b04a76387b63fd297d65e1068b985f65199ed2b", "committedDate": "2020-06-10T09:49:11Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b04a76387b63fd297d65e1068b985f65199ed2b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0b04a76387b63fd297d65e1068b985f65199ed2b", "committedDate": "2020-06-10T09:49:11Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "f727e818d1cf82262b0ba377eec7617ad9d1a461", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f727e818d1cf82262b0ba377eec7617ad9d1a461", "committedDate": "2020-06-10T10:14:43Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f727e818d1cf82262b0ba377eec7617ad9d1a461", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/f727e818d1cf82262b0ba377eec7617ad9d1a461", "committedDate": "2020-06-10T10:14:43Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "36c49527333e43e3a98bbf5da2baabfaf1a9e631", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/36c49527333e43e3a98bbf5da2baabfaf1a9e631", "committedDate": "2020-06-10T10:48:28Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36c49527333e43e3a98bbf5da2baabfaf1a9e631", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/36c49527333e43e3a98bbf5da2baabfaf1a9e631", "committedDate": "2020-06-10T10:48:28Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "aa6d77e3ea67616d7ed5454ccea68812d79ae987", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/aa6d77e3ea67616d7ed5454ccea68812d79ae987", "committedDate": "2020-06-11T11:19:01Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa6d77e3ea67616d7ed5454ccea68812d79ae987", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/aa6d77e3ea67616d7ed5454ccea68812d79ae987", "committedDate": "2020-06-11T11:19:01Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "5fac5e7c44263549b4085455ddbf44d8e04f347e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5fac5e7c44263549b4085455ddbf44d8e04f347e", "committedDate": "2020-06-11T11:23:22Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fac5e7c44263549b4085455ddbf44d8e04f347e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5fac5e7c44263549b4085455ddbf44d8e04f347e", "committedDate": "2020-06-11T11:23:22Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "c43fd351306820c3e51dc19dda505537b7177819", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c43fd351306820c3e51dc19dda505537b7177819", "committedDate": "2020-06-11T11:44:27Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c43fd351306820c3e51dc19dda505537b7177819", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c43fd351306820c3e51dc19dda505537b7177819", "committedDate": "2020-06-11T11:44:27Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "8244a662829cbb6264b00b82a3d4f7243db7269f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8244a662829cbb6264b00b82a3d4f7243db7269f", "committedDate": "2020-06-11T11:45:45Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8244a662829cbb6264b00b82a3d4f7243db7269f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8244a662829cbb6264b00b82a3d4f7243db7269f", "committedDate": "2020-06-11T11:45:45Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3", "committedDate": "2020-06-11T12:54:43Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTE1MDA2", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#pullrequestreview-429515006", "createdAt": "2020-06-12T07:18:47Z", "commit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzoxODo0N1rOGi5ruQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzoxOTo0NFrOGi5tMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI0OTg0OQ==", "bodyText": "Can you get just the crn from the database?", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#discussion_r439249849", "createdAt": "2020-06-12T07:18:47Z", "author": {"login": "foldik"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/service/dbconfig/DatabaseConfigService.java", "diffHunk": "@@ -271,4 +280,25 @@ public Long getResourceIdByResourceCrn(String resourceCrn) {\n     public Long getResourceIdByResourceName(String resourceName) {\n         return getByName(resourceName).getId();\n     }\n+\n+    @Override\n+    public AuthorizationResourceType getResourceType() {\n+        return AuthorizationResourceType.DATABASE;\n+    }\n+\n+    @Override\n+    public String getResourceCrnByResourceName(String resourceName) {\n+        return getByName(resourceName).getResourceCrn().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3"}, "originalPosition": 102}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI0OTk4Nw==", "bodyText": "Can you get just the crns from the database?", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#discussion_r439249987", "createdAt": "2020-06-12T07:19:09Z", "author": {"login": "foldik"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/service/dbconfig/DatabaseConfigService.java", "diffHunk": "@@ -271,4 +280,25 @@ public Long getResourceIdByResourceCrn(String resourceCrn) {\n     public Long getResourceIdByResourceName(String resourceName) {\n         return getByName(resourceName).getId();\n     }\n+\n+    @Override\n+    public AuthorizationResourceType getResourceType() {\n+        return AuthorizationResourceType.DATABASE;\n+    }\n+\n+    @Override\n+    public String getResourceCrnByResourceName(String resourceName) {\n+        return getByName(resourceName).getResourceCrn().toString();\n+    }\n+\n+    @Override\n+    public List<String> getResourceCrnListByResourceNameList(List<String> resourceNames) {\n+        return repository.findByNameIn(resourceNames).stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MDE2Nw==", "bodyText": "Can you get just the crn from the database?", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#discussion_r439250167", "createdAt": "2020-06-12T07:19:33Z", "author": {"login": "foldik"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/service/dbserverconfig/DatabaseServerConfigService.java", "diffHunk": "@@ -320,6 +325,22 @@ boolean validateDatabaseName(String databaseName) {\n \n     @Override\n     public AuthorizationResourceType getResourceType() {\n-        return AuthorizationResourceType.DATALAKE;\n+        return AuthorizationResourceType.DATABASE_SERVER;\n+    }\n+\n+    @Override\n+    public String getResourceCrnByResourceName(String resourceName) {\n+        return repository.findByName(resourceName).get().getResourceCrn().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MDIyNw==", "bodyText": "Can you get just the crns from the database?", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#discussion_r439250227", "createdAt": "2020-06-12T07:19:44Z", "author": {"login": "foldik"}, "path": "redbeams/src/main/java/com/sequenceiq/redbeams/service/dbserverconfig/DatabaseServerConfigService.java", "diffHunk": "@@ -320,6 +325,22 @@ boolean validateDatabaseName(String databaseName) {\n \n     @Override\n     public AuthorizationResourceType getResourceType() {\n-        return AuthorizationResourceType.DATALAKE;\n+        return AuthorizationResourceType.DATABASE_SERVER;\n+    }\n+\n+    @Override\n+    public String getResourceCrnByResourceName(String resourceName) {\n+        return repository.findByName(resourceName).get().getResourceCrn().toString();\n+    }\n+\n+    @Override\n+    public List<String> getResourceCrnListByResourceNameList(List<String> resourceNames) {\n+        return repository.findByNameIn(resourceNames).stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3"}, "originalPosition": 89}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0b4cbdd13fd11efd7b7fc0137f27af3fa47c4ba3", "committedDate": "2020-06-11T12:54:43Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "390c12aecdd4e6a73f8d2cf23a0c5a245c16ad93", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/390c12aecdd4e6a73f8d2cf23a0c5a245c16ad93", "committedDate": "2020-06-12T07:55:38Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTQwODQ4", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#pullrequestreview-429540848", "createdAt": "2020-06-12T08:03:25Z", "commit": {"oid": "390c12aecdd4e6a73f8d2cf23a0c5a245c16ad93"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "074b5389de948eabe9590e0006bfce0240b6c367", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/074b5389de948eabe9590e0006bfce0240b6c367", "committedDate": "2020-06-12T08:42:09Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "390c12aecdd4e6a73f8d2cf23a0c5a245c16ad93", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/390c12aecdd4e6a73f8d2cf23a0c5a245c16ad93", "committedDate": "2020-06-12T07:55:38Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}, "afterCommit": {"oid": "074b5389de948eabe9590e0006bfce0240b6c367", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/074b5389de948eabe9590e0006bfce0240b6c367", "committedDate": "2020-06-12T08:42:09Z", "message": "CB-7105 Add resource based Auth for Redbeams api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTg0NzI5", "url": "https://github.com/hortonworks/cloudbreak/pull/8236#pullrequestreview-429584729", "createdAt": "2020-06-12T09:11:00Z", "commit": {"oid": "074b5389de948eabe9590e0006bfce0240b6c367"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1822, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}