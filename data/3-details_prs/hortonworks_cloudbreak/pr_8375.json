{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NDQ3ODkw", "number": 8375, "title": "CB-7615 Add resource based authz for recipes", "bodyText": "", "createdAt": "2020-06-23T09:38:20Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8375", "merged": true, "mergeCommit": {"oid": "86ca5307e700baadbfba48731ecfcf6dec3dc521"}, "closed": true, "closedAt": "2020-06-24T15:30:40Z", "author": {"login": "horadla23"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuCXAKABqjM0NzIxMjAxNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcubNvxgFqTQzNjcyMzM3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fc7961d08852243b48e8adcae9041aa4bb4d7bb", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9fc7961d08852243b48e8adcae9041aa4bb4d7bb", "committedDate": "2020-06-23T09:37:13Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "3e643e2dcb02befe61c0a5d9210d48bb7cd2ae0f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/3e643e2dcb02befe61c0a5d9210d48bb7cd2ae0f", "committedDate": "2020-06-23T09:50:58Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e643e2dcb02befe61c0a5d9210d48bb7cd2ae0f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/3e643e2dcb02befe61c0a5d9210d48bb7cd2ae0f", "committedDate": "2020-06-23T09:50:58Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "deb1a8bc8b63122039b23b96582150b801f9322d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/deb1a8bc8b63122039b23b96582150b801f9322d", "committedDate": "2020-06-23T13:38:18Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "deb1a8bc8b63122039b23b96582150b801f9322d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/deb1a8bc8b63122039b23b96582150b801f9322d", "committedDate": "2020-06-23T13:38:18Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "a06d3ec2a039e9439a6e09e0b9a947243e47668e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a06d3ec2a039e9439a6e09e0b9a947243e47668e", "committedDate": "2020-06-23T14:02:58Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a06d3ec2a039e9439a6e09e0b9a947243e47668e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a06d3ec2a039e9439a6e09e0b9a947243e47668e", "committedDate": "2020-06-23T14:02:58Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "16d4d897da1a3364ca988759810ad4e9357c244b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/16d4d897da1a3364ca988759810ad4e9357c244b", "committedDate": "2020-06-23T14:11:20Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16d4d897da1a3364ca988759810ad4e9357c244b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/16d4d897da1a3364ca988759810ad4e9357c244b", "committedDate": "2020-06-23T14:11:20Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "73308c3c56a2b2c76844e12cd923a739c2ae4f88", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/73308c3c56a2b2c76844e12cd923a739c2ae4f88", "committedDate": "2020-06-23T14:20:58Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73308c3c56a2b2c76844e12cd923a739c2ae4f88", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/73308c3c56a2b2c76844e12cd923a739c2ae4f88", "committedDate": "2020-06-23T14:20:58Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "2a2216d8994896eb02122b23ba20d231013c9658", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a2216d8994896eb02122b23ba20d231013c9658", "committedDate": "2020-06-23T14:33:01Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a2216d8994896eb02122b23ba20d231013c9658", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2a2216d8994896eb02122b23ba20d231013c9658", "committedDate": "2020-06-23T14:33:01Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "9824e8ea7f1001b3e45eb7fd425983696908a49e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9824e8ea7f1001b3e45eb7fd425983696908a49e", "committedDate": "2020-06-23T15:34:13Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9824e8ea7f1001b3e45eb7fd425983696908a49e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9824e8ea7f1001b3e45eb7fd425983696908a49e", "committedDate": "2020-06-23T15:34:13Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "d1350d05ec64f926e98e3dde11b1e01e6eeb079e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d1350d05ec64f926e98e3dde11b1e01e6eeb079e", "committedDate": "2020-06-23T16:35:09Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d1350d05ec64f926e98e3dde11b1e01e6eeb079e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d1350d05ec64f926e98e3dde11b1e01e6eeb079e", "committedDate": "2020-06-23T16:35:09Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "bec2fe409a6c5e74480656c419a17bcce99ee7d6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bec2fe409a6c5e74480656c419a17bcce99ee7d6", "committedDate": "2020-06-24T07:06:12Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e254fd3b710816390291c134520d876c39b05e2", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/8e254fd3b710816390291c134520d876c39b05e2", "committedDate": "2020-06-24T08:42:50Z", "message": "Abstract workspace service should check if resource exists at the beginning"}, "afterCommit": {"oid": "bec2fe409a6c5e74480656c419a17bcce99ee7d6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bec2fe409a6c5e74480656c419a17bcce99ee7d6", "committedDate": "2020-06-24T07:06:12Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bec2fe409a6c5e74480656c419a17bcce99ee7d6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bec2fe409a6c5e74480656c419a17bcce99ee7d6", "committedDate": "2020-06-24T07:06:12Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "2fec7b9f9c3d807de862aeb1673bafe920629087", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2fec7b9f9c3d807de862aeb1673bafe920629087", "committedDate": "2020-06-24T10:15:08Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fec7b9f9c3d807de862aeb1673bafe920629087", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2fec7b9f9c3d807de862aeb1673bafe920629087", "committedDate": "2020-06-24T10:15:08Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "e730b3980f6ad3f158ccad4e0a79a77edaceba22", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e730b3980f6ad3f158ccad4e0a79a77edaceba22", "committedDate": "2020-06-24T10:57:42Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e730b3980f6ad3f158ccad4e0a79a77edaceba22", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e730b3980f6ad3f158ccad4e0a79a77edaceba22", "committedDate": "2020-06-24T10:57:42Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6", "committedDate": "2020-06-24T11:45:13Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzAwMzg3", "url": "https://github.com/hortonworks/cloudbreak/pull/8375#pullrequestreview-436700387", "createdAt": "2020-06-24T14:26:20Z", "commit": {"oid": "9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDoyNjoyMFrOGoUm8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDoyNjoyMFrOGoUm8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDkzMzg3NQ==", "bodyText": "We should remove this endpoint?\nCan we do a lookup in kibana if it's still used or not? There should be a controller interceptor for it.", "url": "https://github.com/hortonworks/cloudbreak/pull/8375#discussion_r444933875", "createdAt": "2020-06-24T14:26:20Z", "author": {"login": "lnardai"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/controller/v4/RecipesV4Controller.java", "diffHunk": "@@ -67,33 +81,38 @@ public RecipeV4Response post(Long workspaceId, RecipeV4Request request) {\n     }\n \n     @Override\n-    public RecipeV4Response deleteByName(Long workspaceId, String name) {\n+    @CheckPermissionByResourceName(action = AuthorizationResourceAction.DELETE_RECIPE)\n+    public RecipeV4Response deleteByName(Long workspaceId, @ResourceName String name) {\n         Recipe deleted = recipeService.delete(NameOrCrn.ofName(name), workspaceId);\n         notify(ResourceEvent.RECIPE_DELETED);\n         return converterUtil.convert(deleted, RecipeV4Response.class);\n     }\n \n     @Override\n-    public RecipeV4Response deleteByCrn(Long workspaceId, @NotNull String crn) {\n+    @CheckPermissionByResourceCrn(action = AuthorizationResourceAction.DELETE_RECIPE)\n+    public RecipeV4Response deleteByCrn(Long workspaceId, @NotNull @ResourceCrn String crn) {\n         Recipe deleted = recipeService.delete(NameOrCrn.ofCrn(crn), workspaceId);\n         notify(ResourceEvent.RECIPE_DELETED);\n         return converterUtil.convert(deleted, RecipeV4Response.class);\n     }\n \n     @Override\n-    public RecipeV4Responses deleteMultiple(Long workspaceId, Set<String> names) {\n+    @CheckPermissionByResourceNameList(action = AuthorizationResourceAction.DELETE_RECIPE)\n+    public RecipeV4Responses deleteMultiple(Long workspaceId, @ResourceNameList Set<String> names) {\n         Set<Recipe> deleted = recipeService.deleteMultipleByNameFromWorkspace(names, workspaceId);\n         notify(ResourceEvent.RECIPE_DELETED);\n         return new RecipeV4Responses(converterUtil.convertAllAsSet(deleted, RecipeV4Response.class));\n     }\n \n     @Override\n+    @DisableCheckPermissions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6"}, "originalPosition": 89}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9963383d63dcbc3e20777ea4d8c2de27f1c5fbd6", "committedDate": "2020-06-24T11:45:13Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "ccd3f0b26475106995aa6ee18b0426c3e38b880d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ccd3f0b26475106995aa6ee18b0426c3e38b880d", "committedDate": "2020-06-24T14:41:28Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77caeea84a154545bd14bf844f8f10a6ef3f261a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/77caeea84a154545bd14bf844f8f10a6ef3f261a", "committedDate": "2020-06-24T14:42:39Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccd3f0b26475106995aa6ee18b0426c3e38b880d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ccd3f0b26475106995aa6ee18b0426c3e38b880d", "committedDate": "2020-06-24T14:41:28Z", "message": "CB-7615 Add resource based authz for recipes"}, "afterCommit": {"oid": "77caeea84a154545bd14bf844f8f10a6ef3f261a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/77caeea84a154545bd14bf844f8f10a6ef3f261a", "committedDate": "2020-06-24T14:42:39Z", "message": "CB-7615 Add resource based authz for recipes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzIzMzc4", "url": "https://github.com/hortonworks/cloudbreak/pull/8375#pullrequestreview-436723378", "createdAt": "2020-06-24T14:49:03Z", "commit": {"oid": "77caeea84a154545bd14bf844f8f10a6ef3f261a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1652, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}