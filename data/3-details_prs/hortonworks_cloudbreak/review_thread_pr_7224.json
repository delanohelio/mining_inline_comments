{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNDQzODU5", "number": 7224, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1NDo0MFrODdmsAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1Njo0NlrODdmugw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMzY5MTUzOnYy", "diffSide": "RIGHT", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/flow/stack/termination/StackTerminationFlowConfig.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1NDo0MFrOFmTURg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1NDo0MFrOFmTURg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTcwNjY5NA==", "bodyText": "this doesn't seem right in case of CCM. if we deregister freeipa from CCM and CP we won't be able to communicate with it anymore.", "url": "https://github.com/hortonworks/cloudbreak/pull/7224#discussion_r375706694", "createdAt": "2020-02-06T08:54:40Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/flow/stack/termination/StackTerminationFlowConfig.java", "diffHunk": "@@ -32,7 +34,8 @@\n                     .defaultFailureEvent(TERMINATION_FAILED_EVENT)\n                     .from(INIT_STATE).to(DEREGISTER_CLUSTERPROXY_STATE).event(TERMINATION_EVENT).noFailureEvent()\n                     .from(DEREGISTER_CLUSTERPROXY_STATE).to(DEREGISTER_CCMKEY_STATE).event(CLUSTER_PROXY_DEREGISTRATION_FINISHED_EVENT).noFailureEvent()\n-                    .from(DEREGISTER_CCMKEY_STATE).to(REMOVE_MACHINE_USER_STATE).event(CCM_KEY_DEREGISTRATION_FINISHED_EVENT).noFailureEvent()\n+                    .from(DEREGISTER_CCMKEY_STATE).to(STOP_TELEMETRY_AGENT_STATE).event(CCM_KEY_DEREGISTRATION_FINISHED_EVENT).noFailureEvent()\n+                    .from(STOP_TELEMETRY_AGENT_STATE).to(REMOVE_MACHINE_USER_STATE).event(STOP_TELEMETRY_AGENT_FINISHED_EVENT).noFailureEvent()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a50e33c8c01ef3ef32c70d48dc8e4be19ac2e66"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMzY5Nzk1OnYy", "diffSide": "RIGHT", "path": "orchestrator-salt/src/main/java/com/sequenceiq/cloudbreak/orchestrator/salt/SaltOrchestrator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1Njo0NlrOFmTYNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwODo1Njo0NlrOFmTYNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTcwNzcwMQ==", "bodyText": "could you move this out?", "url": "https://github.com/hortonworks/cloudbreak/pull/7224#discussion_r375707701", "createdAt": "2020-02-06T08:56:46Z", "author": {"login": "lacikaaa"}, "path": "orchestrator-salt/src/main/java/com/sequenceiq/cloudbreak/orchestrator/salt/SaltOrchestrator.java", "diffHunk": "@@ -195,6 +195,27 @@ public String submit(SaltConnector saltConnector) {\n         }\n     }\n \n+    @Override\n+    public void stopTelemetryAgent(List<GatewayConfig> allGateway, Set<Node> nodes, ExitCriteriaModel exitModel)\n+            throws CloudbreakOrchestratorFailedException {\n+        GatewayConfig primaryGateway = getPrimaryGatewayConfig(allGateway);\n+        Set<String> gatewayTargets = getGatewayPrivateIps(allGateway);\n+        try (SaltConnector sc = createSaltConnector(primaryGateway)) {\n+            BaseSaltJobRunner baseSaltJobRunner = new BaseSaltJobRunner(gatewayTargets, nodes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a50e33c8c01ef3ef32c70d48dc8e4be19ac2e66"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2903, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}