{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0MzU5MzAx", "number": 8276, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODowODoyOFrOEFbpbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODowODoyOFrOEFbpbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MTMxMzEwOnYy", "diffSide": "RIGHT", "path": "flow/src/main/java/com/sequenceiq/flow/core/Flow2Handler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODowODoyOFrOGjneiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODoyNjozOVrOGjoGvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAwMDEzNw==", "bodyText": "just a minor thing: as far as i see, there is a void version from required method, is it possible to use that here?", "url": "https://github.com/hortonworks/cloudbreak/pull/8276#discussion_r440000137", "createdAt": "2020-06-15T08:08:28Z", "author": {"login": "horadla23"}, "path": "flow/src/main/java/com/sequenceiq/flow/core/Flow2Handler.java", "diffHunk": "@@ -145,7 +145,13 @@ private void handle(String key, Payload payload, FlowParameters flowParameters,\n                         flow.initialize(contextParams);\n                         runningFlows.put(flow, flowChainId);\n                         try {\n-                            flowLogService.save(flowParameters, flowChainId, key, payload, null, flowConfig.getClass(), flow.getCurrentState());\n+                            transactionService.required(() -> {\n+                                flowLogService.save(flowParameters, flowChainId, key, payload, null, flowConfig.getClass(), flow.getCurrentState());\n+                                if (flowChainId != null) {\n+                                    flowChains.removeLastTriggerEvent(flowChainId, flowParameters.getFlowTriggerUserCrn());\n+                                }\n+                                return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64da38570ce27a06ddcc26f040069cffcccaa097"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxMDQzMA==", "bodyText": "Sure", "url": "https://github.com/hortonworks/cloudbreak/pull/8276#discussion_r440010430", "createdAt": "2020-06-15T08:26:39Z", "author": {"login": "foldik"}, "path": "flow/src/main/java/com/sequenceiq/flow/core/Flow2Handler.java", "diffHunk": "@@ -145,7 +145,13 @@ private void handle(String key, Payload payload, FlowParameters flowParameters,\n                         flow.initialize(contextParams);\n                         runningFlows.put(flow, flowChainId);\n                         try {\n-                            flowLogService.save(flowParameters, flowChainId, key, payload, null, flowConfig.getClass(), flow.getCurrentState());\n+                            transactionService.required(() -> {\n+                                flowLogService.save(flowParameters, flowChainId, key, payload, null, flowConfig.getClass(), flow.getCurrentState());\n+                                if (flowChainId != null) {\n+                                    flowChains.removeLastTriggerEvent(flowChainId, flowParameters.getFlowTriggerUserCrn());\n+                                }\n+                                return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAwMDEzNw=="}, "originalCommit": {"oid": "64da38570ce27a06ddcc26f040069cffcccaa097"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3207, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}