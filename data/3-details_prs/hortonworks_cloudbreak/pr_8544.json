{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTEwMzYw", "number": 8544, "title": "CDPCP-2598 Add logs around major user sync tasks", "bodyText": "Add logs around the major user sync tasks so that we can\neasily determine duration of these tasks from the logs.\nSee detailed description in the commit message.", "createdAt": "2020-07-13T21:38:04Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8544", "merged": true, "mergeCommit": {"oid": "ec02e4494852b0621844e03a7f82b5649ae0cf5c"}, "closed": true, "closedAt": "2020-07-15T21:28:35Z", "author": {"login": "handavid"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0qeirgFqTQ0NzY3MzEwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1OFcSgBqjM1NDk1NzkyMzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NjczMTA5", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#pullrequestreview-447673109", "createdAt": "2020-07-13T23:13:31Z", "commit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMzoxMzozMlrOGw956w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMzoxMzo0MlrOGw96Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk5OTA4Mw==", "bodyText": "Is there a request ID in this context? If there is, is it included in the message? Maybe add the operation ID?", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#discussion_r453999083", "createdAt": "2020-07-13T23:13:32Z", "author": {"login": "giladwolff"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/service/freeipa/user/UserSyncService.java", "diffHunk": "@@ -208,8 +208,10 @@ private void internalSynchronizeUsers(String operationId, String accountId, Stri\n                     umsEventGenerationIdsProvider.getEventGenerationIds(accountId, requestId) :\n                     null;\n \n+            LOGGER.debug(\"Starting RETRIEVE_{}_UMS_STATE for environments {} ...\", fullSync ? \"FULL\" : \"PARTIAL\", environmentCrns);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk5OTEyNw==", "bodyText": "and here?", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#discussion_r453999127", "createdAt": "2020-07-13T23:13:42Z", "author": {"login": "giladwolff"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/service/freeipa/user/UserSyncService.java", "diffHunk": "@@ -208,8 +208,10 @@ private void internalSynchronizeUsers(String operationId, String accountId, Stri\n                     umsEventGenerationIdsProvider.getEventGenerationIds(accountId, requestId) :\n                     null;\n \n+            LOGGER.debug(\"Starting RETRIEVE_{}_UMS_STATE for environments {} ...\", fullSync ? \"FULL\" : \"PARTIAL\", environmentCrns);\n             Map<String, UmsUsersState> envToUmsStateMap = umsUsersStateProvider\n                     .getEnvToUmsUsersStateMap(accountId, actorCrn, environmentCrns, userCrnFilter, machineUserCrnFilter, requestId);\n+            LOGGER.debug(\"Finished RETRIEVE_{}_UMS_STATE.\", fullSync ? \"FULL\" : \"PARTIAL\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODY1MDkx", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#pullrequestreview-447865091", "createdAt": "2020-07-14T07:42:58Z", "commit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo0Mjo1OFrOGxIF1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo0Mjo1OFrOGxIF1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE2NTk3Mw==", "bodyText": "this FULL vs PARTIAL is duplicated. maybe it should be move to a variable or a method", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#discussion_r454165973", "createdAt": "2020-07-14T07:42:58Z", "author": {"login": "lacikaaa"}, "path": "freeipa/src/main/java/com/sequenceiq/freeipa/service/freeipa/user/UserSyncService.java", "diffHunk": "@@ -276,18 +278,26 @@ private SyncStatusDetail internalSynchronizeStack(Stack stack, UmsUsersState ums\n         Multimap<String, String> warnings = ArrayListMultimap.create();\n         try {\n             FreeIpaClient freeIpaClient = freeIpaClientFactory.getFreeIpaClientForStack(stack);\n+            LOGGER.debug(\"Starting RETRIEVE_{}_IPA_STATE ...\", fullSync ? \"FULL\" : \"PARTIAL\");\n             UsersState ipaUsersState = getIpaUserState(freeIpaClient, umsUsersState, fullSync);\n-            LOGGER.debug(\"IPA UsersState, found {} users and {} groups\", ipaUsersState.getUsers().size(), ipaUsersState.getGroups().size());\n+            LOGGER.debug(\"Finished RETRIEVE_{}_IPA_STATE, found {} users and {} groups.\", fullSync ? \"FULL\" : \"PARTIAL\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODY1MjY2", "url": "https://github.com/hortonworks/cloudbreak/pull/8544#pullrequestreview-447865266", "createdAt": "2020-07-14T07:43:13Z", "commit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2b34640fb97d3b7fb29a1ccb885cb4d1af99d77", "author": {"user": {"login": "handavid", "name": "David Han"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b2b34640fb97d3b7fb29a1ccb885cb4d1af99d77", "committedDate": "2020-07-15T17:28:15Z", "message": "CDPCP-2598 Add logs around major user sync tasks\n\nAdd logs around the major user sync tasks so that we can\neasily determine duration of these tasks from the logs."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d791df24f2daf7eb978b554e6f37a987b7ad9fd5", "author": {"user": {"login": "handavid", "name": "David Han"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d791df24f2daf7eb978b554e6f37a987b7ad9fd5", "committedDate": "2020-07-13T19:51:50Z", "message": "CDPCP-2598 Add logs around major user sync tasks\n\nAdd logs around the major user sync tasks so that we can\neasily determine duration of these tasks from the logs."}, "afterCommit": {"oid": "b2b34640fb97d3b7fb29a1ccb885cb4d1af99d77", "author": {"user": {"login": "handavid", "name": "David Han"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b2b34640fb97d3b7fb29a1ccb885cb4d1af99d77", "committedDate": "2020-07-15T17:28:15Z", "message": "CDPCP-2598 Add logs around major user sync tasks\n\nAdd logs around the major user sync tasks so that we can\neasily determine duration of these tasks from the logs."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2710, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}