{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzczMzc4", "number": 7530, "title": "CB-5590 spark3 added", "bodyText": "We dont have spark3 template yet", "createdAt": "2020-03-10T21:27:35Z", "url": "https://github.com/hortonworks/cloudbreak/pull/7530", "merged": true, "mergeCommit": {"oid": "35d9cde39294c4aa4a720602dfefe5a9c2407bd5"}, "closed": true, "closedAt": "2020-03-26T08:23:55Z", "author": {"login": "doktoric"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMnzU6ABqjMxMTg5OTM2MDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRXNZvgBqjMxNjcwNDU4Mjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88c81238027e9af2e16898313062178cafbecf05", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/88c81238027e9af2e16898313062178cafbecf05", "committedDate": "2020-03-10T21:25:36Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "cd28ffccaaf934dcc6ea5f3274928c69f4ce7ddc", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cd28ffccaaf934dcc6ea5f3274928c69f4ce7ddc", "committedDate": "2020-03-11T14:15:03Z", "message": "CB-5590 spark3 added"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd28ffccaaf934dcc6ea5f3274928c69f4ce7ddc", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/cd28ffccaaf934dcc6ea5f3274928c69f4ce7ddc", "committedDate": "2020-03-11T14:15:03Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d582e89250d2383580160bd9a26d809c33bf0b7e", "committedDate": "2020-03-19T10:12:07Z", "message": "CB-5590 spark3 added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MjUyMDY5", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#pullrequestreview-379252069", "createdAt": "2020-03-23T09:23:55Z", "commit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MjUyODEw", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#pullrequestreview-379252810", "createdAt": "2020-03-23T09:24:56Z", "commit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNDo1NlrOF583OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNDo1NlrOF583OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMxMDMyOQ==", "bodyText": "I think ACLs are missing from the topology.", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396310329", "createdAt": "2020-03-23T09:24:56Z", "author": {"login": "keyki"}, "path": "orchestrator-salt/src/main/resources/salt/salt/gateway/config/cm/topology.xml.j2", "diffHunk": "@@ -480,6 +480,17 @@\n     {%- endif %}\n     {%- endif %}\n \n+    {% if 'SPARK3_YARN_HISTORY_SERVER' in salt['pillar.get']('gateway:location') -%}\n+    {% if 'SPARK3HISTORYUI' in exposed -%}\n+    <service>\n+        <role>SPARK3HISTORYUI</role>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d582e89250d2383580160bd9a26d809c33bf0b7e", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d582e89250d2383580160bd9a26d809c33bf0b7e", "committedDate": "2020-03-19T10:12:07Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "08f0c5b65d8638879943e18a195bd1d3181d5184", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/08f0c5b65d8638879943e18a195bd1d3181d5184", "committedDate": "2020-03-23T09:36:29Z", "message": "CB-5590 spark3 added"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "08f0c5b65d8638879943e18a195bd1d3181d5184", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/08f0c5b65d8638879943e18a195bd1d3181d5184", "committedDate": "2020-03-23T09:36:29Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c424ccb17593acce6ebace473249ccb1367af28d", "committedDate": "2020-03-23T11:10:01Z", "message": "CB-5590 spark3 added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NDE2MTEw", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#pullrequestreview-379416110", "createdAt": "2020-03-23T13:15:35Z", "commit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzoxNTozNlrOF6E1eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzoxNTozNlrOF6E1eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ0MDk1Mw==", "bodyText": "I thought we were moving away from safety valves? This uses another one?", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#discussion_r396440953", "createdAt": "2020-03-23T13:15:36Z", "author": {"login": "risdenk"}, "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/spark/Spark3OnYarnRoleConfigProvider.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.sequenceiq.cloudbreak.cmtemplate.configproviders.spark;\n+\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils.config;\n+import static com.sequenceiq.cloudbreak.cmtemplate.configproviders.hive.HiveMetastoreCloudStorageServiceConfigProvider.HMS_METASTORE_EXTERNAL_DIR;\n+\n+import java.util.List;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.cloudera.api.swagger.model.ApiClusterTemplateConfig;\n+import com.sequenceiq.cloudbreak.cmtemplate.CmTemplateProcessor;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.AbstractRoleConfigProvider;\n+import com.sequenceiq.cloudbreak.cmtemplate.configproviders.ConfigUtils;\n+import com.sequenceiq.cloudbreak.template.TemplatePreparationObject;\n+\n+@Component\n+public class Spark3OnYarnRoleConfigProvider extends AbstractRoleConfigProvider {\n+\n+    private static final String SPARK3_CONF_CLIENT_SAFETY_VALVE = \"spark-conf/spark-defaults.conf_client_config_safety_valve\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c424ccb17593acce6ebace473249ccb1367af28d", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c424ccb17593acce6ebace473249ccb1367af28d", "committedDate": "2020-03-23T11:10:01Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "9fe1555444ab7f4c20508065b8039b63fa1fee51", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9fe1555444ab7f4c20508065b8039b63fa1fee51", "committedDate": "2020-03-23T16:42:57Z", "message": "CB-5590 spark3 added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NjUxNzUz", "url": "https://github.com/hortonworks/cloudbreak/pull/7530#pullrequestreview-379651753", "createdAt": "2020-03-23T17:22:53Z", "commit": {"oid": "9fe1555444ab7f4c20508065b8039b63fa1fee51"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fe1555444ab7f4c20508065b8039b63fa1fee51", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9fe1555444ab7f4c20508065b8039b63fa1fee51", "committedDate": "2020-03-23T16:42:57Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "d62e44b30f6b1834bcbba024cfd82fe8cb430057", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d62e44b30f6b1834bcbba024cfd82fe8cb430057", "committedDate": "2020-03-25T20:45:06Z", "message": "CB-5590 spark3 added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d1ef183d4e2aa90eda312751b5e85541b9de515", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/4d1ef183d4e2aa90eda312751b5e85541b9de515", "committedDate": "2020-03-26T07:44:55Z", "message": "CB-5590 spark3 added"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d62e44b30f6b1834bcbba024cfd82fe8cb430057", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d62e44b30f6b1834bcbba024cfd82fe8cb430057", "committedDate": "2020-03-25T20:45:06Z", "message": "CB-5590 spark3 added"}, "afterCommit": {"oid": "4d1ef183d4e2aa90eda312751b5e85541b9de515", "author": {"user": {"login": "doktoric", "name": "Richard Doktorics"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/4d1ef183d4e2aa90eda312751b5e85541b9de515", "committedDate": "2020-03-26T07:44:55Z", "message": "CB-5590 spark3 added"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2557, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}