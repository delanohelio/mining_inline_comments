{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MTI2MDI0", "number": 9679, "title": "ENGESC-5953 remove empty stack versions when gathering stack versions", "bodyText": "See detailed description in the commit message.", "createdAt": "2020-12-22T13:32:31Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9679", "merged": true, "mergeCommit": {"oid": "7ff9df1b49a2c0634ad2094793e0ed748ec36fdd"}, "closed": true, "closedAt": "2020-12-22T15:09:58Z", "author": {"login": "sodre90"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoq0r9AFqTU1NzA4OTk0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdoq558ABqjQxNDAyNDIzMzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MDg5OTQ5", "url": "https://github.com/hortonworks/cloudbreak/pull/9679#pullrequestreview-557089949", "createdAt": "2020-12-22T13:47:10Z", "commit": {"oid": "068794c2ef2c7b6339f751e7bd4af71adbe27ca8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxMzo0NzoxMFrOIJ7uGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxMzo0NzoyOVrOIJ7uwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI4NjU1Mw==", "bodyText": "a log line would be nice here", "url": "https://github.com/hortonworks/cloudbreak/pull/9679#discussion_r547286553", "createdAt": "2020-12-22T13:47:10Z", "author": {"login": "pdarvasi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/cluster/ambari/InstanceMetadataUpdater.java", "diffHunk": "@@ -264,12 +265,24 @@ private void addPackageVersionsFromGrain(GatewayConfig gatewayConfig, HostOrches\n         return packageVersionsByNameByHost;\n     }\n \n+    private void removeEmptyStack(ArrayList<String> stackTypedPackages, Entry<String, Map<String, String>> entry) {\n+        if (!CollectionUtils.isEmpty(stackTypedPackages)) {\n+            Set<String> keySet = entry.getValue().keySet();\n+            for (String stackTypedPackage : stackTypedPackages) {\n+                if (keySet.contains(stackTypedPackage)) {\n+                    if (StringUtils.isEmpty(entry.getValue().get(stackTypedPackage))) {\n+                        entry.getValue().remove(stackTypedPackage);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "068794c2ef2c7b6339f751e7bd4af71adbe27ca8"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI4NjcyMQ==", "bodyText": "a unit test covering this would be good", "url": "https://github.com/hortonworks/cloudbreak/pull/9679#discussion_r547286721", "createdAt": "2020-12-22T13:47:29Z", "author": {"login": "pdarvasi"}, "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/cluster/ambari/InstanceMetadataUpdater.java", "diffHunk": "@@ -264,12 +265,24 @@ private void addPackageVersionsFromGrain(GatewayConfig gatewayConfig, HostOrches\n         return packageVersionsByNameByHost;\n     }\n \n+    private void removeEmptyStack(ArrayList<String> stackTypedPackages, Entry<String, Map<String, String>> entry) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "068794c2ef2c7b6339f751e7bd4af71adbe27ca8"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MDkwNTQy", "url": "https://github.com/hortonworks/cloudbreak/pull/9679#pullrequestreview-557090542", "createdAt": "2020-12-22T13:48:08Z", "commit": {"oid": "068794c2ef2c7b6339f751e7bd4af71adbe27ca8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1e7abb882db1421059ba14ed3711cf3c271a3df", "author": {"user": {"login": "sodre90", "name": "Erd\u0151s P\u00e9ter"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b1e7abb882db1421059ba14ed3711cf3c271a3df", "committedDate": "2020-12-22T13:53:02Z", "message": "ENGESC-5953 remove empty stack versions when gathering stack versions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "068794c2ef2c7b6339f751e7bd4af71adbe27ca8", "author": {"user": {"login": "sodre90", "name": "Erd\u0151s P\u00e9ter"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/068794c2ef2c7b6339f751e7bd4af71adbe27ca8", "committedDate": "2020-12-22T13:26:33Z", "message": "ENGESC-5953 remove empty stack versions when gathering stack versions"}, "afterCommit": {"oid": "b1e7abb882db1421059ba14ed3711cf3c271a3df", "author": {"user": {"login": "sodre90", "name": "Erd\u0151s P\u00e9ter"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b1e7abb882db1421059ba14ed3711cf3c271a3df", "committedDate": "2020-12-22T13:53:02Z", "message": "ENGESC-5953 remove empty stack versions when gathering stack versions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1909, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}