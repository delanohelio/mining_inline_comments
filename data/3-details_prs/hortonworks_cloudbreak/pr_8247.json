{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxODk4ODIw", "number": 8247, "title": "CB-6619-Optimize-CB-ClusterSync", "bodyText": "Introducing CB-Periscope Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds to avoid unnecessary CB DB Load and  periscope processing already synced clusters.\nPersicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios.\n\nThis was tested on private stack for periscope-cb cluster sync and autoscaling scaleup\\scaledown actions.\nCloses #CB-6619", "createdAt": "2020-06-09T15:48:15Z", "url": "https://github.com/hortonworks/cloudbreak/pull/8247", "merged": true, "mergeCommit": {"oid": "e4c5c58cb2fe2a3ca4bf27dcb453cffc7c6f8cf6"}, "closed": true, "closedAt": "2020-06-12T07:13:55Z", "author": {"login": "smaniraju"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcp43jCAFqTQyODAwNDAwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqJ7_DABqjM0MzMwNTI4MDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MDA0MDA0", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#pullrequestreview-428004004", "createdAt": "2020-06-10T12:32:20Z", "commit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMjozMjoyMFrOGhyk_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMjozMjoyMFrOGhyk_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4NDg2Mw==", "bodyText": "is it unnecessary?", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438084863", "createdAt": "2020-06-10T12:32:20Z", "author": {"login": "topolyai5"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/service/security/TlsHttpClientConfigurationService.java", "diffHunk": "@@ -35,7 +35,7 @@ public HttpClientConfig buildTLSClientConfig(String stackCrn, String host, Tunne\n         Optional<String> clusterProxyUrl = clusterProxyConfigurationService.getClusterProxyUrl();\n         HttpClientConfig httpClientConfig =\n                 new HttpClientConfig(host, tlsConfiguration.getServerCert(), tlsConfiguration.getClientCert(), tlsConfiguration.getClientKey());\n-        if (clusterProxyUrl.isPresent() && tunnel.useClusterProxy()) {\n+        if (clusterProxyUrl.isPresent()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MDA2NTQ0", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#pullrequestreview-428006544", "createdAt": "2020-06-10T12:35:56Z", "commit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDkzNTQ1", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#pullrequestreview-428493545", "createdAt": "2020-06-10T23:23:16Z", "commit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMzoyMzoxNlrOGiJdyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMzozMzoxOFrOGiJpKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1OTg0OA==", "bodyText": "Nit: Remove the reference and import since the stackCollectorService isn't used here.", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438459848", "createdAt": "2020-06-10T23:23:16Z", "author": {"login": "sidseth"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/service/ha/LeaderElectionService.java", "diffHunk": "@@ -126,7 +114,6 @@ public void leaderElection() {\n                     @Override\n                     public void run() {\n                         try {\n-                            stackCollectorService.collectStackDetails();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ2Mjc2MQ==", "bodyText": "Maybe also remove the entire StackCollectorService class if it is not used elsewhere.", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438462761", "createdAt": "2020-06-10T23:33:18Z", "author": {"login": "sidseth"}, "path": "autoscale/src/main/java/com/sequenceiq/periscope/service/ha/LeaderElectionService.java", "diffHunk": "@@ -126,7 +114,6 @@ public void leaderElection() {\n                     @Override\n                     public void run() {\n                         try {\n-                            stackCollectorService.collectStackDetails();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1OTg0OA=="}, "originalCommit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5373712dde8a1134c43677b948411526aae3a46f", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5373712dde8a1134c43677b948411526aae3a46f", "committedDate": "2020-06-11T08:09:36Z", "message": "CB-6619-Optimize-CB-ClusterSync\n\n1. Introduced Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds which avoids CB DB Load and  processing already created clusters in periscope.\n2. Persicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03a89725d3a7c9d03daa8828be27e31509040cb8", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/03a89725d3a7c9d03daa8828be27e31509040cb8", "committedDate": "2020-06-09T15:35:00Z", "message": "CB-6619-Optimize-CB-ClusterSync\n\n1. Introduced Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds which avoids CB DB Load and  processing already created clusters in periscope.\n2. Persicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios."}, "afterCommit": {"oid": "5373712dde8a1134c43677b948411526aae3a46f", "author": {"user": {"login": "smaniraju", "name": null}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5373712dde8a1134c43677b948411526aae3a46f", "committedDate": "2020-06-11T08:09:36Z", "message": "CB-6619-Optimize-CB-ClusterSync\n\n1. Introduced Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds which avoids CB DB Load and  processing already created clusters in periscope.\n2. Persicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1677, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}