{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNTYwMzYz", "number": 9201, "title": "CB-9156 refactor permission check logic on request object within auth\u2026", "bodyText": "\u2026z framework\nSee detailed description in the commit message.", "createdAt": "2020-10-12T12:57:40Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9201", "merged": true, "mergeCommit": {"oid": "9a7533674f0a387437e8df0621637f4ab03b8cf4"}, "closed": true, "closedAt": "2020-10-22T11:23:53Z", "author": {"login": "horadla23"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRz5I3gBqjM4NjY2MTM1NzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdU-SsNgBqjM5MDc5NTg0OTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38c16e367bbfb8b4fbc3c9ed8d58598f5cde9cea", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/38c16e367bbfb8b4fbc3c9ed8d58598f5cde9cea", "committedDate": "2020-10-12T12:49:38Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "ab982d25290b1a9fc5104ce9b9563e5c32dde11a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ab982d25290b1a9fc5104ce9b9563e5c32dde11a", "committedDate": "2020-10-12T13:21:08Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab982d25290b1a9fc5104ce9b9563e5c32dde11a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ab982d25290b1a9fc5104ce9b9563e5c32dde11a", "committedDate": "2020-10-12T13:21:08Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "2c8e00fa1d348ec8d43f26cac35f6f19fd93c72d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2c8e00fa1d348ec8d43f26cac35f6f19fd93c72d", "committedDate": "2020-10-13T10:24:33Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c8e00fa1d348ec8d43f26cac35f6f19fd93c72d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/2c8e00fa1d348ec8d43f26cac35f6f19fd93c72d", "committedDate": "2020-10-13T10:24:33Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "abcf7e32958ddc930cbea1e71d071598567467d5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/abcf7e32958ddc930cbea1e71d071598567467d5", "committedDate": "2020-10-13T10:29:34Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abcf7e32958ddc930cbea1e71d071598567467d5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/abcf7e32958ddc930cbea1e71d071598567467d5", "committedDate": "2020-10-13T10:29:34Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "09a29655c3bf9451160e666ee6f866f6e6b50579", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/09a29655c3bf9451160e666ee6f866f6e6b50579", "committedDate": "2020-10-13T10:45:57Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "09a29655c3bf9451160e666ee6f866f6e6b50579", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/09a29655c3bf9451160e666ee6f866f6e6b50579", "committedDate": "2020-10-13T10:45:57Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "bf8c47efd0cd20684367aed49c0b0db3b3adfe61", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bf8c47efd0cd20684367aed49c0b0db3b3adfe61", "committedDate": "2020-10-13T11:06:57Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf8c47efd0cd20684367aed49c0b0db3b3adfe61", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/bf8c47efd0cd20684367aed49c0b0db3b3adfe61", "committedDate": "2020-10-13T11:06:57Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "74cab385c98cd7a0590d7041507683cd9cea05d5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/74cab385c98cd7a0590d7041507683cd9cea05d5", "committedDate": "2020-10-13T12:28:19Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74cab385c98cd7a0590d7041507683cd9cea05d5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/74cab385c98cd7a0590d7041507683cd9cea05d5", "committedDate": "2020-10-13T12:28:19Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "0e501fd7f61a9a285f4eb4cbe41e0c5607c7d53e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0e501fd7f61a9a285f4eb4cbe41e0c5607c7d53e", "committedDate": "2020-10-13T18:18:44Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0e501fd7f61a9a285f4eb4cbe41e0c5607c7d53e", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0e501fd7f61a9a285f4eb4cbe41e0c5607c7d53e", "committedDate": "2020-10-13T18:18:44Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "c2abecf710ae1a50f85e48191b88434c60730e4f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c2abecf710ae1a50f85e48191b88434c60730e4f", "committedDate": "2020-10-14T05:20:33Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2abecf710ae1a50f85e48191b88434c60730e4f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c2abecf710ae1a50f85e48191b88434c60730e4f", "committedDate": "2020-10-14T05:20:33Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "ac0b20ea2f6ca8412a5092304a591fbe98cb41f1", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ac0b20ea2f6ca8412a5092304a591fbe98cb41f1", "committedDate": "2020-10-14T05:26:26Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac0b20ea2f6ca8412a5092304a591fbe98cb41f1", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/ac0b20ea2f6ca8412a5092304a591fbe98cb41f1", "committedDate": "2020-10-14T05:26:26Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "9c7532b43e9f914d4c85ba2af99e3df91886cfd4", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9c7532b43e9f914d4c85ba2af99e3df91886cfd4", "committedDate": "2020-10-14T09:51:51Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c7532b43e9f914d4c85ba2af99e3df91886cfd4", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9c7532b43e9f914d4c85ba2af99e3df91886cfd4", "committedDate": "2020-10-14T09:51:51Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "fb21b7df3ba72a645abfb4c2f20fe511e2e2ff1c", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fb21b7df3ba72a645abfb4c2f20fe511e2e2ff1c", "committedDate": "2020-10-14T10:03:29Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb21b7df3ba72a645abfb4c2f20fe511e2e2ff1c", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/fb21b7df3ba72a645abfb4c2f20fe511e2e2ff1c", "committedDate": "2020-10-14T10:03:29Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "b5eba7c6528098758ae53e593f682fb86af7be0c", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b5eba7c6528098758ae53e593f682fb86af7be0c", "committedDate": "2020-10-14T11:39:45Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5eba7c6528098758ae53e593f682fb86af7be0c", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/b5eba7c6528098758ae53e593f682fb86af7be0c", "committedDate": "2020-10-14T11:39:45Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "56be864efeffff6227225dbb7290bce2de45b4f9", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/56be864efeffff6227225dbb7290bce2de45b4f9", "committedDate": "2020-10-14T11:55:21Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56be864efeffff6227225dbb7290bce2de45b4f9", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/56be864efeffff6227225dbb7290bce2de45b4f9", "committedDate": "2020-10-14T11:55:21Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "19157b5745d85af19c227d0f764528c825e7051b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/19157b5745d85af19c227d0f764528c825e7051b", "committedDate": "2020-10-19T08:45:26Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19157b5745d85af19c227d0f764528c825e7051b", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/19157b5745d85af19c227d0f764528c825e7051b", "committedDate": "2020-10-19T08:45:26Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "72053d66a7df2a479fb90458ceea5fd809a2853f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/72053d66a7df2a479fb90458ceea5fd809a2853f", "committedDate": "2020-10-19T10:06:07Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72053d66a7df2a479fb90458ceea5fd809a2853f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/72053d66a7df2a479fb90458ceea5fd809a2853f", "committedDate": "2020-10-19T10:06:07Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "0854d321e2022ee0b2e0d8ae82836a9043c549e5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0854d321e2022ee0b2e0d8ae82836a9043c549e5", "committedDate": "2020-10-21T09:18:43Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0854d321e2022ee0b2e0d8ae82836a9043c549e5", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/0854d321e2022ee0b2e0d8ae82836a9043c549e5", "committedDate": "2020-10-21T09:18:43Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "9691e57e3d5cd245a0628aa89e235b764da13dc3", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9691e57e3d5cd245a0628aa89e235b764da13dc3", "committedDate": "2020-10-21T09:38:28Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NDE2NDkz", "url": "https://github.com/hortonworks/cloudbreak/pull/9201#pullrequestreview-514416493", "createdAt": "2020-10-22T07:05:04Z", "commit": {"oid": "9691e57e3d5cd245a0628aa89e235b764da13dc3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwNzowNTowNFrOHmTY1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwNzowNTowNFrOHmTY1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTkyNTU5MQ==", "bodyText": "Not a blocker but would be better to make only one request to UMS instead of doing it in a for loop.", "url": "https://github.com/hortonworks/cloudbreak/pull/9201#discussion_r509925591", "createdAt": "2020-10-22T07:05:04Z", "author": {"login": "foldik"}, "path": "authorization-common/src/main/java/com/sequenceiq/authorization/service/CompositeRequestPropertyPermissionChecker.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package com.sequenceiq.authorization.service;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.Arrays;\n+\n+import javax.inject.Inject;\n+\n+import org.aspectj.lang.ProceedingJoinPoint;\n+import org.aspectj.lang.reflect.MethodSignature;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.stereotype.Component;\n+\n+import com.sequenceiq.authorization.annotation.CheckPermissionByCompositeRequestProperty;\n+\n+@Component\n+public class CompositeRequestPropertyPermissionChecker extends ResourcePermissionChecker<CheckPermissionByCompositeRequestProperty> {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(CompositeRequestPropertyPermissionChecker.class);\n+\n+    @Inject\n+    private RequestPropertyPermissionChecker requestPropertyPermissionChecker;\n+\n+    @Override\n+    public <T extends Annotation> void checkPermissions(T rawMethodAnnotation, String userCrn, ProceedingJoinPoint proceedingJoinPoint,\n+            MethodSignature methodSignature, long startTime) {\n+        // check fields of requestObject\n+        CheckPermissionByCompositeRequestProperty methodAnnotation = (CheckPermissionByCompositeRequestProperty) rawMethodAnnotation;\n+        Arrays.stream(methodAnnotation.value()).forEach(checkPermissionByRequestField -> requestPropertyPermissionChecker.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9691e57e3d5cd245a0628aa89e235b764da13dc3"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "313a94f396159e88e81d9aa8af16ffa913488eb1", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/313a94f396159e88e81d9aa8af16ffa913488eb1", "committedDate": "2020-10-22T09:09:56Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9691e57e3d5cd245a0628aa89e235b764da13dc3", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/9691e57e3d5cd245a0628aa89e235b764da13dc3", "committedDate": "2020-10-21T09:38:28Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}, "afterCommit": {"oid": "313a94f396159e88e81d9aa8af16ffa913488eb1", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/313a94f396159e88e81d9aa8af16ffa913488eb1", "committedDate": "2020-10-22T09:09:56Z", "message": "CB-9156 refactor permission check logic on request object within authz framework"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2155, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}