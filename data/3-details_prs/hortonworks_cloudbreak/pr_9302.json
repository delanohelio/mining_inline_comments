{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNzIxNjI3", "number": 9302, "title": "CB-9472 make authz mock tests runnable from one testsuite", "bodyText": "See detailed description in the commit message.", "createdAt": "2020-10-27T12:37:23Z", "url": "https://github.com/hortonworks/cloudbreak/pull/9302", "merged": true, "mergeCommit": {"oid": "51b92dcba5706ea56e03dddad57a46902dd68422"}, "closed": true, "closedAt": "2020-10-29T10:29:19Z", "author": {"login": "horadla23"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWpcmdgBqjM5MjYwOTM3OTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXPnC3gFqTUxOTUyNTg5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "796cf694a00c32e64426b2950066aebcbf4571f1", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/796cf694a00c32e64426b2950066aebcbf4571f1", "committedDate": "2020-10-27T12:36:12Z", "message": "CB-9472 make authz mock tests runnable from one testsuite"}, "afterCommit": {"oid": "d379aacb199e593158982b964a870b3b536140a6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d379aacb199e593158982b964a870b3b536140a6", "committedDate": "2020-10-27T14:00:33Z", "message": "CB-9472 make authz mock tests runnable from one testsuite"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d379aacb199e593158982b964a870b3b536140a6", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d379aacb199e593158982b964a870b3b536140a6", "committedDate": "2020-10-27T14:00:33Z", "message": "CB-9472 make authz mock tests runnable from one testsuite"}, "afterCommit": {"oid": "04a134365a99db90169a80fd5fe75552f4c69d77", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/04a134365a99db90169a80fd5fe75552f4c69d77", "committedDate": "2020-10-27T14:15:44Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- currently we need different suites and jenkins jobs for every authz mock tests based on account and it would be better to use one suite for every authz test with one jenkins job and this commit make is possible to use existing suite to introduce more authz tests even if it is executed for different account and it makes also possible to handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "04a134365a99db90169a80fd5fe75552f4c69d77", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/04a134365a99db90169a80fd5fe75552f4c69d77", "committedDate": "2020-10-27T14:15:44Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- currently we need different suites and jenkins jobs for every authz mock tests based on account and it would be better to use one suite for every authz test with one jenkins job and this commit make is possible to use existing suite to introduce more authz tests even if it is executed for different account and it makes also possible to handle account admins of test users based on account id"}, "afterCommit": {"oid": "5974bf4ee81c5f68b9cce421caddcfebfedb4519", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5974bf4ee81c5f68b9cce421caddcfebfedb4519", "committedDate": "2020-10-27T14:30:33Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit make possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5974bf4ee81c5f68b9cce421caddcfebfedb4519", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/5974bf4ee81c5f68b9cce421caddcfebfedb4519", "committedDate": "2020-10-27T14:30:33Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit make possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "d6d0079e15c8cb6c70ab97383518a5dfe5e58962", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d6d0079e15c8cb6c70ab97383518a5dfe5e58962", "committedDate": "2020-10-27T14:46:52Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit make possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6d0079e15c8cb6c70ab97383518a5dfe5e58962", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/d6d0079e15c8cb6c70ab97383518a5dfe5e58962", "committedDate": "2020-10-27T14:46:52Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit make possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/be4a637c032bdd58d54f690f738f006abd35935a", "committedDate": "2020-10-27T14:47:19Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NDk1MDI5", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#pullrequestreview-518495029", "createdAt": "2020-10-28T10:00:34Z", "commit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMDowMDozNFrOHpiW5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMDowNDoxNFrOHpiffg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzMxNjU4Mw==", "bodyText": "why create a new map?\naz keyvault secret show --name \"real-ums-users-dev\" --vault-name \"jenkins-secret\" --version $secret_version --query 'value' -o tsv | jq > $USER_JSON_LOCATION\nI've a similar approach in another PR. This way we can easily update the secret.", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#discussion_r513316583", "createdAt": "2020-10-28T10:00:34Z", "author": {"login": "lnardai"}, "path": "integration-test/scripts/fetch-secrets.sh", "diffHunk": "@@ -14,7 +14,7 @@ fi\n mkdir -p ./src/main/resources/ums-users\n \n echo \"Executing secret fetching from Azure 'jenkins-secret' store\"\n-az keyvault secret show --name \"real-ums-users-dev\" --vault-name \"jenkins-secret\" --query 'value' -o tsv | jq > $USER_JSON_LOCATION", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzMxNzIzNg==", "bodyText": "can't we just use the primitive? Constructors could be simpler also.", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#discussion_r513317236", "createdAt": "2020-10-28T10:01:41Z", "author": {"login": "lnardai"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/actor/CloudbreakUser.java", "diffHunk": "@@ -12,19 +12,30 @@\n \n     private String displayName;\n \n+    private Boolean admin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzMxODc4Mg==", "bodyText": "Will this work with the old local setup for dp cli command? Since in that run there is no concept of userCrn.", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#discussion_r513318782", "createdAt": "2020-10-28T10:04:14Z", "author": {"login": "lnardai"}, "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/context/TestContext.java", "diffHunk": "@@ -336,7 +335,7 @@ T doAction(T entity, Class<? extends MicroserviceClient> clientClass, Action<T,\n \n     protected <T extends CloudbreakTestDto, U extends MicroserviceClient>\n     T doActionAsAdmin(T entity, Class<? extends MicroserviceClient> clientClass, Action<T, U> action, String who) throws Exception {\n-        return action.action(getTestContext(), entity, getAdminMicroserviceClient(clientClass));\n+        return action.action(getTestContext(), entity, getAdminMicroserviceClient(clientClass, Crn.fromString(entity.getCrn()).getAccountId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTAwODkw", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#pullrequestreview-518500890", "createdAt": "2020-10-28T10:07:13Z", "commit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be4a637c032bdd58d54f690f738f006abd35935a", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/be4a637c032bdd58d54f690f738f006abd35935a", "committedDate": "2020-10-27T14:47:19Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "19e532a6dc5860f8f0344ddb21405cb0c522407d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/19e532a6dc5860f8f0344ddb21405cb0c522407d", "committedDate": "2020-10-28T13:48:25Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19e532a6dc5860f8f0344ddb21405cb0c522407d", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/19e532a6dc5860f8f0344ddb21405cb0c522407d", "committedDate": "2020-10-28T13:48:25Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "a5e4857cdd70565c2cbc56b895668c948b09176f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a5e4857cdd70565c2cbc56b895668c948b09176f", "committedDate": "2020-10-28T14:40:51Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5e4857cdd70565c2cbc56b895668c948b09176f", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/a5e4857cdd70565c2cbc56b895668c948b09176f", "committedDate": "2020-10-28T14:40:51Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "c0e11a3ef0f3e548246b57914d065c5140e7eb63", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c0e11a3ef0f3e548246b57914d065c5140e7eb63", "committedDate": "2020-10-28T15:16:22Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6dbeb41a9c0dde99619d34767a8958a5fb79548", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e6dbeb41a9c0dde99619d34767a8958a5fb79548", "committedDate": "2020-10-28T15:59:09Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0e11a3ef0f3e548246b57914d065c5140e7eb63", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/c0e11a3ef0f3e548246b57914d065c5140e7eb63", "committedDate": "2020-10-28T15:16:22Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}, "afterCommit": {"oid": "e6dbeb41a9c0dde99619d34767a8958a5fb79548", "author": {"user": {"login": "horadla23", "name": "Adam Horvath"}}, "url": "https://github.com/hortonworks/cloudbreak/commit/e6dbeb41a9c0dde99619d34767a8958a5fb79548", "committedDate": "2020-10-28T15:59:09Z", "message": "CB-9472 make authz mock tests runnable from one testsuite\n- before this we needed different suites and jenkins jobs for every authz mock tests/account\n- this commit makes possible to:\n  - use one suite for every authz test with one jenkins job even if they are executed against more accounts\n  - handle account admins of test users based on account id"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDI0MTQz", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#pullrequestreview-519424143", "createdAt": "2020-10-29T08:22:02Z", "commit": {"oid": "e6dbeb41a9c0dde99619d34767a8958a5fb79548"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NTI1ODk0", "url": "https://github.com/hortonworks/cloudbreak/pull/9302#pullrequestreview-519525894", "createdAt": "2020-10-29T10:28:43Z", "commit": {"oid": "e6dbeb41a9c0dde99619d34767a8958a5fb79548"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2074, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}