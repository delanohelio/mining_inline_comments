{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzOTgyOTA4", "number": 304, "title": "Corrected port number validation range", "bodyText": "Description\nCorrected the port range to upper limit of valid port range ie 65535.\nAdded UT for the scenario.\nFixes #291\nType of change\nPlease delete options that are not relevant.\n\n Bug fix (non-breaking change which fixes an issue)\n\nFeature/Issue validation/testing\n\n\n Test A\nRun torchserve on valid port range eg: 8081,42523 (1024 - 65535)\n\n\nUT/IT execution results\n\n\nLogs\nissue_291_torchserve_sanity_log.txt\n\n\nChecklist:\n\n Have you added tests that prove your fix is effective or that this feature works?\n New and existing unit tests pass locally with these changes?\n Has code been commented, particularly in hard-to-understand areas?\n Have you made corresponding changes to the documentation?", "createdAt": "2020-05-06T09:33:21Z", "url": "https://github.com/pytorch/serve/pull/304", "merged": true, "mergeCommit": {"oid": "7844a112d16d351f64e5079efe18ad67cf280f25"}, "closed": true, "closedAt": "2020-05-21T17:08:22Z", "author": {"login": "shivamshriwas"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcelOizgH2gAyNDEzOTgyOTA4OjM2ODkxMGNkMjExNWM3YWRmZjExMWE1NGJjOTFiN2M5YjY5YzA1ODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjg03MAFqTQxNjMzMTk2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "368910cd2115c7adff111a54bc91b7c9b69c0585", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/368910cd2115c7adff111a54bc91b7c9b69c0585", "committedDate": "2020-05-06T09:26:11Z", "message": "Corrected port number validation range"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da29522352592f3401d17d5470e4533610fc3a94", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/da29522352592f3401d17d5470e4533610fc3a94", "committedDate": "2020-05-06T16:06:15Z", "message": "added UT for issue 291"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1f1fb1420adeda898e7ea5224abf855bed25f1e", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/f1f1fb1420adeda898e7ea5224abf855bed25f1e", "committedDate": "2020-05-06T16:32:40Z", "message": "added ut dependency file formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eeea607a0018484b54851b09150f5aebc7bbc76", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/2eeea607a0018484b54851b09150f5aebc7bbc76", "committedDate": "2020-05-06T16:35:45Z", "message": "correct param in config_test_env.properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18d67158d820a6d56920a48f150cfb06ebec4386", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/18d67158d820a6d56920a48f150cfb06ebec4386", "committedDate": "2020-05-06T16:39:31Z", "message": "removed incorrect flags from test case config files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTE2ODIz", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-407116823", "createdAt": "2020-05-07T02:52:42Z", "commit": {"oid": "18d67158d820a6d56920a48f150cfb06ebec4386"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fef31270fe70b3a1439660c206895c2621d6bc71", "author": {"user": {"login": "harshbafna", "name": "Harsh Bafna"}}, "url": "https://github.com/pytorch/serve/commit/fef31270fe70b3a1439660c206895c2621d6bc71", "committedDate": "2020-05-07T02:52:52Z", "message": "Merge branch 'staging_0_1_1' into issue_291"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTMwMzE4", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-407130318", "createdAt": "2020-05-07T03:44:04Z", "commit": {"oid": "fef31270fe70b3a1439660c206895c2621d6bc71"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwMzo0NDowNFrOGRtUHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwMzo0NDowNFrOGRtUHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTIyMTQwNQ==", "bodyText": "Can we add negative and edge cases for this?", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421221405", "createdAt": "2020-05-07T03:44:04Z", "author": {"login": "dhaniram-kshirsagar"}, "path": "frontend/server/src/test/java/org/pytorch/serve/ModelServerTest.java", "diffHunk": "@@ -1244,4 +1247,43 @@ private void testMetricManager() throws JsonParseException, InterruptedException\n             }\n         }\n     }\n+\n+    private void testTSPortRange()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fef31270fe70b3a1439660c206895c2621d6bc71"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce70699e087f67e6c6ba79d2dd3edd2c994e46f5", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/ce70699e087f67e6c6ba79d2dd3edd2c994e46f5", "committedDate": "2020-05-07T15:56:07Z", "message": "added negative test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/ecfd86c51295db13cb461828f6c50c70b3a9447d", "committedDate": "2020-05-07T15:56:53Z", "message": "Merge branch 'issue_291' of https://github.com/pytorch/serve into issue_291"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NjQyMjI2", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-407642226", "createdAt": "2020-05-07T16:31:41Z", "commit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjozMTo0MVrOGSGuIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjozNjo1OVrOGSG6qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzY2Ng==", "bodyText": "Why are we removing this?", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421637666", "createdAt": "2020-05-07T16:31:41Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/resources/config.properties", "diffHunk": "@@ -25,7 +25,6 @@ certificate_file=src/test/resources/certs.pem\n # max_response_size=6553500\n max_request_size=10485760\n # blacklist_env_vars=.*USERNAME.*|.*PASSWORD.*\n-# enable_env_vars_config=false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzOTQxMQ==", "bodyText": "We can remove the commented properties in test configurations.", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421639411", "createdAt": "2020-05-07T16:34:34Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/resources/config_invalid_port.properties", "diffHunk": "@@ -0,0 +1,5 @@\n+inference_address=https://127.0.0.1:65536\n+management_address=unix:/tmp/management.sock\n+# model_server_home=../..", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzOTczNA==", "bodyText": "Do we need inference_address to be true? The configuration seems to be set in the properties file itself.", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421639734", "createdAt": "2020-05-07T16:35:07Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/resources/config_invalid_port.properties", "diffHunk": "@@ -0,0 +1,5 @@\n+inference_address=https://127.0.0.1:65536\n+management_address=unix:/tmp/management.sock\n+# model_server_home=../..\n+model_store=../modelarchive/src/test/resources/models\n+enable_envvars_config=true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY0MDg3Mw==", "bodyText": "I am curious to know what this file is, that we are deleting.", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421640873", "createdAt": "2020-05-07T16:36:59Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/java/org/pytorch/serve/ModelServerTest.java", "diffHunk": "@@ -1244,4 +1248,65 @@ private void testMetricManager() throws JsonParseException, InterruptedException\n             }\n         }\n     }\n+\n+    private void testTSValidPort()\n+            throws InterruptedException, GeneralSecurityException, InvalidSnapshotException,\n+                    IOException {\n+        //  test case for verifying port range refer https://github.com/pytorch/serve/issues/291\n+        server.stop();\n+        System.setProperty(\"tsConfigFile\", \"src/test/resources/config_port.properties\");\n+        FileUtils.deleteQuietly(new File(System.getProperty(\"LOG_LOCATION\"), \"config\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Njg3NjUy", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-407687652", "createdAt": "2020-05-07T17:31:28Z", "commit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNzozMToyOFrOGSI7gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNzozNTozMFrOGSJEkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY3Mzg1Ng==", "bodyText": "Why is snapshot given a preference over the runtime configuration? Whats the order of preference for this?", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421673856", "createdAt": "2020-05-07T17:31:28Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/java/org/pytorch/serve/ModelServerTest.java", "diffHunk": "@@ -1244,4 +1248,65 @@ private void testMetricManager() throws JsonParseException, InterruptedException\n             }\n         }\n     }\n+\n+    private void testTSValidPort()\n+            throws InterruptedException, GeneralSecurityException, InvalidSnapshotException,\n+                    IOException {\n+        //  test case for verifying port range refer https://github.com/pytorch/serve/issues/291\n+        server.stop();\n+        System.setProperty(\"tsConfigFile\", \"src/test/resources/config_port.properties\");\n+        FileUtils.deleteQuietly(new File(System.getProperty(\"LOG_LOCATION\"), \"config\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY0MDg3Mw=="}, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY3NTMwMw==", "bodyText": "I was thinking about this test a little more. Since this test is only testing hte JAVA code path, couldn't we simply modify the TS_INFERENCE_ADDRESS property in ConfigManager and restart the server? Do we need this additional config.properties file?", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421675303", "createdAt": "2020-05-07T17:33:56Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/java/org/pytorch/serve/ModelServerTest.java", "diffHunk": "@@ -1244,4 +1248,65 @@ private void testMetricManager() throws JsonParseException, InterruptedException\n             }\n         }\n     }\n+\n+    private void testTSValidPort()\n+            throws InterruptedException, GeneralSecurityException, InvalidSnapshotException,\n+                    IOException {\n+        //  test case for verifying port range refer https://github.com/pytorch/serve/issues/291\n+        server.stop();\n+        System.setProperty(\"tsConfigFile\", \"src/test/resources/config_port.properties\");\n+        FileUtils.deleteQuietly(new File(System.getProperty(\"LOG_LOCATION\"), \"config\"));\n+        ConfigManager.init(new ConfigManager.Arguments());\n+        configManager = ConfigManager.getInstance();\n+        PluginsManager.getInstance().initialize();\n+\n+        InternalLoggerFactory.setDefaultFactory(Slf4JLoggerFactory.INSTANCE);\n+        server = new ModelServer(configManager);\n+        server.start();\n+\n+        Channel channel = null;\n+        Channel managementChannel = null;\n+        for (int i = 0; i < 5; ++i) {\n+            channel = TestUtils.connect(false, configManager);\n+            if (channel != null) {\n+                break;\n+            }\n+            Thread.sleep(100);\n+        }\n+\n+        for (int i = 0; i < 5; ++i) {\n+            managementChannel = TestUtils.connect(true, configManager);\n+            if (managementChannel != null) {\n+                break;\n+            }\n+            Thread.sleep(100);\n+        }\n+\n+        Assert.assertNotNull(channel, \"Failed to connect to inference port.\");\n+        Assert.assertNotNull(managementChannel, \"Failed to connect to management port.\");\n+\n+        testPing(channel);\n+    }\n+\n+    private void testTSInvalidPort()\n+            throws InterruptedException, GeneralSecurityException, InvalidSnapshotException,\n+                    IOException {\n+        //  test case for verifying port range refer https://github.com/pytorch/serve/issues/291\n+        //  invalid port test\n+        server.stop();\n+        System.setProperty(\"tsConfigFile\", \"src/test/resources/config_invalid_port.properties\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY3NjE3OA==", "bodyText": "Oh. Ok. Good catch.", "url": "https://github.com/pytorch/serve/pull/304#discussion_r421676178", "createdAt": "2020-05-07T17:35:30Z", "author": {"login": "vdantu"}, "path": "frontend/server/src/test/resources/config.properties", "diffHunk": "@@ -25,7 +25,6 @@ certificate_file=src/test/resources/certs.pem\n # max_response_size=6553500\n max_request_size=10485760\n # blacklist_env_vars=.*USERNAME.*|.*PASSWORD.*\n-# enable_env_vars_config=false", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzNzY2Ng=="}, "originalCommit": {"oid": "ecfd86c51295db13cb461828f6c50c70b3a9447d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c09831396ddccfa6afe7cbcc6e4067ee305c40a", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/1c09831396ddccfa6afe7cbcc6e4067ee305c40a", "committedDate": "2020-05-08T09:39:52Z", "message": "removed properties file and changes in test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a9fa73b7c2096adf3daf9caa6d225782a3807d1", "author": {"user": {"login": "shivamshriwas", "name": "shivamshriwas"}}, "url": "https://github.com/pytorch/serve/commit/3a9fa73b7c2096adf3daf9caa6d225782a3807d1", "committedDate": "2020-05-21T10:55:23Z", "message": "resolved merge conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MjY2ODAz", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-416266803", "createdAt": "2020-05-21T15:43:08Z", "commit": {"oid": "3a9fa73b7c2096adf3daf9caa6d225782a3807d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzMxOTYx", "url": "https://github.com/pytorch/serve/pull/304#pullrequestreview-416331961", "createdAt": "2020-05-21T17:08:08Z", "commit": {"oid": "3a9fa73b7c2096adf3daf9caa6d225782a3807d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2375, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}