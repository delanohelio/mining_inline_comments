{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3OTAwNzU3", "number": 472, "title": "Fixed model-archiver to accept handler name or handler_name:entry_pnt_func combinations", "bodyText": "Description\nFixed model-archiver to accept handler name or handler_name:entry_pnt_func combinations\n\nRemoved source_vocab option as it was only used for text handler and the same can be replaced with --extra-files with a custom init step in the handler.\n\nTODO - Backward compatibility is supported however same can be remove in future release once updated mar  for text_classifier  example is uploaded to s3\nFixes #465\nType of change\nPlease delete options that are not relevant.\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to not work as expected)\n This change requires a documentation update\n\nFeature/Issue validation/testing\n\nTested with existing mar commands for examples i.e. default handlers and custom handler e.g. text_classification and resnet_152\nTest image_segmention model default handler mar\nTest without .py extenstion i.e. with module_name and module_name:entry_point_function_name\n\n\nUT/IT execution results\nLogs\nmodel-archive-test-logs.log\n\nChecklist:\n\n Have you added tests that prove your fix is effective or that this feature works?\n New and existing unit tests pass locally with these changes?\n Has code been commented, particularly in hard-to-understand areas?\n Have you made corresponding changes to the documentation?", "createdAt": "2020-06-22T12:14:09Z", "url": "https://github.com/pytorch/serve/pull/472", "merged": true, "mergeCommit": {"oid": "8231cc6f183099087fa96d5f02cd77bdc2d86d29"}, "closed": true, "closedAt": "2020-08-04T01:09:36Z", "author": {"login": "dhaniram-kshirsagar"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpj7ZgAH2gAyNDM3OTAwNzU3OjE0ZDE0ZjFhY2Y2ZjQxNzY3ZTY2OGRkZDhhZmRkODkzMzVlNDhkYmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7cEFYgFqTQ2MDQzMTM3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "14d14f1acf6f41767e668ddd8afdd89335e48dba", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/14d14f1acf6f41767e668ddd8afdd89335e48dba", "committedDate": "2020-06-09T12:08:32Z", "message": "Fix for error while loading model on cpu which was saved on gpu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8092b2f37d6b7cfae79a73f9dec7f9e1ca5d91d", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/d8092b2f37d6b7cfae79a73f9dec7f9e1ca5d91d", "committedDate": "2020-06-18T12:53:16Z", "message": "Merge branch 'master' of https://github.com/pytorch/serve"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9217583a2b78eeb79956cd9c0e9db570e2235aaa", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/9217583a2b78eeb79956cd9c0e9db570e2235aaa", "committedDate": "2020-06-22T10:39:43Z", "message": "Fixed issue 465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "449206eb19f683b5020e811f182aa3c7eb41b975", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/449206eb19f683b5020e811f182aa3c7eb41b975", "committedDate": "2020-06-22T11:21:29Z", "message": "Added more changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6275bfc75da1524c4fe6a5ae3bf8071bf7180cb2", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/6275bfc75da1524c4fe6a5ae3bf8071bf7180cb2", "committedDate": "2020-06-22T12:28:26Z", "message": "Fixed UTs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad923db35db6baa4a59298fcfcc5f685f6bff9e5", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/ad923db35db6baa4a59298fcfcc5f685f6bff9e5", "committedDate": "2020-06-23T06:12:53Z", "message": "Offline code review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3OTYwNDg2", "url": "https://github.com/pytorch/serve/pull/472#pullrequestreview-437960486", "createdAt": "2020-06-26T01:30:14Z", "commit": {"oid": "ad923db35db6baa4a59298fcfcc5f685f6bff9e5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMTozMDoxNFrOGpQ84w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMTozMDoxNFrOGpQ84w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkyMjUzMQ==", "bodyText": "@dhaniram-kshirsagar Will this require updates to automated tests?", "url": "https://github.com/pytorch/serve/pull/472#discussion_r445922531", "createdAt": "2020-06-26T01:30:14Z", "author": {"login": "chauhang"}, "path": "examples/text_classification/README.md", "diffHunk": "@@ -21,8 +21,12 @@ The above command generated the model's state dict as model.pt and the vocab use\n  * Create a torch model archive using the torch-model-archiver utility to archive the above files.\n  \n     ```bash\n-    torch-model-archiver --model-name my_text_classifier --version 1.0 --model-file model.py --serialized-file model.pt --source-vocab source_vocab.pt --handler text_classifier --extra-files index_to_name.json\n+    torch-model-archiver --model-name my_text_classifier --version 1.0 --model-file model.py --serialized-file model.pt  --handler text_classifier --extra-files \"index_to_name.json,source_vocab.pt\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad923db35db6baa4a59298fcfcc5f685f6bff9e5"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53582f4eea9855de35992b8da9e0d67209b918e6", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/53582f4eea9855de35992b8da9e0d67209b918e6", "committedDate": "2020-06-29T04:33:51Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bde62d64812492a7f29884685aaea63b11482669", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/bde62d64812492a7f29884685aaea63b11482669", "committedDate": "2020-07-06T18:15:20Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06a5452d9b12959a6f2b80546820b6b9ceec0bcc", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/06a5452d9b12959a6f2b80546820b6b9ceec0bcc", "committedDate": "2020-07-09T21:58:13Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26a003251bdf62252b3de6f2548def7cf0dd539d", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/26a003251bdf62252b3de6f2548def7cf0dd539d", "committedDate": "2020-07-20T05:11:40Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d96c4634c98462f51fff4fd28059b5265ed92459", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/d96c4634c98462f51fff4fd28059b5265ed92459", "committedDate": "2020-07-22T12:24:52Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4c7e34f0c1992596d62c42f20208c4aa5521741", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/d4c7e34f0c1992596d62c42f20208c4aa5521741", "committedDate": "2020-07-22T12:49:28Z", "message": "Fixed pylint error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4ea81b0dddbbddc9c37e36163aa3f171967bc67", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/e4ea81b0dddbbddc9c37e36163aa3f171967bc67", "committedDate": "2020-07-22T17:00:39Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a55173372f316fbe775e16df60591d8d8355ff3b", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/a55173372f316fbe775e16df60591d8d8355ff3b", "committedDate": "2020-07-22T19:24:09Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58d1b0428079b73d5ec01f4df7d3dcaa3e068f72", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/58d1b0428079b73d5ec01f4df7d3dcaa3e068f72", "committedDate": "2020-07-22T20:56:49Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fd88b1663394b6974e0669b42340db45a9b7462", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/1fd88b1663394b6974e0669b42340db45a9b7462", "committedDate": "2020-07-23T04:46:06Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a0532d6a78c16b86049746e8c904c5d3c470f3c", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/0a0532d6a78c16b86049746e8c904c5d3c470f3c", "committedDate": "2020-07-23T16:02:40Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75da63f19445e2b556ebb2add498c7bee02eab83", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/75da63f19445e2b556ebb2add498c7bee02eab83", "committedDate": "2020-07-24T03:46:27Z", "message": "Fixed conflicts and merged master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MDU5ODgz", "url": "https://github.com/pytorch/serve/pull/472#pullrequestreview-455059883", "createdAt": "2020-07-24T17:23:30Z", "commit": {"oid": "75da63f19445e2b556ebb2add498c7bee02eab83"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNzoyMzozMFrOG23qkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNzoyOTo1MlrOG2327A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE4ODMwNw==", "bodyText": "@dhaniram-kshirsagar Shouldn't this be --handler /home/serve/examples/custom_image_classifier**.py**? Where is the module_name getting set in case of Custom Handlers?", "url": "https://github.com/pytorch/serve/pull/472#discussion_r460188307", "createdAt": "2020-07-24T17:23:30Z", "author": {"login": "chauhang"}, "path": "model-archiver/README.md", "diffHunk": "@@ -140,13 +137,17 @@ A serialized file (.pt or .pth) should be a checkpoint in case of torchscript an\n \n ### Handler\n \n-Handler can be TorchServe's inbuilt handler name or path to a py to handle custom TorchServe inference logic. TorchServe supports following handlers out or box:\n+Handler can be TorchServe's inbuilt handler name or path to a py file to handle custom TorchServe inference logic. TorchServe supports following handlers out or box:\n 1. `image_classifier`\n 2. `object_detector`\n 3. `text_classifier`\n 4. `image_segmenter`\n \n-For more details refer [default handler documentation](../docs/default_handlers.md)\n+In case of custom handler, if you plan to provide just `module_name` or `module_name:entry_point_function_name` then make sure that it is prefixed with absolute or relative path of python file.\n+e.g. if your custom handler custom_image_classifier.py is in /home/serve/examples then\n+`--handler /home/serve/examples/custom_image_classifier` or if it has my_entry_point module level function then `--handler /home/serve/examples/custom_image_classifier:my_entry_point_func`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75da63f19445e2b556ebb2add498c7bee02eab83"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE5MTQ2OA==", "bodyText": "@dhaniram-kshirsagar Please provide details of actual tests run for backward compatibility", "url": "https://github.com/pytorch/serve/pull/472#discussion_r460191468", "createdAt": "2020-07-24T17:29:52Z", "author": {"login": "chauhang"}, "path": "ts/torch_handler/text_handler.py", "diffHunk": "@@ -27,9 +28,25 @@ def __init__(self):\n     def initialize(self, ctx):\n         super(TextHandler, self).initialize(ctx)\n         self.initialized = False\n-        self.source_vocab = torch.load(self.manifest['model']['sourceVocab'])\n+        source_vocab = self.manifest['model']['sourceVocab'] if 'sourceVocab' in self.manifest['model'] else None\n+        if source_vocab:\n+            # Backward compatibility", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75da63f19445e2b556ebb2add498c7bee02eab83"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "352374af0575b3989fb2f44a72ee7b0837a94f04", "author": {"user": {"login": "dhaniram-kshirsagar", "name": null}}, "url": "https://github.com/pytorch/serve/commit/352374af0575b3989fb2f44a72ee7b0837a94f04", "committedDate": "2020-07-24T19:45:11Z", "message": "Added UT-IT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ddaee56c3337270f13286497aeecfddb549bd9f", "author": {"user": {"login": "harshbafna", "name": "Harsh Bafna"}}, "url": "https://github.com/pytorch/serve/commit/6ddaee56c3337270f13286497aeecfddb549bd9f", "committedDate": "2020-07-29T11:14:01Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "916e063f826e6075bf1f8daeeda30b7ec68d06c8", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/916e063f826e6075bf1f8daeeda30b7ec68d06c8", "committedDate": "2020-07-31T17:22:06Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51887270166955bc95d976752156fe4a866acd06", "author": {"user": {"login": "maaquib", "name": "Aaqib"}}, "url": "https://github.com/pytorch/serve/commit/51887270166955bc95d976752156fe4a866acd06", "committedDate": "2020-07-31T23:44:57Z", "message": "Merge branch 'master' into issue_465"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNDMxMzcx", "url": "https://github.com/pytorch/serve/pull/472#pullrequestreview-460431371", "createdAt": "2020-08-04T01:09:25Z", "commit": {"oid": "51887270166955bc95d976752156fe4a866acd06"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2229, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}