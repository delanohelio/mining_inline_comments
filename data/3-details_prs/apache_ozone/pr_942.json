{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5ODQ3Mjcx", "number": 942, "title": "HDDS-2556. Handle InterruptedException in BlockOutputStream", "bodyText": "What changes were proposed in this pull request?\nAddress sonar violations to handle InterruptedException appropriately.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-2556\nHow was this patch tested?\nSonar plugin in IntelliJ, Clean build, unit tests", "createdAt": "2020-05-19T03:02:03Z", "url": "https://github.com/apache/ozone/pull/942", "merged": true, "mergeCommit": {"oid": "2ca872cad0867fce90964f320203ac101a45da95"}, "closed": true, "closedAt": "2020-05-22T19:52:17Z", "author": {"login": "dineshchitlangia"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcirfszgH2gAyNDE5ODQ3MjcxOjQ3MjhkYjEyMzI4MWRjY2EwYjU2ODY1NmQyZThmYzQ5ZjBlZDJjOWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjlFYmAH2gAyNDE5ODQ3MjcxOjZhNzJhMjAwMTY5YTNjZjE4NGE2NDJkNmRmOTkwMzEyZTZmY2RmZDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4728db123281dcca0b568656d2e8fc49f0ed2c9a", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/4728db123281dcca0b568656d2e8fc49f0ed2c9a", "committedDate": "2020-05-19T03:00:03Z", "message": "HDDS-2556. Handle InterruptedException in BlockOutputStream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NzgwMTMx", "url": "https://github.com/apache/ozone/pull/942#pullrequestreview-415780131", "createdAt": "2020-05-20T23:22:29Z", "commit": {"oid": "4728db123281dcca0b568656d2e8fc49f0ed2c9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMzoyMjozMFrOGYhI-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMzoyMjozMFrOGYhI-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM2MTk3OQ==", "bodyText": "Same code is in multiple places, can we have short utility to do all these in that. So, this will avoid code smell in sonar.", "url": "https://github.com/apache/ozone/pull/942#discussion_r428361979", "createdAt": "2020-05-20T23:22:30Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/client/src/main/java/org/apache/hadoop/hdds/scm/storage/BlockOutputStream.java", "diffHunk": "@@ -317,10 +317,16 @@ private void handleFullBuffer() throws IOException {\n       if (!commitWatcher.getFutureMap().isEmpty()) {\n         waitOnFlushFutures();\n       }\n-    } catch (InterruptedException | ExecutionException e) {\n+    } catch (ExecutionException e) {\n       setIoException(e);\n       adjustBuffersOnException();\n       throw getIoException();\n+    } catch (InterruptedException ex) {\n+      LOG.error(\"Command execution was interrupted.\");\n+      Thread.currentThread().interrupt();\n+      setIoException(ex);\n+      adjustBuffersOnException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4728db123281dcca0b568656d2e8fc49f0ed2c9a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NzgwMjYz", "url": "https://github.com/apache/ozone/pull/942#pullrequestreview-415780263", "createdAt": "2020-05-20T23:22:52Z", "commit": {"oid": "4728db123281dcca0b568656d2e8fc49f0ed2c9a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cdfc37e70e19e43f35608a30b8ac040b7cf7448", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/2cdfc37e70e19e43f35608a30b8ac040b7cf7448", "committedDate": "2020-05-21T03:22:44Z", "message": "addressed review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f5f5e3a3c4cbf46ded06843178be01e9954305f", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/5f5f5e3a3c4cbf46ded06843178be01e9954305f", "committedDate": "2020-05-21T03:38:11Z", "message": "simplified parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13b01eebc4cc3aa734a7bb28584070bcc03fe5e1", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/13b01eebc4cc3aa734a7bb28584070bcc03fe5e1", "committedDate": "2020-05-21T03:42:45Z", "message": "removed unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/cbd320ef9e7523020d76d05d73047351b4b0d278", "committedDate": "2020-05-21T04:19:44Z", "message": "Avoid autounboxing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NDgwMTc0", "url": "https://github.com/apache/ozone/pull/942#pullrequestreview-416480174", "createdAt": "2020-05-21T20:47:19Z", "commit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo0NzoyMFrOGZCTaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo0NzoyMFrOGZCTaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwNTMyMQ==", "bodyText": "Minor NIT: variable name is called skipExecutionException, but when true, we are handling ExecutionException. I think it should be viceversa.", "url": "https://github.com/apache/ozone/pull/942#discussion_r428905321", "createdAt": "2020-05-21T20:47:20Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/client/src/main/java/org/apache/hadoop/hdds/scm/storage/BlockOutputStream.java", "diffHunk": "@@ -654,4 +662,34 @@ private void writeChunkToContainer(ChunkBuffer chunk) throws IOException {\n   public void setXceiverClient(XceiverClientSpi xceiverClient) {\n     this.xceiverClient = xceiverClient;\n   }\n+\n+  /**\n+   * Handles InterruptedExecution.\n+   *\n+   * @param ex\n+   * @param skipExecutionException is optional, if passed as TRUE, then\n+   * handle ExecutionException else skip it.\n+   * @throws IOException\n+   */\n+  private void handleInterruptedException(Exception ex,\n+      boolean skipExecutionException)\n+      throws IOException {\n+    LOG.error(\"Command execution was interrupted.\");\n+    if(skipExecutionException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278"}, "originalPosition": 134}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NDgxNjA1", "url": "https://github.com/apache/ozone/pull/942#pullrequestreview-416481605", "createdAt": "2020-05-21T20:49:35Z", "commit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo0OTozNVrOGZCX1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo0OTozNVrOGZCX1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwNjQ1Mw==", "bodyText": "NIT: javadoc also need to be updated for this.", "url": "https://github.com/apache/ozone/pull/942#discussion_r428906453", "createdAt": "2020-05-21T20:49:35Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/client/src/main/java/org/apache/hadoop/hdds/scm/storage/BlockOutputStream.java", "diffHunk": "@@ -654,4 +662,34 @@ private void writeChunkToContainer(ChunkBuffer chunk) throws IOException {\n   public void setXceiverClient(XceiverClientSpi xceiverClient) {\n     this.xceiverClient = xceiverClient;\n   }\n+\n+  /**\n+   * Handles InterruptedExecution.\n+   *\n+   * @param ex\n+   * @param skipExecutionException is optional, if passed as TRUE, then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278"}, "originalPosition": 126}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NDgxNzY4", "url": "https://github.com/apache/ozone/pull/942#pullrequestreview-416481768", "createdAt": "2020-05-21T20:49:50Z", "commit": {"oid": "cbd320ef9e7523020d76d05d73047351b4b0d278"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a72a200169a3cf184a642d6df990312e6fcdfd8", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/6a72a200169a3cf184a642d6df990312e6fcdfd8", "committedDate": "2020-05-21T22:05:48Z", "message": "renamed variable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3278, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}