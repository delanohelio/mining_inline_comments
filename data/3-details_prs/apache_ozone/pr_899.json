{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MDAzOTE1", "number": 899, "title": "HDDS-3549. TestKeyInputStream#testSeek fails intermittently.", "bodyText": "What changes were proposed in this pull request?\n\nThe test TestKeyInputStream#testSeek compares incorrect metric. This metric compared pendingOps.\n   Assert.assertEquals(readChunkCount, metrics .getContainerOpsMetrics(ContainerProtos.Type.ReadChunk));\nThe PR now compares the correct metric i.e. getContainerOpCountMetrics.\nChanged name for metric value getter to make it more distinct. From getContainerOpsMetrics to getPendingContainerOpCountMetrics.\n\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3549\nHow was this patch tested?\nThe patch fixes a unit test.", "createdAt": "2020-05-06T10:16:19Z", "url": "https://github.com/apache/ozone/pull/899", "merged": true, "mergeCommit": {"oid": "be8a2fcc8773dece81912814ad7b6a4b72aa2718"}, "closed": true, "closedAt": "2020-05-13T05:49:40Z", "author": {"login": "lokeshj1703"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcel53RAH2gAyNDE0MDAzOTE1OjM2NGIzMWFiNzc5OTk1ZDhhMTk1NzFiMWZmOGZjYzIzNjFmMDQ4NjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgyUteAFqTQxMDYwNDU5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/364b31ab779995d8a19571b1ff8fcc2361f04862", "committedDate": "2020-05-06T10:13:30Z", "message": "HDDS-3549. TestKeyInputStream#testSeek fails intermittently."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NTEzNjMy", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-406513632", "createdAt": "2020-05-06T11:14:52Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTk5MzMx", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-407199331", "createdAt": "2020-05-07T07:05:12Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNzowNToxMlrOGRxGJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNzowNToxMlrOGRxGJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI4MzM2Ng==", "bodyText": "So this was comparing pending op count, and now it will compare completed op count.\nBut I don't think this would fix the test failure:\ntestSeek(org.apache.hadoop.ozone.client.rpc.TestKeyInputStream)  Time elapsed: 0.103 s  <<< FAILURE!\njava.lang.AssertionError: expected:<0> but was:<-1>\n  ...\n  at org.apache.hadoop.ozone.client.rpc.TestKeyInputStream.testSeek(TestKeyInputStream.java:259)\n\nNeither pending nor completed count should ever be -1.", "url": "https://github.com/apache/ozone/pull/899#discussion_r421283366", "createdAt": "2020-05-07T07:05:12Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/client/rpc/TestKeyInputStream.java", "diffHunk": "@@ -257,7 +257,7 @@ public void testSeek() throws Exception {\n \n     // Seek operation should not result in any readChunk operation.\n     Assert.assertEquals(readChunkCount, metrics\n-        .getContainerOpsMetrics(ContainerProtos.Type.ReadChunk));\n+        .getContainerOpCountMetrics(ContainerProtos.Type.ReadChunk));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MjIzMjg3", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-407223287", "createdAt": "2020-05-07T07:43:37Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDExNzM2", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-407411736", "createdAt": "2020-05-07T12:14:36Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDM2MjEx", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-407436211", "createdAt": "2020-05-07T12:48:21Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNjA0NTk3", "url": "https://github.com/apache/ozone/pull/899#pullrequestreview-410604597", "createdAt": "2020-05-13T05:49:32Z", "commit": {"oid": "364b31ab779995d8a19571b1ff8fcc2361f04862"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3225, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}