{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NDYzNzMz", "number": 1633, "title": "HDDS-4516. [Doc] Add zh translation to Recon Architecture", "bodyText": "What changes were proposed in this pull request?\nAdd zh translation to Recon Architecture.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4516\nHow was this patch tested?\nno test.", "createdAt": "2020-11-27T08:18:48Z", "url": "https://github.com/apache/ozone/pull/1633", "merged": true, "mergeCommit": {"oid": "1b6f7dbed61a9e70969b6682707ce19e99c459bb"}, "closed": true, "closedAt": "2020-12-17T05:26:50Z", "author": {"login": "sky76093016"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgjGFUAH2gAyNTI4NDYzNzMzOmVlZTZmZThlN2Y1MmRlZTY5Yjg4YTJmYmE5NDYxZjY1ZWUzNzgxMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdm8penAFqTU1NDI4ODk0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eee6fe8e7f52dee69b88a2fba9461f65ee37812a", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/eee6fe8e7f52dee69b88a2fba9461f65ee37812a", "committedDate": "2020-11-27T08:16:08Z", "message": "HDDS-4516. [Doc] Add zh translation to Recon Architecture"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39c3b241d9524e0ac1d85d7587f15832cc952bc2", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/39c3b241d9524e0ac1d85d7587f15832cc952bc2", "committedDate": "2020-11-27T08:58:16Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d95ee86dcb3554a944dc72403acfa38ae28ba12a", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/d95ee86dcb3554a944dc72403acfa38ae28ba12a", "committedDate": "2020-11-27T09:21:08Z", "message": "modify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c004dc953625c10e63e68b3a15261d6c75f29358", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/c004dc953625c10e63e68b3a15261d6c75f29358", "committedDate": "2020-11-27T09:35:27Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bccfe69afb9ce567ddd369bb7366e58d2eeabb39", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/bccfe69afb9ce567ddd369bb7366e58d2eeabb39", "committedDate": "2020-11-30T08:36:16Z", "message": "Modify format"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d04a1abcc4157d6cd592f68314ba69a82cc370fa", "author": {"user": {"login": "cku328", "name": "Neo Yang"}}, "url": "https://github.com/apache/ozone/commit/d04a1abcc4157d6cd592f68314ba69a82cc370fa", "committedDate": "2020-11-30T07:36:49Z", "message": "trigger new CI check"}, "afterCommit": {"oid": "bccfe69afb9ce567ddd369bb7366e58d2eeabb39", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/bccfe69afb9ce567ddd369bb7366e58d2eeabb39", "committedDate": "2020-11-30T08:36:16Z", "message": "Modify format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11d3f1fcda2dd694941a0e6f18765827541f0901", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/11d3f1fcda2dd694941a0e6f18765827541f0901", "committedDate": "2020-11-30T09:01:22Z", "message": "Modify format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "560e3ebc4151726ff3bf4d211f541b4c0b302ef5", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/560e3ebc4151726ff3bf4d211f541b4c0b302ef5", "committedDate": "2020-11-30T09:49:08Z", "message": "Modify format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NjY4MTU3", "url": "https://github.com/apache/ozone/pull/1633#pullrequestreview-544668157", "createdAt": "2020-12-04T05:33:22Z", "commit": {"oid": "560e3ebc4151726ff3bf4d211f541b4c0b302ef5"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f2b33a8af362d51560f6b1ff5dd23cbd4c6475d", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/7f2b33a8af362d51560f6b1ff5dd23cbd4c6475d", "committedDate": "2020-12-04T08:22:24Z", "message": "Recon API document translation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwODkyNzA2", "url": "https://github.com/apache/ozone/pull/1633#pullrequestreview-550892706", "createdAt": "2020-12-13T07:29:08Z", "commit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QwNzoyOTowOFrOIEw6cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QwOTowNToxOFrOIEx2Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg2NjYxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n          \n          \n            \n            Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4efb\u4f55\u95ee\u9898\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541866610", "createdAt": "2020-12-13T07:29:08Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg2NzQ0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n          \n          \n            \n            \u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u6536\u96c6\u548c\u6c47\u603b\u6765\u81ea Ozone Manager\uff08OM\uff09\u3001Storage Container Manager\uff08SCM\uff09\u548c\u6570\u636e\u8282\u70b9\uff08DN\uff09\u7684\u5143\u6570\u636e\uff0c\u5e76\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM \u6216 SCM \u8fc7\u8f7d\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541867441", "createdAt": "2020-12-13T07:34:34Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg2ODQyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \u8303\u4f8b\uff1a/api/v1/metrics/query?query=ratis_leader_election_electionCount\n          \n          \n            \n                \u793a\u4f8b\uff1a/api/v1/metrics/query?query=ratis_leader_election_electionCount", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541868426", "createdAt": "2020-12-13T07:41:39Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5904\u4e8e\u7ed9\u5b9a\u72b6\u6001\u7684\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.\n+    \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c\n+    \n+#### \u96c6\u7fa4\u72b6\u6001\n+\n+* **/clusterState**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/clusterState\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u8fd4\u56de Ozone \u96c6\u7fa4\u5f53\u524d\u72b6\u6001\u7684\u6458\u8981\u3002\n+    \n+     ```json\n+     {\n+     \t\"pipelines\": 5,\n+     \t\"totalDatanodes\": 4,\n+     \t\"healthyDatanodes\": 4,\n+     \t\"storageReport\": {\n+     \t\t\"capacity\": 1081719668736,\n+     \t\t\"used\": 1309212672,\n+     \t\t\"remaining\": 597361258496\n+     \t},\n+     \t\"containers\": 26,\n+     \t\"volumes\": 6,\n+     \t\"buckets\": 26,\n+     \t\"keys\": 25\n+     }\n+     ```\n+     \n+#### \u6570\u636e\u8282\u70b9\n+\n+* **/datanodes**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/datanodes\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u6570\u636e\u8282\u70b9\u3002\n+    \n+    ```json\n+    {\n+     \t\"totalCount\": 4,\n+     \t\"datanodes\": [{\n+     \t\t\"uuid\": \"f8f8cb45-3ab2-4123\",\n+     \t\t\"hostname\": \"localhost-1\",\n+     \t\t\"state\": \"HEALTHY\",\n+     \t\t\"lastHeartbeat\": 1605738400544,\n+     \t\t\"storageReport\": {\n+     \t\t\t\"capacity\": 270429917184,\n+     \t\t\t\"used\": 358805504,\n+     \t\t\t\"remaining\": 119648149504\n+     \t\t},\n+     \t\t\"pipelines\": [{\n+     \t\t\t\"pipelineID\": \"b9415b20-b9bd-4225\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 3,\n+     \t\t\t\"leaderNode\": \"localhost-2\"\n+     \t\t}, {\n+     \t\t\t\"pipelineID\": \"3bf4a9e9-69cc-4d20\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 1,\n+     \t\t\t\"leaderNode\": \"localhost-1\"\n+     \t\t}],\n+     \t\t\"containers\": 17,\n+     \t\t\"leaderCount\": 1\n+     \t},\n+        ...\n+        ]\n+     }\n+     ```\n+     \n+#### \u7ba1\u9053\n+\n+* **/pipelines**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/pipelines\n+    ```\n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u7ba1\u9053\n+    \n+    ```json\n+     {\n+     \t\"totalCount\": 5,\n+     \t\"pipelines\": [{\n+     \t\t\"pipelineId\": \"b9415b20-b9bd-4225\",\n+     \t\t\"status\": \"OPEN\",\n+     \t\t\"leaderNode\": \"localhost-1\",\n+     \t\t\"datanodes\": [\"localhost-1\", \"localhost-2\", \"localhost-3\"],\n+     \t\t\"lastLeaderElection\": 0,\n+     \t\t\"duration\": 23166128,\n+     \t\t\"leaderElections\": 0,\n+     \t\t\"replicationType\": \"RATIS\",\n+     \t\t\"replicationFactor\": 3,\n+     \t\t\"containers\": 0\n+     \t},\n+        ...\n+        ]\n+     }\n+     ```  \n+\n+#### \u4efb\u52a1\n+\n+* **/task/status**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/task/status\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 Recon \u4efb\u52a1\u7684\u72b6\u6001\u3002\n+  \n+    ```json\n+     [\n+       {\n+     \t\"taskName\": \"OmDeltaRequest\",\n+     \t\"lastUpdatedTimestamp\": 1605724099147,\n+     \t\"lastUpdatedSeqNumber\": 186\n+       },\n+       ...\n+     ]\n+    ```\n+    \n+#### \u4f7f\u7528\u7387\n+\n+* **/utilization/fileCount**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/utilization/fileCount\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * volume (\u53ef\u9009)\n+    \n+        \u6839\u636e\u7ed9\u5b9a\u7684\u5377\u540d\u8fc7\u6ee4\u7ed3\u679c\u3002\n+        \n+    * bucket (\u53ef\u9009)\n+    \n+        \u6839\u636e\u7ed9\u5b9a\u7684\u6876\u540d\u8fc7\u6ee4\u7ed3\u679c\u3002\n+        \n+    * fileSize (\u53ef\u9009)\n+\n+        \u6839\u636e\u7ed9\u5b9a\u7684\u6587\u4ef6\u5927\u5c0f\u7b5b\u9009\u7ed3\u679c\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u4e0d\u540c\u6587\u4ef6\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\uff0c\u5176\u4e2d\u54cd\u5e94\u5bf9\u8c61\u4e2d\u7684`fileSize`\u662f\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u7684\u4e0a\u9650\u3002\n+    \n+    ```json\n+     [{\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-0-11685\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-1-41795\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-2-93377\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-3-50336\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 2\n+     }]\n+    ```\n+    \n+#### <a name=\"metrics\"></a> \u6307\u6807\n+\n+* **/metrics/:api**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/metrics/:api\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u8fd9\u662f Prometheus \u7684\u4ee3\u7406\u7aef\u70b9\uff0c\u5e76\u56de\u4f20\u4e0e Prometheus \u7aef\u70b9\u76f8\u540c\u7684\u54cd\u5e94\u3002\n+    \u8303\u4f8b\uff1a/api/v1/metrics/query?query=ratis_leader_election_electionCount", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 472}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg2OTQ2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \n          \n          \n            \n                \u8bf7\u53c2\u9605 [Prometheus HTTP API \u53c2\u8003](https://prometheus.io/docs/prometheus/latest/querying/api/) \u4ee5\u83b7\u53d6\u5b8c\u6574\u7684\u67e5\u8be2\u6587\u6863\u3002\n          \n          \n            \n                \n          \n          \n            \n                 **\u56de\u4f20**", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541869465", "createdAt": "2020-12-13T07:48:01Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5904\u4e8e\u7ed9\u5b9a\u72b6\u6001\u7684\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.\n+    \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c\n+    \n+#### \u96c6\u7fa4\u72b6\u6001\n+\n+* **/clusterState**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/clusterState\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u8fd4\u56de Ozone \u96c6\u7fa4\u5f53\u524d\u72b6\u6001\u7684\u6458\u8981\u3002\n+    \n+     ```json\n+     {\n+     \t\"pipelines\": 5,\n+     \t\"totalDatanodes\": 4,\n+     \t\"healthyDatanodes\": 4,\n+     \t\"storageReport\": {\n+     \t\t\"capacity\": 1081719668736,\n+     \t\t\"used\": 1309212672,\n+     \t\t\"remaining\": 597361258496\n+     \t},\n+     \t\"containers\": 26,\n+     \t\"volumes\": 6,\n+     \t\"buckets\": 26,\n+     \t\"keys\": 25\n+     }\n+     ```\n+     \n+#### \u6570\u636e\u8282\u70b9\n+\n+* **/datanodes**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/datanodes\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u6570\u636e\u8282\u70b9\u3002\n+    \n+    ```json\n+    {\n+     \t\"totalCount\": 4,\n+     \t\"datanodes\": [{\n+     \t\t\"uuid\": \"f8f8cb45-3ab2-4123\",\n+     \t\t\"hostname\": \"localhost-1\",\n+     \t\t\"state\": \"HEALTHY\",\n+     \t\t\"lastHeartbeat\": 1605738400544,\n+     \t\t\"storageReport\": {\n+     \t\t\t\"capacity\": 270429917184,\n+     \t\t\t\"used\": 358805504,\n+     \t\t\t\"remaining\": 119648149504\n+     \t\t},\n+     \t\t\"pipelines\": [{\n+     \t\t\t\"pipelineID\": \"b9415b20-b9bd-4225\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 3,\n+     \t\t\t\"leaderNode\": \"localhost-2\"\n+     \t\t}, {\n+     \t\t\t\"pipelineID\": \"3bf4a9e9-69cc-4d20\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 1,\n+     \t\t\t\"leaderNode\": \"localhost-1\"\n+     \t\t}],\n+     \t\t\"containers\": 17,\n+     \t\t\"leaderCount\": 1\n+     \t},\n+        ...\n+        ]\n+     }\n+     ```\n+     \n+#### \u7ba1\u9053\n+\n+* **/pipelines**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/pipelines\n+    ```\n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u7ba1\u9053\n+    \n+    ```json\n+     {\n+     \t\"totalCount\": 5,\n+     \t\"pipelines\": [{\n+     \t\t\"pipelineId\": \"b9415b20-b9bd-4225\",\n+     \t\t\"status\": \"OPEN\",\n+     \t\t\"leaderNode\": \"localhost-1\",\n+     \t\t\"datanodes\": [\"localhost-1\", \"localhost-2\", \"localhost-3\"],\n+     \t\t\"lastLeaderElection\": 0,\n+     \t\t\"duration\": 23166128,\n+     \t\t\"leaderElections\": 0,\n+     \t\t\"replicationType\": \"RATIS\",\n+     \t\t\"replicationFactor\": 3,\n+     \t\t\"containers\": 0\n+     \t},\n+        ...\n+        ]\n+     }\n+     ```  \n+\n+#### \u4efb\u52a1\n+\n+* **/task/status**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/task/status\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 Recon \u4efb\u52a1\u7684\u72b6\u6001\u3002\n+  \n+    ```json\n+     [\n+       {\n+     \t\"taskName\": \"OmDeltaRequest\",\n+     \t\"lastUpdatedTimestamp\": 1605724099147,\n+     \t\"lastUpdatedSeqNumber\": 186\n+       },\n+       ...\n+     ]\n+    ```\n+    \n+#### \u4f7f\u7528\u7387\n+\n+* **/utilization/fileCount**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/utilization/fileCount\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * volume (\u53ef\u9009)\n+    \n+        \u6839\u636e\u7ed9\u5b9a\u7684\u5377\u540d\u8fc7\u6ee4\u7ed3\u679c\u3002\n+        \n+    * bucket (\u53ef\u9009)\n+    \n+        \u6839\u636e\u7ed9\u5b9a\u7684\u6876\u540d\u8fc7\u6ee4\u7ed3\u679c\u3002\n+        \n+    * fileSize (\u53ef\u9009)\n+\n+        \u6839\u636e\u7ed9\u5b9a\u7684\u6587\u4ef6\u5927\u5c0f\u7b5b\u9009\u7ed3\u679c\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u4e0d\u540c\u6587\u4ef6\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\uff0c\u5176\u4e2d\u54cd\u5e94\u5bf9\u8c61\u4e2d\u7684`fileSize`\u662f\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u7684\u4e0a\u9650\u3002\n+    \n+    ```json\n+     [{\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-0-11685\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-1-41795\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-2-93377\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 1\n+     }, {\n+     \t\"volume\": \"vol-2-04168\",\n+     \t\"bucket\": \"bucket-3-50336\",\n+     \t\"fileSize\": 1024,\n+     \t\"count\": 2\n+     }]\n+    ```\n+    \n+#### <a name=\"metrics\"></a> \u6307\u6807\n+\n+* **/metrics/:api**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/metrics/:api\n+    ```\n+    \n+    **\u53c2\u6570**\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 470}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MDAyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \u56de\u4f20\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u7ba1\u9053\n          \n          \n            \n                \u56de\u4f20\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u7ba1\u9053\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541870026", "createdAt": "2020-12-13T07:51:36Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5904\u4e8e\u7ed9\u5b9a\u72b6\u6001\u7684\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.\n+    \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c\n+    \n+#### \u96c6\u7fa4\u72b6\u6001\n+\n+* **/clusterState**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/clusterState\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u8fd4\u56de Ozone \u96c6\u7fa4\u5f53\u524d\u72b6\u6001\u7684\u6458\u8981\u3002\n+    \n+     ```json\n+     {\n+     \t\"pipelines\": 5,\n+     \t\"totalDatanodes\": 4,\n+     \t\"healthyDatanodes\": 4,\n+     \t\"storageReport\": {\n+     \t\t\"capacity\": 1081719668736,\n+     \t\t\"used\": 1309212672,\n+     \t\t\"remaining\": 597361258496\n+     \t},\n+     \t\"containers\": 26,\n+     \t\"volumes\": 6,\n+     \t\"buckets\": 26,\n+     \t\"keys\": 25\n+     }\n+     ```\n+     \n+#### \u6570\u636e\u8282\u70b9\n+\n+* **/datanodes**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/datanodes\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u6570\u636e\u8282\u70b9\u3002\n+    \n+    ```json\n+    {\n+     \t\"totalCount\": 4,\n+     \t\"datanodes\": [{\n+     \t\t\"uuid\": \"f8f8cb45-3ab2-4123\",\n+     \t\t\"hostname\": \"localhost-1\",\n+     \t\t\"state\": \"HEALTHY\",\n+     \t\t\"lastHeartbeat\": 1605738400544,\n+     \t\t\"storageReport\": {\n+     \t\t\t\"capacity\": 270429917184,\n+     \t\t\t\"used\": 358805504,\n+     \t\t\t\"remaining\": 119648149504\n+     \t\t},\n+     \t\t\"pipelines\": [{\n+     \t\t\t\"pipelineID\": \"b9415b20-b9bd-4225\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 3,\n+     \t\t\t\"leaderNode\": \"localhost-2\"\n+     \t\t}, {\n+     \t\t\t\"pipelineID\": \"3bf4a9e9-69cc-4d20\",\n+     \t\t\t\"replicationType\": \"RATIS\",\n+     \t\t\t\"replicationFactor\": 1,\n+     \t\t\t\"leaderNode\": \"localhost-1\"\n+     \t\t}],\n+     \t\t\"containers\": 17,\n+     \t\t\"leaderCount\": 1\n+     \t},\n+        ...\n+        ]\n+     }\n+     ```\n+     \n+#### \u7ba1\u9053\n+\n+* **/pipelines**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/pipelines\n+    ```\n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u7ba1\u9053", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 359}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MDM0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c\n          \n          \n            \n                \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541870342", "createdAt": "2020-12-13T07:53:56Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5904\u4e8e\u7ed9\u5b9a\u72b6\u6001\u7684\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.\n+    \u54cd\u5e94\u7ed3\u6784\u4e0e`/containers/unhealthy`\u76f8\u540c", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 260}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MDYwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.\n          \n          \n            \n                \u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u53ef\u80fd\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541870605", "createdAt": "2020-12-13T07:55:30Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u5904\u4e8e\u7ed9\u5b9a\u72b6\u6001\u7684\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \u53ef\u80fd\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\u72b6\u6001\u4e3a`MISSING`, `MIS_REPLICATED`, `UNDER_REPLICATED`, `OVER_REPLICATED`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 259}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MTExMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n          \n          \n            \n                    \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u5230limit\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1\u52302 * limit\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541871110", "createdAt": "2020-12-13T07:58:35Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684 UnhealthyContainerMetadata \u5bf9\u8c61\u3002\n+    \n+     ```json\n+     {\n+     \t\"missingCount\": 2,\n+     \t\"underReplicatedCount\": 0,\n+     \t\"overReplicatedCount\": 0,\n+     \t\"misReplicatedCount\": 0,\n+     \t\"containers\": [{\n+     \t\t\"containerID\": 1,\n+     \t\t\"containerState\": \"MISSING\",\n+     \t\t\"unhealthySince\": 1605731029145,\n+     \t\t\"expectedReplicaCount\": 3,\n+     \t\t\"actualReplicaCount\": 0,\n+     \t\t\"replicaDeltaCount\": 3,\n+     \t\t\"reason\": null,\n+     \t\t\"keys\": 7,\n+     \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+     \t\t\"replicas\": [{\n+     \t\t\t\"containerId\": 1,\n+     \t\t\t\"datanodeHost\": \"localhost-1\",\n+     \t\t\t\"firstReportTimestamp\": 1605722960125,\n+     \t\t\t\"lastReportTimestamp\": 1605731230509\n+     \t\t}, \n+            ...\n+            ]\n+     \t},\n+        ...\n+        ]\n+     } \n+     ```\n+     \n+* **/containers/unhealthy/:state**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/unhealthy/:state\n+    ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+    \n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 250}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MTI5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002\n          \n          \n            \n                    \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u5230limit\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1\u52302 * limit\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541871295", "createdAt": "2020-12-13T07:59:39Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n+        \n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+        \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 KeyMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"totalCount\":7,\n+      \"keys\": [\n+        {\n+          \"Volume\":\"vol-1-73141\",\n+          \"Bucket\":\"bucket-3-35816\",\n+          \"Key\":\"key-0-43637\",\n+          \"DataSize\":1000,\n+          \"Versions\":[0],\n+          \"Blocks\": {\n+            \"0\": [\n+              {\n+                \"containerID\":1,\n+                \"localID\":105232659753992201\n+              }\n+            ]\n+          },\n+          \"CreationTime\":\"2020-11-18T18:09:17.722Z\",\n+          \"ModificationTime\":\"2020-11-18T18:09:30.405Z\"\n+        },\n+        ...\n+      ]\n+    }\n+    ```\n+* **/containers/missing**\n+    \n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/missing\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709\u4e22\u5931\u5bb9\u5668\u7684 MissingContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+    \t\"totalCount\": 26,\n+    \t\"containers\": [{\n+    \t\t\"containerID\": 1,\n+    \t\t\"missingSince\": 1605731029145,\n+    \t\t\"keys\": 7,\n+    \t\t\"pipelineID\": \"88646d32-a1aa-4e1a\",\n+    \t\t\"replicas\": [{\n+    \t\t\t\"containerId\": 1,\n+    \t\t\t\"datanodeHost\": \"localhost-1\",\n+    \t\t\t\"firstReportTimestamp\": 1605724047057,\n+    \t\t\t\"lastReportTimestamp\": 1605731201301\n+    \t\t}, \n+            ...\n+            ]\n+    \t},\n+        ...\n+        ]\n+    }\n+    ```\n+* **/containers/:id/replicaHistory**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/replicaHistory\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    \u6ca1\u6709\u53c2\u6570\u3002\n+    \n+    **\u56de\u4f20**\n+\n+    \u56de\u4f20\u7ed9\u5b9a\u5bb9\u5668 ID \u7684\u6240\u6709 ContainerHistory \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    [\n+      {\n+        \"containerId\": 1,\n+        \"datanodeHost\": \"localhost-1\",\n+        \"firstReportTimestamp\": 1605724047057,\n+        \"lastReportTimestamp\": 1605730421294\n+      },\n+      ...\n+    ]\n+    ```\n+* **/containers/unhealthy**\n+\n+    **URL \u7ed3\u6784**\n+     ```\n+     GET /api/v1/containers/unhealthy\n+     ```\n+     \n+    **\u53c2\u6570**\n+    \n+    * batchNum (\u53ef\u9009)\n+\n+        \u56de\u4f20\u7ed3\u679c\u7684\u6279\u53f7(\u5982\u201c\u9875\u7801\u201d)\u3002\n+        \u4f20\u90121\uff0c\u5c06\u56de\u4f20\u8bb0\u5f551\u4ee5\u9650\u5236\u3002\u4f20\u90122\uff0c\u5c06\u56de\u4f20limit + 1 to 2 * limit\uff0c\u7b49\u7b49\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 198}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MTgzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n          \n          \n            \n                    \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684 prevKey \u7684\u5bb9\u5668\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541871839", "createdAt": "2020-12-13T08:02:46Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MTkzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \u8303\u4f8b\uff1aprevKey=1\n          \n          \n            \n                    \u793a\u4f8b\uff1aprevKey=1", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541871939", "createdAt": "2020-12-13T08:03:52Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MTk3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1\n          \n          \n            \n                    \u793a\u4f8b\uff1aprevKey=/vol1/bucket1/key1", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541871977", "createdAt": "2020-12-13T08:04:08Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/interface/ReconApi.zh.md", "diffHunk": "@@ -0,0 +1,498 @@\n+---\n+title: Recon API\n+weight: 4\n+menu:\n+   main:\n+      parent: \"\u7f16\u7a0b\u63a5\u53e3\"\n+summary: Recon \u670d\u52a1\u5668\u652f\u6301 HTTP \u7aef\u70b9\uff0c\u4ee5\u5e2e\u52a9\u6545\u969c\u6392\u9664\u548c\u76d1\u542c Ozone \u96c6\u7fa4\u3002\n+---\n+\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon API v1 \u662f\u4e00\u7ec4 HTTP \u7aef\u70b9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u4e86\u89e3 Ozone \u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\n+\n+### HTTP \u7aef\u70b9\n+\n+#### \u5bb9\u5668\n+\n+* **/containers**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers\n+    ```\n+\n+    **\u53c2\u6570**\n+\n+    * prevKey (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20ID\u5927\u4e8e\u7ed9\u5b9a\u7684prevKey\u7684\u5bb9\u5668\u3002\n+        \u8303\u4f8b\uff1aprevKey=1\n+\n+    * limit (\u53ef\u9009)\n+    \n+        \u53ea\u56de\u4f20\u6709\u9650\u6570\u91cf\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u9650\u5236\u662f1000\u3002\n+    \n+    **\u56de\u4f20**\n+    \n+    \u56de\u4f20\u6240\u6709 ContainerMetadata \u5bf9\u8c61\u3002\n+    \n+    ```json\n+    {\n+      \"data\": {\n+        \"totalCount\": 3,\n+        \"containers\": [\n+          {\n+            \"ContainerID\": 1,\n+            \"NumberOfKeys\": 834\n+          },\n+          {\n+            \"ContainerID\": 2,\n+            \"NumberOfKeys\": 833\n+          },\n+          {\n+            \"ContainerID\": 3,\n+            \"NumberOfKeys\": 833\n+          }\n+        ]\n+      }\n+    }\n+    ```\n+\n+* **/containers/:id/keys**\n+\n+    **URL \u7ed3\u6784**\n+    ```\n+    GET /api/v1/containers/:id/keys\n+    ```\n+    \n+    **\u53c2\u6570**\n+    \n+    * prevKey (\u53ef\u9009)\n+     \n+        \u53ea\u56de\u4f20\u5728\u7ed9\u5b9a\u7684 prevKey \u952e\u524d\u7f00\u4e4b\u540e\u7684\u952e\u3002\n+        \u8303\u4f8b\uff1aprevKey=/vol1/bucket1/key1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MjYyMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u542c\u63a7\u5236\u53f0\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u5c06\u5176\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d\uff0c\u56e0\u4e3a Recon \u53ef\u4ee5\u5728\u5173\u952e\u65f6\u523b\u5e2e\u52a9\u60a8\u5bf9\u96c6\u7fa4\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\u8bf7\u53c2\u9605 [Recon \u67b6\u6784]({{< ref \"concept/Recon.zh.md\" >}})\u4ee5\u83b7\u5f97\u8be6\u7ec6\u7684\u67b6\u6784\u6982\u8ff0\u548c HTTP API \u53c2\u8003\u7684 [Recon API]({{< ref path=\"interface/ReconApi.zh.md\" >}}) \u6587\u6863\u3002\n          \n          \n            \n            Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u542c\u63a7\u5236\u53f0\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u5c06\u5176\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d\uff0c\u56e0\u4e3a Recon \u53ef\u4ee5\u5728\u5173\u952e\u65f6\u523b\u5e2e\u52a9\u60a8\u5bf9\u96c6\u7fa4\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\u8bf7\u53c2\u9605 [Recon \u67b6\u6784]({{< ref \"concept/Recon.zh.md\" >}})\u4ee5\u83b7\u5f97\u8be6\u7ec6\u7684\u67b6\u6784\u6982\u8ff0\u548c[Recon API]({{< ref path=\"interface/ReconApi.zh.md\" >}}) \u6587\u6863\uff0c\u4ee5\u83b7\u5f97 HTTP API \u53c2\u8003\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541872621", "createdAt": "2020-12-13T08:07:45Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/feature/Recon.zh.md", "diffHunk": "@@ -23,27 +23,10 @@ summary: Recon \u662f Ozone \u4e2d\u7528\u4e8e\u5206\u6790\u670d\u52a1\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\n   limitations under the License.\n -->\n \n-Recon \u662f Ozone \u4e2d\u7528\u4e8e\u5206\u6790\u670d\u52a1\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u60a8\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u589e\u52a0\u53ef\u89c6\u6027\u3002\n+Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u542c\u63a7\u5236\u53f0\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u5c06\u5176\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d\uff0c\u56e0\u4e3a Recon \u53ef\u4ee5\u5728\u5173\u952e\u65f6\u523b\u5e2e\u52a9\u60a8\u5bf9\u96c6\u7fa4\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\u8bf7\u53c2\u9605 [Recon \u67b6\u6784]({{< ref \"concept/Recon.zh.md\" >}})\u4ee5\u83b7\u5f97\u8be6\u7ec6\u7684\u67b6\u6784\u6982\u8ff0\u548c HTTP API \u53c2\u8003\u7684 [Recon API]({{< ref path=\"interface/ReconApi.zh.md\" >}}) \u6587\u6863\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MjY5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u662f\u4e00\u4e2a\u5e26\u6709\u81ea\u5df1\u7684 HTTP \u7f51\u9875\u670d\u52a1\u5668\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u3002\n          \n          \n            \n            Recon \u662f\u4e00\u4e2a\u81ea\u5e26 HTTP \u7f51\u9875\u670d\u52a1\u5668\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541872692", "createdAt": "2020-12-13T08:08:34Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/feature/Recon.zh.md", "diffHunk": "@@ -23,27 +23,10 @@ summary: Recon \u662f Ozone \u4e2d\u7528\u4e8e\u5206\u6790\u670d\u52a1\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\n   limitations under the License.\n -->\n \n-Recon \u662f Ozone \u4e2d\u7528\u4e8e\u5206\u6790\u670d\u52a1\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u60a8\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u589e\u52a0\u53ef\u89c6\u6027\u3002\n+Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u542c\u63a7\u5236\u53f0\u3002\u5b83\u662f\u4e00\u4e2a\u53ef\u9009\u7ec4\u4ef6\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u5c06\u5176\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d\uff0c\u56e0\u4e3a Recon \u53ef\u4ee5\u5728\u5173\u952e\u65f6\u523b\u5e2e\u52a9\u60a8\u5bf9\u96c6\u7fa4\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002\u8bf7\u53c2\u9605 [Recon \u67b6\u6784]({{< ref \"concept/Recon.zh.md\" >}})\u4ee5\u83b7\u5f97\u8be6\u7ec6\u7684\u67b6\u6784\u6982\u8ff0\u548c HTTP API \u53c2\u8003\u7684 [Recon API]({{< ref path=\"interface/ReconApi.zh.md\" >}}) \u6587\u6863\u3002\n \n-Recon \u4ece Ozone \u96c6\u7fa4\u4e2d**\u6536\u96c6**\u6240\u6709\u6570\u636e\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5728 SQL\u6570\u636e\u5e93\u4e2d\uff0c\u4ee5\u4fbf\u8fdb\u4e00\u6b65\u5206\u6790\u3002\n-\n- 1. Ozone Manager \u7684\u6570\u636e\u662f\u901a\u8fc7\u5f02\u6b65\u8fc7\u7a0b\u5728\u540e\u53f0\u4e0b\u8f7d\u7684\u3002OM \u4f1a\u5b9a\u671f\u521b\u5efa RocksDB \u5feb\u7167\uff0c\u5e76\u5c06\u589e\u91cf\u6570\u636e\u590d\u5236\u5230 Recon \u8fdb\u884c\u5904\u7406\u3002\n-\n- 2. \u6570\u636e\u8282\u70b9\u4e0d\u4ec5\u53ef\u4ee5\u5c06\u5fc3\u8df3\u53d1\u9001\u5230 SCM\uff0c\u4e5f\u80fd\u53d1\u9001\u5230 Recon\u3002Recon \u53ef\u4ee5\u6210\u4e3a\u5fc3\u8df3\u7684\u552f\u8bfb\uff08Read-only\uff09\u76d1\u542c\u5668\uff0c\u5e76\u6839\u636e\u6536\u5230\u7684\u4fe1\u606f\u66f4\u65b0\u672c\u5730\u6570\u636e\u5e93\u3002\n-\n-\u5f53 Recon \u914d\u7f6e\u5b8c\u6210\u65f6\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u542f\u52a8\u670d\u52a1\u3002\n+Recon \u662f\u4e00\u4e2a\u5e26\u6709\u81ea\u5df1\u7684 HTTP \u7f51\u9875\u670d\u52a1\u5668\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MzA1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n          \n          \n            \n            Recon \u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541873051", "createdAt": "2020-12-13T08:10:46Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MzQ0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n          \n          \n            \n            Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u65f6\u95f4\u70b9\u7684\u6307\u6807\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541873448", "createdAt": "2020-12-13T08:13:14Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MzY1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## \u6301\u7eed\u72b6\u6001\n          \n          \n            \n            ## \u6301\u4e45\u5316\u72b6\u6001", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541873652", "createdAt": "2020-12-13T08:14:28Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NDE3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n          \n          \n            \n             * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n          \n          \n            \n             * [OM database]({{< ref \"concept/OzoneManager.zh.md#\u6301\u4e45\u5316\u72b6\u6001\" >}})\u7684\u672c\u5730\u526f\u672c\n          \n          \n            \n             * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#\u6301\u4e45\u5316\u72b6\u6001\" >}})\u7684\u672c\u5730\u526f\u672c", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541874175", "createdAt": "2020-12-13T08:17:46Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NDU3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n          \n          \n            \n             * \u4ee5\u4e0b\u6570\u636e\u5728 Recon \u4e2d\u6301\u4e45\u5316\u5728\u6307\u5b9a\u7684 RocksDB \u76ee\u5f55\u4e0b\uff1a", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541874575", "createdAt": "2020-12-13T08:20:30Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NTA0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n          \n          \n            \n                     * \u8ddf\u8e2a\u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541875042", "createdAt": "2020-12-13T08:23:35Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NTc3MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9\n          \n          \n            \n                     * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u5f53\u4e00\u4e2a\u5bb9\u5668\u88ab\u62a5\u544a\u4e22\u5931\u65f6\uff0c\u5b83\u88ab\u7528\u6765\u786e\u5b9a\u6700\u540e\u5df2\u77e5\u7684\u6570\u636e\u8282\u70b9\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541875770", "createdAt": "2020-12-13T08:27:34Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n+     * ContainerHistory \u8868\n+         * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NTk3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\uff08MISSING\uff0cUNDER_REPLICATED\uff0cOVER_REPLICATED\uff0cMIS_REPLICATED\uff09\n          \n          \n            \n                     * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u7684\u5bb9\u5668\uff08MISSING\u3001UNDER_REPLICATED\u3001OVER_REPLICATED\u3001MIS_REPLICATED\uff09", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541875976", "createdAt": "2020-12-13T08:29:18Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n+     * ContainerHistory \u8868\n+         * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9\n+     * UnhealthyContainers \u8868\n+         * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\uff08MISSING\uff0cUNDER_REPLICATED\uff0cOVER_REPLICATED\uff0cMIS_REPLICATED\uff09", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NjYxNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ozone.recon.sql.db.jooq.dialect | DERBY | \u8bf7\u53c2\u8003 [SQL \u65b9\u8a00](https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html) \u6307\u5b9a\u5176\u4ed6\u65b9\u8a00\u3002\n          \n          \n            \n            ozone.recon.sql.db.jooq.dialect | DERBY | \u8bf7\u53c2\u8003 [SQL \u65b9\u8a00](https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html) \u6765\u6307\u5b9a\u4e0d\u540c\u7684\u65b9\u8a00\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541876614", "createdAt": "2020-12-13T08:33:13Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n+     * ContainerHistory \u8868\n+         * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9\n+     * UnhealthyContainers \u8868\n+         * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\uff08MISSING\uff0cUNDER_REPLICATED\uff0cOVER_REPLICATED\uff0cMIS_REPLICATED\uff09\n+\n+\n+## \u9700\u8981\u5173\u6ce8\u7684\u914d\u7f6e\u9879\n+\n+\u914d\u7f6e\u9879 |\u9ed8\u8ba4\u503c | <div style=\"width:300px;\">\u63cf\u8ff0</div>\n+----|---------|------------\n+ozone.recon.http-address | 0.0.0.0:9888 | Recon web UI \u76d1\u542c\u7684\u5730\u5740\u548c\u57fa\u672c\u7aef\u53e3\u3002\n+ozone.recon.address | 0.0.0.0:9891 | Recon \u7684 RPC \u5730\u5740\u3002\n+ozone.recon.db.dir | none | Recon Server \u5b58\u50a8\u5176\u5143\u6570\u636e\u7684\u76ee\u5f55\u3002\n+ozone.recon.om.db.dir | none | Recon Server \u5b58\u50a8\u5176 OM \u5feb\u7167 DB \u7684\u76ee\u5f55\u3002\n+ozone.recon.om.snapshot<br>.task.interval.delay | 10m | Recon \u4ee5\u5206\u949f\u95f4\u9694\u8bf7\u6c42 OM DB \u5feb\u7167\u3002\n+ozone.recon.task<br>.missingcontainer.interval | 300s | \u5b9a\u671f\u68c0\u67e5\u96c6\u7fa4\u4e2d\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u65f6\u95f4\u95f4\u9694\u3002\n+ozone.recon.sql.db.jooq.dialect | DERBY | \u8bf7\u53c2\u8003 [SQL \u65b9\u8a00](https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html) \u6307\u5b9a\u5176\u4ed6\u65b9\u8a00\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NjgwOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ozone.recon.sql.db.username | none | Recon SQL database \u7684 username\u3002\n          \n          \n            \n            ozone.recon.sql.db.password | none | Recon SQL database \u7684 password\u3002\n          \n          \n            \n            ozone.recon.sql.db.username | none | Recon SQL\u6570\u636e\u5e93\u7684\u7528\u6237\u540d\u3002\n          \n          \n            \n            ozone.recon.sql.db.password | none | Recon SQL\u6570\u636e\u5e93\u7684\u5bc6\u7801\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541876809", "createdAt": "2020-12-13T08:34:41Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n+     * ContainerHistory \u8868\n+         * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9\n+     * UnhealthyContainers \u8868\n+         * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\uff08MISSING\uff0cUNDER_REPLICATED\uff0cOVER_REPLICATED\uff0cMIS_REPLICATED\uff09\n+\n+\n+## \u9700\u8981\u5173\u6ce8\u7684\u914d\u7f6e\u9879\n+\n+\u914d\u7f6e\u9879 |\u9ed8\u8ba4\u503c | <div style=\"width:300px;\">\u63cf\u8ff0</div>\n+----|---------|------------\n+ozone.recon.http-address | 0.0.0.0:9888 | Recon web UI \u76d1\u542c\u7684\u5730\u5740\u548c\u57fa\u672c\u7aef\u53e3\u3002\n+ozone.recon.address | 0.0.0.0:9891 | Recon \u7684 RPC \u5730\u5740\u3002\n+ozone.recon.db.dir | none | Recon Server \u5b58\u50a8\u5176\u5143\u6570\u636e\u7684\u76ee\u5f55\u3002\n+ozone.recon.om.db.dir | none | Recon Server \u5b58\u50a8\u5176 OM \u5feb\u7167 DB \u7684\u76ee\u5f55\u3002\n+ozone.recon.om.snapshot<br>.task.interval.delay | 10m | Recon \u4ee5\u5206\u949f\u95f4\u9694\u8bf7\u6c42 OM DB \u5feb\u7167\u3002\n+ozone.recon.task<br>.missingcontainer.interval | 300s | \u5b9a\u671f\u68c0\u67e5\u96c6\u7fa4\u4e2d\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u65f6\u95f4\u95f4\u9694\u3002\n+ozone.recon.sql.db.jooq.dialect | DERBY | \u8bf7\u53c2\u8003 [SQL \u65b9\u8a00](https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html) \u6307\u5b9a\u5176\u4ed6\u65b9\u8a00\u3002\n+ozone.recon.sql.db.jdbc.url | jdbc:derby:${ozone.recon.db.dir}<br>/ozone_recon_derby.db | Recon SQL database \u7684 jdbc url\u3002\n+ozone.recon.sql.db.username | none | Recon SQL database \u7684 username\u3002\n+ozone.recon.sql.db.password | none | Recon SQL database \u7684 password\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3Njg1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ozone.recon.sql.db.driver | org.apache.derby.jdbc<br>.EmbeddedDriver | Recon SQL database \u7684 jdbc driver\u3002\n          \n          \n            \n            ozone.recon.sql.db.driver | org.apache.derby.jdbc<br>.EmbeddedDriver | Recon SQL\u6570\u636e\u5e93\u7684 jdbc driver\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541876858", "createdAt": "2020-12-13T08:35:06Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n+\n+## API \u53c2\u8003\n+\n+[\u94fe\u63a5\u5230\u5b8c\u6574\u7684 API \u53c2\u8003]({{< ref path=\"interface/ReconApi.zh.md\" >}})\n+   \n+## \u6301\u7eed\u72b6\u6001\n+\n+ * [OM database]({{< ref \"concept/OzoneManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * [SCM database]({{< ref \"concept/StorageContainerManager.zh.md#persisted-state\" >}})\u7684\u672c\u5730\u526f\u672c\n+ * \u4ee5\u4e0b\u6570\u636e\u5c06\u4fdd\u7559\u5728\u6307\u5b9a RocksDB \u76ee\u5f55\u4e2d\u7684 Recon \u4e2d\uff1a \n+     * ContainerKey \u8868\n+         * \u5b58\u50a8\u6620\u5c04\uff08\u5bb9\u5668\uff0c\u952e\uff09 -> \u8ba1\u6570\n+     * ContainerKeyCount \u8868\n+         * \u5b58\u50a8\u5bb9\u5668 ID  -> \u5bb9\u5668\u5185\u7684\u952e\u6570\n+ * \u4ee5\u4e0b\u6570\u636e\u5b58\u50a8\u5728\u5df2\u914d\u7f6e\u7684 SQL \u6570\u636e\u5e93\u4e2d\uff08\u9ed8\u8ba4\u4e3a Derby \uff09\uff1a\n+     * GlobalStats \u8868\n+         * \u4e00\u4e2a\u952e -> Value table \u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u4e2d\u51fa\u73b0\u7684\u5377/\u6876/\u952e\u7684\u603b\u6570\u7b49\u805a\u5408\u4fe1\u606f\n+     * FileCountBySize \u8868\n+         * \u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u6570\u91cf\n+     * ReconTaskStatus \u8868\n+         * \u5728[Recon \u4efb\u52a1\u6846\u67b6](#task-framework)\u4e2d\u8ddf\u8e2a\u5df2\u6ce8\u518c\u7684 OM \u548c SCM DB \u4efb\u52a1\u7684\u72b6\u6001\u548c\u6700\u540e\u8fd0\u884c\u65f6\u95f4\u6233\n+     * ContainerHistory \u8868\n+         * \u5b58\u50a8\u5bb9\u5668\u526f\u672c -> \u5177\u6709\u6700\u65b0\u5df2\u77e5\u65f6\u95f4\u6233\u8bb0\u7684\u6570\u636e\u8282\u70b9\u6620\u5c04\u3002\u7528\u4e8e\u786e\u5b9a\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u65f6\u7684\u6700\u540e\u4e00\u4e2a\u5df2\u77e5\u6570\u636e\u8282\u70b9\n+     * UnhealthyContainers \u8868\n+         * \u968f\u65f6\u8ddf\u8e2a\u96c6\u7fa4\u4e2d\u6240\u6709\u4e0d\u5065\u5eb7\u5bb9\u5668\uff08MISSING\uff0cUNDER_REPLICATED\uff0cOVER_REPLICATED\uff0cMIS_REPLICATED\uff09\n+\n+\n+## \u9700\u8981\u5173\u6ce8\u7684\u914d\u7f6e\u9879\n+\n+\u914d\u7f6e\u9879 |\u9ed8\u8ba4\u503c | <div style=\"width:300px;\">\u63cf\u8ff0</div>\n+----|---------|------------\n+ozone.recon.http-address | 0.0.0.0:9888 | Recon web UI \u76d1\u542c\u7684\u5730\u5740\u548c\u57fa\u672c\u7aef\u53e3\u3002\n+ozone.recon.address | 0.0.0.0:9891 | Recon \u7684 RPC \u5730\u5740\u3002\n+ozone.recon.db.dir | none | Recon Server \u5b58\u50a8\u5176\u5143\u6570\u636e\u7684\u76ee\u5f55\u3002\n+ozone.recon.om.db.dir | none | Recon Server \u5b58\u50a8\u5176 OM \u5feb\u7167 DB \u7684\u76ee\u5f55\u3002\n+ozone.recon.om.snapshot<br>.task.interval.delay | 10m | Recon \u4ee5\u5206\u949f\u95f4\u9694\u8bf7\u6c42 OM DB \u5feb\u7167\u3002\n+ozone.recon.task<br>.missingcontainer.interval | 300s | \u5b9a\u671f\u68c0\u67e5\u96c6\u7fa4\u4e2d\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u65f6\u95f4\u95f4\u9694\u3002\n+ozone.recon.sql.db.jooq.dialect | DERBY | \u8bf7\u53c2\u8003 [SQL \u65b9\u8a00](https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html) \u6307\u5b9a\u5176\u4ed6\u65b9\u8a00\u3002\n+ozone.recon.sql.db.jdbc.url | jdbc:derby:${ozone.recon.db.dir}<br>/ozone_recon_derby.db | Recon SQL database \u7684 jdbc url\u3002\n+ozone.recon.sql.db.username | none | Recon SQL database \u7684 username\u3002\n+ozone.recon.sql.db.password | none | Recon SQL database \u7684 password\u3002\n+ozone.recon.sql.db.driver | org.apache.derby.jdbc<br>.EmbeddedDriver | Recon SQL database \u7684 jdbc driver\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3NzQxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002\n          \n          \n            \n            Recon \u53ef\u4ee5\u4e0e\u4efb\u4f55\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/\u6307\u6807]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541877416", "createdAt": "2020-12-13T08:38:48Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n+\n+## Recon \u548c Prometheus\n+\n+Recon \u53ef\u4ee5\u4e0e\u914d\u7f6e\u4e3a\u6536\u96c6\u6307\u6807\u7684\u4efb\u4f55 Prometheus \u5b9e\u4f8b\u96c6\u6210\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6570\u636e\u8282\u70b9\u548c Pipelines \u9875\u9762\u7684 Recon UI \u4e2d\u663e\u793a\u6709\u7528\u7684\u4fe1\u606f\u3002Recon \u8fd8\u516c\u5f00\u4e86\u4e00\u4e2a\u4ee3\u7406\u7aef\u70b9 ([/metrics]({{< ref path=\"interface/ReconApi.zh.md#metrics\" >}})) \u6765\u67e5\u8be2 Prometheus\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06\u6b64\u914d\u7f6e`ozone.recon.prometheus.http.endpoint`\u8bbe\u7f6e\u4e3a Prometheus \u7aef\u70b9\u5982`ozone.recon.prometheus.http.endpoint=localhost:9090`\u6765\u542f\u7528\u6b64\u96c6\u6210\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3ODY2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n          \n          \n            \n            `ReconOmTask`\u7684\u4e00\u4e2a\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u6301\u4e45\u5316\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u5bb9\u5668\u88ab\u62a5\u544a\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u7684\u8fd0\u884c\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541878661", "createdAt": "2020-12-13T08:46:15Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3OTE1NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002\n          \n          \n            \n            `ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\u3001`MIS_REPLICATED`\u3001`UNDER_REPLICATED`\u3001`OVER_REPLICATED`\uff09\u6301\u4e45\u5316\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541879154", "createdAt": "2020-12-13T08:48:48Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n+\n+## Recon \u548c Storage Container Manager\n+\n+{{<figure src=\"/concept/ReconScmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u8fd8\u5145\u5f53\u6570\u636e\u8282\u70b9\u7684\u88ab\u52a8 SCM\u3002\u5728\u96c6\u7fa4\u4e2d\u914d\u7f6e Recon \u65f6\uff0c\u6240\u6709\u6570\u636e\u8282\u70b9\u90fd\u5411 Recon \u6ce8\u518c\uff0c\u5e76\u50cf SCM \u4e00\u6837\u5411 Recon \u53d1\u9001\u5fc3\u8df3\u3001\u5bb9\u5668\u62a5\u544a\u3001\u589e\u91cf\u5bb9\u5668\u62a5\u544a\u7b49\u3002Recon \u4f7f\u7528\u5b83\u4ece\u6570\u636e\u8282\u70b9\u5f97\u5230\u7684\u6240\u6709\u4fe1\u606f\u5728\u672c\u5730\u6784\u5efa\u81ea\u5df1\u7684 SCM rocks DB \u526f\u672c\u3002Recon \u4ece\u4e0d\u5411\u6570\u636e\u8282\u70b9\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4f5c\u4e3a\u54cd\u5e94\uff0c\u800c\u53ea\u662f\u5145\u5f53\u88ab\u52a8 SCM \u4ee5\u66f4\u5feb\u5730\u67e5\u627e SCM \u5143\u6570\u636e\u3002\n+\n+## <a name=\"task-framework\"></a> \u4efb\u52a1\u6846\u67b6\n+\n+Recon \u6709\u5176\u81ea\u5df1\u7684\u4efb\u52a1\u6846\u67b6\uff0c\u53ef\u5bf9\u4ece OM \u548c SCM \u83b7\u5f97\u7684\u6570\u636e\u8fdb\u884c\u6279\u5904\u7406\u3002\u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5728 OM DB \u6216 SCM DB \u4e0a\u76d1\u542c\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e8b\u4ef6\uff0c\u5982`PUT`\u3001`DELETE`\u3001`UPDATE`\u7b49\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4efb\u52a1\u5b9e\u73b0`org.apache.hadoop.ozone.recon.tasks.ReconOmTask`\u6216\u8005\u6269\u5c55`org.apache.hadoop.ozone.recon.scm.ReconScmTask`\u3002\n+\n+`ReconOmTask`\u7684\u793a\u4f8b\u662f`ContainerKeyMapperTask`\uff0c\u5b83\u5728 RocksDB \u4e2d\u4fdd\u7559\u4e86\u5bb9\u5668 -> \u952e\u6620\u5c04\u3002\u5f53\u62a5\u544a\u5bb9\u5668\u4e22\u5931\u6216\u5904\u4e8e\u4e0d\u5065\u5eb7\u8fd0\u884c\u72b6\u51b5\u7684\u72b6\u6001\u65f6\uff0c\u8fd9\u6709\u52a9\u4e8e\u4e86\u89e3\u54ea\u4e9b\u952e\u662f\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u3002\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f`FileSizeCountTask`\uff0c\u5b83\u8ddf\u8e2a SQL \u6570\u636e\u5e93\u4e2d\u7ed9\u5b9a\u6587\u4ef6\u5927\u5c0f\u8303\u56f4\u5185\u7684\u6587\u4ef6\u8ba1\u6570\u3002\u8fd9\u4e9b\u4efb\u52a1\u5177\u6709\u4e24\u79cd\u60c5\u51b5\u7684\u5b9e\u73b0\uff1a\n+ \n+ - \u5b8c\u6574\u5feb\u7167\uff08reprocess()\uff09\n+ - \u589e\u91cf\u66f4\u65b0\uff08process()\uff09\n+ \n+\u5f53\u4ece\u9886\u5bfc\u8005 OM \u83b7\u5f97 OM DB \u7684\u5b8c\u6574\u5feb\u7167\u65f6\uff0c\u5c06\u5bf9\u6240\u6709\u6ce8\u518c\u7684 OM \u4efb\u52a1\u8c03\u7528 reprocess()\u3002\u5728\u968f\u540e\u7684\u589e\u91cf\u66f4\u65b0\u4e2d\uff0c\u5c06\u5728\u8fd9\u4e9b OM \u4efb\u52a1\u4e0a\u8c03\u7528 process()\u3002\n+\n+`ReconScmTask`\u7684\u793a\u4f8b\u662f`ContainerHealthTask`\uff0c\u5b83\u4ee5\u53ef\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u8fd0\u884c\uff0c\u626b\u63cf\u6240\u6709\u5bb9\u5668\u7684\u5217\u8868\uff0c\u5e76\u5c06\u4e0d\u5065\u5eb7\u5bb9\u5668\u7684\u72b6\u6001\uff08`MISSING`\uff0c`MIS_REPLICATED`\uff0c`UNDER_REPLICATED`\uff0c`OVER_REPLICATED`\uff09\u4fdd\u7559\u5728 SQL \u8868\u4e2d\u3002\u6b64\u4fe1\u606f\u7528\u4e8e\u786e\u5b9a\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u4e22\u5931\u7684\u5bb9\u5668\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg4MTg5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n          \n          \n            \n            Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \u7684 RPC \u8c03\u7528\uff0c\u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u4f1a\u518d\u6b21\u8bf7\u6c42\u4e00\u4e2a\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u80fd\u4f1a\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u7684\u3002\n          \n          \n            \n            \n          \n          \n            \n            \u7136\u540e\uff0c\u4eceOM\u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\u4f1a\u88ab\u8f6c\u6362\u6210\u4e00\u6279\u4e8b\u4ef6\uff0c\u7531 OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u4e00\u6b65\u5904\u7406\u3002", "url": "https://github.com/apache/ozone/pull/1633#discussion_r541881895", "createdAt": "2020-12-13T09:05:18Z", "author": {"login": "cku328"}, "path": "hadoop-hdds/docs/content/concept/Recon.zh.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+title: \"Recon\"\n+date: \"2020-10-27\"\n+weight: 8\n+menu: \n+  main:\n+     parent: \u6982\u5ff5\n+summary: Recon \u4f5c\u4e3a Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\n+---\n+<!---\n+  Licensed to the Apache Software Foundation (ASF) under one or more\n+  contributor license agreements.  See the NOTICE file distributed with\n+  this work for additional information regarding copyright ownership.\n+  The ASF licenses this file to You under the Apache License, Version 2.0\n+  (the \"License\"); you may not use this file except in compliance with\n+  the License.  You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+  Unless required by applicable law or agreed to in writing, software\n+  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  See the License for the specific language governing permissions and\n+  limitations under the License.\n+-->\n+\n+Recon \u5145\u5f53 Ozone \u7684\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002\u5b83\u63d0\u4f9b\u4e86 Ozone \u7684\u9e1f\u77b0\u56fe\uff0c\u5e76\u901a\u8fc7\u57fa\u4e8e REST \u7684 API \u548c\u4e30\u5bcc\u7684\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u5c55\u793a\u4e86\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4ece\u800c\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u4e86\u4efb\u4f55\u95ee\u9898\u3002\n+\n+\n+## \u9ad8\u5c42\u6b21\u8bbe\u8ba1\n+\n+{{<figure src=\"/concept/ReconHighLevelDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+\u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0cRecon \u4ece Ozone Manager\uff08OM\uff09\u6536\u96c6\u548c\u6c47\u603b\u5143\u6570\u636e\uff0cStorage Container Manager\uff08SCM\uff09\u548c Datanodes\uff08DN\uff09\u5145\u5f53\u4e2d\u592e\u7ba1\u7406\u548c\u76d1\u89c6\u63a7\u5236\u53f0\u3002Ozone \u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528 Recon \u67e5\u8be2\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u4f7f OM  \u6216 SCM \u8fc7\u8f7d\u3002\n+\n+Recon\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u652f\u6301\u6279\u5904\u7406\uff0c\u66f4\u5feb\u7684\u67e5\u8be2\u548c\u6301\u4e45\u5316\u805a\u5408\u4fe1\u606f\u3002\u5b83\u7ef4\u62a4 OM DB \u548c SCM DB \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u53ca\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u805a\u5408\u4fe1\u606f\u7684 SQL \u6570\u636e\u5e93\u3002\n+\n+Recon \u8fd8\u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u4e00\u4e2a HTTP \u7aef\u70b9\u6765\u67e5\u8be2 Prometheus \u7684 Ozone \u6307\u6807\uff0c\u5e76\u5728\u7f51\u9875\u7528\u6237\u754c\u9762\uff08Web UI\uff09\u4e2d\u663e\u793a\u4e00\u4e9b\u5173\u952e\u7684\u65f6\u95f4\u70b9\u6307\u6807\u3002\n+\n+## Recon \u548c Ozone Manager\n+\n+{{<figure src=\"/concept/ReconOmDesign.png\" width=\"800px\">}}\n+\n+<br/>\n+\n+Recon \u6700\u521d\u4ece\u9886\u5bfc\u8005 OM \u7684 HTTP \u7aef\u70b9\u83b7\u53d6 OM rocks DB \u7684\u5b8c\u6574\u5feb\u7167\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u5e76\u521d\u59cb\u5316 RocksDB \u4ee5\u8fdb\u884c\u672c\u5730\u67e5\u8be2\u3002\u901a\u8fc7\u5bf9\u6700\u540e\u4e00\u4e2a\u5e94\u7528\u7684\u5e8f\u5217 ID \uff0cRPC calls \u5b9a\u671f\u8bf7\u6c42\u9886\u5bfc\u8005 OM \u8fdb\u884c\u589e\u91cf\u66f4\u65b0\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u5e93\u4fdd\u6301\u540c\u6b65\u3002\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u65e0\u6cd5\u68c0\u7d22\u589e\u91cf\u66f4\u65b0\u6216\u5c06\u5176\u5e94\u7528\u4e8e\u672c\u5730\u6570\u636e\u5e93\uff0c\u5219\u518d\u6b21\u8bf7\u6c42\u5b8c\u6574\u5feb\u7167\u4ee5\u4f7f\u672c\u5730\u6570\u636e\u5e93\u4e0e OM DB \u4fdd\u6301\u540c\u6b65\u3002\u56e0\u6b64\uff0cRecon \u53ef\u4ee5\u663e\u793a\u9648\u65e7\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u672c\u5730\u6570\u636e\u5e93\u4e0d\u4f1a\u603b\u662f\u540c\u6b65\u3002\u4ece OM \u68c0\u7d22\u5230\u7684\u6570\u636e\u5e93\u66f4\u65b0\uff0c\u7136\u540e\u8f6c\u6362\u4e3a\u4e00\u6279\u4e8b\u4ef6\uff0c\u4ee5\u4fbf OM DB \u4efb\u52a1\u901a\u8fc7 [Recon \u4efb\u52a1\u6846\u67b6](#task-framework) \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1297c51c26482b4ece2754fbd51abb62d0f0484b", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/1297c51c26482b4ece2754fbd51abb62d0f0484b", "committedDate": "2020-12-14T05:58:17Z", "message": "Modify related documents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b95408df97767f3d57b0c36b6340d7e06dbd9985", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/b95408df97767f3d57b0c36b6340d7e06dbd9985", "committedDate": "2020-12-04T08:50:33Z", "message": "Recon API document translation"}, "afterCommit": {"oid": "1297c51c26482b4ece2754fbd51abb62d0f0484b", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/1297c51c26482b4ece2754fbd51abb62d0f0484b", "committedDate": "2020-12-14T05:58:17Z", "message": "Modify related documents"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2880a76a56cca35efe9abecbe5a0399df1dd837", "author": {"user": null}, "url": "https://github.com/apache/ozone/commit/e2880a76a56cca35efe9abecbe5a0399df1dd837", "committedDate": "2020-12-17T03:24:51Z", "message": "Checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0Mjg4OTQz", "url": "https://github.com/apache/ozone/pull/1633#pullrequestreview-554288943", "createdAt": "2020-12-17T05:25:58Z", "commit": {"oid": "e2880a76a56cca35efe9abecbe5a0399df1dd837"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1987, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}