{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0Mjk0NTgw", "number": 976, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozMDo1OVrOEAaUkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozMzowM1rOEAaXhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4ODY2NzA2OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/HddsUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozMDo1OVrOGbq_9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMzozMToyMVrOGcNpjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2OTIzOA==", "bodyText": "Thanks @ChenSammi for the analysis and the changes.\nIt looks like the \"current time\" change is not related to this, please let me know your thoughts.", "url": "https://github.com/apache/ozone/pull/976#discussion_r431669238", "createdAt": "2020-05-28T08:30:59Z", "author": {"login": "rakeshadr"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/HddsUtils.java", "diffHunk": "@@ -465,11 +464,11 @@ public static ObjectName registerWithJmxProperties(\n   }\n \n   /**\n-   * Get the current UTC time in milliseconds.\n-   * @return the current UTC time in milliseconds.\n+   * Get the current time in milliseconds.\n+   * @return the current time in milliseconds.\n    */\n-  public static long getUtcTime() {\n-    return Calendar.getInstance(UTC_ZONE).getTimeInMillis();\n+  public static long getTime() {\n+    return System.currentTimeMillis();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c0c60632c03b2fa6ef971402b6cca4efadfd98f"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzNjk0MQ==", "bodyText": "It's part of another PR.  Will upload a clean patch.", "url": "https://github.com/apache/ozone/pull/976#discussion_r432236941", "createdAt": "2020-05-29T03:31:21Z", "author": {"login": "ChenSammi"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/HddsUtils.java", "diffHunk": "@@ -465,11 +464,11 @@ public static ObjectName registerWithJmxProperties(\n   }\n \n   /**\n-   * Get the current UTC time in milliseconds.\n-   * @return the current UTC time in milliseconds.\n+   * Get the current time in milliseconds.\n+   * @return the current time in milliseconds.\n    */\n-  public static long getUtcTime() {\n-    return Calendar.getInstance(UTC_ZONE).getTimeInMillis();\n+  public static long getTime() {\n+    return System.currentTimeMillis();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2OTIzOA=="}, "originalCommit": {"oid": "7c0c60632c03b2fa6ef971402b6cca4efadfd98f"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4ODY3NDYwOnYy", "diffSide": "RIGHT", "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/KeyManagerImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozMzowM1rOGbrEuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMzozNzo1MVrOGcNuqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3MDQ1Ng==", "bodyText": "It looks to me an opportunity to add a unit test, can we? Thanks!", "url": "https://github.com/apache/ozone/pull/976#discussion_r431670456", "createdAt": "2020-05-28T08:33:03Z", "author": {"login": "rakeshadr"}, "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/KeyManagerImpl.java", "diffHunk": "@@ -2037,11 +2037,11 @@ private void listStatusFindKeyInTableCache(\n                 // if entry is a directory\n                 if (!deletedKeySet.contains(entryInDb)) {\n                   if (!entryKeyName.equals(immediateChild)) {\n-                    OmKeyInfo fakeDirEntry = new OmKeyInfo.Builder()\n-                        .setVolumeName(omKeyInfo.getVolumeName())\n-                        .setBucketName(omKeyInfo.getBucketName())\n-                        .setKeyName(immediateChild)\n-                        .build();\n+                    OmKeyInfo fakeDirEntry = createDirectoryKey(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c0c60632c03b2fa6ef971402b6cca4efadfd98f"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzODI1MQ==", "bodyText": "I find an easy way to reproduce the issue.  Use \"key put\" to upload an object with a path like object name, for example \"object-dir/object-name\", then use \"fs -ls\" to list the bucket.", "url": "https://github.com/apache/ozone/pull/976#discussion_r432238251", "createdAt": "2020-05-29T03:37:51Z", "author": {"login": "ChenSammi"}, "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/KeyManagerImpl.java", "diffHunk": "@@ -2037,11 +2037,11 @@ private void listStatusFindKeyInTableCache(\n                 // if entry is a directory\n                 if (!deletedKeySet.contains(entryInDb)) {\n                   if (!entryKeyName.equals(immediateChild)) {\n-                    OmKeyInfo fakeDirEntry = new OmKeyInfo.Builder()\n-                        .setVolumeName(omKeyInfo.getVolumeName())\n-                        .setBucketName(omKeyInfo.getBucketName())\n-                        .setKeyName(immediateChild)\n-                        .build();\n+                    OmKeyInfo fakeDirEntry = createDirectoryKey(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3MDQ1Ng=="}, "originalCommit": {"oid": "7c0c60632c03b2fa6ef971402b6cca4efadfd98f"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4178, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}