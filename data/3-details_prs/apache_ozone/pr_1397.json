{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwMDcyOTY2", "number": 1397, "title": "HDDS-4211. [OFS] Better owner and group display for listing Ozone volumes and buckets", "bodyText": "What changes were proposed in this pull request?\nImprove volumes' and buckets' owner and group display when listing root and in volumes in OFS.\n\nDisplay short name instead of full Kerberos principal.\nFor volumes, get actual group of the owner (currently it is the volume admin name which is incorrect)\nFor buckets, display the owner and group of its parent volume.\n\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4211\nHow was this patch tested?\nModified testListStatusRootAndVolumeNonRecursive to add the owner and group check for volumes and buckets listing.", "createdAt": "2020-09-04T20:37:27Z", "url": "https://github.com/apache/ozone/pull/1397", "merged": true, "mergeCommit": {"oid": "bfa2801ddeb50e21438ffa3ac2481517e3cc60f2"}, "closed": true, "closedAt": "2020-09-09T18:20:12Z", "author": {"login": "smengcl"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFrUgDAH2gAyNDgwMDcyOTY2OmUwOTk0ZjIzNDM3YzgxZGVhZTIwYjY2MzE2YjY3MjRhMDQ0YWZjYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHQYYYgH2gAyNDgwMDcyOTY2OjBjYTE4MmFhZWU4YjUyNzEzY2I1NGI1MGRhYTkxNzI4NGI3OWVjMGM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e0994f23437c81deae20b66316b6724a044afcc5", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/e0994f23437c81deae20b66316b6724a044afcc5", "committedDate": "2020-09-04T20:35:10Z", "message": "HDDS-4211. [OFS] Better owner and group display for listing Ozone volumes and buckets\n\nChange-Id: I28a4d6dc8756c63b9ac242f283c3ed0b0f0b40c8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "245a16787cb67b31c30027c72eee7990c7a6e6ac", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/245a16787cb67b31c30027c72eee7990c7a6e6ac", "committedDate": "2020-09-04T21:19:49Z", "message": "Update test testListStatusRootAndVolumeNonRecursive.\n\nChange-Id: I5286aadd344dca405c062ed6c4942112b8754f8b"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzA0MDI5", "url": "https://github.com/apache/ozone/pull/1397#pullrequestreview-484304029", "createdAt": "2020-09-08T16:23:34Z", "commit": {"oid": "245a16787cb67b31c30027c72eee7990c7a6e6ac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNjoyMzozNFrOHOk4Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNjoyMzozNFrOHOk4Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0NjMxMA==", "bodyText": "NIT: The comment is not accurate. The ACLs will not be able to provider owner and group information. We might add owner information as bucket metadata in future.", "url": "https://github.com/apache/ozone/pull/1397#discussion_r485046310", "createdAt": "2020-09-08T16:23:34Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-ozone/ozonefs-common/src/main/java/org/apache/hadoop/fs/ozone/BasicRootedOzoneClientAdapterImpl.java", "diffHunk": "@@ -972,24 +992,26 @@ private static FileStatusAdapter getFileStatusAdapterForVolume(\n    * Generate a FileStatusAdapter for a bucket.\n    * @param ozoneBucket OzoneBucket object.\n    * @param uri Full URI to OFS root.\n+   * @param owner Owner of the parent volume of the bucket.\n+   * @param group Group of the parent volume of the bucket.\n    * @return FileStatusAdapter for a bucket.\n    */\n   private static FileStatusAdapter getFileStatusAdapterForBucket(\n-      OzoneBucket ozoneBucket, URI uri, String username) {\n+      OzoneBucket ozoneBucket, URI uri, String owner, String group) {\n     String pathStr = uri.toString() +\n         OZONE_URI_DELIMITER + ozoneBucket.getVolumeName() +\n         OZONE_URI_DELIMITER + ozoneBucket.getName();\n     if (LOG.isDebugEnabled()) {\n-      LOG.debug(\"getFileStatusAdapterForBucket: ozoneBucket={}, pathStr={}, \"\n-              + \"username={}\", ozoneBucket.getVolumeName() + OZONE_URI_DELIMITER\n-              + ozoneBucket.getName(), pathStr, username);\n+      LOG.debug(\"getFileStatusAdapterForBucket: ozoneBucket={}, pathStr={}\",\n+          ozoneBucket.getVolumeName() + OZONE_URI_DELIMITER +\n+              ozoneBucket.getName(), pathStr);\n     }\n     Path path = new Path(pathStr);\n     return new FileStatusAdapter(0L, path, true, (short)0, 0L,\n         ozoneBucket.getCreationTime().getEpochSecond() * 1000, 0L,\n-        FsPermission.getDirDefault().toShort(),  // TODO: derive from ACLs later\n-        // TODO: revisit owner and group\n-        username, username, path, new BlockLocation[0]);\n+        FsPermission.getDirDefault().toShort(),\n+        // TODO: maybe derive owner and group from ACLs later", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "245a16787cb67b31c30027c72eee7990c7a6e6ac"}, "originalPosition": 84}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzA2Nzgz", "url": "https://github.com/apache/ozone/pull/1397#pullrequestreview-484306783", "createdAt": "2020-09-08T16:27:14Z", "commit": {"oid": "245a16787cb67b31c30027c72eee7990c7a6e6ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ca182aaee8b52713cb54b50daa917284b79ec0c", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/0ca182aaee8b52713cb54b50daa917284b79ec0c", "committedDate": "2020-09-09T18:19:49Z", "message": "Remove inaccurate comment.\n\nChange-Id: If9a8f7106ad3a3eb3358e5118a4c08368588cb66"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2463, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}