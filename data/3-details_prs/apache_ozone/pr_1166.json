{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0OTc3NDAz", "number": 1166, "title": "HDDS-3914. Remove LevelDB configuration option for DN Metastore", "bodyText": "What changes were proposed in this pull request?\nLevelDB support was removed for OM and SCM DBs but DN Metastore can still be configured to use LevelDB or RocksDB.\nThis Jira proposes to remove LevelDB configuration option for DN Metastore (ozone.metastore.impl) and use RocksDB only.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3914\nHow was this patch tested?\nDeprecation patch. No unit tests required.", "createdAt": "2020-07-06T20:08:50Z", "url": "https://github.com/apache/ozone/pull/1166", "merged": true, "mergeCommit": {"oid": "2af6198686d81daa3ad0513f723118637d2945cf"}, "closed": true, "closedAt": "2020-07-10T19:50:16Z", "author": {"login": "hanishakoneru"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcypzKOgFqTQ0NDEyNzQxMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczbRCcAFqTQ0NjEwMjkyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MTI3NDEx", "url": "https://github.com/apache/ozone/pull/1166#pullrequestreview-444127411", "createdAt": "2020-07-07T18:00:30Z", "commit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMDozMFrOGuJt5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMzoyNlrOGuJ0cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA==", "bodyText": "Thanks @hanishakoneru  for working on this. Not sure if I understand correctly, since we are removing LevelDB support on DN, do we still need to define two types of DB for container here?", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451046884", "createdAt": "2020-07-07T18:00:30Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "diffHunk": "@@ -186,8 +186,8 @@ private void checkContainerFile() throws IOException {\n     }\n \n     dbType = onDiskContainerData.getContainerDBType();\n-    if (!dbType.equals(OZONE_METADATA_STORE_IMPL_ROCKSDB) &&\n-        !dbType.equals(OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (!dbType.equals(CONTAINER_DB_TYPE_ROCKSDB) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzgzNQ==", "bodyText": "Do we still need this?", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451047835", "createdAt": "2020-07-07T18:02:06Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -90,12 +93,12 @@ public void init() throws IOException {\n         + \"-\" + storeImpl.toLowerCase());\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n \n     store = MetadataStoreBuilder.newBuilder()\n         .setConf(conf)\n         .setCreateIfMissing(true)\n         .setDbFile(testDir)\n+        .setDBType(storeImpl)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0ODU2MQ==", "bodyText": "The logic needs to be reversed, maybe a typo.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451048561", "createdAt": "2020-07-07T18:03:26Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -166,12 +170,12 @@ public void testIterator() throws Exception {\n   public void testMetaStoreConfigDifferentFromType() throws IOException {\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n+\n     String dbType;\n     GenericTestUtils.setLogLevel(MetadataStoreBuilder.LOG, Level.DEBUG);\n     GenericTestUtils.LogCapturer logCapturer =\n         GenericTestUtils.LogCapturer.captureLogs(MetadataStoreBuilder.LOG);\n-    if (storeImpl.equals(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (storeImpl.equals(CONTAINER_DB_TYPE_LEVELDB)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 104}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e639d129955fc2769832c3c137ec4bebf20f960", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/7e639d129955fc2769832c3c137ec4bebf20f960", "committedDate": "2020-07-09T18:04:35Z", "message": "HDDS-3914. Remove LevelDB configuration option for DN Metastore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48114a099c440eeda976547e4f255c9574b190e8", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/48114a099c440eeda976547e4f255c9574b190e8", "committedDate": "2020-07-09T18:04:35Z", "message": "checkstyle fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35ef925a1bffdd766938b9895cb2813325d83118", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/35ef925a1bffdd766938b9895cb2813325d83118", "committedDate": "2020-07-09T18:04:35Z", "message": "integration test fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ff2338319ce04ad276632009c0f55ca8dbce751", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/6ff2338319ce04ad276632009c0f55ca8dbce751", "committedDate": "2020-07-09T18:04:35Z", "message": "review and checkstyle fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/86451aeb80c3cd67386e35a3688aeb3a0ff26620", "committedDate": "2020-07-06T18:39:47Z", "message": "integration test fix"}, "afterCommit": {"oid": "6ff2338319ce04ad276632009c0f55ca8dbce751", "author": {"user": {"login": "hanishakoneru", "name": "Hanisha Koneru"}}, "url": "https://github.com/apache/ozone/commit/6ff2338319ce04ad276632009c0f55ca8dbce751", "committedDate": "2020-07-09T18:04:35Z", "message": "review and checkstyle fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MTAyOTI1", "url": "https://github.com/apache/ozone/pull/1166#pullrequestreview-446102925", "createdAt": "2020-07-10T03:42:16Z", "commit": {"oid": "6ff2338319ce04ad276632009c0f55ca8dbce751"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3076, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}