{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzNjY1NDA2", "number": 1414, "title": "HDDS-4231. Background Service blocks on task results.", "bodyText": "What changes were proposed in this pull request?\nBackground service currently waits on the results of the tasks. The idea is to track the time it took for the task to execute and log if task takes more than configured timeout.\nThis does not require waiting on the task results and can be achieved by just comparing the execution time of a task with the timeout value.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4231\nHow was this patch tested?\nThis was one of the reasons for failure of TestBlockDeletion tracked in HDDS-3432. Please check a3feb31 . HDDS-3432 is blocked on a ratis bug.", "createdAt": "2020-09-10T10:46:23Z", "url": "https://github.com/apache/ozone/pull/1414", "merged": true, "mergeCommit": {"oid": "6267a39d2067441ccda8bdf36085ebd15ecdc08f"}, "closed": true, "closedAt": "2020-09-29T08:45:27Z", "author": {"login": "lokeshj1703"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHkDAJAFqTQ4NjE0NjI2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNkJcggFqTQ5ODI0NDMyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MTQ2MjYx", "url": "https://github.com/apache/ozone/pull/1414#pullrequestreview-486146261", "createdAt": "2020-09-10T17:14:33Z", "commit": {"oid": "5aaf4e1a49110383303fd3cfa0ad54fc392d82db"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNzoxNDozNFrOHP96yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNzoxNDozNFrOHP96yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjUwNTE2Mg==", "bodyText": "Usually long is not enough to contain NANOSECONDS but this variable seems just a service timeout, which should be a very small number so it should be fine.", "url": "https://github.com/apache/ozone/pull/1414#discussion_r486505162", "createdAt": "2020-09-10T17:14:34Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/utils/BackgroundService.java", "diffHunk": "@@ -62,11 +56,11 @@ public BackgroundService(String serviceName, long interval,\n     this.interval = interval;\n     this.unit = unit;\n     this.serviceName = serviceName;\n-    this.serviceTimeout = serviceTimeout;\n+    this.serviceTimeoutInNanos = TimeDuration.valueOf(serviceTimeout, unit)\n+            .toLong(TimeUnit.NANOSECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5aaf4e1a49110383303fd3cfa0ad54fc392d82db"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97a3f60102ea966f9cdf76bf8e196ef81a0dd9e6", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/97a3f60102ea966f9cdf76bf8e196ef81a0dd9e6", "committedDate": "2020-09-28T06:08:23Z", "message": "HDDS-4231. Background Service blocks on task results."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56ad40441c7f0eebe35c7421269cef5546848e03", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/56ad40441c7f0eebe35c7421269cef5546848e03", "committedDate": "2020-09-28T06:08:24Z", "message": "Fix unit test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5db79994a333e2fedc83c7e7bc970ce63e780919", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/5db79994a333e2fedc83c7e7bc970ce63e780919", "committedDate": "2020-09-11T05:48:42Z", "message": "Fix unit test"}, "afterCommit": {"oid": "56ad40441c7f0eebe35c7421269cef5546848e03", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/56ad40441c7f0eebe35c7421269cef5546848e03", "committedDate": "2020-09-28T06:08:24Z", "message": "Fix unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a34edf3c5ba9bd8251d6e3621dbe16c194a50f15", "author": {"user": {"login": "lokeshj1703", "name": "Lokesh Jain"}}, "url": "https://github.com/apache/ozone/commit/a34edf3c5ba9bd8251d6e3621dbe16c194a50f15", "committedDate": "2020-09-29T06:33:10Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MjQ0MzI3", "url": "https://github.com/apache/ozone/pull/1414#pullrequestreview-498244327", "createdAt": "2020-09-29T08:45:09Z", "commit": {"oid": "a34edf3c5ba9bd8251d6e3621dbe16c194a50f15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2501, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}