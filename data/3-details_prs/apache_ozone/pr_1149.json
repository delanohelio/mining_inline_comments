{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMDA2Njg0", "number": 1149, "title": "HDDS-3878. Make OMHA serviceID optional if one (but only one) is defined in the config", "bodyText": "What changes were proposed in this pull request?\nom.serviceId is required on case of OM.HA in all the client parameters even if there is only one om.serviceId and it can be chosen.\nMy goal is:\n\nProvide better usability\nSimplify the documentation task ;-)\n\nWith using the om.serviceId from the config if\n\nconfig is available\nom ha is configured\nonly one service is configured\n\nIt also makes easier to run the same tests with/without HA\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3878?filter=12349091\nHow was this patch tested?\n\nGot full green build on my fork.\nozone-ha acceptance tests\n\nozone-ha acceptance tests are turned off long time ago (it included some life-cycle test to start/stop services. In this patch I simplified the ha cluster and added simple smoketest.\nLater we can restore the lifecycle tests (start/stop) but I would prefer to use a generic approach for all the clusters.", "createdAt": "2020-06-30T12:51:35Z", "url": "https://github.com/apache/ozone/pull/1149", "merged": true, "mergeCommit": {"oid": "cee43e908f700633a283f8791687523341a8ee27"}, "closed": true, "closedAt": "2020-08-11T13:49:45Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcurWCLgH2gAyNDQyMDA2Njg0OmQyZTI4NjlhZGU1MWZiN2RiOGQ4NmRhNDJlZjFmZmVmMGRiNWRkMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9meluAH2gAyNDQyMDA2Njg0OjUxMjk1NTQ4ZmE0MDkzNTA0ODU2ZjRjYmZmZmIxNDNjNWQ1OTE1YjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d2e2869ade51fb7db8d86da42ef1ffef0db5dd06", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/d2e2869ade51fb7db8d86da42ef1ffef0db5dd06", "committedDate": "2020-06-25T09:36:35Z", "message": "fix1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd8b353f9157183c92d6fdcfed237532cd68a3e9", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/bd8b353f9157183c92d6fdcfed237532cd68a3e9", "committedDate": "2020-06-25T10:27:11Z", "message": "update om ha compose fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c540c5746537db775246fa6c860c4a83525d8a8", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/0c540c5746537db775246fa6c860c4a83525d8a8", "committedDate": "2020-06-25T15:16:55Z", "message": "fix ofs without host names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f0a92cdd4a87d32b5d1a250a2275bc790d910f7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/8f0a92cdd4a87d32b5d1a250a2275bc790d910f7", "committedDate": "2020-06-26T07:28:57Z", "message": "fix unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5b35b1434837d5e124c5f91e2a440177cf6e67f", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/e5b35b1434837d5e124c5f91e2a440177cf6e67f", "committedDate": "2020-06-26T11:52:21Z", "message": "fix acceptance tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c5e18efef41a1c8ff2a1072b90abde5b59553aa", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/9c5e18efef41a1c8ff2a1072b90abde5b59553aa", "committedDate": "2020-06-26T15:56:46Z", "message": "add missing stop command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccfdd3ed52d653a69b20610f35331d4358ffd8a7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ccfdd3ed52d653a69b20610f35331d4358ffd8a7", "committedDate": "2020-06-30T12:52:32Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3878"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "689f6d246b51be052fa86b33e61f140d0a35ea02", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/689f6d246b51be052fa86b33e61f140d0a35ea02", "committedDate": "2020-06-30T12:53:05Z", "message": "rollback irrelevant changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab346cb66537b5a772945ee3e6cf2a5ea1812ddd", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ab346cb66537b5a772945ee3e6cf2a5ea1812ddd", "committedDate": "2020-06-30T13:17:25Z", "message": "fix rpc client generation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c4500b06d6a77eddcbaabafdc081688dd15b725", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/8c4500b06d6a77eddcbaabafdc081688dd15b725", "committedDate": "2020-06-30T19:46:17Z", "message": "fix OzoneClientFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36b9295faa75ae8f8ecfbd63697e53421caeb4c2", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/36b9295faa75ae8f8ecfbd63697e53421caeb4c2", "committedDate": "2020-07-06T12:36:25Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3878"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "477233136d119fc1c946113aabfcb162ff1ea846", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/477233136d119fc1c946113aabfcb162ff1ea846", "committedDate": "2020-07-06T14:42:17Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fa87add21efd0a91d0078a359bd2326996c58d3", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/0fa87add21efd0a91d0078a359bd2326996c58d3", "committedDate": "2020-07-06T16:17:01Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c7a9ba7d7f20367768ac2b73f142fa5ab711984", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/1c7a9ba7d7f20367768ac2b73f142fa5ab711984", "committedDate": "2020-07-07T11:07:26Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b860ef5624aa8fe521da1ea3fe7fbb20c01350d", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/3b860ef5624aa8fe521da1ea3fe7fbb20c01350d", "committedDate": "2020-07-07T12:28:30Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MTIyNDMw", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-444122430", "createdAt": "2020-07-07T17:53:48Z", "commit": {"oid": "3b860ef5624aa8fe521da1ea3fe7fbb20c01350d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "732e83c7d6a7ff78b9d9b89ee140dc222c5a37f1", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/732e83c7d6a7ff78b9d9b89ee140dc222c5a37f1", "committedDate": "2020-07-22T09:40:35Z", "message": "revert ozone fs related changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78d4c7af12c988efc8af018abba6107ab0ef17ce", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/78d4c7af12c988efc8af018abba6107ab0ef17ce", "committedDate": "2020-07-22T09:41:42Z", "message": "Merge remote-tracking branch 'elek/HDDS-3878' into HDDS-3878"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "024d7a48abdfa385ad05b6c0654a509397b6de91", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/024d7a48abdfa385ad05b6c0654a509397b6de91", "committedDate": "2020-07-22T09:56:20Z", "message": "fix om related freon tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0818fa8049675f0e0fe44dbfbc39a3b4699cff6f", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/0818fa8049675f0e0fe44dbfbc39a3b4699cff6f", "committedDate": "2020-07-29T07:48:51Z", "message": "add more unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/dfc07661a4b70a3159759b582b12ab72372404bf", "committedDate": "2020-07-29T07:49:06Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3878"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODY2NTkz", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-462866593", "createdAt": "2020-08-06T20:49:37Z", "commit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo0OTozOFrOG9DxxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo0OTozOFrOG9DxxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY3ODIxMg==", "bodyText": "These files are removed, I think this docker-compose is for testing for ratis log purge usecase.", "url": "https://github.com/apache/ozone/pull/1149#discussion_r466678212", "createdAt": "2020-08-06T20:49:38Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/test_disabled.sh", "diffHunk": "@@ -1,41 +0,0 @@\n-#!/usr/bin/env bash\n-# Licensed to the Apache Software Foundation (ASF) under one\n-# or more contributor license agreements.  See the NOTICE file\n-# distributed with this work for additional information\n-# regarding copyright ownership.  The ASF licenses this file\n-# to you under the Apache License, Version 2.0 (the\n-# \"License\"); you may not use this file except in compliance\n-# with the License.  You may obtain a copy of the License at\n-#", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODY2ODA1", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-462866805", "createdAt": "2020-08-06T20:49:59Z", "commit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo0OTo1OVrOG9Dyig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo0OTo1OVrOG9Dyig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY3ODQxMA==", "bodyText": "Is this change, related to this PR?", "url": "https://github.com/apache/ozone/pull/1149#discussion_r466678410", "createdAt": "2020-08-06T20:49:59Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/test-utils/src/main/java/org/apache/hadoop/test/InMemoryConfiguration.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.test;\n+\n+import java.io.IOException;\n+import java.util.Collection;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODY4OTA2", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-462868906", "createdAt": "2020-08-06T20:53:23Z", "commit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo1MzoyNFrOG9D5Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo1MzoyNFrOG9D5Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4MDEwMg==", "bodyText": "Minor. Extra \".\"", "url": "https://github.com/apache/ozone/pull/1149#discussion_r466680102", "createdAt": "2020-08-06T20:53:24Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/test-utils/src/main/java/org/apache/hadoop/test/InMemoryConfiguration.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.test;\n+\n+import java.io.IOException;\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import org.apache.hadoop.hdds.conf.MutableConfigurationSource;\n+\n+/**\n+ * In memory, mutable configuration source for testing..", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODgwMTgx", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-462880181", "createdAt": "2020-08-06T21:11:49Z", "commit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMTo1MFrOG9Ebag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMTo1MFrOG9Ebag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4ODg3NA==", "bodyText": "Minor: protected OzoneClient createRpcClient(ConfigurationSource conf) fits in a single line", "url": "https://github.com/apache/ozone/pull/1149#discussion_r466688874", "createdAt": "2020-08-06T21:11:50Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/OzoneAddress.java", "diffHunk": "@@ -85,7 +89,34 @@ public OzoneAddress(String address)\n \n   }\n \n-  public OzoneClient createClient(OzoneConfiguration conf)\n+  @VisibleForTesting\n+  protected OzoneClient createRpcClient(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfc07661a4b70a3159759b582b12ab72372404bf"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29550ce803abb075d7899e7a7e747d97d0e9cbc7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/29550ce803abb075d7899e7a7e747d97d0e9cbc7", "committedDate": "2020-08-07T13:55:15Z", "message": "typo fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9980b56c75921032963ec3b246b5d045cb9aa6a9", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/9980b56c75921032963ec3b246b5d045cb9aa6a9", "committedDate": "2020-08-07T13:56:28Z", "message": "one line method def"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f305df3ef241a0d3ee0cf115160e4fe6b406359", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/3f305df3ef241a0d3ee0cf115160e4fe6b406359", "committedDate": "2020-08-08T08:59:01Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3878"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9776c88e06de10f25c41858f712e75af4da5dc3a", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/9776c88e06de10f25c41858f712e75af4da5dc3a", "committedDate": "2020-08-10T15:11:48Z", "message": "retrigger build with empty commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "872d13e1a0f49dc74ffb7846a2aefe12b2081029", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/872d13e1a0f49dc74ffb7846a2aefe12b2081029", "committedDate": "2020-08-10T17:22:34Z", "message": "fix unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDM4NDYz", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-464438463", "createdAt": "2020-08-10T17:39:32Z", "commit": {"oid": "872d13e1a0f49dc74ffb7846a2aefe12b2081029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDQxOTA2", "url": "https://github.com/apache/ozone/pull/1149#pullrequestreview-464441906", "createdAt": "2020-08-10T17:44:40Z", "commit": {"oid": "872d13e1a0f49dc74ffb7846a2aefe12b2081029"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51295548fa4093504856f4cbfffb143c5d5915b4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/51295548fa4093504856f4cbfffb143c5d5915b4", "committedDate": "2020-08-10T18:25:16Z", "message": "restore original om-ha-tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3056, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}