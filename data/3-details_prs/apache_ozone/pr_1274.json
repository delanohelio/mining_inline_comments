{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4OTIxMTY3", "number": 1274, "title": "HDDS-3810. Add the logic to distribute open containers among the pipelines of a datanode.", "bodyText": "What changes were proposed in this pull request?\nAdded logic for open container distribution among multiple pipelines of a dn\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3810\nHow was this patch tested?\nAdded unit tests.", "createdAt": "2020-07-30T07:01:43Z", "url": "https://github.com/apache/ozone/pull/1274", "merged": true, "mergeCommit": {"oid": "f8a62d6d506974b5ee2df64bdc2ea3aea6ff7610"}, "closed": true, "closedAt": "2020-10-05T05:32:23Z", "author": {"login": "bshashikant"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc58ccKAFqTQ1ODI0NTEwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN7KosAH2gAyNDU4OTIxMTY3OjIyOWRhY2E2OTMxZTJiZTUwZTNmZjM2M2U3OTJkYTZjZGFjZjNkYmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MjQ1MTAz", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-458245103", "createdAt": "2020-07-30T09:39:30Z", "commit": {"oid": "05dad8bf4fcf8cc56fac9acd837f69e95939cc45"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwOTozOTozMFrOG5bwWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwOTozOTozMFrOG5bwWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg3Njc2MA==", "bodyText": "Should be added to ozone-default.xml, too (indicated by failure of TestOzoneConfigurationFields).", "url": "https://github.com/apache/ozone/pull/1274#discussion_r462876760", "createdAt": "2020-07-30T09:39:30Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/scm/ScmConfigKeys.java", "diffHunk": "@@ -307,6 +307,10 @@\n       OZONE_SCM_KEY_VALUE_CONTAINER_DELETION_CHOOSING_POLICY =\n       \"ozone.scm.keyvalue.container.deletion-choosing.policy\";\n \n+  public static final String OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK =\n+      \"ozone.scm.pipeline.per.raft.log.disk\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05dad8bf4fcf8cc56fac9acd837f69e95939cc45"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MjU0MDQ4", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-458254048", "createdAt": "2020-07-30T09:52:10Z", "commit": {"oid": "a656dc79a01439a1dc00e7f5b30f9caa8f468b9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwOTo1MjoxMVrOG5cL7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwOTo1MjoxMVrOG5cL7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg4MzgyMQ==", "bodyText": "Shouldn't this be same as OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK_DEFAULT?", "url": "https://github.com/apache/ozone/pull/1274#discussion_r462883821", "createdAt": "2020-07-30T09:52:11Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/common/src/main/resources/ozone-default.xml", "diffHunk": "@@ -821,6 +821,13 @@\n     <description>Number of containers per owner per disk in a pipeline.\n     </description>\n   </property>\n+  <property>\n+    <name>ozone.scm.pipeline.per.raft.log.disk</name>\n+    <value>3</value>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a656dc79a01439a1dc00e7f5b30f9caa8f468b9f"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MzI1NDUz", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-458325453", "createdAt": "2020-07-30T11:48:32Z", "commit": {"oid": "3db842ecf2d22c68b9d1dc11f1da3538e2fbd3c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c538a7542e3962cf1588a18fc889af494c663bff", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/c538a7542e3962cf1588a18fc889af494c663bff", "committedDate": "2020-08-28T07:11:42Z", "message": "HDDS-3810. Add the logic to distribute open containers among the piplelines of a datanode."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca4fa4ce75d74db56cef600c150d3dd29c68be0f", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/ca4fa4ce75d74db56cef600c150d3dd29c68be0f", "committedDate": "2020-08-28T07:11:42Z", "message": "Addressed review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "331ddcde454da394543afafd3d520277d80c4b1b", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/331ddcde454da394543afafd3d520277d80c4b1b", "committedDate": "2020-08-28T07:11:42Z", "message": "changed default config value."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b4d8cc371e0e34704ecad7e98b52837fe071a89", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/6b4d8cc371e0e34704ecad7e98b52837fe071a89", "committedDate": "2020-08-28T12:15:09Z", "message": "Added logic for raft log disk accouting in pipeline creation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e665488dbf0fa60e92c924bfce0c88f414b737f7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/e665488dbf0fa60e92c924bfce0c88f414b737f7", "committedDate": "2020-08-24T15:47:37Z", "message": "retrigger build with empty commit"}, "afterCommit": {"oid": "6b4d8cc371e0e34704ecad7e98b52837fe071a89", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/6b4d8cc371e0e34704ecad7e98b52837fe071a89", "committedDate": "2020-08-28T12:15:09Z", "message": "Added logic for raft log disk accouting in pipeline creation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa", "committedDate": "2020-08-28T15:22:32Z", "message": "Revert pom.xml changes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NzQxNDU1", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-497741455", "createdAt": "2020-09-28T17:19:00Z", "commit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNzoxOTowMFrOHZIQzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNzo0Njo0MFrOHZJOiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjExMTgyMg==", "bodyText": "Rename suggestion: getMetadataVolumeCount()", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496111822", "createdAt": "2020-09-28T17:19:00Z", "author": {"login": "nandakumar131"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/DatanodeInfo.java", "diffHunk": "@@ -121,6 +143,19 @@ public int getHealthyVolumeCount() {\n     }\n   }\n \n+  /**\n+   * Returns count of healthy raft log volumes reported from datanode.\n+   * @return count of healthy raft log volumes\n+   */\n+  public int getRaftLogVolumeCount() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjEyNzYyNA==", "bodyText": "Will this work in case of heterogeneous datanodes, where one datanode has 1 Raft log disk with 2 data disk and the other datanode has 5 Raft log disk with 10 data disk?\nAccording to the current logic getOpenContainerCountPerPipeline will return 10, if numContainerPerVolume and numPipelinesPerRaftLogDisk are set to 2.", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496127624", "createdAt": "2020-09-28T17:46:40Z", "author": {"login": "nandakumar131"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/SCMContainerManager.java", "diffHunk": "@@ -101,12 +103,23 @@ public SCMContainerManager(\n     this.numContainerPerVolume = conf\n         .getInt(ScmConfigKeys.OZONE_SCM_PIPELINE_OWNER_CONTAINER_COUNT,\n             ScmConfigKeys.OZONE_SCM_PIPELINE_OWNER_CONTAINER_COUNT_DEFAULT);\n+    this.numPipelinesPerRaftLogDisk = conf\n+        .getInt(ScmConfigKeys.OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK,\n+            ScmConfigKeys.OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK_DEFAULT);\n \n     loadExistingContainers();\n \n     scmContainerManagerMetrics = SCMContainerManagerMetrics.create();\n   }\n \n+  private int getOpenContainerCountPerPipeline(Pipeline pipeline) {\n+    int totalContainerCountPerDn = numContainerPerVolume *\n+        pipelineManager.getNumHealthyVolumes(pipeline);\n+    int maxPipelineCountPerDn = pipelineManager.maxPipelineLimit(pipeline);\n+    return (int) Math.ceil(\n+        ((double) totalContainerCountPerDn / maxPipelineCountPerDn));\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MDI5MDIx", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-498029021", "createdAt": "2020-09-29T02:54:50Z", "commit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwMjo1NDo1MVrOHZWspQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwMzozNTozNFrOHZXTlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM0ODMyNQ==", "bodyText": "may replace StorageContainerDatanodeProtocolProtos.MetadataStorageReportProto with MetadataStorageReportProto", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496348325", "createdAt": "2020-09-29T02:54:51Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/DatanodeInfo.java", "diffHunk": "@@ -40,6 +43,8 @@\n   private long lastStatsUpdatedTime;\n \n   private List<StorageReportProto> storageReports;\n+  private List<StorageContainerDatanodeProtocolProtos.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM0ODU5Ng==", "bodyText": "stale java doc, suggestion: Updates the datanode metadata storage reports.", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496348596", "createdAt": "2020-09-29T02:55:52Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/DatanodeInfo.java", "diffHunk": "@@ -94,6 +100,22 @@ public void updateStorageReports(List<StorageReportProto> reports) {\n     }\n   }\n \n+  /**\n+   * Updates the datanode storage reports.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM1MTgwMQ==", "bodyText": "How about OZONE_SCM_PIPELINE_PER_METADATA_DISK ?\nThere are both raft log disk and meta data storage report existing in the code context, they are similar to each other, bring in some redundancy.\nBTW, the former one may lead misunderstanding. One might think that each raft log disk contains one raft log, which is straightforwad, nevertheless, the raft log disk and the raft log is a OneToMany relationship.", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496351801", "createdAt": "2020-09-29T03:08:22Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/scm/ScmConfigKeys.java", "diffHunk": "@@ -308,6 +308,10 @@\n       OZONE_SCM_KEY_VALUE_CONTAINER_DELETION_CHOOSING_POLICY =\n       \"ozone.scm.keyvalue.container.deletion-choosing.policy\";\n \n+  public static final String OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM1NzA0OA==", "bodyText": "method name is maxPipelineLimit, but the logic calculates the min, which is a little bit weird. How about minPipelineLimit", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496357048", "createdAt": "2020-09-29T03:30:20Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/SCMNodeManager.java", "diffHunk": "@@ -530,6 +540,43 @@ public int getNumHealthyVolumes(List<DatanodeDetails> dnList) {\n     return Collections.max(volumeCountList);\n   }\n \n+  /**\n+   * Returns the pipeline limit for the datanode.\n+   * if the datanode pipeline limit is set, consider that as the max\n+   * pipeline limit.\n+   * In case, the pipeline limit is not set, the max pipeline limit\n+   * will be based on the no of raft log volume reported and provided\n+   * that it has atleast one healthy data volume.\n+   */\n+  @Override\n+  public int maxPipelineLimit(DatanodeDetails dn) {\n+    try {\n+      if (heavyNodeCriteria > 0) {\n+        return heavyNodeCriteria;\n+      } else if (nodeStateManager.getNode(dn).getHealthyVolumeCount() > 0) {\n+        return numPipelinesPerRaftLogDisk *\n+            nodeStateManager.getNode(dn).getRaftLogVolumeCount();\n+      }\n+    } catch (NodeNotFoundException e) {\n+      LOG.warn(\"Cannot generate NodeStat, datanode {} not found.\",\n+          dn.getUuid());\n+    }\n+    return 0;\n+  }\n+\n+  /**\n+   * Returns the pipeline limit for set of datanodes.\n+   */\n+  @Override\n+  public int maxPipelineLimit(List<DatanodeDetails> dnList) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM1ODI5NQ==", "bodyText": "pipelineManager.getMaxHealthyVolumeNum(pipeline) / pipelineManager.getMinPipelineLimit(pipeline) may be more expressive.", "url": "https://github.com/apache/ozone/pull/1274#discussion_r496358295", "createdAt": "2020-09-29T03:35:34Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/SCMContainerManager.java", "diffHunk": "@@ -101,12 +103,23 @@ public SCMContainerManager(\n     this.numContainerPerVolume = conf\n         .getInt(ScmConfigKeys.OZONE_SCM_PIPELINE_OWNER_CONTAINER_COUNT,\n             ScmConfigKeys.OZONE_SCM_PIPELINE_OWNER_CONTAINER_COUNT_DEFAULT);\n+    this.numPipelinesPerRaftLogDisk = conf\n+        .getInt(ScmConfigKeys.OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK,\n+            ScmConfigKeys.OZONE_SCM_PIPELINE_PER_RAFT_LOG_DISK_DEFAULT);\n \n     loadExistingContainers();\n \n     scmContainerManagerMetrics = SCMContainerManagerMetrics.create();\n   }\n \n+  private int getOpenContainerCountPerPipeline(Pipeline pipeline) {\n+    int totalContainerCountPerDn = numContainerPerVolume *\n+        pipelineManager.getNumHealthyVolumes(pipeline);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ddc28746bc31fcd52d3f8302e3f31c7e8bf1caa"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5338e15f1cbd791697f8bd395a08eaa511a09dd0", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/5338e15f1cbd791697f8bd395a08eaa511a09dd0", "committedDate": "2020-09-29T05:26:09Z", "message": "Addressed review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ce53bc48b3ac6932e9bce5bac658edf080b62a4", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/7ce53bc48b3ac6932e9bce5bac658edf080b62a4", "committedDate": "2020-09-29T08:52:07Z", "message": "Addressed unit test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ae1a5f6856a13b9723b4ab438e8f8d5963f70cb", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/3ae1a5f6856a13b9723b4ab438e8f8d5963f70cb", "committedDate": "2020-09-29T09:11:26Z", "message": "Addressed Integeration test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e710be6ea896724ca75c7e3967dc66e885e44c4", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/9e710be6ea896724ca75c7e3967dc66e885e44c4", "committedDate": "2020-09-29T11:36:07Z", "message": "Addressed test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "576c1ab93a8114f601e25d445013f87b7c0a3653", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/576c1ab93a8114f601e25d445013f87b7c0a3653", "committedDate": "2020-09-29T14:39:56Z", "message": "Addressed Checkstyle issues."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/9ef14e007f4410bde398bd0e66e617f5d674b239", "committedDate": "2020-09-30T07:51:45Z", "message": "Changed the logic for calculating healthyVolume count per pipeline."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MjE3MTU1", "url": "https://github.com/apache/ozone/pull/1274#pullrequestreview-499217155", "createdAt": "2020-09-30T08:52:01Z", "commit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODo1NToxMFrOHaT12Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwOTowMDoxMlrOHaUC8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM1MDEwNQ==", "bodyText": "method name suggestion: minHealthyVolumeNum", "url": "https://github.com/apache/ozone/pull/1274#discussion_r497350105", "createdAt": "2020-09-30T08:55:10Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/SCMNodeManager.java", "diffHunk": "@@ -511,7 +521,7 @@ private SCMNodeStat getNodeStatInternal(DatanodeDetails datanodeDetails) {\n   }\n \n   /**\n-   * Returns the max of no healthy volumes reported out of the set\n+   * Returns the min of no healthy volumes reported out of the set", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM1MDY4Ng==", "bodyText": "name suggestion: totalContainerCountPerDn  -> minContainerCountPerDn", "url": "https://github.com/apache/ozone/pull/1274#discussion_r497350686", "createdAt": "2020-09-30T08:56:04Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/SCMContainerManager.java", "diffHunk": "@@ -107,6 +107,14 @@ public SCMContainerManager(\n     scmContainerManagerMetrics = SCMContainerManagerMetrics.create();\n   }\n \n+  private int getOpenContainerCountPerPipeline(Pipeline pipeline) {\n+    int totalContainerCountPerDn = numContainerPerVolume *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM1MjMyMQ==", "bodyText": "member var name suggestion: numPipelinesPerMetadataVolume", "url": "https://github.com/apache/ozone/pull/1274#discussion_r497352321", "createdAt": "2020-09-30T08:58:31Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/node/SCMNodeManager.java", "diffHunk": "@@ -130,6 +133,11 @@ public SCMNodeManager(OzoneConfiguration conf,\n     this.useHostname = conf.getBoolean(\n         DFSConfigKeysLegacy.DFS_DATANODE_USE_DN_HOSTNAME,\n         DFSConfigKeysLegacy.DFS_DATANODE_USE_DN_HOSTNAME_DEFAULT);\n+    this.numPipelinesPerRaftLogDisk =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM1MzQ1OQ==", "bodyText": "name suggestion: OZONE_SCM_PIPELINE_PER_METADATA_VOLUME.\nWe'd better use concept volume instead of concept disk in SCM, the former one is a logical concept, the latter is physical one, and volume is already widely used in context.", "url": "https://github.com/apache/ozone/pull/1274#discussion_r497353459", "createdAt": "2020-09-30T09:00:12Z", "author": {"login": "GlenGeng"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/scm/ScmConfigKeys.java", "diffHunk": "@@ -308,6 +308,10 @@\n       OZONE_SCM_KEY_VALUE_CONTAINER_DELETION_CHOOSING_POLICY =\n       \"ozone.scm.keyvalue.container.deletion-choosing.policy\";\n \n+  public static final String OZONE_SCM_PIPELINE_PER_METADATA_DISK =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ef14e007f4410bde398bd0e66e617f5d674b239"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ed4460a840e860d89472915f3680f4b25a39fc5", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/5ed4460a840e860d89472915f3680f4b25a39fc5", "committedDate": "2020-09-30T09:31:49Z", "message": "Addressed review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8160fe710d0faa761b7127e873405c6d81a3509", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/a8160fe710d0faa761b7127e873405c6d81a3509", "committedDate": "2020-09-30T10:21:29Z", "message": "Fix compilation issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "229daca6931e2be50e3ff363e792da6cdacf3dbc", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/ozone/commit/229daca6931e2be50e3ff363e792da6cdacf3dbc", "committedDate": "2020-09-30T11:34:16Z", "message": "Trigger CI check"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2618, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}