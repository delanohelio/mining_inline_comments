{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzOTA5OTU3", "number": 453, "title": "HDDS-2897. Ozone recon Start failed due to Kerberos principal not bei\u2026", "bodyText": "\u2026ng found.\nWhat changes were proposed in this pull request?\nThe Ozone Configuration was not getting passed into the Http Server since there was a recent change in the ConfigurationProvider to provide an instance of 'OzoneConfiguration' instead of 'Configuration'. Hence, Guice created a new Configuration instance for the HttpServer. Since the server did not get the kerberos related configuration, it shut down in the secure environment.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-2897\nHow was this patch tested?\nManually tested on a secure cluster and verified Recon starts up fine.", "createdAt": "2020-01-17T00:29:03Z", "url": "https://github.com/apache/ozone/pull/453", "merged": true, "mergeCommit": {"oid": "71c24a8629dbfacdcb3aa167c9a4abcf981fb111"}, "closed": true, "closedAt": "2020-01-17T20:06:25Z", "author": {"login": "avijayanhwx"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7DlPPgH2gAyMzYzOTA5OTU3OmFmYzY2ZTU3NTAwMWVhMTVmM2ZlNWQ3NjM2MDhmMWYxN2I1ZDhmMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7UcTygFqTM0NDgxMzAzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "afc66e575001ea15f3fe5d763608f1f17b5d8f28", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/afc66e575001ea15f3fe5d763608f1f17b5d8f28", "committedDate": "2020-01-17T00:26:51Z", "message": "HDDS-2897. Ozone recon Start failed due to Kerberos principal not being found."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "760e665c88ea0b267a42608932ded42ea9e4a76b", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/760e665c88ea0b267a42608932ded42ea9e4a76b", "committedDate": "2020-01-17T06:35:25Z", "message": "HDDS-2897. Add basic robot tests for recon in unsecure and secure cluster."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDAwODgy", "url": "https://github.com/apache/ozone/pull/453#pullrequestreview-344400882", "createdAt": "2020-01-17T07:28:31Z", "commit": {"oid": "760e665c88ea0b267a42608932ded42ea9e4a76b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDI2MDM1", "url": "https://github.com/apache/ozone/pull/453#pullrequestreview-344426035", "createdAt": "2020-01-17T08:33:52Z", "commit": {"oid": "760e665c88ea0b267a42608932ded42ea9e4a76b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwODozMzo1MlrOFex5VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwODozMzo1MlrOFex5VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgxOTA5Mw==", "bodyText": "The robot tests look good, but I think we could get rid of the duplication.  security/ozone-secure-recon.robot works in both secure and unsecure env.  So I propose:\n\nrename security/ozone-secure-recon.robot to recon/recon-api.robot (ie. get rid of the unsecure-only test, but keep its name and location)\nadd execute_robot_test recon recon in ozonesecure/test.sh, too\n\nThis way the same test would be executed in both secure and unsecure env, similar to eg. s3 tests:\nhttps://github.com/apache/hadoop-ozone/blob/1caf1e30865aa2b380a7fca6d87f5ae8034fee4e/hadoop-ozone/dist/src/main/compose/ozone/test.sh#L39\nhttps://github.com/apache/hadoop-ozone/blob/1caf1e30865aa2b380a7fca6d87f5ae8034fee4e/hadoop-ozone/dist/src/main/compose/ozonesecure/test.sh#L36", "url": "https://github.com/apache/ozone/pull/453#discussion_r367819093", "createdAt": "2020-01-17T08:33:52Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/smoketest/security/ozone-secure-recon.robot", "diffHunk": "@@ -0,0 +1,30 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+*** Settings ***\n+Documentation       Smoke test to start cluster with docker-compose environments.\n+Library             OperatingSystem\n+Library             String\n+Library             BuiltIn\n+Resource            ../commonlib.robot\n+\n+*** Variables ***\n+${ENDPOINT_URL}     http://recon:9888\n+\n+*** Test Cases ***\n+Recon REST API\n+    Run Keyword if      '${SECURITY_ENABLED}' == 'true'     Kinit HTTP user\n+    ${result} =         Execute                             curl --negotiate -u : -v ${ENDPOINT_URL}/api/containers\n+                        Should contain      ${result}       containers", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "760e665c88ea0b267a42608932ded42ea9e4a76b"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fb368b208e5687c5904d2e748c055511298f432", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/8fb368b208e5687c5904d2e748c055511298f432", "committedDate": "2020-01-17T18:59:13Z", "message": "HDDS-2897. Use same robot test for recon secure and unsecure recon."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODEzMDM3", "url": "https://github.com/apache/ozone/pull/453#pullrequestreview-344813037", "createdAt": "2020-01-17T20:05:29Z", "commit": {"oid": "8fb368b208e5687c5904d2e748c055511298f432"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3693, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}