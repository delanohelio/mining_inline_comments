{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NDgwOTQw", "number": 1736, "title": "HDDS-4594. Add namespace quota to documentation", "bodyText": "What changes were proposed in this pull request?\nAdd namespace quota to documentation\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4594\nHow was this patch tested?\nUT", "createdAt": "2020-12-24T23:31:24Z", "url": "https://github.com/apache/ozone/pull/1736", "merged": true, "mergeCommit": {"oid": "1e84d1789256d58d99a94e11ed86461bfd83e701"}, "closed": true, "closedAt": "2020-12-29T13:04:53Z", "author": {"login": "amaliujia"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpcWwuAH2gAyNTQ1NDgwOTQwOjBmYjEzODJmYTBkNjlkYWY2MzYwN2JmNTU5MWNhNjEyYmM5ZDRmMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdq35SCAFqTU1OTQ2MzM0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "committedDate": "2020-12-24T23:30:20Z", "message": "HDDS-4594. Add namespace quota to documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NzM4OTU3", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-558738957", "createdAt": "2020-12-25T02:33:47Z", "commit": {"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQwMjozMzo0N1rOILXBhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQwMjozMzo0N1rOILXBhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODc4MjQ2OQ==", "bodyText": "Do we also need example client usage for namespace quota in the following section?", "url": "https://github.com/apache/ozone/pull/1736#discussion_r548782469", "createdAt": "2020-12-25T02:33:47Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/docs/content/feature/Quota.md", "diffHunk": "@@ -45,6 +45,18 @@ e. If the cluster is upgraded from old version less than 1.1.0, use of quota on\n \n f. If volume's quota is enabled then bucket's quota cannot be cleared. \n \n+2. Namespace quota\n+\n+Administrators should be able to define how many namespace a Volume or Bucket can use. The following settings for namespace quota are supported: \n+\n+a. By default, the namespace quota for volume and bucket is not enabled.\n+\n+b. When volume namespace quota is enabled, the total number of buckets under the volume, cannot exceed the volume namespace quota.\n+\n+c. When bucket namespace quota is enabled, the totoal number of keys under the bucket, cannot exceed the bucket namespace quota.\n+\n+d. Linked buckets do not consume namespace quota.\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NzM5MTYy", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-558739162", "createdAt": "2020-12-25T02:35:20Z", "commit": {"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQwMjozNToyMFrOILXCXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQwMjozNToyMFrOILXCXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODc4MjY4Nw==", "bodyText": "Whether 'e' in Storage Space applies equally to Namespace quota. If so, we need to list.", "url": "https://github.com/apache/ozone/pull/1736#discussion_r548782687", "createdAt": "2020-12-25T02:35:20Z", "author": {"login": "captainzmc"}, "path": "hadoop-hdds/docs/content/feature/Quota.md", "diffHunk": "@@ -45,6 +45,18 @@ e. If the cluster is upgraded from old version less than 1.1.0, use of quota on\n \n f. If volume's quota is enabled then bucket's quota cannot be cleared. \n \n+2. Namespace quota\n+\n+Administrators should be able to define how many namespace a Volume or Bucket can use. The following settings for namespace quota are supported: \n+\n+a. By default, the namespace quota for volume and bucket is not enabled.\n+\n+b. When volume namespace quota is enabled, the total number of buckets under the volume, cannot exceed the volume namespace quota.\n+\n+c. When bucket namespace quota is enabled, the totoal number of keys under the bucket, cannot exceed the bucket namespace quota.\n+\n+d. Linked buckets do not consume namespace quota.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2054a00de5830f3f054cb9fed07bc0060318884a", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/2054a00de5830f3f054cb9fed07bc0060318884a", "committedDate": "2020-12-25T05:31:33Z", "message": "fixup! address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2", "committedDate": "2020-12-25T06:36:41Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODUyNjMx", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-558852631", "createdAt": "2020-12-26T08:10:44Z", "commit": {"oid": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTg2NzYw", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-558986760", "createdAt": "2020-12-28T03:49:02Z", "commit": {"oid": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMzo0OTowMlrOILw0lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMzo0OTowMlrOILw0lA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIwNTE0MA==", "bodyText": "There's something wrong with the directory structure. At present is:\n#space quota\n\u2026\u2026\n#namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage\nWe can change it to:\n#space quota\n\u2026\u2026\n## clear quota\n## check quota and usage\n#namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage\nor\n#space quota and namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage", "url": "https://github.com/apache/ozone/pull/1736#discussion_r549205140", "createdAt": "2020-12-28T03:49:02Z", "author": {"login": "captainzmc"}, "path": "hadoop-hdds/docs/content/feature/Quota.zh.md", "diffHunk": "@@ -70,10 +84,35 @@ bin/ozone sh bucket setquota  --space-quota 10GB /volume1/bucket1\n \n bucket\u7684\u603b\u914d\u989d \u4e0d\u5e94\u5927\u4e8e\u5176Volume\u7684\u914d\u989d\u3002\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a10MB\u7684Volume\uff0c\u8be5volume\u4e0b\u6240\u6709bucket\u7684\u5927\u5c0f\u4e4b\u548c\u4e0d\u80fd\u8d85\u8fc710MB\uff0c\u5426\u5219\u8bbe\u7f6ebucket quota\u5c06\u5931\u8d25\u3002\n \n+### Namespace quota\n+\u547d\u540d\u7a7a\u95f4\u914d\u989d\u662f\u4e00\u4e2a\u6570\u5b57\uff0c\u5176\u4ee3\u8868\u7531\u591a\u5c11\u4e2a\u540d\u5b57\u80fd\u591f\u4f7f\u7528\u3002\u8fd9\u4e2a\u6570\u5b57\u4e0d\u80fd\u8d85\u8fc7Java long\u6570\u636e\u7c7b\u578b\u7684\u6700\u5927\u503c\u3002\n+\n+#### Volume Namespace quota\n+```shell\n+bin/ozone sh volume create --namespace-quota 100 /volume1\n+```\n+\u8fd9\u610f\u5473\u7740\u5c06volume1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u8bbe\u7f6e\u4e3a100\u3002\n+\n+```shell\n+bin/ozone sh volume setquota --namespace-quota 1000 /volume1\n+```\n+\u6b64\u884c\u4e3a\u5c06volume1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u66f4\u6539\u4e3a1000\u3002\n+\n+#### Bucket Namespace quota\n+```shell\n+bin/ozone sh bucket create --namespace-quota 100 /volume1/bucket1\n+```\n+\u8fd9\u610f\u5473\u7740bucket1\u5141\u8bb8\u6211\u4eec\u4f7f\u7528100\u7684\u547d\u540d\u7a7a\u95f4\u3002\n+\n+```shell\n+bin/ozone sh bucket setquota --namespace-quota 1000 /volume1/bucket1 \n+```\n+\u8be5\u884c\u4e3a\u5c06bucket1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u66f4\u6539\u4e3a1000\u3002\n+\n #### \u6e05\u9664volume\u548cbucket\u7684\u914d\u989d\n ```shell\n-bin/ozone sh volume clrquota --space-quota /volume1\n-bin/ozone sh bucket clrquota --space-quota /volume1/bucket1\n+bin/ozone sh volume clrquota --space-quota --namespace-quota /volume1\n+bin/ozone sh bucket clrquota --space-quota --namespace-quota /volume1/bucket1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86a955d520fa51932f49c474b0941a0db8507629", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/86a955d520fa51932f49c474b0941a0db8507629", "committedDate": "2020-12-28T04:53:17Z", "message": "fixup! restructure doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faa32ed971e69129e99cd4ae4d3646e028c86b17", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/faa32ed971e69129e99cd4ae4d3646e028c86b17", "committedDate": "2020-12-28T08:14:29Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db4feec8cdce33ee677018a6534b10912e59a490", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/db4feec8cdce33ee677018a6534b10912e59a490", "committedDate": "2020-12-28T20:11:42Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61e9b6b9c8745f4bf9cf85204a79768bf026dc4c", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/61e9b6b9c8745f4bf9cf85204a79768bf026dc4c", "committedDate": "2020-12-28T20:12:47Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDU4MDA5", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-559458009", "createdAt": "2020-12-29T09:55:40Z", "commit": {"oid": "61e9b6b9c8745f4bf9cf85204a79768bf026dc4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDYzMzQz", "url": "https://github.com/apache/ozone/pull/1736#pullrequestreview-559463343", "createdAt": "2020-12-29T10:09:24Z", "commit": {"oid": "61e9b6b9c8745f4bf9cf85204a79768bf026dc4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1912, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}