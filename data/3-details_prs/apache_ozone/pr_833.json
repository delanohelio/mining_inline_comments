{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MzA0ODQy", "number": 833, "title": "HDDS-3314. FIx ContainerOperationClient#readContainer to use Grpc Client to read from datanode", "bodyText": "What changes were proposed in this pull request?\nOzone debug chunkinfo  command fails intermittently on killing  a datanode in a multinode setup as it uses the ratis pipeline.This was because the query happens only on the leader node.The change is that the scm now queries different datanodes in case of failure through the grpcClient.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3314\nHow was this patch tested?\nManual test", "createdAt": "2020-04-16T11:40:50Z", "url": "https://github.com/apache/ozone/pull/833", "merged": true, "mergeCommit": {"oid": "1a51d585b5954658f9dc78e7bbd3309c7e976191"}, "closed": true, "closedAt": "2020-04-29T15:36:01Z", "author": {"login": "sadanand48"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYLB44gH2gAyNDA0MzA0ODQyOmM3MWI2MjAyZTEzOWUzNmU1NGYxODM3MDQ5MmFiYzJlZGZlODg5ZGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccaUbCAFqTQwMjc5MDAzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c71b6202e139e36e54f18370492abc2edfe889dc", "author": {"user": {"login": "sadanand48", "name": "Sadanand Shenoy"}}, "url": "https://github.com/apache/ozone/commit/c71b6202e139e36e54f18370492abc2edfe889dc", "committedDate": "2020-04-16T11:31:17Z", "message": "HDDS-3314. scmcli container info command failing intermittently"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MDQyOTg5", "url": "https://github.com/apache/ozone/pull/833#pullrequestreview-395042989", "createdAt": "2020-04-16T22:28:45Z", "commit": {"oid": "c71b6202e139e36e54f18370492abc2edfe889dc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMjoyODo0NVrOGG5aBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMjoyODo0NVrOGG5aBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg4NTE5MA==", "bodyText": "I have not really understood this change, as we just changed from acquireClient  -> acquireClientForReadData.\nHow that will handle failures, and how it will retry on other datanodes.\nAnd also InfoSubCommand Uses below code, and it is not calling readContainer.\nfinal ContainerWithPipeline container = scmClient.\ngetContainerWithPipeline(containerID);\n\n  final ContainerWithPipeline container = scmClient.\n      getContainerWithPipeline(containerID);\n  Preconditions.checkNotNull(container, \"Container cannot be null\");\n\n\nIf possible, can you explain this change, not sure if I am missing something here.", "url": "https://github.com/apache/ozone/pull/833#discussion_r409885190", "createdAt": "2020-04-16T22:28:45Z", "author": {"login": "bharatviswa504"}, "path": "hadoop-hdds/tools/src/main/java/org/apache/hadoop/hdds/scm/cli/ContainerOperationClient.java", "diffHunk": "@@ -382,7 +382,7 @@ public ContainerDataProto readContainer(long containerID,\n       Pipeline pipeline) throws IOException {\n     XceiverClientSpi client = null;\n     try {\n-      client = xceiverClientManager.acquireClient(pipeline);\n+      client = xceiverClientManager.acquireClientForReadData(pipeline);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c71b6202e139e36e54f18370492abc2edfe889dc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNzkwMDM1", "url": "https://github.com/apache/ozone/pull/833#pullrequestreview-402790035", "createdAt": "2020-04-29T15:35:48Z", "commit": {"oid": "c71b6202e139e36e54f18370492abc2edfe889dc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3385, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}