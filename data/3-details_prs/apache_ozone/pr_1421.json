{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MzYxNzk5", "number": 1421, "title": "HDDS-4174. Add current HDDS layout version to Datanode heartbeat/registration", "bodyText": "What changes were proposed in this pull request?\nAdd current HDDS layout version to DataNode heartbeat/registration\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4174\nHow was this patch tested?\nSuccessful Build", "createdAt": "2020-09-14T06:20:49Z", "url": "https://github.com/apache/ozone/pull/1421", "merged": true, "mergeCommit": {"oid": "75ea5bf64b5ca86726871fe8de8786c384239237"}, "closed": true, "closedAt": "2020-09-15T01:40:05Z", "author": {"login": "prashantpogde"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdItCewAH2gAyNDg2MzYxNzk5OmUxMTMzMDE0Yzc3YmY2OGI4MDVkMWViN2M4M2FkOGRjZGRjMWY2Mzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI9rIcgFqTQ4ODI2MzkwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637", "author": {"user": {"login": "prashantpogde", "name": null}}, "url": "https://github.com/apache/ozone/commit/e1133014c77bf68b805d1eb7c83ad8dcddc1f637", "committedDate": "2020-09-14T06:17:04Z", "message": "HDDS-4174. Add current HDDS layout version to Datanode heartbeat/registration."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NTAwMjcw", "url": "https://github.com/apache/ozone/pull/1421#pullrequestreview-487500270", "createdAt": "2020-09-14T07:49:37Z", "commit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo0OTozN1rOHRH2mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo0OTozN1rOHRH2mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxNjUwNA==", "bodyText": "What is the use case the command where this flag=false. Is it a no-op request?", "url": "https://github.com/apache/ozone/pull/1421#discussion_r487716504", "createdAt": "2020-09-14T07:49:37Z", "author": {"login": "elek"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -390,6 +404,14 @@ message ClosePipelineCommandProto {\n   required int64 cmdId = 2;\n }\n \n+/**\n+ * This command asks the DataNode to finalize a new HDDS layout version.\n+ */\n+message FinalizeNewLayoutVersionCommandProto {\n+  required bool finalizeNewHDDSLayoutVersion = 1 [default = false];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NTA0MTc3", "url": "https://github.com/apache/ozone/pull/1421#pullrequestreview-487504177", "createdAt": "2020-09-14T07:54:58Z", "commit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo1NDo1OVrOHRICgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo1NDo1OVrOHRICgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxOTU1Mw==", "bodyText": "Why not this be a required field? when Datanode firstly register on SCM, it should have its own HDDS layout version.", "url": "https://github.com/apache/ozone/pull/1421#discussion_r487719553", "createdAt": "2020-09-14T07:54:59Z", "author": {"login": "linyiqun"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -92,6 +101,7 @@ message SCMRegisterRequestProto {\n   required NodeReportProto nodeReport = 2;\n   required ContainerReportsProto containerReport = 3;\n   required PipelineReportsProto pipelineReports = 4;\n+  optional HDDSLayoutVersionProto dataNodeLayoutVersion = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3OTI1NTcz", "url": "https://github.com/apache/ozone/pull/1421#pullrequestreview-487925573", "createdAt": "2020-09-14T16:04:03Z", "commit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjowNDowNFrOHRcK8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjowNDowNFrOHRcK8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0OTM5NA==", "bodyText": "Why not use a single line: optional FinalizeNewLayoutVersionCommandProto=9?", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488049394", "createdAt": "2020-09-14T16:04:04Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -303,6 +315,8 @@ message SCMCommandProto {\n   optional ReplicateContainerCommandProto replicateContainerCommandProto = 6;\n   optional CreatePipelineCommandProto createPipelineCommandProto = 7;\n   optional ClosePipelineCommandProto closePipelineCommandProto = 8;\n+  optional FinalizeNewLayoutVersionCommandProto\n+  finalizeNewLayoutVersionCommandProto = 9;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95ae42af5c201d4c5da8e9746c58743b439b4b10", "author": {"user": {"login": "prashantpogde", "name": null}}, "url": "https://github.com/apache/ozone/commit/95ae42af5c201d4c5da8e9746c58743b439b4b10", "committedDate": "2020-09-14T19:22:39Z", "message": "HDDS-4174. Addressing review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MjYzOTA1", "url": "https://github.com/apache/ozone/pull/1421#pullrequestreview-488263905", "createdAt": "2020-09-15T01:39:57Z", "commit": {"oid": "95ae42af5c201d4c5da8e9746c58743b439b4b10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2517, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}