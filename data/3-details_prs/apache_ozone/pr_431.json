{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMzEyNDA1", "number": 431, "title": "HDDS-2846. Handle Datanode Pipeline & Container Reports reports in Recon.", "bodyText": "What changes were proposed in this pull request?\nRecon should be able to process Container and Pipeline reports from registered Datanodes. It still wont be able to understand new containers and pipelines though. Along with HDDS-2850, HDDS-2852 and HDDS-2869, Recon will be a fully functional passive SCM.\nIn addition to the above, some refactoring work also has been done.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-2846\nHow was this patch tested?\nManually tested on docker.\nCreated key (container) on ozone cluster, and verified Recon gets the container info in Datanode heartbeat.", "createdAt": "2020-01-10T07:25:01Z", "url": "https://github.com/apache/ozone/pull/431", "merged": true, "mergeCommit": {"oid": "5d27f45c2cf38a6c40c79f0f870080f8f235f969"}, "closed": true, "closedAt": "2020-01-19T17:19:11Z", "author": {"login": "avijayanhwx"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb45SKfgH2gAyMzYxMzEyNDA1Ojc3NDRkMGYzMjg1ZWMyZDZlOGNkNmYzZGI1ZmE0ZTYxOTMwNTA5MWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb77Qo3AFqTM0NTAxNDc4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7744d0f3285ec2d6e8cd6f3db5fa4e619305091c", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/7744d0f3285ec2d6e8cd6f3db5fa4e619305091c", "committedDate": "2020-01-10T07:19:07Z", "message": "HDDS-2846. Handle Datanode Pipeline & Container Reports reports in Recon."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c", "committedDate": "2020-01-14T05:39:19Z", "message": "Merge remote-tracking branch 'upstream/master' into HDDS-2846-master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MzQ1NjUx", "url": "https://github.com/apache/ozone/pull/431#pullrequestreview-344345651", "createdAt": "2020-01-17T03:23:48Z", "commit": {"oid": "e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwMzoyMzo0OFrOFet5Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwMzoyMzo0OFrOFet5Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc1MzUxOA==", "bodyText": "Minor nit: Should drop the Facade from the class name, a facade merely provides access to underlying subsystems minus the management functions which this class actually does in addition to abstracting out access.", "url": "https://github.com/apache/ozone/pull/431#discussion_r367753518", "createdAt": "2020-01-17T03:23:48Z", "author": {"login": "swagle"}, "path": "hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/scm/ReconStorageContainerManagerFacade.java", "diffHunk": "@@ -27,52 +28,99 @@\n \n import org.apache.hadoop.hdds.conf.OzoneConfiguration;\n import org.apache.hadoop.hdds.scm.block.BlockManager;\n+import org.apache.hadoop.hdds.scm.container.CloseContainerEventHandler;\n+import org.apache.hadoop.hdds.scm.container.ContainerActionsHandler;\n import org.apache.hadoop.hdds.scm.container.ContainerManager;\n+import org.apache.hadoop.hdds.scm.container.ContainerReportHandler;\n+import org.apache.hadoop.hdds.scm.container.IncrementalContainerReportHandler;\n import org.apache.hadoop.hdds.scm.container.ReplicationManager;\n import org.apache.hadoop.hdds.scm.events.SCMEvents;\n import org.apache.hadoop.hdds.scm.net.NetworkTopology;\n import org.apache.hadoop.hdds.scm.net.NetworkTopologyImpl;\n+import org.apache.hadoop.hdds.scm.node.DeadNodeHandler;\n import org.apache.hadoop.hdds.scm.node.NodeManager;\n import org.apache.hadoop.hdds.scm.node.NodeReportHandler;\n+import org.apache.hadoop.hdds.scm.node.SCMNodeManager;\n+import org.apache.hadoop.hdds.scm.node.StaleNodeHandler;\n+import org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler;\n import org.apache.hadoop.hdds.scm.pipeline.PipelineManager;\n+import org.apache.hadoop.hdds.scm.pipeline.PipelineReportHandler;\n+import org.apache.hadoop.hdds.scm.safemode.SafeModeManager;\n import org.apache.hadoop.hdds.scm.server.SCMStorageConfig;\n import org.apache.hadoop.hdds.scm.server.OzoneStorageContainerManager;\n import org.apache.hadoop.hdds.server.events.EventQueue;\n+import org.apache.hadoop.io.IOUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n /**\n  * Recon's 'lite' version of SCM.\n  */\n-public class ReconStorageContainerManager\n+public class ReconStorageContainerManagerFacade", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MzQ1ODQ5", "url": "https://github.com/apache/ozone/pull/431#pullrequestreview-344345849", "createdAt": "2020-01-17T03:24:48Z", "commit": {"oid": "e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDE0Nzgy", "url": "https://github.com/apache/ozone/pull/431#pullrequestreview-345014782", "createdAt": "2020-01-19T17:19:02Z", "commit": {"oid": "e40b6b04ff80d0ea7416b074ddb69e0aeca8a37c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3919, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}