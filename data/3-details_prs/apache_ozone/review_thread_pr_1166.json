{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0OTc3NDAz", "number": 1166, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMDozMFrOEML2qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMzoyNlrOEML6mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMjEyNTg0OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMDozMFrOGuJt5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMzo0MTozOFrOGvo31g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA==", "bodyText": "Thanks @hanishakoneru  for working on this. Not sure if I understand correctly, since we are removing LevelDB support on DN, do we still need to define two types of DB for container here?", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451046884", "createdAt": "2020-07-07T18:00:30Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "diffHunk": "@@ -186,8 +186,8 @@ private void checkContainerFile() throws IOException {\n     }\n \n     dbType = onDiskContainerData.getContainerDBType();\n-    if (!dbType.equals(OZONE_METADATA_STORE_IMPL_ROCKSDB) &&\n-        !dbType.equals(OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (!dbType.equals(CONTAINER_DB_TYPE_ROCKSDB) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MTk0Ng==", "bodyText": "We are deprecating LevelDB support. I kept it there in case there are old containers using LevelDB.\nI am up for removing LevelDB support completely. I think it is safe to assume that there would not be a Container using LevelDB.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452391946", "createdAt": "2020-07-09T17:54:49Z", "author": {"login": "hanishakoneru"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "diffHunk": "@@ -186,8 +186,8 @@ private void checkContainerFile() throws IOException {\n     }\n \n     dbType = onDiskContainerData.getContainerDBType();\n-    if (!dbType.equals(OZONE_METADATA_STORE_IMPL_ROCKSDB) &&\n-        !dbType.equals(OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (!dbType.equals(CONTAINER_DB_TYPE_ROCKSDB) &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA=="}, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYwNTkxMA==", "bodyText": "That makes sense to me.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452605910", "createdAt": "2020-07-10T03:41:38Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "diffHunk": "@@ -186,8 +186,8 @@ private void checkContainerFile() throws IOException {\n     }\n \n     dbType = onDiskContainerData.getContainerDBType();\n-    if (!dbType.equals(OZONE_METADATA_STORE_IMPL_ROCKSDB) &&\n-        !dbType.equals(OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (!dbType.equals(CONTAINER_DB_TYPE_ROCKSDB) &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA=="}, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMjEzMTU4OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMjowNlrOGuJxmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNzo1NTowMlrOGvb0Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzgzNQ==", "bodyText": "Do we still need this?", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451047835", "createdAt": "2020-07-07T18:02:06Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -90,12 +93,12 @@ public void init() throws IOException {\n         + \"-\" + storeImpl.toLowerCase());\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n \n     store = MetadataStoreBuilder.newBuilder()\n         .setConf(conf)\n         .setCreateIfMissing(true)\n         .setDbFile(testDir)\n+        .setDBType(storeImpl)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MjAzOA==", "bodyText": "For the same reason as above.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452392038", "createdAt": "2020-07-09T17:55:02Z", "author": {"login": "hanishakoneru"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -90,12 +93,12 @@ public void init() throws IOException {\n         + \"-\" + storeImpl.toLowerCase());\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n \n     store = MetadataStoreBuilder.newBuilder()\n         .setConf(conf)\n         .setCreateIfMissing(true)\n         .setDbFile(testDir)\n+        .setDBType(storeImpl)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzgzNQ=="}, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMjEzNTkyOnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMzoyNlrOGuJ0cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNzo1NToxM1rOGvb00w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0ODU2MQ==", "bodyText": "The logic needs to be reversed, maybe a typo.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451048561", "createdAt": "2020-07-07T18:03:26Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -166,12 +170,12 @@ public void testIterator() throws Exception {\n   public void testMetaStoreConfigDifferentFromType() throws IOException {\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n+\n     String dbType;\n     GenericTestUtils.setLogLevel(MetadataStoreBuilder.LOG, Level.DEBUG);\n     GenericTestUtils.LogCapturer logCapturer =\n         GenericTestUtils.LogCapturer.captureLogs(MetadataStoreBuilder.LOG);\n-    if (storeImpl.equals(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (storeImpl.equals(CONTAINER_DB_TYPE_LEVELDB)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MjE0Nw==", "bodyText": "Thanks. Will fix it.", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452392147", "createdAt": "2020-07-09T17:55:13Z", "author": {"login": "hanishakoneru"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -166,12 +170,12 @@ public void testIterator() throws Exception {\n   public void testMetaStoreConfigDifferentFromType() throws IOException {\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n+\n     String dbType;\n     GenericTestUtils.setLogLevel(MetadataStoreBuilder.LOG, Level.DEBUG);\n     GenericTestUtils.LogCapturer logCapturer =\n         GenericTestUtils.LogCapturer.captureLogs(MetadataStoreBuilder.LOG);\n-    if (storeImpl.equals(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (storeImpl.equals(CONTAINER_DB_TYPE_LEVELDB)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0ODU2MQ=="}, "originalCommit": {"oid": "86451aeb80c3cd67386e35a3688aeb3a0ff26620"}, "originalPosition": 104}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4168, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}