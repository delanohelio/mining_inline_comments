{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NTY0NjM4", "number": 1636, "title": "HDDS-4496. Separate client and server2server GRPC services of datanode", "bodyText": "What changes were proposed in this pull request?\nToday both the closed-container-replication service and datanode client service are exposed on the same datanode port which makes it impossible to use different network configuration (like mutual TLS).\nIn this patch I propose to separate the two services and use two network ports.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4496\nHow was this patch tested?\nTested the replication with local docker-compose cluster (adding keys, closing container, waiting for replication)", "createdAt": "2020-11-30T13:52:50Z", "url": "https://github.com/apache/ozone/pull/1636", "merged": true, "mergeCommit": {"oid": "a0a936dda93ee513c8eaf1906cd359d10b02b892"}, "closed": true, "closedAt": "2021-01-06T10:36:46Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfUvEYAH2gAyNTI5NTY0NjM4OjNmY2ZjNGI4NDhiOWRlNjNkMTM1ZDhmMzViYzFlMTJiYTZkODBmNGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkcHSwgH2gAyNTI5NTY0NjM4OmMwZGUxMzhlZDI0MmUxMzlkNzc4YjFlNGY1OTVkZjEwZDczNjRlZGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3fcfc4b848b9de63d135d8f35bc1e12ba6d80f4c", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/3fcfc4b848b9de63d135d8f35bc1e12ba6d80f4c", "committedDate": "2020-11-23T12:58:24Z", "message": "replication separation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e432d7d68285ea989264a2c9013753b92c05b83f", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/e432d7d68285ea989264a2c9013753b92c05b83f", "committedDate": "2020-11-24T13:00:51Z", "message": "fix tests + checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec21c3f19d7f4a0a42e4f2a5a4712c7ee5630601", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ec21c3f19d7f4a0a42e4f2a5a4712c7ee5630601", "committedDate": "2020-11-25T07:55:11Z", "message": "temporary fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f97fece21613226320db978c9ca35f06b41930d", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/6f97fece21613226320db978c9ca35f06b41930d", "committedDate": "2020-11-26T12:14:47Z", "message": "ssl context fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d1aab6e7133f2226b20c1d6c224b95d1be9b8e8", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/8d1aab6e7133f2226b20c1d6c224b95d1be9b8e8", "committedDate": "2020-11-26T12:19:23Z", "message": "cleanup the patch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8cdb9d36c2a2b7bf1747c831d68e236fed1d44a", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/b8cdb9d36c2a2b7bf1747c831d68e236fed1d44a", "committedDate": "2020-11-26T12:20:56Z", "message": "checkstyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e7e14e0c037600697ac0796dadb0e8be01241ee", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/3e7e14e0c037600697ac0796dadb0e8be01241ee", "committedDate": "2020-11-26T13:43:03Z", "message": "remove proto reflection service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "562eb0dfb3852a36150312353d3b5c6bf6d45eb4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/562eb0dfb3852a36150312353d3b5c6bf6d45eb4", "committedDate": "2020-11-26T15:34:01Z", "message": "fix grpc error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f22e5617454845a60297aac11694c2b2885f997", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/0f22e5617454845a60297aac11694c2b2885f997", "committedDate": "2020-12-01T15:15:17Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-4496"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bf3cdde0cbd5431e31d8877b8fb16399e379847", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/2bf3cdde0cbd5431e31d8877b8fb16399e379847", "committedDate": "2020-12-01T15:16:31Z", "message": "fix imports after merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a803689bac98e2c74043dc683055d4897653ddf7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/a803689bac98e2c74043dc683055d4897653ddf7", "committedDate": "2020-12-01T15:19:04Z", "message": "signature fixes after merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/a05b2657bcad3a17a6506ba48939954b4018260b", "committedDate": "2020-12-01T15:27:37Z", "message": "fix unit test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzI3NDAy", "url": "https://github.com/apache/ozone/pull/1636#pullrequestreview-542327402", "createdAt": "2020-12-01T21:53:34Z", "commit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMTo1MzozNVrOH9BQxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjoxMDozOVrOH9Bz5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0NTg2MQ==", "bodyText": "Just curious in which case we will get a 0 here after netty server starts. If each server has a non-zero known port for replication server, this should work.\nHowever, if the replication server returns port 0, DatanodeDetails#Name.Replication will be set 0 as well in OzoneContainer#start. How does other DNs figure out the proper port number to connect. Do we have other way to figure out the actual random port number and populate it properly to DatanodeDetails?", "url": "https://github.com/apache/ozone/pull/1636#discussion_r533745861", "createdAt": "2020-12-01T21:53:35Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/replication/ReplicationServer.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.container.replication;\n+\n+import javax.net.ssl.SSLException;\n+import java.io.IOException;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.hadoop.hdds.conf.Config;\n+import org.apache.hadoop.hdds.conf.ConfigGroup;\n+import org.apache.hadoop.hdds.conf.ConfigTag;\n+import org.apache.hadoop.hdds.security.x509.SecurityConfig;\n+import org.apache.hadoop.hdds.security.x509.certificate.client.CertificateClient;\n+import org.apache.hadoop.hdds.tracing.GrpcServerInterceptor;\n+import org.apache.hadoop.ozone.OzoneConsts;\n+import org.apache.hadoop.ozone.container.ozoneimpl.ContainerController;\n+\n+import org.apache.ratis.thirdparty.io.grpc.Server;\n+import org.apache.ratis.thirdparty.io.grpc.ServerBuilder;\n+import org.apache.ratis.thirdparty.io.grpc.ServerInterceptors;\n+import org.apache.ratis.thirdparty.io.grpc.netty.GrpcSslContexts;\n+import org.apache.ratis.thirdparty.io.grpc.netty.NettyServerBuilder;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.ClientAuth;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.SslContextBuilder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Separated network server for server2server container replication.\n+ */\n+public class ReplicationServer {\n+\n+  private static final Logger LOG =\n+      LoggerFactory.getLogger(ReplicationServer.class);\n+\n+  private Server server;\n+\n+  private SecurityConfig secConf;\n+\n+  private CertificateClient caClient;\n+\n+  private ContainerController controller;\n+\n+  private int port;\n+\n+  public ReplicationServer(\n+      ContainerController controller,\n+      ReplicationConfig replicationConfig,\n+      SecurityConfig secConf,\n+      CertificateClient caClient\n+  ) {\n+    this.secConf = secConf;\n+    this.caClient = caClient;\n+    this.controller = controller;\n+    this.port = replicationConfig.getPort();\n+    init();\n+  }\n+\n+  public void init() {\n+    NettyServerBuilder nettyServerBuilder =\n+        ((NettyServerBuilder) ServerBuilder.forPort(port))\n+            .maxInboundMessageSize(OzoneConsts.OZONE_SCM_CHUNK_MAX_SIZE);\n+\n+    GrpcServerInterceptor tracingInterceptor = new GrpcServerInterceptor();\n+    nettyServerBuilder\n+        .addService(ServerInterceptors.intercept(new GrpcReplicationService(\n+            new OnDemandContainerReplicationSource(controller)\n+        ), tracingInterceptor));\n+\n+    if (secConf.isSecurityEnabled()) {\n+      try {\n+        SslContextBuilder sslContextBuilder = SslContextBuilder.forServer(\n+            caClient.getPrivateKey(), caClient.getCertificate());\n+\n+        sslContextBuilder = GrpcSslContexts.configure(\n+            sslContextBuilder, secConf.getGrpcSslProvider());\n+\n+        sslContextBuilder.clientAuth(ClientAuth.REQUIRE);\n+        sslContextBuilder.trustManager(caClient.getCACertificate());\n+\n+        nettyServerBuilder.sslContext(sslContextBuilder.build());\n+      } catch (SSLException ex) {\n+        throw new IllegalArgumentException(\n+            \"Unable to setup TLS for secure datanode replication GRPC \"\n+                + \"endpoint.\", ex);\n+      }\n+    }\n+\n+    server = nettyServerBuilder.build();\n+  }\n+\n+  public void start() throws IOException {\n+    server.start();\n+\n+    port = server.getPort();\n+\n+    if (port == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc1MjAzNA==", "bodyText": "To be consistent with existing replication related configurations, should we move this Configuration key as part of DatanodeConfiguration.java class under the prefix as hdds.datanode.replication.*?", "url": "https://github.com/apache/ozone/pull/1636#discussion_r533752034", "createdAt": "2020-12-01T22:05:09Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/replication/ReplicationServer.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.container.replication;\n+\n+import javax.net.ssl.SSLException;\n+import java.io.IOException;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.hadoop.hdds.conf.Config;\n+import org.apache.hadoop.hdds.conf.ConfigGroup;\n+import org.apache.hadoop.hdds.conf.ConfigTag;\n+import org.apache.hadoop.hdds.security.x509.SecurityConfig;\n+import org.apache.hadoop.hdds.security.x509.certificate.client.CertificateClient;\n+import org.apache.hadoop.hdds.tracing.GrpcServerInterceptor;\n+import org.apache.hadoop.ozone.OzoneConsts;\n+import org.apache.hadoop.ozone.container.ozoneimpl.ContainerController;\n+\n+import org.apache.ratis.thirdparty.io.grpc.Server;\n+import org.apache.ratis.thirdparty.io.grpc.ServerBuilder;\n+import org.apache.ratis.thirdparty.io.grpc.ServerInterceptors;\n+import org.apache.ratis.thirdparty.io.grpc.netty.GrpcSslContexts;\n+import org.apache.ratis.thirdparty.io.grpc.netty.NettyServerBuilder;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.ClientAuth;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.SslContextBuilder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Separated network server for server2server container replication.\n+ */\n+public class ReplicationServer {\n+\n+  private static final Logger LOG =\n+      LoggerFactory.getLogger(ReplicationServer.class);\n+\n+  private Server server;\n+\n+  private SecurityConfig secConf;\n+\n+  private CertificateClient caClient;\n+\n+  private ContainerController controller;\n+\n+  private int port;\n+\n+  public ReplicationServer(\n+      ContainerController controller,\n+      ReplicationConfig replicationConfig,\n+      SecurityConfig secConf,\n+      CertificateClient caClient\n+  ) {\n+    this.secConf = secConf;\n+    this.caClient = caClient;\n+    this.controller = controller;\n+    this.port = replicationConfig.getPort();\n+    init();\n+  }\n+\n+  public void init() {\n+    NettyServerBuilder nettyServerBuilder =\n+        ((NettyServerBuilder) ServerBuilder.forPort(port))\n+            .maxInboundMessageSize(OzoneConsts.OZONE_SCM_CHUNK_MAX_SIZE);\n+\n+    GrpcServerInterceptor tracingInterceptor = new GrpcServerInterceptor();\n+    nettyServerBuilder\n+        .addService(ServerInterceptors.intercept(new GrpcReplicationService(\n+            new OnDemandContainerReplicationSource(controller)\n+        ), tracingInterceptor));\n+\n+    if (secConf.isSecurityEnabled()) {\n+      try {\n+        SslContextBuilder sslContextBuilder = SslContextBuilder.forServer(\n+            caClient.getPrivateKey(), caClient.getCertificate());\n+\n+        sslContextBuilder = GrpcSslContexts.configure(\n+            sslContextBuilder, secConf.getGrpcSslProvider());\n+\n+        sslContextBuilder.clientAuth(ClientAuth.REQUIRE);\n+        sslContextBuilder.trustManager(caClient.getCACertificate());\n+\n+        nettyServerBuilder.sslContext(sslContextBuilder.build());\n+      } catch (SSLException ex) {\n+        throw new IllegalArgumentException(\n+            \"Unable to setup TLS for secure datanode replication GRPC \"\n+                + \"endpoint.\", ex);\n+      }\n+    }\n+\n+    server = nettyServerBuilder.build();\n+  }\n+\n+  public void start() throws IOException {\n+    server.start();\n+\n+    port = server.getPort();\n+\n+    if (port == 0) {\n+      LOG.info(\"{} is started using port {}\", getClass().getSimpleName(), port);\n+    }\n+  }\n+\n+  public void stop() {\n+    try {\n+      server.shutdown().awaitTermination(10L, TimeUnit.SECONDS);\n+    } catch (InterruptedException ex) {\n+      LOG.warn(\"{} couldn't be stopped gracefully\", getClass().getSimpleName());\n+    }\n+  }\n+\n+  public int getPort() {\n+    return port;\n+  }\n+\n+  @ConfigGroup(prefix = \"datanode.replication\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc1NDg1NA==", "bodyText": "NIT: separate line 44 from the *.", "url": "https://github.com/apache/ozone/pull/1636#discussion_r533754854", "createdAt": "2020-12-01T22:10:39Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/replication/ReplicationServer.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.container.replication;\n+\n+import javax.net.ssl.SSLException;\n+import java.io.IOException;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.hadoop.hdds.conf.Config;\n+import org.apache.hadoop.hdds.conf.ConfigGroup;\n+import org.apache.hadoop.hdds.conf.ConfigTag;\n+import org.apache.hadoop.hdds.security.x509.SecurityConfig;\n+import org.apache.hadoop.hdds.security.x509.certificate.client.CertificateClient;\n+import org.apache.hadoop.hdds.tracing.GrpcServerInterceptor;\n+import org.apache.hadoop.ozone.OzoneConsts;\n+import org.apache.hadoop.ozone.container.ozoneimpl.ContainerController;\n+\n+import org.apache.ratis.thirdparty.io.grpc.Server;\n+import org.apache.ratis.thirdparty.io.grpc.ServerBuilder;\n+import org.apache.ratis.thirdparty.io.grpc.ServerInterceptors;\n+import org.apache.ratis.thirdparty.io.grpc.netty.GrpcSslContexts;\n+import org.apache.ratis.thirdparty.io.grpc.netty.NettyServerBuilder;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.ClientAuth;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.SslContextBuilder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Separated network server for server2server container replication.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7dc18d7bbcd6ded90ec119b6ef471c14dbba0f3", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/f7dc18d7bbcd6ded90ec119b6ef471c14dbba0f3", "committedDate": "2020-12-04T11:51:10Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f70c34bd73879eb9bc59c8dc56a9d388bfaf31c", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/6f70c34bd73879eb9bc59c8dc56a9d388bfaf31c", "committedDate": "2020-12-04T11:52:30Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-4496"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NTQ3OTY5", "url": "https://github.com/apache/ozone/pull/1636#pullrequestreview-546547969", "createdAt": "2020-12-07T21:23:52Z", "commit": {"oid": "6f70c34bd73879eb9bc59c8dc56a9d388bfaf31c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMToyMzo1MlrOIA7VZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMToyMzo1MlrOIA7VZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0MzA0Ng==", "bodyText": "The two lines of the class description in the previous commits somehow wraps into the same line as indicated the * in the middle between two sentences. I see this comments has be simplified and not an issue any more.", "url": "https://github.com/apache/ozone/pull/1636#discussion_r537843046", "createdAt": "2020-12-07T21:23:52Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/replication/ReplicationServer.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.container.replication;\n+\n+import javax.net.ssl.SSLException;\n+import java.io.IOException;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.hadoop.hdds.conf.Config;\n+import org.apache.hadoop.hdds.conf.ConfigGroup;\n+import org.apache.hadoop.hdds.conf.ConfigTag;\n+import org.apache.hadoop.hdds.security.x509.SecurityConfig;\n+import org.apache.hadoop.hdds.security.x509.certificate.client.CertificateClient;\n+import org.apache.hadoop.hdds.tracing.GrpcServerInterceptor;\n+import org.apache.hadoop.ozone.OzoneConsts;\n+import org.apache.hadoop.ozone.container.ozoneimpl.ContainerController;\n+\n+import org.apache.ratis.thirdparty.io.grpc.Server;\n+import org.apache.ratis.thirdparty.io.grpc.ServerBuilder;\n+import org.apache.ratis.thirdparty.io.grpc.ServerInterceptors;\n+import org.apache.ratis.thirdparty.io.grpc.netty.GrpcSslContexts;\n+import org.apache.ratis.thirdparty.io.grpc.netty.NettyServerBuilder;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.ClientAuth;\n+import org.apache.ratis.thirdparty.io.netty.handler.ssl.SslContextBuilder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Separated network server for server2server container replication.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc1NDg1NA=="}, "originalCommit": {"oid": "a05b2657bcad3a17a6506ba48939954b4018260b"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0de138ed242e139d778b1e4f595df10d7364ede", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/c0de138ed242e139d778b1e4f595df10d7364ede", "committedDate": "2020-12-09T10:23:49Z", "message": "retrigger build"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1994, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}