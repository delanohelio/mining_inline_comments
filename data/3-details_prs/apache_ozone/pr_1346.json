{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyOTMyNjYz", "number": 1346, "title": "HDDS-4115. CLI command to show current SCM leader and follower status.", "bodyText": "What changes were proposed in this pull request?\nCLI command to show current SCM leader and follower status. E.g. ozone admin scmha listratisstatus\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4115\nHow was this patch tested?\nUnit Test\nCommand line output\n[180.3.14.5:2333, 180.3.14.21:2333, 180.3.14.145:2333]", "createdAt": "2020-08-25T04:41:09Z", "url": "https://github.com/apache/ozone/pull/1346", "merged": true, "mergeCommit": {"oid": "1c2a9502783c677dc24679f879f11782e7a201c1"}, "closed": true, "closedAt": "2020-09-29T06:57:11Z", "author": {"login": "amaliujia"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCw1IxAFqTQ3NTc4ODA5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNDV4cAH2gAyNDcyOTMyNjYzOjAyODEwYjI3NzM5OTc0NmRiN2M4YjUxZmM2ODkxNGI4MDIwZmI4Mzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1Nzg4MDk4", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-475788098", "createdAt": "2020-08-26T19:18:33Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxODozNFrOHHaUMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxODozNFrOHHaUMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMzIzNQ==", "bodyText": "One thing I am not sure is what should be fetched from Ratis peers. Should I also include which one is leader and which one is follower?", "url": "https://github.com/apache/ozone/pull/1346#discussion_r477533235", "createdAt": "2020-08-26T19:18:34Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/server/SCMClientProtocolServer.java", "diffHunk": "@@ -560,6 +563,13 @@ public boolean getReplicationManagerStatus() {\n     return scm.getReplicationManager().isRunning();\n   }\n \n+  @Override\n+  public List<String> getScmRatisStatus() throws IOException {\n+    return scm.getScmHAManager()\n+        .getRatisServer().getRaftPeers()\n+        .stream().map(peer -> peer.getAddress()).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1Nzg4ODA0", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-475788804", "createdAt": "2020-08-26T19:19:33Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxOTozM1rOHHaWVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxOTozM1rOHHaWVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMzc4MA==", "bodyText": "Does this API belongs to StorageContainerLocationProtocol?", "url": "https://github.com/apache/ozone/pull/1346#discussion_r477533780", "createdAt": "2020-08-26T19:19:33Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/scm/protocol/StorageContainerLocationProtocol.java", "diffHunk": "@@ -230,4 +230,5 @@ Pipeline createReplicationPipeline(HddsProtos.ReplicationType type,\n    */\n   boolean getReplicationManagerStatus() throws IOException;\n \n+  List<String> getScmRatisStatus() throws IOException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1Nzg5NDEw", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-475789410", "createdAt": "2020-08-26T19:20:30Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToyMDozMVrOHHaYOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToyMDozMVrOHHaYOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzNDI2Ng==", "bodyText": "This is actually not a unit test as it does not check what is returned. I will think about whether there is a simple way to test that API directly.", "url": "https://github.com/apache/ozone/pull/1346#discussion_r477534266", "createdAt": "2020-08-26T19:20:31Z", "author": {"login": "amaliujia"}, "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/shell/TestScmAdminHA.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.apache.hadoop.ozone.shell;\n+\n+import java.io.File;\n+import java.net.InetSocketAddress;\n+import java.util.Arrays;\n+import java.util.UUID;\n+import org.apache.hadoop.fs.FileUtil;\n+import org.apache.hadoop.hdds.conf.OzoneConfiguration;\n+import org.apache.hadoop.hdds.scm.ScmConfigKeys;\n+import org.apache.hadoop.ozone.MiniOzoneCluster;\n+import org.apache.hadoop.ozone.OzoneConsts;\n+import org.apache.hadoop.ozone.admin.OzoneAdmin;\n+import org.apache.hadoop.ozone.admin.scm.ScmAdmin;\n+import org.apache.hadoop.test.GenericTestUtils;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import picocli.CommandLine;\n+import picocli.CommandLine.RunLast;\n+\n+public class TestScmAdminHA {\n+  private static OzoneAdmin ozoneAdmin;\n+  private static OzoneConfiguration conf;\n+  private static String omServiceId;\n+  private static int numOfOMs;\n+  private static String clusterId;\n+  private static String scmId;\n+  private static MiniOzoneCluster cluster;\n+\n+  @BeforeClass\n+  public static void init() throws Exception {\n+    ozoneAdmin = new OzoneAdmin();\n+    conf = new OzoneConfiguration();\n+\n+    // Init HA cluster\n+    omServiceId = \"om-service-test1\";\n+    numOfOMs = 3;\n+    clusterId = UUID.randomUUID().toString();\n+    scmId = UUID.randomUUID().toString();\n+    cluster = MiniOzoneCluster.newHABuilder(conf)\n+        .setClusterId(clusterId)\n+        .setScmId(scmId)\n+        .setOMServiceId(omServiceId)\n+        .setNumOfOzoneManagers(numOfOMs)\n+        .build();\n+    conf.setQuietMode(false);\n+    // enable ratis for Scm.\n+    conf.setBoolean(ScmConfigKeys.DFS_CONTAINER_RATIS_ENABLED_KEY, true);\n+    cluster.waitForClusterToBeReady();\n+  }\n+\n+  @AfterClass\n+  public static void shutdown() {\n+    if (cluster != null) {\n+      cluster.shutdown();\n+    }\n+  }\n+\n+  @Test\n+  public void testGetLeaderStatus() {\n+    InetSocketAddress address = cluster.getStorageContainerManager().getClientRpcAddress();\n+    String hostPort = address.getHostName() + \":\" + address.getPort();\n+    String[] args = {\"--scm\", hostPort, \"scmha\", \"listratisstatus\"};\n+    ozoneAdmin.execute(args);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 64}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NzM3MzI0", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-479737324", "createdAt": "2020-09-01T13:25:02Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzoyNTowM1rOHK2IlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzoyNTowM1rOHK2IlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDc0MQ==", "bodyText": "GetSCMRatisRole will be better", "url": "https://github.com/apache/ozone/pull/1346#discussion_r481134741", "createdAt": "2020-09-01T13:25:03Z", "author": {"login": "timmylicheng"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/protocol/StorageContainerLocationProtocolServerSideTranslatorPB.java", "diffHunk": "@@ -271,6 +273,14 @@ public ScmContainerLocationResponse processRequest(\n             .setGetSafeModeRuleStatusesResponse(getSafeModeRuleStatues(\n                 request.getGetSafeModeRuleStatusesRequest()))\n             .build();\n+      case ScmHAStatus:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NzQ3NzU1", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-479747755", "createdAt": "2020-09-01T13:36:31Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzozNjozMVrOHK2m9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzozNjozMVrOHK2m9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0MjUxNw==", "bodyText": "Name seems a bit verbose. Let me find a syntax to align with OM HA", "url": "https://github.com/apache/ozone/pull/1346#discussion_r481142517", "createdAt": "2020-09-01T13:36:31Z", "author": {"login": "timmylicheng"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/admin/scm/GetScmRatisStatusSubcommand.java", "diffHunk": "@@ -0,0 +1,26 @@\n+package org.apache.hadoop.ozone.admin.scm;\n+\n+import java.util.List;\n+import java.util.concurrent.Callable;\n+import org.apache.hadoop.hdds.cli.HddsVersionProvider;\n+import org.apache.hadoop.hdds.scm.client.ScmClient;\n+import picocli.CommandLine;\n+\n+@CommandLine.Command(\n+    name = \"listratisstatus\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NzUyOTk3", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-479752997", "createdAt": "2020-09-01T13:42:02Z", "commit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzo0MjowMlrOHK23KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzo0MjowMlrOHK23KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0NjY2NQ==", "bodyText": "Apart from UT, we can have an acceptance test to test CLI.\nYou may find examples here: #375", "url": "https://github.com/apache/ozone/pull/1346#discussion_r481146665", "createdAt": "2020-09-01T13:42:02Z", "author": {"login": "timmylicheng"}, "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/shell/TestScmAdminHA.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.apache.hadoop.ozone.shell;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad3962e0bce8613919b086f2b0d9e47cabef350c", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/ad3962e0bce8613919b086f2b0d9e47cabef350c", "committedDate": "2020-09-01T19:20:27Z", "message": "HDDS-4115. CLI command to show current SCM leader and follower status."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0269d6c98181b233de43eda22e890ec42f416e0f", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/0269d6c98181b233de43eda22e890ec42f416e0f", "committedDate": "2020-09-01T22:42:04Z", "message": "fixup! address comments."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cf37411626ad478b219c48755c8783954118b4f", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/8cf37411626ad478b219c48755c8783954118b4f", "committedDate": "2020-08-25T04:39:05Z", "message": "HDDS-4115. CLI command to show current SCM leader and follower status."}, "afterCommit": {"oid": "0269d6c98181b233de43eda22e890ec42f416e0f", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/0269d6c98181b233de43eda22e890ec42f416e0f", "committedDate": "2020-09-01T22:42:04Z", "message": "fixup! address comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98508154f18058c920074f03f106859eb841145d", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/98508154f18058c920074f03f106859eb841145d", "committedDate": "2020-09-01T22:54:59Z", "message": "fixup! fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ce2bc24a08260ad6d6e6df9732462704ae89cb", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/08ce2bc24a08260ad6d6e6df9732462704ae89cb", "committedDate": "2020-09-01T23:02:20Z", "message": "fixup! fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56f20369b1d9939bb525656869ff00c34e9a5d66", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/56f20369b1d9939bb525656869ff00c34e9a5d66", "committedDate": "2020-09-01T23:09:27Z", "message": "fixup! add cli command description"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8373b6d498113991d98a85ed50cc2b8ef0e43b71", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/8373b6d498113991d98a85ed50cc2b8ef0e43b71", "committedDate": "2020-09-02T07:58:11Z", "message": "fixup! 1. use `ozone admin scm roles` 2. fix acceptance test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/277089b59186debc0c2f769fac69ac1cafe6a56a", "committedDate": "2020-09-02T08:04:55Z", "message": "fixup! fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU3NDc1", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-497057475", "createdAt": "2020-09-27T07:05:35Z", "commit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzowNTozNVrOHYlRZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzowNTozNVrOHYlRZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzODUzNQ==", "bodyText": "We probably want to align the naming here. Either we use roles or status for all external and internal interfaces.", "url": "https://github.com/apache/ozone/pull/1346#discussion_r495538535", "createdAt": "2020-09-27T07:05:35Z", "author": {"login": "timmylicheng"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/admin/scm/GetScmRatisStatusSubcommand.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ *  with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.admin.scm;\n+\n+import java.util.List;\n+import java.util.concurrent.Callable;\n+import org.apache.hadoop.hdds.cli.HddsVersionProvider;\n+import org.apache.hadoop.hdds.scm.client.ScmClient;\n+import picocli.CommandLine;\n+\n+/**\n+ * Handler of scm status command.\n+ */\n+@CommandLine.Command(\n+    name = \"roles\",\n+    description = \"List all SCMs and their respective Ratis server status\",\n+    mixinStandardHelpOptions = true,\n+    versionProvider = HddsVersionProvider.class)\n+public class GetScmRatisStatusSubcommand implements Callable<Void> {\n+\n+  @CommandLine.ParentCommand\n+  private ScmAdmin parent;\n+\n+  @Override\n+  public Void call() throws Exception {\n+    ScmClient scmClient = parent.createScmClient();\n+    List<String> status = scmClient.getScmRatisStatus();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU3NjU0", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-497057654", "createdAt": "2020-09-27T07:08:11Z", "commit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzowODoxMVrOHYlSQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzowODoxMVrOHYlSQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzODc1Mg==", "bodyText": "You mean SCM here?", "url": "https://github.com/apache/ozone/pull/1346#discussion_r495538752", "createdAt": "2020-09-27T07:08:11Z", "author": {"login": "timmylicheng"}, "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/shell/TestScmAdminHA.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ *  with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package org.apache.hadoop.ozone.shell;\n+\n+import java.net.InetSocketAddress;\n+import java.util.UUID;\n+import org.apache.hadoop.hdds.conf.OzoneConfiguration;\n+import org.apache.hadoop.hdds.scm.ScmConfigKeys;\n+import org.apache.hadoop.ozone.MiniOzoneCluster;\n+import org.apache.hadoop.ozone.admin.OzoneAdmin;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+/**\n+ * This class tests ozone admin scm commands.\n+ */\n+public class TestScmAdminHA {\n+  private static OzoneAdmin ozoneAdmin;\n+  private static OzoneConfiguration conf;\n+  private static String omServiceId;\n+  private static int numOfOMs;\n+  private static String clusterId;\n+  private static String scmId;\n+  private static MiniOzoneCluster cluster;\n+\n+  @BeforeClass\n+  public static void init() throws Exception {\n+    ozoneAdmin = new OzoneAdmin();\n+    conf = new OzoneConfiguration();\n+\n+    // Init HA cluster\n+    omServiceId = \"om-service-test1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU4MTM4", "url": "https://github.com/apache/ozone/pull/1346#pullrequestreview-497058138", "createdAt": "2020-09-27T07:15:37Z", "commit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzoxNTozN1rOHYlVDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzoxNTozN1rOHYlVDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzOTQ3MQ==", "bodyText": "You can use the default SCM RatisServer port. Check ratisBindPort in SCMHAConfiguration", "url": "https://github.com/apache/ozone/pull/1346#discussion_r495539471", "createdAt": "2020-09-27T07:15:37Z", "author": {"login": "timmylicheng"}, "path": "hadoop-hdds/server-scm/src/test/java/org/apache/hadoop/hdds/scm/ha/MockSCMHAManager.java", "diffHunk": "@@ -107,6 +108,14 @@ public void shutdown() throws IOException {\n     ratisServer.stop();\n   }\n \n+  @Override\n+  public List<String> getRatisStatus() {\n+    return Arrays.asList(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "277089b59186debc0c2f769fac69ac1cafe6a56a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02810b277399746db7c8b51fc68914b8020fb839", "author": {"user": {"login": "amaliujia", "name": "Rui Wang"}}, "url": "https://github.com/apache/ozone/commit/02810b277399746db7c8b51fc68914b8020fb839", "committedDate": "2020-09-27T18:31:52Z", "message": "fixup! address comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2764, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}