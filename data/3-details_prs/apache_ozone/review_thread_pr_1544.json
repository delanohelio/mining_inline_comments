{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0Mzg2MzE2", "number": 1544, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMDowMDo0N1rOE3osyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMDowODozNVrOE3o4Yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NzczOTYxOnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMDowMDo0N1rOHxGTpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMzozNjoyMFrOHx7Chg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI0NTYwNQ==", "bodyText": "I think a better name for this parameter might be:\n\"hdds.datanode.container.rocksdb.cache.size\"\nThat more clearly says \"this is the cache size for the container rocksDBs\". What do you think?", "url": "https://github.com/apache/ozone/pull/1544#discussion_r521245605", "createdAt": "2020-11-11T10:00:47Z", "author": {"login": "sodonnel"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA4NzEwMQ==", "bodyText": "My initial thought was that metadata tells what the cache is used for, which seemed more useful than rocksdb, which tells how the cache is implemented. But if this config is being changed, knowing that it is for a RocksDB instance might be useful. Maybe we could include both parts? For example, the existing config ozone.metastore.rocksdb.statistics contains both pieces of information.\nI think putting container in the name makes the config sound like it is for one container, whereas just having datanode makes it more apparent that this is the size of one shared cache for the whole DN.\nThese would give a new name like hdds.datanode.rocksdb.metadata.cache.size or hdds.datanode.metadata.store.rocksdb.cache.size which are informative but fairly long. Since ozone-default.xml has a description, this may not be necessary.\nI don't really have a strong opinion either way. If you think hdds.datanode.container.rocksdb.cache.size the best name I am fine with that.", "url": "https://github.com/apache/ozone/pull/1544#discussion_r522087101", "createdAt": "2020-11-12T12:59:18Z", "author": {"login": "errose28"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI0NTYwNQ=="}, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA5MTQ1Ng==", "bodyText": "How about hdds.datanode.metadata.rocksdb.cache.size? I just dropped store from your suggestion.", "url": "https://github.com/apache/ozone/pull/1544#discussion_r522091456", "createdAt": "2020-11-12T13:06:40Z", "author": {"login": "sodonnel"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI0NTYwNQ=="}, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjEwOTU3NA==", "bodyText": "Sounds good to me, I'll update the name.", "url": "https://github.com/apache/ozone/pull/1544#discussion_r522109574", "createdAt": "2020-11-12T13:36:20Z", "author": {"login": "errose28"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI0NTYwNQ=="}, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2Nzc2OTMxOnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMDowODozNVrOHxGlrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMzowMToyM1rOHx5vyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI1MDIyMA==", "bodyText": "The usual pattern here is to have a pair of variables name like:\nPARAMETER_KEY\nPARAMETER_DEFAULT\nI think it would be good to change this variable to HDDS_DATANODE_METADATA_CACHE_SIZE_DEFAULT.\nI see some other parameters in this file don't end in \"_KEY\", so I guess it is not essential to rename HDDS_DATANODE_METADATA_CACHE_SIZE to \"HDDS_DATANODE_METADATA_CACHE_SIZE_KEY\".\nIf we change the parameter name to \"hdds.datanode.container.rocksdb.cache.size\" based on the above comment, maybe we should also rename the variables to HDDS_DATANODE_CONTAINER_ROCKSDB_CACHE_SIZE ?", "url": "https://github.com/apache/ozone/pull/1544#discussion_r521250220", "createdAt": "2020-11-11T10:08:35Z", "author": {"login": "sodonnel"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";\n+  public static final String\n+      HDDS_DATANODE_CACHE_SIZE_DEFAULT = \"64MB\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA4ODM5NQ==", "bodyText": "Yes, this was a typo. I forgot to update the name of the default variable when I updated the name. I will fix it once we decide on a name for the config.", "url": "https://github.com/apache/ozone/pull/1544#discussion_r522088395", "createdAt": "2020-11-12T13:01:23Z", "author": {"login": "errose28"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -343,6 +343,11 @@\n   public static final double\n       HDDS_DATANODE_STORAGE_UTILIZATION_CRITICAL_THRESHOLD_DEFAULT = 0.95;\n \n+  public static final String\n+      HDDS_DATANODE_METADATA_CACHE_SIZE = \"hdds.datanode.metadata.cache.size\";\n+  public static final String\n+      HDDS_DATANODE_CACHE_SIZE_DEFAULT = \"64MB\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTI1MDIyMA=="}, "originalCommit": {"oid": "18d90f717e55b76c8695a8cdcd5a7604e7d02c3e"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4683, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}