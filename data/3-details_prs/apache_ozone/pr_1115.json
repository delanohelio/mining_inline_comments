{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NjQyMDkx", "number": 1115, "title": "HDDS-3632. starter scripts can't manage Ozone and HDFS datandodes on the same machine ", "bodyText": "\u2026\nsince the service names are same and they both referring to same location for pid files, we can not start both services at once.\nTweak is to export HADOOP_PID_DIR to different location after starting one service and start other one.\nIt would be better to have different pid file names.\nUmas-MacBook-Pro ozone-0.5.0-beta % bin/ozone --daemon start datanode\ndatanode is running as process 25167.  Stop it first.\n\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3632\nHow was this patch tested?\n\nStarted a new cluster with compose/ozonescripts\nFixed the configuration (will be uploaded in a separated jira)\nUsed ./start.sh\nChecked if cluster works (ozone sh + volume, bucket, key create)\nChecked if the /tmp/*.pid contains ozone name on the datanodes.", "createdAt": "2020-06-23T15:18:22Z", "url": "https://github.com/apache/ozone/pull/1115", "merged": true, "mergeCommit": {"oid": "b1ab8bcf59ac7525d83d650640f21a1f4b5cd893"}, "closed": true, "closedAt": "2020-07-02T07:53:16Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuG_FYAH2gAyNDM4NjQyMDkxOjZmZDAwMTFlNGQ5MWNmM2M2ZmYwODAxNjU5ZGMyYmY1Nzk3YmY2Nzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwrsmmgFqTQ0MDk2MDE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6fd0011e4d91cf3c6ff0801659dc2bf5797bf679", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/6fd0011e4d91cf3c6ff0801659dc2bf5797bf679", "committedDate": "2020-06-23T15:14:56Z", "message": "HDDS-3632. HddsDatanodeService cannot be started if HDFS datanode running in same machine with same user."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDk3MDY1", "url": "https://github.com/apache/ozone/pull/1115#pullrequestreview-436497065", "createdAt": "2020-06-24T09:53:34Z", "commit": {"oid": "6fd0011e4d91cf3c6ff0801659dc2bf5797bf679"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOTo1MzozNFrOGoLN-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOTo1MzozNFrOGoLN-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc4MDAyNg==", "bodyText": "Won't these privileged files also conflict?  (I don't think this branch is hit with current code, though.)", "url": "https://github.com/apache/ozone/pull/1115#discussion_r444780026", "createdAt": "2020-06-24T09:53:34Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/shell/hdds/hadoop-functions.sh", "diffHunk": "@@ -2702,11 +2702,11 @@ function hadoop_generic_java_subcmd_handler\n     priv_outfile=\"${HADOOP_LOG_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n     priv_errfile=\"${HADOOP_LOG_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.err\"\n     priv_pidfile=\"${HADOOP_PID_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd0011e4d91cf3c6ff0801659dc2bf5797bf679"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTI1Njc1", "url": "https://github.com/apache/ozone/pull/1115#pullrequestreview-439525675", "createdAt": "2020-06-29T21:50:55Z", "commit": {"oid": "6fd0011e4d91cf3c6ff0801659dc2bf5797bf679"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo1MDo1NVrOGqjfIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo1MDo1NVrOGqjfIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI3NDc4NA==", "bodyText": "in below mode also: do we have any scenario where user sets their log DIR to a common folder for all services?\nIf yes, below case also may need update?", "url": "https://github.com/apache/ozone/pull/1115#discussion_r447274784", "createdAt": "2020-06-29T21:50:55Z", "author": {"login": "umamaheswararao"}, "path": "hadoop-ozone/dist/src/shell/hdds/hadoop-functions.sh", "diffHunk": "@@ -2702,11 +2702,11 @@ function hadoop_generic_java_subcmd_handler\n     priv_outfile=\"${HADOOP_LOG_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n     priv_errfile=\"${HADOOP_LOG_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.err\"\n     priv_pidfile=\"${HADOOP_PID_DIR}/privileged-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"\n-    daemon_outfile=\"${HADOOP_LOG_DIR}/hadoop-${HADOOP_SECURE_USER}-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n-    daemon_pidfile=\"${HADOOP_PID_DIR}/hadoop-${HADOOP_SECURE_USER}-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"\n+    daemon_outfile=\"${HADOOP_LOG_DIR}/ozone-${HADOOP_SECURE_USER}-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n+    daemon_pidfile=\"${HADOOP_PID_DIR}/ozone-${HADOOP_SECURE_USER}-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"\n   else\n-    daemon_outfile=\"${HADOOP_LOG_DIR}/hadoop-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n-    daemon_pidfile=\"${HADOOP_PID_DIR}/hadoop-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"\n+    daemon_outfile=\"${HADOOP_LOG_DIR}/ozone-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}-${HOSTNAME}.out\"\n+    daemon_pidfile=\"${HADOOP_PID_DIR}/ozone-${HADOOP_IDENT_STRING}-${HADOOP_SUBCMD}.pid\"\n   fi\n \n   # are we actually in daemon mode?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd0011e4d91cf3c6ff0801659dc2bf5797bf679"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82337ca1c588509779d90e843dd231f63f935514", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/82337ca1c588509779d90e843dd231f63f935514", "committedDate": "2020-06-30T10:30:26Z", "message": "fix remaining hadoop- prefixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0d1d1d485a6a25ec60c02c2c294dd449965ae46", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/d0d1d1d485a6a25ec60c02c2c294dd449965ae46", "committedDate": "2020-06-30T16:18:59Z", "message": "trigger new CI check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwOTAxMDA2", "url": "https://github.com/apache/ozone/pull/1115#pullrequestreview-440901006", "createdAt": "2020-07-01T14:04:57Z", "commit": {"oid": "d0d1d1d485a6a25ec60c02c2c294dd449965ae46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwOTYwMTQz", "url": "https://github.com/apache/ozone/pull/1115#pullrequestreview-440960143", "createdAt": "2020-07-01T15:09:05Z", "commit": {"oid": "d0d1d1d485a6a25ec60c02c2c294dd449965ae46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3014, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}