{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NzA4Mjg2", "number": 502, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwMDo1NzoxOFrODd4ZfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwMDo1NzoxOFrODd4ZfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjU5MzI1OnYy", "diffSide": "LEFT", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/utils/db/DBStoreBuilder.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwMDo1NzoxOFrOFmvSjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNDoxMDoyMVrOFnnYqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2NTAwNg==", "bodyText": "Can we pass the dbProfile's name to addTable so that we can LOG the profile name inside addTable?", "url": "https://github.com/apache/ozone/pull/502#discussion_r376165006", "createdAt": "2020-02-07T00:57:18Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/utils/db/DBStoreBuilder.java", "diffHunk": "@@ -174,21 +184,16 @@ private void processDBProfile() {\n       dbProfile = this.configuration.getEnum(HDDS_DB_PROFILE,\n           HDDS_DEFAULT_DB_PROFILE);\n     }\n+    LOG.debug(\"default profile:{}\", dbProfile);\n   }\n \n   private void processTables() throws IOException {\n-    if (tableNames.size() > 0) {\n-      for (String name : tableNames) {\n-        addTable(name, dbProfile.getColumnFamilyOptions());\n-        LOG.info(\"Using default column profile:{} for Table:{}\",\n-            dbProfile.toString(), name);\n-      }\n+    List<String> list = new ArrayList<>(tableNames);\n+    list.add(DEFAULT_COLUMN_FAMILY_NAME);\n+    for (String name : list) {\n+      LOG.debug(\"using default profile for table:{}\", name);\n+      addTableDefinition(name, dbProfile.getColumnFamilyOptions());\n     }\n-    addTable(StringUtils.bytes2String(RocksDB.DEFAULT_COLUMN_FAMILY),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc000418269857452c824935ddf4b61e65f56a3d"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA4NDA3NA==", "bodyText": "Thanks @xiaoyuyao for the review.\nBoth previously and with this patch only the default profile name is logged, no custom profile names.  (I guess the reason for that is that it's only a ColumnFamilyOptions object being passed to addTable, not a DBProfile, and only the latter has meaningful name).  The patch changes logging of the default profile to happen only once instead of for all tables using it, to avoid repetition.", "url": "https://github.com/apache/ozone/pull/502#discussion_r377084074", "createdAt": "2020-02-10T14:10:21Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/hdds/utils/db/DBStoreBuilder.java", "diffHunk": "@@ -174,21 +184,16 @@ private void processDBProfile() {\n       dbProfile = this.configuration.getEnum(HDDS_DB_PROFILE,\n           HDDS_DEFAULT_DB_PROFILE);\n     }\n+    LOG.debug(\"default profile:{}\", dbProfile);\n   }\n \n   private void processTables() throws IOException {\n-    if (tableNames.size() > 0) {\n-      for (String name : tableNames) {\n-        addTable(name, dbProfile.getColumnFamilyOptions());\n-        LOG.info(\"Using default column profile:{} for Table:{}\",\n-            dbProfile.toString(), name);\n-      }\n+    List<String> list = new ArrayList<>(tableNames);\n+    list.add(DEFAULT_COLUMN_FAMILY_NAME);\n+    for (String name : list) {\n+      LOG.debug(\"using default profile for table:{}\", name);\n+      addTableDefinition(name, dbProfile.getColumnFamilyOptions());\n     }\n-    addTable(StringUtils.bytes2String(RocksDB.DEFAULT_COLUMN_FAMILY),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2NTAwNg=="}, "originalCommit": {"oid": "fc000418269857452c824935ddf4b61e65f56a3d"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 18, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}