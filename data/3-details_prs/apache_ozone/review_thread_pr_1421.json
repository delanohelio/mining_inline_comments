{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MzYxNzk5", "number": 1421, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo0OTozN1rOEjAO4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjowNDowNFrOEjNdUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MTM5NDI3OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo0OTozN1rOHRH2mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMDo1NzoyN1rOHVKdYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxNjUwNA==", "bodyText": "What is the use case the command where this flag=false. Is it a no-op request?", "url": "https://github.com/apache/ozone/pull/1421#discussion_r487716504", "createdAt": "2020-09-14T07:49:37Z", "author": {"login": "elek"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -390,6 +404,14 @@ message ClosePipelineCommandProto {\n   required int64 cmdId = 2;\n }\n \n+/**\n+ * This command asks the DataNode to finalize a new HDDS layout version.\n+ */\n+message FinalizeNewLayoutVersionCommandProto {\n+  required bool finalizeNewHDDSLayoutVersion = 1 [default = false];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0OTczMw==", "bodyText": "yes, that would be a no op request.", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488049733", "createdAt": "2020-09-14T16:04:35Z", "author": {"login": "prashantpogde"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -390,6 +404,14 @@ message ClosePipelineCommandProto {\n   required int64 cmdId = 2;\n }\n \n+/**\n+ * This command asks the DataNode to finalize a new HDDS layout version.\n+ */\n+message FinalizeNewLayoutVersionCommandProto {\n+  required bool finalizeNewHDDSLayoutVersion = 1 [default = false];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxNjUwNA=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk1MzUwNg==", "bodyText": "Is there any use case for this noop request? Will it be used by somebody? Why do we need this field?", "url": "https://github.com/apache/ozone/pull/1421#discussion_r491953506", "createdAt": "2020-09-21T10:57:27Z", "author": {"login": "elek"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -390,6 +404,14 @@ message ClosePipelineCommandProto {\n   required int64 cmdId = 2;\n }\n \n+/**\n+ * This command asks the DataNode to finalize a new HDDS layout version.\n+ */\n+message FinalizeNewLayoutVersionCommandProto {\n+  required bool finalizeNewHDDSLayoutVersion = 1 [default = false];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxNjUwNA=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MTQxNDYxOnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNzo1NDo1OVrOHRICgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxOToyMTozMVrOHRjT2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxOTU1Mw==", "bodyText": "Why not this be a required field? when Datanode firstly register on SCM, it should have its own HDDS layout version.", "url": "https://github.com/apache/ozone/pull/1421#discussion_r487719553", "createdAt": "2020-09-14T07:54:59Z", "author": {"login": "linyiqun"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -92,6 +101,7 @@ message SCMRegisterRequestProto {\n   required NodeReportProto nodeReport = 2;\n   required ContainerReportsProto containerReport = 3;\n   required PipelineReportsProto pipelineReports = 4;\n+  optional HDDSLayoutVersionProto dataNodeLayoutVersion = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA1MTI4Nw==", "bodyText": "Datanode need not pass the HDDSLaoutVersionProto information during registration.", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488051287", "createdAt": "2020-09-14T16:06:45Z", "author": {"login": "prashantpogde"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -92,6 +101,7 @@ message SCMRegisterRequestProto {\n   required NodeReportProto nodeReport = 2;\n   required ContainerReportsProto containerReport = 3;\n   required PipelineReportsProto pipelineReports = 4;\n+  optional HDDSLayoutVersionProto dataNodeLayoutVersion = 5;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxOTU1Mw=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE2NjM2MA==", "bodyText": "All new fields added should be optional for backward compatibility.", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488166360", "createdAt": "2020-09-14T19:21:31Z", "author": {"login": "prashantpogde"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -92,6 +101,7 @@ message SCMRegisterRequestProto {\n   required NodeReportProto nodeReport = 2;\n   required ContainerReportsProto containerReport = 3;\n   required PipelineReportsProto pipelineReports = 4;\n+  optional HDDSLayoutVersionProto dataNodeLayoutVersion = 5;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzcxOTU1Mw=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzU2MTE0OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjowNDowNFrOHRcK8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoxMTo1MlrOHRcgDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0OTM5NA==", "bodyText": "Why not use a single line: optional FinalizeNewLayoutVersionCommandProto=9?", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488049394", "createdAt": "2020-09-14T16:04:04Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -303,6 +315,8 @@ message SCMCommandProto {\n   optional ReplicateContainerCommandProto replicateContainerCommandProto = 6;\n   optional CreatePipelineCommandProto createPipelineCommandProto = 7;\n   optional ClosePipelineCommandProto closePipelineCommandProto = 8;\n+  optional FinalizeNewLayoutVersionCommandProto\n+  finalizeNewLayoutVersionCommandProto = 9;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA1MjEwNw==", "bodyText": "80 columns", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488052107", "createdAt": "2020-09-14T16:07:57Z", "author": {"login": "prashantpogde"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -303,6 +315,8 @@ message SCMCommandProto {\n   optional ReplicateContainerCommandProto replicateContainerCommandProto = 6;\n   optional CreatePipelineCommandProto createPipelineCommandProto = 7;\n   optional ClosePipelineCommandProto closePipelineCommandProto = 8;\n+  optional FinalizeNewLayoutVersionCommandProto\n+  finalizeNewLayoutVersionCommandProto = 9;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0OTM5NA=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA1NDc5Nw==", "bodyText": "Ah I see. Didn't know Ozone also enforce that in proto files (very common that message name is very long).", "url": "https://github.com/apache/ozone/pull/1421#discussion_r488054797", "createdAt": "2020-09-14T16:11:52Z", "author": {"login": "amaliujia"}, "path": "hadoop-hdds/interface-server/src/main/proto/ScmServerDatanodeHeartbeatProtocol.proto", "diffHunk": "@@ -303,6 +315,8 @@ message SCMCommandProto {\n   optional ReplicateContainerCommandProto replicateContainerCommandProto = 6;\n   optional CreatePipelineCommandProto createPipelineCommandProto = 7;\n   optional ClosePipelineCommandProto closePipelineCommandProto = 8;\n+  optional FinalizeNewLayoutVersionCommandProto\n+  finalizeNewLayoutVersionCommandProto = 9;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0OTM5NA=="}, "originalCommit": {"oid": "e1133014c77bf68b805d1eb7c83ad8dcddc1f637"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4895, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}