{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNTUzOTMz", "number": 1352, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMToyNDoyMlrOEch8Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMToyNTo1MVrOEch-WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MzUxNjk4OnYy", "diffSide": "RIGHT", "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMToyNDoyMlrOHHHnyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxODoyNToxM1rOHIcNPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNjk1Mw==", "bodyText": "Why is this line required to use META-INF based discovery?", "url": "https://github.com/apache/ozone/pull/1352#discussion_r477226953", "createdAt": "2020-08-26T11:24:22Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "diffHunk": "@@ -14,6 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n+CORE-SITE.XML_fs.defaultFS=ofs://om", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ2NzI2Mg==", "bodyText": "Hi @elek , in most automated robot tests fs.defaultFS isn't really used.\nMostly it improves QoL when user logs into the docker-compose cluster and manually checks for something (e.g. docker-compose exec om /bin/bash then ozone fs -ls /).\nI can remove them from this PR.", "url": "https://github.com/apache/ozone/pull/1352#discussion_r477467262", "createdAt": "2020-08-26T17:26:34Z", "author": {"login": "smengcl"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "diffHunk": "@@ -14,6 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n+CORE-SITE.XML_fs.defaultFS=ofs://om", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNjk1Mw=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4ODM5MQ==", "bodyText": "Mostly it improves QoL when user logs into the docker-compose cluster and manually checks for something (e.g. docker-compose exec om /bin/bash then ozone fs -ls /).\n\nGood point. And I agree to support debug ofs is better choice as all the volumes are visible by default.", "url": "https://github.com/apache/ozone/pull/1352#discussion_r478388391", "createdAt": "2020-08-27T12:42:11Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "diffHunk": "@@ -14,6 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n+CORE-SITE.XML_fs.defaultFS=ofs://om", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNjk1Mw=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYwNzU5NA==", "bodyText": "Thanks @elek . I will file another jira to add those trivial docker-config changes then.", "url": "https://github.com/apache/ozone/pull/1352#discussion_r478607594", "createdAt": "2020-08-27T18:15:31Z", "author": {"login": "smengcl"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "diffHunk": "@@ -14,6 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n+CORE-SITE.XML_fs.defaultFS=ofs://om", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNjk1Mw=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYxMjc5OA==", "bodyText": "Filed https://issues.apache.org/jira/browse/HDDS-4161", "url": "https://github.com/apache/ozone/pull/1352#discussion_r478612798", "createdAt": "2020-08-27T18:25:13Z", "author": {"login": "smengcl"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-csi/docker-config", "diffHunk": "@@ -14,6 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n+CORE-SITE.XML_fs.defaultFS=ofs://om", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNjk1Mw=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MzUyMjE2OnYy", "diffSide": "RIGHT", "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/docker-config", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMToyNTo1MVrOHHHq1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMjo1OTowNVrOHIPLKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzczNQ==", "bodyText": "Why do we need this line to use META-INF services based discovery?", "url": "https://github.com/apache/ozone/pull/1352#discussion_r477227735", "createdAt": "2020-08-26T11:25:51Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/docker-config", "diffHunk": "@@ -14,8 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n-CORE-SITE.XML_fs.o3fs.impl=org.apache.hadoop.fs.ozone.OzoneFileSystem\n-CORE-SITE.XML_fs.defaultFS=o3fs://bucket1.volume1.omservice\n+CORE-SITE.XML_fs.defaultFS=ofs://omservice", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM4NDU3OQ==", "bodyText": "I think only MR tests (ozone-mr and ozonesecure-mr) use defaultFS when setting up MR environment:\nhttps://github.com/apache/hadoop-ozone/blob/8102ac799816f417e096873b6f351fd531f7bfbf/hadoop-ozone/dist/src/main/smoketest/createmrenv.robot#L46-L47\nChanging defaultFS to ofs:// in these environments can help validate the META-INF changes.\nChanging/adding defaultFS in the other ones is not needed IMO.", "url": "https://github.com/apache/ozone/pull/1352#discussion_r477384579", "createdAt": "2020-08-26T15:20:35Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/docker-config", "diffHunk": "@@ -14,8 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n-CORE-SITE.XML_fs.o3fs.impl=org.apache.hadoop.fs.ozone.OzoneFileSystem\n-CORE-SITE.XML_fs.defaultFS=o3fs://bucket1.volume1.omservice\n+CORE-SITE.XML_fs.defaultFS=ofs://omservice", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzczNQ=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM5MTg0OQ==", "bodyText": "AFAIK these are just helper lines, not really the test of the file system. META-INF/services are already tested as test.sh is modified to do both o3fs/ofs tests.\nI am fine to replace all the defaultFS just let's agree first what do we need to test. Do we need different MR test with both kind of defaultFs?\nOr is it enough to test o3fs/ofs low level functionality and MR can use just one of them?\n(And you see it's a different discussion, that's the reason why I suggested to do it in a separated PR. But can be included if you think it's better.)", "url": "https://github.com/apache/ozone/pull/1352#discussion_r478391849", "createdAt": "2020-08-27T12:47:30Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/docker-config", "diffHunk": "@@ -14,8 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n-CORE-SITE.XML_fs.o3fs.impl=org.apache.hadoop.fs.ozone.OzoneFileSystem\n-CORE-SITE.XML_fs.defaultFS=o3fs://bucket1.volume1.omservice\n+CORE-SITE.XML_fs.defaultFS=ofs://omservice", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzczNQ=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM5OTI3Mw==", "bodyText": "META-INF/services are already tested as test.sh is modified to do both o3fs/ofs tests.\n\nGot it.\n\nDo we need different MR test with both kind of defaultFs?\n\nI'm doing that in HDDS-3840.  I'll pass it via -D command-line option, as different value is needed for each test in the same cluster.\nI guess I can retain the cluster-level config for convenience.", "url": "https://github.com/apache/ozone/pull/1352#discussion_r478399273", "createdAt": "2020-08-27T12:59:05Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-om-ha/docker-config", "diffHunk": "@@ -14,8 +14,8 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n-CORE-SITE.XML_fs.o3fs.impl=org.apache.hadoop.fs.ozone.OzoneFileSystem\n-CORE-SITE.XML_fs.defaultFS=o3fs://bucket1.volume1.omservice\n+CORE-SITE.XML_fs.defaultFS=ofs://omservice", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzczNQ=="}, "originalCommit": {"oid": "9670c6e6a34f96c8ce6599800b06ccb145f9af0b"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3919, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}