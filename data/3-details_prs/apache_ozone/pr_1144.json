{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMTg2MzEy", "number": 1144, "title": "HDDS-3803. [OFS] Add User Guide", "bodyText": "What changes were proposed in this pull request?\nAdd/update OFS user guide ofs.md.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3803\nHow was this patch tested?\nNo testing necessary.", "createdAt": "2020-06-29T04:21:52Z", "url": "https://github.com/apache/ozone/pull/1144", "merged": true, "mergeCommit": {"oid": "1d13b4fb18d5ceb830380f09b62fa1740c96b5f5"}, "closed": true, "closedAt": "2020-06-30T18:47:08Z", "author": {"login": "smengcl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcv5NlcgH2gAyNDQxMTg2MzEyOjVmMjVjYTBkNGEyNWQ2OGUzYTI4MzFlZThlM2U5NTQxNTEyNjdkYjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwaMXSgH2gAyNDQxMTg2MzEyOjU3YTU2N2U5YzRjMDc4Y2RiN2M5ZDZhMDdiMGU1ZWE2OGE2YTc2OWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/5f25ca0d4a25d68e3a2831ee8e3e954151267db3", "committedDate": "2020-06-29T04:19:57Z", "message": "Update ofs.md.\n\nChange-Id: Ib6c6181170e6f45cd24cfa7b6371d4de85fbdaa8"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTY4MzIw", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-439568320", "createdAt": "2020-06-29T23:27:09Z", "commit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyNzowOVrOGql-ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyNzowOVrOGql-ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzMxNTYxOQ==", "bodyText": "I think we could add a separate admin command called provisionTmp to hide these details. This can be a separate JIRA.", "url": "https://github.com/apache/ozone/pull/1144#discussion_r447315619", "createdAt": "2020-06-29T23:27:09Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/docs/content/design/ofs.md", "diffHunk": "@@ -22,12 +22,140 @@ author: Siyao Meng\n \n # Abstract\n \n-  Existing scheme: o3fs://bucket.volume/key/../...\n+  Scheme: ofs://<Hostname[:Port] or Service ID>/[<volumeName>/<bucketName>/path/to/key]\n+\n+# The Basics\n+\n+Examples of valid OFS paths:\n+\n+```\n+ofs://om1/\n+ofs://om3:9862/\n+ofs://omservice/\n+ofs://omservice/volume1/\n+ofs://omservice/volume1/bucket1/\n+ofs://omservice/volume1/bucket1/dir1\n+ofs://omservice/volume1/bucket1/dir1/key1\n+\n+ofs://omservice/tmp/\n+ofs://omservice/tmp/key1\n+```\n+\n+Volumes and mount(s) are located at the root level of an OFS Filesystem.\n+Buckets are listed naturally under volumes.\n+Keys and directories are under each buckets.\n+\n+Note that for mounts, only temp mount `/tmp` is supported at the moment.\n+\n+# Differences from existing o3fs\n+\n+## Creating files\n+\n+OFS doesn't allow creating keys(files) directly under root or volumes.\n+Users will receive an error message when they try to do that:\n+\n+```\n+$ ozone fs -touch /volume1/key1\n+touch: Cannot create file under root or volume.\n+```\n+\n+## Simplify fs.defaultFS\n+\n+With OFS, fs.defaultFS (in core-site.xml) no longer needs to have a specific\n+volume and bucket in its path like o3fs did.\n+Simply put the OM host or service ID:\n+\n+```\n+<property>\n+<name>fs.defaultFS</name>\n+<value>ofs://omservice</value>\n+</property>\n+```\n+\n+The client would then be able to access every volume and bucket on the cluster\n+without specifying the hostname or service ID.\n+\n+```\n+$ ozone fs -mkdir -p /volume1/bucket1\n+```\n+\n+## Volume and bucket management directly from FileSystem shell\n+\n+Admins can create and delete volumes and buckets easily with Hadoop FS shell.\n+Volumes and buckets are treated similar to directories so they will be created\n+if they don't exist with `-p`:\n+\n+```\n+$ ozone fs -mkdir -p ofs://omservice/volume1/bucket1/dir1/\n+```\n+\n+Note that the supported volume and bucket name character set rule still applies.\n+For instance, bucket and volume names don't take underscore(`_`):\n+\n+```\n+$ ozone fs -mkdir -p /volume_1\n+mkdir: Bucket or Volume name has an unsupported character : _\n+```\n+\n+# Mounts\n+\n+In order to be compatible with legacy Hadoop applications that use /tmp/,\n+we have a special temp mount located at the root of the FS.\n+This feature may be expanded in the feature to support custom mount paths.\n+\n+Important: To use it, first, an **admin** needs to create the volume tmp\n+(the volume name is hardcoded for now) and set its ACL to world ALL access.\n+Namely:\n+\n+```\n+$ ozone sh volume create tmp", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "originalPosition": 100}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTY5MDUy", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-439569052", "createdAt": "2020-06-29T23:29:18Z", "commit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyOToxOVrOGqmBAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyOToxOVrOGqmBAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzMxNjIyNg==", "bodyText": "NIT: can we rename this to \"Delete with trash enabled\"", "url": "https://github.com/apache/ozone/pull/1144#discussion_r447316226", "createdAt": "2020-06-29T23:29:19Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/docs/content/design/ofs.md", "diffHunk": "@@ -22,12 +22,140 @@ author: Siyao Meng\n \n # Abstract\n \n-  Existing scheme: o3fs://bucket.volume/key/../...\n+  Scheme: ofs://<Hostname[:Port] or Service ID>/[<volumeName>/<bucketName>/path/to/key]\n+\n+# The Basics\n+\n+Examples of valid OFS paths:\n+\n+```\n+ofs://om1/\n+ofs://om3:9862/\n+ofs://omservice/\n+ofs://omservice/volume1/\n+ofs://omservice/volume1/bucket1/\n+ofs://omservice/volume1/bucket1/dir1\n+ofs://omservice/volume1/bucket1/dir1/key1\n+\n+ofs://omservice/tmp/\n+ofs://omservice/tmp/key1\n+```\n+\n+Volumes and mount(s) are located at the root level of an OFS Filesystem.\n+Buckets are listed naturally under volumes.\n+Keys and directories are under each buckets.\n+\n+Note that for mounts, only temp mount `/tmp` is supported at the moment.\n+\n+# Differences from existing o3fs\n+\n+## Creating files\n+\n+OFS doesn't allow creating keys(files) directly under root or volumes.\n+Users will receive an error message when they try to do that:\n+\n+```\n+$ ozone fs -touch /volume1/key1\n+touch: Cannot create file under root or volume.\n+```\n+\n+## Simplify fs.defaultFS\n+\n+With OFS, fs.defaultFS (in core-site.xml) no longer needs to have a specific\n+volume and bucket in its path like o3fs did.\n+Simply put the OM host or service ID:\n+\n+```\n+<property>\n+<name>fs.defaultFS</name>\n+<value>ofs://omservice</value>\n+</property>\n+```\n+\n+The client would then be able to access every volume and bucket on the cluster\n+without specifying the hostname or service ID.\n+\n+```\n+$ ozone fs -mkdir -p /volume1/bucket1\n+```\n+\n+## Volume and bucket management directly from FileSystem shell\n+\n+Admins can create and delete volumes and buckets easily with Hadoop FS shell.\n+Volumes and buckets are treated similar to directories so they will be created\n+if they don't exist with `-p`:\n+\n+```\n+$ ozone fs -mkdir -p ofs://omservice/volume1/bucket1/dir1/\n+```\n+\n+Note that the supported volume and bucket name character set rule still applies.\n+For instance, bucket and volume names don't take underscore(`_`):\n+\n+```\n+$ ozone fs -mkdir -p /volume_1\n+mkdir: Bucket or Volume name has an unsupported character : _\n+```\n+\n+# Mounts\n+\n+In order to be compatible with legacy Hadoop applications that use /tmp/,\n+we have a special temp mount located at the root of the FS.\n+This feature may be expanded in the feature to support custom mount paths.\n+\n+Important: To use it, first, an **admin** needs to create the volume tmp\n+(the volume name is hardcoded for now) and set its ACL to world ALL access.\n+Namely:\n+\n+```\n+$ ozone sh volume create tmp\n+$ ozone sh volume setacl tmp -al world::a\n+```\n+\n+These commands only needs to be done **once per cluster**.\n+\n+Then, **each user** needs to mkdir first to initialize their own temp bucket\n+once.\n+\n+```\n+$ ozone fs -mkdir /tmp\n+2020-06-04 00:00:00,050 [main] INFO rpc.RpcClient: Creating Bucket: tmp/0238 ...\n+```\n+\n+After that they can write to it just like they would do to a regular\n+directory. e.g.:\n+\n+```\n+$ ozone fs -touch /tmp/key1\n+```\n+\n+# Delete to trash", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "originalPosition": 121}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTY5MTcz", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-439569173", "createdAt": "2020-06-29T23:29:42Z", "commit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyOTo0MlrOGqmBaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMzoyOTo0MlrOGqmBaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzMxNjMyOA==", "bodyText": "deleted to trash=> deleted with trash enabled", "url": "https://github.com/apache/ozone/pull/1144#discussion_r447316328", "createdAt": "2020-06-29T23:29:42Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/docs/content/design/ofs.md", "diffHunk": "@@ -22,12 +22,140 @@ author: Siyao Meng\n \n # Abstract\n \n-  Existing scheme: o3fs://bucket.volume/key/../...\n+  Scheme: ofs://<Hostname[:Port] or Service ID>/[<volumeName>/<bucketName>/path/to/key]\n+\n+# The Basics\n+\n+Examples of valid OFS paths:\n+\n+```\n+ofs://om1/\n+ofs://om3:9862/\n+ofs://omservice/\n+ofs://omservice/volume1/\n+ofs://omservice/volume1/bucket1/\n+ofs://omservice/volume1/bucket1/dir1\n+ofs://omservice/volume1/bucket1/dir1/key1\n+\n+ofs://omservice/tmp/\n+ofs://omservice/tmp/key1\n+```\n+\n+Volumes and mount(s) are located at the root level of an OFS Filesystem.\n+Buckets are listed naturally under volumes.\n+Keys and directories are under each buckets.\n+\n+Note that for mounts, only temp mount `/tmp` is supported at the moment.\n+\n+# Differences from existing o3fs\n+\n+## Creating files\n+\n+OFS doesn't allow creating keys(files) directly under root or volumes.\n+Users will receive an error message when they try to do that:\n+\n+```\n+$ ozone fs -touch /volume1/key1\n+touch: Cannot create file under root or volume.\n+```\n+\n+## Simplify fs.defaultFS\n+\n+With OFS, fs.defaultFS (in core-site.xml) no longer needs to have a specific\n+volume and bucket in its path like o3fs did.\n+Simply put the OM host or service ID:\n+\n+```\n+<property>\n+<name>fs.defaultFS</name>\n+<value>ofs://omservice</value>\n+</property>\n+```\n+\n+The client would then be able to access every volume and bucket on the cluster\n+without specifying the hostname or service ID.\n+\n+```\n+$ ozone fs -mkdir -p /volume1/bucket1\n+```\n+\n+## Volume and bucket management directly from FileSystem shell\n+\n+Admins can create and delete volumes and buckets easily with Hadoop FS shell.\n+Volumes and buckets are treated similar to directories so they will be created\n+if they don't exist with `-p`:\n+\n+```\n+$ ozone fs -mkdir -p ofs://omservice/volume1/bucket1/dir1/\n+```\n+\n+Note that the supported volume and bucket name character set rule still applies.\n+For instance, bucket and volume names don't take underscore(`_`):\n+\n+```\n+$ ozone fs -mkdir -p /volume_1\n+mkdir: Bucket or Volume name has an unsupported character : _\n+```\n+\n+# Mounts\n+\n+In order to be compatible with legacy Hadoop applications that use /tmp/,\n+we have a special temp mount located at the root of the FS.\n+This feature may be expanded in the feature to support custom mount paths.\n+\n+Important: To use it, first, an **admin** needs to create the volume tmp\n+(the volume name is hardcoded for now) and set its ACL to world ALL access.\n+Namely:\n+\n+```\n+$ ozone sh volume create tmp\n+$ ozone sh volume setacl tmp -al world::a\n+```\n+\n+These commands only needs to be done **once per cluster**.\n+\n+Then, **each user** needs to mkdir first to initialize their own temp bucket\n+once.\n+\n+```\n+$ ozone fs -mkdir /tmp\n+2020-06-04 00:00:00,050 [main] INFO rpc.RpcClient: Creating Bucket: tmp/0238 ...\n+```\n+\n+After that they can write to it just like they would do to a regular\n+directory. e.g.:\n+\n+```\n+$ ozone fs -touch /tmp/key1\n+```\n+\n+# Delete to trash\n+\n+When keys are deleted to trash, they are moved to a trash directory under", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "originalPosition": 123}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTY5Njcw", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-439569670", "createdAt": "2020-06-29T23:31:09Z", "commit": {"oid": "5f25ca0d4a25d68e3a2831ee8e3e954151267db3"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ee78167b8bf32cc64c0bc1f2ea7c2f77d97b51d", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/0ee78167b8bf32cc64c0bc1f2ea7c2f77d97b51d", "committedDate": "2020-06-30T05:07:05Z", "message": "Update doc.\n\nChange-Id: I9e6a192d28ad9947bae19ccefe3466511cd7886a"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjAwMzEz", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-440200313", "createdAt": "2020-06-30T16:42:38Z", "commit": {"oid": "0ee78167b8bf32cc64c0bc1f2ea7c2f77d97b51d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjo0MjozOFrOGrFRNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjo0MjozOFrOGrFRNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyODI3Nw==", "bodyText": "can we update the date given the status changed below?", "url": "https://github.com/apache/ozone/pull/1144#discussion_r447828277", "createdAt": "2020-06-30T16:42:38Z", "author": {"login": "xiaoyuyao"}, "path": "hadoop-hdds/docs/content/design/ofs.md", "diffHunk": "@@ -3,7 +3,7 @@ title: Implement new Ozone FileSystem scheme ofs://\n summary: A new schema structure for Hadoop compatible file system\n date: 2019-12-05", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ee78167b8bf32cc64c0bc1f2ea7c2f77d97b51d"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjEwODM5", "url": "https://github.com/apache/ozone/pull/1144#pullrequestreview-440210839", "createdAt": "2020-06-30T16:55:29Z", "commit": {"oid": "0ee78167b8bf32cc64c0bc1f2ea7c2f77d97b51d"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57a567e9c4c078cdb7c9d6a07b0e5ea68a6a769f", "author": {"user": {"login": "smengcl", "name": "Siyao Meng"}}, "url": "https://github.com/apache/ozone/commit/57a567e9c4c078cdb7c9d6a07b0e5ea68a6a769f", "committedDate": "2020-06-30T18:45:29Z", "message": "Update date.\n\nChange-Id: I047ae8448d31a1cb418f2d9a17d5fcb38c80b105"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3043, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}