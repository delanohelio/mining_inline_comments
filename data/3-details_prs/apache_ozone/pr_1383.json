{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NDcxMjk4", "number": 1383, "title": "HDDS-4194. Create a script to check AWS S3 compatibility", "bodyText": "What changes were proposed in this pull request?\nOzone S3G implements the REST interface of AWS S3 protocol. Our robot test based scripts check if it's possible to use Ozone S3 with the AWS client tool.\nBut occasionally we should check if our robot test definitions are valid: robot tests should be executed with using real AWS endpoint and bucket(s) and all the test cases should be passed.\nThis patch provides a simple shell script to make this cross-check easier.\nImplementation\nPlease note that for reliable testing we shouldn't use the same keys for tests. I added a random prefix to the used keys to make sure that tests don't use any existing data from the bucket.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4194\nHow was this patch tested?\nExecuted the new script with setting environment variables to REAL aws buckets.\nToday it's expected to be fail with MPU ranged copy. It's a bug in our implementation and will be fixed by https://issues.apache.org/jira/browse/HDDS-4193", "createdAt": "2020-09-03T08:53:51Z", "url": "https://github.com/apache/ozone/pull/1383", "merged": true, "mergeCommit": {"oid": "c955729c3c134d1a3e28eca7850c44f001d486ad"}, "closed": true, "closedAt": "2020-09-24T19:43:58Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE-91PgH2gAyNDc4NDcxMjk4OjI0MGY3ZjAzMTkwNmNlMGMwZTY5MDFiOWZkZmVlNTRkM2EyNjRmYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMDFUVgFqTQ5NTcwNTUzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "240f7f031906ce0c0e6901b9fdfee54d3a264fa4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/240f7f031906ce0c0e6901b9fdfee54d3a264fa4", "committedDate": "2020-09-02T16:54:35Z", "message": "HDDS-4194. Create a script to check AWS S3 compatiblity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a6d26360a8318d2a49e615ba9e695db3cdf1ff7", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/5a6d26360a8318d2a49e615ba9e695db3cdf1ff7", "committedDate": "2020-09-03T08:50:40Z", "message": "remove generated test results"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzUxOTQw", "url": "https://github.com/apache/ozone/pull/1383#pullrequestreview-491351940", "createdAt": "2020-09-18T10:46:29Z", "commit": {"oid": "5a6d26360a8318d2a49e615ba9e695db3cdf1ff7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDo0NjoyOVrOHUH1cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDo0NzozNVrOHUH3lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg2MTkzOA==", "bodyText": "Is lack of quotes (flagged by SC2086) necessary for the script to work?", "url": "https://github.com/apache/ozone/pull/1383#discussion_r490861938", "createdAt": "2020-09-18T10:46:29Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/smoketest/s3/s3_compatbility_check.sh", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+# shellcheck disable=SC2086", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a6d26360a8318d2a49e615ba9e695db3cdf1ff7"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg2MjQ4NQ==", "bodyText": "Might be better to avoid using test, which is also the name of a shell builtin.", "url": "https://github.com/apache/ozone/pull/1383#discussion_r490862485", "createdAt": "2020-09-18T10:47:35Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/smoketest/s3/s3_compatbility_check.sh", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+# shellcheck disable=SC2086\n+\n+set -e\n+\n+# This script helps to execute S3 robot test against real AWS s3 endpoint\n+# To make sure that all of our defined tests cases copies the behavior of AWS\n+\n+: ${OZONE_TEST_S3_BUCKET1:?Please define test bucket}\n+: ${OZONE_TEST_S3_BUCKET2:?Please define second test bucket}\n+: ${OZONE_TEST_S3_REGION:?Please define the S3 region for test buckets}\n+\n+test() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a6d26360a8318d2a49e615ba9e695db3cdf1ff7"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8e86a2d85395ec693fc60520674fc69bfd08250", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/e8e86a2d85395ec693fc60520674fc69bfd08250", "committedDate": "2020-09-23T11:53:58Z", "message": "rename test method to avoid conflict with the built-in"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a83be3360b2dc2a65a37d7be0fe93749748b63", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/a8a83be3360b2dc2a65a37d7be0fe93749748b63", "committedDate": "2020-09-23T11:55:17Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-4194"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NzA1NTM0", "url": "https://github.com/apache/ozone/pull/1383#pullrequestreview-495705534", "createdAt": "2020-09-24T15:39:51Z", "commit": {"oid": "a8a83be3360b2dc2a65a37d7be0fe93749748b63"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2434, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}