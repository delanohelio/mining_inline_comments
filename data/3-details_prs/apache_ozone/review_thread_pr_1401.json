{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwNTYzNjk0", "number": 1401, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxODowNVrOEg6gfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxOTowMFrOEg6htA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyOTQ4NDc5OnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/common/src/main/conf/hadoop-env.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxODowNVrOHN9Nkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QyMzozMjowOFrOHOIxlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjQzNQ==", "bodyText": "I think OZONE_OM_OPTS is aligned with the naming conventions. Especially as it's already working thanks to the\nhadoop_subcommand_opts \"${HADOOP_SHELL_EXECNAME}\" \"${HADOOP_SUBCMD}\"\n\nline.", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396435", "createdAt": "2020-09-07T12:18:05Z", "author": {"login": "elek"}, "path": "hadoop-hdds/common/src/main/conf/hadoop-env.sh", "diffHunk": "@@ -400,7 +400,16 @@ export HADOOP_OS_TYPE=${HADOOP_OS_TYPE:-$(uname -s)}\n # These options will be appended to the options specified as HADOOP_OPTS\n # and therefore may override any similar flags set in HADOOP_OPTS\n #\n-# export HDFS_OM_OPTS=\"\"\n+# export OZONE_MANAGER_OPTS=\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NTg3OQ==", "bodyText": "Renamed to OZONE_OM_OPTS", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484585879", "createdAt": "2020-09-07T23:32:08Z", "author": {"login": "smengcl"}, "path": "hadoop-hdds/common/src/main/conf/hadoop-env.sh", "diffHunk": "@@ -400,7 +400,16 @@ export HADOOP_OS_TYPE=${HADOOP_OS_TYPE:-$(uname -s)}\n # These options will be appended to the options specified as HADOOP_OPTS\n # and therefore may override any similar flags set in HADOOP_OPTS\n #\n-# export HDFS_OM_OPTS=\"\"\n+# export OZONE_MANAGER_OPTS=\"\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjQzNQ=="}, "originalCommit": {"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyOTQ4NjYxOnYy", "diffSide": "RIGHT", "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxODozOVrOHN9Oqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QyMzozMzozOFrOHOIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjcxNQ==", "bodyText": "I think this line is not necessary, because it will be added by\nhadoop_subcommand_opts \"${HADOOP_SHELL_EXECNAME}\" \"${HADOOP_SUBCMD}\"\n\nBut please check it.", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396715", "createdAt": "2020-09-07T12:18:39Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "diffHunk": "@@ -105,8 +105,9 @@ function ozonecmd_case\n       # Corresponding Ratis issue https://issues.apache.org/jira/browse/RATIS-534.\n       # TODO: Fix the problem related to netty resource leak detector throwing\n       # exception as mentioned in HDDS-3812\n-      HDDS_DN_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${HDDS_DN_OPTS}\"\n-      HADOOP_OPTS=\"${HADOOP_OPTS} ${HDDS_DN_OPTS}\"\n+      hadoop_deprecate_envvar HDDS_DN_OPTS OZONE_DATANODE_OPTS\n+      OZONE_DATANODE_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${OZONE_DATANODE_OPTS}\"\n+      HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_DATANODE_OPTS}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NjAzOQ==", "bodyText": "Yes looks like HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_DATANODE_OPTS}\" is redundant with hadoop_subcommand_opts since we are aligning the OPTS names.\nGood catch!", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484586039", "createdAt": "2020-09-07T23:33:38Z", "author": {"login": "smengcl"}, "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "diffHunk": "@@ -105,8 +105,9 @@ function ozonecmd_case\n       # Corresponding Ratis issue https://issues.apache.org/jira/browse/RATIS-534.\n       # TODO: Fix the problem related to netty resource leak detector throwing\n       # exception as mentioned in HDDS-3812\n-      HDDS_DN_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${HDDS_DN_OPTS}\"\n-      HADOOP_OPTS=\"${HADOOP_OPTS} ${HDDS_DN_OPTS}\"\n+      hadoop_deprecate_envvar HDDS_DN_OPTS OZONE_DATANODE_OPTS\n+      OZONE_DATANODE_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${OZONE_DATANODE_OPTS}\"\n+      HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_DATANODE_OPTS}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjcxNQ=="}, "originalCommit": {"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyOTQ4Nzg4OnYy", "diffSide": "RIGHT", "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxOTowMFrOHN9Pbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMjoxOTowMFrOHN9Pbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjkxMQ==", "bodyText": "Same as before.", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396911", "createdAt": "2020-09-07T12:19:00Z", "author": {"login": "elek"}, "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "diffHunk": "@@ -154,8 +155,9 @@ function ozonecmd_case\n     om)\n       HADOOP_SUBCMD_SUPPORTDAEMONIZATION=\"true\"\n       HADOOP_CLASSNAME=org.apache.hadoop.ozone.om.OzoneManagerStarter\n-      HDFS_OM_OPTS=\"${HDFS_OM_OPTS} -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/om-audit-log4j2.properties\"\n-      HADOOP_OPTS=\"${HADOOP_OPTS} ${HDFS_OM_OPTS}\"\n+      hadoop_deprecate_envvar HDFS_OM_OPTS OZONE_MANAGER_OPTS\n+      OZONE_MANAGER_OPTS=\"${OZONE_MANAGER_OPTS} -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/om-audit-log4j2.properties\"\n+      HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_MANAGER_OPTS}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4865, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}