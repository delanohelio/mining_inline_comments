{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MDAzMDEz", "number": 922, "title": "HDDS-3588. Fix NPE while getPipelines if absent in query2OpenPipelines", "bodyText": "What changes were proposed in this pull request?\nAs title described, there maybe a NPE if get pipeline from query2OpenPipelines return null. It is possible if we can specify a replication number other than 1 and 3.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3588\nHow was this patch tested?\nNow, this issue cannot be trigger until HDDS-3581 merged.", "createdAt": "2020-05-14T13:37:19Z", "url": "https://github.com/apache/ozone/pull/922", "merged": true, "mergeCommit": {"oid": "a75c2f66bd36eca93401fe7d29cc69962f3631e9"}, "closed": true, "closedAt": "2020-05-19T04:07:08Z", "author": {"login": "maobaolong"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchNjkcAH2gAyNDE4MDAzMDEzOmM0Njc4ZGYwZDAxYzY5MWRlMjA5Y2RiNmRjNjZmOWQ4ZDY5MzNlY2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABch4FuNgBqjMzNDM2ODQ4OTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c4678df0d01c691de209cdb6dc66f9d8d6933ece", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/c4678df0d01c691de209cdb6dc66f9d8d6933ece", "committedDate": "2020-05-14T13:33:12Z", "message": "HDDS-3588. Fix NPE while getPipelines if absent in query2OpenPipelines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14e7676d324a0a7a6d7be39d0652b7dd49cf3e73", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/14e7676d324a0a7a6d7be39d0652b7dd49cf3e73", "committedDate": "2020-05-14T13:39:52Z", "message": "retrigger build with empty commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd2ff0803037d911e19c05c8ab723e3c54d20850", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/bd2ff0803037d911e19c05c8ab723e3c54d20850", "committedDate": "2020-05-14T14:06:00Z", "message": "Update PipelineStateMap.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfcbc26bca3929041a26381e3aebcd94ece1e29b", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/cfcbc26bca3929041a26381e3aebcd94ece1e29b", "committedDate": "2020-05-14T16:34:49Z", "message": "Update PipelineStateMap.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMDMyOTY1", "url": "https://github.com/apache/ozone/pull/922#pullrequestreview-412032965", "createdAt": "2020-05-14T17:30:20Z", "commit": {"oid": "cfcbc26bca3929041a26381e3aebcd94ece1e29b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNzozMDoyMVrOGVm8qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNzozMDoyMVrOGVm8qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMTQwMw==", "bodyText": "Can we use getOrDefault here?", "url": "https://github.com/apache/ozone/pull/922#discussion_r425311403", "createdAt": "2020-05-14T17:30:21Z", "author": {"login": "avijayanhwx"}, "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/pipeline/PipelineStateMap.java", "diffHunk": "@@ -210,6 +210,11 @@ Pipeline getPipeline(PipelineID pipelineID) throws PipelineNotFoundException {\n     Preconditions.checkNotNull(state, \"Pipeline state cannot be null\");\n \n     if (state == PipelineState.OPEN) {\n+      List<Pipeline> pipeline =\n+          query2OpenPipelines.get(new PipelineQuery(type, factor));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfcbc26bca3929041a26381e3aebcd94ece1e29b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "036ac26f5fe6fe7cb316ac673bf763e89c774a29", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/036ac26f5fe6fe7cb316ac673bf763e89c774a29", "committedDate": "2020-05-14T18:03:57Z", "message": "Update PipelineStateMap.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc5e5e1e31af67838ac1df35997f425431751674", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/fc5e5e1e31af67838ac1df35997f425431751674", "committedDate": "2020-05-16T15:05:33Z", "message": "trigger new ci check"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab9f2bb6d124ffc15c855f4092286f1ba7a8fdad", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/ab9f2bb6d124ffc15c855f4092286f1ba7a8fdad", "committedDate": "2020-05-14T18:08:16Z", "message": "Update PipelineStateMap.java"}, "afterCommit": {"oid": "fc5e5e1e31af67838ac1df35997f425431751674", "author": {"user": {"login": "maobaolong", "name": "maobaolong"}}, "url": "https://github.com/apache/ozone/commit/fc5e5e1e31af67838ac1df35997f425431751674", "committedDate": "2020-05-16T15:05:33Z", "message": "trigger new ci check"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3253, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}