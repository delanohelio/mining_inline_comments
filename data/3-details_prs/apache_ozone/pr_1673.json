{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0MDY4MzIw", "number": 1673, "title": "HDDS-4559. Avoid using hard coding uft-8 charset", "bodyText": "What changes were proposed in this pull request?\nFrom jdk1.7\uff0cjdk support StandardCharsets.UTF_8, so avoid using hard coding uft-8 charset\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4559\nHow was this patch tested?\nmvn checkstyle:checkstyle", "createdAt": "2020-12-08T02:12:36Z", "url": "https://github.com/apache/ozone/pull/1673", "merged": true, "mergeCommit": {"oid": "7eefe24a136a2b1f8a32b6a063581ad5047f0aa2"}, "closed": true, "closedAt": "2020-12-10T12:07:45Z", "author": {"login": "lamberken"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkA5_ZgH2gAyNTM0MDY4MzIwOjg4NTM4MzRkZTZhOGEwZjhjOTlhYWU4YWM2NDAyYTdjM2FhOTgwZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkyMj-gFqTU0OTEzMTQ3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8853834de6a8a0f8c99aae8ac6402a7c3aa980e7", "author": {"user": {"login": "lamberken", "name": "lamberken"}}, "url": "https://github.com/apache/ozone/commit/8853834de6a8a0f8c99aae8ac6402a7c3aa980e7", "committedDate": "2020-12-08T02:41:51Z", "message": "HDDS-4559. Avoid using hard coding uft-8 charset"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2ODA0NTcx", "url": "https://github.com/apache/ozone/pull/1673#pullrequestreview-546804571", "createdAt": "2020-12-08T07:16:02Z", "commit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2Nzk3OTA3", "url": "https://github.com/apache/ozone/pull/1673#pullrequestreview-546797907", "createdAt": "2020-12-08T07:02:10Z", "commit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzowMjoxMFrOIBKBPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzoyODo1MFrOIBKy_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MzY0NA==", "bodyText": "Both usages of GDPR_CHARSET are in calls to methods where both String and Charset versions exist, so we can make this change:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public static final String GDPR_CHARSET = StandardCharsets.UTF_8.name();\n          \n          \n            \n              public static final Charset GDPR_CHARSET = StandardCharsets.UTF_8;\n          \n      \n    \n    \n  \n\nSince it is only used in GDPRSymmetricKey, I would also consider inlining this constant.  I don't think we need to define it globally.", "url": "https://github.com/apache/ozone/pull/1673#discussion_r538083644", "createdAt": "2020-12-08T07:02:10Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConsts.java", "diffHunk": "@@ -351,7 +352,7 @@ private OzoneConsts() {\n   public static final String GDPR_FLAG = \"gdprEnabled\";\n   public static final String GDPR_ALGORITHM_NAME = \"AES\";\n   public static final int GDPR_DEFAULT_RANDOM_SECRET_LENGTH = 16;\n-  public static final String GDPR_CHARSET = \"UTF-8\";\n+  public static final String GDPR_CHARSET = StandardCharsets.UTF_8.name();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4OTUwNQ==", "bodyText": "This is used in two kinds of calls:\n\nRandomStringUtils.random: its chars parameter is not intended for charsets, rather the set of characters to use.  Eg. for \"UTF-8\" it will generate strings like \"--8F8T8U8T\".  Since we don't need this special kind of random string, this usage can be simply removed.\nIOUtils.toInputStream: can accept Charset, too.\n\nAfter removing the first kind of usage, we can convert this constant to Charset.  (I would also inline it, ie. simply use UTF_8.)", "url": "https://github.com/apache/ozone/pull/1673#discussion_r538089505", "createdAt": "2020-12-08T07:15:07Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/security/x509/certificate/client/TestDefaultCertificateClient.java", "diffHunk": "@@ -75,7 +76,7 @@\n   private Path dnMetaDirPath;\n   private SecurityConfig omSecurityConfig;\n   private SecurityConfig dnSecurityConfig;\n-  private final static String UTF = \"UTF-8\";\n+  private final static String UTF = StandardCharsets.UTF_8.name();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA5MTM3Nw==", "bodyText": "Nit: this constant can be replaced with import static java.nio.charset.StandardCharsets.UTF_8;.", "url": "https://github.com/apache/ozone/pull/1673#discussion_r538091377", "createdAt": "2020-12-08T07:18:43Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/security/AWSV4AuthValidator.java", "diffHunk": "@@ -42,7 +42,7 @@\n   private final static Logger LOG =\n       LoggerFactory.getLogger(AWSV4AuthValidator.class);\n   private static final String HMAC_SHA256_ALGORITHM = \"HmacSHA256\";\n-  private static final Charset UTF_8 = Charset.forName(\"utf-8\");\n+  private static final Charset UTF_8 = StandardCharsets.UTF_8;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA5NTc4NQ==", "bodyText": "Nit: usages of this constant can be replaced with the one from StandardCharsets.", "url": "https://github.com/apache/ozone/pull/1673#discussion_r538095785", "createdAt": "2020-12-08T07:27:45Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/s3gateway/src/main/java/org/apache/hadoop/ozone/s3/SignatureProcessor.java", "diffHunk": "@@ -32,7 +33,7 @@\n   String X_AMAZ_DATE = \"X-Amz-Date\";\n   String CONTENT_MD5 = \"content-md5\";\n   String AUTHORIZATION_HEADER = \"Authorization\";\n-  Charset UTF_8 = Charset.forName(\"utf-8\");\n+  Charset UTF_8 = StandardCharsets.UTF_8;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA5NjM4MA==", "bodyText": "encoding is unused, can be removed.", "url": "https://github.com/apache/ozone/pull/1673#discussion_r538096380", "createdAt": "2020-12-08T07:28:50Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/scm/cli/SQLCLI.java", "diffHunk": "@@ -72,7 +73,7 @@\n \n   private Options options;\n   private BasicParser parser;\n-  private final Charset encoding = Charset.forName(\"UTF-8\");\n+  private final Charset encoding = StandardCharsets.UTF_8;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87bc56de0838ae178bb506dddc163782baa10e2d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa807234bf8ae2623c4525a0e1751c34d48db082", "author": {"user": {"login": "leo65535", "name": "leo65535"}}, "url": "https://github.com/apache/ozone/commit/fa807234bf8ae2623c4525a0e1751c34d48db082", "committedDate": "2020-12-09T01:23:38Z", "message": "improve updates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MTMxNDc1", "url": "https://github.com/apache/ozone/pull/1673#pullrequestreview-549131475", "createdAt": "2020-12-10T12:07:29Z", "commit": {"oid": "fa807234bf8ae2623c4525a0e1751c34d48db082"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2064, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}