{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MDQyMTQ4", "number": 1263, "title": "HDDS-4033. Make the acceptance test reports hierarchical", "bodyText": "What changes were proposed in this pull request?\nAcceptance test reports of today uses a generated name for each of the executed robot tests.\nInstead of using a flat structure with generated name it seems to be better to use a hierarchical structure which represents the directory structure.\nbefore:\n\nafter:\n\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4033\nHow was this patch tested?\nRunning CI on my fork:\nhttps://github.com/elek/hadoop-ozone/runs/911471446?check_suite_focus=true\nSee the attached artifacts", "createdAt": "2020-07-27T09:49:51Z", "url": "https://github.com/apache/ozone/pull/1263", "merged": true, "mergeCommit": {"oid": "5837e868031623c0fff4e6fdab571b001e93ab3a"}, "closed": true, "closedAt": "2020-07-30T04:31:03Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc13jnegH2gAyNDU3MDQyMTQ4OjMyMzc4NTZiZWJlMTEyNTQ1M2JmZTMzODBmZDM1Y2I5ZWM3ZjQzZmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5uIImgFqTQ1NzcxOTAwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3237856bebe1125453bfe3380fd35cb9ec7f43fb", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/3237856bebe1125453bfe3380fd35cb9ec7f43fb", "committedDate": "2020-07-17T17:47:45Z", "message": "advanced reporting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef725dfb1e0a0dbeb0978516917d85bf2287a906", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ef725dfb1e0a0dbeb0978516917d85bf2287a906", "committedDate": "2020-07-17T17:48:25Z", "message": "execute only acceptance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "becba2af8968d877e166a7b95c1417aa1d4dc4fa", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/becba2af8968d877e166a7b95c1417aa1d4dc4fa", "committedDate": "2020-07-17T20:23:50Z", "message": "avoid recursion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a5cd418aa3b7d7aeb84787d0675827a75253fe8", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/0a5cd418aa3b7d7aeb84787d0675827a75253fe8", "committedDate": "2020-07-18T06:11:25Z", "message": "fix naming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "798f9be03a26abec17c409590eab5e77c1645df2", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/798f9be03a26abec17c409590eab5e77c1645df2", "committedDate": "2020-07-20T06:59:02Z", "message": "retrigger ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4721b0f7e0f83aa97c9caa35a55f2e2846977778", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/4721b0f7e0f83aa97c9caa35a55f2e2846977778", "committedDate": "2020-07-20T12:51:24Z", "message": "fix test execution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1252d3d5660c385622eaa5f4e896dd0b4a29f0d4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/1252d3d5660c385622eaa5f4e896dd0b4a29f0d4", "committedDate": "2020-07-21T14:36:45Z", "message": "report output"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28445cb21f58c0c8615b8c19fadcc0cd22eceb07", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/28445cb21f58c0c8615b8c19fadcc0cd22eceb07", "committedDate": "2020-07-22T10:20:53Z", "message": "do not fail if logs output files are missing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae5878968e83ffdb8a0fa32f2dc377fd31df336d", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ae5878968e83ffdb8a0fa32f2dc377fd31df336d", "committedDate": "2020-07-26T10:19:54Z", "message": "fix names in loops"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7ee7c396319b9db2cd1dbc0a92c803473104f5b", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/e7ee7c396319b9db2cd1dbc0a92c803473104f5b", "committedDate": "2020-07-26T10:23:55Z", "message": "Merge remote-tracking branch 'origin/master' into acceptance-reporting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cdaf4e871ef7c7d0522b49d52ef561c7d274d89", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/4cdaf4e871ef7c7d0522b49d52ef561c7d274d89", "committedDate": "2020-07-26T10:31:01Z", "message": "follow latest changes from master (dirname /home/elek/projects/ozone-review)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "committedDate": "2020-07-27T09:44:51Z", "message": "re-enable all the tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTUyMjcw", "url": "https://github.com/apache/ozone/pull/1263#pullrequestreview-455952270", "createdAt": "2020-07-27T16:40:02Z", "commit": {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0MDowM1rOG3qktA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NTowNlrOG3qxPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyMjM4OA==", "bodyText": "I think -mindepth 2 -maxdepth 2 should be added to test-all.sh, too, because currently ozone-mr/hadoop* tests are executed twice:\n2020-07-27T10:02:03.8462205Z Executing test in /mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/ozone-mr/hadoop27\n...\n2020-07-27T10:11:13.8415416Z Executing test in /mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/ozone-mr/hadoop27", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461022388", "createdAt": "2020-07-27T16:40:03Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-mr/test.sh", "diffHunk": "@@ -0,0 +1,32 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+SCRIPT_DIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" >/dev/null && pwd )\n+ALL_RESULT_DIR=\"$SCRIPT_DIR/result\"\n+set -x\n+RESULT=0\n+IFS=$'\\n'\n+# shellcheck disable=SC2044\n+for test in $(find \"$SCRIPT_DIR\" -mindepth 2 -maxdepth 2 -name test.sh | grep \"${OZONE_TEST_SELECTOR:-\"\"}\" |sort); do", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNDk2Mg==", "bodyText": "Nice.  Can you also add explicit name for the different readdata tests in ozone-topology?\nhttps://github.com/apache/hadoop-ozone/blob/ddd3211757ad67d1574e0e9e983b182681050a7c/hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh#L42\nhttps://github.com/apache/hadoop-ozone/blob/ddd3211757ad67d1574e0e9e983b182681050a7c/hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh#L52", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461024962", "createdAt": "2020-07-27T16:44:03Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone/test.sh", "diffHunk": "@@ -35,14 +35,14 @@ execute_robot_test scm gdpr\n \n for scheme in ofs o3fs; do\n   for bucket in link bucket; do\n-    execute_robot_test scm -v SCHEME:${scheme} -v BUCKET_TYPE:${bucket} ozonefs/ozonefs.robot\n+    execute_robot_test scm -v SCHEME:${scheme} -v BUCKET_TYPE:${bucket} -N ozonefs-${scheme}-${bucket} ozonefs/ozonefs.robot", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTU5OA==", "bodyText": "Nit: store result of $(basename $(dirname \"$test\")) in variable.", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461025598", "createdAt": "2020-07-27T16:45:06Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/test-all.sh", "diffHunk": "@@ -46,9 +46,12 @@ for test in $(find \"$SCRIPT_DIR\" -name test.sh | grep \"${OZONE_TEST_SELECTOR:-\"\"\n       echo \"ERROR: Test execution of $(dirname \"$test\") is FAILED!!!!\"\n   fi\n   RESULT_DIR=\"$(dirname \"$test\")/result\"\n-  cp \"$RESULT_DIR\"/robot-*.xml \"$RESULT_DIR\"/docker-*.log \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/\n+  rebot -N $(basename $(dirname \"$test\")) -o \"$ALL_RESULT_DIR\"/$(basename $(dirname \"$test\")).xml \"$RESULT_DIR\"/*.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "378b92a7cb2db713c4c11ec58dff68522ddaa9f4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/378b92a7cb2db713c4c11ec58dff68522ddaa9f4", "committedDate": "2020-07-29T08:10:47Z", "message": "Merge remote-tracking branch 'origi/master' into HDDS-4033"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "committedDate": "2020-07-29T09:17:47Z", "message": "address code review comments (+reorganize find_tests)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NTI0MzMx", "url": "https://github.com/apache/ozone/pull/1263#pullrequestreview-457524331", "createdAt": "2020-07-29T13:32:58Z", "commit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMzozMjo1OFrOG44m_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDoxMDoyM1rOG46TDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwMDkyNQ==", "bodyText": "I think this line should be removed:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            rebot -N \"smoketests\" -d \"$SCRIPT_DIR/result\" \"$SCRIPT_DIR/result/robot-*.xml\"\n          \n      \n    \n    \n  \n\nto avoid the following error:\n2020-07-29T10:07:38.2962715Z [ ERROR ] Reading XML source '/mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/result/robot-*.xml' failed: No such file or directory", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462300925", "createdAt": "2020-07-29T13:32:58Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/test-all.sh", "diffHunk": "@@ -64,10 +49,16 @@ for t in ${tests}; do\n       RESULT=1\n       echo \"ERROR: Test execution of ${d} is FAILED!!!!\"\n   fi\n+  cd \"$SCRIPT_DIR\"\n   RESULT_DIR=\"${d}/result\"\n-  cp \"$RESULT_DIR\"/robot-*.xml \"$RESULT_DIR\"/docker-*.log \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/\n+  TEST_DIR_NAME=$(basename ${d})\n+  rebot -N $TEST_DIR_NAME -o \"$ALL_RESULT_DIR\"/$TEST_DIR_NAME.xml \"$RESULT_DIR\"/\"*.xml\"\n+  cp \"$RESULT_DIR\"/docker-*.log \"$ALL_RESULT_DIR\"/\n+  cp \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/ || true\n done\n \n+rebot -N acceptance -d \"$ALL_RESULT_DIR\" \"$ALL_RESULT_DIR\"/*.xml\n+\n rebot -N \"smoketests\" -d \"$SCRIPT_DIR/result\" \"$SCRIPT_DIR/result/robot-*.xml\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwNzg1NQ==", "bodyText": "Arguments need to be swapped:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            execute_robot_test scm topology/readdata.robot -N readdata-first-half\n          \n          \n            \n            execute_robot_test scm -N readdata-first-half topology/readdata.robot\n          \n      \n    \n    \n  \n\nto avoid:\n2020-07-29T09:51:30.5630160Z [ ERROR ] Parsing 'topology/readdata.robot' failed: File or directory to execute does not exist.", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462307855", "createdAt": "2020-07-29T13:42:37Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh", "diffHunk": "@@ -39,7 +39,7 @@ execute_robot_test scm topology/loaddata.robot\n \n stop_containers datanode_1 datanode_2 datanode_3\n \n-execute_robot_test scm topology/readdata.robot\n+execute_robot_test scm topology/readdata.robot -N readdata-first-half", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwNzk5MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            execute_robot_test scm topology/readdata.robot -N readdata-second-half\n          \n          \n            \n            execute_robot_test scm -N readdata-second-half topology/readdata.robot", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462307991", "createdAt": "2020-07-29T13:42:47Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh", "diffHunk": "@@ -49,7 +49,7 @@ wait_for_port datanode_3 9858 60\n \n stop_containers datanode_4 datanode_5 datanode_6\n \n-execute_robot_test scm topology/readdata.robot\n+execute_robot_test scm topology/readdata.robot -N readdata-second-half", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyMzU1Ng==", "bodyText": "This needs to be updated to avoid failure in bats check:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462323556", "createdAt": "2020-07-29T14:03:45Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyMzk2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462323969", "createdAt": "2020-07-29T14:04:19Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNDEyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              echo \"x${output}x}\"", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462324127", "createdAt": "2020-07-29T14:04:32Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNDMyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462324327", "createdAt": "2020-07-29T14:04:48Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzY1MA==", "bodyText": "Can you please explain what's the purpose of repeatedly loading the library being tested?  In my experience it works fine with a single load, but maybe you want to cover some case I'm not aware of.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh\n          \n      \n    \n    \n  \n\nor\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462327650", "createdAt": "2020-07-29T14:09:17Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzc3Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462327773", "createdAt": "2020-07-29T14:09:26Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests\n+  [[ \"$output\" == \"./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test default suite\" {\n+  OZONE_ACCEPTANCE_SUITE=misc\n+  run find_tests", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyODU4OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh\n          \n      \n    \n    \n  \n\nor\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462328588", "createdAt": "2020-07-29T14:10:23Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests\n+  [[ \"$output\" == \"./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7398d4879bd6c7260abf3c0e6aa247185c8a1c3", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/f7398d4879bd6c7260abf3c0e6aa247185c8a1c3", "committedDate": "2020-07-29T14:14:41Z", "message": "rat fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62c9780724f6bb61826009d370880d3134e7cc1d", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/62c9780724f6bb61826009d370880d3134e7cc1d", "committedDate": "2020-07-29T14:30:14Z", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c549d468cbfb0ea7e88decbdd1e3098850243adf", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/c549d468cbfb0ea7e88decbdd1e3098850243adf", "committedDate": "2020-07-29T14:30:26Z", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d003b88f689d23a1bf8e09e9abc4faec535c9fb", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/1d003b88f689d23a1bf8e09e9abc4faec535c9fb", "committedDate": "2020-07-29T14:30:37Z", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88f37655493315ae7cd506a74484884d81783811", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/88f37655493315ae7cd506a74484884d81783811", "committedDate": "2020-07-29T14:30:47Z", "message": "Update hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b133a6190df555134a4596d3e4d4f0307e1498c", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/2b133a6190df555134a4596d3e4d4f0307e1498c", "committedDate": "2020-07-29T14:31:15Z", "message": "Update hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "674205c2e33f52e1cf5f5e695dc18bf404a92664", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/674205c2e33f52e1cf5f5e695dc18bf404a92664", "committedDate": "2020-07-29T14:32:47Z", "message": "Merge remote-tracking branch 'elek/HDDS-4033' into HDDS-4033"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c53c971f7903258ecfd7cd2570055df87cb2898", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/5c53c971f7903258ecfd7cd2570055df87cb2898", "committedDate": "2020-07-29T14:35:45Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05e5f5000d9b15e3b07c09379d50bf03416800fd", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/05e5f5000d9b15e3b07c09379d50bf03416800fd", "committedDate": "2020-07-29T14:35:54Z", "message": "Merge remote-tracking branch 'elek/HDDS-4033' into HDDS-4033"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "712a06c67addc7e152c0c69a9a68fba4163236fb", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/712a06c67addc7e152c0c69a9a68fba4163236fb", "committedDate": "2020-07-29T14:36:56Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-4033"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a208ad0858ef1b5c8330247a4ffcbc34962aacb", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/6a208ad0858ef1b5c8330247a4ffcbc34962aacb", "committedDate": "2020-07-29T14:37:23Z", "message": "remove duplicated loads"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NzE5MDAz", "url": "https://github.com/apache/ozone/pull/1263#pullrequestreview-457719003", "createdAt": "2020-07-29T17:04:17Z", "commit": {"oid": "6a208ad0858ef1b5c8330247a4ffcbc34962aacb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2938, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}