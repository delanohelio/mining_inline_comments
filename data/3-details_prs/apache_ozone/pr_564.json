{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2OTEzMDgy", "number": 564, "title": "HDDS-3031. OM HA- Client requests get LeaderNotReadyException after OM's restart.", "bodyText": "What changes were proposed in this pull request?\nFix LeaderNotReady exception which is thrown for write requests after OM restarts.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3031\nHow was this patch tested?\nDeployed on the cluster and tried the scenario. With the PR fix, now able to execute client requests after OM restart.\nI will see if I can add UT for this.", "createdAt": "2020-02-19T01:07:51Z", "url": "https://github.com/apache/ozone/pull/564", "merged": true, "mergeCommit": {"oid": "72b17bf14872ae06c94ea4df48417b24cb727ed5"}, "closed": true, "closedAt": "2020-02-20T20:04:20Z", "author": {"login": "bharatviswa504"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF63cAgFqTM2MTMyNjk3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcF97PQgBqjMwNTM1OTA2ODU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMzI2OTc2", "url": "https://github.com/apache/ozone/pull/564#pullrequestreview-361326976", "createdAt": "2020-02-19T18:21:41Z", "commit": {"oid": "421b375e1510205f6a688fe9291e138bfe845788"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODoyMTo0MVrOFryXaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODoyNjowNlrOFryhBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ1ODI4MA==", "bodyText": "Keeping this log message at info level will flood the log file. It prints the Request body also.", "url": "https://github.com/apache/ozone/pull/564#discussion_r381458280", "createdAt": "2020-02-19T18:21:41Z", "author": {"login": "hanishakoneru"}, "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeCreateRequest.java", "diffHunk": "@@ -164,7 +164,7 @@ public OMClientResponse validateAndUpdateCache(OzoneManager ozoneManager,\n           // Replay implies the response has already been returned to\n           // the client. So take no further action and return a dummy\n           // OMClientResponse.\n-          LOG.debug(\"Replayed Transaction {} ignored. Request: {}\",\n+          LOG.info(\"Replayed Transaction {} ignored. Request: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "421b375e1510205f6a688fe9291e138bfe845788"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ2MDc0Mw==", "bodyText": "Missed adding addResponseToDoubleBuffer() here.", "url": "https://github.com/apache/ozone/pull/564#discussion_r381460743", "createdAt": "2020-02-19T18:26:06Z", "author": {"login": "hanishakoneru"}, "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/s3/multipart/S3InitiateMultipartUploadRequest.java", "diffHunk": "@@ -203,11 +203,7 @@ public OMClientResponse validateAndUpdateCache(OzoneManager ozoneManager,\n       omClientResponse = new S3InitiateMultipartUploadResponse(\n           createErrorOMResponse(omResponse, exception));\n     } finally {\n-      if (omClientResponse != null) {\n-        omClientResponse.setFlushFuture(\n-            ozoneManagerDoubleBufferHelper.add(omClientResponse,\n-                transactionLogIndex));\n-      }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "421b375e1510205f6a688fe9291e138bfe845788"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ead61cd8796993fbb58ac3875e3a2e660dcbec4", "author": {"user": {"login": "bharatviswa504", "name": "Bharat Viswanadham"}}, "url": "https://github.com/apache/ozone/commit/3ead61cd8796993fbb58ac3875e3a2e660dcbec4", "committedDate": "2020-02-19T20:34:26Z", "message": "HDDS-3031. OM HA- Client requests get LeaderNotReadyException after OM restart."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6545d1eee14a6987adb25506821c67f95afb9e19", "author": {"user": {"login": "bharatviswa504", "name": "Bharat Viswanadham"}}, "url": "https://github.com/apache/ozone/commit/6545d1eee14a6987adb25506821c67f95afb9e19", "committedDate": "2020-02-19T20:34:26Z", "message": "check style."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b09ecced6cf92194adc11e9f5a52d91b75502964", "author": {"user": {"login": "bharatviswa504", "name": "Bharat Viswanadham"}}, "url": "https://github.com/apache/ozone/commit/b09ecced6cf92194adc11e9f5a52d91b75502964", "committedDate": "2020-02-19T20:34:27Z", "message": "review comments."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f094420d9560d1496eb63a6085a91b81eb6b74b", "author": {"user": {"login": "bharatviswa504", "name": "Bharat Viswanadham"}}, "url": "https://github.com/apache/ozone/commit/1f094420d9560d1496eb63a6085a91b81eb6b74b", "committedDate": "2020-02-19T20:22:39Z", "message": "review comments."}, "afterCommit": {"oid": "b09ecced6cf92194adc11e9f5a52d91b75502964", "author": {"user": {"login": "bharatviswa504", "name": "Bharat Viswanadham"}}, "url": "https://github.com/apache/ozone/commit/b09ecced6cf92194adc11e9f5a52d91b75502964", "committedDate": "2020-02-19T20:34:27Z", "message": "review comments."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3587, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}