{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzODk0NjA1", "number": 724, "title": "HDDS-3282. ozone.http.filter.initializers can't be set properly for S\u2026", "bodyText": "What changes were proposed in this pull request?\nChange to use the Initializer class from hadoop-common while keeping the ozone initializer configuration key as-is.\nMore specifically, to enable SPNEGO auth for ozone web console, you need to properly set the auth filter initializer like below.\nozone.http.filter.initializers = org.apache.hadoop.security.AuthenticationFilterInitializer\nStandardize the SPNEGO related configurations to follow the SPNEGO filter prefix rules as follows:\nozone.[component].http.auth.type = [simple, kerberos]\nozone.[component].http.auth.kerberos.principal\nozone.[component].http.auth.kerberos.keytab\ncomponent should be [om,scm,datanode,s3g,recon]\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3282\nHow the fix is tested:\nTest with ozonesecure docker-compose locally and verified that the change ensure unauthenticated user will get 401 error like below.\nURI: | /\n-- | --\n401\nAuthentication required\norg.eclipse.jetty.servlet.DefaultServlet-1e1b061", "createdAt": "2020-03-26T00:34:37Z", "url": "https://github.com/apache/ozone/pull/724", "merged": true, "mergeCommit": {"oid": "4a9fde5816ce092c7f60e59f1229c1be1869ca31"}, "closed": true, "closedAt": "2020-05-06T22:46:06Z", "author": {"login": "xiaoyuyao"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUBPFegFqTM4NzI3NDE5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcc6t0TAH2gAyMzkzODk0NjA1OjM2MmM2MzU2OTRjYTYxNTVkZjcyMGIzNGQzY2M0MDgzM2NjMWExODU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Mjc0MTk3", "url": "https://github.com/apache/ozone/pull/724#pullrequestreview-387274197", "createdAt": "2020-04-03T13:50:57Z", "commit": {"oid": "ddda189f61fb22cfec0dd21235926b7b63b3ff37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNjA4Nzkz", "url": "https://github.com/apache/ozone/pull/724#pullrequestreview-393608793", "createdAt": "2020-04-15T09:31:43Z", "commit": {"oid": "ddda189f61fb22cfec0dd21235926b7b63b3ff37"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ddda189f61fb22cfec0dd21235926b7b63b3ff37", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/ddda189f61fb22cfec0dd21235926b7b63b3ff37", "committedDate": "2020-03-26T00:31:01Z", "message": "HDDS-3282. ozone.http.filter.initializers can't be set properly for SPNEGO auth."}, "afterCommit": {"oid": "0a91f8fdeb9c8de83e07da24074ed4af3c73e70d", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/0a91f8fdeb9c8de83e07da24074ed4af3c73e70d", "committedDate": "2020-04-17T03:54:52Z", "message": "HDDS-3282. ozone.http.filter.initializers can't be set properly for SPNEGO auth."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2385d9b4534bc28b5ea22f46f637c3636b8d79b5", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/2385d9b4534bc28b5ea22f46f637c3636b8d79b5", "committedDate": "2020-04-21T21:16:43Z", "message": "HDDS-3282. ozone.http.filter.initializers can't be set properly for SPNEGO auth."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b3fd6c0bc5d111a62c78572d260898db15e6ce4", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/1b3fd6c0bc5d111a62c78572d260898db15e6ce4", "committedDate": "2020-04-21T23:28:31Z", "message": "Fix the acceptance test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32821ecb1d78723c9adc5a5e2fe4315240069fcc", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/32821ecb1d78723c9adc5a5e2fe4315240069fcc", "committedDate": "2020-04-17T19:35:19Z", "message": "avoid having individual http.auth.type config"}, "afterCommit": {"oid": "1b3fd6c0bc5d111a62c78572d260898db15e6ce4", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/1b3fd6c0bc5d111a62c78572d260898db15e6ce4", "committedDate": "2020-04-21T23:28:31Z", "message": "Fix the acceptance test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c236cd1d3f6d875f04959ca7c19aab4b9079bfd5", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/c236cd1d3f6d875f04959ca7c19aab4b9079bfd5", "committedDate": "2020-04-22T02:12:19Z", "message": "fix docker-compose issue with recon http keytab key name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MDUwNDc5", "url": "https://github.com/apache/ozone/pull/724#pullrequestreview-398050479", "createdAt": "2020-04-22T10:22:23Z", "commit": {"oid": "c236cd1d3f6d875f04959ca7c19aab4b9079bfd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDoyMjoyM1rOGJu9yA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDoyMjoyM1rOGJu9yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg1OTg0OA==", "bodyText": "Are these classes copied from Hadoop being removed and dependency on Hadoop being re-introduced intentionally? CC @elek", "url": "https://github.com/apache/ozone/pull/724#discussion_r412859848", "createdAt": "2020-04-22T10:22:23Z", "author": {"login": "adoroszlai"}, "path": "hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/HttpServer2.java", "diffHunk": "@@ -57,6 +57,9 @@\n import org.apache.hadoop.hdds.conf.ConfigurationSource;\n import org.apache.hadoop.hdds.conf.OzoneConfiguration;\n import org.apache.hadoop.hdds.utils.LegacyHadoopConfigurationSource;\n+import org.apache.hadoop.http.FilterContainer;\n+import org.apache.hadoop.http.FilterInitializer;\n+import org.apache.hadoop.http.lib.StaticUserWebFilter;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c236cd1d3f6d875f04959ca7c19aab4b9079bfd5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd10e344bfbbab5e7046fecf7ba64fd143046afd", "author": {"user": {"login": "xiaoyuyao", "name": "Xiaoyu Yao"}}, "url": "https://github.com/apache/ozone/commit/cd10e344bfbbab5e7046fecf7ba64fd143046afd", "committedDate": "2020-04-30T19:10:09Z", "message": "Merge branch 'master' into HDDS-3282"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "362c635694ca6155df720b34d3cc40833cc1a185", "author": {"user": {"login": "adoroszlai", "name": "Doroszlai, Attila"}}, "url": "https://github.com/apache/ozone/commit/362c635694ca6155df720b34d3cc40833cc1a185", "committedDate": "2020-05-01T05:20:30Z", "message": "trigger new CI check"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3544, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}