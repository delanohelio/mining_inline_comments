{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTQxNzQ5", "number": 1122, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNjozNDozNlrOEI1mpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNjozNDozNlrOEI1mpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NzAyMzExOnYy", "diffSide": "RIGHT", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/common/transport/server/ratis/XceiverServerRatis.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNjozNDozNlrOGpCvkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMjoyNToyMFrOGpRuaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY4OTc0Ng==", "bodyText": "Can we update the msg accordingly with the reason. The reason precisely was when installSnapshotFromLeader gets invoked on follower, as leader snapshot doesn't contain any data to replay. All the log entries prior to the snapshot might have been purged. So , follower should not try to install snapshot from leader but can close the pipeline here.", "url": "https://github.com/apache/ozone/pull/1122#discussion_r445689746", "createdAt": "2020-06-25T16:34:36Z", "author": {"login": "bshashikant"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/common/transport/server/ratis/XceiverServerRatis.java", "diffHunk": "@@ -552,6 +552,10 @@ private void handlePipelineFailure(RaftGroupId groupId,\n       msg = datanode + \" is in candidate state for \" +\n           roleInfoProto.getCandidateInfo().getLastLeaderElapsedTimeMs() + \"ms\";\n       break;\n+    case FOLLOWER:\n+      msg = datanode + \" is in follower state for \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8228bc6479a3ceb1abac4cac2c4ec6509a0df599"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkzNTIxMQ==", "bodyText": "@bshashikant Thanks for you review and explanation. I have updated the patch.", "url": "https://github.com/apache/ozone/pull/1122#discussion_r445935211", "createdAt": "2020-06-26T02:25:20Z", "author": {"login": "runzhiwang"}, "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/common/transport/server/ratis/XceiverServerRatis.java", "diffHunk": "@@ -552,6 +552,10 @@ private void handlePipelineFailure(RaftGroupId groupId,\n       msg = datanode + \" is in candidate state for \" +\n           roleInfoProto.getCandidateInfo().getLastLeaderElapsedTimeMs() + \"ms\";\n       break;\n+    case FOLLOWER:\n+      msg = datanode + \" is in follower state for \" +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY4OTc0Ng=="}, "originalCommit": {"oid": "8228bc6479a3ceb1abac4cac2c4ec6509a0df599"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4110, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}