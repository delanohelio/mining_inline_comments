{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzMzAyNTQ1", "number": 1223, "title": "HDDS-3990. Test Kubernetes examples with acceptance tests", "bodyText": "What changes were proposed in this pull request?\nhadoop-ozone/dist/src/main/k8s/example directory contains example Kubernetes resources to start Ozone in kubernetes environment. To make sure those resources are working and up-to-date I propose to test them during standard build.\nK3s project provides a lightweight Kubernetes distribution which can be installed easily in Github Actions environment and Kubernetes based clusters can be tested.\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-3990\nHow was this patch tested?\nNew type of acceptance tests are executed 5 times on my fork and passed.", "createdAt": "2020-07-20T10:29:48Z", "url": "https://github.com/apache/ozone/pull/1223", "merged": true, "mergeCommit": {"oid": "30ec0e2d0e04e23b3ac59d14be25c87411100802"}, "closed": true, "closedAt": "2020-07-30T12:23:04Z", "author": {"login": "elek"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc2vEnFAH2gAyNDUzMzAyNTQ1OjljNTk2YmNjZWY2NjdmYjI1NGRkMzlmYmY1ZjNlOWUyZDE3M2ZkNzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc588QSgH2gAyNDUzMzAyNTQ1OjA0ZmQzNDQ1N2RjNDAyNDFiYWU2ZGNmNmMzYWY0ZjI4MGRmNWEyOTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9c596bccef667fb254dd39fbf5f3e9e2d173fd78", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/9c596bccef667fb254dd39fbf5f3e9e2d173fd78", "committedDate": "2020-07-20T10:28:34Z", "message": "HDDS-3990. Test Kubernetes examples with acceptance tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/9144ea93bc6adbb67610b9031d6b16f09b1cf5ab", "committedDate": "2020-07-21T08:13:52Z", "message": "retrigger build with empty commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDgzMzQ1", "url": "https://github.com/apache/ozone/pull/1223#pullrequestreview-455483345", "createdAt": "2020-07-27T05:40:13Z", "commit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNTo0MDoxM1rOG3USWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNjoxNzo1NFrOG3U-Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY1NzI0MA==", "bodyText": "Argument is not needed since combine_reports uses pwd instead of parameter -- applies to all test.sh scripts.", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460657240", "createdAt": "2020-07-27T05:40:13Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/k8s/examples/getting-started/test.sh", "diffHunk": "@@ -0,0 +1,38 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+export K8S_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" >/dev/null 2>&1 && pwd )\"\n+\n+cd \"$K8S_DIR\"\n+\n+# shellcheck source=/dev/null\n+source \"../testlib.sh\"\n+\n+rm -rf result\n+\n+regenerate_resources\n+\n+start_k8s_env\n+\n+execute_robot_test scm-0 smoketest/basic/basic.robot\n+\n+combine_reports 'getting-started'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2MjA2Mg==", "bodyText": "If I understand correctly, this flekszible generate call is only needed when executed from source dir (hadoop-ozone/dist/src/main/k8s) to restore source files.  I propose it to be executed as part of stop_k8s_env:\n\nI ran tests from target/..., had some errors and tried to find out what's wrong.  It was confusing to see resource files referencing non-existent docker image apache/ozone:0.6.0-SNAPSHOT (plus other differences compared to the files actually used for the test).\nAvoid possible omission in new scripts.\nReduce code duplication.\nSave some very minimal runtime cost.", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460662062", "createdAt": "2020-07-27T05:57:17Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/k8s/examples/getting-started/test.sh", "diffHunk": "@@ -0,0 +1,38 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+export K8S_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" >/dev/null 2>&1 && pwd )\"\n+\n+cd \"$K8S_DIR\"\n+\n+# shellcheck source=/dev/null\n+source \"../testlib.sh\"\n+\n+rm -rf result\n+\n+regenerate_resources\n+\n+start_k8s_env\n+\n+execute_robot_test scm-0 smoketest/basic/basic.robot\n+\n+combine_reports 'getting-started'\n+\n+stop_k8s_env\n+\n+flekszible generate", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2NTYwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # bats gc_opts.bats (FROM THE CURRENT DIRECTORY)\n          \n          \n            \n            # bats testlib.bats (FROM THE CURRENT DIRECTORY)", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460665608", "createdAt": "2020-07-27T06:09:11Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/k8s/examples/testlib.bats", "diffHunk": "@@ -0,0 +1,61 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+\n+#\n+# Can be executed with bats (https://github.com/bats-core/bats-core)\n+# bats gc_opts.bats (FROM THE CURRENT DIRECTORY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2NzQyMw==", "bodyText": "Is there any way to avoid hard-coding the image name?", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460667423", "createdAt": "2020-07-27T06:14:44Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/k8s/examples/testlib.sh", "diffHunk": "@@ -0,0 +1,125 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+retry() {\n+   n=0\n+   until [ $n -ge 30 ]\n+   do\n+      \"$@\" && break\n+      n=$[$n+1]\n+      echo \"$n '$@' is failed...\"\n+      sleep ${RETRY_SLEEP:-3}\n+   done\n+   if [ $n -eq 30 ]; then\n+      return 255\n+   fi\n+}\n+\n+grep_log() {\n+   CONTAINER=\"$1\"\n+   PATTERN=\"$2\"\n+   kubectl logs \"$1\"  | grep \"$PATTERN\"\n+}\n+\n+wait_for_startup(){\n+   print_phase \"Waiting until the k8s cluster is running\"\n+   retry all_pods_are_running\n+   retry grep_log scm-0 \"SCM exiting safe mode.\"\n+   retry grep_log om-0 \"HTTP server of ozoneManager listening\"\n+   print_phase \"Cluster is up and running\"\n+}\n+\n+all_pods_are_running() {\n+   RUNNING_COUNT=$(kubectl get pod --field-selector status.phase=Running | wc -l)\n+   ALL_COUNT=$(kubectl get pod | wc -l)\n+   RUNNING_COUNT=$((RUNNING_COUNT - 1))\n+   ALL_COUNT=$((ALL_COUNT - 1))\n+   if [ \"$RUNNING_COUNT\" -lt \"3\" ]; then\n+      echo \"$RUNNING_COUNT pods are running. Waiting for more.\"\n+      return 1\n+   elif [ \"$RUNNING_COUNT\" -ne \"$ALL_COUNT\" ]; then\n+      echo \"$RUNNING_COUNT pods are running out from the $ALL_COUNT\"\n+      return 2\n+   else\n+      STARTED=true\n+      return 0\n+   fi\n+}\n+\n+start_k8s_env() {\n+   print_phase \"Deleting existing k8s resources\"\n+   #reset environment\n+   kubectl delete pvc --all\n+   kubectl delete pv --all\n+   kubectl delete statefulset --all\n+   kubectl delete daemonset --all\n+   kubectl delete deployment --all\n+   kubectl delete service --all\n+   kubectl delete configmap --all\n+   kubectl delete pod --all\n+\n+   print_phase \"Applying k8s resources from $1\"\n+   kubectl apply -f .\n+   wait_for_startup\n+}\n+\n+stop_k8s_env() {\n+   if [ ! \"$KEEP_RUNNING\" ]; then\n+     kubectl delete -f .\n+   fi\n+}\n+\n+regenerate_resources() {\n+  PARENT_OF_PARENT=$(realpath ../..)\n+\n+  if [ $(basename $PARENT_OF_PARENT) == \"k8s\" ]; then\n+    #running from src dir\n+    OZONE_ROOT=$(realpath ../../../../../target/ozone-0.6.0-SNAPSHOT)\n+  else\n+    #running from dist\n+    OZONE_ROOT=$(realpath ../../..)\n+  fi\n+\n+  flekszible generate -t mount:hostPath=\"$OZONE_ROOT\",path=/opt/hadoop -t image:image=apache/ozone-runner:20200420-1 -t ozone/onenode", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2ODEzMA==", "bodyText": "$RANDOM: TIL, thanks. \ud83d\udc4d", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460668130", "createdAt": "2020-07-27T06:16:52Z", "author": {"login": "adoroszlai"}, "path": "hadoop-ozone/dist/src/main/k8s/examples/testlib.sh", "diffHunk": "@@ -0,0 +1,125 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+retry() {\n+   n=0\n+   until [ $n -ge 30 ]\n+   do\n+      \"$@\" && break\n+      n=$[$n+1]\n+      echo \"$n '$@' is failed...\"\n+      sleep ${RETRY_SLEEP:-3}\n+   done\n+   if [ $n -eq 30 ]; then\n+      return 255\n+   fi\n+}\n+\n+grep_log() {\n+   CONTAINER=\"$1\"\n+   PATTERN=\"$2\"\n+   kubectl logs \"$1\"  | grep \"$PATTERN\"\n+}\n+\n+wait_for_startup(){\n+   print_phase \"Waiting until the k8s cluster is running\"\n+   retry all_pods_are_running\n+   retry grep_log scm-0 \"SCM exiting safe mode.\"\n+   retry grep_log om-0 \"HTTP server of ozoneManager listening\"\n+   print_phase \"Cluster is up and running\"\n+}\n+\n+all_pods_are_running() {\n+   RUNNING_COUNT=$(kubectl get pod --field-selector status.phase=Running | wc -l)\n+   ALL_COUNT=$(kubectl get pod | wc -l)\n+   RUNNING_COUNT=$((RUNNING_COUNT - 1))\n+   ALL_COUNT=$((ALL_COUNT - 1))\n+   if [ \"$RUNNING_COUNT\" -lt \"3\" ]; then\n+      echo \"$RUNNING_COUNT pods are running. Waiting for more.\"\n+      return 1\n+   elif [ \"$RUNNING_COUNT\" -ne \"$ALL_COUNT\" ]; then\n+      echo \"$RUNNING_COUNT pods are running out from the $ALL_COUNT\"\n+      return 2\n+   else\n+      STARTED=true\n+      return 0\n+   fi\n+}\n+\n+start_k8s_env() {\n+   print_phase \"Deleting existing k8s resources\"\n+   #reset environment\n+   kubectl delete pvc --all\n+   kubectl delete pv --all\n+   kubectl delete statefulset --all\n+   kubectl delete daemonset --all\n+   kubectl delete deployment --all\n+   kubectl delete service --all\n+   kubectl delete configmap --all\n+   kubectl delete pod --all\n+\n+   print_phase \"Applying k8s resources from $1\"\n+   kubectl apply -f .\n+   wait_for_startup\n+}\n+\n+stop_k8s_env() {\n+   if [ ! \"$KEEP_RUNNING\" ]; then\n+     kubectl delete -f .\n+   fi\n+}\n+\n+regenerate_resources() {\n+  PARENT_OF_PARENT=$(realpath ../..)\n+\n+  if [ $(basename $PARENT_OF_PARENT) == \"k8s\" ]; then\n+    #running from src dir\n+    OZONE_ROOT=$(realpath ../../../../../target/ozone-0.6.0-SNAPSHOT)\n+  else\n+    #running from dist\n+    OZONE_ROOT=$(realpath ../../..)\n+  fi\n+\n+  flekszible generate -t mount:hostPath=\"$OZONE_ROOT\",path=/opt/hadoop -t image:image=apache/ozone-runner:20200420-1 -t ozone/onenode\n+}\n+\n+execute_robot_test() {\n+   print_phase \"Executing robot tests $@\"\n+   mkdir -p result\n+\n+   CONTAINER=\"$1\"\n+   shift 1 #Remove first argument which was the container name\n+\n+   # shellcheck disable=SC2206\n+   ARGUMENTS=($@)\n+\n+   kubectl exec -it \"${CONTAINER}\" -- bash -c 'rm -rf /tmp/report'\n+   kubectl exec -it \"${CONTAINER}\" -- bash -c 'mkdir -p  /tmp/report'\n+   kubectl exec -it \"${CONTAINER}\" -- robot --nostatusrc -d /tmp/report ${ARGUMENTS[@]} || true\n+   kubectl cp \"${CONTAINER}\":/tmp/report/output.xml \"result/$CONTAINER-$RANDOM.xml\" || true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2ODQ5NQ==", "bodyText": "Nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - name: insstall robotframework\n          \n          \n            \n                  - name: install robotframework", "url": "https://github.com/apache/ozone/pull/1223#discussion_r460668495", "createdAt": "2020-07-27T06:17:54Z", "author": {"login": "adoroszlai"}, "path": ".github/workflows/post-commit.yml", "diffHunk": "@@ -224,3 +224,60 @@ jobs:\n          with:\n            name: coverage\n            path: target/coverage\n+  kubernetes:\n+    name: kubernetes\n+    runs-on: ubuntu-18.04\n+    steps:\n+      - uses: actions/cache@v2\n+        with:\n+          path: ~/.m2/repository\n+          key: maven-repo-${{ hashFiles('**/pom.xml') }}\n+      - uses: actions/cache@v2\n+        with:\n+          path: |\n+            ~/.pnpm-store\n+            **/node_modules\n+          key: ${{ runner.os }}-pnpm-${{ hashFiles('**/pnpm-lock.yaml') }}\n+          restore-keys: |\n+            ${{ runner.os }}-pnpm-\n+      - name: checkout to /mnt/ozone\n+        run: |\n+          sudo chmod 777 /mnt\n+          git clone https://github.com/${GITHUB_REPOSITORY}.git /mnt/ozone\n+          cd /mnt/ozone\n+          git fetch origin \"${GITHUB_REF}\"\n+          git checkout FETCH_HEAD\n+          git reset --hard\n+      - name: insstall robotframework", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9144ea93bc6adbb67610b9031d6b16f09b1cf5ab"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81c68f5e85c3b41d83cc2bd391298e9fb60eaa53", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/81c68f5e85c3b41d83cc2bd391298e9fb60eaa53", "committedDate": "2020-07-27T12:04:11Z", "message": "remove parameter of combine_reports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17afb8d013cde6c7dbc84b5e366922c1f497a353", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/17afb8d013cde6c7dbc84b5e366922c1f497a353", "committedDate": "2020-07-27T12:06:54Z", "message": "move bats to the tests (and fix test name)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb308b09c264689b332e929d337d4555ff40ee19", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/eb308b09c264689b332e929d337d4555ff40ee19", "committedDate": "2020-07-27T12:09:30Z", "message": "typo in post-commit (insstall)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bd1e910b26f14c26e0bac53ae2c44f0e5c82252", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/4bd1e910b26f14c26e0bac53ae2c44f0e5c82252", "committedDate": "2020-07-27T12:22:22Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3990"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "473a02e9ab9c4d680e81c4db840376c57a98d356", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/473a02e9ab9c4d680e81c4db840376c57a98d356", "committedDate": "2020-07-27T12:22:54Z", "message": "Merge remote-tracking branch 'elek/HDDS-3990' into HDDS-3990"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddce73e1d051ed82902d311e2469c8fff2278aeb", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/ddce73e1d051ed82902d311e2469c8fff2278aeb", "committedDate": "2020-07-29T09:20:31Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3990"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDI5MjIz", "url": "https://github.com/apache/ozone/pull/1223#pullrequestreview-457429223", "createdAt": "2020-07-29T11:25:19Z", "commit": {"oid": "ddce73e1d051ed82902d311e2469c8fff2278aeb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NzMxMDY5", "url": "https://github.com/apache/ozone/pull/1223#pullrequestreview-457731069", "createdAt": "2020-07-29T17:19:46Z", "commit": {"oid": "ddce73e1d051ed82902d311e2469c8fff2278aeb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNzoxOTo0NlrOG5CYfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNzoxOTo0NlrOG5CYfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjQ2MTA1Mg==", "bodyText": "Can you please update this with the fix from fd47f91?", "url": "https://github.com/apache/ozone/pull/1223#discussion_r462461052", "createdAt": "2020-07-29T17:19:46Z", "author": {"login": "adoroszlai"}, "path": ".github/workflows/post-commit.yml", "diffHunk": "@@ -238,3 +238,61 @@ jobs:\n            name: coverage\n            path: target/coverage\n          continue-on-error: true\n+  kubernetes:\n+    name: kubernetes\n+    runs-on: ubuntu-18.04\n+    steps:\n+      - uses: actions/cache@v2\n+        with:\n+          path: ~/.m2/repository\n+          key: maven-repo-${{ hashFiles('**/pom.xml') }}\n+      - uses: actions/cache@v2\n+        with:\n+          path: |\n+            ~/.pnpm-store\n+            **/node_modules\n+          key: ${{ runner.os }}-pnpm-${{ hashFiles('**/pnpm-lock.yaml') }}\n+          restore-keys: |\n+            ${{ runner.os }}-pnpm-\n+      - name: checkout to /mnt/ozone\n+        run: |\n+          sudo chmod 777 /mnt\n+          git clone https://github.com/${GITHUB_REPOSITORY}.git /mnt/ozone\n+          cd /mnt/ozone\n+          git fetch origin \"${GITHUB_REF}\"\n+          git checkout FETCH_HEAD", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddce73e1d051ed82902d311e2469c8fff2278aeb"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f15bb4c5ddff5d74fa7fda23fb2d5b13f7006d6", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/6f15bb4c5ddff5d74fa7fda23fb2d5b13f7006d6", "committedDate": "2020-07-30T10:11:32Z", "message": "adjust debug log and wrap final generation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fe4e59fbd7b941cfff16f1f216fa34991904a35", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/8fe4e59fbd7b941cfff16f1f216fa34991904a35", "committedDate": "2020-07-30T10:12:54Z", "message": "Use updated checkout logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28e150fdb228a1bd5bb4bfb5eee5435142bde6d4", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/28e150fdb228a1bd5bb4bfb5eee5435142bde6d4", "committedDate": "2020-07-30T10:15:22Z", "message": "Add names for each new build step"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "118d26b8c8dfa6a02accde3b4281a462397acbff", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/118d26b8c8dfa6a02accde3b4281a462397acbff", "committedDate": "2020-07-30T10:17:53Z", "message": "Merge remote-tracking branch 'origin/master' into HDDS-3990"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04fd34457dc40241bae6dcf6c3af4f280df5a294", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/04fd34457dc40241bae6dcf6c3af4f280df5a294", "committedDate": "2020-07-30T10:19:53Z", "message": "fix bats"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2882, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}