{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NDkzNTQ4", "number": 1255, "title": "HDDS-4021. Organize Recon DBs into a 'DBDefinition'.", "bodyText": "What changes were proposed in this pull request?\n\nReconNodeManager uses node db in an old format which is not part of ReconDBDefinition. Move the definition to ReconDBDefinition.\nCreate DB Definition for Recon Container DB.\nModify DBScanner tool to allow it to read Recon DBs.\n\nWhat is the link to the Apache JIRA\nhttps://issues.apache.org/jira/browse/HDDS-4021\nHow was this patch tested?\nManually tested on cluster.\nAdded unit test for DBScanner changes.", "createdAt": "2020-07-24T21:14:51Z", "url": "https://github.com/apache/ozone/pull/1255", "merged": true, "mergeCommit": {"oid": "e219aae7c7bcd8eacd592ca2ccfcf58626477f37"}, "closed": true, "closedAt": "2020-08-01T05:38:35Z", "author": {"login": "avijayanhwx"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4KshHgH2gAyNDU2NDkzNTQ4OjQ3NjEyYjJmNWI1MTkwMGQ3MDk0NjI4NjMyYjNkMzFlYjY0ODBkNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6iHPLAFqTQ1OTU1NTM1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "47612b2f5b51900d7094628632b3d31eb6480d4a", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/47612b2f5b51900d7094628632b3d31eb6480d4a", "committedDate": "2020-07-24T21:13:31Z", "message": "HDDS-4021. Organize Recon DBs into a 'DBDefinition'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "803bd69db16a12e3de602d8086c016c986245448", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/803bd69db16a12e3de602d8086c016c986245448", "committedDate": "2020-07-24T21:51:49Z", "message": "Fix compilation issue."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NTIxMDY0", "url": "https://github.com/apache/ozone/pull/1255#pullrequestreview-457521064", "createdAt": "2020-07-29T13:29:17Z", "commit": {"oid": "803bd69db16a12e3de602d8086c016c986245448"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MzM1NTIx", "url": "https://github.com/apache/ozone/pull/1255#pullrequestreview-458335521", "createdAt": "2020-07-30T12:05:05Z", "commit": {"oid": "803bd69db16a12e3de602d8086c016c986245448"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMjowNTowNlrOG5gHGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMjowODoxOFrOG5gM0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk0ODEyMg==", "bodyText": "NIT: as I am an oldschool command line user, I would prefer to use --with-keys instead of camel case", "url": "https://github.com/apache/ozone/pull/1255#discussion_r462948122", "createdAt": "2020-07-30T12:05:06Z", "author": {"login": "elek"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/debug/DBScanner.java", "diffHunk": "@@ -44,28 +44,46 @@\n             description = \"Table name\")\n   private String tableName;\n \n+  @CommandLine.Option(names = {\"--withKey\"},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "803bd69db16a12e3de602d8086c016c986245448"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk0OTU4Ng==", "bodyText": "I am not sure if we need type here. I think this can be simplified as:\n public static DBDefinition getDefinition(String dbName, String type){\n    if (dbMap.containsKey(dbName)){\n      return dbMap.get(dbName);\n  }\n    if (dbName.equals(RECON_SCM_DB_NAME)) {\n      return new ReconSCMDBDefinition();\n    } else if (dbName.startsWith(RECON_CONTAINER_KEY_DB)) {\n      return new ReconDBDefinition(dbName);\n    } else if (dbName.startsWith(RECON_OM_SNAPSHOT_DB)) {\n      return new OMDBDefinition();\n    }\n    return null;\n  }\nSeems to be a good logic which just works.\nOr actually RECON_SCM_DB_NAME also can be added to the map, so you don't need the firts condition", "url": "https://github.com/apache/ozone/pull/1255#discussion_r462949586", "createdAt": "2020-07-30T12:08:18Z", "author": {"login": "elek"}, "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/debug/DBDefinitionFactory.java", "diffHunk": "@@ -40,10 +46,24 @@ private DBDefinitionFactory() {\n     dbMap.put(new OMDBDefinition().getName(), new OMDBDefinition());\n   }\n \n-  public static DBDefinition getDefinition(String dbName){\n+  public static DBDefinition getDefinition(String dbName, String type){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "803bd69db16a12e3de602d8086c016c986245448"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16ea452459883086de1df5a392f147b387fa58ca", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/16ea452459883086de1df5a392f147b387fa58ca", "committedDate": "2020-07-30T22:10:13Z", "message": "Address review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39dba090fd3cf85bf029d0ac61ec080161227618", "author": {"user": {"login": "avijayanhwx", "name": null}}, "url": "https://github.com/apache/ozone/commit/39dba090fd3cf85bf029d0ac61ec080161227618", "committedDate": "2020-07-31T03:24:43Z", "message": "Merge remote-tracking branch 'upstream/master' into HDDS-4021-master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2c7c20116b43799ff33dbb5fb79db1181f15a48", "author": {"user": {"login": "elek", "name": "Elek, M\u00e1rton"}}, "url": "https://github.com/apache/ozone/commit/f2c7c20116b43799ff33dbb5fb79db1181f15a48", "committedDate": "2020-07-31T15:30:53Z", "message": "retrigger build with empty commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTU1MzU5", "url": "https://github.com/apache/ozone/pull/1255#pullrequestreview-459555359", "createdAt": "2020-08-01T05:38:22Z", "commit": {"oid": "f2c7c20116b43799ff33dbb5fb79db1181f15a48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2924, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}