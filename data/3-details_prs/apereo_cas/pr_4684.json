{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMzc2NDg1", "number": 4684, "title": "Provides feature to configure saml session store factory", "bodyText": "Added and handled configuration parameter to specify saml session store factory WRT pac4j property org.pac4j.saml.config.SAML2Configuration#samlSessionStoreFactory", "createdAt": "2020-02-07T11:56:52Z", "url": "https://github.com/apereo/cas/pull/4684", "merged": true, "mergeCommit": {"oid": "24ad1530d7ac01f543fbed1140eee7e7da4a35d7"}, "closed": true, "closedAt": "2020-02-08T06:38:01Z", "author": {"login": "fmartelli"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcB9-XSAH2gAyMzcyMzc2NDg1OmRlMGNlNDJmZDRhMTMzMDM3MDgxYmE1NDhkODJhMjBhNjYxOGU3OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCMkrLgH2gAyMzcyMzc2NDg1OjJiMjViM2Q3M2ZiYjVhNGQ1N2M0YzdlNDJiN2YxOTM2NTc3NGMxYjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "de0ce42fd4a133037081ba548d82a20a6618e797", "author": {"user": {"login": "fmartelli", "name": "Fabio Martelli"}}, "url": "https://github.com/apereo/cas/commit/de0ce42fd4a133037081ba548d82a20a6618e797", "committedDate": "2020-02-07T11:52:20Z", "message": "provides feature to configure saml session store factory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f347f41d2be2ea7bf2d0a6f687d55d609810395", "author": {"user": {"login": "apereocas-bot", "name": null}}, "url": "https://github.com/apereo/cas/commit/6f347f41d2be2ea7bf2d0a6f687d55d609810395", "committedDate": "2020-02-07T13:50:44Z", "message": "Merge branch '6.1.x' into sessionStoreFactoryIssue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8f6896426859bc10c573f2f0c767983fdc75ee1", "author": {"user": {"login": "fmartelli", "name": "Fabio Martelli"}}, "url": "https://github.com/apereo/cas/commit/e8f6896426859bc10c573f2f0c767983fdc75ee1", "committedDate": "2020-02-07T15:01:06Z", "message": "remove trailing spaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3bd561dbe4f6c506949b0f5f73435cf24ece2ce", "author": {"user": {"login": "apereocas-bot", "name": null}}, "url": "https://github.com/apereo/cas/commit/d3bd561dbe4f6c506949b0f5f73435cf24ece2ce", "committedDate": "2020-02-07T16:50:42Z", "message": "Merge branch '6.1.x' into sessionStoreFactoryIssue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be", "author": {"user": {"login": "mmoayyed", "name": "Misagh Moayyed"}}, "url": "https://github.com/apereo/cas/commit/21c79747888f89460da46f72f7c1920d5d82b4be", "committedDate": "2020-02-07T17:01:19Z", "message": "Update Pac4jSamlClientProperties.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MzAyNDUw", "url": "https://github.com/apereo/cas/pull/4684#pullrequestreview-355302450", "createdAt": "2020-02-07T17:04:31Z", "commit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxNzowNDozMVrOFnD6Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxNzowNjo1OVrOFnD-bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwMjgzNA==", "bodyText": "val clazz = ClassUtils.getClass(DelegatedClientFactory.class.getClassLoader(), className);\nval factory = SAMLMessageStoreFactory.class.cast(clazz.getDeclaredConstructor().newInstance());", "url": "https://github.com/apereo/cas/pull/4684#discussion_r376502834", "createdAt": "2020-02-07T17:04:31Z", "author": {"login": "mmoayyed"}, "path": "support/cas-server-support-pac4j-core-clients/src/main/java/org/apereo/cas/support/pac4j/authentication/DelegatedClientFactory.java", "diffHunk": "@@ -419,6 +421,19 @@ protected void configureSamlClient(final Collection<IndirectClient> properties)\n                 cfg.setWantsAssertionsSigned(saml.isWantsAssertionsSigned());\n                 cfg.setUseNameQualifier(saml.isUseNameQualifier());\n                 cfg.setAttributeConsumingServiceIndex(saml.getAttributeConsumingServiceIndex());\n+                \n+                try{\n+                    cfg.setSamlMessageStoreFactory(SAMLMessageStoreFactory.class.cast(\n+                        Class.forName(saml.getMessageStoreFactory()).getDeclaredConstructor().newInstance()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwMzAxOA==", "bodyText": "catch (final Exception e)", "url": "https://github.com/apereo/cas/pull/4684#discussion_r376503018", "createdAt": "2020-02-07T17:04:57Z", "author": {"login": "mmoayyed"}, "path": "support/cas-server-support-pac4j-core-clients/src/main/java/org/apereo/cas/support/pac4j/authentication/DelegatedClientFactory.java", "diffHunk": "@@ -419,6 +421,19 @@ protected void configureSamlClient(final Collection<IndirectClient> properties)\n                 cfg.setWantsAssertionsSigned(saml.isWantsAssertionsSigned());\n                 cfg.setUseNameQualifier(saml.isUseNameQualifier());\n                 cfg.setAttributeConsumingServiceIndex(saml.getAttributeConsumingServiceIndex());\n+                \n+                try{\n+                    cfg.setSamlMessageStoreFactory(SAMLMessageStoreFactory.class.cast(\n+                        Class.forName(saml.getMessageStoreFactory()).getDeclaredConstructor().newInstance()));\n+                }catch(ClassNotFoundException ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwMzE4NA==", "bodyText": "Use [{}]", "url": "https://github.com/apereo/cas/pull/4684#discussion_r376503184", "createdAt": "2020-02-07T17:05:23Z", "author": {"login": "mmoayyed"}, "path": "support/cas-server-support-pac4j-core-clients/src/main/java/org/apereo/cas/support/pac4j/authentication/DelegatedClientFactory.java", "diffHunk": "@@ -419,6 +421,19 @@ protected void configureSamlClient(final Collection<IndirectClient> properties)\n                 cfg.setWantsAssertionsSigned(saml.isWantsAssertionsSigned());\n                 cfg.setUseNameQualifier(saml.isUseNameQualifier());\n                 cfg.setAttributeConsumingServiceIndex(saml.getAttributeConsumingServiceIndex());\n+                \n+                try{\n+                    cfg.setSamlMessageStoreFactory(SAMLMessageStoreFactory.class.cast(\n+                        Class.forName(saml.getMessageStoreFactory()).getDeclaredConstructor().newInstance()));\n+                }catch(ClassNotFoundException \n+                        | InstantiationException \n+                        | IllegalAccessException \n+                        | NoSuchMethodException \n+                        | InvocationTargetException e){\n+                    LOGGER.error(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwMzkxNw==", "bodyText": "HttpSessionStoreFactory.class.getName()\nUse the class itself to get its name, so if it moves or is deleted, we can catch the issue at compile-time.", "url": "https://github.com/apereo/cas/pull/4684#discussion_r376503917", "createdAt": "2020-02-07T17:06:59Z", "author": {"login": "mmoayyed"}, "path": "support/cas-server-support-pac4j-core-clients/src/test/java/org/apereo/cas/support/pac4j/authentication/DelegatedClientFactoryTests.java", "diffHunk": "@@ -79,13 +80,18 @@ public void verifyFactoryForSamlClients() throws Exception {\n         saml.setServiceProviderMetadataPath(new File(FileUtils.getTempDirectoryPath(), \"sp.xml\").getCanonicalPath());\n         saml.setServiceProviderEntityId(\"test-entityid\");\n         saml.setForceKeystoreGeneration(true);\n+        saml.setMessageStoreFactory(\"org.pac4j.saml.store.HttpSessionStoreFactory\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21c79747888f89460da46f72f7c1920d5d82b4be"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb3e13b1639cb7a20b57cddd70d4d4df8ecc484d", "author": {"user": {"login": "fmartelli", "name": "Fabio Martelli"}}, "url": "https://github.com/apereo/cas/commit/bb3e13b1639cb7a20b57cddd70d4d4df8ecc484d", "committedDate": "2020-02-07T18:00:32Z", "message": "addresses some comments + fixes checkstyle issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bca0a04af03eff5dfe8abe90e166737be3e50ad5", "author": {"user": {"login": "mmoayyed", "name": "Misagh Moayyed"}}, "url": "https://github.com/apereo/cas/commit/bca0a04af03eff5dfe8abe90e166737be3e50ad5", "committedDate": "2020-02-07T18:04:46Z", "message": "Update DelegatedClientFactory.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1150b90794ceab055e5aba583c5421b6585ed5b7", "author": {"user": {"login": "mmoayyed", "name": "Misagh Moayyed"}}, "url": "https://github.com/apereo/cas/commit/1150b90794ceab055e5aba583c5421b6585ed5b7", "committedDate": "2020-02-07T18:05:23Z", "message": "Update DelegatedClientFactory.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDI2MDEy", "url": "https://github.com/apereo/cas/pull/4684#pullrequestreview-355426012", "createdAt": "2020-02-07T20:45:06Z", "commit": {"oid": "1150b90794ceab055e5aba583c5421b6585ed5b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c067367e0c572a206a4253a6c18a28f6098c770a", "author": {"user": {"login": "apereocas-bot", "name": null}}, "url": "https://github.com/apereo/cas/commit/c067367e0c572a206a4253a6c18a28f6098c770a", "committedDate": "2020-02-08T01:52:51Z", "message": "Merge branch '6.1.x' into sessionStoreFactoryIssue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b25b3d73fbb5a4d57c4c7e42b7f19365774c1b7", "author": {"user": {"login": "apereocas-bot", "name": null}}, "url": "https://github.com/apereo/cas/commit/2b25b3d73fbb5a4d57c4c7e42b7f19365774c1b7", "committedDate": "2020-02-08T04:52:51Z", "message": "Merge branch '6.1.x' into sessionStoreFactoryIssue"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3674, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}