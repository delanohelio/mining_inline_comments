{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxOTYzMDk2", "number": 3810, "title": "Add economy commands to towny admin.", "bodyText": "Description:\n\nAdd economy commands to town/nation sub-commands within /townyadmin.\nThe appropriate language strings have not been added (but have been stubbed). I was not sure if we should use existing ones or create new ones.\n\nNew Nodes/Commands/ConfigOptions:\n\nWithdraw/Deposit Sub-commands to /ta town and /ta nation. Example Usage: /ta town TestTown withdraw 5.\n\nRelevant Towny Issue ticket:\n\nCloses #3687\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-03-22T06:24:38Z", "url": "https://github.com/TownyAdvanced/Towny/pull/3810", "merged": true, "mergeCommit": {"oid": "db17b666d0563c077e76cd1d53727fba7ee4660d"}, "closed": true, "closedAt": "2020-03-22T21:15:49Z", "author": {"login": "silverwolfg11"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQDls9AH2gAyMzkxOTYzMDk2OjA5Yzc4ODk3OGEzMWYxMTQ5YzZhOWRiNjU3MjMwZDEwN2Y2NjQ2NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQQYjNAFqTM3OTA0Nzk2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "09c788978a31f1149c6a9db657230d107f664644", "author": {"user": {"login": "silverwolfg11", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/09c788978a31f1149c6a9db657230d107f664644", "committedDate": "2020-03-22T06:19:46Z", "message": "Add deposit and withdraw sub-command to town and nation options in /townyadmin."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTk0OTg4", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#pullrequestreview-378994988", "createdAt": "2020-03-22T11:23:57Z", "commit": {"oid": "09c788978a31f1149c6a9db657230d107f664644"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMToyMzo1N1rOF5u8BA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMToyMzo1N1rOF5u8BA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4MjE4MA==", "bodyText": "TownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"town_sign\")));\nTownyMessaging.sendPrefixedTownMessage(town, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"town_sign\")));", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#discussion_r396082180", "createdAt": "2020-03-22T11:23:57Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java", "diffHunk": "@@ -932,6 +939,32 @@ public void parseAdminTownCommand(String[] split) throws TownyException {\n \t\t\t\tTownCommand.townSet(player, StringMgmt.remArgs(split, 2), true, town);\r\n \t\t\t} else if (split[1].equalsIgnoreCase(\"meta\")) {\r\n \t\t\t\thandleTownMetaCommand(player, town, split);\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"deposit\")) {\r\n+\t\t\t\tint amount;\r\n+\t\t\t\t\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\ttown.getAccount().collect(amount, \"Admin Deposit\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Town Deposit Language String\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\ttown.getAccount().pay(amount, \"Admin Withdraw\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Town Withdraw Language String\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09c788978a31f1149c6a9db657230d107f664644"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTk1MjEw", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#pullrequestreview-378995210", "createdAt": "2020-03-22T11:26:38Z", "commit": {"oid": "09c788978a31f1149c6a9db657230d107f664644"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMToyNjozOVrOF5u86Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMToyNjozOVrOF5u86Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4MjQwOQ==", "bodyText": "TownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount, TownySettings.getLangString(\"nation_sign\")));\nTownyMessaging.sendPrefixedNationMessage(nation, String.format(TownySettings.getLangString(\"msg_xx_withdrew_xx\"), (isConsole ? \"console\" : player.getName()), amount,  TownySettings.getLangString(\"nation_sign\")));", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#discussion_r396082409", "createdAt": "2020-03-22T11:26:39Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/TownyAdminCommand.java", "diffHunk": "@@ -1126,9 +1163,34 @@ public void parseAdminNationCommand(String[] split) throws TownyException {\n \t\t\t} else if(split[1].equalsIgnoreCase(\"toggle\")) {\r\n \t\t\t\t\r\n \t\t\t\tNationCommand.nationToggle(player, StringMgmt.remArgs(split, 2), true, nation);\r\n+\t\t\t} else if (split[1].equalsIgnoreCase(\"deposit\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\tnation.getAccount().collect(amount, \"Admin Deposit\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Nation Deposit Language String\r\n+\t\t\t}\r\n+\t\t\telse if (split[1].equalsIgnoreCase(\"withdraw\")) {\r\n+\t\t\t\tint amount;\r\n+\r\n+\t\t\t\ttry {\r\n+\t\t\t\t\tamount = Integer.parseInt(split[2]);\r\n+\t\t\t\t} catch (NumberFormatException ex) {\r\n+\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_error_must_be_int\"));\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\tnation.getAccount().pay(amount, \"Admin Withdraw\");\r\n+\t\t\t\tTownyMessaging.sendMessage(sender, String.format(TownySettings.getLangString(\"\"), \"\")); // TODO Nation Withdraw Language String\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09c788978a31f1149c6a9db657230d107f664644"}, "originalPosition": 127}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTk1NTAx", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#pullrequestreview-378995501", "createdAt": "2020-03-22T11:29:59Z", "commit": {"oid": "09c788978a31f1149c6a9db657230d107f664644"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "author": {"user": {"login": "silverwolfg11", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/08bb616f651a7d7bdfe759d3a4f06613c60c9f26", "committedDate": "2020-03-22T19:22:46Z", "message": "Use language strings for admin economy sub-cmds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MDQ3OTY4", "url": "https://github.com/TownyAdvanced/Towny/pull/3810#pullrequestreview-379047968", "createdAt": "2020-03-22T21:14:10Z", "commit": {"oid": "08bb616f651a7d7bdfe759d3a4f06613c60c9f26"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4243, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}