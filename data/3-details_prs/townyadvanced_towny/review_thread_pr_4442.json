{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMTMzMjg3", "number": 4442, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQxNTowODoyNlrOE5LWLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjoyNjo1MlrOE5_kpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4MzkwMTkxOnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQxNTowODoyNlrOHzgdWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMjo0NDoyNlrOH0iP4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzc3MTIyNQ==", "bodyText": "I would move the isAdmin() test up to be in front of line 788. If this is an admin we need to bail out earlier.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r523771225", "createdAt": "2020-11-15T15:08:26Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -790,7 +792,7 @@ public void onOutlawEnterTown(PlayerEnterTownEvent event) throws NotRegisteredEx\n \t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw()) {\n \t\t\t\tTownyMessaging.sendPrefixedTownMessage(town, Translation.of(\"msg_outlaw_town_notify\", outlaw.getFormattedName()));\n \t\t\t}\n-\t\t\tif (TownySettings.canOutlawsEnterTowns()) {\n+\t\t\tif (TownySettings.canOutlawsEnterTowns() || TownyUniverse.getInstance().getPermissionSource().isTownyAdmin(event.getPlayer())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31eabf0118bf7a8f20f31173ae1eaf52afaba89a"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg0OTEyMA==", "bodyText": "I had it here intentionally so that admins/others with the perm to bypass (which I just added) will still be warned that they are outlawed in case they are also players, but... we likely don't want admins announce if the server is announcing outlaws, so I'm adding the generic admin check on line 791 as well.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r524849120", "createdAt": "2020-11-17T02:44:26Z", "author": {"login": "Momshroom"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -790,7 +792,7 @@ public void onOutlawEnterTown(PlayerEnterTownEvent event) throws NotRegisteredEx\n \t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw()) {\n \t\t\t\tTownyMessaging.sendPrefixedTownMessage(town, Translation.of(\"msg_outlaw_town_notify\", outlaw.getFormattedName()));\n \t\t\t}\n-\t\t\tif (TownySettings.canOutlawsEnterTowns()) {\n+\t\t\tif (TownySettings.canOutlawsEnterTowns() || TownyUniverse.getInstance().getPermissionSource().isTownyAdmin(event.getPlayer())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzc3MTIyNQ=="}, "originalCommit": {"oid": "31eabf0118bf7a8f20f31173ae1eaf52afaba89a"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4MzkwMjI3OnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQxNTowODo0OFrOHzgdhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMjoyMzozOFrOH0h3bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzc3MTI3MA==", "bodyText": "Whitespacing change, please revert.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r523771270", "createdAt": "2020-11-15T15:08:48Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -585,6 +586,7 @@ public void onPlayerMove(PlayerMoveEvent event) {\n \t\tLocation from;\n \t\tPlayerCache cache = plugin.getCache(player);\n \t\tResident resident = null;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31eabf0118bf7a8f20f31173ae1eaf52afaba89a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg0Mjg2MQ==", "bodyText": "fixing... not even sure how that happened.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r524842861", "createdAt": "2020-11-17T02:23:38Z", "author": {"login": "Momshroom"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -585,6 +586,7 @@ public void onPlayerMove(PlayerMoveEvent event) {\n \t\tLocation from;\n \t\tPlayerCache cache = plugin.getCache(player);\n \t\tResident resident = null;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzc3MTI3MA=="}, "originalCommit": {"oid": "31eabf0118bf7a8f20f31173ae1eaf52afaba89a"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjQ0NDc1OnYy", "diffSide": "RIGHT", "path": "resources/plugin.yml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjoyMzowOFrOH0yYxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjoyODo0MFrOH09zOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMzU0Mw==", "bodyText": "Any admin node should start with the towny.admin.{foo}\nI would suggest towny.admin.outlaw.teleportbypass, which can be added to the PermissionNodes.java underneath the towny.admin.nation_zone permission node.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525113543", "createdAt": "2020-11-17T12:23:08Z", "author": {"login": "LlmDl"}, "path": "resources/plugin.yml", "diffHunk": "@@ -59,11 +59,16 @@ permissions:\n             towny.claimed.*: true\n             towny.admin.nation_zone: true\n             towny.admin.spawn: true\n+            towny.outlaw.tpbypass: true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwNDczMQ==", "bodyText": "Make the towny.admin.outlaw.teleportbypass node a child node of towny.admin.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525204731", "createdAt": "2020-11-17T14:39:36Z", "author": {"login": "LlmDl"}, "path": "resources/plugin.yml", "diffHunk": "@@ -59,11 +59,16 @@ permissions:\n             towny.claimed.*: true\n             towny.admin.nation_zone: true\n             towny.admin.spawn: true\n+            towny.outlaw.tpbypass: true", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMzU0Mw=="}, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMwMDUzNg==", "bodyText": "Done", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525300536", "createdAt": "2020-11-17T16:28:40Z", "author": {"login": "Momshroom"}, "path": "resources/plugin.yml", "diffHunk": "@@ -59,11 +59,16 @@ permissions:\n             towny.claimed.*: true\n             towny.admin.nation_zone: true\n             towny.admin.spawn: true\n+            towny.outlaw.tpbypass: true", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExMzU0Mw=="}, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjQ1NDQwOnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/permissions/PermissionNodes.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjoyNTo0MVrOH0yemw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjoyOTowMVrOH090eA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExNTAzNQ==", "bodyText": "Replace this with TOWNY_ADMIN_OUTLAW_TELEPORT_BYPASS(\"towny.admin.outlaw.teleportbypass\"), added to line 10, below the admin nation zone node.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525115035", "createdAt": "2020-11-17T12:25:41Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/permissions/PermissionNodes.java", "diffHunk": "@@ -378,6 +378,7 @@\n \tTOWNY_CHAT_SPY(\"towny.chat.spy\"),\r\n \t\r\n \tTOWNY_OUTLAW_JAILER(\"towny.outlaw.jailer\"),\r\n+\tTOWNY_OUTLAW_TPBYPASS(\"towny.outlaw.tpbypass\"),\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMwMDg1Ng==", "bodyText": "Done, but with teleport_bypass to be consistent with nation_zone.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525300856", "createdAt": "2020-11-17T16:29:01Z", "author": {"login": "Momshroom"}, "path": "src/com/palmergames/bukkit/towny/permissions/PermissionNodes.java", "diffHunk": "@@ -378,6 +378,7 @@\n \tTOWNY_CHAT_SPY(\"towny.chat.spy\"),\r\n \t\r\n \tTOWNY_OUTLAW_JAILER(\"towny.outlaw.jailer\"),\r\n+\tTOWNY_OUTLAW_TPBYPASS(\"towny.outlaw.tpbypass\"),\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExNTAzNQ=="}, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjQ1ODYwOnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjoyNjo1MlrOH0yhJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjoyOToxMFrOH0906A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExNTY4NA==", "bodyText": "This isTownyAdmin() test should happen earlier, before the outlaw variable is declared.\nAdd a //comment mentioning that this is to keep towns from knowing an admin might be spying on them.", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525115684", "createdAt": "2020-11-17T12:26:52Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -787,10 +788,11 @@ public void onOutlawEnterTown(PlayerEnterTownEvent event) throws NotRegisteredEx\n \t\tTown town = event.getEnteredtown();\n \t\t\n \t\tif (town.hasOutlaw(outlaw)) {\n-\t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw()) {\n+\t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw() && !TownyUniverse.getInstance().getPermissionSource().isTownyAdmin(event.getPlayer())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMwMDk2OA==", "bodyText": "Done", "url": "https://github.com/TownyAdvanced/Towny/pull/4442#discussion_r525300968", "createdAt": "2020-11-17T16:29:10Z", "author": {"login": "Momshroom"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyPlayerListener.java", "diffHunk": "@@ -787,10 +788,11 @@ public void onOutlawEnterTown(PlayerEnterTownEvent event) throws NotRegisteredEx\n \t\tTown town = event.getEnteredtown();\n \t\t\n \t\tif (town.hasOutlaw(outlaw)) {\n-\t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw()) {\n+\t\t\tif (TownySettings.doTownsGetWarnedOnOutlaw() && !TownyUniverse.getInstance().getPermissionSource().isTownyAdmin(event.getPlayer())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTExNTY4NA=="}, "originalCommit": {"oid": "6ec9e96e6e33754e0807fa0380a67c1d4f759dce"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1238, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}