{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MzYwODY4", "number": 3755, "title": "HotFix: Fix Ally invite sending to already allied nations.", "bodyText": "Description:\n\nThis fixes the issue where towny will still send invites to ally with nations even if they are already allied. This also removes the labeler workflow.\n\nRelevant Towny Issue ticket:\n\nCloses #3749\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-03-09T02:55:34Z", "url": "https://github.com/TownyAdvanced/Towny/pull/3755", "merged": true, "mergeCommit": {"oid": "8382ac1b35b36292e663db0d189135cd91d74441"}, "closed": true, "closedAt": "2020-03-10T19:26:35Z", "author": null, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcL01wrAH2gAyMzg1MzYwODY4OmE3YWM2OTZjNTg1YmJkYzRkOTRhYjg3NjE1YWQ2YWMwYTFlMGYyNmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMWFK-AFqTM3MjE3NjM3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a7ac696c585bbdc4d94ab87615ad6ac0a1e0f26c", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/a7ac696c585bbdc4d94ab87615ad6ac0a1e0f26c", "committedDate": "2020-03-09T02:53:02Z", "message": "Fixed problem where nation ally invite would send invite to other nation even if they were already allied."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fda38de29e21a0af96c455ca25a80ef150287b64", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/fda38de29e21a0af96c455ca25a80ef150287b64", "committedDate": "2020-03-09T02:56:40Z", "message": "Remove labeler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxMTYzMDY0", "url": "https://github.com/TownyAdvanced/Towny/pull/3755#pullrequestreview-371163064", "createdAt": "2020-03-09T13:12:22Z", "commit": {"oid": "fda38de29e21a0af96c455ca25a80ef150287b64"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMzoxMjoyMlrOFzmWGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMzoxOTo1M1rOFzmmDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTY0OTk0NQ==", "bodyText": "Unused import?", "url": "https://github.com/TownyAdvanced/Towny/pull/3755#discussion_r389649945", "createdAt": "2020-03-09T13:12:22Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyBlockListener.java", "diffHunk": "@@ -26,6 +26,7 @@\n import org.bukkit.Material;\r\n import org.bukkit.block.Block;\r\n import org.bukkit.block.BlockFace;\r\n+import org.bukkit.configuration.file.YamlConfiguration;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fda38de29e21a0af96c455ca25a80ef150287b64"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTY1MDAzNw==", "bodyText": "Unused imports?", "url": "https://github.com/TownyAdvanced/Towny/pull/3755#discussion_r389650037", "createdAt": "2020-03-09T13:12:34Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/listeners/TownyBlockListener.java", "diffHunk": "@@ -37,6 +38,9 @@\n import org.bukkit.event.block.BlockPistonExtendEvent;\r\n import org.bukkit.event.block.BlockPistonRetractEvent;\r\n import org.bukkit.event.block.BlockPlaceEvent;\r\n+import org.bukkit.inventory.ItemStack;\r\n+import org.bukkit.inventory.meta.ItemMeta;\r\n+import org.yaml.snakeyaml.Yaml;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fda38de29e21a0af96c455ca25a80ef150287b64"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTY1NDAzMA==", "bodyText": "It's debatable whether the return statement should be put back in for the nation.equals(ally) and also added to your new if statement. I know it's supposed to pass over any non-usable names because it is sent a String[], but if you look at the cases below inside of the catch, if it is given an unusable argument it kills it with a return, rather than continuing to process the string. I would say put the returns in the try to match until all of the returns can be dealt with.", "url": "https://github.com/TownyAdvanced/Towny/pull/3755#discussion_r389654030", "createdAt": "2020-03-09T13:19:53Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -1735,10 +1735,12 @@ private void nationAlly(Player player, String[] split) throws TownyException {\n \t\t\t\t\tally = townyUniverse.getDataSource().getNation(name);\r\n \t\t\t\t\tif (nation.equals(ally)) {\r\n \t\t\t\t\t\tTownyMessaging.sendErrorMsg(player, TownySettings.getLangString(\"msg_own_nation_disallow\"));\r\n-\t\t\t\t\t\treturn;\r\n+\t\t\t\t\t} else if (nation.isAlliedWith(ally)) {\r\n+\t\t\t\t\t\tTownyMessaging.sendErrorMsg(player, String.format(TownySettings.getLangString(\"msg_already_ally\"), ally));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fda38de29e21a0af96c455ca25a80ef150287b64"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a326252ebec97ea0226ab624a4ad90e162dccfa4", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/a326252ebec97ea0226ab624a4ad90e162dccfa4", "committedDate": "2020-03-09T16:47:44Z", "message": "removed unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4c126b4fe8c1ff1a543cbe7f438ed369ca925aa", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/b4c126b4fe8c1ff1a543cbe7f438ed369ca925aa", "committedDate": "2020-03-10T00:06:23Z", "message": "remove other returns in loop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTc2Mzcz", "url": "https://github.com/TownyAdvanced/Towny/pull/3755#pullrequestreview-372176373", "createdAt": "2020-03-10T17:36:44Z", "commit": {"oid": "b4c126b4fe8c1ff1a543cbe7f438ed369ca925aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4228, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}