{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NjYwMTMy", "number": 4107, "title": "Add Mayoral Succession", "bodyText": "Description:\nAllow mayoral succession to include ranks other than assistant.\n\nNew Config Option:\nGTOWN_ORDER_OF_MAYORAL_SUCCESSION\nSpecifies the ranks to be given preference over regular residents when Towny automatically assigns a new mayor upon the removal of the previous mayor.\n\nRelevant Towny Issue ticket:\nNone known, but this allows servers that do not use the assistant rank to have a rank with priority over normal residents when Towny automatically assigns a new mayor upon the removal of the previous mayor.\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-06-22T03:32:47Z", "url": "https://github.com/TownyAdvanced/Towny/pull/4107", "merged": true, "mergeCommit": {"oid": "808aba1f667a583cf7f2e62fa09d6e8340be68b3"}, "closed": true, "closedAt": "2020-07-18T13:16:25Z", "author": {"login": "docwhomc"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbVYVYigH2gAyNDM3NjYwMTMyOmU1YmZkMzI4YTNiZDU4NmY2Njk1NTMzOGZiY2NjYWJiMGRmMjRjYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1-LH-AFqTQ1MTAyMDIyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e5bfd328a3bd586f66955338fbcccabb0df24ca9", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e5bfd328a3bd586f66955338fbcccabb0df24ca9", "committedDate": "2019-09-21T23:08:25Z", "message": "Add `Town.getRank`\n\nAdd `getRank` method to `Town` class to get a list of town residents with the rank specified as an argument to `getRank`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90aa311363f4f25ef76d09045841c32f59d5c40b", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/90aa311363f4f25ef76d09045841c32f59d5c40b", "committedDate": "2019-09-21T23:14:42Z", "message": "Make `Town.getAssistant` use `Town.getRank`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6de51da5251f60aeed7f0a43206d70ff55c58ad2", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/6de51da5251f60aeed7f0a43206d70ff55c58ad2", "committedDate": "2019-09-21T23:51:38Z", "message": "Check mayoralSuccession ranks when removing mayor\n\nCheck ranks in `Town.mayoralSuccession` when removing mayor with `Town.remove`.\r\n\r\nTODO: Set `mayoralSuccession` with config file instead of hard coding it."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1b2703f6b003eed03b8cc8ad1082260ff3ed5b4", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/a1b2703f6b003eed03b8cc8ad1082260ff3ed5b4", "committedDate": "2020-05-31T19:56:22Z", "message": "Reformat `Town.getAssistant`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfa3e82daff0e29fcde5d60cc7f6ab8d074baa87", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/dfa3e82daff0e29fcde5d60cc7f6ab8d074baa87", "committedDate": "2020-05-31T20:20:11Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e82de8657401a74046f090bfe66edb6552466a5a", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e82de8657401a74046f090bfe66edb6552466a5a", "committedDate": "2020-05-31T23:43:19Z", "message": "Add config option for order of mayoral succession"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e128ecb5aaaf87264e071b9d9b907a61a8f3b851", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e128ecb5aaaf87264e071b9d9b907a61a8f3b851", "committedDate": "2020-06-01T00:08:01Z", "message": "Fix undefined variable in `Town.getRank()`\n\nChange `assistant` to `resident` in `Town.getRank()`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63fd0e2132a3661a2110277e11739cd20b22e36b", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/63fd0e2132a3661a2110277e11739cd20b22e36b", "committedDate": "2020-06-01T00:11:11Z", "message": "Add `Town.hasRank()` method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e38e83a7d4e140391584c037950d8c264c840d3b", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e38e83a7d4e140391584c037950d8c264c840d3b", "committedDate": "2020-06-01T00:11:56Z", "message": "Update `Town.hasAssistant()` to use `hasRank()`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c05ca1db3fff4be3f5e3c85ec1c27a41670f077", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/0c05ca1db3fff4be3f5e3c85ec1c27a41670f077", "committedDate": "2020-06-01T00:15:55Z", "message": "Fix `TownySettings.getOrderOfMayoralSuccession()`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0de021540e1662d400a4c108f496357189a64e5", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/c0de021540e1662d400a4c108f496357189a64e5", "committedDate": "2020-06-20T21:24:04Z", "message": "Update mayoral succession config comment\n\nUpdate mayoral succession config comment to note that the order the\nranks specified will be checked in (prior to checking regular residents)\nis not guaranteed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8b546b42b002b8b5ff2a66c08e8d412fa24c81a", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e8b546b42b002b8b5ff2a66c08e8d412fa24c81a", "committedDate": "2020-06-20T21:26:54Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a62f28929da724836e476b96391835e4a6d8fce5", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/a62f28929da724836e476b96391835e4a6d8fce5", "committedDate": "2020-06-20T21:29:59Z", "message": "Fix syntax error in mayoral succession config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fde605843b5ffb3d6d112ba9f195c9372e33570c", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/fde605843b5ffb3d6d112ba9f195c9372e33570c", "committedDate": "2020-06-24T01:06:08Z", "message": "Add debugging output for mayoral succession"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "committedDate": "2020-06-24T01:58:01Z", "message": "Fix mayoral succession rank ordering issue\n\nFix issue where mayoral succession rank loop not being broken/exited\nwhen a new mayor is appointed, which had resulted in the first eligible\nresident for each rank in the order of succession being being made mayor\n(with the last one to be made mayor ending up as the mayor when the\nsuccession process completed).\n\nUpdate config comment for the order of mayoral succession to reflect the\nrank ordering issue being resolved."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "024fee8b53bab583d7df6c55cf210fadda288f85", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/024fee8b53bab583d7df6c55cf210fadda288f85", "committedDate": "2020-06-24T01:41:53Z", "message": "Fix mayoral succession loop issue\n\nFix issue where mayoral succession loops are not broken/exited when a\nnew mayor is appointed, which had resulted in each resident with a\nmayoral succession eligible rank being made mayor (with the last one to\nbe made mayor ending up as the mayor when the succession process\ncompleted)."}, "afterCommit": {"oid": "c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/c4cd8924b819d0cf0aa780b268e0ed83b229c81f", "committedDate": "2020-06-24T01:58:01Z", "message": "Fix mayoral succession rank ordering issue\n\nFix issue where mayoral succession rank loop not being broken/exited\nwhen a new mayor is appointed, which had resulted in the first eligible\nresident for each rank in the order of succession being being made mayor\n(with the last one to be made mayor ending up as the mayor when the\nsuccession process completed).\n\nUpdate config comment for the order of mayoral succession to reflect the\nrank ordering issue being resolved."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48a978a2e8c3684d6c0ca7f9b810524ccdcacfa4", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/48a978a2e8c3684d6c0ca7f9b810524ccdcacfa4", "committedDate": "2020-06-24T02:10:04Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/d5143348f1a5c64afd62b25a86af75df085ee5ec", "committedDate": "2020-07-11T01:49:11Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODMxMzA0", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-446831304", "createdAt": "2020-07-11T21:52:27Z", "commit": {"oid": "48a978a2e8c3684d6c0ca7f9b810524ccdcacfa4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQyMTo1MzowNFrOGwPf3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQyMTo1NDoyOFrOGwPgNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc0OA==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238748", "createdAt": "2020-07-11T21:53:04Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -661,7 +671,7 @@ private void removeAllResidents() {\n \t}\n \n \tprivate void remove(Resident resident) {\n-\t\t\n+\t\tSystem.out.println(\"private void remove(Resident residen = \" + resident + \")\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc1Nw==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238757", "createdAt": "2020-07-11T21:53:15Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -683,34 +693,21 @@ private void remove(Resident resident) {\n \t\t\t}\n \t\t}\n \n+\t\t// Mayoral succession.\n \t\tif (isMayor(resident)) {\n-\n \t\t\tif (residents.size() > 1) {\n-\t\t\t\tfor (Resident assistant : new ArrayList<>(getAssistants()))\n-\t\t\t\t\tif ((assistant != resident) && (resident.hasTownRank(\"assistant\"))) {\n-\t\t\t\t\t\ttry {\n-\t\t\t\t\t\t\tsetMayor(assistant);\n-\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t} catch (TownyException e) {\n-\t\t\t\t\t\t\t// Error setting mayor.\n-\t\t\t\t\t\t\te.printStackTrace();\n-\t\t\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"TownySettings.getOrderOfMayoralSuccession() = \" + TownySettings.getOrderOfMayoralSuccession());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc4Nw==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238787", "createdAt": "2020-07-11T21:53:43Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODc5MA==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238790", "createdAt": "2020-07-11T21:53:49Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgxMw==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238813", "createdAt": "2020-07-11T21:53:56Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzMA==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238830", "createdAt": "2020-07-11T21:54:17Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 130}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIzODgzOQ==", "bodyText": "Remove debug.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r453238839", "createdAt": "2020-07-11T21:54:28Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif (newMayor != mayor) {\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 141}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTgzNDgw", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-448583480", "createdAt": "2020-07-15T02:16:30Z", "commit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMjoxNjozMFrOGxrsww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMjoxNjozMFrOGxrsww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTM3OQ==", "bodyText": "There's no need for an array copy here new ArrayList<>(getRank(rank)) should just be getRank(Rank)", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r454749379", "createdAt": "2020-07-15T02:16:30Z", "author": null, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 104}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTgzOTc2", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-448583976", "createdAt": "2020-07-15T02:18:03Z", "commit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMjoxODowM1rOGxruvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMjoxODowM1rOGxruvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0OTg4NQ==", "bodyText": "Again, another array copy", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r454749885", "createdAt": "2020-07-15T02:18:03Z", "author": null, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -729,6 +726,58 @@ private void remove(Resident resident) {\n \t\tTownyUniverse.getInstance().getDataSource().saveTown(this);\n \t}\n \n+\t/**\n+\t * Tries to find a new mayor from among the town's residents with the rank specified.\n+\t * \n+\t * @param rank - the rank being checked for potential mayors\n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor(String rank) {\n+\t\tboolean found = false;\n+\t\tSystem.out.println(\"getRank(rank = \" + rank + \") = \" + getRank(rank));\n+\t\tfor (Resident newMayor : new ArrayList<>(getRank(rank))) {\n+\t\t\tSystem.out.println(\"newMayor = \" + newMayor);\n+\t\t\tif ((newMayor != mayor) && (newMayor.hasTownRank(rank))) {  // The latter portion seems redundant.\n+\t\t\t\ttry {\n+\t\t\t\t\tsetMayor(newMayor);\n+\t\t\t\t\tfound = true;\n+\t\t\t\t\tbreak;\n+\t\t\t\t} catch (TownyException e) {\n+\t\t\t\t\t// Error setting mayor.\n+\t\t\t\t\te.printStackTrace();\n+\t\t\t\t\tfound = false;\n+\t\t\t\t}\n+\t\t\t\tSystem.out.println(\"mayor = \" + mayor);\n+\t\t\t}\n+\t\t}\n+\t\treturn found;\n+\t}\n+\t\n+\t/**\n+\t * Tries to find a new mayor from among the town's residents.\n+\t * \n+\t * @return found - whether or not a new mayor was found\n+\t */\n+\tprivate boolean findNewMayor() {\n+\t\tboolean found = false;\n+\t\tfor (Resident newMayor : new ArrayList<>(getResidents())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5143348f1a5c64afd62b25a86af75df085ee5ec"}, "originalPosition": 129}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc62ab9a07b643c2d0ecae03aad2ad5a76942757", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/cc62ab9a07b643c2d0ecae03aad2ad5a76942757", "committedDate": "2020-07-17T01:47:27Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5316b5fa5816423a2b9ba5f60ce3e8ece1d4bf81", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/5316b5fa5816423a2b9ba5f60ce3e8ece1d4bf81", "committedDate": "2020-07-17T02:08:50Z", "message": "Remove debugging output from remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9606f94d6c95ec81a934e87eca2e5ac72278463d", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/9606f94d6c95ec81a934e87eca2e5ac72278463d", "committedDate": "2020-07-17T02:12:11Z", "message": "Clean up loops in Town.findNewMayor() methods\n\nDon't create new `ArrayList`s in the for loops of the\n`Town.findNewMayor()` methods."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNjI3NjAy", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-450627602", "createdAt": "2020-07-17T12:49:01Z", "commit": {"oid": "9606f94d6c95ec81a934e87eca2e5ac72278463d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjo0OTowMVrOGzRsoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjo0OTowMVrOGzRsoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMDUxMg==", "bodyText": "this should probably just return resident.hasTownRank(\"assistant\"); and the hasRank() method below can be scrapped. Eventually I want all of the assistant stuff removed from being hardcoded, including the saving/loading assistants in the DB.", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456420512", "createdAt": "2020-07-17T12:49:01Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -254,7 +259,12 @@ public boolean hasResident(Resident resident) {\n \n \tpublic boolean hasAssistant(Resident resident) {\n \n-\t\treturn getAssistants().contains(resident);\n+\t\treturn hasRank(resident, \"assistant\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9606f94d6c95ec81a934e87eca2e5ac72278463d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88789ef7191b8d910123e55b3d5a1d52b3d0f01a", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/88789ef7191b8d910123e55b3d5a1d52b3d0f01a", "committedDate": "2020-07-17T23:56:38Z", "message": "Merge branch 'master' into remove-mayor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b090fe7d02927f3e26f0252757cd817533daf905", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/b090fe7d02927f3e26f0252757cd817533daf905", "committedDate": "2020-07-17T23:57:51Z", "message": "Depreciate `Town.getAssistants()`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea3df36b146343b759d970e672d52a33ea9c72ad", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/ea3df36b146343b759d970e672d52a33ea9c72ad", "committedDate": "2020-07-18T00:04:53Z", "message": "Use Resident.hasTownRank() in Town.hasAssistant()\n\nSwitch from using `Town.hasRank()` to `Resident.hasTownRank()` in\n`Town.hasAssistant()`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb20ac24c5f90fcc964700766eff98cf54398eaa", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/fb20ac24c5f90fcc964700766eff98cf54398eaa", "committedDate": "2020-07-18T00:07:33Z", "message": "Remove redundant method `Town.hasRank()`\n\nThe single use of `Town.hasRank()` has already been replaced with the\npreexisting `Resident.hasTownRank()` method, which provides the same\nfunctionality."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0953fef0bc9d07024b20d47b113aa3a2253fe430", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/0953fef0bc9d07024b20d47b113aa3a2253fe430", "committedDate": "2020-07-18T00:36:26Z", "message": "Depreciate `Town.hasAssistant()`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDE2NTI3", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-451016527", "createdAt": "2020-07-18T00:52:01Z", "commit": {"oid": "0953fef0bc9d07024b20d47b113aa3a2253fe430"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMDo1MjowMVrOGzkeew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMDo1MjowMVrOGzkeew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjcyODE4Nw==", "bodyText": "When you deprecate something you need to provide information as to what version it was deprecated as well as alternative methods in the javadoc for example:\n/**\n* @deprecated Since VERSION, use {@link myNewMethod} instead.\n*\n*/\npublic void myDeprecatedMethod(){}", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#discussion_r456728187", "createdAt": "2020-07-18T00:52:01Z", "author": null, "path": "src/com/palmergames/bukkit/towny/object/Town.java", "diffHunk": "@@ -192,9 +198,10 @@ public boolean hasResident(Resident resident) {\n \t\treturn residents.contains(resident);\n \t}\n \n+\t@Deprecated\n \tpublic boolean hasAssistant(Resident resident) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0953fef0bc9d07024b20d47b113aa3a2253fe430"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b7da5dddceb3fdae695faabceaf1d4e5edc5b9", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/b1b7da5dddceb3fdae695faabceaf1d4e5edc5b9", "committedDate": "2020-07-18T01:22:31Z", "message": "Add depreciation note for Town#hasAssistantTown\n\nAdd depreciation note for `Town#hasAssistant(Resident)`."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDIwMjI2", "url": "https://github.com/TownyAdvanced/Towny/pull/4107#pullrequestreview-451020226", "createdAt": "2020-07-18T01:30:20Z", "commit": {"oid": "b1b7da5dddceb3fdae695faabceaf1d4e5edc5b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3216, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}