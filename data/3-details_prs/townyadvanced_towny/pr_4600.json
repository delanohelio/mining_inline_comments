{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxNDEyMDc3", "number": 4600, "title": "Implemented New Plot Events", "bodyText": "Description:\nAdds new plot events\n\nNew Nodes/Commands/ConfigOptions:\n\n\nRelevant Towny Issue ticket:\n\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-12-16T20:11:54Z", "url": "https://github.com/TownyAdvanced/Towny/pull/4600", "merged": true, "mergeCommit": {"oid": "4140bff3a4b1e38950d1dd4d755d919918c2f4cc"}, "closed": true, "closedAt": "2020-12-16T22:52:15Z", "author": {"login": "Kovalski4"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdm0s9sAH2gAyNTQxNDEyMDc3OjcxNzk5ZTMwYjRhMGVkN2UzMjY1Nzk4ZTU4ZWFmMzAxNzJlMTlkMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdm3Ap1gFqTU1NDE0OTc0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "71799e30b4a0ed7e3265798e58eaf30172e19d13", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/71799e30b4a0ed7e3265798e58eaf30172e19d13", "committedDate": "2020-12-16T20:10:32Z", "message": "Implemented New Plot Events"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MDkyMTEz", "url": "https://github.com/TownyAdvanced/Towny/pull/4600#pullrequestreview-554092113", "createdAt": "2020-12-16T21:18:35Z", "commit": {"oid": "71799e30b4a0ed7e3265798e58eaf30172e19d13"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQyMToxODozNVrOIHZkpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQyMToxODo0N1rOIHZlEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDYyOTkyNg==", "bodyText": "revert whitespacing change", "url": "https://github.com/TownyAdvanced/Towny/pull/4600#discussion_r544629926", "createdAt": "2020-12-16T21:18:35Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/PlotCommand.java", "diffHunk": "@@ -1111,11 +1115,17 @@ public void plotToggle(Player player, TownBlock townBlock, String[] split) {\n \t\t\t\t\t// Prevent plot pvp from being enabled if admin pvp is disabled\r\n \t\t\t\t\tif (townBlock.getTown().isAdminDisabledPVP() && !townBlock.getPermissions().pvp)\r\n \t\t\t\t\t\tthrow new TownyException(Translation.of(\"msg_err_admin_controlled_pvp_prevents_you_from_changing_pvp\", \"adminDisabledPVP\", \"on\"));\r\n-\t\t\t\t\t\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71799e30b4a0ed7e3265798e58eaf30172e19d13"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDYyOTk5MA==", "bodyText": "revert whitespacing change", "url": "https://github.com/TownyAdvanced/Towny/pull/4600#discussion_r544629990", "createdAt": "2020-12-16T21:18:42Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/PlotCommand.java", "diffHunk": "@@ -1125,20 +1135,40 @@ public void plotToggle(Player player, TownBlock townBlock, String[] split) {\n \t\t\t\t} else if (split[0].equalsIgnoreCase(\"explosion\")) {\r\n \t\t\t\t\t// Make sure we are allowed to set these permissions.\r\n \t\t\t\t\ttoggleTest(player, townBlock, StringMgmt.join(split, \" \"));\r\n+\r\n+\t\t\t\t\tPlotToggleExplosionEvent plotToggleExplosionEvent = new PlotToggleExplosionEvent(townBlock.getTown(), player, choice.orElse(!townBlock.getPermissions().explosion));\r\n+\t\t\t\t\tBukkit.getPluginManager().callEvent(plotToggleExplosionEvent);\r\n+\t\t\t\t\tif (plotToggleExplosionEvent.isCancelled()){\r\n+\t\t\t\t\t\treturn;\r\n+\t\t\t\t\t}\r\n+\r\n \t\t\t\t\ttownBlock.getPermissions().explosion = choice.orElse(!townBlock.getPermissions().explosion);\r\n \t\t\t\t\tTownyMessaging.sendMessage(player, Translation.of(\"msg_changed_expl\", \"the Plot\", townBlock.getPermissions().explosion ? Translation.of(\"enabled\") : Translation.of(\"disabled\")));\r\n \r\n \t\t\t\t} else if (split[0].equalsIgnoreCase(\"fire\")) {\r\n \t\t\t\t\t// Make sure we are allowed to set these permissions.\r\n \t\t\t\t\ttoggleTest(player, townBlock, StringMgmt.join(split, \" \"));\r\n+\r\n+\t\t\t\t\tPlotToggleFireEvent plotToggleFireEvent = new PlotToggleFireEvent(townBlock.getTown(), player, choice.orElse(!townBlock.getPermissions().fire));\r\n+\t\t\t\t\tBukkit.getPluginManager().callEvent(plotToggleFireEvent);\r\n+\t\t\t\t\tif (plotToggleFireEvent.isCancelled()){\r\n+\t\t\t\t\t\treturn;\r\n+\t\t\t\t\t}\r\n+\r\n \t\t\t\t\ttownBlock.getPermissions().fire = choice.orElse(!townBlock.getPermissions().fire);\r\n \t\t\t\t\tTownyMessaging.sendMessage(player, Translation.of(\"msg_changed_fire\", \"the Plot\", townBlock.getPermissions().fire ? Translation.of(\"enabled\") : Translation.of(\"disabled\")));\r\n \r\n \t\t\t\t} else if (split[0].equalsIgnoreCase(\"mobs\")) {\r\n \t\t\t\t\t// Make sure we are allowed to set these permissions.\r\n \t\t\t\t\ttoggleTest(player, townBlock, StringMgmt.join(split, \" \"));\r\n+\r\n+\t\t\t\t\tPlotToggleMobsEvent plotToggleMobsEvent= new PlotToggleMobsEvent(townBlock.getTown(), player, choice.orElse(!townBlock.getPermissions().mobs));\r\n+\t\t\t\t\tBukkit.getPluginManager().callEvent(plotToggleMobsEvent);\r\n+\t\t\t\t\tif (plotToggleMobsEvent.isCancelled()){\r\n+\t\t\t\t\t\treturn;\r\n+\t\t\t\t\t}\r\n+\r\n \t\t\t\t\ttownBlock.getPermissions().mobs = choice.orElse(!townBlock.getPermissions().mobs);\r\n-\t\t\t\t\t\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71799e30b4a0ed7e3265798e58eaf30172e19d13"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDYzMDAzNA==", "bodyText": "revert whitespacing change", "url": "https://github.com/TownyAdvanced/Towny/pull/4600#discussion_r544630034", "createdAt": "2020-12-16T21:18:47Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/PlotCommand.java", "diffHunk": "@@ -1155,7 +1185,7 @@ public void plotToggle(Player player, TownBlock townBlock, String[] split) {\n \t\t\t} catch (Exception e) {\r\n \t\t\t\tTownyMessaging.sendErrorMsg(player, e.getMessage());\r\n \t\t\t}\r\n-\t\t\t\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71799e30b4a0ed7e3265798e58eaf30172e19d13"}, "originalPosition": 77}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f76416a521be58bb2984393bbb0cdd16231d8ce0", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/f76416a521be58bb2984393bbb0cdd16231d8ce0", "committedDate": "2020-12-16T21:44:26Z", "message": "Revert \"Implemented New Plot Events\"\n\nThis reverts commit 71799e30"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62a6380cb6e9c80c504db8fdb52f2b1d4daff30e", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/62a6380cb6e9c80c504db8fdb52f2b1d4daff30e", "committedDate": "2020-12-16T21:52:05Z", "message": "Implemented New Plot Events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "952fe0d0133f482fde7a58a0fed5016ffa9c46d8", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/952fe0d0133f482fde7a58a0fed5016ffa9c46d8", "committedDate": "2020-12-16T21:54:15Z", "message": "Revert \"Implemented New Plot Events\"\n\nThis reverts commit 62a6380c"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25d921989ede623b1cd05dcfddd08f5ad82a40c8", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/25d921989ede623b1cd05dcfddd08f5ad82a40c8", "committedDate": "2020-12-16T21:57:21Z", "message": "Implemented New Plot Events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "284f95276bc4d0f898f8da3bd7a5126f167cf57a", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/284f95276bc4d0f898f8da3bd7a5126f167cf57a", "committedDate": "2020-12-16T21:58:28Z", "message": "Revert \"Implemented New Plot Events\"\n\nThis reverts commit 25d92198"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5b8211cf3d11f7ad6de0eadfadaafe1e694d1f5", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/f5b8211cf3d11f7ad6de0eadfadaafe1e694d1f5", "committedDate": "2020-12-16T22:04:08Z", "message": "Implemented New Plot Events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5810393c56b0bf956c2a2fe4ac1961cf2d8d6044", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/5810393c56b0bf956c2a2fe4ac1961cf2d8d6044", "committedDate": "2020-12-16T22:32:38Z", "message": "Revert \"Implemented New Plot Events\"\n\nThis reverts commit f5b8211c"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dbeaa6712b3a5bc3c4129fa679977c39329e1a6", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/4dbeaa6712b3a5bc3c4129fa679977c39329e1a6", "committedDate": "2020-12-16T22:44:07Z", "message": "Revert Implemented New Plot Events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6c29a2d4cc2afea1c8ff1eae34a52afd1c6efdd", "author": {"user": {"login": "Kovalski4", "name": "Murat YILMAZ"}}, "url": "https://github.com/TownyAdvanced/Towny/commit/c6c29a2d4cc2afea1c8ff1eae34a52afd1c6efdd", "committedDate": "2020-12-16T22:47:24Z", "message": "Implemented New Plot Events"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MTQ5NzQz", "url": "https://github.com/TownyAdvanced/Towny/pull/4600#pullrequestreview-554149743", "createdAt": "2020-12-16T22:51:51Z", "commit": {"oid": "c6c29a2d4cc2afea1c8ff1eae34a52afd1c6efdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4156, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}