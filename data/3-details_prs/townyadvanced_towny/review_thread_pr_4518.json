{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxODM3NzA2", "number": 4518, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNTo0ODo1M1rOFAUoLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0MDowNFrOFAWQkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1ODgyMjg0OnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNTo0ODo1M1rOH-jXow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjoxOToyNlrOH-k55Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1MzI1MQ==", "bodyText": "If I'm not mistaken this will result in the msg_reclaim_available message being show in situations where getTownsRuinsReclaimEnabled is not true...", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535353251", "createdAt": "2020-12-03T15:48:53Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "diffHunk": "@@ -378,11 +378,12 @@ private static void getRanks(Town town, List<String> ranklist) {\n \r\n \t\tif (town.isRuined()) {\r\n \t\t\tout.add(Translation.of(\"msg_time_remaining_before_full_removal\", TownRuinSettings.getTownRuinsMaxDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()) {\r\n-\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours())\r\n-\t\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\t\telse \r\n-\t\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r\n+\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()\r\n+\t\t\t\t\t&& TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours()) {\r\n+\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n+\t\t\t}\r\n+\t\t\telse {\r\n+\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM3ODQwNQ==", "bodyText": "Ah, yeah... This one is human error on my part. Linter never complained about this one. Should be resolved with next commit.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535378405", "createdAt": "2020-12-03T16:19:26Z", "author": {"login": "TheFlagCourier"}, "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "diffHunk": "@@ -378,11 +378,12 @@ private static void getRanks(Town town, List<String> ranklist) {\n \r\n \t\tif (town.isRuined()) {\r\n \t\t\tout.add(Translation.of(\"msg_time_remaining_before_full_removal\", TownRuinSettings.getTownRuinsMaxDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()) {\r\n-\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours())\r\n-\t\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\t\telse \r\n-\t\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r\n+\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()\r\n+\t\t\t\t\t&& TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours()) {\r\n+\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n+\t\t\t}\r\n+\t\t\telse {\r\n+\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1MzI1MQ=="}, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1ODgzNDY0OnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNTo1MDozOFrOH-jfSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjozOToyMFrOH-l24g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1NTIwOA==", "bodyText": "Because the getTown() is hidden behind a hasTown() we know we can ignore this.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535355208", "createdAt": "2020-12-03T15:50:38Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "diffHunk": "@@ -47,7 +50,9 @@ public static boolean isPlayersTownRuined(Player player) {\n \t\t\tif(resident.hasTown() && resident.getTown().isRuined())\n \t\t\t\treturn true;\n \t\t\t\n-\t\t} catch (NotRegisteredException ignored) {}\n+\t\t} catch (NotRegisteredException ignored) {\n+\t\t\t// Ignored - Maybe add to a debug logger later?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM4NTU5NQ==", "bodyText": "While this is true, there's also the possibility of getResident() throwing the NotRegisteredException. As this is a public method, it's accessible to other plugins, so actually giving them something to work with is probably the better course of action, is it not?", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535385595", "createdAt": "2020-12-03T16:28:33Z", "author": {"login": "TheFlagCourier"}, "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "diffHunk": "@@ -47,7 +50,9 @@ public static boolean isPlayersTownRuined(Player player) {\n \t\t\tif(resident.hasTown() && resident.getTown().isRuined())\n \t\t\t\treturn true;\n \t\t\t\n-\t\t} catch (NotRegisteredException ignored) {}\n+\t\t} catch (NotRegisteredException ignored) {\n+\t\t\t// Ignored - Maybe add to a debug logger later?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1NTIwOA=="}, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5NDAxOA==", "bodyText": "That's valid, I believe this would also end up being sorted out with @silverwolfg11 's resident UUID map PR as well, depending on what was accepted first.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535394018", "createdAt": "2020-12-03T16:39:20Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "diffHunk": "@@ -47,7 +50,9 @@ public static boolean isPlayersTownRuined(Player player) {\n \t\t\tif(resident.hasTown() && resident.getTown().isRuined())\n \t\t\t\treturn true;\n \t\t\t\n-\t\t} catch (NotRegisteredException ignored) {}\n+\t\t} catch (NotRegisteredException ignored) {\n+\t\t\t// Ignored - Maybe add to a debug logger later?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1NTIwOA=="}, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1ODg2MDQwOnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNTo1NToxNVrOH-julQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjoyOToyNFrOH-lYoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1OTEyNQ==", "bodyText": "Please re-add the TODO: on this, so that it gets dealt with later on.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535359125", "createdAt": "2020-12-03T15:55:15Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "diffHunk": "@@ -160,10 +157,17 @@ public static void processRuinedTownReclaimRequest(Player player, Towny plugin)\n \t\t\tBukkit.getPluginManager().callEvent(event);\n \n \t\t\tTownyMessaging.sendGlobalMessage(Translation.of(\"msg_town_reclaimed\", resident.getName(), town.getName()));\n-\t\t} catch (TownyException e) {\n+\t\t} catch (TownyException | EconomyException e) {\n \t\t\tTownyMessaging.sendErrorMsg(player,e.getMessage());\n-\t\t} catch (EconomyException ex) {\n-\t\t\tTownyMessaging.sendErrorMsg(player,ex.getMessage());\n+\t\t}\n+\t}\n+\n+\tprivate static void setMayor(Towny plugin, Town town, String name) {\n+\t\ttry {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM4NjI3Mw==", "bodyText": "Will do.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535386273", "createdAt": "2020-12-03T16:29:24Z", "author": {"login": "TheFlagCourier"}, "path": "src/com/palmergames/bukkit/towny/war/common/townruin/TownRuinUtil.java", "diffHunk": "@@ -160,10 +157,17 @@ public static void processRuinedTownReclaimRequest(Player player, Towny plugin)\n \t\t\tBukkit.getPluginManager().callEvent(event);\n \n \t\t\tTownyMessaging.sendGlobalMessage(Translation.of(\"msg_town_reclaimed\", resident.getName(), town.getName()));\n-\t\t} catch (TownyException e) {\n+\t\t} catch (TownyException | EconomyException e) {\n \t\t\tTownyMessaging.sendErrorMsg(player,e.getMessage());\n-\t\t} catch (EconomyException ex) {\n-\t\t\tTownyMessaging.sendErrorMsg(player,ex.getMessage());\n+\t\t}\n+\t}\n+\n+\tprivate static void setMayor(Towny plugin, Town town, String name) {\n+\t\ttry {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM1OTEyNQ=="}, "originalCommit": {"oid": "9c1f072cd0cfa7f9b5b1dbba29a2037fad0be412"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTA5MDExOnYy", "diffSide": "RIGHT", "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0MDowNVrOH-l5qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo1NDowNFrOH-mtbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5NDczMA==", "bodyText": "This can be replaced by the master branch entirely now.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535394730", "createdAt": "2020-12-03T16:40:05Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "diffHunk": "@@ -378,11 +378,13 @@ private static void getRanks(Town town, List<String> ranklist) {\n \r\n \t\tif (town.isRuined()) {\r\n \t\t\tout.add(Translation.of(\"msg_time_remaining_before_full_removal\", TownRuinSettings.getTownRuinsMaxDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()) {\r\n-\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours())\r\n+\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()){\r\n+\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours()) {\r\n \t\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\t\telse \r\n+\t\t\t\t}\r\n+\t\t\t\telse {\r\n \t\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r\n+\t\t\t\t}\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cda64d79e357f32a42d79ea749a682a11cd0475b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQwNzk4MA==", "bodyText": "Ah, yeah.", "url": "https://github.com/TownyAdvanced/Towny/pull/4518#discussion_r535407980", "createdAt": "2020-12-03T16:54:04Z", "author": {"login": "TheFlagCourier"}, "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "diffHunk": "@@ -378,11 +378,13 @@ private static void getRanks(Town town, List<String> ranklist) {\n \r\n \t\tif (town.isRuined()) {\r\n \t\t\tout.add(Translation.of(\"msg_time_remaining_before_full_removal\", TownRuinSettings.getTownRuinsMaxDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()) {\r\n-\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours())\r\n+\t\t\tif (TownRuinSettings.getTownRuinsReclaimEnabled()){\r\n+\t\t\t\tif (TownRuinUtil.getTimeSinceRuining(town) < TownRuinSettings.getTownRuinsMinDurationHours()) {\r\n \t\t\t\t\tout.add(Translation.of(\"msg_time_until_reclaim_available\", TownRuinSettings.getTownRuinsMinDurationHours() - TownRuinUtil.getTimeSinceRuining(town)));\r\n-\t\t\t\telse \r\n+\t\t\t\t}\r\n+\t\t\t\telse {\r\n \t\t\t\t\tout.add(Translation.of(\"msg_reclaim_available\"));\r\n+\t\t\t\t}\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5NDczMA=="}, "originalCommit": {"oid": "cda64d79e357f32a42d79ea749a682a11cd0475b"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1199, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}