{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3ODk3NDIy", "number": 3946, "title": "Allow line length > 54", "bodyText": "Description:\n\nThis removes the forced split of messages at line length > 54 due to restrictions from years ago. Luckily for us we don't need to do this anymore as the API handles it now. There were a few more things that I wanted to cleanup, but I think I'll save them for another PR as they are a little out of scope for this one.\nBefore:\n\nAfter:\n\n\nNew Nodes/Commands/ConfigOptions:\n\n\nRelevant Towny Issue ticket:\n\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-04-23T12:55:19Z", "url": "https://github.com/TownyAdvanced/Towny/pull/3946", "merged": true, "mergeCommit": {"oid": "c6250badbd1d4969aa3f175c1a6bfd37367a29dd"}, "closed": true, "closedAt": "2020-04-28T13:02:22Z", "author": null, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZp5zbAH2gAyNDA3ODk3NDIyOmVkYTBjOGZjNDA0YWUzYjFmMzc2MDAwYTBhOWViOWVmNDM2NGJlZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbLE1-gFqTQwMDQyMzM3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eda0c8fc404ae3b1f376000a0a9eb9ef4364beee", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/eda0c8fc404ae3b1f376000a0a9eb9ef4364beee", "committedDate": "2020-04-21T02:03:26Z", "message": "Make confirmations slightly more configurable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d2a3817af2dfdeb9aecc5a421d4b27abf3520fe", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/3d2a3817af2dfdeb9aecc5a421d4b27abf3520fe", "committedDate": "2020-04-21T02:46:21Z", "message": "Why are there two...?"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb53fea0bd7d32df68ee22606f4e4819ec4ae008", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/bb53fea0bd7d32df68ee22606f4e4819ec4ae008", "committedDate": "2020-04-21T17:07:38Z", "message": "Introduce customizable confirmation/invitation prefixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8af438a057c90f7de385cfa0ef8438471cc4031b", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/8af438a057c90f7de385cfa0ef8438471cc4031b", "committedDate": "2020-04-22T20:07:34Z", "message": "Merge branch 'master' of https://github.com/TownyAdvanced/Towny\n\n\u0001 Conflicts:\n\u0001\tresources/english.yml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a89b902fd0467a586459897de66541a1529bf17", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/9a89b902fd0467a586459897de66541a1529bf17", "committedDate": "2020-04-23T02:58:37Z", "message": "First pass at removing the 54 char restriction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03c076e293ca02203ef7e43b86cb9e1873ffcce4", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/03c076e293ca02203ef7e43b86cb9e1873ffcce4", "committedDate": "2020-04-23T12:35:15Z", "message": "Cleanup and fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/3960a83b57fd73733e1bfcc0f683f55a9780bbee", "committedDate": "2020-04-23T13:12:22Z", "message": "Small mistake"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MTM0OTE4", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399134918", "createdAt": "2020-04-23T14:09:00Z", "commit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNDowOTowMVrOGKqAUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNToxOTozNlrOGKtyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzgyNzE1Mw==", "bodyText": "This is an error message and has to be forced red as otherwise we'd have to prefix all the err_msg's in the lang files with colour codes.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413827153", "createdAt": "2020-04-23T14:09:01Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -47,22 +49,19 @@ public static void sendErrorMsg(String msg) {\n \t * @param msg the message to send\r\n \t */\r\n \tpublic static void sendErrorMsg(Object sender, String msg) {\r\n-\t\tboolean isPlayer = false;\r\n+\t\t// todo: maybe check if it's already colored to avoid forcing red?\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzgzMjIyOA==", "bodyText": "Just an fyi we don't have any of this { return; } going on in the code. I would appreciate if you did\nif (p == null)\n   return;\n\nTo be more uniform with the rest of the code.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413832228", "createdAt": "2020-04-23T14:14:46Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -108,22 +99,30 @@ public static void sendMsg(String msg) {\n \t * @param msg the message being sent\r\n \t */\r\n \tpublic static void sendMsg(Object sender, String msg) {\r\n-\t\tfor (String line : ChatTools.color(TownySettings.getLangString(\"default_towny_prefix\") + Colors.Green + msg)) {\r\n-\t\t\tif (sender instanceof Player) {\r\n-\t\t\t\t((Player) sender).sendMessage(line);\r\n-\t\t\t} else if (sender instanceof CommandSender) {\r\n-\t\t\t\t((CommandSender) sender).sendMessage(Colors.strip(line));\r\n-\t\t\t} else if (sender instanceof Resident) {\r\n-\t\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n-\t\t\t\tif (p == null) {\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n-\t\t\t}\r\n+\t\t// todo: maybe check if it's already colored to avoid forcing green?\r\n+\t\t// I don't fully understand the reason for the Resident check but I don't want to break something so...\r\n+\t\tif (sender instanceof Resident) {\r\n+\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n+\t\t\tif (p == null) { return; }\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MDYzNg==", "bodyText": "I am also not quite sure that the resident is supposed to have the colour stripped. As all the sendMsg should be green.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413840636", "createdAt": "2020-04-23T14:24:24Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -108,22 +99,30 @@ public static void sendMsg(String msg) {\n \t * @param msg the message being sent\r\n \t */\r\n \tpublic static void sendMsg(Object sender, String msg) {\r\n-\t\tfor (String line : ChatTools.color(TownySettings.getLangString(\"default_towny_prefix\") + Colors.Green + msg)) {\r\n-\t\t\tif (sender instanceof Player) {\r\n-\t\t\t\t((Player) sender).sendMessage(line);\r\n-\t\t\t} else if (sender instanceof CommandSender) {\r\n-\t\t\t\t((CommandSender) sender).sendMessage(Colors.strip(line));\r\n-\t\t\t} else if (sender instanceof Resident) {\r\n-\t\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n-\t\t\t\tif (p == null) {\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n-\t\t\t}\r\n+\t\t// todo: maybe check if it's already colored to avoid forcing green?\r\n+\t\t// I don't fully understand the reason for the Resident check but I don't want to break something so...\r\n+\t\tif (sender instanceof Resident) {\r\n+\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n+\t\t\tif (p == null) { return; }\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzgzMjIyOA=="}, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MzM3MA==", "bodyText": "This one is not meant to be prefixed.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413843370", "createdAt": "2020-04-23T14:27:30Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -252,7 +246,7 @@ public static void sendMessage(Object sender, String[] lines) {\n \t\t\t\tif (p == null) {\r\n \t\t\t\t\treturn;\r\n \t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n+\t\t\t\tp.sendMessage(PREFIX + Colors.strip(line));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 161}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg1NTMxMQ==", "bodyText": "I am not entirely sure why you changed out from using ChatTools.list() throughout this file, as you've already removed the wordwrap and color methods from ChatTools which would have been causing an issue. What you've replaced it with, to me, is less readable. Can you explain if this was necessary?", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413855311", "createdAt": "2020-04-23T14:41:13Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/tasks/DailyTimerTask.java", "diffHunk": "@@ -231,9 +231,9 @@ protected void collectNationTaxes(Nation nation) throws EconomyException {\n \t\t\t}\r\n \t\t\tif (localRemovedTowns != null) {\r\n \t\t\t\tif (localRemovedTowns.size() == 1) \r\n-\t\t\t\t\tTownyMessaging.sendNationMessagePrefixed(nation, String.format(TownySettings.getLangString(\"msg_couldnt_pay_tax\"), ChatTools.list(localRemovedTowns), \"nation\"));\r\n+\t\t\t\t\tTownyMessaging.sendNationMessagePrefixed(nation, String.format(\"%s%s%s\", TownySettings.getLangString(\"msg_couldnt_pay_tax\"), String.join(\", \", localRemovedTowns), \"nation\"));\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg1NTg4Ng==", "bodyText": "Unused import?", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413855886", "createdAt": "2020-04-23T14:41:49Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/util/ChatTools.java", "diffHunk": "@@ -1,5 +1,7 @@\n package com.palmergames.bukkit.util;\n \n+import org.bukkit.ChatColor;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg4OTA3Mg==", "bodyText": "Unused import?", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413889072", "createdAt": "2020-04-23T15:19:36Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/TownyFormatter.java", "diffHunk": "@@ -20,6 +20,7 @@\n import com.palmergames.bukkit.util.ChatTools;\r\n import com.palmergames.bukkit.util.Colors;\r\n import com.palmergames.util.StringMgmt;\r\n+import org.bukkit.ChatColor;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3960a83b57fd73733e1bfcc0f683f55a9780bbee"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3356874ff7ec37a47505f7e503fd7eda1dd73885", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/3356874ff7ec37a47505f7e503fd7eda1dd73885", "committedDate": "2020-04-23T15:50:09Z", "message": "Removed unused imports and reverted edits to DailyTimerTask"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MjU1Mjgz", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399255283", "createdAt": "2020-04-23T16:09:19Z", "commit": {"oid": "3356874ff7ec37a47505f7e503fd7eda1dd73885"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjowOToxOVrOGKwPLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjoxMDowNFrOGKwRoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzkyOTI2Mw==", "bodyText": "Three changes to this file should probably be reverted, otherwise we're not getting a nice \"name, name, name\" list.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413929263", "createdAt": "2020-04-23T16:09:19Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/ResidentCommand.java", "diffHunk": "@@ -464,7 +464,7 @@ else if (resident.isMayor())\n \t\t\t\tformatedList.add(colour + resident.getName() + Colors.White);\r\n \t\t\t}\r\n \t\t}\r\n-\t\tfor (String line : ChatTools.list(formatedList))\r\n+\t\tfor (String line : formatedList)\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3356874ff7ec37a47505f7e503fd7eda1dd73885"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzkyOTg4OQ==", "bodyText": "All of the changes to this file can be reverted except for this one.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413929889", "createdAt": "2020-04-23T16:10:04Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/tasks/DailyTimerTask.java", "diffHunk": "@@ -493,8 +493,8 @@ public void collectNationCosts() throws EconomyException {\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\r\n-\t\tif (removedNations != null) {\r\n-\t\t\tif (removedNations.size() == 1) \r\n+\t\tif (removedNations != null && !removedNations.isEmpty()) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3356874ff7ec37a47505f7e503fd7eda1dd73885"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/e0ad723dc5bf7e3e6723ece81f8b04123c303005", "committedDate": "2020-04-23T16:42:22Z", "message": "Revert more changes except for empty col check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5Mjg3Njc3", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399287677", "createdAt": "2020-04-23T16:47:12Z", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo0NzoxM1rOGKx-0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo0NzoxM1rOGKx-0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk1Nzg0Mg==", "bodyText": "If the above if-statement passes, then this if-statement will always be false. Thus you can use an else-if here or you could move this if-statement above the previous one and use an else-if on the previous one.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413957842", "createdAt": "2020-04-23T16:47:13Z", "author": {"login": "silverwolfg11"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -47,22 +49,18 @@ public static void sendErrorMsg(String msg) {\n \t * @param msg the message to send\r\n \t */\r\n \tpublic static void sendErrorMsg(Object sender, String msg) {\r\n-\t\tboolean isPlayer = false;\r\n \t\tif (sender instanceof Player) {\r\n-\t\t\tisPlayer = true;\r\n+\t\t\t((Player) sender).sendMessage(PREFIX + ChatColor.RED + msg);\r\n \t\t}\r\n \r\n+\t\tif (sender instanceof ConsoleCommandSender) {\r\n+\t\t\t((ConsoleCommandSender) sender).sendMessage(PREFIX + ChatColor.stripColor(msg));\r\n+\t\t}\r\n+\t\t\r\n \t\tif (sender == null) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MjkxNDIx", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399291421", "createdAt": "2020-04-23T16:51:42Z", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1MTo0MlrOGKyLLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1MTo0MlrOGKyLLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk2MTAwNQ==", "bodyText": "This if-statement call is highly unlikely (but still valid). However, I wouldn't return on null (bad, in this instance, for control flow and you would skip the dev message) and would instead use a simple != null check", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413961005", "createdAt": "2020-04-23T16:51:42Z", "author": {"login": "silverwolfg11"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -108,22 +98,30 @@ public static void sendMsg(String msg) {\n \t * @param msg the message being sent\r\n \t */\r\n \tpublic static void sendMsg(Object sender, String msg) {\r\n-\t\tfor (String line : ChatTools.color(TownySettings.getLangString(\"default_towny_prefix\") + Colors.Green + msg)) {\r\n-\t\t\tif (sender instanceof Player) {\r\n-\t\t\t\t((Player) sender).sendMessage(line);\r\n-\t\t\t} else if (sender instanceof CommandSender) {\r\n-\t\t\t\t((CommandSender) sender).sendMessage(Colors.strip(line));\r\n-\t\t\t} else if (sender instanceof Resident) {\r\n-\t\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n-\t\t\t\tif (p == null) {\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n-\t\t\t}\r\n+\t\t// I don't fully understand the reason for the Resident check but I don't want to break something so...\r\n+\t\tif (sender instanceof Resident) {\r\n+\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n+\t\t\tif (p == null)\r\n+\t\t\t\treturn;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "originalPosition": 85}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MjkyMzYy", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399292362", "createdAt": "2020-04-23T16:52:51Z", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1Mjo1MVrOGKyOMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1Mjo1MVrOGKyOMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk2MTc3Nw==", "bodyText": "All of these if-statements, are mutually exclusive so they can be prefixed with an else if", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413961777", "createdAt": "2020-04-23T16:52:51Z", "author": {"login": "silverwolfg11"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -108,22 +98,30 @@ public static void sendMsg(String msg) {\n \t * @param msg the message being sent\r\n \t */\r\n \tpublic static void sendMsg(Object sender, String msg) {\r\n-\t\tfor (String line : ChatTools.color(TownySettings.getLangString(\"default_towny_prefix\") + Colors.Green + msg)) {\r\n-\t\t\tif (sender instanceof Player) {\r\n-\t\t\t\t((Player) sender).sendMessage(line);\r\n-\t\t\t} else if (sender instanceof CommandSender) {\r\n-\t\t\t\t((CommandSender) sender).sendMessage(Colors.strip(line));\r\n-\t\t\t} else if (sender instanceof Resident) {\r\n-\t\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n-\t\t\t\tif (p == null) {\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n-\t\t\t}\r\n+\t\t// I don't fully understand the reason for the Resident check but I don't want to break something so...\r\n+\t\tif (sender instanceof Resident) {\r\n+\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n+\t\t\tif (p == null)\r\n+\t\t\t\treturn;\r\n+\t\t\tp.sendMessage(PREFIX + ChatColor.GREEN + msg);\r\n+\t\t}\r\n+\t\t\r\n+\t\tif (sender instanceof Player) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "originalPosition": 89}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MjkzOTkx", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399293991", "createdAt": "2020-04-23T16:54:52Z", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1NDo1MlrOGKyTxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1NDo1MlrOGKyTxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk2MzIwNg==", "bodyText": "Use this is as probably the last else statement (if you use else-ifs above). Also do not use system.out, use TownyMessaging instead, and probably with Invalid sender instead of null sender if you chose to do the else-ifs.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413963206", "createdAt": "2020-04-23T16:54:52Z", "author": {"login": "silverwolfg11"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -108,22 +98,30 @@ public static void sendMsg(String msg) {\n \t * @param msg the message being sent\r\n \t */\r\n \tpublic static void sendMsg(Object sender, String msg) {\r\n-\t\tfor (String line : ChatTools.color(TownySettings.getLangString(\"default_towny_prefix\") + Colors.Green + msg)) {\r\n-\t\t\tif (sender instanceof Player) {\r\n-\t\t\t\t((Player) sender).sendMessage(line);\r\n-\t\t\t} else if (sender instanceof CommandSender) {\r\n-\t\t\t\t((CommandSender) sender).sendMessage(Colors.strip(line));\r\n-\t\t\t} else if (sender instanceof Resident) {\r\n-\t\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n-\t\t\t\tif (p == null) {\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\t\t\t\tp.sendMessage(Colors.strip(line));\r\n-\t\t\t}\r\n+\t\t// I don't fully understand the reason for the Resident check but I don't want to break something so...\r\n+\t\tif (sender instanceof Resident) {\r\n+\t\t\tPlayer p = TownyAPI.getInstance().getPlayer((Resident) sender);\r\n+\t\t\tif (p == null)\r\n+\t\t\t\treturn;\r\n+\t\t\tp.sendMessage(PREFIX + ChatColor.GREEN + msg);\r\n+\t\t}\r\n+\t\t\r\n+\t\tif (sender instanceof Player) {\r\n+\t\t\t((Player) sender).sendMessage(PREFIX + ChatColor.GREEN + msg);\r\n+\t\t}\r\n+\r\n+\t\tif (sender instanceof ConsoleCommandSender) {\r\n+\t\t\t((ConsoleCommandSender) sender).sendMessage(PREFIX + ChatColor.stripColor(msg));\r\n+\t\t}\r\n+\r\n+\t\tif (sender == null) {\r\n+\t\t\tSystem.out.print(\"Message called with null sender\");\r\n \t\t}\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "originalPosition": 99}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5Mjk0OTc1", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-399294975", "createdAt": "2020-04-23T16:56:04Z", "commit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1NjowNFrOGKyXMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjo1NjowNFrOGKyXMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk2NDA4Mw==", "bodyText": "This would be really convenient to have, however, it prevents changing the prefix on language file reload.", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#discussion_r413964083", "createdAt": "2020-04-23T16:56:04Z", "author": {"login": "silverwolfg11"}, "path": "src/com/palmergames/bukkit/towny/TownyMessaging.java", "diffHunk": "@@ -28,6 +29,7 @@\n public class TownyMessaging {\r\n \tprivate static final Logger LOGGER = LogManager.getLogger(Towny.class);\r\n \tprivate static final Logger LOGGER_DEBUG = LogManager.getLogger(\"com.palmergames.bukkit.towny.debug\");\r\n+\tprivate static final String PREFIX = TownySettings.getLangString(\"default_towny_prefix\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ad723dc5bf7e3e6723ece81f8b04123c303005"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef3c7202997e7d26ee1a897ce7bd2d32c08a104b", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/ef3c7202997e7d26ee1a897ce7bd2d32c08a104b", "committedDate": "2020-04-23T17:41:07Z", "message": "By request, removed static prefix, refactored message sending"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b18ae82435a1b6cd2a98dc8d57b12a3d93b86977", "author": {"user": null}, "url": "https://github.com/TownyAdvanced/Towny/commit/b18ae82435a1b6cd2a98dc8d57b12a3d93b86977", "committedDate": "2020-04-23T17:43:12Z", "message": "Removed unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDIzMzc3", "url": "https://github.com/TownyAdvanced/Towny/pull/3946#pullrequestreview-400423377", "createdAt": "2020-04-25T19:16:17Z", "commit": {"oid": "b18ae82435a1b6cd2a98dc8d57b12a3d93b86977"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4277, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}