{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyNTYxNTE2", "number": 4519, "title": "Adds NationRankRemoveEvent and NationRankAddEvent", "bodyText": "Description:\n\nAdds NationRankAddEvent and NationRankRemoveEvent to the API which is useful for some war systems or just API use in general.\n\nNew Nodes/Commands/ConfigOptions:\n\n\nRelevant Towny Issue ticket:\n\n\n\n I have tested this pull request for defects on a server.\n\n\nBy making this pull request, I represent that I have the right to waive copyright and related rights to my contribution, and agree that all copyright and related rights in my contributions are waived, and I acknowledge that the TownyAdvanced organization has the copyright to use and modify my contribution under the Towny License for perpetuity.", "createdAt": "2020-12-04T14:15:44Z", "url": "https://github.com/TownyAdvanced/Towny/pull/4519", "merged": true, "mergeCommit": {"oid": "06e561bbdb49204dd95df1bee259a8e879098d56"}, "closed": true, "closedAt": "2020-12-04T17:03:32Z", "author": {"login": "ceeedric"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi4ZGzAH2gAyNTMyNTYxNTE2OjQwYWEzYWQwZjUxYWJiMzU1MzVkYzAzNjdiN2JjMDE0NWUxYjhkOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi55OKgFqTU0NTA4NDA3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "40aa3ad0f51abb35535dc0367b7bc0145e1b8d90", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/40aa3ad0f51abb35535dc0367b7bc0145e1b8d90", "committedDate": "2020-12-04T14:12:46Z", "message": "Adds NationRankRemoveEvent and NationRankAddEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf56abec468ac49fead0399162e9e01c7fc98634", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/cf56abec468ac49fead0399162e9e01c7fc98634", "committedDate": "2020-12-04T14:16:47Z", "message": "adding new line at the end of the event classes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0OTk5NzA3", "url": "https://github.com/TownyAdvanced/Towny/pull/4519#pullrequestreview-544999707", "createdAt": "2020-12-04T14:21:54Z", "commit": {"oid": "cf56abec468ac49fead0399162e9e01c7fc98634"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNDoyMTo1NVrOH_S_Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNDoyNDozNVrOH_TGiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEzMzQ2Mg==", "bodyText": "This should have been done to line 958.", "url": "https://github.com/TownyAdvanced/Towny/pull/4519#discussion_r536133462", "createdAt": "2020-12-04T14:21:55Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/command/NationCommand.java", "diffHunk": "@@ -954,11 +960,20 @@ public void nationRank(Player player, String[] split) throws TownyException {\n \t\t\t\t\t}\r\n \t\t\t\t} catch (AlreadyRegisteredException e) {\r\n \t\t\t\t\t// Must already have this rank\r\n-\t\t\t\t\tTownyMessaging.sendMsg(player, Translation.of(\"msg_resident_already_has_rank\", target.getName(), \"Nation\"));\r\n+\t\t\t\t\tTownyMessaging.sendMsg(player, nationRankAddEvent.getCancelMessage());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf56abec468ac49fead0399162e9e01c7fc98634"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEzNTMwNA==", "bodyText": "The cancelMessage should be Translation.of(\"msg_resident_not_part_of_any_town\") which can be set directly on line 18.", "url": "https://github.com/TownyAdvanced/Towny/pull/4519#discussion_r536135304", "createdAt": "2020-12-04T14:24:35Z", "author": {"login": "LlmDl"}, "path": "src/com/palmergames/bukkit/towny/event/NationRankAddEvent.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.palmergames.bukkit.towny.event;\n+\n+import com.palmergames.bukkit.towny.object.Nation;\n+import com.palmergames.bukkit.towny.object.Resident;\n+import com.palmergames.bukkit.towny.object.Translation;\n+import org.bukkit.event.Cancellable;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+public class NationRankAddEvent extends Event implements Cancellable {\n+\n+\tprivate static final HandlerList handlers = new HandlerList();\n+\n+\tprivate final Nation nation;\n+\tprivate final Resident res;\n+\tprivate final String rank;\n+\tprivate boolean isCancelled = false;\n+\tprivate String cancelMessage;\n+\n+\tpublic NationRankAddEvent(Nation nation, String rank, Resident res) {\n+\t\tthis.nation = nation;\n+\t\tthis.rank = rank;\n+\t\tthis.res = res;\n+\t\tthis.cancelMessage = Translation.of(\"msg_resident_already_has_rank\", res.getName(), \"Nation\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf56abec468ac49fead0399162e9e01c7fc98634"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "655c967031229fcfc1716e47f3a6bfa21b5c3ef7", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/655c967031229fcfc1716e47f3a6bfa21b5c3ef7", "committedDate": "2020-12-04T14:28:49Z", "message": "adding new line at the end of the event classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baa4a5d847f21530b3d7e22fa0698a30d1951e8b", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/baa4a5d847f21530b3d7e22fa0698a30d1951e8b", "committedDate": "2020-12-04T14:34:27Z", "message": "Fixes up cancel message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1d2a010ab3acc1333302a535a8d31de1c44a5ad", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/e1d2a010ab3acc1333302a535a8d31de1c44a5ad", "committedDate": "2020-12-04T14:47:52Z", "message": "Fixes people actually getting the rank"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edfc18dd8f974e27d7b8984d4fefb45f88bafb46", "author": {"user": {"login": "ceeedric", "name": null}}, "url": "https://github.com/TownyAdvanced/Towny/commit/edfc18dd8f974e27d7b8984d4fefb45f88bafb46", "committedDate": "2020-12-04T15:34:23Z", "message": "moving events to nation package"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MDg0MDcx", "url": "https://github.com/TownyAdvanced/Towny/pull/4519#pullrequestreview-545084071", "createdAt": "2020-12-04T15:57:45Z", "commit": {"oid": "edfc18dd8f974e27d7b8984d4fefb45f88bafb46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4148, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}