{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczOTU0MTU1", "number": 1741, "title": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from t\u2026", "bodyText": "Jira:\nhttps://issues.redhat.com/browse/JBPM-9310", "createdAt": "2020-08-26T14:39:47Z", "url": "https://github.com/kiegroup/jbpm/pull/1741", "merged": true, "mergeCommit": {"oid": "bb01c4d1229e637f86d219c068ea459407f00554"}, "closed": true, "closedAt": "2020-09-07T09:47:35Z", "author": {"login": "elguardian"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC7OGYgBqjM2OTgxMjk0NjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFl2gogFqTQ4MjY4NjM1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6cc5c3fbd357d78f25d722b5534391de53701cf4", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/6cc5c3fbd357d78f25d722b5534391de53701cf4", "committedDate": "2020-08-26T14:38:10Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "082b769fc85295ef5544a87ae8018daaedfa6f42", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/082b769fc85295ef5544a87ae8018daaedfa6f42", "committedDate": "2020-08-27T07:24:37Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "082b769fc85295ef5544a87ae8018daaedfa6f42", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/082b769fc85295ef5544a87ae8018daaedfa6f42", "committedDate": "2020-08-27T07:24:37Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "7f4a38cd0ccfdcb5286803edc07974e1227f25ba", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/7f4a38cd0ccfdcb5286803edc07974e1227f25ba", "committedDate": "2020-08-27T09:50:02Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f4a38cd0ccfdcb5286803edc07974e1227f25ba", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/7f4a38cd0ccfdcb5286803edc07974e1227f25ba", "committedDate": "2020-08-27T09:50:02Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "de5a7fa07f62d0607a93f9692c04c905090f2158", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/de5a7fa07f62d0607a93f9692c04c905090f2158", "committedDate": "2020-08-28T07:42:55Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de5a7fa07f62d0607a93f9692c04c905090f2158", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/de5a7fa07f62d0607a93f9692c04c905090f2158", "committedDate": "2020-08-28T07:42:55Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "881b840b1a63dc908ad0f023a9f2e818426ad752", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/881b840b1a63dc908ad0f023a9f2e818426ad752", "committedDate": "2020-08-28T14:10:23Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "881b840b1a63dc908ad0f023a9f2e818426ad752", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/881b840b1a63dc908ad0f023a9f2e818426ad752", "committedDate": "2020-08-28T14:10:23Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "045277f82de8625b025eb87aac38557b364a8d64", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/045277f82de8625b025eb87aac38557b364a8d64", "committedDate": "2020-08-31T07:00:12Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "045277f82de8625b025eb87aac38557b364a8d64", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/045277f82de8625b025eb87aac38557b364a8d64", "committedDate": "2020-08-31T07:00:12Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/c20cffa0a939e8287b17d45bc73dd465051ec21e", "committedDate": "2020-09-01T07:45:01Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNTM1ODE5", "url": "https://github.com/kiegroup/jbpm/pull/1741#pullrequestreview-480535819", "createdAt": "2020-09-02T07:02:07Z", "commit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNzowMjowN1rOHLfTKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNzoxMzo1OVrOHLf3bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTgwOTE5NA==", "bodyText": "Arrays.asList().stream() can be replaced with Arrays.stream() and method reference can be used in lambda\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        descriptorHierarchy.addAll(asList(presets).stream().filter(e -> e != null).collect(toList()));\n          \n          \n            \n                        descriptorHierarchy.addAll(Arrays.stream(presets).filter(Objects::nonNull).collect(toList()));", "url": "https://github.com/kiegroup/jbpm/pull/1741#discussion_r481809194", "createdAt": "2020-09-02T07:02:07Z", "author": {"login": "afalhambra"}, "path": "jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/deploy/DeploymentDescriptorManagerUtil.java", "diffHunk": "@@ -35,6 +40,30 @@\n \n     private static final Logger logger = LoggerFactory.getLogger(DeploymentDescriptorManagerUtil.class);\n \n+    /**\n+     * This creates a deployment descriptor\n+     * @param manager\n+     * @param kieContainer\n+     * @param presets\n+     * @return\n+     */\n+    public static DeploymentDescriptor getDeploymentDescriptor(DeploymentDescriptorManager manager, KieContainer kieContainer, MergeMode mode, DeploymentDescriptor ...presets) {\n+        List<DeploymentDescriptor> descriptorHierarchy = new ArrayList<DeploymentDescriptor>();\n+        \n+\n+        if(presets != null) {\n+            descriptorHierarchy.addAll(asList(presets).stream().filter(e -> e != null).collect(toList()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTgxMDEwNg==", "bodyText": "Not used. Please remove", "url": "https://github.com/kiegroup/jbpm/pull/1741#discussion_r481810106", "createdAt": "2020-09-02T07:03:17Z", "author": {"login": "afalhambra"}, "path": "jbpm-runtime-manager/src/main/java/org/jbpm/runtime/manager/impl/deploy/DeploymentDescriptorManagerUtil.java", "diffHunk": "@@ -15,6 +15,10 @@\n  */\n package org.jbpm.runtime.manager.impl.deploy;\n \n+import static java.util.Arrays.asList;\n+import static java.util.Collections.addAll;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTgxODQ3OA==", "bodyText": "Can be simplified - descriptor != null is always true\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \t} else if (descriptor != null && !deploymentUnit.isDeployed()) {\n          \n          \n            \n                \t} else if (!deploymentUnit.isDeployed()) {", "url": "https://github.com/kiegroup/jbpm/pull/1741#discussion_r481818478", "createdAt": "2020-09-02T07:13:59Z", "author": {"login": "afalhambra"}, "path": "jbpm-services/jbpm-kie-services/src/main/java/org/jbpm/kie/services/impl/KModuleDeploymentService.java", "diffHunk": "@@ -253,19 +253,12 @@ protected RuntimeEnvironmentBuilder boostrapRuntimeEnvironmentBuilder(KModuleDep\n     \tDeploymentDescriptor descriptor = deploymentUnit.getDeploymentDescriptor();\n     \tif (descriptor == null || ((DeploymentDescriptorImpl)descriptor).isEmpty()) { // skip empty descriptors as its default can override settings\n \t    \tDeploymentDescriptorManager descriptorManager = new DeploymentDescriptorManager(\"org.jbpm.domain\");\n-            List<DeploymentDescriptor> descriptorHierarchy = DeploymentDescriptorManagerUtil.getDeploymentDescriptorHierarchy(descriptorManager, kieContainer);\n-\n-\t\t\tdescriptor = merger.merge(descriptorHierarchy, mode);\n-\t\t\tdeploymentUnit.setDeploymentDescriptor(descriptor);\n+\t    \tdescriptor = getDeploymentDescriptor(descriptorManager, kieContainer, mode);\n     \t} else if (descriptor != null && !deploymentUnit.isDeployed()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDg3Mzc0", "url": "https://github.com/kiegroup/jbpm/pull/1741#pullrequestreview-482087374", "createdAt": "2020-09-03T18:14:12Z", "commit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoxNDoxMlrOHMyJ8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoxNDoxMlrOHMyJ8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE2NjcwNw==", "bodyText": "Previously, descriptor was only set in both cases of previous \"if...else..\"; however, now it would be set even if deploymentUnit is deployed, is it right?", "url": "https://github.com/kiegroup/jbpm/pull/1741#discussion_r483166707", "createdAt": "2020-09-03T18:14:12Z", "author": {"login": "gmunozfe"}, "path": "jbpm-services/jbpm-kie-services/src/main/java/org/jbpm/kie/services/impl/KModuleDeploymentService.java", "diffHunk": "@@ -253,19 +253,12 @@ protected RuntimeEnvironmentBuilder boostrapRuntimeEnvironmentBuilder(KModuleDep\n     \tDeploymentDescriptor descriptor = deploymentUnit.getDeploymentDescriptor();\n     \tif (descriptor == null || ((DeploymentDescriptorImpl)descriptor).isEmpty()) { // skip empty descriptors as its default can override settings\n \t    \tDeploymentDescriptorManager descriptorManager = new DeploymentDescriptorManager(\"org.jbpm.domain\");\n-            List<DeploymentDescriptor> descriptorHierarchy = DeploymentDescriptorManagerUtil.getDeploymentDescriptorHierarchy(descriptorManager, kieContainer);\n-\n-\t\t\tdescriptor = merger.merge(descriptorHierarchy, mode);\n-\t\t\tdeploymentUnit.setDeploymentDescriptor(descriptor);\n+\t    \tdescriptor = getDeploymentDescriptor(descriptorManager, kieContainer, mode);\n     \t} else if (descriptor != null && !deploymentUnit.isDeployed()) {\n     \t\tDeploymentDescriptorManager descriptorManager = new DeploymentDescriptorManager(\"org.jbpm.domain\");\n-            List<DeploymentDescriptor> descriptorHierarchy = DeploymentDescriptorManagerUtil.getDeploymentDescriptorHierarchy(descriptorManager, kieContainer);\n-\n-\t    \tdescriptorHierarchy.add(0, descriptor);\n-\t    \tdescriptor = merger.merge(descriptorHierarchy, mode);\n-\t\t\tdeploymentUnit.setDeploymentDescriptor(descriptor);\n+    \t\tdescriptor = getDeploymentDescriptor(descriptorManager, kieContainer, mode, deploymentUnit.getDeploymentDescriptor());\n     \t}\n-\n+        deploymentUnit.setDeploymentDescriptor(descriptor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e"}, "originalPosition": 35}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c20cffa0a939e8287b17d45bc73dd465051ec21e", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/c20cffa0a939e8287b17d45bc73dd465051ec21e", "committedDate": "2020-09-01T07:45:01Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "c0aba9842124f5bf6c84dcbe92b61ac1ae6d17a6", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/c0aba9842124f5bf6c84dcbe92b61ac1ae6d17a6", "committedDate": "2020-09-04T09:22:04Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6016a8a39c178377940e18055222cdf79eb9af15", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/6016a8a39c178377940e18055222cdf79eb9af15", "committedDate": "2020-09-04T09:23:10Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0aba9842124f5bf6c84dcbe92b61ac1ae6d17a6", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/c0aba9842124f5bf6c84dcbe92b61ac1ae6d17a6", "committedDate": "2020-09-04T09:22:04Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "6016a8a39c178377940e18055222cdf79eb9af15", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/6016a8a39c178377940e18055222cdf79eb9af15", "committedDate": "2020-09-04T09:23:10Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNjc2MTgx", "url": "https://github.com/kiegroup/jbpm/pull/1741#pullrequestreview-482676181", "createdAt": "2020-09-04T13:59:53Z", "commit": {"oid": "6016a8a39c178377940e18055222cdf79eb9af15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNjg2MzU2", "url": "https://github.com/kiegroup/jbpm/pull/1741#pullrequestreview-482686356", "createdAt": "2020-09-04T14:12:53Z", "commit": {"oid": "6016a8a39c178377940e18055222cdf79eb9af15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 751, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}