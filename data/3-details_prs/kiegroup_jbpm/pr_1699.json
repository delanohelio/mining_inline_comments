{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2Nzg2MTc4", "number": 1699, "title": "[JBPM-9185] use BoundaryEvent name to compose timer name", "bodyText": "Add boundary event name to timer name", "createdAt": "2020-07-09T11:01:09Z", "url": "https://github.com/kiegroup/jbpm/pull/1699", "merged": true, "mergeCommit": {"oid": "5d01646aab7f4254476afd609373e38a33c69234"}, "closed": true, "closedAt": "2020-07-14T18:11:41Z", "author": {"login": "fjtirado"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczPzPjABqjM1Mjk5NDIyNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc04Fg3gFqTQ0ODIzODEyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0e8707c59c9a24a5402efac68748dcb502668947", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/0e8707c59c9a24a5402efac68748dcb502668947", "committedDate": "2020-07-09T11:00:42Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}, "afterCommit": {"oid": "360163550a090b5be9bd0ce706a146a77fcaefef", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/360163550a090b5be9bd0ce706a146a77fcaefef", "committedDate": "2020-07-09T14:20:15Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NTUwOTY3", "url": "https://github.com/kiegroup/jbpm/pull/1699#pullrequestreview-446550967", "createdAt": "2020-07-10T16:50:48Z", "commit": {"oid": "360163550a090b5be9bd0ce706a146a77fcaefef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNjo1MDo0OFrOGv-abw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNjo1MDo0OFrOGv-abw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk1ODgzMQ==", "bodyText": "if human task has no name (compositeNode.getName() will return \"null\"):\nPerhaps, in this scenario, it's better to assign \"\" (as well as logging a WARN trace)", "url": "https://github.com/kiegroup/jbpm/pull/1699#discussion_r452958831", "createdAt": "2020-07-10T16:50:48Z", "author": {"login": "gmunozfe"}, "path": "jbpm-bpmn2/src/main/java/org/jbpm/bpmn2/xml/ProcessHandler.java", "diffHunk": "@@ -461,7 +461,8 @@ private static void linkBoundaryTimerEvent(NodeContainer nodeContainer, Node nod\n         String timeCycle = (String) node.getMetaData().get(\"TimeCycle\");\n         String timeDate = (String) node.getMetaData().get(\"TimeDate\");\n         Timer timer = new Timer();\n-        timer.setName(node.getName());\n+        String boundaryEventName = node.getName();\n+        timer.setName(compositeNode.getName() +(boundaryEventName != null ? \"-\"+boundaryEventName : \"\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "360163550a090b5be9bd0ce706a146a77fcaefef"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "360163550a090b5be9bd0ce706a146a77fcaefef", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/360163550a090b5be9bd0ce706a146a77fcaefef", "committedDate": "2020-07-09T14:20:15Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}, "afterCommit": {"oid": "4e28e324ec1f0b27e0fef7c812f0fd74fe93a0d4", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/4e28e324ec1f0b27e0fef7c812f0fd74fe93a0d4", "committedDate": "2020-07-13T08:19:08Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4e28e324ec1f0b27e0fef7c812f0fd74fe93a0d4", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/4e28e324ec1f0b27e0fef7c812f0fd74fe93a0d4", "committedDate": "2020-07-13T08:19:08Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}, "afterCommit": {"oid": "3f0aab3053476e985095f937dc7d24eac1b8f49b", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/3f0aab3053476e985095f937dc7d24eac1b8f49b", "committedDate": "2020-07-13T08:31:46Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MTEzNTYw", "url": "https://github.com/kiegroup/jbpm/pull/1699#pullrequestreview-448113560", "createdAt": "2020-07-14T13:38:11Z", "commit": {"oid": "3f0aab3053476e985095f937dc7d24eac1b8f49b"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMzozODoxMlrOGxUDqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMzozOToxNVrOGxUGUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM2MjAyNQ==", "bodyText": "Here as well, assertEquals(\"usertask-timer\", timer.getTimerName());", "url": "https://github.com/kiegroup/jbpm/pull/1699#discussion_r454362025", "createdAt": "2020-07-14T13:38:12Z", "author": {"login": "MarianMacik"}, "path": "jbpm-services/jbpm-kie-services/src/test/java/org/jbpm/kie/services/impl/admin/ProcessInstanceAdminServiceImplTest.java", "diffHunk": "@@ -413,6 +414,21 @@ public void testListSLATimer() throws Exception {\n         assertNotNull(timer.getId());\n         assertNotNull(timer.getTimerName());\n     }\n+    \n+    @Test(timeout=10000)\n+    public void testTimerName() throws Exception {\n+        processInstanceId = processService.startProcess(deploymentUnit.getIdentifier(), \"org.jbpm.boundarytimer\");\n+        assertNotNull(processInstanceId);\n+        \n+        Collection<TimerInstance> timers = processAdminService.getTimerInstances(processInstanceId);\n+        assertNotNull(timers);\n+        assertEquals(1, timers.size());\n+        \n+        TimerInstance timer = timers.iterator().next();\n+        assertEquals(\"usertask-timer\",timer.getTimerName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f0aab3053476e985095f937dc7d24eac1b8f49b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM2MjcwNg==", "bodyText": "Just a recommendation for the code style. It should be concatName(String prefix...) (no space) and return prefix.concat('-' + suffix); (space between operator and operands). If you use Eclipse or IntelliJ IDEA, you can find IDE configuration here: https://github.com/kiegroup/droolsjbpm-build-bootstrap/tree/master/ide-configuration", "url": "https://github.com/kiegroup/jbpm/pull/1699#discussion_r454362706", "createdAt": "2020-07-14T13:39:15Z", "author": {"login": "MarianMacik"}, "path": "jbpm-bpmn2/src/main/java/org/jbpm/bpmn2/xml/ProcessHandler.java", "diffHunk": "@@ -454,14 +454,24 @@ private static void linkBoundaryErrorEvent(NodeContainer nodeContainer, Node nod\n         ((EventNode)node).setActions(EndNode.EVENT_NODE_EXIT, actions);\n     }\n     \n+    private static String concatName (String prefix, String suffix) {\n+        if (prefix == null) {\n+            return suffix;\n+        } else if (suffix == null) {\n+            return prefix;\n+        } else {\n+            return prefix.concat('-'+suffix);\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f0aab3053476e985095f937dc7d24eac1b8f49b"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3eafe63788d61c38da1a24fb20557616614ef70a", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/3eafe63788d61c38da1a24fb20557616614ef70a", "committedDate": "2020-07-14T13:51:02Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f0aab3053476e985095f937dc7d24eac1b8f49b", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/3f0aab3053476e985095f937dc7d24eac1b8f49b", "committedDate": "2020-07-13T08:31:46Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}, "afterCommit": {"oid": "3eafe63788d61c38da1a24fb20557616614ef70a", "author": {"user": {"login": "fjtirado", "name": "Francisco Javier Tirado Sarti"}}, "url": "https://github.com/kiegroup/jbpm/commit/3eafe63788d61c38da1a24fb20557616614ef70a", "committedDate": "2020-07-14T13:51:02Z", "message": "[JBPM-9185] use BoundaryEvent name to compose timer name\n\nAdd boundary event name to timer name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MjM4MTIz", "url": "https://github.com/kiegroup/jbpm/pull/1699#pullrequestreview-448238123", "createdAt": "2020-07-14T15:50:51Z", "commit": {"oid": "3eafe63788d61c38da1a24fb20557616614ef70a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 964, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}