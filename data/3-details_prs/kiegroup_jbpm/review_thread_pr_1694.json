{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0NjM5MzA2", "number": 1694, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwODoyODo0N1rOEL-aaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwOTowMDo0MlrOEL_LTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwOTkyMzYwOnYy", "diffSide": "RIGHT", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwODoyODo0N1rOGt0Qew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMjo1ODo0MVrOGuScbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NTI5MQ==", "bodyText": "I think below message is slightly clearer. I removed Active cause I understand that it might be in a different status other than Active? wdyt?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertEquals(\"Active task node instance when aborting process should be at ABORTED type -2-\", \n          \n          \n            \n                    assertEquals(\"Task node instance when aborting process should be in ABORTED status (2)\",", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450695291", "createdAt": "2020-07-07T08:28:47Z", "author": {"login": "afalhambra"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { \n+        String PROCESS_ID = \"com.sample.ruleflow4\";\n+        // start process instance\n+        long processInstanceId = ksession.startProcess(PROCESS_ID).getId();\n+        \n+        logger.info(\"Checking process instances for process '{}' before aborting\", PROCESS_ID);\n+       \n+        ksession.abortProcessInstance(processInstanceId);\n+        \n+        List<NodeInstanceLog> nodeInstances = auditLogService.findNodeInstances(processInstanceId);\n+        \n+        assertEquals(\"There should be 4 node instances\", 4, nodeInstances.size());\n+        assertEquals(\"Active task node instance when aborting process should be at ABORTED type -2-\", ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE4OTg2OA==", "bodyText": "Done", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451189868", "createdAt": "2020-07-07T22:58:41Z", "author": {"login": "gmunozfe"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { \n+        String PROCESS_ID = \"com.sample.ruleflow4\";\n+        // start process instance\n+        long processInstanceId = ksession.startProcess(PROCESS_ID).getId();\n+        \n+        logger.info(\"Checking process instances for process '{}' before aborting\", PROCESS_ID);\n+       \n+        ksession.abortProcessInstance(processInstanceId);\n+        \n+        List<NodeInstanceLog> nodeInstances = auditLogService.findNodeInstances(processInstanceId);\n+        \n+        assertEquals(\"There should be 4 node instances\", 4, nodeInstances.size());\n+        assertEquals(\"Active task node instance when aborting process should be at ABORTED type -2-\", ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NTI5MQ=="}, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwOTkzNzcyOnYy", "diffSide": "RIGHT", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwODozMjoyOVrOGt0Ziw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMzowMDo1M1rOGuSfXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzYxMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ksession.getWorkItemManager().registerWorkItemHandler(\"No completed task\", new DoNothingWorkItemHandler());\n          \n          \n            \n                    ksession.getWorkItemManager().registerWorkItemHandler(\"Not completed task\", new DoNothingWorkItemHandler());", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450697611", "createdAt": "2020-07-07T08:32:29Z", "author": {"login": "afalhambra"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -59,7 +60,8 @@ public void setUp() throws Exception {\n         ksession = createKieSession(kbase, env);\n         new JPAWorkingMemoryDbLogger(ksession);\n         ksession.getWorkItemManager().registerWorkItemHandler(\"Human Task\", new SystemOutWorkItemHandler());\n-       \n+        //Register a workitem that does not complete it when executed\n+        ksession.getWorkItemManager().registerWorkItemHandler(\"No completed task\", new DoNothingWorkItemHandler());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE5MDYyMQ==", "bodyText": "Done", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451190621", "createdAt": "2020-07-07T23:00:53Z", "author": {"login": "gmunozfe"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -59,7 +60,8 @@ public void setUp() throws Exception {\n         ksession = createKieSession(kbase, env);\n         new JPAWorkingMemoryDbLogger(ksession);\n         ksession.getWorkItemManager().registerWorkItemHandler(\"Human Task\", new SystemOutWorkItemHandler());\n-       \n+        //Register a workitem that does not complete it when executed\n+        ksession.getWorkItemManager().registerWorkItemHandler(\"No completed task\", new DoNothingWorkItemHandler());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzYxMQ=="}, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwOTkzOTA5OnYy", "diffSide": "RIGHT", "path": "jbpm-audit/src/test/resources/ruleflow4.rf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwODozMjo1MlrOGt0abw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMzowMToxMlrOGuSfsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzgzOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <work name=\"No completed task\" >\n          \n          \n            \n                  <work name=\"Not completed task\" >", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450697839", "createdAt": "2020-07-07T08:32:52Z", "author": {"login": "afalhambra"}, "path": "jbpm-audit/src/test/resources/ruleflow4.rf", "diffHunk": "@@ -0,0 +1,37 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n+<process xmlns=\"http://drools.org/drools-5.0/process\"\n+         xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xs:schemaLocation=\"http://drools.org/drools-5.0/process drools-processes-5.0.xsd\"\n+         type=\"RuleFlow\" name=\"ruleflow4\" id=\"com.sample.ruleflow4\" package-name=\"org.drools.core.process.workflow\" >\n+\n+  <header>\n+  </header>\n+\n+  <nodes>\n+    <start id=\"1\" name=\"Start\" />\n+    <workItem id=\"2\" name=\"Task\" >\n+      <work name=\"No completed task\" >", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE5MDcwNQ==", "bodyText": "Done", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451190705", "createdAt": "2020-07-07T23:01:12Z", "author": {"login": "gmunozfe"}, "path": "jbpm-audit/src/test/resources/ruleflow4.rf", "diffHunk": "@@ -0,0 +1,37 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n+<process xmlns=\"http://drools.org/drools-5.0/process\"\n+         xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xs:schemaLocation=\"http://drools.org/drools-5.0/process drools-processes-5.0.xsd\"\n+         type=\"RuleFlow\" name=\"ruleflow4\" id=\"com.sample.ruleflow4\" package-name=\"org.drools.core.process.workflow\" >\n+\n+  <header>\n+  </header>\n+\n+  <nodes>\n+    <start id=\"1\" name=\"Start\" />\n+    <workItem id=\"2\" name=\"Task\" >\n+      <work name=\"No completed task\" >", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY5NzgzOQ=="}, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDA0ODc5OnYy", "diffSide": "RIGHT", "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwOTowMDo0MlrOGt1dmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMzowNDowM1rOGuSjBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcxNTAzNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { \n          \n          \n            \n                public void whenAbortingProcessTaskShouldBeInAbortedStatus() {", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r450715035", "createdAt": "2020-07-07T09:00:42Z", "author": {"login": "afalhambra"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE5MTU1Nw==", "bodyText": "Done", "url": "https://github.com/kiegroup/jbpm/pull/1694#discussion_r451191557", "createdAt": "2020-07-07T23:04:03Z", "author": {"login": "gmunozfe"}, "path": "jbpm-audit/src/test/java/org/jbpm/process/audit/StandaloneAuditLogServiceTest.java", "diffHunk": "@@ -106,4 +108,23 @@ public void setAuditLogServiceForCommandTest() {\n         processInstances = setAuditLogServiceAndExecute(new FindProcessInstancesCommand(PROCESS_ID));\n         assertEquals(0, processInstances.size());\n     }\n+    \n+    @Test\n+    public void whenAbortingProcess_activeTaskShouldBeAtAbortedType() { ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcxNTAzNQ=="}, "originalCommit": {"oid": "f5a762bedb3949f95a55ed07cdb12902423a48c5"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1743, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}