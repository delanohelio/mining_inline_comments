{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NTk0MjU3", "number": 1620, "title": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered", "bodyText": "discrimate wheter the timer is triggered for subprocess or not", "createdAt": "2020-03-27T07:27:18Z", "url": "https://github.com/kiegroup/jbpm/pull/1620", "merged": true, "mergeCommit": {"oid": "d5772933b9bb1478efef310423f7a078bf98a5c9"}, "closed": true, "closedAt": "2020-04-02T12:41:06Z", "author": {"login": "elguardian"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSxPmBAFqTM4NDAyNTUwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTrg06gFqTM4NjM3ODkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MDI1NTA0", "url": "https://github.com/kiegroup/jbpm/pull/1620#pullrequestreview-384025504", "createdAt": "2020-03-30T16:26:39Z", "commit": {"oid": "d5169d531ebf684c8d52035716be5986c8d39100"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNjoyNjozOVrOF9x-8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNjoyNjozOVrOF9x-8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMyNjM4Ng==", "bodyText": "May getTimerInstances return null and this line throws a NPE?", "url": "https://github.com/kiegroup/jbpm/pull/1620#discussion_r400326386", "createdAt": "2020-03-30T16:26:39Z", "author": {"login": "gmunozfe"}, "path": "jbpm-flow/src/main/java/org/jbpm/workflow/instance/node/EventSubProcessNodeInstance.java", "diffHunk": "@@ -54,14 +56,22 @@ public void signalEvent(String type, Object event) {\n             // start it only if it was not already started - meaning there are node instances\n             if (this.getNodeInstances().isEmpty()) {\n                 StartNode startNode = getCompositeNode().findStartNode();\n-                if (resolveVariables(((EventSubProcessNode) getEventBasedNode()).getEvents()).contains(type) || type.equals(\"timerTriggered\")) {\n+                if (resolveVariables(((EventSubProcessNode) getEventBasedNode()).getEvents()).contains(type) || containsTimerEvent(type, event)) {\n                     NodeInstance nodeInstance = getNodeInstance(startNode);\n                     ((StartNodeInstance) nodeInstance).signalEvent(type, event);\n                 }\n             }\n         }\n         super.signalEvent(type, event);\n     }\n+\n+    private boolean containsTimerEvent(String type, Object event) {\n+        if (!type.equals(\"timerTriggered\") || !(event instanceof TimerInstance)) {\n+            return false;\n+        }\n+        TimerInstance timerInstance = (TimerInstance) event;\n+        return getTimerInstances().contains(timerInstance.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5169d531ebf684c8d52035716be5986c8d39100"}, "originalPosition": 35}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d5169d531ebf684c8d52035716be5986c8d39100", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/d5169d531ebf684c8d52035716be5986c8d39100", "committedDate": "2020-03-27T07:26:46Z", "message": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered\n\ndiscrimate wheter the timer is triggered for subprocess or not"}, "afterCommit": {"oid": "6f30b24b99c5f1507aa82d014addd6664c889b61", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/6f30b24b99c5f1507aa82d014addd6664c889b61", "committedDate": "2020-04-01T06:36:11Z", "message": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered\n\ndiscrimate wheter the timer is triggered for subprocess or not"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f658a1ccfb13161c24b9056b36abcccceb036412", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/f658a1ccfb13161c24b9056b36abcccceb036412", "committedDate": "2020-04-02T06:23:48Z", "message": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered\n\ndiscrimate wheter the timer is triggered for subprocess or not"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f30b24b99c5f1507aa82d014addd6664c889b61", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/6f30b24b99c5f1507aa82d014addd6664c889b61", "committedDate": "2020-04-01T06:36:11Z", "message": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered\n\ndiscrimate wheter the timer is triggered for subprocess or not"}, "afterCommit": {"oid": "f658a1ccfb13161c24b9056b36abcccceb036412", "author": {"user": null}, "url": "https://github.com/kiegroup/jbpm/commit/f658a1ccfb13161c24b9056b36abcccceb036412", "committedDate": "2020-04-02T06:23:48Z", "message": "[RHPAM-2839] Event Sub-process with timer start node fire if an intermediate timer from process is triggered\n\ndiscrimate wheter the timer is triggered for subprocess or not"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2Mzc4OTM4", "url": "https://github.com/kiegroup/jbpm/pull/1620#pullrequestreview-386378938", "createdAt": "2020-04-02T12:32:25Z", "commit": {"oid": "f658a1ccfb13161c24b9056b36abcccceb036412"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1069, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}