{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMTAxODg2", "number": 1803, "title": "[JBPM-9466] Make configurable Kafka Producer max.block.ms", "bodyText": "JIRA: JBPM-9466", "createdAt": "2020-11-12T19:19:11Z", "url": "https://github.com/kiegroup/jbpm/pull/1803", "merged": true, "mergeCommit": {"oid": "5bca51e6772772ec11d23bb3efc26fcb464a34e7"}, "closed": true, "closedAt": "2020-11-24T11:51:03Z", "author": {"login": "gmunozfe"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcD9SFAH2gAyNTIwMTAxODg2OmE4OWEyYjY1OTVjMDFkMzIxZjc4MjA5MmQ4NWM3YmMxMzQ3YzU3MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddX19yAFqTUzMjI1OTcxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706", "author": {"user": {"login": "gmunozfe", "name": "Gonzalo Mu\u00f1oz"}}, "url": "https://github.com/kiegroup/jbpm/commit/a89a2b6595c01d321f782092d85c7bc1347c5706", "committedDate": "2020-11-13T09:43:46Z", "message": "[JBPM-9466] Make configurable Kafka Producer max.block.ms"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8cecb2e86eebcbd715d2c7e58c71794153547b3", "author": {"user": {"login": "gmunozfe", "name": "Gonzalo Mu\u00f1oz"}}, "url": "https://github.com/kiegroup/jbpm/commit/c8cecb2e86eebcbd715d2c7e58c71794153547b3", "committedDate": "2020-11-12T18:59:20Z", "message": "[JBPM-9466] Make configurable Kafka Producer max.block.ms"}, "afterCommit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706", "author": {"user": {"login": "gmunozfe", "name": "Gonzalo Mu\u00f1oz"}}, "url": "https://github.com/kiegroup/jbpm/commit/a89a2b6595c01d321f782092d85c7bc1347c5706", "committedDate": "2020-11-13T09:43:46Z", "message": "[JBPM-9466] Make configurable Kafka Producer max.block.ms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTE3NDg4", "url": "https://github.com/kiegroup/jbpm/pull/1803#pullrequestreview-529917488", "createdAt": "2020-11-13T09:46:06Z", "commit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMjU5NzEx", "url": "https://github.com/kiegroup/jbpm/pull/1803#pullrequestreview-532259711", "createdAt": "2020-11-17T11:16:05Z", "commit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMToxNjowNVrOH0wFeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMToxNzozNVrOH0wI1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA3NTgzNA==", "bodyText": "maybe it's worth checking whether this.emitter is null as it might be already closed. wdyt?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.emitter.close();\n          \n          \n            \n                    emitter = null;\n          \n          \n            \n                    if (this.emitter != null) {\n          \n          \n            \n                        this.emitter.close();\n          \n          \n            \n                        emitter = null;\n          \n          \n            \n                    }", "url": "https://github.com/kiegroup/jbpm/pull/1803#discussion_r525075834", "createdAt": "2020-11-17T11:16:05Z", "author": {"login": "afalhambra"}, "path": "jbpm-persistence/jbpm-persistence-api/src/main/java/org/jbpm/persistence/api/integration/base/TransactionalPersistenceEventManager.java", "diffHunk": "@@ -153,5 +153,6 @@ public void close() {\n         }\n         \n         this.emitter.close();\n+        emitter = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA3NjY5Mw==", "bodyText": "Shouldn't we leave to the default ProducerConfig.MAX_BLOCK_MS_CONFIG value (60secs)? - wdyt?", "url": "https://github.com/kiegroup/jbpm/pull/1803#discussion_r525076693", "createdAt": "2020-11-17T11:17:35Z", "author": {"login": "afalhambra"}, "path": "jbpm-event-emitters/jbpm-event-emitters-kafka/src/main/java/org/jbpm/event/emitters/kafka/KafkaEventEmitter.java", "diffHunk": "@@ -154,6 +154,8 @@ public EventCollection newCollection() {\n         if (clientId != null) {\n             configs.put(ProducerConfig.CLIENT_ID_CONFIG, clientId);\n         }\n+        configs.put(ProducerConfig.MAX_BLOCK_MS_CONFIG, \n+                    System.getProperty(\"org.kie.jbpm.event.emitters.kafka.max.block.ms\", \"2000\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a89a2b6595c01d321f782092d85c7bc1347c5706"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 837, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}