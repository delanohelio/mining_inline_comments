{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NjExMjc3", "number": 158, "title": "Code cleanup", "bodyText": "Reviewed all JavaDoc comments and corrected/reformatted where required.\nMoved and changed artifact's names where appropriate for the sake of clarity and consistency.\nRemoved unnecessary classes.\nChanged the visibility of some code artifacts that should not be exposed to customers.\nConsolidated some interfaces and their implementations as described in this commit for the sake of having a clearer and cleaner public API.", "createdAt": "2020-01-22T01:01:24Z", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158", "merged": true, "mergeCommit": {"oid": "86084d6dbe0b4f781bd1af9cebc3ab3bb16095b4"}, "closed": true, "closedAt": "2020-01-28T23:10:11Z", "author": {"login": "vcolin7"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8Y0XLAH2gAyMzY1NjExMjc3Ojk2Y2E4MWFmYmY2Y2UxZjQ4MTIxZDVlOTY1N2VkNGQ4NTM3NzAxYzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-5qvBAH2gAyMzY1NjExMjc3OjAwNzM4M2JmMjkzZTliZjlkNDEyN2IzOWQ1MTNkMDM4ODI1Y2VlNWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "96ca81afbf6ce1f48121d5e9657ed4d8537701c7", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/96ca81afbf6ce1f48121d5e9657ed4d8537701c7", "committedDate": "2020-01-21T03:45:18Z", "message": "Corrected and reformatted JavaDoc comments where necessary in the whole project (except CoreUtils). Refactored some code for better readability."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2566b9906ae725cb3757fe3b4c24667e6fadae2c", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/2566b9906ae725cb3757fe3b4c24667e6fadae2c", "committedDate": "2020-01-21T03:52:20Z", "message": "Merge branch 'upstream-dev' into code-cleanup\n\n# Conflicts:\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/CurlLoggingInterceptor.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/LogOptions.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/LogUtils.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/LoggingInterceptor.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/implementation/http/rest/RetrofitAPIClient.java\n#\tsdk/storage/azure-storage-common/src/main/java/com/azure/android/storage/common/interceptor/ResponseHeadersValidationInterceptor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c2e07081f58a5fd0431639d7acc3400aec8311c", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/4c2e07081f58a5fd0431639d7acc3400aec8311c", "committedDate": "2020-01-21T04:02:36Z", "message": "Made slight corrections to errors caused when merging in the past commit."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "818cc9a135c2a455ee6ed2426e4f81b303233bda", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/818cc9a135c2a455ee6ed2426e4f81b303233bda", "committedDate": "2020-01-21T23:31:02Z", "message": "Moved all HTTP-related exceptions into the http package inside of azure-core."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fca9c127ba6c4c13b88affd812972ea85a6c2ab", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/8fca9c127ba6c4c13b88affd812972ea85a6c2ab", "committedDate": "2020-01-21T23:36:16Z", "message": "Renamed the 'implementation' package to 'internal' to follow Android conventions. Changed the visibility of some getModule() methods that can be package-private instead of public. Moved an exception class to its own package for the sake of consistency. Removed the AdditionalProperties and Flattening serializers and deserializers since they are not required at the moment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fde6cd318609900a2f0176746e2f1c9f780c78e", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/8fde6cd318609900a2f0176746e2f1c9f780c78e", "committedDate": "2020-01-21T23:38:29Z", "message": "Changed the visibility of AndroidClientLogger to package-private since we want user to get new instances only through ClientLogger.getDefault() calls. Corrected these artifacts' JavaDoc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/bf8ed6437d7bf5e6ef56154967be0edafbf89aea", "committedDate": "2020-01-21T23:56:31Z", "message": "After a brainstorming session with @anuchandy, we decided that if we are going to decouple Android classes like Context and Configuration to make it easier to create some unit tests it would be good to reduce the surface area of our public API involved (InformationProvider interfaces). So instead of having a whole 'implementation' package with a bunch of public interfaces and classes, we can consolidate everything into one interface and its implementation and move it into the 'interceptors' package while keeping the implementation package-private and the interface public with a getDefault() method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2OTgwMTIy", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#pullrequestreview-346980122", "createdAt": "2020-01-22T23:41:03Z", "commit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzo0MTowNFrOFguziA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwMDoxNDoxNFrOFgvW4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2NTYwOA==", "bodyText": "AndroidInformation type is package private so we should not link that type in javadoc.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369865608", "createdAt": "2020-01-22T23:41:04Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/DeviceInformation.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package com.azure.android.core.http.interceptor;\n+\n+import android.content.Context;\n+import android.content.res.Configuration;\n+\n+/**\n+ * Interface for an object that contains application, platform and locale information.\n+ */\n+public interface DeviceInformation {\n+    /**\n+     * Creates and returns a default {@link DeviceInformation} in the form of an {@link AndroidInformation} instance.\n+     *\n+     * @param configuration The application's context.\n+     * @param context       The system configuration.\n+     * @return An {@link AndroidInformation} instance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2NjM4NA==", "bodyText": "We can remove this annotation type given we don't use flattening serializer and deserializer any more.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369866384", "createdAt": "2020-01-22T23:43:53Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/annotation/JsonFlatten.java", "diffHunk": "@@ -3,21 +3,17 @@\n \n package com.azure.android.core.annotation;\n \n-import static java.lang.annotation.RetentionPolicy.RUNTIME;\n-\n import java.lang.annotation.ElementType;\n import java.lang.annotation.Retention;\n import java.lang.annotation.Target;\n \n+import static java.lang.annotation.RetentionPolicy.RUNTIME;\n+\n /**\n- * Annotation used for flattening properties separated by '.'.\n- *\n- * E.g. a property with JsonProperty value \"properties.value\"\n- * will have \"value\" property under the \"properties\" tree on\n- * the wire.\n- *\n+ * Annotation used for flattening properties separated by '.', e.g., a property with JsonProperty value\n+ * \"properties.value\" will have \"value\" property under the \"properties\" tree on the wire.\n  */\n @Retention(RUNTIME)\n @Target({ElementType.ANNOTATION_TYPE, ElementType.TYPE})\n public @interface JsonFlatten {\n-}\n\\ No newline at end of file\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2NzY5MQ==", "bodyText": "nit; this type is internal, its ok to have no doc for the overridden methods as we don't generate javadoc for internal types. We can just keep the class level and ctr level docs and remove rest.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369867691", "createdAt": "2020-01-22T23:48:55Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/AndroidInformation.java", "diffHunk": "@@ -0,0 +1,126 @@\n+package com.azure.android.core.http.interceptor;\n+\n+import android.content.Context;\n+import android.content.pm.PackageManager;\n+import android.content.res.Configuration;\n+import android.os.Build;\n+\n+/**\n+ * Provider that contains device and application information extracted from {@link Configuration} and {@link Context}\n+ * objects, as well as the {@link Build} class.\n+ */\n+final class AndroidInformation implements DeviceInformation {\n+    private final Configuration configuration;\n+    private final Context context;\n+\n+    private int targetSdkVersion;\n+    private String applicationId;\n+    private String applicationVersion;\n+    private String language;\n+    private String systemRegion;\n+\n+    /**\n+     * Constructor that takes an application's {@link Context} and a system's {@link Configuration} object to extract\n+     * data from.\n+     *\n+     * @param configuration The application's context.\n+     * @param context       The system configuration.\n+     */\n+    AndroidInformation(Configuration configuration, Context context) {\n+        this.configuration = configuration;\n+        this.context = context;\n+        targetSdkVersion = -1;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public int getTargetSdkVersion() {\n+        if (targetSdkVersion == -1) {\n+            targetSdkVersion = context.getApplicationInfo().targetSdkVersion;\n+        }\n+\n+        return targetSdkVersion;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getApplicationId() {\n+        if (applicationId == null) {\n+            applicationId = context.getPackageName();\n+        }\n+\n+        return applicationId;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getApplicationVersion() {\n+        if (applicationVersion == null) {\n+            try {\n+                applicationVersion = context.getPackageManager().getPackageInfo(getApplicationId(), 0).versionName;\n+            } catch (PackageManager.NameNotFoundException e) {\n+                e.printStackTrace();\n+            }\n+        }\n+\n+        return applicationVersion;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getDefaultSystemLanguage() {\n+        if (language == null) {\n+            // Using this instead of Configuration.getLocales() because it's not supported in anything less than\n+            // Android L24\n+            language = configuration.locale.getLanguage();\n+        }\n+\n+        return language;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getSystemRegion() {\n+        if (systemRegion == null) {\n+            // Using this instead of Configuration.getLocales() because it's not supported in anything less than\n+            // Android L24\n+            systemRegion = configuration.locale.getCountry();\n+        }\n+\n+        return systemRegion;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getManufacturer() {\n+        return Build.MANUFACTURER;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public String getModel() {\n+        return Build.MODEL;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public int getOsVersion() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2ODczMA==", "bodyText": "we might want to revert to implementation based on team discussion.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369868730", "createdAt": "2020-01-22T23:52:25Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/internal/http/rest/RetrofitAPIClient.java", "diffHunk": "@@ -1,10 +1,10 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.android.core.implementation.http.rest;\n+package com.azure.android.core.internal.http.rest;\n \n-import com.azure.android.core.implementation.util.serializer.SerializerAdapter;\n-import com.azure.android.core.implementation.util.serializer.SerializerEncoding;\n+import com.azure.android.core.internal.util.serializer.SerializerAdapter;\n+import com.azure.android.core.internal.util.serializer.SerializerEncoding;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2ODk2Mg==", "bodyText": "internal -> implementation. Please check other places as well.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369868962", "createdAt": "2020-01-22T23:53:09Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/serializer/Base64UrlSerializer.java", "diffHunk": "@@ -1,11 +1,12 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.android.core.implementation.util.serializer;\n+package com.azure.android.core.internal.util.serializer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg3MjI2MQ==", "bodyText": "We shouldn't turn this to an interface given there is no use-case to implement it.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369872261", "createdAt": "2020-01-23T00:05:02Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/Base64Util.java", "diffHunk": "@@ -9,78 +9,76 @@\n /**\n  * Utility for Base64 encoding and decoding.\n  */\n-public final class Base64Util {\n+public interface Base64Util {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg3NDY1OA==", "bodyText": "nit; given this is internal type we can remove inherit-javadoc for all overriden methods", "url": "https://github.com/Azure/azure-sdk-for-android/pull/158#discussion_r369874658", "createdAt": "2020-01-23T00:14:14Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/logging/AndroidClientLogger.java", "diffHunk": "@@ -61,48 +63,80 @@ public void setLogLevel(@LogLevel int logLevel) {\n         this.logLevel = logLevel;\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n     public void debug(String message) {\n         if (LOG_LEVEL_DEBUG >= this.logLevel) {\n             Log.d(tag, message);\n         }\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n     public void debug(String message, Throwable throwable) {\n         if (LOG_LEVEL_DEBUG >= this.logLevel) {\n             Log.d(tag, message, throwable);\n         }\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n     public void info(String message) {\n         if (LOG_LEVEL_INFO >= this.logLevel) {\n             Log.i(tag, message);\n         }\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n     public void info(String message, Throwable throwable) {\n         if (LOG_LEVEL_INFO >= this.logLevel) {\n             Log.i(tag, message, throwable);\n         }\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n     public void warning(String message) {\n         if (LOG_LEVEL_WARNING>= this.logLevel) {\n             Log.w(tag, message);\n         }\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8ed6437d7bf5e6ef56154967be0edafbf89aea"}, "originalPosition": 108}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f66804034cb2661f9e086c751a47eb8154afb55c", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/f66804034cb2661f9e086c751a47eb8154afb55c", "committedDate": "2020-01-27T17:07:23Z", "message": "Reverted the consolidation of all information providers."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "300763d41884d09a85f13ef746ab32cefc7d655a", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/300763d41884d09a85f13ef746ab32cefc7d655a", "committedDate": "2020-01-27T17:01:17Z", "message": "Reverted the consolidation of all information providers."}, "afterCommit": {"oid": "f66804034cb2661f9e086c751a47eb8154afb55c", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/f66804034cb2661f9e086c751a47eb8154afb55c", "committedDate": "2020-01-27T17:07:23Z", "message": "Reverted the consolidation of all information providers."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "007383bf293e9bf9d4127b39d513d038825cee5a", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/007383bf293e9bf9d4127b39d513d038825cee5a", "committedDate": "2020-01-28T23:09:30Z", "message": "Merge branch 'dev' of github.com:Azure/azure-sdk-for-android into code-cleanup\n\n# Conflicts:\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/implementation/util/serializer/SerializerAdapter.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/implementation/util/serializer/SerializerEncoding.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/implementation/util/serializer/SerializerFormat.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/http/rest/RetrofitAPIClient.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/ExceptionUtils.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/serializer/ByteArraySerializer.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/serializer/DateTimeRfc1123Serializer.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/serializer/JacksonAdapter.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/internal/util/serializer/SerializerEncoding.java\n#\tsdk/core/azure-core/src/main/java/com/azure/android/core/util/DateTimeRfc1123.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1374, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}