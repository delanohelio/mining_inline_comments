{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4ODM4MTQy", "number": 173, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTowOTo1OVrODbxWqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTowOTo1OVrODbxWqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQ2NzYxOnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "isResolved": false, "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTowOTo1OVrOFjcuug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQwMDozNDozNFrOFj-Xrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA==", "bodyText": "By making this change, do we actually need the AndroidApplicationInformationProvider to be public any more? Meaning it would be package-private, but people can still get an instance of it by calling this public method.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372715194", "createdAt": "2020-01-30T01:09:59Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTM3Ng==", "bodyText": "And if the answer is that it can be package-private, should we then move it out of the internal namespace and directly into com.azure.android.core.provider?", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372715376", "createdAt": "2020-01-30T01:10:37Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNjAwMg==", "bodyText": "We don't strictly need it to be public, I just thought it looked nicer to have them grouped like this. They can definitely be package-private. Would we prefer that?", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372716002", "createdAt": "2020-01-30T01:13:19Z", "author": {"login": "vcolin7"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxODU1MQ==", "bodyText": "We should use \"internal\" in the namespace in order to discourage customers from using a public class that we can't make private or package-private for whatever reason.\nIf we can make it package-private or private, we should do so, and leave \"internal\" for those edge cases. I'm fine with leaving the implementations in their own namespace com.azure.android.core.provider.implementation and just tightening up the access level for these classes to the least-visible option we can (I assume that's package-private).", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372718551", "createdAt": "2020-01-30T01:23:56Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcyMjM1OQ==", "bodyText": "Consumers pass these providers to userAgentInterceptor Ctr like:\n\n  \n    \n      azure-sdk-for-android/sdk/core/azure-core/src/main/java/com/azure/android/core/http/interceptor/UserAgentInterceptor.java\n    \n    \n        Lines 133 to 138\n      in\n      a9d9b5e\n    \n    \n    \n    \n\n        \n          \n           public UserAgentInterceptor(String sdkName, \n        \n\n        \n          \n                                       String sdkVersion, \n        \n\n        \n          \n                                       String applicationId, \n        \n\n        \n          \n                                       PlatformInformationProvider platformInformationProvider, \n        \n\n        \n          \n                                       ApplicationInformationProvider applicationInformationProvider, \n        \n\n        \n          \n                                       LocaleInformationProvider localeInformationProvider) { \n        \n    \n  \n\n\nI guess other than the unit test scenarios, we/consumers are going to call getDefault(Context|Configuration) on each of these provider interfaces and pass it to UserAgentInterceptor.\nI wonder it make sense to have a type that composes default providers then interceptor take that type.\ninterface EnvironmentInformation {\n   ApplicationInforationProvider getApplicationInformationProvider();\n   LocaleInformationProvider getLocaleInformationProvider();\n   PlatformInformationProvider getPlatformInformationProvider();\n\n   static EnvironmentInformation getDefault(Context cxt, Configuration cfg) {\n       return EnvironmentInformation() {\n           @Override\n           public ApplicationInformationProvider getApplicationInformationProvider() {\n               return ApplicationInformationProvider.createDefault(cxt);\n           }\n   \n           // and other providers\n       }\n  }\nthoughts?", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372722359", "createdAt": "2020-01-30T01:40:14Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcyNDE3Ng==", "bodyText": "Agree with you guys on keeping these default implementation package-private (in the same namespace as provider). I think we should put a type with \"PUBLIC\" access modifier in internal only if that's that only option because we want that type outside package but don't want customers to use it.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372724176", "createdAt": "2020-01-30T01:48:23Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgyMTM1Nw==", "bodyText": "@vcolin7 I didn't mean to hold on this PR with EnvironmentInformation. Let's discuss that in our next sync up to see it make sense. PR lgtm, just make sure the default provider impls are package-private.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r372821357", "createdAt": "2020-01-30T08:49:02Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE2NzA1Ng==", "bodyText": "@anuchandy I have wondered the same thing on iOS, but so far I haven't found it terribly cumbersome. I think most places will only need one or two providers, the UserAgent interceptor is sort of an exception.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r373167056", "createdAt": "2020-01-30T20:06:59Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE2OTg0MA==", "bodyText": "@anuchandy One thing that might be nice is a convenience constructor that takes the Context - this would be pretty familiar to most Android devs. E.g.:\npublic UserAgentInterceptor(@NonNull Context context,\n                            @NonNull String sdkName, \n                            @NonNull String sdkVersion, \n                            @Nullable String applicationId) {\n    this(sdkName,\n         sdkVersion,\n         applicationId, \n         PlatformInformationProvider.getDefault(context), \n         ApplicationInformationProvider.getDefault(context), \n         LocaleInformationProvider.getDefault(context)\n    )\n}\nIIRC the convention is that the context is usually the first parameter.\nWe did the same thing in iOS by using parameter defaults - the consumer can omit the provider-related parameters and in that case we will acquire instances of them from their respective default() methods inside the initializer. It's basically the same thing except we don't need the consumer to pass us a context object.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r373169840", "createdAt": "2020-01-30T20:12:55Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIyNTIzNg==", "bodyText": "@bsiegel sounds good, the LocaleInformationProvider requires Configuration instance to retrieve info it needed, so we might want to take @NonNull Context context, @NonNull Configuration conf", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r373225236", "createdAt": "2020-01-30T22:20:44Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIyODU3Nw==", "bodyText": "@anuchandy Can you not just retrieve that configuration object from the context?\nConfiguration config = context.getResources().getConfiguration();", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r373228577", "createdAt": "2020-01-30T22:29:09Z", "author": {"login": "bsiegel"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzI2NjM1MQ==", "bodyText": "cool, then I agree with your proposal of ctr taking context.", "url": "https://github.com/Azure/azure-sdk-for-android/pull/173#discussion_r373266351", "createdAt": "2020-01-31T00:34:34Z", "author": {"login": "anuchandy"}, "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/provider/ApplicationInformationProvider.java", "diffHunk": "@@ -1,9 +1,26 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n package com.azure.android.core.provider;\n \n+import android.content.Context;\n+\n+import com.azure.android.core.internal.provider.AndroidApplicationInformationProvider;\n+\n /**\n  * Interface for a provider that contains application information.\n  */\n public interface ApplicationInformationProvider {\n+    /**\n+     * Creates a default {@link ApplicationInformationProvider}.\n+     *\n+     * @param context Android {@link Context} object to extract data from.\n+     * @return A default {@link ApplicationInformationProvider}.\n+     */\n+    static ApplicationInformationProvider getDefault(Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTE5NA=="}, "originalCommit": {"oid": "e7452df489e01b646cfc5e29a62312012667de8c"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2317, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}