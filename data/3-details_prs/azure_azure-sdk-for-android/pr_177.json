{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNDU5MjA2", "number": 177, "title": "Created Storage sample app with blob listing and MSAL", "bodyText": "In collaboration with @anuchandy.\nThis depends on PR #174.", "createdAt": "2020-02-03T18:30:57Z", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177", "merged": true, "mergeCommit": {"oid": "973c9071c5505d12b7a2fcf5916f5ab109980a8e"}, "closed": true, "closedAt": "2020-02-06T23:17:37Z", "author": {"login": "vcolin7"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAxN33gH2gAyMzcwNDU5MjA2OjI4YWNkNzY1MjIyMTc4NDYyOGQ5ZDU5ZjNjM2ZhNTdjZTEwMzkzMzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBzKURABqjMwMTU4Mjc4OTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/28acd7652221784628d9d59f3c3fa57ce1039332", "committedDate": "2020-02-03T18:26:35Z", "message": "Moved the sample Storage app to root level, changed the folder structure to follow core and storage and refactored classes that required it. This work is based on the 'storage-client-prototype-1' branch by @anuchandy."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMjI4MzYz", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#pullrequestreview-353228363", "createdAt": "2020-02-04T19:08:26Z", "commit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6ea91b9be061ec9492f0492b48b7997e5859b60", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/b6ea91b9be061ec9492f0492b48b7997e5859b60", "committedDate": "2020-02-04T23:42:16Z", "message": "Fix Gradle build issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzcxMDc3", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#pullrequestreview-353371077", "createdAt": "2020-02-04T23:16:05Z", "commit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMzoxNjowNVrOFlm3eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMzoyMDozMlrOFlm9ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk3ODQyNA==", "bodyText": "Let's get this section sorted (editor should be able to just do a \"sort lines\")", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#discussion_r374978424", "createdAt": "2020-02-04T23:16:05Z", "author": {"login": "bsiegel"}, "path": "samples/sample-app-storage/build.gradle", "diffHunk": "@@ -0,0 +1,56 @@\n+apply plugin: 'com.android.application'\n+\n+android {\n+    compileSdkVersion 29\n+    buildToolsVersion \"29.0.2\"\n+\n+    defaultConfig {\n+        applicationId \"com.azure.android.storage.sample\"\n+        minSdkVersion 21\n+        targetSdkVersion 29\n+        versionCode 1\n+        versionName \"1.0\"\n+        testInstrumentationRunner \"androidx.test.runner.AndroidJUnitRunner\"\n+    }\n+\n+    compileOptions {\n+        sourceCompatibility JavaVersion.VERSION_1_8\n+        targetCompatibility JavaVersion.VERSION_1_8\n+    }\n+\n+    buildTypes {\n+        release {\n+            minifyEnabled false\n+            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n+        }\n+    }\n+}\n+\n+dependencies {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk3OTc2Mg==", "bodyText": "Can we add a comment here about what this type of exception means?", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#discussion_r374979762", "createdAt": "2020-02-04T23:19:55Z", "author": {"login": "bsiegel"}, "path": "samples/sample-app-storage/src/main/java/com/azure/android/storage/sample/MsalClient.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.azure.android.storage.sample;\n+\n+import android.app.Activity;\n+import android.util.Log;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.storage.sample.core.credential.AccessToken;\n+import com.azure.android.storage.sample.core.util.tokenrequest.TokenResponseCallback;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalClientException;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalServiceException;\n+import com.microsoft.identity.client.exception.MsalUiRequiredException;\n+\n+import org.threeten.bp.DateTimeUtils;\n+import org.threeten.bp.OffsetDateTime;\n+import org.threeten.bp.ZoneOffset;\n+\n+import java.util.Date;\n+\n+class MsalClient {\n+    private static final String TAG = MsalClient.class.getSimpleName();\n+\n+    private MsalClient() {}\n+\n+    public static void signIn(@NonNull final PublicClientApplication aadApp,\n+                       @NonNull final Activity activity,\n+                       @NonNull final String[] scopes,\n+                       @NonNull final TokenResponseCallback callback) {\n+        aadApp.getAccounts(accounts -> {\n+            if (!accounts.isEmpty()) {\n+                aadApp.acquireTokenSilentAsync(scopes, accounts.get(0), new AuthenticationCallback() {\n+                    @Override\n+                    public void onSuccess(IAuthenticationResult authResult) {\n+                        Log.d(TAG, \"[acquireTokenSilentAsync]: Successfully authenticated.\");\n+                        callback.onToken(new AccessToken(authResult.getAccessToken(),\n+                                toOffsetDateTime(authResult.getExpiresOn())));\n+                    }\n+\n+                    @Override\n+                    public void onError(MsalException exception) {\n+                        Log.d(TAG, \"[acquireTokenSilentAsync]: Authentication failed: \" + exception.toString());\n+                        if (exception instanceof MsalClientException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk3OTk2Mw==", "bodyText": "Nit: How do you feel about capitalizing this (and other MSAL-related classes) like MSALClient?", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#discussion_r374979963", "createdAt": "2020-02-04T23:20:32Z", "author": {"login": "bsiegel"}, "path": "samples/sample-app-storage/src/main/java/com/azure/android/storage/sample/MsalClient.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.azure.android.storage.sample;\n+\n+import android.app.Activity;\n+import android.util.Log;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.storage.sample.core.credential.AccessToken;\n+import com.azure.android.storage.sample.core.util.tokenrequest.TokenResponseCallback;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalClientException;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalServiceException;\n+import com.microsoft.identity.client.exception.MsalUiRequiredException;\n+\n+import org.threeten.bp.DateTimeUtils;\n+import org.threeten.bp.OffsetDateTime;\n+import org.threeten.bp.ZoneOffset;\n+\n+import java.util.Date;\n+\n+class MsalClient {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28acd7652221784628d9d59f3c3fa57ce1039332"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1e637e673dc47093049f05cef24920fedd6e3ad", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/a1e637e673dc47093049f05cef24920fedd6e3ad", "committedDate": "2020-02-06T03:21:07Z", "message": "Re-ordered the sample app's dependencies."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d892a581830da5445a8bec986488c3a71f63957b", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/d892a581830da5445a8bec986488c3a71f63957b", "committedDate": "2020-02-06T04:09:21Z", "message": "Added more info on MsalException and fixed a lint error in ContainerBlobsPagedListAdapter."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b744d033fc4d3ffc0f0cac1335ef7eeddb2e2c9", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/4b744d033fc4d3ffc0f0cac1335ef7eeddb2e2c9", "committedDate": "2020-02-06T04:11:35Z", "message": "Merge branch 'dev' into storage-sample-app"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8c445e828570134480c68db72548127e68ac652", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/a8c445e828570134480c68db72548127e68ac652", "committedDate": "2020-02-06T22:57:32Z", "message": "Re-applied changes to fix Gradle build issues (by @bsiegel here: https://github.com/Azure/azure-sdk-for-android/commit/b6ea91b9be061ec9492f0492b48b7997e5859b60)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0ODM4NzAz", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#pullrequestreview-354838703", "createdAt": "2020-02-06T23:13:20Z", "commit": {"oid": "a00a23c6c9cb9cd8894323687d0b5fb6443f0a80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0ODM4OTAz", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#pullrequestreview-354838903", "createdAt": "2020-02-06T23:13:46Z", "commit": {"oid": "a00a23c6c9cb9cd8894323687d0b5fb6443f0a80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMzoxMzo0N1rOFmtdhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMzoxMzo0N1rOFmtdhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEzNTA0NA==", "bodyText": "link should be : https://javadoc.io/static/com.microsoft.identity.client/msal/0.1.1/com/microsoft/identity/client/MsalUiRequiredException.html", "url": "https://github.com/Azure/azure-sdk-for-android/pull/177#discussion_r376135044", "createdAt": "2020-02-06T23:13:47Z", "author": {"login": "anuchandy"}, "path": "samples/sample-app-storage/src/main/java/com/azure/android/storage/sample/MsalClient.java", "diffHunk": "@@ -40,15 +40,18 @@ public void onSuccess(IAuthenticationResult authResult) {\n                                 toOffsetDateTime(authResult.getExpiresOn())));\n                     }\n \n-                    // For more info on MsalException, see: https://javadoc.io/doc/com.microsoft.identity.client/msal/0.1.1/com/microsoft/identity/client/MsalClientException.html\n                     @Override\n                     public void onError(MsalException exception) {\n                         Log.d(TAG, \"[acquireTokenSilentAsync]: Authentication failed: \" + exception.toString());\n                         if (exception instanceof MsalClientException) {\n+                            // Exception thrown for general errors that are local to the MSAL library. For more\n+                            // information, see: https://javadoc.io/doc/com.microsoft.identity.client/msal/0.1.1/com/microsoft/identity/client/MsalClientException.html\n                         } else if (exception instanceof MsalServiceException) {\n-                            /* Exception when communicating with the STS, likely config issue */\n+                            // Exception thrown when communicating with the STS, likely because of a configuration\n+                            // issue. For more information, see: https://javadoc.io/static/com.microsoft.identity.client/msal/0.1.1/com/microsoft/identity/client/MsalServiceException.html\n                         } else if (exception instanceof MsalUiRequiredException) {\n-                            /* Tokens expired or no session, retry with interactive */\n+                            // Exception thrown when auth token is expired or there is no active session, must retry\n+                            // with interactive login. For more information, see: https://javadoc.io/static/com.microsoft.identity.client/msal/0.1.1/com/microsoft/identity/client/MsalServiceException.html", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a00a23c6c9cb9cd8894323687d0b5fb6443f0a80"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7828e2317252dd4dcb43727deb205491444f54cb", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/7828e2317252dd4dcb43727deb205491444f54cb", "committedDate": "2020-02-06T23:16:10Z", "message": "Added more information on the different types of MsalException."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a00a23c6c9cb9cd8894323687d0b5fb6443f0a80", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/a00a23c6c9cb9cd8894323687d0b5fb6443f0a80", "committedDate": "2020-02-06T23:08:06Z", "message": "Added more information on the different types of MsalException."}, "afterCommit": {"oid": "7828e2317252dd4dcb43727deb205491444f54cb", "author": {"user": {"login": "vcolin7", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-android/commit/7828e2317252dd4dcb43727deb205491444f54cb", "committedDate": "2020-02-06T23:16:10Z", "message": "Added more information on the different types of MsalException."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1281, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}