{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNDIyNTc1", "number": 1903, "title": "ZK-4519: datebox constraint parsing errors if there are numbers in me\u2026", "bodyText": "\u2026ssage", "createdAt": "2020-03-04T09:06:41Z", "url": "https://github.com/zkoss/zk/pull/1903", "merged": true, "mergeCommit": {"oid": "dbb3095fac058f4d53fda6c3ad005d478107eab9"}, "closed": true, "closedAt": "2020-03-04T10:03:04Z", "author": {"login": "plijyfes"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKTdAMABqjMwOTU2MzM2NjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKT_ePgFqTM2ODY0NDQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1afb82da8ce8731fbe1480d0483984cdbaae984", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/b1afb82da8ce8731fbe1480d0483984cdbaae984", "committedDate": "2020-03-04T08:52:44Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}, "afterCommit": {"oid": "0abc6aa3c50c2af01edb4dc9832fa4719ad3640b", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/0abc6aa3c50c2af01edb4dc9832fa4719ad3640b", "committedDate": "2020-03-04T09:24:55Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0abc6aa3c50c2af01edb4dc9832fa4719ad3640b", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/0abc6aa3c50c2af01edb4dc9832fa4719ad3640b", "committedDate": "2020-03-04T09:24:55Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}, "afterCommit": {"oid": "bd17e41e29b3b6920e782974208c8c62ae0cbf9e", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/bd17e41e29b3b6920e782974208c8c62ae0cbf9e", "committedDate": "2020-03-04T09:26:49Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd17e41e29b3b6920e782974208c8c62ae0cbf9e", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/bd17e41e29b3b6920e782974208c8c62ae0cbf9e", "committedDate": "2020-03-04T09:26:49Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}, "afterCommit": {"oid": "ae283ef87e265a8443a8c4601532d3b1a0a8b410", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/ae283ef87e265a8443a8c4601532d3b1a0a8b410", "committedDate": "2020-03-04T09:30:32Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjI3MzY0", "url": "https://github.com/zkoss/zk/pull/1903#pullrequestreview-368627364", "createdAt": "2020-03-04T09:39:19Z", "commit": {"oid": "ae283ef87e265a8443a8c4601532d3b1a0a8b410"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwOTozOToxOVrOFxmFHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwOTozOToxOVrOFxmFHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU0ODQ0Ng==", "bodyText": "use split(\":\") get0", "url": "https://github.com/zkoss/zk/pull/1903#discussion_r387548446", "createdAt": "2020-03-04T09:39:19Z", "author": {"login": "plijyfes"}, "path": "zul/src/org/zkoss/zul/SimpleDateConstraint.java", "diffHunk": "@@ -119,19 +119,24 @@ public SimpleDateConstraint(int flags, Date begin, Date end, String errmsg) {\n \t */\n \tpublic SimpleDateConstraint(String constraint) {\n \t\tsuper(constraint);\n-\t\tif (!isValidConstraint(constraint))\n-\t\t\tthrow new UiException(\"Invalid constraint: \" + constraint + \" (the constraint should be formatted in yyyyMMdd)\");\n+\t\tcheckValidConstraint(constraint);\n \t}\n \n-\tprivate boolean isValidConstraint(String constraint) {\n+\tprivate void checkValidConstraint(String constraint) {\n \t\tint constraintFormatLength = \"yyyyMMdd\".length(); // default constraint format is yyyyMMdd\n-\t\tPattern numberOnly = Pattern.compile(\"\\\\d+\");\n-\t\tMatcher matcher = numberOnly.matcher(constraint);\n-\t\twhile (matcher.find()) {\n-\t\t\tif (matcher.group().length() != constraintFormatLength)\n-\t\t\t\treturn false;\n+\t\tString[] constraintParts = constraint.split(\",\");\n+\t\tPattern numberStartWithKeyword;\n+\t\tfor (String part: constraintParts) {\n+\t\t\tif (part.contains(\":\")) // should ignore message", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae283ef87e265a8443a8c4601532d3b1a0a8b410"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjM0NDc5", "url": "https://github.com/zkoss/zk/pull/1903#pullrequestreview-368634479", "createdAt": "2020-03-04T09:49:04Z", "commit": {"oid": "ae283ef87e265a8443a8c4601532d3b1a0a8b410"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaae813a746f074fcaa9299530913eff1740d529", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/aaae813a746f074fcaa9299530913eff1740d529", "committedDate": "2020-03-04T09:55:49Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae283ef87e265a8443a8c4601532d3b1a0a8b410", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/ae283ef87e265a8443a8c4601532d3b1a0a8b410", "committedDate": "2020-03-04T09:30:32Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}, "afterCommit": {"oid": "aaae813a746f074fcaa9299530913eff1740d529", "author": {"user": {"login": "plijyfes", "name": "LeonLee"}}, "url": "https://github.com/zkoss/zk/commit/aaae813a746f074fcaa9299530913eff1740d529", "committedDate": "2020-03-04T09:55:49Z", "message": "ZK-4519: datebox constraint parsing errors if there are numbers in message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjQyNDU2", "url": "https://github.com/zkoss/zk/pull/1903#pullrequestreview-368642456", "createdAt": "2020-03-04T09:59:58Z", "commit": {"oid": "aaae813a746f074fcaa9299530913eff1740d529"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjQ0NDM5", "url": "https://github.com/zkoss/zk/pull/1903#pullrequestreview-368644439", "createdAt": "2020-03-04T10:02:51Z", "commit": {"oid": "aaae813a746f074fcaa9299530913eff1740d529"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}