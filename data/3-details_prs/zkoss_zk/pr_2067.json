{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MDc0MTA5", "number": 2067, "title": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the\u2026", "bodyText": "\u2026 active item\nOpen menupopup by keyboard, focus on the first menuitem", "createdAt": "2020-07-27T10:39:29Z", "url": "https://github.com/zkoss/zk/pull/2067", "merged": true, "mergeCommit": {"oid": "3d7adcf0cab41505693645a06918553d1d923722"}, "closed": true, "closedAt": "2020-07-29T10:38:53Z", "author": {"login": "scribetw"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5ReswgBqjM1OTMwNTIzNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5ol9nAFqTQ1NzM5OTc1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23dc9bcfd09ee972e556fd70ba10beb47f950a31", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/23dc9bcfd09ee972e556fd70ba10beb47f950a31", "committedDate": "2020-07-27T10:37:44Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}, "afterCommit": {"oid": "d19bf4c10e23e0a94ea6b9c684024f58057ee334", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/d19bf4c10e23e0a94ea6b9c684024f58057ee334", "committedDate": "2020-07-28T07:35:11Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d19bf4c10e23e0a94ea6b9c684024f58057ee334", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/d19bf4c10e23e0a94ea6b9c684024f58057ee334", "committedDate": "2020-07-28T07:35:11Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}, "afterCommit": {"oid": "294de9c12e19b0a4ee61eeffcc6247e9b94a5df6", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/294de9c12e19b0a4ee61eeffcc6247e9b94a5df6", "committedDate": "2020-07-28T07:54:24Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "294de9c12e19b0a4ee61eeffcc6247e9b94a5df6", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/294de9c12e19b0a4ee61eeffcc6247e9b94a5df6", "committedDate": "2020-07-28T07:54:24Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}, "afterCommit": {"oid": "e3250d04ee500c6e16fba3b25233209fffe0bf22", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/e3250d04ee500c6e16fba3b25233209fffe0bf22", "committedDate": "2020-07-28T08:17:15Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e3250d04ee500c6e16fba3b25233209fffe0bf22", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/e3250d04ee500c6e16fba3b25233209fffe0bf22", "committedDate": "2020-07-28T08:17:15Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem"}, "afterCommit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/df7fbb448933959a7b2feb682003675ff3d74224", "committedDate": "2020-07-28T08:39:01Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDc3MTcw", "url": "https://github.com/zkoss/zk/pull/2067#pullrequestreview-456477170", "createdAt": "2020-07-28T09:50:20Z", "commit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo1MDoyMFrOG4FQxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo1NDozOVrOG4FacA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1OTY1NQ==", "bodyText": "modify _curIndex", "url": "https://github.com/zkoss/zk/pull/2067#discussion_r461459655", "createdAt": "2020-07-28T09:50:20Z", "author": {"login": "scribetw"}, "path": "zul/src/archive/web/js/zul/menu/Menuitem.js", "diffHunk": "@@ -370,8 +372,20 @@ zul.menu.Menuitem = zk.$extends(zul.LabelImageWidget, {\n \t\treturn this.$n('a');\n \t},\n \t_doMouseEnter: function (evt) {\n-\t\tif (zul.menu._nOpen || this.isTopmost())\n+\t\tvar isTopmost = this.isTopmost();\n+\t\tif (zul.menu._nOpen || isTopmost)\n \t\t\tzWatch.fire('onFloatUp', this); //notify all\n+\t\tif (!isTopmost && !this._disabled) {\n+\t\t\tif (this.parent)\n+\t\t\t\tthis.parent.removeActive_();\n+\t\t\tthis.$class._addActive(this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1OTc4OQ==", "bodyText": "_curIndex = -1", "url": "https://github.com/zkoss/zk/pull/2067#discussion_r461459789", "createdAt": "2020-07-28T09:50:32Z", "author": {"login": "scribetw"}, "path": "zul/src/archive/web/js/zul/menu/Menuitem.js", "diffHunk": "@@ -370,8 +372,20 @@ zul.menu.Menuitem = zk.$extends(zul.LabelImageWidget, {\n \t\treturn this.$n('a');\n \t},\n \t_doMouseEnter: function (evt) {\n-\t\tif (zul.menu._nOpen || this.isTopmost())\n+\t\tvar isTopmost = this.isTopmost();\n+\t\tif (zul.menu._nOpen || isTopmost)\n \t\t\tzWatch.fire('onFloatUp', this); //notify all\n+\t\tif (!isTopmost && !this._disabled) {\n+\t\t\tif (this.parent)\n+\t\t\t\tthis.parent.removeActive_();\n+\t\t\tthis.$class._addActive(this);\n+\t\t}\n+\t},\n+\t_doMouseLeave: function (evt) {\n+\t\tvar isTopmost = this.isTopmost();\n+\t\tif (!isTopmost && !this._disabled) {\n+\t\t\tthis.$class._rmActive(this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ2MjEyOA==", "bodyText": "activating the menuitem, regain the focus", "url": "https://github.com/zkoss/zk/pull/2067#discussion_r461462128", "createdAt": "2020-07-28T09:54:39Z", "author": {"login": "scribetw"}, "path": "zul/src/archive/web/js/zul/menu/Menupopup.js", "diffHunk": "@@ -358,16 +354,18 @@ zul.menu.Menupopup = zk.$extends(zul.wgt.Popup, {\n \t\t\t\tvar root = _getRootMenu(this);\n \t\t\t\tif (root && (root = root._getPrevVisibleMenu()))\n \t\t\t\t\t_activateNextMenu(root);\n-\t\t\t\telse // the parent is not menu widget\n+\t\t\t\telse { // the parent is not menu widget\n+\t\t\t\t\tvar ref = this._fakeParent;\n \t\t\t\t\tthis.close();\n-\n+\t\t\t\t\tif (ref) ref.focus();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224"}, "originalPosition": 119}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df7fbb448933959a7b2feb682003675ff3d74224", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/df7fbb448933959a7b2feb682003675ff3d74224", "committedDate": "2020-07-28T08:39:01Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}, "afterCommit": {"oid": "98c21ba203d05a8d80ddb5094fb452d8d9909b77", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/98c21ba203d05a8d80ddb5094fb452d8d9909b77", "committedDate": "2020-07-29T04:27:04Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ee01f981c5bd1c77ab267137fd851d917c83362", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/7ee01f981c5bd1c77ab267137fd851d917c83362", "committedDate": "2020-07-29T06:53:45Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "98c21ba203d05a8d80ddb5094fb452d8d9909b77", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/98c21ba203d05a8d80ddb5094fb452d8d9909b77", "committedDate": "2020-07-29T04:27:04Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}, "afterCommit": {"oid": "7ee01f981c5bd1c77ab267137fd851d917c83362", "author": {"user": {"login": "scribetw", "name": "Scribe Huang"}}, "url": "https://github.com/zkoss/zk/commit/7ee01f981c5bd1c77ab267137fd851d917c83362", "committedDate": "2020-07-29T06:53:45Z", "message": "refine ZK-4598: Menupopup mouse hovering on a menu/menuitem moves the active item\nOpen menupopup by keyboard, focus on the first menuitem\nClose menupopup, regain the focus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3Mzk1NDY3", "url": "https://github.com/zkoss/zk/pull/2067#pullrequestreview-457395467", "createdAt": "2020-07-29T10:30:44Z", "commit": {"oid": "7ee01f981c5bd1c77ab267137fd851d917c83362"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3Mzk5NzU2", "url": "https://github.com/zkoss/zk/pull/2067#pullrequestreview-457399756", "createdAt": "2020-07-29T10:37:26Z", "commit": {"oid": "7ee01f981c5bd1c77ab267137fd851d917c83362"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 113, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}