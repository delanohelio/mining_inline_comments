{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNjE5MjU2", "number": 2753, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNDoyNFrOD4_GVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNDoyNFrOD4_GVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDgwNjYwOnYy", "diffSide": "RIGHT", "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNDoyNFrOGQAHYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNToyMjo0OFrOGRYaGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzMjI4OQ==", "bodyText": "I would suggest something like lang3.isNotBlank() rather than just comparing with \"\", to catch whitespace of nonzero length.  I think I've actually seen this happen.\n(Separately, ought we to have Metadatavalue require a non-null language to be a valid ISO 639-1 code?)", "url": "https://github.com/DSpace/DSpace/pull/2753#discussion_r419432289", "createdAt": "2020-05-04T13:24:24Z", "author": {"login": "mwoodiupui"}, "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "diffHunk": "@@ -725,7 +725,14 @@ protected void addDCValue(Context c, Item i, String schema, Node n) throws Trans\n         String qualifier = getAttributeValue(n, \"qualifier\"); //NodeValue();\n         // //getElementData(n,\n         // \"qualifier\");\n-        String language = getAttributeValue(n, \"language\");\n+\n+        String language = null;\n+\n+        //DS-4493 protection against initialising as an empty string\n+        if (!\"\".equals(getAttributeValue(n, \"language\"))){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQ4NDA1OQ==", "bodyText": "+1 on using isNotBlank(). Something similar was done in #2350.", "url": "https://github.com/DSpace/DSpace/pull/2753#discussion_r419484059", "createdAt": "2020-05-04T14:35:34Z", "author": {"login": "nwoodward"}, "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "diffHunk": "@@ -725,7 +725,14 @@ protected void addDCValue(Context c, Item i, String schema, Node n) throws Trans\n         String qualifier = getAttributeValue(n, \"qualifier\"); //NodeValue();\n         // //getElementData(n,\n         // \"qualifier\");\n-        String language = getAttributeValue(n, \"language\");\n+\n+        String language = null;\n+\n+        //DS-4493 protection against initialising as an empty string\n+        if (!\"\".equals(getAttributeValue(n, \"language\"))){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzMjI4OQ=="}, "originalCommit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg2NTM1OQ==", "bodyText": "@bram-atmire : I agree with the feedback of @mwoodiupui and @nwoodward here.  This should be updated.  It also looks like it may need porting to master.", "url": "https://github.com/DSpace/DSpace/pull/2753#discussion_r420865359", "createdAt": "2020-05-06T15:05:06Z", "author": {"login": "tdonohue"}, "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "diffHunk": "@@ -725,7 +725,14 @@ protected void addDCValue(Context c, Item i, String schema, Node n) throws Trans\n         String qualifier = getAttributeValue(n, \"qualifier\"); //NodeValue();\n         // //getElementData(n,\n         // \"qualifier\");\n-        String language = getAttributeValue(n, \"language\");\n+\n+        String language = null;\n+\n+        //DS-4493 protection against initialising as an empty string\n+        if (!\"\".equals(getAttributeValue(n, \"language\"))){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzMjI4OQ=="}, "originalCommit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg3ODg3Mw==", "bodyText": "Thanks @mwoodiupui @nwoodward @tdonohue , agreed & resolved.", "url": "https://github.com/DSpace/DSpace/pull/2753#discussion_r420878873", "createdAt": "2020-05-06T15:22:48Z", "author": {"login": "bram-atmire"}, "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "diffHunk": "@@ -725,7 +725,14 @@ protected void addDCValue(Context c, Item i, String schema, Node n) throws Trans\n         String qualifier = getAttributeValue(n, \"qualifier\"); //NodeValue();\n         // //getElementData(n,\n         // \"qualifier\");\n-        String language = getAttributeValue(n, \"language\");\n+\n+        String language = null;\n+\n+        //DS-4493 protection against initialising as an empty string\n+        if (!\"\".equals(getAttributeValue(n, \"language\"))){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzMjI4OQ=="}, "originalCommit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1501, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}