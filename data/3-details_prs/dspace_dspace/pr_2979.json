{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMzU4OTg0", "number": 2979, "title": "Submission bugfix for file upload mandatory", "bodyText": "Description\nWhen verifying whether the file upload is mandatory, the submission REST API always verified for the submission step with name \"upload\" instead of the current step\nInstructions for Reviewers\nConfigure a new submission step, with a different name (not upload).\nSet file upload optional for this step\nVerify whether REST no longer claims there are validation errors due to missing files\nChecklist\nThis checklist provides a reminder of what we are going to look for when reviewing your PR. You need not complete this checklist prior to creating your PR (draft PRs are always welcome). If you are unsure about an item in the checklist, don't hesitate to ask. We're here to help!\n\n My PR is small in size (e.g. less than 1,000 lines of code, not including comments & integration tests). Exceptions may be made if previously agreed upon.\n My PR passes Checkstyle validation based on the Code Style Guide.\n My PR includes Javadoc for all new (or modified) public methods and classes. It also includes Javadoc for large or complex private methods.\n My PR passes all tests and includes new/updated Unit or Integration Tests based on the Code Testing Guide.\n If my PR includes new, third-party dependencies (in any pom.xml), I've made sure their licenses align with the DSpace BSD License based on the Licensing of Contributions documentation.\n If my PR modifies the REST API, I've linked to the REST Contract page (or open PR) related to this change.", "createdAt": "2020-09-21T14:51:11Z", "url": "https://github.com/DSpace/DSpace/pull/2979", "merged": true, "mergeCommit": {"oid": "541903bdb0d9e93e241195d134c1339179393359"}, "closed": true, "closedAt": "2020-10-01T19:22:12Z", "author": {"login": "benbosman"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLAniJgH2gAyNDkwMzU4OTg0Ojg4ZTA3M2Q4ZjJkZWFhMjNhZDIxNTVhYTkxNmZlNmM0MGQ4YWU0M2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOWdJDgFqTUwMDY0OTM4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "88e073d8f2deaa23ad2155aa916fe6c40d8ae43c", "author": {"user": {"login": "benbosman", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/88e073d8f2deaa23ad2155aa916fe6c40d8ae43c", "committedDate": "2020-09-21T10:13:35Z", "message": "bugfix to verify whether a file is mandatory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NzAyMjY4", "url": "https://github.com/DSpace/DSpace/pull/2979#pullrequestreview-498702268", "createdAt": "2020-09-29T17:06:09Z", "commit": {"oid": "88e073d8f2deaa23ad2155aa916fe6c40d8ae43c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNzowNjowOVrOHZ4cog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNzowNjowOVrOHZ4cog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjkwMTI4Mg==", "bodyText": "@benbosman : While this is a one line change, it looks slightly odd to me, as the previous line is an if statement looking for the \"key\" to match.\nDoes this method need further refactoring?  It almost seems like previously we had to loop through the keys in the uploadConfigurationService to locate the one that matched with UploadValidation.getName().   Now, it looks like the loop has no purpose, as we're just calling get(config.getId()) to grab the UploadConfiguration that we want directly.\nAm I misunderstanding this tiny change?  It almost seems like we can remove this for loop entirely.", "url": "https://github.com/DSpace/DSpace/pull/2979#discussion_r496901282", "createdAt": "2020-09-29T17:06:09Z", "author": {"login": "tdonohue"}, "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/submit/step/validation/UploadValidation.java", "diffHunk": "@@ -43,7 +43,7 @@\n \n         for (String key : uploadConfigurationService.getMap().keySet()) {\n             if (getName().equals(key)) {\n-                UploadConfiguration uploadConfig = uploadConfigurationService.getMap().get(key);\n+                UploadConfiguration uploadConfig = uploadConfigurationService.getMap().get(config.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e073d8f2deaa23ad2155aa916fe6c40d8ae43c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f824c0642073d96ae6c3907361c9f040bd0db5d", "author": {"user": {"login": "benbosman", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/8f824c0642073d96ae6c3907361c9f040bd0db5d", "committedDate": "2020-10-01T14:17:26Z", "message": "for loop is not applicable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjQ5Mzgx", "url": "https://github.com/DSpace/DSpace/pull/2979#pullrequestreview-500649381", "createdAt": "2020-10-01T19:21:55Z", "commit": {"oid": "8f824c0642073d96ae6c3907361c9f040bd0db5d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1339, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}