{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MzIxMjM3", "number": 2909, "title": "Support multiple dsoType values in discovery", "bodyText": "References\n\nRelated to REST Contract\n\nDescription\nThis is a minor change to support e.g. /server/api/discover/search/objects?dsoType=Collection&dsoType=Community to return communities and collections\nWe discovered this was relevant to create the Angular UI to import or export a CSV, where a collection or community should be selected (and both should be selectable)\nInstructions for Reviewers\nThere's no need to reindex data. You can test it using:\n\nno dsoType parameter\n/server/api/discover/search/objects?dsoType=Collection&dsoType=Community\n/server/api/discover/search/objects?dsoType=Item\n/server/api/discover/search/objects?dsoType=Item&dsoType=Collection\n\u2026\n\nChecklist\nThis checklist provides a reminder of what we are going to look for when reviewing your PR. You need not complete this checklist prior to creating your PR (draft PRs are always welcome). If you are unsure about an item in the checklist, don't hesitate to ask. We're here to help!\n\n My PR is small in size (e.g. less than 1,000 lines of code, not including comments & integration tests). Exceptions may be made if previously agreed upon.\n My PR passes Checkstyle validation based on the Code Style Guide.\n My PR includes Javadoc for all new (or modified) public methods and classes. It also includes Javadoc for large or complex private methods.\n My PR passes all tests and includes new/updated Unit or Integration Tests based on the Code Testing Guide.\n If my PR includes new, third-party dependencies (in any pom.xml), I've made sure their licenses align with the DSpace BSD License based on the Licensing of Contributions documentation.\n If my PR modifies the REST API, I've linked to the REST Contract page (or open PR) related to this change.", "createdAt": "2020-07-29T09:44:57Z", "url": "https://github.com/DSpace/DSpace/pull/2909", "merged": true, "mergeCommit": {"oid": "2027b03a8d9ed3d03aad9312649983205173dab7"}, "closed": true, "closedAt": "2020-08-05T14:45:25Z", "author": {"login": "benbosman"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5msn_AH2gAyNDU4MzIxMjM3Ojg4ZTFlY2MwYTk4ZjBkYTNmMjU1MjdkNmFhOGVjYjBmMzg1MWNjNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc78VVKgFqTQ2MTczNjIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "88e1ecc0a98f0da3f25527d6aa8ecb0f3851cc53", "author": {"user": {"login": "samuelcambien", "name": "Samuel Cambien (Atmire)"}}, "url": "https://github.com/DSpace/DSpace/commit/88e1ecc0a98f0da3f25527d6aa8ecb0f3851cc53", "committedDate": "2020-07-29T08:24:54Z", "message": "taskid 71899 Support multiple dsoType values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzExNDgw", "url": "https://github.com/DSpace/DSpace/pull/2909#pullrequestreview-459311480", "createdAt": "2020-07-31T16:39:53Z", "commit": {"oid": "88e1ecc0a98f0da3f25527d6aa8ecb0f3851cc53"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNjozOTo1M1rOG6O7Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNjo0MDowOVrOG6O73A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNTE1NA==", "bodyText": "Could you please add Javadocs to this new method?", "url": "https://github.com/DSpace/DSpace/pull/2909#discussion_r463715154", "createdAt": "2020-07-31T16:39:53Z", "author": {"login": "tdonohue"}, "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/utils/DiscoverQueryBuilder.java", "diffHunk": "@@ -71,8 +75,19 @@ public DiscoverQuery buildQuery(Context context, IndexableObject scope,\n                                     String dsoType, Pageable page)\n         throws DSpaceBadRequestException {\n \n+        List<String> dsoTypes = dsoType != null ? singletonList(dsoType) : emptyList();\n+\n+        return buildQuery(context, scope, discoveryConfiguration, query, searchFilters, dsoTypes, page);\n+    }\n+\n+    public DiscoverQuery buildQuery(Context context, IndexableObject scope,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e1ecc0a98f0da3f25527d6aa8ecb0f3851cc53"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNTI5Mg==", "bodyText": "Again, please add Javadocs to this new method.", "url": "https://github.com/DSpace/DSpace/pull/2909#discussion_r463715292", "createdAt": "2020-07-31T16:40:09Z", "author": {"login": "tdonohue"}, "path": "dspace-server-webapp/src/main/java/org/dspace/app/rest/utils/DiscoverQueryBuilder.java", "diffHunk": "@@ -104,8 +119,20 @@ public DiscoverQuery buildFacetQuery(Context context, IndexableObject scope,\n                                          String dsoType, Pageable page, String facetName)\n         throws DSpaceBadRequestException {\n \n+        List<String> dsoTypes = dsoType != null ? singletonList(dsoType) : emptyList();\n+\n+        return buildFacetQuery(\n+                context, scope, discoveryConfiguration, prefix, query, searchFilters, dsoTypes, page, facetName);\n+    }\n+\n+    public DiscoverQuery buildFacetQuery(Context context, IndexableObject scope,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e1ecc0a98f0da3f25527d6aa8ecb0f3851cc53"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94394d8e593d3d2b65daf6464f2ad0b5e30cc510", "author": {"user": {"login": "samuelcambien", "name": "Samuel Cambien (Atmire)"}}, "url": "https://github.com/DSpace/DSpace/commit/94394d8e593d3d2b65daf6464f2ad0b5e30cc510", "committedDate": "2020-08-05T10:25:05Z", "message": "taskid 71899 Support multiple dsoType values - add typedocs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNzM2MjE2", "url": "https://github.com/DSpace/DSpace/pull/2909#pullrequestreview-461736216", "createdAt": "2020-08-05T14:45:13Z", "commit": {"oid": "94394d8e593d3d2b65daf6464f2ad0b5e30cc510"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1545, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}