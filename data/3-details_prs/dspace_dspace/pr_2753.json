{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNjE5MjU2", "number": 2753, "title": "DS-4493 prevent empty string assignment for language", "bodyText": "References\n\nhttps://jira.lyrasis.org/browse/DS-4493\n\nDescription\nPrevention of empty string (\"\") being assigned to language codes during import", "createdAt": "2020-05-03T15:24:09Z", "url": "https://github.com/DSpace/DSpace/pull/2753", "merged": true, "mergeCommit": {"oid": "f34d81f9ef8b80f6067aecd2e19bba066ff20b4d"}, "closed": true, "closedAt": "2021-08-23T09:09:35Z", "author": {"login": "bram-atmire"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccnbXagH2gAyNDEyNjE5MjU2OmFlN2EyMmQyNWY3MjViYjAzZTc5MjVjM2JhYzRhN2I2ZTVjNDc0NmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABe3JE3agFqTczNTg5MDc3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a", "author": {"user": {"login": "bram-atmire", "name": "Bram Luyten"}}, "url": "https://github.com/DSpace/DSpace/commit/ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a", "committedDate": "2020-04-30T06:52:09Z", "message": "DS-4493 prevent empty string assignment for language"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0OTgyMzgy", "url": "https://github.com/DSpace/DSpace/pull/2753#pullrequestreview-404982382", "createdAt": "2020-05-04T13:24:24Z", "commit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNDoyNFrOGQAHYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNDoyNFrOGQAHYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzMjI4OQ==", "bodyText": "I would suggest something like lang3.isNotBlank() rather than just comparing with \"\", to catch whitespace of nonzero length.  I think I've actually seen this happen.\n(Separately, ought we to have Metadatavalue require a non-null language to be a valid ISO 639-1 code?)", "url": "https://github.com/DSpace/DSpace/pull/2753#discussion_r419432289", "createdAt": "2020-05-04T13:24:24Z", "author": {"login": "mwoodiupui"}, "path": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImportServiceImpl.java", "diffHunk": "@@ -725,7 +725,14 @@ protected void addDCValue(Context c, Item i, String schema, Node n) throws Trans\n         String qualifier = getAttributeValue(n, \"qualifier\"); //NodeValue();\n         // //getElementData(n,\n         // \"qualifier\");\n-        String language = getAttributeValue(n, \"language\");\n+\n+        String language = null;\n+\n+        //DS-4493 protection against initialising as an empty string\n+        if (!\"\".equals(getAttributeValue(n, \"language\"))){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae7a22d25f725bb03e7925c3bac4a7b6e5c4746a"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ec197e06e78b2553001a2b0f15208a365911edd", "author": {"user": {"login": "bram-atmire", "name": "Bram Luyten"}}, "url": "https://github.com/DSpace/DSpace/commit/2ec197e06e78b2553001a2b0f15208a365911edd", "committedDate": "2020-05-06T15:21:49Z", "message": "DS-4493 improving empty string check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzM1ODkwNzcy", "url": "https://github.com/DSpace/DSpace/pull/2753#pullrequestreview-735890772", "createdAt": "2021-08-23T09:08:41Z", "commit": {"oid": "2ec197e06e78b2553001a2b0f15208a365911edd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1438, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}