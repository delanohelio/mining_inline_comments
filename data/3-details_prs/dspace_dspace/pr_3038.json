{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyODk0NDI3", "number": 3038, "title": "Importing new csv with relationships", "bodyText": "References\n\nFixes #3008\n\nDescription\nThis PR ensures that Relationships can be created through the importing of CSVs to create Items and alter existing Items.\nInstructions for Reviewers\nList of changes in this PR:\n\nCreation of Relationships is possible through the import CSV\nAdded tests for this\n\nHow to test this PR:\n\nCreate a CSV for a new Item, add a Relationship.type metadatafield and a relationship. metadatafield in the headers. Fill them in with proper values\nVerify that an Item is created with a Relationship to the specified item in the CSV\nRepeat but for an existing Item, verify that a new Relationship is made\n\nChecklist\n\n My PR is small in size (e.g. less than 1,000 lines of code, not including comments & integration tests). Exceptions may be made if previously agreed upon.\n My PR passes Checkstyle validation based on the Code Style Guide.\n My PR includes Javadoc for all new (or modified) public methods and classes. It also includes Javadoc for large or complex private methods.\n My PR passes all tests and includes new/updated Unit or Integration Tests based on the Code Testing Guide.\n If my PR includes new, third-party dependencies (in any pom.xml), I've made sure their licenses align with the DSpace BSD License based on the Licensing of Contributions documentation.\n If my PR modifies the REST API, I've linked to the REST Contract page (or open PR) related to this change.", "createdAt": "2020-10-30T10:16:56Z", "url": "https://github.com/DSpace/DSpace/pull/3038", "merged": true, "mergeCommit": {"oid": "6ac06c8a23b2d2abbaf5ac3dd0bd780395a414da"}, "closed": true, "closedAt": "2020-11-10T17:38:22Z", "author": {"login": "Raf-atmire"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXjBICAH2gAyNTEyODk0NDI3OjI3YTYxNzMzNjAwYmIzZTcwN2RlMjcxZmRkZmYyMGVhM2FmZTNjMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbM8GnAFqTUyNzQ0NzU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "27a61733600bb3e707de271fddff20ea3afe3c10", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/27a61733600bb3e707de271fddff20ea3afe3c10", "committedDate": "2020-10-30T09:05:24Z", "message": "[Task 71782] created support to check relationship.type metadata from the csv instead of the item which won't yet exist\n\nConflicts:\n\tdspace-api/src/test/java/org/dspace/app/bulkedit/MetadataImportTest.java\n\tdspace-api/src/test/resources/test-config.properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3df1ff5f70d1949f8be4dbcfaa975f739f732151", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/3df1ff5f70d1949f8be4dbcfaa975f739f732151", "committedDate": "2020-10-30T09:06:04Z", "message": "[Task 71782] added test to the MetadataImport tests\n\nConflicts:\n\tdspace-api/src/test/java/org/dspace/app/bulkedit/MetadataImportTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e33cc4735dae2bd5fbfbc38547112e944e338670", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/e33cc4735dae2bd5fbfbc38547112e944e338670", "committedDate": "2020-10-30T09:06:42Z", "message": "Fixed imports for MetadataImportTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eaa53c53b1281311212b87aefd0df1b4ac5ed884", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/eaa53c53b1281311212b87aefd0df1b4ac5ed884", "committedDate": "2020-10-30T10:12:40Z", "message": "Rewrote MetadataImportTest with builders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d4151c22fac2acfc53a636b200ebfab5fb46b43", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/9d4151c22fac2acfc53a636b200ebfab5fb46b43", "committedDate": "2020-10-30T10:13:26Z", "message": "deleting unused files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NTE1MDA1", "url": "https://github.com/DSpace/DSpace/pull/3038#pullrequestreview-526515005", "createdAt": "2020-11-09T18:01:46Z", "commit": {"oid": "9d4151c22fac2acfc53a636b200ebfab5fb46b43"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NjYyNTI1", "url": "https://github.com/DSpace/DSpace/pull/3038#pullrequestreview-526662525", "createdAt": "2020-11-09T21:19:16Z", "commit": {"oid": "9d4151c22fac2acfc53a636b200ebfab5fb46b43"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQyMToxOToxNlrOHwCAjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQyMToxOToxNlrOHwCAjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDEyNjYwNA==", "bodyText": "Small thing...this is an Integration Test, so it should be renamed MetadataImportIT.", "url": "https://github.com/DSpace/DSpace/pull/3038#discussion_r520126604", "createdAt": "2020-11-09T21:19:16Z", "author": {"login": "tdonohue"}, "path": "dspace-api/src/test/java/org/dspace/app/bulkedit/MetadataImportTest.java", "diffHunk": "@@ -10,63 +10,75 @@\n import static junit.framework.TestCase.assertEquals;\n import static junit.framework.TestCase.assertTrue;\n \n+import java.io.BufferedWriter;\n import java.io.File;\n+import java.io.FileOutputStream;\n+import java.io.OutputStreamWriter;\n+import java.sql.SQLException;\n+import java.util.List;\n \n import org.apache.commons.cli.ParseException;\n+import org.apache.commons.collections4.IteratorUtils;\n import org.apache.commons.lang3.StringUtils;\n-import org.dspace.AbstractIntegrationTest;\n+import org.dspace.AbstractIntegrationTestWithDatabase;\n import org.dspace.app.launcher.ScriptLauncher;\n import org.dspace.app.scripts.handler.impl.TestDSpaceRunnableHandler;\n+import org.dspace.builder.CollectionBuilder;\n+import org.dspace.builder.CommunityBuilder;\n+import org.dspace.builder.EntityTypeBuilder;\n+import org.dspace.builder.ItemBuilder;\n+import org.dspace.builder.RelationshipTypeBuilder;\n import org.dspace.content.Collection;\n import org.dspace.content.Community;\n+import org.dspace.content.EntityType;\n import org.dspace.content.Item;\n+import org.dspace.content.Relationship;\n import org.dspace.content.factory.ContentServiceFactory;\n-import org.dspace.content.service.CollectionService;\n-import org.dspace.content.service.CommunityService;\n import org.dspace.content.service.ItemService;\n+import org.dspace.content.service.RelationshipService;\n+import org.dspace.eperson.factory.EPersonServiceFactory;\n+import org.dspace.eperson.service.EPersonService;\n import org.dspace.scripts.DSpaceRunnable;\n import org.dspace.scripts.configuration.ScriptConfiguration;\n import org.dspace.scripts.factory.ScriptServiceFactory;\n import org.dspace.scripts.service.ScriptService;\n-import org.junit.Rule;\n+import org.junit.Before;\n import org.junit.Test;\n-import org.junit.rules.ExpectedException;\n \n-public class MetadataImportTest extends AbstractIntegrationTest {\n+public class MetadataImportTest extends AbstractIntegrationTestWithDatabase {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d4151c22fac2acfc53a636b200ebfab5fb46b43"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1cc44ebac859ab622a3d526fb90bcfeeb938698", "author": {"user": {"login": "Raf-atmire", "name": null}}, "url": "https://github.com/DSpace/DSpace/commit/a1cc44ebac859ab622a3d526fb90bcfeeb938698", "committedDate": "2020-11-10T13:43:53Z", "message": "Renamed MetadataImportTest to MetadataImportIT to better reflect that it is an Integration Test class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NDQ3NTQ4", "url": "https://github.com/DSpace/DSpace/pull/3038#pullrequestreview-527447548", "createdAt": "2020-11-10T17:37:42Z", "commit": {"oid": "a1cc44ebac859ab622a3d526fb90bcfeeb938698"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1375, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}