{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NTQxNzA1", "number": 2281, "title": "[java] Implement AST-based symbols", "bodyText": "Add AST-based symbol implementations. This reuses QualifiedNameResolver to set symbols on the relevant nodes. When we remove qualified names (depends on #2241), we can reuse and simplify this class just to build the symbols.\nRefs #2178\nThe next step is to add  local symbol tables (for variables, type parameters, member types). With this the symbol table is smart enough for everything except resolving inherited members. This will bring it on par with the current symbol table.", "createdAt": "2020-02-12T21:24:22Z", "url": "https://github.com/pmd/pmd/pull/2281", "merged": true, "mergeCommit": {"oid": "fee7bd83bbc184c7d3c662ca82e716f3364d2a17"}, "closed": true, "closedAt": "2020-02-20T10:18:14Z", "author": {"login": "oowekyala"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDpYepAH2gAyMzc0NTQxNzA1OjlkMTdiYjU5ZDVjY2NjMzY1ZDk1Yzg3MGJlZjA3ODlkYjc5ZWJmMzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGH00FgH2gAyMzc0NTQxNzA1OmUyNzM0Y2RhY2MzYTFhZjFiODI2YzY4OGMyNDdkZmQ0N2Y0MmUzZjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9d17bb59d5cccc365d95c870bef0789db79ebf37", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/9d17bb59d5cccc365d95c870bef0789db79ebf37", "committedDate": "2020-02-12T17:00:42Z", "message": "Checkout AST symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16b8be05db7a2cd41efd53b3db413fe99c5cedc9", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/16b8be05db7a2cd41efd53b3db413fe99c5cedc9", "committedDate": "2020-02-12T17:01:22Z", "message": "Checkout ast sym tables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9ccaa682178ada7ab122bb5a39d7a726cd3800f", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/e9ccaa682178ada7ab122bb5a39d7a726cd3800f", "committedDate": "2020-02-12T17:01:24Z", "message": "Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65263b3285ac8a3ac1fc920f7379170c83db8ea7", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/65263b3285ac8a3ac1fc920f7379170c83db8ea7", "committedDate": "2020-02-12T17:01:24Z", "message": "Test type params scoping"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de9daf43605546b296bc72b3e3caab5d7d4b54f9", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/de9daf43605546b296bc72b3e3caab5d7d4b54f9", "committedDate": "2020-02-12T17:01:24Z", "message": "Make decent toStrings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c53aed240c7e541d6de9b00ba550301372c5e0c1", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/c53aed240c7e541d6de9b00ba550301372c5e0c1", "committedDate": "2020-02-12T17:01:24Z", "message": "Fix scoping in modifier lists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65329d60bd5accbeca26359a3c601b0150ca2f5a", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/65329d60bd5accbeca26359a3c601b0150ca2f5a", "committedDate": "2020-02-12T17:01:24Z", "message": "Fix scope of for statements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a451a4aae807a2abbbf22cb2a4089533058bc275", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/a451a4aae807a2abbbf22cb2a4089533058bc275", "committedDate": "2020-02-12T17:01:55Z", "message": "Simplify some things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd6c63984396d55ad925e31ea5fb6deb82e5d01e", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/dd6c63984396d55ad925e31ea5fb6deb82e5d01e", "committedDate": "2020-02-12T17:01:56Z", "message": "Handle synthetic symbols more generally"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b1d3a9ee7a2589e42eeb18cf67767d6892ba6b6", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/2b1d3a9ee7a2589e42eeb18cf67767d6892ba6b6", "committedDate": "2020-02-12T17:01:56Z", "message": "Checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87afc7360cb3fdeda29d5573914abc5e3aa0b81a", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/87afc7360cb3fdeda29d5573914abc5e3aa0b81a", "committedDate": "2020-02-12T17:01:56Z", "message": "Add tests for ast symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1404ce062620f0253cf163345e630f76163ea61", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/f1404ce062620f0253cf163345e630f76163ea61", "committedDate": "2020-02-12T17:01:56Z", "message": "Reactivate old symtable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c6f5a2e3a9c7d7b3ad3793a4d2326646c0b8ddd", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/9c6f5a2e3a9c7d7b3ad3793a4d2326646c0b8ddd", "committedDate": "2020-02-12T17:01:56Z", "message": "Checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1154c7493c7c335f86381b2a99b1a9b79aeea25", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/f1154c7493c7c335f86381b2a99b1a9b79aeea25", "committedDate": "2020-02-12T20:46:26Z", "message": "REVERT ME: Remove local sym tables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "094ba5f447779eb606358f476ce4df10ad3b8abb", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/094ba5f447779eb606358f476ce4df10ad3b8abb", "committedDate": "2020-02-12T20:46:30Z", "message": "Cleanup toString"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a4efa268d1d88ca3d2db3884ff3456b7db0f1e8", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/7a4efa268d1d88ca3d2db3884ff3456b7db0f1e8", "committedDate": "2020-02-12T20:46:30Z", "message": "Add sym visitor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9719637b88ff6a65ca3b906826256454593b0700", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/9719637b88ff6a65ca3b906826256454593b0700", "committedDate": "2020-02-12T20:46:30Z", "message": "Fix build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19d8e2fc6943e6fc7b224724fbcd998d4a969c37", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/19d8e2fc6943e6fc7b224724fbcd998d4a969c37", "committedDate": "2020-02-12T20:46:30Z", "message": "REVERT ME remove dependency on #2271"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e6da0006909f5a099b95f7a492c2bdb49d6f342", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/9e6da0006909f5a099b95f7a492c2bdb49d6f342", "committedDate": "2020-02-12T20:46:30Z", "message": "Make base class for symbol declarators"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33afd7e0de4f0e68c6f71b0b2a749332c43b34b6", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/33afd7e0de4f0e68c6f71b0b2a749332c43b34b6", "committedDate": "2020-02-12T20:46:30Z", "message": "Simplify factory logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c81633a884fbff66a20490f63776501a3cfff46", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/4c81633a884fbff66a20490f63776501a3cfff46", "committedDate": "2020-02-12T20:46:30Z", "message": "Add a bunch of additional tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35193446c471523b3654e3304897c33f0d78405c", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/35193446c471523b3654e3304897c33f0d78405c", "committedDate": "2020-02-12T21:20:58Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a39819a473b6938d32a42a5f082323f2081c57a3", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/a39819a473b6938d32a42a5f082323f2081c57a3", "committedDate": "2020-02-17T22:39:25Z", "message": "Merge branch 'java-grammar' into sym-ast-impl3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a7e2766f8983cbaf2e4d39a55756908d0c8e21f", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/3a7e2766f8983cbaf2e4d39a55756908d0c8e21f", "committedDate": "2020-02-17T22:40:04Z", "message": "Revert \"REVERT ME remove dependency on #2271\"\n\nThis reverts commit 19d8e2fc6943e6fc7b224724fbcd998d4a969c37."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/184b368c8249ae7556002b3d4977be1ac9c95bb6", "committedDate": "2020-02-19T13:53:35Z", "message": "Merge branch 'java-grammar' into sym-ast-impl3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzIyNzk4", "url": "https://github.com/pmd/pmd/pull/2281#pullrequestreview-361722798", "createdAt": "2020-02-20T08:52:33Z", "commit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwODo1MjozM1rOFsKygw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOToyNzo1MlrOFsL91A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg1ODQzNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Returns the canonical name of this class, it it exists.\n          \n          \n            \n                 * Returns the canonical name of this class, if it exists.", "url": "https://github.com/pmd/pmd/pull/2281#discussion_r381858435", "createdAt": "2020-02-20T08:52:33Z", "author": {"login": "adangel"}, "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/ast/ASTAnyTypeDeclaration.java", "diffHunk": "@@ -49,9 +55,57 @@ default String getSimpleName() {\n      * Returns the binary name of this type declaration. This\n      * is like {@link Class#getName()}.\n      */\n-    // @NotNull\n+    @NonNull\n     String getBinaryName();\n \n+\n+    /**\n+     * Returns the canonical name of this class, it it exists.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2MzczOQ==", "bodyText": "This is a bit surprising in comparison the formal parameters - in ASTFormalParameter, the owner node is the direct parent and not the grand parent. Maybe something to consider later?\nASTFormalParameter::getOwnerList() vs. ASTTypeParameter::getOwner() ...", "url": "https://github.com/pmd/pmd/pull/2281#discussion_r381863739", "createdAt": "2020-02-20T09:02:29Z", "author": {"login": "adangel"}, "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/ast/ASTTypeParameter.java", "diffHunk": "@@ -62,6 +64,13 @@ public ASTType getTypeBoundNode() {\n         return getFirstChildOfType(ASTType.class);\n     }\n \n+    /**\n+     * Returns the node to which this type parameter belongs.\n+     */\n+    public TypeParamOwnerNode getOwner() {\n+        return (TypeParamOwnerNode) jjtGetParent().jjtGetParent();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2OTY4Mg==", "bodyText": "So this will become what previously was called \"SymbolTableFacade\"? \ud83d\udc4d", "url": "https://github.com/pmd/pmd/pull/2281#discussion_r381869682", "createdAt": "2020-02-20T09:13:41Z", "author": {"login": "adangel"}, "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/qname/QualifiedNameResolver.java", "diffHunk": "@@ -18,20 +20,30 @@\n import net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration;\n import net.sourceforge.pmd.lang.java.ast.ASTCompilationUnit;\n import net.sourceforge.pmd.lang.java.ast.ASTConstructorDeclaration;\n+import net.sourceforge.pmd.lang.java.ast.ASTFormalParameter;\n import net.sourceforge.pmd.lang.java.ast.ASTFormalParameters;\n import net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration;\n+import net.sourceforge.pmd.lang.java.ast.ASTMethodOrConstructorDeclaration;\n import net.sourceforge.pmd.lang.java.ast.ASTPackageDeclaration;\n+import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;\n import net.sourceforge.pmd.lang.java.ast.InternalApiBridge;\n import net.sourceforge.pmd.lang.java.ast.JavaParserVisitorAdapter;\n import net.sourceforge.pmd.lang.java.ast.JavaQualifiableNode;\n import net.sourceforge.pmd.lang.java.ast.internal.PrettyPrintingUtil;\n import net.sourceforge.pmd.lang.java.qname.ImmutableList.ListFactory;\n-import net.sourceforge.pmd.lang.java.typeresolution.PMDASMClassLoader;\n+import net.sourceforge.pmd.lang.java.symbols.JClassSymbol;\n+import net.sourceforge.pmd.lang.java.symbols.JExecutableSymbol;\n+import net.sourceforge.pmd.lang.java.symbols.JTypeParameterOwnerSymbol;\n+import net.sourceforge.pmd.lang.java.symbols.internal.impl.ast.AstSymFactory;\n \n \n /**\n  * Populates {@link JavaQualifiableNode} instances with their qualified names.\n  *\n+ * <p>In fact, populates symbols on declaration nodes.\n+ * TODO in the near future we'll get rid of qualified names, and can\n+ * reuse this class just to build symbols (moving it to symbols.impl.ast).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MzAzMA==", "bodyText": "This looks like another API PMD provides now... we'll definitively need good documentations and usage examples...", "url": "https://github.com/pmd/pmd/pull/2281#discussion_r381873030", "createdAt": "2020-02-20T09:19:45Z", "author": {"login": "adangel"}, "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/symbols/SymbolVisitor.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.lang.java.symbols;\n+\n+/**\n+ * Visitor over symbols.\n+ */\n+public interface SymbolVisitor<R, P> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3NzcxNg==", "bodyText": "I'm wondering, whether we really want to have both internal and impl - what's the difference? Looks to me the same...", "url": "https://github.com/pmd/pmd/pull/2281#discussion_r381877716", "createdAt": "2020-02-20T09:27:52Z", "author": {"login": "adangel"}, "path": "pmd-java/src/main/java/net/sourceforge/pmd/lang/java/symbols/internal/impl/ast/AbstractAstBackedSymbol.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.lang.java.symbols.internal.impl.ast;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184b368c8249ae7556002b3d4977be1ac9c95bb6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2734cdacc3a1af1b826c688c247dfd47f42e3f4", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/e2734cdacc3a1af1b826c688c247dfd47f42e3f4", "committedDate": "2020-02-20T09:36:39Z", "message": "Update pmd-java/src/main/java/net/sourceforge/pmd/lang/java/ast/ASTAnyTypeDeclaration.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4880, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}