{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTU4NzQ1", "number": 2195, "title": "[modelica] Normalize invalid node ranges", "bodyText": "Some files were parsed into ASTs with nodes having negative ranges.\nFor example:\npackage TestPackage\n  package EmptyPackage\n  end EmptyPackage;\nend TestPackage;\nhas subtree:\n  SimpleLongClassSpecifier \"EmptyPackage\"\n    SimpleName \"EmptyPackage\"\n    Composition\n      ElementList <-- start = 3:3, end = 2:22\n    SimpleName \"EmptyPackage\"", "createdAt": "2020-01-03T11:30:13Z", "url": "https://github.com/pmd/pmd/pull/2195", "merged": true, "mergeCommit": {"oid": "394de28a0d3c0ee7dee91a25f3100ac884fd3511"}, "closed": true, "closedAt": "2020-01-06T17:44:47Z", "author": {"login": "atrosinenko"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2srANAH2gAyMzU4OTU4NzQ1OjRmM2RiODZhNzA4N2Q3MDZlMDk0NmY5OWVmZmYwNDlhMTExYmU2ZTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb3b6jCgH2gAyMzU4OTU4NzQ1OjM5NGRlMjhhMGQzYzBlZTdkZWU5MWEyNWYzMTAwYWM4ODRmZDM1MTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4f3db86a7087d706e0946f99efff049a111be6e1", "author": {"user": {"login": "atrosinenko", "name": "Anatoly Trosinenko"}}, "url": "https://github.com/pmd/pmd/commit/4f3db86a7087d706e0946f99efff049a111be6e1", "committedDate": "2020-01-03T11:29:38Z", "message": "[modelica] Normalize invalid node ranges\n\nSome files were parsed into ASTs with nodes having negative ranges.\nFor example:\n\npackage TestPackage\n  package EmptyPackage\n  end EmptyPackage;\nend TestPackage;\n\nhas subtree:\n\n  SimpleLongClassSpecifier \"EmptyPackage\"\n    SimpleName \"EmptyPackage\"\n    Composition\n      ElementList <-- start = 3:3, end = 2:22\n    SimpleName \"EmptyPackage\""}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4Mjc1MTQy", "url": "https://github.com/pmd/pmd/pull/2195#pullrequestreview-338275142", "createdAt": "2020-01-03T21:06:42Z", "commit": {"oid": "4f3db86a7087d706e0946f99efff049a111be6e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QyMTowNjo0MlrOFaJZ1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QyMTowNjo0MlrOFaJZ1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk2MTM2NA==", "bodyText": "You could avoid doing any of that (in jjtOpen/Close) if instead of using the fields of AbstractNode, you delegated the method calls to the tokens, eg:\n\n  \n    \n      pmd/pmd-java/src/main/java/net/sourceforge/pmd/lang/java/ast/AbstractJavaNode.java\n    \n    \n        Lines 33 to 51\n      in\n      a802874\n    \n    \n    \n    \n\n        \n          \n           @Override \n        \n\n        \n          \n           public int getBeginLine() { \n        \n\n        \n          \n               return jjtGetFirstToken().getBeginLine(); \n        \n\n        \n          \n           } \n        \n\n        \n          \n            \n        \n\n        \n          \n           @Override \n        \n\n        \n          \n           public int getBeginColumn() { \n        \n\n        \n          \n               return jjtGetFirstToken().getBeginColumn(); \n        \n\n        \n          \n           } \n        \n\n        \n          \n            \n        \n\n        \n          \n           @Override \n        \n\n        \n          \n           public int getEndLine() { \n        \n\n        \n          \n               return jjtGetLastToken().getEndLine(); \n        \n\n        \n          \n           } \n        \n\n        \n          \n            \n        \n\n        \n          \n           @Override \n        \n\n        \n          \n           public int getEndColumn() { \n        \n\n        \n          \n               return jjtGetLastToken().getEndColumn(); \n        \n\n        \n          \n           }", "url": "https://github.com/pmd/pmd/pull/2195#discussion_r362961364", "createdAt": "2020-01-03T21:06:42Z", "author": {"login": "oowekyala"}, "path": "pmd-modelica/src/main/java/net/sourceforge/pmd/lang/modelica/ast/AbstractModelicaNode.java", "diffHunk": "@@ -66,6 +66,14 @@ public void jjtClose() {\n         }\n         endLine = parser.token.endLine;\n         endColumn = parser.token.endColumn;\n+\n+        if (endLine < beginLine) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f3db86a7087d706e0946f99efff049a111be6e1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9dbe0233facac2a907dce716e0a3376e96e2cc6", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/e9dbe0233facac2a907dce716e0a3376e96e2cc6", "committedDate": "2020-01-05T18:06:32Z", "message": "Use implicit zero-length token in modelica"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f61522971773d62f97e433a324c9d6a898bc732", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/6f61522971773d62f97e433a324c9d6a898bc732", "committedDate": "2020-01-05T18:22:17Z", "message": "Test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "394de28a0d3c0ee7dee91a25f3100ac884fd3511", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/394de28a0d3c0ee7dee91a25f3100ac884fd3511", "committedDate": "2020-01-05T18:32:09Z", "message": "Set image"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4838, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}