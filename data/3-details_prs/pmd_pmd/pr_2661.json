{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1Nzg1Mzg2", "number": 2661, "title": "[apex] Make apex visitor generic", "bodyText": "Describe the PR\nMake the apex visitor generic. This also changes some conventions:\n\n\nThe method visit(ApexNode<?> node, P data) is now called visitApexNode. This avoids overloading all the other visit methods, so that it is clearer what method gets called.\n\nFor example, you don't need to upcast the node to select that overload. Previously you had to call visit((ApexNode<?>) node, data), now you can call visitApexNode(node, data). You can't mess it up anymore, and mistakenly forget the cast, which would select another overload\nAnother this it's good for, is that the implementations of acceptVisitor cannot select visitApexNode by mistake now. This spots cases, where we add a node and forget to add a method to the visitor. This mistake was present for ASTApexFile (refs #2491):\n\nThe code for jjtAccept was copypasted and called visitor.visit(node, data).\nThere was no overload specific to ASTApexFile, so the selected overload was the default visitApexNode behavior, but this was silent.\n\n\n\n\n\nSimilarly, the implementation of acceptVisitor with the more specific ApexVisitor parameter is named acceptApexVisitor to avoid overload selection conflicts, that need to be resolved through casts\n\n\nthe umbrella visit methods, eg the common method to which visit(ASTUserClass and visit(ASTUserInterface delegate, is also renamed so as not to overload other visit methods. Eg here it's called visitTypeDecl.\n\n\nWith this scheme\n\nonly concrete node types have a method named exactly visit\nfor each concrete node type there's exactly one of those methods, that is applicable. So there can be no overload conflicts that need casts to be resolved\nif there is none, and we copy-paste the acceptVisitor code, then it will fail to compile and warn us that the visitor needs a new method\nselecting another compatible method is clear at the call site visitTypeDecl, visitApexNode, visitNode\n\nI think this naming scheme should be used in other modules too. Especially with the newer java grammar, where there are a few more instances of visitor method delegation (eg for expressions, etc)\nRelated issues\n\n\nPart of #880\n\nReady?\n\n\n Added unit tests for fixed bug/feature\n Passing all unit tests\n Complete build ./mvnw clean verify passes (checked automatically by travis)\n Added (in-code) documentation (if needed)", "createdAt": "2020-07-23T15:18:06Z", "url": "https://github.com/pmd/pmd/pull/2661", "merged": true, "mergeCommit": {"oid": "da3d06377c715fc8dbcf94ee6291337d2c2e9b34"}, "closed": true, "closedAt": "2020-08-23T14:53:58Z", "author": {"login": "oowekyala"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3wB_WAH2gAyNDU1Nzg1Mzg2OjlkZDM3MDIzNmJlMTFjODcyMGM3ZWZhODg4NTAyZDE1NTc4ZjgxNWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBaXZlgFqTQ3MjkzMDM0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9dd370236be11c8720c7efa888502d15578f815e", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/9dd370236be11c8720c7efa888502d15578f815e", "committedDate": "2020-07-23T14:09:32Z", "message": "Add default method to apex visitor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97322010e10b11ff9fc3d001d9ab633b57662def", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/97322010e10b11ff9fc3d001d9ab633b57662def", "committedDate": "2020-07-23T14:09:45Z", "message": "Remove 'reduced' visitor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "783a7b0583a9ccde26ea2044b76b3e26230860ca", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/783a7b0583a9ccde26ea2044b76b3e26230860ca", "committedDate": "2020-07-23T14:49:18Z", "message": "Update jjtAccept"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b81baebf79fd150415ed4f4aeef15c179061018c", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/b81baebf79fd150415ed4f4aeef15c179061018c", "committedDate": "2020-07-23T14:56:50Z", "message": "Convert cyclo visitor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "437222db2249d5a413a41e429bc73f2e63d32224", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/437222db2249d5a413a41e429bc73f2e63d32224", "committedDate": "2020-07-23T15:07:14Z", "message": "Fix rules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b15b8ad5874566c891ab074c983e0280ad38a41", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/5b15b8ad5874566c891ab074c983e0280ad38a41", "committedDate": "2020-07-23T15:13:53Z", "message": "Fix metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c481b4e90a96fa31f1be930c4ab975ca8082142a", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/c481b4e90a96fa31f1be930c4ab975ca8082142a", "committedDate": "2020-07-24T19:25:37Z", "message": "Merge branch '7.0.x' into apex-generic-visitor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyOTMwMTMz", "url": "https://github.com/pmd/pmd/pull/2661#pullrequestreview-472930133", "createdAt": "2020-08-22T14:30:09Z", "commit": {"oid": "c481b4e90a96fa31f1be930c4ab975ca8082142a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQxNDozMDowOVrOHFFlZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQxNDozMDowOVrOHFFlZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTA5NjQyMA==", "bodyText": "Since we deleting this on pmd7, should we deprecate this on pmd6?", "url": "https://github.com/pmd/pmd/pull/2661#discussion_r475096420", "createdAt": "2020-08-22T14:30:09Z", "author": {"login": "adangel"}, "path": "pmd-apex/src/main/java/net/sourceforge/pmd/lang/apex/ast/ApexParserVisitorReducedAdapter.java", "diffHunk": "@@ -1,29 +0,0 @@\n-/*\n- * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n- */\n-\n-package net.sourceforge.pmd.lang.apex.ast;\n-\n-/**\n- * @author Cl\u00e9ment Fournier\n- */\n-public class ApexParserVisitorReducedAdapter extends ApexParserVisitorAdapter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c481b4e90a96fa31f1be930c4ab975ca8082142a"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyOTMwMzQx", "url": "https://github.com/pmd/pmd/pull/2661#pullrequestreview-472930341", "createdAt": "2020-08-22T14:34:15Z", "commit": {"oid": "c481b4e90a96fa31f1be930c4ab975ca8082142a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4642, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}