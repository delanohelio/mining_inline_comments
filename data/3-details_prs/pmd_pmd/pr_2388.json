{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MTIzNTUw", "number": 2388, "title": "[lang-test] Use tree dumps for regression tests", "bodyText": "This makes it possible to write parser tests that just compare a dump of the AST against a baseline. This can make for cheap regression tests, which can be useful\n\nin language modules which use an external parser, and so the structure can easily change when upgrading the parser library (eg Javascript, Apex, Scala).\nin newer language modules, where the amount of tests to write to get decent parser coverage is overwhelming (eg Scala)\nto support parser features that may easily change in the future, eg Java preview features\n\nI extracted the AST printer from the designer codebase, so that the designer can use this printer in the next update\nThis adds a few tests for Scala as a PoC", "createdAt": "2020-03-28T17:01:58Z", "url": "https://github.com/pmd/pmd/pull/2388", "merged": true, "mergeCommit": {"oid": "85924b5ad185fab7b8a1199bff606da081b0e82b"}, "closed": true, "closedAt": "2020-04-11T13:20:18Z", "author": {"login": "oowekyala"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSIJrkAH2gAyMzk1MTIzNTUwOmJiOTIwNDRhMTU2OWM2NzQ0MjU3OTI3ZmYzYmQyN2Q3OWVlMmFlMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWlbQ6gFqTM5MTc2NDI2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bb92044a1569c6744257927ff3bd27d79ee2ae2b", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/bb92044a1569c6744257927ff3bd27d79ee2ae2b", "committedDate": "2020-03-28T16:46:32Z", "message": "Add ability to test an AST dump as cheap regression test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c83790fab5473eae7bc0521f41afd6524984e921", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/c83790fab5473eae7bc0521f41afd6524984e921", "committedDate": "2020-03-28T16:46:33Z", "message": "Recycle tree printer from the designer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ddc628cdc3435586294fec39ed5716be7e321f", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/09ddc628cdc3435586294fec39ed5716be7e321f", "committedDate": "2020-03-28T16:46:33Z", "message": "Fix reference files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89cddd8aa8991d15b61f1e9d904656be8b1f2d94", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/89cddd8aa8991d15b61f1e9d904656be8b1f2d94", "committedDate": "2020-03-28T16:46:33Z", "message": "Use parsing helper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f36835638fd3fa17dc15d196f785524f5f6ac211", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/f36835638fd3fa17dc15d196f785524f5f6ac211", "committedDate": "2020-03-28T16:46:33Z", "message": "Add some scala tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e89c54fcf9df1e2730e6dde608975889d9e8bc2f", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/e89c54fcf9df1e2730e6dde608975889d9e8bc2f", "committedDate": "2020-03-28T17:01:32Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e84349531b2c8cd0d5614036ba7e05bed0b77804", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/e84349531b2c8cd0d5614036ba7e05bed0b77804", "committedDate": "2020-03-29T07:17:49Z", "message": "Normalize line endings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cbfdfdd9904b688511585614a18f8b319ff9365", "author": {"user": {"login": "oowekyala", "name": "Cl\u00e9ment Fournier"}}, "url": "https://github.com/pmd/pmd/commit/5cbfdfdd9904b688511585614a18f8b319ff9365", "committedDate": "2020-03-29T07:21:38Z", "message": "Use ascii printer for tree dumps\n\nSome environments may not display\nthe structure correctly otherwise. See\neg https://travis-ci.org/github/pmd/pmd/jobs/668122788#L9312-L9322"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzY0MjYw", "url": "https://github.com/pmd/pmd/pull/2388#pullrequestreview-391764260", "createdAt": "2020-04-11T12:57:44Z", "commit": {"oid": "5cbfdfdd9904b688511585614a18f8b319ff9365"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMjo1Nzo0NFrOGENCSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMjo1Nzo0NFrOGENCSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MTA2NQ==", "bodyText": "I think, now that this class is in pmd-core, we can remove it from pmd-designer, don't we?", "url": "https://github.com/pmd/pmd/pull/2388#discussion_r407061065", "createdAt": "2020-04-11T12:57:44Z", "author": {"login": "adangel"}, "path": "pmd-core/src/main/java/net/sourceforge/pmd/util/treeexport/TextTreeRenderer.java", "diffHunk": "@@ -0,0 +1,210 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.util.treeexport;\n+\n+import java.io.IOException;\n+\n+import net.sourceforge.pmd.annotation.Experimental;\n+import net.sourceforge.pmd.lang.ast.Node;\n+import net.sourceforge.pmd.properties.AbstractPropertySource;\n+import net.sourceforge.pmd.properties.PropertyDescriptor;\n+import net.sourceforge.pmd.properties.PropertyFactory;\n+import net.sourceforge.pmd.properties.PropertySource;\n+\n+/**\n+ * A simple recursive printer. Output looks like so:\n+ *\n+ * <pre>\n+ *\n+ * +- LocalVariableDeclaration\n+ *    +- Type\n+ *    |  +- PrimitiveType\n+ *    +- VariableDeclarator\n+ *       +- VariableDeclaratorId\n+ *       +- VariableInitializer\n+ *          +- 1 child not shown\n+ *\n+ * </pre>\n+ *\n+ * or\n+ *\n+ * <pre>\n+ *\n+ * \u2514\u2500 LocalVariableDeclaration\n+ *    \u251c\u2500 Type\n+ *    \u2502  \u2514\u2500 PrimitiveType\n+ *    \u2514\u2500 VariableDeclarator\n+ *       \u251c\u2500 VariableDeclaratorId\n+ *       \u2514\u2500 VariableInitializer\n+ *          \u2514\u2500 1 child not shown\n+ *\n+ * </pre>\n+ *\n+ *\n+ * By default just prints the structure, like shown above. You can\n+ * configure it to render nodes differently by overriding {@link #appendNodeInfoLn(Appendable, Node)}.\n+ */\n+@Experimental\n+public class TextTreeRenderer implements TreeRenderer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cbfdfdd9904b688511585614a18f8b319ff9365"}, "originalPosition": 50}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4747, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}