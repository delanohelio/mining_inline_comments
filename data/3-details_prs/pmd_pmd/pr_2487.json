{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4OTk2MDM4", "number": 2487, "title": "[all] Cleanup rule test xml", "bodyText": "Describe the PR\nThis does a big cleanup of all of our rule test xml cases, so that\n\nall xml files are no consistent in formatting (description doesn't use CDATA, indentation for XML and test code is correct)\nnew contributors are not confused anymore when to use CDATA or not\n\nI've added a small section in the docs. Most of the changes is whitespace (tabs, indentation). I've changed a few times the test case description if it was obviously wrong or missing.\nSo, best to be viewed with \"hide whitespace changes\": https://github.com/pmd/pmd/pull/2487/files?diff=unified&w=1\nRelated issues\n\nnone\n\nReady?\n\n\n Added unit tests for fixed bug/feature\n Passing all unit tests\n Complete build ./mvnw clean verify passes (checked automatically by travis)\n Added (in-code) documentation (if needed)", "createdAt": "2020-05-16T17:09:33Z", "url": "https://github.com/pmd/pmd/pull/2487", "merged": true, "mergeCommit": {"oid": "09a30d2ef50f534b838fca045f26d68ebb8e2bec"}, "closed": true, "closedAt": "2020-05-22T18:03:30Z", "author": {"login": "adangel"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABch5p7TAH2gAyNDE4OTk2MDM4OmY5MzA0OTE1MzhkZGQxNmRhZTA3NDIwODk5YzliNDRhMTRkMjViYmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABciku2qAFqTQxMzg2NDkxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f930491538ddd16dae07420899c9b44a14d25bbe", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/f930491538ddd16dae07420899c9b44a14d25bbe", "committedDate": "2020-05-16T16:55:58Z", "message": "[apex] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9828c2acb27b5766a6331d285b4994c1e32a34f", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/b9828c2acb27b5766a6331d285b4994c1e32a34f", "committedDate": "2020-05-16T16:56:04Z", "message": "[java] Cleanup rule test xml files (bestpractices)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b19b888a6e1d5bcf3aa3ec278e29fd17788913dd", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/b19b888a6e1d5bcf3aa3ec278e29fd17788913dd", "committedDate": "2020-05-16T16:56:04Z", "message": "[java] Cleanup rule test xml files (codestyle)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c914a2a5542cdb5c1d889b753c30fa36a0a823a", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/6c914a2a5542cdb5c1d889b753c30fa36a0a823a", "committedDate": "2020-05-16T16:56:04Z", "message": "[java] Cleanup rule test xml files (design)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ec063b63879b182db69d2745439feb6da48c776", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/9ec063b63879b182db69d2745439feb6da48c776", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files (documentation)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a80bc88276ba83ab7809138c209c6c657ba107ff", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/a80bc88276ba83ab7809138c209c6c657ba107ff", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files (errorprone)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11d886ec4164263bac67346b5d0d65f9adbc478b", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/11d886ec4164263bac67346b5d0d65f9adbc478b", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files (multithreading)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fd74794c82e8fa7d3673c8283a3d8a025465b47", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/3fd74794c82e8fa7d3673c8283a3d8a025465b47", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files (performance)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ed25a9277f9e6159b0027f770c5ab878c2ae626", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/5ed25a9277f9e6159b0027f770c5ab878c2ae626", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files (security)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c2c111492e49c59137f3d1f7868baa24285c19c", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/4c2c111492e49c59137f3d1f7868baa24285c19c", "committedDate": "2020-05-16T16:56:05Z", "message": "[javascript] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edc40521a3517bd016b262d933ca9812c45ba72e", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/edc40521a3517bd016b262d933ca9812c45ba72e", "committedDate": "2020-05-16T16:56:05Z", "message": "[visualforce] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48da3feee0094c6de6546f61e5ccb0cc0519b588", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/48da3feee0094c6de6546f61e5ccb0cc0519b588", "committedDate": "2020-05-16T16:56:05Z", "message": "[modelica] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7334738a975fce080cace8943808cdac64e4ed20", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/7334738a975fce080cace8943808cdac64e4ed20", "committedDate": "2020-05-16T16:56:05Z", "message": "[plsql] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fef1ad76c6198387df487f3e36c630836292fd2c", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/fef1ad76c6198387df487f3e36c630836292fd2c", "committedDate": "2020-05-16T16:56:05Z", "message": "[vm] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3215c830d8d5247a4faa9e3e4e78e4b56eda244", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/b3215c830d8d5247a4faa9e3e4e78e4b56eda244", "committedDate": "2020-05-16T16:56:05Z", "message": "[xml] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b53edfd3503ce6a2c5872c9177594a6f9c5362fc", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/b53edfd3503ce6a2c5872c9177594a6f9c5362fc", "committedDate": "2020-05-16T16:56:05Z", "message": "[java] Cleanup rule test xml files for metrics\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7de968a5c903afadcb33fb38fae0b2e34b20658b", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/7de968a5c903afadcb33fb38fae0b2e34b20658b", "committedDate": "2020-05-16T16:56:05Z", "message": "[jsp] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09a30d2ef50f534b838fca045f26d68ebb8e2bec", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/09a30d2ef50f534b838fca045f26d68ebb8e2bec", "committedDate": "2020-05-16T16:56:05Z", "message": "[doc] Fix indentation in rule testing doc, add note about CDATA"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzODY0OTE0", "url": "https://github.com/pmd/pmd/pull/2487#pullrequestreview-413864914", "createdAt": "2020-05-18T19:07:16Z", "commit": {"oid": "09a30d2ef50f534b838fca045f26d68ebb8e2bec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxOTowNzoxNlrOGXECdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxOTowNzoxNlrOGXECdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgzNjU5Nw==", "bodyText": "I would also explain why source-type is optional, and not needed in most cases. It's just used to select a specific language version, not the language. Most PRs that add a new language add source-type in the xml files, but this is not needed and throws off schema validation, because of this line:\n\n  \n    \n      pmd/pmd-test/src/main/resources/rule-tests_1_0_0.xsd\n    \n    \n         Line 53\n      in\n      0cc0027\n    \n    \n    \n    \n\n        \n          \n           <pattern value=\"(apex|ecmascript|java|jsp|modelica|plsql|pom|scala|vf|vm|wsdl|xml|xsl)( [\\w\\d._-]+)?\"></pattern> \n        \n    \n  \n\n\nSchema validation fails until the schema is updated.\nI'm not sure it's documented somewhere, how to update the schema (eg on which server to put the new file). This is an item in #597\nI think anyway, this validation constraint should be removed from the schema. It forces us to update the schema each time we add a language, and couples the schema to standard language modules.", "url": "https://github.com/pmd/pmd/pull/2487#discussion_r426836597", "createdAt": "2020-05-18T19:07:16Z", "author": {"login": "oowekyala"}, "path": "docs/pages/pmd/userdocs/extending/testing.md", "diffHunk": "@@ -195,41 +197,49 @@ in a \"CDATA\" section, so that no further XML escapes (entity references such as\n             <message>Violation message 2</message>\n         </expected-messages>\n         <code><![CDATA[\n-    public class ConsistentReturn {\n-        public Boolean foo() {\n-        }\n+public class ConsistentReturn {\n+    public Boolean foo() {\n     }\n-         ]]></code>\n-            <source-type>apex</source-type>                             <!-- optional -->\n-        </test-code>\n+}\n+        ]]></code>\n+        <source-type>apex</source-type>                             <!-- optional -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09a30d2ef50f534b838fca045f26d68ebb8e2bec"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4789, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}