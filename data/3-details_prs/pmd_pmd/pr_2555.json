{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NDM3NTg2", "number": 2555, "title": "[java] Improve UseDiamondOperator rule", "bodyText": "Describe the PR\nThis introduces the property \"java7compatibility\", which is disabled by default (for backwards\ncompatibility of the rule this can be enabled).\nThe rule now detects more cases by default, that are only valid for java8+: nested types,\ntypes with wildcards, ternary operators.\nWith this property, the previously added version specific test cases are now all enabled.\nRelated issues\n\nFixes #2545\n\nReady?\n\n Added unit tests for fixed bug/feature\n Passing all unit tests\n Complete build ./mvnw clean verify passes (checked automatically by travis)\n Added (in-code) documentation (if needed)", "createdAt": "2020-05-30T08:55:50Z", "url": "https://github.com/pmd/pmd/pull/2555", "merged": true, "mergeCommit": {"oid": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b"}, "closed": true, "closedAt": "2020-06-15T15:48:58Z", "author": {"login": "adangel"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmSuHcAH2gAyNDI1NDM3NTg2OmMyY2VhOWQxNWJjZjUxMmRiZmNlOGQ2N2M0NjZmZjBkMTc3NzRkZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrJCvhAFqTQzMDIwNDI2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c2cea9d15bcf512dbfce8d67c466ff0d17774ded", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/c2cea9d15bcf512dbfce8d67c466ff0d17774ded", "committedDate": "2020-05-30T08:23:52Z", "message": "[java] UseDiamondOperator - support nested type arguments\n\nFixes #2545 partially"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cae13164726eb86e7c9cd91c42783e493db8703f", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/cae13164726eb86e7c9cd91c42783e493db8703f", "committedDate": "2020-05-30T08:38:09Z", "message": "[java] UseDiamondOperator - add property java7compatibility\n\nThis property is disabled by default, so that the rule\nsuggests changes that work on java8+ only by default.\n\nEnable the version dependent tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b", "author": {"user": {"login": "adangel", "name": "Andreas Dangel"}}, "url": "https://github.com/pmd/pmd/commit/7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b", "committedDate": "2020-05-30T08:43:00Z", "message": "[doc] Update release notes, fixes #2545"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMjA0MjY0", "url": "https://github.com/pmd/pmd/pull/2555#pullrequestreview-430204264", "createdAt": "2020-06-14T09:55:47Z", "commit": {"oid": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwOTo1NTo0N1rOGjb_tA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwOTo1NTo0N1rOGjb_tA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgxMjAyMA==", "bodyText": "In proper camelCase this would be java7Compatibility", "url": "https://github.com/pmd/pmd/pull/2555#discussion_r439812020", "createdAt": "2020-06-14T09:55:47Z", "author": {"login": "oowekyala"}, "path": "pmd-java/src/main/resources/category/java/codestyle.xml", "diffHunk": "@@ -2004,15 +2009,17 @@ which makes the code also more readable.\n |\n //StatementExpression[AssignmentOperator and PrimaryExpression/PrimaryPrefix[not(Expression)]]\n )\n-/Expression/PrimaryExpression[not(PrimarySuffix) and not(ancestor::ArgumentList)]\n+/(Expression | Expression[$java7compatibility = false()]/ConditionalExpression | Expression[$java7compatibility = false()]/ConditionalExpression/Expression)\n+/PrimaryExpression[not(PrimarySuffix) and not(ancestor::ArgumentList)]\n /PrimaryPrefix\n /AllocationExpression\n     [@AnonymousClass=false()]\n-    [ClassOrInterfaceType/TypeArguments[@Diamond=false() and not(TypeArgument//TypeArguments)]]\n+    [ClassOrInterfaceType/TypeArguments[@Diamond=false() and not($java7compatibility = true() and .//TypeArgument[@Wildcard=true()])]]\n     [not(ArrayDimsAndInits)]\n ]]>\n                 </value>\n             </property>\n+            <property name=\"java7compatibility\" type=\"Boolean\" description=\"If disabled, the rule shows also violations that are applicable for java8+\" value=\"false\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4805, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}