{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NDk1Mzg4", "number": 424, "title": "fix: improve numeric range checks", "bodyText": "Adds additional checks on NUMERIC values before sending them to Cloud Spanner in order to return sensible error messages as soon as possible, and adds documentation on how to handle NUMERIC values with trailing zeros in the fractional part.", "createdAt": "2020-09-14T10:05:23Z", "url": "https://github.com/googleapis/java-spanner/pull/424", "merged": true, "mergeCommit": {"oid": "9f2678568be77e82c14632b1c7ffcaafb71e7679"}, "closed": true, "closedAt": "2020-09-18T06:43:50Z", "author": {"login": "olavloite"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIwPixgH2gAyNDg2NDk1Mzg4OjdlMDA1NDUyN2Y2OWRmMjA5ODUwYWNlNmJiNTNmYTdmN2NmMDQ3Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ7aYVAFqTQ5MTA5Mjk3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e0054527f69df209850ace6bb53fa7f7cf04769", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/googleapis/java-spanner/commit/7e0054527f69df209850ace6bb53fa7f7cf04769", "committedDate": "2020-09-14T10:01:03Z", "message": "fix: improve numeric range checks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abb579c4e86cb3053096b2cef4310c70cf21faec", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/googleapis/java-spanner/commit/abb579c4e86cb3053096b2cef4310c70cf21faec", "committedDate": "2020-09-14T10:35:18Z", "message": "fix: skip numeric ITs on emulator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MzYwNzAz", "url": "https://github.com/googleapis/java-spanner/pull/424#pullrequestreview-488360703", "createdAt": "2020-09-15T06:27:39Z", "commit": {"oid": "abb579c4e86cb3053096b2cef4310c70cf21faec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNjoyNzozOVrOHRyktg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNjoyNzozOVrOHRyktg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQxNjQzOA==", "bodyText": "Is this all necessary because BigDecimal has arbitrary precision but NUMERIC doesn't?\nJust as an FYI, we chose not to do this explicit check in other clients just because we wanted to make sure that the backend threw errors in case they decide to change the precision later on. In practice, they wouldn't change it without notifying us so it's not a big deal.", "url": "https://github.com/googleapis/java-spanner/pull/424#discussion_r488416438", "createdAt": "2020-09-15T06:27:39Z", "author": {"login": "skuruppu"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/Value.java", "diffHunk": "@@ -123,11 +123,37 @@ public static Value float64(double v) {\n   }\n \n   /**\n-   * Returns a {@code NUMERIC} value.\n+   * Returns a {@code NUMERIC} value. The valid value range for the whole component of the {@link\n+   * BigDecimal} is from -9,999,999,999,999,999,999,999,999 to +9,999,999,999,999,999,999,999,999\n+   * (both inclusive), i.e. the max length of the whole component is 29 digits. The max length of\n+   * the fractional part is 9 digits. Trailing zeros in the fractional part are not considered and\n+   * will be lost, as Cloud Spanner does not preserve the precision of a numeric value.\n+   *\n+   * <p>If you set a numeric value of a record to for example 0.10, Cloud Spanner will return this\n+   * value as 0.1 in subsequent queries. Use {@link BigDecimal#stripTrailingZeros()} to compare\n+   * inserted values with retrieved values if your application might insert numeric values with\n+   * trailing zeros.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abb579c4e86cb3053096b2cef4310c70cf21faec"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMDkyOTcx", "url": "https://github.com/googleapis/java-spanner/pull/424#pullrequestreview-491092971", "createdAt": "2020-09-18T01:35:46Z", "commit": {"oid": "abb579c4e86cb3053096b2cef4310c70cf21faec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1001, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}