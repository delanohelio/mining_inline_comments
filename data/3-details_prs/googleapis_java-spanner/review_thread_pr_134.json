{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MTQ1OTA4", "number": 134, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo0OTowNFrODtu82Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMzozMToxNlrODtvgcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MjgxNzUzOnYy", "diffSide": "RIGHT", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo0OTowNFrOF_VYOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo0Njo0MVrOF_dXwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NDg3Mg==", "bodyText": "Why do we name this from distributeOverChannels to initialization? initialization seems not to have a clear meaning.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r401954872", "createdAt": "2020-04-01T22:49:04Z", "author": {"login": "hengfengli"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "diffHunk": "@@ -1794,7 +1795,7 @@ private boolean canCreateSession() {\n     }\n   }\n \n-  private void createSessions(final int sessionCount) {\n+  private void createSessions(final int sessionCount, boolean initialization) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NTgyNQ==", "bodyText": "Good point, changed. I had named it initialization because the session pool only calls this with true during initialization, but naming it by what it actually does instead of when it's called, is a lot more helpful.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r402085825", "createdAt": "2020-04-02T06:46:41Z", "author": {"login": "olavloite"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "diffHunk": "@@ -1794,7 +1795,7 @@ private boolean canCreateSession() {\n     }\n   }\n \n-  private void createSessions(final int sessionCount) {\n+  private void createSessions(final int sessionCount, boolean initialization) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NDg3Mg=="}, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5Mjg5OTA3OnYy", "diffSide": "RIGHT", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMzoyNjo0MVrOF_WJzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo1MDozN1rOF_deoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk2NzU2Nw==", "bodyText": "So does this mean only when we initialize the pool, we will distribute requests across different channels? For the rest, we don't.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r401967567", "createdAt": "2020-04-01T23:26:41Z", "author": {"login": "hengfengli"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "diffHunk": "@@ -1077,7 +1077,7 @@ private void replenishPool() {\n         // If we have gone below min pool size, create that many sessions.\n         int sessionCount = options.getMinSessions() - (totalSessions() + numSessionsBeingCreated);\n         if (sessionCount > 0) {\n-          createSessions(getAllowedCreateSessions(sessionCount));\n+          createSessions(getAllowedCreateSessions(sessionCount), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NzU4NA==", "bodyText": "Yes, that is correct. The SessionClient will automatically make sure that consecutive requests will be executed on different channels round robin, so that the distribution over channels will still be maintained if the session pool continues to request additional sessions.\nThis means that the pool initialization will distribute the MinSessions sessions over all available channels. Each time the pool increases the number of sessions, that batch of new sessions will all be bound to one channel, but each new batch will be bound to a different channel. So in the end the sessions will still be distributed over all available channels.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r402087584", "createdAt": "2020-04-02T06:50:37Z", "author": {"login": "olavloite"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPool.java", "diffHunk": "@@ -1077,7 +1077,7 @@ private void replenishPool() {\n         // If we have gone below min pool size, create that many sessions.\n         int sessionCount = options.getMinSessions() - (totalSessions() + numSessionsBeingCreated);\n         if (sessionCount > 0) {\n-          createSessions(getAllowedCreateSessions(sessionCount));\n+          createSessions(getAllowedCreateSessions(sessionCount), false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk2NzU2Nw=="}, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MjkwODY0OnYy", "diffSide": "RIGHT", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPoolOptions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMzozMToxNlrOF_WPgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo1MTo1NlrOF_dglQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk2OTAyNg==", "bodyText": "Do we need to allow users to configure this? I mean we add a new parameter to let users to configure, which can add cognitive load to them.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r401969026", "createdAt": "2020-04-01T23:31:16Z", "author": {"login": "hengfengli"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPoolOptions.java", "diffHunk": "@@ -40,6 +42,7 @@ private SessionPoolOptions(Builder builder) {\n     // maxSessions value is less than the default for minSessions.\n     this.minSessions = Math.min(builder.minSessions, builder.maxSessions);\n     this.maxSessions = builder.maxSessions;\n+    this.incStep = builder.incStep;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4ODA4NQ==", "bodyText": "No, the configuration parameter is package-private, meaning that it can only be configured internally by the client library and its tests. Users can't see this configuration, unless they browse the source code of the client library.\nIt needs to be configurable for the benchmarks to be able to test different scenarios.", "url": "https://github.com/googleapis/java-spanner/pull/134#discussion_r402088085", "createdAt": "2020-04-02T06:51:56Z", "author": {"login": "olavloite"}, "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionPoolOptions.java", "diffHunk": "@@ -40,6 +42,7 @@ private SessionPoolOptions(Builder builder) {\n     // maxSessions value is less than the default for minSessions.\n     this.minSessions = Math.min(builder.minSessions, builder.maxSessions);\n     this.maxSessions = builder.maxSessions;\n+    this.incStep = builder.incStep;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk2OTAyNg=="}, "originalCommit": {"oid": "d4cdee90cbb96010e8b6105436a0ec6aaac01cb5"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3229, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}