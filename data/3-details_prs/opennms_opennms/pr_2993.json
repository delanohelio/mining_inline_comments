{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMjgyNzIw", "number": 2993, "title": "NMS-12656: Query support for aggregated flow documents", "bodyText": "JIRA: https://issues.opennms.org/browse/NMS-12656\nHere we add support for responding to flow queries using aggregated flow documents built by https://github.com/OpenNMS/nephron\nThe ElasticFlowRepository has been refactored to accommodate this and new Elasticsearch queries have been written to make use of the aggregated flows.", "createdAt": "2020-05-01T20:13:10Z", "url": "https://github.com/OpenNMS/opennms/pull/2993", "merged": true, "mergeCommit": {"oid": "c7afd5c14dadd2f9da265140acb75a7376e2d7c6"}, "closed": true, "closedAt": "2020-05-04T14:23:13Z", "author": {"login": "j-white"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdHaj7AH2gAyNDEyMjgyNzIwOjliN2M5OTkxYTM3NzIxNWFmMzc5MDg3ZWVkMzlhYWVmNTdkMGUyNTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcd_xBZgFqTQwNTAwMjgyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b7c9991a377215af379087eed39aaef57d0e251", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/9b7c9991a377215af379087eed39aaef57d0e251", "committedDate": "2020-05-01T20:08:14Z", "message": "NMS-12656: Upgrade the version of Elasticsearch used for ITs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a5d3550a04d080813d99ff77d40b647a3980d76", "author": {"user": {"login": "indigo423", "name": "Ronny Trommer"}}, "url": "https://github.com/OpenNMS/opennms/commit/5a5d3550a04d080813d99ff77d40b647a3980d76", "committedDate": "2020-05-01T20:08:15Z", "message": "Publish features/drift261 to DockerHub as drift261 tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cc07e6c345212741d85574aa949086339e51acc", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/8cc07e6c345212741d85574aa949086339e51acc", "committedDate": "2020-05-01T20:08:15Z", "message": "NMS-12656: Wire in a new AggregatedFlowRepository to query alternate indices."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdf695a5e97ebdd9c8898a4bf48f0f135771e7ee", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/cdf695a5e97ebdd9c8898a4bf48f0f135771e7ee", "committedDate": "2020-05-01T20:08:15Z", "message": "NMS-12663: Fix collapse list when indexPrefix is involved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62ab6177fff515d546c56451c8b3069741475298", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/62ab6177fff515d546c56451c8b3069741475298", "committedDate": "2020-05-01T20:08:15Z", "message": "NMS-12663: Move timeRangeAggregateThresholdMs to AggregatedFlowRepository"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b914c53161ebac26e1f8b35d9cbac3641ca3cb13", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/b914c53161ebac26e1f8b35d9cbac3641ca3cb13", "committedDate": "2020-05-01T20:08:15Z", "message": "NMS-12656: Refactor the ElasticFlowRepository in order to add\nsupport for queries derived from aggregated flows."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ee5b00fa2248a055db31a29bfe9b03a4e5d2e2c", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/7ee5b00fa2248a055db31a29bfe9b03a4e5d2e2c", "committedDate": "2020-05-01T20:23:39Z", "message": "NMS-15656: Cleanup."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0Mzc3MzQw", "url": "https://github.com/OpenNMS/opennms/pull/2993#pullrequestreview-404377340", "createdAt": "2020-05-01T20:15:26Z", "commit": {"oid": "b914c53161ebac26e1f8b35d9cbac3641ca3cb13"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMDoxNToyNlrOGPUjNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMDoyMjo1NFrOGPUu2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxODUxOQ==", "bodyText": "TODO: Remove me before merge.", "url": "https://github.com/OpenNMS/opennms/pull/2993#discussion_r418718519", "createdAt": "2020-05-01T20:15:26Z", "author": {"login": "j-white"}, "path": ".circleci/config.yml", "diffHunk": "@@ -410,6 +410,7 @@ workflows:\n                 - master\n                 - develop\n                 - /^release-.*/\n+                - features/drift261", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b914c53161ebac26e1f8b35d9cbac3641ca3cb13"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxODkxNg==", "bodyText": "We upgraded the rate-limited-logger library as part of this patch to be compatible with some other libraries we're using - they no longer rely on joda.", "url": "https://github.com/OpenNMS/opennms/pull/2993#discussion_r418718916", "createdAt": "2020-05-01T20:16:30Z", "author": {"login": "j-white"}, "path": "core/ipc/rpc/kafka/src/main/java/org/opennms/core/ipc/rpc/kafka/KafkaRpcClientFactory.java", "diffHunk": "@@ -124,7 +124,7 @@\n     private static final Logger LOG = LoggerFactory.getLogger(KafkaRpcClientFactory.class);\n     private static final RateLimitedLog RATE_LIMITED_LOG = RateLimitedLog\n             .withRateLimit(LOG)\n-            .maxRate(5).every(Duration.standardSeconds(30))\n+            .maxRate(5).every(Duration.ofSeconds(30))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b914c53161ebac26e1f8b35d9cbac3641ca3cb13"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcyMTQ5OA==", "bodyText": "TODO: Remove me before merge.", "url": "https://github.com/OpenNMS/opennms/pull/2993#discussion_r418721498", "createdAt": "2020-05-01T20:22:54Z", "author": {"login": "j-white"}, "path": "opennms-container/version-tags.sh", "diffHunk": "@@ -11,6 +11,9 @@ case \"${CIRCLE_BRANCH}\" in\n   \"release-\"*)\n     VERSION=\"release-candidate\"\n     ;;\n+  \"features/drift261\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b914c53161ebac26e1f8b35d9cbac3641ca3cb13"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NDA5NDA1", "url": "https://github.com/OpenNMS/opennms/pull/2993#pullrequestreview-404409405", "createdAt": "2020-05-01T21:26:22Z", "commit": {"oid": "7ee5b00fa2248a055db31a29bfe9b03a4e5d2e2c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMToyNjoyM1rOGPWKyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMToyNjoyM1rOGPWKyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc0NTAzNA==", "bodyText": "TODO: Point to tagged release before merge.", "url": "https://github.com/OpenNMS/opennms/pull/2993#discussion_r418745034", "createdAt": "2020-05-01T21:26:23Z", "author": {"login": "j-white"}, "path": "features/flows/itests/pom.xml", "diffHunk": "@@ -0,0 +1,282 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n+    <parent>\n+        <groupId>org.opennms.features</groupId>\n+        <artifactId>org.opennms.features.flows</artifactId>\n+        <version>26.1.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+    <groupId>org.opennms.features.flows</groupId>\n+    <artifactId>org.opennms.features.flows.itests</artifactId>\n+    <packaging>jar</packaging>\n+    <name>OpenNMS :: Features :: Flows :: Integration Tests</name>\n+    <properties>\n+        <skipITs>true</skipITs>\n+        <nephronVersion>1.0.0-SNAPSHOT</nephronVersion>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ee5b00fa2248a055db31a29bfe9b03a4e5d2e2c"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1a26db9553cfa3eafc857ad67f23f70e2547f10", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/e1a26db9553cfa3eafc857ad67f23f70e2547f10", "committedDate": "2020-05-02T01:41:22Z", "message": "NMS-15656: Fix call to constructor in Blueprint %&$#?@\n\nAlso remove Blueprint artifacts from lib/ that shouldn't be there."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9aef6dc552d5145ef838b02fac94c07d9d2525b8", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/9aef6dc552d5145ef838b02fac94c07d9d2525b8", "committedDate": "2020-05-02T23:09:53Z", "message": "NMS-15656: Fix behavior of force flags and cleanup."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cea5d583be610480714c70da9be3a5d76e33ffa1", "author": {"user": {"login": "j-white", "name": "Jesse White"}}, "url": "https://github.com/OpenNMS/opennms/commit/cea5d583be610480714c70da9be3a5d76e33ffa1", "committedDate": "2020-05-03T03:03:18Z", "message": "don't load external DTDs when testing:\n'http://www.eclipse.org/jetty/configure.dtd' is no longer available"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MDAyODI2", "url": "https://github.com/OpenNMS/opennms/pull/2993#pullrequestreview-405002826", "createdAt": "2020-05-04T13:47:27Z", "commit": {"oid": "cea5d583be610480714c70da9be3a5d76e33ffa1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3618, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}