{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0NzYyMDQz", "number": 3221, "title": "NMS-12974: Import Scan should be performed always for new nodes", "bodyText": "For requisitions that are synchronized with no or dbonly flags, SNMP scan is not performed in import phase.\nThis results SNMP service being discovered first before Node gets updated with system info.\nCollectd doesn't perform any SNMP collection if nodesysoid is not present and it removes this from it's schedule.\nHad to restart OpenNMS or reload Collectd to get SNMP collection working.\nThe solution here identifies a new node being inserted and performs SNMP scan for that node always irrespective of rescanExisting value.\nExternal References\n\nJIRA (Issue Tracker): http://issues.opennms.org/browse/NMS-12974", "createdAt": "2020-11-20T15:00:19Z", "url": "https://github.com/OpenNMS/opennms/pull/3221", "merged": true, "mergeCommit": {"oid": "b20aaf615306b50a5ff7fc9499d9c7cd3f0bbd9a"}, "closed": true, "closedAt": "2020-11-20T19:57:56Z", "author": {"login": "cgorantla"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeY3yOgFqTUzNTUxNDAxOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdebehIABqjQwMjIyMDYyMzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NTE0MDE5", "url": "https://github.com/OpenNMS/opennms/pull/3221#pullrequestreview-535514019", "createdAt": "2020-11-20T15:13:37Z", "commit": {"oid": "823891d177b0e370b7916db9eb0973e2203808a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNToxMzozN1rOH3TyOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNToxMzozN1rOH3TyOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc1Nzg4Mg==", "bodyText": "aha! yeah, that's a simple way to do that :D", "url": "https://github.com/OpenNMS/opennms/pull/3221#discussion_r527757882", "createdAt": "2020-11-20T15:13:37Z", "author": {"login": "RangerRick"}, "path": "opennms-provision/opennms-provisiond/src/main/java/org/opennms/netmgt/provision/service/CoreImportActivities.java", "diffHunk": "@@ -138,8 +138,10 @@ public static void scanNode(final ImportOperation operation, final RequisitionIm\n             return;\n         }\n \n-        if (rescanExisting == null || Boolean.valueOf(rescanExisting)) {\n-            info(\"Running scan phase of {}, the parameter {} was set to {} during import.\", operation, EventConstants.PARM_IMPORT_RESCAN_EXISTING, rescanExisting);\n+        if (rescanExisting == null || Boolean.valueOf(rescanExisting) ||\n+                // scan at import should always be performed for new nodes irrespective of rescanExisting flag.\n+                operation.getOperationType().equals(ImportOperation.OperationType.INSERT)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "823891d177b0e370b7916db9eb0973e2203808a7"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NTE0NDM3", "url": "https://github.com/OpenNMS/opennms/pull/3221#pullrequestreview-535514437", "createdAt": "2020-11-20T15:14:04Z", "commit": {"oid": "823891d177b0e370b7916db9eb0973e2203808a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NTUxNDE3", "url": "https://github.com/OpenNMS/opennms/pull/3221#pullrequestreview-535551417", "createdAt": "2020-11-20T15:55:50Z", "commit": {"oid": "823891d177b0e370b7916db9eb0973e2203808a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbe431c747dacee2934645f36823c832d0b86e33", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/fbe431c747dacee2934645f36823c832d0b86e33", "committedDate": "2020-11-20T18:15:10Z", "message": "NMS-12974: Import Scan should be done for any new nodes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "823891d177b0e370b7916db9eb0973e2203808a7", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/823891d177b0e370b7916db9eb0973e2203808a7", "committedDate": "2020-11-19T22:54:37Z", "message": "NMS-12974: Import Scan should be done for any new nodes"}, "afterCommit": {"oid": "fbe431c747dacee2934645f36823c832d0b86e33", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/fbe431c747dacee2934645f36823c832d0b86e33", "committedDate": "2020-11-20T18:15:10Z", "message": "NMS-12974: Import Scan should be done for any new nodes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3854, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}