{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMDU4MTE3", "number": 2995, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMzo0OTo1NVrOD5aXhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMTo0NToxMFrOD5lzPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNTI3NDMwOnYy", "diffSide": "RIGHT", "path": "opennms-container/minion/CONFD_README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMzo0OTo1NVrOGQqVNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNTo1MDo0NlrOGQv6jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyMzk1OQ==", "bodyText": "Should rename this to jetty - it's also used by Hawtio and other webapps.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420123959", "createdAt": "2020-05-05T13:49:55Z", "author": {"login": "j-white"}, "path": "opennms-container/minion/CONFD_README.md", "diffHunk": "@@ -161,3 +161,33 @@ system:\n ```\n Config specified will be written to `etc/confd.system.properties` which gets automatically appended to `etc/system.properties`. Additionally, provided the\n `jaeger-agent-host` key is specified, `etc/featuresBoot.d/jaeger.boot` will also be updated.\n+\n+### Karaf Properties\n+```\n+---\n+karaf:\n+    shell:\n+        ssh:\n+            host: \"0.0.0.0\"\n+            port: 8201\n+    management:\n+        rmi:\n+            registry:\n+                host: \"127.0.0.1\"\n+                port: 1299\n+            server:\n+                host: \"127.0.0.1\"\n+                port: 45444\n+```\n+Config specified will be written to:\n+- `etc/org.apache.karaf.shell.cfg` for content under `shell`.\n+- `etc/org.apache.karaf.management.cfg` for content under `management`.\n+\n+### Jolokia Properties\n+```\n+---\n+jolokia:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIxNTQzOA==", "bodyText": "Sounds good; re-named.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420215438", "createdAt": "2020-05-05T15:50:46Z", "author": {"login": "bouff"}, "path": "opennms-container/minion/CONFD_README.md", "diffHunk": "@@ -161,3 +161,33 @@ system:\n ```\n Config specified will be written to `etc/confd.system.properties` which gets automatically appended to `etc/system.properties`. Additionally, provided the\n `jaeger-agent-host` key is specified, `etc/featuresBoot.d/jaeger.boot` will also be updated.\n+\n+### Karaf Properties\n+```\n+---\n+karaf:\n+    shell:\n+        ssh:\n+            host: \"0.0.0.0\"\n+            port: 8201\n+    management:\n+        rmi:\n+            registry:\n+                host: \"127.0.0.1\"\n+                port: 1299\n+            server:\n+                host: \"127.0.0.1\"\n+                port: 45444\n+```\n+Config specified will be written to:\n+- `etc/org.apache.karaf.shell.cfg` for content under `shell`.\n+- `etc/org.apache.karaf.management.cfg` for content under `management`.\n+\n+### Jolokia Properties\n+```\n+---\n+jolokia:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyMzk1OQ=="}, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNTI3ODQ0OnYy", "diffSide": "RIGHT", "path": "opennms-container/minion/CONFD_README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMzo1MDo0NlrOGQqXww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNTo1MDo1OFrOGQv7Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyNDYxMQ==", "bodyText": "Can we add the host as well? We should be able to bind this to the loopback.\norg.ops4j.pax.web.listening.addresses may work - see https://ops4j1.jira.com/wiki/spaces/paxweb/pages/12059275/Basic+Configuration", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420124611", "createdAt": "2020-05-05T13:50:46Z", "author": {"login": "j-white"}, "path": "opennms-container/minion/CONFD_README.md", "diffHunk": "@@ -161,3 +161,33 @@ system:\n ```\n Config specified will be written to `etc/confd.system.properties` which gets automatically appended to `etc/system.properties`. Additionally, provided the\n `jaeger-agent-host` key is specified, `etc/featuresBoot.d/jaeger.boot` will also be updated.\n+\n+### Karaf Properties\n+```\n+---\n+karaf:\n+    shell:\n+        ssh:\n+            host: \"0.0.0.0\"\n+            port: 8201\n+    management:\n+        rmi:\n+            registry:\n+                host: \"127.0.0.1\"\n+                port: 1299\n+            server:\n+                host: \"127.0.0.1\"\n+                port: 45444\n+```\n+Config specified will be written to:\n+- `etc/org.apache.karaf.shell.cfg` for content under `shell`.\n+- `etc/org.apache.karaf.management.cfg` for content under `management`.\n+\n+### Jolokia Properties\n+```\n+---\n+jolokia:\n+    web:\n+        port: 8181", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIxNTU4Mg==", "bodyText": "Yup org.ops4j.pax.web.listening.addresses works.  Added.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420215582", "createdAt": "2020-05-05T15:50:58Z", "author": {"login": "bouff"}, "path": "opennms-container/minion/CONFD_README.md", "diffHunk": "@@ -161,3 +161,33 @@ system:\n ```\n Config specified will be written to `etc/confd.system.properties` which gets automatically appended to `etc/system.properties`. Additionally, provided the\n `jaeger-agent-host` key is specified, `etc/featuresBoot.d/jaeger.boot` will also be updated.\n+\n+### Karaf Properties\n+```\n+---\n+karaf:\n+    shell:\n+        ssh:\n+            host: \"0.0.0.0\"\n+            port: 8201\n+    management:\n+        rmi:\n+            registry:\n+                host: \"127.0.0.1\"\n+                port: 1299\n+            server:\n+                host: \"127.0.0.1\"\n+                port: 45444\n+```\n+Config specified will be written to:\n+- `etc/org.apache.karaf.shell.cfg` for content under `shell`.\n+- `etc/org.apache.karaf.management.cfg` for content under `management`.\n+\n+### Jolokia Properties\n+```\n+---\n+jolokia:\n+    web:\n+        port: 8181", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyNDYxMQ=="}, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNTI4NDE1OnYy", "diffSide": "RIGHT", "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMzo1MjowMVrOGQqbYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNTo1MjowM1rOGQv-MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyNTUzOQ==", "bodyText": "I don't think we've done this yet - but maybe we should add a # Managed with confd - DO NOT EDIT style \"header\" to these files.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420125539", "createdAt": "2020-05-05T13:52:01Z", "author": {"login": "j-white"}, "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "diffHunk": "@@ -0,0 +1,104 @@\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIxNjM2OA==", "bodyText": "Added header to the new templates I introduced.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420216368", "createdAt": "2020-05-05T15:52:03Z", "author": {"login": "bouff"}, "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "diffHunk": "@@ -0,0 +1,104 @@\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEyNTUzOQ=="}, "originalCommit": {"oid": "dc3a75b0eb0c2f3e84259c9af40a07722403b157"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNzEyNjQ1OnYy", "diffSide": "RIGHT", "path": "opennms-container/minion/container-fs/confd/conf.d/org.apache.karaf.management.cfg.toml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMTozODoyOVrOGQ8i0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMjozMjowNlrOGQ990Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyMjM1Mw==", "bodyText": "This is fine, however we could make the restriction broader to avoid having to update the keys in the future.\nCould just use /karaf/management/rmi then you will get access to all the children as well.\nSame for the other toml's.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420422353", "createdAt": "2020-05-05T21:38:29Z", "author": {"login": "mattixtech"}, "path": "opennms-container/minion/container-fs/confd/conf.d/org.apache.karaf.management.cfg.toml", "diffHunk": "@@ -0,0 +1,9 @@\n+[template]\n+src = \"org.apache.karaf.management.cfg.tmpl\"\n+dest = \"/opt/minion/etc/org.apache.karaf.management.cfg\"\n+keys = [\n+    \"/karaf/management/rmi/registry/host\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ0NTY0OQ==", "bodyText": "Good to know, will do this.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420445649", "createdAt": "2020-05-05T22:32:06Z", "author": {"login": "bouff"}, "path": "opennms-container/minion/container-fs/confd/conf.d/org.apache.karaf.management.cfg.toml", "diffHunk": "@@ -0,0 +1,9 @@\n+[template]\n+src = \"org.apache.karaf.management.cfg.tmpl\"\n+dest = \"/opt/minion/etc/org.apache.karaf.management.cfg\"\n+keys = [\n+    \"/karaf/management/rmi/registry/host\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyMjM1Mw=="}, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNzEzNzczOnYy", "diffSide": "RIGHT", "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMTo0MTo1NFrOGQ8pWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMjozMTo1M1rOGQ99ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyNDAyNg==", "bodyText": "Not strictly necessary, but it may be a good idea to assign the common parts of the path to a variable and then concatenate to get the full path. Avoids churning in the future should we change key paths (not that its likely). See confd-telemetry-feature.xml.tmpl $flowsPath variable as example.\nSame for other templates here.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420424026", "createdAt": "2020-05-05T21:41:54Z", "author": {"login": "mattixtech"}, "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "diffHunk": "@@ -0,0 +1,107 @@\n+#\n+# DON'T EDIT THIS FILE :: GENERATED WITH CONFD\n+#\n+\n+#\n+# The properties in this file define the configuration of Apache Karaf's JMX Management\n+#\n+\n+#\n+# Port number for RMI registry connection\n+#\n+rmiRegistryPort = {{getv \"/karaf/management/rmi/registry/port\" \"1299\"}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ0NTU0Ng==", "bodyText": "Sure, will do", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420445546", "createdAt": "2020-05-05T22:31:53Z", "author": {"login": "bouff"}, "path": "opennms-container/minion/container-fs/confd/templates/org.apache.karaf.management.cfg.tmpl", "diffHunk": "@@ -0,0 +1,107 @@\n+#\n+# DON'T EDIT THIS FILE :: GENERATED WITH CONFD\n+#\n+\n+#\n+# The properties in this file define the configuration of Apache Karaf's JMX Management\n+#\n+\n+#\n+# Port number for RMI registry connection\n+#\n+rmiRegistryPort = {{getv \"/karaf/management/rmi/registry/port\" \"1299\"}}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyNDAyNg=="}, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNzE0NzQ5OnYy", "diffSide": "RIGHT", "path": "smoke-test/src/main/resources/minion-config/minion-config.yaml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMTo0NToxMFrOGQ8vRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQyMjoxMzo1OVrOGQ9g1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyNTU0MA==", "bodyText": "Looks like this is the default. Could remove it, s'pose it doesn't hurt though.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420425540", "createdAt": "2020-05-05T21:45:10Z", "author": {"login": "mattixtech"}, "path": "smoke-test/src/main/resources/minion-config/minion-config.yaml", "diffHunk": "@@ -22,3 +22,9 @@ telemetry:\n netmgt:\n   traps:\n     trapd.listen.interface: \"0.0.0.0\"\n+\n+karaf:\n+  shell:\n+    ssh:\n+      host: \"0.0.0.0\"\n+      port: 8201", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQzODIyOQ==", "bodyText": "Will remove port - but host definitely has to stay.", "url": "https://github.com/OpenNMS/opennms/pull/2995#discussion_r420438229", "createdAt": "2020-05-05T22:13:59Z", "author": {"login": "bouff"}, "path": "smoke-test/src/main/resources/minion-config/minion-config.yaml", "diffHunk": "@@ -22,3 +22,9 @@ telemetry:\n netmgt:\n   traps:\n     trapd.listen.interface: \"0.0.0.0\"\n+\n+karaf:\n+  shell:\n+    ssh:\n+      host: \"0.0.0.0\"\n+      port: 8201", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQyNTU0MA=="}, "originalCommit": {"oid": "8f3868aac45d6a7e42e92fe7d54dbb0c04207ed9"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 645, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}