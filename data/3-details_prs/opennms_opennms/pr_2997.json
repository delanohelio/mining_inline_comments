{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMjg4ODc0", "number": 2997, "title": "NMS-12688: Use custom thread pool to run the Startup of consumers", "bodyText": "Without using the custom thread pool, the thread that is going to run CompletableFuture.runAsync seems to be coming from thread pool that is using different classloader (may be custom classloader from osgi ? ) than default class loader which is causing class loader issues while running telemetry adapters.\nExternal References\n\nJIRA (Issue Tracker): http://issues.opennms.org/browse/NMS-12688\nBamboo (Continuous Integration): https://bamboo.opennms.org/", "createdAt": "2020-05-05T03:35:04Z", "url": "https://github.com/OpenNMS/opennms/pull/2997", "merged": true, "mergeCommit": {"oid": "824dd4feab6a0e27c01f3d6d7927ab8feddbcb5b"}, "closed": true, "closedAt": "2020-05-05T13:43:34Z", "author": {"login": "cgorantla"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceLftWAH2gAyNDEzMjg4ODc0Ojk4ZWJmZWUxOTM3OTliNmVmN2UxZDYxMTBhNjk5OTliY2RlYTlkZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceSzBjAFqTQwNTcxODAwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "98ebfee193799b6ef7e1d6110a69999bcdea9de9", "author": {"user": {"login": "cgorantla", "name": "Chandra Gorantla"}}, "url": "https://github.com/OpenNMS/opennms/commit/98ebfee193799b6ef7e1d6110a69999bcdea9de9", "committedDate": "2020-05-05T03:27:24Z", "message": "NMS-12688: Use custom thread pool to run the start of consumers\n\nWithout using the custom thread pool, the thread that is going to run\nrunAsync seems to be coming from thread pool that is using different\nclassloader (may be custom classloader from osgi) than default class loader."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NzE4MDA5", "url": "https://github.com/OpenNMS/opennms/pull/2997#pullrequestreview-405718009", "createdAt": "2020-05-05T11:57:50Z", "commit": {"oid": "98ebfee193799b6ef7e1d6110a69999bcdea9de9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMTo1Nzo1MFrOGQmCAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxMTo1Nzo1MFrOGQmCAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDA1MzUwNA==", "bodyText": "Let's make sure this thread pool gets shutdown.", "url": "https://github.com/OpenNMS/opennms/pull/2997#discussion_r420053504", "createdAt": "2020-05-05T11:57:50Z", "author": {"login": "j-white"}, "path": "core/ipc/sink/common/src/main/java/org/opennms/core/ipc/sink/common/AbstractMessageConsumerManager.java", "diffHunk": "@@ -44,13 +47,20 @@\n import com.google.common.collect.LinkedListMultimap;\n import com.google.common.collect.Lists;\n import com.google.common.collect.Multimap;\n+import com.google.common.util.concurrent.ThreadFactoryBuilder;\n \n public abstract class AbstractMessageConsumerManager implements MessageConsumerManager {\n \n     private static final Logger LOG = LoggerFactory.getLogger(AbstractMessageConsumerManager.class);\n \n     public static final String SINK_INITIAL_SLEEP_TIME = \"org.opennms.core.ipc.sink.initialSleepTime\";\n \n+    private final ThreadFactory threadFactory = new ThreadFactoryBuilder()\n+            .setNameFormat(\"consumer-starter-%d\")\n+            .build();\n+\n+    protected final ExecutorService startupExecutor = Executors.newCachedThreadPool(threadFactory);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ebfee193799b6ef7e1d6110a69999bcdea9de9"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3626, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}