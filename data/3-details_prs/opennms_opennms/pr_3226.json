{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MjkwNDE1", "number": 3226, "title": "NMS-12973: Adding metrics and checking sequences", "bodyText": "This is groundwork used to analyze the situation where we maybe drop flows  during processing with hostname resolution enabled.\nThis enables a variety of counters related to flow processing. Mostly watching out for error situations but also adding a throughput counter to every stage.\nIn addition, the packet sequence numbers are check and a log message is generated if a packet is detected missing.\nOh, and it fixes a memory leak if flows are considered illegal.\nExternal References\n\nJIRA (Issue Tracker): http://issues.opennms.org/browse/NMS-12973 and https://issues.opennms.org/browse/NMS-13024", "createdAt": "2020-11-26T22:57:37Z", "url": "https://github.com/OpenNMS/opennms/pull/3226", "merged": true, "mergeCommit": {"oid": "73fd2e1f8ccd77f292a6223adbea1be4a41295a0"}, "closed": true, "closedAt": "2020-11-30T10:23:10Z", "author": {"login": "fooker"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbI-iGAH2gAyNTI4MjkwNDE1OjQxYmY5YzBkNmYzZmRjNmM1YjEwZGVmNTNlOTRhMzUzZDg3MmUyM2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgtHMkAFqTU0MDE3NjM5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "41bf9c0d6f3fdc6c5b10def53e94a353d872e23f", "author": {"user": {"login": "fooker", "name": "Dustin Frisch"}}, "url": "https://github.com/OpenNMS/opennms/commit/41bf9c0d6f3fdc6c5b10def53e94a353d872e23f", "committedDate": "2020-11-10T13:00:44Z", "message": "NMS-12973: Add instrumentation for flow receiver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83377e252cfa017557a69b88ad661ad916fe9912", "author": {"user": {"login": "fooker", "name": "Dustin Frisch"}}, "url": "https://github.com/OpenNMS/opennms/commit/83377e252cfa017557a69b88ad661ad916fe9912", "committedDate": "2020-11-11T12:20:36Z", "message": "NMS-12973: Add instrumentation for flow processor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "815461eed9be64d720c1af309f5a894d6f576497", "author": {"user": {"login": "fooker", "name": "Dustin Frisch"}}, "url": "https://github.com/OpenNMS/opennms/commit/815461eed9be64d720c1af309f5a894d6f576497", "committedDate": "2020-11-12T14:16:03Z", "message": "fixup! NMS-12973: Add instrumentation for flow receiver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "255a0c8b0e48632eeb796f2a04cbb8b7c75c2ed2", "author": {"user": {"login": "christianpape", "name": "Christian Pape"}}, "url": "https://github.com/OpenNMS/opennms/commit/255a0c8b0e48632eeb796f2a04cbb8b7c75c2ed2", "committedDate": "2020-11-19T08:54:23Z", "message": "NMS-12973: Fix memory leak for illegal flow handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82ec378fc333ca755d54c97aced2d0c7e04a13cc", "author": {"user": {"login": "fooker", "name": "Dustin Frisch"}}, "url": "https://github.com/OpenNMS/opennms/commit/82ec378fc333ca755d54c97aced2d0c7e04a13cc", "committedDate": "2020-11-19T08:54:37Z", "message": "NMS-12973: Check flows are in sequence"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NzUwNjg5", "url": "https://github.com/OpenNMS/opennms/pull/3226#pullrequestreview-539750689", "createdAt": "2020-11-27T07:17:20Z", "commit": {"oid": "82ec378fc333ca755d54c97aced2d0c7e04a13cc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwNzoxNzoyMVrOH6zRGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwNzoxNzoyMVrOH6zRGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQxOTQxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public KafkaFlowForwarder(ConfigurationAdmin configAdmin,\n          \n          \n            \n                public KafkaFlowForwarder(final ConfigurationAdmin configAdmin,", "url": "https://github.com/OpenNMS/opennms/pull/3226#discussion_r531419417", "createdAt": "2020-11-27T07:17:21Z", "author": {"login": "christianpape"}, "path": "features/flows/kafka-persistence/src/main/java/org/opennms/netmgt/flows/persistence/KafkaFlowForwarder.java", "diffHunk": "@@ -63,14 +66,27 @@\n             .build();\n     private Properties producerConfig;\n \n-    public KafkaFlowForwarder(ConfigurationAdmin configAdmin) {\n+    private final Meter forwarded;\n+    private final Meter persisted;\n+    private final Counter skipped;\n+    private final Counter failed;\n+\n+    public KafkaFlowForwarder(ConfigurationAdmin configAdmin,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82ec378fc333ca755d54c97aced2d0c7e04a13cc"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3c1814fd03d06612de7353f7dc5d9901c335f10", "author": {"user": {"login": "fooker", "name": "Dustin Frisch"}}, "url": "https://github.com/OpenNMS/opennms/commit/f3c1814fd03d06612de7353f7dc5d9901c335f10", "committedDate": "2020-11-27T10:15:51Z", "message": "fixup! NMS-12973: Check flows are in sequence"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMTc2Mzky", "url": "https://github.com/OpenNMS/opennms/pull/3226#pullrequestreview-540176392", "createdAt": "2020-11-27T19:56:24Z", "commit": {"oid": "f3c1814fd03d06612de7353f7dc5d9901c335f10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3860, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}