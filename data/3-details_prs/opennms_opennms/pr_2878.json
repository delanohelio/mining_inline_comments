{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwODMzNTQ3", "number": 2878, "title": "NMS-12445: Integrate Graph Service with the opennms-integration-api (OIA)", "bodyText": "Here we integrate the new Graph Service API with the OpenNMS Integration API.\nJIRA: https://issues.opennms.org/browse/NMS-12445\nWe may need to do a new OIA release (v.0.3.1) in order to get this to work properly.", "createdAt": "2020-02-04T13:19:57Z", "url": "https://github.com/OpenNMS/opennms/pull/2878", "merged": true, "mergeCommit": {"oid": "573a8824e2314994b23d74c772fe8745d71b81c4"}, "closed": true, "closedAt": "2020-02-21T09:23:47Z", "author": {"login": "mvrueden"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDYfTVAFqTM1Njk2ODY4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGRWQ-AFqTM2MjIxODQ2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTY4Njgw", "url": "https://github.com/OpenNMS/opennms/pull/2878#pullrequestreview-356968680", "createdAt": "2020-02-11T20:25:19Z", "commit": {"oid": "74be0c3f53882d75831936e5b706bc533cf27137"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMDoyNToxOVrOFoX23w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMDoyNToxOVrOFoX23w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg3ODIzOQ==", "bodyText": "Should we use a thread-safe map here?", "url": "https://github.com/OpenNMS/opennms/pull/2878#discussion_r377878239", "createdAt": "2020-02-11T20:25:19Z", "author": {"login": "j-white"}, "path": "features/graph/service/src/main/java/org/opennms/netmgt/graph/service/DefaultGraphService.java", "diffHunk": "@@ -42,10 +45,25 @@\n import org.opennms.netmgt.graph.api.info.GraphInfo;\n import org.opennms.netmgt.graph.api.service.GraphContainerProvider;\n import org.opennms.netmgt.graph.api.service.GraphService;\n+import org.opennms.netmgt.graph.api.service.osgi.GraphContainerProviderRegistration;\n+import org.osgi.framework.BundleContext;\n+import org.osgi.framework.ServiceRegistration;\n+\n+import com.google.common.collect.Maps;\n \n public class DefaultGraphService implements GraphService {\n \n     private List<GraphContainerProvider> graphContainerProviders = new CopyOnWriteArrayList<>();\n+    private final BundleContext bundleContext;\n+    private final Map<GraphContainerProvider, ServiceRegistration<GraphContainerProviderRegistration>> serviceRegistrationMap = Maps.newHashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74be0c3f53882d75831936e5b706bc533cf27137"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da6437c5941b71ca67425f71ecfb8226f26307fb", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/da6437c5941b71ca67425f71ecfb8226f26307fb", "committedDate": "2020-02-13T09:50:09Z", "message": "NMS-12445: Integrate OIA GraphProvider as well as allow exposing it to the TopologyUI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d41799d536e1e12ff36f0b69769eb6b26f50c07c", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/d41799d536e1e12ff36f0b69769eb6b26f50c07c", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Restructuring and add support for OIA-GraphContainerProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c125eb97fde779cdec616c11e38b530b5e50e53d", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/c125eb97fde779cdec616c11e38b530b5e50e53d", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Various enhancements to fully integrate with the Graph Service API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d54adaff5bd283fd99ee294a13d3ca9399b84c6", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/3d54adaff5bd283fd99ee294a13d3ca9399b84c6", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Expose status for new Graph API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b059db9c1fbef97b6ce93dacace041f60b1f010", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/1b059db9c1fbef97b6ce93dacace041f60b1f010", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Integrate Status calculation for Graph/Topology API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e0b8eedb00ddaed223a0bb4ea77083250a24961", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/9e0b8eedb00ddaed223a0bb4ea77083250a24961", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Some cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "721ed1fa2877dac74c5621318f99cbf16a609eda", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/721ed1fa2877dac74c5621318f99cbf16a609eda", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Prevent NPE if status was null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daf81642d5caaf0746aa1f77f7dfaaf3fec14181", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/daf81642d5caaf0746aa1f77f7dfaaf3fec14181", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Consider GraphCacheStrategy in OIA"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "013f728eb22c9d37f3a8814eb22a01dffc9bfb0d", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/013f728eb22c9d37f3a8814eb22a01dffc9bfb0d", "committedDate": "2020-02-13T09:50:10Z", "message": "NMS-12445: Apply rename from oia upstream to the implemetnation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d03bdc79e403485a5913b4084e6c44e4fc95b133", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/d03bdc79e403485a5913b4084e6c44e4fc95b133", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Fix NPE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3cdc4ce37308f974e37ae623c8f58e4ac7ca574", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/e3cdc4ce37308f974e37ae623c8f58e4ac7ca574", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Implement getOppositeVertices(VertexRef)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d92f33a6968c08c2077076b2befc7bb809c79391", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/d92f33a6968c08c2077076b2befc7bb809c79391", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Use thread-safe map"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fc507c4efcbe9788a599c648419de9c7b171af0", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/4fc507c4efcbe9788a599c648419de9c7b171af0", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Register MetaTopologyProvider last to avoid wird states (no icons/no status, etc)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "770b605ce6208491d3db6175943fab7c02e85bae", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/770b605ce6208491d3db6175943fab7c02e85bae", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Expose TopologyCache as its own interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec2ca90cfa48041630bc72488cdf192acc198410", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/ec2ca90cfa48041630bc72488cdf192acc198410", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Invalidate topology cache when MetaTopologyProvider is unregistered"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "64153c136bffc1d7fcb06f035e42e259e464d493", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/64153c136bffc1d7fcb06f035e42e259e464d493", "committedDate": "2020-02-12T13:18:59Z", "message": "NMS-12445: Invalidate topology cache when MetaTopologyProvider is unregistered"}, "afterCommit": {"oid": "ec2ca90cfa48041630bc72488cdf192acc198410", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/ec2ca90cfa48041630bc72488cdf192acc198410", "committedDate": "2020-02-13T09:50:11Z", "message": "NMS-12445: Invalidate topology cache when MetaTopologyProvider is unregistered"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ce3cc74a4de2154a63d02ea74f86dadd240319d", "author": {"user": {"login": "mvrueden", "name": null}}, "url": "https://github.com/OpenNMS/opennms/commit/9ce3cc74a4de2154a63d02ea74f86dadd240319d", "committedDate": "2020-02-13T14:55:24Z", "message": "NMS-12445: Make OpenNMS compile again"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMjE4NDYx", "url": "https://github.com/OpenNMS/opennms/pull/2878#pullrequestreview-362218461", "createdAt": "2020-02-20T20:42:20Z", "commit": {"oid": "9ce3cc74a4de2154a63d02ea74f86dadd240319d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3726, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}