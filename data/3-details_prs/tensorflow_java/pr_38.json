{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMDE3ODkw", "number": 38, "title": "Attach protobuf generated classes to TF Core API", "bodyText": "The main purpose of this PR is to generate Java classes from TensorFlow core protocol buffer descriptions and to distribute them directly from the tensorflow-core-api artifact. This way, the API can use concrete typed classes in the signature of some methods accepting TF protocol buffers instead of raw byte arrays.\nThe classes are generated from the Bazel build, using the same protobuf compiler used to build TensorFlow native library, which matches the version of the protobuf Maven dependency. The generated classes are then unarchived in the /src/gen/java folder of the tensorflow-core-api for building the Java library.\nA few other changes were also applied as side-effects of this feature:\n\nUpgrade version of TensorFlow runtime library to 2.2.0-rc2\n\nrequires bazel = 2.0.0\nthis increase the size of this PR considerably but was required to catch up with new protos\n\n\nPatch protobuf definitions that were missing the java_package option\nAdd a utility java_api_import to help select the right package/group for new operations\n\nok this is really just a little helper that gives hints on where maybe that operations has landed in the Python client, no rocket science here... but it is still very useful and for a moment I thought I lost it so I prefer to put it now in a safe place :) Don't spend too much time reviewing it.\n\n\nClassify new ops and move some debugging ops to their own group/package debugging\nRemoved GRPC patch for Ubuntu (TF uses a new version of GRPC that shouldn't have this issue)\n\n@dhruvrajan can you please validate this still compiles for you?\n\n\n\nTo see the impact of including the protobuf in the Java client, look at changes applied to the src/main/java/org/tensorflow classes (e.g. Graph, Session, EagerSession, SavedModelBundle, Server...)\nRef: #21", "createdAt": "2020-04-07T03:35:41Z", "url": "https://github.com/tensorflow/java/pull/38", "merged": true, "mergeCommit": {"oid": "9fe9d87a454308e020b57839abf2e061f04c5a1e"}, "closed": true, "closedAt": "2020-04-11T12:54:45Z", "author": {"login": "karllessard"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVKSTWAH2gAyNDAwMDE3ODkwOjUxNjgwY2M3YjBkMmJmZDYwNWM1MTAyZDI3YjVkYzFiZDMzNTUyMTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV-xtTAH2gAyNDAwMDE3ODkwOmY0NTExZWFjZWMyNjg1ODE4NDZmMmU4OWIwNjJlZWY2OTViZTRlMzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "51680cc7b0d2bfd605c5102d27b5dc1bd3355215", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/51680cc7b0d2bfd605c5102d27b5dc1bd3355215", "committedDate": "2020-04-07T02:57:32Z", "message": "Add protos w/upgrade to TF2.2rc2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "594cbd5c5a1b4b89adcb8b5a00fcdac2e672b6a6", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/594cbd5c5a1b4b89adcb8b5a00fcdac2e672b6a6", "committedDate": "2020-04-07T03:16:49Z", "message": "Adapt API to protobuf classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "128df37db7ae98a6c45f244073b9fbe76bdddc86", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/128df37db7ae98a6c45f244073b9fbe76bdddc86", "committedDate": "2020-04-07T03:16:53Z", "message": "Update bazel version for TF2.2rc2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f145b53bbab3db43aa584492f7e4b4bb85142f40", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/f145b53bbab3db43aa584492f7e4b4bb85142f40", "committedDate": "2020-04-07T03:34:06Z", "message": "Cleanup ops moved to different location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43", "committedDate": "2020-04-07T03:51:56Z", "message": "Check ByteBuffer 32-bits limitations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4Nzg4OTMz", "url": "https://github.com/tensorflow/java/pull/38#pullrequestreview-388788933", "createdAt": "2020-04-07T05:15:47Z", "commit": {"oid": "d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNToxNTo0OFrOGBzKDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNToxNTo0OFrOGBzKDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUzOTkxNg==", "bodyText": "Using the original protobuf artifact as is will cause issues with other libraries that need a different version of protobuf, so this should all be shaded. If the plan is to wait until users having this problem show up, is it going to be OK to break backward compatibility at that time?", "url": "https://github.com/tensorflow/java/pull/38#discussion_r404539916", "createdAt": "2020-04-07T05:15:48Z", "author": {"login": "saudet"}, "path": "tensorflow-core/tensorflow-core-api/pom.xml", "diffHunk": "@@ -14,12 +14,22 @@\n   <name>TensorFlow Core API Library</name>\n   <description>Platform-dependent native code and pure-Java code for the TensorFlow machine intelligence library.</description>\n \n+  <properties>\n+    <!-- Match version used by TensorFlow, in tensorflow/workspace.bzl -->\n+    <protobuf.version>3.8.0</protobuf.version>\n+  </properties>\n+\n   <dependencies>\n     <dependency>\n       <groupId>org.bytedeco</groupId>\n       <artifactId>javacpp</artifactId>\n       <version>${javacpp.version}</version>\n     </dependency>\n+    <dependency>\n+      <groupId>com.google.protobuf</groupId>\n+      <artifactId>protobuf-java</artifactId>\n+      <version>${protobuf.version}</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzkwNTQ3", "url": "https://github.com/tensorflow/java/pull/38#pullrequestreview-388790547", "createdAt": "2020-04-07T05:19:56Z", "commit": {"oid": "d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNToxOTo1N1rOGBzPJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNToxOTo1N1rOGBzPJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU0MTIyMA==", "bodyText": "Could this be translated to Java? And if not, why not?", "url": "https://github.com/tensorflow/java/pull/38#discussion_r404541220", "createdAt": "2020-04-07T05:19:57Z", "author": {"login": "saudet"}, "path": "tensorflow-core/tensorflow-core-api/src/bazel/api_def/import/api_import.cc", "diffHunk": "@@ -0,0 +1,317 @@\n+/* Copyright 2017 The TensorFlow Authors. All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7618c2b9be4b5f0d4942ef8adbd571e8aa6bc43"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4511eacec268581846f2e89b062eef695be4e36", "author": {"user": {"login": "karllessard", "name": "Karl Lessard"}}, "url": "https://github.com/tensorflow/java/commit/f4511eacec268581846f2e89b062eef695be4e36", "committedDate": "2020-04-09T16:06:54Z", "message": "Group all proto classes under the same package"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3440, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}