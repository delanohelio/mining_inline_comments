{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzOTU0NDI2", "number": 1049, "title": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob", "bodyText": "Description\nFixed two bugs that were triggered by scheduler integration tests:\n\nInvalid query in SavingsAccountCharge (missing parameters)\nLazy loading not working for m_savings_account.group_id due to transaction boundary\n\nAlso changed triggering of jobs to use executeAndAwaitJob() and fixed logging for exceptions jobs\nChecklist\nPlease make sure these boxes are checked before submitting your pull request - thanks!\n\n\n Commit message starts with the issue number from https://issues.apache.org/jira/projects/FINERACT/. Ex: FINERACT-646 Pockets API.\n\n\n Coding conventions at https://cwiki.apache.org/confluence/display/FINERACT/Coding+Conventions have been followed.\n\n\n API documentation at fineract-provider/src/main/resources/static/api-docs/apiLive.htm has been updated with details of any API changes.\n\n\n Integration tests have been created/updated for verifying the changes made.\n\n\n All Integrations tests are passing with the new commits.\n\n\n Submission is not a \"code dump\".  (Large changes can be made \"in repository\" via a branch.  Ask on the list.)\n\n\nOur guidelines for code reviews is at https://cwiki.apache.org/confluence/display/FINERACT/Code+Review+Guide", "createdAt": "2020-06-13T03:58:11Z", "url": "https://github.com/apache/fineract/pull/1049", "merged": true, "mergeCommit": {"oid": "e8ecd79b9d70da1cdad1f5e1c7af80ef815d95f5"}, "closed": true, "closedAt": "2020-06-14T12:09:42Z", "author": {"login": "ptuomola"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqwVTmgBqjM0NDA0NzIzODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrKoE3gH2gAyNDMzOTU0NDI2OmZlNWM5ZGNmYzk2MDgwNWU1ZTBjYjI1NzQ5YmMwNzJhMWNlNmJkMzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6925621979518befaf62fd878642d1e564a2003c", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/6925621979518befaf62fd878642d1e564a2003c", "committedDate": "2020-06-13T03:55:41Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}, "afterCommit": {"oid": "18c83a07efb15315cd3e32072de31fc4dea77c9a", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/18c83a07efb15315cd3e32072de31fc4dea77c9a", "committedDate": "2020-06-13T05:09:25Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18c83a07efb15315cd3e32072de31fc4dea77c9a", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/18c83a07efb15315cd3e32072de31fc4dea77c9a", "committedDate": "2020-06-13T05:09:25Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}, "afterCommit": {"oid": "1d3afeec00d3197144f4597218a1a6cc20db0fc2", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/1d3afeec00d3197144f4597218a1a6cc20db0fc2", "committedDate": "2020-06-13T05:25:08Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d3afeec00d3197144f4597218a1a6cc20db0fc2", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/1d3afeec00d3197144f4597218a1a6cc20db0fc2", "committedDate": "2020-06-13T05:25:08Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}, "afterCommit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/ddef698b60bff27b7d2abbd2232b2ff262797815", "committedDate": "2020-06-13T06:18:40Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTIzNTQ5", "url": "https://github.com/apache/fineract/pull/1049#pullrequestreview-430123549", "createdAt": "2020-06-13T08:22:00Z", "commit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QwODoyMjowMFrOGjWbbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QwODoyNDo1MVrOGjWb9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyMDgxMw==", "bodyText": "LOG.error(..., e) instead of e.getMessage() will log full cause. Or was this intentional?", "url": "https://github.com/apache/fineract/pull/1049#discussion_r439720813", "createdAt": "2020-06-13T08:22:00Z", "author": {"login": "vorburger"}, "path": "fineract-provider/src/main/java/org/apache/fineract/scheduledjobs/service/ScheduledJobRunnerServiceImpl.java", "diffHunk": "@@ -229,7 +229,7 @@ public void applyAnnualFeeForSavings() {\n                     LOG.error(\"Apply annual fee failed for account: {} with message {}\", savingsAccountReference.getAccountNo(), error);\n                 }\n             } catch (final Exception ex) {\n-                // need to handle this scenario\n+                LOG.error(\"Apply annual fee failed for account: {} with message: {}\", savingsAccountReference.getAccountNo(), ex.getMessage());\n             }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyMDgyMw==", "bodyText": "as above", "url": "https://github.com/apache/fineract/pull/1049#discussion_r439720823", "createdAt": "2020-06-13T08:22:11Z", "author": {"login": "vorburger"}, "path": "fineract-provider/src/main/java/org/apache/fineract/scheduledjobs/service/ScheduledJobRunnerServiceImpl.java", "diffHunk": "@@ -307,7 +307,7 @@ public void updateMaturityDetailsOfDepositAccounts() {\n                     LOG.error(\"Update maturity details failed for account: {} with message {}\", depositAccount.accountNo(), error.getDeveloperMessage());\n                 }\n             } catch (final Exception ex) {\n-                // need to handle this scenario\n+                LOG.error(\"Update maturity details failed for account: {} with message: {}\", depositAccount.accountNo(), ex.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyMDk0OA==", "bodyText": "Is this left over, or for the lazy loading? I fear future automated code clean up may try to remove this as NOOP... maybe put an inline comment to explain it forces lazy loading, if that's what it is? Or even fake store it in a variable used in a useless expression to prevent NOOP clean up? Or remove if this is just a left over and not actually required.", "url": "https://github.com/apache/fineract/pull/1049#discussion_r439720948", "createdAt": "2020-06-13T08:24:51Z", "author": {"login": "vorburger"}, "path": "fineract-provider/src/main/java/org/apache/fineract/portfolio/savings/domain/SavingsAccount.java", "diffHunk": "@@ -2928,6 +2928,7 @@ public void loadLazyCollections() {\n         transactions.size();\n         charges.size();\n         savingsOfficerHistory.size();\n+        if(group != null) { group.getOffice(); }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b921e3866952291484a69450cc056fdaff1f8ba", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/6b921e3866952291484a69450cc056fdaff1f8ba", "committedDate": "2020-06-13T19:53:22Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ddef698b60bff27b7d2abbd2232b2ff262797815", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/ddef698b60bff27b7d2abbd2232b2ff262797815", "committedDate": "2020-06-13T06:18:40Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}, "afterCommit": {"oid": "6b921e3866952291484a69450cc056fdaff1f8ba", "author": {"user": {"login": "ptuomola", "name": "Petri Tuomola"}}, "url": "https://github.com/apache/fineract/commit/6b921e3866952291484a69450cc056fdaff1f8ba", "committedDate": "2020-06-13T19:53:22Z", "message": "FINERACT-857: Fixing scheduler integration tests and migrating to executeAndAwaitJob"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMjEwNzU4", "url": "https://github.com/apache/fineract/pull/1049#pullrequestreview-430210758", "createdAt": "2020-06-14T11:33:00Z", "commit": {"oid": "6b921e3866952291484a69450cc056fdaff1f8ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5c9dcfc960805e5e0cb25749bc072a1ce6bd31", "author": {"user": {"login": "vorburger", "name": "Michael Vorburger \u26d1\ufe0f"}}, "url": "https://github.com/apache/fineract/commit/fe5c9dcfc960805e5e0cb25749bc072a1ce6bd31", "committedDate": "2020-06-14T11:47:39Z", "message": "Merge branch 'develop' into FINERACT-857"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1897, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}