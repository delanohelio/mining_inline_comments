{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1OTI4NzM4", "number": 7073, "title": "Make warnings non-reportable", "bodyText": "Add a check for logging level in our global logging handler. If the log\nlevel is warning then disable the 'upload button'. Same, if the level\nis a warning also add a generic statement giving the user a link to\nreport the problem.\nThis update allows us to notify users of general errors that have happened\nthat are outside of TripleA's control and are something that we can\ntell the user how to fix in the warning message. This way we can\nuse a 'warning' logging to report this to the user without\nconstructing a full swing dialog with the same text.\nEvents logged at a 'severe' level will continue to have an 'upload' button\nenabled and there is no change to the 'severe' logging behavior.\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[x] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[] Problem fix\n[] Other:   \nTesting\nInjected a logging statement into GameRunner main method to verify dialog behavior for warning and severe levels.\n\nScreens Shots\nBefore\n\nAfter\n\nAdditional Notes to Reviewer\nOf note, this fix is not for us to blindly convert severe logging into warning to make it non-reportable. We should be careful that any warning logging actually tells a user how to fix the problem (eg: \"unavailable, try again\", \"you are a probably already hosting a game on this port, please choose another port\")\n\nRelease Note", "createdAt": "2020-07-08T04:05:08Z", "url": "https://github.com/triplea-game/triplea/pull/7073", "merged": true, "mergeCommit": {"oid": "be411b9cdac62edfdcb79982b78a73c2eaf3d226"}, "closed": true, "closedAt": "2020-07-10T01:30:40Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyylHEgH2gAyNDQ1OTI4NzM4OmVhZjg3MWQ4YTUyOTk2YjgwNDIzZWY2NTcwOTk0ZWJjNTQ5MmExMzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcy3pudgFqTQ0NDYwMzcxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eaf871d8a52996b80423ef6570994ebc5492a131", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/eaf871d8a52996b80423ef6570994ebc5492a131", "committedDate": "2020-07-08T04:18:05Z", "message": "Make warnings non-reportable\n\nAdd a check for logging level in our global logging handler. If the log\nlevel is warning then disable the 'upload button'. Same, if the level\nis a warning also add a generic statement giving the user a link to\nreport the problem.\n\nThis update allows us to notify users of general errors that have happened\nthat are outside of TripleA's control and are something that we can\ntell the user how to fix in the warning message. This way we can\nuse a 'warning' logging to report this to the user without\nconstructing a full swing dialog with the same text.\n\nEvents logged at a 'severe' level will continue to have an 'upload' button\nenabled and there is no change to the 'severe' logging behavior."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d128c55f97d199c129ebee8fa32043ae26ec72e2", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/d128c55f97d199c129ebee8fa32043ae26ec72e2", "committedDate": "2020-07-08T04:00:12Z", "message": "Make warnings non-reportable\n\nAdd a check for logging level in our global logging handler. If the log\nlevel is warning then disable the 'upload button'. Same, if the level\nis a warning also add a generic statement giving the user a link to\nreport the problem.\n\nThis update allows us to notify users of general errors that have happened\nthat are outside of TripleA's control and are something that we can\ntell the user how to fix in the warning message. This way we can\nuse a 'warning' logging to report this to the user without\nconstructing a full swing dialog with the same text.\n\nEvents logged at a 'severe' level will continue to have an 'upload' button\nenabled and there is no change to the 'severe' logging behavior."}, "afterCommit": {"oid": "eaf871d8a52996b80423ef6570994ebc5492a131", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/eaf871d8a52996b80423ef6570994ebc5492a131", "committedDate": "2020-07-08T04:18:05Z", "message": "Make warnings non-reportable\n\nAdd a check for logging level in our global logging handler. If the log\nlevel is warning then disable the 'upload button'. Same, if the level\nis a warning also add a generic statement giving the user a link to\nreport the problem.\n\nThis update allows us to notify users of general errors that have happened\nthat are outside of TripleA's control and are something that we can\ntell the user how to fix in the warning message. This way we can\nuse a 'warning' logging to report this to the user without\nconstructing a full swing dialog with the same text.\n\nEvents logged at a 'severe' level will continue to have an 'upload' button\nenabled and there is no change to the 'severe' logging behavior."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjAzNzEy", "url": "https://github.com/triplea-game/triplea/pull/7073#pullrequestreview-444603712", "createdAt": "2020-07-08T10:12:07Z", "commit": {"oid": "eaf871d8a52996b80423ef6570994ebc5492a131"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDoxMjowOFrOGuhUvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDoxMjowOFrOGuhUvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQzMzY2MQ==", "bodyText": "I actually think this problem is too complex to represent it in a single severity level.\nLet's say a map maker is trying to build a new map and wants to test it.\nTurns out they got the format wrong and therefore the engine is unable to parse the map. I would still consider this a severe error, not a warning because it is an exception that prevents an entire action from happening, but it shouldn't be reportable.\nHowever let's say $User has their maps saved as a folder somewhere and the write and read permissions are messed up. In this case the error is still severe and it's a clear case for user help, but the system can't communicate that at all.\nI must admit that I don't have a better idea than this, it's probably the best short-term approach we can go with, but we might want to change the system to do some heuristics if the error is user related (local IOException, FileNotFound etc.) or it has a real code implication (NullPointerException etc.) in the long run.\nOf course there are edgecases as well: Is a StackOverflowError a regression or a low-memory user issue?\nBut I think it's better than this approach", "url": "https://github.com/triplea-game/triplea/pull/7073#discussion_r451433661", "createdAt": "2020-07-08T10:12:08Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/org/triplea/debug/ErrorMessage.java", "diffHunk": "@@ -130,7 +132,12 @@ private void setUploadRecord(final LogRecord logRecord) {\n   }\n \n   private void activateUploadErrorReportButton(final URI lobbyUri, final LogRecord logRecord) {\n-    INSTANCE.uploadButton.setVisible(true);\n+    // Set upload button to be visible only if the logging is greater than a 'warning'.\n+    // Warning logging should tell a user how to correct the error and it should be something\n+    // that is 'normal' (but maybe not happy, like no internet) and something they can fix\n+    // (or perhaps something that we simply can never fix). Hence, for warning we want to inform\n+    // the user that the problem happened, how to fix it, and let them create a bug report manually.\n+    INSTANCE.uploadButton.setVisible(logRecord.getLevel().intValue() > Level.WARNING.intValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eaf871d8a52996b80423ef6570994ebc5492a131"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3201, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}