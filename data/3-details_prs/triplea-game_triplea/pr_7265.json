{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2OTA3NDc3", "number": 7265, "title": "Add an initial schema for maps-db", "bodyText": "Contains enough of a schema that we can model the triplea_maps.yaml file\n\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[x] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[] Problem fix\n[] Other:   \nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\nOpen to discussion on this, working draft PR. Schema is important!!\n\nRelease Note", "createdAt": "2020-07-27T05:29:03Z", "url": "https://github.com/triplea-game/triplea/pull/7265", "merged": true, "mergeCommit": {"oid": "142b57167befc5951d67520c8cf8081360243018"}, "closed": true, "closedAt": "2020-08-19T02:17:16Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc468RVAH2gAyNDU2OTA3NDc3OjE2ZDE0OGIxMzYzMTk4NDQwZGY3OTEzZTQ3NmY3MTY2NWM2YTczZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6iFf2AH2gAyNDU2OTA3NDc3OjhlNzgxMWQ4ZmVjYzIzZTU1Mzk2M2FiNmU2NDIxZjIwZDcxNWYwMmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/16d148b1363198440df7913e476f71665c6a73e2", "committedDate": "2020-07-27T05:26:10Z", "message": "Add an initial schema for maps-db\n\n- Contains enough of a schema that we can model the triplea_maps.yaml file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDkwNjkw", "url": "https://github.com/triplea-game/triplea/pull/7265#pullrequestreview-457490690", "createdAt": "2020-07-29T12:54:21Z", "commit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjo1NDoyMVrOG43BXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMzoyMjoxMVrOG44JEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3NDkxMA==", "bodyText": "I think sooner or later we'll have to revisit those tags/categories, but for now it's good.", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462274910", "createdAt": "2020-07-29T12:54:21Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()\n+);\n+\n+create table category (\n+  id serial primary key,\n+  name varchar(32) unique not null check (length(name) > 2),\n+  date_created timestamptz not null default now()\n+);\n+\n+insert into category (name) values\n+  ('BEST'),\n+  ('GOOD'),\n+  ('EXPERIMENTAL');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3ODA2Mw==", "bodyText": "I mean a length check is nice, but I don't think it's necessary here tbh", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462278063", "createdAt": "2020-07-29T12:59:14Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()\n+);\n+\n+create table category (\n+  id serial primary key,\n+  name varchar(32) unique not null check (length(name) > 2),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI4NzQ1Ng==", "bodyText": "Not sure we need a creation date, but I guess it doesn't hurt", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462287456", "createdAt": "2020-07-29T13:13:44Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI4Nzk0MA==", "bodyText": "I don't think Map Thumbnails are a requirement right now.\nSo the not null constraint might be wrong, I could be wrong though", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462287940", "createdAt": "2020-07-29T13:14:31Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()\n+);\n+\n+create table category (\n+  id serial primary key,\n+  name varchar(32) unique not null check (length(name) > 2),\n+  date_created timestamptz not null default now()\n+);\n+\n+insert into category (name) values\n+  ('BEST'),\n+  ('GOOD'),\n+  ('EXPERIMENTAL');\n+\n+\n+create table map_version (\n+  id serial primary key,\n+  map_id integer not null references map(id),\n+  version integer not null check (version > 0),\n+  url varchar(256) not null check (url like 'http%'),\n+  thumbnail varchar(256) not null check (thumbnail like 'http%'),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI5MTA2Nw==", "bodyText": "Ok, I don't quite get what those timestamps are supposed to represent.\nDoesn't the map table store the \"last updated\" date already?", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462291067", "createdAt": "2020-07-29T13:18:57Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()\n+);\n+\n+create table category (\n+  id serial primary key,\n+  name varchar(32) unique not null check (length(name) > 2),\n+  date_created timestamptz not null default now()\n+);\n+\n+insert into category (name) values\n+  ('BEST'),\n+  ('GOOD'),\n+  ('EXPERIMENTAL');\n+\n+\n+create table map_version (\n+  id serial primary key,\n+  map_id integer not null references map(id),\n+  version integer not null check (version > 0),\n+  url varchar(256) not null check (url like 'http%'),\n+  thumbnail varchar(256) not null check (thumbnail like 'http%'),\n+  category_id integer not null references category(id),\n+  description varchar(4096),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI5MzI2NQ==", "bodyText": "Sooner or later we might want to revisit this too", "url": "https://github.com/triplea-game/triplea/pull/7265#discussion_r462293265", "createdAt": "2020-07-29T13:22:11Z", "author": {"login": "RoiEXLab"}, "path": "maps-db/src/main/resources/db/migration/V1.00.01__create_map_index_table.sql", "diffHunk": "@@ -0,0 +1,33 @@\n+comment on database maps_db is 'Database used to store, track and serve map information';\n+\n+create table map (\n+  id serial primary key,\n+  name varchar(256) not null unique check(length(name) > 3),\n+  date_created timestamptz not null default now(),\n+  date_updated timestamptz not null default now()\n+);\n+\n+create table category (\n+  id serial primary key,\n+  name varchar(32) unique not null check (length(name) > 2),\n+  date_created timestamptz not null default now()\n+);\n+\n+insert into category (name) values\n+  ('BEST'),\n+  ('GOOD'),\n+  ('EXPERIMENTAL');\n+\n+\n+create table map_version (\n+  id serial primary key,\n+  map_id integer not null references map(id),\n+  version integer not null check (version > 0),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d148b1363198440df7913e476f71665c6a73e2"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e7811d8fecc23e553963ab6e6421f20d715f02f", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/8e7811d8fecc23e553963ab6e6421f20d715f02f", "committedDate": "2020-08-01T05:36:28Z", "message": "Drop non-null constraint on map-thumbnail and add uniqueness constraints\n\n- map-version 'map-id' and 'version' should be unique, we expect only one version\n  of a given map version.\n- each map-version URL should be unique as well so that only one map-version\n  points to a specific location."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3250, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}