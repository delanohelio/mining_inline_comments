{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NTM1NDA4", "number": 6038, "title": "Notify game removed", "bodyText": "Overview\nResolves: #6025 \"Game listings not removed\" by adding pro-active callbacks to the lobby to notify that a game has been closed. Otherwise we will rely on TTL expiration to remove a game if the lobby game fails to send a closed notification pro-actively.\nCommits\ncommit 06c6c4e\nShutdown lobby watcher on server game cancel\n\ncommit d39d2f7\nShutdown server if lobby staging screen is closed\n\ncommit a7a1aa3\nAdd system exit callback to close servermodel if program is exited\n\nThis ensures that we will remove any listed lobby games if we launch\na server game and then exit the program. If we simply leave the program\nwe should be sure to actually keep the game listed as we just change\nstate from running to waiting.\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[x] Problem fix:  #6025 \n[] Other:   \nTesting\nVerified the 3 scenarios in #6025 were fixed and general smoke testing around quit functionality.", "createdAt": "2020-03-11T07:54:19Z", "url": "https://github.com/triplea-game/triplea/pull/6038", "merged": true, "mergeCommit": {"oid": "5ddfca3ee78f8b2db5205459b320abd3b74d0d07"}, "closed": true, "closedAt": "2020-03-11T20:56:46Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMhUaOAH2gAyMzg2NTM1NDA4OjA2YzZjNGU1NTAzZWIyM2Q5Y2ZlNDRiMjY1MzNlM2IyNDViZGUyNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMkW1lAFqTM3MjYyNTMyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "06c6c4e5503eb23d9cfe44b26533e3b245bde245", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/06c6c4e5503eb23d9cfe44b26533e3b245bde245", "committedDate": "2020-03-11T06:42:20Z", "message": "Shutdown lobby watcher on server game cancel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d39d2f72faffd11f1f45cf56fca3f09ab1bbb766", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/d39d2f72faffd11f1f45cf56fca3f09ab1bbb766", "committedDate": "2020-03-11T07:47:07Z", "message": "Shutdown server if lobby staging screen is closed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7a1aa338903e60935341494eaffb975459b3c4a", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/a7a1aa338903e60935341494eaffb975459b3c4a", "committedDate": "2020-03-11T07:53:38Z", "message": "Add system exit callback to close servermodel if program is exited\n\nThis ensures that we will remove any listed lobby games if we launch\na server game and then exit the program. If we simply leave the program\nwe should be sure to actually keep the game listed as we just change\nstate from running to waiting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNjI1MzIy", "url": "https://github.com/triplea-game/triplea/pull/6038#pullrequestreview-372625322", "createdAt": "2020-03-11T10:14:32Z", "commit": {"oid": "a7a1aa338903e60935341494eaffb975459b3c4a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMDoxNDozM1rOF0wpOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMDoxNDozM1rOF0wpOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg2NzI1Nw==", "bodyText": "What's wrong with calling cancel here?", "url": "https://github.com/triplea-game/triplea/pull/6038#discussion_r390867257", "createdAt": "2020-03-11T10:14:33Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/games/strategy/engine/framework/startup/mc/ServerModel.java", "diffHunk": "@@ -422,7 +426,6 @@ private void createServerMessenger(\n                     .bannedPlayerListener(new PlayerDisconnectAction(serverMessenger, this::cancel))\n                     .shutdownListener(\n                         emptyStringMessage -> {\n-                          cancel();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7a1aa338903e60935341494eaffb975459b3c4a"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3732, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}