{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyODIwODM4", "number": 6236, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMTo1MDo0MFrODxZrRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMTo1MDo0MFrODxZrRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMTI3NDk0OnYy", "diffSide": "RIGHT", "path": "http-clients/src/main/java/org/triplea/http/client/web/socket/WebSocketConnection.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMTo1MDo0MFrOGE2m5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMDo1MTo0NVrOGE6Q-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc0MjE4Mw==", "bodyText": "I don't know what the server side of the websocket implementation is capable of, but I think it would be a better idea to use a custom status code  for closing (it looks like codes 4000 - 4999 are reserved for application use) and make decisions based on that.", "url": "https://github.com/triplea-game/triplea/pull/6236#discussion_r407742183", "createdAt": "2020-04-13T21:50:40Z", "author": {"login": "RoiEXLab"}, "path": "http-clients/src/main/java/org/triplea/http/client/web/socket/WebSocketConnection.java", "diffHunk": "@@ -205,7 +205,11 @@ public void onOpen(final WebSocket webSocket) {\n     public CompletionStage<?> onClose(\n         final WebSocket webSocket, final int statusCode, final String reason) {\n       pingSender.cancel();\n-      listener.connectionClosed(reason);\n+      if (reason.equals(WebSocketConnection.CLIENT_DISCONNECT_MESSAGE)) {\n+        listener.connectionClosed();\n+      } else {\n+        listener.connectionTerminated(reason.isBlank() ? \"Server disconnected\" : reason);\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61c204e21cd7f601918b8afb192f85de288d05ad"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgwMjEwNA==", "bodyText": "Why better?\nstatus code for http calls can certainly give more information. There are cases where the payload of a 200 is an error message, ie: the message and service are all okay, everything happened as expected, but something resulted in an error.\nIn this case though, the message string is quite exact, keeps it quite simple. (For example, a close from server very well could be a 200, which would look like the same if the client closed)", "url": "https://github.com/triplea-game/triplea/pull/6236#discussion_r407802104", "createdAt": "2020-04-14T00:51:45Z", "author": {"login": "DanVanAtta"}, "path": "http-clients/src/main/java/org/triplea/http/client/web/socket/WebSocketConnection.java", "diffHunk": "@@ -205,7 +205,11 @@ public void onOpen(final WebSocket webSocket) {\n     public CompletionStage<?> onClose(\n         final WebSocket webSocket, final int statusCode, final String reason) {\n       pingSender.cancel();\n-      listener.connectionClosed(reason);\n+      if (reason.equals(WebSocketConnection.CLIENT_DISCONNECT_MESSAGE)) {\n+        listener.connectionClosed();\n+      } else {\n+        listener.connectionTerminated(reason.isBlank() ? \"Server disconnected\" : reason);\n+      }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc0MjE4Mw=="}, "originalCommit": {"oid": "61c204e21cd7f601918b8afb192f85de288d05ad"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2252, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}