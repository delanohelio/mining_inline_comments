{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTA4MTA0", "number": 6842, "title": "Indicate if the missing image is for a damaged or disabled unit", "bodyText": "This adds some additional text to the 'MISSING UNIT IMAGE' error message to indicate if the image should be a damaged and/or disabled image.  That should help in figuring out what image is actually missing.  It also might help in figuring out if the game is requesting these images more in 2.0 vs 1.9.\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[] Problem fix\n[] Other:   \nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note\n\nCHANGE|Missing Unit Image error now indicates if image should be a damaged and/or disabled image", "createdAt": "2020-06-25T15:48:09Z", "url": "https://github.com/triplea-game/triplea/pull/6842", "merged": true, "mergeCommit": {"oid": "ca0245eff9502cd9dcb0131edbc607ab261bf49d"}, "closed": true, "closedAt": "2020-06-28T20:06:39Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuwlydgH2gAyNDQwMTA4MTA0OjMzOTY0ODMyNjZhOGUxM2RkZDQ1NjdiMTdjOTA0NTg0NmI4MmE3YmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvEzlMgFqTQzODM4MTE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3396483266a8e13ddd4567b17c9045846b82a7bb", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/3396483266a8e13ddd4567b17c9045846b82a7bb", "committedDate": "2020-06-25T15:43:19Z", "message": "Indicate if the missing image is for a damaged or disabled unit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/ae927f36595d3ba218af66b638815b8e5a657c71", "committedDate": "2020-06-25T15:51:20Z", "message": "Use String.join instead of StringBuilder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MDA3NDY1", "url": "https://github.com/triplea-game/triplea/pull/6842#pullrequestreview-438007465", "createdAt": "2020-06-26T04:35:48Z", "commit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDozNTo0OFrOGpTZcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDozNjo1OFrOGpTaZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MjYwOA==", "bodyText": "nit, what's the motivation to re-assign disabled to a new variable?", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445962608", "createdAt": "2020-06-26T04:35:48Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2Mjg1Mg==", "bodyText": "We can have, or even require sometimes a disabled & damaged image? I kinda thought they were mutually exclusive. If not, it implies a pretty large number of image permutations that is probably not typically included (which would be kinda bad news).", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445962852", "createdAt": "2020-06-26T04:36:58Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;\n     final Optional<Image> img =\n-        uiContext\n-            .getUnitImageFactory()\n-            .getImage(type, owner, damaged > 0 || bombingUnitDamage > 0, disabled);\n+        uiContext.getUnitImageFactory().getImage(type, owner, damagedImage, disabledImage);\n \n     if (img.isEmpty() && !uiContext.isShutDown()) {\n+      final List<String> imageQualifiers = new ArrayList<>();\n+      if (damagedImage) {\n+        imageQualifiers.add(\"damaged \");\n+      }\n+      if (disabledImage) {\n+        imageQualifiers.add(\"disabled \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae656e3cfe049751ccc6c76947d1a5867c72858d", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/ae656e3cfe049751ccc6c76947d1a5867c72858d", "committedDate": "2020-06-26T04:45:22Z", "message": "Fix calculation of the image qualifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5dd55ed30b315f09c82a47bda6afee21764eabf", "author": {"user": {"login": "tripleabuilderbot", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/e5dd55ed30b315f09c82a47bda6afee21764eabf", "committedDate": "2020-06-26T04:47:37Z", "message": "Auto-Formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzgxMTQz", "url": "https://github.com/triplea-game/triplea/pull/6842#pullrequestreview-438381143", "createdAt": "2020-06-26T15:16:25Z", "commit": {"oid": "e5dd55ed30b315f09c82a47bda6afee21764eabf"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNToxNjoyNVrOGpkwRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNToxNjoyNVrOGpkwRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI0Njk4Mw==", "bodyText": "I think this error message shouldn't be all caps tbh", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r446246983", "createdAt": "2020-06-26T15:16:25Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +110,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n     final Optional<Image> img =\n-        uiContext\n-            .getUnitImageFactory()\n-            .getImage(type, owner, damaged > 0 || bombingUnitDamage > 0, disabled);\n+        uiContext.getUnitImageFactory().getImage(type, owner, damagedImage, disabled);\n \n     if (img.isEmpty() && !uiContext.isShutDown()) {\n+      final String imageQualifier;\n+      if (disabled) {\n+        imageQualifier = \"disabled \";\n+      } else if (damagedImage) {\n+        imageQualifier = \"damaged \";\n+      } else {\n+        imageQualifier = \"\";\n+      }\n       log.severe(\n           \"MISSING UNIT IMAGE (won't be displayed): \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5dd55ed30b315f09c82a47bda6afee21764eabf"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3280, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}