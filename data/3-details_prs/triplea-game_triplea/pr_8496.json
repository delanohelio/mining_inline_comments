{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MjM4NjY1", "number": 8496, "title": "Move some matches to use relationshiptracker instead of game state", "bodyText": "This modifies a few of the Matches methods to take just the RelationshipTracker instead of the full GameState/GameData.\nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note", "createdAt": "2020-12-22T16:44:07Z", "url": "https://github.com/triplea-game/triplea/pull/8496", "merged": true, "mergeCommit": {"oid": "ecb8c41aa153e41e1b1b99288a05d572b06d7cb2"}, "closed": true, "closedAt": "2020-12-22T17:17:41Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdotIXIAH2gAyNTQ0MjM4NjY1OmU1MDk1NmFkYWVlZGE5ODA3MDg0NzM0NGIyY2Q0ZTI2ZjdmNWNiY2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdot0kOgFqTU1NzIzNzQwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e50956adaeeda98070847344b2cd4e26f7f5cbce", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/e50956adaeeda98070847344b2cd4e26f7f5cbce", "committedDate": "2020-12-22T16:29:04Z", "message": "Change Matches.unitIsEnemyOf to take RelationshipTracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00be5e9311a155b4af9f51d4f3855a7c499ae86c", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/00be5e9311a155b4af9f51d4f3855a7c499ae86c", "committedDate": "2020-12-22T16:31:33Z", "message": "Change Matches.unitIsAlliedCarrier to take RelationshipTracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "095209fc3afb219f70372a1d6a3af7f468add093", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/095209fc3afb219f70372a1d6a3af7f468add093", "committedDate": "2020-12-22T16:36:56Z", "message": "Change Matches.isTerritoryAllies to take RelationshipTracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f8aa75f858b537e57ce78977d654538aca0dae8", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/9f8aa75f858b537e57ce78977d654538aca0dae8", "committedDate": "2020-12-22T16:42:40Z", "message": "Change Matches#territoryHasAlliedIsFactoryOrCanProduceUnits to take RelationshipTracker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjM3NDA0", "url": "https://github.com/triplea-game/triplea/pull/8496#pullrequestreview-557237404", "createdAt": "2020-12-22T17:17:21Z", "commit": {"oid": "9f8aa75f858b537e57ce78977d654538aca0dae8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzoxNzoyMVrOIKCn9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzoxNzoyMVrOIKCn9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5OTY3MQ==", "bodyText": "For consideration, this might not be the right way remove GameData from Matches. It could make more sense to instead to inline this match altogether. In that case we'd want the object invoking this to not only have the match inlined, but also for that object to keep a reference to relationship tracker and not GameData.\nI think any one-line matcher needs to be really questions. The Matches API is a DIY java8 Predicate that was created before Java8 came out. We are now re-inventing a java built-in here.\nEG:\n.filter(unitIsEnemyOf(relationshipTracker, player))\n\nvs:\n.filter(unit -> relationshipTracker.isAtWar(unit.getOwner(), player))\n\nI think we need to consider how we are going to update Matches, whether it really is a nicer API for such cases. If so, this update makes sense, if not, then the update here is churn.", "url": "https://github.com/triplea-game/triplea/pull/8496#discussion_r547399671", "createdAt": "2020-12-22T17:17:21Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/Matches.java", "diffHunk": "@@ -245,8 +245,9 @@ private Matches() {}\n     return unit -> UnitAttachment.get(unit.getType()).getDefense(unit.getOwner()) >= defendValue;\n   }\n \n-  public static Predicate<Unit> unitIsEnemyOf(final GameState data, final GamePlayer player) {\n-    return unit -> data.getRelationshipTracker().isAtWar(unit.getOwner(), player);\n+  public static Predicate<Unit> unitIsEnemyOf(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8aa75f858b537e57ce78977d654538aca0dae8"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3833, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}