{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxOTU0ODY3", "number": 6074, "title": "Update infrastructure to be able to deloy 1.9 bots", "bodyText": "Update production inventory to reflect servers that are fully managed by ansible\ndeployments. We can deploy admin keys as a one-off by hand to other servers\nas needed. Otherwise now we will have bot updates take effect after merges.\nUpdate production overrides to reflect 1.9 servers. When creating a 2.0 production,\nwe will probably want to create as second production inventory file to keep\nthe server configurations different.\nParameterize the bot args and define one set of args for 1.9 in production.yml\ngroup_vars, an override that applies to servers only in production.yml. Otherwise\nthe default vars are appropriate for 2.0 servers.\nAdd an important 'using_latest' parameter to allow bot servers to either\nuse a latest 'jar' file build or when 'using_latest' is false to download\na target jar file version. This parameter allows for deployments of arbitrary\nversions. To support this, we override and fix the version value in production.\nUse version 1.9.0.0.12226 for production bots, the latest stable jar build (13066)\nhas an inadvertent AWT (headed) dependency and fails on startup.\n\n \nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[x] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[x] Configuration Change\n[] Problem fix:  \n[] Other:   \nTesting\n\n\n\n\nAdditional Review Notes\n\nMostly checking in code that was used to launch the latest new 1.9 bot servers\nReview focusing on consistency and any clarity names/text is welcome\nThe 'download-all-maps' script is based on the 'clone-all-maps' script located in maps repo: https://github.com/triplea-maps/admin_scripts/blob/master/bin/clone_all.sh\nI plan to follow-up with another PR with documentation on how to set up linodes for bot servers and which commands to run to get the servers configured and running. As is, if we add a bot server to the production inventory, it will be launched, will have admin scripts (and will have no maps on it, but only need to SSH to it and run the 'download-all-maps' script).", "createdAt": "2020-03-22T04:23:29Z", "url": "https://github.com/triplea-game/triplea/pull/6074", "merged": true, "mergeCommit": {"oid": "7a0590dc9a3f9311bfdd86ab623f0fad56dd7e86"}, "closed": true, "closedAt": "2020-03-23T14:29:00Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQBe2GAH2gAyMzkxOTU0ODY3OjdmOGVjM2FlOWNiZDE0ODVkNzYxMjY5Zjk4ZTExMTVkODNlMjg1NWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQTwELAFqTM3OTA4MTM1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7f8ec3ae9cbd1485d761269f98e1115d83e2855a", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/7f8ec3ae9cbd1485d761269f98e1115d83e2855a", "committedDate": "2020-03-22T03:52:28Z", "message": "Update infrastructure to be able to deloy 1.9 bots\n\n- Update production inventory to reflect servers that are fully managed by ansible\n  deployments. We can deploy admin keys as a one-off by hand to other servers\n  as needed. Otherwise now we will have bot updates take effect after merges.\n- Update production overrides to reflect 1.9 servers. When creating a 2.0 production,\n  we will probably want to create as second production inventory file to keep\n  the server configurations different.\n- Parameterize the bot args and define one set of args for 1.9 in production.yml\n  group_vars, an override that applies to servers only in production.yml. Otherwise\n  the default vars are appropriate for 2.0 servers.\n- Add an important 'using_latest' parameter to allow bot servers to either\n  use a latest 'jar' file build or when 'using_latest' is false to download\n  a target jar file version. This parameter allows for deployments of arbitrary\n  versions. To support this, we override and fix the version value in production.\n- Use version 1.9.0.0.12226 for production bots, the latest stable jar build (13066)\n  has an inadvertent AWT (headed) dependency and fails on startup."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MDgxMzUx", "url": "https://github.com/triplea-game/triplea/pull/6074#pullrequestreview-379081351", "createdAt": "2020-03-23T00:51:49Z", "commit": {"oid": "7f8ec3ae9cbd1485d761269f98e1115d83e2855a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMDo1MTo0OVrOF50VsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMDo1Mjo1N1rOF50WRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE3MDY3Mg==", "bodyText": "If this entry is removed, is there still a need to write [letsEncrypt:children] here?", "url": "https://github.com/triplea-game/triplea/pull/6074#discussion_r396170672", "createdAt": "2020-03-23T00:51:49Z", "author": {"login": "RoiEXLab"}, "path": "infrastructure/ansible/inventory/production", "diffHunk": "@@ -23,5 +22,4 @@ forums\n production\n \n [letsEncrypt:children]\n-dropwizardHosts", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f8ec3ae9cbd1485d761269f98e1115d83e2855a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE3MDgyMA==", "bodyText": "Are postgresHosts and dropwizardHosts still required?", "url": "https://github.com/triplea-game/triplea/pull/6074#discussion_r396170820", "createdAt": "2020-03-23T00:52:57Z", "author": {"login": "RoiEXLab"}, "path": "infrastructure/ansible/inventory/production", "diffHunk": "@@ -1,14 +1,13 @@\n [postgresHosts]\n-lobby.triplea-game.org\n \n [dropwizardHosts]\n-lobby.triplea-game.org", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f8ec3ae9cbd1485d761269f98e1115d83e2855a"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3590, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}