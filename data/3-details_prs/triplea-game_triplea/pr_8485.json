{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNzk1NTY4", "number": 8485, "title": "Add the player types to the headless Injections", "bodyText": "Testing\n\nStarted a headless game bot, started lobby, started headed game.  Connected to the local lobby and connected to the headless game.  Before this change, it would throw errors about unknown player types.  Now it works.\nScreens Shots\n\nAdditional Notes to Reviewer\n\nI don't generally play in the lobby but it feels like the headless bots have changed behavior.  Now, when I loaded the bot, it immediately started the game with all players using the AI.  I reverted the code to before the introduction of the \"ai\" project and it still is acting like that.  I'm going to look back further to see if there is a change in behavior.  But that would be fixed in a different PR, if there is a fix needed.\nRelease Note", "createdAt": "2020-12-22T00:21:35Z", "url": "https://github.com/triplea-game/triplea/pull/8485", "merged": true, "mergeCommit": {"oid": "a53460856d80dba8cfc8571c72d6bb783e176b01"}, "closed": true, "closedAt": "2020-12-24T19:45:58Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdofQMWgH2gAyNTQzNzk1NTY4OmJiYTViYTQ2ODFjNzA3ZTg4YTYyMTllMWEwZjA4NDMwNzVhOGU4M2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpZDxygH2gAyNTQzNzk1NTY4Ojg2YzViOTg4ZGJlMTZkNmRkMTY0YjQzNmY1NzJjZDJjNGNhYzVjMDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bba5ba4681c707e88a6219e1a0f0843075a8e83b", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/bba5ba4681c707e88a6219e1a0f0843075a8e83b", "committedDate": "2020-12-22T00:18:57Z", "message": "Add the player types to the headless Injections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2ODIxNDYw", "url": "https://github.com/triplea-game/triplea/pull/8485#pullrequestreview-556821460", "createdAt": "2020-12-22T05:07:11Z", "commit": {"oid": "bba5ba4681c707e88a6219e1a0f0843075a8e83b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwNTowNzoxMVrOIJuh_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwNTowNzoxMVrOIJuh_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzA3MDQ2Mw==", "bodyText": "Bots are not able to use AI players, does this make sense to have?", "url": "https://github.com/triplea-game/triplea/pull/8485#discussion_r547070463", "createdAt": "2020-12-22T05:07:11Z", "author": {"login": "DanVanAtta"}, "path": "game-headless/src/main/java/org/triplea/game/server/HeadlessGameRunner.java", "diffHunk": "@@ -17,6 +26,20 @@ public static void main(final String[] args) {\n   }\n \n   private static Injections constructInjections() {\n-    return Injections.builder().engineVersion(new ProductVersionReader().getVersion()).build();\n+    return Injections.builder()\n+        .engineVersion(new ProductVersionReader().getVersion())\n+        .playerTypes(gatherPlayerTypes())\n+        .build();\n+  }\n+\n+  private static Collection<PlayerTypes.Type> gatherPlayerTypes() {\n+    return Stream.of(\n+            PlayerTypes.getBuiltInPlayerTypes(),\n+            List.of(new PlayerTypes.AiType(new DoesNothingAiProvider())),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bba5ba4681c707e88a6219e1a0f0843075a8e83b"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4MzM1NTYx", "url": "https://github.com/triplea-game/triplea/pull/8485#pullrequestreview-558335561", "createdAt": "2020-12-24T04:57:49Z", "commit": {"oid": "bba5ba4681c707e88a6219e1a0f0843075a8e83b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwNDo1Nzo0OVrOIK-mpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwNDo1Nzo0OVrOIK-mpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODM4MjM3Mg==", "bodyText": "I'm quite sure we're not going to deploy custom AIs to bots, for a number of reasons:\n\nnone exist yet\nwe keep bots uniform, if something is going to be baked into the deployment it is effectively part of the code\nwe're fully responsible for bots running, any drop-in AIs are going to be us managing and debugging, at which point it really may as well be part of the main code base (a distributed code base is inherently more complex)\nAIs don't run on bots.", "url": "https://github.com/triplea-game/triplea/pull/8485#discussion_r548382372", "createdAt": "2020-12-24T04:57:49Z", "author": {"login": "DanVanAtta"}, "path": "game-headless/src/main/java/org/triplea/game/server/HeadlessGameRunner.java", "diffHunk": "@@ -17,6 +26,20 @@ public static void main(final String[] args) {\n   }\n \n   private static Injections constructInjections() {\n-    return Injections.builder().engineVersion(new ProductVersionReader().getVersion()).build();\n+    return Injections.builder()\n+        .engineVersion(new ProductVersionReader().getVersion())\n+        .playerTypes(gatherPlayerTypes())\n+        .build();\n+  }\n+\n+  private static Collection<PlayerTypes.Type> gatherPlayerTypes() {\n+    return Stream.of(\n+            PlayerTypes.getBuiltInPlayerTypes(),\n+            List.of(new PlayerTypes.AiType(new DoesNothingAiProvider())),\n+            StreamSupport.stream(ServiceLoader.load(AiProvider.class).spliterator(), false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bba5ba4681c707e88a6219e1a0f0843075a8e83b"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e3e339140a3c6ac24df08ab3b96e6267830c457", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/6e3e339140a3c6ac24df08ab3b96e6267830c457", "committedDate": "2020-12-24T17:15:43Z", "message": "Remove unneeded service discovery for headless runner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9123e42576df98510bb828c75aa4a31373a2970e", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/9123e42576df98510bb828c75aa4a31373a2970e", "committedDate": "2020-12-24T17:18:36Z", "message": "Merge remote-tracking branch 'upstream/master' into fix-bot-ai-player-type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbfb56f0846a488d7b7901480bf52e3de4bd17c8", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/cbfb56f0846a488d7b7901480bf52e3de4bd17c8", "committedDate": "2020-12-24T17:29:15Z", "message": "Remove doesnothing ai from headless bot"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NzA3NjEz", "url": "https://github.com/triplea-game/triplea/pull/8485#pullrequestreview-558707613", "createdAt": "2020-12-24T19:36:27Z", "commit": {"oid": "cbfb56f0846a488d7b7901480bf52e3de4bd17c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxOTozNjoyN1rOILTpcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxOTozNjoyN1rOILTpcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODcyNzE1NQ==", "bodyText": "nit, looks like it would be more concise and consistent (with   .engineVersion(new ProductVersionReader().getVersion())) to inline this method", "url": "https://github.com/triplea-game/triplea/pull/8485#discussion_r548727155", "createdAt": "2020-12-24T19:36:27Z", "author": {"login": "DanVanAtta"}, "path": "game-headless/src/main/java/org/triplea/game/server/HeadlessGameRunner.java", "diffHunk": "@@ -17,6 +19,13 @@ public static void main(final String[] args) {\n   }\n \n   private static Injections constructInjections() {\n-    return Injections.builder().engineVersion(new ProductVersionReader().getVersion()).build();\n+    return Injections.builder()\n+        .engineVersion(new ProductVersionReader().getVersion())\n+        .playerTypes(gatherPlayerTypes())\n+        .build();\n+  }\n+\n+  private static Collection<PlayerTypes.Type> gatherPlayerTypes() {\n+    return PlayerTypes.getBuiltInPlayerTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbfb56f0846a488d7b7901480bf52e3de4bd17c8"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86c5b988dbe16d6dd164b436f572cd2c4cac5c01", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/86c5b988dbe16d6dd164b436f572cd2c4cac5c01", "committedDate": "2020-12-24T19:39:53Z", "message": "Inline gatherPlayerTypes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3831, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}