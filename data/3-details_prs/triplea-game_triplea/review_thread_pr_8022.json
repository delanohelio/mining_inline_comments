{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNDY0ODk3", "number": 8022, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxNzowMTozMVrOE0D-dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQwMToxODowNFrOE0GMEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMDI2NTUwOnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/delegate/power/calculator/CombatValue.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxNzowMTozMVrOHropVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxNzowMTozMVrOHropVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUxNjc1Nw==", "bodyText": "I added this api method because territoryEffects was being passed around solely to be used in a \"simplified\" combat value calculator (see UnitBattleComparator#getUnitPowerForSorting).  I think I'll be able to replace that completely with the new combat values but I didn't want to include that change in this PR.  So, by adding this getTerritoryEffects api, it allows me to remove the need to pass it around manually and then once I rework UnitBattleComparator#getUnitPowerForSorting, I'll remove this api completely.", "url": "https://github.com/triplea-game/triplea/pull/8022#discussion_r515516757", "createdAt": "2020-10-31T17:01:31Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/power/calculator/CombatValue.java", "diffHunk": "@@ -15,8 +15,14 @@\n \n   boolean isDefending();\n \n+  Collection<TerritoryEffect> getTerritoryEffects();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "792f21a8b5dd3d485b9ee46ebd80bc8ace7073fd"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMDI2ODUxOnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/delegate/power/calculator/CombatValue.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxNzowNDozNlrOHroqvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxNzowNDozNlrOHroqvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUxNzExOA==", "bodyText": "getFriendUnits and getEnemyUnits is used solely to send the friend and enemy units across the wire in Player#selectCasualties.  And the only implementation of Player#selectCasualties that uses the enemy and friend units is AbstractProAi#selectCasualties.  I've thought about putting a @ChangeOnNextRelease tag here, but I'm not exactly sure if there is something that could be done to remove the need for these two methods.", "url": "https://github.com/triplea-game/triplea/pull/8022#discussion_r515517118", "createdAt": "2020-10-31T17:04:36Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/power/calculator/CombatValue.java", "diffHunk": "@@ -15,8 +15,14 @@\n \n   boolean isDefending();\n \n+  Collection<TerritoryEffect> getTerritoryEffects();\n+\n   GameData getGameData();\n \n+  Collection<Unit> getFriendUnits();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "792f21a8b5dd3d485b9ee46ebd80bc8ace7073fd"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMDYyODAwOnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/StrategicBombingRaidBattle.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQwMToxODowNFrOHrrXAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQwMToxODowNFrOHrrXAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU2MTIxOA==", "bodyText": "this kind of line rally 'screams' for a builder.", "url": "https://github.com/triplea-game/triplea/pull/8022#discussion_r515561218", "createdAt": "2020-11-01T01:18:04Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/StrategicBombingRaidBattle.java", "diffHunk": "@@ -587,33 +588,40 @@ private CasualtyDetails calculateCasualties(\n       return CasualtySelector.selectCasualties(\n           attacker,\n           validAttackingUnitsForThisRoll,\n-          attackingUnits,\n-          defendingUnits,\n+          CombatValue.buildMainCombatValue(\n+              defendingUnits,\n+              attackingUnits,\n+              false,\n+              bridge.getData(),\n+              battleSite,\n+              territoryEffects),\n           battleSite,\n-          territoryEffects,\n           bridge,\n-          text, /* dice */\n-          null,\n-          /* defending */ false,\n-          battleId, /* head-less */\n-          false,\n+          text,\n+          null, /* dice */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "829c0ad3e151ae478dfac8af4b280cc318ef3d50"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2780, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}