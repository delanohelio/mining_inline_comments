{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyNzE5NDQ2", "number": 7584, "title": "Update: PerfTimer use throwing functions and unify timing method names to 'time'", "bodyText": "Having throwing functions makes using PerfTimer easier, the inner code executed\nby the function can throw without needing to be explicitly wrapped with a\nnew try/catch.\n\nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note", "createdAt": "2020-09-09T09:50:54Z", "url": "https://github.com/triplea-game/triplea/pull/7584", "merged": true, "mergeCommit": {"oid": "76f6dd4a3fb0dec62be789ab993347b94553e81e"}, "closed": true, "closedAt": "2020-09-10T00:49:09Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHJFZqgH2gAyNDgyNzE5NDQ2OmQxZTgxZWIzNGIwNjJkOGJkNjM4ZTQ0NTUzYjI2NTZkZDM5M2QyZjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdIMEyPgFqTQ4NzIzODA4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d1e81eb34b062d8bd638e44553b2656dd393d2f5", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/d1e81eb34b062d8bd638e44553b2656dd393d2f5", "committedDate": "2020-09-09T09:49:45Z", "message": "Update: PerfTimer use throwing functions and unify timing method names to 'time'\n\nHaving throwing functions makes using PerfTimer easier, the inner code executed\nby the function can throw without needing to be explicitly wrapped with a\nnew try/catch."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff50b9a90f9486d25e66a35a7d4d1d5226669857", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/ff50b9a90f9486d25e66a35a7d4d1d5226669857", "committedDate": "2020-09-09T10:07:57Z", "message": "Re-order methods (fixes checkstyle), group method overloads together"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjM4MDgw", "url": "https://github.com/triplea-game/triplea/pull/7584#pullrequestreview-487238080", "createdAt": "2020-09-12T15:52:37Z", "commit": {"oid": "ff50b9a90f9486d25e66a35a7d4d1d5226669857"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQxNTo1MjozN1rOHQ156Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQxNTo1MjozN1rOHQ156Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQyMjQ0MQ==", "bodyText": "In order to re-use code I would've done something like this:\ntime(() -> {\n  functionToTime.run();\n  return null;\n})", "url": "https://github.com/triplea-game/triplea/pull/7584#discussion_r487422441", "createdAt": "2020-09-12T15:52:37Z", "author": {"login": "RoiEXLab"}, "path": "java-extras/src/main/java/org/triplea/performance/PerfTimer.java", "diffHunk": "@@ -61,10 +57,37 @@ public static PerfTimer startTimer(final String title) {\n    * @return the perf timer object\n    */\n   @SuppressWarnings(\"unused\")\n-  public static PerfTimer startTimer(final String title, final int reportingFrequency) {\n+  public static PerfTimer time(final String title, final int reportingFrequency) {\n     return new PerfTimer(title, reportingFrequency);\n   }\n \n+  @SuppressWarnings(\"unused\")\n+  public static PerfTimer time(final String title) {\n+    return time(title, 1);\n+  }\n+\n+  public static <T> T time(final String title, final ThrowingSupplier<T, ?> functionToTime) {\n+    final T value;\n+    try (PerfTimer timer = time(title)) {\n+      value = functionToTime.get();\n+    } catch (final Throwable throwable) {\n+      throw new IllegalStateException(\n+          \"Unexpected throwable in timed method: \" + throwable.getMessage(), throwable);\n+    }\n+    return value;\n+  }\n+\n+  public static void time(final String title, final ThrowingRunnable<?> functionToTime) {\n+    try (PerfTimer timer = time(title)) {\n+      try {\n+        functionToTime.run();\n+      } catch (final Throwable throwable) {\n+        throw new IllegalStateException(\n+            \"Unexpected throwable in timed method: \" + throwable.getMessage(), throwable);\n+      }\n+    }\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff50b9a90f9486d25e66a35a7d4d1d5226669857"}, "originalPosition": 57}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3995, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}