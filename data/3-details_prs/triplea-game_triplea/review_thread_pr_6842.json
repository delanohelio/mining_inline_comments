{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTA4MTA0", "number": 6842, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDozNTo0OFrOEI__Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNToxNjoyNVrOEJK2zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3ODcyNDM5OnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDozNTo0OFrOGpTZcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNDoxNTo1NlrOGpikxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MjYwOA==", "bodyText": "nit, what's the motivation to re-assign disabled to a new variable?", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445962608", "createdAt": "2020-06-26T04:35:48Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MzUyOQ==", "bodyText": "Attempt to ensure that the same values passed in the getImage call would be used in the log message.", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445963529", "createdAt": "2020-06-26T04:40:03Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MjYwOA=="}, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk4NDk4OQ==", "bodyText": "Is it not thread safe?\nIf we're trying to protect against concurrency, what's to keep the value from changing before this line? (in which case, unless I'm mistaken, the log message is also incorrect)", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445984989", "createdAt": "2020-06-26T06:06:24Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MjYwOA=="}, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjIxMTI2OQ==", "bodyText": "It should be thread safe.\nThis was to protect a developer from changing the condition for the call and not changing the condition for the log call.  But I've removed the disabledImage variable and now just use disabled.", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r446211269", "createdAt": "2020-06-26T14:15:56Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2MjYwOA=="}, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3ODcyNTkzOnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDozNjo1OFrOGpTaZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDo0MjoyN1rOGpTfUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2Mjg1Mg==", "bodyText": "We can have, or even require sometimes a disabled & damaged image? I kinda thought they were mutually exclusive. If not, it implies a pretty large number of image permutations that is probably not typically included (which would be kinda bad news).", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445962852", "createdAt": "2020-06-26T04:36:58Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;\n     final Optional<Image> img =\n-        uiContext\n-            .getUnitImageFactory()\n-            .getImage(type, owner, damaged > 0 || bombingUnitDamage > 0, disabled);\n+        uiContext.getUnitImageFactory().getImage(type, owner, damagedImage, disabledImage);\n \n     if (img.isEmpty() && !uiContext.isShutDown()) {\n+      final List<String> imageQualifiers = new ArrayList<>();\n+      if (damagedImage) {\n+        imageQualifiers.add(\"damaged \");\n+      }\n+      if (disabledImage) {\n+        imageQualifiers.add(\"disabled \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2NDExMg==", "bodyText": "Ah, looks like I missed the \"else\" in the UnitImageFactory.  I somehow misread it as two if statements instead of a if else if.", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r445964112", "createdAt": "2020-06-26T04:42:27Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +111,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n+    final boolean disabledImage = disabled;\n     final Optional<Image> img =\n-        uiContext\n-            .getUnitImageFactory()\n-            .getImage(type, owner, damaged > 0 || bombingUnitDamage > 0, disabled);\n+        uiContext.getUnitImageFactory().getImage(type, owner, damagedImage, disabledImage);\n \n     if (img.isEmpty() && !uiContext.isShutDown()) {\n+      final List<String> imageQualifiers = new ArrayList<>();\n+      if (damagedImage) {\n+        imageQualifiers.add(\"damaged \");\n+      }\n+      if (disabledImage) {\n+        imageQualifiers.add(\"disabled \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2Mjg1Mg=="}, "originalCommit": {"oid": "ae927f36595d3ba218af66b638815b8e5a657c71"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4MDUwNTA4OnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNToxNjoyNVrOGpkwRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNToxNjoyNVrOGpkwRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI0Njk4Mw==", "bodyText": "I think this error message shouldn't be all caps tbh", "url": "https://github.com/triplea-game/triplea/pull/6842#discussion_r446246983", "createdAt": "2020-06-26T15:16:25Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/games/strategy/triplea/ui/screen/UnitsDrawer.java", "diffHunk": "@@ -110,14 +110,22 @@ public void draw(\n       throw new IllegalStateException(\"Type not found:\" + unitType);\n     }\n     final GamePlayer owner = data.getPlayerList().getPlayerId(playerName);\n+    final boolean damagedImage = damaged > 0 || bombingUnitDamage > 0;\n     final Optional<Image> img =\n-        uiContext\n-            .getUnitImageFactory()\n-            .getImage(type, owner, damaged > 0 || bombingUnitDamage > 0, disabled);\n+        uiContext.getUnitImageFactory().getImage(type, owner, damagedImage, disabled);\n \n     if (img.isEmpty() && !uiContext.isShutDown()) {\n+      final String imageQualifier;\n+      if (disabled) {\n+        imageQualifier = \"disabled \";\n+      } else if (damagedImage) {\n+        imageQualifier = \"damaged \";\n+      } else {\n+        imageQualifier = \"\";\n+      }\n       log.severe(\n           \"MISSING UNIT IMAGE (won't be displayed): \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5dd55ed30b315f09c82a47bda6afee21764eabf"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2056, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}