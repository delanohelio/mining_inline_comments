{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NzU3MDcy", "number": 5936, "title": "Forum poster structure", "bodyText": "Collapses children of NodeBbForumPoster into parent class. This is done by parameterizing the 'abstract' method implementations and injecting them into the constructor of the parent class. This is done via a 'builder parameter object' refactor. Following this we can further combine interface methods from IForumPoster into NodeBbForumPoster to reduce unnecessary indirection and remove implementation from the interface.\n\nThe changes are structured to be relatively reviewable commit-by-commit, can maybe be reviewed all at once as well.\n \nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[x] Code Cleanup or refactor\n[] Configuration Change\n[] Problem fix:  \n[] Other:   \nTesting\n\n[] Manual testing done", "createdAt": "2020-02-15T20:58:14Z", "url": "https://github.com/triplea-game/triplea/pull/5936", "merged": true, "mergeCommit": {"oid": "a229f4883449df80f83b60ec866559306249d8af"}, "closed": true, "closedAt": "2020-02-15T22:24:38Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEqhPbAH2gAyMzc1NzU3MDcyOjEzYzQ0OTdmOWRmMjhlYzAzNTJhZTlkZTc0MGY5ZjM1ZTc3MGQ4OWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcErT5nAFqTM1OTM2ODE1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "13c4497f9df28ec0352ae9de740f9f35e770d89f", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/13c4497f9df28ec0352ae9de740f9f35e770d89f", "committedDate": "2020-02-15T20:54:06Z", "message": "Collapse forum poster heirarchy to be configuration injection instead of inheritance."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86d51a5ad72e23e2df8b9421823b18134a5e4ba3", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/86d51a5ad72e23e2df8b9421823b18134a5e4ba3", "committedDate": "2020-02-15T20:54:09Z", "message": "Finish combining IForum interface into NodeBbForumPoster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2b2055d847d35acab20b98b793ad467fcf40259", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/a2b2055d847d35acab20b98b793ad467fcf40259", "committedDate": "2020-02-15T20:54:09Z", "message": "Add TODO to merge IForumPoster constants to another class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "committedDate": "2020-02-15T20:55:56Z", "message": "Update javadoc method to be current"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzY2MjMy", "url": "https://github.com/triplea-game/triplea/pull/5936#pullrequestreview-359366232", "createdAt": "2020-02-15T21:01:56Z", "commit": {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQyMTowMTo1NlrOFqQj7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQyMTowMTo1N1rOFqQj8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1NQ==", "bodyText": "Identical blocks of code found in 2 locations. Consider refactoring.", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855855", "createdAt": "2020-02-15T21:01:56Z", "author": {"login": "codeclimate"}, "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/NodeBbForumPoster.java", "diffHunk": "@@ -29,24 +32,92 @@\n import org.snakeyaml.engine.v2.api.Load;\n import org.snakeyaml.engine.v2.api.LoadSettings;\n import org.triplea.awt.OpenFileUtility;\n+import org.triplea.util.Arrays;\n \n /**\n  * Posts turn summaries to a NodeBB based forum of your choice.\n  *\n  * <p>URL format is {@code https://your.forumurl.com/api/v2/topics/<topicID>}.\n  */\n @Log\n-@AllArgsConstructor(access = AccessLevel.PACKAGE)\n-abstract class NodeBbForumPoster implements IForumPoster {\n+public class NodeBbForumPoster {\n+\n+  public static final String AXIS_AND_ALLIES_ORG_DISPLAY_NAME = \"www.axisandallies.org/forums/\";\n+  public static final String TRIPLEA_FORUM_DISPLAY_NAME = \"forums.triplea-game.org\";\n \n   private final Load load = new Load(LoadSettings.builder().build());\n   private final int topicId;\n   private final String username;\n   private final String password;\n+  private final String forumUrl;\n+\n+  @Builder\n+  public static class ForumPostingParameters {\n+    @Nonnull private final Integer topicId;\n+    @Nonnull private final char[] username;\n+    @Nonnull private final char[] password;\n+    @Nonnull private final String forumUrl;\n+  }\n+\n+  private NodeBbForumPoster(final ForumPostingParameters forumPostingParameters) {\n+    this.topicId = forumPostingParameters.topicId;\n+    this.forumUrl = forumPostingParameters.forumUrl;\n+    this.username =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.username, String::new);\n+    this.password =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.password, String::new);\n+  }\n+\n+  /**\n+   * Creates a {@link NodeBbForumPoster} instance based on the given arguments and the configured\n+   * settings.\n+   */\n+  public static NodeBbForumPoster newInstanceByName(final String name, final int topicId) {\n+    switch (name) {\n+      case NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1Ng==", "bodyText": "Identical blocks of code found in 2 locations. Consider refactoring.", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855856", "createdAt": "2020-02-15T21:01:57Z", "author": {"login": "codeclimate"}, "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/NodeBbForumPoster.java", "diffHunk": "@@ -29,24 +32,92 @@\n import org.snakeyaml.engine.v2.api.Load;\n import org.snakeyaml.engine.v2.api.LoadSettings;\n import org.triplea.awt.OpenFileUtility;\n+import org.triplea.util.Arrays;\n \n /**\n  * Posts turn summaries to a NodeBB based forum of your choice.\n  *\n  * <p>URL format is {@code https://your.forumurl.com/api/v2/topics/<topicID>}.\n  */\n @Log\n-@AllArgsConstructor(access = AccessLevel.PACKAGE)\n-abstract class NodeBbForumPoster implements IForumPoster {\n+public class NodeBbForumPoster {\n+\n+  public static final String AXIS_AND_ALLIES_ORG_DISPLAY_NAME = \"www.axisandallies.org/forums/\";\n+  public static final String TRIPLEA_FORUM_DISPLAY_NAME = \"forums.triplea-game.org\";\n \n   private final Load load = new Load(LoadSettings.builder().build());\n   private final int topicId;\n   private final String username;\n   private final String password;\n+  private final String forumUrl;\n+\n+  @Builder\n+  public static class ForumPostingParameters {\n+    @Nonnull private final Integer topicId;\n+    @Nonnull private final char[] username;\n+    @Nonnull private final char[] password;\n+    @Nonnull private final String forumUrl;\n+  }\n+\n+  private NodeBbForumPoster(final ForumPostingParameters forumPostingParameters) {\n+    this.topicId = forumPostingParameters.topicId;\n+    this.forumUrl = forumPostingParameters.forumUrl;\n+    this.username =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.username, String::new);\n+    this.password =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.password, String::new);\n+  }\n+\n+  /**\n+   * Creates a {@link NodeBbForumPoster} instance based on the given arguments and the configured\n+   * settings.\n+   */\n+  public static NodeBbForumPoster newInstanceByName(final String name, final int topicId) {\n+    switch (name) {\n+      case NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME:\n+        return new NodeBbForumPoster(\n+            ForumPostingParameters.builder()\n+                .topicId(topicId)\n+                .username(ClientSetting.tripleaForumUsername.getValueOrThrow())\n+                .password(ClientSetting.tripleaForumPassword.getValueOrThrow())\n+                .forumUrl(UrlConstants.TRIPLEA_FORUM)\n+                .build());\n+      case NodeBbForumPoster.AXIS_AND_ALLIES_ORG_DISPLAY_NAME:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1Nw==", "bodyText": "TODO found", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855857", "createdAt": "2020-02-15T21:01:57Z", "author": {"login": "codeclimate"}, "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/IForumPoster.java", "diffHunk": "@@ -1,79 +1,13 @@\n package games.strategy.engine.posted.game.pbf;\n \n-import com.google.common.collect.ImmutableSet;\n-import games.strategy.triplea.settings.ClientSetting;\n-import java.nio.file.Path;\n-import java.util.concurrent.CompletableFuture;\n-import org.triplea.util.Arrays;\n-\n /**\n  * An interface for classes that can post a turn summary, the summary may also include a save game\n  * if the implementing class supports this.\n  */\n+// TODO: merge these constants into another class, perhaps GameProperties or NodeBbForumPoster", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "274aa72b1a4c47d1b45b240a3cbed62a45821c7e", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/274aa72b1a4c47d1b45b240a3cbed62a45821c7e", "committedDate": "2020-02-15T21:11:14Z", "message": "Update PbemMessagePoster to reflect restructure"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzY4MTUw", "url": "https://github.com/triplea-game/triplea/pull/5936#pullrequestreview-359368150", "createdAt": "2020-02-15T21:49:26Z", "commit": {"oid": "274aa72b1a4c47d1b45b240a3cbed62a45821c7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3681, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}