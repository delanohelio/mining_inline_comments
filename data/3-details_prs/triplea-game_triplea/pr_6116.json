{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MDMxOTky", "number": 6116, "title": "Fix BC Not At War Bug", "bodyText": "Addresses bug reported here: https://forums.triplea-game.org/topic/1836/release-2-0-prep-and-testing/3\nThe battle calc had a bug related to simulating battles where 2 nations aren't actually at war yet that is causing the odd AI behavior. You can actually see this yourself if you simulate a battle in global before 2 nations are at war with say 1 UK ship attacking a large Japanese fleet in the BC and you'll see that it shows a draw with all units destroyed. This is now fixed as it properly consider non-enemy (not at war) remaining defenders.\nTested\n\nLoading the given save game and the AI making more reasonable moves\nVarious scenarios with the BC to ensure proper TUV results", "createdAt": "2020-03-31T02:56:58Z", "url": "https://github.com/triplea-game/triplea/pull/6116", "merged": true, "mergeCommit": {"oid": "b3062375e756df44a1dc693778d8d7bc0dcad301"}, "closed": true, "closedAt": "2020-04-01T01:35:41Z", "author": {"login": "ron-murhammer"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS6DCkAH2gAyMzk2MDMxOTkyOjNmNDYyMTQyMGRjOTBiZTlmN2E2ZThkOGIxNzY0NzMzODIwZDE3NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTNQn7AH2gAyMzk2MDMxOTkyOjBiNzExMzA4YWM1MjAxNDM1YzBkYWI3M2U4NGFjYzRlODg2N2UyMWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3f4621420dc90be9f7a6e8d8b1764733820d1754", "author": {"user": {"login": "ron-murhammer", "name": "Ron"}}, "url": "https://github.com/triplea-game/triplea/commit/3f4621420dc90be9f7a6e8d8b1764733820d1754", "committedDate": "2020-03-31T02:54:32Z", "message": "Fix BC Not At War Bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDE1NTI3", "url": "https://github.com/triplea-game/triplea/pull/6116#pullrequestreview-384415527", "createdAt": "2020-03-31T05:40:44Z", "commit": {"oid": "3f4621420dc90be9f7a6e8d8b1764733820d1754"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNTo0MDo0NFrOF-GERA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNTo0MDo0NFrOF-GERA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1NTQyOA==", "bodyText": "This is a bit of a surprising update. This line seems like a really important item. I'm now not sure how this was even close to correct before.", "url": "https://github.com/triplea-game/triplea/pull/6116#discussion_r400655428", "createdAt": "2020-03-31T05:40:44Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java", "diffHunk": "@@ -278,14 +278,17 @@ void addDependentUnits(final Map<Unit, Collection<Unit>> dependencies) {\n \n   @Override\n   public List<Unit> getRemainingDefendingUnits() {\n-    final List<Unit> remaining = new ArrayList<>(defendingUnitsRetreated);\n+    final Set<Unit> remaining = new HashSet<>(defendingUnitsRetreated);\n+    remaining.addAll(defendingUnits);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f4621420dc90be9f7a6e8d8b1764733820d1754"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b711308ac5201435c0dab73e84acc4e8867e21e", "author": {"user": {"login": "ron-murhammer", "name": "Ron"}}, "url": "https://github.com/triplea-game/triplea/commit/0b711308ac5201435c0dab73e84acc4e8867e21e", "committedDate": "2020-04-01T01:17:34Z", "message": "Add method javadoc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3623, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}