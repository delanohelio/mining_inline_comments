{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3ODQ4NTk2", "number": 7125, "title": "Add log aggregation to servers", "bodyText": "Sets up log aggregation from the application servers to a support server.\nAn hours worth of logs are dumped from each application using journalctl\nand then SCP'd to the support server.\nSummary of log aggregation flow:\n\ncronjob executes on app server each hour, for each application\n\nthis creates a log file using journalctl containing the last hours worth of logs\nthe app server uses \"logs user\" to SCP the log file to aggregration server\napp server cleans up the log file\n\n\nthe log server each hour will zip up log files older than 2 hours\nthe log server each hour will delete log files older than 3 months\nthe log server each hour will delete empty log folders\n\nOf some note, in this update we add 'admin' user to the 'adm' group on\napplication servers to allow 'admin' user sudo-less journalctl. Without\nthat you need to run 'sudo' to be able to view logs for arbitrary systemctl\nservices.\nAs part of this we update inventory and add a 'support01' server that has\nthe aggregration server role\nIn sum, two new roles are added:\n\nNew role: log_aggregation_server\n\nsets up a server to receive log files\nadds a 'logs' user with a public key that other hosts will use when performing\nSCP to copy log files to the host.\nlog files will land in '/home/admin/logs/2020/...'\n\n\nNew role: log_aggregation_sender:\n\nadds the logs user private ssh key to admin user to enable SCP and SSH to the\nlog aggregation server\nadds an hourly cronjob to send last hours logs to the aggregation server\nadds a 'send_logs' scripts that is invoked by cron that actually sends the log files\n\n\n\nThe log files that are sent are controlled by a 'group_var' variable: 'journalctl_applications'. Each\nentry in the application list will be one item where we will query journalctl (ie: journalctl -u 'app01'),\nthereby grabbing the last hours worth of logs and dumping that to a file.\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[x] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[] Problem fix\n[] Other:   \nTesting\n\ndid some testing with vagrant and prerelease\n\nThis was a key command used to test:\n./run_ansible_prerelease 2.1.0 --limit=botHosts -t support\n\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note", "createdAt": "2020-07-12T04:16:58Z", "url": "https://github.com/triplea-game/triplea/pull/7125", "merged": true, "mergeCommit": {"oid": "a689ea6b9c422baf0b485004a45bd7fae447bcd0"}, "closed": true, "closedAt": "2020-07-12T22:37:12Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0FA0lAFqTQ0Njg0NDc3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0TEQDgFqTQ0NjkwODQyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODQ0Nzc1", "url": "https://github.com/triplea-game/triplea/pull/7125#pullrequestreview-446844775", "createdAt": "2020-07-12T04:20:33Z", "commit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQwNDoyMDozM1rOGwRGvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQwNDoyMDozNFrOGwRGxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA4Ng==", "bodyText": "Argument mixes string and array. Use * or separate argument.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265086", "createdAt": "2020-07-12T04:20:33Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA4OQ==", "bodyText": "Double quote to prevent globbing and word splitting.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265089", "createdAt": "2020-07-12T04:20:34Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour ago' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch /tmp/$log_file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA5MA==", "bodyText": "sudo doesn't affect redirects. Use ..| sudo tee file", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265090", "createdAt": "2020-07-12T04:20:34Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour ago' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch /tmp/$log_file\n+\n+# Grab the last hours worth of logs from journalctl and dump to file\n+sudo journalctl \\\n+  --since \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:00:00 UTC\")\" \\\n+  --until \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:59:59 UTC\")\" \\\n+  -u \"$app_name\" > /tmp/$log_file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA5Mg==", "bodyText": "Double quote to prevent globbing and word splitting.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265092", "createdAt": "2020-07-12T04:20:34Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour ago' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch /tmp/$log_file\n+\n+# Grab the last hours worth of logs from journalctl and dump to file\n+sudo journalctl \\\n+  --since \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:00:00 UTC\")\" \\\n+  --until \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:59:59 UTC\")\" \\\n+  -u \"$app_name\" > /tmp/$log_file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA5NA==", "bodyText": "Note that, unescaped, this expands on the client side.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265094", "createdAt": "2020-07-12T04:20:34Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour ago' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch /tmp/$log_file\n+\n+# Grab the last hours worth of logs from journalctl and dump to file\n+sudo journalctl \\\n+  --since \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:00:00 UTC\")\" \\\n+  --until \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:59:59 UTC\")\" \\\n+  -u \"$app_name\" > /tmp/$log_file\n+\n+\n+# Create the folder on the remote server where we will send the log file\n+log_folder_path=\"/home/admin/logs/$(date +%Y)/$(date +%m)/$(date +%d)\"\n+ssh -i \"$key_file\" \"$log_server\" \"mkdir -p $log_folder_path\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI2NTA5NQ==", "bodyText": "Double quote to prevent globbing and word splitting.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453265095", "createdAt": "2020-07-12T04:20:34Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 .ssh/logs_key_ed25519 logs@support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+key_file=\"$2\"\n+log_server=\"$3\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$@'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour ago' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch /tmp/$log_file\n+\n+# Grab the last hours worth of logs from journalctl and dump to file\n+sudo journalctl \\\n+  --since \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:00:00 UTC\")\" \\\n+  --until \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:59:59 UTC\")\" \\\n+  -u \"$app_name\" > /tmp/$log_file\n+\n+\n+# Create the folder on the remote server where we will send the log file\n+log_folder_path=\"/home/admin/logs/$(date +%Y)/$(date +%m)/$(date +%d)\"\n+ssh -i \"$key_file\" \"$log_server\" \"mkdir -p $log_folder_path\"\n+\n+# Copy the log file to the remote server\n+scp -i \"$key_file\" \"/tmp/$log_file\" \"$log_server:$log_folder_path/$log_file\"\n+\n+# Clean up locally\n+rm /tmp/$log_file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad517e7edbea4d5acb523d63cf4c891ee3f304a"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODYxNDE1", "url": "https://github.com/triplea-game/triplea/pull/7125#pullrequestreview-446861415", "createdAt": "2020-07-12T09:23:10Z", "commit": {"oid": "e59eae9a62e4486115d1bae9a4b688774c0262fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQwOToyMzoxMFrOGwSu4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQwOToyMzoxMFrOGwSu4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzI5MTc0NQ==", "bodyText": "adm?", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453291745", "createdAt": "2020-07-12T09:23:10Z", "author": {"login": "RoiEXLab"}, "path": "infrastructure/ansible/roles/system/admin_user/tasks/main.yml", "diffHunk": "@@ -11,7 +11,7 @@\n     shell: /bin/bash\n     create_home: yes\n     append: yes\n-    groups: admin\n+    groups: admin,adm", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e59eae9a62e4486115d1bae9a4b688774c0262fc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "733ed92ee1c1c1896e500d49c2ab6ab038c143db", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/733ed92ee1c1c1896e500d49c2ab6ab038c143db", "committedDate": "2020-07-12T18:58:38Z", "message": "Add log aggregation to servers\n\nSets up log aggregation from the application servers to a support server.\nAn hours worth of logs are dumped from each application using journalctl\nand then SCP'd to the support server.\n\nSummary of log aggregation flow:\n  - cronjob executes on app server each hour, for each application\n    - this creates a log file using journalctl containing the last hours worth of logs\n    - the app server uses \"logs user\" to SCP the log file to aggregration server\n    - app server cleans up the log file\n  - the log server each hour will zip up log files older than 2 hours\n  - the log server each hour will delete log files older than 3 months\n  - the log server each hour will delete empty log folders\n\nOf some note, in this update we add 'admin' user to the 'adm' group on\napplication servers to allow 'admin' user sudo-less journalctl. Without\nthat you need to run 'sudo' to be able to view logs for arbitrary systemctl\nservices.\n\nAs part of this we update inventory and add a 'support01' server that has\nthe aggregration server role\n\nIn sum, two new roles are added:\n- New role: log_aggregation_server\n  - sets up a server to receive log files\n  - adds a 'logs' user with a public key that other hosts will use when performing\n    SCP to copy log files to the host.\n  - log files will land in '/home/admin/logs/2020/...'\n- New role: log_aggregation_sender:\n  - adds the logs user private ssh key to admin user to enable SCP and SSH to the\n    log aggregation server\n  - adds an hourly cronjob to send last hours logs to the aggregation server\n  - adds a 'send_logs' scripts that is invoked by cron that actually sends the log files\n\nThe log files that are sent are controlled by a 'group_var' variable: 'journalctl_applications'. Each\nentry in the application list will be one item where we will query journalctl (ie: journalctl -u 'app01'),\nthereby grabbing the last hours worth of logs and dumping that to a file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe50fe06ead5ebf659114a8a7dd74106bd04f5c6", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/fe50fe06ead5ebf659114a8a7dd74106bd04f5c6", "committedDate": "2020-07-12T18:58:38Z", "message": "Fix various shellchecks in 'send_logs' script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4899b33dbf3f1d0b8c5d82297ca09c849a0fac73", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/4899b33dbf3f1d0b8c5d82297ca09c849a0fac73", "committedDate": "2020-07-12T19:07:41Z", "message": "Fix date offset, uses a different syntax compared to journalctl"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e59eae9a62e4486115d1bae9a4b688774c0262fc", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/e59eae9a62e4486115d1bae9a4b688774c0262fc", "committedDate": "2020-07-12T05:15:28Z", "message": "Fix various shellchecks in 'send_logs' script"}, "afterCommit": {"oid": "4899b33dbf3f1d0b8c5d82297ca09c849a0fac73", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/4899b33dbf3f1d0b8c5d82297ca09c849a0fac73", "committedDate": "2020-07-12T19:07:41Z", "message": "Fix date offset, uses a different syntax compared to journalctl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de970700c63af8ee14bd75b252b8b7d274e34759", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/de970700c63af8ee14bd75b252b8b7d274e34759", "committedDate": "2020-07-12T20:37:40Z", "message": "Fix ssh_config file, should be deployed as .ssh/config\n\n- With the config file fixed, place the SSH key to use in that\n  file and simplify the 'send_logs' script to no longer require\n  the SSH key location parameter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2OTA4NDI1", "url": "https://github.com/triplea-game/triplea/pull/7125#pullrequestreview-446908425", "createdAt": "2020-07-12T20:42:58Z", "commit": {"oid": "de970700c63af8ee14bd75b252b8b7d274e34759"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQyMDo0Mjo1OVrOGwW-wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQyMDo0Mjo1OVrOGwW-wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM2MTM0NA==", "bodyText": "Note that, unescaped, this expands on the client side.", "url": "https://github.com/triplea-game/triplea/pull/7125#discussion_r453361344", "createdAt": "2020-07-12T20:42:59Z", "author": {"login": "codeclimate"}, "path": "infrastructure/ansible/roles/support/log_aggregation_sender/files/send_logs", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+###\n+### Sends the last hours worth of logs to a log aggregation server.\n+### Key file and user are controlled by .ssh/config\n+### \n+### Usage:\n+###    send_logs [journalctl_name] [log_server]\n+### Example:\n+###    send_logs bot@01 support01.triplea-game.org\n+###      \n+\n+app_name=\"$1\"\n+log_server=\"$2\"\n+\n+function usage() {\n+  sed -rn 's/^### ?//;T;p' \"$0\"\n+}\n+\n+if [ -z \"$log_server\" ]; then\n+  echo \"Error: Missing arguments, received: '$*'\"\n+  usage\n+  exit 1\n+fi\n+\n+\n+# This is the file where we will dump the last hours worth of logs\n+log_file=\"$(date -d '-1 hour' -u \"+%Y-%m-%d--%H\").$(hostname).$app_name.log\"\n+\n+# Touch the log file so that we have something to send always\n+touch \"/tmp/$log_file\"\n+\n+# Grab the last hours worth of logs from journalctl and dump to file\n+journalctl \\\n+  --since \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:00:00 UTC\")\" \\\n+  --until \"$(date -d '1 hour ago' -u \"+%Y-%m-%d %H:59:59 UTC\")\" \\\n+  -u \"$app_name\" > \"/tmp/$log_file\"\n+\n+\n+# Create the folder on the remote server where we will send the log file\n+log_folder_path=\"/home/admin/logs/$(date +%Y)/$(date +%m)/$(date +%d)\"\n+ssh \"$log_server\" \"mkdir -p $log_folder_path\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de970700c63af8ee14bd75b252b8b7d274e34759"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3221, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}