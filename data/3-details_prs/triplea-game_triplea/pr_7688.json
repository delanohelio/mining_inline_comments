{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4Njg4MzE5", "number": 7688, "title": "Convert general casualty removal", "bodyText": "Testing\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note", "createdAt": "2020-09-17T13:56:45Z", "url": "https://github.com/triplea-game/triplea/pull/7688", "merged": true, "mergeCommit": {"oid": "e49aa6b0a17ef9443746c136a82e483fecce849a"}, "closed": true, "closedAt": "2020-09-18T02:22:58Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJxaE1gH2gAyNDg4Njg4MzE5OjlmNmY1NTAwYThiOGQzNjM4MzQ2OWNlZTBlNzczZTM3NDk1NWQ0N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ8FcMAFqTQ5MTEwNjgzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f6f5500a8b8d36383469cee0e773e374955d47f", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/9f6f5500a8b8d36383469cee0e773e374955d47f", "committedDate": "2020-09-17T13:56:23Z", "message": "Convert general casualty removal"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMDYwNDI4", "url": "https://github.com/triplea-game/triplea/pull/7688#pullrequestreview-491060428", "createdAt": "2020-09-17T23:46:19Z", "commit": {"oid": "9f6f5500a8b8d36383469cee0e773e374955d47f"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMzo0NjoxOVrOHT5LTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMzo0ODo1NVrOHT5N8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYyMTc3Mw==", "bodyText": "We're going to be inline this on next major vs outright removal, right?\nIf so, this might help us in the future to comment that so we don't think we can just delete it:\nRemoveOnNextMajorRelease(\"inline IExecutable body and remove IExecutable\")", "url": "https://github.com/triplea-game/triplea/pull/7688#discussion_r490621773", "createdAt": "2020-09-17T23:46:19Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java", "diffHunk": "@@ -1587,16 +1588,19 @@ private void addCheckEndBattleAndRetreatingSteps(final List<IExecutable> steps)\n     final BattleStep defensiveSubsRetreat = new DefensiveSubsRetreat(this, this);\n     final BattleStep removeGeneralSuicide = new RemoveGeneralSuicide(this, this);\n     final BattleStep offensiveGeneralRetreat = new OffensiveGeneralRetreat(this, this);\n+    final BattleStep clearGeneralCasualties = new ClearGeneralCasualties(this, this);\n \n-    steps.add(\n-        new IExecutable() {\n-          private static final long serialVersionUID = 8611067962952500496L;\n+    steps.add(clearGeneralCasualties);\n+    new IExecutable() {\n+      private static final long serialVersionUID = 8611067962952500496L;\n \n-          @Override\n-          public void execute(final ExecutionStack stack, final IDelegateBridge bridge) {\n-            clearWaitingToDieAndDamagedChangesInto(bridge);\n-          }\n-        });\n+      @Override\n+      @RemoveOnNextMajorRelease", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6f5500a8b8d36383469cee0e773e374955d47f"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYyMjEzNg==", "bodyText": "Any thoughts to rename 'clear' to 'remove'? They are mostly synonymous, IMO 'remove' is just slightly more descriptive.", "url": "https://github.com/triplea-game/triplea/pull/7688#discussion_r490622136", "createdAt": "2020-09-17T23:47:38Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/steps/BattleSteps.java", "diffHunk": "@@ -58,7 +59,10 @@\n         new ClearFirstStrikeCasualties(battleState, battleActions);\n     final BattleStep offensiveStandard = new OffensiveGeneral(battleState, battleActions);\n     final BattleStep defensiveStandard = new DefensiveGeneral(battleState, battleActions);\n-    final BattleStep generalRetreat = new OffensiveGeneralRetreat(battleState, battleActions);\n+    final BattleStep offensiveGeneralRetreat =\n+        new OffensiveGeneralRetreat(battleState, battleActions);\n+    final BattleStep clearGeneralCasualties =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6f5500a8b8d36383469cee0e773e374955d47f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYyMjQ1MA==", "bodyText": "Why protected on these variables? Can we mark them as private?\n\nEffective Java Item 17: Design and document for inheritance or else prohibit it\nhttps://medium.com/@rufuszh90/effective-java-item-17-design-and-document-for-inheritance-or-else-prohibit-it-be6041719fbc", "url": "https://github.com/triplea-game/triplea/pull/7688#discussion_r490622450", "createdAt": "2020-09-17T23:48:55Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/steps/change/ClearGeneralCasualties.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package games.strategy.triplea.delegate.battle.steps.change;\n+\n+import static games.strategy.triplea.delegate.battle.BattleStepStrings.REMOVE_CASUALTIES;\n+\n+import games.strategy.engine.delegate.IDelegateBridge;\n+import games.strategy.triplea.delegate.ExecutionStack;\n+import games.strategy.triplea.delegate.battle.BattleActions;\n+import games.strategy.triplea.delegate.battle.BattleState;\n+import games.strategy.triplea.delegate.battle.steps.BattleStep;\n+import java.util.List;\n+import lombok.AllArgsConstructor;\n+\n+@AllArgsConstructor\n+public class ClearGeneralCasualties implements BattleStep {\n+  private static final long serialVersionUID = 995118832242624142L;\n+\n+  protected final BattleState battleState;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6f5500a8b8d36383469cee0e773e374955d47f"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df059f3acc24e0aca0edb6a60f7c55fbaab7adb1", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/df059f3acc24e0aca0edb6a60f7c55fbaab7adb1", "committedDate": "2020-09-18T01:15:36Z", "message": "Mark variables as private"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMDg4Nzg0", "url": "https://github.com/triplea-game/triplea/pull/7688#pullrequestreview-491088784", "createdAt": "2020-09-18T01:21:39Z", "commit": {"oid": "df059f3acc24e0aca0edb6a60f7c55fbaab7adb1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToyMTozOVrOHT6tkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToyMTozOVrOHT6tkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY0NjkyOQ==", "bodyText": "My first comment on this seems to have been lost in github : /\nI'm wondering/concerned if this class is too thin and a bit indirect. Can we move the logic of MustFightBattle here and have the other references in MustFightBattle and elsewhere call this class? Even if we move that logic here as a static method, at least it would have the one, isolated home and presumably could be independently tested. Of most significant though we'd be unburdening MustfightBattle that is already doing too much.", "url": "https://github.com/triplea-game/triplea/pull/7688#discussion_r490646929", "createdAt": "2020-09-18T01:21:39Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/steps/change/ClearGeneralCasualties.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package games.strategy.triplea.delegate.battle.steps.change;\n+\n+import static games.strategy.triplea.delegate.battle.BattleStepStrings.REMOVE_CASUALTIES;\n+\n+import games.strategy.engine.delegate.IDelegateBridge;\n+import games.strategy.triplea.delegate.ExecutionStack;\n+import games.strategy.triplea.delegate.battle.BattleActions;\n+import games.strategy.triplea.delegate.battle.BattleState;\n+import games.strategy.triplea.delegate.battle.steps.BattleStep;\n+import java.util.List;\n+import lombok.AllArgsConstructor;\n+\n+@AllArgsConstructor\n+public class ClearGeneralCasualties implements BattleStep {\n+  private static final long serialVersionUID = 995118832242624142L;\n+\n+  private final BattleState battleState;\n+\n+  private final BattleActions battleActions;\n+\n+  @Override\n+  public List<String> getNames() {\n+    return List.of(REMOVE_CASUALTIES);\n+  }\n+\n+  @Override\n+  public Order getOrder() {\n+    return Order.GENERAL_REMOVE_CASUALTIES;\n+  }\n+\n+  @Override\n+  public void execute(final ExecutionStack stack, final IDelegateBridge bridge) {\n+    battleActions.clearWaitingToDieAndDamagedChangesInto(bridge);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df059f3acc24e0aca0edb6a60f7c55fbaab7adb1"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTA2ODMy", "url": "https://github.com/triplea-game/triplea/pull/7688#pullrequestreview-491106832", "createdAt": "2020-09-18T02:22:48Z", "commit": {"oid": "df059f3acc24e0aca0edb6a60f7c55fbaab7adb1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3932, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}