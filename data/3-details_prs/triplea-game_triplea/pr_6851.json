{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTc0NDY4", "number": 6851, "title": "Fix NPEs in ProSimulateTurnUtils.", "bodyText": "Marks return value of functions that can return null w/\n@nullable and adds null checks to callers.\nFixes: #6833\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[X] Problem fix #6833\n[] Other:   \nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note\n\nFIX|Potential error when AI is calculating transport movement", "createdAt": "2020-06-25T18:00:04Z", "url": "https://github.com/triplea-game/triplea/pull/6851", "merged": true, "mergeCommit": {"oid": "b806794b618130568d2ac7d4307cc82589e95cd4"}, "closed": true, "closedAt": "2020-06-26T04:48:01Z", "author": {"login": "asvitkine"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuyhVsAH2gAyNDQwMTc0NDY4OjM4YmNhMDIzOGFjNjg3MzdlNDg3YjUzYjJiMGI3YmFkYTliNWY5YmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcu7zZOAFqTQzODAxMDQxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "38bca0238ac68737e487b53b2b0b7bada9b5f9bf", "author": {"user": {"login": "asvitkine", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/38bca0238ac68737e487b53b2b0b7bada9b5f9bf", "committedDate": "2020-06-25T17:58:16Z", "message": "Fix NPEs in ProSimulateTurnUtils.\n\nMarks return value of functions that can return null w/\n@Nullable and adds null checks to callers.\n\nFixes: https://github.com/triplea-game/triplea/issues/6833"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MDEwNDE0", "url": "https://github.com/triplea-game/triplea/pull/6851#pullrequestreview-438010414", "createdAt": "2020-06-26T04:46:47Z", "commit": {"oid": "38bca0238ac68737e487b53b2b0b7bada9b5f9bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDo0Njo0N1rOGpTjHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNDo0Njo0N1rOGpTjHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk2NTA4Ng==", "bodyText": "not necessary, but any thoughts to using Optional to avoid the intermediate variable?\ntransferUnit(u, unitTerritoryMap, usedUnits, toData, player).ifPresent(\nunit -> {\n:\n:\n});\nOptional return values generally work out very nicely and avoid needing to notice there is a nullable annotation and forces you (type safety) to deal with the null.", "url": "https://github.com/triplea-game/triplea/pull/6851#discussion_r445965086", "createdAt": "2020-06-26T04:46:47Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/ai/pro/simulate/ProSimulateTurnUtils.java", "diffHunk": "@@ -181,28 +189,34 @@ public static void simulateBattles(\n       for (final Unit u : moveMap.get(fromTerritory).getUnits()) {\n         if (!amphibUnits.contains(u)) {\n           final Unit toUnit = transferUnit(u, unitTerritoryMap, usedUnits, toData, player);\n-          patd.addUnit(toUnit);\n-          ProLogger.trace(\"---Transferring unit \" + u + \" to \" + toUnit);\n+          if (toUnit != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38bca0238ac68737e487b53b2b0b7bada9b5f9bf"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3286, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}