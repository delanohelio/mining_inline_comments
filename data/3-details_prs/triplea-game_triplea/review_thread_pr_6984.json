{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNTI1OTAw", "number": 6984, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMjowMzoxM1rOEKrPcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMjoyMDo1N1rOEKrfJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NjI5NjgxOnYy", "diffSide": "RIGHT", "path": "game-core/src/main/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMjowMzoxM1rOGr2ydA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjoyNzoyNFrOGsepag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYzOTYwNA==", "bodyText": "Something worth considering:\nAs we all know the report body is truncated at X characters. This means that the trailing \\n```\\n\\n will be cut off if the stacktrace is too long.\nPerhaps we want to truncate the stracktrace so we don't ever hit the other limit", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r448639604", "createdAt": "2020-07-01T22:03:13Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatter.java", "diffHunk": "@@ -158,11 +170,6 @@ private static String throwableToString(final Throwable e) {\n     try (PrintWriter printWriter = new PrintWriter(outputStream, false, StandardCharsets.UTF_8)) {\n       e.printStackTrace(printWriter);\n     }\n-    return \"## Exception \\n\"\n-        + e.getClass().getName()\n-        + Optional.ofNullable(e.getMessage()).map(msg -> \": \" + msg).orElse(\"\")\n-        + \"\\n\\n## Stack Trace\\n```\\n\"\n-        + outputStream.toString(StandardCharsets.UTF_8)\n-        + \"\\n```\\n\\n\";\n+    return \"## Stack Trace\\n```\\n\" + outputStream.toString(StandardCharsets.UTF_8) + \"\\n```\\n\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY2MDA1Mw==", "bodyText": "If you're missing the trailing ```, you'll still get the code format.\nIf we truncate only the stack trace, you'll need to calculate how much the rest of the content is taking and do a subtraction.\nIt then seems just easier to truncate the whole thing knowing that the stack trace is at the end.", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r448660053", "createdAt": "2020-07-01T23:04:55Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatter.java", "diffHunk": "@@ -158,11 +170,6 @@ private static String throwableToString(final Throwable e) {\n     try (PrintWriter printWriter = new PrintWriter(outputStream, false, StandardCharsets.UTF_8)) {\n       e.printStackTrace(printWriter);\n     }\n-    return \"## Exception \\n\"\n-        + e.getClass().getName()\n-        + Optional.ofNullable(e.getMessage()).map(msg -> \": \" + msg).orElse(\"\")\n-        + \"\\n\\n## Stack Trace\\n```\\n\"\n-        + outputStream.toString(StandardCharsets.UTF_8)\n-        + \"\\n```\\n\\n\";\n+    return \"## Stack Trace\\n```\\n\" + outputStream.toString(StandardCharsets.UTF_8) + \"\\n```\\n\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYzOTYwNA=="}, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MjY1MA==", "bodyText": "True, just wanted to through the idea out there", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r449292650", "createdAt": "2020-07-02T22:27:24Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatter.java", "diffHunk": "@@ -158,11 +170,6 @@ private static String throwableToString(final Throwable e) {\n     try (PrintWriter printWriter = new PrintWriter(outputStream, false, StandardCharsets.UTF_8)) {\n       e.printStackTrace(printWriter);\n     }\n-    return \"## Exception \\n\"\n-        + e.getClass().getName()\n-        + Optional.ofNullable(e.getMessage()).map(msg -> \": \" + msg).orElse(\"\")\n-        + \"\\n\\n## Stack Trace\\n```\\n\"\n-        + outputStream.toString(StandardCharsets.UTF_8)\n-        + \"\\n```\\n\\n\";\n+    return \"## Stack Trace\\n```\\n\" + outputStream.toString(StandardCharsets.UTF_8) + \"\\n```\\n\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYzOTYwNA=="}, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NjMzNzAwOnYy", "diffSide": "RIGHT", "path": "http-server/src/main/java/org/triplea/db/dao/error/reporting/ErrorReportingDao.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMjoyMDo1N1rOGr3Khw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjoyNjo1MlrOGseoxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY0NTc2Nw==", "bodyText": "I wonder if a check for equality is the right move here.\nIf we fix an issue, but people are still using an unpatched version, they shouldn't be able to create an issue IMO.\nThoughts?", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r448645767", "createdAt": "2020-07-01T22:20:57Z", "author": {"login": "RoiEXLab"}, "path": "http-server/src/main/java/org/triplea/db/dao/error/reporting/ErrorReportingDao.java", "diffHunk": "@@ -23,4 +26,12 @@\n    */\n   @SqlUpdate(\"delete from error_report_history where date_created < :purgeSinceDate\")\n   void purgeOld(@Bind(\"purgeSinceDate\") Instant purgeSinceDate);\n+\n+  @SqlQuery(\n+      \"select created_issue_link\"\n+          + \"  from error_report_history\"\n+          + \"  where report_title = :reportTitle \"\n+          + \"    and game_version = :gameVersion\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY1OTE4MA==", "bodyText": "That'll be a problem if you go back in time. So we can certainly get 'n' issues up until a problem is fixed. That is a risk. If we fail to fix an issue, it's more risky if we suppress it. False-positives are not great,  false-negatives are worse.\nDoes that make sense?", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r448659180", "createdAt": "2020-07-01T23:01:55Z", "author": {"login": "DanVanAtta"}, "path": "http-server/src/main/java/org/triplea/db/dao/error/reporting/ErrorReportingDao.java", "diffHunk": "@@ -23,4 +26,12 @@\n    */\n   @SqlUpdate(\"delete from error_report_history where date_created < :purgeSinceDate\")\n   void purgeOld(@Bind(\"purgeSinceDate\") Instant purgeSinceDate);\n+\n+  @SqlQuery(\n+      \"select created_issue_link\"\n+          + \"  from error_report_history\"\n+          + \"  where report_title = :reportTitle \"\n+          + \"    and game_version = :gameVersion\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY0NTc2Nw=="}, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY2MTcxNg==", "bodyText": "@RoiEXLab how do you mean by an unpatched version?\nLet's say a problem is reported for 'v2', and someone is using a 'v3' and we only have a fix in 'v4', we can get a duplicate report fro both 'v2' and 'v3', is that the scenario you are considering?\nIMO it's okay:\n\nthe stack traces could change between v2 and v3 along with line numbers. Having that be different is slightly helpful.\nwe still go from 'n' reports being linear to the number of versions instead of number of occurrances.\nwe avoid a situation where we think we fixed the problem in 'v4', but perhaps we did not. If we de-dupe on title only, then a closed issue is theoretically definitive even if the problem is re-introduced or never fixed in the first place.\n\nIn part we're being clever about detecting when problems are fixed by just de-duping by title and version. If we suppressed all future version reports we'd need to know when a problem is fixed. As-is, a person looks at the bug report, sees it's closed and hopefully we'll comment which version has a fix.\nGoing forward pre-release hopefully will get back to being used for preview and testing and not early access like it was. In part the early access was due to map features and because map versioning is deficient when it comes to forward & backward compatibility. Removing the need for early access implies we've some work to improve how maps are handled.", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r448661716", "createdAt": "2020-07-01T23:10:37Z", "author": {"login": "DanVanAtta"}, "path": "http-server/src/main/java/org/triplea/db/dao/error/reporting/ErrorReportingDao.java", "diffHunk": "@@ -23,4 +26,12 @@\n    */\n   @SqlUpdate(\"delete from error_report_history where date_created < :purgeSinceDate\")\n   void purgeOld(@Bind(\"purgeSinceDate\") Instant purgeSinceDate);\n+\n+  @SqlQuery(\n+      \"select created_issue_link\"\n+          + \"  from error_report_history\"\n+          + \"  where report_title = :reportTitle \"\n+          + \"    and game_version = :gameVersion\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY0NTc2Nw=="}, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MjQ4Nw==", "bodyText": "is that the scenario you are considering\n\nYes, that's exactly what I meant", "url": "https://github.com/triplea-game/triplea/pull/6984#discussion_r449292487", "createdAt": "2020-07-02T22:26:52Z", "author": {"login": "RoiEXLab"}, "path": "http-server/src/main/java/org/triplea/db/dao/error/reporting/ErrorReportingDao.java", "diffHunk": "@@ -23,4 +26,12 @@\n    */\n   @SqlUpdate(\"delete from error_report_history where date_created < :purgeSinceDate\")\n   void purgeOld(@Bind(\"purgeSinceDate\") Instant purgeSinceDate);\n+\n+  @SqlQuery(\n+      \"select created_issue_link\"\n+          + \"  from error_report_history\"\n+          + \"  where report_title = :reportTitle \"\n+          + \"    and game_version = :gameVersion\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODY0NTc2Nw=="}, "originalCommit": {"oid": "e9da7eb10e0e26e6fad48bc0539a0be5d09545ff"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2089, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}