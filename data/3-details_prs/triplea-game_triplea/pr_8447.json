{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxNjEyMjQz", "number": 8447, "title": "Pass GameMap instead of GameData for TerritoryAttachment methods", "bodyText": "The four static methods in TerritoryAttachment that are related with\ncapitals don't need the entire GameData. They only need the GameMap.\n\nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nI came across this while looking at the AI code.\nRelease Note", "createdAt": "2020-12-17T05:27:42Z", "url": "https://github.com/triplea-game/triplea/pull/8447", "merged": true, "mergeCommit": {"oid": "7cb762eb657637178c4fd8b7419bf4b715a70c45"}, "closed": true, "closedAt": "2020-12-17T07:37:26Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdm8o2kgH2gAyNTQxNjEyMjQzOmY2YTVmNDk4YTc3YjQyZjM4MTYxZDIwMzBlZTBlYzc5YmExZTc4MGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdm-hu5gFqTU1NDM0MDk2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f6a5f498a77b42f38161d2030ee0ec79ba1e780c", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/f6a5f498a77b42f38161d2030ee0ec79ba1e780c", "committedDate": "2020-12-17T05:25:17Z", "message": "Pass GameMap instead of GameData for TerritoryAttachment methods\n\nThe four static methods in TerritoryAttachment that are related with\ncapitals don't need the entire GameData. They only need the GameMap."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MjkwMDQ1", "url": "https://github.com/triplea-game/triplea/pull/8447#pullrequestreview-554290045", "createdAt": "2020-12-17T05:29:28Z", "commit": {"oid": "f6a5f498a77b42f38161d2030ee0ec79ba1e780c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwNToyOToyOFrOIHlVng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwNToyOToyOFrOIHlVng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDgyMjY4Ng==", "bodyText": "These checks are redundant since setCapital doesn't allow unknown player names.  So ta.getCapital() will either return a null or will return a String that is a valid player name.", "url": "https://github.com/triplea-game/triplea/pull/8447#discussion_r544822686", "createdAt": "2020-12-17T05:29:28Z", "author": {"login": "trevan"}, "path": "game-core/src/main/java/games/strategy/triplea/attachments/TerritoryAttachment.java", "diffHunk": "@@ -78,19 +80,15 @@ public static boolean doWeHaveEnoughCapitalsToProduce(\n    * we find that we don't own. If a capital has no neighbor connections, it will be sent last.\n    */\n   public static @Nullable Territory getFirstOwnedCapitalOrFirstUnownedCapital(\n-      final GamePlayer player, final GameData data) {\n+      final GamePlayer player, final GameMap gameMap) {\n     final List<Territory> capitals = new ArrayList<>();\n     final List<Territory> noNeighborCapitals = new ArrayList<>();\n-    for (final Territory current : data.getMap().getTerritories()) {\n+    for (final Territory current : gameMap.getTerritories()) {\n       final TerritoryAttachment ta = TerritoryAttachment.get(current);\n       if (ta != null && ta.getCapital() != null) {\n-        final GamePlayer whoseCapital = data.getPlayerList().getPlayerId(ta.getCapital());\n-        if (whoseCapital == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6a5f498a77b42f38161d2030ee0ec79ba1e780c"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e0d97039ca357cbd44759d0b5e44386d75a648a", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/7e0d97039ca357cbd44759d0b5e44386d75a648a", "committedDate": "2020-12-17T05:31:07Z", "message": "Mark TerritoryAttachment#getCapital as nullable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MzQwOTYw", "url": "https://github.com/triplea-game/triplea/pull/8447#pullrequestreview-554340960", "createdAt": "2020-12-17T07:35:41Z", "commit": {"oid": "7e0d97039ca357cbd44759d0b5e44386d75a648a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwNzozNTo0MVrOIHoP5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwNzozNTo0MVrOIHoP5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDg3MDM3NQ==", "bodyText": "It's a bit amusing this is used almost 20 lines later.   : )\n\"Clean code\" was written in 2008, this code almost certainly predates it. Interesting to see the concept of 'good code' evolve.", "url": "https://github.com/triplea-game/triplea/pull/8447#discussion_r544870375", "createdAt": "2020-12-17T07:35:41Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/TripleAPlayer.java", "diffHunk": "@@ -566,7 +566,6 @@ private void endTurn() {\n     if (getPlayerBridge().isGameOver()) {\n       return;\n     }\n-    final GameData data = getGameData();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e0d97039ca357cbd44759d0b5e44386d75a648a"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3820, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}