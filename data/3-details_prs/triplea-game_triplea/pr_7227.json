{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NDg5NTQx", "number": 7227, "title": "Track the isSub/isSuicide combo properties separately from the individual props", "bodyText": "Fixes #7177\nWith the change from isSub and isSuicide to the separated properties, the engine now checks the gameProperties only once when the save is loaded or the game map is loaded.  If the user then edits the gameProperties through the UI and changes sub or suicide related properties, they will not take affect.\nThis adds back the isSub and the isSuicide properties.  The separate properties are no longer set during setIsSub and setIsSuicide.  Instead, each of the properties will check if isSub or isSuicide is set.  And if a gameProperty is needed, it will check it then.  This way, the edited gameProperty will be seen when the game starts.\nI've verified that this is save compatible with older saves in 2.x.  Those saves will not be fixed by this change.  The user will have to restart the game to see this fix.\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[] Code Cleanup or refactor\n[] Configuration Change\n[x] Problem fix\n[] Other:   \nTesting\n\nI've played a few sub games with a few different properties.  It looks like the properties are acting correctly and that user editable properties work.\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note\n\nFIX|Disabling \"Air Attack Sub Restricted\" in Map Options will correctly allow airplanes to hit subs.", "createdAt": "2020-07-23T05:33:56Z", "url": "https://github.com/triplea-game/triplea/pull/7227", "merged": true, "mergeCommit": {"oid": "1211fe9727a325d8e78bf99003ba89b46429144c"}, "closed": true, "closedAt": "2020-08-01T05:22:01Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3okHXAH2gAyNDU1NDg5NTQxOjY5MTA3Mzk1NThlOTQxYTdkZjk4ODA2NWZmZjk1Yzg1NzY2YWEyNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6heOLAFqTQ1OTU1MjgwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6910739558e941a7df988065fff95c85766aa26f", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/6910739558e941a7df988065fff95c85766aa26f", "committedDate": "2020-07-23T05:27:34Z", "message": "Track the isSub/isSuicide combo properties separately from the individual props"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzODQ2MTQ0", "url": "https://github.com/triplea-game/triplea/pull/7227#pullrequestreview-453846144", "createdAt": "2020-07-23T05:37:59Z", "commit": {"oid": "6910739558e941a7df988065fff95c85766aa26f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwNTozNzo1OVrOG18y5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwNTozNzo1OVrOG18y5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIyMzc4Mg==", "bodyText": "Codacy found an issue: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/triplea-game/triplea/pull/7227#discussion_r459223782", "createdAt": "2020-07-23T05:37:59Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/attachments/UnitAttachment.java", "diffHunk": "@@ -629,13 +633,10 @@ private void setIsSub(final String s) {\n   }\n \n   private void setIsSub(final Boolean s) {\n-    setCanEvade(s);\n-    setIsFirstStrike(s);\n-    setCanMoveThroughEnemies(s && Properties.getSubmersibleSubs(getData()));\n-    setCanBeMovedThroughByEnemies(s && Properties.getIgnoreSubInMovement(getData()));\n+    isSub = true;\n     if (s) {\n       canNotTarget = null;\n-      canNotBeTargetedBy = Properties.getAirAttackSubRestricted(getData()) ? null : new HashSet<>();\n+      canNotBeTargetedBy = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6910739558e941a7df988065fff95c85766aa26f"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTUyODAy", "url": "https://github.com/triplea-game/triplea/pull/7227#pullrequestreview-459552802", "createdAt": "2020-08-01T04:49:53Z", "commit": {"oid": "6910739558e941a7df988065fff95c85766aa26f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwNDo0OTo1NFrOG6bkQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwNDo1MjoyOVrOG6blNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkyMjI0MQ==", "bodyText": "A 'combo' property is not well defined, what does this mean? Is this comment adding more than the questions it raises? I would suggest either explaining this more or just omitting the comment.", "url": "https://github.com/triplea-game/triplea/pull/7227#discussion_r463922241", "createdAt": "2020-08-01T04:49:54Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/attachments/UnitAttachment.java", "diffHunk": "@@ -226,6 +226,10 @@\n   // Manually set TUV\n   private int tuv = -1;\n \n+  // combo properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6910739558e941a7df988065fff95c85766aa26f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkyMjQ4Ng==", "bodyText": "This is sad to see of course as options become super complex. What happens when I set 'isFirstStrike = false' and 'isSub = true' (well, it is first strike even though the option is set to off). I think that examples shows we lack flexibility, you cannot have a non-first strike sub unit or non-first strike suicide unit.\nIs the other option for us instead of the 'combo' property would be to update all maps? I'm not sure if there is really a good alternative to the code update proposed, I'm more thinking out loud and wondering what other options we might have.", "url": "https://github.com/triplea-game/triplea/pull/7227#discussion_r463922486", "createdAt": "2020-08-01T04:52:29Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/attachments/UnitAttachment.java", "diffHunk": "@@ -647,31 +648,31 @@ private void setCanEvade(final Boolean s) {\n   }\n \n   public boolean getCanEvade() {\n-    return canEvade;\n+    return canEvade || isSub;\n   }\n \n   private void setIsFirstStrike(final Boolean s) {\n     isFirstStrike = s;\n   }\n \n   public boolean getIsFirstStrike() {\n-    return isFirstStrike;\n+    return isFirstStrike || isSub || isSuicide;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6910739558e941a7df988065fff95c85766aa26f"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3233, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}