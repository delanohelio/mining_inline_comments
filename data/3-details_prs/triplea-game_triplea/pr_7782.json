{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzNjAwODQz", "number": 7782, "title": "Simplify BattleState api by combining methods", "bodyText": "This reduces the number of methods exposed in BattleState.\nTesting\n\nScreens Shots\n\nAdditional Notes to Reviewer\n\nRelease Note", "createdAt": "2020-09-26T16:54:00Z", "url": "https://github.com/triplea-game/triplea/pull/7782", "merged": true, "mergeCommit": {"oid": "07eff11f52ffd007edb647ed817aa9e188ebab05"}, "closed": true, "closedAt": "2020-09-27T02:49:36Z", "author": {"login": "trevan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMtS_kAH2gAyNDkzNjAwODQzOjE4YWYxMzE3ZDA0YzMxZjFhZmFlY2IxNjc3OTc1MDQ4Nzg3N2ZhMjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdM07v1gH2gAyNDkzNjAwODQzOmUyNzFmMTZiODNiY2VlZjI0ZDQ5YTAzODMwOTdkY2VjOWE4Njk1OTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/18af1317d04c31f1afaecb16779750487877fa29", "committedDate": "2020-09-26T16:50:48Z", "message": "Simplify BattleState api by combining methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDIzMjky", "url": "https://github.com/triplea-game/triplea/pull/7782#pullrequestreview-497023292", "createdAt": "2020-09-26T18:38:11Z", "commit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxODozODoxMVrOHYh6Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxODo0NjoyNlrOHYh9CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ4MzQ3MQ==", "bodyText": "Do I understand right that we're doing more of a filter operation here rather than a straight get? If so, what would you think of naming this method 'filterUnits'?  Or 'getUnitsByStatus', or 'filterUnitsBySTatus'", "url": "https://github.com/triplea-game/triplea/pull/7782#discussion_r495483471", "createdAt": "2020-09-26T18:38:11Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java", "diffHunk": "@@ -363,7 +365,29 @@ public BattleRound getBattleRoundState() {\n   }\n \n   @Override\n-  public Collection<Unit> getUnits(final Side... sides) {\n+  public GamePlayer getPlayer(final Side side) {\n+    return side == OFFENSE ? getAttacker() : getDefender();\n+  }\n+\n+  @Override\n+  public Collection<Unit> getUnits(final UnitsStatus status, final Side... sides) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ4MzY3MA==", "bodyText": "I'm a bit confused by 'active' being alive and casualty. The confusing part is if they are alive and casualty, then wouldn't they be 'casualty'?\nThe enum maybe would be more descriptive as well called UnitBattleStatus as it's seemingly the units status relative to the current battle.\nThe 'active' I think could use more clarity", "url": "https://github.com/triplea-game/triplea/pull/7782#discussion_r495483670", "createdAt": "2020-09-26T18:40:20Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/BattleState.java", "diffHunk": "@@ -30,10 +30,24 @@ public Side getOpposite() {\n     }\n   }\n \n+  enum UnitsStatus {\n+    // units that have not been hit\n+    ALIVE,\n+    // both ALIVE and CASUALTY\n+    ACTIVE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ4Mzc4NA==", "bodyText": "Would it make sense to call this \"removed\" and use that terminology in the comments above as well?\nI notice: \" but not yet cleared\", which would imply this is a \"CLEARED\" status. \"CLEARED\" could mean a few other things, \"REMOVED\" on the other hand I believe would be unambiguous.\nArguably, 'dead' and 'casualty' can mean the same thing, a slight rename would keep that distinction crystal clear.", "url": "https://github.com/triplea-game/triplea/pull/7782#discussion_r495483784", "createdAt": "2020-09-26T18:41:45Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/BattleState.java", "diffHunk": "@@ -30,10 +30,24 @@ public Side getOpposite() {\n     }\n   }\n \n+  enum UnitsStatus {\n+    // units that have not been hit\n+    ALIVE,\n+    // both ALIVE and CASUALTY\n+    ACTIVE,\n+    // units that have been hit but not yet cleared\n+    CASUALTY,\n+    // units that are dead\n+    DEAD,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ4Mzc5NA==", "bodyText": "Nice, many fewer methods here, good work  \ud83d\udc4d", "url": "https://github.com/triplea-game/triplea/pull/7782#discussion_r495483794", "createdAt": "2020-09-26T18:42:10Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/BattleState.java", "diffHunk": "@@ -65,20 +77,10 @@ public boolean isFirstRound() {\n \n   Collection<Unit> getBombardingUnits();\n \n-  Collection<Unit> getKilled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ4NDE2OQ==", "bodyText": "The exact implementation in the fake as we have in the real is concerning. At some point this is not even a fake but just another battle-state implementation.  I don't know if there is a good solution for this problem that would fit within the scope of this PR. However, let's keep an eye on this as it seems to be a growing problem for the fake battle state.", "url": "https://github.com/triplea-game/triplea/pull/7782#discussion_r495484169", "createdAt": "2020-09-26T18:46:26Z", "author": {"login": "DanVanAtta"}, "path": "game-core/src/test/java/games/strategy/triplea/delegate/battle/FakeBattleState.java", "diffHunk": "@@ -96,12 +94,34 @@\n   }\n \n   @Override\n-  public BattleRound getBattleRoundState() {\n-    return BattleRound.of(battleRound, maxBattleRounds);\n+  public BattleStatus getStatus() {\n+    return BattleStatus.of(battleRound, maxBattleRounds, over, amphibious, headless);\n   }\n \n   @Override\n-  public Collection<Unit> getUnits(final Side... sides) {\n+  public GamePlayer getPlayer(final Side side) {\n+    return side == OFFENSE ? attacker : defender;\n+  }\n+\n+  @Override\n+  public Collection<Unit> getUnits(final UnitsStatus status, final Side... sides) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18af1317d04c31f1afaecb16779750487877fa29"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1d9b9adf660f2e3c6dc647c89d33d19056c86c0", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/a1d9b9adf660f2e3c6dc647c89d33d19056c86c0", "committedDate": "2020-09-26T19:29:37Z", "message": "Improve UnitBattleStatus comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f153f6783f699e5f3223da8ad4ca6825ce144b39", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/f153f6783f699e5f3223da8ad4ca6825ce144b39", "committedDate": "2020-09-26T21:20:07Z", "message": "Allow requesting multiple states for getUnits"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69789843330b2c4f25b2c1dac31c8ffa1c1ef8ab", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/69789843330b2c4f25b2c1dac31c8ffa1c1ef8ab", "committedDate": "2020-09-26T23:47:30Z", "message": "Rename getUnits to filterUnits and use a filter that wraps the status"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e271f16b83bceef24d49a0383097dcec9a869595", "author": {"user": {"login": "trevan", "name": null}}, "url": "https://github.com/triplea-game/triplea/commit/e271f16b83bceef24d49a0383097dcec9a869595", "committedDate": "2020-09-27T01:44:39Z", "message": "Fix checkstyle issues"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3954, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}