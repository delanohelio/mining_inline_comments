{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMzM2OTQy", "number": 6519, "title": "Do reverse-connection check of new game hosts when posting games", "bodyText": "This update combines the connectivity check endpoint with the post-game\nendpoint. This avoids any timing issues and seeks to simplify\nthe game posting flow. Instead of a client doing two round trips\nto the server to first post a game and then ask for a connectivity\ncheck, it is done as one now.\nFor implementation updates, we update the response from the game-posting\nrequest to include both game-id (nullable) and the result of the\nconnectivity check. After posting a game we now should check\nthe connectivity result and if okay, then proceed, otherwise\nexecute the previous behavior when the connectivity check failed\n(which is to show the \"this is how to set up port forwarding\" message\nand shutdown).\n\nFunctional Changes\n\n[] New map or map update\n[] New Feature\n[] Feature update or enhancement\n[] Feature Removal\n[x] Code Cleanup or refactor\n[] Configuration Change\n[x] Problem fix: Addresses: #6484 \n[] Other:   \nTesting\nVerified could connect to a local lobby and host a game.\n\n\n\n\nAdditional Review Notes\nThis gets us super close to a 2.0 RC. I'd like to have this get in and add a single or double retry to websocket connections and then consider that next build a RC.", "createdAt": "2020-05-23T22:52:23Z", "url": "https://github.com/triplea-game/triplea/pull/6519", "merged": true, "mergeCommit": {"oid": "fe8feb45befd8467f90c04377d4f44dce29c81d6"}, "closed": true, "closedAt": "2020-05-24T23:39:48Z", "author": {"login": "DanVanAtta"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckO7KhgH2gAyNDIyMzM2OTQyOjBjMjVjZTdkM2RhNjA3Y2FiZjEyNzVlZGE2YTk1MjY5YWNmOTk5MmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABckkG_9gFqTQxNzQwMDAzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c25ce7d3da607cabf1275eda6a95269acf9992d", "author": {"user": {"login": "DanVanAtta", "name": "Dan Van Atta"}}, "url": "https://github.com/triplea-game/triplea/commit/0c25ce7d3da607cabf1275eda6a95269acf9992d", "committedDate": "2020-05-23T22:50:39Z", "message": "Do reverse-connection check of new game hosts when posting games\n\nThis update combines the connectivity check endpoint with the post-game\nendpoint. This avoids any timing issues and seeks to simplify\nthe game posting flow. Instead of a client doing two round trips\nto the server to first post a game and then ask for a connectivity\ncheck, it is done as one now.\n\nFor implementation updates, we update the response from the game-posting\nrequest to include both game-id (nullable) and the result of the\nconnectivity check. After posting a game we now should check\nthe connectivity result and if okay, then proceed, otherwise\nexecute the previous behavior when the connectivity check failed\n(which is to show the \"this is how to set up port forwarding\" message\nand shutdown)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NDAwMDM1", "url": "https://github.com/triplea-game/triplea/pull/6519#pullrequestreview-417400035", "createdAt": "2020-05-24T23:12:50Z", "commit": {"oid": "0c25ce7d3da607cabf1275eda6a95269acf9992d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQyMzoxMjo1MFrOGZx2uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQyMzoxMjo1MFrOGZx2uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY4NDQxMQ==", "bodyText": "What is the \"How to host\" button currently doing?\nWe might want to mention the possibility of using a relay service in the future", "url": "https://github.com/triplea-game/triplea/pull/6519#discussion_r429684411", "createdAt": "2020-05-24T23:12:50Z", "author": {"login": "RoiEXLab"}, "path": "game-core/src/main/java/games/strategy/engine/framework/startup/WatcherThreadMessaging.java", "diffHunk": "@@ -12,14 +12,31 @@\n \n /** Interface to communicate lobby watcher events to user. */\n public interface WatcherThreadMessaging {\n-  void serverNotAvailableHandler(String message);\n+  String COMPUTER_NOT_REACHABLE_ERROR_MESSAGE =\n+      \"Your computer is not reachable from the internet.\\n\"\n+          + \"Please make sure your Firewall allows incoming connections (hosting) \"\n+          + \"for TripleA.\\n\"\n+          + \"(The firewall exception must be updated every time a new version of \"\n+          + \"TripleA comes out.)\\n\"\n+          + \"And that your Router is configured to send TCP traffic the correct port \"\n+          + \" to your local ip address.\\n\"\n+          + \"See 'How To Host...' in the help menu, at the top of the lobby \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c25ce7d3da607cabf1275eda6a95269acf9992d"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3453, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}