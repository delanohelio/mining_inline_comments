{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NzgxODg3", "number": 1810, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo1NzowOFrODti2Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjoxMFrODti_Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDgzNDAzOnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo1NzowOFrOF_B5Rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDozNTozMVrOF_Dp-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzNTY1NQ==", "bodyText": "This line is tab spaced, and it looks like some other parts of this file are too.", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401635655", "createdAt": "2020-04-01T13:57:08Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -1846,13 +1846,25 @@ FiringPlan getFullFiringPlan(final Entity shooter,\n         \t\tcontinue;\n         \t}\n         \t\n-        \t\n-            final double toHitThreshold = ammoConservation.get(weapon);\n-            final WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+        \tfinal double toHitThreshold = ammoConservation.get(weapon);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY2NDUwNg==", "bodyText": "Don't have access to my dev environment right now, so we'll get this one next time.", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401664506", "createdAt": "2020-04-01T14:35:31Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -1846,13 +1846,25 @@ FiringPlan getFullFiringPlan(final Entity shooter,\n         \t\tcontinue;\n         \t}\n         \t\n-        \t\n-            final double toHitThreshold = ammoConservation.get(weapon);\n-            final WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+        \tfinal double toHitThreshold = ammoConservation.get(weapon);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzNTY1NQ=="}, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg1MTYxOnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/WeaponFireInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMDo1MFrOF_CELA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMDo1MFrOF_CELA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzODQ0NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401638444", "createdAt": "2020-04-01T14:00:50Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/WeaponFireInfo.java", "diffHunk": "@@ -521,19 +520,10 @@ void initDamage(@Nullable final MovePath shooterPath,\n             } else {\n                 setToHit(calcToHit());\n             }\n-\n+            ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg1NDg2OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMTozNVrOF_CGVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMTozNVrOF_CGVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzODk5Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(updatedMissileMode > -1) {\n          \n          \n            \n                            if (updatedMissileMode > -1) {", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401638997", "createdAt": "2020-04-01T14:01:35Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -1846,13 +1846,25 @@ FiringPlan getFullFiringPlan(final Entity shooter,\n         \t\tcontinue;\n         \t}\n         \t\n-        \t\n-            final double toHitThreshold = ammoConservation.get(weapon);\n-            final WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+        \tfinal double toHitThreshold = ammoConservation.get(weapon);\n+            WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+            \n+            // if we're below the threshold, try switching missile modes\n+            if ((shoot.getProbabilityToHit() <= toHitThreshold)) {\n+                \n+                int updatedMissileMode = switchMissileMode(weapon);\n+                \n+                if(updatedMissileMode > -1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg1NTY5OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMTo0NVrOF_CG4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMTo0NVrOF_CG4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzOTEzNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if ((shoot.getProbabilityToHit() <= toHitThreshold)) {\n          \n          \n            \n                        if (shoot.getProbabilityToHit() <= toHitThreshold) {", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401639137", "createdAt": "2020-04-01T14:01:45Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -1846,13 +1846,25 @@ FiringPlan getFullFiringPlan(final Entity shooter,\n         \t\tcontinue;\n         \t}\n         \t\n-        \t\n-            final double toHitThreshold = ammoConservation.get(weapon);\n-            final WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+        \tfinal double toHitThreshold = ammoConservation.get(weapon);\n+            WeaponFireInfo shoot = buildWeaponFireInfo(shooter, target, weapon, game, false);\n+            \n+            // if we're below the threshold, try switching missile modes\n+            if ((shoot.getProbabilityToHit() <= toHitThreshold)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg1NzA1OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjowM1rOF_CHvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjowM1rOF_CHvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzOTM1OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(!weapon.curMode().equals(Weapon.MODE_MISSILE_INDIRECT)) {\n          \n          \n            \n                        if (!weapon.curMode().equals(Weapon.MODE_MISSILE_INDIRECT)) {", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401639358", "createdAt": "2020-04-01T14:02:03Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -3273,4 +3285,26 @@ public SearchlightAttackAction getSearchLightAction(Entity shooter, FiringPlan p\n         \n         return null;\n     }\n+    \n+    /**\n+     * Attempts to switch the current weapon's firing mode between direct and indirect\n+     * or vice versa. Returns -1 if the mode switch fails, or the weapon mode index if it succeeds.\n+     * @return Mode switch result.\n+     */\n+    private int switchMissileMode(Mounted weapon) {\n+        // check that we're operating a missile weapon that can switch direct/indirect modes\n+        // don't bother checking non-missile weapons\n+        if(weapon.getType().hasFlag(Weapon.F_MISSILE) &&\n+                weapon.getType().hasModeType(Weapon.MODE_MISSILE_INDIRECT)) {\n+            \n+            // if we are able to switch the weapon to indirect fire mode, do so and try again\n+            if(!weapon.curMode().equals(Weapon.MODE_MISSILE_INDIRECT)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg1NzYzOnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjoxMFrOF_CIGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjoxMFrOF_CIGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzOTQ1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(weapon.getType().hasFlag(Weapon.F_MISSILE) &&\n          \n          \n            \n                    if (weapon.getType().hasFlag(Weapon.F_MISSILE) &&", "url": "https://github.com/MegaMek/megamek/pull/1810#discussion_r401639451", "createdAt": "2020-04-01T14:02:10Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -3273,4 +3285,26 @@ public SearchlightAttackAction getSearchLightAction(Entity shooter, FiringPlan p\n         \n         return null;\n     }\n+    \n+    /**\n+     * Attempts to switch the current weapon's firing mode between direct and indirect\n+     * or vice versa. Returns -1 if the mode switch fails, or the weapon mode index if it succeeds.\n+     * @return Mode switch result.\n+     */\n+    private int switchMissileMode(Mounted weapon) {\n+        // check that we're operating a missile weapon that can switch direct/indirect modes\n+        // don't bother checking non-missile weapons\n+        if(weapon.getType().hasFlag(Weapon.F_MISSILE) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ac7802b103464f73f7947920aab2f612b880cf"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2891, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}