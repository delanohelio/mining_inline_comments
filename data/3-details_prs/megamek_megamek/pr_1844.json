{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMzY2MjIw", "number": 1844, "title": "Towing improvements 1", "bodyText": "Feature: Ammo Sharing between adjacent trailers/tractors\nEnhancement: Allow infantry loading/unloading to trains\nErrata: Calculate MP of trains using engine rating + lowest suspension factor\n\nAddresses #1496, #1467", "createdAt": "2020-04-12T16:45:23Z", "url": "https://github.com/MegaMek/megamek/pull/1844", "merged": true, "mergeCommit": {"oid": "1aa9790d29d96245dc3c1b4568829e9dbeee1775"}, "closed": true, "closedAt": "2020-04-17T18:45:20Z", "author": {"login": "mkerensky"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVWFx7gH2gAyNDAyMzY2MjIwOmJiNjQzOTdmNTVkNjNhMTg1NjVhODMyMDJlYjk0MTkyY2VhZTIxMGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYl1CagFqTM5NTY5MTU4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bb64397f55d63a18565a83202eb94192ceae210a", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/bb64397f55d63a18565a83202eb94192ceae210a", "committedDate": "2020-04-07T16:42:43Z", "message": "Update towing MP per TM errata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8582c413c6f431fda487d5e4d51689b99a65621", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/a8582c413c6f431fda487d5e4d51689b99a65621", "committedDate": "2020-04-08T15:48:50Z", "message": "Test adjacent coords for whole land train when unloading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e159757f5a44574a9f8e805fb4813c7d89db418e", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/e159757f5a44574a9f8e805fb4813c7d89db418e", "committedDate": "2020-04-08T16:37:19Z", "message": "Allow towed trailers to unload to alternate positions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e76f9a0fcc94afdbe2aba8890146c2367795ebf8", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/e76f9a0fcc94afdbe2aba8890146c2367795ebf8", "committedDate": "2020-04-08T16:37:41Z", "message": "Fix stack violation check to use targetPos if available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "decd072989a494462dde3d77cf9e14796a5a6f34", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/decd072989a494462dde3d77cf9e14796a5a6f34", "committedDate": "2020-04-09T15:34:31Z", "message": "Finish unload trains to adjacent hexes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af988c840b5c2d32d347a13b06a54225b9f32044", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/af988c840b5c2d32d347a13b06a54225b9f32044", "committedDate": "2020-04-09T15:56:26Z", "message": "Allow infantry adjacent to trains to Mount"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5e7aeb29779ba789a4c17c0dcaafad0676455e7", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/a5e7aeb29779ba789a4c17c0dcaafad0676455e7", "committedDate": "2020-04-10T16:53:38Z", "message": "Update system panel display for trailer ammo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0572f3b8a8cb57c5da22712e79aa90d3a002cb95", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/0572f3b8a8cb57c5da22712e79aa90d3a002cb95", "committedDate": "2020-04-10T16:58:28Z", "message": "WIP ammo sharing for trains"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b72a264612ec671ef1de22a741a36625541c9ef8", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/b72a264612ec671ef1de22a741a36625541c9ef8", "committedDate": "2020-04-11T16:41:59Z", "message": "Allow loadWeaponWithSameAmmo to search trailers and tractor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46a3df6ca12bfc870c5d886643a88241e9793975", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/46a3df6ca12bfc870c5d886643a88241e9793975", "committedDate": "2020-04-11T17:21:38Z", "message": "Add ammo carrier tracking for weapon attack actions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27c35b8c6a1e2046ac48ade3bde5c19ff3c3bb6f", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/27c35b8c6a1e2046ac48ade3bde5c19ff3c3bb6f", "committedDate": "2020-04-11T17:37:34Z", "message": "Update arty handler to use ammo carrier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42e6f9d33244f4eca6665b3adc43f3c6945e6924", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/42e6f9d33244f4eca6665b3adc43f3c6945e6924", "committedDate": "2020-04-11T17:42:27Z", "message": "WIP reloading ammo at disconnect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3834ad7e0eb8e4859bc5d621db6a376fdfe79023", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/3834ad7e0eb8e4859bc5d621db6a376fdfe79023", "committedDate": "2020-04-12T15:14:46Z", "message": "Set AmmoId in waa using entity of ammo mounted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebb25a0137fd054f357c1885cc7fe3ae9c58e721", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/ebb25a0137fd054f357c1885cc7fe3ae9c58e721", "committedDate": "2020-04-12T15:55:03Z", "message": "Update isTowing value when disconnecting a trailer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4e62a9b182619855e0985018905f8d11db07346", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/a4e62a9b182619855e0985018905f8d11db07346", "committedDate": "2020-04-12T16:09:29Z", "message": "Undo changes to system panel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bfd94c1e439a01a74f499489d1e64092ca0cb3c", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/8bfd94c1e439a01a74f499489d1e64092ca0cb3c", "committedDate": "2020-04-12T16:40:12Z", "message": "Show train ammo in WeaponPanel display"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/27f8efa619f768a4319e183bca6b403b85e44113", "committedDate": "2020-04-12T16:41:32Z", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into Towing_Improvements_1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODc1NTg3", "url": "https://github.com/MegaMek/megamek/pull/1844#pullrequestreview-391875587", "createdAt": "2020-04-12T16:48:20Z", "commit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo0ODoyMFrOGEW9aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo1MToyNVrOGEW_Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzY1Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        sb.append('['+ \"TR] \"); //$NON-NLS-1$\n          \n          \n            \n                        sb.append(\"[TR] \"); //$NON-NLS-1$", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407223657", "createdAt": "2020-04-12T16:48:20Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/client/ui/swing/unitDisplay/WeaponPanel.java", "diffHunk": "@@ -2128,7 +2139,9 @@ private String formatAmmo(Mounted m) {\n         int ammoIndex = m.getDesc().indexOf(\n                 Messages.getString(\"MechDisplay.0\")); //$NON-NLS-1$\n         int loc = m.getLocation();\n-        if (loc != Entity.LOC_NONE) {\n+        if (!m.getEntity().equals(entity)) {\n+            sb.append('['+ \"TR] \"); //$NON-NLS-1$", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzc3MA==", "bodyText": "Small craft can tow entities?", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407223770", "createdAt": "2020-04-12T16:49:00Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/Compute.java", "diffHunk": "@@ -6678,7 +6677,7 @@ public static boolean inDeadZone(IGame game, Entity ae, Targetable target) {\n                 if ((en.getOwner().equals(other.getOwner()) || (en.getOwner()\n                                                                   .getTeam() == other.getOwner().getTeam()))\n                     && !en.equals(other)\n-                    && (other instanceof SmallCraft)\n+                    && ((other instanceof SmallCraft) || other.getTowing() != Entity.NONE || other.getTowedBy() != Entity.NONE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNDA4Mg==", "bodyText": "Could this return null if aaa.getAmmoCarrier() returns Entity.NONE? Or can that never happen?", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407224082", "createdAt": "2020-04-12T16:51:25Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -152,7 +152,9 @@ public boolean handle(IGame.Phase phase, Vector<Report> vPhaseReport) {\n             System.err.println(\"Artillery Entity is null!\");\n             return true;\n         }\n-        Mounted ammoUsed = ae.getEquipment(aaa.getAmmoId());\n+        //Trailers can share ammo, which means the entity carrying the ammo might\n+        Entity ammoCarrier = game.getEntity(aaa.getAmmoCarrier());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODc3MTY0", "url": "https://github.com/MegaMek/megamek/pull/1844#pullrequestreview-391877164", "createdAt": "2020-04-12T17:06:42Z", "commit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNzowNjo0MlrOGEXGag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNzowNjo0MlrOGEXGag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNTk2Mg==", "bodyText": "Needs a continue; here to avoid an NPE:\nhttps://lgtm.com/projects/g/MegaMek/megamek/snapshot/01ffc9b23acdb201d74d30b8fbf713894c95eb95/files/megamek/src/megamek/client/bot/princess/FireControl.java#x7c149b9bf1a4a99f:1", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407225962", "createdAt": "2020-04-12T17:06:42Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -2527,6 +2527,7 @@ void loadAmmo(final Entity shooter,\n             }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8307d6adc63d2e0b6d675aeca82d12395dd1bebd", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/8307d6adc63d2e0b6d675aeca82d12395dd1bebd", "committedDate": "2020-04-13T14:31:55Z", "message": "Fix stringBuffer text in formatAmmo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f57aae0f831e2196ed6316a293a88bab147a18c", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/4f57aae0f831e2196ed6316a293a88bab147a18c", "committedDate": "2020-04-13T14:37:05Z", "message": "Finish partial comment in artyindirecthandler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6c069df2c28bc3a47123c9776de4d62fe1af069", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/b6c069df2c28bc3a47123c9776de4d62fe1af069", "committedDate": "2020-04-13T14:38:00Z", "message": "Resave long tom ammo trailer with trailer flag set"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39e12585c65988d8ae7d15f0b798f0cf8cec7e68", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/39e12585c65988d8ae7d15f0b798f0cf8cec7e68", "committedDate": "2020-04-13T14:49:12Z", "message": "setAmmoCarrier for artyBayWeapon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9ec41a1e8d3340e4a913357be73357eee3dded1", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/b9ec41a1e8d3340e4a913357be73357eee3dded1", "committedDate": "2020-04-13T14:54:00Z", "message": "Add continue at FireControl 2527"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "871742bd2be2586a649ab60efce128c2f5b3adeb", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/871742bd2be2586a649ab60efce128c2f5b3adeb", "committedDate": "2020-04-17T15:11:24Z", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into Towing_Improvements_1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d1119a69a4bff216dd0e605dcc7ace4b88e4b07", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/1d1119a69a4bff216dd0e605dcc7ace4b88e4b07", "committedDate": "2020-04-17T16:11:06Z", "message": "Prevent princess from firing with no valid ammo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0f49810176133b7bff6b064a717930b760dd7a4", "author": {"user": null}, "url": "https://github.com/MegaMek/megamek/commit/c0f49810176133b7bff6b064a717930b760dd7a4", "committedDate": "2020-04-17T16:20:44Z", "message": "Add comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NjkxNTgz", "url": "https://github.com/MegaMek/megamek/pull/1844#pullrequestreview-395691583", "createdAt": "2020-04-17T18:44:41Z", "commit": {"oid": "c0f49810176133b7bff6b064a717930b760dd7a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4967, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}