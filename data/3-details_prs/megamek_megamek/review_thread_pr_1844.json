{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMzY2MjIw", "number": 1844, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo0ODoyMFrODxEk8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNzowNjo0MlrODxEr9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNzgxODA5OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/ui/swing/unitDisplay/WeaponPanel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo0ODoyMFrOGEW9aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDozMToyMFrOGEoU6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzY1Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        sb.append('['+ \"TR] \"); //$NON-NLS-1$\n          \n          \n            \n                        sb.append(\"[TR] \"); //$NON-NLS-1$", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407223657", "createdAt": "2020-04-12T16:48:20Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/client/ui/swing/unitDisplay/WeaponPanel.java", "diffHunk": "@@ -2128,7 +2139,9 @@ private String formatAmmo(Mounted m) {\n         int ammoIndex = m.getDesc().indexOf(\n                 Messages.getString(\"MechDisplay.0\")); //$NON-NLS-1$\n         int loc = m.getLocation();\n-        if (loc != Entity.LOC_NONE) {\n+        if (!m.getEntity().equals(entity)) {\n+            sb.append('['+ \"TR] \"); //$NON-NLS-1$", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUwODIwMw==", "bodyText": "Fixed", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407508203", "createdAt": "2020-04-13T14:31:20Z", "author": {"login": "mkerensky"}, "path": "megamek/src/megamek/client/ui/swing/unitDisplay/WeaponPanel.java", "diffHunk": "@@ -2128,7 +2139,9 @@ private String formatAmmo(Mounted m) {\n         int ammoIndex = m.getDesc().indexOf(\n                 Messages.getString(\"MechDisplay.0\")); //$NON-NLS-1$\n         int loc = m.getLocation();\n-        if (loc != Entity.LOC_NONE) {\n+        if (!m.getEntity().equals(entity)) {\n+            sb.append('['+ \"TR] \"); //$NON-NLS-1$", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzY1Nw=="}, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNzgxODk4OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/Compute.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo0OTowMFrOGEW92g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDozNDoxNlrOGEoa7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzc3MA==", "bodyText": "Small craft can tow entities?", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407223770", "createdAt": "2020-04-12T16:49:00Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/Compute.java", "diffHunk": "@@ -6678,7 +6677,7 @@ public static boolean inDeadZone(IGame game, Entity ae, Targetable target) {\n                 if ((en.getOwner().equals(other.getOwner()) || (en.getOwner()\n                                                                   .getTeam() == other.getOwner().getTeam()))\n                     && !en.equals(other)\n-                    && (other instanceof SmallCraft)\n+                    && ((other instanceof SmallCraft) || other.getTowing() != Entity.NONE || other.getTowedBy() != Entity.NONE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUwOTc0Mw==", "bodyText": "This is code for loading infantry aboard multi-hex units, and yes, trains handle it like Dropships", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407509743", "createdAt": "2020-04-13T14:34:16Z", "author": {"login": "mkerensky"}, "path": "megamek/src/megamek/common/Compute.java", "diffHunk": "@@ -6678,7 +6677,7 @@ public static boolean inDeadZone(IGame game, Entity ae, Targetable target) {\n                 if ((en.getOwner().equals(other.getOwner()) || (en.getOwner()\n                                                                   .getTeam() == other.getOwner().getTeam()))\n                     && !en.equals(other)\n-                    && (other instanceof SmallCraft)\n+                    && ((other instanceof SmallCraft) || other.getTowing() != Entity.NONE || other.getTowedBy() != Entity.NONE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyMzc3MA=="}, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNzgyMTQ4OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNjo1MToyNVrOGEW_Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDozODoxNlrOGEoizQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNDA4Mg==", "bodyText": "Could this return null if aaa.getAmmoCarrier() returns Entity.NONE? Or can that never happen?", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407224082", "createdAt": "2020-04-12T16:51:25Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -152,7 +152,9 @@ public boolean handle(IGame.Phase phase, Vector<Report> vPhaseReport) {\n             System.err.println(\"Artillery Entity is null!\");\n             return true;\n         }\n-        Mounted ammoUsed = ae.getEquipment(aaa.getAmmoId());\n+        //Trailers can share ammo, which means the entity carrying the ammo might\n+        Entity ammoCarrier = game.getEntity(aaa.getAmmoCarrier());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUxMTc1Nw==", "bodyText": "That can't happen. AmmoCarrier will return the firing entity 95% of the time.", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407511757", "createdAt": "2020-04-13T14:38:16Z", "author": {"login": "mkerensky"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -152,7 +152,9 @@ public boolean handle(IGame.Phase phase, Vector<Report> vPhaseReport) {\n             System.err.println(\"Artillery Entity is null!\");\n             return true;\n         }\n-        Mounted ammoUsed = ae.getEquipment(aaa.getAmmoId());\n+        //Trailers can share ammo, which means the entity carrying the ammo might\n+        Entity ammoCarrier = game.getEntity(aaa.getAmmoCarrier());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNDA4Mg=="}, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNzgzNjA1OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNzowNjo0MlrOGEXGag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDo1MDowNFrOGEo6-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNTk2Mg==", "bodyText": "Needs a continue; here to avoid an NPE:\nhttps://lgtm.com/projects/g/MegaMek/megamek/snapshot/01ffc9b23acdb201d74d30b8fbf713894c95eb95/files/megamek/src/megamek/client/bot/princess/FireControl.java#x7c149b9bf1a4a99f:1", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407225962", "createdAt": "2020-04-12T17:06:42Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -2527,6 +2527,7 @@ void loadAmmo(final Entity shooter,\n             }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUxNzk0Nw==", "bodyText": "Good catch on ArtilleryBayWeapon(77).  I don't think either line in Compute needs it - those seem to be 'fake' weapon attack actions created but not finalized to calculate damage.\nI'll do some further playtesting with this on my next battle and see if I encounter unforeseen issues.", "url": "https://github.com/MegaMek/megamek/pull/1844#discussion_r407517947", "createdAt": "2020-04-13T14:50:04Z", "author": {"login": "mkerensky"}, "path": "megamek/src/megamek/client/bot/princess/FireControl.java", "diffHunk": "@@ -2527,6 +2527,7 @@ void loadAmmo(final Entity shooter,\n             }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIyNTk2Mg=="}, "originalCommit": {"oid": "27f8efa619f768a4319e183bca6b403b85e44113"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2914, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}