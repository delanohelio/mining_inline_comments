{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2OTcxMzg4", "number": 1691, "title": "Keep BA AP weapons matched to their mount in the blk file.", "bodyText": "BattleArmor anti-personnel weapons can be installed in either an AP mount or an armored glove. The relationship is tracked through Mounted::setLinked. When the BA unit is loaded the links are established during post-load initialization by linking each weapon to the first mount available in the list. For BA with a single AP mount this works fine, but BA with two armored gloves can find the weapon switching hands and BA with an AP mount and one or more armored gloves can have the weapon switched to a different type of mount. I used an approach similar to what is used for weapon bays, skipping the AP weapon when iterating through equipment and writing it directly after the mount that links to it. Then when loading any AP weapon is linked to the last eligible mount that was loaded.\nFixes MegaMek/megameklab#441.", "createdAt": "2020-02-19T05:24:16Z", "url": "https://github.com/MegaMek/megamek/pull/1691", "merged": true, "mergeCommit": {"oid": "5494c015a06c78a9392724dceccaa889a44466cb"}, "closed": true, "closedAt": "2020-02-19T14:23:01Z", "author": {"login": "neoancient"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFvWKdgH2gAyMzc2OTcxMzg4OmQ2NzQzNTlkNmJhYzkyMTJhOTk5Y2E3YjhlMDU5NjI2YzAxMzU5ZGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcF2XnHAFqTM2MTA5OTMyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d674359d6bac9212a999ca7b8e059626c01359dc", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/d674359d6bac9212a999ca7b8e059626c01359dc", "committedDate": "2020-02-19T05:05:27Z", "message": "Keep BA AP weapons matched to their mount in the blk file.\n\nAP weapons are listed immediately after the AP mount or armored glove they belong to and linked during\nloading."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwODUwMTQ5", "url": "https://github.com/MegaMek/megamek/pull/1691#pullrequestreview-360850149", "createdAt": "2020-02-19T05:27:35Z", "commit": {"oid": "d674359d6bac9212a999ca7b8e059626c01359dc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwNToyNzozNlrOFrbhXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwNToyNzozNlrOFrbhXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA4Mzk5OA==", "bodyText": "Entity#addEquipment never returns null. It can throw an exception, but it is guaranteed to be non-null in the try block. The test was confusing code analysis tools into flagging subsequent dereferences as potential NPEs.", "url": "https://github.com/MegaMek/megamek/pull/1691#discussion_r381083998", "createdAt": "2020-02-19T05:27:36Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/loaders/BLKBattleArmorFile.java", "diffHunk": "@@ -237,13 +231,24 @@ protected void loadEquipment(Entity t, String sName, int nLoc) throws EntityLoad\n                     try {\n                         Mounted m = t.addEquipment(etype, nLoc, false, \n                                 mountLoc, dwpMounted);\n-                        if (numShots != 0 && m != null ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d674359d6bac9212a999ca7b8e059626c01359dc"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMDk5MzIx", "url": "https://github.com/MegaMek/megamek/pull/1691#pullrequestreview-361099321", "createdAt": "2020-02-19T13:16:22Z", "commit": {"oid": "d674359d6bac9212a999ca7b8e059626c01359dc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4551, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}