{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNDIzMDQ4", "number": 2202, "title": "Inconsistent combat log sprites", "bodyText": "This is a fix #2186. The problem was that the value for the option to add the sprites to the log was was checked when the image code was added to the reports instead of when the client requested the reports to fill the log. This resulted in them not being added for other clients when the option was disabled and it stopped them from showing up retroactively if reports were added while the option was disabled. Some null checks were added as well to prevent other potential issues.\nThis issue also mentioned that the sprites would not display at all for one user. This seems to be an issue in specific versions of Java. I was able to reproduce it when I installed a different version initially, but the issue seemed to go away after updating it. If this continues to be a problem, there's a potential workaround for displaying the sprites in the log. Instead of converting the images to Base64, the BufferedImages could instead be written to a temp folder and displayed by returning their file address when BASE64ImageView calls \"getImageURL\".\nAlso, this potentially includes a fix for #2190. I had encountered a StringIndexOutOfBoundsException on line 492 of the Report class, like in the issue. So I added a check to make sure it wasn't trying to read text out of bounds before inserting the code for the sprites.", "createdAt": "2020-09-07T14:08:01Z", "url": "https://github.com/MegaMek/megamek/pull/2202", "merged": true, "mergeCommit": {"oid": "f0bceb3490d21f1da6b6a7ac9e440c2252d8ebc7"}, "closed": true, "closedAt": "2020-09-15T19:10:18Z", "author": {"login": "Krashner"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGis_tAH2gAyNDgxNDIzMDQ4OjBhZTczZDM2OThiNzU0YTRlMmRlYTAwOTdhODdjYzIyNGQ3MWRmODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJMLkXgH2gAyNDgxNDIzMDQ4OjYwY2IxOTk3NGQ4YTJjMzE4ODE1MWYxZTA2MjI3Yzc0ODRjNGQzMzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0ae73d3698b754a4e2dea0097a87cc224d71df80", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/0ae73d3698b754a4e2dea0097a87cc224d71df80", "committedDate": "2020-09-07T13:06:42Z", "message": "Fixed bug that caused sprites to be disabled for all clients when one toggled option"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c8668d723c44f186dc802f2c3b46dc9dc429beb", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/7c8668d723c44f186dc802f2c3b46dc9dc429beb", "committedDate": "2020-09-07T13:24:57Z", "message": "Fixed a string index out of bounds error when inserting image code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf1e3add4d87fc05edc242089d412e9789011368", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/cf1e3add4d87fc05edc242089d412e9789011368", "committedDate": "2020-09-07T14:01:33Z", "message": "Fixed a string index out of bounds error when inserting image code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "committedDate": "2020-09-07T14:01:53Z", "message": "Merge branch 'inconsistentCombatLogSprites' of https://github.com/Krashner/megamek into inconsistentCombatLogSprites"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNjQ4Njk0", "url": "https://github.com/MegaMek/megamek/pull/2202#pullrequestreview-483648694", "createdAt": "2020-09-07T16:02:48Z", "commit": {"oid": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjowMjo0OFrOHOD7kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjowNToxMlrOHOD-3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNjUxMw==", "bodyText": "Is text.startsWith(\"\\n\") not an option? Simpler than a length check and first char check.", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484506513", "createdAt": "2020-09-07T16:02:48Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -489,7 +487,7 @@ public String getText() {\n             }\n             //draw the sprite at the beginning of the line\n             if(imageCode != null && imageCode.length() > 0){\n-                if(text.substring(0,1).equals(\"\\n\")){\n+                if(text.length() >= 2 && text.substring(0,1).equals(\"\\n\")){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNzM1OA==", "bodyText": "Are we leaking these BAIS? Or do we need them held open for the BufferedImage's.", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484507358", "createdAt": "2020-09-07T16:05:12Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,31 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/a8661baf39ba5132071a85163c54905b8a6ac856", "committedDate": "2020-09-08T10:57:55Z", "message": "Cleaned up report text check and closed bais"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MDUwMjg2", "url": "https://github.com/MegaMek/megamek/pull/2202#pullrequestreview-487050286", "createdAt": "2020-09-11T19:00:21Z", "commit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "state": "COMMENTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTowMDoyMVrOHQqT8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTowNzowM1rOHQqgYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjQ5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n          \n          \n            \n                    if (!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232499", "createdAt": "2020-09-11T19:00:21Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/Client.java", "diffHunk": "@@ -1139,7 +1140,8 @@ public String receiveReport(Vector<Report> v) {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(imgCache == null || !imgCache.containsKey(id)) {\n+        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjYwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            || imgCache == null || !imgCache.containsKey(id)) {\n          \n          \n            \n                            || (imgCache == null) || !imgCache.containsKey(id)) {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232605", "createdAt": "2020-09-11T19:00:35Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/Client.java", "diffHunk": "@@ -1139,7 +1140,8 @@ public String receiveReport(Vector<Report> v) {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(imgCache == null || !imgCache.containsKey(id)) {\n+        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n+                || imgCache == null || !imgCache.containsKey(id)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjY4MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(image != null) {\n          \n          \n            \n                    if (image != null) {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232681", "createdAt": "2020-09-11T19:00:45Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjc1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(b64 != null) {\n          \n          \n            \n                    if (b64 != null) {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232756", "createdAt": "2020-09-11T19:00:54Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDQ5Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        } catch (Throwable ex) {\n          \n          \n            \n                            ex.printStackTrace();\n          \n          \n            \n                        } catch (Exception ex) {\n          \n          \n            \n                            MegaMek.getLogger(getClass(), \"loadImage\", ex);", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234497", "createdAt": "2020-09-11T19:04:38Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDU2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    }\n          \n          \n            \n                    else{\n          \n          \n            \n                    } else {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234567", "createdAt": "2020-09-11T19:04:48Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();\n+            }\n+            return newImage;\n+        }\n+        else{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDYzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        return  null;\n          \n          \n            \n                        return null;", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234636", "createdAt": "2020-09-11T19:04:54Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();\n+            }\n+            return newImage;\n+        }\n+        else{\n+            return  null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTE0NQ==", "bodyText": "Can this be done through try with properties?", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235145", "createdAt": "2020-09-11T19:06:00Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTQzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(indentation <= Report.DEFAULT_INDENTATION || showImage) {\n          \n          \n            \n                        if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235436", "createdAt": "2020-09-11T19:06:34Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -314,9 +313,8 @@ public void choose(boolean choice) {\n      */\n     public void addDesc(Entity entity) {\n         if (entity != null) {\n-            if(GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n-                    && (indentation <= Report.DEFAULT_INDENTATION || showImage)) {\n-                imageCode = \"<span id='\" +entity.getId() + \"'></span>\";\n+            if(indentation <= Report.DEFAULT_INDENTATION || showImage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTY4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(!imageCode.isEmpty()){\n          \n          \n            \n                            if(text.toString().startsWith(\"\\n\")){\n          \n          \n            \n                        if (!imageCode.isEmpty()) {\n          \n          \n            \n                            if (text.toString().startsWith(\"\\n\")) {", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235680", "createdAt": "2020-09-11T19:07:03Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -487,9 +485,9 @@ public String getText() {\n                 }\n                 i++;\n             }\n-            //draw the sprite at the beginning of the line\n-            if(imageCode != null && imageCode.length() > 0){\n-                if(text.substring(0,1).equals(\"\\n\")){\n+            //add the sprite code at the beginning of the line\n+            if(!imageCode.isEmpty()){\n+                if(text.toString().startsWith(\"\\n\")){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/58b8c9cc3431375b3c8a877637fef5719c20e7c2", "committedDate": "2020-09-15T17:05:17Z", "message": "Added requested change to loadImage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "committedDate": "2020-09-15T17:06:01Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6ca70022320199f2c8075cf223638273f363818", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/c6ca70022320199f2c8075cf223638273f363818", "committedDate": "2020-09-15T17:14:08Z", "message": "Added missing reference and slight code change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7", "committedDate": "2020-09-15T17:16:03Z", "message": "Removed line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTAwNTc4", "url": "https://github.com/MegaMek/megamek/pull/2202#pullrequestreview-488900578", "createdAt": "2020-09-15T17:19:41Z", "commit": {"oid": "e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoxOTo0MVrOHSL9gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoxOTo0MVrOHSL9gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzMjM4NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n          \n          \n            \n                            MegaMek.getLogger().error(this, ex);", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r488832385", "createdAt": "2020-09-15T17:19:41Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -53,29 +54,25 @@ private void populateImage() {\n         }\n         URL src = getImageURL();\n         Image image = loadImage();\n-        if(image != null) {\n+        if (image != null) {\n             cache.put(src, image);\n         }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60cb19974d8a2c3188151f1e06227c7484c4d333", "author": {"user": {"login": "Krashner", "name": "Justin"}}, "url": "https://github.com/MegaMek/megamek/commit/60cb19974d8a2c3188151f1e06227c7484c4d333", "committedDate": "2020-09-15T18:34:03Z", "message": "Add suggested change\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4756, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}