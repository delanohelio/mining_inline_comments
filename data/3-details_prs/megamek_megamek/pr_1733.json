{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMDY4NTc0", "number": 1733, "title": "Creating static getLogger() in MegaMek.java", "bodyText": "This allows us to just call MegaMek.getLogger() instead of having a private variable, and it has been implemented in three files alongside a bunch of code cleanup.", "createdAt": "2020-03-01T17:05:47Z", "url": "https://github.com/MegaMek/megamek/pull/1733", "merged": true, "mergeCommit": {"oid": "c6e1dde50dc33ff007336608e26e5edc8145f27b"}, "closed": true, "closedAt": "2020-07-07T17:41:30Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJMm_bgH2gAyMzgyMDY4NTc0Ojg2ODI5MGFjNmRiMTA4ZmVlMDkzZDMwMDMwODZhYmM1MGE1ZWJiY2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcypMfngH2gAyMzgyMDY4NTc0OjVjMjU1Yzg2ZDRmYmVjM2RjMzliNjg3OTAxYWMyMjVmNTRmYmZiMGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "868290ac6db108fee093d3003086abc50a5ebbcb", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/868290ac6db108fee093d3003086abc50a5ebbcb", "committedDate": "2020-02-29T22:52:51Z", "message": "Add static getLogger to MegaMek"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bb40f7a336bef16c35556a2be4de8abffcf8f34", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/6bb40f7a336bef16c35556a2be4de8abffcf8f34", "committedDate": "2020-02-29T23:24:02Z", "message": "Cleaning up code in MegaMek/java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca576fd5b507f477f561a80f68d02b7c1264a890", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/ca576fd5b507f477f561a80f68d02b7c1264a890", "committedDate": "2020-03-01T14:17:13Z", "message": "Finishing code cleanup of MegaMek.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15221266a11556f22bc0bbe48b23d146a7df34d6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/15221266a11556f22bc0bbe48b23d146a7df34d6", "committedDate": "2020-03-01T15:07:45Z", "message": "Switching error() calls to instead just throw the exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "087cf05ae1605289562fd923065af66f0cf174f3", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/087cf05ae1605289562fd923065af66f0cf174f3", "committedDate": "2020-03-01T15:08:38Z", "message": "Cleaning up the AbstractCommandLineParser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d2a18af47d027c4c1b0cee314da2b877474db6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/84d2a18af47d027c4c1b0cee314da2b877474db6", "committedDate": "2020-03-01T15:10:12Z", "message": "Cleaning up code in DedicatedServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51c1ca8497e80103cd44e9f6bb0f6f607943514f", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/51c1ca8497e80103cd44e9f6bb0f6f607943514f", "committedDate": "2020-03-01T15:13:26Z", "message": "Switching DedicatedServer to instead use MMLogger"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODg0OTEy", "url": "https://github.com/MegaMek/megamek/pull/1733#pullrequestreview-366884912", "createdAt": "2020-03-01T20:38:48Z", "commit": {"oid": "51c1ca8497e80103cd44e9f6bb0f6f607943514f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQyMDozODo0OFrOFwQCQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQyMDo0MDoyNVrOFwQCpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEzODY5MQ==", "bodyText": "Is that needed if we're calling System.exit below?", "url": "https://github.com/MegaMek/megamek/pull/1733#discussion_r386138691", "createdAt": "2020-03-01T20:38:48Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/MegaMek.java", "diffHunk": "@@ -121,23 +108,22 @@ public static void main(String[] args) {\n \n                 String interfaceName = cp.getGuiName();\n                 if (interfaceName == null) {\n-                    interfaceName = PreferenceManager.getClientPreferences()\n-                            .getGUIName();\n+                    interfaceName = PreferenceManager.getClientPreferences().getGUIName();\n                 }\n                 MegaMek.startGUI(interfaceName, restArgs);\n             }\n \n         } catch (CommandLineParser.ParseException e) {\n-            StringBuilder message = new StringBuilder(INCORRECT_ARGUMENTS_MESSAGE)\n-                    .append(e.getMessage()).append('\\n');\n-            message.append(ARGUMENTS_DESCRIPTION_MESSAGE);\n-            MegaMek.displayMessageAndExit(message.toString(),\n-                                          \"main(String[])\");\n+            String message = INCORRECT_ARGUMENTS_MESSAGE + e.getMessage() + '\\n'\n+                    + ARGUMENTS_DESCRIPTION_MESSAGE;\n+            getLogger().log(MegaMek.class, \"main(String[])\", LogLevel.INFO, message);\n+            TimerSingleton.getInstance().killTimer();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51c1ca8497e80103cd44e9f6bb0f6f607943514f"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEzODc4OQ==", "bodyText": "Is this really creating a directory called ./docs? Wouldn't it be ./logs?", "url": "https://github.com/MegaMek/megamek/pull/1733#discussion_r386138789", "createdAt": "2020-03-01T20:40:25Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/MegaMek.java", "diffHunk": "@@ -255,41 +242,43 @@ public static String getMegaMekSHA256() {\n     public static String getMemoryUsed() {\n         long heap = Runtime.getRuntime().totalMemory();\n         long free = Runtime.getRuntime().freeMemory();\n-        long used = (heap - free) / 1024;\n-        return commafy.format(used) + \" kB\"; //$NON-NLS-1$\n+        return commafy.format((heap - free) / 1024) + \" kB\";\n     }\n \n     /**\n      * This function redirects the standard error and output streams to the\n      * given File name.\n      *\n-     * @param logFileName\n-     *            The file name to redirect to.\n+     * @param logFileName The file name to redirect to.\n      */\n     private static void redirectOutput(String logFileName) {\n-        try {\n-            System.out.println(\"Redirecting output to \" + logFileName); //$NON-NLS-1$\n-            String sLogDir = PreferenceManager.getClientPreferences()\n-                    .getLogDirectory();\n-            File logDir = new File(sLogDir);\n-            if (!logDir.exists()) {\n-                logDir.mkdir();\n+        getLogger().info(MegaMek.class, \"redirectOutput\",\n+                \"Redirecting output to \" + logFileName);\n+        String sLogDir = PreferenceManager.getClientPreferences().getLogDirectory();\n+        File logDir = new File(sLogDir);\n+        if (!logDir.exists()) {\n+            if (!logDir.mkdir()) {\n+                getLogger().error(MegaMek.class, \"redirectOutput\",\n+                        \"Error in creating directory ./docs. We know this is annoying, and apologise. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51c1ca8497e80103cd44e9f6bb0f6f607943514f"}, "originalPosition": 262}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b", "committedDate": "2020-03-01T21:13:21Z", "message": "Applying review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjUxODUw", "url": "https://github.com/MegaMek/megamek/pull/1733#pullrequestreview-371651850", "createdAt": "2020-03-10T02:56:43Z", "commit": {"oid": "d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMjo1Njo0M1rOFz_7LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMjo1Njo0M1rOFz_7LA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA2OTAzNg==", "bodyText": "Why are you removing this (here and elsewhere)?", "url": "https://github.com/MegaMek/megamek/pull/1733#discussion_r390069036", "createdAt": "2020-03-10T02:56:43Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/MegaMek.java", "diffHunk": "@@ -73,33 +62,30 @@\n  * @author mev This is the class where the execution of the megamek game starts.\n  */\n public class MegaMek {\n+    private static MMLogger logger = null;\n \n-    private static final MMLogger logger = DefaultMmLogger.getInstance();\n-\n-    public static String VERSION = \"0.47.5-SNAPSHOT\"; //$NON-NLS-1$\n-    public static long TIMESTAMP = new File(PreferenceManager\n-            .getClientPreferences().getLogDirectory()\n-            + File.separator\n-            + \"timestamp\").lastModified(); //$NON-NLS-1$\n+    public static String VERSION = \"0.47.5-SNAPSHOT\";\n+    public static long TIMESTAMP = new File(PreferenceManager.getClientPreferences().getLogDirectory()\n+            + File.separator + \"timestamp\").lastModified();\n \n     private static final NumberFormat commafy = NumberFormat.getInstance();\n-    private static final String INCORRECT_ARGUMENTS_MESSAGE = \"Incorrect arguments:\"; //$NON-NLS-1$\n-    private static final String ARGUMENTS_DESCRIPTION_MESSAGE = \"Arguments syntax:\\n\\t MegaMek [-log <logfile>] [(-gui <guiname>)|(-dedicated)|(-validate)|(-export)|(-eqdb)|(-eqedb) (-oul)] [<args>]\"; //$NON-NLS-1$\n-    private static final String UNKNOWN_GUI_MESSAGE = \"Unknown GUI:\"; //$NON-NLS-1$\n-    private static final String GUI_CLASS_NOT_FOUND_MESSAGE = \"Couldn't find the GUI Class:\"; //$NON-NLS-1$\n-    private static final String DEFAULT_LOG_FILE_NAME = \"megameklog.txt\"; //$NON-NLS-1$\n+    private static final String INCORRECT_ARGUMENTS_MESSAGE = \"Incorrect arguments:\";\n+    private static final String ARGUMENTS_DESCRIPTION_MESSAGE = \"Arguments syntax:\\n\\t MegaMek \"\n+            + \"[-log <logfile>] [(-gui <guiname>)|(-dedicated)|(-validate)|(-export)|(-eqdb)|\"\n+            + \"(-eqedb) (-oul)] [<args>]\";\n+    private static final String UNKNOWN_GUI_MESSAGE = \"Unknown GUI:\";\n+    private static final String GUI_CLASS_NOT_FOUND_MESSAGE = \"Couldn't find the GUI Class:\";\n+    private static final String DEFAULT_LOG_FILE_NAME = \"megameklog.txt\";\n \n     public static void main(String[] args) {\n-\n         String logFileName = DEFAULT_LOG_FILE_NAME;\n-\n         CommandLineParser cp = new CommandLineParser(args);\n \n         try {\n             cp.parse();\n             String lf = cp.getLogFilename();\n             if (lf != null) {\n-                if (lf.equals(\"none\") || lf.equals(\"off\")) { //$NON-NLS-1$ //$NON-NLS-2$", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MzIyNzAw", "url": "https://github.com/MegaMek/megamek/pull/1733#pullrequestreview-376322700", "createdAt": "2020-03-17T19:01:20Z", "commit": {"oid": "d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxOTowMToyMFrOF3qChg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxOTowMToyMFrOF3qChg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzkwNDc3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        super.flush();getFD().sync();\n          \n          \n            \n                                        super.flush();\n          \n          \n            \n                                        getFD().sync();", "url": "https://github.com/MegaMek/megamek/pull/1733#discussion_r393904774", "createdAt": "2020-03-17T19:01:20Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/MegaMek.java", "diffHunk": "@@ -255,41 +239,43 @@ public static String getMegaMekSHA256() {\n     public static String getMemoryUsed() {\n         long heap = Runtime.getRuntime().totalMemory();\n         long free = Runtime.getRuntime().freeMemory();\n-        long used = (heap - free) / 1024;\n-        return commafy.format(used) + \" kB\"; //$NON-NLS-1$\n+        return commafy.format((heap - free) / 1024) + \" kB\";\n     }\n \n     /**\n      * This function redirects the standard error and output streams to the\n      * given File name.\n      *\n-     * @param logFileName\n-     *            The file name to redirect to.\n+     * @param logFileName The file name to redirect to.\n      */\n     private static void redirectOutput(String logFileName) {\n-        try {\n-            System.out.println(\"Redirecting output to \" + logFileName); //$NON-NLS-1$\n-            String sLogDir = PreferenceManager.getClientPreferences()\n-                    .getLogDirectory();\n-            File logDir = new File(sLogDir);\n-            if (!logDir.exists()) {\n-                logDir.mkdir();\n+        getLogger().info(MegaMek.class, \"redirectOutput\",\n+                \"Redirecting output to \" + logFileName);\n+        String sLogDir = PreferenceManager.getClientPreferences().getLogDirectory();\n+        File logDir = new File(sLogDir);\n+        if (!logDir.exists()) {\n+            if (!logDir.mkdir()) {\n+                getLogger().error(MegaMek.class, \"redirectOutput\",\n+                        \"Error in creating directory ./logs. We know this is annoying, and apologise. \"\n+                                + \"Please submit a bug report at https://github.com/MegaMek/megamek/issues \"\n+                                + \" and we will try to resolve your issue.\");\n             }\n+        }\n+        try {\n             PrintStream ps = new PrintStream(\n                     new BufferedOutputStream(new FileOutputStream(sLogDir\n-                                                                  + File.separator + logFileName, true) {\n+                            + File.separator + logFileName, true) {\n                         @Override\n                         public void flush() throws IOException {\n-                            super.flush();\n-                            getFD().sync();\n-                        };\n-                    }\n-                            , 64));\n+                            super.flush();getFD().sync();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9ad9d4dc8cb2959c911abca16c9b219e64e4d8b"}, "originalPosition": 279}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "552a52daf0a89f2625bab5d743ab757a6a2cb398", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/552a52daf0a89f2625bab5d743ab757a6a2cb398", "committedDate": "2020-03-28T01:52:14Z", "message": "Update megamek/src/megamek/MegaMek.java\r\n\r\nHow did I miss that on both reads... committed\n\nCo-Authored-By: Christopher Watford <christopher.watford@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1cc83da7ccb213aa578ba429139d4b763f000d6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/c1cc83da7ccb213aa578ba429139d4b763f000d6", "committedDate": "2020-03-31T03:25:50Z", "message": "Fixing merge conflic\nt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cec11dc7b7906c918a089cc5eb673f401f7d47db", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/cec11dc7b7906c918a089cc5eb673f401f7d47db", "committedDate": "2020-04-05T01:53:55Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "960607e9513886c68e2a0c3d68a99f98d196b5cf", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/960607e9513886c68e2a0c3d68a99f98d196b5cf", "committedDate": "2020-05-10T12:59:11Z", "message": "Merge branch 'master' into dev_Windchild_MMLogger"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MDk1NTAx", "url": "https://github.com/MegaMek/megamek/pull/1733#pullrequestreview-444095501", "createdAt": "2020-07-07T17:15:41Z", "commit": {"oid": "960607e9513886c68e2a0c3d68a99f98d196b5cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c255c86d4fbec3dc39b687901ac225f54fbfb0b", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/megamek/commit/5c255c86d4fbec3dc39b687901ac225f54fbfb0b", "committedDate": "2020-07-07T17:22:03Z", "message": "Fixing merge conflicts"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4584, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}