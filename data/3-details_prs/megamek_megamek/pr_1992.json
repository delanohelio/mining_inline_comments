{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI5MTc3OTk4", "number": 1992, "title": "Inclines and cliffs", "bodyText": "Adding incline & sheer cliff graphics and rules according to TO p.39.\n\n Implement hidden & automatic terrains in editor\n Add Saxarba gfx to saxarba tileset\n Add Saxarba gfx to hq_saxarba tileset\n Add GUI option\n Don't save automatic terrains\n Remove incline when cliff at the same exit\n Cliff rules: no backwards movement across sheer cliffs at all\n Cliff rules: Mechs up cliff: PSR, +1 for lvl1 cliff +2 for lvl2 cliff, if lost, nothing happens, MP lost\n Cliff rules: Mechs down cliff: PSR, +0 for lvl1 cliff +1 for lvl2 cliff, if lost, fall, movement over\n Cliff rules: Veh (exc VTOL/WIGE) up cliff: not possible;\n Cliff rules: up cliff WIGE: 1MP extra\n Cliff rules: Veh (exc VTOL/WIGE) down cliff: DSR, fail: Motive roll, move over;\n Cliff rules: down cliff VTOL/WIGE: no effect at all\n Cliff rules: Inf: Forbidden exc Mountaineer\n Order of PSRs when turning on pavement then walking up a cliff\n Climbing actions don't seem to be implemented in MM\n AO shadows only on cliffs and lvl2 incs\n Shorten lvl1 shadows\n show PSRs as danger in move paths\n Underwater cliffs, remove any underwater inclines for now\n Test QuadVees\n Test LAMs\n Test Hover\n Test Mechs\n Test VTOL, Aero, WIGE\n Spider in Water, cliff at water's edge, fails, now has 6 MP left but all moves illegal -> incorrect-> reproducible, maybe connected to not getting up in water after hull down fail\n Make inclines transparent in other tilesets\n\nOpen points:\n\nShould the inclines be added to other tilesets? Currently they are simply invisible in other tilesets and switching on the GUI Pref does not change anything except for a slight change of shadows.\nWhat do Protomechs do with cliffs?\nRoads across normal level changes do not change anything. Should roads across a cliff allow normal movement across the level change? (Making the cliff act as a normal level change)\nHovers can slip down 1 level without effect, 2 levels results in a fall. Should a skid/slip down a 1 level cliff result in a fall? Or an automatically failed PSR with motive damage chance (more along cliff rules)?", "createdAt": "2020-06-06T12:38:13Z", "url": "https://github.com/MegaMek/megamek/pull/1992", "merged": true, "mergeCommit": {"oid": "5f46d9cb1791144cb765fa5259e2f35454a6b8f0"}, "closed": true, "closedAt": "2020-07-31T14:41:46Z", "author": {"login": "SJuliez"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcg6QzDAH2gAyNDI5MTc3OTk4OjAwODNmNDM4ZDk2MTUwODQ3YzBkMmQ5NWQ0NjBkOWEyMTk0MTg1OWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc4FhP8gH2gAyNDI5MTc3OTk4OjBlOTc4OGMwZTM3YzEzNDU3YWM5MGI3Njc3ZDM5NjFjYTg3OWYxODM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0083f438d96150847c0d2d95d460d9a21941859a", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/0083f438d96150847c0d2d95d460d9a21941859a", "committedDate": "2020-05-13T15:04:30Z", "message": "Added incline terrain and test images"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef7fcefcaafe3b669bfe06c13482e284061b61f", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/3ef7fcefcaafe3b669bfe06c13482e284061b61f", "committedDate": "2020-05-13T18:31:16Z", "message": "Merge branch 'MM_master4' into SJ_Incline\n\nConflicts:\n\tmegamek/data/images/hexes/saxarba.tileset\n\tmegamek/src/megamek/common/Terrains.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08f9bff068d3849284bbc71e473d36ae92ed5e8b", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/08f9bff068d3849284bbc71e473d36ae92ed5e8b", "committedDate": "2020-05-18T19:08:55Z", "message": "Implementing Incline and Cliff gfx #1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f98454dfe1906968c5ae975ba447e9506b3bbd", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/27f98454dfe1906968c5ae975ba447e9506b3bbd", "committedDate": "2020-05-19T18:25:59Z", "message": "Implementing Incline and Cliff gfx #2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6774ede90941206585fa16a9a3e84c7a8514997", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/a6774ede90941206585fa16a9a3e84c7a8514997", "committedDate": "2020-05-19T18:26:50Z", "message": "Implementing Incline and Cliff gfx #3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04889b36d037263874b3945444cd46b11ac36def", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/04889b36d037263874b3945444cd46b11ac36def", "committedDate": "2020-05-23T06:57:53Z", "message": "Add high inclines, automatic handling for all, hide terrains in Editor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8162e50d0d9d0cd9c169e41c2cd99ead3822b105", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/8162e50d0d9d0cd9c169e41c2cd99ead3822b105", "committedDate": "2020-05-28T20:20:13Z", "message": "Implementing Cliffs&Inclines, rules effects, avoid saving auto terrain"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f0967718d02618425a3300d8f8ffb3463db0a13", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/9f0967718d02618425a3300d8f8ffb3463db0a13", "committedDate": "2020-05-31T12:49:58Z", "message": "Add incline graphics by Saxarba"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33aa606090b1d9de7e1e8bd785eb6cf9f877c82f", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/33aa606090b1d9de7e1e8bd785eb6cf9f877c82f", "committedDate": "2020-05-31T12:50:28Z", "message": "Implement sheer cliff rules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d5d6465a397cb80976bc50cd043b54219f5d01a", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/3d5d6465a397cb80976bc50cd043b54219f5d01a", "committedDate": "2020-05-31T12:54:55Z", "message": "Correct small mistake"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c04970c5f5350fe64533b5e33dac92f7b280efdd", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/c04970c5f5350fe64533b5e33dac92f7b280efdd", "committedDate": "2020-06-01T06:13:56Z", "message": "Merge branch 'MM_master_8' into SJ_Incline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13cba75d8746591441bf448bcdf4b21b3a51ebb3", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/13cba75d8746591441bf448bcdf4b21b3a51ebb3", "committedDate": "2020-06-01T08:58:37Z", "message": "Replace Tabs with spaces, Find PSRs in cliff steps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8319a863ce40eb2ca63579a68b7b279f6b39079c", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/8319a863ce40eb2ca63579a68b7b279f6b39079c", "committedDate": "2020-06-02T14:19:02Z", "message": "Add sheer cliff rules for infantry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d095923bbe96c1af674e150f5eb81d1460a5d12", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/5d095923bbe96c1af674e150f5eb81d1460a5d12", "committedDate": "2020-06-05T14:28:54Z", "message": "Add Infantry, refactor all the cliff tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db3b8280dc83a09885340cb150d079db6402f080", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/db3b8280dc83a09885340cb150d079db6402f080", "committedDate": "2020-06-05T21:20:41Z", "message": "Add GUIP setting for incline graphics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fd8b2ac3d2c28ce475092fca57b72850f0f7432", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/6fd8b2ac3d2c28ce475092fca57b72850f0f7432", "committedDate": "2020-06-05T21:24:21Z", "message": "Merge branch 'master10' into SJ_Incline\n\nConflicts:\n\tmegamek/src/megamek/client/ui/swing/HexTileset.java\n\tmegamek/src/megamek/common/Board.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5bb058d9d3706da790c6cd55b10260460df65bf", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/c5bb058d9d3706da790c6cd55b10260460df65bf", "committedDate": "2020-06-06T09:41:07Z", "message": "GUI Option for incline terrain"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2624d12c07a9f8680708d80ee048bfe9b24f9613", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/2624d12c07a9f8680708d80ee048bfe9b24f9613", "committedDate": "2020-06-06T13:49:07Z", "message": "Small changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "137feb7b877f147275cbcfa6a508857b73eaca23", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/137feb7b877f147275cbcfa6a508857b73eaca23", "committedDate": "2020-06-08T15:10:27Z", "message": "Merge branch 'master11' into SJ_Incline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c9a47c4f671a10242eb4283f62a44c692b26fb9", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/7c9a47c4f671a10242eb4283f62a44c692b26fb9", "committedDate": "2020-06-10T13:55:19Z", "message": "Adapt shadows to inc., add cliffs to tilesets, correct order of PSRs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57bf723520d3657f942b3633d35535f0c4a21db5", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/57bf723520d3657f942b3633d35535f0c4a21db5", "committedDate": "2020-06-10T14:41:43Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a40d13339d046aaddb178f498b1a41218f86869", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/3a40d13339d046aaddb178f498b1a41218f86869", "committedDate": "2020-06-12T05:31:34Z", "message": "ProtoMechs and cliffs, apply incline gfx to all tilesets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/d5ae66882841d64c9cd845de44f62960b8a21dcd", "committedDate": "2020-06-24T15:01:17Z", "message": "Roads cancel cliffs, acc. falls from cliffs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNzg5MjQ4", "url": "https://github.com/MegaMek/megamek/pull/1992#pullrequestreview-453789248", "createdAt": "2020-07-23T01:35:05Z", "commit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMTozNTowNVrOG15qtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMTozODoyN1rOG15t0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MjUzNA==", "bodyText": "Seems to me like this logic and the logic in SharedUtility.NagPSR should be unified somehow to avoid inconsistencies if/ when it needs to be updated. Keeping it in a distinct method will also allow it to be referenced by other code that may need it (e.g. the bot)", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459172534", "createdAt": "2020-07-23T01:35:05Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/Compute.java", "diffHunk": "@@ -548,6 +548,42 @@ public static boolean isPilotingSkillNeeded(IGame game, int entityId,\n                 && !isPavementStep) {\n             return true;\n         }\n+        \n+        // Sheer Cliffs, TO p.39\n+        // Roads over cliffs cancel the cliff effects for units that move on roads\n+        boolean quadveeVehMode = entity instanceof QuadVee ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MjcwMg==", "bodyText": "Normally I don't bother about white space formatting, but it looks like the tabs got completely clobbered here.", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459172702", "createdAt": "2020-07-23T01:35:43Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/Compute.java", "diffHunk": "@@ -3160,72 +3196,72 @@ public static float getExpectedDamage(IGame g, WeaponAttackAction waa,\n                         g.getEntity(waa.getTargetId()).getPosition());\n                 //Convert AV to fDamage for bay weapons, fighters, etc\n                 if (attacker.usesWeaponBays()){\n-                \tdouble av = 0;\n-                \tdouble threat = 1;\n+                    double av = 0;\n+                    double threat = 1;\n                     for (int wId : weapon.getBayWeapons()) {\n-                    \tMounted bayW = attacker.getEquipment(wId);\n-                    \tWeaponType bayWType = ((WeaponType) bayW.getType());\n-                \t//Capital weapons have a different range scale\n+                        Mounted bayW = attacker.getEquipment(wId);\n+                        WeaponType bayWType = ((WeaponType) bayW.getType());\n+                    //Capital weapons have a different range scale\n                         if (wt.isCapital()) {\n-                        \t// Capital missiles get higher priority than standard missiles:\n+                            // Capital missiles get higher priority than standard missiles:\n                             // damage plus a bonus for the critical hit threat they represent\n-                        \tthreat = 12;\n-                        \tif (rangeToTarget > 50) {\n-                \t\t\tav = 0;\n-                        \t} else if (rangeToTarget > 40) {\n-                \t\t\tav += bayWType.getExtAV();\n-                        \t} else if (rangeToTarget > 25) {\n-                \t\t\tav += bayWType.getLongAV();\n-                        \t} else if (rangeToTarget > 12) {\n-                \t\t\tav += bayWType.getMedAV();\n-                        \t} else {\n-                \t\t\tav += bayWType.getShortAV();\n-                        \t}\n+                            threat = 12;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 148}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3Mjc5Ng==", "bodyText": "Let's put a comment on this public method.", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459172796", "createdAt": "2020-07-23T01:36:12Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/Hex.java", "diffHunk": "@@ -590,20 +590,23 @@ public void getUnstuckModifier(int elev, PilotingRollData rollTarget) {\n             terrain.getUnstuckModifier(elev, rollTarget);\n         }\n     }\n+    \n+    public boolean hasCliffTopTowards(IHex otherHex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MjkyNw==", "bodyText": "Should probably uncomment these guys?", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459172927", "createdAt": "2020-07-23T01:36:34Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/MechSummaryCache.java", "diffHunk": "@@ -489,8 +489,8 @@ private boolean loadMechsFromDirectory(Vector<MechSummary> vMechs,\n             Set<String> sKnownFiles, long lLastCheck, File fDir,\n             boolean ignoreUnofficial) {\n         boolean bNeedsUpdate = false;\n-        loadReport.append(\"  Looking in \").append(fDir.getPath())\n-                .append(\"...\\n\");\n+//        loadReport.append(\"  Looking in \").append(fDir.getPath())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MzI0Mg==", "bodyText": "It looks like a triplication of the 'is this affected by a cliff' code, so yet another argument to consolidate that logic.", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459173242", "createdAt": "2020-07-23T01:38:01Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/MoveStep.java", "diffHunk": "@@ -3356,24 +3364,76 @@ public boolean isMovementPossible(IGame game, Coords src, int srcEl, CachedEntit\n                 return false;\n             }\n         }\n+        \n+        // Sheer Cliffs, TO p.39\n+        // Roads over cliffs cancel the cliff effects for units that move on roads\n+        boolean vehicleAffectedByCliff = entity instanceof Tank ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MzMyOQ==", "bodyText": "A quadruplication!", "url": "https://github.com/MegaMek/megamek/pull/1992#discussion_r459173329", "createdAt": "2020-07-23T01:38:27Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/server/Server.java", "diffHunk": "@@ -8720,6 +8721,69 @@ else if (bldgExited.equals(bldgEntered)\n                     }\n                 }\n             }\n+            \n+            // Sheer Cliffs, TO p.39\n+            boolean vehicleAffectedByCliff = entity instanceof Tank ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5ae66882841d64c9cd845de44f62960b8a21dcd"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6098c0995f6213e5c84c5ecf5cde918f22dd2d1", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/b6098c0995f6213e5c84c5ecf5cde918f22dd2d1", "committedDate": "2020-07-24T14:46:41Z", "message": "Formatting, correcting mistakes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e32f1f3bb46681396a585240acb0c83f443d43a7", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/e32f1f3bb46681396a585240acb0c83f443d43a7", "committedDate": "2020-07-24T14:50:29Z", "message": "Formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fe1c049709b78929bb977a8133f0eaadf94a647", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/6fe1c049709b78929bb977a8133f0eaadf94a647", "committedDate": "2020-07-24T15:01:06Z", "message": "Merge branch 'master17' into SJ_Incline\n\nConflicts:\n\tmegamek/data/images/hexes/bw_atmospheric.tileset\n\tmegamek/data/images/hexes/hq_atmospheric.tileset\n\tmegamek/data/images/hexes/hq_isometric.tileset\n\tmegamek/src/megamek/client/ui/swing/HexTileset.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e9788c0e37c13457ac90b7677d3961ca879f183", "author": {"user": {"login": "SJuliez", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/0e9788c0e37c13457ac90b7677d3961ca879f183", "committedDate": "2020-07-24T15:11:41Z", "message": "Switch grass and desert for the inclines"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4866, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}