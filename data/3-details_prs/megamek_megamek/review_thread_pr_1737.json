{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMzMxNTUz", "number": 1737, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMzozMDozMVrODlq3Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMzoyNTozOVrODmiMGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwODI2MTY3OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMzozMDozMVrOFysLfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwNDoyODo1NFrOFys2-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY5Njk1Nw==", "bodyText": "Consolidates mine clearing code into one place. I was going to have FAE code invoke it as well, but then realized that FAE probably can't clear minefields (the \"can I clear minefields\" code appears to imply that only standard munitions can clear mine fields)", "url": "https://github.com/MegaMek/megamek/pull/1737#discussion_r388696957", "createdAt": "2020-03-06T03:30:31Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -456,24 +448,30 @@ else if ((null != bestSpotter) && !(this instanceof ArtilleryWeaponDirectFireHan\n \n         // artillery may unintentially clear minefields, but only if it wasn't\n         // trying to\n-        if (!mineClear && game.containsMinefield(targetPos)) {\n-            Enumeration<Minefield> minefields = game.getMinefields(targetPos)\n-                    .elements();\n-            ArrayList<Minefield> mfRemoved = new ArrayList<Minefield>();\n-            while (minefields.hasMoreElements()) {\n-                Minefield mf = minefields.nextElement();\n-                if (server.clearMinefield(mf, ae, 10, vPhaseReport)) {\n-                    mfRemoved.add(mf);\n-                }\n-            }\n-            // we have to do it this way to avoid a concurrent error problem\n-            for (Minefield mf : mfRemoved) {\n-                server.removeMinefield(mf);\n-            }\n+        if (!mineClear) {\n+            clearMineFields(targetPos, Minefield.CLEAR_NUMBER_WEAPON_ACCIDENT, vPhaseReport);\n         }\n \n         return false;\n     }\n+    \n+    /**\n+     * Worker function that clears minefields.\n+     */\n+    private void clearMineFields(Coords targetPos, int targetNum, Vector<Report> vPhaseReport) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "090657ada3d36b88cb785603ff3c08ca6c76932e"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODcwMjIwMg==", "bodyText": "I checked with the rules team and FAE can clear minefields per the rules in TO. For all the hexes the FAE covers. So they are pretty good minesweepers.", "url": "https://github.com/MegaMek/megamek/pull/1737#discussion_r388702202", "createdAt": "2020-03-06T03:57:19Z", "author": {"login": "HammerGS"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -456,24 +448,30 @@ else if ((null != bestSpotter) && !(this instanceof ArtilleryWeaponDirectFireHan\n \n         // artillery may unintentially clear minefields, but only if it wasn't\n         // trying to\n-        if (!mineClear && game.containsMinefield(targetPos)) {\n-            Enumeration<Minefield> minefields = game.getMinefields(targetPos)\n-                    .elements();\n-            ArrayList<Minefield> mfRemoved = new ArrayList<Minefield>();\n-            while (minefields.hasMoreElements()) {\n-                Minefield mf = minefields.nextElement();\n-                if (server.clearMinefield(mf, ae, 10, vPhaseReport)) {\n-                    mfRemoved.add(mf);\n-                }\n-            }\n-            // we have to do it this way to avoid a concurrent error problem\n-            for (Minefield mf : mfRemoved) {\n-                server.removeMinefield(mf);\n-            }\n+        if (!mineClear) {\n+            clearMineFields(targetPos, Minefield.CLEAR_NUMBER_WEAPON_ACCIDENT, vPhaseReport);\n         }\n \n         return false;\n     }\n+    \n+    /**\n+     * Worker function that clears minefields.\n+     */\n+    private void clearMineFields(Coords targetPos, int targetNum, Vector<Report> vPhaseReport) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY5Njk1Nw=="}, "originalCommit": {"oid": "090657ada3d36b88cb785603ff3c08ca6c76932e"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODcwODA4OQ==", "bodyText": "Ok, I'll make the necessary changes.", "url": "https://github.com/MegaMek/megamek/pull/1737#discussion_r388708089", "createdAt": "2020-03-06T04:28:54Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -456,24 +448,30 @@ else if ((null != bestSpotter) && !(this instanceof ArtilleryWeaponDirectFireHan\n \n         // artillery may unintentially clear minefields, but only if it wasn't\n         // trying to\n-        if (!mineClear && game.containsMinefield(targetPos)) {\n-            Enumeration<Minefield> minefields = game.getMinefields(targetPos)\n-                    .elements();\n-            ArrayList<Minefield> mfRemoved = new ArrayList<Minefield>();\n-            while (minefields.hasMoreElements()) {\n-                Minefield mf = minefields.nextElement();\n-                if (server.clearMinefield(mf, ae, 10, vPhaseReport)) {\n-                    mfRemoved.add(mf);\n-                }\n-            }\n-            // we have to do it this way to avoid a concurrent error problem\n-            for (Minefield mf : mfRemoved) {\n-                server.removeMinefield(mf);\n-            }\n+        if (!mineClear) {\n+            clearMineFields(targetPos, Minefield.CLEAR_NUMBER_WEAPON_ACCIDENT, vPhaseReport);\n         }\n \n         return false;\n     }\n+    \n+    /**\n+     * Worker function that clears minefields.\n+     */\n+    private void clearMineFields(Coords targetPos, int targetNum, Vector<Report> vPhaseReport) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY5Njk1Nw=="}, "originalCommit": {"oid": "090657ada3d36b88cb785603ff3c08ca6c76932e"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwODI2MzAxOnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMzozMToyOFrOFysMOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMzozMToyOFrOFysMOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY5NzE0Ng==", "bodyText": "The \"contains minefield\" check was redundant.", "url": "https://github.com/MegaMek/megamek/pull/1737#discussion_r388697146", "createdAt": "2020-03-06T03:31:28Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -461,24 +448,30 @@ else if ((null != bestSpotter) && !(this instanceof ArtilleryWeaponDirectFireHan\n \n         // artillery may unintentially clear minefields, but only if it wasn't\n         // trying to\n-        if (!mineClear && game.containsMinefield(targetPos)) {\n-            Enumeration<Minefield> minefields = game.getMinefields(targetPos)\n-                    .elements();\n-            ArrayList<Minefield> mfRemoved = new ArrayList<Minefield>();\n-            while (minefields.hasMoreElements()) {\n-                Minefield mf = minefields.nextElement();\n-                if (server.clearMinefield(mf, ae, 10, vPhaseReport)) {\n-                    mfRemoved.add(mf);\n-                }\n-            }\n-            // we have to do it this way to avoid a concurrent error problem\n-            for (Minefield mf : mfRemoved) {\n-                server.removeMinefield(mf);\n-            }\n+        if (!mineClear) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "090657ada3d36b88cb785603ff3c08ca6c76932e"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNzMyNjM1OnYy", "diffSide": "LEFT", "path": "megamek/src/megamek/common/AmmoType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMzoyNTozOVrOF0AW2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMzoyNTozOVrOF0AW2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA3NjEyMQ==", "bodyText": "It would be helpful to add a comment here that 62 is already in use, as is done elsewhere that the numbers are out of order.", "url": "https://github.com/MegaMek/megamek/pull/1737#discussion_r390076121", "createdAt": "2020-03-10T03:25:39Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/AmmoType.java", "diffHunk": "@@ -333,9 +333,11 @@\n     \n     // More SRM+LRM Munitions types\n     public static final long M_MINE_CLEARANCE = 1l << 61;\n+    \n+    public static final long M_FAE = 1l << 63;\n   \n   \n-    // Numbers 62-63 are used for Nuclear munitions, above ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f0864b81d43d03b580b69ac69841b88eaf74f53"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2514, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}