{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNjM0ODU5", "number": 2518, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMjo0MFrOFHQPyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMjo0MFrOFHQPyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMTUwNTM5OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/AmmoType.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMjo0MFrOIIpqAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyNjo1MFrOIIpzoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0MjAxOA==", "bodyText": "Can't look at it right now, what's the final logic block look like at the bottom that's returned? The one that's like \"(mmlAmmoMatch || lbxAmmoMatch || ammoOfSameType) && !mismatch", "url": "https://github.com/MegaMek/megamek/pull/2518#discussion_r545942018", "createdAt": "2020-12-18T16:22:40Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/AmmoType.java", "diffHunk": "@@ -15897,17 +15897,16 @@ public static boolean canSwitchToAmmo(Mounted weapon, AmmoType otherAmmo) {\n         \n         AmmoType currentAmmoType = (AmmoType) weapon.getLinked().getType();\n         \n-        boolean ammoOfSameType = currentAmmoType.equals(otherAmmo);\n+        boolean ammoOfSameType = currentAmmoType.equalsAmmoTypeOnly(otherAmmo)\n+                && (currentAmmoType.getRackSize() == otherAmmo.getRackSize());\n         \n         // MMLs can swap between different specific ammo types, so we have a special case check here\n-        boolean mmlAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_MML &&\n-                otherAmmo.getAmmoType() == AmmoType.T_MML &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean mmlAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_MML)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_MML);\n         \n         // LBXs can swap between cluster and slug ammo types\n-        boolean lbxAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX &&\n-                otherAmmo.getAmmoType() == AmmoType.T_AC_LBX &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean lbxAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_AC_LBX);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0NDIxMg==", "bodyText": "You can't even view it on GH its too large...oy.\n    /**\n     * Whether the given weapon can switch to the given ammo type\n     * @param weapon The weapon being considered\n     * @param otherAmmo The other ammo type being considered\n     * @return true/false - null arguments or linked ammo bin for the weapon result in false\n     */\n    public static boolean canSwitchToAmmo(Mounted weapon, AmmoType otherAmmo) {\n        if((weapon == null) ||\n                (weapon.getLinked() == null) ||\n                (otherAmmo == null)) {\n            return false;\n        }\n        \n        AmmoType currentAmmoType = (AmmoType) weapon.getLinked().getType();\n        \n        boolean ammoOfSameType = currentAmmoType.equalsAmmoTypeOnly(otherAmmo)\n                && (currentAmmoType.getRackSize() == otherAmmo.getRackSize());\n        \n        // MMLs can swap between different specific ammo types, so we have a special case check here\n        boolean mmlAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_MML)\n                && (otherAmmo.getAmmoType() == AmmoType.T_MML);\n        \n        // LBXs can swap between cluster and slug ammo types\n        boolean lbxAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX)\n                && (otherAmmo.getAmmoType() == AmmoType.T_AC_LBX);\n        \n        boolean caselessLoaded = currentAmmoType.getMunitionType() == AmmoType.M_CASELESS;\n        boolean otherBinCaseless = otherAmmo.getMunitionType() == AmmoType.M_CASELESS;\n        boolean caselessMismatch = caselessLoaded != otherBinCaseless;\n        \n        boolean hasStaticFeed = weapon.hasQuirk(OptionsConstants.QUIRK_WEAP_NEG_STATIC_FEED);\n        boolean staticFeedMismatch = hasStaticFeed && (currentAmmoType.getMunitionType() != otherAmmo.getMunitionType());\n        \n        return (ammoOfSameType || mmlAmmoMatch || lbxAmmoMatch) && !caselessMismatch && !staticFeedMismatch;\n    }", "url": "https://github.com/MegaMek/megamek/pull/2518#discussion_r545944212", "createdAt": "2020-12-18T16:26:24Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/AmmoType.java", "diffHunk": "@@ -15897,17 +15897,16 @@ public static boolean canSwitchToAmmo(Mounted weapon, AmmoType otherAmmo) {\n         \n         AmmoType currentAmmoType = (AmmoType) weapon.getLinked().getType();\n         \n-        boolean ammoOfSameType = currentAmmoType.equals(otherAmmo);\n+        boolean ammoOfSameType = currentAmmoType.equalsAmmoTypeOnly(otherAmmo)\n+                && (currentAmmoType.getRackSize() == otherAmmo.getRackSize());\n         \n         // MMLs can swap between different specific ammo types, so we have a special case check here\n-        boolean mmlAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_MML &&\n-                otherAmmo.getAmmoType() == AmmoType.T_MML &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean mmlAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_MML)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_MML);\n         \n         // LBXs can swap between cluster and slug ammo types\n-        boolean lbxAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX &&\n-                otherAmmo.getAmmoType() == AmmoType.T_AC_LBX &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean lbxAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_AC_LBX);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0MjAxOA=="}, "originalCommit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0NDQ4MA==", "bodyText": "Hell I missed the rack size fix, let me add that back.", "url": "https://github.com/MegaMek/megamek/pull/2518#discussion_r545944480", "createdAt": "2020-12-18T16:26:50Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/AmmoType.java", "diffHunk": "@@ -15897,17 +15897,16 @@ public static boolean canSwitchToAmmo(Mounted weapon, AmmoType otherAmmo) {\n         \n         AmmoType currentAmmoType = (AmmoType) weapon.getLinked().getType();\n         \n-        boolean ammoOfSameType = currentAmmoType.equals(otherAmmo);\n+        boolean ammoOfSameType = currentAmmoType.equalsAmmoTypeOnly(otherAmmo)\n+                && (currentAmmoType.getRackSize() == otherAmmo.getRackSize());\n         \n         // MMLs can swap between different specific ammo types, so we have a special case check here\n-        boolean mmlAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_MML &&\n-                otherAmmo.getAmmoType() == AmmoType.T_MML &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean mmlAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_MML)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_MML);\n         \n         // LBXs can swap between cluster and slug ammo types\n-        boolean lbxAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX &&\n-                otherAmmo.getAmmoType() == AmmoType.T_AC_LBX &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean lbxAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_AC_LBX);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0MjAxOA=="}, "originalCommit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2559, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}