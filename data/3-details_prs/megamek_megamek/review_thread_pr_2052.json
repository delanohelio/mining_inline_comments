{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0OTExODEx", "number": 2052, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxODowMTowNVrOELyhkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxODowNDozOFrOELymdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzk3NTg1OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/templates/InfantryTROView.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxODowMTowNlrOGthr2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxOTozNjo1NFrOGtkmEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM5MTAwMw==", "bodyText": "Yikes.", "url": "https://github.com/MegaMek/megamek/pull/2052#discussion_r450391003", "createdAt": "2020-07-06T18:01:06Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/templates/InfantryTROView.java", "diffHunk": "@@ -226,10 +226,8 @@ private void addAugmentationNotes(List<String> notes) {\n         }\n         if (!options.isEmpty()) {\n             notes.add(Messages.getString(\"TROView.InfantryNote.Augmented\"));\n-            options.forEach(o -> {\n-                notes.add(o.getDisplayableName().replaceAll(\"\\\\s+\\\\(Not Implemn?ented\\\\)\", \"\") + \": \"\n-                        + o.getDescription().replaceAll(\"See IO.*\", \"\"));\n-            });\n+            options.forEach(o -> notes.add(o.getDisplayableName().replaceAll(\"\\\\s+\\\\(Not Implemented\\\\)\", \"\") + \": \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b13737d9da6246c72c549bdca51213fd6d98f55"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQzODY3Mg==", "bodyText": "I was lazy the first time around and accounted for the spelling error rather that fixing it.", "url": "https://github.com/MegaMek/megamek/pull/2052#discussion_r450438672", "createdAt": "2020-07-06T19:36:54Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/templates/InfantryTROView.java", "diffHunk": "@@ -226,10 +226,8 @@ private void addAugmentationNotes(List<String> notes) {\n         }\n         if (!options.isEmpty()) {\n             notes.add(Messages.getString(\"TROView.InfantryNote.Augmented\"));\n-            options.forEach(o -> {\n-                notes.add(o.getDisplayableName().replaceAll(\"\\\\s+\\\\(Not Implemn?ented\\\\)\", \"\") + \": \"\n-                        + o.getDescription().replaceAll(\"See IO.*\", \"\"));\n-            });\n+            options.forEach(o -> notes.add(o.getDisplayableName().replaceAll(\"\\\\s+\\\\(Not Implemented\\\\)\", \"\") + \": \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM5MTAwMw=="}, "originalCommit": {"oid": "5b13737d9da6246c72c549bdca51213fd6d98f55"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzk4ODM2OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/templates/TROView.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxODowNDozOFrOGthznw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxOTo0ODozNlrOGtk7AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM5Mjk5MQ==", "bodyText": "The name variable appears to get overwritten if the equipment is not ammo but takes up more than one slot?", "url": "https://github.com/MegaMek/megamek/pull/2052#discussion_r450392991", "createdAt": "2020-07-06T18:04:38Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/templates/TROView.java", "diffHunk": "@@ -439,26 +429,30 @@ protected int addEquipment(Entity entity, boolean includeAmmo) {\n             if (m.isOmniPodMounted() || !entity.isOmni()) {\n                 final String loc = formatLocationTableEntry(entity, m);\n                 equipment.putIfAbsent(loc, new HashMap<>());\n-                equipment.get(loc).merge(m.getType(), 1, Integer::sum);\n+                equipment.get(loc).merge(new EquipmentKey(m.getType(), m.getSize(), m.isArmored()),\n+                        1, Integer::sum);\n             }\n         }\n         final List<Map<String, Object>> eqList = new ArrayList<>();\n         for (final String loc : equipment.keySet()) {\n-            for (final Map.Entry<EquipmentType, Integer> entry : equipment.get(loc).entrySet()) {\n-                final EquipmentType eq = entry.getKey();\n-                final int count = equipment.get(loc).get(eq);\n-                String name = stripNotes(eq.getName());\n+            for (final Map.Entry<EquipmentKey, Integer> entry : equipment.get(loc).entrySet()) {\n+                final EquipmentType eq = entry.getKey().getType();\n+                final int count = equipment.get(loc).get(entry.getKey());\n+                String name = stripNotes(entry.getKey().name());\n+                if (entry.getKey().isArmored()) {\n+                    name += \" (Armored)\";\n+                }\n                 if (eq instanceof AmmoType) {\n                     name = String.format(\"%s (%d)\", name, ((AmmoType) eq).getShots() * count);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b13737d9da6246c72c549bdca51213fd6d98f55"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ0NDAzMg==", "bodyText": "Actually it's if there's more than one of them. It adds the count and appends an 's' to the name. But the formation of a plural is not correct in cases where the equipment name itself ends in 's' and the possible addition of \"(Armored)\" throws it off in any case. So I removed the grammatical inflection as well as including the armored tag.", "url": "https://github.com/MegaMek/megamek/pull/2052#discussion_r450444032", "createdAt": "2020-07-06T19:48:36Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/templates/TROView.java", "diffHunk": "@@ -439,26 +429,30 @@ protected int addEquipment(Entity entity, boolean includeAmmo) {\n             if (m.isOmniPodMounted() || !entity.isOmni()) {\n                 final String loc = formatLocationTableEntry(entity, m);\n                 equipment.putIfAbsent(loc, new HashMap<>());\n-                equipment.get(loc).merge(m.getType(), 1, Integer::sum);\n+                equipment.get(loc).merge(new EquipmentKey(m.getType(), m.getSize(), m.isArmored()),\n+                        1, Integer::sum);\n             }\n         }\n         final List<Map<String, Object>> eqList = new ArrayList<>();\n         for (final String loc : equipment.keySet()) {\n-            for (final Map.Entry<EquipmentType, Integer> entry : equipment.get(loc).entrySet()) {\n-                final EquipmentType eq = entry.getKey();\n-                final int count = equipment.get(loc).get(eq);\n-                String name = stripNotes(eq.getName());\n+            for (final Map.Entry<EquipmentKey, Integer> entry : equipment.get(loc).entrySet()) {\n+                final EquipmentType eq = entry.getKey().getType();\n+                final int count = equipment.get(loc).get(entry.getKey());\n+                String name = stripNotes(entry.getKey().name());\n+                if (entry.getKey().isArmored()) {\n+                    name += \" (Armored)\";\n+                }\n                 if (eq instanceof AmmoType) {\n                     name = String.format(\"%s (%d)\", name, ((AmmoType) eq).getShots() * count);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM5Mjk5MQ=="}, "originalCommit": {"oid": "5b13737d9da6246c72c549bdca51213fd6d98f55"}, "originalPosition": 67}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2848, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}