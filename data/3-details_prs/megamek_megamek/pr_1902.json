{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExMDY4NTc1", "number": 1902, "title": "Variable equipment size, part 1", "bodyText": "This is a change I've been putting off for a while because of its potential to have hidden side effects, but there's some equipment that won't match the construction rules without it. It affects items that have a variable size or weight. So far we have taken two approaches:\n\nWhere the weight is a linear progression, we have created an EquipmentType instance for each possible value. This includes cargo for mechs, communications equipment, and ladders. It fails for BA mission equipment, which does not come in discrete sizes, making it impossible to create or modify a unit with a size other than the two we have created for canon units.\nWhere the weight is non-linear, we have created one EquipmentType instance for the base unit and an additional instance for expanded capacity. The two current examples are the drone (remote) control console and MASH equipment. Two drone control systems, ATAC and DTAC, have the base units implemented but no ability yet to expand the number of drones they can control. While this system works adequately for the most part, it is non-intuitive for designing units in MML and there is no way to determine which base unit the expanded capacity instance goes with, if there is more than one. The rules for the DCCS explicitly allow multiples on the unit, though no canon unit has them.\n\nTo rework this I broadened the use of the ammoCapacity field of Mounted, currently used for weapon bay ammo bin size, for use with any variable-sized equipment. I added new methods to access the name and cost of the item through Mounted to be able to account for the size. Many of the files that were changed were a result of replacing EquipmentType#getName with Mounted#getName where it made sense to do so. The extra drone/MASH theater instances have been removed, and I added code in the unit loaders to handle legacy entries.\nThis is the first phase, and deals with DCCS, MASH, ATAC, and DTAC. Some of the code is in place for handling the equipment listed under #1 above for illustration purposes, but as this change is fairly broad I wanted to limit it. This also does not show the equipment capacity in the TRO summaries. That required some more involved changes, which I worked on in a separate branch.\nThere will be accompanying MML and MekHQ PRs.", "createdAt": "2020-04-30T01:51:46Z", "url": "https://github.com/MegaMek/megamek/pull/1902", "merged": true, "mergeCommit": {"oid": "88d881f347f1402c6b5980a96609d3255e524504"}, "closed": true, "closedAt": "2020-05-13T11:45:29Z", "author": {"login": "neoancient"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccG9SWAH2gAyNDExMDY4NTc1OjY2Y2U3NTU0M2U5NmYwMzFlMzU2ZTI3ODI4OWQ5N2YxZjcxNTQxNjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfRswCAFqTQwODIyODk5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "66ce75543e96f031e356e278289d97f1f7154161", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/66ce75543e96f031e356e278289d97f1f7154161", "committedDate": "2020-04-28T17:02:20Z", "message": "Changed ammoCapacity field to a more generic size field."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73e67ac2e543a8584f475b353f192fc0d6df5635", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/73e67ac2e543a8584f475b353f192fc0d6df5635", "committedDate": "2020-04-28T18:26:21Z", "message": "Use Mounted#size for determining weight, cost, and name of drone systems and MASH."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac092ea3e2e24d5d180adfc611d291ffd0a0bf58", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/ac092ea3e2e24d5d180adfc611d291ffd0a0bf58", "committedDate": "2020-04-28T20:13:37Z", "message": "Removed drone and MASH extra equipment and repurposed their flags."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e3dd59be3d89d5cf8ab687804649ac13c0bbe66", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/2e3dd59be3d89d5cf8ab687804649ac13c0bbe66", "committedDate": "2020-04-28T21:18:09Z", "message": "Include equipment size in mount name and description."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6fb536b5eddfe874a1efa9aa6b8e801fd34852d", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/d6fb536b5eddfe874a1efa9aa6b8e801fd34852d", "committedDate": "2020-04-29T05:57:12Z", "message": "Add MASH variable size weight and cost calculations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83b038cb7524d1ee07d91b56ea4a434854bf5881", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/83b038cb7524d1ee07d91b56ea4a434854bf5881", "committedDate": "2020-04-29T06:14:05Z", "message": "Legacy support extra drone and extra mash in aerospace loaders."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ded223465c502768b774650205cbedb140ae756", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/2ded223465c502768b774650205cbedb140ae756", "committedDate": "2020-04-29T06:17:16Z", "message": "Shortname fields for ATAC and DTAC."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7687c87e949f3fc4dd6b554d5ddb379797ec0b5a", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/7687c87e949f3fc4dd6b554d5ddb379797ec0b5a", "committedDate": "2020-04-29T20:54:36Z", "message": "Save and load size field to and from the unit file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de7a0abe13374a213a81b86efe50d143b6b366a5", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/de7a0abe13374a213a81b86efe50d143b6b366a5", "committedDate": "2020-04-30T01:12:47Z", "message": "Use a spinner to edit the size column on the equipment tab."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96edd65edf569f7c8f75a77a2a6e997e23821bbd", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/96edd65edf569f7c8f75a77a2a6e997e23821bbd", "committedDate": "2020-04-30T01:13:51Z", "message": "Fix DTAC weight calculation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18ebc4d5e44fe8d39f14d1b76880c0db160ca28f", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/18ebc4d5e44fe8d39f14d1b76880c0db160ca28f", "committedDate": "2020-05-07T21:08:54Z", "message": "Merge remote-tracking branch 'origin/master' into variable_equipment_size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3ODc1MjU3", "url": "https://github.com/MegaMek/megamek/pull/1902#pullrequestreview-407875257", "createdAt": "2020-05-07T22:15:52Z", "commit": {"oid": "18ebc4d5e44fe8d39f14d1b76880c0db160ca28f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMjoxNTo1MlrOGSSOHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMjoxNTo1MlrOGSSOHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgyNjA3Nw==", "bodyText": "Missing the format argument.", "url": "https://github.com/MegaMek/megamek/pull/1902#discussion_r421826077", "createdAt": "2020-05-07T22:15:52Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/MiscType.java", "diffHunk": "@@ -435,13 +434,51 @@ public double getDamageDivisor() {\n         return damageDivisor;\n     }\n \n+    private String sizeSuffix(double size) {\n+        if (hasFlag(F_VARIABLE_SIZE)) {\n+            if (hasFlag(MiscType.F_DRONE_CARRIER_CONTROL)\n+                    || hasFlag(MiscType.F_ATAC) || hasFlag(MiscType.F_DTAC)) {\n+                return String.format(\" (%d %s)\", (int) size, size > 1 ?\n+                        Messages.getString(\"MiscType.drones\") :\n+                        Messages.getString(\"MiscType.drone\"));\n+            } else if (hasFlag(MiscType.F_MASH)) {\n+                return String.format(\" (%d %s)\", (int) size, size > 1 ?\n+                        Messages.getString(\"MiscType.theaters\") :\n+                        Messages.getString(\"MiscType.theater\"));\n+            } else if (hasFlag(MiscType.F_LADDER)) {\n+                return String.format(\" (%d m\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18ebc4d5e44fe8d39f14d1b76880c0db160ca28f"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "279639ff06e949bb413d688da6f7fae9f46485a8", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/279639ff06e949bb413d688da6f7fae9f46485a8", "committedDate": "2020-05-07T22:30:48Z", "message": "Added missing format argument."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50d5f0f6680650140ec20929e47e46cf8f0ac857", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/50d5f0f6680650140ec20929e47e46cf8f0ac857", "committedDate": "2020-05-07T22:31:52Z", "message": "Make narrowing in assignment explicit."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MjI4OTk4", "url": "https://github.com/MegaMek/megamek/pull/1902#pullrequestreview-408228998", "createdAt": "2020-05-08T13:15:00Z", "commit": {"oid": "50d5f0f6680650140ec20929e47e46cf8f0ac857"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4821, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}