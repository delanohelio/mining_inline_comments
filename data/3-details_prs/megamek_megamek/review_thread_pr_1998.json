{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNTQ4OTY1", "number": 1998, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMToxMDoxNFrOED0vhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0MToyNlrOEFl3Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNDQ1MzE2OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/MULParser.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMToxMDoxNFrOGhEXdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNzoyMjozNVrOGhUtng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzMyNzczMg==", "bodyText": "If they have a GUNNERY attribute that is valid, when this falls thru you won't receive any helpful message. You'll just silently use the value from that attribute.", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r437327732", "createdAt": "2020-06-09T11:10:14Z", "author": {"login": "sixlettervariables"}, "path": "megamek/src/megamek/common/MULParser.java", "diffHunk": "@@ -1062,23 +1062,82 @@ private void setCrewAttributes(Crew crew, Map<String,String> attributes, Entity\n      * @param attributes A map of attribute values keyed to the attribute names.\n      */\n     private void setPilotAttributes(Crew crew, int slot, Map<String, String> attributes) {\n+        boolean hasGun = attributes.containsKey(GUNNERY) && (attributes.get(GUNNERY).length() > 0);\n+        boolean hasRpgGun = attributes.containsKey(GUNNERYL) && (attributes.get(GUNNERYL).length() > 0) &&\n+                attributes.containsKey(GUNNERYM) && (attributes.get(GUNNERYM).length() > 0) &&\n+                attributes.containsKey(GUNNERYB) && (attributes.get(GUNNERYB).length() > 0);\n+\n         // Did we find required attributes?\n-        if (!attributes.containsKey(GUNNERY) || (attributes.get(GUNNERY).length() == 0)) {\n+        if (!hasGun && !hasRpgGun) {\n             warning.append(\"Could not find gunnery for pilot.\\n\");\n         } else if (!attributes.containsKey(PILOTING) || (attributes.get(PILOTING).length() == 0)) {\n             warning.append(\"Could not find piloting for pilot.\\n\");\n         } else {\n             // Try to get a good gunnery value.\n             int gunVal = -1;\n-            try {\n-                gunVal = Integer.parseInt(attributes.get(GUNNERY));\n-            } catch (NumberFormatException ignored) {\n-                // Handled by the next if test.\n+            if (hasGun) {\n+                try {\n+                    gunVal = Integer.parseInt(attributes.get(GUNNERY));\n+                } catch (NumberFormatException ignored) {\n+                    // Handled by the next if test.\n+                }\n+\n+                if ((gunVal < 0)\n+                        || (gunVal > Crew.MAX_SKILL)) {\n+                    warning.append(\"Found invalid gunnery value: \")\n+                            .append(attributes.get(GUNNERY)).append(\".\\n\");\n+                    return;\n+                }\n             }\n-            if ((gunVal < 0) || (gunVal > Crew.MAX_SKILL)) {\n-                warning.append(\"Found invalid gunnery value: \")\n-                        .append(attributes.get(GUNNERY)).append(\".\\n\");\n-                return;\n+\n+            // get RPG skills\n+            int gunneryLVal = gunVal;\n+            int gunneryMVal = gunVal;\n+            int gunneryBVal = gunVal;\n+            if (hasRpgGun) {\n+                if ((attributes.containsKey(GUNNERYL)) && (attributes.get(GUNNERYL).length() > 0)) {\n+                    try {\n+                        gunneryLVal = Integer.parseInt(attributes.get(GUNNERYL));\n+                    } catch (NumberFormatException ignored) {\n+                        // Handled by the next if test.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f798e78d5d107aebd60c249c5a4e0c47b73cb048"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5NTU1MA==", "bodyText": "Updated", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r437595550", "createdAt": "2020-06-09T17:22:35Z", "author": {"login": "sagnam"}, "path": "megamek/src/megamek/common/MULParser.java", "diffHunk": "@@ -1062,23 +1062,82 @@ private void setCrewAttributes(Crew crew, Map<String,String> attributes, Entity\n      * @param attributes A map of attribute values keyed to the attribute names.\n      */\n     private void setPilotAttributes(Crew crew, int slot, Map<String, String> attributes) {\n+        boolean hasGun = attributes.containsKey(GUNNERY) && (attributes.get(GUNNERY).length() > 0);\n+        boolean hasRpgGun = attributes.containsKey(GUNNERYL) && (attributes.get(GUNNERYL).length() > 0) &&\n+                attributes.containsKey(GUNNERYM) && (attributes.get(GUNNERYM).length() > 0) &&\n+                attributes.containsKey(GUNNERYB) && (attributes.get(GUNNERYB).length() > 0);\n+\n         // Did we find required attributes?\n-        if (!attributes.containsKey(GUNNERY) || (attributes.get(GUNNERY).length() == 0)) {\n+        if (!hasGun && !hasRpgGun) {\n             warning.append(\"Could not find gunnery for pilot.\\n\");\n         } else if (!attributes.containsKey(PILOTING) || (attributes.get(PILOTING).length() == 0)) {\n             warning.append(\"Could not find piloting for pilot.\\n\");\n         } else {\n             // Try to get a good gunnery value.\n             int gunVal = -1;\n-            try {\n-                gunVal = Integer.parseInt(attributes.get(GUNNERY));\n-            } catch (NumberFormatException ignored) {\n-                // Handled by the next if test.\n+            if (hasGun) {\n+                try {\n+                    gunVal = Integer.parseInt(attributes.get(GUNNERY));\n+                } catch (NumberFormatException ignored) {\n+                    // Handled by the next if test.\n+                }\n+\n+                if ((gunVal < 0)\n+                        || (gunVal > Crew.MAX_SKILL)) {\n+                    warning.append(\"Found invalid gunnery value: \")\n+                            .append(attributes.get(GUNNERY)).append(\".\\n\");\n+                    return;\n+                }\n             }\n-            if ((gunVal < 0) || (gunVal > Crew.MAX_SKILL)) {\n-                warning.append(\"Found invalid gunnery value: \")\n-                        .append(attributes.get(GUNNERY)).append(\".\\n\");\n-                return;\n+\n+            // get RPG skills\n+            int gunneryLVal = gunVal;\n+            int gunneryMVal = gunVal;\n+            int gunneryBVal = gunVal;\n+            if (hasRpgGun) {\n+                if ((attributes.containsKey(GUNNERYL)) && (attributes.get(GUNNERYL).length() > 0)) {\n+                    try {\n+                        gunneryLVal = Integer.parseInt(attributes.get(GUNNERYL));\n+                    } catch (NumberFormatException ignored) {\n+                        // Handled by the next if test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzMyNzczMg=="}, "originalCommit": {"oid": "f798e78d5d107aebd60c249c5a4e0c47b73cb048"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTM1Nzc0OnYy", "diffSide": "LEFT", "path": "megamek/i18n/megamek/client/messages.properties", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjowMDowM1rOGiwRNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNjozNTo1MFrOGj6Aew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA5NTYwNQ==", "bodyText": "Why is this being renamed from L to E? (Please note that this is being asked primarily because I have never played the MechWarrior RPG, so I'm not sure how it is handled there)", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r439095605", "createdAt": "2020-06-11T22:00:03Z", "author": {"login": "Windchild292"}, "path": "megamek/i18n/megamek/client/messages.properties", "diffHunk": "@@ -2970,7 +2969,7 @@ WeaponAttackAction.GoldenGoose=Golden Goose\n WeaponAttackAction.GunnerHit=gunner incapacitated\n WeaponAttackAction.GunSkill=gunnery skill\n WeaponAttackAction.GunBSkill=gunnery (B) skill\n-WeaponAttackAction.GunESkill=gunnery (E) skill", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMwMzczOQ==", "bodyText": "In 3ed RPG it was called laser.  In A Time of War for small arms they reference a damage type E for energy.  I think that's why it was labeled aToW and called energy.", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r440303739", "createdAt": "2020-06-15T16:35:50Z", "author": {"login": "sagnam"}, "path": "megamek/i18n/megamek/client/messages.properties", "diffHunk": "@@ -2970,7 +2969,7 @@ WeaponAttackAction.GoldenGoose=Golden Goose\n WeaponAttackAction.GunnerHit=gunner incapacitated\n WeaponAttackAction.GunSkill=gunnery skill\n WeaponAttackAction.GunBSkill=gunnery (B) skill\n-WeaponAttackAction.GunESkill=gunnery (E) skill", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA5NTYwNQ=="}, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTM2MjI0OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/client/ui/swing/ChatLounge.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjowMjowMFrOGiwULw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjowMjowMFrOGiwULw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA5NjM2Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            boolean rpgSkills = clientgui.getClient().getGame().getOptions().booleanOption(OptionsConstants.RPG_RPG_GUNNERY);\n          \n          \n            \n                            final boolean rpgSkills = clientgui.getClient().getGame().getOptions().booleanOption(OptionsConstants.RPG_RPG_GUNNERY);", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r439096367", "createdAt": "2020-06-11T22:02:00Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/client/ui/swing/ChatLounge.java", "diffHunk": "@@ -3364,10 +3362,11 @@ public Object getValueAt(int row, int col) {\n                             + clientgui.getClient().getGame().getPlayer(entity.getOwnerId()).getTeam();\n                 }\n             } else if (col == COL_PILOT) {\n+                boolean rpgSkills = clientgui.getClient().getGame().getOptions().booleanOption(OptionsConstants.RPG_RPG_GUNNERY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTM4NjM3OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/MULParser.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjoxMjo0OFrOGiwjaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjoxMjo0OFrOGiwjaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMDI2NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    boolean hasGun = attributes.containsKey(GUNNERY) && (attributes.get(GUNNERY).length() > 0);\n          \n          \n            \n                    boolean hasRpgGun = attributes.containsKey(GUNNERYL) && (attributes.get(GUNNERYL).length() > 0) &&\n          \n          \n            \n                    final boolean hasGun = attributes.containsKey(GUNNERY) && (attributes.get(GUNNERY).length() > 0);\n          \n          \n            \n                    final boolean hasRpgGun = attributes.containsKey(GUNNERYL) && (attributes.get(GUNNERYL).length() > 0) &&", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r439100265", "createdAt": "2020-06-11T22:12:48Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/common/MULParser.java", "diffHunk": "@@ -1062,23 +1062,86 @@ private void setCrewAttributes(Crew crew, Map<String,String> attributes, Entity\n      * @param attributes A map of attribute values keyed to the attribute names.\n      */\n     private void setPilotAttributes(Crew crew, int slot, Map<String, String> attributes) {\n+        boolean hasGun = attributes.containsKey(GUNNERY) && (attributes.get(GUNNERY).length() > 0);\n+        boolean hasRpgGun = attributes.containsKey(GUNNERYL) && (attributes.get(GUNNERYL).length() > 0) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0Mjk4Njc5OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/util/CrewSkillSummaryUtil.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0MToyMlrOGj34ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0MToyMlrOGj34ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI2ODkwMQ==", "bodyText": "This is misspelt, there should only be two n's in gunnery, not three.", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r440268901", "createdAt": "2020-06-15T15:41:22Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/common/util/CrewSkillSummaryUtil.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package megamek.common.util;\n+\n+import java.text.MessageFormat;\n+\n+import megamek.common.Messages;\n+\n+public class CrewSkillSummaryUtil {\n+    private static final String SKILL_SUMMARY_PILOT = \"{0}/{1}\";\n+    private static final String SKILL_SUMMARY_RPG_PILOT = \"{0}/{1}/{2}/{3}\";\n+    private static final String SKILL_SUMMARY_LAM_PILOT = \"M: {0}/{1} A: {2}/{3}\";\n+    private static final String SKILL_SUMMARY_RPG_LAM_PILOT = \"M: {0}/{1}/{2}/{3} A: {4}/{5}/{6}/{7}\";\n+    private static final String SKILL_SUMMARY_GUNNERY = \"{0}\";\n+    private static final String SKILL_SUMMARY_RPG_GUNNERY = \"{0}/{1}/{2}\";\n+    private static final String SKILL_SUMMARY_LAM_GUNNERY = \"{0}/{1}\";\n+    private static final String SKILL_SUMMARY_RPG_LAM_GUNNERY = \"M: {0}/{1}/{2} A: {3}/{4}/{5}\";\n+\n+    public static String getPilotSkillSummary(int gunnery, int gunneryL, int gunneryM, int gunneryB, int piloting, boolean rpgGunnery) {\n+        if (rpgGunnery) {\n+            return MessageFormat.format(SKILL_SUMMARY_RPG_PILOT, gunneryL, gunneryM, gunneryB, piloting);\n+        } else {\n+            return MessageFormat.format(SKILL_SUMMARY_PILOT, gunnery, piloting);\n+        }\n+    }\n+\n+    public static String getPilotSkillSummary(String gunnery, String gunneryL, String gunneryM, String gunneryB, String piloting, boolean rpgGunnery) {\n+        if (rpgGunnery) {\n+            return MessageFormat.format(SKILL_SUMMARY_RPG_PILOT, gunneryL, gunneryM, gunneryB, piloting);\n+        } else {\n+            return MessageFormat.format(SKILL_SUMMARY_PILOT, gunnery, piloting);\n+        }\n+    }\n+\n+    public static String getGunnnerySkillSummary(int gunnery, int gunneryL, int gunneryM, int gunneryB, boolean rpgGunnery) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0Mjk4NzA3OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/util/CrewSkillSummaryUtil.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0MToyN1rOGj34mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0MToyN1rOGj34mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI2ODk1NQ==", "bodyText": "This is misspelt, there should only be two n's in gunnery, not three.", "url": "https://github.com/MegaMek/megamek/pull/1998#discussion_r440268955", "createdAt": "2020-06-15T15:41:27Z", "author": {"login": "Windchild292"}, "path": "megamek/src/megamek/common/util/CrewSkillSummaryUtil.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package megamek.common.util;\n+\n+import java.text.MessageFormat;\n+\n+import megamek.common.Messages;\n+\n+public class CrewSkillSummaryUtil {\n+    private static final String SKILL_SUMMARY_PILOT = \"{0}/{1}\";\n+    private static final String SKILL_SUMMARY_RPG_PILOT = \"{0}/{1}/{2}/{3}\";\n+    private static final String SKILL_SUMMARY_LAM_PILOT = \"M: {0}/{1} A: {2}/{3}\";\n+    private static final String SKILL_SUMMARY_RPG_LAM_PILOT = \"M: {0}/{1}/{2}/{3} A: {4}/{5}/{6}/{7}\";\n+    private static final String SKILL_SUMMARY_GUNNERY = \"{0}\";\n+    private static final String SKILL_SUMMARY_RPG_GUNNERY = \"{0}/{1}/{2}\";\n+    private static final String SKILL_SUMMARY_LAM_GUNNERY = \"{0}/{1}\";\n+    private static final String SKILL_SUMMARY_RPG_LAM_GUNNERY = \"M: {0}/{1}/{2} A: {3}/{4}/{5}\";\n+\n+    public static String getPilotSkillSummary(int gunnery, int gunneryL, int gunneryM, int gunneryB, int piloting, boolean rpgGunnery) {\n+        if (rpgGunnery) {\n+            return MessageFormat.format(SKILL_SUMMARY_RPG_PILOT, gunneryL, gunneryM, gunneryB, piloting);\n+        } else {\n+            return MessageFormat.format(SKILL_SUMMARY_PILOT, gunnery, piloting);\n+        }\n+    }\n+\n+    public static String getPilotSkillSummary(String gunnery, String gunneryL, String gunneryM, String gunneryB, String piloting, boolean rpgGunnery) {\n+        if (rpgGunnery) {\n+            return MessageFormat.format(SKILL_SUMMARY_RPG_PILOT, gunneryL, gunneryM, gunneryB, piloting);\n+        } else {\n+            return MessageFormat.format(SKILL_SUMMARY_PILOT, gunnery, piloting);\n+        }\n+    }\n+\n+    public static String getGunnnerySkillSummary(int gunnery, int gunneryL, int gunneryM, int gunneryB, boolean rpgGunnery) {\n+        if (rpgGunnery) {\n+            return MessageFormat.format(SKILL_SUMMARY_RPG_GUNNERY, gunneryL, gunneryM, gunneryB);\n+        } else {\n+            return MessageFormat.format(SKILL_SUMMARY_GUNNERY, gunnery);\n+        }\n+    }\n+\n+    public static String getGunnnerySkillSummary(String gunnery, String gunneryL, String gunneryM, String gunneryB, boolean rpgGunnery) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd5051f048951f2ea94488abe987766e3c77d8b5"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2823, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}