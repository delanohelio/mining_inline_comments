{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2Mjk0MDA2", "number": 2219, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNDowODoyNlrOEi9JHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNzo0NFrOEjK70g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MDg4Nzk3OnYy", "diffSide": "LEFT", "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistoMachinePistolSPEC7AWeapon.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNDowODoyNlrOHRDOpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMTo1MTozM1rOHRtj-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0MDc0MA==", "bodyText": "What happened to this poor thing?", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r487640740", "createdAt": "2020-09-14T04:08:26Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistoMachinePistolSPEC7AWeapon.java", "diffHunk": "@@ -1,51 +0,0 @@\n-/**\n- * MegaMek - Copyright (C) 2004,2005 Ben Mazur (bmazur@sev.org)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMzNDMzMQ==", "bodyText": "I don't remember deleting it, but it looks like it's a duplicate of InfantryPistolSMGGHTSpec7aWeapon, so I probably kept the one that was spelled correctly.", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r488334331", "createdAt": "2020-09-15T01:51:33Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistoMachinePistolSPEC7AWeapon.java", "diffHunk": "@@ -1,51 +0,0 @@\n-/**\n- * MegaMek - Copyright (C) 2004,2005 Ben Mazur (bmazur@sev.org)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0MDc0MA=="}, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MDg4ODk2OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistolISPulseLaserPistolWeapon.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNDowOTowMVrOHRDPOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMTo1MTo0N1rOHRtkTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0MDg5MQ==", "bodyText": "Out of curiosity, where's this data come from?", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r487640891", "createdAt": "2020-09-14T04:09:01Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistolISPulseLaserPistolWeapon.java", "diffHunk": "@@ -36,13 +36,16 @@ public InfantryPistolISPulseLaserPistolWeapon() {\n \t\tsetInternalName(name);\n \t\taddLookupName(\"InfantryPulseLaserpistol\");\n \t\taddLookupName(\"Pulse Laser Pistol\");\n-\t\tammoType = AmmoType.T_NA;\n+\t\tammoType = AmmoType.T_INFANTRY;\n \t\tcost = 1000;\n \t\tbv = 0.13;\n \t\ttonnage = .001;\n \t\tflags = flags.or(F_NO_FIRES).or(F_DIRECT_FIRE).or(F_ENERGY);\n \t\tinfantryDamage = 0.14;\n \t\tinfantryRange = 0;\n+\t\tammoWeight = 0.0003;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMzNDQxNQ==", "bodyText": "The infantry weapon tables in TM.", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r488334415", "createdAt": "2020-09-15T01:51:47Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/infantry/InfantryPistolISPulseLaserPistolWeapon.java", "diffHunk": "@@ -36,13 +36,16 @@ public InfantryPistolISPulseLaserPistolWeapon() {\n \t\tsetInternalName(name);\n \t\taddLookupName(\"InfantryPulseLaserpistol\");\n \t\taddLookupName(\"Pulse Laser Pistol\");\n-\t\tammoType = AmmoType.T_NA;\n+\t\tammoType = AmmoType.T_INFANTRY;\n \t\tcost = 1000;\n \t\tbv = 0.13;\n \t\ttonnage = .001;\n \t\tflags = flags.or(F_NO_FIRES).or(F_DIRECT_FIRE).or(F_ENERGY);\n \t\tinfantryDamage = 0.14;\n \t\tinfantryRange = 0;\n+\t\tammoWeight = 0.0003;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0MDg5MQ=="}, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzEzNTM5OnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/MechView.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNTowN1rOHRYBYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMTo1Mzo1MFrOHRtmoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTQxMA==", "bodyText": "Chain-linked ammo bins?", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r487981410", "createdAt": "2020-09-14T14:35:07Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/MechView.java", "diffHunk": "@@ -911,6 +912,30 @@ private ViewElement getAmmo() {\n                 ammoTable.addRow(row);\n             }\n         }\n+        if (entity.getWeightClass() == EntityWeightClass.WEIGHT_SMALL_SUPPORT) {\n+            for (Mounted mounted : entity.getWeaponList()) {\n+                String[] row = {mounted.getName(),\n+                        entity.getLocationAbbr(mounted.getLocation()),\n+                        String.valueOf((int) mounted.getSize() * ((InfantryWeapon) mounted.getType()).getShots()),\n+                        \"\"};\n+                if (entity.isOmni()) {\n+                    row[3] = mounted.isOmniPodMounted() ?\n+                            Messages.getString(\"MechView.Pod\") : //$NON-NLS-1$\n+                            Messages.getString(\"MechView.Fixed\"); //$NON-NLS-1$\n+                }\n+                int shotsLeft = 0;\n+                for (Mounted current = mounted.getLinked(); current != null; current = current.getLinked()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMzNDg1Ng==", "bodyText": "As mentioned in the PR description, the way I handled alternate munitions that can only be used by one weapon is to chain link them. So weapons that have alternate inferno ammo get two bins.", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r488334856", "createdAt": "2020-09-15T01:53:20Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/MechView.java", "diffHunk": "@@ -911,6 +912,30 @@ private ViewElement getAmmo() {\n                 ammoTable.addRow(row);\n             }\n         }\n+        if (entity.getWeightClass() == EntityWeightClass.WEIGHT_SMALL_SUPPORT) {\n+            for (Mounted mounted : entity.getWeaponList()) {\n+                String[] row = {mounted.getName(),\n+                        entity.getLocationAbbr(mounted.getLocation()),\n+                        String.valueOf((int) mounted.getSize() * ((InfantryWeapon) mounted.getType()).getShots()),\n+                        \"\"};\n+                if (entity.isOmni()) {\n+                    row[3] = mounted.isOmniPodMounted() ?\n+                            Messages.getString(\"MechView.Pod\") : //$NON-NLS-1$\n+                            Messages.getString(\"MechView.Fixed\"); //$NON-NLS-1$\n+                }\n+                int shotsLeft = 0;\n+                for (Mounted current = mounted.getLinked(); current != null; current = current.getLinked()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTQxMA=="}, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMzNTAwOA==", "bodyText": "This code is agnostic. It works regardless of the number of bins linked to the weapon.", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r488335008", "createdAt": "2020-09-15T01:53:50Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/MechView.java", "diffHunk": "@@ -911,6 +912,30 @@ private ViewElement getAmmo() {\n                 ammoTable.addRow(row);\n             }\n         }\n+        if (entity.getWeightClass() == EntityWeightClass.WEIGHT_SMALL_SUPPORT) {\n+            for (Mounted mounted : entity.getWeaponList()) {\n+                String[] row = {mounted.getName(),\n+                        entity.getLocationAbbr(mounted.getLocation()),\n+                        String.valueOf((int) mounted.getSize() * ((InfantryWeapon) mounted.getType()).getShots()),\n+                        \"\"};\n+                if (entity.isOmni()) {\n+                    row[3] = mounted.isOmniPodMounted() ?\n+                            Messages.getString(\"MechView.Pod\") : //$NON-NLS-1$\n+                            Messages.getString(\"MechView.Fixed\"); //$NON-NLS-1$\n+                }\n+                int shotsLeft = 0;\n+                for (Mounted current = mounted.getLinked(); current != null; current = current.getLinked()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTQxMA=="}, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzE0NzcwOnYy", "diffSide": "RIGHT", "path": "megamek/src/megamek/common/templates/SupportVeeTROView.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNzo0NFrOHRYJDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMjowMjoxNFrOHRtwKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MzM3NA==", "bodyText": "The interior of this if block looks almost identical to the one in the TROView - 1, any reason why the # shots isn't displayed in the TRO view, and 2, any chance to unify this logic?", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r487983374", "createdAt": "2020-09-14T14:37:44Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/templates/SupportVeeTROView.java", "diffHunk": "@@ -191,8 +192,21 @@ protected int addEquipment(Entity entity) {\n                 }\n                 fields.put(\"tonnage\", adjustWeight(eq.getTonnage(entity, entry.getKey().getSize()) * count));\n                 fields.put(\"location\", loc);\n-                fields.put(\"slots\", eq.getCriticals(entity, entry.getValue()) * count);\n+                fields.put(\"slots\", eq.getSupportVeeSlots(entity) * count);\n                 weaponList.add(fields);\n+                if (eq instanceof InfantryWeapon) {\n+                    Map<String, Object> ammoFields = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMzNzQ1MA==", "bodyText": "The method in TROView never gets called for support vehicles. I think what happened is that I started reworking TROView then realized that some differences in logic would require overriding it, but never removed the extra code from the parent class. This is what comes of working in 10-15 minute sessions with several days between.", "url": "https://github.com/MegaMek/megamek/pull/2219#discussion_r488337450", "createdAt": "2020-09-15T02:02:14Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/templates/SupportVeeTROView.java", "diffHunk": "@@ -191,8 +192,21 @@ protected int addEquipment(Entity entity) {\n                 }\n                 fields.put(\"tonnage\", adjustWeight(eq.getTonnage(entity, entry.getKey().getSize()) * count));\n                 fields.put(\"location\", loc);\n-                fields.put(\"slots\", eq.getCriticals(entity, entry.getValue()) * count);\n+                fields.put(\"slots\", eq.getSupportVeeSlots(entity) * count);\n                 weaponList.add(fields);\n+                if (eq instanceof InfantryWeapon) {\n+                    Map<String, Object> ammoFields = new HashMap<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MzM3NA=="}, "originalCommit": {"oid": "91f60d6deea4a92a93b955d1dbdeab4648ed1c1e"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2695, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}