{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MzQyMjg4", "number": 2293, "title": "Small fixed wing support vehicles implementation", "bodyText": "This should finish the implementation of the aerospace small support vehicles - currently only fixed wing, but airships and satellites in the future. There are two basic areas covered:\n\nSet up ammo bins for any weapons. This is done for ground vehicles in BlkFile, but I failed to check whether BLKFixedWIngSupportFile overrides loadEquipment.\nProvide aerospace stats to infantry weapons. This includes determining AV at each range band and calculating the maximum range band for the weapon based on the infantryRange. Infantry weapons don't use the standard S/M/L values, but instead have a single value. Small support vehicle weapon range is 1x/2x/3x this value, for a maximum range of infantryRange * 3.\n\nThere were several places in the code that use the maxRange field directly rather than using the accessor method, which bypasses the different calculation for infantry weapons. I fixed those and changed the visibility of all the aerotech fields to protected.", "createdAt": "2020-10-03T21:43:56Z", "url": "https://github.com/MegaMek/megamek/pull/2293", "merged": true, "mergeCommit": {"oid": "f949b3a0ba9141f2e5ab3b280872f08f017ac0ed"}, "closed": true, "closedAt": "2020-10-04T02:16:26Z", "author": {"login": "neoancient"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNq8RnAH2gAyNDk3MzQyMjg4OmFkMzYxYzVjODYxODliNDQxMzRiYmY1ODRlZTdkYWQyYzNkOTFjYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPEbHMAFqTUwMTU4MzEwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ad361c5c86189b44134bbf584ee7dad2c3d91cbb", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/ad361c5c86189b44134bbf584ee7dad2c3d91cbb", "committedDate": "2020-09-29T16:40:06Z", "message": "Set ammo bin size for small fixed wing SVs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db22ff933d7e0b78eadc72b161248df2e55febb5", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/db22ff933d7e0b78eadc72b161248df2e55febb5", "committedDate": "2020-09-29T16:46:09Z", "message": "AV for infantry weapons for small fixed wing SVs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ece32330a99f784cb13c5bf15387ffb737e13c77", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/ece32330a99f784cb13c5bf15387ffb737e13c77", "committedDate": "2020-10-02T21:08:24Z", "message": "Calculate max aero range band for infantry weapons."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a29ceaca179838f8f0d492a863163d415359d870", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/a29ceaca179838f8f0d492a863163d415359d870", "committedDate": "2020-10-03T20:05:59Z", "message": "Remove public access for AT2 fields in WeaponType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd82bfbba450c4e2be2a498f0c052fe62a5cf6a1", "author": {"user": {"login": "neoancient", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/fd82bfbba450c4e2be2a498f0c052fe62a5cf6a1", "committedDate": "2020-10-03T20:32:37Z", "message": "Merge remote-tracking branch 'origin/master' into small_fixed_wing_sv"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNTgzMTA1", "url": "https://github.com/MegaMek/megamek/pull/2293#pullrequestreview-501583105", "createdAt": "2020-10-04T00:55:09Z", "commit": {"oid": "fd82bfbba450c4e2be2a498f0c052fe62a5cf6a1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwMDo1NTowOVrOHcEatw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwMDo1NTowOVrOHcEatw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE5NDU1MQ==", "bodyText": "I hate to ask, but what about battle armor?", "url": "https://github.com/MegaMek/megamek/pull/2293#discussion_r499194551", "createdAt": "2020-10-04T00:55:09Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/weapons/infantry/InfantryWeaponHandler.java", "diffHunk": "@@ -157,12 +157,15 @@ protected int calcnClusterAero(Entity entityTarget) {\n     }\n \n     protected int calcAttackValue() {\n-        int av = 0;\n+        int av;\n         //Sigh, another rules oversight - nobody bothered to figure this out\n         //To be consistent with other cluster weapons we will assume 60% hit\n-        if ((ae instanceof Infantry) && !(ae instanceof BattleArmor)) {\n+        if (ae.isConventionalInfantry()) {\n             double damage = ((Infantry) ae).getDamagePerTrooper();\n             av = (int) Math.round(damage * 0.6 * ((Infantry) ae).getShootingStrength());\n+        } else {\n+            // Small fixed wing support\n+            av = super.calcAttackValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd82bfbba450c4e2be2a498f0c052fe62a5cf6a1"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4803, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}