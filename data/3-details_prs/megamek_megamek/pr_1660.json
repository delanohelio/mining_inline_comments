{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMzkwNjA0", "number": 1660, "title": "Narrow/low profile quirk", "bodyText": "This is my crack at the updated narrow/low profile quirk. It wasn't nearly as bad as I initially thought, but still, a lot of changes.\nThe highlights:\n\nconsolidated logic for determining whether a hit is a glancing blow or a narrow/low-profile glancing blow\nconsolidated logic for adding glancing blow reports\nconsolidated logic for applying glancing blow effects", "createdAt": "2020-02-10T22:41:13Z", "url": "https://github.com/MegaMek/megamek/pull/1660", "merged": true, "mergeCommit": {"oid": "af9b41a03e071b2fe26d6fa99eb9e5097907f2d4"}, "closed": true, "closedAt": "2020-02-18T00:18:33Z", "author": {"login": "NickAragua"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAPpMPgH2gAyMzczMzkwNjA0OmQ0NDI3MmZmZjhjM2U1OGFiMzAwMTRjODQ5ZmNmZjlmNTdlZjg5NmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDw6JygH2gAyMzczMzkwNjA0OmZjNWRiNTAxNWYwNTM0ZGJlMWVhZDc1M2I0ZDE3ZDBhY2ViNTBhNWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d44272fff8c3e58ab30014c849fcff9f57ef896a", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/d44272fff8c3e58ab30014c849fcff9f57ef896a", "committedDate": "2020-02-02T03:19:39Z", "message": "new report message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60bde69b84558a758016a776698f8a848e68c213", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/60bde69b84558a758016a776698f8a848e68c213", "committedDate": "2020-02-02T03:19:46Z", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c14d2632eecffd51d1920d4f3e59213d4231a64c", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/c14d2632eecffd51d1920d4f3e59213d4231a64c", "committedDate": "2020-02-02T15:06:08Z", "message": "consolidate glancing blow logic for standard attacks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24729a75865e64fb74a4cbdd2f36100889394b23", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/24729a75865e64fb74a4cbdd2f36100889394b23", "committedDate": "2020-02-04T02:29:42Z", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/1d786d2d9eae8f1641021314d7add8245ffe8c27", "committedDate": "2020-02-05T02:17:41Z", "message": "additional handlers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NzkyNzI1", "url": "https://github.com/MegaMek/megamek/pull/1660#pullrequestreview-356792725", "createdAt": "2020-02-11T16:15:34Z", "commit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNjoxNTozNVrOFoPZwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTo0ODo0OFrOFoWytg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzczOTcxMg==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377739712", "createdAt": "2020-02-11T16:15:35Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/LRMSwarmHandler.java", "diffHunk": "@@ -348,10 +337,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNDA3MQ==", "bodyText": "Should be rounded up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377814071", "createdAt": "2020-02-11T18:22:55Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/PPCHandler.java", "diffHunk": "@@ -128,9 +128,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNTY5Ng==", "bodyText": "This is against conventional infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377815696", "createdAt": "2020-02-11T18:25:42Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/SRMFragHandler.java", "diffHunk": "@@ -71,9 +71,8 @@ protected int calcDamagePerHit() {\n             if (bDirect) {\n                 toReturn += toHit.getMoS() / 3;\n             }\n-            if (bGlancing) {\n-                toReturn = (int) Math.floor(toReturn / 2.0);\n-            }\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNjEwOQ==", "bodyText": "Infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377816109", "createdAt": "2020-02-11T18:26:27Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/SRMHandler.java", "diffHunk": "@@ -60,10 +60,10 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNjY0Ng==", "bodyText": "Infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377816646", "createdAt": "2020-02-11T18:27:27Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/SRMTandemChargeHandler.java", "diffHunk": "@@ -195,9 +195,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n+\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzMjEwOA==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377832108", "createdAt": "2020-02-11T18:55:35Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/battlearmor/BALBXHandler.java", "diffHunk": "@@ -51,10 +51,8 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\r\n                     ((Infantry) target).isMechanized(),\r\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\r\n-            if (bGlancing) {\r\n-                toReturn /= 2;\r\n-            }\r\n-            return (int) Math.floor(toReturn);\r\n+            toReturn = applyGlancingBlowModifier(toReturn, false);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNDQxMA==", "bodyText": "Round up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377834410", "createdAt": "2020-02-11T18:59:47Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/ACWeaponHandler.java", "diffHunk": "@@ -70,9 +70,7 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNTQwMA==", "bodyText": "Round up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377835400", "createdAt": "2020-02-11T19:01:34Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/ArtilleryCannonWeaponHandler.java", "diffHunk": "@@ -271,17 +271,13 @@ public boolean handle(IGame.Phase phase, Vector<Report> vPhaseReport) {\n      */\n     @Override\n     protected int calcDamagePerHit() {\n-        float toReturn = wtype.getDamage();\n+        double toReturn = wtype.getDamage();\n         // area effect damage is double\n         if ((target instanceof Infantry) && !(target instanceof BattleArmor)) {\n             toReturn /= 0.5;\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n-        // System.err.println(\"Attack is doing \" + toReturn + \" damage.\");\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNTY3MQ==", "bodyText": "Round up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377835671", "createdAt": "2020-02-11T19:02:04Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -497,11 +497,7 @@ protected int calcDamagePerHit() {\n             toReturn /= 0.5;\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n-        // System.err.println(\"Attack is doing \" + toReturn + \" damage.\");\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNzIyNw==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377837227", "createdAt": "2020-02-11T19:04:52Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/ATMHandler.java", "diffHunk": "@@ -83,9 +83,7 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNzg4OQ==", "bodyText": "Round up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377837889", "createdAt": "2020-02-11T19:06:05Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/ChemicalLaserHandler.java", "diffHunk": "@@ -88,9 +88,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0Mjc2NA==", "bodyText": "Round up for conventional infantry.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377842764", "createdAt": "2020-02-11T19:15:02Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/EnergyWeaponHandler.java", "diffHunk": "@@ -92,10 +92,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0NDU3Ng==", "bodyText": "Round up for conventional infantry, down for other units.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377844576", "createdAt": "2020-02-11T19:18:16Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/HyperLaserHandler.java", "diffHunk": "@@ -138,10 +138,8 @@ protected int calcDamagePerHit() {\n \r\n         }\r\n \r\n-        if (bGlancing) {\r\n-            toReturn = (int) Math.floor(toReturn / 2.0);\r\n-        }\r\n-        return (int) Math.ceil(toReturn);\r\n+        toReturn = applyGlancingBlowModifier(toReturn, true);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0NTIwMw==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377845203", "createdAt": "2020-02-11T19:19:24Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/LBXHandler.java", "diffHunk": "@@ -65,10 +65,8 @@ protected int calcDamagePerHit() {\n                     WeaponType.WEAPON_CLUSTER_BALLISTIC,\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1MzQyOA==", "bodyText": "I think the comment on \"partial streak missiles\" refers to iATMs firing either as streak missiles (direct fire) or as cluster weapons (indirect fire). I would say that when firing as streak they are unaffected by glancing blows, but in the case of indirect fire they would get the damage reduction (since attacks against conventional infantry don't use the cluster table).\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        if (streakInactive()) {\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);\n          \n          \n            \n                        }", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377853428", "createdAt": "2020-02-11T19:34:51Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/CLIATMHandler.java", "diffHunk": "@@ -95,11 +95,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2; // Is this correct for partial streak missiles??\n-                // it seems as if this only affects infantry -\n-                // I'm going to ignore this.\n-            }\n+            \n+            // some question here about \"partial streak missiles\"\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NDk5MA==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377854990", "createdAt": "2020-02-11T19:37:46Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/MekMortarHandler.java", "diffHunk": "@@ -122,10 +122,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NTUyMg==", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377855522", "createdAt": "2020-02-11T19:38:45Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/MGHandler.java", "diffHunk": "@@ -83,18 +82,16 @@ protected int calcDamagePerHit() {\n                         wtype.getInfantryDamageClass(),\n                         ((Infantry) target).isMechanized(),\n                         toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-                if (bGlancing) {\n-                    toReturn = (int) Math.floor(toReturn / 2.0);\n-                }\n+                \n+                toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NTk4NA==", "bodyText": "Conventional infantry should be rounded up.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377855984", "createdAt": "2020-02-11T19:39:37Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/NarcExplosiveHandler.java", "diffHunk": "@@ -133,9 +133,7 @@ protected int calcDamagePerHit() {\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n             toReturn = Math.ceil(toReturn);\n         }\n-        if (bGlancing) {\n-            return (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NjMwMg==", "bodyText": "Conventional infantry should be rounded up.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377856302", "createdAt": "2020-02-11T19:40:21Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/PlasmaCannonHandler.java", "diffHunk": "@@ -296,9 +296,7 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NzI2MA==", "bodyText": "Conventional infantry should be rounded up.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377857260", "createdAt": "2020-02-11T19:42:07Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/PulseLaserWeaponHandler.java", "diffHunk": "@@ -89,9 +89,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODA5Ng==", "bodyText": "Conventional infantry should be rounded up.", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377858096", "createdAt": "2020-02-11T19:43:47Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/RifleWeaponHandler.java", "diffHunk": "@@ -87,9 +87,7 @@ protected int calcDamagePerHit() {\n             }\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODUyNA==", "bodyText": "This is against conventional infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377858524", "createdAt": "2020-02-11T19:44:31Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/SRMDeadFireHandler.java", "diffHunk": "@@ -66,10 +66,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg2MDMyMA==", "bodyText": "Round up against conventional infantry", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377860320", "createdAt": "2020-02-11T19:47:54Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/VariableSpeedPulseLaserWeaponHandler.java", "diffHunk": "@@ -104,9 +104,7 @@ protected int calcDamagePerHit() {\n \n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg2MDc5MA==", "bodyText": "This is against infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377860790", "createdAt": "2020-02-11T19:48:48Z", "author": {"login": "neoancient"}, "path": "megamek/src/megamek/common/weapons/VehicleFlamerHandler.java", "diffHunk": "@@ -128,9 +128,8 @@ protected int calcDamagePerHit() {\n             if (((Entity) target).hasAbility(OptionsConstants.MD_PAIN_SHUNT)) {\n                 toReturn /= 2;\n             }\n-            if (bGlancing) {\n-                toReturn = Math.ceil(toReturn / 2.0);\n-            }\n+\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb7b39db8c68411d92cf9d52be324431483827ee", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/bb7b39db8c68411d92cf9d52be324431483827ee", "committedDate": "2020-02-12T01:57:41Z", "message": "code review changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e86e8601295b8a650f977adb9d458b9e0c72c3c5", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/e86e8601295b8a650f977adb9d458b9e0c72c3c5", "committedDate": "2020-02-12T01:57:58Z", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3ODU4MDky", "url": "https://github.com/MegaMek/megamek/pull/1660#pullrequestreview-357858092", "createdAt": "2020-02-12T23:17:03Z", "commit": {"oid": "bb7b39db8c68411d92cf9d52be324431483827ee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc5db5015f0534dbe1ead753b4d17d0aceb50a5c", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/megamek/commit/fc5db5015f0534dbe1ead753b4d17d0aceb50a5c", "committedDate": "2020-02-13T01:46:49Z", "message": "fix arithmetic; eliminate to-hit penalty"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4535, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}