{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNjM0ODU5", "number": 2518, "title": "Issue #2517: Ensure AmmoType::canSwitchToAmmo ignores munition types", "bodyText": "This makes sure that AmmoType::canSwitchToAmmo ignores munition types, fixing #2517.", "createdAt": "2020-12-18T16:03:21Z", "url": "https://github.com/MegaMek/megamek/pull/2518", "merged": true, "mergeCommit": {"oid": "cc478dae584cea62adb67b89e503a4dd757931a6"}, "closed": true, "closedAt": "2020-12-18T17:44:27Z", "author": {"login": "sixlettervariables"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnaVA7AH2gAyNTQyNjM0ODU5OjMzOWJhNTc2MTg0Mzc5NzUwZmY4OTVmNDVmYTI2MDNhZTE4Y2JkNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdna8BBAFqTU1NTY0NTg1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "339ba576184379750ff895f45fa2603ae18cbd4e", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/megamek/commit/339ba576184379750ff895f45fa2603ae18cbd4e", "committedDate": "2020-12-18T16:00:46Z", "message": "AmmoType::canSwitchToAmmo should ignore munition type #2517"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/megamek/commit/d037c18c88ec60976de9b87dd9f04e83c248b19b", "committedDate": "2020-12-18T16:01:51Z", "message": "Add parentheses where required"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NjMwMTY3", "url": "https://github.com/MegaMek/megamek/pull/2518#pullrequestreview-555630167", "createdAt": "2020-12-18T16:22:40Z", "commit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMjo0MFrOIIpqAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMjo0MFrOIIpqAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0MjAxOA==", "bodyText": "Can't look at it right now, what's the final logic block look like at the bottom that's returned? The one that's like \"(mmlAmmoMatch || lbxAmmoMatch || ammoOfSameType) && !mismatch", "url": "https://github.com/MegaMek/megamek/pull/2518#discussion_r545942018", "createdAt": "2020-12-18T16:22:40Z", "author": {"login": "NickAragua"}, "path": "megamek/src/megamek/common/AmmoType.java", "diffHunk": "@@ -15897,17 +15897,16 @@ public static boolean canSwitchToAmmo(Mounted weapon, AmmoType otherAmmo) {\n         \n         AmmoType currentAmmoType = (AmmoType) weapon.getLinked().getType();\n         \n-        boolean ammoOfSameType = currentAmmoType.equals(otherAmmo);\n+        boolean ammoOfSameType = currentAmmoType.equalsAmmoTypeOnly(otherAmmo)\n+                && (currentAmmoType.getRackSize() == otherAmmo.getRackSize());\n         \n         // MMLs can swap between different specific ammo types, so we have a special case check here\n-        boolean mmlAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_MML &&\n-                otherAmmo.getAmmoType() == AmmoType.T_MML &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean mmlAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_MML)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_MML);\n         \n         // LBXs can swap between cluster and slug ammo types\n-        boolean lbxAmmoMatch = currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX &&\n-                otherAmmo.getAmmoType() == AmmoType.T_AC_LBX &&\n-                currentAmmoType.getRackSize() == otherAmmo.getRackSize();\n+        boolean lbxAmmoMatch = (currentAmmoType.getAmmoType() == AmmoType.T_AC_LBX)\n+                && (otherAmmo.getAmmoType() == AmmoType.T_AC_LBX);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d037c18c88ec60976de9b87dd9f04e83c248b19b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19d8efb69f3adc73355dfc124150d5883b2b45c4", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/megamek/commit/19d8efb69f3adc73355dfc124150d5883b2b45c4", "committedDate": "2020-12-18T16:28:41Z", "message": "Add rack size restrictions on MML/LBX"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NjM3NDI4", "url": "https://github.com/MegaMek/megamek/pull/2518#pullrequestreview-555637428", "createdAt": "2020-12-18T16:32:04Z", "commit": {"oid": "19d8efb69f3adc73355dfc124150d5883b2b45c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4abbd3653f7761eb024e345401242552b611f8bd", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/megamek/commit/4abbd3653f7761eb024e345401242552b611f8bd", "committedDate": "2020-12-18T16:39:30Z", "message": "Add missing mocks to FireControlTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NjQ1ODUy", "url": "https://github.com/MegaMek/megamek/pull/2518#pullrequestreview-555645852", "createdAt": "2020-12-18T16:43:22Z", "commit": {"oid": "4abbd3653f7761eb024e345401242552b611f8bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4634, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}