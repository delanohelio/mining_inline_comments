{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMzI1MDYy", "number": 9221, "title": "CMTS-30: Support for multi-level resolution on values, changed contra\u2026", "bodyText": "\u2026ct to receive providerName instead of parameterName", "createdAt": "2020-08-19T17:59:21Z", "url": "https://github.com/mulesoft/mule/pull/9221", "merged": true, "mergeCommit": {"oid": "09c712ad6ab14a12c3919c1e184fb8b169dab1ac"}, "closed": true, "closedAt": "2020-08-24T12:01:20Z", "author": {"login": "gsfernandes"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAf0IZABqjM2NzIwODE3MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdB9fHGgFqTQ3MjQ0OTEwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4e7afb225640489c7466590cb2d1312e11dc34f", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/e4e7afb225640489c7466590cb2d1312e11dc34f", "committedDate": "2020-08-19T17:57:11Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}, "afterCommit": {"oid": "9148a7adc15dbb4652ea712c6fb98357701af82d", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/9148a7adc15dbb4652ea712c6fb98357701af82d", "committedDate": "2020-08-19T18:18:13Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9148a7adc15dbb4652ea712c6fb98357701af82d", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/9148a7adc15dbb4652ea712c6fb98357701af82d", "committedDate": "2020-08-19T18:18:13Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}, "afterCommit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/b8696287f569cde6c66c7328d3a20e601f889835", "committedDate": "2020-08-19T19:05:15Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxOTU2ODIy", "url": "https://github.com/mulesoft/mule/pull/9221#pullrequestreview-471956822", "createdAt": "2020-08-20T20:20:16Z", "commit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQyMDoyMDoxNlrOHER6Ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQyMDoyMDoxNlrOHER6Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI0OTc4Nw==", "bodyText": "just to understand, if the value provider returned more than one continent then the valueResult would contain a tree for each continent, right?", "url": "https://github.com/mulesoft/mule/pull/9221#discussion_r474249787", "createdAt": "2020-08-20T20:20:16Z", "author": {"login": "svacas"}, "path": "modules/tooling-support-parent/functional-tests/src/test/java/org/mule/runtime/module/tooling/ComponentValueProviderTestCase.java", "diffHunk": "@@ -167,4 +173,15 @@ public void getValuesOnParameterWithNoValueProvider() {\n                           INVALID_VALUE_RESOLVER_NAME);\n   }\n \n+  @Test\n+  public void multiLevelSourceValue() {\n+    ComponentElementDeclaration elementDeclaration = sourceWithMultiLevelValue(CONFIG_NAME, \"America\", \"USA\");\n+    // ProviderName is groupName\n+    ValueResult valueResult = getValueResult(session, elementDeclaration, \"values\");\n+    // ValueResult for multi level no matter if previous levels are set it would always return the whole tree\n+    assertThat(valueResult.getValues(), hasSize(1));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNDM0NjE1", "url": "https://github.com/mulesoft/mule/pull/9221#pullrequestreview-472434615", "createdAt": "2020-08-21T12:08:09Z", "commit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjowODowOVrOHEqsQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjowODowOVrOHEqsQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY1NTgxMA==", "bodyText": "Was this supposed to be renamed here? I see that the old multiLevelOPDeclaration still exists.", "url": "https://github.com/mulesoft/mule/pull/9221#discussion_r474655810", "createdAt": "2020-08-21T12:08:09Z", "author": {"login": "lucianoRM"}, "path": "modules/tooling-support-parent/functional-tests/src/test/java/org/mule/runtime/module/tooling/MetadataTypesTestCase.java", "diffHunk": "@@ -20,9 +20,8 @@\n import static org.mule.runtime.module.tooling.TestExtensionDeclarationUtils.configLessOPDeclaration;\n import static org.mule.runtime.module.tooling.TestExtensionDeclarationUtils.invalidComponentDeclaration;\n import static org.mule.runtime.module.tooling.TestExtensionDeclarationUtils.multiLevelCompleteOPDeclaration;\n-import static org.mule.runtime.module.tooling.TestExtensionDeclarationUtils.multiLevelOPDeclaration;\n+import static org.mule.runtime.module.tooling.TestExtensionDeclarationUtils.multiLevelOPDeclarationPartialTypeKeys;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2af39228fb25dc6f7157d76ec5c1e33932ec212e", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/2af39228fb25dc6f7157d76ec5c1e33932ec212e", "committedDate": "2020-08-24T03:34:45Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/b8696287f569cde6c66c7328d3a20e601f889835", "committedDate": "2020-08-19T19:05:15Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}, "afterCommit": {"oid": "2af39228fb25dc6f7157d76ec5c1e33932ec212e", "author": {"user": {"login": "gsfernandes", "name": "Guillermo Fernandes"}}, "url": "https://github.com/mulesoft/mule/commit/2af39228fb25dc6f7157d76ec5c1e33932ec212e", "committedDate": "2020-08-24T03:34:45Z", "message": "CMTS-30: Support for multi-level resolution on values, changed contract to receive providerName instead of parameterName"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNDQ5MTA3", "url": "https://github.com/mulesoft/mule/pull/9221#pullrequestreview-472449107", "createdAt": "2020-08-21T12:32:33Z", "commit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjozMjozNFrOHErZCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjozMjozNFrOHErZCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2NzI3NA==", "bodyText": "Is the mediator supposed to receive the providerName?\nI think it only knows. how to handle parameterNames", "url": "https://github.com/mulesoft/mule/pull/9221#discussion_r474667274", "createdAt": "2020-08-21T12:32:34Z", "author": {"login": "lucianoRM"}, "path": "modules/tooling-support-parent/tooling-support/src/main/java/org/mule/runtime/module/tooling/internal/config/InternalDeclarationSession.java", "diffHunk": "@@ -241,16 +241,16 @@ public void dispose() {\n     //do nothing\n   }\n \n-  private <T extends ParameterizedModel & EnrichableModel> ValueResult discoverValues(T componentModel,\n-                                                                                      String parameterName,\n+  private <T extends ParameterizedModel & EnrichableModel> ValueResult discoverValues(T containerModel,\n+                                                                                      String providerName,\n                                                                                       ParameterValueResolver parameterValueResolver,\n                                                                                       Optional<String> configName) {\n-    ValueProviderMediator<T> valueProviderMediator = createValueProviderMediator(componentModel);\n+    ValueProviderMediator<T> valueProviderMediator = createValueProviderMediator(containerModel);\n     ExtensionResolvingContext context =\n         new ExtensionResolvingContext(() -> configName.flatMap(name -> artifactHelper().getConfigurationInstance(name)),\n                                       connectionManager);\n     try {\n-      return resultFrom(valueProviderMediator.getValues(parameterName,\n+      return resultFrom(valueProviderMediator.getValues(providerName,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8696287f569cde6c66c7328d3a20e601f889835"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 543, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}