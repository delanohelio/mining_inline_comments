{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyMDAyNjY5", "number": 9368, "title": "CMTS-35: Support invalidate caches (types/values) for a configuration", "bodyText": "", "createdAt": "2020-09-08T12:21:34Z", "url": "https://github.com/mulesoft/mule/pull/9368", "merged": true, "mergeCommit": {"oid": "a66f7dfd778b7666f865191fac87adcd2b9a980f"}, "closed": true, "closedAt": "2020-09-10T14:30:19Z", "author": {"login": "lucianoRM"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGmvETgH2gAyNDgyMDAyNjY5OjhlNzRmZTlhMjQ1MTdhNTgwNmMxMjVjMjJkMTdkNjhhZmUzOTEwMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHQYHyAFqTQ4NTI4MTkyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e74fe9a24517a5806c125c22d17d68afe391012", "author": {"user": {"login": "lucianoRM", "name": "Luciano RaineriMarchina"}}, "url": "https://github.com/mulesoft/mule/commit/8e74fe9a24517a5806c125c22d17d68afe391012", "committedDate": "2020-09-07T17:48:35Z", "message": "added new ways to declare operations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "523469066a72f016dc69517f6719cc7d40b6a95e", "author": {"user": {"login": "lucianoRM", "name": "Luciano RaineriMarchina"}}, "url": "https://github.com/mulesoft/mule/commit/523469066a72f016dc69517f6719cc7d40b6a95e", "committedDate": "2020-09-09T09:47:26Z", "message": "hack for valueproviders"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDUzNTI1", "url": "https://github.com/mulesoft/mule/pull/9368#pullrequestreview-485053525", "createdAt": "2020-09-09T14:13:36Z", "commit": {"oid": "523469066a72f016dc69517f6719cc7d40b6a95e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNDoxMzozN1rOHPJcQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNDoxMzozN1rOHPJcQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY0NTM3OA==", "bodyText": "How about another interface that extends ValueProviderCacheIdGenerator and provides this capability?", "url": "https://github.com/mulesoft/mule/pull/9368#discussion_r485645378", "createdAt": "2020-09-09T14:13:37Z", "author": {"login": "gsfernandes"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/api/dsl/model/metadata/DeclarationBasedValueProviderCacheIdGenerator.java", "diffHunk": "@@ -25,13 +25,26 @@ public DeclarationBasedValueProviderCacheIdGenerator(DslResolvingContext context\n                                                        ComponentLocator<ElementDeclaration> locator) {\n     this.elementModelFactory = DslElementModelFactory.getDefault(context);\n     this.delegate = new DslElementBasedValueProviderCacheIdGenerator(\n-                                                                     l -> locator.get(l)\n-                                                                         .map(e -> elementModelFactory.create(e).orElse(null)));\n+            l -> locator.get(l)\n+                    .map(e -> elementModelFactory.create(e).orElse(null)));\n   }\n \n   @Override\n   public Optional<ValueProviderCacheId> getIdForResolvedValues(ElementDeclaration containerComponent, String parameterName) {\n     checkArgument(containerComponent != null, \"Cannot generate a Cache Key for a 'null' component\");\n     return elementModelFactory.create(containerComponent).flatMap(dsl -> delegate.getIdForResolvedValues(dsl, parameterName));\n   }\n+\n+  //This method was added so that it can be called by reflection and we can keep the logic on how\n+  //the ValueProviderCacheId is generated for configs and connections in one place, without changing the\n+  //ValueProviderCacheIdGenerator API.\n+  //I could not come with a better solution that does not involve refactoring of the whole API. Having\n+  //said that, we have encountered multiple scenarios where we are needing more information than the\n+  //currently provided by the ValueProviderCacheId (Hierarchical info for example). Meaning that we should\n+  //consider refactoring this in the future to make things simpler. MULE-18743\n+  private Optional<ValueProviderCacheId> getIdForDependency(ElementDeclaration elementDeclaration) {\n+    return elementModelFactory.create(elementDeclaration).flatMap(delegate::resolveIdForInjectedElement);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "523469066a72f016dc69517f6719cc7d40b6a95e"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ad2cd4254e4ef0bf063460b781d53115c6f806d", "author": {"user": {"login": "lucianoRM", "name": "Luciano RaineriMarchina"}}, "url": "https://github.com/mulesoft/mule/commit/9ad2cd4254e4ef0bf063460b781d53115c6f806d", "committedDate": "2020-09-09T17:08:10Z", "message": "rolled back"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MjgxOTI1", "url": "https://github.com/mulesoft/mule/pull/9368#pullrequestreview-485281925", "createdAt": "2020-09-09T18:19:32Z", "commit": {"oid": "9ad2cd4254e4ef0bf063460b781d53115c6f806d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1289, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}