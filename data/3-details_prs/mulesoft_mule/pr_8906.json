{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxODM5ODM4", "number": 8906, "title": "MULE-17774: ComponentParameterAst#getParameter, left value should not\u2026", "bodyText": "\u2026 have the #[] markers", "createdAt": "2020-06-09T14:33:54Z", "url": "https://github.com/mulesoft/mule/pull/8906", "merged": true, "mergeCommit": {"oid": "c1fd4ec6fac73af0041551a8f4f63d08ecf5c961"}, "closed": true, "closedAt": "2020-06-11T13:08:59Z", "author": {"login": "mlischetti"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpmMlfgFqTQyNzIyNzg3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp-klVgFqTQyODM1MjE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MjI3ODcw", "url": "https://github.com/mulesoft/mule/pull/8906#pullrequestreview-427227870", "createdAt": "2020-06-09T14:45:36Z", "commit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDo0NTozNlrOGhNsMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDo0Njo1N1rOGhNwfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDQ5Nw==", "bodyText": "use StringUtils", "url": "https://github.com/mulesoft/mule/pull/8906#discussion_r437480497", "createdAt": "2020-06-09T14:45:36Z", "author": {"login": "elrodro83"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/util/MuleExtensionUtils.java", "diffHunk": "@@ -473,12 +475,33 @@ public static String getImplicitConfigurationProviderName(ExtensionModel extensi\n   public static boolean isExpression(Object value) {\n     if (value instanceof String) {\n       String trim = ((String) value).trim();\n-      return trim.startsWith(\"#[\") && trim.endsWith(\"]\");\n+      return trim.startsWith(DEFAULT_EXPRESSION_PREFIX) && trim.endsWith(DEFAULT_EXPRESSION_POSTFIX);\n     } else {\n       return false;\n     }\n   }\n \n+  /**\n+   * Parse the given value and remove expression markers if it is considered as an expression.\n+   *\n+   * @param value Value to parse\n+   * @return a String containing the expression without markers or null if the value is not an expression.\n+   */\n+  public static Optional<String> extractExpression(Object value) {\n+    Optional<String> result = Optional.empty();\n+    if (isExpression(value)) {\n+      String expression = (String) value;\n+      if (expression != null && !expression.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDU3NA==", "bodyText": "static import", "url": "https://github.com/mulesoft/mule/pull/8906#discussion_r437480574", "createdAt": "2020-06-09T14:45:41Z", "author": {"login": "elrodro83"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/util/MuleExtensionUtils.java", "diffHunk": "@@ -473,12 +475,33 @@ public static String getImplicitConfigurationProviderName(ExtensionModel extensi\n   public static boolean isExpression(Object value) {\n     if (value instanceof String) {\n       String trim = ((String) value).trim();\n-      return trim.startsWith(\"#[\") && trim.endsWith(\"]\");\n+      return trim.startsWith(DEFAULT_EXPRESSION_PREFIX) && trim.endsWith(DEFAULT_EXPRESSION_POSTFIX);\n     } else {\n       return false;\n     }\n   }\n \n+  /**\n+   * Parse the given value and remove expression markers if it is considered as an expression.\n+   *\n+   * @param value Value to parse\n+   * @return a String containing the expression without markers or null if the value is not an expression.\n+   */\n+  public static Optional<String> extractExpression(Object value) {\n+    Optional<String> result = Optional.empty();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MDc1Mw==", "bodyText": "static import", "url": "https://github.com/mulesoft/mule/pull/8906#discussion_r437480753", "createdAt": "2020-06-09T14:45:51Z", "author": {"login": "elrodro83"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/util/MuleExtensionUtils.java", "diffHunk": "@@ -473,12 +475,33 @@ public static String getImplicitConfigurationProviderName(ExtensionModel extensi\n   public static boolean isExpression(Object value) {\n     if (value instanceof String) {\n       String trim = ((String) value).trim();\n-      return trim.startsWith(\"#[\") && trim.endsWith(\"]\");\n+      return trim.startsWith(DEFAULT_EXPRESSION_PREFIX) && trim.endsWith(DEFAULT_EXPRESSION_POSTFIX);\n     } else {\n       return false;\n     }\n   }\n \n+  /**\n+   * Parse the given value and remove expression markers if it is considered as an expression.\n+   *\n+   * @param value Value to parse\n+   * @return a String containing the expression without markers or null if the value is not an expression.\n+   */\n+  public static Optional<String> extractExpression(Object value) {\n+    Optional<String> result = Optional.empty();\n+    if (isExpression(value)) {\n+      String expression = (String) value;\n+      if (expression != null && !expression.isEmpty()) {\n+        String trimmedText = expression.trim();\n+        result =\n+            Optional.of(trimmedText.substring(DEFAULT_EXPRESSION_PREFIX.length(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MTU1OA==", "bodyText": "check for optional presense before setting: extractExpression(rawValue).ifPresent(expression::set)", "url": "https://github.com/mulesoft/mule/pull/8906#discussion_r437481558", "createdAt": "2020-06-09T14:46:54Z", "author": {"login": "elrodro83"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/model/DefaultComponentParameterAst.java", "diffHunk": "@@ -138,7 +139,7 @@ protected void defaultVisit(MetadataType metadataType) {\n             } else if (!NOT_SUPPORTED.equals(getModel().getExpressionSupport())) {\n               if (isExpression(rawValue)) {\n                 // For complex types that may be the result of an expression, just return the expression\n-                expression.set(rawValue);\n+                expression.set(extractExpression(rawValue).get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4MTU5OQ==", "bodyText": "check for optional presense before setting: extractExpression(rawValue).ifPresent(expression::set)", "url": "https://github.com/mulesoft/mule/pull/8906#discussion_r437481599", "createdAt": "2020-06-09T14:46:57Z", "author": {"login": "elrodro83"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/model/DefaultComponentParameterAst.java", "diffHunk": "@@ -64,7 +65,7 @@ private DefaultComponentParameterAst(String rawValue, Object complexValue, Suppl\n       } else if (isEmpty(rawValue)) {\n         final Object defaultValue = getModel().getDefaultValue();\n         if (isExpression(defaultValue)) {\n-          return left((String) defaultValue);\n+          return left(extractExpression(defaultValue).get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0967b3204b8a376eab7dfbba6202d5a24b0f8"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87b30a170d25f5f92c3795861e478fae180d29c8", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/87b30a170d25f5f92c3795861e478fae180d29c8", "committedDate": "2020-06-09T18:57:16Z", "message": "MULE-17774: ComponentParameterAst#getParameter, left value should not have the #[] markers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "819ac4409a163e6bae67c4fe7cec78f3a4d1120e", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/819ac4409a163e6bae67c4fe7cec78f3a4d1120e", "committedDate": "2020-06-09T18:57:16Z", "message": "MULE-17774: Requested changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c47083c2478dbd593b362fde4658e3e92039ba1", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/5c47083c2478dbd593b362fde4658e3e92039ba1", "committedDate": "2020-06-09T16:48:25Z", "message": "MULE-17774: Requested changes"}, "afterCommit": {"oid": "819ac4409a163e6bae67c4fe7cec78f3a4d1120e", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/819ac4409a163e6bae67c4fe7cec78f3a4d1120e", "committedDate": "2020-06-09T18:57:16Z", "message": "MULE-17774: Requested changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "994a08746dd42f9bb81f33886b33b4f990eabb93", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/994a08746dd42f9bb81f33886b33b4f990eabb93", "committedDate": "2020-06-10T16:29:08Z", "message": "MULE-17774: MacroExpansionModuleModel filter expression on expandGlobalElement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MzUyMTky", "url": "https://github.com/mulesoft/mule/pull/8906#pullrequestreview-428352192", "createdAt": "2020-06-10T19:11:03Z", "commit": {"oid": "994a08746dd42f9bb81f33886b33b4f990eabb93"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 705, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}