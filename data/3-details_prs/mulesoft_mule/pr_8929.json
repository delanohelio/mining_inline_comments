{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MzU3MjE4", "number": 8929, "title": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0", "bodyText": "", "createdAt": "2020-06-16T17:15:27Z", "url": "https://github.com/mulesoft/mule/pull/8929", "merged": true, "mergeCommit": {"oid": "2688dce50aa0440d32cac4eccd9d3ccfb9729a89"}, "closed": true, "closedAt": "2020-06-24T15:21:27Z", "author": {"login": "pabloperalta"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsNKHhAH2gAyNDM1MzU3MjE4Ojg1ZTMzNmRiMzEwNjMyOTc2MjM0NTVhMGVhNjZlNjZhM2ExM2E1MGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcubdvNgFqTQzNjc0MDkzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "85e336db31063297623455a0ea66e66a3a13a50d", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/85e336db31063297623455a0ea66e66a3a13a50d", "committedDate": "2020-06-17T17:18:34Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nThe method \"doComplete\" was being called twice (and triggered a NPE) because of a workaround in the close method in the CompletionHandler needed for most HTTP 1.0 cases that do use OutputHandlers. Added a flag to prevent it from being called twice."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be2e3ada8b13064925c6ae45dd01bf5dbe7d4f0e", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/be2e3ada8b13064925c6ae45dd01bf5dbe7d4f0e", "committedDate": "2020-06-17T17:18:34Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nCreated a test to reproduce the issue and verified that the solution made the test pass. It is a flow with a listener and a soap call."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3c615732f831480898a75633da7e1246c3ebf9e", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/f3c615732f831480898a75633da7e1246c3ebf9e", "committedDate": "2020-06-16T19:18:22Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nCreated a test to reproduce the issue and verified that the solution made the test pass. It is a flow with a listener and a soap call."}, "afterCommit": {"oid": "be2e3ada8b13064925c6ae45dd01bf5dbe7d4f0e", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/be2e3ada8b13064925c6ae45dd01bf5dbe7d4f0e", "committedDate": "2020-06-17T17:18:34Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nCreated a test to reproduce the issue and verified that the solution made the test pass. It is a flow with a listener and a soap call."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c757d54cc25a28ce9dc86d125e14ac68f128c58", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/6c757d54cc25a28ce9dc86d125e14ac68f128c58", "committedDate": "2020-06-17T18:38:04Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nRenamed the test after PR to refer to the MULE more directly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNjc0MTA0", "url": "https://github.com/mulesoft/mule/pull/8929#pullrequestreview-432674104", "createdAt": "2020-06-17T18:40:33Z", "commit": {"oid": "6c757d54cc25a28ce9dc86d125e14ac68f128c58"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNjc1NjAx", "url": "https://github.com/mulesoft/mule/pull/8929#pullrequestreview-432675601", "createdAt": "2020-06-17T18:42:42Z", "commit": {"oid": "6c757d54cc25a28ce9dc86d125e14ac68f128c58"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxODo0Mjo0MlrOGlScgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxODo0Mjo0MlrOGlScgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTc1MjcwNA==", "bodyText": "Use an AtomicBoolean and compareAndSet", "url": "https://github.com/mulesoft/mule/pull/8929#discussion_r441752704", "createdAt": "2020-06-17T18:42:42Z", "author": {"login": "eze210"}, "path": "modules/http/src/main/java/org/mule/module/http/internal/listener/grizzly/ResponseDeferringCompletionHandler.java", "diffHunk": "@@ -98,9 +99,12 @@ public void completed(WriteResult result)\n \n   private void doComplete()\n   {\n-    responseStatusCallback.responseSendSuccessfully();\n-    ctx.notifyDownstream(RESPONSE_COMPLETE_EVENT);\n-    resume();\n+    if(!isCompleted) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c757d54cc25a28ce9dc86d125e14ac68f128c58"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8eb66ff63a7db797d66d81ca7f7b6f054330c14e", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/8eb66ff63a7db797d66d81ca7f7b6f054330c14e", "committedDate": "2020-06-17T19:24:31Z", "message": "MULE-18493: HTTP Connector leaking sockets in state CLOSE_WAIT when client uses HTTP/1.0\n\nChanged \"isCompleted\" field type to AtomicBoolean to make the fix more thread-safe"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNzA4NjE4", "url": "https://github.com/mulesoft/mule/pull/8929#pullrequestreview-432708618", "createdAt": "2020-06-17T19:27:08Z", "commit": {"oid": "8eb66ff63a7db797d66d81ca7f7b6f054330c14e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d697243c761c9c89b6e2ef7d5456d3cb607d0b9", "author": {"user": {"login": "pabloperalta", "name": null}}, "url": "https://github.com/mulesoft/mule/commit/7d697243c761c9c89b6e2ef7d5456d3cb607d0b9", "committedDate": "2020-06-23T20:36:39Z", "message": "Merge branch 'support/3.x' into fix/MULE-18493"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzQwOTM0", "url": "https://github.com/mulesoft/mule/pull/8929#pullrequestreview-436740934", "createdAt": "2020-06-24T15:06:31Z", "commit": {"oid": "7d697243c761c9c89b6e2ef7d5456d3cb607d0b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 737, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}