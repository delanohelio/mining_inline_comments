{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NTI1MzAx", "number": 9442, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDoyODowM1rOElG0rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozNDo0MFrOElG76A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ0NTU4OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTracker.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDoyODowM1rOHUa7eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTozMzozNlrOHUcgEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NDc3OA==", "bodyText": "add javadocs", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491174778", "createdAt": "2020-09-18T20:28:03Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTracker.java", "diffHunk": "@@ -0,0 +1,12 @@\n+package org.mule.tests.api;\n+\n+import org.mule.runtime.api.lifecycle.Disposable;\n+import org.mule.runtime.api.lifecycle.Initialisable;\n+import org.mule.runtime.core.api.context.MuleContextAware;\n+\n+import java.util.List;\n+\n+public interface LifecycleTracker extends Initialisable, Disposable, MuleContextAware {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTIwMDUyOA==", "bodyText": "Added for this interface and the base class. Do you think it's needed somewhere else?", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491200528", "createdAt": "2020-09-18T21:33:36Z", "author": {"login": "eze210"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTracker.java", "diffHunk": "@@ -0,0 +1,12 @@\n+package org.mule.tests.api;\n+\n+import org.mule.runtime.api.lifecycle.Disposable;\n+import org.mule.runtime.api.lifecycle.Initialisable;\n+import org.mule.runtime.core.api.context.MuleContextAware;\n+\n+import java.util.List;\n+\n+public interface LifecycleTracker extends Initialisable, Disposable, MuleContextAware {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NDc3OA=="}, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ0NzI2OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerConfiguration.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDoyODo0MlrOHUa8mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDo1MToxMFrOHUbimw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NTA2NA==", "bodyText": "is the formatter being applied here?", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491175064", "createdAt": "2020-09-18T20:28:42Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerConfiguration.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import org.mule.runtime.api.component.Component;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.annotation.Configuration;\n+import org.mule.runtime.extension.api.annotation.Operations;\n+import org.mule.runtime.extension.api.annotation.param.RefName;\n+import org.mule.runtime.extension.api.annotation.Sources;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+import org.mule.tests.internal.LifecycleTrackerOperations;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Configuration(name = \"lifecycleTrackerConfig\")\n+@Operations({LifecycleTrackerOperations.class})\n+@Sources(LifecycleTrackerSource.class)\n+public class LifecycleTrackerConfiguration extends BaseLifecycleTracker {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE4NDc5NQ==", "bodyText": "Now it is", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491184795", "createdAt": "2020-09-18T20:51:10Z", "author": {"login": "eze210"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerConfiguration.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import org.mule.runtime.api.component.Component;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.annotation.Configuration;\n+import org.mule.runtime.extension.api.annotation.Operations;\n+import org.mule.runtime.extension.api.annotation.param.RefName;\n+import org.mule.runtime.extension.api.annotation.Sources;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+import org.mule.tests.internal.LifecycleTrackerOperations;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Configuration(name = \"lifecycleTrackerConfig\")\n+@Operations({LifecycleTrackerOperations.class})\n+@Sources(LifecycleTrackerSource.class)\n+public class LifecycleTrackerConfiguration extends BaseLifecycleTracker {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NTA2NA=="}, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ1NDQ2OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozMToxMVrOHUbA6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTozMjo0M1rOHUcfBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NjE2OQ==", "bodyText": "why use String.contains here? aren't the operation names a short list already?", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491176169", "createdAt": "2020-09-18T20:31:11Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.disposeIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.initialiseIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.startIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.stopIfNeeded;\n+import static org.slf4j.LoggerFactory.getLogger;\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.meta.model.ComponentModel;\n+import org.mule.runtime.api.meta.model.declaration.fluent.OperationDeclaration;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.loader.DeclarationEnricher;\n+import org.mule.runtime.extension.api.loader.ExtensionLoadingContext;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutor;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutorFactory;\n+import org.mule.runtime.extension.api.runtime.operation.ExecutionContext;\n+import org.mule.runtime.module.extension.api.loader.java.property.CompletableComponentExecutorModelProperty;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+public class LifecycleTrackerEnricher implements DeclarationEnricher {\n+\n+    @Override\n+    public void enrich(ExtensionLoadingContext extensionLoadingContext) {\n+        extensionLoadingContext.getExtensionDeclarer().getDeclaration().getOperations().forEach(operation -> {\n+            if (operation.getName().contains(\"lifecycleTracker\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTIwMDI2MQ==", "bodyText": "Because the enricher is called for the whole extension. Added comment to clarify this", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491200261", "createdAt": "2020-09-18T21:32:43Z", "author": {"login": "eze210"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.disposeIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.initialiseIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.startIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.stopIfNeeded;\n+import static org.slf4j.LoggerFactory.getLogger;\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.meta.model.ComponentModel;\n+import org.mule.runtime.api.meta.model.declaration.fluent.OperationDeclaration;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.loader.DeclarationEnricher;\n+import org.mule.runtime.extension.api.loader.ExtensionLoadingContext;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutor;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutorFactory;\n+import org.mule.runtime.extension.api.runtime.operation.ExecutionContext;\n+import org.mule.runtime.module.extension.api.loader.java.property.CompletableComponentExecutorModelProperty;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+public class LifecycleTrackerEnricher implements DeclarationEnricher {\n+\n+    @Override\n+    public void enrich(ExtensionLoadingContext extensionLoadingContext) {\n+        extensionLoadingContext.getExtensionDeclarer().getDeclaration().getOperations().forEach(operation -> {\n+            if (operation.getName().contains(\"lifecycleTracker\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NjE2OQ=="}, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ1NDc3OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozMToxOVrOHUbBIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozMToxOVrOHUbBIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NjIyNA==", "bodyText": "same as above", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491176224", "createdAt": "2020-09-18T20:31:19Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.disposeIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.initialiseIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.startIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.stopIfNeeded;\n+import static org.slf4j.LoggerFactory.getLogger;\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.meta.model.ComponentModel;\n+import org.mule.runtime.api.meta.model.declaration.fluent.OperationDeclaration;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.loader.DeclarationEnricher;\n+import org.mule.runtime.extension.api.loader.ExtensionLoadingContext;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutor;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutorFactory;\n+import org.mule.runtime.extension.api.runtime.operation.ExecutionContext;\n+import org.mule.runtime.module.extension.api.loader.java.property.CompletableComponentExecutorModelProperty;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+public class LifecycleTrackerEnricher implements DeclarationEnricher {\n+\n+    @Override\n+    public void enrich(ExtensionLoadingContext extensionLoadingContext) {\n+        extensionLoadingContext.getExtensionDeclarer().getDeclaration().getOperations().forEach(operation -> {\n+            if (operation.getName().contains(\"lifecycleTracker\")) {\n+                boolean shouldCheckPhase = operation.getName().contains(\"Check\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ1OTk0OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozMzowMFrOHUbEEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTozMzowMVrOHUcfZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3Njk3Nw==", "bodyText": "this oldFactory comes from an Optional already, use map/orElse here instead of if", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491176977", "createdAt": "2020-09-18T20:33:00Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.disposeIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.initialiseIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.startIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.stopIfNeeded;\n+import static org.slf4j.LoggerFactory.getLogger;\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.meta.model.ComponentModel;\n+import org.mule.runtime.api.meta.model.declaration.fluent.OperationDeclaration;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.loader.DeclarationEnricher;\n+import org.mule.runtime.extension.api.loader.ExtensionLoadingContext;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutor;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutorFactory;\n+import org.mule.runtime.extension.api.runtime.operation.ExecutionContext;\n+import org.mule.runtime.module.extension.api.loader.java.property.CompletableComponentExecutorModelProperty;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+public class LifecycleTrackerEnricher implements DeclarationEnricher {\n+\n+    @Override\n+    public void enrich(ExtensionLoadingContext extensionLoadingContext) {\n+        extensionLoadingContext.getExtensionDeclarer().getDeclaration().getOperations().forEach(operation -> {\n+            if (operation.getName().contains(\"lifecycleTracker\")) {\n+                boolean shouldCheckPhase = operation.getName().contains(\"Check\");\n+                CompletableComponentExecutorFactory executorFactory = getExecutorFactory(operation, shouldCheckPhase);\n+                operation.addModelProperty(new CompletableComponentExecutorModelProperty(executorFactory));\n+            }\n+        });\n+    }\n+\n+    private CompletableComponentExecutorFactory getExecutorFactory(OperationDeclaration operation, boolean shouldCheckPhase) {\n+        Optional<CompletableComponentExecutorModelProperty> executorModelProperty = operation.getModelProperty(CompletableComponentExecutorModelProperty.class);\n+        CompletableComponentExecutorFactory<ComponentModel> oldFactory = executorModelProperty.map(CompletableComponentExecutorModelProperty::getExecutorFactory).orElse(null);\n+        return (componentModel, map) -> {\n+            CompletableComponentExecutor<ComponentModel> delegateExecutor = null;\n+            if (oldFactory != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTIwMDM1OQ==", "bodyText": "done", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491200359", "createdAt": "2020-09-18T21:33:01Z", "author": {"login": "eze210"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/LifecycleTrackerEnricher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api;\n+\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.disposeIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.initialiseIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.startIfNeeded;\n+import static org.mule.runtime.core.api.lifecycle.LifecycleUtils.stopIfNeeded;\n+import static org.slf4j.LoggerFactory.getLogger;\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.meta.model.ComponentModel;\n+import org.mule.runtime.api.meta.model.declaration.fluent.OperationDeclaration;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.loader.DeclarationEnricher;\n+import org.mule.runtime.extension.api.loader.ExtensionLoadingContext;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutor;\n+import org.mule.runtime.extension.api.runtime.operation.CompletableComponentExecutorFactory;\n+import org.mule.runtime.extension.api.runtime.operation.ExecutionContext;\n+import org.mule.runtime.module.extension.api.loader.java.property.CompletableComponentExecutorModelProperty;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+public class LifecycleTrackerEnricher implements DeclarationEnricher {\n+\n+    @Override\n+    public void enrich(ExtensionLoadingContext extensionLoadingContext) {\n+        extensionLoadingContext.getExtensionDeclarer().getDeclaration().getOperations().forEach(operation -> {\n+            if (operation.getName().contains(\"lifecycleTracker\")) {\n+                boolean shouldCheckPhase = operation.getName().contains(\"Check\");\n+                CompletableComponentExecutorFactory executorFactory = getExecutorFactory(operation, shouldCheckPhase);\n+                operation.addModelProperty(new CompletableComponentExecutorModelProperty(executorFactory));\n+            }\n+        });\n+    }\n+\n+    private CompletableComponentExecutorFactory getExecutorFactory(OperationDeclaration operation, boolean shouldCheckPhase) {\n+        Optional<CompletableComponentExecutorModelProperty> executorModelProperty = operation.getModelProperty(CompletableComponentExecutorModelProperty.class);\n+        CompletableComponentExecutorFactory<ComponentModel> oldFactory = executorModelProperty.map(CompletableComponentExecutorModelProperty::getExecutorFactory).orElse(null);\n+        return (componentModel, map) -> {\n+            CompletableComponentExecutor<ComponentModel> delegateExecutor = null;\n+            if (oldFactory != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3Njk3Nw=="}, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzQ2NDA4OnYy", "diffSide": "RIGHT", "path": "tests/test-components/src/main/java/org/mule/tests/api/pojos/LifecycleObject.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDozNDo0MFrOHUbGuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTozMzowNlrOHUcfeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NzY1OQ==", "bodyText": "remove empty lines", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491177659", "createdAt": "2020-09-18T20:34:40Z", "author": {"login": "elrodro83"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/pojos/LifecycleObject.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api.pojos;\n+\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.Disposable;\n+import org.mule.runtime.api.lifecycle.Initialisable;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.lifecycle.Startable;\n+import org.mule.runtime.api.lifecycle.Stoppable;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.annotation.dsl.xml.TypeDsl;\n+import org.mule.runtime.extension.api.annotation.param.Optional;\n+import org.mule.runtime.extension.api.annotation.param.Parameter;\n+import org.mule.runtime.extension.api.annotation.param.RefName;\n+import org.mule.tests.api.LifecycleTrackerRegistry;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import javax.inject.Inject;\n+\n+@TypeDsl(allowTopLevelDefinition = true)\n+public class LifecycleObject extends BaseLifecycleTracker {\n+\n+    @Inject\n+    private LifecycleTrackerRegistry registry;\n+\n+    @RefName\n+    private String name;\n+\n+    @Optional\n+    @Parameter\n+    private String failurePhase;\n+\n+    @Optional\n+    @Parameter\n+    private String otherLifecycleObject;\n+\n+    public LifecycleObject() {\n+        super(false);\n+    }\n+\n+    @Override\n+    protected void onSetMuleContext(MuleContext muleContext) {\n+        addTrackingDataToRegistry(name);\n+        failIfNeeded(\"setMuleContext\");\n+    }\n+\n+    @Override\n+    protected void onInit(MuleContext muleContext) throws InitialisationException {\n+        failIfNeeded(Initialisable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onStart() throws MuleException {\n+        failIfNeeded(Startable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onStop() throws MuleException {\n+        failIfNeeded(Stoppable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onDispose() {\n+        failIfNeeded(Disposable.PHASE_NAME);\n+    }\n+\n+\n+\n+    private void failIfNeeded(String phase) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTIwMDM3Ng==", "bodyText": "done", "url": "https://github.com/mulesoft/mule/pull/9442#discussion_r491200376", "createdAt": "2020-09-18T21:33:06Z", "author": {"login": "eze210"}, "path": "tests/test-components/src/main/java/org/mule/tests/api/pojos/LifecycleObject.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.tests.api.pojos;\n+\n+import org.mule.runtime.api.exception.MuleException;\n+import org.mule.runtime.api.lifecycle.Disposable;\n+import org.mule.runtime.api.lifecycle.Initialisable;\n+import org.mule.runtime.api.lifecycle.InitialisationException;\n+import org.mule.runtime.api.lifecycle.Startable;\n+import org.mule.runtime.api.lifecycle.Stoppable;\n+import org.mule.runtime.core.api.MuleContext;\n+import org.mule.runtime.extension.api.annotation.dsl.xml.TypeDsl;\n+import org.mule.runtime.extension.api.annotation.param.Optional;\n+import org.mule.runtime.extension.api.annotation.param.Parameter;\n+import org.mule.runtime.extension.api.annotation.param.RefName;\n+import org.mule.tests.api.LifecycleTrackerRegistry;\n+import org.mule.tests.internal.BaseLifecycleTracker;\n+\n+import javax.inject.Inject;\n+\n+@TypeDsl(allowTopLevelDefinition = true)\n+public class LifecycleObject extends BaseLifecycleTracker {\n+\n+    @Inject\n+    private LifecycleTrackerRegistry registry;\n+\n+    @RefName\n+    private String name;\n+\n+    @Optional\n+    @Parameter\n+    private String failurePhase;\n+\n+    @Optional\n+    @Parameter\n+    private String otherLifecycleObject;\n+\n+    public LifecycleObject() {\n+        super(false);\n+    }\n+\n+    @Override\n+    protected void onSetMuleContext(MuleContext muleContext) {\n+        addTrackingDataToRegistry(name);\n+        failIfNeeded(\"setMuleContext\");\n+    }\n+\n+    @Override\n+    protected void onInit(MuleContext muleContext) throws InitialisationException {\n+        failIfNeeded(Initialisable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onStart() throws MuleException {\n+        failIfNeeded(Startable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onStop() throws MuleException {\n+        failIfNeeded(Stoppable.PHASE_NAME);\n+    }\n+\n+    @Override\n+    protected void onDispose() {\n+        failIfNeeded(Disposable.PHASE_NAME);\n+    }\n+\n+\n+\n+    private void failIfNeeded(String phase) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NzY1OQ=="}, "originalCommit": {"oid": "e597149279f41e12b32b58bac9e012a5bb827935"}, "originalPosition": 74}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4723, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}