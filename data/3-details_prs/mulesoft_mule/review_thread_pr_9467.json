{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0MTgwODUy", "number": 9467, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMjowNzoyM1rOEohH0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMjozOTo1NVrOEqtWjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwOTIxMTY4OnYy", "diffSide": "RIGHT", "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMjowNzoyM1rOHZp5dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjo0NzozOVrOHcldbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MjkwMg==", "bodyText": "We should test that 2 different operations with the same value providerId and same values, return the same hash", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r496662902", "createdAt": "2020-09-29T12:07:23Z", "author": {"login": "lucianoRM"}, "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "diffHunk": "@@ -400,13 +399,24 @@ public void differentConfigsWithSameParameterGetDifferentHash() throws Exception\n   }\n \n   @Test\n-  public void differentValueProviderNameGetsDifferentHash() throws Exception {\n+  public void differentValueProviderNameGetsSameHash() throws Exception {\n     ArtifactDeclaration app = getBaseApp();\n     when(valueProviderModel.requiresConnection()).thenReturn(true);\n     when(valueProviderModel.requiresConfiguration()).thenReturn(true);\n     Optional<ValueProviderCacheId> opId1 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n     when(valueProviderModel.getProviderName()).thenReturn(\"newValueProviderName\");\n     Optional<ValueProviderCacheId> opId2 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n+    checkIdsAreEqual(opId1, opId2);\n+  }\n+\n+  @Test\n+  public void differentValueProviderIdGetsDifferentHash() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "567bd48967ef86c5a5b97f41544e1aabece42f1c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2ODUwMQ==", "bodyText": "https://github.com/mulesoft/mule/pull/9467/files#diff-651f29168e45b3db6280ce600b706537R402", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r496668501", "createdAt": "2020-09-29T12:17:03Z", "author": {"login": "gsfernandes"}, "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "diffHunk": "@@ -400,13 +399,24 @@ public void differentConfigsWithSameParameterGetDifferentHash() throws Exception\n   }\n \n   @Test\n-  public void differentValueProviderNameGetsDifferentHash() throws Exception {\n+  public void differentValueProviderNameGetsSameHash() throws Exception {\n     ArtifactDeclaration app = getBaseApp();\n     when(valueProviderModel.requiresConnection()).thenReturn(true);\n     when(valueProviderModel.requiresConfiguration()).thenReturn(true);\n     Optional<ValueProviderCacheId> opId1 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n     when(valueProviderModel.getProviderName()).thenReturn(\"newValueProviderName\");\n     Optional<ValueProviderCacheId> opId2 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n+    checkIdsAreEqual(opId1, opId2);\n+  }\n+\n+  @Test\n+  public void differentValueProviderIdGetsDifferentHash() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MjkwMg=="}, "originalCommit": {"oid": "567bd48967ef86c5a5b97f41544e1aabece42f1c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI4NTY0MA==", "bodyText": "But that is the same operation. I just want to make sure that there is nothing related to the operation itself used for the hashing. If we are using the operation name for example (which we shouldn't) this test will pass but the one I am asking to add should fail.", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r497285640", "createdAt": "2020-09-30T07:05:25Z", "author": {"login": "lucianoRM"}, "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "diffHunk": "@@ -400,13 +399,24 @@ public void differentConfigsWithSameParameterGetDifferentHash() throws Exception\n   }\n \n   @Test\n-  public void differentValueProviderNameGetsDifferentHash() throws Exception {\n+  public void differentValueProviderNameGetsSameHash() throws Exception {\n     ArtifactDeclaration app = getBaseApp();\n     when(valueProviderModel.requiresConnection()).thenReturn(true);\n     when(valueProviderModel.requiresConfiguration()).thenReturn(true);\n     Optional<ValueProviderCacheId> opId1 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n     when(valueProviderModel.getProviderName()).thenReturn(\"newValueProviderName\");\n     Optional<ValueProviderCacheId> opId2 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n+    checkIdsAreEqual(opId1, opId2);\n+  }\n+\n+  @Test\n+  public void differentValueProviderIdGetsDifferentHash() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MjkwMg=="}, "originalCommit": {"oid": "567bd48967ef86c5a5b97f41544e1aabece42f1c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIwNDQ1OQ==", "bodyText": "Ok, I will add another test with this scenario.", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r498204459", "createdAt": "2020-10-01T12:28:00Z", "author": {"login": "gsfernandes"}, "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "diffHunk": "@@ -400,13 +399,24 @@ public void differentConfigsWithSameParameterGetDifferentHash() throws Exception\n   }\n \n   @Test\n-  public void differentValueProviderNameGetsDifferentHash() throws Exception {\n+  public void differentValueProviderNameGetsSameHash() throws Exception {\n     ArtifactDeclaration app = getBaseApp();\n     when(valueProviderModel.requiresConnection()).thenReturn(true);\n     when(valueProviderModel.requiresConfiguration()).thenReturn(true);\n     Optional<ValueProviderCacheId> opId1 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n     when(valueProviderModel.getProviderName()).thenReturn(\"newValueProviderName\");\n     Optional<ValueProviderCacheId> opId2 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n+    checkIdsAreEqual(opId1, opId2);\n+  }\n+\n+  @Test\n+  public void differentValueProviderIdGetsDifferentHash() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MjkwMg=="}, "originalCommit": {"oid": "567bd48967ef86c5a5b97f41544e1aabece42f1c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTczNTkxNw==", "bodyText": "Done, please review this again.", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r499735917", "createdAt": "2020-10-05T16:47:39Z", "author": {"login": "gsfernandes"}, "path": "modules/spring-config/src/test/java/org/mule/runtime/config/dsl/model/ValueProviderCacheIdGeneratorTestCase.java", "diffHunk": "@@ -400,13 +399,24 @@ public void differentConfigsWithSameParameterGetDifferentHash() throws Exception\n   }\n \n   @Test\n-  public void differentValueProviderNameGetsDifferentHash() throws Exception {\n+  public void differentValueProviderNameGetsSameHash() throws Exception {\n     ArtifactDeclaration app = getBaseApp();\n     when(valueProviderModel.requiresConnection()).thenReturn(true);\n     when(valueProviderModel.requiresConfiguration()).thenReturn(true);\n     Optional<ValueProviderCacheId> opId1 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n     when(valueProviderModel.getProviderName()).thenReturn(\"newValueProviderName\");\n     Optional<ValueProviderCacheId> opId2 = computeIdFor(app, OPERATION_LOCATION, PROVIDED_PARAMETER_NAME);\n+    checkIdsAreEqual(opId1, opId2);\n+  }\n+\n+  @Test\n+  public void differentValueProviderIdGetsDifferentHash() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MjkwMg=="}, "originalCommit": {"oid": "567bd48967ef86c5a5b97f41544e1aabece42f1c"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMjE4NzAzOnYy", "diffSide": "RIGHT", "path": "modules/spring-config/src/main/java/org/mule/runtime/config/api/dsl/model/metadata/DslElementBasedValueProviderCacheIdGenerator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMjozOTo1NVrOHdEVsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMjo1MTo0MFrOHdEylQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI0MTg0MA==", "bodyText": "only the namespace and if not present the id? You are assuming that if the namespace is not present, then the id should be the identifier right?", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r500241840", "createdAt": "2020-10-06T12:39:55Z", "author": {"login": "lucianoRM"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/api/dsl/model/metadata/DslElementBasedValueProviderCacheIdGenerator.java", "diffHunk": "@@ -101,24 +103,32 @@ public DslElementBasedValueProviderCacheIdGenerator(ComponentLocator<DslElementM\n                                                                  Map<String, ParameterModelInformation> parameterModelsInformation) {\n     List<ValueProviderCacheId> parts = new LinkedList<>();\n \n-    parts.add(resolveValueProviderId(valueProviderModel));\n     parts.addAll(resolveActingParameterIds(valueProviderModel, parameterModelsInformation));\n+    parts.add(resolveValueProviderId(valueProviderModel));\n+    parts.add(aValueProviderCacheId(fromElementWithName(VALUE_PROVIDER).withHashValueFrom(VALUE_PROVIDER)));\n \n     String id = resolveDslTag(containerComponent).orElse(getSourceElementName(containerComponent));\n-    return of(aValueProviderCacheId(fromElementWithName(id).withHashValueFrom(id).containing(parts)));\n+    return of(aValueProviderCacheId(fromElementWithName(id)\n+        .withHashValueFrom(resolveDslTagNamespace(containerComponent).orElse(id)).containing(parts)));\n   }\n \n   private Optional<ValueProviderCacheId> resolveForComponentModel(DslElementModel<?> containerComponent,\n                                                                   ValueProviderModel valueProviderModel,\n                                                                   Map<String, ParameterModelInformation> parameterModelsInformation) {\n     List<ValueProviderCacheId> parts = new LinkedList<>();\n \n-    parts.add(resolveValueProviderId(valueProviderModel));\n     parts.addAll(resolveActingParameterIds(valueProviderModel, parameterModelsInformation));\n     parts.addAll(resolveIdForInjectedElements(containerComponent, valueProviderModel));\n+    parts.add(resolveValueProviderId(valueProviderModel));\n+    parts.add(aValueProviderCacheId(fromElementWithName(VALUE_PROVIDER).withHashValueFrom(VALUE_PROVIDER)));\n \n     String id = resolveDslTag(containerComponent).orElse(getSourceElementName(containerComponent));\n-    return of(aValueProviderCacheId(fromElementWithName(id).withHashValueFrom(id).containing(parts)));\n+    return of(aValueProviderCacheId(fromElementWithName(id)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50049d527484dedf89ba14a50ecea7305e28f9e"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI0OTIzNw==", "bodyText": "Yes, there is no other way to associate it to an extension.", "url": "https://github.com/mulesoft/mule/pull/9467#discussion_r500249237", "createdAt": "2020-10-06T12:51:40Z", "author": {"login": "gsfernandes"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/api/dsl/model/metadata/DslElementBasedValueProviderCacheIdGenerator.java", "diffHunk": "@@ -101,24 +103,32 @@ public DslElementBasedValueProviderCacheIdGenerator(ComponentLocator<DslElementM\n                                                                  Map<String, ParameterModelInformation> parameterModelsInformation) {\n     List<ValueProviderCacheId> parts = new LinkedList<>();\n \n-    parts.add(resolveValueProviderId(valueProviderModel));\n     parts.addAll(resolveActingParameterIds(valueProviderModel, parameterModelsInformation));\n+    parts.add(resolveValueProviderId(valueProviderModel));\n+    parts.add(aValueProviderCacheId(fromElementWithName(VALUE_PROVIDER).withHashValueFrom(VALUE_PROVIDER)));\n \n     String id = resolveDslTag(containerComponent).orElse(getSourceElementName(containerComponent));\n-    return of(aValueProviderCacheId(fromElementWithName(id).withHashValueFrom(id).containing(parts)));\n+    return of(aValueProviderCacheId(fromElementWithName(id)\n+        .withHashValueFrom(resolveDslTagNamespace(containerComponent).orElse(id)).containing(parts)));\n   }\n \n   private Optional<ValueProviderCacheId> resolveForComponentModel(DslElementModel<?> containerComponent,\n                                                                   ValueProviderModel valueProviderModel,\n                                                                   Map<String, ParameterModelInformation> parameterModelsInformation) {\n     List<ValueProviderCacheId> parts = new LinkedList<>();\n \n-    parts.add(resolveValueProviderId(valueProviderModel));\n     parts.addAll(resolveActingParameterIds(valueProviderModel, parameterModelsInformation));\n     parts.addAll(resolveIdForInjectedElements(containerComponent, valueProviderModel));\n+    parts.add(resolveValueProviderId(valueProviderModel));\n+    parts.add(aValueProviderCacheId(fromElementWithName(VALUE_PROVIDER).withHashValueFrom(VALUE_PROVIDER)));\n \n     String id = resolveDslTag(containerComponent).orElse(getSourceElementName(containerComponent));\n-    return of(aValueProviderCacheId(fromElementWithName(id).withHashValueFrom(id).containing(parts)));\n+    return of(aValueProviderCacheId(fromElementWithName(id)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI0MTg0MA=="}, "originalCommit": {"oid": "b50049d527484dedf89ba14a50ecea7305e28f9e"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4742, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}