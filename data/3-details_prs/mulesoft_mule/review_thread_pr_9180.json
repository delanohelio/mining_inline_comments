{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NDU5NTcz", "number": 9180, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozMjo0MlrOEWy1Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozNToyMlrOEWy5gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMzM2OTA2OnYy", "diffSide": "RIGHT", "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozMjo0MlrOG-OsgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozMjo0MlrOG-OsgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkwNTY2NA==", "bodyText": "remove unused parameters elementDsl and parameterized", "url": "https://github.com/mulesoft/mule/pull/9180#discussion_r467905664", "createdAt": "2020-08-10T13:32:42Z", "author": {"login": "mlischetti"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "diffHunk": "@@ -528,75 +410,56 @@ private void populateParameterizedElements(ParameterizedModel model, DslElementS\n         .forEach(p -> addElementParameter(innerComponents, parameters, elementDsl, builder, p));\n   }\n \n-  private void populateComposableElements(ComposableModel model, DslElementSyntax elementDsl,\n+  private void populateConnectionProviderElements(NamedObject model, DslElementSyntax elementDsl,\n+                                                  DslElementModel.Builder builder, ComponentAst configuration) {\n+    configuration.directChildrenStream()\n+        .filter(c -> c.getModel(ConnectionProviderModel.class).isPresent())\n+        .forEach(nestedComponentConfig -> create(nestedComponentConfig).ifPresent(builder::containing));\n+  }\n+\n+  private void populateComposableElements(NamedObject model, DslElementSyntax elementDsl,\n                                           DslElementModel.Builder builder, ComponentAst configuration) {\n+    final List<String> paramsAsChildrenNames = configuration.getModel(ParameterizedModel.class)\n+        .map(pmz -> pmz.getAllParameterModels()\n+            .stream()\n+            .map(pm -> hyphenize(pm.getName()))\n+            .collect(toList()))\n+        .orElse(emptyList());\n \n     configuration.directChildrenStream()\n-        .forEach(nestedComponentConfig -> {\n-          DslElementModel nestedElement = createIdentifiedElement(nestedComponentConfig);\n-          if (nestedElement != null) {\n-            builder.containing(nestedElement);\n-          } else {\n-            model.getNestedComponents()\n-                .stream()\n-                .filter(nestedModel -> nestedModel instanceof NestedRouteModel)\n-                .filter(nestedModel -> elementDsl.getContainedElement(nestedModel.getName())\n-                    .map(nestedDsl -> getIdentifier(nestedDsl).map(id -> nestedComponentConfig.getIdentifier().equals(id))\n-                        .orElse(false))\n-                    .orElse(false))\n-                .findFirst()\n-                .ifPresent(nestedModel -> {\n-                  DslElementSyntax routeDsl = elementDsl.getContainedElement(nestedModel.getName()).get();\n-                  DslElementModel.Builder<? extends NestableElementModel> routeBuilder =\n-                      DslElementModel.<NestableElementModel>builder()\n-                          .withModel(nestedModel)\n-                          .withDsl(routeDsl)\n-                          .withConfig(nestedComponentConfig)\n-                          .isExplicitInDsl(true);\n-\n-                  populateParameterizedElements((ParameterizedModel) nestedModel, routeDsl, routeBuilder, nestedComponentConfig);\n-                  nestedComponentConfig.directChildrenStream()\n-                      .forEach(routeElement -> {\n-                        DslElementModel nestableElementModel = createIdentifiedElement(routeElement);\n-                        if (nestableElementModel != null) {\n-                          routeBuilder.containing(nestableElementModel);\n-                        }\n-                      });\n-\n-                  builder.containing(routeBuilder.build());\n-                });\n-          }\n-        });\n+        // TODO MULE-17711 Remove this filter\n+        .filter(c -> !paramsAsChildrenNames.contains(c.getIdentifier().getName()))\n+        .filter(c -> !c.getModel(ConnectionProviderModel.class).isPresent())\n+        .forEach(nestedComponentConfig -> create(nestedComponentConfig).ifPresent(builder::containing));\n   }\n \n-  private void addInlineGroup(DslElementSyntax elementDsl,\n+  private void addInlineGroup(DslElementSyntax elementDsl, ComponentAst parameterized,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f03504b19c0b68e63eec5ef44df9fa8ec27db72b"}, "originalPosition": 410}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMzM3MjQzOnYy", "diffSide": "RIGHT", "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozMzoyOVrOG-Oukw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozMzoyOVrOG-Oukw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkwNjE5NQ==", "bodyText": "remove unused parameters: model, elementDsl", "url": "https://github.com/mulesoft/mule/pull/9180#discussion_r467906195", "createdAt": "2020-08-10T13:33:29Z", "author": {"login": "mlischetti"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "diffHunk": "@@ -528,75 +410,56 @@ private void populateParameterizedElements(ParameterizedModel model, DslElementS\n         .forEach(p -> addElementParameter(innerComponents, parameters, elementDsl, builder, p));\n   }\n \n-  private void populateComposableElements(ComposableModel model, DslElementSyntax elementDsl,\n+  private void populateConnectionProviderElements(NamedObject model, DslElementSyntax elementDsl,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f03504b19c0b68e63eec5ef44df9fa8ec27db72b"}, "originalPosition": 351}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMzM4MDUwOnYy", "diffSide": "RIGHT", "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozNToyMlrOG-OzYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzozNToyMlrOG-OzYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkwNzQyNQ==", "bodyText": "remove unused parameters: model, elementDsl", "url": "https://github.com/mulesoft/mule/pull/9180#discussion_r467907425", "createdAt": "2020-08-10T13:35:22Z", "author": {"login": "mlischetti"}, "path": "modules/spring-config/src/main/java/org/mule/runtime/config/internal/dsl/model/ComponentAstBasedElementModelFactory.java", "diffHunk": "@@ -528,75 +410,56 @@ private void populateParameterizedElements(ParameterizedModel model, DslElementS\n         .forEach(p -> addElementParameter(innerComponents, parameters, elementDsl, builder, p));\n   }\n \n-  private void populateComposableElements(ComposableModel model, DslElementSyntax elementDsl,\n+  private void populateConnectionProviderElements(NamedObject model, DslElementSyntax elementDsl,\n+                                                  DslElementModel.Builder builder, ComponentAst configuration) {\n+    configuration.directChildrenStream()\n+        .filter(c -> c.getModel(ConnectionProviderModel.class).isPresent())\n+        .forEach(nestedComponentConfig -> create(nestedComponentConfig).ifPresent(builder::containing));\n+  }\n+\n+  private void populateComposableElements(NamedObject model, DslElementSyntax elementDsl,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f03504b19c0b68e63eec5ef44df9fa8ec27db72b"}, "originalPosition": 358}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4797, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}