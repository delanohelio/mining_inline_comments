{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MTA1MjAz", "number": 9509, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMTo1MTowOVrOEq7yKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowODoyMlrOErMqDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNDU1MTQ3OnYy", "diffSide": "RIGHT", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMTo1MTowOVrOHdbOJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMTo1MTowOVrOHdbOJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDYxNjc0Mw==", "bodyText": "bad usage of scheduler:\n\nYou're creating a scheduler which you never dispose\nAll scheduling should be done through the scheduling service", "url": "https://github.com/mulesoft/mule/pull/9509#discussion_r500616743", "createdAt": "2020-10-06T21:51:09Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "diffHunk": "@@ -323,22 +313,25 @@ public void onException(ConnectionException exception) {\n                        sourceAdapter.getName(), getLocation().getRootContainerName()),\n                 exception);\n \n-    Mono<Void> reconnectionAction = sourceAdapter.getReconnectionAction(exception)\n-        .map(p -> from(retryPolicyTemplate.applyPolicy(p, retryScheduler)))\n-        .orElseGet(() -> create(sink -> {\n-          try {\n-            exception.getConnection().ifPresent(sourceConnectionManager::invalidate);\n-            restart(new ReactiveReconnectionCallback(sink));\n-          } catch (Exception e) {\n-            sink.error(e);\n-          }\n-        }));\n-\n-    reconnectionAction\n-        .doOnSuccess(v -> onReconnectionSuccessful())\n-        .doOnError(this::onReconnectionFailed)\n-        .doAfterTerminate(() -> reconnecting.set(false))\n-        .subscribe();\n+    Executors.newSingleThreadExecutor().submit(() -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "229edf9191c294a7a2c96decc10c4a53c030ee0a"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNDU1Mzk4OnYy", "diffSide": "RIGHT", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMTo1MjowNlrOHdbPyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMTo1MjowNlrOHdbPyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDYxNzE2Mg==", "bodyText": "delete and use org.mule.runtime.core.internal.util.rx.ImmediateScheduler#IMMEDIATE_SCHEDULER instead", "url": "https://github.com/mulesoft/mule/pull/9509#discussion_r500617162", "createdAt": "2020-10-06T21:52:06Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "diffHunk": "@@ -747,4 +707,12 @@ private void stopUsingConfiguration(CoreEvent event) {\n   public String toString() {\n     return this.getClass().getSimpleName() + \": \" + Objects.toString(sourceAdapter);\n   }\n+\n+  private class ImmediateExecutor implements Executor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "229edf9191c294a7a2c96decc10c4a53c030ee0a"}, "originalPosition": 157}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNzMwMzEyOnYy", "diffSide": "RIGHT", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowNTozMlrOHd1F5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDoyNDo0MVrOHd2AgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA0MDYxNQ==", "bodyText": "you already have a retry scheduler. Why not reuse that one?", "url": "https://github.com/mulesoft/mule/pull/9509#discussion_r501040615", "createdAt": "2020-10-07T14:05:32Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "diffHunk": "@@ -149,6 +148,7 @@\n   private SourceAdapter sourceAdapter;\n   private RetryPolicyTemplate retryPolicyTemplate;\n   private Scheduler retryScheduler;\n+  private Scheduler reconnectScheduler;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4488b231f05bebf18dfc2bc5e6351c9b34a6b96"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA1NTYxNw==", "bodyText": "Done", "url": "https://github.com/mulesoft/mule/pull/9509#discussion_r501055617", "createdAt": "2020-10-07T14:24:41Z", "author": {"login": "gabrieldalborgo"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "diffHunk": "@@ -149,6 +148,7 @@\n   private SourceAdapter sourceAdapter;\n   private RetryPolicyTemplate retryPolicyTemplate;\n   private Scheduler retryScheduler;\n+  private Scheduler reconnectScheduler;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA0MDYxNQ=="}, "originalCommit": {"oid": "d4488b231f05bebf18dfc2bc5e6351c9b34a6b96"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNzMxNTk4OnYy", "diffSide": "RIGHT", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowODoyMlrOHd1OOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowODoyMlrOHd1OOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA0Mjc0Ng==", "bodyText": "to create and destroy the scheduler on each use is not a good way of handling the lifecycle", "url": "https://github.com/mulesoft/mule/pull/9509#discussion_r501042746", "createdAt": "2020-10-07T14:08:22Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/source/ExtensionMessageSource.java", "diffHunk": "@@ -464,6 +468,14 @@ private void stopSchedulers() {\n         retryScheduler = null;\n       }\n     }\n+\n+    if (reconnectScheduler != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4488b231f05bebf18dfc2bc5e6351c9b34a6b96"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4678, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}