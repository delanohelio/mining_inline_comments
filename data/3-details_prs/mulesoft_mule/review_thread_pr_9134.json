{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4NjU5MTA0", "number": 9134, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDowMjowMFrOETZ_Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDowMjowMFrOETZ_Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4Nzg0MTkwOnYy", "diffSide": "LEFT", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDowMjowMFrOG5ICnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDowOTo1OFrOG5IVUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1Mzc1Ng==", "bodyText": "why is this the problem? Who else can remove items from the cache?", "url": "https://github.com/mulesoft/mule/pull/9134#discussion_r462553756", "createdAt": "2020-07-29T20:02:00Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "diffHunk": "@@ -217,7 +220,6 @@ protected void registerConfiguration(ConfigurationInstance configuration) {\n   public List<ConfigurationInstance> getExpired() {\n     return cache.asMap().entrySet().stream().filter(entry -> isExpired(entry.getValue())).map(entry -> {\n       cache.invalidate(entry.getKey());\n-      unRegisterConfiguration(entry.getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da49cb8a123d39b443b009b710256beb8aafa9a0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1NDIzNQ==", "bodyText": "There is a list in the parent class which isn't cleaned up", "url": "https://github.com/mulesoft/mule/pull/9134#discussion_r462554235", "createdAt": "2020-07-29T20:02:53Z", "author": {"login": "eze210"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "diffHunk": "@@ -217,7 +220,6 @@ protected void registerConfiguration(ConfigurationInstance configuration) {\n   public List<ConfigurationInstance> getExpired() {\n     return cache.asMap().entrySet().stream().filter(entry -> isExpired(entry.getValue())).map(entry -> {\n       cache.invalidate(entry.getKey());\n-      unRegisterConfiguration(entry.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1Mzc1Ng=="}, "originalCommit": {"oid": "da49cb8a123d39b443b009b710256beb8aafa9a0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1NDQyNQ==", "bodyText": "Sorry, the cache's removalListener", "url": "https://github.com/mulesoft/mule/pull/9134#discussion_r462554425", "createdAt": "2020-07-29T20:03:16Z", "author": {"login": "eze210"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "diffHunk": "@@ -217,7 +220,6 @@ protected void registerConfiguration(ConfigurationInstance configuration) {\n   public List<ConfigurationInstance> getExpired() {\n     return cache.asMap().entrySet().stream().filter(entry -> isExpired(entry.getValue())).map(entry -> {\n       cache.invalidate(entry.getKey());\n-      unRegisterConfiguration(entry.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1Mzc1Ng=="}, "originalCommit": {"oid": "da49cb8a123d39b443b009b710256beb8aafa9a0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1NTg0Nw==", "bodyText": "that's not what I asked. Your fix is to move this from here to the remove listener. My question is, why does that fix the problem? that makes sense if the item gets removed from the cache from any place other than this. Which place is that?", "url": "https://github.com/mulesoft/mule/pull/9134#discussion_r462555847", "createdAt": "2020-07-29T20:05:13Z", "author": {"login": "marianogonzalez"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "diffHunk": "@@ -217,7 +220,6 @@ protected void registerConfiguration(ConfigurationInstance configuration) {\n   public List<ConfigurationInstance> getExpired() {\n     return cache.asMap().entrySet().stream().filter(entry -> isExpired(entry.getValue())).map(entry -> {\n       cache.invalidate(entry.getKey());\n-      unRegisterConfiguration(entry.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1Mzc1Ng=="}, "originalCommit": {"oid": "da49cb8a123d39b443b009b710256beb8aafa9a0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1ODU0NA==", "bodyText": "The cache has a time-based eviction policy (see expireAfterAccess(expirationPolicy.getMaxIdleTime(), expirationPolicy.getTimeUnit()) )\nIt's automatically called on cache maintenance", "url": "https://github.com/mulesoft/mule/pull/9134#discussion_r462558544", "createdAt": "2020-07-29T20:09:58Z", "author": {"login": "eze210"}, "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/runtime/config/DynamicConfigurationProvider.java", "diffHunk": "@@ -217,7 +220,6 @@ protected void registerConfiguration(ConfigurationInstance configuration) {\n   public List<ConfigurationInstance> getExpired() {\n     return cache.asMap().entrySet().stream().filter(entry -> isExpired(entry.getValue())).map(entry -> {\n       cache.invalidate(entry.getKey());\n-      unRegisterConfiguration(entry.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1Mzc1Ng=="}, "originalCommit": {"oid": "da49cb8a123d39b443b009b710256beb8aafa9a0"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4858, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}