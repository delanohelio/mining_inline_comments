{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNjYyODQ0", "number": 9459, "title": "MULE-18794: Cannot access application resources from KeyResolver for Configurations Part 2", "bodyText": "", "createdAt": "2020-09-24T19:46:19Z", "url": "https://github.com/mulesoft/mule/pull/9459", "merged": true, "mergeCommit": {"oid": "3fcf25e9df3851b9bac4ec3d185850bbcbb958a1"}, "closed": true, "closedAt": "2020-10-05T19:58:17Z", "author": {"login": "SebaElizalde"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMGizJAH2gAyNDkyNjYyODQ0OjkzNmVhNTAyNzZjYzNmOTM4ODBiNjdjMDZmMjEwZGNiNDQyN2M1MjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPnfUGAFqTUwMjI4MzM5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521", "author": {"user": {"login": "SebaElizalde", "name": "Sebastian Elizalde"}}, "url": "https://github.com/mulesoft/mule/commit/936ea50276cc3f93880b67c06f210dcb4427c521", "committedDate": "2020-09-24T19:41:46Z", "message": "fix and tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMzA5NzEy", "url": "https://github.com/mulesoft/mule/pull/9459#pullrequestreview-500309712", "createdAt": "2020-10-01T12:48:16Z", "commit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxMjo0ODoxNlrOHbIwPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxMjo1MTozOVrOHbI4cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIxNzAyMQ==", "bodyText": "I would set the type resolver for a specific operation you want to modify, or create a new one.", "url": "https://github.com/mulesoft/mule/pull/9459#discussion_r498217021", "createdAt": "2020-10-01T12:48:16Z", "author": {"login": "ndinu"}, "path": "tests/test-extensions/classloading-extension/src/main/java/org/mule/test/classloading/ClassLoadingExtension.java", "diffHunk": "@@ -11,12 +11,14 @@\n import org.mule.runtime.extension.api.annotation.Extension;\n import org.mule.runtime.extension.api.annotation.connectivity.ConnectionProviders;\n import org.mule.runtime.extension.api.annotation.dsl.xml.Xml;\n+import org.mule.runtime.extension.api.annotation.metadata.MetadataScope;\n import org.mule.test.classloading.api.ClassLoadingHelper;\n \n @Extension(name = \"ClassLoading\")\n @Xml(prefix = \"classloading\")\n @ConnectionProviders({CLPoolingConnectionProvider.class, CLCachedConnectionProvider.class, CLNoneConnectionProvider.class})\n @Configurations(CLConfiguration.class)\n+@MetadataScope(keysResolver = CLKeysResolver.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIxNzUyOQ==", "bodyText": "call the field metadataService", "url": "https://github.com/mulesoft/mule/pull/9459#discussion_r498217529", "createdAt": "2020-10-01T12:49:09Z", "author": {"login": "ndinu"}, "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/classloading/ClassLoadingOnConnectionsTestCase.java", "diffHunk": "@@ -29,13 +34,18 @@\n import java.util.Map;\n import java.util.Set;\n \n+import javax.inject.Inject;\n+\n import org.hamcrest.Matcher;\n import org.hamcrest.core.StringContains;\n import org.junit.Rule;\n import org.junit.Test;\n \n public class ClassLoadingOnConnectionsTestCase extends AbstractExtensionFunctionalTestCase {\n \n+  @Inject\n+  private MetadataService metadataManager;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIxNzkyNA==", "bodyText": "I don't feel that this test belongs in this class.", "url": "https://github.com/mulesoft/mule/pull/9459#discussion_r498217924", "createdAt": "2020-10-01T12:49:44Z", "author": {"login": "ndinu"}, "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/classloading/ClassLoadingOnConnectionsTestCase.java", "diffHunk": "@@ -72,6 +82,12 @@ public void allOptionalParameterGroup() throws Exception {\n     verifyUsedClassLoaders(ALL_OPTIONAL_PARAMETER_GROUP);\n   }\n \n+  @Test\n+  public void operationWithMetadataResolver() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIxOTEyMw==", "bodyText": "If you are going to assert that the operation metadata key resolution and source metadata key resolution are using the correct class loader, I would make them use two different resolvers, and use the addClassLoader method with different values.", "url": "https://github.com/mulesoft/mule/pull/9459#discussion_r498219123", "createdAt": "2020-10-01T12:51:39Z", "author": {"login": "ndinu"}, "path": "tests/test-extensions/classloading-extension/src/main/java/org/mule/test/classloading/CLKeysResolver.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com\n+ * The software in this package is published under the terms of the CPAL v1.0\n+ * license, a copy of which has been included with this distribution in the\n+ * LICENSE.txt file.\n+ */\n+package org.mule.test.classloading;\n+\n+import static org.mule.metadata.api.model.MetadataFormat.JAVA;\n+import static org.mule.test.classloading.api.ClassLoadingHelper.addClassLoader;\n+\n+import org.mule.metadata.api.builder.BaseTypeBuilder;\n+import org.mule.metadata.api.model.MetadataType;\n+import org.mule.runtime.api.connection.ConnectionException;\n+import org.mule.runtime.api.metadata.MetadataContext;\n+import org.mule.runtime.api.metadata.MetadataKey;\n+import org.mule.runtime.api.metadata.MetadataKeyBuilder;\n+import org.mule.runtime.api.metadata.MetadataResolvingException;\n+import org.mule.runtime.api.metadata.resolving.OutputTypeResolver;\n+import org.mule.runtime.api.metadata.resolving.TypeKeysResolver;\n+\n+import java.util.Set;\n+\n+import com.google.common.collect.ImmutableSet;\n+\n+public class CLKeysResolver implements TypeKeysResolver, OutputTypeResolver {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "936ea50276cc3f93880b67c06f210dcb4427c521"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f8a6b772aca9bbe305587c693567e4d09463d5a", "author": {"user": {"login": "SebaElizalde", "name": "Sebastian Elizalde"}}, "url": "https://github.com/mulesoft/mule/commit/6f8a6b772aca9bbe305587c693567e4d09463d5a", "committedDate": "2020-10-01T20:27:04Z", "message": "PR review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f7225b6e2d4431c77909e0a67b7017e1efea21", "author": {"user": {"login": "SebaElizalde", "name": "Sebastian Elizalde"}}, "url": "https://github.com/mulesoft/mule/commit/27f7225b6e2d4431c77909e0a67b7017e1efea21", "committedDate": "2020-10-01T20:31:30Z", "message": "removed unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjE0Mzcz", "url": "https://github.com/mulesoft/mule/pull/9459#pullrequestreview-502214373", "createdAt": "2020-10-05T16:14:28Z", "commit": {"oid": "27f7225b6e2d4431c77909e0a67b7017e1efea21"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04f2ed1530c7aa348d30a2b7a403b38865149185", "author": {"user": {"login": "SebaElizalde", "name": "Sebastian Elizalde"}}, "url": "https://github.com/mulesoft/mule/commit/04f2ed1530c7aa348d30a2b7a403b38865149185", "committedDate": "2020-10-05T17:40:40Z", "message": "unnecessary metadata scope"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjgzMzky", "url": "https://github.com/mulesoft/mule/pull/9459#pullrequestreview-502283392", "createdAt": "2020-10-05T17:46:36Z", "commit": {"oid": "04f2ed1530c7aa348d30a2b7a403b38865149185"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1232, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}