{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MjU2OTQ0", "number": 9758, "title": "MULE-19015: Nested foreach with batch-size bigger than 1 close CursorStreamProvider", "bodyText": "", "createdAt": "2020-11-19T21:55:16Z", "url": "https://github.com/mulesoft/mule/pull/9758", "merged": true, "mergeCommit": {"oid": "aedcc0c319ac6ab289841f957830b7947abcce30"}, "closed": true, "closedAt": "2020-11-20T21:27:37Z", "author": {"login": "mlischetti"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeJ8sQAH2gAyNTI0MjU2OTQ0OjQxMTE5NDkyYjJmYmQ4NDUxNjc4MDVkMWQ5ZmNjNGYxYTQwZDc5YmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdebmaAgFqTUzNTY3NjQ0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "41119492b2fbd845167805d1d9fcc4f1a40d79be", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/41119492b2fbd845167805d1d9fcc4f1a40d79be", "committedDate": "2020-11-19T21:50:24Z", "message": "MULE-19015: Nested foreach with batch-size bigger than 1 close CursorStreamProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84bd3d27884ada34e5584c28a69da951aebb1bb3", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/84bd3d27884ada34e5584c28a69da951aebb1bb3", "committedDate": "2020-11-20T15:24:29Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NjE3MjIw", "url": "https://github.com/mulesoft/mule/pull/9758#pullrequestreview-535617220", "createdAt": "2020-11-20T17:12:10Z", "commit": {"oid": "84bd3d27884ada34e5584c28a69da951aebb1bb3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNzoxMjoxMVrOH3Yn6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNzoxMjoxMVrOH3Yn6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzgzNzE2MA==", "bodyText": "this is quite similar to ForeachRouter#createTypedValuePartToProcess. Refactor.", "url": "https://github.com/mulesoft/mule/pull/9758#discussion_r527837160", "createdAt": "2020-11-20T17:12:11Z", "author": {"login": "elrodro83"}, "path": "core/src/main/java/org/mule/runtime/core/internal/routing/Foreach.java", "diffHunk": "@@ -155,14 +158,24 @@ boolean validateExpression(CoreEvent event) {\n     return result;\n   }\n \n-  TypedValue setCurrentValue(int batchSize, ForeachContext foreachContext) {\n+  TypedValue setCurrentValue(int batchSize, ForeachContext foreachContext, CoreEvent event) {\n     TypedValue currentValue;\n     Iterator<TypedValue<?>> iterator = foreachContext.getIterator();\n     if (batchSize > 1) {\n       int counter = 0;\n       List currentBatch = new ArrayList<>();\n       while (iterator.hasNext() && counter < batchSize) {\n-        currentBatch.add(iterator.next());\n+        TypedValue managedValue;\n+        TypedValue<?> typedValue = iterator.next();\n+        if (typedValue.getValue() instanceof EventBuilderConfigurer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84bd3d27884ada34e5584c28a69da951aebb1bb3"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NjE5NDIw", "url": "https://github.com/mulesoft/mule/pull/9758#pullrequestreview-535619420", "createdAt": "2020-11-20T17:14:57Z", "commit": {"oid": "84bd3d27884ada34e5584c28a69da951aebb1bb3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bf1a43b3f91c71bdb96a51b134dd8b402f0d0cb", "author": {"user": {"login": "mlischetti", "name": "Mariano Lischetti"}}, "url": "https://github.com/mulesoft/mule/commit/8bf1a43b3f91c71bdb96a51b134dd8b402f0d0cb", "committedDate": "2020-11-20T17:28:24Z", "message": "review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NjYyMjM0", "url": "https://github.com/mulesoft/mule/pull/9758#pullrequestreview-535662234", "createdAt": "2020-11-20T18:03:07Z", "commit": {"oid": "8bf1a43b3f91c71bdb96a51b134dd8b402f0d0cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1Njc2NDQy", "url": "https://github.com/mulesoft/mule/pull/9758#pullrequestreview-535676442", "createdAt": "2020-11-20T18:24:21Z", "commit": {"oid": "8bf1a43b3f91c71bdb96a51b134dd8b402f0d0cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1094, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}