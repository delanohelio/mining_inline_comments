{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyOTEyMTc5", "number": 2854, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0Mjo1N1rODkuwPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0ODoyNVrODku5Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODQxMzQzOnYy", "diffSide": "RIGHT", "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProcessingCheck.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0Mjo1N1rOFxNw7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0Mjo1N1rOFxNw7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE1MDA2Mg==", "bodyText": "two options here:\n\nyou can replace property.propertyName()::equals by property::isNamed\nor you can drop isNamed(String), as I have to feeling that it does the same at the end  (see line below)", "url": "https://github.com/SonarSource/sonar-java/pull/2854#discussion_r387150062", "createdAt": "2020-03-03T16:42:57Z", "author": {"login": "m-g-sonar"}, "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProcessingCheck.java", "diffHunk": "@@ -339,8 +346,13 @@ private ProgramState checkArguments(ProgramState state, Arguments arguments, Xxe\n       return state;\n     }\n \n-    boolean isSettingProperty(ExpressionTree arg0, String propertyName) {\n-      return arg0.asConstant(String.class).filter(propertyName::equals).isPresent();\n+    boolean isSettingProperty(ProgramState state, ExpressionTree arg0, XxeProperty property) {\n+      if (arg0.asConstant(String.class).filter(property.propertyName()::equals).isPresent()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6582a2408f6ecf520db8439bddb1377ff8b0d3d"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODQyNzM4OnYy", "diffSide": "RIGHT", "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProcessingCheck.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0NjoxN1rOFxN5ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0NjoxN1rOFxN5ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE1MjIzNA==", "bodyText": "what about property.propertyName().equals(value.get()) and drop isNamed? or maybe we don't need anymore propertyName()", "url": "https://github.com/SonarSource/sonar-java/pull/2854#discussion_r387152234", "createdAt": "2020-03-03T16:46:17Z", "author": {"login": "m-g-sonar"}, "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProcessingCheck.java", "diffHunk": "@@ -351,6 +363,23 @@ public ProgramState checkPostStatement(CheckerContext context, Tree syntaxNode)\n     return visitor.programState;\n   }\n \n+  private static ProgramState addNamedConstraint(@Nullable ExpressionTree expressionTree, ProgramState state) {\n+    if (expressionTree != null) {\n+      SymbolicValue sv = state.peekValue();\n+      if (sv != null) {\n+        Optional<String> value = expressionTree.asConstant(String.class);\n+        if (value.isPresent()) {\n+          for (XxeProperty property : PROPERTIES_TO_CHECK) {\n+            if (property.isNamed(value.get())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6582a2408f6ecf520db8439bddb1377ff8b0d3d"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODQzNjMwOnYy", "diffSide": "RIGHT", "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProperty.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0ODoyNVrOFxN-1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo0ODoyNVrOFxN-1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE1MzYyMA==", "bodyText": "I would put named on the first line, next to propertyName to group them semantically.", "url": "https://github.com/SonarSource/sonar-java/pull/2854#discussion_r387153620", "createdAt": "2020-03-03T16:48:25Z", "author": {"login": "m-g-sonar"}, "path": "java-frontend/src/main/java/org/sonar/java/se/checks/XxeProperty.java", "diffHunk": "@@ -81,24 +89,28 @@ static boolean isSetToTrue(@Nullable SymbolicValue sv1, ExpressionTree arg1) {\n     private final BiPredicate<SymbolicValue, ExpressionTree> unsecuring;\n     private final Constraint unsecured;\n \n+    private final Constraint named;\n+\n     public XxePropertyHolder(String propertyName,\n       BiPredicate<SymbolicValue, ExpressionTree> securing, Constraint secured,\n-      BiPredicate<SymbolicValue, ExpressionTree> unsecuring, Constraint unsecured) {\n+      BiPredicate<SymbolicValue, ExpressionTree> unsecuring, Constraint unsecured, Constraint named) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6582a2408f6ecf520db8439bddb1377ff8b0d3d"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4069, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}