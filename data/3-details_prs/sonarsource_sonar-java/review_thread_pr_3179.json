{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3Mzc4NjQ2", "number": 3179, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODozNzowN1rOEj8xHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyNDowOVrOEkB5jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTMxMjMwOnYy", "diffSide": "RIGHT", "path": "java-checks-test-sources/src/main/java/checks/NonRandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODozNzowN1rOHSmQSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoxNTozMlrOHSt-Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI2MzE3OQ==", "bodyText": "Usually when the code is simple enough, we try to keep one file for both compliant and noncompliant examples.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489263179", "createdAt": "2020-09-16T08:37:07Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks-test-sources/src/main/java/checks/NonRandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package checks;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMxNjQyOA==", "bodyText": "This was the intention to check the file without any issues. Because otherwise this case is not covered.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489316428", "createdAt": "2020-09-16T09:59:26Z", "author": {"login": "margarita-nedzelska-sonarsource"}, "path": "java-checks-test-sources/src/main/java/checks/NonRandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package checks;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI2MzE3OQ=="}, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM4OTYzNA==", "bodyText": "It makes sense indeed.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489389634", "createdAt": "2020-09-16T12:15:32Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks-test-sources/src/main/java/checks/NonRandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package checks;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI2MzE3OQ=="}, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTM3Mzg5OnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODo1MTowMFrOHSm2ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODo1MTowMFrOHSm2ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI3Mjk3MA==", "bodyText": "This formatting looks strange, is it intended? Same for the next MethodMatchers.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489272970", "createdAt": "2020-09-16T08:51:00Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()\n+      .build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTQwMTM3OnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODo1Nzo0MFrOHSnHog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwODo1Nzo0MFrOHSnHog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI3NzM0Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private static final String MESSAGE = \"Replace randomly generated values with a fixed ones.\";\n          \n          \n            \n              private static final String MESSAGE = \"Replace randomly generated values with fixed ones.\";", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489277346", "createdAt": "2020-09-16T08:57:40Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final MethodMatchers RANDOM_UUID_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.UUID\")\n+    .names(\"randomUUID\")\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final String LOCATIONS_TEXT = \"usage of random data in test\";\n+  private static final String MESSAGE = \"Replace randomly generated values with a fixed ones.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTQxMzg0OnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTowMDo1MlrOHSnPaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTowMDo1MlrOHSnPaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI3OTMzOQ==", "bodyText": "I tend to agree that reporting only one issue per test file is enough, we should just make sure that the rspec description reflects this behavior (current Highlighting part mention that one issue per method will be reported).", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489279339", "createdAt": "2020-09-16T09:00:52Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final MethodMatchers RANDOM_UUID_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.UUID\")\n+    .names(\"randomUUID\")\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final String LOCATIONS_TEXT = \"usage of random data in test\";\n+  private static final String MESSAGE = \"Replace randomly generated values with a fixed ones.\";\n+\n+  private boolean reportedUUIDRandom = false;\n+  private final List<Tree> randomSecondaryLocations = new ArrayList<>();\n+\n+\n+  @Override\n+  public List<Tree.Kind> nodesToVisit() {\n+    return Arrays.asList(Tree.Kind.METHOD_INVOCATION, Tree.Kind.NEW_CLASS);\n+  }\n+\n+  @Override\n+  public void visitNode(Tree tree) {\n+    if (tree.is(Tree.Kind.NEW_CLASS)) {\n+      checkForRandomConstructorUsage(tree);\n+    }\n+    if (!reportedUUIDRandom && tree.is(Tree.Kind.METHOD_INVOCATION)) {\n+      checkAndReportUUIDRandomUsage(tree);\n+    }\n+  }\n+\n+  private void checkForRandomConstructorUsage(Tree tree) {\n+    NewClassTree newClassTree = (NewClassTree) tree;\n+    if (RANDOM_CONSTRUCTOR_METHOD_MATCHER.matches(newClassTree)) {\n+      randomSecondaryLocations.add(tree);\n+    }\n+  }\n+\n+  private void checkAndReportUUIDRandomUsage(Tree tree) {\n+    MethodInvocationTree methodInvocationTree = (MethodInvocationTree) tree;\n+    Symbol symbol = methodInvocationTree.symbol();\n+    if (RANDOM_UUID_MATCHER.matches(methodInvocationTree)) {\n+      reportedUUIDRandom = true;\n+      List<JavaFileScannerContext.Location> locations = symbol.usages().stream()\n+        .map(identifierTree -> new JavaFileScannerContext.Location(LOCATIONS_TEXT, identifierTree))\n+        .collect(Collectors.toList());\n+      reportIssue(tree, MESSAGE, locations, null);\n+    }\n+  }\n+\n+  @Override\n+  public void leaveFile(JavaFileScannerContext context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTQ3ODc5OnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOToxNjo1NFrOHSn2_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOToxNjo1NFrOHSn2_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI4OTQ3MQ==", "bodyText": "If you call this method naively with any Tree, the cast is not safe.\nI would rather use NewClassTree as parameter's type and perform the cast when you call it.\nSame for checkAndReportUUIDRandomUsage.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489289471", "createdAt": "2020-09-16T09:16:54Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final MethodMatchers RANDOM_UUID_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.UUID\")\n+    .names(\"randomUUID\")\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final String LOCATIONS_TEXT = \"usage of random data in test\";\n+  private static final String MESSAGE = \"Replace randomly generated values with a fixed ones.\";\n+\n+  private boolean reportedUUIDRandom = false;\n+  private final List<Tree> randomSecondaryLocations = new ArrayList<>();\n+\n+\n+  @Override\n+  public List<Tree.Kind> nodesToVisit() {\n+    return Arrays.asList(Tree.Kind.METHOD_INVOCATION, Tree.Kind.NEW_CLASS);\n+  }\n+\n+  @Override\n+  public void visitNode(Tree tree) {\n+    if (tree.is(Tree.Kind.NEW_CLASS)) {\n+      checkForRandomConstructorUsage(tree);\n+    }\n+    if (!reportedUUIDRandom && tree.is(Tree.Kind.METHOD_INVOCATION)) {\n+      checkAndReportUUIDRandomUsage(tree);\n+    }\n+  }\n+\n+  private void checkForRandomConstructorUsage(Tree tree) {\n+    NewClassTree newClassTree = (NewClassTree) tree;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTUyMzgzOnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOToyNzoyN1rOHSoSVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOToyNzoyN1rOHSoSVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI5NjQ3MQ==", "bodyText": "It means that we will report an issue for Random with seed.\nNot so unpredictable, but using hardcoded value is still more readable, so it seems correct to me.\nWe should just add a test for this case, to show that we thought about it.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489296471", "createdAt": "2020-09-16T09:27:27Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTUzOTEyOnYy", "diffSide": "RIGHT", "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTozMToxMVrOHSob6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTozMToxMVrOHSob6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTI5ODkyMQ==", "bodyText": "Can it actually take parameters? If not, we should consider using addWithoutParametersMatcher().", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489298921", "createdAt": "2020-09-16T09:31:11Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks/src/main/java/org/sonar/java/checks/tests/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * SonarQube Java\n+ * Copyright (C) 2012-2020 SonarSource SA\n+ * mailto:info AT sonarsource DOT com\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 3 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public License\n+ * along with this program; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n+ */\n+package org.sonar.java.checks.tests;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import org.sonar.check.Rule;\n+import org.sonar.plugins.java.api.IssuableSubscriptionVisitor;\n+import org.sonar.plugins.java.api.JavaFileScannerContext;\n+import org.sonar.plugins.java.api.semantic.MethodMatchers;\n+import org.sonar.plugins.java.api.semantic.Symbol;\n+import org.sonar.plugins.java.api.tree.MethodInvocationTree;\n+import org.sonar.plugins.java.api.tree.NewClassTree;\n+import org.sonar.plugins.java.api.tree.Tree;\n+\n+@Rule(key = \"S5977\")\n+public class RandomizedTestDataCheck extends IssuableSubscriptionVisitor {\n+\n+  private static final MethodMatchers RANDOM_CONSTRUCTOR_METHOD_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.Random\")\n+    .constructor()\n+    .withAnyParameters()\n+      .build();\n+\n+  private static final MethodMatchers RANDOM_UUID_MATCHER = MethodMatchers.create()\n+    .ofTypes(\"java.util.UUID\")\n+    .names(\"randomUUID\")\n+    .withAnyParameters()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1cbe96d6048acbacb32d1d3c989777bcd84a990"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MjE1MzA5OnYy", "diffSide": "RIGHT", "path": "java-checks-test-sources/src/main/java/checks/RandomizedTestDataCheck.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyNDowOVrOHSuRxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjo1MToyM1rOHSvTKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5NDYzMA==", "bodyText": "I don't think it makes sense to include the main location in the secondaries.", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489394630", "createdAt": "2020-09-16T12:24:09Z", "author": {"login": "quentin-jaquier-sonarsource"}, "path": "java-checks-test-sources/src/main/java/checks/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package checks;\n+\n+import java.util.Random;\n+import java.util.UUID;\n+import org.junit.jupiter.api.Test;\n+\n+public class RandomizedTestDataCheck {\n+\n+  @Test\n+  public void randomizedTest() {\n+    int userAge = new Random().nextInt(42);  // Noncompliant[[sc=19;ec=31;secondary=11,25,27,29,31,33,42]]{{Replace randomly generated values with fixed ones.}}\n+    UUID userID = UUID.randomUUID(); // Noncompliant[[sc=19;ec=36;secondary=12,26,28,30,32,34]]{{Replace randomly generated values with fixed ones.}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad1efed781081f19916e353c29e40e0dd9d4ad1d"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQxMTM3MQ==", "bodyText": "On the one hand yes.\nWhat I thought about secondary locations is that there are different cases, If we report the main issue on a different level (example class) and highlight secondaries (example method) we do not report the primary one in a secondary.\nWhen we're talking about this issue. Here we report the first occurrence and highlight other usages. So at this point this makes sense to add the first one to secondary locations. And moreover, this way we have a fair counter of all usages.\nWdyt?", "url": "https://github.com/SonarSource/sonar-java/pull/3179#discussion_r489411371", "createdAt": "2020-09-16T12:51:23Z", "author": {"login": "margarita-nedzelska-sonarsource"}, "path": "java-checks-test-sources/src/main/java/checks/RandomizedTestDataCheck.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package checks;\n+\n+import java.util.Random;\n+import java.util.UUID;\n+import org.junit.jupiter.api.Test;\n+\n+public class RandomizedTestDataCheck {\n+\n+  @Test\n+  public void randomizedTest() {\n+    int userAge = new Random().nextInt(42);  // Noncompliant[[sc=19;ec=31;secondary=11,25,27,29,31,33,42]]{{Replace randomly generated values with fixed ones.}}\n+    UUID userID = UUID.randomUUID(); // Noncompliant[[sc=19;ec=36;secondary=12,26,28,30,32,34]]{{Replace randomly generated values with fixed ones.}}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5NDYzMA=="}, "originalCommit": {"oid": "ad1efed781081f19916e353c29e40e0dd9d4ad1d"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3893, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}