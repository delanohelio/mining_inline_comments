{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1OTE2NTk3", "number": 690, "title": "Fix zk cleanup test in TestCoordinator.java", "bodyText": "Fix the flaky test case. It is failing because post clean up takes some time after becoming leader.\nAdding additional timeout in verify to make sure that cleanUpOrphanConnectorTasks is called within 30 sec of becoming leader. I have to upgrade junit to version4.x because mockito.timeout throws classNotFoundError. Mockito is built with junit V4.x.", "createdAt": "2020-03-10T03:21:44Z", "url": "https://github.com/linkedin/brooklin/pull/690", "merged": true, "mergeCommit": {"oid": "5480b6f2204c0a4740b0dceb52763b6ea4f45822"}, "closed": true, "closedAt": "2020-03-10T20:54:51Z", "author": {"login": "vmaheshw"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABboAf5CAH2gAyMzg1OTE2NTk3OmMzMWNkNGExNWNjOGRkNjliMGE2NTNkYmU0MjAxZGU5MzRlYTZkNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMYlmjAFqTM3MjI5OTMxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c31cd4a15cc8dd69b0a653dbe4201de934ea6d65", "author": {"user": {"login": "vmaheshw", "name": "Vaibhav Maheshwari"}}, "url": "https://github.com/linkedin/brooklin/commit/c31cd4a15cc8dd69b0a653dbe4201de934ea6d65", "committedDate": "2019-11-18T20:06:44Z", "message": "Merge pull request #1 from linkedin/master\n\nPull latest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8437a603918e25035b06af9b156749d8533e156", "author": {"user": null}, "url": "https://github.com/linkedin/brooklin/commit/e8437a603918e25035b06af9b156749d8533e156", "committedDate": "2020-03-10T02:14:17Z", "message": "Merge branch 'master' of github.com:linkedin/brooklin into fixZkCleanupTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91fa76621367c08b749f6418371a7081f4906eb9", "author": {"user": null}, "url": "https://github.com/linkedin/brooklin/commit/91fa76621367c08b749f6418371a7081f4906eb9", "committedDate": "2020-03-10T03:19:52Z", "message": "Fix TestCoordinator flaky testcase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjYwMzUx", "url": "https://github.com/linkedin/brooklin/pull/690#pullrequestreview-371660351", "createdAt": "2020-03-10T03:25:46Z", "commit": {"oid": "91fa76621367c08b749f6418371a7081f4906eb9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMzoyNTo0NlrOF0AW8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMzoyNTo0NlrOF0AW8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA3NjE0NA==", "bodyText": "Is there no way to do this using testng instead of adding a junit dependency?", "url": "https://github.com/linkedin/brooklin/pull/690#discussion_r390076144", "createdAt": "2020-03-10T03:25:46Z", "author": {"login": "somandal"}, "path": "datastream-server-restli/src/test/java/com/linkedin/datastream/server/TestCoordinator.java", "diffHunk": "@@ -2555,7 +2556,7 @@ public void testCoordinatorLeaderCleanupTasksPostElection() throws Exception {\n     instance1.stop();\n     Assert.assertTrue(PollUtils.poll(() -> instance2.getIsLeader().getAsBoolean(), 100, 30000));\n     verify(spyZkAdapter1, times(0)).cleanUpOrphanConnectorTasks(anyBoolean());\n-    verify(spyZkAdapter2, times(1)).cleanUpOrphanConnectorTasks(anyBoolean());\n+    verify(spyZkAdapter2, timeout(30000).times(1)).cleanUpOrphanConnectorTasks(anyBoolean());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91fa76621367c08b749f6418371a7081f4906eb9"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjYxNzY4", "url": "https://github.com/linkedin/brooklin/pull/690#pullrequestreview-371661768", "createdAt": "2020-03-10T03:31:38Z", "commit": {"oid": "91fa76621367c08b749f6418371a7081f4906eb9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTU0MTI3", "url": "https://github.com/linkedin/brooklin/pull/690#pullrequestreview-372154127", "createdAt": "2020-03-10T17:09:33Z", "commit": {"oid": "91fa76621367c08b749f6418371a7081f4906eb9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f856e322d4eae5800b55799caf6977166ef2371e", "author": {"user": null}, "url": "https://github.com/linkedin/brooklin/commit/f856e322d4eae5800b55799caf6977166ef2371e", "committedDate": "2020-03-10T19:02:42Z", "message": "Remove junit dependency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjYzNDgw", "url": "https://github.com/linkedin/brooklin/pull/690#pullrequestreview-372263480", "createdAt": "2020-03-10T19:37:09Z", "commit": {"oid": "f856e322d4eae5800b55799caf6977166ef2371e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjk5MzE5", "url": "https://github.com/linkedin/brooklin/pull/690#pullrequestreview-372299319", "createdAt": "2020-03-10T20:31:58Z", "commit": {"oid": "f856e322d4eae5800b55799caf6977166ef2371e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 391, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}