{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NDE5NDk4", "number": 688, "title": "Fix keys getting discarded before sending the record to the destination", "bodyText": "The record's keys are missing in the destination Kafka topic. This pull request has the fix to make sure that the keys are intact in the producer record.", "createdAt": "2020-03-05T17:56:21Z", "url": "https://github.com/linkedin/brooklin/pull/688", "merged": true, "mergeCommit": {"oid": "9fe959a8a1b877924a6fa3006ec05f96db02ef3f"}, "closed": true, "closedAt": "2020-03-31T05:17:45Z", "author": {"login": "sdomalap"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKvQ4TAH2gAyMzg0NDE5NDk4OjdiOTA0YmU0NzBjMzI2OTFkMGY0YjBiOTk2ZTQ4NGU0NTM1M2VmODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcS8GBYAFqTM4NDQwODMxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7b904be470c32691d0f4b0b996e484e45353ef83", "author": {"user": null}, "url": "https://github.com/linkedin/brooklin/commit/7b904be470c32691d0f4b0b996e484e45353ef83", "committedDate": "2020-03-05T17:49:18Z", "message": "Fix keys getting discarded before sending the record to the destination"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5OTgzNzA2", "url": "https://github.com/linkedin/brooklin/pull/688#pullrequestreview-369983706", "createdAt": "2020-03-05T23:24:20Z", "commit": {"oid": "7b904be470c32691d0f4b0b996e484e45353ef83"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMDAxMTg1", "url": "https://github.com/linkedin/brooklin/pull/688#pullrequestreview-370001185", "createdAt": "2020-03-06T00:12:53Z", "commit": {"oid": "7b904be470c32691d0f4b0b996e484e45353ef83"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMDoxMjo1M1rOFyolyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMDoxMjo1M1rOFyolyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODYzODE1NA==", "bodyText": "I understand you're trying to minimize changes but I think the code would be slightly clearer/better if we avoid the redundant assignment, i.e.\nif (record.getPartitionKey().isPresent()) {\n    keyValue = record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8);\n}", "url": "https://github.com/linkedin/brooklin/pull/688#discussion_r388638154", "createdAt": "2020-03-06T00:12:53Z", "author": {"login": "ahmedahamid"}, "path": "datastream-kafka/src/main/java/com/linkedin/datastream/kafka/KafkaTransportProvider.java", "diffHunk": "@@ -119,7 +119,7 @@ public KafkaTransportProvider(DatastreamTask datastreamTask, List<KafkaProducerW\n       // If the partition is not specified. We use the partitionKey as the key. Kafka will use the hash of that\n       // to determine the partition. If partitionKey does not exist, use the key value.\n       keyValue = record.getPartitionKey().isPresent()\n-          ? record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8) : null;\n+              ? record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8) : keyValue;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b904be470c32691d0f4b0b996e484e45353ef83"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDA4MzEy", "url": "https://github.com/linkedin/brooklin/pull/688#pullrequestreview-384408312", "createdAt": "2020-03-31T05:17:36Z", "commit": {"oid": "7b904be470c32691d0f4b0b996e484e45353ef83"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 387, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}