{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MjAyNjc2", "number": 779, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODowMDo1NVrOE3WJeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODowMDo1NVrOE3WJeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NDcwMDEwOnYy", "diffSide": "RIGHT", "path": "datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaTopicPartitionTracker.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODowMDo1NVrOHwo0Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODowMDo1NVrOHwo0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc2MjQyMw==", "bodyText": "Can we add a check here to confirm record has the timestamType?", "url": "https://github.com/linkedin/brooklin/pull/779#discussion_r520762423", "createdAt": "2020-11-10T18:00:55Z", "author": {"login": "vishwajith-s"}, "path": "datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaTopicPartitionTracker.java", "diffHunk": "@@ -115,9 +121,21 @@ public void onPartitionsPolled(@NotNull ConsumerRecords<?, ?> consumerRecords) {\n       Map<Integer, Long> partitionOffsetMap = _consumedOffsets.computeIfAbsent(topicPartition.topic(),\n           k -> new ConcurrentHashMap<>());\n       partitionOffsetMap.put(topicPartition.partition(), lastRecord.offset());\n+\n+      Map<Integer, Long> partitionConsumptionLagMap = _consumptionLag.computeIfAbsent(topicPartition.topic(),\n+          k -> new ConcurrentHashMap<>());\n+      partitionConsumptionLagMap.put(topicPartition.partition(), calculateLag(lastRecord));\n     });\n   }\n \n+  private Long calculateLag(ConsumerRecord<?, ?> record) {\n+    if (record.timestampType().equals(TimestampType.LOG_APPEND_TIME)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2251a4f38a4b0622c30232cf5a956d534c32b91"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 926, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}