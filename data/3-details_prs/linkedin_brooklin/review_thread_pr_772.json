{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3ODU5OTE3", "number": 772, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzo0NDo0N1rOEwitfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzo1ODo1MlrOEwi4gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzM1ODA2OnYy", "diffSide": "RIGHT", "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzo0NDo0N1rOHmLkSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzo1NzowMlrOHmLy3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5NzQ1MA==", "bodyText": "I didn't get this check. Can you please elaborate?", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509797450", "createdAt": "2020-10-21T23:44:47Z", "author": {"login": "vishwajith-s"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -304,6 +310,11 @@ private void reportMetrics(DatastreamRecordMetadata metadata, long eventsSourceT\n       _dynamicMetricsManager.createOrUpdateSlidingWindowHistogram(MODULE, _datastreamTask.getConnectorType(),\n           EVENTS_LATENCY_MS_STRING, LATENCY_SLIDING_WINDOW_LENGTH_MS, sourceToDestinationLatencyMs);\n \n+      if (_enablePerTopicEventLatencyMetrics && !_enablePerTopicMetrics) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5ODI4Nw==", "bodyText": "If someone enables per topic metrics for all metrics via the _enablePerTopicMetrics, then I don't want to double count, since the topicOrDatastreamName will point to the topic name already. Would you like me to add a comment?", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509798287", "createdAt": "2020-10-21T23:47:26Z", "author": {"login": "somandal"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -304,6 +310,11 @@ private void reportMetrics(DatastreamRecordMetadata metadata, long eventsSourceT\n       _dynamicMetricsManager.createOrUpdateSlidingWindowHistogram(MODULE, _datastreamTask.getConnectorType(),\n           EVENTS_LATENCY_MS_STRING, LATENCY_SLIDING_WINDOW_LENGTH_MS, sourceToDestinationLatencyMs);\n \n+      if (_enablePerTopicEventLatencyMetrics && !_enablePerTopicMetrics) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5NzQ1MA=="}, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5OTI3Ng==", "bodyText": "Please add a comment. It's not obvious. Thanks for the explanation", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509799276", "createdAt": "2020-10-21T23:50:43Z", "author": {"login": "vishwajith-s"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -304,6 +310,11 @@ private void reportMetrics(DatastreamRecordMetadata metadata, long eventsSourceT\n       _dynamicMetricsManager.createOrUpdateSlidingWindowHistogram(MODULE, _datastreamTask.getConnectorType(),\n           EVENTS_LATENCY_MS_STRING, LATENCY_SLIDING_WINDOW_LENGTH_MS, sourceToDestinationLatencyMs);\n \n+      if (_enablePerTopicEventLatencyMetrics && !_enablePerTopicMetrics) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5NzQ1MA=="}, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMTE4MQ==", "bodyText": "done", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509801181", "createdAt": "2020-10-21T23:57:02Z", "author": {"login": "somandal"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -304,6 +310,11 @@ private void reportMetrics(DatastreamRecordMetadata metadata, long eventsSourceT\n       _dynamicMetricsManager.createOrUpdateSlidingWindowHistogram(MODULE, _datastreamTask.getConnectorType(),\n           EVENTS_LATENCY_MS_STRING, LATENCY_SLIDING_WINDOW_LENGTH_MS, sourceToDestinationLatencyMs);\n \n+      if (_enablePerTopicEventLatencyMetrics && !_enablePerTopicMetrics) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc5NzQ1MA=="}, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzM4NjI2OnYy", "diffSide": "RIGHT", "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzo1ODo1MlrOHmL05w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMDowNzo1NFrOHmMAYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMTcwMw==", "bodyText": "if this was written as:\n_enablePerTopicEventLatencyMetrics =         Boolean.parseBoolean(config.getProperty(CONFIG_ENABLE_PER_TOPIC_EVENT_LATENCY_METRICS,\n            String.valueOf(_enablePerTopicMetrics)));``` \nyou possibly won't need to check the 2 values below and can just check  if `_enablePerTopicEventLatencyMetrics` is true?", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509801703", "createdAt": "2020-10-21T23:58:52Z", "author": {"login": "DEEPTHIKORAT"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -159,6 +161,10 @@ public EventProducer(DatastreamTask task, TransportProvider transportProvider, C\n     _enablePerTopicMetrics =\n         Boolean.parseBoolean(config.getProperty(CONFIG_ENABLE_PER_TOPIC_METRICS, Boolean.TRUE.toString()));\n \n+    _enablePerTopicEventLatencyMetrics =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMzI4OQ==", "bodyText": "Not sure I fully follow. If I set the default to String.valueOf(_enablePerTopicMetrics)) then I'm essentially picking up it's value (true or false), right? Which means if enablePerTopicMetrics is true and enablePerTopicEventLatencyMetrics isn't set, then enablePerTopicEventLatencyMetrics will become true too and i'll land up double counting later, right?", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509803289", "createdAt": "2020-10-22T00:04:11Z", "author": {"login": "somandal"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -159,6 +161,10 @@ public EventProducer(DatastreamTask task, TransportProvider transportProvider, C\n     _enablePerTopicMetrics =\n         Boolean.parseBoolean(config.getProperty(CONFIG_ENABLE_PER_TOPIC_METRICS, Boolean.TRUE.toString()));\n \n+    _enablePerTopicEventLatencyMetrics =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMTcwMw=="}, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwNDY0MQ==", "bodyText": "Ah, you are right. I misunderstood the code.", "url": "https://github.com/linkedin/brooklin/pull/772#discussion_r509804641", "createdAt": "2020-10-22T00:07:54Z", "author": {"login": "DEEPTHIKORAT"}, "path": "datastream-server/src/main/java/com/linkedin/datastream/server/EventProducer.java", "diffHunk": "@@ -159,6 +161,10 @@ public EventProducer(DatastreamTask task, TransportProvider transportProvider, C\n     _enablePerTopicMetrics =\n         Boolean.parseBoolean(config.getProperty(CONFIG_ENABLE_PER_TOPIC_METRICS, Boolean.TRUE.toString()));\n \n+    _enablePerTopicEventLatencyMetrics =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMTcwMw=="}, "originalCommit": {"oid": "4e3f2eb1e1ebc981a826594378becc5f52a3e352"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 907, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}