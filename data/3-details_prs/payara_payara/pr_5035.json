{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNjAxNDA1", "number": 5035, "title": "FISH-886 Deploy GAV from local repository + some code cleanup", "bodyText": "Description\n\nAdded ability to deploy GAV from local repository.\nExample:\njava -jar payara-micro.jar --deployFromGAV org.example:someapp:1.0 --additionalRepository file:///c:/Users/alex/.m2/repository\nImportant Info\nBlockers\n\nTesting\nNew tests\n\nTesting Performed\n\nTesting Environment\n\nZulu JDK 8, Windows 10 Pro\nDocumentation\n\nNotes for Reviewers", "createdAt": "2020-12-07T11:31:44Z", "url": "https://github.com/payara/Payara/pull/5035", "merged": true, "mergeCommit": {"oid": "6b127329aa15a58923565a1ae572334070b30a96"}, "closed": true, "closedAt": "2020-12-18T18:19:01Z", "author": {"login": "avpinchuk"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjzyCkAH2gAyNTMzNjAxNDA1OjM2NjAzYjU2ZTBiMzVhMGVjZDc1NGNmM2QzOTQ4NmJkZGViZDg5NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnV-Z3gFqTU1NTM4OTY3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "36603b56e0b35a0ecd754cf3d39486bddebd8950", "author": {"user": {"login": "avpinchuk", "name": "Alexander Pinchuk"}}, "url": "https://github.com/payara/Payara/commit/36603b56e0b35a0ecd754cf3d39486bddebd8950", "committedDate": "2020-12-07T11:24:24Z", "message": "Deploy GAV from local repository"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2Mzc4MzYx", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-546378361", "createdAt": "2020-12-07T17:35:34Z", "commit": {"oid": "36603b56e0b35a0ecd754cf3d39486bddebd8950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MzgzMzcz", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-546383373", "createdAt": "2020-12-07T17:41:37Z", "commit": {"oid": "36603b56e0b35a0ecd754cf3d39486bddebd8950"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98", "author": {"user": {"login": "avpinchuk", "name": "Alexander Pinchuk"}}, "url": "https://github.com/payara/Payara/commit/d36259c33f2bf3e68bd9385e15d277900ad48a98", "committedDate": "2020-12-07T19:27:19Z", "message": "Change copyright year"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NDY5NTA4", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-546469508", "createdAt": "2020-12-07T19:31:46Z", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODA4MjQz", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-552808243", "createdAt": "2020-12-15T19:42:17Z", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOTo0MjoxOFrOIGc38w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOTo0MjoxOFrOIGc38w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYzNTQ0Mw==", "bodyText": "This makes some assumption about the type of connection but it might be a JarURLConnection. Like this one: jar:http://www.foo.com/bar/baz.jar.\nYou might want a separate if-block to handle these kind of archive URLs.\nBut if it is all about local URLs this is unnessessary.", "url": "https://github.com/payara/Payara/pull/5035#discussion_r543635443", "createdAt": "2020-12-15T19:42:18Z", "author": {"login": "svendiedrichsen"}, "path": "nucleus/deployment/common/src/main/java/fish/payara/deployment/util/GAVConvertor.java", "diffHunk": "@@ -171,18 +173,27 @@ private URL findArtefactURL(List<URL> repositoryURLs, String relativeURLString)\n                 try {\n                     artefactURL = new URL(repositoryURL, relativeURLString + archiveType);\n \n-                    HttpURLConnection httpConnection = (HttpURLConnection) artefactURL.openConnection();\n-                    \n-                    String auth = artefactURL.getUserInfo();\n-                    if (auth != null) {\n-                        String encodedAuth = Base64.getEncoder().encodeToString(auth.getBytes());\n-                        httpConnection.setRequestProperty(\"Authorization\", \"Basic \" + encodedAuth);\n+                    if (\"file\".equalsIgnoreCase(artefactURL.getProtocol())) {\n+                        if (Files.exists(Paths.get(artefactURL.toURI()))) {\n+                            validURLFound = true;\n+                        }\n+                    } else {\n+                        HttpURLConnection httpConnection = (HttpURLConnection) artefactURL.openConnection();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODIwNzQz", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-552820743", "createdAt": "2020-12-15T19:58:41Z", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOTo1ODo0MVrOIGdh-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOTo1ODo0MVrOIGdh-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY0NjIwMA==", "bodyText": "Maven coordinates might also include packaging and classifier. If the packaging coordinate exists you don't have to iterate over the whole list of possible file extensions. You could simply use this. If the classifier coordinate exists you won't be able to find the artefact without it in the URL.\nYou can find some examples here: https://developpaper.com/coordinates-of-maven-basic-course/", "url": "https://github.com/payara/Payara/pull/5035#discussion_r543646200", "createdAt": "2020-12-15T19:58:41Z", "author": {"login": "svendiedrichsen"}, "path": "nucleus/deployment/common/src/main/java/fish/payara/deployment/util/GAVConvertor.java", "diffHunk": "@@ -117,7 +120,7 @@\n      * the provided GAV as Strings\n      */\n     private Map<String, String> splitGAV(String GAV) throws MalformedURLException {\n-        final String[] splitGAV = GAV.split(\",|:\");\n+        final String[] splitGAV = GAV.split(\"[,:]\");\n         final Map<String, String> GAVMap = new HashMap<>();\n         try {\n             GAVMap.put(\"groupId\", splitGAV[0].replace('.', '/'));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODU0MDMx", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-552854031", "createdAt": "2020-12-15T20:46:04Z", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMDo0NjowNFrOIGfO3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMDo0NjowNFrOIGfO3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY3NDA3Nw==", "bodyText": "Isn't a valid GAV only split by :? Doesn't it suggest when you find a comma that this is really a list of GAV? And if you accept lists here you should really focus on splitting by comma first to have a chance to determine optional fields like packaging and classifier.", "url": "https://github.com/payara/Payara/pull/5035#discussion_r543674077", "createdAt": "2020-12-15T20:46:04Z", "author": {"login": "svendiedrichsen"}, "path": "nucleus/deployment/common/src/main/java/fish/payara/deployment/util/GAVConvertor.java", "diffHunk": "@@ -117,7 +120,7 @@\n      * the provided GAV as Strings\n      */\n     private Map<String, String> splitGAV(String GAV) throws MalformedURLException {\n-        final String[] splitGAV = GAV.split(\",|:\");\n+        final String[] splitGAV = GAV.split(\"[,:]\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1Mzg5Njc0", "url": "https://github.com/payara/Payara/pull/5035#pullrequestreview-555389674", "createdAt": "2020-12-18T10:56:27Z", "commit": {"oid": "d36259c33f2bf3e68bd9385e15d277900ad48a98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 640, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}