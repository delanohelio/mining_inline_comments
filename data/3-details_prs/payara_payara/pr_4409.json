{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NTMwMTYz", "number": 4409, "title": "CUSTOM-142 Delete JVM options with min max versions.", "bodyText": "This is a bug fix\nWhen you try to delete a JVM option which has defined a min and/or max version, the option cannot be found (and thus not deleted).\nThis PR fixes the delete logic of the JVM Options.\nImportant Info\nNo Unit Test created due to proxy requirements of JavaConfig within org.jvnet.hk2.config.ConfigSupport#apply(org.jvnet.hk2.config.SingleConfigCode<T>, T)\nTesting\nTesting Performed\n./asadmin start-domain\n./asadmin create-jvm-options '[1.8.123|1.8.231]-DtestOption'\n./asadmin delete-jvm-options '[1.8.123|1.8.231]-DtestOption'\n\nQuicklook\n\nTesting Environment\nMaven 3.5.4\nJDK 1.8u181", "createdAt": "2020-01-06T12:51:11Z", "url": "https://github.com/payara/Payara/pull/4409", "merged": true, "mergeCommit": {"oid": "7002f7a754ac704b8adddf0a975e3f593b6edde5"}, "closed": true, "closedAt": "2020-01-10T17:02:13Z", "author": {"login": "rdebusscher"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3rgfNAH2gAyMzU5NTMwMTYzOmQ0NzNhMjFhN2E5YWMxZGIxN2IzMDIwMWU5MWE2MzFhOGQ5NzBjNjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4kxGXAFqTM0MDMyNjk3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d473a21a7a9ac1db17b30201e91a631a8d970c62", "author": {"user": {"login": "rdebusscher", "name": "Rudy De Busscher"}}, "url": "https://github.com/payara/Payara/commit/d473a21a7a9ac1db17b30201e91a631a8d970c62", "committedDate": "2020-01-06T12:42:10Z", "message": "Delete JVM options with min max versions. CUSTOM-142."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5ODIwNzc3", "url": "https://github.com/payara/Payara/pull/4409#pullrequestreview-339820777", "createdAt": "2020-01-08T12:05:18Z", "commit": {"oid": "d473a21a7a9ac1db17b30201e91a631a8d970c62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzI2OTcz", "url": "https://github.com/payara/Payara/pull/4409#pullrequestreview-340326973", "createdAt": "2020-01-09T07:24:48Z", "commit": {"oid": "d473a21a7a9ac1db17b30201e91a631a8d970c62"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwNzoyNDo0OFrOFbsvWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwNzoyNDo0OFrOFbsvWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU4ODg4OA==", "bodyText": "This method has expectations ... it expects that formatting is done in option.toString() and it's result will be same as strings in bag1.getJvmRawOptions().\nSeems fragile to me,\ngetJvmRawOptions does not have javadoc, but it looks it is the content of the XML element.\nJvmOption.toString prints also minVersion and maxVersion, seems it is really symetric at this moment ... ok.", "url": "https://github.com/payara/Payara/pull/4409#discussion_r364588888", "createdAt": "2020-01-09T07:24:48Z", "author": {"login": "dmatej"}, "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/admin/commands/DeleteJvmOptions.java", "diffHunk": "@@ -162,7 +162,8 @@ private void deleteX(final JvmOptionBag bag, final List<String> toRemove, final\n         SingleConfigCode<JvmOptionBag> scc = (JvmOptionBag bag1) -> {\n             List<String> jvmopts = new ArrayList<>(bag1.getJvmRawOptions());\n             int orig = jvmopts.size();\n-            boolean removed = jvmopts.removeIf(option -> toRemove.contains(new JvmOption(option).option));\n+            // using new JvmOption(option).toString() (instead op option directly) to make sure the correct formatting is applied.\n+            boolean removed = jvmopts.removeIf(option -> toRemove.contains(new JvmOption(option).toString()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d473a21a7a9ac1db17b30201e91a631a8d970c62"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 828, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}