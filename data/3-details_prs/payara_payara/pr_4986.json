{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NDI1NDk2", "number": 4986, "title": "FISH-660 Upgrade MicroProfile Health Implementation to 3.0-RC5", "bodyText": "Description\n\nThis is a feature. Will need upgrading to the final release version when it's release, but for now the release candidate is good enough.\nTesting\nNew tests\n\nTCK updated: payara/MicroProfile-TCK-Runners#122\nTesting Performed\n\nRan the new TCK against our current implementation\nDocumentation\n\nTBW\nNotes for Reviewers", "createdAt": "2020-11-10T11:35:45Z", "url": "https://github.com/payara/Payara/pull/4986", "merged": true, "mergeCommit": {"oid": "8f82cb9c3b6a64cebb50dca9b33e21fd88fcdf6a"}, "closed": true, "closedAt": "2020-11-23T09:27:27Z", "author": {"login": "MattGill98"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbap2ZAFqTUyODAwNjY4OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeXGiLgBqjQwMjA4MjI4NzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MDA2Njg5", "url": "https://github.com/payara/Payara/pull/4986#pullrequestreview-528006689", "createdAt": "2020-11-11T09:34:14Z", "commit": {"oid": "e5714744023ca96ec57c9f11387dec8df721c97d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwOTozNDoxNFrOHxFXEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwOTozNDoxNFrOHxFXEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTIzMDA5Nw==", "bodyText": "Can't wrap my head around this one. How is an empty modifiable map of any use? Why would a concurrent map be wrong in a shared service? How is this only applying to health and not equally to readiness and liveness?\nMaybe you can shine some light on this for me.", "url": "https://github.com/payara/Payara/pull/4986#discussion_r521230097", "createdAt": "2020-11-11T09:34:14Z", "author": {"login": "jbee"}, "path": "appserver/payara-appserver-modules/microprofile/healthcheck/src/main/java/fish/payara/microprofile/healthcheck/HealthCheckService.java", "diffHunk": "@@ -116,16 +115,11 @@\n     private ApplicationRegistry applicationRegistry;\n \n     @Inject\n-    private MetricsHealthCheckConfiguration configuration;\n-\n-    @Inject\n-    private ConfigProviderResolver microConfigResolver;\n-\n-    private boolean backwardCompEnabled;\n+    private MicroprofileHealthCheckConfiguration configuration;\n \n     private static final Logger LOG = Logger.getLogger(HealthCheckService.class.getName());\n \n-    private final Map<String, Set<HealthCheck>> health = new ConcurrentHashMap<>();\n+    private final Map<String, Set<HealthCheck>> health = unmodifiableMap(new HashMap<>());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5714744023ca96ec57c9f11387dec8df721c97d"}, "originalPosition": 86}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b53a0675b2d0c75ecb4e426e1d5d0de94483b21", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/6b53a0675b2d0c75ecb4e426e1d5d0de94483b21", "committedDate": "2020-11-11T14:57:35Z", "message": "FISH-660 Upgrade MicroProfile Health to 3.0-RC5\n\n@Health annotation has been removed, so the backward compatibility flag\nhas also been removed.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b59f164a71d80edd86e1383f58d67d5ea75af68e", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/b59f164a71d80edd86e1383f58d67d5ea75af68e", "committedDate": "2020-11-11T14:57:41Z", "message": "FISH-660 Fix MicroProfile Health Configuration Name\n\nThis is a breaking change, but the MP health configuration was\nincorrectly called \"metrics-healthcheck-configuration\" which was\nconfusing.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5714744023ca96ec57c9f11387dec8df721c97d", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/e5714744023ca96ec57c9f11387dec8df721c97d", "committedDate": "2020-11-10T11:30:52Z", "message": "FISH-660 Fix MicroProfile Health Configuration Name\n\nThis is a breaking change, but the MP health configuration was\nincorrectly called \"metrics-healthcheck-configuration\" which was\nconfusing.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}, "afterCommit": {"oid": "b59f164a71d80edd86e1383f58d67d5ea75af68e", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/b59f164a71d80edd86e1383f58d67d5ea75af68e", "committedDate": "2020-11-11T14:57:41Z", "message": "FISH-660 Fix MicroProfile Health Configuration Name\n\nThis is a breaking change, but the MP health configuration was\nincorrectly called \"metrics-healthcheck-configuration\" which was\nconfusing.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d37c78db5215e54edd01689d253a0410a1b778", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/84d37c78db5215e54edd01689d253a0410a1b778", "committedDate": "2020-11-12T10:46:44Z", "message": "FISH-660 Remove Old MP Health Watches\n\nMonitoring still collected Health data, which has been removed. The\n'overall' metric has also been renamed to health as it now feels more\nappropriate.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTcyNjI0", "url": "https://github.com/payara/Payara/pull/4986#pullrequestreview-528972624", "createdAt": "2020-11-12T10:58:06Z", "commit": {"oid": "84d37c78db5215e54edd01689d253a0410a1b778"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23db90ffa6dc25e462d062f396cf094b6bbec6d1", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/23db90ffa6dc25e462d062f396cf094b6bbec6d1", "committedDate": "2020-11-20T11:17:31Z", "message": "Merge branch 'FISH-660' of github.com:MattGill98/Payara into FISH-660"}, "afterCommit": {"oid": "1cc21a1b7b5ceec4d76a5a6d65f8ca616ab358b2", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/1cc21a1b7b5ceec4d76a5a6d65f8ca616ab358b2", "committedDate": "2020-11-20T11:28:55Z", "message": "Merge branch 'FISH-660' of github.com:MattGill98/Payara into FISH-660"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1ec9a1da720da92cc952e69c0c592faea46dea0", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/f1ec9a1da720da92cc952e69c0c592faea46dea0", "committedDate": "2020-11-20T11:34:02Z", "message": "Merge branch 'master' into FISH-660"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1cc21a1b7b5ceec4d76a5a6d65f8ca616ab358b2", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/1cc21a1b7b5ceec4d76a5a6d65f8ca616ab358b2", "committedDate": "2020-11-20T11:28:55Z", "message": "Merge branch 'FISH-660' of github.com:MattGill98/Payara into FISH-660"}, "afterCommit": {"oid": "7e299af6efe77b062ebdbd41dac0d9d5cbee6571", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/7e299af6efe77b062ebdbd41dac0d9d5cbee6571", "committedDate": "2020-11-20T11:35:25Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e299af6efe77b062ebdbd41dac0d9d5cbee6571", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/7e299af6efe77b062ebdbd41dac0d9d5cbee6571", "committedDate": "2020-11-20T11:35:25Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}, "afterCommit": {"oid": "6683379ee2b61757db66008608a7762dca05f75b", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/6683379ee2b61757db66008608a7762dca05f75b", "committedDate": "2020-11-20T12:04:29Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c2e33b73d38f5c2e6199acab5f176837e64b87a", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/2c2e33b73d38f5c2e6199acab5f176837e64b87a", "committedDate": "2020-11-20T13:09:41Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6683379ee2b61757db66008608a7762dca05f75b", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/6683379ee2b61757db66008608a7762dca05f75b", "committedDate": "2020-11-20T12:04:29Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}, "afterCommit": {"oid": "2c2e33b73d38f5c2e6199acab5f176837e64b87a", "author": {"user": {"login": "MattGill98", "name": "Matthew Gill"}}, "url": "https://github.com/payara/Payara/commit/2c2e33b73d38f5c2e6199acab5f176837e64b87a", "committedDate": "2020-11-20T13:09:41Z", "message": "FISH-660 Reconcile master merge with Health Upgrade\n\nConflicts arose caused by FISH-327 MP Sniffers. These are integrated\ninto the Health upgrade.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 616, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}