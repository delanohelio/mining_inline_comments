{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMDczNTIy", "number": 4585, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMTo0OVrODqUJxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMTo0OVrODqUJxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1Njk2OTY0OnYy", "diffSide": "RIGHT", "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/admin/commands/DeleteJvmOptions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMTo0OVrOF5-9Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMToxMzowNlrOF6AwTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDY3MQ==", "bodyText": "This construct fails in some cases when multiple options are removed.  Iterator is only initialised once, so you can have the situation that the second toRemoveOption value is already in the part of the iterator which has been traversed already.", "url": "https://github.com/payara/Payara/pull/4585#discussion_r396344671", "createdAt": "2020-03-23T10:21:49Z", "author": {"login": "rdebusscher"}, "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/admin/commands/DeleteJvmOptions.java", "diffHunk": "@@ -158,12 +159,22 @@ public Object run(JavaConfig jc) throws PropertyVetoException, TransactionFailur\n     }\n     */\n     //@ForTimeBeing :)\n-    private void deleteX(final JvmOptionBag bag, final List<String> toRemove, final ActionReport.MessagePart part) throws Exception {\n+    private void deleteX(final JvmOptionBag bag, final List<String> toRemoveOptions, final ActionReport.MessagePart part) throws Exception {\n         SingleConfigCode<JvmOptionBag> scc = (JvmOptionBag bag1) -> {\n             List<String> jvmopts = new ArrayList<>(bag1.getJvmRawOptions());\n             int orig = jvmopts.size();\n-            // using new JvmOption(option).toString() (instead op option directly) to make sure the correct formatting is applied.\n-            boolean removed = jvmopts.removeIf(option -> toRemove.contains(new JvmOption(option).toString()));\n+            boolean removed = false;\n+            Iterator<String> iter = jvmopts.iterator();\n+            for (String toRemoveOption : toRemoveOptions) {\n+                String option = new JvmOption(toRemoveOption).option;\n+                while (iter.hasNext()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d8f273127d8afaa945d7bc93e88460ed583debc"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3NDA5Mw==", "bodyText": "@rdebusscher, you are right. It was a dumb mistake on my part", "url": "https://github.com/payara/Payara/pull/4585#discussion_r396374093", "createdAt": "2020-03-23T11:13:06Z", "author": {"login": "MeroRai"}, "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/admin/commands/DeleteJvmOptions.java", "diffHunk": "@@ -158,12 +159,22 @@ public Object run(JavaConfig jc) throws PropertyVetoException, TransactionFailur\n     }\n     */\n     //@ForTimeBeing :)\n-    private void deleteX(final JvmOptionBag bag, final List<String> toRemove, final ActionReport.MessagePart part) throws Exception {\n+    private void deleteX(final JvmOptionBag bag, final List<String> toRemoveOptions, final ActionReport.MessagePart part) throws Exception {\n         SingleConfigCode<JvmOptionBag> scc = (JvmOptionBag bag1) -> {\n             List<String> jvmopts = new ArrayList<>(bag1.getJvmRawOptions());\n             int orig = jvmopts.size();\n-            // using new JvmOption(option).toString() (instead op option directly) to make sure the correct formatting is applied.\n-            boolean removed = jvmopts.removeIf(option -> toRemove.contains(new JvmOption(option).toString()));\n+            boolean removed = false;\n+            Iterator<String> iter = jvmopts.iterator();\n+            for (String toRemoveOption : toRemoveOptions) {\n+                String option = new JvmOption(toRemoveOption).option;\n+                while (iter.hasNext()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDY3MQ=="}, "originalCommit": {"oid": "9d8f273127d8afaa945d7bc93e88460ed583debc"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1319, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}