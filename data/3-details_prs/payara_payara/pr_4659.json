{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MTIzMjU2", "number": 4659, "title": "ECOSYS-157 OpenID Connect Caller's name and groups are null", "bodyText": "Description\nThis is a fix to set the caller's name & groups after the authentication in OpenIdContext and error message logged if redirect URL not matched with request URL.\nTesting\nTesting Performed\nManually Tested, Payara-Samples", "createdAt": "2020-05-08T08:45:19Z", "url": "https://github.com/payara/Payara/pull/4659", "merged": true, "mergeCommit": {"oid": "328d07ee291c49ff075a25afddd805ec51b84b7b"}, "closed": true, "closedAt": "2020-06-05T06:14:14Z", "author": {"login": "jGauravGupta"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfNFO8gH2gAyNDE1MTIzMjU2OmQwNDcwMWM2YjY1ZTg1NDllZDkxYzZmOWM5MzUzOGE0MGNhYmUyMjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcihe_7AH2gAyNDE1MTIzMjU2Ojk5ODcxMGNiMTJhNmQ5ODA2Y2IyYjRjYjViYmM3MzI2MDY2YTE1ZmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d04701c6b65e8549ed91c6f9c93538a40cabe223", "author": {"user": {"login": "jGauravGupta", "name": "Gaurav Gupta"}}, "url": "https://github.com/payara/Payara/commit/d04701c6b65e8549ed91c6f9c93538a40cabe223", "committedDate": "2020-05-08T07:52:13Z", "message": "ECOSYS-157 OpenID Connect Caller's name and groups are null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b72d4f7d2e307a7e5720abe44824e9db862e0163", "author": {"user": {"login": "jGauravGupta", "name": "Gaurav Gupta"}}, "url": "https://github.com/payara/Payara/commit/b72d4f7d2e307a7e5720abe44824e9db862e0163", "committedDate": "2020-05-08T12:53:40Z", "message": "ECOSYS-157 OpenId test case fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MjI0Mzk4", "url": "https://github.com/payara/Payara/pull/4659#pullrequestreview-408224398", "createdAt": "2020-05-08T13:07:43Z", "commit": {"oid": "b72d4f7d2e307a7e5720abe44824e9db862e0163"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjM4OTM1", "url": "https://github.com/payara/Payara/pull/4659#pullrequestreview-410238935", "createdAt": "2020-05-12T16:54:36Z", "commit": {"oid": "b72d4f7d2e307a7e5720abe44824e9db862e0163"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNjo1NDozNlrOGUQC5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNjo1NDozNlrOGUQC5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg4NzU4OQ==", "bodyText": "Hi, what is the reason of adding extra redirectURI.contains(request.getServletPath()) check?\nit breaks existing applications, (I just debugged it),\nif redirectURI is \"https://localhost:8181/myapp/\" and a welcome file is specified, i.e.\n\nfaces/About.xhtml\n\nrequest.getServletPath() returns \"/faces\" and this check fails. In case of index.html it returns \"/index.html\". Setting welcome-file to \"/\" makes authentication work again, but breaks user experience.", "url": "https://github.com/payara/Payara/pull/4659#discussion_r423887589", "createdAt": "2020-05-12T16:54:36Z", "author": {"login": "NikitaZ"}, "path": "appserver/payara-appserver-modules/security-openid/src/main/java/fish/payara/security/openid/OpenIdAuthenticationMechanism.java", "diffHunk": "@@ -235,21 +236,22 @@ private AuthenticationStatus authenticate(\n \n         Optional<OpenIdState> receivedState = OpenIdState.from(request.getParameter(STATE));\n         String redirectURI = configuration.buildRedirectURI(request);\n-        if (receivedState.isPresent()\n-                && request.getRequestURL().toString().equals(redirectURI)) {\n-\n+        if (receivedState.isPresent() && redirectURI.contains(request.getServletPath())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b72d4f7d2e307a7e5720abe44824e9db862e0163"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "998710cb12a6d9806cb2b4cb5bbc7326066a15fe", "author": {"user": {"login": "jGauravGupta", "name": "Gaurav Gupta"}}, "url": "https://github.com/payara/Payara/commit/998710cb12a6d9806cb2b4cb5bbc7326066a15fe", "committedDate": "2020-05-18T15:20:14Z", "message": "ECOSYS-157 Remove redirectURI extra check"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 818, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}