{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNTk2NDQ3", "number": 4622, "title": "CUSTCOM-133 Code cleanup in security", "bodyText": "This PR is based on #4621 and was created to separate testing of both change steps.\nBlockers\n\nFirst must be merged the fix #4621 (done)\n\nTesting\nFirst follow instructions in #4621 , then you can test this in similar way:\nThis should still pass:\ngit checkout dmatej/CUSTCOM-133-code-cleanup\nmvn clean install -PQuickBuild,fastest -TC8\ngit checkout dmatej/PAYARA-4176-TestContainers-prototype\nmvn clean install -Ptest-containers  -pl :test-containers -Dit.test=MetricsSecurityITest,JaspicSamAuthenticationITest # should pass again", "createdAt": "2020-04-15T07:46:47Z", "url": "https://github.com/payara/Payara/pull/4622", "merged": true, "mergeCommit": {"oid": "72ccedf0b653c924131bce6c2c1e8df524297a08"}, "closed": true, "closedAt": "2020-04-16T17:40:58Z", "author": {"login": "dmatej"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYKuX3ABqjMyMzkzOTUxNDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYPRcxABqjMyNDA3NjQyOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3a6a4632620fc8c5bb9fa207d666ef1fcd982cc2", "author": {"user": null}, "url": "https://github.com/payara/Payara/commit/3a6a4632620fc8c5bb9fa207d666ef1fcd982cc2", "committedDate": "2020-04-15T07:40:22Z", "message": "CUSTCOM-133 Cleanups around security\n\n- trimmed white spaces, manual formatting\n- more logging\n- added javadocs\n- enhanced loops\n- WebContainer:1812\n  - removed dead code, simplified\n- WebModuleConfig\n  - new method isSystemObjectType; it was weird to make this comparison outside\n    the object"}, "afterCommit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b", "author": {"user": null}, "url": "https://github.com/payara/Payara/commit/d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b", "committedDate": "2020-04-16T11:09:18Z", "message": "CUSTCOM-133 Cleanups around security\n\n- trimmed white spaces, manual formatting\n- more logging\n- added javadocs\n- enhanced loops\n- WebContainer:1812\n  - removed dead code, simplified\n- WebModuleConfig\n  - new method isSystemObjectType; it was weird to make this comparison outside\n    the object"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NzIwMDc5", "url": "https://github.com/payara/Payara/pull/4622#pullrequestreview-394720079", "createdAt": "2020-04-16T14:57:38Z", "commit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNDo1NzozOVrOGGphsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNToxMDo1OVrOGGqJJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTYyNTAwOQ==", "bodyText": "(\u256f\u00b0\u25a1\u00b0\uff09\u256f\ufe35 \u253b\u2501\u253b\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    initialize(appname);\n          \n          \n            \n                    initialise(appname);", "url": "https://github.com/payara/Payara/pull/4622#discussion_r409625009", "createdAt": "2020-04-16T14:57:39Z", "author": {"login": "Pandrex247"}, "path": "appserver/security/core-ee/src/main/java/com/sun/enterprise/security/jacc/JaccWebAuthorizationManager.java", "diffHunk": "@@ -181,38 +178,36 @@ public JaccWebAuthorizationManager(WebBundleDescriptor webBundleDescriptor, Serv\n         this.CONTEXT_ID = getContextID(webBundleDescriptor);\n         this.serverContext = serverContext;\n         this.webSecurityManagerFactory = webSecurityManagerFactory;\n-        \n-        String appname = getAppId();\n \n-        postConstruct();\n-        \n+        String appname = getAppId();\n+        SecurityRoleMapperFactoryGen.getSecurityRoleMapperFactory().setAppNameForContext(getAppId(), CONTEXT_ID);\n         // Initialize this class and specifically load permissions into the JACC Policy Configuration.\n-        initialise(appname);\n+        initialize(appname);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTYzMzIwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param defaultRealmName - this realm name will be used as a default if there will not be\n          \n          \n            \n                 * @param defaultRealmName - this realm name will be used as a default if there is not\n          \n      \n    \n    \n  \n\nGrammar", "url": "https://github.com/payara/Payara/pull/4622#discussion_r409633204", "createdAt": "2020-04-16T15:08:19Z", "author": {"login": "Pandrex247"}, "path": "nucleus/common/common-util/src/main/java/com/sun/enterprise/security/integration/RealmInitializer.java", "diffHunk": "@@ -37,22 +37,38 @@\n  * only if the new code is made subject to such option by the copyright\n  * holder.\n  */\n-// Portions Copyright [2019] [Payara Foundation and/or its affiliates]\n+// Portions Copyright [2019-2020] [Payara Foundation and/or its affiliates]\n package com.sun.enterprise.security.integration;\n \n /**\n  * Interface to facilitate Initialization of the injected Realm Instance with Application Descriptor info.\n- * \n+ *\n  * <p>\n  * See com.sun.enterprise.web.WebContainer and com.sun.web.security.RealmAdapter\n  */\n public interface RealmInitializer {\n \n-    void initializeRealm(Object bundledescriptor, boolean isSystemApp, String realmName);\n+    /**\n+     * Initializes the internal state of this instance with provided parameters.\n+     *\n+     * @param bundleDescriptor - contains bundle-specific configuration\n+     * @param isSystemApp - realm may have different behavior for system applications\n+     * @param defaultRealmName - this realm name will be used as a default if there will not be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTYzNTEwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if ( listener == null ) {\n          \n          \n            \n                    if (listener == null) {", "url": "https://github.com/payara/Payara/pull/4622#discussion_r409635108", "createdAt": "2020-04-16T15:10:59Z", "author": {"login": "Pandrex247"}, "path": "appserver/web/web-glue/src/main/java/com/sun/enterprise/web/WebModule.java", "diffHunk": "@@ -1266,7 +1264,9 @@ protected void addValve(org.glassfish.web.deployment.runtime.Valve valveDescript\n     protected void addCatalinaListener(String listenerName) {\n         Object listener = loadInstance(listenerName);\n \n-        if ( listener == null ) return;\n+        if ( listener == null ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b"}, "originalPosition": 204}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37627552b2006849ae6a3835f6d6fb0898e91ad6", "author": {"user": null}, "url": "https://github.com/payara/Payara/commit/37627552b2006849ae6a3835f6d6fb0898e91ad6", "committedDate": "2020-04-16T16:27:40Z", "message": "CUSTCOM-133 Cleanups around security\n\n- trimmed white spaces, manual formatting\n- more logging\n- added javadocs\n- enhanced loops\n- WebContainer:1812\n  - removed dead code, simplified\n- WebModuleConfig\n  - new method isSystemObjectType; it was weird to make this comparison outside\n    the object"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b", "author": {"user": null}, "url": "https://github.com/payara/Payara/commit/d31653cd8679a0fe15352a3a2bbea7e4f2ff1c9b", "committedDate": "2020-04-16T11:09:18Z", "message": "CUSTCOM-133 Cleanups around security\n\n- trimmed white spaces, manual formatting\n- more logging\n- added javadocs\n- enhanced loops\n- WebContainer:1812\n  - removed dead code, simplified\n- WebModuleConfig\n  - new method isSystemObjectType; it was weird to make this comparison outside\n    the object"}, "afterCommit": {"oid": "37627552b2006849ae6a3835f6d6fb0898e91ad6", "author": {"user": null}, "url": "https://github.com/payara/Payara/commit/37627552b2006849ae6a3835f6d6fb0898e91ad6", "committedDate": "2020-04-16T16:27:40Z", "message": "CUSTCOM-133 Cleanups around security\n\n- trimmed white spaces, manual formatting\n- more logging\n- added javadocs\n- enhanced loops\n- WebContainer:1812\n  - removed dead code, simplified\n- WebModuleConfig\n  - new method isSystemObjectType; it was weird to make this comparison outside\n    the object"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 809, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}