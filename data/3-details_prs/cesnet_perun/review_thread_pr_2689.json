{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MzM2NzA4", "number": 2689, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzoyMzo0M1rOD7HVjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzoyMzo0M1rOD7HVjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzMzEyNzgyOnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ResourcesManagerImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzoyMzo0M1rOGTPxAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzozMzoyN1rOGTQFoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzNDQzNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\t\" from services join resource_services on services.id=resource_services.service_id and resource_services.resource_id=?\",\n          \n          \n            \n            \t\t\t\t\t\" from services join resource_services on services.id=resource_services.service_id where resource_services.resource_id=?\",\n          \n      \n    \n    \n  \n\nI just wanted to ask, if there is a reason to use the condition in the join like you do, instead of writing WHERE?", "url": "https://github.com/CESNET/perun/pull/2689#discussion_r422834435", "createdAt": "2020-05-11T07:23:43Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ResourcesManagerImpl.java", "diffHunk": "@@ -560,9 +560,11 @@ public boolean isGroupAssigned(PerunSession sess, Group group, Resource resource\n \t}\n \n \t@Override\n-\tpublic List<Integer> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n+\tpublic List<Service> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n \t\ttry {\n-\t\t\treturn jdbc.query(\"select service_id as id from resource_services where resource_id=?\", Utils.ID_MAPPER, resource.getId());\n+\t\t\treturn jdbc.query(\"select \"+ ServicesManagerImpl.serviceMappingSelectQuery +\n+\t\t\t\t\t\" from services join resource_services on services.id=resource_services.service_id and resource_services.resource_id=?\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1760ce3b70fe41fe7561025ef9fa1d90ae33cb56"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzODc1NQ==", "bodyText": "Joined table can be constrained before actual joining. When you use condition in where, then whole tables are joined first and then invalid data is discarded. For our numbers of records within tables it doesn't really matter + clever sql planners can optimize it even if it`s in a where clause.", "url": "https://github.com/CESNET/perun/pull/2689#discussion_r422838755", "createdAt": "2020-05-11T07:31:35Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ResourcesManagerImpl.java", "diffHunk": "@@ -560,9 +560,11 @@ public boolean isGroupAssigned(PerunSession sess, Group group, Resource resource\n \t}\n \n \t@Override\n-\tpublic List<Integer> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n+\tpublic List<Service> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n \t\ttry {\n-\t\t\treturn jdbc.query(\"select service_id as id from resource_services where resource_id=?\", Utils.ID_MAPPER, resource.getId());\n+\t\t\treturn jdbc.query(\"select \"+ ServicesManagerImpl.serviceMappingSelectQuery +\n+\t\t\t\t\t\" from services join resource_services on services.id=resource_services.service_id and resource_services.resource_id=?\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzNDQzNQ=="}, "originalCommit": {"oid": "1760ce3b70fe41fe7561025ef9fa1d90ae33cb56"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzOTcxMg==", "bodyText": "Ok, I thought it might be something like that. Thanks.", "url": "https://github.com/CESNET/perun/pull/2689#discussion_r422839712", "createdAt": "2020-05-11T07:33:27Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ResourcesManagerImpl.java", "diffHunk": "@@ -560,9 +560,11 @@ public boolean isGroupAssigned(PerunSession sess, Group group, Resource resource\n \t}\n \n \t@Override\n-\tpublic List<Integer> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n+\tpublic List<Service> getAssignedServices(PerunSession sess, Resource resource) throws InternalErrorException {\n \t\ttry {\n-\t\t\treturn jdbc.query(\"select service_id as id from resource_services where resource_id=?\", Utils.ID_MAPPER, resource.getId());\n+\t\t\treturn jdbc.query(\"select \"+ ServicesManagerImpl.serviceMappingSelectQuery +\n+\t\t\t\t\t\" from services join resource_services on services.id=resource_services.service_id and resource_services.resource_id=?\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzNDQzNQ=="}, "originalCommit": {"oid": "1760ce3b70fe41fe7561025ef9fa1d90ae33cb56"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2035, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}