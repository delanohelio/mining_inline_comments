{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MTA0ODMx", "number": 2551, "title": "Add new method for testing database performance", "bodyText": "new method getTimeOfQueryPerformance in DatabaseManager on all layers\n(RPC, api, bl, blImpl), can be called by anyone with role SELF and it\nwill count processing time (in nanoseconds) of update operation (set\ntimestamp to database table configurations to predefined property)\nfor this purpose, other methods was created to support this\nfuncionality like createProperty (to create a new property in\nconfigurations table), propertyExists (to check if specific property\nalready exists or need to be created)\ncreating of this new property was added to initialization process of\nDatabaseManager (if property doesn't exist, it will be created on start\nof Perun system)\ndatabase schemas were modified to remove existing constraint on\nconfigurations table to allow any property (not just database version)\nbasic tests of new methods were added\ndatabase version was increased\n\nIMPORTANT: database need to be changed manually for this commit,\nconstraint need to be removed before using properly", "createdAt": "2020-01-30T14:29:28Z", "url": "https://github.com/CESNET/perun/pull/2551", "merged": true, "mergeCommit": {"oid": "89fcfa8ea0f276d5a7836dffce2eae08de649cca"}, "closed": true, "closedAt": "2020-02-04T13:31:47Z", "author": {"login": "stavamichal"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_raLQAFqTM1MTM2OTU2OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBBmOmAFqTM1Mjk3NDU1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMzY5NTY5", "url": "https://github.com/CESNET/perun/pull/2551#pullrequestreview-351369569", "createdAt": "2020-01-31T09:06:40Z", "commit": {"oid": "37951f786d55a93a476ddf57bb6f5d58a571593f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMzgzMjkz", "url": "https://github.com/CESNET/perun/pull/2551#pullrequestreview-351383293", "createdAt": "2020-01-31T09:32:11Z", "commit": {"oid": "37951f786d55a93a476ddf57bb6f5d58a571593f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDQwOTQ1", "url": "https://github.com/CESNET/perun/pull/2551#pullrequestreview-351440945", "createdAt": "2020-01-31T11:18:32Z", "commit": {"oid": "37951f786d55a93a476ddf57bb6f5d58a571593f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37951f786d55a93a476ddf57bb6f5d58a571593f", "author": {"user": {"login": "stavamichal", "name": "Michal Stava"}}, "url": "https://github.com/CESNET/perun/commit/37951f786d55a93a476ddf57bb6f5d58a571593f", "committedDate": "2020-01-30T14:28:40Z", "message": "Add new method for testing database performance\n\n - new method getTimeOfQueryPerformance in DatabaseManager on all layers\n (RPC, api, bl, blImpl), can be called by anyone with role SELF and it\n will count processing time (in nanoseconds) of update operation (set\n timestamp to database table configurations to predefined property)\n - for this purpose, other methods was created to support this\n funcionality like createProperty (to create a new property in\n configurations table), propertyExists (to check if specific property\n already exists or need to be created)\n - creating of this new property was added to initialization process of\n DatabaseManager (if property doesn't exist, it will be created on start\n of Perun system)\n - database schemas were modified to remove existing constraint on\n configurations table to allow any property (not just database version)\n - basic tests of new methods were added\n - database version was increased\n\n IMPORTANT: database need to be changed manually for this commit,\n constraint need to be removed before using properly"}, "afterCommit": {"oid": "a78c0db1f31e01d644e798e7c4c3c6612fbd4463", "author": {"user": {"login": "stavamichal", "name": "Michal Stava"}}, "url": "https://github.com/CESNET/perun/commit/a78c0db1f31e01d644e798e7c4c3c6612fbd4463", "committedDate": "2020-02-03T08:45:03Z", "message": "Add new method for testing database performance\n\n - new method getTimeOfQueryPerformance in DatabaseManager on all layers\n (RPC, api, bl, blImpl), can be called by anyone with role SELF and it\n will count processing time (in nanoseconds) of update operation (set\n timestamp to database table configurations to predefined property)\n - for this purpose, other methods was created to support this\n funcionality like createProperty (to create a new property in\n configurations table), propertyExists (to check if specific property\n already exists or need to be created)\n - creating of this new property was added to initialization process of\n DatabaseManager (if property doesn't exist, it will be created on start\n of Perun system)\n - method were added also to openapi perun module\n - database schemas were modified to remove existing constraint on\n configurations table to allow any property (not just database version)\n - basic tests of new methods were added\n - database version was increased\n\n IMPORTANT: database need to be changed manually for this commit,\n constraint need to be removed before using properly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMTM4NjE1", "url": "https://github.com/CESNET/perun/pull/2551#pullrequestreview-352138615", "createdAt": "2020-02-03T10:04:33Z", "commit": {"oid": "a78c0db1f31e01d644e798e7c4c3c6612fbd4463"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMDowNDozM1rOFksAQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMDowNDozM1rOFksAQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDAxNDAxNw==", "bodyText": "Please change the return type of the method to Long:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tpublic Object call(ApiCaller ac, Deserializer parms) throws PerunException {\n          \n          \n            \n            \t\tpublic Long call(ApiCaller ac, Deserializer parms) throws PerunException {", "url": "https://github.com/CESNET/perun/pull/2551#discussion_r374014017", "createdAt": "2020-02-03T10:04:33Z", "author": {"login": "martin-kuba"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/DatabaseManagerMethod.java", "diffHunk": "@@ -50,5 +52,21 @@ public Object call(ApiCaller ac, Deserializer parms) throws PerunException {\n \n \t\t\treturn ac.getDatabaseManager().getDatabaseInformation(ac.getSession());\n \t\t}\n+\t},\n+\n+\t/**\n+\t *\tGet time in ns \"nanoseconds\" of calling 1 simple update query to DB.\n+\t *  This query will update property for this purpose in configurations table.\n+\t *\n+\t * @exampleResponse \"196920\"\n+\t * @return time of processing query in nanoseconds\n+\t */\n+\tgetTimeOfQueryPerformance {\n+\n+\t\t@Override\n+\t\tpublic Object call(ApiCaller ac, Deserializer parms) throws PerunException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a78c0db1f31e01d644e798e7c4c3c6612fbd4463"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdedae6652b8a7bcac2a27858a29302de4a937fd", "author": {"user": {"login": "stavamichal", "name": "Michal Stava"}}, "url": "https://github.com/CESNET/perun/commit/fdedae6652b8a7bcac2a27858a29302de4a937fd", "committedDate": "2020-02-03T11:10:12Z", "message": "Add new method for testing database performance\n\n - new method getTimeOfQueryPerformance in DatabaseManager on all layers\n (RPC, api, bl, blImpl), can be called by anyone with role SELF and it\n will count processing time (in nanoseconds) of update operation (set\n timestamp to database table configurations to predefined property)\n - for this purpose, other methods was created to support this\n funcionality like createProperty (to create a new property in\n configurations table), propertyExists (to check if specific property\n already exists or need to be created)\n - creating of this new property was added to initialization process of\n DatabaseManager (if property doesn't exist, it will be created on start\n of Perun system)\n - method were added also to openapi perun module\n - database schemas were modified to remove existing constraint on\n configurations table to allow any property (not just database version)\n - basic tests of new methods were added\n - database version was increased\n\n IMPORTANT: database need to be changed manually for this commit,\n constraint need to be removed before using properly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a78c0db1f31e01d644e798e7c4c3c6612fbd4463", "author": {"user": {"login": "stavamichal", "name": "Michal Stava"}}, "url": "https://github.com/CESNET/perun/commit/a78c0db1f31e01d644e798e7c4c3c6612fbd4463", "committedDate": "2020-02-03T08:45:03Z", "message": "Add new method for testing database performance\n\n - new method getTimeOfQueryPerformance in DatabaseManager on all layers\n (RPC, api, bl, blImpl), can be called by anyone with role SELF and it\n will count processing time (in nanoseconds) of update operation (set\n timestamp to database table configurations to predefined property)\n - for this purpose, other methods was created to support this\n funcionality like createProperty (to create a new property in\n configurations table), propertyExists (to check if specific property\n already exists or need to be created)\n - creating of this new property was added to initialization process of\n DatabaseManager (if property doesn't exist, it will be created on start\n of Perun system)\n - method were added also to openapi perun module\n - database schemas were modified to remove existing constraint on\n configurations table to allow any property (not just database version)\n - basic tests of new methods were added\n - database version was increased\n\n IMPORTANT: database need to be changed manually for this commit,\n constraint need to be removed before using properly"}, "afterCommit": {"oid": "fdedae6652b8a7bcac2a27858a29302de4a937fd", "author": {"user": {"login": "stavamichal", "name": "Michal Stava"}}, "url": "https://github.com/CESNET/perun/commit/fdedae6652b8a7bcac2a27858a29302de4a937fd", "committedDate": "2020-02-03T11:10:12Z", "message": "Add new method for testing database performance\n\n - new method getTimeOfQueryPerformance in DatabaseManager on all layers\n (RPC, api, bl, blImpl), can be called by anyone with role SELF and it\n will count processing time (in nanoseconds) of update operation (set\n timestamp to database table configurations to predefined property)\n - for this purpose, other methods was created to support this\n funcionality like createProperty (to create a new property in\n configurations table), propertyExists (to check if specific property\n already exists or need to be created)\n - creating of this new property was added to initialization process of\n DatabaseManager (if property doesn't exist, it will be created on start\n of Perun system)\n - method were added also to openapi perun module\n - database schemas were modified to remove existing constraint on\n configurations table to allow any property (not just database version)\n - basic tests of new methods were added\n - database version was increased\n\n IMPORTANT: database need to be changed manually for this commit,\n constraint need to be removed before using properly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyOTc0NTU5", "url": "https://github.com/CESNET/perun/pull/2551#pullrequestreview-352974559", "createdAt": "2020-02-04T13:31:40Z", "commit": {"oid": "fdedae6652b8a7bcac2a27858a29302de4a937fd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1399, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}