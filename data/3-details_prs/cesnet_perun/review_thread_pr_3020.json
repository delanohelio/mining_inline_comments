{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzU3NzU1", "number": 3020, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToyODozOVrOE_NPlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMTozNDozNlrOE_k9NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NzEyNzI3OnYy", "diffSide": "RIGHT", "path": "perun-core/src/test/java/cz/metacentrum/perun/core/entry/ModulesUtilsEntryIntegrationTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToyODozOVrOH8yXDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowNjo1M1rOH9TcBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwMTcxMA==", "bodyText": "I would create some new testing login namespace instead of using 'einfra' which may not exists.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533501710", "createdAt": "2020-12-01T15:28:39Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/test/java/cz/metacentrum/perun/core/entry/ModulesUtilsEntryIntegrationTest.java", "diffHunk": "@@ -792,6 +794,31 @@ public void countUserFacilityQuotas() throws Exception {\n \t\tassertEquals(expectedResult, result);\n \t}\n \n+\t@Test\n+\tpublic void getUserByLoginInNamespace() throws Exception {\n+\t\tSystem.out.println(CLASS_NAME + \"getUserByLoginInNamespace\");\n+\n+\t\t// create user\n+\t\tUser user = new User();\n+\t\tuser.setFirstName(\"Firstname\");\n+\t\tuser.setLastName(\"Lastname\");\n+\t\tuser = perun.getUsersManagerBl().createUser(sess, user);\n+\t\tassertNotNull(user);\n+\n+\t\tUser userByLogin = perun.getModulesUtilsBl().getUserByLoginInNamespace(sess, \"testlogin\", \"einfra\");\n+\t\tassertNull(\"No user should be found.\", userByLogin);\n+\n+\t\t// create login in einfra namespace\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":einfra\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwMzI2OA==", "bodyText": "We have \"dummy\" login namespace / module for the purpose of the tests.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533703268", "createdAt": "2020-12-01T20:33:02Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/test/java/cz/metacentrum/perun/core/entry/ModulesUtilsEntryIntegrationTest.java", "diffHunk": "@@ -792,6 +794,31 @@ public void countUserFacilityQuotas() throws Exception {\n \t\tassertEquals(expectedResult, result);\n \t}\n \n+\t@Test\n+\tpublic void getUserByLoginInNamespace() throws Exception {\n+\t\tSystem.out.println(CLASS_NAME + \"getUserByLoginInNamespace\");\n+\n+\t\t// create user\n+\t\tUser user = new User();\n+\t\tuser.setFirstName(\"Firstname\");\n+\t\tuser.setLastName(\"Lastname\");\n+\t\tuser = perun.getUsersManagerBl().createUser(sess, user);\n+\t\tassertNotNull(user);\n+\n+\t\tUser userByLogin = perun.getModulesUtilsBl().getUserByLoginInNamespace(sess, \"testlogin\", \"einfra\");\n+\t\tassertNull(\"No user should be found.\", userByLogin);\n+\n+\t\t// create login in einfra namespace\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":einfra\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwMTcxMA=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MzY1Mg==", "bodyText": "Done, I create \"dummy\" login namespace attribute, if it is not already created.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534043652", "createdAt": "2020-12-02T10:06:53Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/test/java/cz/metacentrum/perun/core/entry/ModulesUtilsEntryIntegrationTest.java", "diffHunk": "@@ -792,6 +794,31 @@ public void countUserFacilityQuotas() throws Exception {\n \t\tassertEquals(expectedResult, result);\n \t}\n \n+\t@Test\n+\tpublic void getUserByLoginInNamespace() throws Exception {\n+\t\tSystem.out.println(CLASS_NAME + \"getUserByLoginInNamespace\");\n+\n+\t\t// create user\n+\t\tUser user = new User();\n+\t\tuser.setFirstName(\"Firstname\");\n+\t\tuser.setLastName(\"Lastname\");\n+\t\tuser = perun.getUsersManagerBl().createUser(sess, user);\n+\t\tassertNotNull(user);\n+\n+\t\tUser userByLogin = perun.getModulesUtilsBl().getUserByLoginInNamespace(sess, \"testlogin\", \"einfra\");\n+\t\tassertNull(\"No user should be found.\", userByLogin);\n+\n+\t\t// create login in einfra namespace\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":einfra\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwMTcxMA=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NzM4ODY3OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNjoyMDo0OVrOH805BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowNDoyMFrOH9TVcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU0MzE3Mw==", "bodyText": "I would perform check, that there is a single result and throw ConsistencyErrorException otherwise.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533543173", "createdAt": "2020-12-01T16:20:49Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else {\n+\t\t\treturn usersByLoginInNamespace.get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MTk2OA==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534041968", "createdAt": "2020-12-02T10:04:20Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else {\n+\t\t\treturn usersByLoginInNamespace.get(0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU0MzE3Mw=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODMyNzQyOnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/modules/pwdmgr/EgiuiPasswordManagerModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMDoxMjowN1rOH899YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowNDoyOFrOH9TV1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY5MTc0NQ==", "bodyText": "Since you are extending GenericPasswordManagerModule you should re-define constructor and set proper values to some variables. See EinfraPasswordManagerModule.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533691745", "createdAt": "2020-12-01T20:12:07Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/modules/pwdmgr/EgiuiPasswordManagerModule.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package cz.metacentrum.perun.core.impl.modules.pwdmgr;\n+\n+import cz.metacentrum.perun.core.api.Attribute;\n+import cz.metacentrum.perun.core.api.AttributesManager;\n+import cz.metacentrum.perun.core.api.ExtSource;\n+import cz.metacentrum.perun.core.api.PerunSession;\n+import cz.metacentrum.perun.core.api.User;\n+import cz.metacentrum.perun.core.api.UserExtSource;\n+import cz.metacentrum.perun.core.api.exceptions.AttributeNotExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.ExtSourceNotExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.InternalErrorException;\n+import cz.metacentrum.perun.core.api.exceptions.InvalidLoginException;\n+import cz.metacentrum.perun.core.api.exceptions.UserExtSourceExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongAttributeAssignmentException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongAttributeValueException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongReferenceAttributeValueException;\n+import cz.metacentrum.perun.core.bl.PerunBl;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+/**\n+ * Password manager for EGI-UI login-namespace.\n+ */\n+public class EgiuiPasswordManagerModule extends GenericPasswordManagerModule {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MjA3MA==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534042070", "createdAt": "2020-12-02T10:04:28Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/modules/pwdmgr/EgiuiPasswordManagerModule.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package cz.metacentrum.perun.core.impl.modules.pwdmgr;\n+\n+import cz.metacentrum.perun.core.api.Attribute;\n+import cz.metacentrum.perun.core.api.AttributesManager;\n+import cz.metacentrum.perun.core.api.ExtSource;\n+import cz.metacentrum.perun.core.api.PerunSession;\n+import cz.metacentrum.perun.core.api.User;\n+import cz.metacentrum.perun.core.api.UserExtSource;\n+import cz.metacentrum.perun.core.api.exceptions.AttributeNotExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.ExtSourceNotExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.InternalErrorException;\n+import cz.metacentrum.perun.core.api.exceptions.InvalidLoginException;\n+import cz.metacentrum.perun.core.api.exceptions.UserExtSourceExistsException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongAttributeAssignmentException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongAttributeValueException;\n+import cz.metacentrum.perun.core.api.exceptions.WrongReferenceAttributeValueException;\n+import cz.metacentrum.perun.core.bl.PerunBl;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+/**\n+ * Password manager for EGI-UI login-namespace.\n+ */\n+public class EgiuiPasswordManagerModule extends GenericPasswordManagerModule {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY5MTc0NQ=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODM4ODUzOnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/UsersManagerMethod.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMDoyOToxNVrOH8-iEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowNDozN1rOH9TWNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwMTEzOA==", "bodyText": "Please add some message, so its more like @deprecated see validatePassword()", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533701138", "createdAt": "2020-12-01T20:29:15Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/UsersManagerMethod.java", "diffHunk": "@@ -1158,6 +1158,7 @@ public Void call(ApiCaller ac, Deserializer parms) throws PerunException {\n \t * Validates password for a user in specified login-namespace. After that, user should be able to log-in\n \t * in external authz system using his credentials. It also creates UserExtSource and sets some required attributes.\n \t *\n+\t * @deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MjE2NA==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534042164", "createdAt": "2020-12-02T10:04:37Z", "author": {"login": "cuadradek"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/UsersManagerMethod.java", "diffHunk": "@@ -1158,6 +1158,7 @@ public Void call(ApiCaller ac, Deserializer parms) throws PerunException {\n \t * Validates password for a user in specified login-namespace. After that, user should be able to log-in\n \t * in external authz system using his credentials. It also creates UserExtSource and sets some required attributes.\n \t *\n+\t * @deprecated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwMTEzOA=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODQxMjA1OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/implApi/modules/pwdmgr/PasswordManagerModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMDozNTo0NlrOH8-wNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowNDo1NVrOH9TXCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwNDc1OA==", "bodyText": "I would prefer covering those new exceptions in InternalErrorException as did the original method validatePasswordAndSetExtSources(), since they are not relevant to the caller and are expected to never happen in correctly configured instance. Please update the modules and method hierarchy accordingly. Thank you.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r533704758", "createdAt": "2020-12-01T20:35:46Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/implApi/modules/pwdmgr/PasswordManagerModule.java", "diffHunk": "@@ -40,7 +43,7 @@\n \n \tvoid changePassword(PerunSession sess, String userLogin, String newPassword) throws InvalidLoginException, PasswordStrengthException;\n \n-\tvoid validatePassword(PerunSession sess, String userLogin) throws InvalidLoginException;\n+\tvoid validatePassword(PerunSession sess, String userLogin, User user) throws InvalidLoginException, ExtSourceNotExistsException, WrongReferenceAttributeValueException, WrongAttributeValueException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MjM3OQ==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534042379", "createdAt": "2020-12-02T10:04:55Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/implApi/modules/pwdmgr/PasswordManagerModule.java", "diffHunk": "@@ -40,7 +43,7 @@\n \n \tvoid changePassword(PerunSession sess, String userLogin, String newPassword) throws InvalidLoginException, PasswordStrengthException;\n \n-\tvoid validatePassword(PerunSession sess, String userLogin) throws InvalidLoginException;\n+\tvoid validatePassword(PerunSession sess, String userLogin, User user) throws InvalidLoginException, ExtSourceNotExistsException, WrongReferenceAttributeValueException, WrongAttributeValueException;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwNDc1OA=="}, "originalCommit": {"oid": "84325f16c4e1152c297ee98e55bfd0e355a83928"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDY2NjY3OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMDowOTowNlrOH9ThgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMTowNzoxNVrOH9V1ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0NTA1Ng==", "bodyText": "It is 2 or more (size could be bigger than 2).", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534045056", "createdAt": "2020-12-02T10:09:06Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else if (usersByLoginInNamespace.size() == 1) {\n+\t\t\treturn usersByLoginInNamespace.get(0);\n+\t\t} else throw new ConsistencyErrorException(\"There are 2 same logins '\" + login + \"' in namespace \" + namespace + \".\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a37335e772c73b92a59c0503ec6f8b49d20f8a59"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA4MjkzOQ==", "bodyText": "Fixed", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534082939", "createdAt": "2020-12-02T11:07:15Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else if (usersByLoginInNamespace.size() == 1) {\n+\t\t\treturn usersByLoginInNamespace.get(0);\n+\t\t} else throw new ConsistencyErrorException(\"There are 2 same logins '\" + login + \"' in namespace \" + namespace + \".\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0NTA1Ng=="}, "originalCommit": {"oid": "a37335e772c73b92a59c0503ec6f8b49d20f8a59"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MTAxMjM2OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMTozNDozNlrOH9WzlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMTo1Mjo0MlrOH9XaYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA5ODgzNg==", "bodyText": "Can you please put it between curly brackets, like: } else { throw .... }. Thank you.", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534098836", "createdAt": "2020-12-02T11:34:36Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else if (usersByLoginInNamespace.size() == 1) {\n+\t\t\treturn usersByLoginInNamespace.get(0);\n+\t\t} else throw new ConsistencyErrorException(\"There is more than 1 login '\" + login + \"' in namespace \" + namespace + \".\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "657aa2eef2b52fb1f94f5497d4441e202adf073f"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDEwODc3MQ==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/3020#discussion_r534108771", "createdAt": "2020-12-02T11:52:42Z", "author": {"login": "cuadradek"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/ModulesUtilsBlImpl.java", "diffHunk": "@@ -1183,6 +1184,18 @@ public User getUserFromMessage(PerunSessionImpl sess, String message) {\n \t\treturn convertedRanges;\n \t}\n \n+\t@Override\n+\tpublic User getUserByLoginInNamespace(PerunSession sess, String login, String namespace) {\n+\t\tString attrName = AttributesManager.NS_USER_ATTR_DEF + \":\" + AttributesManager.LOGIN_NAMESPACE + \":\" + namespace;\n+\t\tList<User> usersByLoginInNamespace = getPerunBl().getUsersManagerBl().getUsersByAttributeValue(sess, attrName, login);\n+\n+\t\tif (usersByLoginInNamespace.isEmpty()) {\n+\t\t\treturn null;\n+\t\t} else if (usersByLoginInNamespace.size() == 1) {\n+\t\t\treturn usersByLoginInNamespace.get(0);\n+\t\t} else throw new ConsistencyErrorException(\"There is more than 1 login '\" + login + \"' in namespace \" + namespace + \".\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA5ODgzNg=="}, "originalCommit": {"oid": "657aa2eef2b52fb1f94f5497d4441e202adf073f"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2209, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}