{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MDk1MzE0", "number": 2582, "title": "OpenAPI - vo manager implemented", "bodyText": "implement openAPI methods for vosManager\nadded new schemas and responses", "createdAt": "2020-02-24T16:50:17Z", "url": "https://github.com/CESNET/perun/pull/2582", "merged": true, "mergeCommit": {"oid": "7908cb4f073d23b354688227656577eb16aa7311"}, "closed": true, "closedAt": "2020-03-03T08:42:28Z", "author": {"login": "xkureck"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHhB57AFqTM2MzU1NjAzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJuhcnABqjMwODgxNDg4NDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTU2MDM2", "url": "https://github.com/CESNET/perun/pull/2582#pullrequestreview-363556036", "createdAt": "2020-02-24T17:10:44Z", "commit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMDo0NFrOFtor0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzozMjoyNFrOFtpaxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NjgxOA==", "bodyText": "There is no need to have two separate methods deleteVo and deleteVoForce, the \"force\" parameter can be declared \"required: false\" which makes it optional. Keep just one deleteVo method with the optional parameter.", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383396818", "createdAt": "2020-02-24T17:10:44Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6832,11 +6868,104 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO deleteVo\n+  /urlinjsonout/vosManager/deleteVo/pure:\n+    post:\n+      tags:\n+        - VosManager\n+      operationId: deleteVo\n+      summary: Deletes a VO. If VO contain members, group or resources, it's not deleted and exception is thrown.\n+      parameters:\n+        - $ref: '#/components/parameters/voId'\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/VoidResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO createVo\n+  /urlinjsonout/vosManager/deleteVo/withAll:\n+    post:\n+      tags:\n+        - VosManager\n+      operationId: deleteVoForce\n+      summary: Deletes a VO. If <code>force == true</code> then VO is deleted including members, groups and resources.\n+               Otherwise only empty VO is deleted or exception is thrown.\n+      parameters:\n+        - $ref: '#/components/parameters/voId'\n+        - { name: force, description: \"Force must be true\", schema: { type: boolean },  in: query, required: true }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5OTYzMg==", "bodyText": "The operations /json/vosManager/findCandidates and /json/vosManager/findCandidates/withMaxNumberResults can be merged into one with optional parameter maxNumOfResults.", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383399632", "createdAt": "2020-02-24T17:15:53Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6866,11 +6995,126 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO findCandidates\n+  /json/vosManager/findCandidates:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidates\n+      summary: |\n+              Find candidates for VO. Candidates can be used to create new members. Candidates are searched\n+              in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO getCompleteCandidates\n+  /json/vosManager/findCandidates/withMaxNumberResults:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidatesWithMaximumNumberResults\n+      summary: |\n+              Find candidates for VO with specified maximum number of results. Candidates can be used to create new members.\n+              Candidates are searched in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+        - { name: maxNumOfResults, schema: { type: integer}, in: query, required: true, description: 'Number of maximum results' }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 203}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwMDYwNg==", "bodyText": "Can be replaced with $ref: '#/components/parameters/attrNames'", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383400606", "createdAt": "2020-02-24T17:17:43Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6866,11 +6995,126 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO findCandidates\n+  /json/vosManager/findCandidates:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidates\n+      summary: |\n+              Find candidates for VO. Candidates can be used to create new members. Candidates are searched\n+              in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO getCompleteCandidates\n+  /json/vosManager/findCandidates/withMaxNumberResults:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidatesWithMaximumNumberResults\n+      summary: |\n+              Find candidates for VO with specified maximum number of results. Candidates can be used to create new members.\n+              Candidates are searched in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+        - { name: maxNumOfResults, schema: { type: integer}, in: query, required: true, description: 'Number of maximum results' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO getVosCount\n+  /json/vosManager/findCandidates/forGroup:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidatesForGroup\n+      summary: |\n+              Find candidates for Group. Candidates can be used to create new VO and Group members. Candidates are searched\n+              in Groups external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - { name: group, schema: { type: integer}, in: query, required: true, description: 'group id' }\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /json/vosManager/getCompleteCandidates/forVo:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: getCompleteCandidatesForVo\n+      summary: |\n+                Find MemberCandidates for VO. MemberCandidates can be used to create new members. They are made of Candidate,\n+                RichUser and Member objects. Candidates are searched in VO's external sources (if available). RichUsers are\n+                searched in given VO and are associated with appropriate candidate and member. RichUsers for MemberCandidates\n+                may also be searched in the whole Perun.\n+      parameters:\n+        - { name: vo, schema: { type: integer}, in: query, required: true, description: 'vo id' }\n+        - name: attrNames", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 241}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwMDc2OA==", "bodyText": "dtto", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383400768", "createdAt": "2020-02-24T17:18:02Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6866,11 +6995,126 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO findCandidates\n+  /json/vosManager/findCandidates:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidates\n+      summary: |\n+              Find candidates for VO. Candidates can be used to create new members. Candidates are searched\n+              in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO getCompleteCandidates\n+  /json/vosManager/findCandidates/withMaxNumberResults:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidatesWithMaximumNumberResults\n+      summary: |\n+              Find candidates for VO with specified maximum number of results. Candidates can be used to create new members.\n+              Candidates are searched in VOs external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - $ref: '#/components/parameters/id'\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+        - { name: maxNumOfResults, schema: { type: integer}, in: query, required: true, description: 'Number of maximum results' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO getVosCount\n+  /json/vosManager/findCandidates/forGroup:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: findCandidatesForGroup\n+      summary: |\n+              Find candidates for Group. Candidates can be used to create new VO and Group members. Candidates are searched\n+              in Groups external sources (if available). Candidates, which are already members of VO are never\n+              returned even if they match searchString.\n+      parameters:\n+        - { name: group, schema: { type: integer}, in: query, required: true, description: 'group id' }\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /json/vosManager/getCompleteCandidates/forVo:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: getCompleteCandidatesForVo\n+      summary: |\n+                Find MemberCandidates for VO. MemberCandidates can be used to create new members. They are made of Candidate,\n+                RichUser and Member objects. Candidates are searched in VO's external sources (if available). RichUsers are\n+                searched in given VO and are associated with appropriate candidate and member. RichUsers for MemberCandidates\n+                may also be searched in the whole Perun.\n+      parameters:\n+        - { name: vo, schema: { type: integer}, in: query, required: true, description: 'vo id' }\n+        - name: attrNames\n+          description: 'list with names of attributes that should be find'\n+          schema:\n+            type: array\n+            items:\n+              type: string\n+          in: query\n+          required: true\n+        - { name: searchString, schema: { type: string}, in: query, required: true, description: 'Text to search by' }\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfMemberCandidatesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /json/vosManager/getCompleteCandidates/forGroup:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: getCompleteCandidatesForGroup\n+      summary: |\n+                Find MemberCandidates for GROUP. MemberCandidates can be used to create new members. They are made of Candidate,\n+                RichUser and Member objects. Candidates are searched in VO's or GROUP's (depends on privileges) external sources\n+                (if available). RichUsers are searched in given VO and are associated with appropriate candidate and member.\n+                RichUsers for appropriate Candidate are also searched in the whole Perun.\n+      parameters:\n+        - { name: group, schema: { type: integer}, in: query, required: true, description: 'group id' }\n+        - name: attrNames", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 268}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwNTY3OA==", "bodyText": "The authorizedGroup parameter is repeated at methods addSponsorRoleToGroup, removeSponsorRoleFromGroup, addVoAdminGroup, removeVoAdminGroup, addFacilityAdminGroup, removeFacilityAdminGroup, addAdminToGroup, removeGroupAdminResource. Please declare it in #/components/parameters and use $ref to reference it.", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383405678", "createdAt": "2020-02-24T17:26:33Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6934,7 +7206,35 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-  #TODO removeSponsorRole\n+  /urlinjsonout/vosManager/removeSponsorRole/user:\n+    post:\n+      tags:\n+        - VosManager\n+      operationId: removeSponsorRoleFromUser\n+      summary: Removes user as a sponsor. His or her sponsored members will be set as expired if the user was their last sponsor.\n+      parameters:\n+        - $ref: '#/components/parameters/voId'\n+        - $ref: '#/components/parameters/userId'\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/VoidResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/vosManager/removeSponsorRole/group:\n+    post:\n+      tags:\n+        - VosManager\n+      operationId: removeSponsorRoleFromGroup\n+      summary: Removes group as a sponsor. All group members will cease to be sponsors, and their sponsored members will be set as expired if the group member was their last sponsor.\n+      parameters:\n+        - $ref: '#/components/parameters/voId'\n+        - { name: authorizedGroup, schema: { type: integer}, in: query, required: true, description: 'Group id' }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 362}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwODgzOA==", "bodyText": "Please use the shorter \"flow mapping\" syntax as for the other parameters.", "url": "https://github.com/CESNET/perun/pull/2582#discussion_r383408838", "createdAt": "2020-02-24T17:32:24Z", "author": {"login": "martin-kuba"}, "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -6972,8 +7272,34 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n-\n-  #TODO getRichAdmins\n+  /json/vosManager/getRichAdmins:\n+    get:\n+      tags:\n+        - VosManager\n+      operationId: getRichAdminsForVo\n+      description: |\n+        Get list of all richUser administrators for the vo and supported role with specific attributes.\n+        Supported roles: VOOBSERVER, TOPGROUPCREATOR, VOADMIN\n+        If \"onlyDirectAdmins\" is == true, return only direct admins of the vo for supported role with specific attributes.\n+        If \"allUserAttributes\" is == true, do not specify attributes through list and return them all in objects richUser. Ignoring list of specific attributes.\n+      parameters:\n+        - $ref: '#/components/parameters/voId'\n+        - { name: role, schema: { $ref: '#/components/schemas/VoAdminRoles' }, in: query, required: true, description: 'role name'}\n+        - name: specificAttributes\n+          description: 'list of specified attributes which are needed in object richUser'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e959fa09acdd5ec6800352870caa3ace3afe4ebf"}, "originalPosition": 391}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MjU2MzM0", "url": "https://github.com/CESNET/perun/pull/2582#pullrequestreview-364256334", "createdAt": "2020-02-25T15:54:51Z", "commit": {"oid": "a7e3090dca5133bc1e7234c211b2344e0ada8b7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3MDAwMjE4", "url": "https://github.com/CESNET/perun/pull/2582#pullrequestreview-367000218", "createdAt": "2020-03-02T07:52:32Z", "commit": {"oid": "a7e3090dca5133bc1e7234c211b2344e0ada8b7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bd5f564bddb2a0d2ac9415359b03244953adf47", "author": {"user": null}, "url": "https://github.com/CESNET/perun/commit/3bd5f564bddb2a0d2ac9415359b03244953adf47", "committedDate": "2020-03-02T14:08:56Z", "message": "OpenAPI - vo manager implemented\n* implement openAPI methods for vosManager\n* added new schemas and responses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92107fc02bd4411d51162c221dd03554c3b5a171", "author": {"user": null}, "url": "https://github.com/CESNET/perun/commit/92107fc02bd4411d51162c221dd03554c3b5a171", "committedDate": "2020-03-02T14:22:59Z", "message": "OpenAPI - vo manager implemented\n* changes according to review\n* added new parameters and used them in vo and facility managers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a7e3090dca5133bc1e7234c211b2344e0ada8b7f", "author": {"user": null}, "url": "https://github.com/CESNET/perun/commit/a7e3090dca5133bc1e7234c211b2344e0ada8b7f", "committedDate": "2020-02-25T15:11:44Z", "message": "OpenAPI - vo manager implemented\n* changes according to review\n* added new parameters and used them in vo and facility managers"}, "afterCommit": {"oid": "92107fc02bd4411d51162c221dd03554c3b5a171", "author": {"user": null}, "url": "https://github.com/CESNET/perun/commit/92107fc02bd4411d51162c221dd03554c3b5a171", "committedDate": "2020-03-02T14:22:59Z", "message": "OpenAPI - vo manager implemented\n* changes according to review\n* added new parameters and used them in vo and facility managers"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1432, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}