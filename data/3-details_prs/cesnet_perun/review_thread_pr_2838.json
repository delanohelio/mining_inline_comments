{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzOTU0ODY5", "number": 2838, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyNTowMVrOEgQczQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjo0MToyN1rOEgQsfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU5NDA1OnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ExtSourcesManagerMethod.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyNTowMVrOHNBJeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyNTowMVrOHNBJeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMjM0Ng==", "bodyText": "This is called by CLI when using tools to add/remove UES or set/remove their attributes. We should check, if user (SELF) can call these methods and if yes, we should enable SELF role in this methods policy.", "url": "https://github.com/CESNET/perun/pull/2838#discussion_r483412346", "createdAt": "2020-09-04T06:25:01Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ExtSourcesManagerMethod.java", "diffHunk": "@@ -62,7 +62,7 @@ public Void call(ApiCaller ac, Deserializer parms) throws PerunException {\n \n \t\t@Override\n \t\tpublic ExtSource call(ApiCaller ac, Deserializer parms) throws PerunException {\n-\t\t\treturn ac.getExtSourceById(parms.readInt(\"id\"));\n+\t\t\treturn ac.getExtSourcesManager().getExtSourceById(ac.getSession(), parms.readInt(\"id\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd547bd817a8e507f2ee02cfea65536d6b6c44e9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjYxMTAxOnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/MembersManagerMethod.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozMjoxOFrOHNBTow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozMjoxOFrOHNBTow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNDk0Nw==", "bodyText": "I believe we should allow also SELF on Member/User in this methods policy.", "url": "https://github.com/CESNET/perun/pull/2838#discussion_r483414947", "createdAt": "2020-09-04T06:32:18Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/MembersManagerMethod.java", "diffHunk": "@@ -501,7 +501,7 @@ public Member call(ApiCaller ac, Deserializer parms) throws PerunException {\n \tgetMemberById {\n \t\t@Override\n \t\tpublic Member call(ApiCaller ac, Deserializer parms) throws PerunException {\n-\t\t\treturn ac.getMemberById(parms.readInt(\"id\"));\n+\t\t\treturn ac.getMembersManager().getMemberById(ac.getSession(), parms.readInt(\"id\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd547bd817a8e507f2ee02cfea65536d6b6c44e9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjYyMDY0OnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ResourcesManagerMethod.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozNjoxMFrOHNBZig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozNjoxMFrOHNBZig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNjQ1OA==", "bodyText": "A would allow this method for FACILITYADMIN too. They probably use version with RichResource from GUI, but its not consistent with expected logic that facility admin can retrieve resources of his facility (by any identifier).", "url": "https://github.com/CESNET/perun/pull/2838#discussion_r483416458", "createdAt": "2020-09-04T06:36:10Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ResourcesManagerMethod.java", "diffHunk": "@@ -24,7 +24,7 @@\n \n \t\t@Override\n \t\tpublic Resource call(ApiCaller ac, Deserializer parms) throws PerunException {\n-\t\t\treturn ac.getResourceById(parms.readInt(\"id\"));\n+\t\t\treturn ac.getResourcesManager().getResourceById(ac.getSession(), parms.readInt(\"id\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd547bd817a8e507f2ee02cfea65536d6b6c44e9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjYyNzk1OnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ServicesManagerMethod.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozOTowNlrOHNBdzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjozOTowNlrOHNBdzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNzU1MQ==", "bodyText": "Its strange, that this method is not allowed for facility admins (same for ByName version), but facility admins can retrieve all services together. We should allow it for them in both methods.", "url": "https://github.com/CESNET/perun/pull/2838#discussion_r483417551", "createdAt": "2020-09-04T06:39:06Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ServicesManagerMethod.java", "diffHunk": "@@ -399,7 +399,7 @@ public Void call(ApiCaller ac, Deserializer parms) throws PerunException {\n \n \t\t@Override\n \t\tpublic Service call(ApiCaller ac, Deserializer parms) throws PerunException {\n-\t\t\treturn ac.getServiceById(parms.readInt(\"id\"));\n+\t\t\treturn ac.getServicesManager().getServiceById(ac.getSession(), parms.readInt(\"id\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd547bd817a8e507f2ee02cfea65536d6b6c44e9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjYzNDIxOnYy", "diffSide": "RIGHT", "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ServicesManagerMethod.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjo0MToyN1rOHNBheQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjo0MToyN1rOHNBheQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxODQ4OQ==", "bodyText": "Same goes for all methods working with service packages, since facility admin is the one to get/assign service packages to the facility and perun admin manages those packages.", "url": "https://github.com/CESNET/perun/pull/2838#discussion_r483418489", "createdAt": "2020-09-04T06:41:27Z", "author": {"login": "zlamalp"}, "path": "perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/ServicesManagerMethod.java", "diffHunk": "@@ -966,7 +966,7 @@ public ServiceAttributes call(ApiCaller ac, Deserializer parms) throws PerunExce\n \n \t\t@Override\n \t\tpublic ServicesPackage call(ApiCaller ac, Deserializer parms) throws PerunException {\n-\t\t\treturn ac.getServicesPackageById(parms.readInt(\"servicesPackageId\"));\n+\t\t\treturn ac.getServicesManager().getServicesPackageById(ac.getSession(), parms.readInt(\"servicesPackageId\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd547bd817a8e507f2ee02cfea65536d6b6c44e9"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2391, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}