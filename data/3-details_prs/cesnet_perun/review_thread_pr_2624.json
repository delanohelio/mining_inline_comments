{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NzcxOTIz", "number": 2624, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNDoyNDozOVrODpIerA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNTowNDozN1rODpJnKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NDU3MTMyOnYy", "diffSide": "RIGHT", "path": "perun-base/src/test/resources/perun-roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNDoyNDozOVrOF4HWfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDo1MTozM1rOG2rHHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM4NTAyMg==", "bodyText": "This rules seems weird.", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r394385022", "createdAt": "2020-03-18T14:24:39Z", "author": {"login": "stavamichal"}, "path": "perun-base/src/test/resources/perun-roles.yml", "diffHunk": "@@ -167,4 +167,559 @@ perun_policies:\n       - PERUNOBSERVER:\n     include_policies:\n       - test_resource_admin\n+\n+  #MembersManagerEntry\n+  deleteMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteMembers_List<Member>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteAllMembers_Vo_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSpecificMember_Vo_Candidate_List<User>_SpecificUserType_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_int_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_User_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_ExtSource_String_List<Group>_policy:\n+    policy_roles:\n+      - Group: Group", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MjYyMg==", "bodyText": "Fixed", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r459982622", "createdAt": "2020-07-24T10:51:33Z", "author": {"login": "balcirakpeter"}, "path": "perun-base/src/test/resources/perun-roles.yml", "diffHunk": "@@ -167,4 +167,559 @@ perun_policies:\n       - PERUNOBSERVER:\n     include_policies:\n       - test_resource_admin\n+\n+  #MembersManagerEntry\n+  deleteMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteMembers_List<Member>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteAllMembers_Vo_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSpecificMember_Vo_Candidate_List<User>_SpecificUserType_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_int_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_User_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_ExtSource_String_List<Group>_policy:\n+    policy_roles:\n+      - Group: Group", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM4NTAyMg=="}, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NDYxNTg3OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/entry/MembersManagerEntry.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNDozNDoxMVrOF4Hzxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDo1MTozOFrOG2rHQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM5MjUxOA==", "bodyText": "I would definitely split this to two situations.\n1] user in session is GroupAdmin of all defined groups\n2] at least one of defined group has this ExtSource set (we don't need to check them all before testing this situation)", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r394392518", "createdAt": "2020-03-18T14:34:11Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/entry/MembersManagerEntry.java", "diffHunk": "@@ -344,30 +367,21 @@ public Member createMember(PerunSession sess, Vo vo, ExtSource extSource, String\n \t\t\t}\n \t\t}\n \n-\t\t// Authorization for vo admin and perun admin automatic\n-\t\tif (!AuthzResolver.isAuthorized(sess, Role.VOADMIN, vo)) {\n+\t\t// Authorization\n+\t\tif (!AuthzResolver.authorizedInternal(sess, \"createMember_Vo_ExtSource_String_List<Group>_policy\", Arrays.asList(vo, extSource))) {\n \t\t\t//also group admin of all affected groups is ok\n \t\t\tif (groups != null && !groups.isEmpty()) {\n-\t\t\t\tboolean groupAdminOfAllGroups = true;\n-\t\t\t\tboolean authorizedToExtSource = false;\n-\t\t\t\tfor (Group group : groups) {\n-\t\t\t\t\t//User in session has to be GroupAdmin of all affected groups\n-\t\t\t\t\tif (!AuthzResolver.isAuthorized(sess, Role.GROUPADMIN, group)) {\n-\t\t\t\t\t\tgroupAdminOfAllGroups = false;\n-\t\t\t\t\t\tbreak;\n-\t\t\t\t\t}\n-\t\t\t\t\t//User in session has to have at least one right to work with the ExtSource\n-\t\t\t\t\tList<ExtSource> groupExtSources = getPerunBl().getExtSourcesManagerBl().getGroupExtSources(sess, group);\n-\t\t\t\t\tif (groupExtSources.contains(extSource)) authorizedToExtSource = true;\n-\t\t\t\t}\n-\n-\t\t\t\tif (!groupAdminOfAllGroups || !authorizedToExtSource) {\n-\t\t\t\t\tthrow new PrivilegeException(sess, \"createMember - from login and extSource -- authorized to extSource=\" + authorizedToExtSource + \" and groupAdmin in all groups=\" + groupAdminOfAllGroups);\n+\t\t\t\tSet<ExtSource> groupExtSources = new HashSet<>();\n+\t\t\t\tgroups.forEach(group -> groupExtSources.addAll(getPerunBl().getExtSourcesManagerBl().getGroupExtSources(sess, group)));\n+\t\t\t\tif (!groupExtSources.contains(extSource) ||\n+\t\t\t\t\t!AuthzResolver.authorizedInternal(sess, \"createMember_Vo_ExtSource_String_List<Group>_policy\", new ArrayList<>(groups))) {\n+\t\t\t\t\tthrow new PrivilegeException(sess, \"createMember - from login and extSource\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 260}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MjY1OQ==", "bodyText": "Done", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r459982659", "createdAt": "2020-07-24T10:51:38Z", "author": {"login": "balcirakpeter"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/entry/MembersManagerEntry.java", "diffHunk": "@@ -344,30 +367,21 @@ public Member createMember(PerunSession sess, Vo vo, ExtSource extSource, String\n \t\t\t}\n \t\t}\n \n-\t\t// Authorization for vo admin and perun admin automatic\n-\t\tif (!AuthzResolver.isAuthorized(sess, Role.VOADMIN, vo)) {\n+\t\t// Authorization\n+\t\tif (!AuthzResolver.authorizedInternal(sess, \"createMember_Vo_ExtSource_String_List<Group>_policy\", Arrays.asList(vo, extSource))) {\n \t\t\t//also group admin of all affected groups is ok\n \t\t\tif (groups != null && !groups.isEmpty()) {\n-\t\t\t\tboolean groupAdminOfAllGroups = true;\n-\t\t\t\tboolean authorizedToExtSource = false;\n-\t\t\t\tfor (Group group : groups) {\n-\t\t\t\t\t//User in session has to be GroupAdmin of all affected groups\n-\t\t\t\t\tif (!AuthzResolver.isAuthorized(sess, Role.GROUPADMIN, group)) {\n-\t\t\t\t\t\tgroupAdminOfAllGroups = false;\n-\t\t\t\t\t\tbreak;\n-\t\t\t\t\t}\n-\t\t\t\t\t//User in session has to have at least one right to work with the ExtSource\n-\t\t\t\t\tList<ExtSource> groupExtSources = getPerunBl().getExtSourcesManagerBl().getGroupExtSources(sess, group);\n-\t\t\t\t\tif (groupExtSources.contains(extSource)) authorizedToExtSource = true;\n-\t\t\t\t}\n-\n-\t\t\t\tif (!groupAdminOfAllGroups || !authorizedToExtSource) {\n-\t\t\t\t\tthrow new PrivilegeException(sess, \"createMember - from login and extSource -- authorized to extSource=\" + authorizedToExtSource + \" and groupAdmin in all groups=\" + groupAdminOfAllGroups);\n+\t\t\t\tSet<ExtSource> groupExtSources = new HashSet<>();\n+\t\t\t\tgroups.forEach(group -> groupExtSources.addAll(getPerunBl().getExtSourcesManagerBl().getGroupExtSources(sess, group)));\n+\t\t\t\tif (!groupExtSources.contains(extSource) ||\n+\t\t\t\t\t!AuthzResolver.authorizedInternal(sess, \"createMember_Vo_ExtSource_String_List<Group>_policy\", new ArrayList<>(groups))) {\n+\t\t\t\t\tthrow new PrivilegeException(sess, \"createMember - from login and extSource\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM5MjUxOA=="}, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 260}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NDc1NjkxOnYy", "diffSide": "RIGHT", "path": "perun-base/src/test/resources/perun-roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNTowNDozN1rOF4JPxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDo1MTo0M1rOG2rHZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQxNjA3MA==", "bodyText": "This rule is weird.", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r394416070", "createdAt": "2020-03-18T15:04:37Z", "author": {"login": "stavamichal"}, "path": "perun-base/src/test/resources/perun-roles.yml", "diffHunk": "@@ -167,4 +167,559 @@ perun_policies:\n       - PERUNOBSERVER:\n     include_policies:\n       - test_resource_admin\n+\n+  #MembersManagerEntry\n+  deleteMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteMembers_List<Member>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteAllMembers_Vo_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSpecificMember_Vo_Candidate_List<User>_SpecificUserType_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_int_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_User_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_ExtSource_String_List<Group>_policy:\n+    policy_roles:\n+      - Group: Group\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByUserExtSource_Vo_UserExtSource_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberById_int_policy:\n+    policy_roles:\n+      - RPC:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByUser_Vo_User_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersByUser_User_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  getMembers_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembers_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMemberById_int_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMemberWithAttributes_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_List<AttributeDefinition>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_List<String>_Group_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributesByNames_Vo_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Vo_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Vo_List<String>_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_List<String>_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_Resource_List<String>_List<String>_policy:\n+    policy_roles:\n+      - ENGINE:\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_List<String>_List<String>_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Vo_List<String>_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Vo_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - FACILITYADMIN:\n+      - GROUPADMIN:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER:\n+      - VOADMIN:\n+    include_policies:\n+      - default_policy\n+\n+  filter-findCompleteRichMembers_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - FACILITYADMIN: Facility\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+\n+  findCompleteRichMembers_Group_List<String>_String_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Group_List<String>_List<String>_String_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributesByNames_Group_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Group_List<AttributeDefinition>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Group_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersCount_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersCount_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findMembersByName_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersByNameInVo_Vo_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInVo_Vo_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInParentGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInParentGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersInVo_Vo_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInVo_Vo_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  setStatus_Member_Status_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  setStatus_Member_Status_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  suspendMemberTo_Member_Date_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  unsuspendMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  validateMemberAsync_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  extendMembership_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canExtendMembership_Member_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - SELF: User\n+      - VOADMIN: Vo\n+      - VOOBSERVER: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canExtendMembershipWithReason_Member_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - SELF: User\n+      - VOADMIN: Vo\n+      - VOOBSERVER: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canBeMember_Vo_User_String_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canBeMemberWithReason_Vo_User_String_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByExtSourceNameAndExtLogin_Vo_String_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  sendPasswordResetLinkEmail_Member_String_String_String_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSponsoredMember_Vo_String_Map<String_String>_String_User_policy:\n+    policy_roles:\n+      - VOADMIN: Registrar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 512}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MjY5Mw==", "bodyText": "Fixed", "url": "https://github.com/CESNET/perun/pull/2624#discussion_r459982693", "createdAt": "2020-07-24T10:51:43Z", "author": {"login": "balcirakpeter"}, "path": "perun-base/src/test/resources/perun-roles.yml", "diffHunk": "@@ -167,4 +167,559 @@ perun_policies:\n       - PERUNOBSERVER:\n     include_policies:\n       - test_resource_admin\n+\n+  #MembersManagerEntry\n+  deleteMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteMembers_List<Member>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  deleteAllMembers_Vo_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSpecificMember_Vo_Candidate_List<User>_SpecificUserType_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_String_String_int_String_Candidate_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_User_List<Group>_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createMember_Vo_ExtSource_String_List<Group>_policy:\n+    policy_roles:\n+      - Group: Group\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByUserExtSource_Vo_UserExtSource_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberById_int_policy:\n+    policy_roles:\n+      - RPC:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByUser_Vo_User_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersByUser_User_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  getMembers_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembers_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMemberById_int_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMemberWithAttributes_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_List<AttributeDefinition>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_List<String>_Group_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributesByNames_Vo_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Vo_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Vo_List<String>_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_List<String>_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_Resource_List<String>_List<String>_policy:\n+    policy_roles:\n+      - ENGINE:\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  getCompleteRichMembers_Group_List<String>_List<String>_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Vo_List<String>_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Vo_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - FACILITYADMIN:\n+      - GROUPADMIN:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER:\n+      - VOADMIN:\n+    include_policies:\n+      - default_policy\n+\n+  filter-findCompleteRichMembers_List<String>_List<String>_String_policy:\n+    policy_roles:\n+      - FACILITYADMIN: Facility\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+\n+  findCompleteRichMembers_Group_List<String>_String_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findCompleteRichMembers_Group_List<String>_List<String>_String_boolean_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributesByNames_Group_List<String>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Group_List<AttributeDefinition>_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Group_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembers_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getRichMembersWithAttributes_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersCount_Vo_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMembersCount_Vo_Status_policy:\n+    policy_roles:\n+      - GROUPADMIN: Vo\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findMembersByName_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersByNameInVo_Vo_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInVo_Vo_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+      - PERUNOBSERVER:\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findMembersInParentGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInParentGroup_Group_String_policy:\n+    policy_roles:\n+      - GROUPADMIN: Group\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersInVo_Vo_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  findRichMembersWithAttributesInVo_Vo_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  setStatus_Member_Status_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  setStatus_Member_Status_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  suspendMemberTo_Member_Date_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  unsuspendMember_Member_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  validateMemberAsync_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  extendMembership_Member_policy:\n+    policy_roles:\n+      - SELF: User\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canExtendMembership_Member_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - SELF: User\n+      - VOADMIN: Vo\n+      - VOOBSERVER: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canExtendMembershipWithReason_Member_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - SELF: User\n+      - VOADMIN: Vo\n+      - VOOBSERVER: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canBeMember_Vo_User_String_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  canBeMemberWithReason_Vo_User_String_policy:\n+    policy_roles:\n+      - SELF: User\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  getMemberByExtSourceNameAndExtLogin_Vo_String_String_policy:\n+    policy_roles:\n+      - PERUNOBSERVER:\n+      - VOOBSERVER: Vo\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  sendPasswordResetLinkEmail_Member_String_String_String_String_policy:\n+    policy_roles:\n+      - VOADMIN: Vo\n+    include_policies:\n+      - default_policy\n+\n+  createSponsoredMember_Vo_String_Map<String_String>_String_User_policy:\n+    policy_roles:\n+      - VOADMIN: Registrar", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQxNjA3MA=="}, "originalCommit": {"oid": "e4096640debc0b392a3c0ecfd110cd0681ff036f"}, "originalPosition": 512}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1974, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}