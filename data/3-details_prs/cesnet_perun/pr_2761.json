{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTk4Mjc1", "number": 2761, "title": "Group structure sync - additional attributes", "bodyText": "Implemented loading of additional attributes data returned from the\nquery.\nNow, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\nLoaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql.", "createdAt": "2020-06-24T13:12:29Z", "url": "https://github.com/CESNET/perun/pull/2761", "merged": true, "mergeCommit": {"oid": "f496801cf2145eba1c81bf302f5584d47a0301b6"}, "closed": true, "closedAt": "2020-06-25T11:41:06Z", "author": {"login": "Vojtech-Sassmann"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuag8lgFqTQzNjY1NzY2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcusB7wABqjM0ODE3MjcyMTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NjU3NjYy", "url": "https://github.com/CESNET/perun/pull/2761#pullrequestreview-436657662", "createdAt": "2020-06-24T13:41:38Z", "commit": {"oid": "d0def6685ac94ac9b6da9bf8807533bc71a5475c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMzo0MTozOFrOGoSqOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMzo0MTozOFrOGoSqOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDkwMTk0NA==", "bodyText": "You probably want to change name of this variable. It is a little confusing now.", "url": "https://github.com/CESNET/perun/pull/2761#discussion_r444901944", "createdAt": "2020-06-24T13:41:38Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/test/java/cz/metacentrum/perun/core/entry/GroupStructureSynchronizationIntegrationTest.java", "diffHunk": "@@ -447,6 +454,104 @@ public void removeAllGroupsTest() throws Exception {\n \t\tassertTrue(\"List of sub groups of base group should be empty!\", subGroups.isEmpty());\n \t}\n \n+\t@Test\n+\tpublic void additionalStringAttributeIsSet() throws Exception {\n+        System.out.println(CLASS_NAME + \"additionalStringAttributeIsSet\");\n+\n+\t\tAttributeDefinition loginAttrDef = setGroupAttribute(ADDITIONAL_STRING);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0def6685ac94ac9b6da9bf8807533bc71a5475c"}, "originalPosition": 37}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0def6685ac94ac9b6da9bf8807533bc71a5475c", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/d0def6685ac94ac9b6da9bf8807533bc71a5475c", "committedDate": "2020-06-24T13:10:25Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}, "afterCommit": {"oid": "a010e260ed0ab6602f1636b3018d462770975840", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/a010e260ed0ab6602f1636b3018d462770975840", "committedDate": "2020-06-24T14:21:39Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3Mjk0MDc4", "url": "https://github.com/CESNET/perun/pull/2761#pullrequestreview-437294078", "createdAt": "2020-06-25T08:50:30Z", "commit": {"oid": "a010e260ed0ab6602f1636b3018d462770975840"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1MDozMFrOGoxbRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1MDozMFrOGoxbRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQwNjAyMg==", "bodyText": "I would prefer to return the new resulting Map instead of just changing the input one.", "url": "https://github.com/CESNET/perun/pull/2761#discussion_r445406022", "createdAt": "2020-06-25T08:50:30Z", "author": {"login": "balcirakpeter"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ExtSourceSql.java", "diffHunk": "@@ -358,6 +323,94 @@ public void close() {\n \t\t}\n \t}\n \n+\t/**\n+\t * Decodes a full attribute name from the given value. For used mappings,\n+\t * see attributeNameMapping.\n+\t *\n+\t * @param value which will be mapped\n+\t * @return attribute full name\n+\t */\n+\tprivate String mapAttributeNames(String value) {\n+\t\tString[] attributeRaw = value.split(\":\", 3);\n+\t\tString attributeName = null;\n+\t\tif (!attributeNameMapping.containsKey(attributeRaw[0])) {\n+\t\t\tlog.warn(\"Unknown attribute type '{}', attributeRaw {}\", attributeRaw[0], attributeRaw);\n+\t\t} else if (!attributeNameMapping.containsKey(attributeRaw[1])) {\n+\t\t\tlog.warn(\"Unknown attribute type '{}', attributeRaw {}\", attributeRaw[1], attributeRaw);\n+\t\t} else {\n+\t\t\tattributeName = attributeNameMapping.get(attributeRaw[0]) + attributeNameMapping.get(attributeRaw[1]) +\n+\t\t\t\t\tattributeRaw[2];\n+\t\t}\n+\t\treturn attributeName;\n+\t}\n+\n+\t/**\n+\t * Add additional data from the given result set to the given map.\n+\t *\n+\t * @param map map with attributeName-value entries\n+\t * @param rs result set with attribute data\n+\t * @throws SQLException SQLException\n+\t */\n+\tprivate void addAdditionalAttributeData(Map<String, String> map, ResultSet rs) throws SQLException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a010e260ed0ab6602f1636b3018d462770975840"}, "originalPosition": 114}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a010e260ed0ab6602f1636b3018d462770975840", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/a010e260ed0ab6602f1636b3018d462770975840", "committedDate": "2020-06-24T14:21:39Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}, "afterCommit": {"oid": "5c3c52de1e3b6667e03664eef5f0babedd9499b6", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/5c3c52de1e3b6667e03664eef5f0babedd9499b6", "committedDate": "2020-06-25T10:22:58Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a0bf75141979af682f2e3250f698ecd962516d0", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/6a0bf75141979af682f2e3250f698ecd962516d0", "committedDate": "2020-06-25T10:24:23Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c3c52de1e3b6667e03664eef5f0babedd9499b6", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/5c3c52de1e3b6667e03664eef5f0babedd9499b6", "committedDate": "2020-06-25T10:22:58Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}, "afterCommit": {"oid": "6a0bf75141979af682f2e3250f698ecd962516d0", "author": {"user": {"login": "Vojtech-Sassmann", "name": "Vojt\u011bch Sassmann"}}, "url": "https://github.com/CESNET/perun/commit/6a0bf75141979af682f2e3250f698ecd962516d0", "committedDate": "2020-06-25T10:24:23Z", "message": "Group structure sync - additional attributes\n\n* Implemented loading of additional attributes data returned from the\nquery.\n* Now, from the extsource, it is possible to load additional attribute\ndata, if the columns have a correct name.\n* Loaded data will be set as group def attributes, other attributes\ncannot be set right now, although it is possible to load them from the\nextSourceSql."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1220, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}