{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NTE1NzI0", "number": 2675, "title": "CORE: Fix allowed resource recognition, assignGroup optimization", "bodyText": "Set group and group_resource required attributes together.\nWe now set required attributes only to the valid, expired\nand suspended group members (same as assign service does).\nOptimized isTrulyRequired(user,facility), now we resolve\nallowed resources and check required attributes on them.\nFor true it previously double checked allowed facilities,\nassigned and allowed resources.\nFixed getAllowedResources(facility,user) which previously returned\nalso resources, where member was disabled.\nFixed getAllowedResources(member) which previously returned\nalso resources, where member was disabled.", "createdAt": "2020-04-24T12:15:25Z", "url": "https://github.com/CESNET/perun/pull/2675", "merged": true, "mergeCommit": {"oid": "a9bd6b9818cbee83fcc2df8ad2eaa3daa49888b1"}, "closed": true, "closedAt": "2020-05-06T13:03:49Z", "author": {"login": "zlamalp"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcawbqJAH2gAyNDA4NTE1NzI0OjNmNDA2M2FkZDVjODkwNjg2N2IzNTk2YjEwYmZlY2YyOWM4YmJiNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcek4RBgFqTQwNjQyNDg4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3f4063add5c8906867b3596b10bfecf29c8bbb63", "author": {"user": {"login": "zlamalp", "name": "Pavel Zl\u00e1mal"}}, "url": "https://github.com/CESNET/perun/commit/3f4063add5c8906867b3596b10bfecf29c8bbb63", "committedDate": "2020-04-24T12:13:46Z", "message": "CORE: Fixed wrong member status in getAllowedResources(facility,user)\n\n- If user is disabled, we shouldn't return such resources as allowed.\n  Previously it returned also disabled members, since only invalid\n  status was excluded."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0191dbef3a96fa8f16e04a148063ee6ad94347f1", "author": {"user": {"login": "zlamalp", "name": "Pavel Zl\u00e1mal"}}, "url": "https://github.com/CESNET/perun/commit/0191dbef3a96fa8f16e04a148063ee6ad94347f1", "committedDate": "2020-04-24T13:30:39Z", "message": "CORE: Throw exception if module for virt attribute doesn't exists\n\n- We silently returned null instead of ModuleNotExistsException for\n  following attribute types: member_group, member_resource, group_resource.\n  Now implementation is aligned for all attribute types."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db9fcc893fcbe2243ef889a5c499933fbf26e803", "author": {"user": {"login": "zlamalp", "name": "Pavel Zl\u00e1mal"}}, "url": "https://github.com/CESNET/perun/commit/db9fcc893fcbe2243ef889a5c499933fbf26e803", "committedDate": "2020-04-24T13:36:46Z", "message": "CORE: Optimized performance in group assigning\n\n- Set group and group_resource required attributes together.\n- We now set required attributes only to the valid, expired\n  and suspended group members (same as assign service does).\n- Optimized isTrulyRequired(user,facility), now we resolve\n  allowed resources and check required attributes on them.\n  For true it previously double checked allowed facilities,\n  assigned and allowed resources.\n- Fixed getAllowedResources(member) which previously returned\n  also resources, where member was disabled. Now its aligned\n  with recently fixed getAllowedResources(user,facility)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODg4MzQy", "url": "https://github.com/CESNET/perun/pull/2675#pullrequestreview-404888342", "createdAt": "2020-05-04T11:02:36Z", "commit": {"oid": "db9fcc893fcbe2243ef889a5c499933fbf26e803"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMTowMjozNlrOGP7msA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMTowMjozNlrOGP7msA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTM1ODM4NA==", "bodyText": "I just would like to ask, why is this change made only to these three methods and not to all of them? This way, the module accessing methods behave differently for different combinations of entities.", "url": "https://github.com/CESNET/perun/pull/2675#discussion_r419358384", "createdAt": "2020-05-04T11:02:36Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/AttributesManagerImpl.java", "diffHunk": "@@ -5097,7 +5097,8 @@ private UserExtSourceAttributesModuleImplApi getUserExtSourceAttributeModule(Per\n \t */\n \tGroupResourceVirtualAttributesModuleImplApi getResourceGroupVirtualAttributeModule(PerunSession sess, AttributeDefinition attribute) throws InternalErrorException {\n \t\tObject attributeModule = getAttributesModule(sess, attribute);\n-\t\tif (attributeModule == null) return null;\n+\t\tif (attributeModule == null)\n+\t\t\tthrow new ModuleNotExistsException(\"Virtual attribute module for \" + attribute + \" doesn't exists.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db9fcc893fcbe2243ef889a5c499933fbf26e803"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDI0ODg0", "url": "https://github.com/CESNET/perun/pull/2675#pullrequestreview-406424884", "createdAt": "2020-05-06T09:01:51Z", "commit": {"oid": "db9fcc893fcbe2243ef889a5c499933fbf26e803"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1347, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}