{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4OTI0NTY2", "number": 2942, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMzoyNTozM1rOEx5hZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1NzoyM1rOEySqIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNzU4MTE3OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMzoyNTozM1rOHoPVAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNjoyMDozMVrOHoXgrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NjIyNw==", "bodyText": "These are all members on the facility, right?", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r511956227", "createdAt": "2020-10-26T13:25:33Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "diffHunk": "@@ -380,30 +380,24 @@\n \t *\n \t * attributes: {...hashes...}\n \t * hierarchy: {\n-\t *    ** facility **\n-\t *    hashes: [...hashes...]\n-\t *    members: []\n-\t *    children: [\n-\t *      {\n-\t *        ** resource1 **\n-\t *        hashes: [...hashes...]\n-\t *        children: []\n-\t *        members: [\n-\t *          {\n-\t *            ** member 1 **\n-\t *            hashes: [...hashes...]\n-\t *          },\n-\t *          {\n-\t *            ** member 2 **\n-\t *            ...\n-\t *          }\n-\t *        ]\n-\t *      },\n-\t *      {\n-\t *        ** resource2 **\n-\t *        ...\n-\t *      }\n-\t *    ]\n+\t *   \"1\": {    ** facility id **\n+\t *     members: {    ** all members on resource **", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1aa797ba99b4e7e7105f4ccfa71c8a6a8d1cfb1b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1Njg4NA==", "bodyText": "The same for all other places where this Javadoc is used.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r511956884", "createdAt": "2020-10-26T13:26:35Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "diffHunk": "@@ -380,30 +380,24 @@\n \t *\n \t * attributes: {...hashes...}\n \t * hierarchy: {\n-\t *    ** facility **\n-\t *    hashes: [...hashes...]\n-\t *    members: []\n-\t *    children: [\n-\t *      {\n-\t *        ** resource1 **\n-\t *        hashes: [...hashes...]\n-\t *        children: []\n-\t *        members: [\n-\t *          {\n-\t *            ** member 1 **\n-\t *            hashes: [...hashes...]\n-\t *          },\n-\t *          {\n-\t *            ** member 2 **\n-\t *            ...\n-\t *          }\n-\t *        ]\n-\t *      },\n-\t *      {\n-\t *        ** resource2 **\n-\t *        ...\n-\t *      }\n-\t *    ]\n+\t *   \"1\": {    ** facility id **\n+\t *     members: {    ** all members on resource **", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NjIyNw=="}, "originalCommit": {"oid": "1aa797ba99b4e7e7105f4ccfa71c8a6a8d1cfb1b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjA5MDI4NQ==", "bodyText": "Yes, I have updated the javadocs.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512090285", "createdAt": "2020-10-26T16:20:31Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "diffHunk": "@@ -380,30 +380,24 @@\n \t *\n \t * attributes: {...hashes...}\n \t * hierarchy: {\n-\t *    ** facility **\n-\t *    hashes: [...hashes...]\n-\t *    members: []\n-\t *    children: [\n-\t *      {\n-\t *        ** resource1 **\n-\t *        hashes: [...hashes...]\n-\t *        children: []\n-\t *        members: [\n-\t *          {\n-\t *            ** member 1 **\n-\t *            hashes: [...hashes...]\n-\t *          },\n-\t *          {\n-\t *            ** member 2 **\n-\t *            ...\n-\t *          }\n-\t *        ]\n-\t *      },\n-\t *      {\n-\t *        ** resource2 **\n-\t *        ...\n-\t *      }\n-\t *    ]\n+\t *   \"1\": {    ** facility id **\n+\t *     members: {    ** all members on resource **", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NjIyNw=="}, "originalCommit": {"oid": "1aa797ba99b4e7e7105f4ccfa71c8a6a8d1cfb1b"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNzU4Mjg2OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMzoyNTo1OFrOHoPWDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNjoyMDo0NVrOHoXhVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NjQ5NQ==", "bodyText": "These should be all members on the resource 2.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r511956495", "createdAt": "2020-10-26T13:25:58Z", "author": {"login": "stavamichal"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "diffHunk": "@@ -380,30 +380,24 @@\n \t *\n \t * attributes: {...hashes...}\n \t * hierarchy: {\n-\t *    ** facility **\n-\t *    hashes: [...hashes...]\n-\t *    members: []\n-\t *    children: [\n-\t *      {\n-\t *        ** resource1 **\n-\t *        hashes: [...hashes...]\n-\t *        children: []\n-\t *        members: [\n-\t *          {\n-\t *            ** member 1 **\n-\t *            hashes: [...hashes...]\n-\t *          },\n-\t *          {\n-\t *            ** member 2 **\n-\t *            ...\n-\t *          }\n-\t *        ]\n-\t *      },\n-\t *      {\n-\t *        ** resource2 **\n-\t *        ...\n-\t *      }\n-\t *    ]\n+\t *   \"1\": {    ** facility id **\n+\t *     members: {    ** all members on resource **\n+\t *        \"4\" : 5,    ** member id : user id **\n+\t *        \"6\" : 7,    ** member id : user id **\n+\t *       ...\n+\t *     }\n+\t *     children: [\n+\t *       \"2\": {    ** resource id **\n+\t *         children: []\n+\t *         members: {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1aa797ba99b4e7e7105f4ccfa71c8a6a8d1cfb1b"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjA5MDQ1NQ==", "bodyText": "I have added a comment in the javadocs.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512090455", "createdAt": "2020-10-26T16:20:45Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/api/ServicesManager.java", "diffHunk": "@@ -380,30 +380,24 @@\n \t *\n \t * attributes: {...hashes...}\n \t * hierarchy: {\n-\t *    ** facility **\n-\t *    hashes: [...hashes...]\n-\t *    members: []\n-\t *    children: [\n-\t *      {\n-\t *        ** resource1 **\n-\t *        hashes: [...hashes...]\n-\t *        children: []\n-\t *        members: [\n-\t *          {\n-\t *            ** member 1 **\n-\t *            hashes: [...hashes...]\n-\t *          },\n-\t *          {\n-\t *            ** member 2 **\n-\t *            ...\n-\t *          }\n-\t *        ]\n-\t *      },\n-\t *      {\n-\t *        ** resource2 **\n-\t *        ...\n-\t *      }\n-\t *    ]\n+\t *   \"1\": {    ** facility id **\n+\t *     members: {    ** all members on resource **\n+\t *        \"4\" : 5,    ** member id : user id **\n+\t *        \"6\" : 7,    ** member id : user id **\n+\t *       ...\n+\t *     }\n+\t *     children: [\n+\t *       \"2\": {    ** resource id **\n+\t *         children: []\n+\t *         members: {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NjQ5NQ=="}, "originalCommit": {"oid": "1aa797ba99b4e7e7105f4ccfa71c8a6a8d1cfb1b"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY2MTg2OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1MDowNlrOHo14fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozODozOFrOHrHgjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4NzkwMA==", "bodyText": "Shouldn't hashes: [...hashes...] be removed also from this class javadoc? It was removed from services manager methods API docs.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512587900", "createdAt": "2020-10-27T10:50:06Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -54,6 +56,7 @@\n \tprivate final Service service;\n \tprivate final Facility facility;\n \tprivate final GenDataProvider dataProvider;\n+\tprivate final Set<Member> allMembers = new HashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3MzgzOA==", "bodyText": "Yes, I have removed it.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514973838", "createdAt": "2020-10-30T09:38:38Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -54,6 +56,7 @@\n \tprivate final Service service;\n \tprivate final Facility facility;\n \tprivate final GenDataProvider dataProvider;\n+\tprivate final Set<Member> allMembers = new HashSet<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4NzkwMA=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY3NzgyOnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1MzowMVrOHo2BmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozODo1MVrOHrHg_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDIzMw==", "bodyText": "Shouldn't hashes: [...hashes...] be removed also from this class javadoc? It was removed from services manager methods API docs.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512590233", "createdAt": "2020-10-27T10:53:01Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -68,6 +68,7 @@\n \tprivate final Facility facility;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3Mzk1MQ==", "bodyText": "Yes, I have removed it.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514973951", "createdAt": "2020-10-30T09:38:51Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -68,6 +68,7 @@\n \tprivate final Facility facility;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDIzMw=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY4Nzc5OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1NTowN1rOHo2Hdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozOTowM1rOHrHhag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MTczNA==", "bodyText": "Variable resourceAttrHashes is not used.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512591734", "createdAt": "2020-10-27T10:55:07Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -94,18 +99,19 @@ private GenDataNode getDataForResource(Resource resource) {\n \t\t} else {\n \t\t\tmembers = sess.getPerunBl().getResourcesManagerBl().getAllowedMembers(sess, resource);\n \t\t}\n+\t\tallMembers.addAll(members);\n \n \t\tdataProvider.loadResourceAttributes(resource, members, false);\n \n \t\tList<String> resourceAttrHashes = dataProvider.getResourceAttributesHashes(resource, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3NDA1OA==", "bodyText": "Variable removed.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514974058", "createdAt": "2020-10-30T09:39:03Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -94,18 +99,19 @@ private GenDataNode getDataForResource(Resource resource) {\n \t\t} else {\n \t\t\tmembers = sess.getPerunBl().getResourcesManagerBl().getAllowedMembers(sess, resource);\n \t\t}\n+\t\tallMembers.addAll(members);\n \n \t\tdataProvider.loadResourceAttributes(resource, members, false);\n \n \t\tList<String> resourceAttrHashes = dataProvider.getResourceAttributesHashes(resource, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MTczNA=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY5MTM5OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1NTo1MVrOHo2Jjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozOTowOFrOHrHhhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MjI3MQ==", "bodyText": "facilityAttrHashes is not used anywhere.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512592271", "createdAt": "2020-10-27T10:55:51Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -72,19 +75,21 @@ public HashedGenData generateData() {\n \t\tList<Resource> resources =\n \t\t\t\tsess.getPerunBl().getFacilitiesManagerBl().getAssignedResources(sess, facility, null, service);\n \n-\t\tList<GenDataNode> childNodes = resources.stream()\n-\t\t\t\t.map(this::getDataForResource)\n-\t\t\t\t.collect(Collectors.toList());\n+\t\tMap<Integer, GenDataNode> childNodes = resources.stream()\n+\t\t\t\t.collect(toMap(Resource::getId, this::getDataForResource));\n \n \t\tList<String> facilityAttrHashes = dataProvider.getFacilityAttributesHashes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3NDA4Nw==", "bodyText": "Variable removed.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514974087", "createdAt": "2020-10-30T09:39:08Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/HierarchicalHashedDataGenerator.java", "diffHunk": "@@ -72,19 +75,21 @@ public HashedGenData generateData() {\n \t\tList<Resource> resources =\n \t\t\t\tsess.getPerunBl().getFacilitiesManagerBl().getAssignedResources(sess, facility, null, service);\n \n-\t\tList<GenDataNode> childNodes = resources.stream()\n-\t\t\t\t.map(this::getDataForResource)\n-\t\t\t\t.collect(Collectors.toList());\n+\t\tMap<Integer, GenDataNode> childNodes = resources.stream()\n+\t\t\t\t.collect(toMap(Resource::getId, this::getDataForResource));\n \n \t\tList<String> facilityAttrHashes = dataProvider.getFacilityAttributesHashes();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MjI3MQ=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY5ODEyOnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1NzoxMFrOHo2NhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozOToxMlrOHrHhvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MzI4NA==", "bodyText": "resourceAttrHashes is not used.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512593284", "createdAt": "2020-10-27T10:57:10Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -106,26 +109,27 @@ private GenDataNode getDataForResource(Resource resource) {\n \t\t} else {\n \t\t\tmembers = sess.getPerunBl().getResourcesManagerBl().getAllowedMembers(sess, resource);\n \t\t}\n+\t\tallMembers.addAll(members);\n \n \t\tdataProvider.loadResourceAttributes(resource, members, true);\n \n \t\tList<String> resourceAttrHashes = dataProvider.getResourceAttributesHashes(resource, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3NDE0MA==", "bodyText": "Variable removed.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514974140", "createdAt": "2020-10-30T09:39:12Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -106,26 +109,27 @@ private GenDataNode getDataForResource(Resource resource) {\n \t\t} else {\n \t\t\tmembers = sess.getPerunBl().getResourcesManagerBl().getAllowedMembers(sess, resource);\n \t\t}\n+\t\tallMembers.addAll(members);\n \n \t\tdataProvider.loadResourceAttributes(resource, members, true);\n \n \t\tList<String> resourceAttrHashes = dataProvider.getResourceAttributesHashes(resource, true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MzI4NA=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY5OTU1OnYy", "diffSide": "RIGHT", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1NzoyM1rOHo2OSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTozOToxOFrOHrHh9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MzQ4MQ==", "bodyText": "facilityAttrHashes is not used.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r512593481", "createdAt": "2020-10-27T10:57:23Z", "author": {"login": "zlamalp"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -84,19 +85,21 @@ public HashedGenData generateData() {\n \n \t\tList<Resource> resources = sess.getPerunBl().getFacilitiesManagerBl().getAssignedResources(sess, facility, null, service);\n \n-\t\tList<GenDataNode> childNodes = resources.stream()\n-\t\t\t\t.map(this::getDataForResource)\n-\t\t\t\t.collect(Collectors.toList());\n+\t\tMap<Integer, GenDataNode> childNodes = resources.stream()\n+\t\t\t\t.collect(toMap(Resource::getId, this::getDataForResource));\n \n \t\tList<String> facilityAttrHashes = dataProvider.getFacilityAttributesHashes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk3NDE5Ng==", "bodyText": "Variable removed.", "url": "https://github.com/CESNET/perun/pull/2942#discussion_r514974196", "createdAt": "2020-10-30T09:39:18Z", "author": {"login": "Vojtech-Sassmann"}, "path": "perun-core/src/main/java/cz/metacentrum/perun/core/provisioning/GroupsHashedDataGenerator.java", "diffHunk": "@@ -84,19 +85,21 @@ public HashedGenData generateData() {\n \n \t\tList<Resource> resources = sess.getPerunBl().getFacilitiesManagerBl().getAssignedResources(sess, facility, null, service);\n \n-\t\tList<GenDataNode> childNodes = resources.stream()\n-\t\t\t\t.map(this::getDataForResource)\n-\t\t\t\t.collect(Collectors.toList());\n+\t\tMap<Integer, GenDataNode> childNodes = resources.stream()\n+\t\t\t\t.collect(toMap(Resource::getId, this::getDataForResource));\n \n \t\tList<String> facilityAttrHashes = dataProvider.getFacilityAttributesHashes();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MzQ4MQ=="}, "originalCommit": {"oid": "0c282819932fece1a9b52603b124f9ba4edd83e2"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2344, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}