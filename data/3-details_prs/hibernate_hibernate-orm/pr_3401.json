{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NTgxODAz", "number": 3401, "title": "Required for Hibernate Reactive for queries support", "bodyText": "I haven't created the JIRAs yet, but could you let me know if these changes are viable first? Thanks", "createdAt": "2020-05-15T13:06:26Z", "url": "https://github.com/hibernate/hibernate-orm/pull/3401", "merged": true, "mergeCommit": {"oid": "92b559abda4a0899a2e7cebfd7589037a992d4aa"}, "closed": true, "closedAt": "2020-05-18T11:47:37Z", "author": {"login": "DavideD"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchjo3nABqjMzNDEzNjMwMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcieG26gBqjMzNDY4NDEyMzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "6a798f7ec5b5eefb4fa7f0e7795427c238eb761e", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/6a798f7ec5b5eefb4fa7f0e7795427c238eb761e", "committedDate": "2020-05-15T15:16:34Z", "message": "Change scope of various private methods to protected\n\n  So that Hibernate Reactive can reuse them."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDkzNjQ4", "url": "https://github.com/hibernate/hibernate-orm/pull/3401#pullrequestreview-413093648", "createdAt": "2020-05-16T17:22:23Z", "commit": {"oid": "6a798f7ec5b5eefb4fa7f0e7795427c238eb761e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxNzoyMjoyM1rOGWbhjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxNzoyMjoyM1rOGWbhjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE3MjgxMw==", "bodyText": "@DavideD I'm not a big fan of this. I think it might be better to add a getQueryPlanCache() accessor to SessionFactoryImpl and override it on the subclass.", "url": "https://github.com/hibernate/hibernate-orm/pull/3401#discussion_r426172813", "createdAt": "2020-05-16T17:22:23Z", "author": {"login": "gavinking"}, "path": "hibernate-core/src/main/java/org/hibernate/internal/SessionFactoryImpl.java", "diffHunk": "@@ -260,7 +265,7 @@ public SessionFactoryImpl(\n \t\tLOG.debugf( \"Session factory constructed with filter configurations : %s\", filters );\n \t\tLOG.debugf( \"Instantiating session factory with properties: %s\", properties );\n \n-\t\tthis.queryPlanCache = new QueryPlanCache( this );\n+\t\tthis.queryPlanCache = queryPlanCacheFunction.apply( this );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a798f7ec5b5eefb4fa7f0e7795427c238eb761e"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTA3NjI4", "url": "https://github.com/hibernate/hibernate-orm/pull/3401#pullrequestreview-413107628", "createdAt": "2020-05-16T20:49:12Z", "commit": {"oid": "4ff1e1891e67f3294007727d4c8561d7f5f2b3bb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMDo0OToxMlrOGWckxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMDo0OToxMlrOGWckxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE5MDAyMQ==", "bodyText": "Are you guys really using inheritance everywhere?  You really want to subclass all of these?  Why not just pass in functionals that can create the plan?  Then your SessionFactory (I assume you already subclass SessionFactory, Session, etc) can simply pass in a different one.\nI mean, feel free to keep subclassing everything, but personally I'd be trying to minimize what I need to subclass", "url": "https://github.com/hibernate/hibernate-orm/pull/3401#discussion_r426190021", "createdAt": "2020-05-16T20:49:12Z", "author": {"login": "sebersole"}, "path": "hibernate-core/src/main/java/org/hibernate/engine/query/spi/QueryPlanCache.java", "diffHunk": "@@ -152,7 +153,7 @@ public HQLQueryPlan getHQLQueryPlan(String queryString, boolean shallow, Map<Str\n \t\t\tfinal long startTime = ( stats ) ? System.nanoTime() : 0L;\n \n \t\t\tLOG.tracev( \"Unable to locate HQL query plan in cache; generating ({0})\", queryString );\n-\t\t\tvalue = new HQLQueryPlan( queryString, shallow, enabledFilters, factory );\n+\t\t\tvalue = createHQLQueryPlan( queryString, shallow, enabledFilters, factory );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff1e1891e67f3294007727d4c8561d7f5f2b3bb"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a65706aaef9ccc1a5b934d1cdccd69b7baeed58e", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/a65706aaef9ccc1a5b934d1cdccd69b7baeed58e", "committedDate": "2020-05-18T11:09:55Z", "message": "HHH-14024 Allow the creation of a different QueryPlan"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eccdeebc29c2d0d9103d20f72af9fdba6d6084bf", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/eccdeebc29c2d0d9103d20f72af9fdba6d6084bf", "committedDate": "2020-05-18T11:20:29Z", "message": "HHH-14027 Allow the creation of a different QueryLoader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54cdf9ea9fedaa9b56778e95df03795d9d8aac0f", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/54cdf9ea9fedaa9b56778e95df03795d9d8aac0f", "committedDate": "2020-05-18T11:20:35Z", "message": "HHH-14024 Allow the creation of a different QueryPlanCache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d20cdc0e3437306e6362783f44bba39a5b7cc926", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/d20cdc0e3437306e6362783f44bba39a5b7cc926", "committedDate": "2020-05-18T11:21:54Z", "message": "HHH-14028 Change scope of various private methods to protected\n\n  So that Hibernate Reactive can reuse them."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12346c4fe534e53b4ad1a31dc17627949182737e", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/12346c4fe534e53b4ad1a31dc17627949182737e", "committedDate": "2020-05-18T11:22:01Z", "message": "HHH-14025 Add method to return the query statements for update queries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bde8d814550c0473c04fc67d0c134809d47c476c", "author": {"user": {"login": "DavideD", "name": "Davide D'Alto"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/bde8d814550c0473c04fc67d0c134809d47c476c", "committedDate": "2020-05-18T11:22:01Z", "message": "HHH-14026 Change scope to protected for SessionImple#verifyImmutableEntityUpdate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efde101ed0266359b588031074f3af301e7613b1", "author": {"user": {"login": "gavinking", "name": "Gavin King"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/efde101ed0266359b588031074f3af301e7613b1", "committedDate": "2020-05-18T11:22:01Z", "message": "HHH-14024 add QueryPlanCreator functional interface\n\nsimplifies customization of HQLQueryPlan instantiation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "efde101ed0266359b588031074f3af301e7613b1", "author": {"user": {"login": "gavinking", "name": "Gavin King"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/efde101ed0266359b588031074f3af301e7613b1", "committedDate": "2020-05-18T11:22:01Z", "message": "HHH-14024 add QueryPlanCreator functional interface\n\nsimplifies customization of HQLQueryPlan instantiation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3089, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}