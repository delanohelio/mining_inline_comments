{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMzE0OTk4", "number": 3491, "title": "HHH-14137 Empty String check performance improvements", "bodyText": "https://hibernate.atlassian.net/browse/HHH-14137", "createdAt": "2020-08-03T17:50:07Z", "url": "https://github.com/hibernate/hibernate-orm/pull/3491", "merged": true, "mergeCommit": {"oid": "0ee25a416d99c72110f23ad1efa41da83e760932"}, "closed": true, "closedAt": "2020-08-06T15:14:34Z", "author": {"login": "isadounikau"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7Ys1_gFqTQ2MDM0NTYwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8RMiSgFqTQ2MjYwNzU0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzQ1NjA3", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#pullrequestreview-460345607", "createdAt": "2020-08-03T21:14:19Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMTI1NjQ4", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#pullrequestreview-461125648", "createdAt": "2020-08-04T19:52:23Z", "commit": null, "state": "DISMISSED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOTo1MjoyM1rOG7vOew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOTo1NTowNlrOG7vTxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MjkyMw==", "bodyText": "This used to be null safe and is not anymore. I would keep the null safe behavior just to be sure.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465292923", "createdAt": "2020-08-04T19:52:23Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/cfg/Ejb3Column.java", "diffHunk": "@@ -566,7 +566,7 @@ public void forceNotNull() {\n \t\t\t\t\t}\n \n \t\t\t\t\tfinal String columnName;\n-\t\t\t\t\tif ( \"\".equals( col.name() ) ) {\n+\t\t\t\t\tif ( col.name().isEmpty() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MzAxOA==", "bodyText": "Same here.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293018", "createdAt": "2020-08-04T19:52:33Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/cfg/Ejb3JoinColumn.java", "diffHunk": "@@ -367,7 +367,7 @@ public static Ejb3JoinColumn buildJoinColumn(\n \t\t\t}\n \n \t\t\tfinal String name;\n-\t\t\tif ( \"\".equals( colName ) ) {\n+\t\t\tif ( colName.isEmpty() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MzExNg==", "bodyText": "Same here.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293116", "createdAt": "2020-08-04T19:52:46Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/cfg/annotations/CollectionBinder.java", "diffHunk": "@@ -1458,7 +1458,7 @@ else if ( anyAnn != null ) {\n \t\t\t\t\tConstraintMode foreignKeyValue = joinTableAnn.inverseForeignKey().value();\n \t\t\t\t\tif ( joinTableAnn.inverseJoinColumns().length != 0 ) {\n \t\t\t\t\t\tfinal JoinColumn joinColumnAnn = joinTableAnn.inverseJoinColumns()[0];\n-\t\t\t\t\t\tif ( \"\".equals( foreignKeyName ) ) {\n+\t\t\t\t\t\tif ( foreignKeyName.isEmpty() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MzQzNQ==", "bodyText": "I would add parentheses here around the condition just to be safe.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293435", "createdAt": "2020-08-04T19:53:25Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/engine/internal/JoinSequence.java", "diffHunk": "@@ -334,9 +334,9 @@ else if ( needsTableGroupJoin( joins, withClauseFragment ) ) {\n \t\t\t\t\t\tjoin.getAlias(),\n \t\t\t\t\t\tenabledFilters\n \t\t\t\t);\n-\t\t\t\tcondition = \"\".equals( manyToManyFilter )\n+\t\t\t\tcondition = manyToManyFilter != null && manyToManyFilter.isEmpty()", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MzQ3NQ==", "bodyText": "Same here.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293475", "createdAt": "2020-08-04T19:53:31Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/engine/internal/JoinSequence.java", "diffHunk": "@@ -334,9 +334,9 @@ else if ( needsTableGroupJoin( joins, withClauseFragment ) ) {\n \t\t\t\t\t\tjoin.getAlias(),\n \t\t\t\t\t\tenabledFilters\n \t\t\t\t);\n-\t\t\t\tcondition = \"\".equals( manyToManyFilter )\n+\t\t\t\tcondition = manyToManyFilter != null && manyToManyFilter.isEmpty()\n \t\t\t\t\t\t? on\n-\t\t\t\t\t\t: \"\".equals( on ) ? manyToManyFilter : on + \" and \" + manyToManyFilter;\n+\t\t\t\t\t\t: on != null && on.isEmpty() ? manyToManyFilter : on + \" and \" + manyToManyFilter;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5Mzc4NQ==", "bodyText": "Not null safe anymore but I suppose it can't happen considering the line before.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293785", "createdAt": "2020-08-04T19:54:08Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/hql/internal/ast/util/SyntheticAndFactory.java", "diffHunk": "@@ -147,7 +147,7 @@ public void addDiscriminatorWhereFragment(\n \t\t\tMap enabledFilters,\n \t\t\tString alias) {\n \t\tString whereFragment = persister.filterFragment( alias, enabledFilters ).trim();\n-\t\tif ( \"\".equals( whereFragment ) ) {\n+\t\tif ( whereFragment.isEmpty() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5MzkxNw==", "bodyText": "Same here about the parenthesis.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293917", "createdAt": "2020-08-04T19:54:23Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/loader/OuterJoinableAssociation.java", "diffHunk": "@@ -193,9 +193,9 @@ public boolean isManyToManyWith(OuterJoinableAssociation other) {\n \n \tpublic void addManyToManyJoin(JoinFragment outerjoin, QueryableCollection collection) throws MappingException {\n \t\tString manyToManyFilter = collection.getManyToManyFilterFragment( rhsAlias, enabledFilters );\n-\t\tString condition = \"\".equals( manyToManyFilter )\n+\t\tString condition = manyToManyFilter != null && manyToManyFilter.isEmpty()", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5Mzk3Ng==", "bodyText": "and here too", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465293976", "createdAt": "2020-08-04T19:54:30Z", "author": {"login": "gsmet"}, "path": "hibernate-core/src/main/java/org/hibernate/loader/OuterJoinableAssociation.java", "diffHunk": "@@ -193,9 +193,9 @@ public boolean isManyToManyWith(OuterJoinableAssociation other) {\n \n \tpublic void addManyToManyJoin(JoinFragment outerjoin, QueryableCollection collection) throws MappingException {\n \t\tString manyToManyFilter = collection.getManyToManyFilterFragment( rhsAlias, enabledFilters );\n-\t\tString condition = \"\".equals( manyToManyFilter )\n+\t\tString condition = manyToManyFilter != null && manyToManyFilter.isEmpty()\n \t\t\t\t? on\n-\t\t\t\t: \"\".equals( on )\n+\t\t\t\t: on != null && on.isEmpty()", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI5NDI3Nw==", "bodyText": "Let's keep the null safe behavior here.", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#discussion_r465294277", "createdAt": "2020-08-04T19:55:06Z", "author": {"login": "gsmet"}, "path": "hibernate-envers/src/main/java/org/hibernate/envers/configuration/internal/metadata/CollectionMetadataGenerator.java", "diffHunk": "@@ -553,7 +553,7 @@ else if ( mapKeyEnumType != null ) {\n \t\t\t\tfinal IdMappingData referencedIdMapping = mainGenerator.getEntitiesConfigurations()\n \t\t\t\t\t\t.get( referencedEntityName ).getIdMappingData();\n \t\t\t\tfinal int currentIndex = queryGeneratorBuilder == null ? 0 : queryGeneratorBuilder.getCurrentIndex();\n-\t\t\t\tif ( \"\".equals( mapKey ) ) {\n+\t\t\t\tif ( mapKey.isEmpty() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "eecbfd044e7004546f77711d3df6fff006e15772", "author": {"user": null}, "url": "https://github.com/hibernate/hibernate-orm/commit/eecbfd044e7004546f77711d3df6fff006e15772", "committedDate": "2020-08-04T20:41:23Z", "message": "HHH-14137 Empty String check performance improvements"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "eecbfd044e7004546f77711d3df6fff006e15772", "author": {"user": null}, "url": "https://github.com/hibernate/hibernate-orm/commit/eecbfd044e7004546f77711d3df6fff006e15772", "committedDate": "2020-08-04T20:41:23Z", "message": "HHH-14137 Empty String check performance improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNjA3NTQw", "url": "https://github.com/hibernate/hibernate-orm/pull/3491#pullrequestreview-462607540", "createdAt": "2020-08-06T15:03:37Z", "commit": {"oid": "eecbfd044e7004546f77711d3df6fff006e15772"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2833, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}