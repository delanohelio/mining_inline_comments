{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NDUyOTMy", "number": 3255, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNTo1ODoyMlrODiF3Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QyMjoxNjozMlrODiLsSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDc0MjA2OnYy", "diffSide": "RIGHT", "path": "hibernate-core/src/test/java/org/hibernate/orm/test/metamodel/mapping/collections/SetOperationTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNTo1ODoyMlrOFtLuZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNTo1ODoyMlrOFtLuZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyMjM0MA==", "bodyText": "An example error message I encountered went like this:\nExpected: iterable containing [\"aBC\", \"bcD\", \"cDe\", \"DeF\", \"Efg\"]\n     but: item 0: was \"abc\"", "url": "https://github.com/hibernate/hibernate-orm/pull/3255#discussion_r382922340", "createdAt": "2020-02-22T15:58:22Z", "author": {"login": "NathanQingyangXu"}, "path": "hibernate-core/src/test/java/org/hibernate/orm/test/metamodel/mapping/collections/SetOperationTests.java", "diffHunk": "@@ -164,14 +168,40 @@ public void testSortedSetAccess(SessionFactoryScope scope) {\n \t\t\t\t\t// trigger the init\n \t\t\t\t\tHibernate.initialize( entity.getSortedSetOfBasics() );\n \t\t\t\t\tassertThat( entity.getSortedSetOfBasics(), InitializationCheckMatcher.isInitialized() );\n-\t\t\t\t\tassertThat( entity.getSortedSetOfBasics().size(), is( 2 ) );\n+\t\t\t\t\tassertThat( entity.getSortedSetOfBasics(), IsCollectionWithSize.hasSize( 5 ) );\n+\t\t\t\t\tassertThat( entity.getSetOfEnums(), InitializationCheckMatcher.isNotInitialized() );\n+\n+\t\t\t\t\tassertThat( entity.getSortedSetOfBasics(), IsIterableContainingInOrder.contains(\n+\t\t\t\t\t\t\t\"abc\",\n+\t\t\t\t\t\t\t\"bcd\",\n+\t\t\t\t\t\t\t\"cde\",\n+\t\t\t\t\t\t\t\"def\",\n+\t\t\t\t\t\t\t\"efg\"\n+\t\t\t\t\t) );", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDc0NDk2OnYy", "diffSide": "RIGHT", "path": "hibernate-core/src/test/java/org/hibernate/orm/test/sql/exec/onetoone/OneToOneWithDerivedIdentityTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNjowMzoyMFrOFtLvzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxODo0NDo1N1rOFz09xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyMjcwMA==", "bodyText": "A common erroneous usage of assertEquals in our codebase.", "url": "https://github.com/hibernate/hibernate-orm/pull/3255#discussion_r382922700", "createdAt": "2020-02-22T16:03:20Z", "author": {"login": "NathanQingyangXu"}, "path": "hibernate-core/src/test/java/org/hibernate/orm/test/sql/exec/onetoone/OneToOneWithDerivedIdentityTest.java", "diffHunk": "@@ -52,7 +52,7 @@ public void testGet() {\n \t\tinTransaction(\n \t\t\t\tsession -> {\n \t\t\t\t\tPerson person = session.get( Person.class, PERSON_ID );\n-\t\t\t\t\tassertEquals( person.getName(), \"Alfio\" );\n+\t\t\t\t\tassertEquals( \"Alfio\", person.getName() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg4OTQ3OA==", "bodyText": "Yes, this is once of the great things about hamcrest which we use in newer tests", "url": "https://github.com/hibernate/hibernate-orm/pull/3255#discussion_r389889478", "createdAt": "2020-03-09T18:44:57Z", "author": {"login": "sebersole"}, "path": "hibernate-core/src/test/java/org/hibernate/orm/test/sql/exec/onetoone/OneToOneWithDerivedIdentityTest.java", "diffHunk": "@@ -52,7 +52,7 @@ public void testGet() {\n \t\tinTransaction(\n \t\t\t\tsession -> {\n \t\t\t\t\tPerson person = session.get( Person.class, PERSON_ID );\n-\t\t\t\t\tassertEquals( person.getName(), \"Alfio\" );\n+\t\t\t\t\tassertEquals( \"Alfio\", person.getName() );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyMjcwMA=="}, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MTY5NzM3OnYy", "diffSide": "RIGHT", "path": "hibernate-core/src/main/java/org/hibernate/query/sqm/tree/domain/AbstractSqmFrom.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QyMjoxNjozMlrOFtTI-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QyMjoxNjozMlrOFtTI-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA0MzgzMg==", "bodyText": "So the obvious bug here is we did build join but didn't add it to 'joins' field. Simple fixing.", "url": "https://github.com/hibernate/hibernate-orm/pull/3255#discussion_r383043832", "createdAt": "2020-02-23T22:16:32Z", "author": {"login": "NathanQingyangXu"}, "path": "hibernate-core/src/main/java/org/hibernate/query/sqm/tree/domain/AbstractSqmFrom.java", "diffHunk": "@@ -409,55 +409,55 @@ public SqmMapJoin joinMap(String attributeName, JoinType jt) {\n \t\t\tSqmPathSource<A> joinedPathSource,\n \t\t\tSqmJoinType joinType,\n \t\t\tboolean fetched) {\n+\t\tfinal SqmAttributeJoin sqmJoin;\n \t\tif ( joinedPathSource instanceof SingularPersistentAttribute ) {\n-\t\t\treturn buildSingularJoin(\n+\t\t\tsqmJoin = buildSingularJoin(\n \t\t\t\t\t(SingularPersistentAttribute<T,A>) joinedPathSource,\n \t\t\t\t\tjoinType,\n \t\t\t\t\tfetched\n \t\t\t);\n \t\t}\n-\n-\t\tif ( joinedPathSource instanceof BagPersistentAttribute ) {\n-\t\t\treturn buildBagJoin(\n+\t\telse if ( joinedPathSource instanceof BagPersistentAttribute ) {\n+\t\t\tsqmJoin = buildBagJoin(\n \t\t\t\t\t(BagPersistentAttribute) joinedPathSource,\n \t\t\t\t\tjoinType,\n \t\t\t\t\tfetched\n \t\t\t);\n \t\t}\n-\n-\t\tif ( joinedPathSource instanceof ListPersistentAttribute ) {\n-\t\t\treturn buildListJoin(\n+\t\telse if ( joinedPathSource instanceof ListPersistentAttribute ) {\n+\t\t\tsqmJoin = buildListJoin(\n \t\t\t\t\t(ListPersistentAttribute) joinedPathSource,\n \t\t\t\t\tjoinType,\n \t\t\t\t\tfetched\n \t\t\t);\n \t\t}\n-\n-\t\tif ( joinedPathSource instanceof MapPersistentAttribute ) {\n-\t\t\treturn buildMapJoin(\n+\t\telse if ( joinedPathSource instanceof MapPersistentAttribute ) {\n+\t\t\tsqmJoin = buildMapJoin(\n \t\t\t\t\t(MapPersistentAttribute) joinedPathSource,\n \t\t\t\t\tjoinType,\n \t\t\t\t\tfetched\n \t\t\t);\n \t\t}\n-\n-\t\tif ( joinedPathSource instanceof SetPersistentAttribute ) {\n-\t\t\treturn buildSetJoin(\n+\t\telse if ( joinedPathSource instanceof SetPersistentAttribute ) {\n+\t\t\tsqmJoin = buildSetJoin(\n \t\t\t\t\t(SetPersistentAttribute) joinedPathSource,\n \t\t\t\t\tjoinType,\n \t\t\t\t\tfetched\n \t\t\t);\n \t\t}\n-\n-\t\tthrow new IllegalArgumentException(\n-\t\t\t\tString.format(\n-\t\t\t\t\t\tLocale.ROOT,\n-\t\t\t\t\t\t\"Passed attribute [%s] did not correspond to a joinable reference [%s] relative to %s\",\n-\t\t\t\t\t\tjoinedPathSource.getPathName(),\n-\t\t\t\t\t\tjoinedPathSource,\n-\t\t\t\t\t\tgetNavigablePath().getFullPath()\n-\t\t\t\t)\n-\t\t);\n+\t\telse {\n+\t\t\tthrow new IllegalArgumentException(\n+\t\t\t\t\tString.format(\n+\t\t\t\t\t\t\tLocale.ROOT,\n+\t\t\t\t\t\t\t\"Passed attribute [%s] did not correspond to a joinable reference [%s] relative to %s\",\n+\t\t\t\t\t\t\tjoinedPathSource.getPathName(),\n+\t\t\t\t\t\t\tjoinedPathSource,\n+\t\t\t\t\t\t\tgetNavigablePath().getFullPath()\n+\t\t\t\t\t)\n+\t\t\t);\n+\t\t}\n+\t\taddSqmJoin( sqmJoin );", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 74}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4040, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}