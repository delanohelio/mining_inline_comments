{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NTgzNzE0", "number": 3502, "title": "HHH-14152 reserve end-of-line chars in MultiLineImportExtractor", "bodyText": "https://hibernate.atlassian.net/browse/HHH-14152\nSo the original implementation of MultipleLinesSqlCommandExtractor striped off end-of-line chars. However, end-of-line chars could be a meaningful delimiter as other white space chars. For instance, the following common SQL script\nINSERT INTO ISSUERS\nVALUES (1, 1, 'BIPlatform', NULL, NULL);\n\nwould be erroneously transformed to\nINSERT INTO ISSUERSVALUES (1, 1, 'BIPlatform', NULL, NULL);\n\nThis PR tries to reserve such end-of-line chars.\nAnother strongly related minor issue is the trailing end-of-line chars given that they are reserved rather than skipped. I changed the parser rule to allow trailing white spaces to make the paring more robust (and less confusing. User would get misled and confused when they get statement must end in ; exception in face of trailing whitespaces).\nThe only testing script has been modified to make it more challenging. Without the code changes in this PR, both of the following testing cases would fail:\n\norg.hibernate.test.fileimport.MultiLineImportFileTest\norg.hibernate.test.fileimport.MultiLineImportExtractorTest", "createdAt": "2020-08-18T15:45:37Z", "url": "https://github.com/hibernate/hibernate-orm/pull/3502", "merged": true, "mergeCommit": {"oid": "2ab372027ec10e1189f299d6e673ca1a7bf62a51"}, "closed": true, "closedAt": "2020-08-19T10:12:42Z", "author": {"login": "NathanQingyangXu"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAIt1EAH2gAyNDY5NTgzNzE0OmVjNDdhZDMwYWJhZTBiNTkxZjQ2OTkyNmRkYTM0ZTgzOTc3NGJlYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAJlDPgFqTQ2OTYyMzA3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ec47ad30abae0b591f469926dda34e839774beb5", "author": {"user": {"login": "NathanQingyangXu", "name": "Nathan Xu"}}, "url": "https://github.com/hibernate/hibernate-orm/commit/ec47ad30abae0b591f469926dda34e839774beb5", "committedDate": "2020-08-18T15:26:32Z", "message": "HHH-14153 reserve end-of-line chars in MultiLineImportExtractor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTg4MzIw", "url": "https://github.com/hibernate/hibernate-orm/pull/3502#pullrequestreview-469588320", "createdAt": "2020-08-18T15:47:14Z", "commit": {"oid": "ec47ad30abae0b591f469926dda34e839774beb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NzoxNFrOHCay5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NzoxNFrOHCay5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5ODIxNQ==", "bodyText": "The above three lines are actually mixture of all kinds of white spaces, including ' ', '\\t' and \\n.", "url": "https://github.com/hibernate/hibernate-orm/pull/3502#discussion_r472298215", "createdAt": "2020-08-18T15:47:14Z", "author": {"login": "NathanQingyangXu"}, "path": "hibernate-core/src/test/resources/org/hibernate/test/fileimport/multi-line-statements.sql", "diffHunk": "@@ -23,12 +23,14 @@ INSERT INTO test_data VALUES (2, 'Multi-line comment line 1\n -- INSERT INTO test_data VALUES (1, NULL);\n \n INSERT INTO test_data VALUES (3 /* 'third record' */, NULL /* value */); -- with NULL value\n-INSERT INTO test_data (id, text)\n-     VALUES\n-          (\n-            4 -- another record\n-          , NULL\n-          );\n-\n+INSERT INTO test_data\n+VALUES\n+\t(\n+    \t4 -- another record\n+     \t, NULL\n+    );\n -- comment;\n -- comment;\n+\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec47ad30abae0b591f469926dda34e839774beb5"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjIzMDc3", "url": "https://github.com/hibernate/hibernate-orm/pull/3502#pullrequestreview-469623077", "createdAt": "2020-08-18T16:25:20Z", "commit": {"oid": "ec47ad30abae0b591f469926dda34e839774beb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyNToyMVrOHCcVTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyNToyMVrOHCcVTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMzQwNA==", "bodyText": "What is the reason for parsing trailing whitespace chars?", "url": "https://github.com/hibernate/hibernate-orm/pull/3502#discussion_r472323404", "createdAt": "2020-08-18T16:25:21Z", "author": {"login": "beikov"}, "path": "hibernate-core/src/main/antlr/sql-script.g", "diffHunk": "@@ -56,7 +56,7 @@ script\n     ;\n \n statement\n-\t: { statementStarted(); } (statementPart)*  DELIMITER { statementEnded(); }\n+\t: { statementStarted(); } (statementPart)* DELIMITER (WS_CHAR)* { statementEnded(); }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec47ad30abae0b591f469926dda34e839774beb5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2853, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}