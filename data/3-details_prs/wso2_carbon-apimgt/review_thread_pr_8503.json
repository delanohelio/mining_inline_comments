{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NzQzMjM1", "number": 8503, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxMzowNVrOD9uzVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxMzowNVrOD9uzVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDU2NTM1OnYy", "diffSide": "RIGHT", "path": "features/apimgt/org.wso2.carbon.apimgt.store.feature/src/main/resources/devportal/services/login/introspect.jag", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxMzowNVrOGXZg0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxMzowNVrOGXZg0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE4ODQzNQ==", "bodyText": "We shouldn't remove \"carbon.super\" if EnableEmailUserName settings is disabled but username is an email.\nEx1:\nsay username is amalka@gmail.com@carbon.super, then\n\nif isEnableEmailUserName is true => returned username is amalka@gmail.com\nif isEnableEmailUserName is false => return amalka@gmail.com@carbon.super\n\nEx2:\nsay username is malintha@carbon.super, then\n\nif isEnableEmailUserName is true => returned username is malintha\nif isEnableEmailUserName is false => return malintha (same)\n\nBasically you need to move the same logic in AuthManager.jsx with additional check for EnableEmailUserName.\nconst count = (data.username.match(/@/g) || []).length;\nif (isEnableEmailUserName || (data.username.endsWith('@carbon.super') && count <= 1)) {\n    introspectResult.data.username = introspectResult.data.username.replace('@carbon.super', '');\n}", "url": "https://github.com/wso2/carbon-apimgt/pull/8503#discussion_r427188435", "createdAt": "2020-05-19T10:13:05Z", "author": {"login": "malinthaprasan"}, "path": "features/apimgt/org.wso2.carbon.apimgt.store.feature/src/main/resources/devportal/services/login/introspect.jag", "diffHunk": "@@ -46,6 +46,10 @@\n     // For more info about response.xhr object refer http://jaggeryjs.org/documentation.jag?api=xhr\n     \n     if (introspectResult.xhr.status === 200) {\n+        var isEnableEmailUserName = appUtils.isEnableEmailUserName();\n+        if (isEnableEmailUserName || introspectResult.data.username.endsWith('@carbon.super')) {\n+            introspectResult.data.username = introspectResult.data.username.replace('@carbon.super', '');\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a2a1b95e65e75c7c2d0dd99405d2a3394b16f7a"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3379, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}