{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1ODYzMzIz", "number": 8616, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOTo1MDo0OFrOEBTqPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDozNDo1M1rOEBUWcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODA2MTQwOnYy", "diffSide": "RIGHT", "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOTo1MDo0OFrOGdE4ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDoyNjo1MVrOGdFyyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE0MTk1NQ==", "bodyText": "I think we can set this state at the state initialization time\ni:e\nconst [editMode, setIsEditMode] = useState(policyId !== 'create');", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433141955", "createdAt": "2020-06-01T09:50:48Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE1NjgwOQ==", "bodyText": "Fixed with 6317b1b", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433156809", "createdAt": "2020-06-01T10:26:51Z", "author": {"login": "kavishkafernando"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE0MTk1NQ=="}, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODE3NDU2OnYy", "diffSide": "RIGHT", "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDozNDo1M1rOGdF_3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTowOTo0NlrOGdG3Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE2MDE1Nw==", "bodyText": "dispatch(editState);\nThough this dispatch call does the job here, It's better to follow the action dispatching methodology which is described in Flux pattern.\nIn the Flux pattern Object that we pass into the dispatcher called an action, Typically there are two elements in an action type and payload, and we derive the next state by switching the executing by the action type and incoming event's payload.\nThis pattern can be seen in React documentation examples as well.\nShall we follow a similar pattern here as well?", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433160157", "createdAt": "2020-06-01T10:34:53Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);\n+            restApi.customPolicyGet(policyId).then((result) => {\n+                const formattedSiddhiQuery = sqlFormatter.format(result.body.siddhiQuery);\n+                const editState = {\n+                    policyName: result.body.policyName,\n+                    description: result.body.description,\n+                    keyTemplate: result.body.keyTemplate,\n+                    siddhiQuery: formattedSiddhiQuery,\n+                };\n+                dispatch(editState);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NDI5NQ==", "bodyText": "Fixed with 4e14418", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433174295", "createdAt": "2020-06-01T11:09:46Z", "author": {"login": "kavishkafernando"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);\n+            restApi.customPolicyGet(policyId).then((result) => {\n+                const formattedSiddhiQuery = sqlFormatter.format(result.body.siddhiQuery);\n+                const editState = {\n+                    policyName: result.body.policyName,\n+                    description: result.body.description,\n+                    keyTemplate: result.body.keyTemplate,\n+                    siddhiQuery: formattedSiddhiQuery,\n+                };\n+                dispatch(editState);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE2MDE1Nw=="}, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 79}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3306, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}