{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NjU5NTM4", "number": 8491, "title": "Add deleteEndpointRegistry resource", "bodyText": "", "createdAt": "2020-05-12T11:20:22Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8491", "merged": true, "mergeCommit": {"oid": "85a914dcf1f66dc96476d543ace0f2c45eab1b9a"}, "closed": true, "closedAt": "2020-05-12T14:07:11Z", "author": {"login": "ChamodDamitha"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgib-LgH2gAyNDE2NjU5NTM4OjllYzU2ODQ3Zjg3ZTU2YjNiYWM3MmZhYWJmYTZkMjY1Zjk4OTU5ZTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgk111gFqTQxMDA3ODY3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9ec56847f87e56b3bac72faabfa6d265f98959e8", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/9ec56847f87e56b3bac72faabfa6d265f98959e8", "committedDate": "2020-05-12T11:18:59Z", "message": "Add deleteEndpointRegistry resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTUzNzM5", "url": "https://github.com/wso2/carbon-apimgt/pull/8491#pullrequestreview-409953739", "createdAt": "2020-05-12T11:38:19Z", "commit": {"oid": "9ec56847f87e56b3bac72faabfa6d265f98959e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMTozODoxOVrOGUCe0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMTozODoxOVrOGUCe0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY2NTM2MA==", "bodyText": "Shall we do this in the REST API level, so that we can throw the exception from there itself? I felt the readability is a bit reduced when we throw it from here and catch it from the parent and then handle the exception again. Also, this supports the single responsibility principle by only focusing on the delete operation.", "url": "https://github.com/wso2/carbon-apimgt/pull/8491#discussion_r423665360", "createdAt": "2020-05-12T11:38:19Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/EndpointRegistryImpl.java", "diffHunk": "@@ -78,6 +78,21 @@ public EndpointRegistryInfo getEndpointRegistryByUUID(String registryId) throws\n         return apiMgtDAO.getEndpointRegistryByUUID(registryId);\n     }\n \n+    /**\n+     * Deletes an Endpoint Registry\n+     *\n+     * @param registryId Registry Identifier(UUID)\n+     * @throws APIManagementException if failed to delete the Endpoint Registry\n+     */\n+    public void deleteEndpointRegistry(String registryId) throws APIManagementException {\n+        EndpointRegistryInfo endpointRegistryInfo = apiMgtDAO.getEndpointRegistryByUUID(registryId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec56847f87e56b3bac72faabfa6d265f98959e8"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd7443796a9a205dceb60642d4892d562f9cb057", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/dd7443796a9a205dceb60642d4892d562f9cb057", "committedDate": "2020-05-12T12:20:03Z", "message": "Handle resource not found exception at REST API Level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6e1f3813d3d253476c07cf3ae7b5e4900f70600", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a6e1f3813d3d253476c07cf3ae7b5e4900f70600", "committedDate": "2020-05-12T12:53:34Z", "message": "Add cross-tenant restriction for endpoint registry resources"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDU1MjY4", "url": "https://github.com/wso2/carbon-apimgt/pull/8491#pullrequestreview-410055268", "createdAt": "2020-05-12T13:43:56Z", "commit": {"oid": "a6e1f3813d3d253476c07cf3ae7b5e4900f70600"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMzo0Mzo1N1rOGUHSRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMzo0Mzo1N1rOGUHSRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc0NDA3MA==", "bodyText": "We don't need this right? since we have 'delete on cascade' ? deleting the registry should delete the entries automatically.", "url": "https://github.com/wso2/carbon-apimgt/pull/8491#discussion_r423744070", "createdAt": "2020-05-12T13:43:57Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -14789,6 +14792,32 @@ public EndpointRegistryInfo getEndpointRegistryByUUID(String registryId) throws\n         return null;\n     }\n \n+    /**\n+     * Deletes an Endpoint Registry\n+     *\n+     * @param registryUUID Registry Identifier(UUID)\n+     * @param registryId Registry Identifier\n+     * @throws APIManagementException if failed to delete the Endpoint Registry\n+     */\n+    public void deleteEndpointRegistry(String registryUUID, int registryId) throws APIManagementException {\n+        String deleteRegQuery = SQLConstants.DELETE_ENDPOINT_REGISTRY_SQL;\n+        String deleteRegEntryQuery = SQLConstants.DELETE_ENDPOINT_REGISTRY_ENTRY_BY_REGISTRY_ID_SQL;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6e1f3813d3d253476c07cf3ae7b5e4900f70600"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff8b5f92252c2c3497e900ed0ffdc9071c032be5", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/ff8b5f92252c2c3497e900ed0ffdc9071c032be5", "committedDate": "2020-05-12T14:03:29Z", "message": "Remove unnecessary endpoint registry entry delete query"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "027f192630ecc97b52ab64b00736de123fdeaeff", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/027f192630ecc97b52ab64b00736de123fdeaeff", "committedDate": "2020-05-12T13:51:13Z", "message": "Remove unnecessary endpoint registry entry delete query"}, "afterCommit": {"oid": "ff8b5f92252c2c3497e900ed0ffdc9071c032be5", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/ff8b5f92252c2c3497e900ed0ffdc9071c032be5", "committedDate": "2020-05-12T14:03:29Z", "message": "Remove unnecessary endpoint registry entry delete query"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDc4Njc5", "url": "https://github.com/wso2/carbon-apimgt/pull/8491#pullrequestreview-410078679", "createdAt": "2020-05-12T14:07:03Z", "commit": {"oid": "ff8b5f92252c2c3497e900ed0ffdc9071c032be5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2852, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}