{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MjMwOTUy", "number": 8589, "title": "Update endpoint registry resources to restrict on registry type", "bodyText": "", "createdAt": "2020-05-28T03:49:26Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8589", "merged": true, "mergeCommit": {"oid": "2f2069eac6d71922a81a3b4e150a3781104f6a36"}, "closed": true, "closedAt": "2020-05-28T04:57:49Z", "author": {"login": "ChamodDamitha"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcllrjEAFqTQxOTc1OTg1MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclmBF-AFqTQxOTc2NjIyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzU5ODUx", "url": "https://github.com/wso2/carbon-apimgt/pull/8589#pullrequestreview-419759851", "createdAt": "2020-05-28T03:55:20Z", "commit": {"oid": "c21b7b834baace0284794e8da9a2b0fc875cc15e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzo1NToyMFrOGbkyLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzo1NToyMFrOGbkyLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU2NzQwNg==", "bodyText": "Rather than checking for the existence and then creating the Registry, can't we simply fetch the registry and then create it if it's null?", "url": "https://github.com/wso2/carbon-apimgt/pull/8589#discussion_r431567406", "createdAt": "2020-05-28T03:55:20Z", "author": {"login": "jaadds"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/endpoint/registry/impl/EndpointRegistryImpl.java", "diffHunk": "@@ -113,24 +119,35 @@ public void deleteEndpointRegistry(String registryUUID) throws EndpointRegistryE\n     /**\n      * Returns details of all Endpoint Registries belong to a given tenant\n      *\n-     * @param name         Registry name\n-     * @param sortBy       Name of the sorting field\n-     * @param sortOrder    Order of sorting (asc or desc)\n-     * @param limit        Limit\n-     * @param offset       Offset\n      * @param tenantDomain\n      * @return A list of EndpointRegistryInfo objects\n      * @throws EndpointRegistryException if failed to get details of an Endpoint Registries\n      */\n-    public List<EndpointRegistryInfo> getEndpointRegistries(String name, String sortBy, String sortOrder,\n-                                                            int limit, int offset,\n-                                                            String tenantDomain) throws EndpointRegistryException {\n+    public List<EndpointRegistryInfo> getEndpointRegistries(String tenantDomain) throws EndpointRegistryException {\n \n         int tenantId;\n         try {\n             tenantId = ServiceReferenceHolder.getInstance().getRealmService().getTenantManager()\n                     .getTenantId(tenantDomain);\n-            return registryDAO.getEndpointRegistries(name, sortBy, sortOrder, limit, offset, tenantId);\n+            // Create the default registry if no registry found\n+            if (!registryDAO.isEndpointRegistryTypeExists(EndpointRegistryConstants.REGISTRY_TYPE_WSO2, tenantId) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c21b7b834baace0284794e8da9a2b0fc875cc15e"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57df790c82a44144a82bf19cd18d50b58d332e37", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/57df790c82a44144a82bf19cd18d50b58d332e37", "committedDate": "2020-05-28T04:11:45Z", "message": "Update endpoint registry resources to restrict on registry type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c21b7b834baace0284794e8da9a2b0fc875cc15e", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c21b7b834baace0284794e8da9a2b0fc875cc15e", "committedDate": "2020-05-27T18:09:46Z", "message": "Update endpoint registry resources to restrict on registry type"}, "afterCommit": {"oid": "57df790c82a44144a82bf19cd18d50b58d332e37", "author": {"user": {"login": "ChamodDamitha", "name": "Chamod Damitha Samarajeewa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/57df790c82a44144a82bf19cd18d50b58d332e37", "committedDate": "2020-05-28T04:11:45Z", "message": "Update endpoint registry resources to restrict on registry type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzY2MjIw", "url": "https://github.com/wso2/carbon-apimgt/pull/8589#pullrequestreview-419766220", "createdAt": "2020-05-28T04:18:52Z", "commit": {"oid": "57df790c82a44144a82bf19cd18d50b58d332e37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2804, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}