{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwOTAwNjIz", "number": 8145, "title": "add functionality to validate Mutual SSL certificate as a Header", "bodyText": "add functionality to validate Mutual SSL certificate as a Header", "createdAt": "2020-02-04T15:30:17Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8145", "merged": true, "mergeCommit": {"oid": "7570407af274489d0a0f58b65e4d8a6edbdfe526"}, "closed": true, "closedAt": "2020-02-10T04:48:27Z", "author": {"login": "tharindu1st"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBFtNpgFqTM1MzE3NDk0OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCsKsXABqjMwMjA3NTI3MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMTc0OTQ4", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-353174948", "createdAt": "2020-02-04T17:45:55Z", "commit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "state": "DISMISSED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNzo0NTo1NlrOFldZ_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxODoxODoyOFrOFleaZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgyMzQyMg==", "bodyText": "don't we need \"\\n\" after BEGIN_CERTIFICATE_STRING?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374823422", "createdAt": "2020-02-04T17:45:56Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/common/MutualSSLCertificateHandler.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ *   Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *   WSO2 Inc. licenses this file to you under the Apache License,\n+ *   Version 2.0 (the \"License\"); you may not use this file except\n+ *   in compliance with the License.\n+ *   You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ *\n+ */\n+\n+package org.wso2.carbon.apimgt.gateway.handlers.common;\n+\n+import org.apache.commons.codec.binary.Base64;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.apache.synapse.MessageContext;\n+import org.apache.synapse.core.axis2.Axis2MessageContext;\n+import org.apache.synapse.rest.AbstractHandler;\n+import org.apache.synapse.transport.nhttp.NhttpConstants;\n+import org.wso2.carbon.apimgt.gateway.APIMgtGatewayConstants;\n+import org.wso2.carbon.apimgt.gateway.handlers.Utils;\n+\n+import java.util.Map;\n+\n+import javax.security.cert.X509Certificate;\n+\n+public class MutualSSLCertificateHandler extends AbstractHandler {\n+\n+    private static final Log log = LogFactory.getLog(MutualSSLCertificateHandler.class);\n+\n+    @Override\n+    public boolean handleRequest(MessageContext messageContext) {\n+\n+        X509Certificate certificateFromMessageContext = null;\n+        org.apache.axis2.context.MessageContext axis2MsgContext =\n+                ((Axis2MessageContext) messageContext).getAxis2MessageContext();\n+        Map headers = (Map) (axis2MsgContext)\n+                .getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+\n+        Object sslCertObject = axis2MsgContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        if (sslCertObject != null) {\n+            X509Certificate[] x509Certificates = (X509Certificate[]) sslCertObject;\n+            if (x509Certificates.length > 0) {\n+                certificateFromMessageContext = x509Certificates[0];\n+            }\n+        }\n+        if (certificateFromMessageContext != null) {\n+            if (!headers.containsKey(Utils.getClientCertificateHeader())) {\n+                try {\n+                    byte[] base64Encoded = Base64.encodeBase64(certificateFromMessageContext.getEncoded());\n+                    String base64EncodedString =\n+                            APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING.concat(new String(base64Encoded)).concat(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgyOTAxNw==", "bodyText": "shall we swap if and else, and negate the condition?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374829017", "createdAt": "2020-02-04T17:57:10Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);\n+                    throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                            \"Error while Convert into X509Certificate\", e);\n+                }\n+            }\n+        }\n+        // Certificate available in header\n+        if (certificateFromHeader != null) {\n+            if (isClientCertificateValidationDisable()){\n+                log.debug(\"Client Certificate Validation disable hence returning client certificate from header\");\n+                return certificateFromHeader;\n+            }\n+            try {\n+                if (!APIUtil.isCertificateExistInTrustStore(certificateFromMessageContext)) {\n+                    log.error(\"Certificate in messageContext not available in truststore\");\n+                    return null;\n+                } else {\n+                    return certificateFromHeader;\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 147}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzMTgxOQ==", "bodyText": "and I think we can move this to above L265.", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374831819", "createdAt": "2020-02-04T18:02:33Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);\n+                    throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                            \"Error while Convert into X509Certificate\", e);\n+                }\n+            }\n+        }\n+        // Certificate available in header\n+        if (certificateFromHeader != null) {\n+            if (isClientCertificateValidationDisable()){\n+                log.debug(\"Client Certificate Validation disable hence returning client certificate from header\");\n+                return certificateFromHeader;\n+            }\n+            try {\n+                if (!APIUtil.isCertificateExistInTrustStore(certificateFromMessageContext)) {\n+                    log.error(\"Certificate in messageContext not available in truststore\");\n+                    return null;\n+                } else {\n+                    return certificateFromHeader;\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgyOTAxNw=="}, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 147}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzMjk2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                log.error(\"Error while Convert into X509Certificate\", e);\n          \n          \n            \n                                log.error(\"Error while converting the certificate to X509Certificate\", e);", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374832968", "createdAt": "2020-02-04T18:04:47Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzNDU2Ng==", "bodyText": "shall we put a debug log for the else case?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374834566", "createdAt": "2020-02-04T18:08:05Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 127}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzNjY5Mw==", "bodyText": "can't System.getProperty(\"javax.net.ssl.trustStorePassword\") be null?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374836693", "createdAt": "2020-02-04T18:12:18Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/certificatemgt/reloader/CertificateReLoader.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.apimgt.impl.certificatemgt.reloader;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.impl.internal.ServiceReferenceHolder;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.security.KeyStore;\n+import java.security.KeyStoreException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.cert.CertificateException;\n+\n+/**\n+ * This class used to load new certificate file into Memory\n+ */\n+public class CertificateReLoader implements Runnable {\n+\n+    private static final Log log = LogFactory.getLog(CertificateReLoader.class);\n+    private static char[] TRUST_STORE_PASSWORD = System.getProperty(\"javax.net.ssl.trustStorePassword\").toCharArray();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzNzEzMQ==", "bodyText": "formatting error", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374837131", "createdAt": "2020-02-04T18:13:10Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/certificatemgt/reloader/CertificateReLoaderUtil.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.apimgt.impl.certificatemgt.reloader;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.wso2.carbon.apimgt.impl.APIConstants;\n+import org.wso2.carbon.apimgt.impl.internal.ServiceReferenceHolder;\n+\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.ScheduledExecutorService;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Utility to start CertificateReLoader\n+ */\n+public class CertificateReLoaderUtil {\n+\n+    private static ScheduledExecutorService executor = Executors.newScheduledThreadPool(1);\n+    private CertificateReLoaderUtil() {\n+\n+    }\n+\n+    private static long lastUpdatedTimeStamp;\n+\n+    public static void startCertificateReLoader() {\n+\n+        CertificateReLoader certificateReLoader = new CertificateReLoader();\n+            executor.scheduleAtFixedRate(certificateReLoader, 60, getCertificateReLoaderInterval(), TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzOTYyNQ==", "bodyText": "shall we change this to enable to match with apimgt.mutual_ssl.enable_client_validation?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374839625", "createdAt": "2020-02-04T18:17:57Z", "author": {"login": "bhathiya"}, "path": "features/apimgt/org.wso2.carbon.apimgt.core.feature/src/main/resources/config/api-manager.xml", "diffHunk": "@@ -760,5 +760,11 @@\n     <JWTAuthentication>\n         <EnableSubscriptionValidationViaKeyManager>false</EnableSubscriptionValidationViaKeyManager>\n     </JWTAuthentication>\n-\n+    <CertificateReLoaderConfiguration>\n+        <Period>10</Period>\n+    </CertificateReLoaderConfiguration>\n+    <MutualSSL>\n+        <ClientCertificateHeader>X-WSO2-CLIENT-CERTIFICATE</ClientCertificateHeader>\n+        <DisableClientCertificateValidation>false</DisableClientCertificateValidation>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzOTkxMA==", "bodyText": "shall we change this to enable to match with apimgt.mutual_ssl.enable_client_validation?", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r374839910", "createdAt": "2020-02-04T18:18:28Z", "author": {"login": "bhathiya"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);\n+                    throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                            \"Error while Convert into X509Certificate\", e);\n+                }\n+            }\n+        }\n+        // Certificate available in header\n+        if (certificateFromHeader != null) {\n+            if (isClientCertificateValidationDisable()){\n+                log.debug(\"Client Certificate Validation disable hence returning client certificate from header\");\n+                return certificateFromHeader;\n+            }\n+            try {\n+                if (!APIUtil.isCertificateExistInTrustStore(certificateFromMessageContext)) {\n+                    log.error(\"Certificate in messageContext not available in truststore\");\n+                    return null;\n+                } else {\n+                    return certificateFromHeader;\n+                }\n+            } catch (APIManagementException e) {\n+                throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                        \"Error while Convert into X509Certificate\", e);\n+            }\n+        } else {\n+            return certificateFromMessageContext;\n+        }\n+    }\n+\n+    private boolean isClientCertificateValidationDisable() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 157}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDYzOTYy", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-353463962", "createdAt": "2020-02-05T04:46:55Z", "commit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0Njo1NlrOFlrrvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0Njo1NlrOFlrrvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1NzM0MQ==", "bodyText": "Client Certificate Validation disabled. Hence returning client certificate from header\"", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r375057341", "createdAt": "2020-02-05T04:46:56Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);\n+                    throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                            \"Error while Convert into X509Certificate\", e);\n+                }\n+            }\n+        }\n+        // Certificate available in header\n+        if (certificateFromHeader != null) {\n+            if (isClientCertificateValidationDisable()){\n+                log.debug(\"Client Certificate Validation disable hence returning client certificate from header\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 138}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDY0MDk0", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-353464094", "createdAt": "2020-02-05T04:47:29Z", "commit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0NzozMFrOFlrsKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0NzozMFrOFlrsKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1NzQ0OQ==", "bodyText": "Error while converting ...", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r375057449", "createdAt": "2020-02-05T04:47:30Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.gateway/src/main/java/org/wso2/carbon/apimgt/gateway/handlers/security/authenticator/MutualSSLAuthenticator.java", "diffHunk": "@@ -236,4 +243,77 @@ public String getRequestOrigin() {\n     public int getPriority() {\n         return 0;\n     }\n+\n+    /**\n+     * Return Client Certificate from Message Context or from Header.\n+     * @param axis2MessageContext\n+     * @return X509 Certificate Object\n+     * @throws APISecurityException\n+     */\n+    private X509Certificate getClientCertificate(org.apache.axis2.context.MessageContext axis2MessageContext)\n+            throws APISecurityException {\n+\n+        Map headers =\n+                (Map) axis2MessageContext.getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);\n+        Object sslCertObject = axis2MessageContext.getProperty(NhttpConstants.SSL_CLIENT_AUTH_CERT_X509);\n+        X509Certificate certificateFromMessageContext = null;\n+        X509Certificate certificateFromHeader = null;\n+        if (sslCertObject != null) {\n+            X509Certificate[] certs = (X509Certificate[]) sslCertObject;\n+            certificateFromMessageContext = certs[0];\n+        }\n+        if (headers.containsKey(Utils.getClientCertificateHeader())) {\n+            String base64EncodedCertificate =\n+                    (String) headers.get(Utils.getClientCertificateHeader());\n+            if (base64EncodedCertificate != null) {\n+                base64EncodedCertificate = URLDecoder.decode(base64EncodedCertificate).\n+                        replaceAll(APIMgtGatewayConstants.BEGIN_CERTIFICATE_STRING, \"\")\n+                        .replaceAll(APIMgtGatewayConstants.END_CERTIFICATE_STRING, \"\");\n+\n+                byte[] bytes = Base64.decodeBase64(base64EncodedCertificate);\n+                try (InputStream inputStream = new ByteArrayInputStream(bytes)) {\n+                    X509Certificate x509Certificate = X509Certificate.getInstance(inputStream);\n+                    if (APIUtil.isCertificateExistInTrustStore(x509Certificate)) {\n+                        certificateFromHeader = x509Certificate;\n+                    }\n+                } catch (IOException | CertificateException | APIManagementException e) {\n+                    log.error(\"Error while Convert into X509Certificate\", e);\n+                    throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                            \"Error while Convert into X509Certificate\", e);\n+                }\n+            }\n+        }\n+        // Certificate available in header\n+        if (certificateFromHeader != null) {\n+            if (isClientCertificateValidationDisable()){\n+                log.debug(\"Client Certificate Validation disable hence returning client certificate from header\");\n+                return certificateFromHeader;\n+            }\n+            try {\n+                if (!APIUtil.isCertificateExistInTrustStore(certificateFromMessageContext)) {\n+                    log.error(\"Certificate in messageContext not available in truststore\");\n+                    return null;\n+                } else {\n+                    return certificateFromHeader;\n+                }\n+            } catch (APIManagementException e) {\n+                throw new APISecurityException(APISecurityConstants.API_AUTH_GENERAL_ERROR,\n+                        \"Error while Convert into X509Certificate\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 150}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDY0MzEy", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-353464312", "createdAt": "2020-02-05T04:48:28Z", "commit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0ODoyOFrOFlrs2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNDo0ODoyOFrOFlrs2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1NzYyNg==", "bodyText": "Unable to find the certificate", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r375057626", "createdAt": "2020-02-05T04:48:28Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/certificatemgt/reloader/CertificateReLoader.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.apimgt.impl.certificatemgt.reloader;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.impl.internal.ServiceReferenceHolder;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.security.KeyStore;\n+import java.security.KeyStoreException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.cert.CertificateException;\n+\n+/**\n+ * This class used to load new certificate file into Memory\n+ */\n+public class CertificateReLoader implements Runnable {\n+\n+    private static final Log log = LogFactory.getLog(CertificateReLoader.class);\n+    private static char[] TRUST_STORE_PASSWORD = System.getProperty(\"javax.net.ssl.trustStorePassword\").toCharArray();\n+    private static String TRUST_STORE = System.getProperty(\"javax.net.ssl.trustStore\");\n+\n+    @Override\n+    public void run() {\n+\n+        File trustStoreFile = new File(TRUST_STORE);\n+        FileInputStream localTrustStoreStream;\n+        try {\n+            long lastUpdatedTimeStamp = CertificateReLoaderUtil.getLastUpdatedTimeStamp();\n+            long lastModified = trustStoreFile.lastModified();\n+            if (lastUpdatedTimeStamp != lastModified) {\n+                CertificateReLoaderUtil.setLastUpdatedTimeStamp(lastModified);\n+                localTrustStoreStream = new FileInputStream(trustStoreFile);\n+                KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());\n+                trustStore.load(localTrustStoreStream, TRUST_STORE_PASSWORD);\n+                ServiceReferenceHolder.getInstance().setTrustStore(trustStore);\n+            }\n+\n+        } catch (KeyStoreException | CertificateException | IOException | NoSuchAlgorithmException e) {\n+            log.error(\"Certificate Couldn't find\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDY3MDk1", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-353467095", "createdAt": "2020-02-05T05:01:31Z", "commit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNTowMTozMVrOFlr2Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNTowMTozMVrOFlr2Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA1OTk5OA==", "bodyText": "Exists", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#discussion_r375059998", "createdAt": "2020-02-05T05:01:31Z", "author": {"login": "fazlan-nazeem"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/utils/APIUtil.java", "diffHunk": "@@ -10087,4 +10097,37 @@ public static boolean isDefaultApplicationCreationDisabledForTenant(int tenantId\n         }\n         return state;\n     }\n+\n+    /**\n+     * Validate Certificate exist in TrustStore\n+     * @param certificate\n+     * @return true if certificate exist in truststore\n+     * @throws APIManagementException\n+     */\n+    public static boolean isCertificateExistInTrustStore(X509Certificate certificate) throws APIManagementException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/e9b6e1cbd070c2ab49c77c83ce97a03a724f37aa", "committedDate": "2020-02-04T15:18:54Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "479207db8cc1c3227b2a98d7a922e99254ae9b3e", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/479207db8cc1c3227b2a98d7a922e99254ae9b3e", "committedDate": "2020-02-05T08:31:46Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "479207db8cc1c3227b2a98d7a922e99254ae9b3e", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/479207db8cc1c3227b2a98d7a922e99254ae9b3e", "committedDate": "2020-02-05T08:31:46Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "4a925e8a7b89265182bb325f1b33d9365763f811", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/4a925e8a7b89265182bb325f1b33d9365763f811", "committedDate": "2020-02-05T09:25:07Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a925e8a7b89265182bb325f1b33d9365763f811", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/4a925e8a7b89265182bb325f1b33d9365763f811", "committedDate": "2020-02-05T09:25:07Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "0d842d52bb02b0ab7448151f58b85b70dc2a7656", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/0d842d52bb02b0ab7448151f58b85b70dc2a7656", "committedDate": "2020-02-05T09:46:36Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0d842d52bb02b0ab7448151f58b85b70dc2a7656", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/0d842d52bb02b0ab7448151f58b85b70dc2a7656", "committedDate": "2020-02-05T09:46:36Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "b1ed0111a89965f8f2fc3cea53a0e60b9185b259", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b1ed0111a89965f8f2fc3cea53a0e60b9185b259", "committedDate": "2020-02-05T09:53:37Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1ed0111a89965f8f2fc3cea53a0e60b9185b259", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b1ed0111a89965f8f2fc3cea53a0e60b9185b259", "committedDate": "2020-02-05T09:53:37Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "bf5604c28921a809371e8466d5938d1feb694e09", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/bf5604c28921a809371e8466d5938d1feb694e09", "committedDate": "2020-02-05T09:54:04Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NDM0ODc3", "url": "https://github.com/wso2/carbon-apimgt/pull/8145#pullrequestreview-354434877", "createdAt": "2020-02-06T13:08:37Z", "commit": {"oid": "bf5604c28921a809371e8466d5938d1feb694e09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf5604c28921a809371e8466d5938d1feb694e09", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/bf5604c28921a809371e8466d5938d1feb694e09", "committedDate": "2020-02-05T09:54:04Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "88983ca36b36afcc0d1b2c7cd0d0e348fb6e6e34", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/88983ca36b36afcc0d1b2c7cd0d0e348fb6e6e34", "committedDate": "2020-02-07T11:31:15Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88983ca36b36afcc0d1b2c7cd0d0e348fb6e6e34", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/88983ca36b36afcc0d1b2c7cd0d0e348fb6e6e34", "committedDate": "2020-02-07T11:31:15Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "4bbc2c9d5058ca63eab894d386e7801be612a47e", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/4bbc2c9d5058ca63eab894d386e7801be612a47e", "committedDate": "2020-02-09T16:42:54Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5f914d4b2aa7ee1f60b06882a081d3b21af546f", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b5f914d4b2aa7ee1f60b06882a081d3b21af546f", "committedDate": "2020-02-09T17:40:44Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bbc2c9d5058ca63eab894d386e7801be612a47e", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/4bbc2c9d5058ca63eab894d386e7801be612a47e", "committedDate": "2020-02-09T16:42:54Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}, "afterCommit": {"oid": "b5f914d4b2aa7ee1f60b06882a081d3b21af546f", "author": {"user": {"login": "tharindu1st", "name": "Tharindu Dasun Dharmarathna"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b5f914d4b2aa7ee1f60b06882a081d3b21af546f", "committedDate": "2020-02-09T17:40:44Z", "message": "add functionality to validate Mutual SSL certificate as a Header"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2976, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}