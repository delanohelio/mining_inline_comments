{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NjgwMzYw", "number": 8492, "title": "[Admin portal revamp] Application Owner Change", "bodyText": "", "createdAt": "2020-05-12T12:03:18Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8492", "merged": true, "mergeCommit": {"oid": "e5427bff2293a9a70a1ae276661782c1f41dc00d"}, "closed": true, "closedAt": "2020-05-19T04:35:47Z", "author": {"login": "chathuranga95"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgjIxXgFqTQwOTk3Mzc4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcifsxYABqjMzNDcyNjk1NzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTczNzg4", "url": "https://github.com/wso2/carbon-apimgt/pull/8492#pullrequestreview-409973788", "createdAt": "2020-05-12T12:07:54Z", "commit": {"oid": "112381533ccd0cdb28ed344dcd63ceb80fc19e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowNzo1NFrOGUDbrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowNzo1NFrOGUDbrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY4MDk0MA==", "bodyText": "Do we need to create new promise here?\nWe can do restApi.updateApplicationOwner(id, owner).then() directly, since it's a promise itself", "url": "https://github.com/wso2/carbon-apimgt/pull/8492#discussion_r423680940", "createdAt": "2020-05-12T12:07:54Z", "author": {"login": "Krishanx92"}, "path": "features/apimgt/org.wso2.carbon.apimgt.store.feature/src/main/resources/admin_new/source/src/app/components/ApplicationSettings/EditApplication.jsx", "diffHunk": "@@ -0,0 +1,202 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import React, { useReducer } from 'react';\n+import API from 'AppData/api';\n+import PropTypes from 'prop-types';\n+import TextField from '@material-ui/core/TextField';\n+import DialogContentText from '@material-ui/core/DialogContentText';\n+import { FormattedMessage } from 'react-intl';\n+import { makeStyles } from '@material-ui/core/styles';\n+import FormDialogBase from 'AppComponents/AdminPages/Addons/FormDialogBase';\n+import Alert from 'AppComponents/Shared/Alert';\n+\n+const useStyles = makeStyles((theme) => ({\n+    error: {\n+        color: theme.palette.error.dark,\n+    },\n+}));\n+\n+let initialState = {\n+    name: '',\n+    owner: '',\n+};\n+\n+/**\n+ * Reducer\n+ * @param {JSON} state State\n+ * @returns {Promise}.\n+ */\n+function reducer(state, { field, value }) {\n+    return {\n+        ...state,\n+        [field]: value,\n+    };\n+}\n+\n+/**\n+ * Render a pop-up dialog to change ownership of an Application\n+ * @param {JSON} props props passed from parent\n+ * @returns {JSX}.\n+ */\n+function Edit(props) {\n+    const classes = useStyles();\n+    const {\n+        updateList, dataRow, icon, triggerButtonText, title, applicationList,\n+    } = props;\n+    let id = null;\n+\n+    if (dataRow) {\n+        const { name: originalName, owner: originalOwner } = dataRow;\n+        id = dataRow.applicationId;\n+\n+        initialState = {\n+            name: originalName,\n+            owner: originalOwner,\n+        };\n+    }\n+    const [state, dispatch] = useReducer(reducer, initialState);\n+    const { name, owner } = state;\n+\n+    const onChange = (e) => {\n+        dispatch({ field: e.target.name, value: e.target.value });\n+    };\n+\n+    const validateOwner = () => {\n+        const valid = { invalid: false, error: '' };\n+\n+        const applicationsWithSameName = applicationList.filter(\n+            (app) => app.name === name && app.owner === owner,\n+        );\n+        if (applicationsWithSameName.length > 0) {\n+            valid.error = `${owner} already has an application with name: ${name}`;\n+            valid.invalid = true;\n+        }\n+        // todo: Validate whether the owner is an existing subscriber or not.\n+\n+        return valid;\n+    };\n+\n+\n+    const getAllFormErrors = () => {\n+        let errorText = '';\n+        const valid = validateOwner(applicationList);\n+        if (valid.invalid) {\n+            errorText += valid.error;\n+        }\n+\n+        return errorText;\n+    };\n+    const formSaveCallback = () => {\n+        const formErrors = getAllFormErrors();\n+        if (formErrors !== '') {\n+            Alert.error(formErrors);\n+            return false;\n+        }\n+        const restApi = new API();\n+        let promiseAPICall = restApi.updateApplicationOwner(id, owner);\n+\n+        promiseAPICall = new Promise((resolve, reject) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "112381533ccd0cdb28ed344dcd63ceb80fc19e5e"}, "originalPosition": 114}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTc0MzY1", "url": "https://github.com/wso2/carbon-apimgt/pull/8492#pullrequestreview-409974365", "createdAt": "2020-05-12T12:08:40Z", "commit": {"oid": "112381533ccd0cdb28ed344dcd63ceb80fc19e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowODo0MFrOGUDdYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowODo0MFrOGUDdYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY4MTM3Nw==", "bodyText": "Same here", "url": "https://github.com/wso2/carbon-apimgt/pull/8492#discussion_r423681377", "createdAt": "2020-05-12T12:08:40Z", "author": {"login": "Krishanx92"}, "path": "features/apimgt/org.wso2.carbon.apimgt.store.feature/src/main/resources/admin_new/source/src/app/components/ApplicationSettings/ListApplications.jsx", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import React, { useState } from 'react';\n+import API from 'AppData/api';\n+import { useIntl, FormattedMessage } from 'react-intl';\n+import List from '@material-ui/core/List';\n+import ListItem from '@material-ui/core/ListItem';\n+import ListItemIcon from '@material-ui/core/ListItemIcon';\n+import ListItemText from '@material-ui/core/ListItemText';\n+import Typography from '@material-ui/core/Typography';\n+import HelpBase from 'AppComponents/AdminPages/Addons/HelpBase';\n+import ListBase from 'AppComponents/AdminPages/Addons/ListBase';\n+import EditApplication from 'AppComponents/ApplicationSettings/EditApplication';\n+import DescriptionIcon from '@material-ui/icons/Description';\n+import Link from '@material-ui/core/Link';\n+import Configurations from 'Config';\n+import EditIcon from '@material-ui/icons/Edit';\n+\n+/**\n+ * Render a list\n+ * @returns {JSX} Header AppBar components.\n+ */\n+export default function ListApplications() {\n+    const intl = useIntl();\n+    const [applicationList, setApplicationList] = useState([]);\n+    /**\n+    * API call to get application list\n+    * @returns {Promise}.\n+    */\n+    function apiCall() {\n+        return new Promise((resolve, reject) => {\n+            const restApi = new API();\n+            restApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "112381533ccd0cdb28ed344dcd63ceb80fc19e5e"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTg1Njk0", "url": "https://github.com/wso2/carbon-apimgt/pull/8492#pullrequestreview-410585694", "createdAt": "2020-05-13T04:52:52Z", "commit": {"oid": "707ae1e741f6b5ecddc2c413d0e2635a892c44db"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6622d036c121a229c8d08a43a394e290ddbff9f", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c6622d036c121a229c8d08a43a394e290ddbff9f", "committedDate": "2020-05-18T13:07:05Z", "message": "Add Application Listing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a581240618fdeb5d463dc2333a136209c4a8cab", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/7a581240618fdeb5d463dc2333a136209c4a8cab", "committedDate": "2020-05-18T13:07:45Z", "message": "Listing implement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99ed118c7e9d5f426425f4b21fd19c483611d511", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/99ed118c7e9d5f426425f4b21fd19c483611d511", "committedDate": "2020-05-18T13:07:45Z", "message": "Implement Edit Application Owner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c08714d6c9c30450f460f52f82d9ed1527320a6d", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c08714d6c9c30450f460f52f82d9ed1527320a6d", "committedDate": "2020-05-18T13:07:52Z", "message": "Update locales"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2d7014610a86791af20d84f959930e914a08f2e", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f2d7014610a86791af20d84f959930e914a08f2e", "committedDate": "2020-05-18T13:07:52Z", "message": "Remove unnecessary variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f07c29311d8f3d5e9bfb049c02357123799cc0ea", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f07c29311d8f3d5e9bfb049c02357123799cc0ea", "committedDate": "2020-05-18T13:14:09Z", "message": "Update locales"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "707ae1e741f6b5ecddc2c413d0e2635a892c44db", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/707ae1e741f6b5ecddc2c413d0e2635a892c44db", "committedDate": "2020-05-12T12:14:20Z", "message": "Remove unnecessary variable"}, "afterCommit": {"oid": "f07c29311d8f3d5e9bfb049c02357123799cc0ea", "author": {"user": {"login": "chathuranga95", "name": "ChathurangaS"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f07c29311d8f3d5e9bfb049c02357123799cc0ea", "committedDate": "2020-05-18T13:14:09Z", "message": "Update locales"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2854, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}