{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMzA4Njc2", "number": 8697, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMjoyNFrOEENebg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxNzoxMFrOEENlEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODUwNTQyOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIKey.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMjoyNFrOGhsGGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMjoyNFrOGhsGGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3ODY0OA==", "bodyText": "appMetaData", "url": "https://github.com/wso2/carbon-apimgt/pull/8697#discussion_r437978648", "createdAt": "2020-06-10T09:12:24Z", "author": {"login": "isharac"}, "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIKey.java", "diffHunk": "@@ -32,6 +32,7 @@\n     private String grantTypes;\n     private Object additionalProperties;\n     private String keyManager;\n+    private String appMetadata;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87928c20f9782743f6d706dcf224de1595498352"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODUwNzczOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIConsumerImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMzowNFrOGhsHmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMzowNFrOGhsHmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3OTAzNQ==", "bodyText": "formatting issue", "url": "https://github.com/wso2/carbon-apimgt/pull/8697#discussion_r437979035", "createdAt": "2020-06-10T09:13:04Z", "author": {"login": "isharac"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIConsumerImpl.java", "diffHunk": "@@ -4699,7 +4699,7 @@ public OAuthApplicationInfo updateAuthClient(String userId, String applicationNa\n             oauthAppRequest.getOAuthApplicationInfo().putAllAppAttributes(application.getApplicationAttributes());\n             //call update method.\n             OAuthApplicationInfo updatedAppInfo = keyManager.updateApplication(oauthAppRequest);\n-\n+            apiMgtDAO.updateApplicationKeyTypeMetaData(application.getId(),tokenType,keyManagerName,updatedAppInfo);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87928c20f9782743f6d706dcf224de1595498352"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODUwOTA2OnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/AbstractAPIManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMzoyN1rOGhsIfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxMzoyN1rOGhsIfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3OTI2Mw==", "bodyText": "need to format the code", "url": "https://github.com/wso2/carbon-apimgt/pull/8697#discussion_r437979263", "createdAt": "2020-06-10T09:13:27Z", "author": {"login": "isharac"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/AbstractAPIManager.java", "diffHunk": "@@ -3094,6 +3095,23 @@ protected String getSearchQuery(String searchQuery) throws APIManagementExceptio\n                 KeyManager keyManager = KeyManagerHolder.getKeyManagerInstance(tenantDomain, keyManagerName);\n                 if (keyManager != null) {\n                     OAuthApplicationInfo oAuthApplicationInfo = keyManager.retrieveApplication(consumerKey);\n+                    if (StringUtils.isNotEmpty(apiKey.getAppMetadata())){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87928c20f9782743f6d706dcf224de1595498352"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODUxNTI0OnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxNTowN1rOGhsMhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxNTowN1rOGhsMhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4MDI5NQ==", "bodyText": "why final here?\nAlso better to move the query to SQLConstants", "url": "https://github.com/wso2/carbon-apimgt/pull/8697#discussion_r437980295", "createdAt": "2020-06-10T09:15:07Z", "author": {"login": "isharac"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -8713,7 +8711,7 @@ public boolean isKeyManagerConfigurationExistByName(String name, String tenantDo\n     }\n \n     public Set<APIKey> getKeyMappingsFromApplicationId(int applicationId) throws APIManagementException{\n-        final String query = \"SELECT UUID,CONSUMER_KEY,KEY_MANAGER,KEY_TYPE,STATE FROM AM_APPLICATION_KEY_MAPPING \" +\n+        final String query = \"SELECT UUID,CONSUMER_KEY,KEY_MANAGER,KEY_TYPE,STATE,APP_INFO FROM AM_APPLICATION_KEY_MAPPING \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87928c20f9782743f6d706dcf224de1595498352"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODUyMjQwOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxNzoxMFrOGhsRIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxNzoxMFrOGhsRIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4MTQ3Mg==", "bodyText": "applicationId > 0 isn't it?", "url": "https://github.com/wso2/carbon-apimgt/pull/8697#discussion_r437981472", "createdAt": "2020-06-10T09:17:10Z", "author": {"login": "isharac"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -8804,6 +8809,43 @@ public String getKeyMappingIdFromApplicationIdKeyTypeAndKeyManager(int applicati\n         return null;\n     }\n \n+    /**\n+     * This method used to update Application metadata according to oauth app info\n+     * @param applicationId\n+     * @param keyType\n+     * @param keyManagerName\n+     * @param updatedAppInfo\n+     * @throws APIManagementException\n+     */\n+    public void updateApplicationKeyTypeMetaData(int applicationId, String keyType, String keyManagerName,\n+                                                 OAuthApplicationInfo updatedAppInfo) throws APIManagementException {\n+\n+        if (applicationId != -1 && updatedAppInfo != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87928c20f9782743f6d706dcf224de1595498352"}, "originalPosition": 100}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3352, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}