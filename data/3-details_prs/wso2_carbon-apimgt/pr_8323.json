{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0Nzg5NDUz", "number": 8323, "title": "Sample/Mock Payload Generation with Inline Script Reset Functionality", "bodyText": "Sample/Mock payloads defined in API definition is generated in Inline Prototyping\n\nIf the user edits the generated code the \"Reset\" button appears allowing users to reset the code back to the originally generated script.", "createdAt": "2020-03-06T12:12:47Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8323", "merged": true, "mergeCommit": {"oid": "11b5cb2e1ec0d44388755b717a0b1f0b7e029023"}, "closed": true, "closedAt": "2020-03-10T07:53:10Z", "author": {"login": "VinulaUthsara"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKqL0lgH2gAyMzg0Nzg5NDUzOjNkMzJmYmZhYjkzZTM1ZTE1NjZiMjNmMDQ4M2ZlNDVmZDcwZWE4ZGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMNur8AFqTM3MTczNTQ5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3d32fbfab93e35e1566b23f0483fe45fd70ea8db", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/3d32fbfab93e35e1566b23f0483fe45fd70ea8db", "committedDate": "2020-03-05T11:54:15Z", "message": "Changes made to OAS2Parser and OAS3Parser and OAS3Reader implementation added to APIserviceIMPL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39d147f5c9c01ee52fc43df9953dabbd6db6a5fa", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/39d147f5c9c01ee52fc43df9953dabbd6db6a5fa", "committedDate": "2020-03-05T11:57:07Z", "message": "Merge branch 'master' of https://github.com/wso2/carbon-apimgt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd47f0d9a28796cdbf522001e8507d4200a95a2", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/9bd47f0d9a28796cdbf522001e8507d4200a95a2", "committedDate": "2020-03-06T04:41:01Z", "message": "Removing comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1d5d2c12bb8a247d002563fcec9288ac2343d76", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/e1d5d2c12bb8a247d002563fcec9288ac2343d76", "committedDate": "2020-03-06T11:20:02Z", "message": "fixed empty scope issue for OAS3Parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/1537f61fda368c57f6fcfc728ce6106f8c7c78b9", "committedDate": "2020-03-06T12:01:00Z", "message": "commented code lines removed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMjc5MjEx", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#pullrequestreview-370279211", "createdAt": "2020-03-06T12:14:26Z", "commit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjoxNDoyNlrOFy2v6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjoxNzoxNVrOFy20Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDEyMA==", "bodyText": "Add class comment", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870120", "createdAt": "2020-03-06T12:14:26Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIResourceMediationPolicy.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.wso2.carbon.apimgt.api.model;\n+\n+public class APIResourceMediationPolicy {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDE4NQ==", "bodyText": "Add license header", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870185", "createdAt": "2020-03-06T12:14:36Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/model/APIResourceMediationPolicy.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.wso2.carbon.apimgt.api.model;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDM1NA==", "bodyText": "Use single imports instead of wildcard imports", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870354", "createdAt": "2020-03-06T12:15:01Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/definitions/OAS3Parser.java", "diffHunk": "@@ -60,11 +59,7 @@\n import org.wso2.carbon.apimgt.api.APIManagementException;\n import org.wso2.carbon.apimgt.api.ErrorItem;\n import org.wso2.carbon.apimgt.api.ExceptionCodes;\n-import org.wso2.carbon.apimgt.api.model.API;\n-import org.wso2.carbon.apimgt.api.model.APIProduct;\n-import org.wso2.carbon.apimgt.api.model.Scope;\n-import org.wso2.carbon.apimgt.api.model.SwaggerData;\n-import org.wso2.carbon.apimgt.api.model.URITemplate;\n+import org.wso2.carbon.apimgt.api.model.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDU0MQ==", "bodyText": "Define and use constants", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870541", "createdAt": "2020-03-06T12:15:30Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/definitions/OAS3Parser.java", "diffHunk": "@@ -149,14 +159,52 @@ public String generateExample(String apiDefinition) {\n                         }\n                         if (applicationJson == null && applicationXml == null) {\n                             setDefaultGeneratedResponse(genCode);\n+\n                         }\n                     }\n                 }\n                 genCode.append(responseSection);\n-                op.addExtension(\"x-mediation-script\", genCode);\n+                String finalGenCode = genCode.toString();\n+                apiResourceMediationPolicyObject.setContent(finalGenCode);\n+                op.addExtension(APIConstants.SWAGGER_X_MEDIATION_SCRIPT, genCode);\n+                apiResourceMediationPolicyList.add(apiResourceMediationPolicyObject);\n             }\n+\n+            checkAndSetEmptyScope(swagger);\n+            returnMap.put(\"SWAGGER\", Json.pretty(swagger));\n+            returnMap.put(\"policyList\", apiResourceMediationPolicyList);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDgxNQ==", "bodyText": "Use single imports", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870815", "createdAt": "2020-03-06T12:16:08Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -32,21 +32,7 @@\n import org.wso2.carbon.apimgt.api.ErrorHandler;\n import org.wso2.carbon.apimgt.api.ExceptionCodes;\n import org.wso2.carbon.apimgt.api.WorkflowStatus;\n-import org.wso2.carbon.apimgt.api.model.API;\n-import org.wso2.carbon.apimgt.api.model.APICategory;\n-import org.wso2.carbon.apimgt.api.model.APIIdentifier;\n-import org.wso2.carbon.apimgt.api.model.APIProduct;\n-import org.wso2.carbon.apimgt.api.model.APIProductIdentifier;\n-import org.wso2.carbon.apimgt.api.model.APIProductResource;\n-import org.wso2.carbon.apimgt.api.model.APIStatus;\n-import org.wso2.carbon.apimgt.api.model.APIStateChangeResponse;\n-import org.wso2.carbon.apimgt.api.model.CORSConfiguration;\n-import org.wso2.carbon.apimgt.api.model.Label;\n-import org.wso2.carbon.apimgt.api.model.LifeCycleEvent;\n-import org.wso2.carbon.apimgt.api.model.ResourcePath;\n-import org.wso2.carbon.apimgt.api.model.Scope;\n-import org.wso2.carbon.apimgt.api.model.Tier;\n-import org.wso2.carbon.apimgt.api.model.URITemplate;\n+import org.wso2.carbon.apimgt.api.model.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MDkxOQ==", "bodyText": "Method comments", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388870919", "createdAt": "2020-03-06T12:16:23Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -268,6 +254,39 @@ public static API fromDTOtoAPI(APIDTO dto, String provider) throws APIManagement\n         return model;\n     }\n \n+    /**\n+     *\n+     *\n+     * @param mockPayloads\n+     * @return\n+     * @throws APIManagementException\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MTAxNw==", "bodyText": "Add proper method comments", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388871017", "createdAt": "2020-03-06T12:16:35Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/utils/mappings/APIMappingUtil.java", "diffHunk": "@@ -268,6 +254,39 @@ public static API fromDTOtoAPI(APIDTO dto, String provider) throws APIManagement\n         return model;\n     }\n \n+    /**\n+     *\n+     *\n+     * @param mockPayloads\n+     * @return\n+     * @throws APIManagementException\n+     */\n+    public static MockResponsePayloadListDTO fromMockPayloadsToListDTO (List<APIResourceMediationPolicy> mockPayloads)\n+            throws APIManagementException {\n+\n+        MockResponsePayloadListDTO mockResponsePayloadListDTO = new MockResponsePayloadListDTO();\n+        List<MockResponsePayloadInfoDTO> mockResponsePayloadInfoDTOS = mockResponsePayloadListDTO.getList();\n+        for (APIResourceMediationPolicy apiResourceMediationPolicy : mockPayloads){\n+            mockResponsePayloadInfoDTOS.add(fromMockPayloadToDTO(apiResourceMediationPolicy));\n+        }\n+        return mockResponsePayloadListDTO;\n+    }\n+\n+    /**\n+     *\n+     *\n+     * @param model\n+     * @return\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3MTIzOQ==", "bodyText": "Remove", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r388871239", "createdAt": "2020-03-06T12:17:15Z", "author": {"login": "malinthaprasan"}, "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Endpoints/Prototype/GenericResource.jsx", "diffHunk": "@@ -79,10 +87,18 @@ function GenericResource(props) {\n                 backgroundColor: Utils.hexToRGBA(chipColor, 0.1),\n                 border: `${chipColor} 1px solid`,\n             },\n+            scriptResetButton: {\n+                display: 'flex',\n+                justifyContent: 'space-between',\n+                marginBottom: '10px',\n+            },\n+\n         };\n     });\n \n     const classes = useStyles();\n+    console.log(originalScript);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1537f61fda368c57f6fcfc728ce6106f8c7c78b9"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2433e78cac66f999ecd97606ef0266e73f964d91", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/2433e78cac66f999ecd97606ef0266e73f964d91", "committedDate": "2020-03-10T05:59:47Z", "message": "edited method comments, class comments, licence headers and constants"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNzAzMjky", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#pullrequestreview-371703292", "createdAt": "2020-03-10T06:21:46Z", "commit": {"oid": "2433e78cac66f999ecd97606ef0266e73f964d91"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwNjoyMTo0NlrOF0CrCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwNjoyMTo0NlrOF0CrCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDExNDA1OA==", "bodyText": "Changed by mistake?", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#discussion_r390114058", "createdAt": "2020-03-10T06:21:46Z", "author": {"login": "malinthaprasan"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/resources/publisher-api.yaml", "diffHunk": "@@ -8995,7 +9053,7 @@ definitions:\n   ThreatProtectionPolicy:\n     title: \"Threat Protection Policy Schema\"\n     required:\n-      - name\n+      - nameresource", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2433e78cac66f999ecd97606ef0266e73f964d91"}, "originalPosition": 89}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16a5b55e586e5a87b5fa6dad7943de0a1fe2d7cd", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/16a5b55e586e5a87b5fa6dad7943de0a1fe2d7cd", "committedDate": "2020-03-10T06:43:26Z", "message": "removing mistake in publisher-api.yaml (ThreatProtectionPolicy)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1babf667de9c64d14062c75b6431ce9eaa5a8c2e", "author": {"user": {"login": "VinulaUthsara", "name": "Vinula Uthsara "}}, "url": "https://github.com/wso2/carbon-apimgt/commit/1babf667de9c64d14062c75b6431ce9eaa5a8c2e", "committedDate": "2020-03-10T06:50:06Z", "message": "wildcard import in OAS2Parser fixed to single imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNzM1NDkz", "url": "https://github.com/wso2/carbon-apimgt/pull/8323#pullrequestreview-371735493", "createdAt": "2020-03-10T07:52:56Z", "commit": {"oid": "1babf667de9c64d14062c75b6431ce9eaa5a8c2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2964, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}