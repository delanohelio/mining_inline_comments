{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTQyNTE4", "number": 8970, "title": "Download Tenant theme feature", "bodyText": "This PR includes,\n\nFixes wso2/product-apim#8659\nDownload Tenant theme feature", "createdAt": "2020-07-13T09:48:55Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8970", "merged": true, "mergeCommit": {"oid": "3cdd340a812a4ac2ca6f10059f235537a8f12db5"}, "closed": true, "closedAt": "2020-07-13T11:33:51Z", "author": {"login": "kavishkafernando"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0eMMggH2gAyNDQ4MTQyNTE4OjVhMzFiZGU1MGRmZmNiYmIwNDI0NDZjZGI2YzIxMzMwNDYwNDZhMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0fBW2gH2gAyNDQ4MTQyNTE4OjU4YzE0OWExNDBjOTVjNjBkN2M0NTQyMGIyMWRkMWIwYjNiYmYxNjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5a31bde50dffcbbb042446cdb6c2133046046a28", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/5a31bde50dffcbbb042446cdb6c2133046046a28", "committedDate": "2020-07-13T09:40:37Z", "message": "Download Tenant theme feature"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "committedDate": "2020-07-13T09:48:37Z", "message": "Fix i18n message id"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MTE5ODY4", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#pullrequestreview-447119868", "createdAt": "2020-07-13T10:16:37Z", "commit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxNjozN1rOGwiRAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxNjozN1rOGwiRAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NjI0Mw==", "bodyText": "Do we need to initialize the state with an empty string ?", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453546243", "createdAt": "2020-07-13T10:16:37Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MTIwODE2", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#pullrequestreview-447120816", "createdAt": "2020-07-13T10:17:57Z", "commit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxNzo1N1rOGwiT8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxNzo1N1rOGwiT8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0Njk5Mw==", "bodyText": "Why do we need to remove the first character?", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453546993", "createdAt": "2020-07-13T10:17:57Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');\n     const [isFileAccepted, setIsFileAccepted] = useState(false);\n-    const [isUplaodUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n-\n+    const [isUploadUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n+    const intl = useIntl();\n+    const restApi = new API();\n \n     const onDrop = (acceptedFile) => {\n         setIsFileAccepted(true);\n         setThemeFile(acceptedFile[0]);\n     };\n \n+    useEffect(() => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            const tenantFileName = response.headers['content-disposition'].split('filename=')[1];\n+            setFileName(tenantFileName.slice(1, -1));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MTIxNzkw", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#pullrequestreview-447121790", "createdAt": "2020-07-13T10:19:21Z", "commit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxOToyMVrOGwiWxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMDoxOToyMVrOGwiWxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NzcxNw==", "bodyText": "We can simplify this as\ntenantThemeContent.then(Utils.forceDownload)\n\nno need to create a lambda/arrow function there", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453547717", "createdAt": "2020-07-13T10:19:21Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');\n     const [isFileAccepted, setIsFileAccepted] = useState(false);\n-    const [isUplaodUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n-\n+    const [isUploadUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n+    const intl = useIntl();\n+    const restApi = new API();\n \n     const onDrop = (acceptedFile) => {\n         setIsFileAccepted(true);\n         setThemeFile(acceptedFile[0]);\n     };\n \n+    useEffect(() => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            const tenantFileName = response.headers['content-disposition'].split('filename=')[1];\n+            setFileName(tenantFileName.slice(1, -1));\n+        });\n+    }, []);\n+\n+    /**\n+     * Downloads Tenant Theme ZIP file.\n+     *\n+     */\n+    const handleDownloadTenantTheme = () => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            Utils.forceDownload(response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "originalPosition": 87}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MTIyMTEy", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#pullrequestreview-447122112", "createdAt": "2020-07-13T10:19:50Z", "commit": {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d41afa1a879af3a0c1304795811514841563a38", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/2d41afa1a879af3a0c1304795811514841563a38", "committedDate": "2020-07-13T10:37:04Z", "message": "Fix comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58c149a140c95c60d7c45420b21dd1b0b3bbf164", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/58c149a140c95c60d7c45420b21dd1b0b3bbf164", "committedDate": "2020-07-13T10:38:41Z", "message": "Fix comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2570, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}