{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMjg2MTQ1", "number": 8549, "title": "[Admin REST API] - API to update block condition status", "bodyText": "Fix wso2/product-apim#8033 related to wso2/product-apim#7954", "createdAt": "2020-05-21T10:52:48Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8549", "merged": true, "mergeCommit": {"oid": "d8dd2bf23eaf01357e67066a1ae12bd77841df02"}, "closed": true, "closedAt": "2020-05-22T04:14:28Z", "author": {"login": "Meruja"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjbX4OgH2gAyNDIxMjg2MTQ1OmI3NmJkMzZjNGE0ZjkxZmFjZWRkYWNjMDFjMDJlZjhlZGYwMDgzYmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjqWb4gFqTQxNjYzNjkwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b76bd36c4a4f91faceddacc01c02ef8edf0083ba", "author": {"user": {"login": "Meruja", "name": "Meruja Selvamanikkam"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b76bd36c4a4f91faceddacc01c02ef8edf0083ba", "committedDate": "2020-05-21T10:46:57Z", "message": "Added REST API to update condition status and reformatted the code."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca", "author": {"user": {"login": "Meruja", "name": "Meruja Selvamanikkam"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca", "committedDate": "2020-05-21T10:51:50Z", "message": "Optimised unused imports."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MDYyMTUw", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#pullrequestreview-416062150", "createdAt": "2020-05-21T11:09:48Z", "commit": {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMTowOTo0OFrOGYu-vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMTowOTo0OFrOGYu-vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU4ODczMg==", "bodyText": "Don't we need to throw 404 - handleResourceNotFoundError within else part to handle the case if the condition does not exist", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#discussion_r428588732", "createdAt": "2020-05-21T11:09:48Z", "author": {"login": "vithu30"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/ThrottlingApiServiceImpl.java", "diffHunk": "@@ -979,6 +987,48 @@ public Response throttlingBlacklistConditionIdDelete(String conditionId, String\n         return null;\n     }\n \n+    /**\n+     * Updates an existing condition status of a blocking condition\n+     *\n+     * @param conditionId       Id of the block condition\n+     * @param body              content to update\n+     * @param contentType       Content-Type header\n+     * @param ifMatch           If-Match header value\n+     * @param ifUnmodifiedSince If-Unmodified-Since header value\n+     * @return 200 response if successful\n+     */\n+    @Override\n+    public Response throttlingBlacklistConditionIdPatch(String conditionId, BlockingConditionStatusDTO body,\n+                                                        String contentType, String ifMatch, String ifUnmodifiedSince,\n+                                                        MessageContext messageContext) {\n+        try {\n+            APIProvider apiProvider = RestApiUtil.getLoggedInUserProvider();\n+            String username = RestApiUtil.getLoggedInUsername();\n+\n+            //This will give BlockConditionNotFoundException if there's no block condition exists with UUID\n+            BlockConditionsDTO existingCondition = apiProvider.getBlockConditionByUUID(conditionId);\n+            if (!RestApiAdminUtils.isBlockConditionAccessibleToUser(username, existingCondition)) {\n+                RestApiUtil.handleAuthorizationFailure(RestApiConstants.RESOURCE_BLOCK_CONDITION, conditionId, log);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca"}, "originalPosition": 112}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NjM0NTgy", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#pullrequestreview-416634582", "createdAt": "2020-05-22T04:05:06Z", "commit": {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NjM2OTAx", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#pullrequestreview-416636901", "createdAt": "2020-05-22T04:13:57Z", "commit": {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2777, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}