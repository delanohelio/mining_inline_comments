{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NTI1ODQy", "number": 8754, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMjoyMToyMVrOEGK58Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODoxOTo0OFrOEGPvvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTA1NTg1OnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMjoyMToyMVrOGkzVvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzo1MTo0MFrOGk57DA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI0MzA3MQ==", "bodyText": "don't we hv to send subscription related events?", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441243071", "createdAt": "2020-06-17T02:21:21Z", "author": {"login": "chamilaadhi"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2291,6 +2292,12 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n             apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n             );\n         }\n+        int apiId = apiMgtDAO.getAPIID(api.getId(), null);\n+        APIEvent apiEvent = new APIEvent(UUID.randomUUID().toString(), System.currentTimeMillis(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9889290a078c42797f72abc243ed1077a77d43c0"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM1MDkyNA==", "bodyText": "resolved", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441350924", "createdAt": "2020-06-17T07:51:40Z", "author": {"login": "CrowleyRajapakse"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2291,6 +2292,12 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n             apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n             );\n         }\n+        int apiId = apiMgtDAO.getAPIID(api.getId(), null);\n+        APIEvent apiEvent = new APIEvent(UUID.randomUUID().toString(), System.currentTimeMillis(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI0MzA3MQ=="}, "originalCommit": {"oid": "9889290a078c42797f72abc243ed1077a77d43c0"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTg0ODkyOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODoxOTo0OFrOGk68ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwOTowMjoyNlrOGk8ljg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM2NzcxNQ==", "bodyText": "I don't think you have to pass the tenant Id , you could get the tenant id from the API provider using APIUtil.getTenantId(APIUtil.replaceEmailDomainBack(api.getId().getProviderName())", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441367715", "createdAt": "2020-06-17T08:19:48Z", "author": {"login": "chamilaadhi"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2288,8 +2289,7 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n         Collections.sort(sortedAPIs, comparator);\n         for (int i = sortedAPIs.size() - 1; i >= 0; i--) {\n             String oldVersion = sortedAPIs.get(i).getId().getVersion();\n-            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n-            );\n+            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion, tenantId);\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2642272efaca3507463a56717724c061565ef25"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5NDU3NA==", "bodyText": "resolved", "url": "https://github.com/wso2/carbon-apimgt/pull/8754#discussion_r441394574", "createdAt": "2020-06-17T09:02:26Z", "author": {"login": "CrowleyRajapakse"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIProviderImpl.java", "diffHunk": "@@ -2288,8 +2289,7 @@ public void makeAPIKeysForwardCompatible(API api) throws APIManagementException\n         Collections.sort(sortedAPIs, comparator);\n         for (int i = sortedAPIs.size() - 1; i >= 0; i--) {\n             String oldVersion = sortedAPIs.get(i).getId().getVersion();\n-            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion\n-            );\n+            apiMgtDAO.makeKeysForwardCompatible(new ApiTypeWrapper(api), oldVersion, tenantId);\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM2NzcxNQ=="}, "originalCommit": {"oid": "c2642272efaca3507463a56717724c061565ef25"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3268, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}