{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMTAxMDc1", "number": 8138, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo0ODowMVrODchMQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOTo0MzoyMVrODc6dhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMjMwNTMwOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo0ODowMVrOFkmUtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNTowMToyOFrOFkmcPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMDk0OA==", "bodyText": "What does this flag does? Hope if someone update the sequence it won't get affected.", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373920948", "createdAt": "2020-02-03T04:48:01Z", "author": {"login": "harsha89"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "diffHunk": "@@ -2828,6 +2832,9 @@ public Response apisApiIdSwaggerPut(String apiId, String apiDefinition, String u\n                 apiDefinition = validationResponse.getJsonContent();\n             }\n             String updatedSwagger = updateSwagger(apiId, apiDefinition);\n+            if (isSoapToRestConvertedAPI) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMjg3OQ==", "bodyText": "When updating swagger definition, for REST APIs created from SOAP back-end, we need to update the the generated sequences. This flag is used to differentiate the APIs created from WSDL.\nYes, if someone updates the sequence directly, that won't get affected as it uses a different API - [1]\n[1] https://github.com/wso2/carbon-apimgt/blob/master/components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java#L2695", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373922879", "createdAt": "2020-02-03T05:01:28Z", "author": {"login": "vithu30"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "diffHunk": "@@ -2828,6 +2832,9 @@ public Response apisApiIdSwaggerPut(String apiId, String apiDefinition, String u\n                 apiDefinition = validationResponse.getJsonContent();\n             }\n             String updatedSwagger = updateSwagger(apiId, apiDefinition);\n+            if (isSoapToRestConvertedAPI) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMDk0OA=="}, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMjMwOTU5OnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/SequenceGenerator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo1MjozM1rOFkmXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMTo0NDo1NlrOFmYTiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMTYwMQ==", "bodyText": "Is this split correct? \"[{]\" or should it be \"[{\"", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373921601", "createdAt": "2020-02-03T04:52:33Z", "author": {"login": "tharikaGitHub"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/SequenceGenerator.java", "diffHunk": "@@ -187,8 +191,23 @@ public static void generateSequencesFromSwagger(String swaggerStr, APIIdentifier\n                     String inSequence = template.getMappingInSequence(sequenceMap, operationId, soapAction,\n                             namespace, soapNamespace, arraySequenceElements);\n                     String outSequence = template.getMappingOutSequence();\n-                    saveApiSequences(apiIdentifier, inSequence, outSequence, httpMethod.toString().toLowerCase(),\n-                            pathName);\n+                    if (isResourceFromWSDL) {\n+                        Pattern pattern = Pattern.compile(\"[{}]\");\n+                        Matcher hasSpecialCharacters = pattern.matcher(pathName);\n+                        if (hasSpecialCharacters.find()) {\n+                            String resourcePathName = pathName.split(\"[{]\")[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc4ODQyNA==", "bodyText": "yes, it is added to escape the special character \"{\"", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r375788424", "createdAt": "2020-02-06T11:44:56Z", "author": {"login": "vithu30"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/SequenceGenerator.java", "diffHunk": "@@ -187,8 +191,23 @@ public static void generateSequencesFromSwagger(String swaggerStr, APIIdentifier\n                     String inSequence = template.getMappingInSequence(sequenceMap, operationId, soapAction,\n                             namespace, soapNamespace, arraySequenceElements);\n                     String outSequence = template.getMappingOutSequence();\n-                    saveApiSequences(apiIdentifier, inSequence, outSequence, httpMethod.toString().toLowerCase(),\n-                            pathName);\n+                    if (isResourceFromWSDL) {\n+                        Pattern pattern = Pattern.compile(\"[{}]\");\n+                        Matcher hasSpecialCharacters = pattern.matcher(pathName);\n+                        if (hasSpecialCharacters.find()) {\n+                            String resourcePathName = pathName.split(\"[{]\")[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMTYwMQ=="}, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNjQ0NTQ4OnYy", "diffSide": "RIGHT", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/Resources.jsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOTo0MzoyMVrOFlNq3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMjo1ODo1MFrOFmaKAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU2NTU5Ng==", "bodyText": "Ideally, we shouldn't need to update the UI. Let's try to fix the response from the REST API to alter the resource path. Changing the resource name like this in the UI is hacky.", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r374565596", "createdAt": "2020-02-04T09:43:21Z", "author": {"login": "malinthaprasan"}, "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/Resources.jsx", "diffHunk": "@@ -435,6 +436,13 @@ export default function Resources(props) {\n                                     alignItems='stretch'\n                                 >\n                                     {Object.entries(verbObject).map(([verb, operation]) => {\n+                                        let resourcePathName = target.slice(1);\n+                                        if (regexPattern.test(resourcePathName)) {\n+                                            [resourcePathName] = resourcePathName.split('{');\n+                                            if (resourcePathName.endsWith('/')) {\n+                                                resourcePathName = resourcePathName.slice(0, -1);\n+                                            }\n+                                        }\n                                         return (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgxODc1Mw==", "bodyText": "As suggested, changed the response from back-end, so that it can be rendered in UI without any changes.. :)", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r375818753", "createdAt": "2020-02-06T12:58:50Z", "author": {"login": "vithu30"}, "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/Resources.jsx", "diffHunk": "@@ -435,6 +436,13 @@ export default function Resources(props) {\n                                     alignItems='stretch'\n                                 >\n                                     {Object.entries(verbObject).map(([verb, operation]) => {\n+                                        let resourcePathName = target.slice(1);\n+                                        if (regexPattern.test(resourcePathName)) {\n+                                            [resourcePathName] = resourcePathName.split('{');\n+                                            if (resourcePathName.endsWith('/')) {\n+                                                resourcePathName = resourcePathName.slice(0, -1);\n+                                            }\n+                                        }\n                                         return (", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU2NTU5Ng=="}, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2840, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}