{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2NDY0NzU4", "number": 8630, "title": "Add DB script changes related to shared scopes", "bodyText": "", "createdAt": "2020-06-02T09:30:51Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8630", "merged": true, "mergeCommit": {"oid": "56e40d8dafeab4751b1c58e4d8e26d90ff269936"}, "closed": true, "closedAt": "2020-06-04T05:50:22Z", "author": {"login": "dushaniw"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm88IJgH2gAyNDI2NDY0NzU4OmRiZWY4MTk3NDFkOTZmMzIwZTllZjdjZDdkNTRmYzYxNWY3NzZmNGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn3hQfAFqTQyNDExOTc5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dbef819741d96f320e9ef7cd7d54fc615f776f4d", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/dbef819741d96f320e9ef7cd7d54fc615f776f4d", "committedDate": "2020-06-01T09:35:11Z", "message": "add shared scopes schema changes to mysql script."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7858264c0f667c30d0039c29d11212f67aaca89a", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/7858264c0f667c30d0039c29d11212f67aaca89a", "committedDate": "2020-06-01T10:07:27Z", "message": "add shared scopes schema changes to postgresql script."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebdab3e2b325b4c356bce34e4ef68fb5cb57c984", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/ebdab3e2b325b4c356bce34e4ef68fb5cb57c984", "committedDate": "2020-06-01T10:26:14Z", "message": "add shared scopes schema changes to mssql script."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c65602a83dd99a00ab145895cf93b981f9630d8", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/0c65602a83dd99a00ab145895cf93b981f9630d8", "committedDate": "2020-06-01T10:30:31Z", "message": "add shared scopes schema changes to myssql cluster script."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3938dde78f505205999046bfaec93572d83219c", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/e3938dde78f505205999046bfaec93572d83219c", "committedDate": "2020-06-03T13:11:59Z", "message": "add db2 and oracle scripts for shared scopes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNTY0NzM3", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#pullrequestreview-423564737", "createdAt": "2020-06-03T13:42:16Z", "commit": {"oid": "e3938dde78f505205999046bfaec93572d83219c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMzo0MjoxNlrOGecaGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMzo0MjozNlrOGecbDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NTg5Nw==", "bodyText": "remove this", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434575897", "createdAt": "2020-06-03T13:42:16Z", "author": {"login": "tharindu1st"}, "path": "features/apimgt/org.wso2.carbon.apimgt.core.feature/src/main/resources/sql/db2.sql", "diffHunk": "@@ -2018,6 +2017,23 @@ CREATE TABLE AM_API_URL_MAPPING (\n             PRIMARY KEY (URL_MAPPING_ID)\n )/\n \n+CREATE TABLE AM_API_RESOURCE_SCOPE_MAPPING (\n+            SCOPE_NAME VARCHAR(255) NOT NULL,\n+            URL_MAPPING_ID INTEGER NOT NULL,\n+            TENANT_ID INTEGER NOT NULL,\n+            FOREIGN KEY (URL_MAPPING_ID) REFERENCES AM_API_URL_MAPPING(URL_MAPPING_ID) ON DELETE CASCADE,\n+            PRIMARY KEY(SCOPE_NAME, URL_MAPPING_ID)\n+)/\n+\n+CREATE TABLE AM_KM_MGT_APPLICATION (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3938dde78f505205999046bfaec93572d83219c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NjE0MQ==", "bodyText": "same goes here", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434576141", "createdAt": "2020-06-03T13:42:36Z", "author": {"login": "tharindu1st"}, "path": "features/apimgt/org.wso2.carbon.apimgt.core.feature/src/main/resources/sql/mssql.sql", "diffHunk": "@@ -1439,6 +1438,27 @@ CREATE TABLE AM_API_URL_MAPPING (\n     PRIMARY KEY (URL_MAPPING_ID)\n );\n \n+IF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].[AM_API_RESOURCE_SCOPE_MAPPING]') AND TYPE IN (N'U'))\n+\n+CREATE TABLE AM_API_RESOURCE_SCOPE_MAPPING (\n+    SCOPE_NAME VARCHAR(255) NOT NULL,\n+    URL_MAPPING_ID INTEGER NOT NULL,\n+    TENANT_ID INTEGER NOT NULL,\n+    FOREIGN KEY (URL_MAPPING_ID) REFERENCES AM_API_URL_MAPPING(URL_MAPPING_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(SCOPE_NAME, URL_MAPPING_ID)\n+);\n+\n+IF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].[AM_KM_MGT_APPLICATION]') AND TYPE IN (N'U'))\n+\n+CREATE TABLE AM_KM_MGT_APPLICATION (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3938dde78f505205999046bfaec93572d83219c"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62603d47e6f6a7f6dc79870bd2bceba60449f37d", "author": {"user": {"login": "dushaniw", "name": "Dushani Wellappili"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/62603d47e6f6a7f6dc79870bd2bceba60449f37d", "committedDate": "2020-06-03T15:04:33Z", "message": "remove AM_KM_MGT_APPLICATION"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTE5Nzky", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#pullrequestreview-424119792", "createdAt": "2020-06-04T05:50:14Z", "commit": {"oid": "62603d47e6f6a7f6dc79870bd2bceba60449f37d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2690, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}