{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyODQxNDEw", "number": 8163, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNToxMjowMFrODeVYPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNToxNDoxM1rODeVZGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMTM0MTQxOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNToxMjowMFrOFnaYuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNjozODoxOVrOFnbX_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3MTA5Ng==", "bodyText": "Please check whether the length is exceeded?", "url": "https://github.com/wso2/carbon-apimgt/pull/8163#discussion_r376871096", "createdAt": "2020-02-10T05:12:00Z", "author": {"login": "ruks"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "diffHunk": "@@ -386,11 +388,55 @@ private void addModelDefinition(Node current, ModelImpl model, String type, bool\n                             //do nothing\n                         } else if (model.getProperties().containsKey(element)) {\n                             parentProp = model.getProperties().get(element);\n-                            if (SOAPToRESTConstants.RESTRICTION_ATTR.equals(type) && pos == elements.length - 1) {\n-                                model.getProperties().remove(element);\n-                                parentProp = createPropertyFromNode(current, true);\n-                                parentProp.setName(element);\n-                                model.addProperty(element, parentProp);\n+                            if (pos == elements.length - 1) {\n+                                if (SOAPToRESTConstants.RESTRICTION_ATTR.equals(type)) {\n+                                    model.getProperties().remove(element);\n+                                    parentProp = createPropertyFromNode(current, true);\n+                                    parentProp.setName(element);\n+                                    model.addProperty(element, parentProp);\n+                                } else {\n+                                    if (isChildNode(current, prevNode)) {\n+                                        int index = Arrays.asList(elements).indexOf(element);\n+                                        Property parentProperty = null;\n+                                        String parentName = \"\";\n+                                        for (int i = 1; i < index; i++) {\n+                                            parentProperty = model.getProperties().get(elements[index - i]);\n+                                            if (parentProperty != null) {\n+                                                model.getProperties().remove(element);\n+                                                parentName = elements[index - i];\n+                                                break;\n+                                            }\n+                                        }\n+                                        if (parentProperty instanceof ArrayProperty) {\n+                                            if (((ArrayProperty) parentProperty).getItems() != null) {\n+                                                if (parentName.equals(((ArrayProperty) parentProperty).getItems()\n+                                                        .getName())) {\n+                                                    Property objectProperty = new ObjectProperty();\n+                                                    Map propertiesMap = new HashMap();\n+                                                    propertiesMap.put(element, createPropertyFromNode(current, true));\n+                                                    ((ObjectProperty) objectProperty).setProperties(propertiesMap);\n+                                                    ((ArrayProperty) parentProperty).setItems(objectProperty);\n+                                                    parentProp = parentProperty;\n+                                                }\n+                                            } else {\n+                                                ((ArrayProperty) parentProperty)\n+                                                        .setItems(createPropertyFromNode(current, true));\n+                                            }\n+                                        } else if (parentProperty instanceof ObjectProperty) {\n+                                            if (((ObjectProperty) parentProperty).getProperties() != null) {\n+                                                if ((((ObjectProperty) parentProperty).getProperties()).get(parentName) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d24d878130e7f453e981d3d3e2790c535c1554"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg4NzI5Mw==", "bodyText": "Fixed", "url": "https://github.com/wso2/carbon-apimgt/pull/8163#discussion_r376887293", "createdAt": "2020-02-10T06:38:19Z", "author": {"login": "vithu30"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "diffHunk": "@@ -386,11 +388,55 @@ private void addModelDefinition(Node current, ModelImpl model, String type, bool\n                             //do nothing\n                         } else if (model.getProperties().containsKey(element)) {\n                             parentProp = model.getProperties().get(element);\n-                            if (SOAPToRESTConstants.RESTRICTION_ATTR.equals(type) && pos == elements.length - 1) {\n-                                model.getProperties().remove(element);\n-                                parentProp = createPropertyFromNode(current, true);\n-                                parentProp.setName(element);\n-                                model.addProperty(element, parentProp);\n+                            if (pos == elements.length - 1) {\n+                                if (SOAPToRESTConstants.RESTRICTION_ATTR.equals(type)) {\n+                                    model.getProperties().remove(element);\n+                                    parentProp = createPropertyFromNode(current, true);\n+                                    parentProp.setName(element);\n+                                    model.addProperty(element, parentProp);\n+                                } else {\n+                                    if (isChildNode(current, prevNode)) {\n+                                        int index = Arrays.asList(elements).indexOf(element);\n+                                        Property parentProperty = null;\n+                                        String parentName = \"\";\n+                                        for (int i = 1; i < index; i++) {\n+                                            parentProperty = model.getProperties().get(elements[index - i]);\n+                                            if (parentProperty != null) {\n+                                                model.getProperties().remove(element);\n+                                                parentName = elements[index - i];\n+                                                break;\n+                                            }\n+                                        }\n+                                        if (parentProperty instanceof ArrayProperty) {\n+                                            if (((ArrayProperty) parentProperty).getItems() != null) {\n+                                                if (parentName.equals(((ArrayProperty) parentProperty).getItems()\n+                                                        .getName())) {\n+                                                    Property objectProperty = new ObjectProperty();\n+                                                    Map propertiesMap = new HashMap();\n+                                                    propertiesMap.put(element, createPropertyFromNode(current, true));\n+                                                    ((ObjectProperty) objectProperty).setProperties(propertiesMap);\n+                                                    ((ArrayProperty) parentProperty).setItems(objectProperty);\n+                                                    parentProp = parentProperty;\n+                                                }\n+                                            } else {\n+                                                ((ArrayProperty) parentProperty)\n+                                                        .setItems(createPropertyFromNode(current, true));\n+                                            }\n+                                        } else if (parentProperty instanceof ObjectProperty) {\n+                                            if (((ObjectProperty) parentProperty).getProperties() != null) {\n+                                                if ((((ObjectProperty) parentProperty).getProperties()).get(parentName) != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3MTA5Ng=="}, "originalCommit": {"oid": "c3d24d878130e7f453e981d3d3e2790c535c1554"}, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMTM0MzYwOnYy", "diffSide": "RIGHT", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNToxNDoxM1rOFnaaCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNjozODozNFrOFnbYLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3MTQzNQ==", "bodyText": "can we just return true? If it is true, no need to loop remaining objects right?", "url": "https://github.com/wso2/carbon-apimgt/pull/8163#discussion_r376871435", "createdAt": "2020-02-10T05:14:13Z", "author": {"login": "ruks"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "diffHunk": "@@ -448,6 +522,21 @@ private void addModelDefinition(Node current, ModelImpl model, String type, bool\n         }\n     }\n \n+    private boolean isChildNode(Node current, Node prevNode) {\n+        boolean isChild = false;\n+        if (prevNode.hasChildNodes()) {\n+            NodeList childNodes = prevNode.getChildNodes();\n+            for (int i = 0; i < childNodes.getLength(); i++) {\n+                if (childNodes.item(i).getAttributes() != null && current.getAttributes()\n+                        .getNamedItem(SOAPToRESTConstants.NAME_ATTRIBUTE).getNodeValue().equals(childNodes.item(i)\n+                                .getAttributes().getNamedItem(SOAPToRESTConstants.NAME_ATTRIBUTE).getNodeValue())) {\n+                    isChild = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d24d878130e7f453e981d3d3e2790c535c1554"}, "originalPosition": 178}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg4NzM0Mw==", "bodyText": "Yes..Fixed.", "url": "https://github.com/wso2/carbon-apimgt/pull/8163#discussion_r376887343", "createdAt": "2020-02-10T06:38:34Z", "author": {"login": "vithu30"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/WSDL11SOAPOperationExtractor.java", "diffHunk": "@@ -448,6 +522,21 @@ private void addModelDefinition(Node current, ModelImpl model, String type, bool\n         }\n     }\n \n+    private boolean isChildNode(Node current, Node prevNode) {\n+        boolean isChild = false;\n+        if (prevNode.hasChildNodes()) {\n+            NodeList childNodes = prevNode.getChildNodes();\n+            for (int i = 0; i < childNodes.getLength(); i++) {\n+                if (childNodes.item(i).getAttributes() != null && current.getAttributes()\n+                        .getNamedItem(SOAPToRESTConstants.NAME_ATTRIBUTE).getNodeValue().equals(childNodes.item(i)\n+                                .getAttributes().getNamedItem(SOAPToRESTConstants.NAME_ATTRIBUTE).getNodeValue())) {\n+                    isChild = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3MTQzNQ=="}, "originalCommit": {"oid": "c3d24d878130e7f453e981d3d3e2790c535c1554"}, "originalPosition": 178}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2857, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}