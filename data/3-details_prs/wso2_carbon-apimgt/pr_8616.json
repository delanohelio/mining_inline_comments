{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1ODYzMzIz", "number": 8616, "title": "Moving Blacklist policies to a new page", "bodyText": "This PR includes the following changes\n\nMoving Blacklist policies to a new page\nPut the \"The following sample siddhi query ...\" text into an infobox\nAdd key template helper text\nValidate Key Templates from UI\n\nDefine policy:\n\nEdit policy:", "createdAt": "2020-06-01T09:36:43Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8616", "merged": true, "mergeCommit": {"oid": "bb0f3e2554e89cf21673fc1dc540f626ffa3031d"}, "closed": true, "closedAt": "2020-06-01T16:26:07Z", "author": {"login": "kavishkafernando"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm424bAH2gAyNDI1ODYzMzIzOmE0NzY1NTkwYzc3N2EwNmZmZjMyZDdjYjQ5MDZjMjgwYzYwMTQ2NGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcm-RtsAH2gAyNDI1ODYzMzIzOjRlMTQ0MTgyMzNkMDUyZjdhYjdlNGUzMDUyY2M2ZWM1YTY1NDE2MDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a4765590c777a06fff32d7cb4906c280c601464d", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a4765590c777a06fff32d7cb4906c280c601464d", "committedDate": "2020-06-01T04:49:50Z", "message": "Moving Blacklist policies to a new page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6cdd993eafad31f66b9c8b3363354d2c5282144", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c6cdd993eafad31f66b9c8b3363354d2c5282144", "committedDate": "2020-06-01T09:31:43Z", "message": "Switch Blacklist policies to full page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/b149659284a8d1a5aecaccd61f1d9c645bae3fca", "committedDate": "2020-06-01T09:46:17Z", "message": "Remove commented import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzIyMDU1", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#pullrequestreview-421722055", "createdAt": "2020-06-01T09:50:48Z", "commit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOTo1MDo0OFrOGdE4ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwOTo1MDo0OFrOGdE4ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE0MTk1NQ==", "bodyText": "I think we can set this state at the state initialization time\ni:e\nconst [editMode, setIsEditMode] = useState(policyId !== 'create');", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433141955", "createdAt": "2020-06-01T09:50:48Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6317b1b8dd9637f944977861b4eda0eaaf8b51a1", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/6317b1b8dd9637f944977861b4eda0eaaf8b51a1", "committedDate": "2020-06-01T10:25:17Z", "message": "set edit mode at initialization"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzQ1Nzgx", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#pullrequestreview-421745781", "createdAt": "2020-06-01T10:34:53Z", "commit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDozNDo1M1rOGdF_3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMDozNDo1M1rOGdF_3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE2MDE1Nw==", "bodyText": "dispatch(editState);\nThough this dispatch call does the job here, It's better to follow the action dispatching methodology which is described in Flux pattern.\nIn the Flux pattern Object that we pass into the dispatcher called an action, Typically there are two elements in an action type and payload, and we derive the next state by switching the executing by the action type and incoming event's payload.\nThis pattern can be seen in React documentation examples as well.\nShall we follow a similar pattern here as well?", "url": "https://github.com/wso2/carbon-apimgt/pull/8616#discussion_r433160157", "createdAt": "2020-06-01T10:34:53Z", "author": {"login": "tmkasun"}, "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin_new/source/src/app/components/Throttling/Custom/AddEdit.jsx", "diffHunk": "@@ -100,8 +120,22 @@ function AddEdit(props) {\n     const [validationError, setValidationError] = useState([]);\n     const [editMode, setIsEditMode] = useState(false);\n     const restApi = new API();\n+    const { policyId } = props.match.params;\n \n     useEffect(() => {\n+        if (policyId !== 'create') {\n+            setIsEditMode(true);\n+            restApi.customPolicyGet(policyId).then((result) => {\n+                const formattedSiddhiQuery = sqlFormatter.format(result.body.siddhiQuery);\n+                const editState = {\n+                    policyName: result.body.policyName,\n+                    description: result.body.description,\n+                    keyTemplate: result.body.keyTemplate,\n+                    siddhiQuery: formattedSiddhiQuery,\n+                };\n+                dispatch(editState);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149659284a8d1a5aecaccd61f1d9c645bae3fca"}, "originalPosition": 79}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e14418233d052f7ab7e4e3052cc6ec5a6541608", "author": {"user": {"login": "kavishkafernando", "name": "Kavishka Fernando"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/4e14418233d052f7ab7e4e3052cc6ec5a6541608", "committedDate": "2020-06-01T11:08:40Z", "message": "Fix reducer issue"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2682, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}