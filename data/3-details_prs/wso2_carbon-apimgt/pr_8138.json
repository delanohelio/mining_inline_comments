{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMTAxMDc1", "number": 8138, "title": "Fix issue when updating resources in REST APIs created from WSDL", "bodyText": "Fixes wso2/product-apim#7359.\n\n\nFixes wso2/product-apim#7173.\n-   When editing a resource generated from WSDL with a path parameter, an error is thrown.\n-   When adding new resources to an API generated from SOAP backend", "createdAt": "2020-02-03T03:26:08Z", "url": "https://github.com/wso2/carbon-apimgt/pull/8138", "merged": true, "mergeCommit": {"oid": "04cd0d6ea9a8bc1278d0ee460c6264f1bd367ffa"}, "closed": true, "closedAt": "2020-02-07T17:12:08Z", "author": {"login": "vithu30"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_W8YGgH2gAyMzcwMTAxMDc1OmRiOTY2NDU1MTM4YTBjMzAwOTNmNzFmYjVjOGVkMzU4Y2U5MGI1ZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCCjBwAFqTM1NTMwNjgzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "db966455138a0c30093f71fb5c8ed358ce90b5ed", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/db966455138a0c30093f71fb5c8ed358ce90b5ed", "committedDate": "2020-01-30T09:16:01Z", "message": "Update sequences of APIs created from WSDL when swagger is updated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ad1340572553fb7e744a6eaa8fe671c816aad16", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/2ad1340572553fb7e744a6eaa8fe671c816aad16", "committedDate": "2020-02-03T03:10:26Z", "message": "Fix issue when adding new resources to SOAP to REST APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/46350c1e3bfc5ec65235aa8d1a906f09100e05bc", "committedDate": "2020-02-03T03:13:15Z", "message": "Fix issue when modifying WSDL resources with path parameters"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMDE5Mzk2", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#pullrequestreview-352019396", "createdAt": "2020-02-03T04:48:01Z", "commit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo0ODowMVrOFkmUtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo0ODowMVrOFkmUtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMDk0OA==", "bodyText": "What does this flag does? Hope if someone update the sequence it won't get affected.", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373920948", "createdAt": "2020-02-03T04:48:01Z", "author": {"login": "harsha89"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "diffHunk": "@@ -2828,6 +2832,9 @@ public Response apisApiIdSwaggerPut(String apiId, String apiDefinition, String u\n                 apiDefinition = validationResponse.getJsonContent();\n             }\n             String updatedSwagger = updateSwagger(apiId, apiDefinition);\n+            if (isSoapToRestConvertedAPI) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMDIwMjYx", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#pullrequestreview-352020261", "createdAt": "2020-02-03T04:52:33Z", "commit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo1MjozM1rOFkmXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNDo1MjozM1rOFkmXQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkyMTYwMQ==", "bodyText": "Is this split correct? \"[{]\" or should it be \"[{\"", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r373921601", "createdAt": "2020-02-03T04:52:33Z", "author": {"login": "tharikaGitHub"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/wsdl/SequenceGenerator.java", "diffHunk": "@@ -187,8 +191,23 @@ public static void generateSequencesFromSwagger(String swaggerStr, APIIdentifier\n                     String inSequence = template.getMappingInSequence(sequenceMap, operationId, soapAction,\n                             namespace, soapNamespace, arraySequenceElements);\n                     String outSequence = template.getMappingOutSequence();\n-                    saveApiSequences(apiIdentifier, inSequence, outSequence, httpMethod.toString().toLowerCase(),\n-                            pathName);\n+                    if (isResourceFromWSDL) {\n+                        Pattern pattern = Pattern.compile(\"[{}]\");\n+                        Matcher hasSpecialCharacters = pattern.matcher(pathName);\n+                        if (hasSpecialCharacters.find()) {\n+                            String resourcePathName = pathName.split(\"[{]\")[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyODM4NDM3", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#pullrequestreview-352838437", "createdAt": "2020-02-04T09:43:21Z", "commit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOTo0MzoyMVrOFlNq3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOTo0MzoyMVrOFlNq3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU2NTU5Ng==", "bodyText": "Ideally, we shouldn't need to update the UI. Let's try to fix the response from the REST API to alter the resource path. Changing the resource name like this in the UI is hacky.", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#discussion_r374565596", "createdAt": "2020-02-04T09:43:21Z", "author": {"login": "malinthaprasan"}, "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/Resources.jsx", "diffHunk": "@@ -435,6 +436,13 @@ export default function Resources(props) {\n                                     alignItems='stretch'\n                                 >\n                                     {Object.entries(verbObject).map(([verb, operation]) => {\n+                                        let resourcePathName = target.slice(1);\n+                                        if (regexPattern.test(resourcePathName)) {\n+                                            [resourcePathName] = resourcePathName.split('{');\n+                                            if (resourcePathName.endsWith('/')) {\n+                                                resourcePathName = resourcePathName.slice(0, -1);\n+                                            }\n+                                        }\n                                         return (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46350c1e3bfc5ec65235aa8d1a906f09100e05bc"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5569049ecdc9aab4ffd3fc43f027b327c8d20608", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/5569049ecdc9aab4ffd3fc43f027b327c8d20608", "committedDate": "2020-02-06T12:48:46Z", "message": "Fix review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "252b77400bcae58ef34123d482ae8b2e80ed0067", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/252b77400bcae58ef34123d482ae8b2e80ed0067", "committedDate": "2020-02-06T11:41:30Z", "message": "Fix review comments"}, "afterCommit": {"oid": "5569049ecdc9aab4ffd3fc43f027b327c8d20608", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/5569049ecdc9aab4ffd3fc43f027b327c8d20608", "committedDate": "2020-02-06T12:48:46Z", "message": "Fix review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cf75cd2c0a9bb73aaa06266fa188d1b985af574", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/6cf75cd2c0a9bb73aaa06266fa188d1b985af574", "committedDate": "2020-02-06T12:55:00Z", "message": "Update fork"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36b5aa6a8583a61f6d19e894f1da01032d4e8023", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/36b5aa6a8583a61f6d19e894f1da01032d4e8023", "committedDate": "2020-02-07T08:14:59Z", "message": "Add registry property to sequences to handle path parameter case"}, "afterCommit": {"oid": "f59645f66ce9edd779f405246a3e753740434bf4", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f59645f66ce9edd779f405246a3e753740434bf4", "committedDate": "2020-02-07T08:18:51Z", "message": "Add registry property to sequences to handle path parameter case"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f59645f66ce9edd779f405246a3e753740434bf4", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f59645f66ce9edd779f405246a3e753740434bf4", "committedDate": "2020-02-07T08:18:51Z", "message": "Add registry property to sequences to handle path parameter case"}, "afterCommit": {"oid": "f8f44889ffcb8100ef2bce232d2e30bbb292521a", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f8f44889ffcb8100ef2bce232d2e30bbb292521a", "committedDate": "2020-02-07T08:59:44Z", "message": "Add registry property to sequences to handle path parameter case"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8f44889ffcb8100ef2bce232d2e30bbb292521a", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/f8f44889ffcb8100ef2bce232d2e30bbb292521a", "committedDate": "2020-02-07T08:59:44Z", "message": "Add registry property to sequences to handle path parameter case"}, "afterCommit": {"oid": "e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "committedDate": "2020-02-07T09:04:00Z", "message": "Add registry property to sequences to handle path parameter case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "committedDate": "2020-02-07T09:15:21Z", "message": "Add registry property to sequences to handle path parameter case"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/e8b2998788dbed5b71e2fc08852a4586b8ccaa2a", "committedDate": "2020-02-07T09:04:00Z", "message": "Add registry property to sequences to handle path parameter case"}, "afterCommit": {"oid": "a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "author": {"user": {"login": "vithu30", "name": "Vithursa"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8", "committedDate": "2020-02-07T09:15:21Z", "message": "Add registry property to sequences to handle path parameter case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MzA2ODM0", "url": "https://github.com/wso2/carbon-apimgt/pull/8138#pullrequestreview-355306834", "createdAt": "2020-02-07T17:12:00Z", "commit": {"oid": "a38ba95f35e84b2d9b4d3f45a72c0bb1a0407ae8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2972, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}