{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2NTI0NTU0", "number": 9491, "title": "Adding changes related to API revision retrieval path", "bodyText": "Issues\nwso2/product-apim#9406\nTasks\nAdding changes to List API Revisions.\nView created API revision details through API Publisher.", "createdAt": "2020-12-11T05:33:54Z", "url": "https://github.com/wso2/carbon-apimgt/pull/9491", "merged": true, "mergeCommit": {"oid": "eef95d88cbddd68980b9435728038b4f4f91adf6"}, "closed": true, "closedAt": "2020-12-14T05:17:28Z", "author": {"login": "CrowleyRajapakse"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlBNquAFqTU0OTgxMzc5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdl9_vkABqjQxMDcwNjU1NTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5ODEzNzk1", "url": "https://github.com/wso2/carbon-apimgt/pull/9491#pullrequestreview-549813795", "createdAt": "2020-12-11T05:37:16Z", "commit": {"oid": "3af61ab4b74fdde8f4457c035b4bfe2d157892bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNTozNzoxNlrOIDp5QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNTozNzoxNlrOIDp5QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDcwMzA0MA==", "bodyText": "Formatting issue", "url": "https://github.com/wso2/carbon-apimgt/pull/9491#discussion_r540703040", "createdAt": "2020-12-11T05:37:16Z", "author": {"login": "mushthaq33"}, "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.publisher.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/publisher/v1/impl/ApisApiServiceImpl.java", "diffHunk": "@@ -4311,6 +4336,11 @@ private APIDTO getAPIByID(String apiId) {\n             String tenantDomain = RestApiCommonUtil.getLoggedInUserTenantDomain();\n             APIProvider apiProvider = RestApiCommonUtil.getLoggedInUserProvider();\n             API api = apiProvider.getAPIbyUUID(apiId, tenantDomain);\n+            APIRevision apiRevision = ApiMgtDAO.getInstance().checkAPIUUIDIsARevisionUUID(apiId);\n+            if (apiRevision != null && !StringUtils.isEmpty(apiRevision.getApiUUID()) ){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af61ab4b74fdde8f4457c035b4bfe2d157892bc"}, "originalPosition": 73}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3af61ab4b74fdde8f4457c035b4bfe2d157892bc", "author": {"user": {"login": "CrowleyRajapakse", "name": "Crowley Rajapakse"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/3af61ab4b74fdde8f4457c035b4bfe2d157892bc", "committedDate": "2020-12-11T05:24:19Z", "message": "adding changes to API revision retrieval path"}, "afterCommit": {"oid": "a25993bbbc6781dab65c567cab2dea5bc8aa181d", "author": {"user": {"login": "CrowleyRajapakse", "name": "Crowley Rajapakse"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a25993bbbc6781dab65c567cab2dea5bc8aa181d", "committedDate": "2020-12-11T05:56:34Z", "message": "adding changes to API revision retrieval path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDA4MDg2", "url": "https://github.com/wso2/carbon-apimgt/pull/9491#pullrequestreview-551008086", "createdAt": "2020-12-14T02:38:45Z", "commit": {"oid": "a25993bbbc6781dab65c567cab2dea5bc8aa181d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwMjozODo0NlrOIE9hRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwMjozODo0NlrOIE9hRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA3MzE1Nw==", "bodyText": "need to have space before \"in\"", "url": "https://github.com/wso2/carbon-apimgt/pull/9491#discussion_r542073157", "createdAt": "2020-12-14T02:38:46Z", "author": {"login": "chamilaadhi"}, "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -15700,4 +15704,29 @@ public APIRevision getRevisionByRevisionUUID(String revisionUUID) throws APIMana\n         }\n         return revisionList;\n     }\n+\n+    /**\n+     * Get a provided api uuid is in the revision db table\n+     *\n+     * @return String apiUUID\n+     * @throws APIManagementException if an error occurs while checking revision table\n+     */\n+    public APIRevision checkAPIUUIDIsARevisionUUID(String apiUUID) throws APIManagementException {\n+        APIRevision apiRevision = new APIRevision();\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+             PreparedStatement statement = connection\n+                     .prepareStatement(SQLConstants.APIRevisionSqlConstants.GET_REVISION_APIID_BY_REVISION_UUID)) {\n+            statement.setString(1, apiUUID);\n+            try (ResultSet rs = statement.executeQuery()) {\n+                while (rs.next()) {\n+                    apiRevision.setApiUUID(rs.getString(1));\n+                    apiRevision.setId(rs.getInt(2));\n+                    apiRevision.setRevisionUUID(apiUUID);\n+                }\n+            }\n+        } catch (SQLException e) {\n+            handleException(\"Failed to search UUID: \" + apiUUID + \"in the revision db table\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a25993bbbc6781dab65c567cab2dea5bc8aa181d"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDA5MjE0", "url": "https://github.com/wso2/carbon-apimgt/pull/9491#pullrequestreview-551009214", "createdAt": "2020-12-14T02:42:51Z", "commit": {"oid": "a25993bbbc6781dab65c567cab2dea5bc8aa181d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5f0dce495bd0bd70b2868910c01b755d2ae428f", "author": {"user": {"login": "CrowleyRajapakse", "name": "Crowley Rajapakse"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c5f0dce495bd0bd70b2868910c01b755d2ae428f", "committedDate": "2020-12-14T04:25:11Z", "message": "adding changes to API revision retrieval path"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a25993bbbc6781dab65c567cab2dea5bc8aa181d", "author": {"user": {"login": "CrowleyRajapakse", "name": "Crowley Rajapakse"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/a25993bbbc6781dab65c567cab2dea5bc8aa181d", "committedDate": "2020-12-11T05:56:34Z", "message": "adding changes to API revision retrieval path"}, "afterCommit": {"oid": "c5f0dce495bd0bd70b2868910c01b755d2ae428f", "author": {"user": {"login": "CrowleyRajapakse", "name": "Crowley Rajapakse"}}, "url": "https://github.com/wso2/carbon-apimgt/commit/c5f0dce495bd0bd70b2868910c01b755d2ae428f", "committedDate": "2020-12-14T04:25:11Z", "message": "adding changes to API revision retrieval path"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3039, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}