{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzNTkyMDg3", "number": 2358, "title": "Moving libs.truffleapi to ide cluster. GraalJS impl recommended for JDK15+", "bodyText": "During commit-validation cleanup, I've noticed some dependencies from java to webcommon cluster. Several of them is on truffleapi module, which should IMHO move into ide cluster (similar to graalsdk library).\nAs for libs.graaljs required as project dependency for nashorn.execution: during discussion with @JaroslavTulach, it seemed that GraalJS impl is only necessary when there is no platform that supports Nashorn (either too old, or JDK15+) where the GraalJS classes are put on classpath and used for execution.\nSo this PR will change the project dependency into OpenIDE-Module-Recommends so GraalJS is enabled automatically; in the case the platform is missing, and the GraalJS library is NOT available (= module not installed), it will ask the user whether to download the module (libs.graaljs). If the user says \"No\", decision is remembered - just status message prints on unsuccessful exec.\nI made the libs.graaljs module visible in AU, since the user may need to manually download it.\nNote that Java cluster has still a dependency on webcommon: debugger.jpda.trufflenode uses some types from javascript implementation. So ant -Dcluster.config=java remains broken (the resulting ZIP does not contain webcommon and therefore debugger.jpda.trufflenode is broken and disabled on 1st startup)", "createdAt": "2020-09-10T09:32:19Z", "url": "https://github.com/apache/netbeans/pull/2358", "merged": true, "mergeCommit": {"oid": "eba3ee243620628c58e7c69710d8b1b9642fc02c"}, "closed": true, "closedAt": "2020-09-14T21:01:03Z", "author": {"login": "sdedic"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHh-W4gFqTQ4NjAxMTkwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI4UlmAFqTQ4ODA3NTI2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MDExOTA1", "url": "https://github.com/apache/netbeans/pull/2358#pullrequestreview-486011905", "createdAt": "2020-09-10T14:44:21Z", "commit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo0NDoyMVrOHP3mnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo0NzoyOFrOHP3wJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwMTY5NQ==", "bodyText": "Suspicious at first sight. I'd expect cnb.org.netbeans.libs.graaljs as that is the token exported by default by the module system for the org.netbeans.libs.graaljs module. However correct, the module explicitly exports org.netbeans.libs.graaljs token as can be seen below.", "url": "https://github.com/apache/netbeans/pull/2358#discussion_r486401695", "createdAt": "2020-09-10T14:44:21Z", "author": {"login": "JaroslavTulach"}, "path": "java/nashorn.execution/manifest.mf", "diffHunk": "@@ -4,4 +4,4 @@ Comment: OpenIDE-Module-Layer: org/netbeans/modules/nashorn/execution/resources/\n OpenIDE-Module-Localizing-Bundle: org/netbeans/modules/nashorn/execution/Bundle.properties\n OpenIDE-Module-Specification-Version: 1.16\n AutoUpdate-Show-In-Client: false\n-\n+OpenIDE-Module-Recommends: org.netbeans.libs.graaljs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwMjMxMQ==", "bodyText": "Package private, maybe?", "url": "https://github.com/apache/netbeans/pull/2358#discussion_r486402311", "createdAt": "2020-09-10T14:45:06Z", "author": {"login": "JaroslavTulach"}, "path": "java/nashorn.execution/src/org/netbeans/modules/nashorn/execution/ModuleRequestException.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.netbeans.modules.nashorn.execution;\n+\n+/**\n+ *\n+ * @author sdedic\n+ */\n+public class ModuleRequestException extends UnsupportedOperationException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwMjUyNQ==", "bodyText": "final.", "url": "https://github.com/apache/netbeans/pull/2358#discussion_r486402525", "createdAt": "2020-09-10T14:45:21Z", "author": {"login": "JaroslavTulach"}, "path": "java/nashorn.execution/src/org/netbeans/modules/nashorn/execution/ModuleRequestException.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.netbeans.modules.nashorn.execution;\n+\n+/**\n+ *\n+ * @author sdedic\n+ */\n+public class ModuleRequestException extends UnsupportedOperationException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwMjMxMQ=="}, "originalCommit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwMzYwMw==", "bodyText": "I see. The module explicitly provides org.netbeans.libs.graaljs.", "url": "https://github.com/apache/netbeans/pull/2358#discussion_r486403603", "createdAt": "2020-09-10T14:46:47Z", "author": {"login": "JaroslavTulach"}, "path": "webcommon/libs.graaljs/manifest.mf", "diffHunk": "@@ -1,7 +1,7 @@\n Manifest-Version: 1.0\n-AutoUpdate-Show-In-Client: false\n+AutoUpdate-Show-In-Client: true\n OpenIDE-Module: org.netbeans.libs.graaljs/1\n OpenIDE-Module-Layer: org/netbeans/libs/graaljs/layer.xml\n OpenIDE-Module-Localizing-Bundle: org/netbeans/libs/graaljs/Bundle.properties\n OpenIDE-Module-Specification-Version: 1.7\n-OpenIDE-Module-Provides: javax.script.ScriptEngine.js\n+OpenIDE-Module-Provides: javax.script.ScriptEngine.js,org.netbeans.libs.graaljs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNDEzNQ==", "bodyText": "Increase module version when you are changing the API (by increasing set of provided tokens).", "url": "https://github.com/apache/netbeans/pull/2358#discussion_r486404135", "createdAt": "2020-09-10T14:47:28Z", "author": {"login": "JaroslavTulach"}, "path": "webcommon/libs.graaljs/manifest.mf", "diffHunk": "@@ -1,7 +1,7 @@\n Manifest-Version: 1.0\n-AutoUpdate-Show-In-Client: false\n+AutoUpdate-Show-In-Client: true\n OpenIDE-Module: org.netbeans.libs.graaljs/1\n OpenIDE-Module-Layer: org/netbeans/libs/graaljs/layer.xml\n OpenIDE-Module-Localizing-Bundle: org/netbeans/libs/graaljs/Bundle.properties\n OpenIDE-Module-Specification-Version: 1.7", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d68dd45098ee97f9d0582de49f3aea67210662b"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c084eaa4ed6a6828b60240c5e0a8b053b0fa300", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/9c084eaa4ed6a6828b60240c5e0a8b053b0fa300", "committedDate": "2020-09-10T15:03:18Z", "message": "Increase changed module's version."}, "afterCommit": {"oid": "4696da22cabe1b61774f7d920fb15f41d98076b1", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/4696da22cabe1b61774f7d920fb15f41d98076b1", "committedDate": "2020-09-14T06:42:19Z", "message": "Moving libs.truffleapi to ide cluster. GraalJS impl recommended for JDK15+."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00c5dd6ede9518862fa7e01ea91bfc789d1037ad", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/00c5dd6ede9518862fa7e01ea91bfc789d1037ad", "committedDate": "2020-09-14T15:30:34Z", "message": "Moving libs.truffleapi to ide cluster. GraalJS impl recommended to handle JDK15+ only systems."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af3c7f8ef0b3ca03c7d15b80869ee90a917983fc", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/af3c7f8ef0b3ca03c7d15b80869ee90a917983fc", "committedDate": "2020-09-14T15:30:35Z", "message": "Updating CI: libs.truffleapi moved to ide."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa47834c10a9508d394d843b3eb1e1d386281b59", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/aa47834c10a9508d394d843b3eb1e1d386281b59", "committedDate": "2020-09-14T07:08:24Z", "message": "Updating CI: libs.truffleapi moved to ide."}, "afterCommit": {"oid": "af3c7f8ef0b3ca03c7d15b80869ee90a917983fc", "author": {"user": {"login": "sdedic", "name": "Svatopluk Dedic"}}, "url": "https://github.com/apache/netbeans/commit/af3c7f8ef0b3ca03c7d15b80869ee90a917983fc", "committedDate": "2020-09-14T15:30:35Z", "message": "Updating CI: libs.truffleapi moved to ide."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MDc1MjY4", "url": "https://github.com/apache/netbeans/pull/2358#pullrequestreview-488075268", "createdAt": "2020-09-14T19:25:48Z", "commit": {"oid": "af3c7f8ef0b3ca03c7d15b80869ee90a917983fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4793, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}