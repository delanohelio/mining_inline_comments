{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNzg1NjMx", "number": 2399, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxMTo1NjoxMlrOEn1R2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxMTo1ODo0MVrOEn1Sdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMjAyODQyOnYy", "diffSide": "RIGHT", "path": "java/java.source.base/src/org/netbeans/modules/java/source/ElementUtils.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxMTo1NjoxMlrOHYm54A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNDozNDo0NFrOHagrHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTI4MA==", "bodyText": "Not related to this bug, but a few lines below: (elem.getKind() == ElementKind.CLASS || elem.getKind() == ElementKind.INTERFACE) IMHO does not work for ANNOTATION_TYPE and ENUM. Could be worth to fix as\nelem.getKind().isClass() || elem.getKind().isInterface ?", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r495565280", "createdAt": "2020-09-27T11:56:12Z", "author": {"login": "sdedic"}, "path": "java/java.source.base/src/org/netbeans/modules/java/source/ElementUtils.java", "diffHunk": "@@ -60,6 +60,11 @@ public static TypeElement getTypeElementByBinaryName(JavacTask task, String name\n         for (ModuleElement me : allModules) {\n             TypeElement found = getTypeElementByBinaryName(task, me, name);\n \n+            if (result == found) {\n+                // avoid returning null, partial fix for [NETBEANS-4832]\n+                continue;\n+            }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM0MzE5Mw==", "bodyText": "So you're saying that the if(result==found)continue seems OK.\nAnd that there's an additional issue that could arise in some cases; and you've proposed a fix which can be incorporated with this change.", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r496343193", "createdAt": "2020-09-29T02:34:20Z", "author": {"login": "errael"}, "path": "java/java.source.base/src/org/netbeans/modules/java/source/ElementUtils.java", "diffHunk": "@@ -60,6 +60,11 @@ public static TypeElement getTypeElementByBinaryName(JavacTask task, String name\n         for (ModuleElement me : allModules) {\n             TypeElement found = getTypeElementByBinaryName(task, me, name);\n \n+            if (result == found) {\n+                // avoid returning null, partial fix for [NETBEANS-4832]\n+                continue;\n+            }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTI4MA=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU1ODcwNg==", "bodyText": "Added separate commit for ANNOTATION_TYPE, ENUM, still in this PR.", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r497558706", "createdAt": "2020-09-30T14:32:32Z", "author": {"login": "errael"}, "path": "java/java.source.base/src/org/netbeans/modules/java/source/ElementUtils.java", "diffHunk": "@@ -60,6 +60,11 @@ public static TypeElement getTypeElementByBinaryName(JavacTask task, String name\n         for (ModuleElement me : allModules) {\n             TypeElement found = getTypeElementByBinaryName(task, me, name);\n \n+            if (result == found) {\n+                // avoid returning null, partial fix for [NETBEANS-4832]\n+                continue;\n+            }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTI4MA=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU2MDM1MQ==", "bodyText": "@sdedic Known issues handled, please review.", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r497560351", "createdAt": "2020-09-30T14:34:44Z", "author": {"login": "errael"}, "path": "java/java.source.base/src/org/netbeans/modules/java/source/ElementUtils.java", "diffHunk": "@@ -60,6 +60,11 @@ public static TypeElement getTypeElementByBinaryName(JavacTask task, String name\n         for (ModuleElement me : allModules) {\n             TypeElement found = getTypeElementByBinaryName(task, me, name);\n \n+            if (result == found) {\n+                // avoid returning null, partial fix for [NETBEANS-4832]\n+                continue;\n+            }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTI4MA=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMjAyOTk5OnYy", "diffSide": "RIGHT", "path": "javafx/javafx2.editor/src/org/netbeans/modules/javafx2/editor/FXMLCompletion2.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxMTo1ODo0MVrOHYm6kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNDozMzo1NVrOHagosA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTQ1OQ==", "bodyText": "I understand the trigger, but couldn't it be fixed right in the getPackagElement(), @jlahoda ?", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r495565459", "createdAt": "2020-09-27T11:58:41Z", "author": {"login": "sdedic"}, "path": "javafx/javafx2.editor/src/org/netbeans/modules/javafx2/editor/FXMLCompletion2.java", "diffHunk": "@@ -161,6 +161,8 @@ public void run(ResultIterator resultIterator) throws Exception {\n                 }\n                 Parser.Result result = resultIterator.getParserResult();\n                 ci = CompilationInfo.get(result);\n+                // following populates module info, partial fix for [NETBEANS-4832]\n+                ci.getElements().getPackageElement(\"java.lang\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM0MzM2MA==", "bodyText": "Did you mean getElements() rather than getPackageElement()?", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r496343360", "createdAt": "2020-09-29T02:34:56Z", "author": {"login": "errael"}, "path": "javafx/javafx2.editor/src/org/netbeans/modules/javafx2/editor/FXMLCompletion2.java", "diffHunk": "@@ -161,6 +161,8 @@ public void run(ResultIterator resultIterator) throws Exception {\n                 }\n                 Parser.Result result = resultIterator.getParserResult();\n                 ci = CompilationInfo.get(result);\n+                // following populates module info, partial fix for [NETBEANS-4832]\n+                ci.getElements().getPackageElement(\"java.lang\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTQ1OQ=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM4OTQxMg==", "bodyText": "I think the expected way would be to get a CompilationController (instead of just CompilationInfo) and call toPhase(ELEMENTS_RESOLVED), or alike, on it.", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r496389412", "createdAt": "2020-09-29T04:41:49Z", "author": {"login": "jlahoda"}, "path": "javafx/javafx2.editor/src/org/netbeans/modules/javafx2/editor/FXMLCompletion2.java", "diffHunk": "@@ -161,6 +161,8 @@ public void run(ResultIterator resultIterator) throws Exception {\n                 }\n                 Parser.Result result = resultIterator.getParserResult();\n                 ci = CompilationInfo.get(result);\n+                // following populates module info, partial fix for [NETBEANS-4832]\n+                ci.getElements().getPackageElement(\"java.lang\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTQ1OQ=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU1OTcyOA==", "bodyText": "@jlahoda Use CompilationController as suggested. Works, thanks. Please review.", "url": "https://github.com/apache/netbeans/pull/2399#discussion_r497559728", "createdAt": "2020-09-30T14:33:55Z", "author": {"login": "errael"}, "path": "javafx/javafx2.editor/src/org/netbeans/modules/javafx2/editor/FXMLCompletion2.java", "diffHunk": "@@ -161,6 +161,8 @@ public void run(ResultIterator resultIterator) throws Exception {\n                 }\n                 Parser.Result result = resultIterator.getParserResult();\n                 ci = CompilationInfo.get(result);\n+                // following populates module info, partial fix for [NETBEANS-4832]\n+                ci.getElements().getPackageElement(\"java.lang\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU2NTQ1OQ=="}, "originalCommit": {"oid": "8cd0308d63c79157c92b6b738f4e3ee5c311363b"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 359, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}