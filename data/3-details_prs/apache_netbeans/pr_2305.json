{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MTUzMjY3", "number": 2305, "title": "[NETBEANS-3693] Create only one instance of javac", "bodyText": "Use only one instance of javac to parse multiple files when multiple java files needed to be parsed when netbeans is running without nb-javac.", "createdAt": "2020-08-09T13:38:05Z", "url": "https://github.com/apache/netbeans/pull/2305", "merged": true, "mergeCommit": {"oid": "2d565fe02be31e33009fefb4880254ba0a692f47"}, "closed": true, "closedAt": "2020-10-13T18:27:33Z", "author": {"login": "Akshay-Gupta-Oracle"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-MZTSgBqjM2NDgwMTg2MjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRldAVgBqjM4NjQwNjI1ODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c28d02ccd1f2328509c138c3f9d089e2da3f5c4", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/4c28d02ccd1f2328509c138c3f9d089e2da3f5c4", "committedDate": "2020-08-11T21:06:30Z", "message": "[NETBEANS-3693] Create only one instance of javac"}, "afterCommit": {"oid": "8c73e078e43cbcea4c36dfe72b2ea5e25b9e2f66", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/8c73e078e43cbcea4c36dfe72b2ea5e25b9e2f66", "committedDate": "2020-08-12T14:34:15Z", "message": "[NETBEANS-3693] Create only one instance of javac"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzM1MDky", "url": "https://github.com/apache/netbeans/pull/2305#pullrequestreview-493335092", "createdAt": "2020-09-22T10:48:39Z", "commit": {"oid": "8c73e078e43cbcea4c36dfe72b2ea5e25b9e2f66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDo0ODo0MFrOHV0WIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDo0ODo0MFrOHV0WIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzOTc3Ng==", "bodyText": "I suspect this will disable \"sequential\" processing when nb-javac is installed, right? Or do I miss something here?", "url": "https://github.com/apache/netbeans/pull/2305#discussion_r492639776", "createdAt": "2020-09-22T10:48:40Z", "author": {"login": "lahodaj"}, "path": "java/java.source.base/src/org/netbeans/modules/java/source/parsing/JavacParser.java", "diffHunk": "@@ -424,9 +434,28 @@ private void parseImpl(\n                     break;\n                 default:\n                     init (snapshot, task, false);\n+                    DiagnosticListener<JavaFileObject> diagnosticListener;\n+                    JavacTaskImpl javacTask;\n+                    boolean oneInstanceJava=Boolean.getBoolean(\"java.enable.single.javac\") && this.snapshotSize <= this.MAX_FILE_SIZE;\n+                    if (sequentialParsing == null && ciImpl == null && oneInstanceJava) {\n+                        List<JavaFileObject> jfos = new ArrayList<>();\n+                        for (Snapshot s : snapshots) {\n+                            jfos.add(FileObjects.sourceFileObject(s.getSource().getFileObject(), root, JavaFileFilterQuery.getFilter(s.getSource().getFileObject()), s.getText()));\n+                        }\n+                        diagnosticListener = new CompilationInfoImpl.DiagnosticListenerImpl(this.root, jfos.get(0), this.cpInfo);\n+                        javacTask = JavacParser.createJavacTask(this.file, jfos, this.root, this.cpInfo,\n+                                this, diagnosticListener, false);\n+                    } else if (ciImpl != null &&  oneInstanceJava) {\n+                        diagnosticListener = ciImpl.getDiagnosticListener();\n+                        javacTask = ciImpl.getJavacTask();\n+                        oldParsedTrees=ciImpl.getParsedTrees();\n+                    } else {\n+                        diagnosticListener = null;\n+                        javacTask = null;\n+                    }\n                     ciImpl = createCurrentInfo(this, file, root, snapshot,\n-                        sequentialParsing == null || ciImpl == null ? null : ciImpl.getJavacTask(),\n-                        sequentialParsing == null || ciImpl == null ? null : ciImpl.getDiagnosticListener());\n+                        javacTask,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c73e078e43cbcea4c36dfe72b2ea5e25b9e2f66"}, "originalPosition": 102}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d424ad2aeee7db5341d12ebdfd4999765023e24f", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/d424ad2aeee7db5341d12ebdfd4999765023e24f", "committedDate": "2020-10-10T22:47:56Z", "message": "[NETBEANS-3693] Create only one instance of javac"}, "afterCommit": {"oid": "ebf439b61c7ceac5c88de3598e73efb85311de94", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/ebf439b61c7ceac5c88de3598e73efb85311de94", "committedDate": "2020-10-11T04:18:21Z", "message": "[NETBEANS-3693] Create only one instance of javac"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28e08ca23a1a1b01c3f1dc92334881e63b41ddfd", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/28e08ca23a1a1b01c3f1dc92334881e63b41ddfd", "committedDate": "2020-10-11T20:31:46Z", "message": "[NETBEANS-3693] Create only one instance of javac"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73937091e2c08ccabaf130396e57b8c8872d746b", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/73937091e2c08ccabaf130396e57b8c8872d746b", "committedDate": "2020-10-11T19:31:06Z", "message": "Fixing test cases"}, "afterCommit": {"oid": "28e08ca23a1a1b01c3f1dc92334881e63b41ddfd", "author": {"user": {"login": "Akshay-Gupta-Oracle", "name": "Akshay Gupta"}}, "url": "https://github.com/apache/netbeans/commit/28e08ca23a1a1b01c3f1dc92334881e63b41ddfd", "committedDate": "2020-10-11T20:31:46Z", "message": "[NETBEANS-3693] Create only one instance of javac"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3973, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}