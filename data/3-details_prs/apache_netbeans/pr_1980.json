{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NzM3Mjc1", "number": 1980, "title": "[NETBEANS-2446] Use *parent* of saved projectFolder as projectLocation", "bodyText": "NOTE: this PR only addresses the problem caused by the first changeset listed. I'm filing a 2nd issue for the spurious directory creation which is the 2nd changeset. But I'm including it here for reference/completeness since it is in the issue report.\nNETBEANS-2446 problem comes from two commits (seen in main-silver)\n    changeset:   244321:021157efa98e\n    parent:      244318:5036dc46020f\n    user:        Milos Kleint <mkleint@netbeans.org>\n    date:        Thu Jan 24 15:12:37 2013 +0100\n    summary:     #217087 new wizard able to pick up the parent directory from Action's properties as initial value\n\nand\n    changeset:   301468:76d9cafcee35\n    branch:      ArchetypesUI268677\n    parent:      299970:0c5aa5cdb86a\n    user:        Jaroslav Tulach <jtulach@netbeans.org>\n    date:        Tue Oct 25 21:52:49 2016 +0200\n    summary:     #268677: Recognizing .archetype template files and using them to instantiate projects via mvn archetype\n\nThe first change took out these two lines near the start of java/maven/.../BasicPanelVisual.read(WizardDescriptor settings)\n        } else {\n            projectLocation = projectLocation.getParentFile();\n\nThis is really unrelated to the overall changeset, except that PROJECT_PARENT_FOLDER is nearby.\nWithout these two lines, in NewProject > JavaWithMaven > JavaApplication, if you alternately click \"next\"/\"back\" you'll see\n\nF:\\tmp\\proj1\\proj1\\proj1\\proj1\\\n\nadding another \"proj1\" with each \"next\". Putting back these two lines fixes it.\nThe 2nd changeset problem (not addressed by this PR), \"Recognizing .archetype template ...\", causes spurious directory creation and makes the overall problem highly visible. This problem creates this deep directory tree even though finish is not pushed. Pushing cancel still creates directories.\nThe directory creation comes from java/maven/.../BasicPanelVisual.store(WizardDescriptor d)\n    void store(WizardDescriptor d) {\n        ...\n        d.putProperty(CommonProjectActions.PROJECT_PARENT_FOLDER, parentFolder);\n        if (d instanceof TemplateWizard) {\n            parentFolder.mkdirs();\n            ((TemplateWizard) d).setTargetFolder(DataFolder.findFolder(FileUtil.toFileObject(parentFolder)));\n        }\n\nThe store method is called to save panel settings; it could be for cancel, finish, back, next.\nI don't know if this code is for convenience, to avoid later calculations, or if it's required. I'll file a 2nd issue for this.", "createdAt": "2020-02-25T18:38:35Z", "url": "https://github.com/apache/netbeans/pull/1980", "merged": true, "mergeCommit": {"oid": "e803be8277dec53fa1d5b337e945b10a4bbc2d41"}, "closed": true, "closedAt": "2020-03-12T19:57:33Z", "author": {"login": "errael"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHXkiwgH2gAyMzc5NzM3Mjc1OjcxNzJlMmI3M2NkYjViZWUzM2ExZGEwYjZkNzE0YmM5YzEwNGUzZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNBQLAAFqTM3Mzg1NzAyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7172e2b73cdb5bee33a1da0b6d714bc9c104e3d8", "author": {"user": {"login": "errael", "name": "errael"}}, "url": "https://github.com/apache/netbeans/commit/7172e2b73cdb5bee33a1da0b6d714bc9c104e3d8", "committedDate": "2020-02-24T06:31:17Z", "message": "[NETBEANS-2446] Use *parent* of saved projectFolder as projectLocation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NDc0NDYz", "url": "https://github.com/apache/netbeans/pull/1980#pullrequestreview-367474463", "createdAt": "2020-03-02T19:41:35Z", "commit": {"oid": "926c97ade68be0f867eff9732e35bcb732eab9a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOTo0MTozNVrOFwsuaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOTo0MTozNVrOFwsuaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjYwODc0NQ==", "bodyText": "This looks like a contradiction to the name of the property in line 562. Could it be, that the property is set to the wrong value?", "url": "https://github.com/apache/netbeans/pull/1980#discussion_r386608745", "createdAt": "2020-03-02T19:41:35Z", "author": {"login": "matthiasblaesing"}, "path": "java/maven/src/org/netbeans/modules/maven/newproject/BasicPanelVisual.java", "diffHunk": "@@ -562,7 +562,9 @@ void read(WizardDescriptor settings) {\n         File projectLocation = (File) settings.getProperty(CommonProjectActions.PROJECT_PARENT_FOLDER); //NOI18N\n         if (projectLocation == null || projectLocation.getParentFile() == null || !projectLocation.getParentFile().isDirectory()) {\n             projectLocation = ProjectChooser.getProjectsFolder();\n-        } \n+        } else {\n+            projectLocation = projectLocation.getParentFile();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "926c97ade68be0f867eff9732e35bcb732eab9a2"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzY2MTM0", "url": "https://github.com/apache/netbeans/pull/1980#pullrequestreview-368366134", "createdAt": "2020-03-03T22:15:37Z", "commit": {"oid": "7172e2b73cdb5bee33a1da0b6d714bc9c104e3d8"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczODU3MDI1", "url": "https://github.com/apache/netbeans/pull/1980#pullrequestreview-373857025", "createdAt": "2020-03-12T19:54:40Z", "commit": {"oid": "7172e2b73cdb5bee33a1da0b6d714bc9c104e3d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 211, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}