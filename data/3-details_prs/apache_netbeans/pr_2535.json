{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMDI0NzYx", "number": 2535, "title": "[NETBEANS-5027] PHP - improved display of array parameter", "bodyText": "https://issues.apache.org/jira/browse/NETBEANS-5027\nImproves display of array used as default parameter value.\nUses short array format, displays first item in array, indicates more elements in array.\nBefore:\n\nAfter:", "createdAt": "2020-11-14T16:00:23Z", "url": "https://github.com/apache/netbeans/pull/2535", "merged": true, "mergeCommit": {"oid": "514e170f43416aec1a25c1c443837bf1ef9043f0"}, "closed": true, "closedAt": "2020-11-21T08:31:59Z", "author": {"login": "KacerCZ"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcd6vFgH2gAyNTIxMDI0NzYxOjhlNjZiZmMwMjQyNTMxNzc2MzcxNzUzOGU2YzZlZTA5MjM5NmI2ZTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdebS1FAFqTUzNTY2MjEzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e66bfc02425317763717538e6c6ee092396b6e8", "author": {"user": {"login": "KacerCZ", "name": "Tom\u00e1\u0161 Proch\u00e1zka"}}, "url": "https://github.com/apache/netbeans/commit/8e66bfc02425317763717538e6c6ee092396b6e8", "committedDate": "2020-11-14T15:58:31Z", "message": "[NETBEANS-5027] PHP - improved display of array parameter\n\nhttps://issues.apache.org/jira/browse/NETBEANS-5027\n\nImproves display of array used as default parameter value.\nUses short array format, displays first item in array, indicates more elements in array."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MDY5NTE5", "url": "https://github.com/apache/netbeans/pull/2535#pullrequestreview-535069519", "createdAt": "2020-11-20T04:21:34Z", "commit": {"oid": "8e66bfc02425317763717538e6c6ee092396b6e8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MjY4Mzcz", "url": "https://github.com/apache/netbeans/pull/2535#pullrequestreview-535268373", "createdAt": "2020-11-20T09:38:33Z", "commit": {"oid": "8e66bfc02425317763717538e6c6ee092396b6e8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOTozODozM1rOH3II1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOTozODozM1rOH3II1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU2NzA2MA==", "bodyText": "Could you please add a test where the array value is an object? I would like to see how the tooltip will look like in such a case. Thanks!", "url": "https://github.com/apache/netbeans/pull/2535#discussion_r527567060", "createdAt": "2020-11-20T09:38:33Z", "author": {"login": "tmysik"}, "path": "php/php.editor/test/unit/src/org/netbeans/modules/php/editor/CodeUtilsTest.java", "diffHunk": "@@ -179,4 +183,43 @@ public void testCommonNamespacePrefixes11() {\n         assertEquals(0, prefixes.size());\n     }\n \n+    public void testGetParamDefaultValueEmptyArray() {\n+        List<ArrayElement> emptyArray = Collections.emptyList();\n+        FormalParameter param = createFormalParameterWithDefaultArray(emptyArray);\n+        assertEquals(\"[]\", CodeUtils.getParamDefaultValue(param));\n+    }\n+\n+    public void testGetParamDefaultValueArrayOneItem() {\n+        Scalar value = new Scalar(1, 1, \"'a'\", Scalar.Type.STRING);\n+        ArrayElement item = new ArrayElement(1, 1, null, value);\n+        List<ArrayElement> array = Arrays.asList(item);\n+        FormalParameter param = createFormalParameterWithDefaultArray(array);\n+        assertEquals(\"['a']\", CodeUtils.getParamDefaultValue(param));\n+    }\n+\n+    public void testGetParamDefaultValueArrayTwoItems() {\n+        Scalar value1 = new Scalar(1, 1, \"'a'\", Scalar.Type.STRING);\n+        ArrayElement item1 = new ArrayElement(1, 1, null, value1);\n+        Scalar value2 = new Scalar(1, 1, \"'b'\", Scalar.Type.STRING);\n+        ArrayElement item2 = new ArrayElement(1, 1, null, value2);\n+        List<ArrayElement> array = Arrays.asList(item1, item2);\n+        FormalParameter param = createFormalParameterWithDefaultArray(array);\n+        assertEquals(\"['a',...]\", CodeUtils.getParamDefaultValue(param));\n+    }\n+\n+    public void testGetParamDefaultValueArrayItemWithKey() {\n+        Scalar key = new Scalar(1, 1, \"3\", Scalar.Type.INT);\n+        Scalar value = new Scalar(1, 1, \"'a'\", Scalar.Type.STRING);\n+        ArrayElement item = new ArrayElement(1, 1, key, value);\n+        List<ArrayElement> array = Arrays.asList(item);\n+        FormalParameter param = createFormalParameterWithDefaultArray(array);\n+        assertEquals(\"[3 => 'a']\", CodeUtils.getParamDefaultValue(param));\n+    }\n+\n+    private FormalParameter createFormalParameterWithDefaultArray(List<ArrayElement> arrayContent) {\n+        ArrayCreation defaultValue = new ArrayCreation(1, 1, arrayContent, ArrayCreation.Type.NEW);\n+        FormalParameter param = new FormalParameter(1, 1, null, null, defaultValue);\n+        return param;\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e66bfc02425317763717538e6c6ee092396b6e8"}, "originalPosition": 53}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NjYyMTM4", "url": "https://github.com/apache/netbeans/pull/2535#pullrequestreview-535662138", "createdAt": "2020-11-20T18:02:58Z", "commit": {"oid": "8e66bfc02425317763717538e6c6ee092396b6e8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 332, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}