{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MzgwMjgy", "number": 2549, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNzoyMDo1OFrOE7okwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNzoyMDo1OFrOE7okwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwOTY2MjA4OnYy", "diffSide": "RIGHT", "path": "java/java.lsp.server/vscode/src/test/suite/extension.test.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNzoyMDo1OFrOH3Y-zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxODowNzozNVrOH3beLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg0MzAyMA==", "bodyText": "Can you help, @dbalek? I need to wait for the java.workspace.compile task to finish and just using await isn't enough.  Instead I have to setTimeout(_, 20s) and that isn't pretty at all.", "url": "https://github.com/apache/netbeans/pull/2549#discussion_r527843020", "createdAt": "2020-11-20T17:20:58Z", "author": {"login": "JaroslavTulach"}, "path": "java/java.lsp.server/vscode/src/test/suite/extension.test.ts", "diffHunk": "@@ -21,4 +28,56 @@ suite('Extension Test Suite', () => {\n \t\t}\n \t\tassert.ok(cannotReassignVersion, \"Cannot reassign value of version\");\n \t});\n+\ttest(\"Compile workspace\", async () => {\n+\t\tlet folder: string = assertWorkspace();\n+\n+\t\tfs.writeFileSync(path.join(folder, 'pom.xml'), `\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <groupId>org.netbeans.demo.vscode.t1</groupId>\n+    <artifactId>basicapp</artifactId>\n+    <version>1.0</version>\n+    <properties>\n+        <maven.compiler.source>1.8</maven.compiler.source>\n+        <maven.compiler.target>1.8</maven.compiler.target>\n+    </properties>\n+</project>\n+\t\t`);\n+\n+\t\tlet pkg = path.join(folder, 'src', 'main', 'java', 'pkg');\n+\t\tlet mainJava = path.join(pkg, 'Main.java');\n+\n+\t\tfs.mkdirSync(pkg, { recursive: true });\n+\t\tfs.writeFileSync(mainJava, `\n+package pkg;\n+class Main {\n+\tpublic static void main(String... args) {\n+\t\tSystem.out.println(\"Hello World!\");\n+\t}\n+}\n+\t\t`);\n+\n+\t\tvscode.workspace.saveAll();\n+\n+\t\tlet delayPromise = new Promise((r) => setTimeout(r, 20000));\n+\t\tvscode.window.showInformationMessage('Invoking compile command');\n+\t\tawait vscode.commands.executeCommand(\"java.workspace.compile\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "263da69b2f7e254b3a5ed52ca54e79612fda1c98"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg4MzgyMg==", "bodyText": "f217836 might be the right answer.", "url": "https://github.com/apache/netbeans/pull/2549#discussion_r527883822", "createdAt": "2020-11-20T18:07:35Z", "author": {"login": "JaroslavTulach"}, "path": "java/java.lsp.server/vscode/src/test/suite/extension.test.ts", "diffHunk": "@@ -21,4 +28,56 @@ suite('Extension Test Suite', () => {\n \t\t}\n \t\tassert.ok(cannotReassignVersion, \"Cannot reassign value of version\");\n \t});\n+\ttest(\"Compile workspace\", async () => {\n+\t\tlet folder: string = assertWorkspace();\n+\n+\t\tfs.writeFileSync(path.join(folder, 'pom.xml'), `\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <groupId>org.netbeans.demo.vscode.t1</groupId>\n+    <artifactId>basicapp</artifactId>\n+    <version>1.0</version>\n+    <properties>\n+        <maven.compiler.source>1.8</maven.compiler.source>\n+        <maven.compiler.target>1.8</maven.compiler.target>\n+    </properties>\n+</project>\n+\t\t`);\n+\n+\t\tlet pkg = path.join(folder, 'src', 'main', 'java', 'pkg');\n+\t\tlet mainJava = path.join(pkg, 'Main.java');\n+\n+\t\tfs.mkdirSync(pkg, { recursive: true });\n+\t\tfs.writeFileSync(mainJava, `\n+package pkg;\n+class Main {\n+\tpublic static void main(String... args) {\n+\t\tSystem.out.println(\"Hello World!\");\n+\t}\n+}\n+\t\t`);\n+\n+\t\tvscode.workspace.saveAll();\n+\n+\t\tlet delayPromise = new Promise((r) => setTimeout(r, 20000));\n+\t\tvscode.window.showInformationMessage('Invoking compile command');\n+\t\tawait vscode.commands.executeCommand(\"java.workspace.compile\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg0MzAyMA=="}, "originalCommit": {"oid": "263da69b2f7e254b3a5ed52ca54e79612fda1c98"}, "originalPosition": 57}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 241, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}