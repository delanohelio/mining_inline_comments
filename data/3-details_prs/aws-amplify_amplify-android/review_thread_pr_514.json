{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMTE1NTMz", "number": 514, "reviewThreads": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTo1OToxN1rOD_DrgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoyNDoxOVrOD_Go0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDQ3MTY5OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTo1OToxN1rOGZiX2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTo1OToxN1rOGZiX2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMDc0NQ==", "bodyText": "So long as it gets caught internally and then composed into an ApiException, this is probably good", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429430745", "createdAt": "2020-05-22T19:59:17Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -237,10 +235,9 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDQ3MzQ1OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowMDoyMVrOGZiY-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMjoxNTo1OFrOGZlJcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTAzNQ==", "bodyText": "By the time you reference this as Outer.Inner, it\u2019ll be quite long. Can we shorten the expression of this exception, somehow?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431035", "createdAt": "2020-05-22T20:00:21Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 194}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ3NjIwOQ==", "bodyText": "I changed this to use IllegalStateException. I talked to @TrekSoft about this offline and the idea here is that those methods should only throw errors in case there's a problem with the ode during development time. Only a faulty ModelSchema will result in that code throwing an error which means either the CLI generated something wrong, that although it compiles, our code is not prepare to handle (a bug) or customers changed their models manually and produced something invalid (highly unlikely, can't think of a real scenario here).\nTherefore, I think it's fair to have a RuntimeException here, no app user input can really result in a failure, at least not in this layer of the logic.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429476209", "createdAt": "2020-05-22T22:15:58Z", "author": {"login": "drochetti"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTAzNQ=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 194}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDQ3NTgwOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowMTozNlrOGZiafQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowMTozNlrOGZiafQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTQyMQ==", "bodyText": "Change to default system runtime exception - such as InvalidParameter", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431421", "createdAt": "2020-05-22T20:01:36Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -93,18 +93,17 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDQ4MTEwOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowNDoxN1rOGZid9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTowMToyMVrOGZjiiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA==", "bodyText": "Don't use Report bug for these types", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429432308", "createdAt": "2020-05-22T20:04:17Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n+\n+        private static final long serialVersionUID = 1L;\n+\n+        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n+            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 199}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ0OTg2Nw==", "bodyText": "Yea, the AmplifyException has the strongly modeled recovery exception. I don't think we should inline the recovery suggestions into causes. I'm imagining that this InvalidGraphQLRequestRuntimeException gets composed into an ApiException, before being returned to the customer. If that's so, then we'd have two recovery suggestions. This one, then the one in ApiException.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429449867", "createdAt": "2020-05-22T21:01:21Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n+\n+        private static final long serialVersionUID = 1L;\n+\n+        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n+            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 199}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDUwMjkwOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoxNDoxNFrOGZirKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTo1Mzo1OFrOGZkngg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ==", "bodyText": "Unused param", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429435691", "createdAt": "2020-05-22T20:14:14Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDI5MA==", "bodyText": "It's a public API, the implementation needs to be updated after release to use the token. At least, I think that's whats being stated here, right, @drochetti?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450290", "createdAt": "2020-05-22T21:02:57Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2NzUyMg==", "bodyText": "That's correct. It was a mistake, already fixed.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429467522", "createdAt": "2020-05-22T21:53:58Z", "author": {"login": "drochetti"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDUxNjk0OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyMzo0NFrOGZiz3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyMzo0NFrOGZiz3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNzkxNw==", "bodyText": "Remove comment", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429437917", "createdAt": "2020-05-22T20:23:44Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -121,6 +121,7 @@ public void syncUpToCloudIsWorking() throws AmplifyException {\n         publishedMutationsAccumulator.await();\n \n         // Try to get Charley from the backend.\n+//        BlogOwner remoteCharley = api.get(BlogOwner.class, localCharley.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDUyMjExOnYy", "diffSide": "RIGHT", "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyNzowN1rOGZi3QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyNzowN1rOGZi3QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzODc4NA==", "bodyText": "Not important for this PR, but this should be R, not T.   This was something I missed in my PR.  We can fix it later without it being a breaking change though.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429438784", "createdAt": "2020-05-22T20:27:07Z", "author": {"login": "richardmcclellan"}, "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java", "diffHunk": "@@ -50,134 +46,44 @@\n         this.api = api;\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(@NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, searchCriteria, onResult, onError));\n-\n-    }\n-\n     @NonNull\n     public <R> Single<GraphQLResponse<R>> query(@NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, searchCriteria, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <R> Single<GraphQLResponse<R>> query(\n             @NonNull String apiName, @NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(apiName, graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationType, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull QueryPredicate mutationCriteria, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationCriteria, mutationType, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <T> Single<GraphQLResponse<T>> mutate(@NonNull GraphQLRequest<T> graphQlRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDU5OTU2OnYy", "diffSide": "RIGHT", "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTowNTowMFrOGZjmgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMjoxMjo0MVrOGZlG3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDg4MA==", "bodyText": "ModelQuery is a good name, based on what the class does.\nHowever, when a customer uses it, they might prefer to write like:\napi.query(Where.modelClass(BlogOwner.class), ..., ...)\n\nor something like what we did for the QueryOptions.\nMaybe just,\napi.query(Models.ofType(BlogOwner.class)\n\nThat way we at least have a separate Models.java to put factory methods into, that know about <T extends Model> (I forget where it landed, but Where doesn't know about <T extends Model>, right?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450880", "createdAt": "2020-05-22T21:05:00Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -145,7 +143,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n         GraphQLResponse<Iterable<BlogOwner>> actualResponse =\n             Await.<GraphQLResponse<Iterable<BlogOwner>>, ApiException>result(((onResult, onError) ->\n-                plugin.query(BlogOwner.class, onResult, onError)\n+                plugin.query(ModelQuery.list(BlogOwner.class), onResult, onError)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ3NTU1MA==", "bodyText": "I think there's a difference here between that solution in DataStore and this one in API. Here we're not trying to hide the fact that it's GraphQL behind the scenes. Actually Amplify.API.mutate() and Amplify.API.query() makes that very explicit.\nTherefore, the factory methods here resemble the GraphQL statements:\nModelQuery.get(Todo.class) is query getTodo()\nModelMutation.create(todo) is mutation createTodo({})\netc\nWith static imports the syntax becomes even closer:\nAmplify.API.query(get(Todo.class)); // query getTodo()\nAmplify.API.mutate(update(todo)); // mutation updateTodo()\nThe PR description in the iOS repo also gives an idea of the experience there and how this Android builders were design to follow that same path: aws-amplify/amplify-ios#470", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429475550", "createdAt": "2020-05-22T22:12:41Z", "author": {"login": "drochetti"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -145,7 +143,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n         GraphQLResponse<Iterable<BlogOwner>> actualResponse =\n             Await.<GraphQLResponse<Iterable<BlogOwner>>, ApiException>result(((onResult, onError) ->\n-                plugin.query(BlogOwner.class, onResult, onError)\n+                plugin.query(ModelQuery.list(BlogOwner.class), onResult, onError)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDg4MA=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDYwMzg2OnYy", "diffSide": "RIGHT", "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTowNzozMVrOGZjpMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTowNzozMVrOGZjpMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MTU3MA==", "bodyText": "Can you remove the full qualification here, by adding an import for it?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429451570", "createdAt": "2020-05-22T21:07:31Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -159,7 +157,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n     /**\n      * It should be possible to perform a successful call to\n-     * {@link AWSApiPlugin#mutate(Model, MutationType, Consumer, Consumer)}.\n+     * {@link AWSApiPlugin#mutate(com.amplifyframework.api.graphql.GraphQLRequest, Consumer, Consumer)}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDY2OTU2OnYy", "diffSide": "RIGHT", "path": "rxbindings/build.gradle", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTozNjoyN1rOGZkR5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMzoxMjo0NVrOGZlvYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2MTk5MQ==", "bodyText": "Let's just kill all the tests that use models, or change model to string. The rxbinding (even tests) should only know about the core module, not any plugin.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429461991", "createdAt": "2020-05-22T21:36:27Z", "author": {"login": "jamesonwilliams"}, "path": "rxbindings/build.gradle", "diffHunk": "@@ -30,4 +30,5 @@ dependencies {\n         // https://github.com/robolectric/robolectric/issues/5245\n         exclude group: 'com.google.auto.service', module: 'auto-service'\n     }\n+    testImplementation project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ3MTA5Nw==", "bodyText": "I'm afraid this has a big impact in how tests were written initially. I would be nervous to make that change given the size of this PR.\nIn the future I assume we would be able to change this dependency into the shared module one, like we do in iOS.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429471097", "createdAt": "2020-05-22T21:58:59Z", "author": {"login": "drochetti"}, "path": "rxbindings/build.gradle", "diffHunk": "@@ -30,4 +30,5 @@ dependencies {\n         // https://github.com/robolectric/robolectric/issues/5245\n         exclude group: 'com.google.auto.service', module: 'auto-service'\n     }\n+    testImplementation project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2MTk5MQ=="}, "originalCommit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ4NTkyMQ==", "bodyText": "spoke offline and I was able to understand what Jameson suggested. This was fixed.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429485921", "createdAt": "2020-05-22T23:12:45Z", "author": {"login": "drochetti"}, "path": "rxbindings/build.gradle", "diffHunk": "@@ -30,4 +30,5 @@ dependencies {\n         // https://github.com/robolectric/robolectric/issues/5245\n         exclude group: 'com.google.auto.service', module: 'auto-service'\n     }\n+    testImplementation project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2MTk5MQ=="}, "originalCommit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDg0OTYwOnYy", "diffSide": "RIGHT", "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMzo0NDozNlrOGZmCEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMDoxMzo1MVrOGZmRvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5MDcwNw==", "bodyText": "Hmm..\nR represents the data on a GraphQLResponse\nT represents the Model type (or actually it looks like you've renamed most of these to M in this PR, which makes more sense than T anyway.\nSo, this should either return a GraphQLRequest<R> or a GraphQLRequest<Iterable<T>>, NOT a GraphQLRequest<Iterable<R>>", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429490707", "createdAt": "2020-05-22T23:44:36Z", "author": {"login": "richardmcclellan"}, "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java", "diffHunk": "@@ -381,4 +378,16 @@ public void httpPostEmitsResult() {\n         verify(delegate)\n             .post(eq(options), anyConsumer(), anyConsumer());\n     }\n+\n+    private static <R> GraphQLRequest<R> createMockMutationRequest(Class<R> responseType) {\n+        return new GraphQLRequest<R>(\"\", responseType, null);\n+    }\n+\n+    private static <R> GraphQLRequest<Iterable<R>> createMockListRequest(Class<R> responseType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5NDcxNw==", "bodyText": "updated everything here to T", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429494717", "createdAt": "2020-05-23T00:13:51Z", "author": {"login": "drochetti"}, "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java", "diffHunk": "@@ -381,4 +378,16 @@ public void httpPostEmitsResult() {\n         verify(delegate)\n             .post(eq(options), anyConsumer(), anyConsumer());\n     }\n+\n+    private static <R> GraphQLRequest<R> createMockMutationRequest(Class<R> responseType) {\n+        return new GraphQLRequest<R>(\"\", responseType, null);\n+    }\n+\n+    private static <R> GraphQLRequest<Iterable<R>> createMockListRequest(Class<R> responseType) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5MDcwNw=="}, "originalCommit": {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDkxOTQxOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMToxMzo0NFrOGZmpvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMTo1MjozOVrOGZm1jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMDg2MQ==", "bodyText": "Instead of all of these, you can do:\n@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n\nOn top of the class definition. This will disable the check for the entire class.\nOf rouse, better would be to write the docs. But, the suppression is still better than the not-filled-in stuff, I think.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429500861", "createdAt": "2020-05-23T01:13:44Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -160,20 +186,29 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n-                    exception,\n-                    \"Check the included exception for more details\"\n+                    exception\n             );\n         }\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMzg4NQ==", "bodyText": "I added the docs. Most of them are very similar to the ones in ModelQuery/ModelMutation/ModelSubscription", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429503885", "createdAt": "2020-05-23T01:52:39Z", "author": {"login": "drochetti"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -160,20 +186,29 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n-                    exception,\n-                    \"Check the included exception for more details\"\n+                    exception\n             );\n         }\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMDg2MQ=="}, "originalCommit": {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDk1MTU0OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoxMzo0OVrOGZm7WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoxMzo0OVrOGZm7WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNTM2OQ==", "bodyText": "correct correct => correct", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429505369", "createdAt": "2020-05-23T02:13:49Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -65,13 +65,16 @@\n     private AppSyncGraphQLRequestFactory() { }\n \n     /**\n-     * TODO.\n-     * @param modelClass todo.\n-     * @param objectId todo.\n-     * @param <R> todo.\n-     * @param <T> todo.\n-     * @return todo.\n-     * @throws IllegalStateException todo.\n+     * Creates a {@link GraphQLRequest} that represents a query that expects a single value as a result.\n+     * The request will be created with the correct correct document based on the model schema and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NDk1NjM0OnYy", "diffSide": "RIGHT", "path": "testutils/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoyNDoxOVrOGZm92A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjo0NzozMFrOGZnDIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNjAwOA==", "bodyText": "Ah! It's over here, now. :-D This doesn't bother me as much though. Being a purist about our dependency hierarchy in test code is less important.\nNot for this PR --\nProbably, though, we should migrate SyncrhonousApi so that it only contains methods that resemble ApiCategoryBehavior, sans-callbacks.\nLike:\nvoid asyncFoo(Bar bar, Consumer<Ok> onOk, Conusmer<NotOk> onNotOk);\n\n-->\nOk syncFoo(Bar bar) throws NotOk", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429506008", "createdAt": "2020-05-23T02:24:19Z", "author": {"login": "jamesonwilliams"}, "path": "testutils/build.gradle", "diffHunk": "@@ -22,4 +22,8 @@ dependencies {\n     implementation dependency.junit\n     implementation dependency.androidx.test.core\n     implementation dependency.rxjava\n+\n+    // dependency on Model/GraphQL integration classes\n+    // remove when modules are re-organized to provide better isolation\n+    compileOnly project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNzM2Mg==", "bodyText": "Probably, though, we should migrate SyncrhonousApi so that it only contains methods that resemble ApiCategoryBehavior, sans-callbacks.\n\nI like that idea! Make it implement the ApiCategoryBehavior so it adheres to the contract.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429507362", "createdAt": "2020-05-23T02:47:30Z", "author": {"login": "drochetti"}, "path": "testutils/build.gradle", "diffHunk": "@@ -22,4 +22,8 @@ dependencies {\n     implementation dependency.junit\n     implementation dependency.androidx.test.core\n     implementation dependency.rxjava\n+\n+    // dependency on Model/GraphQL integration classes\n+    // remove when modules are re-organized to provide better isolation\n+    compileOnly project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNjAwOA=="}, "originalCommit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1312, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}