{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxODMwNjcz", "number": 744, "title": "chore(core) Enable logging during unit tests", "bodyText": "This enables logging to the console window when running unit tests.  The AndroidLogger, which relies on android.util.Log does not work during unit tests, since it relies on the Android library, which is not available during unit tests.    There is now a new JavaLogger which is used instead, if run from a unit test.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-08-21T19:59:05Z", "url": "https://github.com/aws-amplify/amplify-android/pull/744", "merged": true, "mergeCommit": {"oid": "088c588eb2e72963fe0a6fd5f2c5273b7cbd212b"}, "closed": true, "closedAt": "2020-08-27T15:56:17Z", "author": {"login": "richardmcclellan"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBKMLrgH2gAyNDcxODMwNjczOmNkMGMxNTJhNDYyYzczOWYyZGNhNjI5ZjcyYjM0MmQyYzI1MzIxMzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDBgRpAFqTQ3Njc5MzA1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cd0c152a462c739f2dca629f72b342d2c2532130", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/cd0c152a462c739f2dca629f72b342d2c2532130", "committedDate": "2020-08-21T19:43:31Z", "message": "chore(core) Enable logging during unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyODkyMjYy", "url": "https://github.com/aws-amplify/amplify-android/pull/744#pullrequestreview-472892262", "createdAt": "2020-08-22T03:02:47Z", "commit": {"oid": "cd0c152a462c739f2dca629f72b342d2c2532130"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8df53c572ec3214ca190863fac591ef51b54e71f", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/8df53c572ec3214ca190863fac591ef51b54e71f", "committedDate": "2020-08-24T19:12:38Z", "message": "Merge branch 'main' into rm/logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3c689692a1a18b6347303791340bb8b1941cb8a", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/c3c689692a1a18b6347303791340bb8b1941cb8a", "committedDate": "2020-08-25T15:01:34Z", "message": "Merge branch 'main' into rm/logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1ODM3MjY0", "url": "https://github.com/aws-amplify/amplify-android/pull/744#pullrequestreview-475837264", "createdAt": "2020-08-26T20:32:43Z", "commit": {"oid": "c3c689692a1a18b6347303791340bb8b1941cb8a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMDozMjo0M1rOHHcrDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMDozMjo0M1rOHHcrDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzU3MTg1Mw==", "bodyText": "The comment says LogLevel.INFO is used as the default logging threshold, but the constructor itself uses LogLevel.VERBOSE.", "url": "https://github.com/aws-amplify/amplify-android/pull/744#discussion_r477571853", "createdAt": "2020-08-26T20:32:43Z", "author": {"login": "eeatonaws"}, "path": "core/src/main/java/com/amplifyframework/logging/JavaLoggingPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.logging;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import org.json.JSONObject;\n+\n+/**\n+ * Implementation of the {@link LoggingCategoryBehavior} designed for use by unit tests,\n+ * which emits logs via {@code System.out.println()}.\n+ */\n+public final class JavaLoggingPlugin extends LoggingPlugin<Void> {\n+    private static final String AMPLIFY_NAMESPACE = \"amplify\";\n+    private final LogLevel defaultLoggerThreshold;\n+\n+    /**\n+     * Creates a logging plugin using {@link LogLevel#INFO} as the default", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3c689692a1a18b6347303791340bb8b1941cb8a"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00147b0d874ab590a8a902c8a4955bd3d87f8394", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/00147b0d874ab590a8a902c8a4955bd3d87f8394", "committedDate": "2020-08-26T20:45:18Z", "message": "INFO, not VERBOSE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7756e946374f590b95c4930b255d8f96a0c04694", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7756e946374f590b95c4930b255d8f96a0c04694", "committedDate": "2020-08-26T21:35:15Z", "message": "Merge branch 'main' into rm/logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a6762ad59dcc5cf535786a61c21b7760e64f839", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/6a6762ad59dcc5cf535786a61c21b7760e64f839", "committedDate": "2020-08-26T21:36:56Z", "message": "Implement new getVersion method from the Plugin interface, in the JavaLoggingPlugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzcxODky", "url": "https://github.com/aws-amplify/amplify-android/pull/744#pullrequestreview-476771892", "createdAt": "2020-08-27T14:22:35Z", "commit": {"oid": "6a6762ad59dcc5cf535786a61c21b7760e64f839"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNDoyMjozNVrOHISvRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNDoyMjozNVrOHISvRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQ1NzY3MA==", "bodyText": "Since the LogLevel passed in is not always LogLevel.ERROR, I think it would be more clear to rename the LogLevel error parameter to something like logLevel or just level.", "url": "https://github.com/aws-amplify/amplify-android/pull/744#discussion_r478457670", "createdAt": "2020-08-27T14:22:35Z", "author": {"login": "eeatonaws"}, "path": "core/src/main/java/com/amplifyframework/logging/JavaLogger.java", "diffHunk": "@@ -0,0 +1,119 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.logging;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import java.util.Objects;\n+\n+final class JavaLogger implements Logger {\n+    private final LogLevel threshold;\n+    private final String namespace;\n+\n+    JavaLogger(@NonNull String namespace, @NonNull LogLevel threshold) {\n+        this.threshold = Objects.requireNonNull(threshold);\n+        this.namespace = Objects.requireNonNull(namespace);\n+    }\n+\n+    @NonNull\n+    @Override\n+    public LogLevel getThresholdLevel() {\n+        return threshold;\n+    }\n+\n+    @NonNull\n+    @Override\n+    public String getNamespace() {\n+        return namespace;\n+    }\n+\n+    @Override\n+    public void error(@Nullable String message) {\n+        if (threshold.above(LogLevel.ERROR)) {\n+            return;\n+        }\n+        log(LogLevel.ERROR, message);\n+    }\n+\n+    @Override\n+    public void error(@Nullable String message, @Nullable Throwable error) {\n+        if (threshold.above(LogLevel.ERROR)) {\n+            return;\n+        }\n+        log(LogLevel.ERROR, message, error);\n+    }\n+\n+    @Override\n+    public void warn(@Nullable String message) {\n+        if (threshold.above(LogLevel.WARN)) {\n+            return;\n+        }\n+        log(LogLevel.WARN, message);\n+    }\n+\n+    @Override\n+    public void warn(@Nullable String message, @Nullable Throwable issue) {\n+        if (threshold.above(LogLevel.WARN)) {\n+            return;\n+        }\n+        log(LogLevel.WARN, message, issue);\n+    }\n+\n+    @Override\n+    public void info(@Nullable String message) {\n+        if (threshold.above(LogLevel.INFO)) {\n+            return;\n+        }\n+        log(LogLevel.INFO, message);\n+    }\n+\n+    @Override\n+    public void debug(@Nullable String message) {\n+        if (threshold.above(LogLevel.DEBUG)) {\n+            return;\n+        }\n+        log(LogLevel.DEBUG, message);\n+    }\n+\n+    @Override\n+    public void verbose(@Nullable String message) {\n+        if (threshold.above(LogLevel.VERBOSE)) {\n+            return;\n+        }\n+        log(LogLevel.VERBOSE, message);\n+    }\n+\n+    private void log(@NonNull LogLevel error, @Nullable String message) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a6762ad59dcc5cf535786a61c21b7760e64f839"}, "originalPosition": 100}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ca9a9c4deff2309267e2b81368a940088d32d80", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/5ca9a9c4deff2309267e2b81368a940088d32d80", "committedDate": "2020-08-27T14:29:46Z", "message": "level, not error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzkzMDU3", "url": "https://github.com/aws-amplify/amplify-android/pull/744#pullrequestreview-476793057", "createdAt": "2020-08-27T14:44:10Z", "commit": {"oid": "5ca9a9c4deff2309267e2b81368a940088d32d80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1978, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}