{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNTc4MTk2", "number": 506, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1NToxMVrOD-v1NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNjo1MjowM1rOD-2MSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTIxOTczOnYy", "diffSide": "RIGHT", "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1NToxMVrOGZCi2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1NToxMVrOGZCi2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwOTI3NA==", "bodyText": "\"AWSPredictionsPlugin\"", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428909274", "createdAt": "2020-05-21T20:55:11Z", "author": {"login": "raphkim"}, "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "diffHunk": "@@ -79,7 +91,26 @@ public String getPluginKey() {\n     @Override\n     public void configure(JSONObject pluginConfiguration, @NonNull Context context) throws PredictionsException {\n         this.configuration = AWSPredictionsPluginConfiguration.fromJson(pluginConfiguration);\n-        this.predictionsService = new AWSPredictionsService(configuration);\n+\n+        AWSCredentialsProvider credentialsProvider;\n+\n+        if (credentialsProviderOverride != null) {\n+            credentialsProvider = credentialsProviderOverride;\n+        } else {\n+            try {\n+                credentialsProvider =\n+                        (AWSMobileClient) Amplify.Auth.getPlugin(AUTH_DEPENDENCY_PLUGIN_KEY).getEscapeHatch();\n+            } catch (IllegalStateException exception) {\n+                throw new PredictionsException(\n+                        \"AWSPredictionsPlugin depends on AWSCognitoAuthPlugin but it is currently missing\",\n+                        exception,\n+                        \"Before configuring Amplify, be sure to add AWSPredictionsPlugin same as you added \" +\n+                                \"AWSPinpointAnalyticsPlugin.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTIyODkzOnYy", "diffSide": "RIGHT", "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1ODowNlrOGZCokQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1ODowNlrOGZCokQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkxMDczNw==", "bodyText": "i think the general pattern should be\npublic AWSPredictionsPlugin() {\n    this(null);\n}\n\n@VisibleForTesting\nAWSPredictionsPlugin(AWSCredentialsProvider provider) {\n    ...\n}\n\nSo that credentialsProviderOverride is explicitly assigned in both cases.", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428910737", "createdAt": "2020-05-21T20:58:06Z", "author": {"login": "raphkim"}, "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "diffHunk": "@@ -70,6 +76,12 @@ public AWSPredictionsPlugin() {\n         this.executorService = Executors.newCachedThreadPool();\n     }\n \n+    @VisibleForTesting\n+    AWSPredictionsPlugin(AWSCredentialsProvider credentialsProviderOverride) {\n+        this();\n+        this.credentialsProviderOverride = credentialsProviderOverride;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTIzMzYyOnYy", "diffSide": "RIGHT", "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1OToyN1rOGZCrYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo1OToyN1rOGZCrYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkxMTQ1Ng==", "bodyText": "nit: punctuation\n\"AWSPredictionsPlugin depends on AWSCognitoAuthPlugin, but it is currently missing.\"", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428911456", "createdAt": "2020-05-21T20:59:27Z", "author": {"login": "raphkim"}, "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "diffHunk": "@@ -79,7 +91,26 @@ public String getPluginKey() {\n     @Override\n     public void configure(JSONObject pluginConfiguration, @NonNull Context context) throws PredictionsException {\n         this.configuration = AWSPredictionsPluginConfiguration.fromJson(pluginConfiguration);\n-        this.predictionsService = new AWSPredictionsService(configuration);\n+\n+        AWSCredentialsProvider credentialsProvider;\n+\n+        if (credentialsProviderOverride != null) {\n+            credentialsProvider = credentialsProviderOverride;\n+        } else {\n+            try {\n+                credentialsProvider =\n+                        (AWSMobileClient) Amplify.Auth.getPlugin(AUTH_DEPENDENCY_PLUGIN_KEY).getEscapeHatch();\n+            } catch (IllegalStateException exception) {\n+                throw new PredictionsException(\n+                        \"AWSPredictionsPlugin depends on AWSCognitoAuthPlugin but it is currently missing\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTQ5MjQwOnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjozNjo0M1rOGZFLTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1ODoxNVrOGZFlVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1MjM5OQ==", "bodyText": "I do wonder idly if we could do a kludge a thing where we listen to the logs and reply them all as DEBUG.  A bad idea for later maybe.", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428952399", "createdAt": "2020-05-21T22:36:43Z", "author": {"login": "jpignata"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -119,6 +123,7 @@ public void configure(\n     ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n         final AtomicReference<Exception> asyncException = new AtomicReference<>();\n+        LogFactory.setLevel(LogFactory.Level.OFF);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1OTA2MQ==", "bodyText": "Maybe - I kinda want to get away from logging stuff in favor of Hub and Callbacks but we should discuss as a team what we want our policy to be on that,", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428959061", "createdAt": "2020-05-21T22:58:15Z", "author": {"login": "TrekSoft"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -119,6 +123,7 @@ public void configure(\n     ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n         final AtomicReference<Exception> asyncException = new AtomicReference<>();\n+        LogFactory.setLevel(LogFactory.Level.OFF);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1MjM5OQ=="}, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUwMDM5OnYy", "diffSide": "RIGHT", "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo0MDo1NlrOGZFQVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1NzozNVrOGZFkcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1MzY4Nw==", "bodyText": "Copypasta.", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428953687", "createdAt": "2020-05-21T22:40:56Z", "author": {"login": "jpignata"}, "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "diffHunk": "@@ -79,7 +91,26 @@ public String getPluginKey() {\n     @Override\n     public void configure(JSONObject pluginConfiguration, @NonNull Context context) throws PredictionsException {\n         this.configuration = AWSPredictionsPluginConfiguration.fromJson(pluginConfiguration);\n-        this.predictionsService = new AWSPredictionsService(configuration);\n+\n+        AWSCredentialsProvider credentialsProvider;\n+\n+        if (credentialsProviderOverride != null) {\n+            credentialsProvider = credentialsProviderOverride;\n+        } else {\n+            try {\n+                credentialsProvider =\n+                        (AWSMobileClient) Amplify.Auth.getPlugin(AUTH_DEPENDENCY_PLUGIN_KEY).getEscapeHatch();\n+            } catch (IllegalStateException exception) {\n+                throw new PredictionsException(\n+                        \"AWSPredictionsPlugin depends on AWSCognitoAuthPlugin but it is currently missing\",\n+                        exception,\n+                        \"Before configuring Amplify, be sure to add AWSPredictionsPlugin same as you added \" +\n+                                \"AWSPinpointAnalyticsPlugin.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODgzNA==", "bodyText": "Yeah gonna clean this all up after GA - it's all throughout the framework.", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428958834", "createdAt": "2020-05-21T22:57:35Z", "author": {"login": "TrekSoft"}, "path": "aws-predictions/src/main/java/com/amplifyframework/predictions/aws/AWSPredictionsPlugin.java", "diffHunk": "@@ -79,7 +91,26 @@ public String getPluginKey() {\n     @Override\n     public void configure(JSONObject pluginConfiguration, @NonNull Context context) throws PredictionsException {\n         this.configuration = AWSPredictionsPluginConfiguration.fromJson(pluginConfiguration);\n-        this.predictionsService = new AWSPredictionsService(configuration);\n+\n+        AWSCredentialsProvider credentialsProvider;\n+\n+        if (credentialsProviderOverride != null) {\n+            credentialsProvider = credentialsProviderOverride;\n+        } else {\n+            try {\n+                credentialsProvider =\n+                        (AWSMobileClient) Amplify.Auth.getPlugin(AUTH_DEPENDENCY_PLUGIN_KEY).getEscapeHatch();\n+            } catch (IllegalStateException exception) {\n+                throw new PredictionsException(\n+                        \"AWSPredictionsPlugin depends on AWSCognitoAuthPlugin but it is currently missing\",\n+                        exception,\n+                        \"Before configuring Amplify, be sure to add AWSPredictionsPlugin same as you added \" +\n+                                \"AWSPinpointAnalyticsPlugin.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1MzY4Nw=="}, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUwMzQ1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/options/AuthSignOutOptions.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo0MjozOFrOGZFSOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1OTowOFrOGZFmUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1NDE3MA==", "bodyText": "This formatting seems curious?", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428954170", "createdAt": "2020-05-21T22:42:38Z", "author": {"login": "jpignata"}, "path": "core/src/main/java/com/amplifyframework/auth/options/AuthSignOutOptions.java", "diffHunk": "@@ -0,0 +1,143 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.options;\n+\n+import androidx.annotation.NonNull;\n+import androidx.core.util.ObjectsCompat;\n+\n+/**\n+ * Advanced options for signing out.\n+ */\n+public class AuthSignOutOptions {\n+    private final boolean globalSignOut;\n+\n+    /**\n+     * Advanced options for signing up.\n+     * @param globalSignOut Sign out of all devices\n+     */\n+    protected AuthSignOutOptions(\n+            boolean globalSignOut", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1OTMxNA==", "bodyText": "How so?", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r428959314", "createdAt": "2020-05-21T22:59:08Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/options/AuthSignOutOptions.java", "diffHunk": "@@ -0,0 +1,143 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.options;\n+\n+import androidx.annotation.NonNull;\n+import androidx.core.util.ObjectsCompat;\n+\n+/**\n+ * Advanced options for signing out.\n+ */\n+public class AuthSignOutOptions {\n+    private final boolean globalSignOut;\n+\n+    /**\n+     * Advanced options for signing up.\n+     * @param globalSignOut Sign out of all devices\n+     */\n+    protected AuthSignOutOptions(\n+            boolean globalSignOut", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1NDE3MA=="}, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MjI2MTg2OnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNjo1MjowM1rOGZMiyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNjo1MjowM1rOGZMiyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA3MzA5Ng==", "bodyText": "Is this for turning off mobile client logs?", "url": "https://github.com/aws-amplify/amplify-android/pull/506#discussion_r429073096", "createdAt": "2020-05-22T06:52:03Z", "author": {"login": "raphkim"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -119,6 +123,7 @@ public void configure(\n     ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n         final AtomicReference<Exception> asyncException = new AtomicReference<>();\n+        LogFactory.setLevel(LogFactory.Level.OFF);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf542bc1005c70e0df8b2df81590678a4d1c688d"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1303, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}