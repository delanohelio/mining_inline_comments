{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NTI2Njk3", "number": 670, "title": "chore(datastore) Represent lastChangedAt as Temporal.Timestamp instead of long", "bodyText": "lastChangedAt, part of ModelMetadata is represented as an AWSTimestamp by AppSync, so we should represent it as such on the client with Temporal.Timestamp, instead of Long.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-07-24T23:17:54Z", "url": "https://github.com/aws-amplify/amplify-android/pull/670", "merged": true, "mergeCommit": {"oid": "46c1a1be8bc93292da1aec348d2959b91ad70bb5"}, "closed": true, "closedAt": "2020-09-16T04:21:00Z", "author": {"login": "richardmcclellan"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4MY1vAH2gAyNDU2NTI2Njk3OjM4OGQ3NjdmY2ExNWExYWVhYTM1OTMwMzQxODVlMmU3ZjA4NzhkMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJUUmEgH2gAyNDU2NTI2Njk3OjExMWIyZWRiZDBlMTUxMDhiZWI4NDU5OGMyNWRiOWFjZmU2MGM2YTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/388d767fca15a1aeaa3593034185e2e7f0878d09", "committedDate": "2020-07-24T23:11:50Z", "message": "chore(datastore) Represent lastChangedAt as Temporal.Timestamp instead of long"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MjY0MjIz", "url": "https://github.com/aws-amplify/amplify-android/pull/670#pullrequestreview-455264223", "createdAt": "2020-07-25T05:56:48Z", "commit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNTo1Njo0OFrOG3Cwag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNTo1ODoxMlrOG3CwtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM3MDAyNg==", "bodyText": "Will this require the SQL table to be reprovisioned?", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r460370026", "createdAt": "2020-07-25T05:56:48Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/appsync/ModelMetadata.java", "diffHunk": "@@ -37,7 +38,7 @@\n     private final @ModelField(targetType = \"ID\", isRequired = true) String id;\n     private final @ModelField(targetType = \"Boolean\") Boolean _deleted;\n     private final @ModelField(targetType = \"Int\") Integer _version;\n-    private final @ModelField(targetType = \"AWSTimestamp\") Long _lastChangedAt;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM3MDA3MA==", "bodyText": "Why not your cool Temporal.now(), in all places, instead?", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r460370070", "createdAt": "2020-07-25T05:57:44Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/appsync/AppSyncMocking.java", "diffHunk": "@@ -101,7 +101,7 @@ public static CreateConfigurator onCreate(AppSync mock) {\n \n                 // Pass back a ModelWithMetadata. Model is the one provided.\n                 ModelMetadata metadata =\n-                    new ModelMetadata(capturedModel.getId(), false, 1, Time.now());\n+                    new ModelMetadata(capturedModel.getId(), false, 1, new Temporal.Timestamp());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM3MDEwMA==", "bodyText": "You could make a Temporal.timestamp(long, TimeUnit) util, too, that might be cool.", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r460370100", "createdAt": "2020-07-25T05:58:12Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/appsync/AppSyncResponseDeserializerTest.java", "diffHunk": "@@ -61,7 +61,7 @@ public void awsDateTypesCanBeDeserialized() {\n                 .build();\n         Boolean deleted = false;\n         Integer version = 42;\n-        Long lastChangedAt = Long.valueOf(1594858827);\n+        Temporal.Timestamp lastChangedAt = new Temporal.Timestamp(1594858827, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MjA4MDgx", "url": "https://github.com/aws-amplify/amplify-android/pull/670#pullrequestreview-456208081", "createdAt": "2020-07-27T23:44:05Z", "commit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMzo0NDowNVrOG33aMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMzo0Njo0NVrOG33dmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTIzMjY4OQ==", "bodyText": "nice \ud83d\udc4d", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r461232689", "createdAt": "2020-07-27T23:44:05Z", "author": {"login": "raphkim"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/core/model/temporal/Temporal.java", "diffHunk": "@@ -434,6 +434,14 @@ public Timestamp(@NonNull java.util.Date date) {\n             this(date.getTime(), TimeUnit.MILLISECONDS);\n         }\n \n+        /**\n+         * Returns a new Timestamp instance that represents the current system time.\n+         * @return a new Timestamp instance that represents the current system time.\n+         */\n+        public static Timestamp now() {\n+            return new Timestamp();\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTIzMzU2MA==", "bodyText": "Just making sure: this change is scoped only to model metadata right? Codegen won't be affected?", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r461233560", "createdAt": "2020-07-27T23:46:45Z", "author": {"login": "raphkim"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/appsync/ModelMetadata.java", "diffHunk": "@@ -37,7 +38,7 @@\n     private final @ModelField(targetType = \"ID\", isRequired = true) String id;\n     private final @ModelField(targetType = \"Boolean\") Boolean _deleted;\n     private final @ModelField(targetType = \"Int\") Integer _version;\n-    private final @ModelField(targetType = \"AWSTimestamp\") Long _lastChangedAt;\n+    private final @ModelField(targetType = \"AWSTimestamp\") Temporal.Timestamp _lastChangedAt;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "388d767fca15a1aeaa3593034185e2e7f0878d09"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48004f8bb6ce23e174c21b9ae6661749db042a70", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/48004f8bb6ce23e174c21b9ae6661749db042a70", "committedDate": "2020-08-03T16:07:08Z", "message": "Temporal.Timestamp.now()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTY4ODc1", "url": "https://github.com/aws-amplify/amplify-android/pull/670#pullrequestreview-461968875", "createdAt": "2020-08-05T19:41:58Z", "commit": {"oid": "48004f8bb6ce23e174c21b9ae6661749db042a70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxMjUwODY2", "url": "https://github.com/aws-amplify/amplify-android/pull/670#pullrequestreview-471250866", "createdAt": "2020-08-20T05:09:13Z", "commit": {"oid": "48004f8bb6ce23e174c21b9ae6661749db042a70"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNTowOToxM1rOHDp7aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNTowOToxM1rOHDp7aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzU5NDcyOA==", "bodyText": "We could potentially create Temporal.Timestamp.seconds(123_123L) and Temporal.Timestamp.milliseconds(123_123_000L) utility factories?", "url": "https://github.com/aws-amplify/amplify-android/pull/670#discussion_r473594728", "createdAt": "2020-08-20T05:09:13Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/appsync/TestModelWithMetadataInstances.java", "diffHunk": "@@ -53,12 +61,18 @@\n                 .rating(3)\n                 .id(\"83ceb757-c8c8-4b6a-bee0-a43afb53a73a\")\n                 .build(),\n-            new ModelMetadata(\"83ceb757-c8c8-4b6a-bee0-a43afb53a73a\", null, 5, 123123L)\n+            new ModelMetadata(\"83ceb757-c8c8-4b6a-bee0-a43afb53a73a\",\n+                    null,\n+                    5,\n+                    new Temporal.Timestamp(123123L, TimeUnit.SECONDS))\n         );\n     public static final ModelWithMetadata<Post> DELETED_DRUM_POST =\n         new ModelWithMetadata<>(\n             DRUM_POST.getModel(),\n-            new ModelMetadata(\"83ceb757-c8c8-4b6a-bee0-a43afb53a73a\", Boolean.TRUE, 5, 123123L)\n+            new ModelMetadata(\"83ceb757-c8c8-4b6a-bee0-a43afb53a73a\",\n+                    Boolean.TRUE,\n+                    5,\n+                    new Temporal.Timestamp(123123L, TimeUnit.SECONDS))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48004f8bb6ce23e174c21b9ae6661749db042a70"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f66d397a06e24cfb22eabb9cd1f2afd6538eed3", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/3f66d397a06e24cfb22eabb9cd1f2afd6538eed3", "committedDate": "2020-09-15T22:52:00Z", "message": "Merge from main"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e698cddadbae0ae30e9a66979fe662df245a1ac", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/0e698cddadbae0ae30e9a66979fe662df245a1ac", "committedDate": "2020-09-15T23:57:32Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c416dd86bb2c8f5bd64d9850b54b731b3cf6ff12", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/c416dd86bb2c8f5bd64d9850b54b731b3cf6ff12", "committedDate": "2020-09-16T01:24:26Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba5a39ff24d517d160a9ec905bd4d2736377b29b", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/ba5a39ff24d517d160a9ec905bd4d2736377b29b", "committedDate": "2020-09-16T03:56:57Z", "message": "compile error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "111b2edbd0e15108beb84598c25db9acfe60c6a8", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/111b2edbd0e15108beb84598c25db9acfe60c6a8", "committedDate": "2020-09-16T04:03:09Z", "message": "checkstyle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1898, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}