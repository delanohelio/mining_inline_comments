{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMDM0Njg4", "number": 355, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODoyNjo0NFrODvdBdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODozMjozMVrODvdKaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDg1MTc1OnYy", "diffSide": "RIGHT", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/TestStorageCategory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODoyNjo0NFrOGB4lKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDowNToxMlrOGCFMlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyODc3Nw==", "bodyText": "nit: Not sure if it's a convention that is documented somewhere, but I think context is always the first argument if it is required. It already bothers me that our configure methods break this pattern haha.", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404628777", "createdAt": "2020-04-07T08:26:44Z", "author": {"login": "raphkim"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/TestStorageCategory.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.core.AmplifyConfiguration;\n+import com.amplifyframework.core.category.CategoryConfiguration;\n+import com.amplifyframework.core.category.CategoryType;\n+import com.amplifyframework.storage.StorageCategory;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Factory for creating {@link StorageCategory} instance suitable for test.\n+ */\n+final class TestStorageCategory {\n+    private TestStorageCategory() {}\n+\n+    /**\n+     * Creates an instance of {@link StorageCategory} using the provided configuration resource.\n+     * @param resourceId Android resource ID for a configuration file\n+     * @param context Android Context\n+     * @return A StorageCategory instance using the provided configuration\n+     */\n+    static StorageCategory create(@RawRes int resourceId, @NonNull Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDgzNTQ3OA==", "bodyText": "Hmm, true. I've never seen that written anywhere, but it \"feels\" true enough... I'll update all locations in the PR.", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404835478", "createdAt": "2020-04-07T14:05:12Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/TestStorageCategory.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.core.AmplifyConfiguration;\n+import com.amplifyframework.core.category.CategoryConfiguration;\n+import com.amplifyframework.core.category.CategoryType;\n+import com.amplifyframework.storage.StorageCategory;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Factory for creating {@link StorageCategory} instance suitable for test.\n+ */\n+final class TestStorageCategory {\n+    private TestStorageCategory() {}\n+\n+    /**\n+     * Creates an instance of {@link StorageCategory} using the provided configuration resource.\n+     * @param resourceId Android resource ID for a configuration file\n+     * @param context Android Context\n+     * @return A StorageCategory instance using the provided configuration\n+     */\n+    static StorageCategory create(@RawRes int resourceId, @NonNull Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyODc3Nw=="}, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDg2MTc5OnYy", "diffSide": "RIGHT", "path": "testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousStorage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODoyOTowNlrOGB4rPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODoyOTowNlrOGB4rPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzMDMzMg==", "bodyText": "Hmm, I guess having smaller default value is fine since SynchronousStorage does allow timeout override for especially long operations (e.g. large file upload)", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404630332", "createdAt": "2020-04-07T08:29:06Z", "author": {"login": "raphkim"}, "path": "testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousStorage.java", "diffHunk": "@@ -38,25 +40,33 @@\n  * code, where we want to make a series of sequential assertions after\n  * performing various operations.\n  */\n-@SuppressWarnings(\"unused\")\n public final class SynchronousStorage {\n-    // 5 seconds seemed to be insufficient to reliably cover both initial auth calls + storage network ops\n-    private static final long STORAGE_OPERATION_TIMEOUT_MS = TimeUnit.SECONDS.toMillis(10);\n+    private static final long STORAGE_OPERATION_TIMEOUT_MS = TimeUnit.SECONDS.toMillis(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDg2OTg4OnYy", "diffSide": "RIGHT", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODozMToxM1rOGB4wWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDowNzoxMFrOGCFR-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzMTY0Mg==", "bodyText": "nit: context as first parameter?", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404631642", "createdAt": "2020-04-07T08:31:13Z", "author": {"login": "raphkim"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.testutils.Resources;\n+import com.amplifyframework.util.Immutable;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+final class UserCredentials implements Iterable<UserCredentials.Credential> {\n+    private static final String CREDENTIALS_RESOURCE_NAME = \"credentials\";\n+    private final List<Credential> credentials;\n+\n+    private UserCredentials(List<Credential> credentials) {\n+        this.credentials = credentials;\n+    }\n+\n+    static UserCredentials create(@NonNull IdentityIdSource identityIdSource, @NonNull Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDgzNjg1Ng==", "bodyText": "done", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404836856", "createdAt": "2020-04-07T14:07:10Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.testutils.Resources;\n+import com.amplifyframework.util.Immutable;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+final class UserCredentials implements Iterable<UserCredentials.Credential> {\n+    private static final String CREDENTIALS_RESOURCE_NAME = \"credentials\";\n+    private final List<Credential> credentials;\n+\n+    private UserCredentials(List<Credential> credentials) {\n+        this.credentials = credentials;\n+    }\n+\n+    static UserCredentials create(@NonNull IdentityIdSource identityIdSource, @NonNull Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzMTY0Mg=="}, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDg3NDY1OnYy", "diffSide": "RIGHT", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODozMjozMVrOGB4zYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDowNzowM1rOGCFRrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzMjQxNw==", "bodyText": "this is clean, and likely reusable for other categories like API :)\nAs far as I know, we lack tests for testing schemas that contain @auth", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404632417", "createdAt": "2020-04-07T08:32:31Z", "author": {"login": "raphkim"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.testutils.Resources;\n+import com.amplifyframework.util.Immutable;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+final class UserCredentials implements Iterable<UserCredentials.Credential> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDgzNjc4Mw==", "bodyText": "Thanks! Yea, it'd be cool to re-use this in the other modules.\nI started to move it into testutils. But I think right now the credentials.json is in the storage tests bucket in S3. Maybe we could move the two things at the same time, later.", "url": "https://github.com/aws-amplify/amplify-android/pull/355#discussion_r404836783", "createdAt": "2020-04-07T14:07:03Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/UserCredentials.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.storage.s3;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.RawRes;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.testutils.Resources;\n+import com.amplifyframework.util.Immutable;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+final class UserCredentials implements Iterable<UserCredentials.Credential> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzMjQxNw=="}, "originalCommit": {"oid": "deec96fe64c90e0ae8fb5d372be7d8e17ad623b3"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1405, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}