{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NzI0ODM1", "number": 635, "title": "feat(datastore) Add support for owner based auth", "bodyText": "Summary\n\nAppSyncGraphQLRequest changes:\n\nMoved it from aws-api to aws-api-appsync, so that it can be used by aws-datastore.  After doing this, I had to refactor the setOwner method to remove the dependency on CognitoUserPoolsAuthProvider since it is still in aws-api.\nThere are a couple of differences in the way API and DataStore need to build requests.  To describe these differences, I created an GraphQLRequestOptions interface, implemented by ApiGraphQLRequestOptions, and DataStoreGraphQLRequestOptions.  These options are now a required parameter of the AppSyncGraphQLRequest.Builder`\n\n\nSelectionSet\n\ntoString() now returns a pretty String (new lines and indents between fields and braces).  No functional difference, but this makes the expected request files used by unit tests more readable.\nAdded a Wrap.inPrettyBraces() helper method to support the above.\n\n\nOwner Based Auth for DataStore\n\nThis actually did not require any code changes specific to owner based auth.   Instead, the only thing required was to refactor AppSyncClient.subscription to use AppSyncGraphQLRequest instead of SimpleGraphQLRequest.  By doing this, the owner argument is now added if required in the AWSApiPlugin.subscribe  method.\n\n\n\nWhat problem does this solve?\nGiven a schema.graphql with an @auth directive, such as:\ntype Todo @model @auth(rules: [{ allow: owner }]) {\n  id: ID!\n  name: String!\n  description: String\n}\n\nAnd an Amplify app using the following plugins:\n        try {\n            Amplify.addPlugin(new AWSDataStorePlugin());\n            Amplify.addPlugin(new AWSCognitoAuthPlugin());\n            Amplify.addPlugin(new AWSApiPlugin());\n//            Amplify.addPlugin(new AWSPredictionsPlugin());\n            Amplify.configure(getApplicationContext());\n            Log.i(\"ApiQuickstart\", \"All set and ready to go!\");\n        } catch (AmplifyException exception) {\n            Log.e(\"ApiQuickstart\", exception.getMessage(), exception);\n        }\n\nThe following error will be shown when DataStore is initialized:\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: AmplifyException {message=Bad subscription data for Todo: [GraphQLResponse.Error{message='Validation error of type MissingFieldArgument: Missing field argument owner @ 'onDeleteTodo'', locations='null', path='null', extensions='null'}], cause=null, recoverySuggestion=Sorry, we don't have a suggested fix for this error yet.}\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.datastore.appsync.AppSyncClient.lambda$subscription$2$AppSyncClient(AppSyncClient.java:331)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.datastore.appsync.-$$Lambda$AppSyncClient$KK1x1_fo5sffWREukMLi8z0goy4.accept(Unknown Source:10)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.api.aws.SubscriptionEndpoint$Subscription.dispatchNextMessage(SubscriptionEndpoint.java:448)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.api.aws.SubscriptionEndpoint.notifySubscriptionData(SubscriptionEndpoint.java:304)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.api.aws.SubscriptionEndpoint.processJsonMessage(SubscriptionEndpoint.java:236)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.api.aws.SubscriptionEndpoint.access$100(SubscriptionEndpoint.java:55)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat com.amplifyframework.api.aws.SubscriptionEndpoint$1.onMessage(SubscriptionEndpoint.java:174)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.ws.RealWebSocket.onReadMessage(RealWebSocket.kt:333)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.ws.WebSocketReader.readMessageFrame(WebSocketReader.kt:245)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.ws.WebSocketReader.processNextFrame(WebSocketReader.kt:106)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.ws.RealWebSocket.loopReader(RealWebSocket.kt:293)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.ws.RealWebSocket$connect$1.onResponse(RealWebSocket.kt:195)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat okhttp3.internal.connection.RealCall$AsyncCall.run(RealCall.kt:504)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)\n07-14 17:26:12.329 25319 25594 W amplify:aws-datastore: \tat java.lang.Thread.run(Thread.java:919)\n\nWhat is the solution, and how should acceptance testing be done on this PR?\n\n\nCreate a new sample app, run amplify add api, configure auth to use Cognito User Pools, and make sure DataStore is enabled.  Then run amplify push.\n\n\nCodegen is being updated (aws-amplify/amplify-cli#4717) to annotate the generated models.  Until that change is released, you can manually update the generated model by replacing:\n\n\n@ModelConfig(pluralName = \"Todos\")\n\nwith:\n@ModelConfig(pluralName = \"Todos\", authRules = { @AuthRule(allow = AuthStrategy.OWNER )} )\n\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-07-11T05:54:43Z", "url": "https://github.com/aws-amplify/amplify-android/pull/635", "merged": true, "mergeCommit": {"oid": "28ab6f309e82a54d27056530e0b46216ab6678fa"}, "closed": true, "closedAt": "2020-07-15T15:23:00Z", "author": {"login": "richardmcclellan"}, "timelineItems": {"totalCount": 55, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcubfclgH2gAyNDQ3NzI0ODM1OjkyODI1MTBlOTFhZTNiZGQyN2Q3ZTQwYmQwZWE0M2NkZjk3YjIwN2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc091S9AH2gAyNDQ3NzI0ODM1OjdkMGM3ODA1YTZlMzFkYjk4MmY1ZmQxYzA2YTE2ODU1MmM1MTIyM2Q=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9282510e91ae3bdd27d7e40bd0ea43cdf97b207a", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/9282510e91ae3bdd27d7e40bd0ea43cdf97b207a", "committedDate": "2020-06-24T15:08:23Z", "message": "Rename Quotes to Wrap and add a couple more helper methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc411298dad9b61e63c9a7f238500fb96842ab1c", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/bc411298dad9b61e63c9a7f238500fb96842ab1c", "committedDate": "2020-06-24T15:08:23Z", "message": "feat(api): refactor GraphQlRequestFactory and add owner based auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cb0042952b45cddea52c87ab0a9b9e18880275a", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/2cb0042952b45cddea52c87ab0a9b9e18880275a", "committedDate": "2020-06-24T22:06:53Z", "message": "Fix integration test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08b00e98a5b47dbd2599cbc1f4ef8ebc7947d1e9", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/08b00e98a5b47dbd2599cbc1f4ef8ebc7947d1e9", "committedDate": "2020-06-29T22:01:28Z", "message": "Merge from main"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bab4cdd592eb95795f0cd6dff22d5324f30db36a", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/bab4cdd592eb95795f0cd6dff22d5324f30db36a", "committedDate": "2020-07-07T01:27:09Z", "message": "Merge branch 'main' into rm/ownerauth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59018cdb7f0e9d7e253b6206dc8f0cba002fe141", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/59018cdb7f0e9d7e253b6206dc8f0cba002fe141", "committedDate": "2020-07-07T07:07:16Z", "message": "Rename setAuthProvider to setOwner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "961866975bac76962ce64276093c0bd5406eced3", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/961866975bac76962ce64276093c0bd5406eced3", "committedDate": "2020-07-07T07:16:35Z", "message": "Early return if failure instead of starting a GraphQLOperation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a25e3c6230436b98b62866620061493fafa49c27", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/a25e3c6230436b98b62866620061493fafa49c27", "committedDate": "2020-07-07T07:25:18Z", "message": "Pass OperationType into SelectionSet so it can figure out when to wrap with pagination details internally"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e48a5f9c83e2402ff8c55b5b4a44968cd3b70c5", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7e48a5f9c83e2402ff8c55b5b4a44968cd3b70c5", "committedDate": "2020-07-07T07:30:16Z", "message": "Refactor SelectionSet.Node copy constructor to call other constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29764599cd2da945a1a0fd13980acd347f8ec09d", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/29764599cd2da945a1a0fd13980acd347f8ec09d", "committedDate": "2020-07-07T07:33:15Z", "message": "Make variables final on AppSyncGraphQLRequest.Builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73c064cc0de31e807091af8084b1015c38825571", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/73c064cc0de31e807091af8084b1015c38825571", "committedDate": "2020-07-07T07:35:21Z", "message": "Fix AppSyncGraphQLRequest toString implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16eabc24bb64e59d2ca01c0c4410ddfd1b7cbf53", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/16eabc24bb64e59d2ca01c0c4410ddfd1b7cbf53", "committedDate": "2020-07-07T07:44:06Z", "message": "Use static import to make casing conversion less verbose"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6929030ed2b5892a3fb94f0de33d3c68303cfe6", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/c6929030ed2b5892a3fb94f0de33d3c68303cfe6", "committedDate": "2020-07-07T07:50:20Z", "message": "Fix SelectionSetTest failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "235af37bb7fcb3585a3d1db16e9eb17b337df717", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/235af37bb7fcb3585a3d1db16e9eb17b337df717", "committedDate": "2020-07-07T08:01:04Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3e879beb0b61359cbda571990acc9ade94aa1b9", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/f3e879beb0b61359cbda571990acc9ade94aa1b9", "committedDate": "2020-07-07T08:01:13Z", "message": "Revert \"Use static import to make casing conversion less verbose\"\n\nThis reverts commit 16eabc24bb64e59d2ca01c0c4410ddfd1b7cbf53."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71a2e1b15bf9a6e6e2883ee68af9203487e0c7a6", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/71a2e1b15bf9a6e6e2883ee68af9203487e0c7a6", "committedDate": "2020-07-07T08:26:07Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c80f4624b4e5ada6f508bb1dab6406001fece689", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/c80f4624b4e5ada6f508bb1dab6406001fece689", "committedDate": "2020-07-07T17:52:31Z", "message": "Move factory methods to inner class of SelectionSet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "787dc8bed952dbe0487a07a65f393257e45528e2", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/787dc8bed952dbe0487a07a65f393257e45528e2", "committedDate": "2020-07-07T19:06:33Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "884dd9c13dc0bb2e66858b5d492ac1e6ca4a9a25", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/884dd9c13dc0bb2e66858b5d492ac1e6ca4a9a25", "committedDate": "2020-07-07T21:04:54Z", "message": "Empty.check instead of isEmpty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d7cd964ad4fac23a45c2c1a618986469576c918", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/9d7cd964ad4fac23a45c2c1a618986469576c918", "committedDate": "2020-07-07T22:32:15Z", "message": "Added Empty.check String helper method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d72f886cde8a4afc109dbe13e46d26ea3f28662", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/2d72f886cde8a4afc109dbe13e46d26ea3f28662", "committedDate": "2020-07-07T22:33:18Z", "message": "Add check so that owner is only added for AuthStrategy.OWNER"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10ba2fd502d498bf9d25c9f5e59edbdf382ef4b0", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/10ba2fd502d498bf9d25c9f5e59edbdf382ef4b0", "committedDate": "2020-07-07T22:33:42Z", "message": "Add unit tests for adding owner field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59b1f34358c56f36358e89fdfa2bd97e0cb57a64", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/59b1f34358c56f36358e89fdfa2bd97e0cb57a64", "committedDate": "2020-07-07T22:34:59Z", "message": "Remove addition of owner field to selection set per mdlaws feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66d5d65ba21d7b2046180673f1fb1ed0458124a6", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/66d5d65ba21d7b2046180673f1fb1ed0458124a6", "committedDate": "2020-07-08T00:00:05Z", "message": "Add logic to filter out owner field if null for mutations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64f2b284f89ea3509dc3ca35ef759abbb2873e37", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/64f2b284f89ea3509dc3ca35ef759abbb2873e37", "committedDate": "2020-07-08T00:30:03Z", "message": "Fix AWSApiPluginTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65a4652743e0919b3f177624a29bb08947a73294", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/65a4652743e0919b3f177624a29bb08947a73294", "committedDate": "2020-07-08T00:34:06Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c28a1d6cb9b189e47f59b562673f0b9f42405aa", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/6c28a1d6cb9b189e47f59b562673f0b9f42405aa", "committedDate": "2020-07-08T00:57:59Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54581b2527f1c7b08e282a0304bf470eefd3e0cf", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/54581b2527f1c7b08e282a0304bf470eefd3e0cf", "committedDate": "2020-07-08T06:04:30Z", "message": "Use Empty.check utility"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ef088b58bf9cc89c8342c3716c2496b60d831c", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/c4ef088b58bf9cc89c8342c3716c2496b60d831c", "committedDate": "2020-07-08T14:48:28Z", "message": "dashes in test resource file names for readability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f12b652d29f0e35368f637658bb827bdbe5a5cdc", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/f12b652d29f0e35368f637658bb827bdbe5a5cdc", "committedDate": "2020-07-08T15:15:13Z", "message": "Use Wrap.inDoubleQuotes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a54299117ce9a884cd560a540dcf7c14464d59af", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/a54299117ce9a884cd560a540dcf7c14464d59af", "committedDate": "2020-07-08T16:39:41Z", "message": "dont use trim in SelectionSetTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aba24dcfa7b5c02bda89bc622271c7eee7896b0e", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/aba24dcfa7b5c02bda89bc622271c7eee7896b0e", "committedDate": "2020-07-08T16:47:25Z", "message": "Use NoOpConsumer.create()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f33c7cf47ff1c6fb59e0eec4bc626c7283f19b9", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/5f33c7cf47ff1c6fb59e0eec4bc626c7283f19b9", "committedDate": "2020-07-08T16:50:00Z", "message": "Use Empty.check everywhere"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "737ca35d7722c8272d268dd94a2c6f03d5a78ebb", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/737ca35d7722c8272d268dd94a2c6f03d5a78ebb", "committedDate": "2020-07-08T19:44:46Z", "message": "Create Operation enum representing GraphQL operations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5854555b5199366fddd274c6f77ce5262bb4de1d", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/5854555b5199366fddd274c6f77ce5262bb4de1d", "committedDate": "2020-07-08T23:38:48Z", "message": "Merge branch 'main' into rm/ownerauth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8f0f46783cf83e45956f115aac0bb8696504e2", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/dc8f0f46783cf83e45956f115aac0bb8696504e2", "committedDate": "2020-07-11T03:23:34Z", "message": "Capitalize first letter of modelName"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ae35ea2d2c8bcdb8156d10018ed384ea8d578f6", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/8ae35ea2d2c8bcdb8156d10018ed384ea8d578f6", "committedDate": "2020-07-11T03:36:37Z", "message": "Move AppSyncGraphQLRequest from aws-api to aws-api-appsync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/0d7a032475bc52c840fd7cb46f3bf43272f7684a", "committedDate": "2020-07-11T05:49:58Z", "message": "feat(datastore) Add support for owner based auth in datastore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzgzMzIw", "url": "https://github.com/aws-amplify/amplify-android/pull/635#pullrequestreview-446783320", "createdAt": "2020-07-11T06:43:19Z", "commit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "state": "APPROVED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNjo0MzoxOVrOGwK8GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNjo1Nzo0NVrOGwLAUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDA1Nw==", "bodyText": "Oh okay, I got this after a second. This is cool.\nMight help to illustrate by adding this into the comment, like:\n<indent>{\n<indent><margin><original>\n<indent>}", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164057", "createdAt": "2020-07-11T06:43:19Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/util/Wrap.java", "diffHunk": "@@ -66,6 +67,21 @@ public static String inBraces(@Nullable String original) {\n         return \"{\" + original + \"}\";\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDM5OA==", "bodyText": "Is this needed?", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164398", "createdAt": "2020-07-11T06:47:58Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/GsonGraphQLResponseFactory.java", "diffHunk": "@@ -19,6 +19,7 @@\n \n import com.amplifyframework.AmplifyException;\n import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.appsync.AppSyncGraphQLRequest;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDQwNQ==", "bodyText": "Needed?", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164405", "createdAt": "2020-07-11T06:48:05Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPaginatedResultDeserializer.java", "diffHunk": "@@ -15,6 +15,7 @@\n \n package com.amplifyframework.api.aws;\n \n+import com.amplifyframework.api.aws.appsync.AppSyncGraphQLRequest;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDUwMg==", "bodyText": "Instead of mutating the request, can you create a new copy, with the owner field re-populated?\ne.g.\nGIzmo newGizmo = oldGizmo.newBuilder().setSpinnerWidgetActive(true).build();", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164502", "createdAt": "2020-07-11T06:49:37Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AWSApiPlugin.java", "diffHunk": "@@ -260,11 +261,9 @@ public void configure(\n         if (graphQLRequest instanceof AppSyncGraphQLRequest) {\n             try {\n                 AppSyncGraphQLRequest<R> request = (AppSyncGraphQLRequest<R>) graphQLRequest;\n-                CognitoUserPoolsAuthProvider cognitoProvider = authProvider.getCognitoUserPoolsAuthProvider();\n-                if (cognitoProvider == null) {\n-                    cognitoProvider = new DefaultCognitoUserPoolsAuthProvider();\n+                if (request.isOwnerArgumentRequired()) {\n+                    request.setOwner(getUsername());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDU3OA==", "bodyText": "I think these are already running at 28, aren't they? There should be a robolectric.properties somewhere under src/test, that sets the sdk target for all the test suites.", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164578", "createdAt": "2020-07-11T06:50:35Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/test/java/com/amplifyframework/api/aws/appsync/SelectionSetTest.java", "diffHunk": "@@ -33,8 +34,13 @@\n      * @throws AmplifyException if a ModelSchema can't be derived from Post.class\n      */\n     @Test\n+    @Config(sdk = 28)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDYxNw==", "bodyText": "(Copy of builder / immutable comment, here too)", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164617", "createdAt": "2020-07-11T06:50:55Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/test/java/com/amplifyframework/api/aws/appsync/AppSyncGraphQLRequestTest.java", "diffHunk": "@@ -120,9 +105,12 @@ private boolean isOwnerArgumentAdded(Class<? extends Model> clazz, OperationType\n         AppSyncGraphQLRequest<Model> request = AppSyncGraphQLRequest.builder()\n                 .modelClass(clazz)\n                 .operationType(operationType)\n+                .requestOptions(new DefaultGraphQLRequestOptions())\n                 .responseType(clazz)\n                 .build();\n-        request.setOwner(authProvider);\n+        if (request.isOwnerArgumentRequired()) {\n+            request.setOwner(\"johndoe\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NDcyMA==", "bodyText": "@Override\n\n\nPassing thought -- I wonder if we should have made an explicit buildGraphQlDocument() or something. toString() can often just have a pretty-print of the object state, which isn't necessarily in any particular standard form. Not really a big deal.", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453164720", "createdAt": "2020-07-11T06:52:41Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/api/aws/appsync/SelectionSet.java", "diffHunk": "@@ -87,6 +91,15 @@ public SelectionSet(String value, Set<SelectionSet> nodes) {\n      */\n     @Override\n     public String toString() {\n+        return toString(\"\");\n+    }\n+\n+    /**\n+     * Generates the String value of the SelectionSet for a GraphQL query document.\n+     * @param margin a margin with which to prefix each field of the selection set.\n+     * @return String value of the SelectionSet for a GraphQL query document.\n+     */\n+    public String toString(String margin) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NTA1Mg==", "bodyText": "You could use an enum for this, to help disambiguate the meaning of the boolean, and save some chars in this long-winded java method name, perhaps?\nHere is one such idea -- can still use iteration:\nLeafSelectionBehavior leafSelectionBehavior();\nwith:\nenum LeafSelectionBehavior {\n    JUST_ID,\n    ALL_FIELDS\n}", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453165052", "createdAt": "2020-07-11T06:56:19Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/api/aws/appsync/GraphQLRequestOptions.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws.appsync;\n+\n+import com.amplifyframework.core.model.Model;\n+\n+import java.util.List;\n+\n+/**\n+ * Options to be provided to a {@link AppSyncGraphQLRequest.Builder}.  When provisioning an AppSync API, there are some\n+ * key differences in the way the GraphQL operations are generated depending on whether DataStore is enabled.  For\n+ * example, _deleted, _lastChangedAt, and _version fields are added to each {@link Model} when using DataStore, but not\n+ * when using API, which means a GraphQLRequest should request these fields only if DataStore is enabled.  This options\n+ * object encapsulates these differences to help build the {@link AppSyncGraphQLRequest}.\n+ */\n+public interface GraphQLRequestOptions {\n+\n+    /**\n+     * Returns list of fields to be requested when the response type is a list of {@link Model} objects.\n+     * Examples: \"nextToken\",  \"startedAt\".\n+     *\n+     * @return list of pagination fields.\n+     */\n+    List<String> paginationFields();\n+\n+    /**\n+     * Returns list of metadata fields that should be requested for a {@link Model}.\n+     * Examples:  \"_deleted\", \"_lastChangedAt\", \"_version\".\n+     *\n+     * @return list of metadata fields\n+     */\n+    List<String> modelMetaFields();\n+\n+    /**\n+     * Returns name of field that should wrap {@link Model} fields.\n+     * Example: \"items\".\n+     *\n+     * @return name of field that should wrap {@link Model} fields.\n+     */\n+    String listField();\n+\n+    /**\n+     * Returns the maximum depth to traverse a {@link Model} when building the {@link SelectionSet}.\n+     * @return the maximum depth to traverse a {@link Model} when building the {@link SelectionSet}.\n+     */\n+    int maxDepth();\n+\n+    /**\n+     * Returns whether to request all fields or only the id field for leaf nodes when building the {@link SelectionSet}.\n+     * @return whether to request all fields or only the id field for leaf nodes when building the {@link SelectionSet}.\n+     */\n+    boolean onlyRequestIdForLeafSelectionSetNodes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2NTEzOA==", "bodyText": "Can we get this in the builder, somehow, to keep the class immutable?", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r453165138", "createdAt": "2020-07-11T06:57:45Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/api/aws/appsync/AppSyncGraphQLRequest.java", "diffHunk": "@@ -107,33 +105,29 @@ public void setVariable(String key, String type, String value) {\n     }\n \n     /**\n-     * Used to add owner argument from authProvider if needed.\n-     * @param authProvider CognitoUserPoolsAuthProvider for obtaining the username to set as the owner field.\n-     * @throws ApiException if request requires owner argument and authProvider or authProvider.getUsername() is null.\n+     * Returns whether owner argument is required for this request based on the model's {@link AuthRule}s.\n+     * @return whether owner argument is required for this request based on the model's {@link AuthRule}s.\n      */\n-    public void setOwner(CognitoUserPoolsAuthProvider authProvider) throws ApiException {\n+    public boolean isOwnerArgumentRequired() {\n         for (AuthRule authRule : modelSchema.getAuthRules()) {\n             if (isOwnerArgumentRequired(authRule)) {\n-                setVariable(authRule.getOwnerFieldOrDefault(), \"String!\", getUsername(authProvider));\n+                return true;\n             }\n         }\n+        return false;\n     }\n \n-    private String getUsername(CognitoUserPoolsAuthProvider authProvider) throws ApiException {\n-        if (authProvider == null) {\n-            throw new ApiException(\n-                    \"Attempted to subscribe to a model with owner based authorization without a Cognito provider\",\n-                    \"Did you add the AWSCognitoAuthPlugin to Amplify before configuring it?\"\n-            );\n-        }\n-        String username = authProvider.getUsername();\n-        if (username == null) {\n-            throw new ApiException(\n-                    \"Attempted to subscribe to a model with owner based authorization without a username\",\n-                    \"Make sure that a user is logged in before subscribing to a model with owner based auth\"\n-            );\n+    /**\n+     * Used to add owner argument from authProvider if needed.\n+     * @param owner username from CognitoUserPoolsAuthProvider to set as the owner field.\n+     * @throws ApiException if request requires owner argument and authProvider or authProvider.getUsername() is null.\n+     */\n+    public void setOwner(String owner) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d7a032475bc52c840fd7cb46f3bf43272f7684a"}, "originalPosition": 81}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67889641baa5393eeeee57ee65aa169e47d2302e", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/67889641baa5393eeeee57ee65aa169e47d2302e", "committedDate": "2020-07-13T20:35:16Z", "message": "Update comment for Wrap.inPrettyBraces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b52c3fcfd8f7ac39898d956a2a719e00b346ae5b", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b52c3fcfd8f7ac39898d956a2a719e00b346ae5b", "committedDate": "2020-07-13T20:39:58Z", "message": "Move source files in aws-appsync-api from aws.api.appsync to aws.api package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4687324f06d51086994c9c0adadf90d6ac29b22", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/e4687324f06d51086994c9c0adadf90d6ac29b22", "committedDate": "2020-07-13T20:47:44Z", "message": "Use robolectric properties file instead of annotation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NTk3NjYy", "url": "https://github.com/aws-amplify/amplify-android/pull/635#pullrequestreview-447597662", "createdAt": "2020-07-13T20:59:53Z", "commit": {"oid": "e4687324f06d51086994c9c0adadf90d6ac29b22"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45af461934fe129b2ef80cd5dd2a4d64ae52ca0f", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/45af461934fe129b2ef80cd5dd2a4d64ae52ca0f", "committedDate": "2020-07-13T21:02:39Z", "message": "LeafSerializationBehavior enum"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7466012477e2e49ae13208551d03d819ae1dacc", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/d7466012477e2e49ae13208551d03d819ae1dacc", "committedDate": "2020-07-13T22:07:13Z", "message": "Flip Operation and OperationType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46d7f1b42590b3a5c6b32690a4d482cae339cc86", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/46d7f1b42590b3a5c6b32690a4d482cae339cc86", "committedDate": "2020-07-13T22:09:30Z", "message": "Rename setVariable to variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0e2e48dafe1d5fc71dd0510d19ceab763535298", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b0e2e48dafe1d5fc71dd0510d19ceab763535298", "committedDate": "2020-07-13T22:16:02Z", "message": "Fix compile issues from merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee36aa7c0fe64973946487e7113871c70390adc5", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/ee36aa7c0fe64973946487e7113871c70390adc5", "committedDate": "2020-07-13T23:01:47Z", "message": "Merge branch 'main' into rm/datastore-auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7f731d50c2598df6e957aea37bd10ff7adb1f81", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/e7f731d50c2598df6e957aea37bd10ff7adb1f81", "committedDate": "2020-07-13T23:48:58Z", "message": "Fix errors from the merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5ec44646c7081e80a321a2533a56686a132b2ab", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b5ec44646c7081e80a321a2533a56686a132b2ab", "committedDate": "2020-07-14T08:13:49Z", "message": "Remove setters from AppSyncGraphQLRequest so it cant be mutated, and add a newBuilder method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MzYwNzg3", "url": "https://github.com/aws-amplify/amplify-android/pull/635#pullrequestreview-448360787", "createdAt": "2020-07-14T18:29:55Z", "commit": {"oid": "b5ec44646c7081e80a321a2533a56686a132b2ab"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxODoyOTo1NVrOGxgHfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxODozMToyN1rOGxgLKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTYxMg==", "bodyText": "Ought these to be Immutable.of(build.variables) and Immutable.of(builder.variableTypes)?", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r454559612", "createdAt": "2020-07-14T18:29:55Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequest.java", "diffHunk": "@@ -60,97 +51,34 @@\n      * Constructor for AppSyncGraphQLRequest.\n      * @throw AmplifyException if a ModelSchema can't be derived from the provided model class\n      */\n-    private AppSyncGraphQLRequest(Builder builder) throws AmplifyException {\n+    private AppSyncGraphQLRequest(Builder builder) {\n         super(builder.responseType, new GsonVariablesSerializer());\n-        this.modelSchema = ModelSchema.fromModelClass(builder.modelClass);\n-        this.selectionSet = SelectionSet.Factory.fromModelClass(builder.modelClass,\n-                builder.operationType,\n-                DEFAULT_DEPTH);\n-        this.operationType = builder.operationType;\n+        this.modelSchema = builder.modelSchema;\n+        this.operation = builder.operation;\n+        this.selectionSet = builder.selectionSet;\n         this.variables = builder.variables;\n         this.variableTypes = builder.variableTypes;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5ec44646c7081e80a321a2533a56686a132b2ab"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU2MDA2Mg==", "bodyText": "Can you mark the non-primitive return types as @NonNull (or, if it is the case, @Nullable)?", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r454560062", "createdAt": "2020-07-14T18:30:36Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/main/java/com/amplifyframework/api/aws/GraphQLRequestOptions.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import com.amplifyframework.core.model.Model;\n+\n+import java.util.List;\n+\n+/**\n+ * Options to be provided to a {@link AppSyncGraphQLRequest.Builder}.  When provisioning an AppSync API, there are some\n+ * key differences in the way the GraphQL operations are generated depending on whether DataStore is enabled.  For\n+ * example, _deleted, _lastChangedAt, and _version fields are added to each {@link Model} when using DataStore, but not\n+ * when using API, which means a GraphQLRequest should request these fields only if DataStore is enabled.  This options\n+ * object encapsulates these differences to help build the {@link AppSyncGraphQLRequest}.\n+ */\n+public interface GraphQLRequestOptions {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5ec44646c7081e80a321a2533a56686a132b2ab"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU2MDU1NA==", "bodyText": "Collections.singletonList(...)", "url": "https://github.com/aws-amplify/amplify-android/pull/635#discussion_r454560554", "createdAt": "2020-07-14T18:31:27Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api-appsync/src/test/java/com/amplifyframework/api/aws/DefaultGraphQLRequestOptions.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+\n+public final class DefaultGraphQLRequestOptions implements GraphQLRequestOptions {\n+    private static final String ITEMS_KEY = \"items\";\n+    private static final String NEXT_TOKEN_KEY = \"nextToken\";\n+\n+    @Override\n+    public List<String> paginationFields() {\n+        return Arrays.asList(NEXT_TOKEN_KEY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5ec44646c7081e80a321a2533a56686a132b2ab"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b052f77f7be9b0d2f5f7e18ddcaaed1843e4e59", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/9b052f77f7be9b0d2f5f7e18ddcaaed1843e4e59", "committedDate": "2020-07-14T20:05:31Z", "message": "Add unit test for AppSyncGraphQLRequest newBuilder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0e5596ae1d4100f42fe72aa62026447050b6e61", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b0e5596ae1d4100f42fe72aa62026447050b6e61", "committedDate": "2020-07-14T22:29:43Z", "message": "Immutable.of"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e34dc69ac1f42f3f570e11d6ae643f75dd128ecc", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/e34dc69ac1f42f3f570e11d6ae643f75dd128ecc", "committedDate": "2020-07-14T22:29:56Z", "message": "@NonNull"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d0c7805a6e31db982f5fd1c06a168552c51223d", "author": {"user": {"login": "richardmcclellan", "name": "Richard McClellan"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7d0c7805a6e31db982f5fd1c06a168552c51223d", "committedDate": "2020-07-14T22:32:34Z", "message": "Collections.singletonList"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1860, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}