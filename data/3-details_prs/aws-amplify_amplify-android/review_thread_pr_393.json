{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NTA1OTY2", "number": 393, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODo1MjoyMlrOD1bNUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToyNToyNlrOD1cCQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzQ2ODk5OnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODo1MjoyM1rOGK3KVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoyODowNVrOGLaWow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0MjcwOQ==", "bodyText": "It's always better to write these as KnownNotNull.VALUE.equals(itCouldMaybeByNull) In the case of enum values, prefer to put them on the left of the .equals(...).", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414042709", "createdAt": "2020-04-23T18:52:23Z", "author": {"login": "jamesonwilliams"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(\n             context,\n             new AWSConfiguration(pluginConfiguration),\n             new Callback<UserStateDetails>() {\n                 @Override\n                 public void onResult(UserStateDetails result) {\n-                    latch.countDown();\n+                    if (result.getUserState().equals(UserState.SIGNED_IN)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYxOTI5OQ==", "bodyText": "Ah, good call out - fixing.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414619299", "createdAt": "2020-04-24T14:28:05Z", "author": {"login": "TrekSoft"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(\n             context,\n             new AWSConfiguration(pluginConfiguration),\n             new Callback<UserStateDetails>() {\n                 @Override\n                 public void onResult(UserStateDetails result) {\n-                    latch.countDown();\n+                    if (result.getUserState().equals(UserState.SIGNED_IN)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0MjcwOQ=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzQ4MjAwOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/util/AsyncResult.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODo1NTo0M1rOGK3SUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoyODo1OFrOGLaZTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0NDc1Mg==", "bodyText": "As a comment on software construction - this looks mostly the same as an java.util.concurrent.AtomicReference.\nMore on the design sign, though, this might be a problematic construct. If actor A is writing to this, and actor B is reading from it, how will actor B know when to read? Even though you have an isSet(), actor B might ask at the wrong time.\nTo that point, the construct is inherently racy, which is why Java makes the AtomicReference as a thread-safe utility in the concurrency package.\nOne of the reasons Rx is popular for async programming is that it provides a way to chain together asynchronous work that depends on other asynchronous work.\nI think the point of the AyncResult here is to decouple a chain of async work, from some synchronous work. But as above, this will destroy the dependency relationship, some event/trigger that notifies another component that the value state has changed.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414044752", "createdAt": "2020-04-23T18:55:43Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/util/AsyncResult.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.util;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * A simple class which starts empty and will indicate if it's ever been set with a value and if so, what that value is.\n+ * @param <T> The type of result stored in this object.\n+ */\n+public class AsyncResult<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYxOTk4MQ==", "bodyText": "Ugh - thanks - I figured there had to be a default class for doing this but just couldn't find it. Will update.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414619981", "createdAt": "2020-04-24T14:28:58Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/util/AsyncResult.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.util;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * A simple class which starts empty and will indicate if it's ever been set with a value and if so, what that value is.\n+ * @param <T> The type of result stored in this object.\n+ */\n+public class AsyncResult<T> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0NDc1Mg=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzUwODE2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTowMTo1MVrOGK3iYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDo0NjoyNFrOGLbNgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0ODg2NA==", "bodyText": "In the JavaDoc, can you qualify what \"completely\" means, here? Does it mean successful completion of any sign-in challenges, and (something about that validation data object?)", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414048864", "createdAt": "2020-04-23T19:01:51Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.core.util.ObjectsCompat;\n+\n+public class AuthSocialSignInResult {\n+    private final boolean isSignedIn;\n+\n+    /**\n+     * Wraps the result of a sign in operation.\n+     * @param isSignedIn true if the user is now completely signed in, false otherwise\n+     */\n+    public AuthSocialSignInResult(boolean isSignedIn) {\n+        this.isSignedIn = isSignedIn;\n+    }\n+\n+    /**\n+     * True if the user is now completely signed in, false otherwise.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYzMzM0Nw==", "bodyText": "Actually in thinking about it, I decided to remove the completely term since I could imagine a scenario where a user is signed in but there are still steps suggested to be taken so isSignedIn here should just be simply whether the user is actually authenticated. Also updated the comment to the technical term of authenticated to be precise.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414633347", "createdAt": "2020-04-24T14:46:24Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.core.util.ObjectsCompat;\n+\n+public class AuthSocialSignInResult {\n+    private final boolean isSignedIn;\n+\n+    /**\n+     * Wraps the result of a sign in operation.\n+     * @param isSignedIn true if the user is now completely signed in, false otherwise\n+     */\n+    public AuthSocialSignInResult(boolean isSignedIn) {\n+        this.isSignedIn = isSignedIn;\n+    }\n+\n+    /**\n+     * True if the user is now completely signed in, false otherwise.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA0ODg2NA=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzUxNzM3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTowNDowOFrOGK3nyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxOTo0MTo0MFrOGLmjIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MDI0OQ==", "bodyText": "When would someone extend this? Can you suggest a use case in a class-level JavaDoc? Or, alternately, add final to close the class?\nHow come we AuthSocialSignInResult needs to be distinct from just an AuthSignInResult?", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414050249", "createdAt": "2020-04-23T19:04:08Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.core.util.ObjectsCompat;\n+\n+public class AuthSocialSignInResult {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYyODYxNA==", "bodyText": "While isSignedIn is common to all sign in results, the nextStep and possible additional data for the results of the different sign in method can be completely different - AWSMobileClient already has a different result object for the federatedSignIn and showSignIn methods than normal sign in and there's reason to believe other plugins would as well.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414628614", "createdAt": "2020-04-24T14:40:20Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.core.util.ObjectsCompat;\n+\n+public class AuthSocialSignInResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MDI0OQ=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgxOTEwNw==", "bodyText": "Possibly implement a common interface for isSignedIn", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414819107", "createdAt": "2020-04-24T19:41:40Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSocialSignInResult.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.core.util.ObjectsCompat;\n+\n+public class AuthSocialSignInResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MDI0OQ=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzUzMTMzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignUpResult.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTowNzoyOVrOGK3wCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNzoyNjoxMlrOGNe_8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjM2Mw==", "bodyText": "Nothing in this PR actually extends it, though, right? Why open it?", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414052363", "createdAt": "2020-04-23T19:07:29Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignUpResult.java", "diffHunk": "@@ -19,7 +19,7 @@\n \n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n \n-public final class AuthSignUpResult {\n+public class AuthSignUpResult {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYwODEzMw==", "bodyText": "By design, we want to enable plugin developers to put any plugin specific return values in an extension of this class.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414608133", "createdAt": "2020-04-24T14:13:02Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignUpResult.java", "diffHunk": "@@ -19,7 +19,7 @@\n \n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n \n-public final class AuthSignUpResult {\n+public class AuthSignUpResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjM2Mw=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYyNjE5Mw==", "bodyText": "My understanding is that, in general, Objects in the core library for a category should be non-final because, by nature, they are simply capturing what must be common across all plugins but we also expect there to be plugin specific values which we don't want put up at the core level but rather extended at the plugin implementation level.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414626193", "createdAt": "2020-04-24T14:37:16Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignUpResult.java", "diffHunk": "@@ -19,7 +19,7 @@\n \n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n \n-public final class AuthSignUpResult {\n+public class AuthSignUpResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjM2Mw=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MjU2MA==", "bodyText": "Open-closed principle (of SOLID) is:\n\nsoftware entities (classes, modules, functions, etc.) should be open for extension, but closed for modification\n\nIn practice, there are two principle ways to achieve extension points: inheritance, and composition. Software texts like Design Patterns tell us to prefer composition over inheritance.\nEven so, there are benefits and drawbacks to using composition over inheritance, and both can be valuable tools.\nPersonally, the issues I have with inheritance are mostly a few:\n\nBase classes grow over time, to include muddled concerns; AbstractFooBase (what is it?)\nWith a closed class implementation, you can encapsulate all of the policy and assumptions you hold about the function of the software. When you open a class, there is no guarantee that the derived class will meet all of these assumptions.\n\nAn interface has problem (2). An open non-abstract class is susceptible to (1). An abstract class may be used to enforce policy while offering means for extension/composition, and so contains partial mitigation to both (1) and (2).\nRef:\n\nDelegation pattern", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r416792560", "createdAt": "2020-04-28T17:26:12Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignUpResult.java", "diffHunk": "@@ -19,7 +19,7 @@\n \n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n \n-public final class AuthSignUpResult {\n+public class AuthSignUpResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjM2Mw=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzUzMzQ5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignInResult.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTowODowMVrOGK3xVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxMzoxMFrOGLZrXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjY5Mg==", "bodyText": "Why open?", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414052692", "createdAt": "2020-04-23T19:08:01Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignInResult.java", "diffHunk": "@@ -20,7 +20,7 @@\n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n import com.amplifyframework.auth.AuthSignInState;\n \n-public final class AuthSignInResult {\n+public class AuthSignInResult {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYwODIyMg==", "bodyText": "Same as above", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414608222", "createdAt": "2020-04-24T14:13:10Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSignInResult.java", "diffHunk": "@@ -20,7 +20,7 @@\n import com.amplifyframework.auth.AuthCodeDeliveryDetails;\n import com.amplifyframework.auth.AuthSignInState;\n \n-public final class AuthSignInResult {\n+public class AuthSignInResult {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MjY5Mg=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzU2OTk2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/auth/AuthUser.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToxNjo0OVrOGK4Gyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDo0MzowOFrOGLbDmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1ODE4Nw==", "bodyText": "If AuthUser is a valid working user, and then changePassword(...) is called and fails, then AuthUser is no longer a valid working user. This might have significance to the auth system, and to the app that integrates it. How can other components come to know that that AuthUser no longer has a valid password? Only by attempting to use the instance?\nThis also makes it look like there's one auth, and it mutates. Is that the case? If so, should you make this a singleton? If so, you could end up with an access pattern like Amplify.Auth.User.changePassword(...) which is certainly very readable, anyway.\nInstead of making an abstract class, and allowing an implementer to add a variety of customizations onto this class, you could accomodate the changePassword(...) by accepting a ChangePasswordStrategy into the constructor of the final AuthUser. e.g.,\n@FunctionalInterface interface ChangePasswordStrategy {\n    void changePassword(String oldPass, String newPass, Action onSuccess, Consumer<AuthException> onFailure);\n}", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414058187", "createdAt": "2020-04-23T19:16:49Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/auth/AuthUser.java", "diffHunk": "@@ -52,6 +55,24 @@ public String getUsername() {\n         return username;\n     }\n \n+    /**\n+     * Interface for changing the password of an existing user.\n+     * @param oldPassword The user's existing password\n+     * @param newPassword The new password desired on the user account\n+     * @param onSuccess Success callback\n+     * @param onError Error callback\n+     */\n+    public abstract void changePassword(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYzMDgwOQ==", "bodyText": "Let's talk about this on Chime - I'm not fully understanding the concerns you raise.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414630809", "createdAt": "2020-04-24T14:43:08Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/auth/AuthUser.java", "diffHunk": "@@ -52,6 +55,24 @@ public String getUsername() {\n         return username;\n     }\n \n+    /**\n+     * Interface for changing the password of an existing user.\n+     * @param oldPassword The user's existing password\n+     * @param newPassword The new password desired on the user account\n+     * @param onSuccess Success callback\n+     * @param onError Error callback\n+     */\n+    public abstract void changePassword(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1ODE4Nw=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzU3NjA3OnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthUser.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToxODoyM1rOGK4Kcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToxODoyM1rOGK4Kcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1OTEyMg==", "bodyText": "final", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414059122", "createdAt": "2020-04-23T19:18:23Z", "author": {"login": "jamesonwilliams"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthUser.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.cognito;\n+\n+import androidx.annotation.NonNull;\n+import androidx.core.util.Consumer;\n+\n+import com.amplifyframework.auth.AuthException;\n+import com.amplifyframework.auth.AuthUser;\n+import com.amplifyframework.core.Action;\n+\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import com.amazonaws.mobile.client.Callback;\n+\n+import java.util.Objects;\n+\n+public final class AWSCognitoAuthUser extends AuthUser {\n+    private AWSMobileClient client;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzU5ODY5OnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToyMzo1N1rOGK4Xnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDo1MToyNlrOGLbcfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA2MjQ5NQ==", "bodyText": "We had agreed to put this in configure(...) since we read the code and it looked like it was only doing configuration.\nThis current PR is adding initialization logic into the callback, though. We should split that out into the initialize() hook.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414062495", "createdAt": "2020-04-23T19:23:57Z", "author": {"login": "jamesonwilliams"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYzNzE4MA==", "bodyText": "I'll catch up with you on this on a brief call", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414637180", "createdAt": "2020-04-24T14:51:26Z", "author": {"login": "TrekSoft"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA2MjQ5NQ=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzYwNDQ5OnYy", "diffSide": "RIGHT", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOToyNToyNlrOGK4bLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDo1MTo0MVrOGLbdTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA2MzQwNw==", "bodyText": "The three exceptions being created from within this try are all very similar. Think of some ways you can create one error, and throw it if any of the scenarios arrise.", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414063407", "createdAt": "2020-04-23T19:25:26Z", "author": {"login": "jamesonwilliams"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(\n             context,\n             new AWSConfiguration(pluginConfiguration),\n             new Callback<UserStateDetails>() {\n                 @Override\n                 public void onResult(UserStateDetails result) {\n-                    latch.countDown();\n+                    if (result.getUserState().equals(UserState.SIGNED_IN)) {\n+                        fetchAndSetUserId(() -> latch.countDown());\n+                    } else {\n+                        userId = null;\n+                        latch.countDown();\n+                    }\n+\n+                    AWSMobileClient.getInstance().addUserStateListener(userStateDetails -> {\n+                        switch (userStateDetails.getUserState()) {\n+                            case SIGNED_IN:\n+                                fetchAndSetUserId(() -> { /* No response needed */ });\n+                                break;\n+                            default:\n+                                userId = null;\n+                        }\n+                    });\n                 }\n \n                 @Override\n                 public void onError(Exception error) {\n-                    throw new IllegalStateException(\"Failed to instantiate AWSMobileClient\", error);\n+                    asyncException.set(error);\n+                    latch.countDown();\n                 }\n             }\n         );\n \n         try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYzNzM5MQ==", "bodyText": "Also need clarification on this so I'll ask about it on our call", "url": "https://github.com/aws-amplify/amplify-android/pull/393#discussion_r414637391", "createdAt": "2020-04-24T14:51:41Z", "author": {"login": "TrekSoft"}, "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -69,35 +76,64 @@ public String getPluginKey() {\n     public void configure(\n             @NonNull JSONObject pluginConfiguration,\n             @NonNull Context context\n-    ) throws AmplifyException {\n+    ) throws AuthException {\n         final CountDownLatch latch = new CountDownLatch(1);\n+        final AsyncResult<Exception> asyncException = new AsyncResult<>();\n \n         AWSMobileClient.getInstance().initialize(\n             context,\n             new AWSConfiguration(pluginConfiguration),\n             new Callback<UserStateDetails>() {\n                 @Override\n                 public void onResult(UserStateDetails result) {\n-                    latch.countDown();\n+                    if (result.getUserState().equals(UserState.SIGNED_IN)) {\n+                        fetchAndSetUserId(() -> latch.countDown());\n+                    } else {\n+                        userId = null;\n+                        latch.countDown();\n+                    }\n+\n+                    AWSMobileClient.getInstance().addUserStateListener(userStateDetails -> {\n+                        switch (userStateDetails.getUserState()) {\n+                            case SIGNED_IN:\n+                                fetchAndSetUserId(() -> { /* No response needed */ });\n+                                break;\n+                            default:\n+                                userId = null;\n+                        }\n+                    });\n                 }\n \n                 @Override\n                 public void onError(Exception error) {\n-                    throw new IllegalStateException(\"Failed to instantiate AWSMobileClient\", error);\n+                    asyncException.set(error);\n+                    latch.countDown();\n                 }\n             }\n         );\n \n         try {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA2MzQwNw=="}, "originalCommit": {"oid": "223ab75339254a2f5437f360b64b8f22bef5327c"}, "originalPosition": 77}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1442, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}