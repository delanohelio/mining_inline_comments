{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzNTI1ODgz", "number": 534, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo0Nzo1OVrOEAq4FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1MzoxM1rOEAq-vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTM3OTQxOnYy", "diffSide": "RIGHT", "path": ".circleci/aggregate-build-artifacts.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo0Nzo1OVrOGcGKNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1NzozMVrOGcGc7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNDIyOQ==", "bodyText": "mkdir -p would be slightly more robust in that it a) will make the full tree if the spec happens to need it, and b) won't fail if the directory suddenly starts to exist between the test and the mkdir command.", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432114229", "createdAt": "2020-05-28T20:47:59Z", "author": {"login": "palpatim"}, "path": ".circleci/aggregate-build-artifacts.sh", "diffHunk": "@@ -0,0 +1,31 @@\n+#!/bin/bash\n+\n+set -e \n+\n+modules_with_build_trees() {\n+   for item in *; do\n+       if [ -d \"$item/build\" ]; then\n+           echo \"$item\"\n+       fi\n+   done\n+}\n+readonly modules=($(modules_with_build_trees))\n+readonly current_dir=\"$(pwd)\"\n+readonly aggregation_dir=\"build-artifacts\"\n+\n+if [ ! -d \"$aggregation_dir\" ]; then\n+    mkdir \"$aggregation_dir\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExOTAyMQ==", "bodyText": "will move to this", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432119021", "createdAt": "2020-05-28T20:57:31Z", "author": {"login": "jamesonwilliams"}, "path": ".circleci/aggregate-build-artifacts.sh", "diffHunk": "@@ -0,0 +1,31 @@\n+#!/bin/bash\n+\n+set -e \n+\n+modules_with_build_trees() {\n+   for item in *; do\n+       if [ -d \"$item/build\" ]; then\n+           echo \"$item\"\n+       fi\n+   done\n+}\n+readonly modules=($(modules_with_build_trees))\n+readonly current_dir=\"$(pwd)\"\n+readonly aggregation_dir=\"build-artifacts\"\n+\n+if [ ! -d \"$aggregation_dir\" ]; then\n+    mkdir \"$aggregation_dir\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNDIyOQ=="}, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTM5NTAxOnYy", "diffSide": "RIGHT", "path": ".circleci/aggregate-test-results.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1Mjo1NVrOGcGTrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1NzoyNVrOGcGcsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNjY1NQ==", "bodyText": "As above, maybe mkdir -p?", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432116655", "createdAt": "2020-05-28T20:52:55Z", "author": {"login": "palpatim"}, "path": ".circleci/aggregate-test-results.sh", "diffHunk": "@@ -0,0 +1,32 @@\n+#!/bin/bash\n+\n+set -e\n+\n+readonly circle_ci_storage_dir='test-results'\n+readonly cur_dir=$(pwd)\n+readonly junit_xmls_path='build/test-results/testDebugUnitTest'\n+\n+[ -z \"$1\" ] && echo \"Usage: $0 <workdir_path>\" >&2 && exit 1\n+\n+module_test_results() {\n+    for item in *; do\n+        if [ -d \"$item/$junit_xmls_path\" ]; then\n+            echo $item\n+        fi\n+    done\n+}\n+readonly test_results_dirs=($(module_test_results))\n+\n+if [ ! -d $circle_ci_storage_dir ]; then\n+    mkdir $circle_ci_storage_dir", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExODk2MQ==", "bodyText": "will move to this", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432118961", "createdAt": "2020-05-28T20:57:25Z", "author": {"login": "jamesonwilliams"}, "path": ".circleci/aggregate-test-results.sh", "diffHunk": "@@ -0,0 +1,32 @@\n+#!/bin/bash\n+\n+set -e\n+\n+readonly circle_ci_storage_dir='test-results'\n+readonly cur_dir=$(pwd)\n+readonly junit_xmls_path='build/test-results/testDebugUnitTest'\n+\n+[ -z \"$1\" ] && echo \"Usage: $0 <workdir_path>\" >&2 && exit 1\n+\n+module_test_results() {\n+    for item in *; do\n+        if [ -d \"$item/$junit_xmls_path\" ]; then\n+            echo $item\n+        fi\n+    done\n+}\n+readonly test_results_dirs=($(module_test_results))\n+\n+if [ ! -d $circle_ci_storage_dir ]; then\n+    mkdir $circle_ci_storage_dir", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNjY1NQ=="}, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTM5NjQ0OnYy", "diffSide": "LEFT", "path": ".circleci/config.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1MzoxM1rOGcGUcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDo1Njo1MlrOGcGbqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNjg0OA==", "bodyText": "I assume the aggregate-build-artifacts takes the place of publishing to local maven?", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432116848", "createdAt": "2020-05-28T20:53:13Z", "author": {"login": "palpatim"}, "path": ".circleci/config.yml", "diffHunk": "@@ -90,12 +90,14 @@ jobs:\n       - generate_gradle_wrapper\n       - run:\n           name: Build the project\n-          command: bash gradlew build\n-      - run:\n-          name: Publish the project to local maven\n-          command: bash gradlew publishToMavenLocal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExODY5Nw==", "bodyText": "This publishToMavenLocal step is actually not needed. It was carried over into this project from the SDK -- there, it is important.", "url": "https://github.com/aws-amplify/amplify-android/pull/534#discussion_r432118697", "createdAt": "2020-05-28T20:56:52Z", "author": {"login": "jamesonwilliams"}, "path": ".circleci/config.yml", "diffHunk": "@@ -90,12 +90,14 @@ jobs:\n       - generate_gradle_wrapper\n       - run:\n           name: Build the project\n-          command: bash gradlew build\n-      - run:\n-          name: Publish the project to local maven\n-          command: bash gradlew publishToMavenLocal", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjExNjg0OA=="}, "originalCommit": {"oid": "4b7a15137e20d336c52d04fc4da509d7f9427c0c"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1326, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}