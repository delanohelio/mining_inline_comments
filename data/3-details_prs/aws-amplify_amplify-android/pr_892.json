{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwOTU2MTY0", "number": 892, "title": "recursively build joins for multilevel nested models", "bodyText": "Issue #, if available:\nDescription of changes:\nCurrently joins only transverse the first level for nested models. This PR attempts to make SQLiteCommandFactory build joins for models with more than one level of nesting.\nA potential gotcha for deeply nested models is the performance hit so we may want to make how deep we follow nesting configurable in DatastoreConfiguration and set and document a default limit.\nA related Important fix here is the order of the limit and order by clause \"The ORDER BY clause should appear before the LIMIT clause\" or it results in an error\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-10-10T10:53:45Z", "url": "https://github.com/aws-amplify/amplify-android/pull/892", "merged": true, "mergeCommit": {"oid": "5078df9e7054c669f5ccf54510f5953b430e924f"}, "closed": true, "closedAt": "2020-11-10T20:29:57Z", "author": {"login": "saltonmassally"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRIZ-zAH2gAyNTAwOTU2MTY0OmIxOTRhMmRkY2U4YTlmNGJmMzk1NjE5NDk3NzkyOGJkNzE4MDQzYTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUI7wjAFqTUxMjA2OTAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b194a2ddce8a9f4bf3956194977928bd718043a8", "author": {"user": {"login": "saltonmassally", "name": "Salton Massally"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b194a2ddce8a9f4bf3956194977928bd718043a8", "committedDate": "2020-10-10T10:41:34Z", "message": "recursively build joins for multilevel nested models"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMDI2MzIz", "url": "https://github.com/aws-amplify/amplify-android/pull/892#pullrequestreview-512026323", "createdAt": "2020-10-19T18:02:09Z", "commit": {"oid": "b194a2ddce8a9f4bf3956194977928bd718043a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMDY5MDMy", "url": "https://github.com/aws-amplify/amplify-android/pull/892#pullrequestreview-512069032", "createdAt": "2020-10-19T18:57:17Z", "commit": {"oid": "b194a2ddce8a9f4bf3956194977928bd718043a8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODo1NzoxN1rOHkdT3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODo1NzoxN1rOHkdT3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk5MTAwNg==", "bodyText": "If you like it, this should work, too:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    adapter.save(blogOwner);\n          \n          \n            \n                    adapter.save(blog);\n          \n          \n            \n                    adapter.save(post);\n          \n          \n            \n                    adapter.save(comment);\n          \n          \n            \n                    adapter.save(blogOwner, blog, post, comment);", "url": "https://github.com/aws-amplify/amplify-android/pull/892#discussion_r507991006", "createdAt": "2020-10-19T18:57:17Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/storage/sqlite/SQLiteStorageAdapterQueryTest.java", "diffHunk": "@@ -146,6 +147,46 @@ public void querySavedDataWithForeignKey() throws DataStoreException {\n         assertTrue(blogs.contains(blog));\n     }\n \n+    /**\n+     * Test that querying the saved item with a foreign key\n+     * also populates that instance variable with object.\n+     * @throws DataStoreException On unexpected failure manipulating items in/out of DataStore\n+     */\n+    @Test\n+    public void querySavedDataWithMultiLevelJoins() throws DataStoreException {\n+        final BlogOwner blogOwner = BlogOwner.builder()\n+            .name(\"Alan Turing\")\n+            .build();\n+\n+        final Blog blog = Blog.builder()\n+            .name(\"Alan's Software Blog\")\n+            .owner(blogOwner)\n+            .build();\n+\n+        final Post post = Post.builder()\n+            .title(\"Alan's first post\")\n+            .status(PostStatus.ACTIVE)\n+            .rating(2)\n+            .blog(blog)\n+            .build();\n+\n+        final Comment comment = Comment.builder()\n+            .content(\"Alan's first comment\")\n+            .post(post)\n+            .build();\n+\n+        adapter.save(blogOwner);\n+        adapter.save(blog);\n+        adapter.save(post);\n+        adapter.save(comment);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b194a2ddce8a9f4bf3956194977928bd718043a8"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1750, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}