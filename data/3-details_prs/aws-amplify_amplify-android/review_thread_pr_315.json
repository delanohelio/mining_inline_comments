{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMzkxODQ1", "number": 315, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNDozMjo0NlrODp5ClA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNToxOTo1MlrODp6PgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjUyNzU2OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/storage/StorageItemChange.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNDozMjo0NlrOF5WJ7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNzo1OTowMlrOF5d-Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY3NjE0MQ==", "bodyText": "This looks like the default equals functionality - is there a need to override it that I'm missing here?", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395676141", "createdAt": "2020-03-20T14:32:46Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/storage/StorageItemChange.java", "diffHunk": "@@ -133,12 +131,13 @@ public T item() {\n      * @param recordFactory A component capable of generating records.\n      * @return A Record representation of this instance.\n      */\n+    @NonNull\n     public Record toRecord(@NonNull RecordFactory recordFactory) {\n         return Objects.requireNonNull(recordFactory).toRecord(this);\n     }\n \n     @Override\n-    public boolean equals(Object thatObject) {\n+    public boolean equals(@Nullable Object thatObject) {\n         if (this == thatObject) {\n             return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc1NzE0Nw==", "bodyText": "The default equals(...) works like this:\n\nfor any non-null reference values x and y, this method returns true if and only if x and y refer to the same object (x == y has the value true).\n\nSo, that'd be equivalent to an implementation like return this == thatObject.\nBut here, I say, \"okay, if they're the same object, yea, they're equal. BUT ALSO.... they're equal if they're fields are equal, even if they're not the same object.\"", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395757147", "createdAt": "2020-03-20T16:36:10Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/storage/StorageItemChange.java", "diffHunk": "@@ -133,12 +131,13 @@ public T item() {\n      * @param recordFactory A component capable of generating records.\n      * @return A Record representation of this instance.\n      */\n+    @NonNull\n     public Record toRecord(@NonNull RecordFactory recordFactory) {\n         return Objects.requireNonNull(recordFactory).toRecord(this);\n     }\n \n     @Override\n-    public boolean equals(Object thatObject) {\n+    public boolean equals(@Nullable Object thatObject) {\n         if (this == thatObject) {\n             return true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY3NjE0MQ=="}, "originalCommit": null, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTgwNDI1MQ==", "bodyText": "Argh, the diff made it look like there was nothing more to this method than what's shown above. Ignore this comment.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395804251", "createdAt": "2020-03-20T17:59:02Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/storage/StorageItemChange.java", "diffHunk": "@@ -133,12 +131,13 @@ public T item() {\n      * @param recordFactory A component capable of generating records.\n      * @return A Record representation of this instance.\n      */\n+    @NonNull\n     public Record toRecord(@NonNull RecordFactory recordFactory) {\n         return Objects.requireNonNull(recordFactory).toRecord(this);\n     }\n \n     @Override\n-    public boolean equals(Object thatObject) {\n+    public boolean equals(@Nullable Object thatObject) {\n         if (this == thatObject) {\n             return true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY3NjE0MQ=="}, "originalCommit": null, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjU4OTc2OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationProcessor.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNDo0ODoyM1rOF5WyNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQyMDoyNjozNFrOF5iN5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4NjQ1Mg==", "bodyText": "What's the idea behind using caps to distinguish between these two classes vs. a naming difference?", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395686452", "createdAt": "2020-03-20T14:48:23Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationProcessor.java", "diffHunk": "@@ -85,20 +103,78 @@ void stopDrainingMutationOutbox() {\n     }\n \n     /**\n-     * To process a StorageItemChange, we try to publish it to the remote GraphQL\n-     * API. If that succeeds, then we can remove it from the outbox. Otherwise,\n-     * we have to keep the mutation in the outbox, so that we can try to publish\n-     * it again later, when network conditions become favorable again.\n+     * Attempt to publish a change (update, delete, creation) over the network.\n      * @param storageItemChange A storage item change to be published to remote API\n-     * @return A single which completes with the successfully published item, or errors\n+     * @return A single which completes with the successfully published item, or emits error\n      *         if the publication fails\n      */\n-    @SuppressWarnings(\"checkstyle:MethodTypeParameterName\") // The generics are complex, so use meaningful names\n     private <MODEL extends Model, SIC extends StorageItemChange<MODEL>> Single<SIC> publishToNetwork(", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc1ODE3NA==", "bodyText": "I could use <M extends Model, S extends StorageItemChange<M>>, I guess.\nSince there are so many generic types, and several types around here start with an M (Model, ModelMetadata, ModelWithMetadata, etc.) I thought it'd be clearer to read if I was explicit with the MODEL, etc.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395758174", "createdAt": "2020-03-20T16:37:53Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationProcessor.java", "diffHunk": "@@ -85,20 +103,78 @@ void stopDrainingMutationOutbox() {\n     }\n \n     /**\n-     * To process a StorageItemChange, we try to publish it to the remote GraphQL\n-     * API. If that succeeds, then we can remove it from the outbox. Otherwise,\n-     * we have to keep the mutation in the outbox, so that we can try to publish\n-     * it again later, when network conditions become favorable again.\n+     * Attempt to publish a change (update, delete, creation) over the network.\n      * @param storageItemChange A storage item change to be published to remote API\n-     * @return A single which completes with the successfully published item, or errors\n+     * @return A single which completes with the successfully published item, or emits error\n      *         if the publication fails\n      */\n-    @SuppressWarnings(\"checkstyle:MethodTypeParameterName\") // The generics are complex, so use meaningful names\n     private <MODEL extends Model, SIC extends StorageItemChange<MODEL>> Single<SIC> publishToNetwork(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4NjQ1Mg=="}, "originalCommit": null, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTgwNTk3Mw==", "bodyText": "Ok, what's the difference between MODEL and Model? Would it make sense to give MODEL a name that reflects that difference?", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395805973", "createdAt": "2020-03-20T18:02:07Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationProcessor.java", "diffHunk": "@@ -85,20 +103,78 @@ void stopDrainingMutationOutbox() {\n     }\n \n     /**\n-     * To process a StorageItemChange, we try to publish it to the remote GraphQL\n-     * API. If that succeeds, then we can remove it from the outbox. Otherwise,\n-     * we have to keep the mutation in the outbox, so that we can try to publish\n-     * it again later, when network conditions become favorable again.\n+     * Attempt to publish a change (update, delete, creation) over the network.\n      * @param storageItemChange A storage item change to be published to remote API\n-     * @return A single which completes with the successfully published item, or errors\n+     * @return A single which completes with the successfully published item, or emits error\n      *         if the publication fails\n      */\n-    @SuppressWarnings(\"checkstyle:MethodTypeParameterName\") // The generics are complex, so use meaningful names\n     private <MODEL extends Model, SIC extends StorageItemChange<MODEL>> Single<SIC> publishToNetwork(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4NjQ1Mg=="}, "originalCommit": null, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg3Mzc2Nw==", "bodyText": "Update: I got rid of all this crap, in a subsequent update. It ends up being easier to read with just the <T extends Model> that we use eery where else.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395873767", "createdAt": "2020-03-20T20:26:34Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationProcessor.java", "diffHunk": "@@ -85,20 +103,78 @@ void stopDrainingMutationOutbox() {\n     }\n \n     /**\n-     * To process a StorageItemChange, we try to publish it to the remote GraphQL\n-     * API. If that succeeds, then we can remove it from the outbox. Otherwise,\n-     * we have to keep the mutation in the outbox, so that we can try to publish\n-     * it again later, when network conditions become favorable again.\n+     * Attempt to publish a change (update, delete, creation) over the network.\n      * @param storageItemChange A storage item change to be published to remote API\n-     * @return A single which completes with the successfully published item, or errors\n+     * @return A single which completes with the successfully published item, or emits error\n      *         if the publication fails\n      */\n-    @SuppressWarnings(\"checkstyle:MethodTypeParameterName\") // The generics are complex, so use meaningful names\n     private <MODEL extends Model, SIC extends StorageItemChange<MODEL>> Single<SIC> publishToNetwork(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY4NjQ1Mg=="}, "originalCommit": null, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjcxOTE1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/core/model/ModelSchemaRegistry.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNToxODo0MlrOF5YEKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNjozODo1NVrOF5bMow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcwNzQzMg==", "bodyText": "Do you think in this case it'd make sense to throw a custom error with an explanation if it is null since this isn't checking input provided by the customer but rather the result we're returning? Same for below on line 73?", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395707432", "createdAt": "2020-03-20T15:18:42Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/core/model/ModelSchemaRegistry.java", "diffHunk": "@@ -57,8 +55,10 @@ public synchronized void load(@NonNull Set<Class<? extends Model>> models) throw\n      *                        {@link Class#getSimpleName()} method.\n      * @return the ModelSchema object for the given Model class.\n      */\n+    @NonNull\n     public synchronized ModelSchema getModelSchemaForModelClass(@NonNull String classSimpleName) {\n-        return modelSchemaMap.get(classSimpleName);\n+        final ModelSchema result = modelSchemaMap.get(classSimpleName);\n+        return Objects.requireNonNull(result);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc1ODc1NQ==", "bodyText": "Hm, yes, I agree. I'll update this.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395758755", "createdAt": "2020-03-20T16:38:55Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/core/model/ModelSchemaRegistry.java", "diffHunk": "@@ -57,8 +55,10 @@ public synchronized void load(@NonNull Set<Class<? extends Model>> models) throw\n      *                        {@link Class#getSimpleName()} method.\n      * @return the ModelSchema object for the given Model class.\n      */\n+    @NonNull\n     public synchronized ModelSchema getModelSchemaForModelClass(@NonNull String classSimpleName) {\n-        return modelSchemaMap.get(classSimpleName);\n+        final ModelSchema result = modelSchemaMap.get(classSimpleName);\n+        return Objects.requireNonNull(result);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcwNzQzMg=="}, "originalCommit": null, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjcyNDQ5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreItemChange.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNToxOTo1MlrOF5YHdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxODowMDoxNlrOF5eA_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcwODI3Nw==", "bodyText": "Why do we have what looks like the same enum here as well as in StorageItemChange.java in the DataStore project?", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395708277", "createdAt": "2020-03-20T15:19:52Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreItemChange.java", "diffHunk": "@@ -259,9 +263,14 @@ public String toString() {\n      */\n     public enum Type {\n         /**\n-         * An item has been saved into the DataStore.\n+         * An item with a new ID has been saved into the DataStore.\n+         */\n+        CREATE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc1OTk4MQ==", "bodyText": "True, yea. The local storage module and the public DataStore API share a number of features. In this case, the enum is entirely the same.\nI could use just one, but I'd need a name for it that made sense for both.\nLogically speaking, one is talking about changes to the DataStore, and one is talking about changes to an internal system component (the storage adapter). Which theoretically could be different, but in practice, aren't really.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395759981", "createdAt": "2020-03-20T16:40:58Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreItemChange.java", "diffHunk": "@@ -259,9 +263,14 @@ public String toString() {\n      */\n     public enum Type {\n         /**\n-         * An item has been saved into the DataStore.\n+         * An item with a new ID has been saved into the DataStore.\n+         */\n+        CREATE,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcwODI3Nw=="}, "originalCommit": null, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTgwNDkyNA==", "bodyText": "Ah, ok yeah if they have different meanings than that makes sense to have the two.", "url": "https://github.com/aws-amplify/amplify-android/pull/315#discussion_r395804924", "createdAt": "2020-03-20T18:00:16Z", "author": {"login": "TrekSoft"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreItemChange.java", "diffHunk": "@@ -259,9 +263,14 @@ public String toString() {\n      */\n     public enum Type {\n         /**\n-         * An item has been saved into the DataStore.\n+         * An item with a new ID has been saved into the DataStore.\n+         */\n+        CREATE,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcwODI3Nw=="}, "originalCommit": null, "originalPosition": 52}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1348, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}