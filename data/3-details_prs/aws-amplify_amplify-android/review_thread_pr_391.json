{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MDMwMjY5", "number": 391, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo0Mjo0MlrOD0jllA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo1NToxN1rOD0jwvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NDM1NjA0OnYy", "diffSide": "LEFT", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageDownloadTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo0Mjo0MlrOGJjFcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMjowMzoxNFrOGJysQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NTIwMw==", "bodyText": "Can we kill the declaration on L96, now? Is String local still used?", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412665203", "createdAt": "2020-04-22T04:42:42Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageDownloadTest.java", "diffHunk": "@@ -101,14 +101,12 @@ public static void setUpOnce() throws Exception {\n         // Upload large test file\n         largeFile = new RandomTempFile(LARGE_FILE_NAME, LARGE_FILE_SIZE);\n         key = LARGE_FILE_NAME;\n-        local = largeFile.getAbsolutePath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkyMDg5Nw==", "bodyText": "It isn't, I missed it. TIL: Analyze -> Run Inspection By Name... -> Unused Declarations!", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412920897", "createdAt": "2020-04-22T12:03:14Z", "author": {"login": "jpignata"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageDownloadTest.java", "diffHunk": "@@ -101,14 +101,12 @@ public static void setUpOnce() throws Exception {\n         // Upload large test file\n         largeFile = new RandomTempFile(LARGE_FILE_NAME, LARGE_FILE_SIZE);\n         key = LARGE_FILE_NAME;\n-        local = largeFile.getAbsolutePath();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NTIwMw=="}, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NDM3MjczOnYy", "diffSide": "RIGHT", "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageUploadAccessLevelTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo1MDowNVrOGJjOWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMjoxODowNlrOGJzR_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NzQ4Mg==", "bodyText": "This existed before this PR -- but just noting it since I saw it:\nfileName is a weird name for the first argument, in these various calls to SynchronousStorage#uploadFile(String, File, StorageOptions). I think it should be named remoteKey, right?", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412667482", "createdAt": "2020-04-22T04:50:05Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageUploadAccessLevelTest.java", "diffHunk": "@@ -88,9 +88,8 @@ public void setUp() throws Exception {\n         mobileClient.signOut();\n \n         // Create a new file to upload\n-        File fileToUpload = new RandomTempFile(UPLOAD_SIZE);\n-        fileName = fileToUpload.getName();\n-        filePath = fileToUpload.getPath();\n+        uploadFile = new RandomTempFile(UPLOAD_SIZE);\n+        fileName = uploadFile.getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzMDU1Ng==", "bodyText": "Cool. I thought perhaps there was a reason for this difference I was missing. Renamed.", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412930556", "createdAt": "2020-04-22T12:18:06Z", "author": {"login": "jpignata"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageUploadAccessLevelTest.java", "diffHunk": "@@ -88,9 +88,8 @@ public void setUp() throws Exception {\n         mobileClient.signOut();\n \n         // Create a new file to upload\n-        File fileToUpload = new RandomTempFile(UPLOAD_SIZE);\n-        fileName = fileToUpload.getName();\n-        filePath = fileToUpload.getPath();\n+        uploadFile = new RandomTempFile(UPLOAD_SIZE);\n+        fileName = uploadFile.getName();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NzQ4Mg=="}, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NDM4NDYyOnYy", "diffSide": "RIGHT", "path": "aws-storage-s3/src/test/java/com/amplifyframework/storage/s3/StorageComponentTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo1NToxN1rOGJjUyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMjoyNTozMFrOGJzk4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2OTEzMQ==", "bodyText": "We have a utility in the code base called RandomTempFile, I think that could be a good replacement to these File.createTemptFile(..., ...) calls:\n\nIt can throw some kind of a E extends RuntimeException, which would prevent the need for us to snake this IOException through, and onto every @Test;\nInstead of passing \"data\" every time, we could let the RandomTempFile populate some random string data.", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412669131", "createdAt": "2020-04-22T04:55:17Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/test/java/com/amplifyframework/storage/s3/StorageComponentTest.java", "diffHunk": "@@ -144,11 +145,12 @@ public void testGenerateUrlGetsPresignedUrl() throws StorageException {\n      * invokes the registered AWSS3StoragePlugin instance and returns a\n      * {@link StorageDownloadFileResult} with correct file path.\n      * @throws StorageException when an error is encountered while downloading\n+     * @throws IOException when a temporary file cannot be created\n      */\n     @Test\n-    public void testDownloadToFileGetsFile() throws StorageException {\n+    public void testDownloadToFileGetsFile() throws StorageException, IOException {\n         final String fromRemoteKey = RandomString.string();\n-        final String toLocalPath = RandomString.string();\n+        final File toLocalFile = File.createTempFile(\"download\", \"data\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkxOTQ0MQ==", "bodyText": "The second parameter is actually a suffix, or file extension, so it's just creating an empty text file called {prefix}.{suffix}. RandomTempFile sounds better for upload tests, however for download tests we'd still like an empty file. (Narrator: Which he could accommodate using the default constructor on RandomTempFile.)", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412919441", "createdAt": "2020-04-22T12:00:53Z", "author": {"login": "jpignata"}, "path": "aws-storage-s3/src/test/java/com/amplifyframework/storage/s3/StorageComponentTest.java", "diffHunk": "@@ -144,11 +145,12 @@ public void testGenerateUrlGetsPresignedUrl() throws StorageException {\n      * invokes the registered AWSS3StoragePlugin instance and returns a\n      * {@link StorageDownloadFileResult} with correct file path.\n      * @throws StorageException when an error is encountered while downloading\n+     * @throws IOException when a temporary file cannot be created\n      */\n     @Test\n-    public void testDownloadToFileGetsFile() throws StorageException {\n+    public void testDownloadToFileGetsFile() throws StorageException, IOException {\n         final String fromRemoteKey = RandomString.string();\n-        final String toLocalPath = RandomString.string();\n+        final File toLocalFile = File.createTempFile(\"download\", \"data\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2OTEzMQ=="}, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzNTM5NQ==", "bodyText": "RandomTempFile also can throw an IOException, so instead I left the throws declaration on each @Test if it was the only one, if not I up-scoped to Exception. Let me know if you had something else in mind.", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412935395", "createdAt": "2020-04-22T12:25:30Z", "author": {"login": "jpignata"}, "path": "aws-storage-s3/src/test/java/com/amplifyframework/storage/s3/StorageComponentTest.java", "diffHunk": "@@ -144,11 +145,12 @@ public void testGenerateUrlGetsPresignedUrl() throws StorageException {\n      * invokes the registered AWSS3StoragePlugin instance and returns a\n      * {@link StorageDownloadFileResult} with correct file path.\n      * @throws StorageException when an error is encountered while downloading\n+     * @throws IOException when a temporary file cannot be created\n      */\n     @Test\n-    public void testDownloadToFileGetsFile() throws StorageException {\n+    public void testDownloadToFileGetsFile() throws StorageException, IOException {\n         final String fromRemoteKey = RandomString.string();\n-        final String toLocalPath = RandomString.string();\n+        final File toLocalFile = File.createTempFile(\"download\", \"data\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2OTEzMQ=="}, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1433, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}