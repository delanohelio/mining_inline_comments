{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMzI1MjQw", "number": 488, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzozNzo0MVrOD-Ahxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMTowNzo1N1rOD-zEWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzQ2OTUwOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLOperation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzozNzo0MVrOGX2RKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMjo1Mjo0NFrOGYkgfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY1OTU2Mg==", "bodyText": "The current Checkstyle likes android and androidx together.", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r427659562", "createdAt": "2020-05-19T23:37:41Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLOperation.java", "diffHunk": "@@ -16,6 +16,7 @@\n package com.amplifyframework.api.aws;\n \n import android.annotation.SuppressLint;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxNzE0OQ==", "bodyText": "Fixed!", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428417149", "createdAt": "2020-05-21T02:52:44Z", "author": {"login": "richardmcclellan"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLOperation.java", "diffHunk": "@@ -16,6 +16,7 @@\n package com.amplifyframework.api.aws;\n \n import android.annotation.SuppressLint;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY1OTU2Mg=="}, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzQ3ODYyOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzo0MjozOFrOGX2W9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMjo1MjozMlrOGYkgTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MTA0Ng==", "bodyText": "Looks reasonable, remember to add equals, hashCode, toString before pushing", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r427661046", "createdAt": "2020-05-19T23:42:38Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+\n+final class AppSyncPage<M> extends Page<M> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxNzEwMg==", "bodyText": "Added in latest commit!", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428417102", "createdAt": "2020-05-21T02:52:32Z", "author": {"login": "richardmcclellan"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+\n+final class AppSyncPage<M> extends Page<M> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MTA0Ng=="}, "originalCommit": null, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzQ4MzE3OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzo0NDo1NFrOGX2Z1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNToyMDoxNlrOGYmg9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MTc4Mg==", "bodyText": "I guess this will mutate the existing request. It'd be better to return a new, immutable copy.\nTo illustate, consider what happens when:\nGraphQLRequest request = buildOne();\nrequest.getVaraiables() // state A \nnew AppSyncPage(response, request, token).getRequestForNextPage();\nrequest.getVariables(); // state B.", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r427661782", "createdAt": "2020-05-19T23:44:54Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+\n+final class AppSyncPage<M> extends Page<M> {\n+    private final String NEXT_TOKEN_KEY = \"nextToken\";\n+\n+    private GraphQLRequest<Page<M>> request;\n+    private String nextToken;\n+\n+    public AppSyncPage(@NonNull GraphQLResponse<Iterable<M>> response,\n+                       @NonNull GraphQLRequest<Page<M>> request,\n+                       String nextToken) {\n+        super(response);\n+        this.request = request;\n+        this.nextToken = nextToken;\n+    }\n+\n+    @Override\n+    public boolean hasNextPage() {\n+        return nextToken != null;\n+    }\n+\n+    @Override\n+    public GraphQLRequest<Page<M>> getRequestForNextPage() {\n+        this.request.addVariable(NEXT_TOKEN_KEY, nextToken);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ1MDAzNw==", "bodyText": "I added a GraphQLRequest copy constructor, and am returning a copy.  The value returned is still NOT immutable though, because GraphQLRequest has public methods that support some mutation (e.g. putVariable, addFragment)\nI think that @drochetti might be refactoring GraphQLRequest right now anyway as part of making GraphQLRequest builder/helpers, so we should revisit this after that work is done.", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428450037", "createdAt": "2020-05-21T05:20:16Z", "author": {"login": "richardmcclellan"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPage.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+\n+final class AppSyncPage<M> extends Page<M> {\n+    private final String NEXT_TOKEN_KEY = \"nextToken\";\n+\n+    private GraphQLRequest<Page<M>> request;\n+    private String nextToken;\n+\n+    public AppSyncPage(@NonNull GraphQLResponse<Iterable<M>> response,\n+                       @NonNull GraphQLRequest<Page<M>> request,\n+                       String nextToken) {\n+        super(response);\n+        this.request = request;\n+        this.nextToken = nextToken;\n+    }\n+\n+    @Override\n+    public boolean hasNextPage() {\n+        return nextToken != null;\n+    }\n+\n+    @Override\n+    public GraphQLRequest<Page<M>> getRequestForNextPage() {\n+        this.request.addVariable(NEXT_TOKEN_KEY, nextToken);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MTc4Mg=="}, "originalCommit": null, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzQ4NjMwOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPageDeserializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzo0NjowNVrOGX2bjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMjo1NTo1MFrOGYkjeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MjIyMw==", "bodyText": "Ah, I guess this thing here, the listTodos and under. This is the \"page\" right?", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r427662223", "createdAt": "2020-05-19T23:46:05Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPageDeserializer.java", "diffHunk": "@@ -0,0 +1,103 @@\n+package com.amplifyframework.api.aws;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import com.google.gson.reflect.TypeToken;\n+\n+import java.lang.reflect.ParameterizedType;\n+import java.lang.reflect.Type;\n+\n+/**\n+ * Takes an input such as the following and deserializes to an AppSyncPage\n+ * {\n+ *   \"data\": {\n+ *     \"listTodos\": {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxNzkxMg==", "bodyText": "This actually was correct based on the design I had implemented yesterday.  I've updated the implementation to the design we discussed last night, which removes the top two levels. (and I have updated this comment).", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428417912", "createdAt": "2020-05-21T02:55:50Z", "author": {"login": "richardmcclellan"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncPageDeserializer.java", "diffHunk": "@@ -0,0 +1,103 @@\n+package com.amplifyframework.api.aws;\n+\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+import com.amplifyframework.api.graphql.GraphQLResponse;\n+import com.amplifyframework.api.graphql.Page;\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import com.google.gson.reflect.TypeToken;\n+\n+import java.lang.reflect.ParameterizedType;\n+import java.lang.reflect.Type;\n+\n+/**\n+ * Takes an input such as the following and deserializes to an AppSyncPage\n+ * {\n+ *   \"data\": {\n+ *     \"listTodos\": {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2MjIyMw=="}, "originalCommit": null, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzUyMjA0OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/GsonFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMDowMjoxMlrOGX2wEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMDowMjoxMlrOGX2wEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2NzQ3Mw==", "bodyText": "Whoa", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r427667473", "createdAt": "2020-05-20T00:02:12Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/GsonFactory.java", "diffHunk": "@@ -60,7 +59,10 @@ private static void withDeserializers(GsonBuilder builder) {\n             .registerTypeAdapter(AWSTime.class, new TemporalDeserializers.AWSTimeDeserializer())\n             .registerTypeAdapter(AWSTimestamp.class, new TemporalDeserializers.AWSTimestampDeserializer())\n             .registerTypeAdapter(AWSDateTime.class, new TemporalDeserializers.AWSDateTimeDeserializer())\n-            .registerTypeAdapter(GraphQLResponse.Error.class, new GsonErrorDeserializer());\n+            .registerTypeAdapter(GraphQLResponse.class, new GraphQLResponseDeserializer())\n+            .registerTypeAdapter(GraphQLResponse.Error.class, new GsonErrorDeserializer())\n+            .registerTypeHierarchyAdapter(Iterable.class, new IterableDeserializer())", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2Nzc3MDA5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/api/graphql/Page.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMjo1MzoyNlrOGYgkCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDo0NTo1NlrOGZCQxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM1MjUyMw==", "bodyText": "I'm open to suggestions on other names for this class.  We actually already have a Page object defined in core, which is used for local pagination via DataStore, so it's kinda confusing to have this one with the same name.", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428352523", "createdAt": "2020-05-20T22:53:26Z", "author": {"login": "richardmcclellan"}, "path": "core/src/main/java/com/amplifyframework/api/graphql/Page.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.amplifyframework.api.graphql;\n+\n+public abstract class Page<M> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3NTA1Nw==", "bodyText": "Does PaginatedResult reflect the intent? (or something along those lines)", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428875057", "createdAt": "2020-05-21T19:47:00Z", "author": {"login": "drochetti"}, "path": "core/src/main/java/com/amplifyframework/api/graphql/Page.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.amplifyframework.api.graphql;\n+\n+public abstract class Page<M> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM1MjUyMw=="}, "originalCommit": null, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkwNDY0NA==", "bodyText": "I like that!  I'll update it.", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428904644", "createdAt": "2020-05-21T20:45:56Z", "author": {"login": "richardmcclellan"}, "path": "core/src/main/java/com/amplifyframework/api/graphql/Page.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.amplifyframework.api.graphql;\n+\n+public abstract class Page<M> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM1MjUyMw=="}, "originalCommit": null, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTc1MDAyOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/GsonErrorDeserializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMTowNzo1N1rOGZHp3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMTowNzo1N1rOGZHp3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk5Mjk5MA==", "bodyText": "Yess!!! Love it :-D", "url": "https://github.com/aws-amplify/amplify-android/pull/488#discussion_r428992990", "createdAt": "2020-05-22T01:07:57Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/GsonErrorDeserializer.java", "diffHunk": "@@ -66,7 +65,7 @@\n                     message = context.deserialize(value, String.class);\n                     break;\n                 case LOCATIONS_KEY:\n-                    Type locationsType = new TypeToken<List<GraphQLLocation>>() {}.getType();\n+                    Type locationsType = TypeMaker.getParameterizedType(List.class, GraphQLLocation.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c8cd1b6901f24d57ba48849c33fa8b7ade5aa7"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1270, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}