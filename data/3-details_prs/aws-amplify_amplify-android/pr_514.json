{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMTE1NTMz", "number": 514, "title": "refactor(api): clean up model-based apis", "bodyText": "Notes:\nFollowing the decision of not having the model-based calls as part of the API Category contract, I moved them out and created semantic factories to build the GraphQLRequest from the models, so the functionality is preserved.\nDe-coupling the Model from the API category will allow us to keep a minimal and generic GraphQL client that will be open for integration with other GraphQL libraries that generate code for GraphQL backends, such as AppSync, Apollo, Prisma, etc.\nExamples:\nMutation of type create:\n// previous\nAmplify.API.mutate(post, MutationType.CREATE, /* result/error lambdas */);\n\n// new (mimics the underlying GraphQL statement: createPost)\nAmplify.API.mutate(ModelMutation.create(post), /* result/error lambdas */);\n// or with static imports\nAmplify.API.mutate(create(post), /* result/error lambdas */);\nQueries:\n// previous\nAmplify.API.query(Post.class, /* result/error lambdas */);\n\n// new  (mimics the underlying GraphQL statement: listPosts)\nAmplify.API.query(ModelQuery.list(Post.class), /* result/error lambdas */);\n// or with static imports\nAmplify.API.query(list(Post.class), /* result/error lambdas */);\n\n// ---\n\n// previous\nAmplify.API.query(Post.class, \"id\", /* result/error lambdas */);\n\n// new  (mimics the underlying GraphQL statement: getPost)\nAmplify.API.query(ModelQuery.get(Post.class, \"id\"), /* result/error lambdas */);\n// or with static imports\nAmplify.API.query(get(Post.class, \"id\"), /* result/error lambdas */);\nSee the diff for more examples.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-05-22T19:51:56Z", "url": "https://github.com/aws-amplify/amplify-android/pull/514", "merged": true, "mergeCommit": {"oid": "3d5117a03e065aa5a354bae1edf5e1b7ad630377"}, "closed": true, "closedAt": "2020-05-23T10:45:19Z", "author": {"login": "drochetti"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcj3uj4AH2gAyNDIyMTE1NTMzOjM0NTJmOWQzYTFkNDAzM2Q2NTk5M2ViNzRhNWZmNWMwODRiOWZkMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcj93YgAH2gAyNDIyMTE1NTMzOjg3NjU2NjZmNmQ4ZTY5MzJkNGY0MzlkYmVkNGNmN2NjNTA5NjgyOGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d", "committedDate": "2020-05-22T19:49:04Z", "message": "refactor(api): clean up model-based apis"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTU3Mjk0", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417157294", "createdAt": "2020-05-22T20:01:36Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowMTozNlrOGZiafQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowMTozNlrOGZiafQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTQyMQ==", "bodyText": "Change to default system runtime exception - such as InvalidParameter", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431421", "createdAt": "2020-05-22T20:01:36Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -93,18 +93,17 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTU4NDkz", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417158493", "createdAt": "2020-05-22T20:04:17Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowNDoxN1rOGZid9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDowNDoxN1rOGZid9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA==", "bodyText": "Don't use Report bug for these types", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429432308", "createdAt": "2020-05-22T20:04:17Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n+\n+        private static final long serialVersionUID = 1L;\n+\n+        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n+            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 199}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTYyODQ1", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417162845", "createdAt": "2020-05-22T20:14:14Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoxNDoxNFrOGZirKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoxNDoxNFrOGZirKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ==", "bodyText": "Unused param", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429435691", "createdAt": "2020-05-22T20:14:14Z", "author": {"login": "TrekSoft"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTY1MzI2", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417165326", "createdAt": "2020-05-22T20:23:43Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyMzo0NFrOGZiz3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyMzo0NFrOGZiz3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNzkxNw==", "bodyText": "Remove comment", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429437917", "createdAt": "2020-05-22T20:23:44Z", "author": {"login": "TrekSoft"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -121,6 +121,7 @@ public void syncUpToCloudIsWorking() throws AmplifyException {\n         publishedMutationsAccumulator.await();\n \n         // Try to get Charley from the backend.\n+//        BlogOwner remoteCharley = api.get(BlogOwner.class, localCharley.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTY2NTA0", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417166504", "createdAt": "2020-05-22T20:27:07Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyNzowN1rOGZi3QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMDoyNzowN1rOGZi3QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzODc4NA==", "bodyText": "Not important for this PR, but this should be R, not T.   This was something I missed in my PR.  We can fix it later without it being a breaking change though.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429438784", "createdAt": "2020-05-22T20:27:07Z", "author": {"login": "richardmcclellan"}, "path": "rxbindings/src/main/java/com/amplifyframework/rx/RxApiBinding.java", "diffHunk": "@@ -50,134 +46,44 @@\n         this.api = api;\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(@NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(modelClass, searchCriteria, onResult, onError));\n-\n-    }\n-\n     @NonNull\n     public <R> Single<GraphQLResponse<R>> query(@NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull String modelId) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, modelId, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<Iterable<T>>> query(\n-            @NonNull String apiName, @NonNull Class<T> modelClass, @NonNull QueryPredicate searchCriteria) {\n-        return toSingle((onResult, onError) -> api.query(apiName, modelClass, searchCriteria, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <R> Single<GraphQLResponse<R>> query(\n             @NonNull String apiName, @NonNull GraphQLRequest<R> graphQlRequest) {\n         return toSingle((onResult, onError) -> api.query(apiName, graphQlRequest, onResult, onError));\n     }\n \n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationType, onResult, onError));\n-    }\n-\n-    @NonNull\n-    @Override\n-    public <T extends Model> Single<GraphQLResponse<T>> mutate(\n-            @NonNull T model, @NonNull QueryPredicate mutationCriteria, @NonNull MutationType mutationType) {\n-        return toSingle((onResult, onError) -> api.mutate(model, mutationCriteria, mutationType, onResult, onError));\n-    }\n-\n     @NonNull\n     @Override\n     public <T> Single<GraphQLResponse<T>> mutate(@NonNull GraphQLRequest<T> graphQlRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/21064d45ffdc71f48050d70508939dc96b0e48d5", "committedDate": "2020-05-22T21:07:49Z", "message": "address initial PR feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTU2MzQ3", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417156347", "createdAt": "2020-05-22T19:59:16Z", "commit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTo1OToxN1rOGZiX2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTowNzozMVrOGZjpMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMDc0NQ==", "bodyText": "So long as it gets caught internally and then composed into an ApiException, this is probably good", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429430745", "createdAt": "2020-05-22T19:59:17Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -237,10 +235,9 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new InvalidGraphQLRequestRuntimeException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMTAzNQ==", "bodyText": "By the time you reference this as Outer.Inner, it\u2019ll be quite long. Can we shorten the expression of this exception, somehow?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429431035", "createdAt": "2020-05-22T20:00:21Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 194}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ0OTg2Nw==", "bodyText": "Yea, the AmplifyException has the strongly modeled recovery exception. I don't think we should inline the recovery suggestions into causes. I'm imagining that this InvalidGraphQLRequestRuntimeException gets composed into an ApiException, before being returned to the customer. If that's so, then we'd have two recovery suggestions. This one, then the one in ApiException.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429449867", "createdAt": "2020-05-22T21:01:21Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -468,4 +458,17 @@ private static String getModelFields(Class<? extends Model> clazz, int levelsDee\n \n         return result.toString();\n     }\n+\n+    static final class InvalidGraphQLRequestRuntimeException extends RuntimeException {\n+\n+        private static final long serialVersionUID = 1L;\n+\n+        InvalidGraphQLRequestRuntimeException(final String message, final Exception rootCause) {\n+            super(message + \"\\n\" + AmplifyException.REPORT_BUG_TO_AWS_SUGGESTION, rootCause);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzMjMwOA=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 199}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDI5MA==", "bodyText": "It's a public API, the implementation needs to be updated after release to use the token. At least, I think that's whats being stated here, right, @drochetti?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450290", "createdAt": "2020-05-22T21:02:57Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/ModelPagination.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import androidx.annotation.Nullable;\n+\n+/**\n+ * TODO.\n+ */\n+public final class ModelPagination {\n+\n+    private static final int DEFAULT_LIMIT = 1000;\n+\n+    private int limit;\n+    private final String nextToken;\n+\n+    private ModelPagination(int limit, String nextToken) {\n+        this.limit = limit;\n+        this.nextToken = nextToken;\n+    }\n+\n+    /**\n+     * TODO.\n+     * @return todo.\n+     */\n+    public static ModelPagination firstPage() {\n+        return nextToken(null);\n+    }\n+\n+    /**\n+     * TODO.\n+     * @param nextToken todo.\n+     * @return todo.\n+     */\n+    public static ModelPagination nextToken(@Nullable String nextToken) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQzNTY5MQ=="}, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MDg4MA==", "bodyText": "ModelQuery is a good name, based on what the class does.\nHowever, when a customer uses it, they might prefer to write like:\napi.query(Where.modelClass(BlogOwner.class), ..., ...)\n\nor something like what we did for the QueryOptions.\nMaybe just,\napi.query(Models.ofType(BlogOwner.class)\n\nThat way we at least have a separate Models.java to put factory methods into, that know about <T extends Model> (I forget where it landed, but Where doesn't know about <T extends Model>, right?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429450880", "createdAt": "2020-05-22T21:05:00Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -145,7 +143,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n         GraphQLResponse<Iterable<BlogOwner>> actualResponse =\n             Await.<GraphQLResponse<Iterable<BlogOwner>>, ApiException>result(((onResult, onError) ->\n-                plugin.query(BlogOwner.class, onResult, onError)\n+                plugin.query(ModelQuery.list(BlogOwner.class), onResult, onError)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ1MTU3MA==", "bodyText": "Can you remove the full qualification here, by adding an import for it?", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429451570", "createdAt": "2020-05-22T21:07:31Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/AWSApiPluginTest.java", "diffHunk": "@@ -159,7 +157,7 @@ public void graphQlQueryRendersValidResponse() throws ApiException {\n \n     /**\n      * It should be possible to perform a successful call to\n-     * {@link AWSApiPlugin#mutate(Model, MutationType, Consumer, Consumer)}.\n+     * {@link AWSApiPlugin#mutate(com.amplifyframework.api.graphql.GraphQLRequest, Consumer, Consumer)}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3452f9d3a1d4033d65993eb74a5ff5c084b9fd1d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTk0OTM4", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417194938", "createdAt": "2020-05-22T21:36:27Z", "commit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTozNjoyN1rOGZkR5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMTozNjoyN1rOGZkR5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ2MTk5MQ==", "bodyText": "Let's just kill all the tests that use models, or change model to string. The rxbinding (even tests) should only know about the core module, not any plugin.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429461991", "createdAt": "2020-05-22T21:36:27Z", "author": {"login": "jamesonwilliams"}, "path": "rxbindings/build.gradle", "diffHunk": "@@ -30,4 +30,5 @@ dependencies {\n         // https://github.com/robolectric/robolectric/issues/5245\n         exclude group: 'com.google.auto.service', module: 'auto-service'\n     }\n+    testImplementation project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21064d45ffdc71f48050d70508939dc96b0e48d5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "862581a9fe7637476b29915cfaa37dc0ce7fab87", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/862581a9fe7637476b29915cfaa37dc0ce7fab87", "committedDate": "2020-05-22T21:49:18Z", "message": "move the model-based builders to core.model.graphql package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de881cd4fee3b6d0f93d269f94e706771f9809ef", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/de881cd4fee3b6d0f93d269f94e706771f9809ef", "committedDate": "2020-05-22T22:05:58Z", "message": "fix checkstyle violations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60bbb6befac90e30ffe0287fa7829c9b250d18cc", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/60bbb6befac90e30ffe0287fa7829c9b250d18cc", "committedDate": "2020-05-22T22:24:14Z", "message": "more checkstyle and lgtm violations fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/f112e0dc57e72a54b80d06bd9024b481df2c9b0d", "committedDate": "2020-05-22T23:10:59Z", "message": "fix rxbindings tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5dd32d9483240e584563bd49b5e2f79c3745a31", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/b5dd32d9483240e584563bd49b5e2f79c3745a31", "committedDate": "2020-05-22T23:29:12Z", "message": "add ModelMutation docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32123080c800bf0cd23ab3055aef69862ffcfce9", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/32123080c800bf0cd23ab3055aef69862ffcfce9", "committedDate": "2020-05-22T23:37:44Z", "message": "fix testutils dependency and move model+graphql integration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MjI2NDg2", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417226486", "createdAt": "2020-05-22T23:44:36Z", "commit": {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMzo0NDozNlrOGZmCEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQyMzo0NDozNlrOGZmCEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQ5MDcwNw==", "bodyText": "Hmm..\nR represents the data on a GraphQLResponse\nT represents the Model type (or actually it looks like you've renamed most of these to M in this PR, which makes more sense than T anyway.\nSo, this should either return a GraphQLRequest<R> or a GraphQLRequest<Iterable<T>>, NOT a GraphQLRequest<Iterable<R>>", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429490707", "createdAt": "2020-05-22T23:44:36Z", "author": {"login": "richardmcclellan"}, "path": "rxbindings/src/test/java/com/amplifyframework/rx/RxApiBindingTest.java", "diffHunk": "@@ -381,4 +378,16 @@ public void httpPostEmitsResult() {\n         verify(delegate)\n             .post(eq(options), anyConsumer(), anyConsumer());\n     }\n+\n+    private static <R> GraphQLRequest<R> createMockMutationRequest(Class<R> responseType) {\n+        return new GraphQLRequest<R>(\"\", responseType, null);\n+    }\n+\n+    private static <R> GraphQLRequest<Iterable<R>> createMockListRequest(Class<R> responseType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f112e0dc57e72a54b80d06bd9024b481df2c9b0d"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "410037a2ab395c15965cf490b0460ff364f8f220", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/410037a2ab395c15965cf490b0460ff364f8f220", "committedDate": "2020-05-22T23:50:18Z", "message": "add more javadoc\n\nps: adding javadoc to getters/setters is a delightful experience."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5147c0949f790b60af8e550303eaa10f15e6895a", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/5147c0949f790b60af8e550303eaa10f15e6895a", "committedDate": "2020-05-22T23:59:14Z", "message": "fix parameter naming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12df073aef71222660cc85b744a0de7b1a5bbbac", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/12df073aef71222660cc85b744a0de7b1a5bbbac", "committedDate": "2020-05-23T00:11:56Z", "message": "add ModelQuery javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7bd3414b94de545aedee3388f7f5b27f29047795", "committedDate": "2020-05-23T00:23:57Z", "message": "add ModelSubscription javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/95d0c59e9337045055c9f46c8a8c54e86b8b6561", "committedDate": "2020-05-23T00:51:41Z", "message": "add javadoc to the appsync graphql request factory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MjM3NzIz", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417237723", "createdAt": "2020-05-23T01:13:44Z", "commit": {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMToxMzo0NFrOGZmpvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMToxMzo0NFrOGZmpvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMDg2MQ==", "bodyText": "Instead of all of these, you can do:\n@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n\nOn top of the class definition. This will disable the check for the entire class.\nOf rouse, better would be to write the docs. But, the suppression is still better than the not-filled-in stuff, I think.", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429500861", "createdAt": "2020-05-23T01:13:44Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -160,20 +186,29 @@ private AppSyncGraphQLRequestFactory() { }\n                     new GsonVariablesSerializer()\n             );\n         } catch (AmplifyException exception) {\n-            throw new ApiException(\n+            throw new IllegalStateException(\n                     \"Could not generate a schema for the specified class\",\n-                    exception,\n-                    \"Check the included exception for more details\"\n+                    exception\n             );\n         }\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bd3414b94de545aedee3388f7f5b27f29047795"}, "originalPosition": 106}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MjQyMTQ3", "url": "https://github.com/aws-amplify/amplify-android/pull/514#pullrequestreview-417242147", "createdAt": "2020-05-23T02:13:49Z", "commit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoxMzo0OVrOGZm7WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QwMjoyNDoxOVrOGZm92A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNTM2OQ==", "bodyText": "correct correct => correct", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429505369", "createdAt": "2020-05-23T02:13:49Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/AppSyncGraphQLRequestFactory.java", "diffHunk": "@@ -65,13 +65,16 @@\n     private AppSyncGraphQLRequestFactory() { }\n \n     /**\n-     * TODO.\n-     * @param modelClass todo.\n-     * @param objectId todo.\n-     * @param <R> todo.\n-     * @param <T> todo.\n-     * @return todo.\n-     * @throws IllegalStateException todo.\n+     * Creates a {@link GraphQLRequest} that represents a query that expects a single value as a result.\n+     * The request will be created with the correct correct document based on the model schema and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwNjAwOA==", "bodyText": "Ah! It's over here, now. :-D This doesn't bother me as much though. Being a purist about our dependency hierarchy in test code is less important.\nNot for this PR --\nProbably, though, we should migrate SyncrhonousApi so that it only contains methods that resemble ApiCategoryBehavior, sans-callbacks.\nLike:\nvoid asyncFoo(Bar bar, Consumer<Ok> onOk, Conusmer<NotOk> onNotOk);\n\n-->\nOk syncFoo(Bar bar) throws NotOk", "url": "https://github.com/aws-amplify/amplify-android/pull/514#discussion_r429506008", "createdAt": "2020-05-23T02:24:19Z", "author": {"login": "jamesonwilliams"}, "path": "testutils/build.gradle", "diffHunk": "@@ -22,4 +22,8 @@ dependencies {\n     implementation dependency.junit\n     implementation dependency.androidx.test.core\n     implementation dependency.rxjava\n+\n+    // dependency on Model/GraphQL integration classes\n+    // remove when modules are re-organized to provide better isolation\n+    compileOnly project(path: ':aws-api')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95d0c59e9337045055c9f46c8a8c54e86b8b6561"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8765666f6d8e6932d4f439dbed4cf7cc5096828d", "author": {"user": {"login": "drochetti", "name": "Daniel Rochetti"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/8765666f6d8e6932d4f439dbed4cf7cc5096828d", "committedDate": "2020-05-23T02:58:08Z", "message": "minor fixes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2559, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}