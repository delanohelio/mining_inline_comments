{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MDMwMjY5", "number": 391, "title": "Use File instead of String input parameters", "bodyText": "Issue #, if available: n/a\nDescription of changes: Currently downloadFile and uploadFile expect a String with the local path for the source file and destination file respectively. To move us closer to iOS and to simplify the iOS, use a File instead as the input parameter.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-04-22T03:59:35Z", "url": "https://github.com/aws-amplify/amplify-android/pull/391", "merged": true, "mergeCommit": {"oid": "4c920ce5c0cd00bb54c6a354a355c1746ff52622"}, "closed": true, "closedAt": "2020-04-22T17:21:13Z", "author": {"login": "jpignata"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ_2ivgH2gAyNDA3MDMwMjY5OjE2ZDA0MDYyMjgxYjk5YzQ1ZjM2NjkwNzEzNmQwYzAwYjg5MmJkMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaLVKXgFqTM5ODM5MjkzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28", "author": {"user": {"login": "jpignata", "name": "John Pignata"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/16d04062281b99c45f366907136d0c00b892bd28", "committedDate": "2020-04-22T03:37:47Z", "message": "Use File instead of String input parameters\n\nCurrently downloadFile and uploadFile expect a String with the local\npath for the source file and destination file respectively. To move us\ncloser to iOS and to simplify the iOS, use a File instead as the input\nparameter."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3ODM5MTk2", "url": "https://github.com/aws-amplify/amplify-android/pull/391#pullrequestreview-397839196", "createdAt": "2020-04-22T04:42:42Z", "commit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo0Mjo0MlrOGJjFcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNDo1NToxN1rOGJjUyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NTIwMw==", "bodyText": "Can we kill the declaration on L96, now? Is String local still used?", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412665203", "createdAt": "2020-04-22T04:42:42Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageDownloadTest.java", "diffHunk": "@@ -101,14 +101,12 @@ public static void setUpOnce() throws Exception {\n         // Upload large test file\n         largeFile = new RandomTempFile(LARGE_FILE_NAME, LARGE_FILE_SIZE);\n         key = LARGE_FILE_NAME;\n-        local = largeFile.getAbsolutePath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2NzQ4Mg==", "bodyText": "This existed before this PR -- but just noting it since I saw it:\nfileName is a weird name for the first argument, in these various calls to SynchronousStorage#uploadFile(String, File, StorageOptions). I think it should be named remoteKey, right?", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412667482", "createdAt": "2020-04-22T04:50:05Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/androidTest/java/com/amplifyframework/storage/s3/AWSS3StorageUploadAccessLevelTest.java", "diffHunk": "@@ -88,9 +88,8 @@ public void setUp() throws Exception {\n         mobileClient.signOut();\n \n         // Create a new file to upload\n-        File fileToUpload = new RandomTempFile(UPLOAD_SIZE);\n-        fileName = fileToUpload.getName();\n-        filePath = fileToUpload.getPath();\n+        uploadFile = new RandomTempFile(UPLOAD_SIZE);\n+        fileName = uploadFile.getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY2OTEzMQ==", "bodyText": "We have a utility in the code base called RandomTempFile, I think that could be a good replacement to these File.createTemptFile(..., ...) calls:\n\nIt can throw some kind of a E extends RuntimeException, which would prevent the need for us to snake this IOException through, and onto every @Test;\nInstead of passing \"data\" every time, we could let the RandomTempFile populate some random string data.", "url": "https://github.com/aws-amplify/amplify-android/pull/391#discussion_r412669131", "createdAt": "2020-04-22T04:55:17Z", "author": {"login": "jamesonwilliams"}, "path": "aws-storage-s3/src/test/java/com/amplifyframework/storage/s3/StorageComponentTest.java", "diffHunk": "@@ -144,11 +145,12 @@ public void testGenerateUrlGetsPresignedUrl() throws StorageException {\n      * invokes the registered AWSS3StoragePlugin instance and returns a\n      * {@link StorageDownloadFileResult} with correct file path.\n      * @throws StorageException when an error is encountered while downloading\n+     * @throws IOException when a temporary file cannot be created\n      */\n     @Test\n-    public void testDownloadToFileGetsFile() throws StorageException {\n+    public void testDownloadToFileGetsFile() throws StorageException, IOException {\n         final String fromRemoteKey = RandomString.string();\n-        final String toLocalPath = RandomString.string();\n+        final File toLocalFile = File.createTempFile(\"download\", \"data\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16d04062281b99c45f366907136d0c00b892bd28"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54ca1468bfab20cd3172c87da147dc036b515bc4", "author": {"user": {"login": "jpignata", "name": "John Pignata"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/54ca1468bfab20cd3172c87da147dc036b515bc4", "committedDate": "2020-04-22T13:10:07Z", "message": "Addressing PR feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MzYzMTI0", "url": "https://github.com/aws-amplify/amplify-android/pull/391#pullrequestreview-398363124", "createdAt": "2020-04-22T16:25:44Z", "commit": {"oid": "54ca1468bfab20cd3172c87da147dc036b515bc4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MzkyOTM1", "url": "https://github.com/aws-amplify/amplify-android/pull/391#pullrequestreview-398392935", "createdAt": "2020-04-22T17:00:11Z", "commit": {"oid": "54ca1468bfab20cd3172c87da147dc036b515bc4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2706, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}