{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MjQ3MDkz", "number": 218, "title": "[API] Accept Lambdas in GraphQL Behaviors", "bodyText": "To reduce verbosity, the ResultListener and StreamListener are\nremoved from the contracts of the GraphQL behaviors. Instead, the\nGraphQL behaviors are reworked to accept \"decomposed\" versions of those\ncallbacks, using Consumer and Action, directly.\nFor example, a query in Amplify 0.9 would have been written as:\nAmplify.API.query(Person.class,\n    new ResultListener<GraphQLResponse<Iterable<Person>>, ApiException>() {\n        @Override\n        public void onResponse(GraphQLResponse<Iterable<Person>> response) {\n            Log.i(TAG, \"Got results!\");\n        }\n\n        @Override\n        public void onError(ApiException failure) {\n            Log.e(TAG, \"Failed.\", failure);\n        }\n    }\n);\n\nBut is now expressed as:\nAmplify.API.query(Person.class,\n    response -> Log.i(TAG, \"Got a response: \" + response),\n    failure -> Log.e(TAG, \"Failed to get a GraphQL response.\", failure)\n);\n\nIssue #, if available:\nDescription of changes:\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-01-04T21:00:13Z", "url": "https://github.com/aws-amplify/amplify-android/pull/218", "merged": true, "mergeCommit": {"oid": "b598aad946e89b17b3e5e2caf7165001b7ab71f9"}, "closed": true, "closedAt": "2020-01-06T23:30:38Z", "author": {"login": "jamesonwilliams"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3wqz1AFqTMzODgxOTY1MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb30P58AFqTMzODk0NDc3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4ODE5NjUw", "url": "https://github.com/aws-amplify/amplify-android/pull/218#pullrequestreview-338819650", "createdAt": "2020-01-06T18:42:58Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxODo0Mjo1OFrOFalxDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxODo0Mjo1OFrOFalxDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQyNjA2MA==", "bodyText": "not exactly onResult() anymore ;)", "url": "https://github.com/aws-amplify/amplify-android/pull/218#discussion_r363426060", "createdAt": "2020-01-06T18:42:58Z", "author": {"login": "raphkim"}, "path": "aws-datastore/src/test/java/com/amplifyframework/datastore/network/MockAppSyncEndpoint.java", "diffHunk": "@@ -61,24 +60,24 @@ static Configurator configure(AppSyncEndpoint mock) {\n         @SafeVarargs\n         final <T extends Model> Configurator mockSuccessResponse(\n                 Class<T> modelClass, ModelWithMetadata<T>... responseItems) {\n-\n             doAnswer(invocation -> {\n-                // Get a handle to the listener that is passed into the sync() method\n-                // ResultListener is the third and final param at index 2 (@0, @1, @2).\n-                final int argumentPositionForResultListener = 2;\n-                final ResultListener<GraphQLResponse<Iterable<ModelWithMetadata<T>>>, DataStoreException> listener =\n-                    invocation.getArgument(argumentPositionForResultListener);\n+                // Get a handle to the response consumer that is passed into the sync() method\n+                // Response consumer is the third param, at index 2 (@0, @1, @2, @3).\n+                final int argumentPositionForResponseConsumer = 2;\n+                final Consumer<GraphQLResponse<Iterable<ModelWithMetadata<T>>>> consumer =\n+                    invocation.getArgument(argumentPositionForResponseConsumer);\n \n                 // Call its onResult(), and pass the mocked items inside of a GraphQLResponse wrapper", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4ODI4MTE2", "url": "https://github.com/aws-amplify/amplify-android/pull/218#pullrequestreview-338828116", "createdAt": "2020-01-06T18:57:56Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxODo1Nzo1NlrOFamKpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxODo1Nzo1NlrOFamKpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQzMjYxMw==", "bodyText": "Is there any other GraphQL behavior besides those three specified?", "url": "https://github.com/aws-amplify/amplify-android/pull/218#discussion_r363432613", "createdAt": "2020-01-06T18:57:56Z", "author": {"login": "raphkim"}, "path": "core/src/main/java/com/amplifyframework/api/GraphQlBehavior.java", "diffHunk": "@@ -23,14 +23,13 @@\n import com.amplifyframework.api.graphql.GraphQLResponse;\n import com.amplifyframework.api.graphql.MutationType;\n import com.amplifyframework.api.graphql.SubscriptionType;\n-import com.amplifyframework.core.ResultListener;\n-import com.amplifyframework.core.StreamListener;\n+import com.amplifyframework.core.Action;\n+import com.amplifyframework.core.Consumer;\n import com.amplifyframework.core.model.Model;\n import com.amplifyframework.core.model.query.predicate.QueryPredicate;\n-import com.amplifyframework.hub.HubCategory;\n \n /**\n- * GraphQL behaviors which include operations like query/subscribe/mutate operations.\n+ * GraphQL behaviors include operations like query, subscribe, mutate, etc.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4ODI5Mzkx", "url": "https://github.com/aws-amplify/amplify-android/pull/218#pullrequestreview-338829391", "createdAt": "2020-01-06T19:00:09Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTowMDoxMFrOFamOXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTowMDoxMFrOFamOXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQzMzU2Ng==", "bodyText": "Are we no longer using the Hub? I thought that we would be publishing everything to hub by default on top of the local callback to caller thread?", "url": "https://github.com/aws-amplify/amplify-android/pull/218#discussion_r363433566", "createdAt": "2020-01-06T19:00:10Z", "author": {"login": "raphkim"}, "path": "core/src/main/java/com/amplifyframework/api/GraphQlBehavior.java", "diffHunk": "@@ -23,14 +23,13 @@\n import com.amplifyframework.api.graphql.GraphQLResponse;\n import com.amplifyframework.api.graphql.MutationType;\n import com.amplifyframework.api.graphql.SubscriptionType;\n-import com.amplifyframework.core.ResultListener;\n-import com.amplifyframework.core.StreamListener;\n+import com.amplifyframework.core.Action;\n+import com.amplifyframework.core.Consumer;\n import com.amplifyframework.core.model.Model;\n import com.amplifyframework.core.model.query.predicate.QueryPredicate;\n-import com.amplifyframework.hub.HubCategory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4ODMxNDc5", "url": "https://github.com/aws-amplify/amplify-android/pull/218#pullrequestreview-338831479", "createdAt": "2020-01-06T19:04:06Z", "commit": null, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47a9b0ece6523b4087068262c76a129a4b4d88ba", "author": {"user": {"login": "jamesonwilliams", "name": "Jameson Williams"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/47a9b0ece6523b4087068262c76a129a4b4d88ba", "committedDate": "2020-01-06T22:49:36Z", "message": "[API] Accept Lambdas in GraphQL Behaviors\n\nTo reduce verbosity, the `ResultListener` and `StreamListener` are\nremoved from the contracts of the GraphQL behaviors. Instead, the\nGraphQL behaviors are reworked to accept \"decomposed\" versions of those\ncallbacks, using `Consumer` and `Action`, directly.\n\nFor example, a query in Amplify 0.9 would have been written as:\n\n```\nAmplify.API.query(Person.class,\n    new ResultListener<GraphQLResponse<Iterable<Person>>>() {\n        @Override\n        public void onResponse(GraphQLResponse<Iterable<Person>> response) {\n            Log.i(TAG, \"Got results!\");\n        }\n\n        @Override\n        public void onError(ApiException failure) {\n            Log.e(TAG, \"Failed.\", failure);\n        }\n    }\n);\n```\n\nBut is now expressed as:\n\n```\nAmplify.API.query(Person.class,\n    response -> Log.i(TAG, \"Got a response: \" + response),\n    failure -> Log.e(TAG, \"Failed to get a GraphQL response.\", failure)\n);\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4OTQ0Nzcx", "url": "https://github.com/aws-amplify/amplify-android/pull/218#pullrequestreview-338944771", "createdAt": "2020-01-06T22:53:12Z", "commit": {"oid": "47a9b0ece6523b4087068262c76a129a4b4d88ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2783, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}