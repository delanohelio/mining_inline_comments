{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NDQ0NDIy", "number": 251, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo0NjoxNFrODbxH3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTowMDo0OVrODbxQ1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQyOTc1OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo0NjoxNFrOFjcXsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMToyMzozNFrOFjc7dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwOTI5OQ==", "bodyText": "What's a Charley model?", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372709299", "createdAt": "2020-01-30T00:46:14Z", "author": {"login": "undefobj"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -91,8 +116,8 @@ public void blogOwnerSavedIntoDataStoreIsThenQueriableInRemoteAppSyncApi() throw\n             .build();\n         dataStore.save(localCharley);\n \n-        // Wait a bit. TODO: this is lame; how to tell deterministically when sync engine has sync'd?\n-        Sleep.milliseconds(NETWORK_OP_TIMEOUT_MS + DATA_STORE_OP_TIMEOUT_MS);\n+        // Wait for a Hub event telling us that our Charley model got published to the cloud.\n+        outboundModelEventAccumulator.takeOne();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwOTk4OQ==", "bodyText": "Oh I see, .name(\"Charley Crockett\")\nI was thinking this was a new data structure \ud83d\ude02", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372709989", "createdAt": "2020-01-30T00:48:56Z", "author": {"login": "undefobj"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -91,8 +116,8 @@ public void blogOwnerSavedIntoDataStoreIsThenQueriableInRemoteAppSyncApi() throw\n             .build();\n         dataStore.save(localCharley);\n \n-        // Wait a bit. TODO: this is lame; how to tell deterministically when sync engine has sync'd?\n-        Sleep.milliseconds(NETWORK_OP_TIMEOUT_MS + DATA_STORE_OP_TIMEOUT_MS);\n+        // Wait for a Hub event telling us that our Charley model got published to the cloud.\n+        outboundModelEventAccumulator.takeOne();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwOTI5OQ=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxODQ1NA==", "bodyText": "Haha we should invent it!!", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372718454", "createdAt": "2020-01-30T01:23:34Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/androidTest/java/com/amplifyframework/datastore/AWSDataStorePluginInstrumentedTest.java", "diffHunk": "@@ -91,8 +116,8 @@ public void blogOwnerSavedIntoDataStoreIsThenQueriableInRemoteAppSyncApi() throw\n             .build();\n         dataStore.save(localCharley);\n \n-        // Wait a bit. TODO: this is lame; how to tell deterministically when sync engine has sync'd?\n-        Sleep.milliseconds(NETWORK_OP_TIMEOUT_MS + DATA_STORE_OP_TIMEOUT_MS);\n+        // Wait for a Hub event telling us that our Charley model got published to the cloud.\n+        outboundModelEventAccumulator.takeOne();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwOTI5OQ=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQzOTQ0OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo1MjoyNVrOFjcdfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTozNDowNlrOFjdFSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMDc4Mw==", "bodyText": "One thought here is do we want to have this on a channel for DataStore or API? We've already seen customers asking about using the API category and DataStore together, so there might be merit to having everything going over the API channel for events from AppSync. OTOH we could always publish to both or switch it later. Food for thought.", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372710783", "createdAt": "2020-01-30T00:52:25Z", "author": {"login": "undefobj"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "diffHunk": "@@ -137,6 +140,11 @@ private void startModelSubscriptions() {\n                         AmplifyException.TODO_RECOVERY_SUGGESTION\n                     );\n             }\n+\n+            // Notify Hub that we just updated the local storage.\n+            HubEvent<? extends Model> receivedFromCloudEvent =\n+                HubEvent.create(DataStoreChannelEventName.RECEIVED_FROM_CLOUD, mutation.model());\n+            Amplify.Hub.publish(HubChannel.DATASTORE, receivedFromCloudEvent);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcyMDk2OQ==", "bodyText": "Since this event was initiated by the datastore, I thought to put it out onto the datastore channel.\nI think there will be fewer hub events for the API category, overall. Although, there might be some good reasons to use Hub for subscription events, paging on list APIs, retries on recoverable error, things like this.", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372720969", "createdAt": "2020-01-30T01:34:06Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "diffHunk": "@@ -137,6 +140,11 @@ private void startModelSubscriptions() {\n                         AmplifyException.TODO_RECOVERY_SUGGESTION\n                     );\n             }\n+\n+            // Notify Hub that we just updated the local storage.\n+            HubEvent<? extends Model> receivedFromCloudEvent =\n+                HubEvent.create(DataStoreChannelEventName.RECEIVED_FROM_CLOUD, mutation.model());\n+            Amplify.Hub.publish(HubChannel.DATASTORE, receivedFromCloudEvent);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMDc4Mw=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQ0MTQ4OnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo1Mzo0M1rOFjcevg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMToyNTo1N1rOFjc-IA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMTEwMg==", "bodyText": "Is this just for local debugging and should we remove?", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372711102", "createdAt": "2020-01-30T00:53:43Z", "author": {"login": "undefobj"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "diffHunk": "@@ -151,7 +159,12 @@ private void startDrainingChangeJournal() {\n                 .flatMapSingle(this::publishToNetwork)\n                 .flatMapSingle(storageItemChangeJournal::remove)\n                 .subscribe(\n-                    processedChange -> LOG.info(\"Change processed successfully! \" + processedChange),\n+                    processedChange -> {\n+                        LOG.info(\"Change processed successfully! \" + processedChange);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxOTEzNg==", "bodyText": "Hm, I should change it from .info to .debug. Since the default is to only print info's or better, debug would effectively turn if off (unless somebody changes the log level.)", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372719136", "createdAt": "2020-01-30T01:25:57Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/network/SyncEngine.java", "diffHunk": "@@ -151,7 +159,12 @@ private void startDrainingChangeJournal() {\n                 .flatMapSingle(this::publishToNetwork)\n                 .flatMapSingle(storageItemChangeJournal::remove)\n                 .subscribe(\n-                    processedChange -> LOG.info(\"Change processed successfully! \" + processedChange),\n+                    processedChange -> {\n+                        LOG.info(\"Change processed successfully! \" + processedChange);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMTEwMg=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQ0MzkyOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo1NTowNlrOFjcgNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTozMToxMVrOFjdCzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMTQ3Ng==", "bodyText": "I like this but do we have a similar structure on iOS that we could align with names? @palpatim @drochetti", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372711476", "createdAt": "2020-01-30T00:55:06Z", "author": {"login": "undefobj"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.datastore;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.amplifyframework.hub.HubCategory;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+\n+import java.util.Objects;\n+\n+/**\n+ * An enumeration of the names of events relating the the {@link DataStoreCategory},\n+ * that are published via {@link HubCategory#publish(HubChannel, HubEvent)} on the\n+ * {@link HubChannel#DATASTORE} channel.\n+ */\n+public enum DataStoreChannelEventName {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcyMDMzMw==", "bodyText": "Good point - since this is API surface, we should get the names and behavior aligned across platforms.", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372720333", "createdAt": "2020-01-30T01:31:11Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.datastore;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.amplifyframework.hub.HubCategory;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+\n+import java.util.Objects;\n+\n+/**\n+ * An enumeration of the names of events relating the the {@link DataStoreCategory},\n+ * that are published via {@link HubCategory#publish(HubChannel, HubEvent)} on the\n+ * {@link HubChannel#DATASTORE} channel.\n+ */\n+public enum DataStoreChannelEventName {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMTQ3Ng=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQ0Nzc2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMDo1Nzo0MlrOFjcijw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTozMDozNFrOFjdCMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMjA3OQ==", "bodyText": "Another thing that we are looking at is \"local only models\" which do not get sync'd to the cloud. A few customers have been asking about this and @drochetti and Manuel are doing a design. In that case we might want to still publish to hub for state management in your app, so it's worth keeping that in mind for the list of possible events - e.g. PUBLISHED_TO_LOCAL", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372712079", "createdAt": "2020-01-30T00:57:42Z", "author": {"login": "undefobj"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.datastore;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.amplifyframework.hub.HubCategory;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+\n+import java.util.Objects;\n+\n+/**\n+ * An enumeration of the names of events relating the the {@link DataStoreCategory},\n+ * that are published via {@link HubCategory#publish(HubChannel, HubEvent)} on the\n+ * {@link HubChannel#DATASTORE} channel.\n+ */\n+public enum DataStoreChannelEventName {\n+    /**\n+     * An item in the local storage has been published to the cloud.\n+     * An event that uses this value for {@link HubEvent#getName()} will contain a model object\n+     * in the {@link HubEvent#getData()}.\n+     */\n+    PUBLISHED_TO_CLOUD(\"published_to_cloud\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcyMDE3OA==", "bodyText": "Okay, cool. Yea, as you note, the DataStoreChangeEventName is really part of the API surface itself, since customers will engage with these names to understand the events on the Hub. I suspect this file will see a bunch more useful stuff come into it.", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372720178", "createdAt": "2020-01-30T01:30:34Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/datastore/DataStoreChannelEventName.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.datastore;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.amplifyframework.hub.HubCategory;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+\n+import java.util.Objects;\n+\n+/**\n+ * An enumeration of the names of events relating the the {@link DataStoreCategory},\n+ * that are published via {@link HubCategory#publish(HubChannel, HubEvent)} on the\n+ * {@link HubChannel#DATASTORE} channel.\n+ */\n+public enum DataStoreChannelEventName {\n+    /**\n+     * An item in the local storage has been published to the cloud.\n+     * An event that uses this value for {@link HubEvent#getName()} will contain a model object\n+     * in the {@link HubEvent#getData()}.\n+     */\n+    PUBLISHED_TO_CLOUD(\"published_to_cloud\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMjA3OQ=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDQ1MjY5OnYy", "diffSide": "RIGHT", "path": "testutils/src/main/java/com/amplifyframework/testutils/HubAccumulator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMTowMDo0OVrOFjclsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwMToyODo1OFrOFjdAwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMjg4Mw==", "bodyText": "I'm not sure if we ever got the filter implemented fully in Hub on Android, just an FYI", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372712883", "createdAt": "2020-01-30T01:00:49Z", "author": {"login": "undefobj"}, "path": "testutils/src/main/java/com/amplifyframework/testutils/HubAccumulator.java", "diffHunk": "@@ -0,0 +1,157 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.testutils;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.core.Amplify;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+import com.amplifyframework.hub.HubEventFilter;\n+import com.amplifyframework.hub.HubEventFilters;\n+import com.amplifyframework.hub.SubscriptionToken;\n+\n+import java.util.ArrayList;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.concurrent.CountDownLatch;\n+\n+/**\n+ * Accumulates {@link HubEvent}s received on a {@link HubChannel}, into an in-memory\n+ * buffer. These may be queried by tests in a synchronous way to check if they have arrived.\n+ */\n+@SuppressWarnings({\"unused\", \"UnusedReturnValue\"})\n+public final class HubAccumulator {\n+    private final HubChannel channel;\n+    private final HubEventFilter filter;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxOTgwOA==", "bodyText": "For Hub, we did, it's more or less just a single if (...) check, in the publish(...) method.", "url": "https://github.com/aws-amplify/amplify-android/pull/251#discussion_r372719808", "createdAt": "2020-01-30T01:28:58Z", "author": {"login": "jamesonwilliams"}, "path": "testutils/src/main/java/com/amplifyframework/testutils/HubAccumulator.java", "diffHunk": "@@ -0,0 +1,157 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.testutils;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.amplifyframework.core.Amplify;\n+import com.amplifyframework.hub.HubChannel;\n+import com.amplifyframework.hub.HubEvent;\n+import com.amplifyframework.hub.HubEventFilter;\n+import com.amplifyframework.hub.HubEventFilters;\n+import com.amplifyframework.hub.SubscriptionToken;\n+\n+import java.util.ArrayList;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.concurrent.CountDownLatch;\n+\n+/**\n+ * Accumulates {@link HubEvent}s received on a {@link HubChannel}, into an in-memory\n+ * buffer. These may be queried by tests in a synchronous way to check if they have arrived.\n+ */\n+@SuppressWarnings({\"unused\", \"UnusedReturnValue\"})\n+public final class HubAccumulator {\n+    private final HubChannel channel;\n+    private final HubEventFilter filter;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxMjg4Mw=="}, "originalCommit": {"oid": "6f6065e05789838cd3da455047a05fc00fb98c77"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1523, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}