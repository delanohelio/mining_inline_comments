{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTQ2OTM1", "number": 439, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxMjozMDo1N1rOD6n6MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxMzoyNDo1OFrOD6o5yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNzk3ODcyOnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationOutbox.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxMjozMDo1N1rOGSj5jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxMjozMDo1N1rOGSj5jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjExNTcyNQ==", "bodyText": "This was the first method that came to mind when I read the PR intro. Looks like you got it covered \ud83d\udc4d", "url": "https://github.com/aws-amplify/amplify-android/pull/439#discussion_r422115725", "createdAt": "2020-05-08T12:30:57Z", "author": {"login": "rjuliano"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/MutationOutbox.java", "diffHunk": "@@ -65,8 +66,10 @@\n     @NonNull\n     Single<Boolean> hasPendingMutation(@NonNull String modelId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0417ec72949f793ee42f77ac8d1b20052ac839f5"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyODE0MTUyOnYy", "diffSide": "RIGHT", "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/PendingMutation.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxMzoyNDo1OFrOGSlbQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNzozNjo0M1rOGStnKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0MDczNw==", "bodyText": "Other than for testing purposes, do we want to leave this instance method callable from any class within this package?\nThis is very low risk, but my only thought is that we want to ensure these time-based UUIDs are generated on the local device only right?", "url": "https://github.com/aws-amplify/amplify-android/pull/439#discussion_r422140737", "createdAt": "2020-05-08T13:24:58Z", "author": {"login": "rjuliano"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/PendingMutation.java", "diffHunk": "@@ -38,34 +37,55 @@\n  * logic onto them, before ultimately uploading to a remote endpoint.\n  * @param <T> Type of model that has experienced a mutation\n  */\n-public final class PendingMutation<T extends Model> {\n+public final class PendingMutation<T extends Model> implements Comparable<PendingMutation<? extends Model>> {\n     private final T mutatedItem;\n     private final Class<T> classOfMutatedItem;\n     private final Type mutationType;\n+    private final TimeBasedUuid mutationId;\n \n-    private PendingMutation(T mutatedItem, Class<T> classOfMutatedItem, Type mutationType) {\n+    private PendingMutation(TimeBasedUuid mutationId, T mutatedItem, Class<T> classOfMutatedItem, Type mutationType) {\n+        this.mutationId = mutationId;\n         this.mutatedItem = mutatedItem;\n         this.classOfMutatedItem = classOfMutatedItem;\n         this.mutationType = mutationType;\n     }\n \n     /**\n-     * Creates a {@link PendingMutation}.\n+     * Creates a {@link PendingMutation}, using a provided mutation ID.\n+     * @param mutationId A globally-unique, *time-based* ID for this mutation event;\n+     *                   the ID is used for temporal ordering of mutations\n      * @param mutatedItem The item that undergone a mutation\n      * @param classOfMutatedItem The class of the item that has undergone mutation\n      * @param mutationType Type of mutation\n      * @param <T> The type of the item that has undergone mutation\n      * @return A {@link PendingMutation}\n      */\n     static <T extends Model> PendingMutation<T> instance(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0417ec72949f793ee42f77ac8d1b20052ac839f5"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI3NDg1OQ==", "bodyText": "This version is actually used by the Gson deserializer, when we convert back from a (peristable) PersistentRecord. This is how we \"recover\" the stored timestamp, back into a PendingMutation.", "url": "https://github.com/aws-amplify/amplify-android/pull/439#discussion_r422274859", "createdAt": "2020-05-08T17:36:43Z", "author": {"login": "jamesonwilliams"}, "path": "aws-datastore/src/main/java/com/amplifyframework/datastore/syncengine/PendingMutation.java", "diffHunk": "@@ -38,34 +37,55 @@\n  * logic onto them, before ultimately uploading to a remote endpoint.\n  * @param <T> Type of model that has experienced a mutation\n  */\n-public final class PendingMutation<T extends Model> {\n+public final class PendingMutation<T extends Model> implements Comparable<PendingMutation<? extends Model>> {\n     private final T mutatedItem;\n     private final Class<T> classOfMutatedItem;\n     private final Type mutationType;\n+    private final TimeBasedUuid mutationId;\n \n-    private PendingMutation(T mutatedItem, Class<T> classOfMutatedItem, Type mutationType) {\n+    private PendingMutation(TimeBasedUuid mutationId, T mutatedItem, Class<T> classOfMutatedItem, Type mutationType) {\n+        this.mutationId = mutationId;\n         this.mutatedItem = mutatedItem;\n         this.classOfMutatedItem = classOfMutatedItem;\n         this.mutationType = mutationType;\n     }\n \n     /**\n-     * Creates a {@link PendingMutation}.\n+     * Creates a {@link PendingMutation}, using a provided mutation ID.\n+     * @param mutationId A globally-unique, *time-based* ID for this mutation event;\n+     *                   the ID is used for temporal ordering of mutations\n      * @param mutatedItem The item that undergone a mutation\n      * @param classOfMutatedItem The class of the item that has undergone mutation\n      * @param mutationType Type of mutation\n      * @param <T> The type of the item that has undergone mutation\n      * @return A {@link PendingMutation}\n      */\n     static <T extends Model> PendingMutation<T> instance(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE0MDczNw=="}, "originalCommit": {"oid": "0417ec72949f793ee42f77ac8d1b20052ac839f5"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1225, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}