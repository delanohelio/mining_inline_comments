{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMTA3OTM4", "number": 502, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDoyOTozNVrOD-ys3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDo0NDowNVrOD-y2AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTY4OTg5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/amplifyframework/api/graphql/GraphQLRequest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDoyOTozNVrOGZHFfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwODowMDozMVrOGZOOAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4MzY3OQ==", "bodyText": "Ah heck. I was gonna say, \"remember to add this to the hashCode()/equals()/toString()!\" But it looks like we don't even have those in this class. Which, given how prominent it is in the API signatures, is bad news.", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r428983679", "createdAt": "2020-05-22T00:29:35Z", "author": {"login": "jamesonwilliams"}, "path": "core/src/main/java/com/amplifyframework/api/graphql/GraphQLRequest.java", "diffHunk": "@@ -69,6 +71,22 @@ public GraphQLRequest(\n         this.variablesSerializer = variablesSerializer;\n     }\n \n+    /**\n+     * Returns the query document string.\n+     * @return the query document string\n+     */\n+    public String getDocument() {\n+        return document;\n+    }\n+\n+    /**\n+     * Returns the immutable map of request variables.\n+     * @return the map of variables\n+     */\n+    public Map<String, Object> getVariables() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTEwMDU0NA==", "bodyText": "I removed getVariables and getDocument again after I realized that it isn't needed anymore. but I agree it still needs those methods you brought up.", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r429100544", "createdAt": "2020-05-22T08:00:31Z", "author": {"login": "raphkim"}, "path": "core/src/main/java/com/amplifyframework/api/graphql/GraphQLRequest.java", "diffHunk": "@@ -69,6 +71,22 @@ public GraphQLRequest(\n         this.variablesSerializer = variablesSerializer;\n     }\n \n+    /**\n+     * Returns the query document string.\n+     * @return the query document string\n+     */\n+    public String getDocument() {\n+        return document;\n+    }\n+\n+    /**\n+     * Returns the immutable map of request variables.\n+     * @return the map of variables\n+     */\n+    public Map<String, Object> getVariables() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4MzY3OQ=="}, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTY5ODYxOnYy", "diffSide": "RIGHT", "path": "aws-api/src/test/java/com/amplifyframework/api/aws/SubscriptionAuthorizerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDozNTowOFrOGZHKzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwODowMTo0OVrOGZOQKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NTAzOA==", "bodyText": "I've never liked this ApiAuthProviders thing, it has poor encapsulation, and muddles together several different technologies without a consistent behavioral contract.", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r428985038", "createdAt": "2020-05-22T00:35:08Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/SubscriptionAuthorizerTest.java", "diffHunk": "@@ -0,0 +1,157 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.testutils.random.RandomString;\n+\n+import com.amazonaws.auth.AWSCredentials;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.auth.BasicAWSCredentials;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.robolectric.RobolectricTestRunner;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+/**\n+ * Test that Subscription authorizer can correctly generate appropriate\n+ * headers for different types of authentication methods.\n+ */\n+@RunWith(RobolectricTestRunner.class)\n+public final class SubscriptionAuthorizerTest {\n+    private String authenticationSecret;\n+    private ApiAuthProviders apiAuthProviders;\n+\n+    /**\n+     * Construct fake auth providers to override default behaviors for\n+     * subscription authorizer.\n+     */\n+    @Before\n+    public void setup() {\n+        authenticationSecret = RandomString.string();\n+        apiAuthProviders = ApiAuthProviders.builder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTEwMTA5OQ==", "bodyText": "Yea it was a poor implementation on my part back when I was working on it for mutate/query, but it's a legacy that should stay for until after GA...", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r429101099", "createdAt": "2020-05-22T08:01:49Z", "author": {"login": "raphkim"}, "path": "aws-api/src/test/java/com/amplifyframework/api/aws/SubscriptionAuthorizerTest.java", "diffHunk": "@@ -0,0 +1,157 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.testutils.random.RandomString;\n+\n+import com.amazonaws.auth.AWSCredentials;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.auth.BasicAWSCredentials;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.robolectric.RobolectricTestRunner;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+/**\n+ * Test that Subscription authorizer can correctly generate appropriate\n+ * headers for different types of authentication methods.\n+ */\n+@RunWith(RobolectricTestRunner.class)\n+public final class SubscriptionAuthorizerTest {\n+    private String authenticationSecret;\n+    private ApiAuthProviders apiAuthProviders;\n+\n+    /**\n+     * Construct fake auth providers to override default behaviors for\n+     * subscription authorizer.\n+     */\n+    @Before\n+    public void setup() {\n+        authenticationSecret = RandomString.string();\n+        apiAuthProviders = ApiAuthProviders.builder()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NTAzOA=="}, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTcwNTc3OnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDozOToyOVrOGZHO5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDoyNjowOFrOGZZGwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NjA4NQ==", "bodyText": "Use the REPORT_TO_AWS-or-whatever one that @drochetti added", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r428986085", "createdAt": "2020-05-22T00:39:29Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import android.net.Uri;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.ApiKeyAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.AppSyncV4Signer;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.DefaultCognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.OidcAuthProvider;\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+\n+import com.amazonaws.DefaultRequest;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.http.HttpMethodName;\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.io.ByteArrayInputStream;\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.Map;\n+\n+final class SubscriptionAuthorizer {\n+    private final ApiConfiguration configuration;\n+    private final ApiAuthProviders authProviders;\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration) {\n+        this(configuration, ApiAuthProviders.noProviderOverrides());\n+    }\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration, ApiAuthProviders authProviders) {\n+        this.configuration = configuration;\n+        this.authProviders = authProviders;\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for subscription registration.\n+     */\n+    JSONObject createHeadersForSubscription(GraphQLRequest<?> request) throws ApiException {\n+        return createHeaders(request, false);\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for establishing connection.\n+     */\n+    JSONObject createHeadersForConnection() throws ApiException {\n+        return createHeaders(null, true);\n+    }\n+\n+    private JSONObject createHeaders(GraphQLRequest<?> request, boolean connectionFlag) throws ApiException {\n+        switch (configuration.getAuthorizationType()) {\n+            case API_KEY:\n+                ApiKeyAuthProvider keyProvider = authProviders.getApiKeyAuthProvider();\n+                if (keyProvider == null) {\n+                    keyProvider = configuration::getApiKey;\n+                }\n+                return forApiKey(keyProvider);\n+            case AWS_IAM:\n+                AWSCredentialsProvider credentialsProvider = authProviders.getAWSCredentialsProvider();\n+                if (credentialsProvider == null) {\n+                    credentialsProvider = AWSMobileClient.getInstance();\n+                }\n+                return forIam(credentialsProvider, request, connectionFlag);\n+            case AMAZON_COGNITO_USER_POOLS:\n+                CognitoUserPoolsAuthProvider cognitoProvider = authProviders.getCognitoUserPoolsAuthProvider();\n+                if (cognitoProvider == null) {\n+                    cognitoProvider = new DefaultCognitoUserPoolsAuthProvider();\n+                }\n+                return forCognitoUserPools(cognitoProvider);\n+            case OPENID_CONNECT:\n+                OidcAuthProvider oidcProvider = authProviders.getOidcAuthProvider();\n+                if (oidcProvider == null) {\n+                    oidcProvider = () -> {\n+                        throw new ApiException(\n+                                \"OidcAuthProvider interface is not implemented.\",\n+                                AmplifyException.TODO_RECOVERY_SUGGESTION\n+                        );\n+                    };\n+                }\n+                return forOidc(oidcProvider);\n+            case NONE:\n+            default:\n+                return new JSONObject();\n+        }\n+    }\n+\n+    private JSONObject forApiKey(ApiKeyAuthProvider keyProvider) throws ApiException {\n+        final String apiKey = keyProvider.getAPIKey();\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"x-amz-date\", Iso8601Timestamp.now())\n+                    .put(\"x-api-key\", apiKey);\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Api key. \",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forCognitoUserPools(CognitoUserPoolsAuthProvider cognitoProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", cognitoProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Cognito User Pools.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forOidc(OidcAuthProvider oidcProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", oidcProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Open ID Connect.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forIam(\n+            AWSCredentialsProvider credentialsProvider,\n+            GraphQLRequest<?> request,\n+            boolean connectionFlag\n+    ) throws ApiException {\n+        final URI apiUrl = getRequestEndpoint(connectionFlag);\n+        final String apiRegion = apiUrl.getAuthority().split(\"\\\\.\")[2];\n+        final String requestContent = getRequestContent(request, connectionFlag);\n+\n+        // Construct a request to be signed\n+        DefaultRequest<?> canonicalRequest = new DefaultRequest<>(\"appsync\");\n+        canonicalRequest.addHeader(\"accept\", \"application/json, text/javascript\");\n+        canonicalRequest.addHeader(\"content-encoding\", \"amz-1.0\");\n+        canonicalRequest.addHeader(\"content-type\", \"application/json; charset=UTF-8\");\n+        canonicalRequest.setHttpMethod(HttpMethodName.valueOf(\"POST\"));\n+        canonicalRequest.setEndpoint(apiUrl);\n+        canonicalRequest.setContent(new ByteArrayInputStream(requestContent.getBytes()));\n+\n+        // Sign with AppSync's SigV4 signer that also considers connection resource path\n+        new AppSyncV4Signer(apiRegion, connectionFlag).sign(\n+                canonicalRequest,\n+                credentialsProvider.getCredentials()\n+        );\n+\n+        // Extract header from signed request and return\n+        Map<String, String> signedHeaders = canonicalRequest.getHeaders();\n+        JSONObject authorization = new JSONObject();\n+        try {\n+            for (Map.Entry<String, String> headerEntry : signedHeaders.entrySet()) {\n+                authorization.put(headerEntry.getKey(), headerEntry.getValue());\n+            }\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for AWS IAM.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+        return authorization;\n+    }\n+\n+    private String getHost() {\n+        return Uri.parse(configuration.getEndpoint()).getHost();\n+    }\n+\n+    private URI getRequestEndpoint(boolean connectionFlag) throws ApiException {\n+        try {\n+            String baseUrl = configuration.getEndpoint();\n+            String connectionUrl = connectionFlag ? baseUrl + \"/connect\" : baseUrl;\n+            return new URI(connectionUrl);\n+        } catch (URISyntaxException uriException) {\n+            throw new ApiException(\n+                    \"Error constructing canonical URI for IAM request signature\",\n+                    uriException, AmplifyException.TODO_RECOVERY_SUGGESTION", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 198}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI3ODkxNA==", "bodyText": "Didn't know we had that! I'll change it, and add appropriate recovery suggestion everywhere else.", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r429278914", "createdAt": "2020-05-22T14:26:08Z", "author": {"login": "raphkim"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import android.net.Uri;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.ApiKeyAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.AppSyncV4Signer;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.DefaultCognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.OidcAuthProvider;\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+\n+import com.amazonaws.DefaultRequest;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.http.HttpMethodName;\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.io.ByteArrayInputStream;\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.Map;\n+\n+final class SubscriptionAuthorizer {\n+    private final ApiConfiguration configuration;\n+    private final ApiAuthProviders authProviders;\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration) {\n+        this(configuration, ApiAuthProviders.noProviderOverrides());\n+    }\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration, ApiAuthProviders authProviders) {\n+        this.configuration = configuration;\n+        this.authProviders = authProviders;\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for subscription registration.\n+     */\n+    JSONObject createHeadersForSubscription(GraphQLRequest<?> request) throws ApiException {\n+        return createHeaders(request, false);\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for establishing connection.\n+     */\n+    JSONObject createHeadersForConnection() throws ApiException {\n+        return createHeaders(null, true);\n+    }\n+\n+    private JSONObject createHeaders(GraphQLRequest<?> request, boolean connectionFlag) throws ApiException {\n+        switch (configuration.getAuthorizationType()) {\n+            case API_KEY:\n+                ApiKeyAuthProvider keyProvider = authProviders.getApiKeyAuthProvider();\n+                if (keyProvider == null) {\n+                    keyProvider = configuration::getApiKey;\n+                }\n+                return forApiKey(keyProvider);\n+            case AWS_IAM:\n+                AWSCredentialsProvider credentialsProvider = authProviders.getAWSCredentialsProvider();\n+                if (credentialsProvider == null) {\n+                    credentialsProvider = AWSMobileClient.getInstance();\n+                }\n+                return forIam(credentialsProvider, request, connectionFlag);\n+            case AMAZON_COGNITO_USER_POOLS:\n+                CognitoUserPoolsAuthProvider cognitoProvider = authProviders.getCognitoUserPoolsAuthProvider();\n+                if (cognitoProvider == null) {\n+                    cognitoProvider = new DefaultCognitoUserPoolsAuthProvider();\n+                }\n+                return forCognitoUserPools(cognitoProvider);\n+            case OPENID_CONNECT:\n+                OidcAuthProvider oidcProvider = authProviders.getOidcAuthProvider();\n+                if (oidcProvider == null) {\n+                    oidcProvider = () -> {\n+                        throw new ApiException(\n+                                \"OidcAuthProvider interface is not implemented.\",\n+                                AmplifyException.TODO_RECOVERY_SUGGESTION\n+                        );\n+                    };\n+                }\n+                return forOidc(oidcProvider);\n+            case NONE:\n+            default:\n+                return new JSONObject();\n+        }\n+    }\n+\n+    private JSONObject forApiKey(ApiKeyAuthProvider keyProvider) throws ApiException {\n+        final String apiKey = keyProvider.getAPIKey();\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"x-amz-date\", Iso8601Timestamp.now())\n+                    .put(\"x-api-key\", apiKey);\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Api key. \",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forCognitoUserPools(CognitoUserPoolsAuthProvider cognitoProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", cognitoProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Cognito User Pools.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forOidc(OidcAuthProvider oidcProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", oidcProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Open ID Connect.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forIam(\n+            AWSCredentialsProvider credentialsProvider,\n+            GraphQLRequest<?> request,\n+            boolean connectionFlag\n+    ) throws ApiException {\n+        final URI apiUrl = getRequestEndpoint(connectionFlag);\n+        final String apiRegion = apiUrl.getAuthority().split(\"\\\\.\")[2];\n+        final String requestContent = getRequestContent(request, connectionFlag);\n+\n+        // Construct a request to be signed\n+        DefaultRequest<?> canonicalRequest = new DefaultRequest<>(\"appsync\");\n+        canonicalRequest.addHeader(\"accept\", \"application/json, text/javascript\");\n+        canonicalRequest.addHeader(\"content-encoding\", \"amz-1.0\");\n+        canonicalRequest.addHeader(\"content-type\", \"application/json; charset=UTF-8\");\n+        canonicalRequest.setHttpMethod(HttpMethodName.valueOf(\"POST\"));\n+        canonicalRequest.setEndpoint(apiUrl);\n+        canonicalRequest.setContent(new ByteArrayInputStream(requestContent.getBytes()));\n+\n+        // Sign with AppSync's SigV4 signer that also considers connection resource path\n+        new AppSyncV4Signer(apiRegion, connectionFlag).sign(\n+                canonicalRequest,\n+                credentialsProvider.getCredentials()\n+        );\n+\n+        // Extract header from signed request and return\n+        Map<String, String> signedHeaders = canonicalRequest.getHeaders();\n+        JSONObject authorization = new JSONObject();\n+        try {\n+            for (Map.Entry<String, String> headerEntry : signedHeaders.entrySet()) {\n+                authorization.put(headerEntry.getKey(), headerEntry.getValue());\n+            }\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for AWS IAM.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+        return authorization;\n+    }\n+\n+    private String getHost() {\n+        return Uri.parse(configuration.getEndpoint()).getHost();\n+    }\n+\n+    private URI getRequestEndpoint(boolean connectionFlag) throws ApiException {\n+        try {\n+            String baseUrl = configuration.getEndpoint();\n+            String connectionUrl = connectionFlag ? baseUrl + \"/connect\" : baseUrl;\n+            return new URI(connectionUrl);\n+        } catch (URISyntaxException uriException) {\n+            throw new ApiException(\n+                    \"Error constructing canonical URI for IAM request signature\",\n+                    uriException, AmplifyException.TODO_RECOVERY_SUGGESTION", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NjA4NQ=="}, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 198}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTcwNjcxOnYy", "diffSide": "RIGHT", "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDo0MDowNFrOGZHPfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDoyNTo0MlrOGZZFtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NjIzNg==", "bodyText": "Just, authorization.putAll(signedHeaders()))?", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r428986236", "createdAt": "2020-05-22T00:40:04Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import android.net.Uri;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.ApiKeyAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.AppSyncV4Signer;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.DefaultCognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.OidcAuthProvider;\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+\n+import com.amazonaws.DefaultRequest;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.http.HttpMethodName;\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.io.ByteArrayInputStream;\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.Map;\n+\n+final class SubscriptionAuthorizer {\n+    private final ApiConfiguration configuration;\n+    private final ApiAuthProviders authProviders;\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration) {\n+        this(configuration, ApiAuthProviders.noProviderOverrides());\n+    }\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration, ApiAuthProviders authProviders) {\n+        this.configuration = configuration;\n+        this.authProviders = authProviders;\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for subscription registration.\n+     */\n+    JSONObject createHeadersForSubscription(GraphQLRequest<?> request) throws ApiException {\n+        return createHeaders(request, false);\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for establishing connection.\n+     */\n+    JSONObject createHeadersForConnection() throws ApiException {\n+        return createHeaders(null, true);\n+    }\n+\n+    private JSONObject createHeaders(GraphQLRequest<?> request, boolean connectionFlag) throws ApiException {\n+        switch (configuration.getAuthorizationType()) {\n+            case API_KEY:\n+                ApiKeyAuthProvider keyProvider = authProviders.getApiKeyAuthProvider();\n+                if (keyProvider == null) {\n+                    keyProvider = configuration::getApiKey;\n+                }\n+                return forApiKey(keyProvider);\n+            case AWS_IAM:\n+                AWSCredentialsProvider credentialsProvider = authProviders.getAWSCredentialsProvider();\n+                if (credentialsProvider == null) {\n+                    credentialsProvider = AWSMobileClient.getInstance();\n+                }\n+                return forIam(credentialsProvider, request, connectionFlag);\n+            case AMAZON_COGNITO_USER_POOLS:\n+                CognitoUserPoolsAuthProvider cognitoProvider = authProviders.getCognitoUserPoolsAuthProvider();\n+                if (cognitoProvider == null) {\n+                    cognitoProvider = new DefaultCognitoUserPoolsAuthProvider();\n+                }\n+                return forCognitoUserPools(cognitoProvider);\n+            case OPENID_CONNECT:\n+                OidcAuthProvider oidcProvider = authProviders.getOidcAuthProvider();\n+                if (oidcProvider == null) {\n+                    oidcProvider = () -> {\n+                        throw new ApiException(\n+                                \"OidcAuthProvider interface is not implemented.\",\n+                                AmplifyException.TODO_RECOVERY_SUGGESTION\n+                        );\n+                    };\n+                }\n+                return forOidc(oidcProvider);\n+            case NONE:\n+            default:\n+                return new JSONObject();\n+        }\n+    }\n+\n+    private JSONObject forApiKey(ApiKeyAuthProvider keyProvider) throws ApiException {\n+        final String apiKey = keyProvider.getAPIKey();\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"x-amz-date\", Iso8601Timestamp.now())\n+                    .put(\"x-api-key\", apiKey);\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Api key. \",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forCognitoUserPools(CognitoUserPoolsAuthProvider cognitoProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", cognitoProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Cognito User Pools.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forOidc(OidcAuthProvider oidcProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", oidcProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Open ID Connect.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forIam(\n+            AWSCredentialsProvider credentialsProvider,\n+            GraphQLRequest<?> request,\n+            boolean connectionFlag\n+    ) throws ApiException {\n+        final URI apiUrl = getRequestEndpoint(connectionFlag);\n+        final String apiRegion = apiUrl.getAuthority().split(\"\\\\.\")[2];\n+        final String requestContent = getRequestContent(request, connectionFlag);\n+\n+        // Construct a request to be signed\n+        DefaultRequest<?> canonicalRequest = new DefaultRequest<>(\"appsync\");\n+        canonicalRequest.addHeader(\"accept\", \"application/json, text/javascript\");\n+        canonicalRequest.addHeader(\"content-encoding\", \"amz-1.0\");\n+        canonicalRequest.addHeader(\"content-type\", \"application/json; charset=UTF-8\");\n+        canonicalRequest.setHttpMethod(HttpMethodName.valueOf(\"POST\"));\n+        canonicalRequest.setEndpoint(apiUrl);\n+        canonicalRequest.setContent(new ByteArrayInputStream(requestContent.getBytes()));\n+\n+        // Sign with AppSync's SigV4 signer that also considers connection resource path\n+        new AppSyncV4Signer(apiRegion, connectionFlag).sign(\n+                canonicalRequest,\n+                credentialsProvider.getCredentials()\n+        );\n+\n+        // Extract header from signed request and return\n+        Map<String, String> signedHeaders = canonicalRequest.getHeaders();\n+        JSONObject authorization = new JSONObject();\n+        try {\n+            for (Map.Entry<String, String> headerEntry : signedHeaders.entrySet()) {\n+                authorization.put(headerEntry.getKey(), headerEntry.getValue());\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 176}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI3ODY0Nw==", "bodyText": "JSONObject doesn't have putAll() method, but I realized that I can just directly construct one with a map, so I'll change it.", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r429278647", "createdAt": "2020-05-22T14:25:42Z", "author": {"login": "raphkim"}, "path": "aws-api/src/main/java/com/amplifyframework/api/aws/SubscriptionAuthorizer.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.api.aws;\n+\n+import android.net.Uri;\n+\n+import com.amplifyframework.AmplifyException;\n+import com.amplifyframework.api.ApiException;\n+import com.amplifyframework.api.aws.sigv4.ApiKeyAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.AppSyncV4Signer;\n+import com.amplifyframework.api.aws.sigv4.CognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.DefaultCognitoUserPoolsAuthProvider;\n+import com.amplifyframework.api.aws.sigv4.OidcAuthProvider;\n+import com.amplifyframework.api.graphql.GraphQLRequest;\n+\n+import com.amazonaws.DefaultRequest;\n+import com.amazonaws.auth.AWSCredentialsProvider;\n+import com.amazonaws.http.HttpMethodName;\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+import java.io.ByteArrayInputStream;\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.Map;\n+\n+final class SubscriptionAuthorizer {\n+    private final ApiConfiguration configuration;\n+    private final ApiAuthProviders authProviders;\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration) {\n+        this(configuration, ApiAuthProviders.noProviderOverrides());\n+    }\n+\n+    SubscriptionAuthorizer(ApiConfiguration configuration, ApiAuthProviders authProviders) {\n+        this.configuration = configuration;\n+        this.authProviders = authProviders;\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for subscription registration.\n+     */\n+    JSONObject createHeadersForSubscription(GraphQLRequest<?> request) throws ApiException {\n+        return createHeaders(request, false);\n+    }\n+\n+    /**\n+     * Return authorization json to be used explicitly for establishing connection.\n+     */\n+    JSONObject createHeadersForConnection() throws ApiException {\n+        return createHeaders(null, true);\n+    }\n+\n+    private JSONObject createHeaders(GraphQLRequest<?> request, boolean connectionFlag) throws ApiException {\n+        switch (configuration.getAuthorizationType()) {\n+            case API_KEY:\n+                ApiKeyAuthProvider keyProvider = authProviders.getApiKeyAuthProvider();\n+                if (keyProvider == null) {\n+                    keyProvider = configuration::getApiKey;\n+                }\n+                return forApiKey(keyProvider);\n+            case AWS_IAM:\n+                AWSCredentialsProvider credentialsProvider = authProviders.getAWSCredentialsProvider();\n+                if (credentialsProvider == null) {\n+                    credentialsProvider = AWSMobileClient.getInstance();\n+                }\n+                return forIam(credentialsProvider, request, connectionFlag);\n+            case AMAZON_COGNITO_USER_POOLS:\n+                CognitoUserPoolsAuthProvider cognitoProvider = authProviders.getCognitoUserPoolsAuthProvider();\n+                if (cognitoProvider == null) {\n+                    cognitoProvider = new DefaultCognitoUserPoolsAuthProvider();\n+                }\n+                return forCognitoUserPools(cognitoProvider);\n+            case OPENID_CONNECT:\n+                OidcAuthProvider oidcProvider = authProviders.getOidcAuthProvider();\n+                if (oidcProvider == null) {\n+                    oidcProvider = () -> {\n+                        throw new ApiException(\n+                                \"OidcAuthProvider interface is not implemented.\",\n+                                AmplifyException.TODO_RECOVERY_SUGGESTION\n+                        );\n+                    };\n+                }\n+                return forOidc(oidcProvider);\n+            case NONE:\n+            default:\n+                return new JSONObject();\n+        }\n+    }\n+\n+    private JSONObject forApiKey(ApiKeyAuthProvider keyProvider) throws ApiException {\n+        final String apiKey = keyProvider.getAPIKey();\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"x-amz-date\", Iso8601Timestamp.now())\n+                    .put(\"x-api-key\", apiKey);\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Api key. \",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forCognitoUserPools(CognitoUserPoolsAuthProvider cognitoProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", cognitoProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Cognito User Pools.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forOidc(OidcAuthProvider oidcProvider) throws ApiException {\n+        try {\n+            return new JSONObject()\n+                    .put(\"host\", getHost())\n+                    .put(\"Authorization\", oidcProvider.getLatestAuthToken());\n+        } catch (JSONException jsonException) {\n+            throw new ApiException(\n+                    \"Error constructing the authorization json for Open ID Connect.\",\n+                    jsonException, AmplifyException.TODO_RECOVERY_SUGGESTION\n+            );\n+        }\n+    }\n+\n+    private JSONObject forIam(\n+            AWSCredentialsProvider credentialsProvider,\n+            GraphQLRequest<?> request,\n+            boolean connectionFlag\n+    ) throws ApiException {\n+        final URI apiUrl = getRequestEndpoint(connectionFlag);\n+        final String apiRegion = apiUrl.getAuthority().split(\"\\\\.\")[2];\n+        final String requestContent = getRequestContent(request, connectionFlag);\n+\n+        // Construct a request to be signed\n+        DefaultRequest<?> canonicalRequest = new DefaultRequest<>(\"appsync\");\n+        canonicalRequest.addHeader(\"accept\", \"application/json, text/javascript\");\n+        canonicalRequest.addHeader(\"content-encoding\", \"amz-1.0\");\n+        canonicalRequest.addHeader(\"content-type\", \"application/json; charset=UTF-8\");\n+        canonicalRequest.setHttpMethod(HttpMethodName.valueOf(\"POST\"));\n+        canonicalRequest.setEndpoint(apiUrl);\n+        canonicalRequest.setContent(new ByteArrayInputStream(requestContent.getBytes()));\n+\n+        // Sign with AppSync's SigV4 signer that also considers connection resource path\n+        new AppSyncV4Signer(apiRegion, connectionFlag).sign(\n+                canonicalRequest,\n+                credentialsProvider.getCredentials()\n+        );\n+\n+        // Extract header from signed request and return\n+        Map<String, String> signedHeaders = canonicalRequest.getHeaders();\n+        JSONObject authorization = new JSONObject();\n+        try {\n+            for (Map.Entry<String, String> headerEntry : signedHeaders.entrySet()) {\n+                authorization.put(headerEntry.getKey(), headerEntry.getValue());\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NjIzNg=="}, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 176}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTcxMzI5OnYy", "diffSide": "RIGHT", "path": "aws-api/src/androidTest/java/com/amplifyframework/api/aws/SubscriptionWithAwsIamTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwMDo0NDowNVrOGZHTWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDoyNTowN1rOGZZERw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NzIyNA==", "bodyText": "How can you move this to src/test?", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r428987224", "createdAt": "2020-05-22T00:44:05Z", "author": {"login": "jamesonwilliams"}, "path": "aws-api/src/androidTest/java/com/amplifyframework/api/aws/SubscriptionWithAwsIamTest.java", "diffHunk": "@@ -0,0 +1,232 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI3ODI3OQ==", "bodyText": "This test was removed for now", "url": "https://github.com/aws-amplify/amplify-android/pull/502#discussion_r429278279", "createdAt": "2020-05-22T14:25:07Z", "author": {"login": "raphkim"}, "path": "aws-api/src/androidTest/java/com/amplifyframework/api/aws/SubscriptionWithAwsIamTest.java", "diffHunk": "@@ -0,0 +1,232 @@\n+/*", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk4NzIyNA=="}, "originalCommit": {"oid": "41ab19b3069c5696bb6cc0819bcfcdccc46feaa6"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1293, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}