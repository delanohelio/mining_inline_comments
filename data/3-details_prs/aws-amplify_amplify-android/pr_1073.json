{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NDk3MjQz", "number": 1073, "title": "chore: add explicit error for signin cancelation", "bodyText": "During sign-in with the Cognito hosted web UI, a Chrome Custom tab will\npop up. The user may fill in their sign-in information. However, they\nmay also exit out of the tab, in which case the sign-in will be\ncancelled.\nThe current behavior is to fire an exception on the onError callback\nwhen this occurs. That exception looks like this:\nAuthException{\n  message=Sign in with web UI failed\n  cause=[...mobile client...] AuthNavigationException{\n    message=user cancelled\n  }\n  recoverySuggestion=See attached exception for more details\n}\n\nThis commit updates the exception that gets returned, to something more\nspecific, that a user could catch explicitly:\nActionCancelledException{\n  message=The user cancelled the sign-in attempt, so it did not complete.\n  cause=[...mobile client...] AuthNavigationException {\n    message=user cancelled\n  }\n  recoverySuggestion=To recover: catch this error, and show the sign-in screen again.\n}\n\nWith this change, the caller may catch the cancellation exception in a\nwhen block:\nAmplify.Auth.signInWithWebUI(this, { /* result .. */ }, { error ->\n    when (error) {\n        is ActionCancelledException -> Log.w(\"TAG\", \"sign-in cancelled\")\n        else ->  Log.e(\"xx\", \"Login failed.\", error)\n    }\n}\nThis commit also applies similar updates to the sign-out method.\nRelated: aws-amplify/amplify-ios#982\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-12-25T02:24:51Z", "url": "https://github.com/aws-amplify/amplify-android/pull/1073", "merged": true, "mergeCommit": {"oid": "08ce7f581ee68deabd094d2aadb314b26d4df2ca"}, "closed": true, "closedAt": "2021-01-05T05:38:03Z", "author": {"login": "jamesonwilliams"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdq8W9PAFqTU1OTU3ODg3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdrRWIIAFqTU2MDEwMTE3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NTc4ODc1", "url": "https://github.com/aws-amplify/amplify-android/pull/1073#pullrequestreview-559578875", "createdAt": "2020-12-29T15:21:25Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNToyMToyNVrOIMRqrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNToyMToyNVrOIMRqrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc0MzI3OQ==", "bodyText": "Maybe call this UserCancelledException instead?  That seems a little more clear to me, and also matches iOS.", "url": "https://github.com/aws-amplify/amplify-android/pull/1073#discussion_r549743279", "createdAt": "2020-12-29T15:21:25Z", "author": {"login": "richardmcclellan"}, "path": "core/src/main/java/com/amplifyframework/auth/AuthException.java", "diffHunk": "@@ -449,6 +449,23 @@ public FailedAttemptsLimitExceededException(Throwable cause) {\n         }\n     }\n \n+    /**\n+     * Could not complete an action because it was cancelled by the user.\n+     */\n+    public static class ActionCancelledException extends AuthException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NTc5NTY1", "url": "https://github.com/aws-amplify/amplify-android/pull/1073#pullrequestreview-559579565", "createdAt": "2020-12-29T15:22:57Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f2626b99eb4fc78bd2280321fe5d5ee2914a6b7", "author": {"user": {"login": "jamesonwilliams", "name": "Jameson Williams"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/4f2626b99eb4fc78bd2280321fe5d5ee2914a6b7", "committedDate": "2020-12-30T15:43:48Z", "message": "chore: add explict error for signin cancelation\n\nDuring sign-in with the Cognito hosted web UI, a Chrome Custom tab will\npop up. The user may fill in their sign-in information. However, they\nmay also exit out of the tab, in which case the sign-in will be\ncancelled.\n\nThe current behavior is to fire an exception on the onError callback\nwhen this occurs. That exception looks like this:\n```\nAuthException{\n  message=Sign in with web UI failed\n  cause=[...mobile client...] AuthNavigationException{\n    message=user cancelled\n  }\n  recoverySuggestion=See attached exception for more details\n}\n```\n\nThis commit updates the exception that gets returned, to something more\nspecific, that a user could catch explicitly:\n```\nActionCancelledException{\n  message=The user cancelled the sign-in attempt, so it did not complete.\n  cause=[...mobile client...] AuthNavigationException {\n    message=user cancelled\n  }\n  recoverySuggestion=To recover: catch this error, and show the sign-in screen again.\n}\n```\n\nWith this change, the caller may catch the cancellation exception in a\n`when` block:\n```kotlin\nAmplify.Auth.signInWithWebUI(this, { /* result .. */ }, { error ->\n    when (error) {\n        is ActionCancelledException -> Log.w(\"TAG\", \"sign-in cancelled\")\n        else ->  Log.e(\"xx\", \"Login failed.\", error)\n    }\n}\n```\n\nThis commit also applies similar updates to the sign-out method.\n\nRelated: https://github.com/aws-amplify/amplify-ios/pull/982"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7af13137800988846918a934be3f7be5a6ad0b98", "author": {"user": {"login": "jamesonwilliams", "name": "Jameson Williams"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7af13137800988846918a934be3f7be5a6ad0b98", "committedDate": "2020-12-30T15:45:49Z", "message": "Rename exception to UserCancelledException, as suggested by Richard M"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "7af13137800988846918a934be3f7be5a6ad0b98", "author": {"user": {"login": "jamesonwilliams", "name": "Jameson Williams"}}, "url": "https://github.com/aws-amplify/amplify-android/commit/7af13137800988846918a934be3f7be5a6ad0b98", "committedDate": "2020-12-30T15:45:49Z", "message": "Rename exception to UserCancelledException, as suggested by Richard M"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMTAxMTcx", "url": "https://github.com/aws-amplify/amplify-android/pull/1073#pullrequestreview-560101171", "createdAt": "2020-12-30T15:48:32Z", "commit": {"oid": "7af13137800988846918a934be3f7be5a6ad0b98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3394, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}