{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzQ5ODQ3", "number": 3984, "title": "chore(broker): expose health metrics of partition", "bodyText": "Description\nAdd health metrics for a partition\nRelated issue\ncloses #3834\nPull Request Checklist\n\n All commit messages match our commit message guidelines\n The submitting code follows our code style\n If submitting code, please run mvn clean install -DskipTests locally before committing", "createdAt": "2020-03-04T18:00:50Z", "url": "https://github.com/camunda-cloud/zeebe/pull/3984", "merged": true, "mergeCommit": {"oid": "e0845ac9c34924b1d516e5f5d83acbe8982113bf"}, "closed": true, "closedAt": "2020-03-09T08:50:12Z", "author": {"login": "deepthidevaki"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKdb09AFqTM2OTExOTQ4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcL5lr2ABqjMxMDk1ODE0NDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MTE5NDg3", "url": "https://github.com/camunda-cloud/zeebe/pull/3984#pullrequestreview-369119487", "createdAt": "2020-03-04T21:01:57Z", "commit": {"oid": "26412730e86cbe791f3c86b95d2933ffb6b1a7df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMTowMTo1N1rOFx9fig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMTowMTo1N1rOFx9fig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkzMjA0Mg==", "bodyText": "Can this call fail? E.g. Exception?", "url": "https://github.com/camunda-cloud/zeebe/pull/3984#discussion_r387932042", "createdAt": "2020-03-04T21:01:57Z", "author": {"login": "Zelldon"}, "path": "broker/src/main/java/io/zeebe/broker/system/partitions/ZeebePartition.java", "diffHunk": "@@ -601,18 +605,22 @@ public void onRecovered() {\n   private void updateHealthStatus(final HealthStatus newStatus) {\n     if (healthStatus != newStatus) {\n       healthStatus = newStatus;\n-      if (failureListener != null) {\n-        switch (newStatus) {\n-          case HEALTHY:\n+      switch (newStatus) {\n+        case HEALTHY:\n+          healthMetrics.setHealthy();\n+          if (failureListener != null) {\n             failureListener.onRecovered();\n-            break;\n-          case UNHEALTHY:\n+          }\n+          break;\n+        case UNHEALTHY:\n+          healthMetrics.setUnhealthy();\n+          if (failureListener != null) {\n             failureListener.onFailure();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26412730e86cbe791f3c86b95d2933ffb6b1a7df"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwOTc3OTg5", "url": "https://github.com/camunda-cloud/zeebe/pull/3984#pullrequestreview-370977989", "createdAt": "2020-03-09T08:21:33Z", "commit": {"oid": "26412730e86cbe791f3c86b95d2933ffb6b1a7df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38a271fc111066b3a3f0c6e41225a8b3eb50f0ae", "author": {"user": {"login": "deepthidevaki", "name": "Deepthi Devaki Akkoorath"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/38a271fc111066b3a3f0c6e41225a8b3eb50f0ae", "committedDate": "2020-03-09T08:24:18Z", "message": "chore(broker): expose health metrics of partition"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26412730e86cbe791f3c86b95d2933ffb6b1a7df", "author": {"user": {"login": "deepthidevaki", "name": "Deepthi Devaki Akkoorath"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/26412730e86cbe791f3c86b95d2933ffb6b1a7df", "committedDate": "2020-03-03T14:55:53Z", "message": "chore(broker): expose health metrics of partition"}, "afterCommit": {"oid": "38a271fc111066b3a3f0c6e41225a8b3eb50f0ae", "author": {"user": {"login": "deepthidevaki", "name": "Deepthi Devaki Akkoorath"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/38a271fc111066b3a3f0c6e41225a8b3eb50f0ae", "committedDate": "2020-03-09T08:24:18Z", "message": "chore(broker): expose health metrics of partition"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3035, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}