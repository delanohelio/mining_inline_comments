{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODAyNzgw", "number": 4918, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMTo1ODo0MlrOENyUUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMTo1ODo0MlrOENyUUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyODkxMzQ2OnYy", "diffSide": "RIGHT", "path": "engine/src/main/java/io/zeebe/engine/nwe/behavior/BpmnStateBehavior.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMTo1ODo0MlrOGwlbbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxMjowMjoyNlrOGwli0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU5ODA2MA==", "bodyText": "Do we remove the variables from the event subprocess so the process that's inside it propagates its variables up when it's completed?", "url": "https://github.com/camunda-cloud/zeebe/pull/4918#discussion_r453598060", "createdAt": "2020-07-13T11:58:42Z", "author": {"login": "MiguelPires"}, "path": "engine/src/main/java/io/zeebe/engine/nwe/behavior/BpmnStateBehavior.java", "diffHunk": "@@ -225,4 +225,16 @@ public void propagateTemporaryVariables(\n         variablesState.getVariablesAsDocument(sourceContext.getElementInstanceKey());\n     variablesState.setTemporaryVariables(targetContext.getElementInstanceKey(), variables);\n   }\n+\n+  public void transferTemporaryVariables(\n+      final BpmnElementContext sourceContext, final long targetElementInstanceKey) {\n+\n+    final var variables =\n+        variablesState.getTemporaryVariables(sourceContext.getElementInstanceKey());\n+\n+    if (variables != null) {\n+      variablesState.setTemporaryVariables(targetElementInstanceKey, variables);\n+      variablesState.removeTemporaryVariables(sourceContext.getElementInstanceKey());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8caa703bab35a5f068e59c78722f9dd8d36e7ddb"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU5OTk1NA==", "bodyText": "Yes. The variables are removed from the event subprocess context because they're already merged when the start event is completed. This is also important to not use them again when the event subprocess is completed :)", "url": "https://github.com/camunda-cloud/zeebe/pull/4918#discussion_r453599954", "createdAt": "2020-07-13T12:02:26Z", "author": {"login": "saig0"}, "path": "engine/src/main/java/io/zeebe/engine/nwe/behavior/BpmnStateBehavior.java", "diffHunk": "@@ -225,4 +225,16 @@ public void propagateTemporaryVariables(\n         variablesState.getVariablesAsDocument(sourceContext.getElementInstanceKey());\n     variablesState.setTemporaryVariables(targetContext.getElementInstanceKey(), variables);\n   }\n+\n+  public void transferTemporaryVariables(\n+      final BpmnElementContext sourceContext, final long targetElementInstanceKey) {\n+\n+    final var variables =\n+        variablesState.getTemporaryVariables(sourceContext.getElementInstanceKey());\n+\n+    if (variables != null) {\n+      variablesState.setTemporaryVariables(targetElementInstanceKey, variables);\n+      variablesState.removeTemporaryVariables(sourceContext.getElementInstanceKey());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU5ODA2MA=="}, "originalCommit": {"oid": "8caa703bab35a5f068e59c78722f9dd8d36e7ddb"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 432, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}