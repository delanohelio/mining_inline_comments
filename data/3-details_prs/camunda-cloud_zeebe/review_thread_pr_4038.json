{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NjU2ODEw", "number": 4038, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzoyODo0OFrODoNxww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzoyODo0OFrODoNxww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDk1MzYzOnYy", "diffSide": "RIGHT", "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzoyODo0OVrOF2oTXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxMjozMTo1MVrOF4C1Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA==", "bodyText": "Wouldn't it be better if duration is serialized to readable format like \"30s\"?", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r392827740", "createdAt": "2020-03-16T07:28:49Z", "author": {"login": "deepthidevaki"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxNTM3MQ==", "bodyText": "To be honest, I am not sure. I did think about it. And I kinda weighed against it. I was very happy to find a standard implementation to serialize Durations and also other date and time formats. So I decided to use this standard implementation.\nIf I would write my own serializer, I would probably output in in ISO format (something like \"PT30S\"). I wouldn't output it as 30s, because this is very custom.\nOne insight I got from talking to Alistair of the cloud team is that hum readable has disadvantages when you want to parse such a configuration, or write such a configuration with a machine. In effect, they want to generate configurations through code. Now, I know this doesn't apply to this location very well. However, I try to strike a blance between human readable and machine readable/writable.\nHaving said all that: I can change it, if you want to. If it's just a mild preference on your part, I would probably leave it for a time being.", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r393615371", "createdAt": "2020-03-17T11:36:30Z", "author": {"login": "pihme"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA=="}, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTY2Nw==", "bodyText": "It is a mild preference from my side. As far as I understand this is only indented for humans to read. It is difficult for me to guess the timeout is in seconds by just reading the serialized config. We also have some other timeout config which are not duration but just long values representing milliseconds (we should probably make them consistent, out of scope for this pr). So it could be confusing.\nI saw that JavaTimeModule has a config to serialize duration into ISO format.", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r393635667", "createdAt": "2020-03-17T12:15:57Z", "author": {"login": "deepthidevaki"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA=="}, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjA4Nw==", "bodyText": "Good find. Changed the setting and it is now output as ISO format.", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r394222087", "createdAt": "2020-03-18T09:51:11Z", "author": {"login": "pihme"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA=="}, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjQ5Nw==", "bodyText": "If you want, you can look at the changes. Otherwise, I would merge it this evening.", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r394222497", "createdAt": "2020-03-18T09:51:53Z", "author": {"login": "pihme"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA=="}, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxMDkxOA==", "bodyText": "Thanks \ud83d\udc4d", "url": "https://github.com/camunda-cloud/zeebe/pull/4038#discussion_r394310918", "createdAt": "2020-03-18T12:31:51Z", "author": {"login": "deepthidevaki"}, "path": "util/src/test/java/io/zeebe/util/ObjectWriterFactoryTest.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH under\n+ * one or more contributor license agreements. See the NOTICE file distributed\n+ * with this work for additional information regarding copyright ownership.\n+ * Licensed under the Zeebe Community License 1.0. You may not use this file\n+ * except in compliance with the Zeebe Community License 1.0.\n+ */\n+package io.zeebe.util;\n+\n+import static io.zeebe.util.ObjectWriterFactory.getDefaultJsonObjectWriter;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.junit.Test;\n+import org.springframework.util.unit.DataSize;\n+\n+public class ObjectWriterFactoryTest {\n+\n+  @Test\n+  public void shouldReturnNonNullDefaultObjectWriter() {\n+    // when\n+    final ObjectWriter actual = getDefaultJsonObjectWriter();\n+\n+    // then\n+    assertThat(actual).isNotNull();\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterWithPrettyPrintingEnabled() {\n+    // given\n+    final Map<String, String> objectToSerialize = new HashMap<>();\n+    objectToSerialize.put(\"field1\", \"value1\");\n+    objectToSerialize.put(\"field2\", \"value2\");\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual)\n+        .withFailMessage(\"Should be pretty printed and therefore contain line breaks\")\n+        .contains(System.lineSeparator());\n+  }\n+\n+  @Test\n+  public void shouldReturnObjectWriterThatWritesDurationAsNumberInSeconds() {\n+    // given\n+    final Duration objectToSerialize = Duration.ofSeconds(30);\n+\n+    String actual;\n+    // when\n+    try {\n+      actual = getDefaultJsonObjectWriter().writeValueAsString(objectToSerialize);\n+    } catch (JsonProcessingException e) {\n+      fail(e.getMessage());\n+      actual = \"\";\n+    }\n+\n+    // then\n+    assertThat(actual).describedAs(\"Serialized form of Duration\").isEqualTo(\"30.000000000\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyNzc0MA=="}, "originalCommit": {"oid": "c00133e6b101a474b4ef369af0c27fef9daac677"}, "originalPosition": 70}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4907, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}