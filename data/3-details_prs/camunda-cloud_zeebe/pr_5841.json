{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwNTU0NTgz", "number": 5841, "title": "Move usage of maven plugins to profiles", "bodyText": "Description\nThis PR moves the usage of maven plugins to profiles. This way dependency management of plugins (like version management) can be handled by the pom directly.\nThis PR also disables the fmt-plugin on jdk 8 and lower, and updates the plugin to the latest version (2.10).\nRelated issues\ncloses #4833\nDefinition of Done\nNot all items need to be done depending on the issue and the pull request.\nCode changes:\n\n The changes are backwards compatibility with previous versions\n If it fixes a bug then PRs are created to backport the fix to the last two minor versions. You can trigger a backport by assigning labels (e.g. backport stable/0.25) to the PR, in case that fails you need to create backports manually.\n\nTesting:\n\n There are unit/integration tests that verify all acceptance criterias of the issue\n New tests are written to ensure backwards compatibility with further versions\n The behavior is tested manually\n The impact of the changes is verified by a benchmark\n\nDocumentation:\n\n The documentation is updated (e.g. BPMN reference, configuration, examples, get-started guides, etc.)\n New content is added to the release announcement", "createdAt": "2020-11-13T12:33:01Z", "url": "https://github.com/camunda-cloud/zeebe/pull/5841", "merged": true, "mergeCommit": {"oid": "9d6908bd6d9d89c60cb64b3ef11a99430b1dd672"}, "closed": true, "closedAt": "2020-11-16T15:31:19Z", "author": {"login": "korthout"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcER1ggH2gAyNTIwNTU0NTgzOmY0OWE4NjdhNDdmZGY3Zjk5ZmQwNmY3MjQ5NDk3OWY0MGI5ZWEwMzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddEpkmABqjQwMDAxNDI0MzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f49a867a47fdf7f99fd06f72494979f40b9ea031", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/f49a867a47fdf7f99fd06f72494979f40b9ea031", "committedDate": "2020-11-13T10:06:13Z", "message": "chore(mvn): move go-offline to profile\n\nVersion management of the maven-dependency-plugin should be handled in\nthe version management of our pom. Therefore, we should not explicitly\ncall the action from outside but use a profile. In the case of the\ngo-offline mojo, this profile actually already existed, but was not yet\nutilised to execute the plugin's mojo."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMDI0ODU2", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#pullrequestreview-530024856", "createdAt": "2020-11-13T12:34:28Z", "commit": {"oid": "3f79d2c80e16f030cb858eb618d02d6c0d2e97ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNDoyOFrOHyspPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNDoyOFrOHyspPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkyMjMwMg==", "bodyText": "This id is necessary to be able to refer to the same execution when disabling it on jdk 8 or lower.", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#discussion_r522922302", "createdAt": "2020-11-13T12:34:28Z", "author": {"login": "korthout"}, "path": "parent/pom.xml", "diffHunk": "@@ -1076,6 +1076,8 @@\n           <version>${plugin.version.fmt}</version>\n           <executions>\n             <execution>\n+              <id>format</id>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f79d2c80e16f030cb858eb618d02d6c0d2e97ee"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f79d2c80e16f030cb858eb618d02d6c0d2e97ee", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/3f79d2c80e16f030cb858eb618d02d6c0d2e97ee", "committedDate": "2020-11-13T12:29:23Z", "message": "chore(pom): update fmt-plugin to 2.10"}, "afterCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770", "committedDate": "2020-11-13T12:35:53Z", "message": "chore(pom): update fmt-plugin to 2.10"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMDI2MjM0", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#pullrequestreview-530026234", "createdAt": "2020-11-13T12:36:31Z", "commit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNjozMlrOHystPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNjozMlrOHystPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkyMzMyNw==", "bodyText": "This execution makes sure that we actually \"go-offline\" when the profile is activated", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#discussion_r522923327", "createdAt": "2020-11-13T12:36:32Z", "author": {"login": "korthout"}, "path": "parent/pom.xml", "diffHunk": "@@ -1428,6 +1430,13 @@\n             <groupId>org.apache.maven.plugins</groupId>\n             <artifactId>maven-dependency-plugin</artifactId>\n             <executions>\n+              <execution>\n+                <id>go-offline</id>\n+                <phase>initialize</phase>\n+                <goals>\n+                  <goal>go-offline</goal>\n+                </goals>\n+              </execution>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMDI2NDI3", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#pullrequestreview-530026427", "createdAt": "2020-11-13T12:36:54Z", "commit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNjo1NFrOHyst3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMjozNjo1NFrOHyst3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkyMzQ4NQ==", "bodyText": "This change is due to the new fmt-plugin v 2.10", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#discussion_r522923485", "createdAt": "2020-11-13T12:36:54Z", "author": {"login": "korthout"}, "path": "qa/integration-tests/src/test/java/io/zeebe/broker/it/clustering/ClusteringRule.java", "diffHunk": "@@ -552,7 +552,10 @@ public void stepDown(final Broker broker, final int partitionId) {\n     final MemberId nodeId = atomix.getMembershipService().getLocalMember().id();\n \n     final var raftPartition =\n-        atomix.getPartitionService().getPartitionGroup(AtomixFactory.GROUP_NAME).getPartitions()\n+        atomix\n+            .getPartitionService()\n+            .getPartitionGroup(AtomixFactory.GROUP_NAME)\n+            .getPartitions()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMjY2MTE4", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#pullrequestreview-531266118", "createdAt": "2020-11-16T12:15:24Z", "commit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMjoxNToyNFrOHz66uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMjoxNTo1MlrOHz68zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDIwNDczMQ==", "bodyText": "Nit: I'd argue it's to enable formatting on jdks 9 and above \ud83d\ude05", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#discussion_r524204731", "createdAt": "2020-11-16T12:15:24Z", "author": {"login": "npepinpe"}, "path": "parent/pom.xml", "diffHunk": "@@ -1482,5 +1491,66 @@\n         </plugins>\n       </build>\n     </profile>\n+\n+    <!-- profile to disable the fmt-plugin on older jdks -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDIwNTI2MA==", "bodyText": "Nit: can you explain why checkstyle is not a validation check? Here I'm mostly confused by the comment, not by the profile, if that makes sense.", "url": "https://github.com/camunda-cloud/zeebe/pull/5841#discussion_r524205260", "createdAt": "2020-11-16T12:15:52Z", "author": {"login": "npepinpe"}, "path": "parent/pom.xml", "diffHunk": "@@ -1482,5 +1491,66 @@\n         </plugins>\n       </build>\n     </profile>\n+\n+    <!-- profile to disable the fmt-plugin on older jdks -->\n+    <profile>\n+      <id>fmt-plugin</id>\n+      <activation>\n+        <jdk>[,9)</jdk>\n+      </activation>\n+      <build>\n+        <plugins>\n+          <plugin>\n+            <artifactId>fmt-maven-plugin</artifactId>\n+            <groupId>com.coveo</groupId>\n+            <executions>\n+              <execution>\n+                <id>format</id>\n+                <phase>none</phase>\n+                <goals>\n+                  <goal>check</goal>\n+                  <goal>format</goal>\n+                </goals>\n+              </execution>\n+            </executions>\n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+\n+    <!-- profile to perform validation checks -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770"}, "originalPosition": 63}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0b1be2d221c40eabc6d5cfc814d911e9095626c", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/a0b1be2d221c40eabc6d5cfc814d911e9095626c", "committedDate": "2020-11-16T13:05:55Z", "message": "chore(build): improve fmt and license checks\n\n- only activate fmt-plugin on jdk9+\n- use profiles to run checks from ci builds\n\nThe latter is necessary to make sure the version from the pom is used,\ninstead of the latest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb086565b3b581fd964517c1fb076803399f16ea", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/bb086565b3b581fd964517c1fb076803399f16ea", "committedDate": "2020-11-16T13:05:55Z", "message": "chore(pom): update fmt-plugin to 2.10"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/cab0ab6fb02f757f3e7f74a2ff77dcbc86a20770", "committedDate": "2020-11-13T12:35:53Z", "message": "chore(pom): update fmt-plugin to 2.10"}, "afterCommit": {"oid": "bb086565b3b581fd964517c1fb076803399f16ea", "author": {"user": {"login": "korthout", "name": "Nico Korthout"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/bb086565b3b581fd964517c1fb076803399f16ea", "committedDate": "2020-11-16T13:05:55Z", "message": "chore(pom): update fmt-plugin to 2.10"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2392, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}