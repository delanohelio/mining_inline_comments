{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MDE1NTEw", "number": 4946, "title": "Add trace logging to transport", "bodyText": "Description\nAdded trace logging to transport and enabled it for the AtomixTransportTest. I hope with that we can better understand why the test is sometimes failing.\n\nRelated issues\n\nrelated #4911\nDefinition of Done\nNot all items need to be done depending on the issue and the pull request.\nCode changes:\n\n The changes are backwards compatibility with previous versions\n If it fixes a bug then PRs are created to backport the fix to the last two minor versions\n\nTesting:\n\n There are unit/integration tests that verify all acceptance criterias of the issue\n New tests are written to ensure backwards compatibility with further versions\n The behavior is tested manually\n The impact of the changes is verified by a benchmark\n\nDocumentation:\n\n The documentation is updated (e.g. BPMN reference, configuration, examples, get-started guides, etc.)\n New content is added to the release annoncement", "createdAt": "2020-07-13T03:37:33Z", "url": "https://github.com/camunda-cloud/zeebe/pull/4946", "merged": true, "mergeCommit": {"oid": "49e4d2360676bd1255b3455bc3747e0ba39bacd0"}, "closed": true, "closedAt": "2020-07-15T09:31:19Z", "author": {"login": "Zelldon"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcz3BLSgH2gAyNDQ4MDE1NTEwOmFkZjEzMTg5YjgyNTM4ZDI1ZTU0MDFiNmU4ZTQyYmI0NTQ2ODM4Yzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1E8LQgFqTQ0ODY3MzI1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "adf13189b82538d25e5401b6e8e42bb4546838c8", "author": {"user": {"login": "Zelldon", "name": "Christopher Zell"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/adf13189b82538d25e5401b6e8e42bb4546838c8", "committedDate": "2020-07-11T12:02:17Z", "message": "chore(transport): add new trace logging to transport"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6be707a2be67ce84867cee03fac32511a7755814", "author": {"user": {"login": "Zelldon", "name": "Christopher Zell"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/6be707a2be67ce84867cee03fac32511a7755814", "committedDate": "2020-07-13T03:32:12Z", "message": "chore(transport): add trace logging to server"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MTAwNDk4", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#pullrequestreview-447100498", "createdAt": "2020-07-13T09:50:12Z", "commit": {"oid": "6be707a2be67ce84867cee03fac32511a7755814"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwOTo1MDoxMlrOGwhUcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwOTo1MjoxMFrOGwhZOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMDczNw==", "bodyText": "Maybe wrap in isTraceEnabled()", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453530737", "createdAt": "2020-07-13T09:50:12Z", "author": {"login": "pihme"}, "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixClientTransportAdapter.java", "diffHunk": "@@ -111,6 +126,12 @@ private void tryToSend(final RequestContext requestContext) {\n       return;\n     }\n \n+    LOG.trace(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be707a2be67ce84867cee03fac32511a7755814"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTM0OQ==", "bodyText": "Maybe wrap in isTraceEnabled(). Also at other places in this class", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453531349", "createdAt": "2020-07-13T09:51:13Z", "author": {"login": "pihme"}, "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixClientTransportAdapter.java", "diffHunk": "@@ -122,14 +143,21 @@ private void tryToSend(final RequestContext requestContext) {\n   private void handleResponse(\n       final RequestContext requestContext, final byte[] response, final Throwable errorOnRequest) {\n     if (requestContext.isDone()) {\n+      LOG.trace(\"Handle response, but request {} is already done\", requestContext.hashCode());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be707a2be67ce84867cee03fac32511a7755814"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMTk2MQ==", "bodyText": "Maybe wrp in \u00ecsTraceEnabled() also at other places in this class", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#discussion_r453531961", "createdAt": "2020-07-13T09:52:10Z", "author": {"login": "pihme"}, "path": "transport/src/main/java/io/zeebe/transport/impl/AtomixServerTransport.java", "diffHunk": "@@ -68,9 +65,11 @@ public void close() {\n   public ActorFuture<Void> subscribe(final int partitionId, final RequestHandler requestHandler) {\n     return actor.call(\n         () -> {\n+          final var topicName = topicName(partitionId);\n+          LOG.trace(\"Subscribe for topic {}\", topicName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be707a2be67ce84867cee03fac32511a7755814"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daa7adcdc180a6a346b97e138c8538b91282f4dd", "author": {"user": {"login": "Zelldon", "name": "Christopher Zell"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/daa7adcdc180a6a346b97e138c8538b91282f4dd", "committedDate": "2020-07-15T04:55:31Z", "message": "chore(transport): check whether trace is enabled"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c80f99fa5b64a8c2f9dbcfa0c9180bece8530319", "author": {"user": {"login": "Zelldon", "name": "Christopher Zell"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/c80f99fa5b64a8c2f9dbcfa0c9180bece8530319", "committedDate": "2020-07-14T14:59:08Z", "message": "chore(transport): check whether trace is enabled"}, "afterCommit": {"oid": "daa7adcdc180a6a346b97e138c8538b91282f4dd", "author": {"user": {"login": "Zelldon", "name": "Christopher Zell"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/daa7adcdc180a6a346b97e138c8538b91282f4dd", "committedDate": "2020-07-15T04:55:31Z", "message": "chore(transport): check whether trace is enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NjczMjUz", "url": "https://github.com/camunda-cloud/zeebe/pull/4946#pullrequestreview-448673253", "createdAt": "2020-07-15T06:49:25Z", "commit": {"oid": "daa7adcdc180a6a346b97e138c8538b91282f4dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2688, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}