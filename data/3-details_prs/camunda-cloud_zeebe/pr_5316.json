{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxOTcyNjgw", "number": 5316, "title": "Reject deployment with invalid workflows", "bodyText": "Description\n\nvalidate the target expressions of variable mappings\nvalidate static timer expressions\nignore error events that are not referenced in the workflow on validation and transformation\ntransform the workflow on validation to avoid missing validations, or unexpected failures on transforming\n\nRelated issues\ncloses #5253\ncloses #5248\ncloses #5247\nDefinition of Done\nNot all items need to be done depending on the issue and the pull request.\nCode changes:\n\n The changes are backwards compatibility with previous versions\n If it fixes a bug then PRs are created to backport the fix to the last two minor versions\n\nTesting:\n\n There are unit/integration tests that verify all acceptance criterias of the issue\n New tests are written to ensure backwards compatibility with further versions\n The behavior is tested manually\n The impact of the changes is verified by a benchmark\n\nDocumentation:\n\n The documentation is updated (e.g. BPMN reference, configuration, examples, get-started guides, etc.)\n New content is added to the release announcement", "createdAt": "2020-09-08T11:22:30Z", "url": "https://github.com/camunda-cloud/zeebe/pull/5316", "merged": true, "mergeCommit": {"oid": "ee66b3b5890c7c8eb5563c9250874a637c2fb9a9"}, "closed": true, "closedAt": "2020-09-14T15:24:07Z", "author": {"login": "saig0"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdG2fM0ABqjM3NDA2MDgyNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI0a-AgBqjM3NjM4MzE1MjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b1730a90f2d858ebaa236d15e7864cd463d2922", "author": {"user": {"login": "saig0", "name": "Philipp Ossler"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/0b1730a90f2d858ebaa236d15e7864cd463d2922", "committedDate": "2020-09-08T09:34:25Z", "message": "fix(broker): reject deployment with invalid workflows\n\n* validate the target expressions of variable mappings\n* validate static timer expressions\n* ignore error events that are not referenced in the workflow on validation and transformation\n* transform the workflow on validation to avoid missing validations, or unexpected failures on transforming"}, "afterCommit": {"oid": "008e18b3cb56dc5996c442f40243b4ce129cb3a9", "author": {"user": {"login": "saig0", "name": "Philipp Ossler"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/008e18b3cb56dc5996c442f40243b4ce129cb3a9", "committedDate": "2020-09-08T12:09:34Z", "message": "fix(broker): reject deployment with invalid workflows\n\n* validate the target expressions of variable mappings\n* validate static timer expressions\n* ignore error events that are not referenced in the workflow on validation and transformation\n* transform the workflow on validation to avoid missing validations, or unexpected failures on transforming"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1ODQzNjA1", "url": "https://github.com/camunda-cloud/zeebe/pull/5316#pullrequestreview-485843605", "createdAt": "2020-09-10T11:41:42Z", "commit": {"oid": "008e18b3cb56dc5996c442f40243b4ce129cb3a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMTo0MTo0M1rOHPvkig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMTo0MTo0M1rOHPvkig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjI3MDA5MA==", "bodyText": "This error message no longer adheres to our preferred error message template. Why do you want to change that?", "url": "https://github.com/camunda-cloud/zeebe/pull/5316#discussion_r486270090", "createdAt": "2020-09-10T11:41:43Z", "author": {"login": "korthout"}, "path": "engine/src/main/java/io/zeebe/engine/processing/common/ExpressionProcessor.java", "diffHunk": "@@ -130,10 +130,7 @@ public ExpressionProcessor(\n           return Either.right(Interval.parse(result.getString()));\n         } catch (final DateTimeParseException e) {\n           return Either.left(\n-              new Failure(\n-                  String.format(\n-                      \"Expected result of the expression '%s' to be parsed to a duration, but was '%s' and encountered error: %s\",\n-                      expression.getExpression(), result.getString(), e.getMessage())));\n+              new Failure(String.format(\"Invalid duration format '%s'\", result.getString())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "008e18b3cb56dc5996c442f40243b4ce129cb3a9"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3Njc4NTYz", "url": "https://github.com/camunda-cloud/zeebe/pull/5316#pullrequestreview-487678563", "createdAt": "2020-09-14T11:56:08Z", "commit": {"oid": "ca9ede3e6d8ca3c00ab9b537927fe40c6ed54b84"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d888feb3d5f54315c361fe18c6445b8c48fb4fa", "author": {"user": {"login": "saig0", "name": "Philipp Ossler"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/1d888feb3d5f54315c361fe18c6445b8c48fb4fa", "committedDate": "2020-09-14T14:52:57Z", "message": "fix(broker): reject deployment with invalid workflows\n\n* validate the target expressions of variable mappings\n* validate static timer expressions\n* ignore error events that are not referenced in the workflow on validation and transformation\n* transform the workflow on validation to avoid missing validations, or unexpected failures on transforming"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca9ede3e6d8ca3c00ab9b537927fe40c6ed54b84", "author": {"user": {"login": "saig0", "name": "Philipp Ossler"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/ca9ede3e6d8ca3c00ab9b537927fe40c6ed54b84", "committedDate": "2020-09-09T10:10:07Z", "message": "chore(engine): improve validation test for timers\n\n* migrate to JUnit 5 to improve the readability and maintainability"}, "afterCommit": {"oid": "1d888feb3d5f54315c361fe18c6445b8c48fb4fa", "author": {"user": {"login": "saig0", "name": "Philipp Ossler"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/1d888feb3d5f54315c361fe18c6445b8c48fb4fa", "committedDate": "2020-09-14T14:52:57Z", "message": "fix(broker): reject deployment with invalid workflows\n\n* validate the target expressions of variable mappings\n* validate static timer expressions\n* ignore error events that are not referenced in the workflow on validation and transformation\n* transform the workflow on validation to avoid missing validations, or unexpected failures on transforming"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2605, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}