{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NDQ2NTQ1", "number": 5260, "title": "Add flag to disable disk usage watermarks", "bodyText": "Description\nOn disabling watermarks for disk usage the watermarks are set to 1, meaning the whole disk space can be used.\nRelated issues\ncloses #5214\nDefinition of Done\nNot all items need to be done depending on the issue and the pull request.\nCode changes:\n\n The changes are backwards compatibility with previous versions\n If it fixes a bug then PRs are created to backport the fix to the last two minor versions\n\nTesting:\n\n There are unit/integration tests that verify all acceptance criterias of the issue\n New tests are written to ensure backwards compatibility with further versions\n The behavior is tested manually\n The impact of the changes is verified by a benchmark\n\nDocumentation:\n\n The documentation is updated (e.g. BPMN reference, configuration, examples, get-started guides, etc.)\n New content is added to the release announcement", "createdAt": "2020-08-28T14:42:23Z", "url": "https://github.com/camunda-cloud/zeebe/pull/5260", "merged": true, "mergeCommit": {"oid": "abb03a347c3b7ca32b8b8e78645726a220c16da4"}, "closed": true, "closedAt": "2020-09-01T09:36:06Z", "author": {"login": "menski"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdENev4gBqjM3MDg1NTAzNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEjtjdAFqTQ3OTU0NDU0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b70970d17a644f07d3160de0f67dbb16dfc29d9d", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/b70970d17a644f07d3160de0f67dbb16dfc29d9d", "committedDate": "2020-08-28T14:40:47Z", "message": "chore(broker): add flag to disable disk usage watermarks\n\nOn disabling watermarks for disk usage the watermarks are set to 1,\nmeaning the whole diskspace can be used."}, "afterCommit": {"oid": "660008d34b37b3a87634acb0126f83741a02ce42", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/660008d34b37b3a87634acb0126f83741a02ce42", "committedDate": "2020-08-31T07:15:09Z", "message": "chore(broker): add flag to disable disk usage watermarks\n\nOn disabling watermarks for disk usage the watermarks are set to 1,\nmeaning the whole diskspace can be used."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NTYwMDM3", "url": "https://github.com/camunda-cloud/zeebe/pull/5260#pullrequestreview-478560037", "createdAt": "2020-08-31T12:11:12Z", "commit": {"oid": "660008d34b37b3a87634acb0126f83741a02ce42"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxMjoxMToxMlrOHJ2ObQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxMjoxMToxMlrOHJ2ObQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA4NzY2MQ==", "bodyText": "I recommend to name it diskUsageMonitoringEnabled.", "url": "https://github.com/camunda-cloud/zeebe/pull/5260#discussion_r480087661", "createdAt": "2020-08-31T12:11:12Z", "author": {"login": "deepthidevaki"}, "path": "broker/src/main/java/io/zeebe/broker/system/configuration/DataCfg.java", "diffHunk": "@@ -34,13 +42,21 @@\n   private int logIndexDensity = 100;\n \n   private boolean useMmap = false;\n+  private boolean diskUsageWatermarkEnabled = DEFAULT_DISK_USAGE_WATERMARK_ENABLED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "660008d34b37b3a87634acb0126f83741a02ce42"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c223abbff38955cd54b3734662c80967c6bf13b", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/8c223abbff38955cd54b3734662c80967c6bf13b", "committedDate": "2020-08-31T15:16:43Z", "message": "chore(broker): skip scheduling of disk space monitor actor"}, "afterCommit": {"oid": "eec1338fd59d8e2c5b688e27954d50905cd27558", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/eec1338fd59d8e2c5b688e27954d50905cd27558", "committedDate": "2020-08-31T15:24:16Z", "message": "chore(broker): skip scheduling of disk space monitor actor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NDczNzY0", "url": "https://github.com/camunda-cloud/zeebe/pull/5260#pullrequestreview-479473764", "createdAt": "2020-09-01T07:35:44Z", "commit": {"oid": "eec1338fd59d8e2c5b688e27954d50905cd27558"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozNTo0NFrOHKpRBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozNTo0NFrOHKpRBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyMzkxMA==", "bodyText": "We can also skip this step when monitoring is disabled.", "url": "https://github.com/camunda-cloud/zeebe/pull/5260#discussion_r480923910", "createdAt": "2020-09-01T07:35:44Z", "author": {"login": "deepthidevaki"}, "path": "broker/src/main/java/io/zeebe/broker/Broker.java", "diffHunk": "@@ -292,9 +292,14 @@ private AutoCloseable monitoringServerStep(final BrokerInfo localBroker) {\n \n   private AutoCloseable diskSpaceMonitorStep(final DataCfg data) {\n     diskSpaceUsageMonitor = new DiskSpaceUsageMonitor(data);\n-    scheduleActor(diskSpaceUsageMonitor);\n+    final boolean diskUsageMonitoringEnabled = data.isDiskUsageMonitoringEnabled();\n+    if (diskUsageMonitoringEnabled) {\n+      scheduleActor(diskSpaceUsageMonitor);\n+    } else {\n+      LOG.info(\"Skipping start of disk space usage monitor, as it is disabled by configuration\");\n+    }\n     diskSpaceUsageListeners.forEach(l -> diskSpaceUsageMonitor.addDiskUsageListener(l));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eec1338fd59d8e2c5b688e27954d50905cd27558"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d556eaac656ba53bdd8984097047217966a1ab1", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/6d556eaac656ba53bdd8984097047217966a1ab1", "committedDate": "2020-09-01T08:39:58Z", "message": "chore(broker): add flag to disable disk usage watermarks\n\nOn disabling watermarks for disk usage the watermarks are set to 1,\nmeaning the whole diskspace can be used."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6b5dbca4e38a0513c17f713c3d63df0f64f2889", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/e6b5dbca4e38a0513c17f713c3d63df0f64f2889", "committedDate": "2020-09-01T08:46:24Z", "message": "chore(broker): skip scheduling of disk space monitor actor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53ecbb0e0246d788633e4327514d34ffa805199f", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/53ecbb0e0246d788633e4327514d34ffa805199f", "committedDate": "2020-09-01T08:46:39Z", "message": "chore(dist): update config files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eec1338fd59d8e2c5b688e27954d50905cd27558", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/eec1338fd59d8e2c5b688e27954d50905cd27558", "committedDate": "2020-08-31T15:24:16Z", "message": "chore(broker): skip scheduling of disk space monitor actor"}, "afterCommit": {"oid": "53ecbb0e0246d788633e4327514d34ffa805199f", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/53ecbb0e0246d788633e4327514d34ffa805199f", "committedDate": "2020-09-01T08:46:39Z", "message": "chore(dist): update config files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7be5c8efe616bbed7a627256d9354f6202e8f461", "author": {"user": {"login": "menski", "name": "Sebastian Menski"}}, "url": "https://github.com/camunda-cloud/zeebe/commit/7be5c8efe616bbed7a627256d9354f6202e8f461", "committedDate": "2020-09-01T08:56:17Z", "message": "docs(operations): add diskUsageMonitoringEnabled flag to documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NTQ0NTQ3", "url": "https://github.com/camunda-cloud/zeebe/pull/5260#pullrequestreview-479544547", "createdAt": "2020-09-01T09:09:22Z", "commit": {"oid": "7be5c8efe616bbed7a627256d9354f6202e8f461"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2583, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}