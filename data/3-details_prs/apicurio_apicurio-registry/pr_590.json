{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MTEyNzE4", "number": 590, "title": "Add version createdon metadata 453", "bodyText": "", "createdAt": "2020-06-03T10:34:05Z", "url": "https://github.com/Apicurio/apicurio-registry/pull/590", "merged": true, "mergeCommit": {"oid": "e4287e6369fdd9801f376e3571fd8a1c24175628"}, "closed": true, "closedAt": "2020-06-03T11:56:12Z", "author": {"login": "carlesarnal"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnmKkgAH2gAyNDI3MTEyNzE4OmVjYmIzMzc5YTI5NjBhYjM0ZTNjYTBiOThiYmU1ZjhhYTQxMzU2YmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnoJ39gFqTQyMzQ3ODE0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ecbb3379a2960ab34e3ca0b98bbe5f8aa41356bf", "author": {"user": {"login": "carlesarnal", "name": "Carles Arnal"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/ecbb3379a2960ab34e3ca0b98bbe5f8aa41356bf", "committedDate": "2020-06-03T09:37:04Z", "message": "Add createdOn version metadata for map based storages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7", "author": {"user": {"login": "carlesarnal", "name": "Carles Arnal"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/9930fe89e5398de0c24d7ac8e6b7c544f128e3d7", "committedDate": "2020-06-03T10:33:07Z", "message": "Add createdOn for streams and jpa storages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDM1NzYx", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#pullrequestreview-423435761", "createdAt": "2020-06-03T10:50:19Z", "commit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDo1MDoyMFrOGeWejQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDo1MDoyMFrOGeWejQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ3ODczMw==", "bodyText": "I don't think this is useful meta-data to put on a version.  The artifact has a logical modifiedOn ... but similar to the createdOn value for an artifact, the modifiedOn for an artifact should be the createdOn value of the artifact's most recent version.", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434478733", "createdAt": "2020-06-03T10:50:20Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/storage/impl/AbstractMapRegistryStorage.java", "diffHunk": "@@ -199,8 +200,6 @@ protected ArtifactMetaDataDto createOrUpdateArtifact(String artifactId, Artifact\n         contents.put(MetaDataKeys.CREATED_ON, currentTimeMillis);\n         contents.put(MetaDataKeys.MODIFIED_ON, currentTimeMillis);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDU0NzA4", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#pullrequestreview-423454708", "createdAt": "2020-06-03T11:20:14Z", "commit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMToyMDoxNFrOGeXX3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMToyMDoxNFrOGeXX3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ5MzQwNw==", "bodyText": "Doesn't this duplicate the logic in the storage?  It seems like the storage is doing this same work (and I think the storage is where we would want to do this work).", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434493407", "createdAt": "2020-06-03T11:20:14Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rest/ArtifactsResourceImpl.java", "diffHunk": "@@ -451,6 +453,12 @@ public void deleteArtifactRule(RuleType rule, String artifactId) {\n     @Override\n     public ArtifactMetaData getArtifactMetaData(String artifactId) {\n         ArtifactMetaDataDto dto = storage.getArtifactMetaData(artifactId);\n+\n+        if (dto.getVersion() != ARTIFACT_FIRST_VERSION) {\n+            //Fetch the createdOn value from the first version of the artifact\n+            ArtifactVersionMetaDataDto artifactVersionMetaData = storage.getArtifactVersionMetaData(artifactId, ARTIFACT_FIRST_VERSION);\n+            dto.setCreatedOn(artifactVersionMetaData.getCreatedOn());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "691af070a9aec9fc6630679393f97423d4e6a1eb", "author": {"user": {"login": "carlesarnal", "name": "Carles Arnal"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/691af070a9aec9fc6630679393f97423d4e6a1eb", "committedDate": "2020-06-03T11:36:31Z", "message": "Remove previous approach for the get artifact metadata"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDc4MTQx", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#pullrequestreview-423478141", "createdAt": "2020-06-03T11:56:07Z", "commit": {"oid": "691af070a9aec9fc6630679393f97423d4e6a1eb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4515, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}