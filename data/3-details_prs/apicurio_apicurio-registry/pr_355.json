{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NTc4NjMy", "number": 355, "title": "Add support for Web Services artifact types #256", "bodyText": "Addresses #256 - Add support for XSD and WSDl ArtifactTypes\n@EricWittmann", "createdAt": "2020-03-31T20:22:32Z", "url": "https://github.com/Apicurio/apicurio-registry/pull/355", "merged": true, "mergeCommit": {"oid": "32ebc79756ea2979e062c69af34a73a8b4d53839"}, "closed": true, "closedAt": "2020-04-15T18:35:43Z", "author": {"login": "cfoskin"}, "timelineItems": {"totalCount": 43, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTrpqWAFqTM4NjM4NjA0MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX73PygH2gAyMzk2NTc4NjMyOjA2ZTI1YzAzZjQwOWE4ZDg4ZTRhNzY2MjZkYjhiZTFjMzNmYWEwZGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2Mzg2MDQw", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-386386040", "createdAt": "2020-04-02T12:42:03Z", "commit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0MjowNFrOF_pWHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0MjowNFrOF_pWHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI4MjAxMg==", "bodyText": "Use java.nio.charset.StandardCharsets.UTF_8 here instead of the string.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r402282012", "createdAt": "2020-04-02T12:42:04Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/content/canon/XsdContentCanonicalizer.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.content.canon;\n+\n+import java.io.IOException;\n+\n+import javax.xml.parsers.ParserConfigurationException;\n+\n+import org.apache.xml.security.Init;\n+import org.apache.xml.security.c14n.CanonicalizationException;\n+import org.apache.xml.security.c14n.Canonicalizer;\n+import org.apache.xml.security.c14n.InvalidCanonicalizerException;\n+import org.xml.sax.SAXException;\n+\n+import io.apicurio.registry.content.ContentCanonicalizer;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+public class XsdContentCanonicalizer implements ContentCanonicalizer {\n+\n+    /**\n+     * @see io.apicurio.registry.content.ContentCanonicalizer#canonicalize(io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public ContentHandle canonicalize(ContentHandle content) {\n+        Init.init(); // this library needs to be initialized using the static init()\n+        try {\n+            Canonicalizer canon = Canonicalizer.getInstance(Canonicalizer.ALGO_ID_C14N_OMIT_COMMENTS);\n+            byte[] canonXmlBytes = canon.canonicalize(content.bytes());\n+            String canonicalized = new String(canonXmlBytes, \"UTF-8\"); // for UTF-8 encoding", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2Mzg2ODQ1", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-386386845", "createdAt": "2020-04-02T12:43:10Z", "commit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0MzoxMFrOF_pYtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0MzoxMFrOF_pYtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI4MjY3Nw==", "bodyText": "Looks good!", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r402282677", "createdAt": "2020-04-02T12:43:10Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/XsdContentValidator.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.xml.XMLConstants;\n+import javax.xml.parsers.DocumentBuilder;\n+import javax.xml.parsers.DocumentBuilderFactory;\n+import javax.xml.transform.Source;\n+import javax.xml.transform.stream.StreamSource;\n+import javax.xml.validation.SchemaFactory;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+@ApplicationScoped\n+public class XsdContentValidator implements ContentValidator {\n+\n+    /**\n+     * @see io.apicurio.registry.rules.validity.ContentValidator#validate(io.apicurio.registry.rules.validity.ValidityLevel,\n+     *      io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public void validate(ValidityLevel level, ContentHandle artifactContent) throws InvalidContentException {\n+        if (level == ValidityLevel.SYNTAX_ONLY || level == ValidityLevel.FULL) {\n+            try {\n+                // try to parse it\n+                DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+                DocumentBuilder builder = factory.newDocumentBuilder();\n+                builder.parse(artifactContent.stream());\n+\n+                if (level == ValidityLevel.FULL) {\n+                    // validate that its a valid schema\n+                    Source source = new StreamSource(artifactContent.stream());\n+                    SchemaFactory schemaFactory = SchemaFactory\n+                            .newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n+                    schemaFactory.newSchema(source);\n+                }\n+            } catch (Exception e) {\n+                throw new InvalidContentException(\"Syntax violation for XSD Schema artifact.\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2Mzg3NTI5", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-386387529", "createdAt": "2020-04-02T12:44:06Z", "commit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0NDowNlrOF_pa6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0NDowNlrOF_pa6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI4MzI0Mg==", "bodyText": "Can you externalize these two files to test resources?", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r402283242", "createdAt": "2020-04-02T12:44:06Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/java/io/apicurio/registry/content/ContentCanonicalizerFactoryTest.java", "diffHunk": "@@ -171,5 +171,44 @@ void testKafkaConnect() {\n         Assertions.assertEquals(expected, actual);\n     }\n \n+    /**\n+    * Test method for {@link io.apicurio.registry.content.ContentCanonicalizerFactory#create(io.apicurio.registry.types.ArtifactType)}.\n+    */\n+    @Test\n+    void testXsd() {\n+       ContentCanonicalizerFactory factory = new ContentCanonicalizerFactory();\n+       ContentCanonicalizer canonicalizer = factory.create(ArtifactType.XSD);\n+       String before = \"<xs:schema xmlns:xs=\\\"http://www.w3.org/2001/XMLSchema\\\">\\n\"\n+               + \"<xs:element             name=\\\"shiporder\\\">\\n\" + \"  <xs:complexType>\\n\"\n+               + \"    <xs:sequence>\\n\"\n+               + \"      <xs:element            name=\\\"orderperson\\\" type=\\\"xs:string\\\"/>\\n\"\n+               + \"      <xs:element       name=\\\"shipto\\\">\\n\" + \"        <xs:complexType>\\n\"\n+               + \"          <xs:sequence>\\n\"\n+               + \"            <xs:element          type=\\\"xs:string\\\"  name=\\\"name\\\" />\\n\"\n+               + \"            <xs:element               type=\\\"xs:string\\\" name=\\\"address\\\"/>\\n\"\n+               + \"            <xs:element      type=\\\"xs:string\\\"  name=\\\"city\\\"/>\\n\"\n+               + \"            <xs:element    type=\\\"xs:string\\\" name=\\\"country\\\"/>\\n\"\n+               + \"          </xs:sequence>\\n\" + \"        </xs:complexType>\\n\" + \"      </xs:element>\\n\"\n+               + \"    </xs:sequence>\\n\"\n+               + \"    <xs:attribute use=\\\"required\\\" type=\\\"xs:string\\\" name=\\\"orderid\\\"/>\\n\"\n+               + \"  </xs:complexType>\\n\" + \"</xs:element>\\n\" + \"</xs:schema>\";\n \n+       String expected = \"<xs:schema xmlns:xs=\\\"http://www.w3.org/2001/XMLSchema\\\">\\n\"\n+               + \"<xs:element name=\\\"shiporder\\\">\\n\" + \"  <xs:complexType>\\n\" + \"    <xs:sequence>\\n\"\n+               + \"      <xs:element name=\\\"orderperson\\\" type=\\\"xs:string\\\"></xs:element>\\n\"\n+               + \"      <xs:element name=\\\"shipto\\\">\\n\" + \"        <xs:complexType>\\n\"\n+               + \"          <xs:sequence>\\n\"\n+               + \"            <xs:element name=\\\"name\\\" type=\\\"xs:string\\\"></xs:element>\\n\"\n+               + \"            <xs:element name=\\\"address\\\" type=\\\"xs:string\\\"></xs:element>\\n\"\n+               + \"            <xs:element name=\\\"city\\\" type=\\\"xs:string\\\"></xs:element>\\n\"\n+               + \"            <xs:element name=\\\"country\\\" type=\\\"xs:string\\\"></xs:element>\\n\"\n+               + \"          </xs:sequence>\\n\" + \"        </xs:complexType>\\n\" + \"      </xs:element>\\n\"\n+               + \"    </xs:sequence>\\n\"\n+               + \"    <xs:attribute name=\\\"orderid\\\" type=\\\"xs:string\\\" use=\\\"required\\\"></xs:attribute>\\n\"\n+               + \"  </xs:complexType>\\n\" + \"</xs:element>\\n\" + \"</xs:schema>\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2Mzg4ODg5", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-386388889", "createdAt": "2020-04-02T12:45:51Z", "commit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0NTo1MVrOF_pfIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjo0NTo1MVrOF_pfIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI4NDMyMw==", "bodyText": "In what way is this semantically invalid?  I can't tell by just looking. :)", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r402284323", "createdAt": "2020-04-02T12:45:51Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/resources/io/apicurio/registry/rules/validity/xml-schema-invalid-semantics.xsd", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n+<xs:element name=\"shiporder\">\n+    <xs:sequence>\n+      <xs:element name=\"orderperson\" type=\"xs:string\"/>\n+      <xs:element name=\"shipto\">\n+        <xs:complexType>\n+          <xs:sequence>\n+            <xs:element name=\"name\" type=\"xs:string\"/>\n+            <xs:element name=\"address\" type=\"xs:string\"/>\n+            <xs:element name=\"city\" type=\"xs:string\"/>\n+            <xs:element name=\"country\" type=\"xs:string\"/>\n+          </xs:sequence>\n+        </xs:complexType>\n+      </xs:element>\n+    <xs:attribute name=\"orderid\" type=\"xs:string\" use=\"required\"/>\n+  </xs:complexType>\n+</xs:element>\n+</xs:schema>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d3f45c16e2d4ed280ae16f8ab172d75f1d1de4a"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5efb7e00ea30cd29b73f54c68efc521642ed458a", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/5efb7e00ea30cd29b73f54c68efc521642ed458a", "committedDate": "2020-04-03T12:17:23Z", "message": "use IOUtils"}, "afterCommit": {"oid": "f3cb160f92930f2cae49d39fe2b649fb5edc1127", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/f3cb160f92930f2cae49d39fe2b649fb5edc1127", "committedDate": "2020-04-03T15:48:07Z", "message": "feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDUxNTc4", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388451578", "createdAt": "2020-04-06T17:09:31Z", "commit": {"oid": "f31e956efb89c7acc3e6a7f0236dc069e3438f3e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzowOTozMVrOGBhotA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzowOTozMVrOGBhotA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1Mjg1Mg==", "bodyText": "The version should be pulled up into the root pom.xml file.  You'll see the pattern for this in that file.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404252852", "createdAt": "2020-04-06T17:09:31Z", "author": {"login": "EricWittmann"}, "path": "app/pom.xml", "diffHunk": "@@ -80,6 +80,12 @@\n \t\t\t<artifactId>xmlsec</artifactId>\n \t\t\t<version>1.3.0</version>\n \t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>wsdl4j</groupId>\n+\t\t\t<artifactId>wsdl4j</artifactId>\n+\t\t\t<version>1.6.3</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f31e956efb89c7acc3e6a7f0236dc069e3438f3e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDUyODI4", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388452828", "createdAt": "2020-04-06T17:11:07Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMTowN1rOGBhsVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMTowN1rOGBhsVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1Mzc4MQ==", "bodyText": "It seems you have re-formatted this file and as a result have replaced all of the spaces with tabs.  This will break the github diff (as you can see).  Please restore the previous format and, if you can, use spaces for indentation instead of tabs for any new changes to the file.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404253781", "createdAt": "2020-04-06T17:11:07Z", "author": {"login": "EricWittmann"}, "path": "app/pom.xml", "diffHunk": "@@ -1,276 +1,291 @@\n <?xml version=\"1.0\"?>\n <project", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDUzMTA3", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388453107", "createdAt": "2020-04-06T17:11:27Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMToyN1rOGBhtKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMToyN1rOGBhtKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1Mzk5Mg==", "bodyText": "Version should be pulled up into the root pom.xml file.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404253992", "createdAt": "2020-04-06T17:11:27Z", "author": {"login": "EricWittmann"}, "path": "app/pom.xml", "diffHunk": "@@ -1,276 +1,291 @@\n <?xml version=\"1.0\"?>\n <project\n-    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\n-    xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n-    <modelVersion>4.0.0</modelVersion>\n-    <parent>\n-        <groupId>io.apicurio</groupId>\n-        <artifactId>apicurio-registry</artifactId>\n-        <version>1.1.3-SNAPSHOT</version>\n-        <relativePath>../pom.xml</relativePath>\n-    </parent>\n+\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\n+\txmlns=\"http://maven.apache.org/POM/4.0.0\"\n+\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+\t<modelVersion>4.0.0</modelVersion>\n+\t<parent>\n+\t\t<groupId>io.apicurio</groupId>\n+\t\t<artifactId>apicurio-registry</artifactId>\n+\t\t<version>1.1.3-SNAPSHOT</version>\n+\t\t<relativePath>../pom.xml</relativePath>\n+\t</parent>\n \n-    <artifactId>apicurio-registry-app</artifactId>\n-    <packaging>jar</packaging>\n-    <name>apicurio-registry-app</name>\n+\t<artifactId>apicurio-registry-app</artifactId>\n+\t<packaging>jar</packaging>\n+\t<name>apicurio-registry-app</name>\n \n-    <dependencies>\n-        <!-- Project -->\n-        <dependency>\n-            <groupId>io.apicurio</groupId>\n-            <artifactId>apicurio-registry-common</artifactId>\n-        </dependency>\n+\t<dependencies>\n+\t\t<!-- Project -->\n+\t\t<dependency>\n+\t\t\t<groupId>io.apicurio</groupId>\n+\t\t\t<artifactId>apicurio-registry-common</artifactId>\n+\t\t</dependency>\n \n-        <dependency>\n-            <groupId>io.apicurio</groupId>\n-            <artifactId>apicurio-registry-search-client</artifactId>\n-        </dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>io.apicurio</groupId>\n+\t\t\t<artifactId>apicurio-registry-search-client</artifactId>\n+\t\t</dependency>\n \n-        <!-- Quarkus Dependencies -->\n-        <dependency>\n-            <groupId>io.quarkus</groupId>\n-            <artifactId>quarkus-undertow</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>io.quarkus</groupId>\n-            <artifactId>quarkus-jackson</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>io.quarkus</groupId>\n-            <artifactId>quarkus-resteasy-jackson</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>io.quarkus</groupId>\n-            <artifactId>quarkus-smallrye-health</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>io.quarkus</groupId>\n-            <artifactId>quarkus-smallrye-metrics</artifactId>\n-        </dependency>\n+\t\t<!-- Quarkus Dependencies -->\n+\t\t<dependency>\n+\t\t\t<groupId>io.quarkus</groupId>\n+\t\t\t<artifactId>quarkus-undertow</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>io.quarkus</groupId>\n+\t\t\t<artifactId>quarkus-jackson</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>io.quarkus</groupId>\n+\t\t\t<artifactId>quarkus-resteasy-jackson</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>io.quarkus</groupId>\n+\t\t\t<artifactId>quarkus-smallrye-health</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>io.quarkus</groupId>\n+\t\t\t<artifactId>quarkus-smallrye-metrics</artifactId>\n+\t\t</dependency>\n \n-        <!-- Third Party Libraries -->\n-        <dependency>\n-            <groupId>io.apicurio</groupId>\n-            <artifactId>apicurio-data-models</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.apache.avro</groupId>\n-            <artifactId>avro</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.networknt</groupId>\n-            <artifactId>json-schema-validator</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.squareup.wire</groupId>\n-            <artifactId>wire-schema</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.projectlombok</groupId>\n-            <artifactId>lombok</artifactId>\n-            <scope>compile</scope>\n-        </dependency>\n-        \n-        <!-- Kafka Connect -->\n-        <dependency>\n-            <groupId>org.apache.kafka</groupId>\n-            <artifactId>connect-api</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.apache.kafka</groupId>\n-            <artifactId>connect-json</artifactId>\n-        </dependency>\n-        \n-        <!-- GraphQL -->\n-        <dependency>\n-            <groupId>com.graphql-java</groupId>\n-            <artifactId>graphql-java</artifactId>\n-        </dependency>\n+\t\t<!-- Third Party Libraries -->\n+\t\t<dependency>\n+\t\t\t<groupId>io.apicurio</groupId>\n+\t\t\t<artifactId>apicurio-data-models</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>org.apache.avro</groupId>\n+\t\t\t<artifactId>avro</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>com.networknt</groupId>\n+\t\t\t<artifactId>json-schema-validator</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>com.squareup.wire</groupId>\n+\t\t\t<artifactId>wire-schema</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>org.projectlombok</groupId>\n+\t\t\t<artifactId>lombok</artifactId>\n+\t\t\t<scope>compile</scope>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>commons-io</groupId>\n+\t\t\t<artifactId>commons-io</artifactId>\n+\t\t</dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>xml-security</groupId>\n+\t\t\t<artifactId>xmlsec</artifactId>\n+\t\t\t<version>1.3.0</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 162}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDUzNzc5", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388453779", "createdAt": "2020-04-06T17:12:20Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMjoyMFrOGBhvPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMjoyMFrOGBhvPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1NDUyNw==", "bodyText": "Good.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404254527", "createdAt": "2020-04-06T17:12:20Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/content/ContentCanonicalizerFactory.java", "diffHunk": "@@ -37,7 +38,10 @@\n     private ContentCanonicalizer kconnect = new KafkaConnectContentCanonicalizer();\n     private ContentCanonicalizer json = new JsonContentCanonicalizer();\n     private ContentCanonicalizer graphql = new GraphQLContentCanonicalizer();\n-    \n+    private ContentCanonicalizer xsd = new XmlContentCanonicalizer();\n+    private ContentCanonicalizer wsdl = new XmlContentCanonicalizer();\n+    private ContentCanonicalizer xml = new XmlContentCanonicalizer();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU0MTQ5", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388454149", "createdAt": "2020-04-06T17:12:50Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMjo1MFrOGBhwaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxMjo1MFrOGBhwaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1NDgyNw==", "bodyText": "Good - just fix the indentation of line 72 - the return xml; is not properly indented.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404254827", "createdAt": "2020-04-06T17:12:50Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/content/ContentCanonicalizerFactory.java", "diffHunk": "@@ -60,8 +64,12 @@ public ContentCanonicalizer create(ArtifactType type) {\n                 return noop;\n             case GRAPHQL:\n                 return graphql;\n-            default:\n-                break;\n+            case XSD:\n+                return xsd;\n+            case WSDL:\n+                return wsdl;\n+            case XML:\n+             return xml;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU1NTUx", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388455551", "createdAt": "2020-04-06T17:14:38Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNDozOFrOGBh1FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNDozOFrOGBh1FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1NjAyMQ==", "bodyText": "How often does this need to be initialized?  Check the javadoc for that init() method to find out.  Is it something that needs to be called every time you get an instance of a Canonicalizer?  I hope not but do not know offhand.\nIt's possible/likely this only needs to be done once, in which case we could put it in a static initializer.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404256021", "createdAt": "2020-04-06T17:14:38Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/content/canon/XmlContentCanonicalizer.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.content.canon;\n+\n+import java.io.IOException;\n+import javax.xml.parsers.ParserConfigurationException;\n+import org.apache.xml.security.Init;\n+import io.apicurio.registry.utils.IoUtil;\n+import org.apache.xml.security.c14n.CanonicalizationException;\n+import org.apache.xml.security.c14n.Canonicalizer;\n+import org.apache.xml.security.c14n.InvalidCanonicalizerException;\n+import org.xml.sax.SAXException;\n+import io.apicurio.registry.content.ContentCanonicalizer;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+\n+public class XmlContentCanonicalizer implements ContentCanonicalizer {\n+\n+    /**\n+     * @see io.apicurio.registry.content.ContentCanonicalizer#canonicalize(io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public ContentHandle canonicalize(ContentHandle content) {\n+        Init.init(); // this library needs to be initialized using the static init()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU2Mzk3", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388456397", "createdAt": "2020-04-06T17:15:40Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNTo0MFrOGBh3xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNTo0MFrOGBh3xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1NjcxMQ==", "bodyText": "Check the javadoc for Canonicalizer and see if it is threadsafe.  If it is, then we can create just one of these and re-use it each time this method is called.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404256711", "createdAt": "2020-04-06T17:15:40Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/content/canon/XmlContentCanonicalizer.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.content.canon;\n+\n+import java.io.IOException;\n+import javax.xml.parsers.ParserConfigurationException;\n+import org.apache.xml.security.Init;\n+import io.apicurio.registry.utils.IoUtil;\n+import org.apache.xml.security.c14n.CanonicalizationException;\n+import org.apache.xml.security.c14n.Canonicalizer;\n+import org.apache.xml.security.c14n.InvalidCanonicalizerException;\n+import org.xml.sax.SAXException;\n+import io.apicurio.registry.content.ContentCanonicalizer;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+\n+public class XmlContentCanonicalizer implements ContentCanonicalizer {\n+\n+    /**\n+     * @see io.apicurio.registry.content.ContentCanonicalizer#canonicalize(io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public ContentHandle canonicalize(ContentHandle content) {\n+        Init.init(); // this library needs to be initialized using the static init()\n+        try {\n+            Canonicalizer canon = Canonicalizer.getInstance(Canonicalizer.ALGO_ID_C14N_OMIT_COMMENTS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU2NjA1", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388456605", "createdAt": "2020-04-06T17:15:58Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNTo1OFrOGBh4bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNTo1OFrOGBh4bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1Njg3Ng==", "bodyText": "Correct.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404256876", "createdAt": "2020-04-06T17:15:58Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/compatibility/ArtifactTypeAdapterFactory.java", "diffHunk": "@@ -39,6 +39,10 @@\n         ADAPTERS.put(ArtifactType.OPENAPI, NoopArtifactTypeAdapter.INSTANCE);\n         ADAPTERS.put(ArtifactType.ASYNCAPI, NoopArtifactTypeAdapter.INSTANCE);\n         ADAPTERS.put(ArtifactType.GRAPHQL, NoopArtifactTypeAdapter.INSTANCE);\n+        ADAPTERS.put(ArtifactType.XSD, NoopArtifactTypeAdapter.INSTANCE);\n+        ADAPTERS.put(ArtifactType.WSDL, NoopArtifactTypeAdapter.INSTANCE);\n+        ADAPTERS.put(ArtifactType.XML, NoopArtifactTypeAdapter.INSTANCE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU2ODAy", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388456802", "createdAt": "2020-04-06T17:16:15Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNjoxNVrOGBh4-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxNjoxNVrOGBh4-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1NzAxOA==", "bodyText": "+1", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404257018", "createdAt": "2020-04-06T17:16:15Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/ContentValidatorFactory.java", "diffHunk": "@@ -63,8 +70,12 @@ public ContentValidator createValidator(ArtifactType artifactType) {\n                 return protofdValidator;\n             case GRAPHQL:\n                 return graphqlValidator;\n-            default:\n-                break;\n+            case XSD:\n+                return xsdValidator;\n+            case WSDL:\n+                return wsdlValidator;\n+            case XML:\n+                return xmlValidator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU4NDM3", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388458437", "createdAt": "2020-04-06T17:18:23Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxODoyM1rOGBh-Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxODoyM1rOGBh-Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1ODMyMw==", "bodyText": "The logic looks great here.  The only thing to check is which of these objects you're using are threadsafe and can be re-used.  You'll need to check the javadoc for each:\n\nDocumentBuilderFactory\nDocumentBuilder\nWSDLFactory\nWSDLReader\n\nI'm guessing the factories can be cached and re-used, but you'll need to confirm by reading the javadocs for all those classes.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404258323", "createdAt": "2020-04-06T17:18:23Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/WsdlContentValidator.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import java.io.InputStream;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.wsdl.factory.WSDLFactory;\n+import javax.wsdl.xml.WSDLReader;\n+import javax.xml.parsers.DocumentBuilder;\n+import javax.xml.parsers.DocumentBuilderFactory;\n+import org.w3c.dom.Document;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+@ApplicationScoped\n+public class WsdlContentValidator implements ContentValidator {\n+\n+    /**\n+     * @see io.apicurio.registry.rules.validity.ContentValidator#validate(io.apicurio.registry.rules.validity.ValidityLevel,\n+     *      io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public void validate(ValidityLevel level, ContentHandle artifactContent) throws InvalidContentException {\n+        if (level == ValidityLevel.SYNTAX_ONLY || level == ValidityLevel.FULL) {\n+            try (InputStream stream = artifactContent.stream()) {\n+                DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+                factory.setNamespaceAware(true);\n+                DocumentBuilder builder = factory.newDocumentBuilder();\n+                // just try to parse it\n+                Document wsdlDoc = builder.parse(stream);\n+                \n+                if (level == ValidityLevel.FULL) {\n+                    // validate that its a valid schema\n+                    WSDLFactory wsdlFactory = WSDLFactory.newInstance();\n+                    WSDLReader wsdlReader = wsdlFactory.newWSDLReader();\n+                    wsdlReader.readWSDL(null, wsdlDoc);\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU5MjEw", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388459210", "createdAt": "2020-04-06T17:19:22Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxOToyMlrOGBiAeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoxOToyMlrOGBiAeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1ODkzNw==", "bodyText": "Looks good!  Same note as before - check which of these things (if any) can be cached and re-used.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404258937", "createdAt": "2020-04-06T17:19:22Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/XmlContentValidator.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import java.io.InputStream;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.xml.parsers.DocumentBuilder;\n+import javax.xml.parsers.DocumentBuilderFactory;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com This class can be used to validate plain XML and only does syntax validation\n+ */\n+@ApplicationScoped\n+public class XmlContentValidator implements ContentValidator {\n+\n+    /**\n+     * @see io.apicurio.registry.rules.validity.ContentValidator#validate(io.apicurio.registry.rules.validity.ValidityLevel,\n+     *      io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public void validate(ValidityLevel level, ContentHandle artifactContent) throws InvalidContentException {\n+        if (level == ValidityLevel.SYNTAX_ONLY || level == ValidityLevel.FULL) {\n+            try (InputStream stream = artifactContent.stream()) {\n+                DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+                DocumentBuilder builder = factory.newDocumentBuilder();\n+                // just try to parse it\n+                builder.parse(stream);\n+            } catch (Exception e) {\n+                throw new InvalidContentException(\"Syntax violation for XML Schema artifact.\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDU5OTE3", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388459917", "createdAt": "2020-04-06T17:20:18Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMDoxOFrOGBiCog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMDoxOFrOGBiCog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI1OTQ5MA==", "bodyText": "This logic looks perfect now.  But again, we need to figure out which of these resources can be cached/re-used.  See previous comments. :)", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404259490", "createdAt": "2020-04-06T17:20:18Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/XsdContentValidator.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import java.io.InputStream;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.xml.XMLConstants;\n+import javax.xml.parsers.DocumentBuilder;\n+import javax.xml.parsers.DocumentBuilderFactory;\n+import javax.xml.transform.Source;\n+import javax.xml.transform.stream.StreamSource;\n+import javax.xml.validation.SchemaFactory;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+@ApplicationScoped\n+public class XsdContentValidator implements ContentValidator {\n+\n+    /**\n+     * @see io.apicurio.registry.rules.validity.ContentValidator#validate(io.apicurio.registry.rules.validity.ValidityLevel,\n+     *      io.apicurio.registry.content.ContentHandle)\n+     */\n+    @Override\n+    public void validate(ValidityLevel level, ContentHandle artifactContent) throws InvalidContentException {\n+        if (level == ValidityLevel.SYNTAX_ONLY || level == ValidityLevel.FULL) {\n+            try (InputStream stream = artifactContent.stream()) {\n+                // try to parse it\n+                DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+                DocumentBuilder builder = factory.newDocumentBuilder();\n+                builder.parse(stream);\n+\n+                if (level == ValidityLevel.FULL) {\n+                    try (InputStream semanticStream = artifactContent.stream()) {\n+                        // validate that its a valid schema\n+                        Source source = new StreamSource(semanticStream);\n+                        SchemaFactory schemaFactory = SchemaFactory\n+                                .newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n+                        schemaFactory.newSchema(source);\n+                    }\n+                }\n+            } catch (Exception e) {\n+                throw new InvalidContentException(\"Syntax violation for XSD Schema artifact.\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDYwODYw", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388460860", "createdAt": "2020-04-06T17:21:32Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMTozMlrOGBiFhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMTozMlrOGBiFhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2MDIzMQ==", "bodyText": "Logic is good but please rename the test files to:\n\nwsdl-before.wsdl\nwsdl-expected.wsdl\n\nThey are not wsdl-schemas, just wsdl. :)", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404260231", "createdAt": "2020-04-06T17:21:32Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/java/io/apicurio/registry/content/ContentCanonicalizerFactoryTest.java", "diffHunk": "@@ -171,5 +172,48 @@ void testKafkaConnect() {\n         Assertions.assertEquals(expected, actual);\n     }\n \n+    /**\n+    * Test method for {@link io.apicurio.registry.content.ContentCanonicalizerFactory#create(io.apicurio.registry.types.ArtifactType)}.\n+    */\n+    @Test\n+    void testXsd() {\n+       ContentCanonicalizerFactory factory = new ContentCanonicalizerFactory();\n+       ContentCanonicalizer canonicalizer = factory.create(ArtifactType.XSD);\n+\n+       ContentHandle content = resourceToContentHandle(\"xml-schema-before.xsd\");\n+       String expected = resourceToString(\"xml-schema-expected.xsd\");\n+       \n+       String actual = canonicalizer.canonicalize(content).content();\n+       Assertions.assertEquals(expected, actual);\n+    }\n+    \n+    /**\n+     * Test method for {@link io.apicurio.registry.content.ContentCanonicalizerFactory#create(io.apicurio.registry.types.ArtifactType)}.\n+     */\n+     @Test\n+     void testWsdl() {\n+        ContentCanonicalizerFactory factory = new ContentCanonicalizerFactory();\n+        ContentCanonicalizer canonicalizer = factory.create(ArtifactType.WSDL);\n+\n+        ContentHandle content = resourceToContentHandle(\"wsdl-schema-before.wsdl\");\n+        String expected = resourceToString(\"wsdl-schema-expected.wsdl\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDYxNTg0", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388461584", "createdAt": "2020-04-06T17:22:28Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMjoyOFrOGBiHzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyMjoyOFrOGBiHzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2MDgxMw==", "bodyText": "For each of these wsdl test resources, please drop the \"-schema\" from the filenames.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404260813", "createdAt": "2020-04-06T17:22:28Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/java/io/apicurio/registry/rules/validity/WsdlContentValidatorTest.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.Test;\n+\n+import io.apicurio.registry.AbstractRegistryTestBase;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+public class WsdlContentValidatorTest extends AbstractRegistryTestBase {\n+    @Test\n+    public void testValidSyntax() throws Exception {\n+        ContentHandle content = resourceToContentHandle(\"wsdl-schema-valid.wsdl\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDYyOTQw", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388462940", "createdAt": "2020-04-06T17:24:18Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyNDoxOVrOGBiMXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyNDoxOVrOGBiMXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2MTk4Mg==", "bodyText": "I think we should perhaps have a separate file for this where the syntax is valid but the semantics are invalid.  Your test uses the same valid WSDL file for both the syntax and the semantic validity check.  That's fine, but we should also have a test where the syntax is valid (and therefore passes here) but the semantics are invalid.  In fact you could just re-use the wsdl-schema-invalid-semantics.wsdl test file I think.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404261982", "createdAt": "2020-04-06T17:24:19Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/java/io/apicurio/registry/rules/validity/WsdlContentValidatorTest.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.Test;\n+\n+import io.apicurio.registry.AbstractRegistryTestBase;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+public class WsdlContentValidatorTest extends AbstractRegistryTestBase {\n+    @Test\n+    public void testValidSyntax() throws Exception {\n+        ContentHandle content = resourceToContentHandle(\"wsdl-schema-valid.wsdl\");\n+        WsdlContentValidator validator = new WsdlContentValidator();\n+        validator.validate(ValidityLevel.SYNTAX_ONLY, content);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDY0NDk2", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388464496", "createdAt": "2020-04-06T17:26:21Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyNjoyMVrOGBiRMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyNjoyMVrOGBiRMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2MzIxOQ==", "bodyText": "Same note here as in the WSDL content validator test.  You can add another test within this method to also run the SYNTAX_ONLY validity against the xml-schema-invalid-semantics.xsd test file and it should be valid.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404263219", "createdAt": "2020-04-06T17:26:21Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/java/io/apicurio/registry/rules/validity/XsdContentValidatorTest.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.Test;\n+\n+import io.apicurio.registry.AbstractRegistryTestBase;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+public class XsdContentValidatorTest extends AbstractRegistryTestBase {\n+    @Test\n+    public void testValidSyntax() throws Exception {\n+        ContentHandle content = resourceToContentHandle(\"xml-schema-valid.xsd\");\n+        XsdContentValidator validator = new XsdContentValidator();\n+        validator.validate(ValidityLevel.SYNTAX_ONLY, content);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDY3MTc2", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388467176", "createdAt": "2020-04-06T17:29:37Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyOTozN1rOGBiZkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzoyOTozN1rOGBiZkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2NTM2Mw==", "bodyText": "What additional options are there for the XML Canonicalizer?  Looking at this file I am noticing the strange/inconsistent indentation for some of the elements.  For example lines 8 and 13 don't line up, and in general the tabbing seems to be preserved from the source.  I'm wondering if there is a more aggressive option we can enable for XML canonicalization that normalizes the indentation of the elements, removing e.g. extra whitespace.", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404265363", "createdAt": "2020-04-06T17:29:37Z", "author": {"login": "EricWittmann"}, "path": "app/src/test/resources/io/apicurio/registry/content/xml-schema-expected.xsd", "diffHunk": "@@ -0,0 +1,20 @@\n+<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n+<xs:element name=\"shiporder\">\n+  <xs:complexType>\n+  <xs:sequence>\n+\t<xs:element name=\"orderperson\" type=\"xs:string\"></xs:element>\n+\t <xs:element name=\"shipto\">\n+\t   <xs:complexType>\n+\t\t<xs:sequence>\n+\t\t   <xs:element name=\"name\" type=\"xs:string\"></xs:element>\n+\t\t   <xs:element name=\"address\" type=\"xs:string\"></xs:element>\n+\t\t   <xs:element name=\"city\" type=\"xs:string\"></xs:element>\n+\t\t   <xs:element name=\"country\" type=\"xs:string\"></xs:element>\n+\t     </xs:sequence>\n+\t    </xs:complexType>\n+\t   </xs:element>\n+\t </xs:sequence>\n+\t <xs:attribute name=\"orderid\" type=\"xs:string\" use=\"required\"></xs:attribute>\n+  </xs:complexType>\n+</xs:element>\n+</xs:schema>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDY4NDc0", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-388468474", "createdAt": "2020-04-06T17:31:13Z", "commit": {"oid": "52a83f4808c21d1ae1e03b14dc0c8b2a09f4f21e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2508548e9e4caa87442fbbcc9bd4e3ac9b9626d", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/e2508548e9e4caa87442fbbcc9bd4e3ac9b9626d", "committedDate": "2020-04-07T15:01:03Z", "message": "feedback applied minus Factories checks"}, "afterCommit": {"oid": "5cff6f2f114cfc2336e3c71bf656d5f586c4bef1", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/5cff6f2f114cfc2336e3c71bf656d5f586c4bef1", "committedDate": "2020-04-07T15:06:25Z", "message": "feedback applied minus Factories checks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MjQxNTQ2", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-389241546", "createdAt": "2020-04-07T15:37:54Z", "commit": {"oid": "5cff6f2f114cfc2336e3c71bf656d5f586c4bef1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNTozNzo1NFrOGCJpnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNTozNzo1NFrOGCJpnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDkwODQ0Nw==", "bodyText": "I need to see whats causing this.. it all looks formatted fine in eclipse locally", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404908447", "createdAt": "2020-04-07T15:37:54Z", "author": {"login": "cfoskin"}, "path": "pom.xml", "diffHunk": "@@ -137,7 +137,9 @@\n \t\t<!-- Dependency versions -->\n \t\t<lombok.version>1.18.12</lombok.version>\n \t\t<h2.version>1.4.199</h2.version>\n-\n+        <xmlsec.version>2.1.5</xmlsec.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cff6f2f114cfc2336e3c71bf656d5f586c4bef1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MzEyNzA1", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-389312705", "createdAt": "2020-04-07T16:57:32Z", "commit": {"oid": "9bc36b3ecd7014aa92fa3c34ff0ed642d075e548"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjo1NzozMlrOGCNKdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjo1NzozMlrOGCNKdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk2NjAwNQ==", "bodyText": "What did you need in commons-io?", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r404966005", "createdAt": "2020-04-07T16:57:32Z", "author": {"login": "EricWittmann"}, "path": "app/pom.xml", "diffHunk": "@@ -70,7 +71,19 @@\n             <artifactId>lombok</artifactId>\n             <scope>compile</scope>\n         </dependency>\n-        \n+        <dependency>\n+            <groupId>commons-io</groupId>\n+            <artifactId>commons-io</artifactId>\n+        </dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bc36b3ecd7014aa92fa3c34ff0ed642d075e548"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMjAyMzg1", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-390202385", "createdAt": "2020-04-08T17:55:23Z", "commit": {"oid": "293c29b78669e06b35a7fc2206f0ee5839872faa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNzo1NToyM1rOGC6ejA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNzo1NToyM1rOGC6ejA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcwODQyOA==", "bodyText": "Looks good!", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r405708428", "createdAt": "2020-04-08T17:55:23Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rules/validity/WsdlContentValidator.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2020 JBoss Inc\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.validity;\n+\n+import java.io.InputStream;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.wsdl.WSDLException;\n+import javax.wsdl.factory.WSDLFactory;\n+import javax.wsdl.xml.WSDLReader;\n+import javax.xml.parsers.DocumentBuilder;\n+import javax.xml.parsers.DocumentBuilderFactory;\n+import javax.xml.parsers.ParserConfigurationException;\n+\n+import org.w3c.dom.Document;\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author cfoskin@redhat.com\n+ */\n+@ApplicationScoped\n+public class WsdlContentValidator implements ContentValidator {\n+\n+    private static ThreadLocal<DocumentBuilder> threadLocaldocBuilder = new ThreadLocal<DocumentBuilder>() {\n+        @Override\n+        protected DocumentBuilder initialValue() {\n+            DocumentBuilder builder = null;\n+            try {\n+                DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+                factory.setNamespaceAware(true);\n+                builder = factory.newDocumentBuilder();\n+            } catch (ParserConfigurationException e) {\n+                throw new RuntimeException(e);\n+            }\n+            return builder;\n+        }\n+\n+        public DocumentBuilder get() {\n+            return super.get();\n+        }\n+    };\n+\n+    private static ThreadLocal<WSDLReader> threadLocalWsdlReader = new ThreadLocal<WSDLReader>() {\n+        @Override\n+        protected WSDLReader initialValue() {\n+            WSDLReader wsdlReader = null;\n+            try {\n+                WSDLFactory wsdlFactory = WSDLFactory.newInstance();\n+                wsdlReader = wsdlFactory.newWSDLReader();\n+            } catch (WSDLException e) {\n+                throw new RuntimeException(e);\n+            }\n+            return wsdlReader;\n+\n+        }\n+\n+        public WSDLReader get() {\n+            return super.get();\n+        }\n+    };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "293c29b78669e06b35a7fc2206f0ee5839872faa"}, "originalPosition": 74}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "293c29b78669e06b35a7fc2206f0ee5839872faa", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/293c29b78669e06b35a7fc2206f0ee5839872faa", "committedDate": "2020-04-07T19:42:56Z", "message": "use ThreadLocal for factories"}, "afterCommit": {"oid": "fd54deed7b1bfaf46844bcca59a45f0846b74770", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/fd54deed7b1bfaf46844bcca59a45f0846b74770", "committedDate": "2020-04-14T13:50:55Z", "message": "refactor to extend AbstractArtifactTypeUtilProvider"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNTk1OTYw", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#pullrequestreview-393595960", "createdAt": "2020-04-15T09:14:36Z", "commit": {"oid": "fd54deed7b1bfaf46844bcca59a45f0846b74770"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxNDozNlrOGFw6Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxNTowOVrOGFw7ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5NzQyMg==", "bodyText": "Duplicated <!-- Schema types -->", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r408697422", "createdAt": "2020-04-15T09:14:36Z", "author": {"login": "jsenko"}, "path": "pom.xml", "diffHunk": "@@ -105,26 +105,29 @@\n \t\t<!-- Quarkus Version -->\n \t\t<quarkus.version>1.3.1.Final</quarkus.version>\n \n-\t\t<!-- Jandex -->\n-\t\t<jandex.version>1.0.7</jandex.version>\n+        <!-- Schema types -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd54deed7b1bfaf46844bcca59a45f0846b74770"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5NzczOA==", "bodyText": "This is required", "url": "https://github.com/Apicurio/apicurio-registry/pull/355#discussion_r408697738", "createdAt": "2020-04-15T09:15:09Z", "author": {"login": "jsenko"}, "path": "pom.xml", "diffHunk": "@@ -105,26 +105,29 @@\n \t\t<!-- Quarkus Version -->\n \t\t<quarkus.version>1.3.1.Final</quarkus.version>\n \n-\t\t<!-- Jandex -->\n-\t\t<jandex.version>1.0.7</jandex.version>\n+        <!-- Schema types -->\n+        <avro.version>1.9.2</avro.version>\n+        <json-schema-validator.version>1.0.36</json-schema-validator.version>\n+        <wire-schema.version>3.0.2</wire-schema.version>\n+        <protobuf.version>3.11.4</protobuf.version>\n \n \t\t<!-- Schema types -->\n \t\t<avro.version>1.9.2</avro.version>\n \t\t<json-schema-validator.version>1.0.38</json-schema-validator.version>\n \t\t<wire-schema.version>3.1.0</wire-schema.version>\n \t\t<protobuf.version>3.11.4</protobuf.version>\n \n-\t\t<!-- Storage types -->\n-\t\t<infinispan.version>10.1.5.Final</infinispan.version>\n+        <!-- gRPC -->\n+        <grpc.version>1.27.0</grpc.version>\n \n \t\t<!-- gRPC -->\n \t\t<grpc.version>1.28.0</grpc.version>\n \n \t\t<!-- Confluent API / client -->\n \t\t<confluent.version>5.4.1</confluent.version>\n \n-\t\t<!-- Default Quarkus configuration profile -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd54deed7b1bfaf46844bcca59a45f0846b74770"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93e8a6a13dd06bd3ffefbc5144e071f506f423d6", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/93e8a6a13dd06bd3ffefbc5144e071f506f423d6", "committedDate": "2020-04-15T12:51:12Z", "message": "xsd validation structure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab02522430bdf729a217791e359313d16ec2da89", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/ab02522430bdf729a217791e359313d16ec2da89", "committedDate": "2020-04-15T12:51:12Z", "message": "addressed feedback & add more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c14fcc1fdb706ee37a4672924362000291f3f83", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/8c14fcc1fdb706ee37a4672924362000291f3f83", "committedDate": "2020-04-15T12:51:12Z", "message": "added canonicalization for xsd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "400c6203f1de34ac97080623aff932861695cfce", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/400c6203f1de34ac97080623aff932861695cfce", "committedDate": "2020-04-15T12:51:13Z", "message": "added wsdl validator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0a0ca3051ec3e795ac7430a7b5937eedb7d1d85", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/a0a0ca3051ec3e795ac7430a7b5937eedb7d1d85", "committedDate": "2020-04-15T12:51:13Z", "message": "wsdl canonicalisation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05dd49f097ec8fd40d6b6a40743a3723cca4aa9f", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/05dd49f097ec8fd40d6b6a40743a3723cca4aa9f", "committedDate": "2020-04-15T12:51:13Z", "message": "use xml canonicaliser for both"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eeed5a009cefdfc93ffd273c77114e83f8cf737", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/9eeed5a009cefdfc93ffd273c77114e83f8cf737", "committedDate": "2020-04-15T12:51:13Z", "message": "added xml validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "518c6ba86e7f7c26ae17cd885f1911087e0794b6", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/518c6ba86e7f7c26ae17cd885f1911087e0794b6", "committedDate": "2020-04-15T12:51:13Z", "message": "use ThreadLocal for factories"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "334f69c3a79ad1eec1e7086ff1e385d16ad882c2", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/334f69c3a79ad1eec1e7086ff1e385d16ad882c2", "committedDate": "2020-04-15T12:51:13Z", "message": "refactor to extend xml validator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f53418214e63763b32f77e59f0fac8faf89f1c9", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/1f53418214e63763b32f77e59f0fac8faf89f1c9", "committedDate": "2020-04-15T12:51:13Z", "message": "extend XmlContentValidator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75863594691ceea363f107a79ef7a7b7fd3ca0a0", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/75863594691ceea363f107a79ef7a7b7fd3ca0a0", "committedDate": "2020-04-15T12:51:13Z", "message": "refactor to extend AbstractArtifactTypeUtilProvider"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd54deed7b1bfaf46844bcca59a45f0846b74770", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/fd54deed7b1bfaf46844bcca59a45f0846b74770", "committedDate": "2020-04-14T13:50:55Z", "message": "refactor to extend AbstractArtifactTypeUtilProvider"}, "afterCommit": {"oid": "75863594691ceea363f107a79ef7a7b7fd3ca0a0", "author": {"user": null}, "url": "https://github.com/Apicurio/apicurio-registry/commit/75863594691ceea363f107a79ef7a7b7fd3ca0a0", "committedDate": "2020-04-15T12:51:13Z", "message": "refactor to extend AbstractArtifactTypeUtilProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63bded44234111a201b7f02c8a7d6265ed134305", "author": {"user": {"login": "EricWittmann", "name": "Eric Wittmann"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/63bded44234111a201b7f02c8a7d6265ed134305", "committedDate": "2020-04-15T17:47:17Z", "message": "Some pom.xml fixes\n\nRestored some missing properties and removed some duplicates."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06e25c03f409a8d88e4a76626db8be1c33faa0df", "author": {"user": {"login": "EricWittmann", "name": "Eric Wittmann"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/06e25c03f409a8d88e4a76626db8be1c33faa0df", "committedDate": "2020-04-15T17:51:05Z", "message": "Reverted the pom.xml file to base and re-added deps\n\nShould be no changes other than adding wsdl4j and xmlsec dependencies."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3450, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}