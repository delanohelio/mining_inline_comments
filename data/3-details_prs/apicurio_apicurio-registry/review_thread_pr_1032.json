{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3MzQzOTQx", "number": 1032, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTozNTo0M1rOE-taDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTo1NzozOFrOE-uEeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MTkxMTE4OnYy", "diffSide": "RIGHT", "path": "app/src/main/resources/application.properties", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTozNTo0M1rOH8AqYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwMDozNDo0MlrOH90BCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NzQ1OQ==", "bodyText": "Can you iterate on this to match the description in the security ADR?  The roles defined there are a bit different than what we have here.  Also you'll need to make sure we're protecting both compatibility APIs as well (ccompat and ibmcompat).", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r532687459", "createdAt": "2020-11-30T15:35:43Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/resources/application.properties", "diffHunk": "@@ -78,3 +78,41 @@ mp.openapi.servers=/api\n %prod.registry.events.kafka.config.enable.idempotence=true\n %prod.registry.events.kafka.config.retries=3\n %prod.registry.events.kafka.config.acks=all\n+\n+#Auth - disabled by default\n+\n+quarkus.oidc.enabled=true\n+quarkus.oidc.tenant-enabled=${AUTH_ENABLED:false}\n+\n+registry.keycloak.url=${KEYCLOAK_URL:https://studio-auth.apicur.io/auth}\n+registry.keycloak.realm=${KEYCLOAK_REALM:apicurio-local}\n+\n+quarkus.oidc.auth-server-url=${registry.keycloak.url}/realms/${registry.keycloak.realm}\n+quarkus.oidc.client-id=${KEYCLOAK_API_CLIENT_ID:registry-api}\n+\n+registry.ui.config.auth.keycloak.url=${registry.keycloak.url}\n+registry.ui.config.auth.keycloak.realm=${registry.keycloak.realm}\n+registry.ui.config.auth.keycloak.clientId=${KEYCLOAK_UI_CLIENT_ID:apicurio-registry}\n+registry.ui.config.auth.keycloak.onLoad=login-required\n+\n+quarkus.http.auth.policy.read-policy.roles-allowed=registry-user,registry-admin\n+quarkus.http.auth.permission.user.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.user.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.user.policy=read-policy\n+quarkus.http.auth.permission.user.methods=GET,HEAD\n+\n+quarkus.http.auth.policy.modify-policy.roles-allowed=registry-admin\n+quarkus.http.auth.permission.admin.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.admin.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.admin.policy=modify-policy\n+quarkus.http.auth.permission.admin.methods=PUT,POST,DELETE,PATCH\n+\n+quarkus.http.auth.permission.permit1.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.permit1.paths=/health,/openapi,/metrics/*\n+quarkus.http.auth.permission.permit1.policy=permit\n+quarkus.http.auth.permission.permit1.methods=GET\n+\n+quarkus.http.auth.permission.authenticated.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.authenticated.paths=/api/*\n+quarkus.http.auth.permission.authenticated.policy=authenticated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA5ODA0Ng==", "bodyText": "I have adapted the permissions and tested the compatibility APIs.", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r534098046", "createdAt": "2020-12-02T11:33:17Z", "author": {"login": "carlesarnal"}, "path": "app/src/main/resources/application.properties", "diffHunk": "@@ -78,3 +78,41 @@ mp.openapi.servers=/api\n %prod.registry.events.kafka.config.enable.idempotence=true\n %prod.registry.events.kafka.config.retries=3\n %prod.registry.events.kafka.config.acks=all\n+\n+#Auth - disabled by default\n+\n+quarkus.oidc.enabled=true\n+quarkus.oidc.tenant-enabled=${AUTH_ENABLED:false}\n+\n+registry.keycloak.url=${KEYCLOAK_URL:https://studio-auth.apicur.io/auth}\n+registry.keycloak.realm=${KEYCLOAK_REALM:apicurio-local}\n+\n+quarkus.oidc.auth-server-url=${registry.keycloak.url}/realms/${registry.keycloak.realm}\n+quarkus.oidc.client-id=${KEYCLOAK_API_CLIENT_ID:registry-api}\n+\n+registry.ui.config.auth.keycloak.url=${registry.keycloak.url}\n+registry.ui.config.auth.keycloak.realm=${registry.keycloak.realm}\n+registry.ui.config.auth.keycloak.clientId=${KEYCLOAK_UI_CLIENT_ID:apicurio-registry}\n+registry.ui.config.auth.keycloak.onLoad=login-required\n+\n+quarkus.http.auth.policy.read-policy.roles-allowed=registry-user,registry-admin\n+quarkus.http.auth.permission.user.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.user.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.user.policy=read-policy\n+quarkus.http.auth.permission.user.methods=GET,HEAD\n+\n+quarkus.http.auth.policy.modify-policy.roles-allowed=registry-admin\n+quarkus.http.auth.permission.admin.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.admin.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.admin.policy=modify-policy\n+quarkus.http.auth.permission.admin.methods=PUT,POST,DELETE,PATCH\n+\n+quarkus.http.auth.permission.permit1.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.permit1.paths=/health,/openapi,/metrics/*\n+quarkus.http.auth.permission.permit1.policy=permit\n+quarkus.http.auth.permission.permit1.methods=GET\n+\n+quarkus.http.auth.permission.authenticated.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.authenticated.paths=/api/*\n+quarkus.http.auth.permission.authenticated.policy=authenticated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NzQ1OQ=="}, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ2NDAwOQ==", "bodyText": "I think there should be 3 roles, no?\n\nRead-Only\nModify allowed (standard access)\nAdmin (same as above + can modify global rules)\n\nI'm not seeing that here yet.", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r534464009", "createdAt": "2020-12-02T20:35:17Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/resources/application.properties", "diffHunk": "@@ -78,3 +78,41 @@ mp.openapi.servers=/api\n %prod.registry.events.kafka.config.enable.idempotence=true\n %prod.registry.events.kafka.config.retries=3\n %prod.registry.events.kafka.config.acks=all\n+\n+#Auth - disabled by default\n+\n+quarkus.oidc.enabled=true\n+quarkus.oidc.tenant-enabled=${AUTH_ENABLED:false}\n+\n+registry.keycloak.url=${KEYCLOAK_URL:https://studio-auth.apicur.io/auth}\n+registry.keycloak.realm=${KEYCLOAK_REALM:apicurio-local}\n+\n+quarkus.oidc.auth-server-url=${registry.keycloak.url}/realms/${registry.keycloak.realm}\n+quarkus.oidc.client-id=${KEYCLOAK_API_CLIENT_ID:registry-api}\n+\n+registry.ui.config.auth.keycloak.url=${registry.keycloak.url}\n+registry.ui.config.auth.keycloak.realm=${registry.keycloak.realm}\n+registry.ui.config.auth.keycloak.clientId=${KEYCLOAK_UI_CLIENT_ID:apicurio-registry}\n+registry.ui.config.auth.keycloak.onLoad=login-required\n+\n+quarkus.http.auth.policy.read-policy.roles-allowed=registry-user,registry-admin\n+quarkus.http.auth.permission.user.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.user.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.user.policy=read-policy\n+quarkus.http.auth.permission.user.methods=GET,HEAD\n+\n+quarkus.http.auth.policy.modify-policy.roles-allowed=registry-admin\n+quarkus.http.auth.permission.admin.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.admin.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.admin.policy=modify-policy\n+quarkus.http.auth.permission.admin.methods=PUT,POST,DELETE,PATCH\n+\n+quarkus.http.auth.permission.permit1.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.permit1.paths=/health,/openapi,/metrics/*\n+quarkus.http.auth.permission.permit1.policy=permit\n+quarkus.http.auth.permission.permit1.methods=GET\n+\n+quarkus.http.auth.permission.authenticated.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.authenticated.paths=/api/*\n+quarkus.http.auth.permission.authenticated.policy=authenticated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NzQ1OQ=="}, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUxNjkxNA==", "bodyText": "I think that you have reviewed an outdated version of the file. I've added the three requires roles. You can see that here", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r534516914", "createdAt": "2020-12-02T22:12:50Z", "author": {"login": "carlesarnal"}, "path": "app/src/main/resources/application.properties", "diffHunk": "@@ -78,3 +78,41 @@ mp.openapi.servers=/api\n %prod.registry.events.kafka.config.enable.idempotence=true\n %prod.registry.events.kafka.config.retries=3\n %prod.registry.events.kafka.config.acks=all\n+\n+#Auth - disabled by default\n+\n+quarkus.oidc.enabled=true\n+quarkus.oidc.tenant-enabled=${AUTH_ENABLED:false}\n+\n+registry.keycloak.url=${KEYCLOAK_URL:https://studio-auth.apicur.io/auth}\n+registry.keycloak.realm=${KEYCLOAK_REALM:apicurio-local}\n+\n+quarkus.oidc.auth-server-url=${registry.keycloak.url}/realms/${registry.keycloak.realm}\n+quarkus.oidc.client-id=${KEYCLOAK_API_CLIENT_ID:registry-api}\n+\n+registry.ui.config.auth.keycloak.url=${registry.keycloak.url}\n+registry.ui.config.auth.keycloak.realm=${registry.keycloak.realm}\n+registry.ui.config.auth.keycloak.clientId=${KEYCLOAK_UI_CLIENT_ID:apicurio-registry}\n+registry.ui.config.auth.keycloak.onLoad=login-required\n+\n+quarkus.http.auth.policy.read-policy.roles-allowed=registry-user,registry-admin\n+quarkus.http.auth.permission.user.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.user.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.user.policy=read-policy\n+quarkus.http.auth.permission.user.methods=GET,HEAD\n+\n+quarkus.http.auth.policy.modify-policy.roles-allowed=registry-admin\n+quarkus.http.auth.permission.admin.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.admin.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.admin.policy=modify-policy\n+quarkus.http.auth.permission.admin.methods=PUT,POST,DELETE,PATCH\n+\n+quarkus.http.auth.permission.permit1.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.permit1.paths=/health,/openapi,/metrics/*\n+quarkus.http.auth.permission.permit1.policy=permit\n+quarkus.http.auth.permission.permit1.methods=GET\n+\n+quarkus.http.auth.permission.authenticated.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.authenticated.paths=/api/*\n+quarkus.http.auth.permission.authenticated.policy=authenticated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NzQ1OQ=="}, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU3NzQxNg==", "bodyText": "You were right, sorry about that.  I was definitely looking at the old stuff.  My bad.", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r534577416", "createdAt": "2020-12-03T00:34:42Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/resources/application.properties", "diffHunk": "@@ -78,3 +78,41 @@ mp.openapi.servers=/api\n %prod.registry.events.kafka.config.enable.idempotence=true\n %prod.registry.events.kafka.config.retries=3\n %prod.registry.events.kafka.config.acks=all\n+\n+#Auth - disabled by default\n+\n+quarkus.oidc.enabled=true\n+quarkus.oidc.tenant-enabled=${AUTH_ENABLED:false}\n+\n+registry.keycloak.url=${KEYCLOAK_URL:https://studio-auth.apicur.io/auth}\n+registry.keycloak.realm=${KEYCLOAK_REALM:apicurio-local}\n+\n+quarkus.oidc.auth-server-url=${registry.keycloak.url}/realms/${registry.keycloak.realm}\n+quarkus.oidc.client-id=${KEYCLOAK_API_CLIENT_ID:registry-api}\n+\n+registry.ui.config.auth.keycloak.url=${registry.keycloak.url}\n+registry.ui.config.auth.keycloak.realm=${registry.keycloak.realm}\n+registry.ui.config.auth.keycloak.clientId=${KEYCLOAK_UI_CLIENT_ID:apicurio-registry}\n+registry.ui.config.auth.keycloak.onLoad=login-required\n+\n+quarkus.http.auth.policy.read-policy.roles-allowed=registry-user,registry-admin\n+quarkus.http.auth.permission.user.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.user.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.user.policy=read-policy\n+quarkus.http.auth.permission.user.methods=GET,HEAD\n+\n+quarkus.http.auth.policy.modify-policy.roles-allowed=registry-admin\n+quarkus.http.auth.permission.admin.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.admin.paths=/api/*,/public/*,/css/*,/js/*,/robots.txt\n+quarkus.http.auth.permission.admin.policy=modify-policy\n+quarkus.http.auth.permission.admin.methods=PUT,POST,DELETE,PATCH\n+\n+quarkus.http.auth.permission.permit1.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.permit1.paths=/health,/openapi,/metrics/*\n+quarkus.http.auth.permission.permit1.policy=permit\n+quarkus.http.auth.permission.permit1.methods=GET\n+\n+quarkus.http.auth.permission.authenticated.enabled=${AUTH_ENABLED:false}\n+quarkus.http.auth.permission.authenticated.paths=/api/*\n+quarkus.http.auth.permission.authenticated.policy=authenticated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NzQ1OQ=="}, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjAxOTc4OnYy", "diffSide": "RIGHT", "path": "storage/kafka/src/test/resources/cluster-test.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTo1NzozOFrOH8BsQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTo1NzozOFrOH8BsQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjcwNDMyMQ==", "bodyText": "This file should probably be deleted - the kafka variant has been removed.", "url": "https://github.com/Apicurio/apicurio-registry/pull/1032#discussion_r532704321", "createdAt": "2020-11-30T15:57:38Z", "author": {"login": "EricWittmann"}, "path": "storage/kafka/src/test/resources/cluster-test.properties", "diffHunk": "@@ -0,0 +1,6 @@\n+\n+initializer=io.apicurio.registry.storage.util.KafkaServiceInitializer\n+node1.props=-Dquarkus.profile=dev -Dbootstrap.servers=${bootstrap.servers} -Dquarkus.oidc.tenant-enabled=false\n+node2.props=-Dquarkus.profile=dev -Dbootstrap.servers=${bootstrap.servers} -Dquarkus.http.port=8081 -Dquarkus.oidc.tenant-enabled=false\n+end.1=Cluster ID:\n+end.2=Resetting offset for partition storage-topic-0 to offset", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e194a317741c0027e07e2e58b459a380a668f24"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3501, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}