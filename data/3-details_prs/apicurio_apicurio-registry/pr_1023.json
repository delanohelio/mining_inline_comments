{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1NTk1MTIy", "number": 1023, "title": "Add support for oauth client credentials flow", "bodyText": "", "createdAt": "2020-11-23T09:40:45Z", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023", "merged": true, "mergeCommit": {"oid": "f2288721805c72cc6b9758484aa32161e80176e5"}, "closed": true, "closedAt": "2020-11-24T18:14:24Z", "author": {"login": "carlesarnal"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfR4SIgH2gAyNTI1NTk1MTIyOmZkMDM5NjM5MjliZWYzNzFjZjRlMGVhNDMzMmNmNDNlODc0Zjc0OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfp-nHgFqTUzNzUwMjY1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fd03963929bef371cf4e0ea4332cf43e874f7497", "author": {"user": {"login": "carlesarnal", "name": "Carles Arnal"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/fd03963929bef371cf4e0ea4332cf43e874f7497", "committedDate": "2020-11-23T09:38:45Z", "message": "Add support for oauth client credentials flow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NTExOTIx", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023#pullrequestreview-536511921", "createdAt": "2020-11-23T14:17:24Z", "commit": {"oid": "fd03963929bef371cf4e0ea4332cf43e874f7497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDoxNzoyNFrOH4PVzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDoxNzoyNFrOH4PVzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODczMzY0Nw==", "bodyText": "This means that if the URL's username/password takes precedence over the inclusion of an Auth.  I'm OK with it if that was your intention.  But I could see an argument that an Auth is more explicit, programmatically, and that it should take precedent over any user/pass info in the URL.  Thoughts?", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023#discussion_r528733647", "createdAt": "2020-11-23T14:17:24Z", "author": {"login": "EricWittmann"}, "path": "rest-client/src/main/java/io/apicurio/registry/client/RegistryRestClientImpl.java", "diffHunk": "@@ -138,6 +140,8 @@ private static OkHttpClient createHttpClientWithConfig(String baseUrl, Map<Strin\n             if (user != null && !user.isEmpty()) {\n                 String credentials = Credentials.basic(user, pwd);\n                 requestHeaders.put(\"Authorization\", credentials);\n+            } else if (auth != null) {\n+                okHttpClientBuilder.addInterceptor(new AuthInterceptor(auth));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd03963929bef371cf4e0ea4332cf43e874f7497"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NTE2OTUy", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023#pullrequestreview-536516952", "createdAt": "2020-11-23T14:22:47Z", "commit": {"oid": "fd03963929bef371cf4e0ea4332cf43e874f7497"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDoyMjo0N1rOH4PkbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDoyMjo0N1rOH4PkbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODczNzM4OQ==", "bodyText": "Let's have another variant of the create() method that takes the Auth instance instead of changing the existing one.  That way you don't have to pass null when you don't have an Auth.", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023#discussion_r528737389", "createdAt": "2020-11-23T14:22:47Z", "author": {"login": "EricWittmann"}, "path": "rest-client/src/main/java/io/apicurio/registry/client/RegistryRestClientFactory.java", "diffHunk": "@@ -20,34 +20,23 @@\n import io.apicurio.registry.auth.Auth;\n import okhttp3.OkHttpClient;\n \n-import java.util.HashMap;\n import java.util.Map;\n \n-import static io.apicurio.registry.client.request.RestClientConfig.REGISTRY_REQUEST_HEADER_AUTHORIZATION;\n-\n \n /**\n  * @author eric.wittmann@gmail.com\n  */\n public class RegistryRestClientFactory {\n \n-\n     public static RegistryRestClient create(String baseUrl) {\n         return new RegistryRestClientImpl(baseUrl);\n     }\n \n-    public static RegistryRestClient create(String baseUrl, Auth auth) {\n-        final Map<String, Object> config = new HashMap<>();\n-        //TODO carnalca for now we only support bearer auth here\n-        config.put(REGISTRY_REQUEST_HEADER_AUTHORIZATION, auth.getAuthStrategy().getToken());\n-        return new RegistryRestClientImpl(baseUrl, config);\n-    }\n-\n     public static RegistryRestClient create(String baseUrl, OkHttpClient okHttpClient) {\n         return new RegistryRestClientImpl(baseUrl, okHttpClient);\n     }\n \n-    public static RegistryRestClient create(String baseUrl, Map<String, Object> configs) {\n-        return new RegistryRestClientImpl(baseUrl, configs);\n+    public static RegistryRestClient create(String baseUrl, Map<String, Object> configs, Auth auth) {\n+        return new RegistryRestClientImpl(baseUrl, configs, auth);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd03963929bef371cf4e0ea4332cf43e874f7497"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7587fed15191db4dd791a575693bddc6d643a7c9", "author": {"user": {"login": "carlesarnal", "name": "Carles Arnal"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/7587fed15191db4dd791a575693bddc6d643a7c9", "committedDate": "2020-11-24T13:30:18Z", "message": "Add basic auth strategy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13a0f036c089090e28cd62217fc60595fe89e0aa", "author": {"user": {"login": "EricWittmann", "name": "Eric Wittmann"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/13a0f036c089090e28cd62217fc60595fe89e0aa", "committedDate": "2020-11-24T13:42:21Z", "message": "Update AbstractKafkaSerDe.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NTAyNjUz", "url": "https://github.com/Apicurio/apicurio-registry/pull/1023#pullrequestreview-537502653", "createdAt": "2020-11-24T13:43:23Z", "commit": {"oid": "13a0f036c089090e28cd62217fc60595fe89e0aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4387, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}