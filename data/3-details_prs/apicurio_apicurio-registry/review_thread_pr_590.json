{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MTEyNzE4", "number": 590, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDo1MDoyMFrOECGgVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMToyMDoxNFrOECHDxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNjM5MTkwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/io/apicurio/registry/storage/impl/AbstractMapRegistryStorage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDo1MDoyMFrOGeWejQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMTowNTo1MVrOGeW9ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ3ODczMw==", "bodyText": "I don't think this is useful meta-data to put on a version.  The artifact has a logical modifiedOn ... but similar to the createdOn value for an artifact, the modifiedOn for an artifact should be the createdOn value of the artifact's most recent version.", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434478733", "createdAt": "2020-06-03T10:50:20Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/storage/impl/AbstractMapRegistryStorage.java", "diffHunk": "@@ -199,8 +200,6 @@ protected ArtifactMetaDataDto createOrUpdateArtifact(String artifactId, Artifact\n         contents.put(MetaDataKeys.CREATED_ON, currentTimeMillis);\n         contents.put(MetaDataKeys.MODIFIED_ON, currentTimeMillis);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ4NjYzNA==", "bodyText": "I can fix it, but nothing has changed regarding the modifiedOn metadata here.", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434486634", "createdAt": "2020-06-03T11:05:51Z", "author": {"login": "carlesarnal"}, "path": "app/src/main/java/io/apicurio/registry/storage/impl/AbstractMapRegistryStorage.java", "diffHunk": "@@ -199,8 +200,6 @@ protected ArtifactMetaDataDto createOrUpdateArtifact(String artifactId, Artifact\n         contents.put(MetaDataKeys.CREATED_ON, currentTimeMillis);\n         contents.put(MetaDataKeys.MODIFIED_ON, currentTimeMillis);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ3ODczMw=="}, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNjQ4MjYxOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/io/apicurio/registry/rest/ArtifactsResourceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMToyMDoxNFrOGeXX3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMToyNDowN1rOGeXe3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ5MzQwNw==", "bodyText": "Doesn't this duplicate the logic in the storage?  It seems like the storage is doing this same work (and I think the storage is where we would want to do this work).", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434493407", "createdAt": "2020-06-03T11:20:14Z", "author": {"login": "EricWittmann"}, "path": "app/src/main/java/io/apicurio/registry/rest/ArtifactsResourceImpl.java", "diffHunk": "@@ -451,6 +453,12 @@ public void deleteArtifactRule(RuleType rule, String artifactId) {\n     @Override\n     public ArtifactMetaData getArtifactMetaData(String artifactId) {\n         ArtifactMetaDataDto dto = storage.getArtifactMetaData(artifactId);\n+\n+        if (dto.getVersion() != ARTIFACT_FIRST_VERSION) {\n+            //Fetch the createdOn value from the first version of the artifact\n+            ArtifactVersionMetaDataDto artifactVersionMetaData = storage.getArtifactVersionMetaData(artifactId, ARTIFACT_FIRST_VERSION);\n+            dto.setCreatedOn(artifactVersionMetaData.getCreatedOn());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ5NTE5Nw==", "bodyText": "Yes, this is part of a previous approach and is something that needs to be removed. Sorry for that.", "url": "https://github.com/Apicurio/apicurio-registry/pull/590#discussion_r434495197", "createdAt": "2020-06-03T11:24:07Z", "author": {"login": "carlesarnal"}, "path": "app/src/main/java/io/apicurio/registry/rest/ArtifactsResourceImpl.java", "diffHunk": "@@ -451,6 +453,12 @@ public void deleteArtifactRule(RuleType rule, String artifactId) {\n     @Override\n     public ArtifactMetaData getArtifactMetaData(String artifactId) {\n         ArtifactMetaDataDto dto = storage.getArtifactMetaData(artifactId);\n+\n+        if (dto.getVersion() != ARTIFACT_FIRST_VERSION) {\n+            //Fetch the createdOn value from the first version of the artifact\n+            ArtifactVersionMetaDataDto artifactVersionMetaData = storage.getArtifactVersionMetaData(artifactId, ARTIFACT_FIRST_VERSION);\n+            dto.setCreatedOn(artifactVersionMetaData.getCreatedOn());\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ5MzQwNw=="}, "originalCommit": {"oid": "9930fe89e5398de0c24d7ac8e6b7c544f128e3d7"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3365, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}