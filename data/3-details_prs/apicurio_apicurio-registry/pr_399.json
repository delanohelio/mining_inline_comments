{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMDQ3OTYz", "number": 399, "title": "Implement JSON Schema compatibility rule. Fixes #373", "bodyText": "This is an implementation of a JSON Schema compatibility checker.", "createdAt": "2020-04-28T11:10:02Z", "url": "https://github.com/Apicurio/apicurio-registry/pull/399", "merged": true, "mergeCommit": {"oid": "0159f7b4cb161a9b4cb4ab3fcfe84dec11c4cc66"}, "closed": true, "closedAt": "2020-05-08T13:31:23Z", "author": {"login": "jsenko"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccUyvSgFqTQwMjQ4ODgyMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfRpfDAH2gAyNDEwMDQ3OTYzOjFjMmExM2MwMzJlN2U5ODQyNjE1M2Y3NjYzNGFmZjA4N2E3ZjVmMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNDg4ODIw", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#pullrequestreview-402488820", "createdAt": "2020-04-29T09:09:29Z", "commit": {"oid": "ee526f99aa6d614e7212f607b13de602c003f926"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwOTowOToyOVrOGN2LMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwOTowOToyOVrOGN2LMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE3MjI3Mg==", "bodyText": "Perhaps move MAPPER init also to this static block.", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#discussion_r417172272", "createdAt": "2020-04-29T09:09:29Z", "author": {"login": "alesj"}, "path": "app/src/main/java/io/apicurio/registry/rules/compatibility/jsonschema/JsonSchemaDiffLibrary.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2019 Red Hat\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.compatibility.jsonschema;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.datatype.jsonorg.JsonOrgModule;\n+import io.apicurio.registry.rules.compatibility.jsonschema.diff.DiffContext;\n+import io.apicurio.registry.rules.compatibility.jsonschema.diff.SchemaDiffVisitor;\n+import org.everit.json.schema.Schema;\n+import org.everit.json.schema.loader.SchemaLoader;\n+import org.json.JSONObject;\n+\n+import static io.apicurio.registry.rules.compatibility.jsonschema.wrapper.WrapUtil.wrap;\n+\n+/**\n+ * @author Jakub Senko <jsenko@redhat.com>\n+ */\n+public class JsonSchemaDiffLibrary {\n+\n+    public static final ObjectMapper MAPPER = new ObjectMapper();\n+\n+    static {\n+        MAPPER.registerModule(new JsonOrgModule());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee526f99aa6d614e7212f607b13de602c003f926"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b60d008916451f2ccd5cc79d24443c37793169eb", "author": {"user": {"login": "jsenko", "name": "Jakub Senko"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/b60d008916451f2ccd5cc79d24443c37793169eb", "committedDate": "2020-05-06T17:38:10Z", "message": "Implement JSON Schema compatibility rule. Fixes #373"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "152ccffbda8ca1a17e7bf2b43bd7d990c74537c4", "author": {"user": {"login": "jsenko", "name": "Jakub Senko"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/152ccffbda8ca1a17e7bf2b43bd7d990c74537c4", "committedDate": "2020-05-06T17:38:10Z", "message": "Detailed tests and bug fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8", "author": {"user": {"login": "jsenko", "name": "Jakub Senko"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/850a562a4a8529deae4426fade3eef2a88720ea8", "committedDate": "2020-05-06T17:38:10Z", "message": "Move constant initialization into static block."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5d7aaf9b05e3527050e68672aaa1d27dc230354", "author": {"user": {"login": "jsenko", "name": "Jakub Senko"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/b5d7aaf9b05e3527050e68672aaa1d27dc230354", "committedDate": "2020-05-06T17:28:49Z", "message": "Move constant initialization into static block."}, "afterCommit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8", "author": {"user": {"login": "jsenko", "name": "Jakub Senko"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/850a562a4a8529deae4426fade3eef2a88720ea8", "committedDate": "2020-05-06T17:38:10Z", "message": "Move constant initialization into static block."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDY5ODQ3", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#pullrequestreview-407469847", "createdAt": "2020-05-07T13:27:44Z", "commit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzoyNzo0NFrOGR-e1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzoyNzo0NFrOGR-e1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMjY3OA==", "bodyText": "Note: Check may be missing here", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#discussion_r421502678", "createdAt": "2020-05-07T13:27:44Z", "author": {"login": "jsenko"}, "path": "app/src/main/java/io/apicurio/registry/rules/compatibility/jsonschema/diff/BooleanSchemaDiffVisitor.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2019 Red Hat\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.rules.compatibility.jsonschema.diff;\n+\n+import io.apicurio.registry.rules.compatibility.jsonschema.JsonSchemaWrapperVisitor;\n+import io.apicurio.registry.rules.compatibility.jsonschema.wrapper.BooleanSchemaWrapper;\n+import org.everit.json.schema.BooleanSchema;\n+\n+/**\n+ * @author Jakub Senko <jsenko@redhat.com>\n+ */\n+public class BooleanSchemaDiffVisitor extends JsonSchemaWrapperVisitor {\n+\n+\n+    private final DiffContext ctx;\n+    private final BooleanSchema original;\n+\n+    public BooleanSchemaDiffVisitor(DiffContext ctx, BooleanSchema original) {\n+        this.ctx = ctx;\n+        this.original = original;\n+    }\n+\n+    @Override\n+    public void visitBooleanSchema(BooleanSchemaWrapper schema) {\n+        super.visitBooleanSchema(schema);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDcxOTY3", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#pullrequestreview-407471967", "createdAt": "2020-05-07T13:30:01Z", "commit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzozMDowMVrOGR-law==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzozMDowMVrOGR-law==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwNDM2Mw==", "bodyText": "Formatting?", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#discussion_r421504363", "createdAt": "2020-05-07T13:30:01Z", "author": {"login": "jsenko"}, "path": "pom.xml", "diffHunk": "@@ -142,6 +142,8 @@\n \n         <!-- JSON Schema Validator -->\n         <medeia-validator-jackson.version>1.1.1</medeia-validator-jackson.version>\n+        <org.everit.json.schema.version>1.12.1</org.everit.json.schema.version><!-- TODO unification -->\n+\t\t<jackson-datatype-json-org.version>2.10.3</jackson-datatype-json-org.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDcyMzc2", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#pullrequestreview-407472376", "createdAt": "2020-05-07T13:30:24Z", "commit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzozMDoyNVrOGR-mgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzozMDoyNVrOGR-mgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwNDY0MA==", "bodyText": "Formatting?", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#discussion_r421504640", "createdAt": "2020-05-07T13:30:25Z", "author": {"login": "jsenko"}, "path": "pom.xml", "diffHunk": "@@ -350,6 +352,16 @@\n                 <artifactId>medeia-validator-jackson</artifactId>\n                 <version>${medeia-validator-jackson.version}</version>\n             </dependency>\n+\t\t\t<dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "850a562a4a8529deae4426fade3eef2a88720ea8"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba2bdab9cf1c303eb687d25e99d1683fa6f09df6", "author": {"user": {"login": "EricWittmann", "name": "Eric Wittmann"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/ba2bdab9cf1c303eb687d25e99d1683fa6f09df6", "committedDate": "2020-05-08T13:11:04Z", "message": "Fixed formatting/indentation in pom.xml file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MjI2NjE5", "url": "https://github.com/Apicurio/apicurio-registry/pull/399#pullrequestreview-408226619", "createdAt": "2020-05-08T13:11:18Z", "commit": {"oid": "ba2bdab9cf1c303eb687d25e99d1683fa6f09df6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c2a13c032e7e98426153f76634aff087a7f5f1c", "author": {"user": {"login": "EricWittmann", "name": "Eric Wittmann"}}, "url": "https://github.com/Apicurio/apicurio-registry/commit/1c2a13c032e7e98426153f76634aff087a7f5f1c", "committedDate": "2020-05-08T13:11:26Z", "message": "Merge branch 'master' into compat-json-schema"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3463, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}