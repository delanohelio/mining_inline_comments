{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0OTIzMjgy", "number": 944, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNTo0N1rODtICiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNzoyNFrODtIFWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NjQ0MjM1OnYy", "diffSide": "RIGHT", "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNTo0N1rOF-Xf4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNTo0N1rOF-Xf4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTAyNA==", "bodyText": "use instanceof", "url": "https://github.com/UNC-Libraries/box-c/pull/944#discussion_r400941024", "createdAt": "2020-03-31T14:05:47Z", "author": {"login": "bbpennel"}, "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "diffHunk": "@@ -87,6 +92,11 @@ private void streamData(String pidString, String datastream, boolean asAttachmen\n         PID pid = PIDs.get(pidString);\n         AccessGroupSet principals = getAgentPrincipals().getPrincipals();\n \n+        RepositoryObject updatedPid = repoObjLoader.getRepositoryObject(pid);\n+        if (updatedPid.getClass() == WorkObject.class) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e0b4c89d0305b4847672445d2f70e55fe1f5bf"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NjQ0NjE5OnYy", "diffSide": "RIGHT", "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNjo0MVrOF-Xiag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNjo0MVrOF-Xiag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTY3NA==", "bodyText": "since this isn't really a pid object, i'd suggest a different variable name", "url": "https://github.com/UNC-Libraries/box-c/pull/944#discussion_r400941674", "createdAt": "2020-03-31T14:06:41Z", "author": {"login": "bbpennel"}, "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "diffHunk": "@@ -87,6 +92,11 @@ private void streamData(String pidString, String datastream, boolean asAttachmen\n         PID pid = PIDs.get(pidString);\n         AccessGroupSet principals = getAgentPrincipals().getPrincipals();\n \n+        RepositoryObject updatedPid = repoObjLoader.getRepositoryObject(pid);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e0b4c89d0305b4847672445d2f70e55fe1f5bf"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NjQ0OTU0OnYy", "diffSide": "RIGHT", "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNzoyNFrOF-XklA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDowNzoyNFrOF-XklA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MjIyOA==", "bodyText": "not all works are guaranteed to have a primary object, so you should check that its null before getting the pid", "url": "https://github.com/UNC-Libraries/box-c/pull/944#discussion_r400942228", "createdAt": "2020-03-31T14:07:24Z", "author": {"login": "bbpennel"}, "path": "access/src/main/java/edu/unc/lib/dl/ui/controller/FedoraContentController.java", "diffHunk": "@@ -87,6 +92,11 @@ private void streamData(String pidString, String datastream, boolean asAttachmen\n         PID pid = PIDs.get(pidString);\n         AccessGroupSet principals = getAgentPrincipals().getPrincipals();\n \n+        RepositoryObject updatedPid = repoObjLoader.getRepositoryObject(pid);\n+        if (updatedPid.getClass() == WorkObject.class) {\n+            pid = ((WorkObject) updatedPid).getPrimaryObject().getPid();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e0b4c89d0305b4847672445d2f70e55fe1f5bf"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 736, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}