{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMTgwNzU4", "number": 967, "title": "BXC-2641/2642 - Tombstone updates", "bodyText": "https://jira.lib.unc.edu/browse/BXC-2641\nhttps://jira.lib.unc.edu/browse/BXC-2642\n\nRetain link from child to parent when transforming objects to tombstones\nTreat tombstones as if they were marked for deletion during ACL checks\nTombstones are now ContentObjects, with indexing disabled\nTombstone PREMIS should be accessible via API now", "createdAt": "2020-04-28T15:08:28Z", "url": "https://github.com/UNC-Libraries/box-c/pull/967", "merged": true, "mergeCommit": {"oid": "2a4cb02b3f0890efeb372f559f87b66e3ce1f4e6"}, "closed": true, "closedAt": "2020-04-29T20:10:27Z", "author": {"login": "bbpennel"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb03PHAH2gAyNDEwMTgwNzU4OjQyNzI3NzNlNzY3ZTA4OTk4YzdkMmE2Y2I1MTEzNzdmNTQ5YzQ1MTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccdvpTgH2gAyNDEwMTgwNzU4OjgwYTZkMTJjYmZlNjdhMzY4OGRkZDZmOWJkNzZmZjBlZTNhNDM3NDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4272773e767e08998c7d2a6cb511377f549c4514", "author": {"user": {"login": "bbpennel", "name": "Ben Pennell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/4272773e767e08998c7d2a6cb511377f549c4514", "committedDate": "2020-04-27T19:57:26Z", "message": "Retain memberOf relationship for tombstones"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77281e36b68a9552201d25552a8e4d20ae6bf957", "author": {"user": {"login": "bbpennel", "name": "Ben Pennell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/77281e36b68a9552201d25552a8e4d20ae6bf957", "committedDate": "2020-04-27T19:57:52Z", "message": "Avoid indexing tombstones"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25440e50225c20870277c32126298b408bffa078", "author": {"user": {"login": "bbpennel", "name": "Ben Pennell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/25440e50225c20870277c32126298b408bffa078", "committedDate": "2020-04-28T12:51:44Z", "message": "Treat permissions to view tombstones the same as marked for deletion. Tombstones are now content objects."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyOTU0MzM3", "url": "https://github.com/UNC-Libraries/box-c/pull/967#pullrequestreview-402954337", "createdAt": "2020-04-29T19:02:27Z", "commit": {"oid": "25440e50225c20870277c32126298b408bffa078"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxOTowMjoyN1rOGOM2Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxOTowMjoyN1rOGOM2Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU0Mzc0Ng==", "bodyText": "Does this need another set of () around it?", "url": "https://github.com/UNC-Libraries/box-c/pull/967#discussion_r417543746", "createdAt": "2020-04-29T19:02:27Z", "author": {"login": "lfarrell"}, "path": "fcrepo-clients/src/main/java/edu/unc/lib/dl/acl/fcrepo4/ObjectAclFactory.java", "diffHunk": "@@ -200,7 +205,8 @@ public void setRepositoryObjectCacheLoader(RepositoryObjectCacheLoader repositor\n             while (it.hasNext()) {\n                 Statement stmt = it.next();\n                 Property property = stmt.getPredicate();\n-                if (CdrAcl.NS.equals(property.getNameSpace())) {\n+                if (CdrAcl.NS.equals(property.getNameSpace())\n+                        || RDF.type.equals(property) && Cdr.Tombstone.equals(stmt.getResource())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25440e50225c20870277c32126298b408bffa078"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80a6d12cbfe67a3688ddd6f9bd76ff0ee3a43747", "author": {"user": {"login": "bbpennel", "name": "Ben Pennell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/80a6d12cbfe67a3688ddd6f9bd76ff0ee3a43747", "committedDate": "2020-04-29T19:35:15Z", "message": "Add parentheses"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2349, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}