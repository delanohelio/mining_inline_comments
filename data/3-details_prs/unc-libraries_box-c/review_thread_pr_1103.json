{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzNDM4MDI3", "number": 1103, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjowOTo0MFrOEv3gkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDowMDo0N1rOEwyCSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NjI3OTg0OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjowOTo0MFrOHlF9EQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjowOTo0MFrOHlF9EQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NjkxMw==", "bodyText": "After checking in with Julie about this, the tag should only appear if the patron permissions are set to something other than the default.\nFor folders/works/files, the default would be either objPatronRoles.size() == 0 OR the authenticated and everyone groups both set to canViewOriginals.\nFor collections, it has to work a little different, we would show patron-settings if objPatronRoles.size() < 2, or eitherauthenticated or everyone groups had any value other than canViewOriginals.\nAnd we can skip this tag altogether for Units.", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r508656913", "createdAt": "2020-10-20T16:09:40Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,7 +106,7 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (objPatronRoles.size() > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9343fbddfabc1b03728a29feccf3bd39a8492bb5"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NjMwNTc0OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/test/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilterTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjoxNDowMlrOHlGNcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjoxNDowMlrOHlGNcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MTEwNw==", "bodyText": "Will probably want to add a test or two to verify that collections get the right patron-settings tag", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r508661107", "createdAt": "2020-10-20T16:14:02Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/test/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilterTest.java", "diffHunk": "@@ -17,6 +17,7 @@\n \n import static edu.unc.lib.dl.acl.util.AccessPrincipalConstants.AUTHENTICATED_PRINC;\n import static edu.unc.lib.dl.acl.util.AccessPrincipalConstants.PUBLIC_PRINC;\n+import static java.util.Arrays.asList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9343fbddfabc1b03728a29feccf3bd39a8492bb5"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MjgzMjg5OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyMTo0M1rOHmGLEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyMTo0M1rOHmGLEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcwOTA3Mg==", "bodyText": "you should do contentObj instanceof AdminUnit instead of retrieving the types and comparing them", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509709072", "createdAt": "2020-10-21T21:21:43Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MjgzODEwOnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyMjo1MVrOHmGOkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyMjo1MVrOHmGOkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcwOTk3MA==", "bodyText": "you can pass the contentObj in instead of rescType, then do contentObj instanceof CollectionObject. Might make sense at some point to add a method to ContentObject to getResourceType or something, which would return the ResourceType. But we probably don't need that here.", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509709970", "createdAt": "2020-10-21T21:22:51Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();\n+        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n+        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+            return false;\n+        }\n+\n+        return hasPatronSettings(contentObj.getPid(), objType);\n+    }\n+\n+    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        int numRoles = objPatronRoles.size();\n+        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5Mjg1MTA2OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyNTo1MlrOHmGXSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyNTo1MlrOHmGXSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcxMjIwMg==", "bodyText": "I'd suggest giving the method a name that indicates that it is evaluating a condition rather than actually performing an addition. Maybe needsPatronSettingsStatus, or merge it with hasPatronSettings", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509712202", "createdAt": "2020-10-21T21:25:52Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5Mjg1MzEyOnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyNjoxNlrOHmGYyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyNjoxNlrOHmGYyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcxMjU4NA==", "bodyText": "you can remove the inner parens", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509712584", "createdAt": "2020-10-21T21:26:16Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();\n+        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n+        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+            return false;\n+        }\n+\n+        return hasPatronSettings(contentObj.getPid(), objType);\n+    }\n+\n+    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        int numRoles = objPatronRoles.size();\n+        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());\n+\n+        if ((!isCollection && numRoles == 0)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5Mjg1NzM5OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMToyNzowOFrOHmGbyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjoxODoyNlrOHme2sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcxMzM1Mg==", "bodyText": "getURI() already returns a string", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509713352", "createdAt": "2020-10-21T21:27:08Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();\n+        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n+        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+            return false;\n+        }\n+\n+        return hasPatronSettings(contentObj.getPid(), objType);\n+    }\n+\n+    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        int numRoles = objPatronRoles.size();\n+        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());\n+\n+        if ((!isCollection && numRoles == 0)) {\n+            return false;\n+        } else if (isCollection && numRoles < 2) {\n+            return true;\n+        }\n+\n+        String canViewOrig = canViewOriginals.getURI().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDExMzQ1OA==", "bodyText": "Seems to return a URI, if the toString isn't added", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r510113458", "createdAt": "2020-10-22T12:18:26Z", "author": {"login": "lfarrell"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();\n+        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n+        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+            return false;\n+        }\n+\n+        return hasPatronSettings(contentObj.getPid(), objType);\n+    }\n+\n+    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        int numRoles = objPatronRoles.size();\n+        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());\n+\n+        if ((!isCollection && numRoles == 0)) {\n+            return false;\n+        } else if (isCollection && numRoles < 2) {\n+            return true;\n+        }\n+\n+        String canViewOrig = canViewOriginals.getURI().toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcxMzM1Mg=="}, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5Mjg3NTE2OnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTozMDoyOFrOHmGnjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTozMDoyOFrOHmGnjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTcxNjM2Ng==", "bodyText": "I'd suggest iterating through the list of roles and returning false if any of them aren't canViewOriginal. There will probably be more than 2 groups in the future, and should have the same affect.", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r509716366", "createdAt": "2020-10-21T21:30:28Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -105,13 +108,45 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (objPrincRoles.size() > 0) {\n+        if (addPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n+    private boolean addPatronSettings(ContentObject contentObj) {\n+        List<String> objTypes = contentObj.getTypes();\n+        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n+        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+            return false;\n+        }\n+\n+        return hasPatronSettings(contentObj.getPid(), objType);\n+    }\n+\n+    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        int numRoles = objPatronRoles.size();\n+        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());\n+\n+        if ((!isCollection && numRoles == 0)) {\n+            return false;\n+        } else if (isCollection && numRoles < 2) {\n+            return true;\n+        }\n+\n+        String canViewOrig = canViewOriginals.getURI().toString();\n+        UserRole roleOne = objPatronRoles.get(0).getRole();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85f1e7cfceebb1fb47935ccc24421a58272baa4"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTg2ODkxOnYy", "diffSide": "RIGHT", "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDowMDo0N1rOHmjSSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDowMDo0N1rOHmjSSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE4NjA1Ng==", "bodyText": "canViewOriginals.getURI() should be sufficient since it returns a string", "url": "https://github.com/UNC-Libraries/box-c/pull/1103#discussion_r510186056", "createdAt": "2020-10-22T14:00:47Z", "author": {"login": "bbpennel"}, "path": "solr-ingest/src/main/java/edu/unc/lib/dl/data/ingest/solr/filter/SetAccessStatusFilter.java", "diffHunk": "@@ -108,43 +108,35 @@ public void setObjectAclFactory(ObjectAclFactory oaf) {\n             status.add(FacetConstants.PUBLIC_ACCESS);\n         }\n \n-        if (addPatronSettings(dip.getContentObject())) {\n+        if (hasPatronSettings(dip.getContentObject())) {\n             status.add(FacetConstants.PATRON_SETTINGS);\n         }\n \n         return status;\n     }\n \n-    private boolean addPatronSettings(ContentObject contentObj) {\n-        List<String> objTypes = contentObj.getTypes();\n-        ResourceType objType = ResourceType.getResourceTypeForUris(objTypes);\n-        if (objType == null || objType.equals(Cdr.AdminUnit.getURI())) {\n+    private boolean hasPatronSettings(ContentObject contentObj) {\n+        if (contentObj instanceof AdminUnit) {\n             return false;\n         }\n \n-        return hasPatronSettings(contentObj.getPid(), objType);\n-    }\n-\n-    private boolean hasPatronSettings(PID pid, ResourceType rescType) {\n-        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(pid);\n+        List<RoleAssignment> objPatronRoles = objAclFactory.getPatronRoleAssignments(contentObj.getPid());\n         int numRoles = objPatronRoles.size();\n-        boolean isCollection = rescType.equals(Cdr.Collection.getLocalName());\n+        boolean isCollection = contentObj instanceof CollectionObject;\n \n-        if ((!isCollection && numRoles == 0)) {\n+        if (!isCollection && numRoles == 0) {\n             return false;\n         } else if (isCollection && numRoles < 2) {\n             return true;\n         }\n \n-        String canViewOrig = canViewOriginals.getURI().toString();\n-        UserRole roleOne = objPatronRoles.get(0).getRole();\n-\n-        if (numRoles > 1) {\n-            UserRole roleTwo = objPatronRoles.get(1).getRole();\n-            return (!roleOne.equals(canViewOrig) || !roleTwo.equals(canViewOrig));\n+        for (RoleAssignment role : objPatronRoles) {\n+            if (!role.getRole().equals(canViewOriginals.getURI().toString())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50dce62b1ed230176e4c693e6707f60dc12c85d"}, "originalPosition": 59}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 573, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}