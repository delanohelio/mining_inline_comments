{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNzgyNDc3", "number": 995, "title": "Add note about max file size and throw an error if file is larger than the max allowed", "bodyText": "https://jira.lib.unc.edu/browse/BXC-2620", "createdAt": "2020-05-20T14:18:38Z", "url": "https://github.com/UNC-Libraries/box-c/pull/995", "merged": true, "mergeCommit": {"oid": "1e9e2d4f80b47013ae873de760e279566d769b73"}, "closed": true, "closedAt": "2020-05-22T20:29:39Z", "author": {"login": "lfarrell"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjJxUngH2gAyNDIwNzgyNDc3OmFmOGQ5NTkzNzMyNjI3ZmMyZTY5MGU0NjJhNTM1MGU0ODk4YWYzMDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcj3tUxgH2gAyNDIwNzgyNDc3OmM3ZTNmODIxNThiMGU4YmEwOTEzNmJmNWJjMjAyNzhkMzc2NjAzMTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "af8d9593732627fc2e690e462a5350e4898af300", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/af8d9593732627fc2e690e462a5350e4898af300", "committedDate": "2020-05-20T14:16:27Z", "message": "Add note about max file size and throw an error if file is larger than the max allowed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33b362c335f55a66b5a150c3fcb1c826a973ae7b", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/33b362c335f55a66b5a150c3fcb1c826a973ae7b", "committedDate": "2020-05-22T15:28:12Z", "message": "Update note and file size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTQ2OTU4", "url": "https://github.com/UNC-Libraries/box-c/pull/995#pullrequestreview-417146958", "createdAt": "2020-05-22T19:36:26Z", "commit": {"oid": "33b362c335f55a66b5a150c3fcb1c826a973ae7b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTozNjoyNlrOGZh7hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxOTozNjoyNlrOGZh7hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQyMzQ5Mg==", "bodyText": "this message doesn't match the size elsewhere", "url": "https://github.com/UNC-Libraries/box-c/pull/995#discussion_r429423492", "createdAt": "2020-05-22T19:36:26Z", "author": {"login": "bbpennel"}, "path": "static/js/admin/src/AbstractFileUploadForm.js", "diffHunk": "@@ -24,20 +24,29 @@ define('AbstractFileUploadForm', [ 'jquery', 'jquery-ui', 'underscore', 'Abstrac\n \tAbstractFileUploadForm.prototype.open = function(resultObject) {\n \t\tvar dialogBox = new ModalCreate(this.options);\n \t\tvar formContents = dialogBox.formContents(resultObject);\n+\t\tvar errors = [];\n+\t\tvar maxFileSize = 1610612736; // 1.5gb\n \t\tvar self = this;\n \t\tthis.closed = false;\n \t\t\n \t\tthis.dialog = $(\"<div class='containingDialog'>\" + formContents + \"</div>\");\n \t\tthis.$form = this.dialog.first();\n \t\tthis.dialog.dialog = dialogBox.modalDialog(this.dialog, self);\n \t\t\n-\t\t$(\"input[type='file']\", this.$form).change(function(){\n+\t\t$(\"input[type='file']\", this.$form).change(function() {\n+\t\t\terrors = []; // reset errors on change\n \t\t\tself.ingestFile = this.files[0];\n \t\t\tif (self.ingestFile) {\n+\t\t\t\tvar fileSize = self.ingestFile.size\n+\n+\t\t\t\tif (fileSize > maxFileSize) {\n+\t\t\t\t\terrors.push(\"The uploaded file is too large. The maximum allowed file size is: 500mb\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b362c335f55a66b5a150c3fcb1c826a973ae7b"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7e3f82158b0e8ba09136bf5bc20278d37660314", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/c7e3f82158b0e8ba09136bf5bc20278d37660314", "committedDate": "2020-05-22T19:47:43Z", "message": "Fix error note"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2382, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}