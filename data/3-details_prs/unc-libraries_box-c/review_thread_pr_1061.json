{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwNTQ2ODI0", "number": 1061, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxMjozMToyMlrOEUlhhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxMjozMToyMlrOEUlhhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMDIxNzY0OnYy", "diffSide": "LEFT", "path": "deposit/src/main/java/edu/unc/lib/deposit/transfer/TransferBinariesToStorageJob.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxMjozMToyMlrOG63qfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNDowNjo1M1rOG6675A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDM4MjU4OQ==", "bodyText": "Do the isObjectCompleted and markObjectCompleted methods in AbstractDepositJob need to be removed?", "url": "https://github.com/UNC-Libraries/box-c/pull/1061#discussion_r464382589", "createdAt": "2020-08-03T12:31:22Z", "author": {"login": "lfarrell"}, "path": "deposit/src/main/java/edu/unc/lib/deposit/transfer/TransferBinariesToStorageJob.java", "diffHunk": "@@ -187,13 +179,38 @@ private void transferDepositManifests(PID objPid, Resource resc, BinaryTransferS\n             }\n \n             PID manifestPid = getDepositManifestPid(objPid, manifestFile.getName());\n+            transferFile(manifestPid, manifestUri, transferSession, resc, CdrDeposit.storageUri);\n+        }\n+    }\n+\n+    private void transferFile(PID binPid, URI stagingUri, BinaryTransferSession transferSession,\n+            Resource resc, Property storageProperty) {\n \n-            if (!isObjectCompleted(manifestPid)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "441deee422c20465b67f96ae3c32857a39183f92"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQzNjE5Ng==", "bodyText": "No, they are still being used by other jobs. It is reasonable to use objectCompleted in cases where the jena model isn't being updated, since those can get lost in cases where the jvm shuts down or the jena transactions are interrupted at the wrong time.", "url": "https://github.com/UNC-Libraries/box-c/pull/1061#discussion_r464436196", "createdAt": "2020-08-03T14:06:53Z", "author": {"login": "bbpennel"}, "path": "deposit/src/main/java/edu/unc/lib/deposit/transfer/TransferBinariesToStorageJob.java", "diffHunk": "@@ -187,13 +179,38 @@ private void transferDepositManifests(PID objPid, Resource resc, BinaryTransferS\n             }\n \n             PID manifestPid = getDepositManifestPid(objPid, manifestFile.getName());\n+            transferFile(manifestPid, manifestUri, transferSession, resc, CdrDeposit.storageUri);\n+        }\n+    }\n+\n+    private void transferFile(PID binPid, URI stagingUri, BinaryTransferSession transferSession,\n+            Resource resc, Property storageProperty) {\n \n-            if (!isObjectCompleted(manifestPid)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDM4MjU4OQ=="}, "originalCommit": {"oid": "441deee422c20465b67f96ae3c32857a39183f92"}, "originalPosition": 109}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 670, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}