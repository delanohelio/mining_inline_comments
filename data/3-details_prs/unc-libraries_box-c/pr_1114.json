{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyOTY0NDgx", "number": 1114, "title": "Transform collections in collections into folders and set parentType destination", "bodyText": "https://jira.lib.unc.edu/browse/BXC-2824\nhttps://jira.lib.unc.edu/browse/BXC-2845", "createdAt": "2020-10-30T12:33:45Z", "url": "https://github.com/UNC-Libraries/box-c/pull/1114", "merged": true, "mergeCommit": {"oid": "5e0b6379d25bb3ecb75e9789c54c80cf1ddc92a7"}, "closed": true, "closedAt": "2020-11-06T20:47:58Z", "author": {"login": "lfarrell"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXm48YgFqTUyMDY3MjY3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZ7HBwgFqTUyNTM4ODAxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNjcyNjc2", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#pullrequestreview-520672676", "createdAt": "2020-10-30T13:35:46Z", "commit": {"oid": "6d10081830de91d7643aa1ec9554d4cafb73ba7d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzozNTo0NlrOHrPS6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzozNTo0NlrOHrPS6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwMTQxOA==", "bodyText": "I don't think this is quite going to work as expected. When we migrate the RLA the isTopLevelAsUnit flag is going to be false in practice, so I think the first if is always going to win for Collections at the moment. Swapping their order would probably work.\nAdditionally, the migration util doesn't seed the parentType parameter with the type of the bxc5 destination. This might be a problem if we end up migrating the RLA or other collections like it in multiple deposits, since it won't be aware the subcollections are going into a collection. It would be prudent to start doing this now, i'll create another ticket for that.", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#discussion_r515101418", "createdAt": "2020-10-30T13:35:46Z", "author": {"login": "bbpennel"}, "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/content/ContentObjectTransformer.java", "diffHunk": "@@ -459,6 +459,8 @@ private Resource getResourceType(Resource bxc3Resc) {\n         if (contentModels.contains(COLLECTION.getResource())) {\n             if (Cdr.AdminUnit.equals(parentType) || !options.isTopLevelAsUnit()) {\n                 return Cdr.Collection;\n+            } else if (Cdr.Collection.equals(parentType)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d10081830de91d7643aa1ec9554d4cafb73ba7d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85f20f2bbe5a50550e575d023a6ebccf2204af66", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/85f20f2bbe5a50550e575d023a6ebccf2204af66", "committedDate": "2020-10-30T17:08:30Z", "message": "Transform collections in collections into folders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9c162f787e48cd11047a9de18bec7b177a494fa", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/f9c162f787e48cd11047a9de18bec7b177a494fa", "committedDate": "2020-10-30T17:08:30Z", "message": "Switch conditional order and add log statement."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d10081830de91d7643aa1ec9554d4cafb73ba7d", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/6d10081830de91d7643aa1ec9554d4cafb73ba7d", "committedDate": "2020-10-30T12:26:37Z", "message": "Transform collections in collections into folders"}, "afterCommit": {"oid": "f9c162f787e48cd11047a9de18bec7b177a494fa", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/f9c162f787e48cd11047a9de18bec7b177a494fa", "committedDate": "2020-10-30T17:08:30Z", "message": "Switch conditional order and add log statement."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "committedDate": "2020-10-30T20:28:58Z", "message": "Set parentType destination"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d169a8020c7ebae1a8bbed5a7b99b72080df24f", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/6d169a8020c7ebae1a8bbed5a7b99b72080df24f", "committedDate": "2020-10-30T20:22:43Z", "message": "Set parentType destination"}, "afterCommit": {"oid": "2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "author": {"user": {"login": "lfarrell", "name": "Dean Farrell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/2fb4d93ebfcf8f45e136c7b7c379ed49025fcf9c", "committedDate": "2020-10-30T20:28:58Z", "message": "Set parentType destination"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a285cad8327c36bdd8f6c165fcb131f4796f6bbd", "author": {"user": {"login": "bbpennel", "name": "Ben Pennell"}}, "url": "https://github.com/UNC-Libraries/box-c/commit/a285cad8327c36bdd8f6c165fcb131f4796f6bbd", "committedDate": "2020-11-06T18:16:42Z", "message": "Move log statement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1Mzg4MDEz", "url": "https://github.com/UNC-Libraries/box-c/pull/1114#pullrequestreview-525388013", "createdAt": "2020-11-06T18:17:26Z", "commit": {"oid": "a285cad8327c36bdd8f6c165fcb131f4796f6bbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2177, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}