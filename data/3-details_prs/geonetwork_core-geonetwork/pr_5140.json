{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNDE3MDQ2", "number": 5140, "title": "Map improvements", "bodyText": "This PR contains several improvements made over the course of several months on Sextant:\nWPS\n\nProcesses containing geometry fields: now supports QGIS server and sends geometries in the view CRS\nSupports asynchronous processes\n\n\nAnnotations\nMany improvements to the Draw tool in the map viewer:\n\nrefactored logic to handle text similarly to other styles (point, line, polygon),\nallow for a custom save callback to allow using the tool in other places,\nbetter layout\n\n\nMap service\n\nFix for WMTS without OperationsMetadata element in capabilities\nPrevent adding the same layer multiple times if no style provided\n\n\n\nBetter parse layer names with multiple : in it\n\nPrint\n\nXYZ layers / Add support for different url layouts that z/x/y\n\n\n\nLegend / Add support for accented chars taken from the capabilities doc (happens with Qgis server sometimes)\n\nWFS features indexing\nA general backport of all frontend features related to WFS indexing:\n\nWFS filters in the map viewer,\n\n\n\nWFS indexing in the admin console\n\n\n\nAdd support for regular scheduling of harvesting tasks\n\n\n\nAdd support for QGIS Server\nAdd relax match on typename without namespace\nMore testing with GeoServer, MapServer (you should be able to harvest a WMS and if an equivalent WFS service is available with same layernames it should work easily)\n\nEditor\n\nDirectory / improve layout for entry selector modal (better overflow of facets, button on the right)\nHarvested record are editable based on admin config.", "createdAt": "2020-10-29T16:49:03Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140", "merged": true, "mergeCommit": {"oid": "1567c170b64abaf46c46db8d72829f94a8e2e18e"}, "closed": true, "closedAt": "2020-11-03T16:41:17Z", "author": {"login": "jahow"}, "timelineItems": {"totalCount": 41, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXR6_ngH2gAyNTEyNDE3MDQ2OjJjMGM2YzdiNWY3MzkyYmY0ZWE0ZDhlNWFlMTllMWExZTAyMzZiMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY7b7HgFqTUyMjY0OTc3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2c0c6c7b5f7392bf4ea4d8e5ae19e1a1e0236b12", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/2c0c6c7b5f7392bf4ea4d8e5ae19e1a1e0236b12", "committedDate": "2020-10-29T13:10:19Z", "message": "WPS / handle point geometries for QGis server\n\nAlso avoid triggering a GFI call when drawing a point with GeometryDirective"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a900d9140d4cefc6b2524d11004868b4533f35e", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/6a900d9140d4cefc6b2524d11004868b4533f35e", "committedDate": "2020-10-29T13:10:19Z", "message": "WPS / send geometries in the map view CRS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ce761abc4a789b54af7ca71bac51e24161a3603", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/6ce761abc4a789b54af7ca71bac51e24161a3603", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / draw directive takes an optional callback\n\nThis can be leveraged to use the directive for something else\nthan exporting a file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3ae184de3f3e6e3aa200a8a10bd523c6a661d64", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/c3ae184de3f3e6e3aa200a8a10bd523c6a661d64", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / allow undefined save callback in draw directive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd655f4bfe397502746bf38d3de42d5db4fd6002", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/bd655f4bfe397502746bf38d3de42d5db4fd6002", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / Allow saving even on empty source if save callback defined"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b1953a8d4ff0b306b6063e4743ac72bcff2acf2", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/1b1953a8d4ff0b306b6063e4743ac72bcff2acf2", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / make the draw options layout more compact"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b732cc79d4e1575fc5df484d0fec77b7586270c", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/8b732cc79d4e1575fc5df484d0fec77b7586270c", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / refactor to allow modifying text and simplify logic\n\nNow the text content is treated like any other style property,\nand not as a separate field (scope.text) directly on the gn-draw directive.\n\nThere is no need to store the text in the 'name' field of features anymore.\n\nOn the other hand, the object type (text, point, line, polygon) is stored\non the features '_type' property. This is actually not necessary for lines\nand polygons, but it is to discriminate text and points (since the geometry\ntype is the same).\n\nFor backwards compatibility, if a JSON file is loaded with features in the\nprevious schema, they will be adapted to the new one."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6b4b9386d76f7a80a39740b9a5a6b67dfe8c3e9", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/d6b4b9386d76f7a80a39740b9a5a6b67dfe8c3e9", "committedDate": "2020-10-29T13:10:19Z", "message": "Draw / fix text input in style form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7594e5454d5bb54bf16ebd39a0da4f1580ad9dd7", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/7594e5454d5bb54bf16ebd39a0da4f1580ad9dd7", "committedDate": "2020-10-29T13:10:19Z", "message": "IndexRequest / fix array unique filter in index request builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49586adf3d29d3d6bccc039c66092c5b20c33951", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/49586adf3d29d3d6bccc039c66092c5b20c33951", "committedDate": "2020-10-29T13:10:19Z", "message": "Md View / prepend current URL path for MD links in search results\n\nWithout this, opening a record in a webpage with a <base> element\nmight route the user to a wrong URL."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f57612fa2db0278170a5fd9d47810f5958fe6480", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f57612fa2db0278170a5fd9d47810f5958fe6480", "committedDate": "2020-10-29T13:10:19Z", "message": "Map / Allow adding a WMTS layer from cap without OperationsMetadata in it\n\nthe OperationsMetadata element might not be present in the WMTS capabilities\nwhich requires a work around for getting layer and capabilities url."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e2c8064660ef127a955de763b8451ae886df900", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/1e2c8064660ef127a955de763b8451ae886df900", "committedDate": "2020-10-29T13:10:19Z", "message": "Map / prevent adding several times the same layer when not specifying style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c017aaa8c0ad7ec729519a9f5f5b6c5e131220c2", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/c017aaa8c0ad7ec729519a9f5f5b6c5e131220c2", "committedDate": "2020-10-29T15:48:01Z", "message": "Map / handle layer names with multiple ':'\n\nWithout this commit, a layername such as namespace:domainABC:layer would\nnot be correctly found in the Capabilities document since only the 'layer'\npart would be kept for comparison"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd9269834b7e3bbcc98d44be641b489d5c89855f", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/dd9269834b7e3bbcc98d44be641b489d5c89855f", "committedDate": "2020-10-29T15:48:01Z", "message": "Editor / improve add directory entry modal layout\n\nAdd button is on the right and facets are now scrollable on their own."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d5ae14126919ecdef2ac4aeeed94d103ba6f35f", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/4d5ae14126919ecdef2ac4aeeed94d103ba6f35f", "committedDate": "2020-10-29T15:48:01Z", "message": "Print / remove reference to MapQuest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cce397eb836e0a94d5039c3ac920d28d8cdb18a6", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/cce397eb836e0a94d5039c3ac920d28d8cdb18a6", "committedDate": "2020-10-29T15:48:01Z", "message": "Print / handle XYZ layers with a different path format (e.g. z/y/x)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03700bb4d5764abf438846e79ec2d7300c800f60", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/03700bb4d5764abf438846e79ec2d7300c800f60", "committedDate": "2020-10-29T15:48:01Z", "message": "Print / handle legend URLs with accented chars in it\n\nThe legend url is converted to a URL object to ensure\nproper formatting."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45f5138f48cd2676814acbc41fa2585ce09984e2", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/45f5138f48cd2676814acbc41fa2585ce09984e2", "committedDate": "2020-10-29T15:48:01Z", "message": "Wro4j / reorder bs-table extensions to avoid CSV export not showing in tables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "132b773d796e7ebca5cb9c9dc82e79fb8eef1e3c", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/132b773d796e7ebca5cb9c9dc82e79fb8eef1e3c", "committedDate": "2020-10-29T15:48:01Z", "message": "Utility / Fix thumbnail modal not working for records using draft mode\n\nRecords in draft would sometimes have their thumbnail url appended\nwith ?approved=... , which breaks thumbnail modal opening."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b283eb79c2c10409145e2b913d55733f5e7ddd8", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/1b283eb79c2c10409145e2b913d55733f5e7ddd8", "committedDate": "2020-10-29T13:59:54Z", "message": "Backports of WFS filter & indexing (admin) from Sextant"}, "afterCommit": {"oid": "f84804c3da670c59cd37f1394e40228fd6f950ea", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f84804c3da670c59cd37f1394e40228fd6f950ea", "committedDate": "2020-10-29T15:53:52Z", "message": "Wro4j / remove remaining ref to closure lib\n\nclosure/base.js will still be used in debug mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a9ff2350226aa9403fb1de67639d793621cd961", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/5a9ff2350226aa9403fb1de67639d793621cd961", "committedDate": "2020-10-29T16:54:45Z", "message": "Backports of WFS filter & indexing (admin) from Sextant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f695a84a4a7e16cd14673da63c368bdf5fb221bb", "committedDate": "2020-10-29T16:54:45Z", "message": "Wro4j / remove remaining ref to closure lib\n\nclosure/base.js will still be used in debug mode"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f84804c3da670c59cd37f1394e40228fd6f950ea", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f84804c3da670c59cd37f1394e40228fd6f950ea", "committedDate": "2020-10-29T15:53:52Z", "message": "Wro4j / remove remaining ref to closure lib\n\nclosure/base.js will still be used in debug mode"}, "afterCommit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb", "author": {"user": {"login": "jahow", "name": "Olivier Guyot"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f695a84a4a7e16cd14673da63c368bdf5fb221bb", "committedDate": "2020-10-29T16:54:45Z", "message": "Wro4j / remove remaining ref to closure lib\n\nclosure/base.js will still be used in debug mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNTg1NDg0", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521585484", "createdAt": "2020-11-02T12:31:13Z", "commit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjozMToxM1rOHsCarQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjozMToxM1rOHsCarQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTkzODk4OQ==", "bodyText": "this sounds highly related to sextant no?", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r515938989", "createdAt": "2020-11-02T12:31:13Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/partials/wfsfilterfacet.html", "diffHunk": "@@ -95,11 +95,16 @@ <h5 gn-collapsible=\"indexObject.geomField.expanded\">\n     <!--admin buttons-->\n     <div class=\"btn-group dropup wfs-filter-group\">\n       <button class=\"btn btn-default btn-xs\" ng-class=\"{ disabled: !filtersChanged }\"\n-        data-gn-click-and-spin=\"filterWMS()\"\n-        data-gn-click-and-spin-stay-disabled=\"true\">\n+              data-gn-click-and-spin=\"filterWMS()\"\n+              data-gn-click-and-spin-stay-disabled=\"true\">\n         <i class=\"fa fa-filter\"></i>&nbsp;\n         <span data-translate=\"\">applyFilter</span>\n       </button>\n+      <button  ng-if=\"::sextant\" class=\"btn btn-default btn-xs\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "originalPosition": 73}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNTk4Mjgw", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521598280", "createdAt": "2020-11-02T12:50:42Z", "commit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjo1MDo0MlrOHsDClQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjo1MDo0MlrOHsDClQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk0OTIwNQ==", "bodyText": "Same here, looks to be used in Sextant for something else\n\n          // SEXTANT SPECIFIC\n          // use nested wms if we're in a group\n          if (scope.baseLayer.get('originalWms')) {\n            scope.layer = scope.baseLayer.get('originalWms');\n          } else {\n            scope.layer = scope.baseLayer\n          }\n          // END SEXTANT SPECIFIC\n\nCurrently layer is never set ... maybe we should add some config to handle both strategies.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r515949205", "createdAt": "2020-11-02T12:50:42Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/WfsFilterDirective.js", "diffHunk": "@@ -110,24 +110,29 @@\n     'wfsFilterService',\n     '$q',\n     '$rootScope',\n+    '$translate',\n     'gnIndexRequestManager',\n     'gnIndexService',\n     'gnGlobalSettings',\n     'gnSearchSettings',\n     'gnFeaturesTableManager',\n-    function($http, wfsFilterService, $q, $rootScope,\n+    'gnHttp',\n+    'gnAlertService',\n+    'gnFacetTree',\n+    function($http, wfsFilterService, $q, $rootScope, $translate,\n              gnIndexRequestManager, gnIndexService, gnGlobalSettings,\n-             gnSearchSettings, gnFeaturesTableManager) {\n+             gnSearchSettings, gnFeaturesTableManager, gnHttp,\n+             gnAlertService, gnFacetTree) {\n       return {\n         restrict: 'A',\n         replace: true,\n         templateUrl: '../../catalog/components/viewer/wfsfilter/' +\n-            'partials/wfsfilterfacet.html',\n+          'partials/wfsfilterfacet.html',\n         scope: {\n           featureTypeName: '@',\n           wfsUrl: '@',\n           displayCount: '@',\n-          layer: '='\n+          baseLayer: '=layer'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjAzMjAw", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521603200", "createdAt": "2020-11-02T12:57:37Z", "commit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjo1NzozN1rOHsDRzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMjo1NzozN1rOHsDRzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk1MzEwMA==", "bodyText": "No, if version 4, you don't need this function call.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r515953100", "createdAt": "2020-11-02T12:57:37Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/WfsFilterDirective.js", "diffHunk": "@@ -193,28 +200,29 @@\n                 scope.wfsUrl || scope.layer.get('url').replace(/wms/i, 'wfs'))\n             });\n \n-            uuid = scope.md && scope.md.uuid;\n+            uuid = scope.md && scope.md.getUuid();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f695a84a4a7e16cd14673da63c368bdf5fb221bb"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2519c3c30710b49628de9e0ee40a64b93b6cd2e6", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/2519c3c30710b49628de9e0ee40a64b93b6cd2e6", "committedDate": "2020-11-02T13:00:15Z", "message": "WFS indexing / Fix UI init."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjA4MDUw", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521608050", "createdAt": "2020-11-02T13:04:12Z", "commit": {"oid": "2519c3c30710b49628de9e0ee40a64b93b6cd2e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzowNDoxMlrOHsDfmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzowNDoxMlrOHsDfmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk1NjYzMg==", "bodyText": "Do not reintroduce version number in API path. In version 4, the API version is GN version. Version in path has been removed.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r515956632", "createdAt": "2020-11-02T13:04:12Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/WfsFilterService.js", "diffHunk": "@@ -195,12 +276,12 @@\n        * @param {string} wfsUrl url of the wfs service\n        */\n       this.getApplicationProfile = function(uuid, ftName, wfsUrl, protocol) {\n-        return $http.post('../api/records/' + uuid +\n-            '/query/wfs-indexing-config', {\n-              url: wfsUrl,\n-              name: ftName,\n-              protocol: protocol\n-            });\n+        return $http.post('../api/0.1/records/' + uuid +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2519c3c30710b49628de9e0ee40a64b93b6cd2e6"}, "originalPosition": 205}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjQxODEx", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521641811", "createdAt": "2020-11-02T13:48:18Z", "commit": {"oid": "2519c3c30710b49628de9e0ee40a64b93b6cd2e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzo0ODoxOFrOHsFCkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzo0ODoxOFrOHsFCkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk4MTk2OQ==", "bodyText": "Maybe we should continue to support both approach. md and Linkstree field may not be defined. Will rework it with a promise.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r515981969", "createdAt": "2020-11-02T13:48:18Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/WfsFilterDirective.js", "diffHunk": "@@ -712,15 +816,31 @@\n            * Only available for administrators.\n            */\n           scope.indexWFSFeatures = function(version) {\n-            appProfilePromise.then(function() {\n-              wfsFilterService.indexWFSFeatures(\n-                  scope.url,\n-                  ftName,\n-                  appProfile ? appProfile.tokenizedFields : null,\n-                  appProfile ? appProfile.treeFields : null,\n-                  uuid,\n-                  version);\n-            });\n+            var applicationProfile = scope.md.linksTree.map(function (d) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2519c3c30710b49628de9e0ee40a64b93b6cd2e6"}, "originalPosition": 510}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6991fffabc8566339c48cb8b23b919d259dbe9b8", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/6991fffabc8566339c48cb8b23b919d259dbe9b8", "committedDate": "2020-11-02T15:55:19Z", "message": "WFS indexing / Remove version number from API path. Use a promise for appProfile if no linksTree field. Fix non existing constant."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d988b92b304d4e670866f9be993fcdfc11b7d29", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/4d988b92b304d4e670866f9be993fcdfc11b7d29", "committedDate": "2020-11-02T15:58:02Z", "message": "WFS indexing / Fix delete and backport changes on date type."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNzgxMzMz", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-521781333", "createdAt": "2020-11-02T16:18:28Z", "commit": {"oid": "6991fffabc8566339c48cb8b23b919d259dbe9b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoxODoyOFrOHsLdkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoxODoyOFrOHsLdkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA4NzE4Nw==", "bodyText": "Maybe we should add the missing entries here? \n  \n    \n      core-geonetwork/web-ui/src/main/resources/catalog/components/catalog/CatalogService.js\n    \n    \n         Line 321\n      in\n      6991fff\n    \n    \n    \n    \n\n        \n          \n           indexproxy: '../../index/records' \n        \n    \n  \n\n\nInstead of writing down a hardcoded url.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#discussion_r516087187", "createdAt": "2020-11-02T16:18:28Z", "author": {"login": "jahow"}, "path": "web-ui/src/main/resources/catalog/components/viewer/wfsfilter/WfsFilterDirective.js", "diffHunk": "@@ -991,7 +980,7 @@\n           }\n \n           // check whether the WFS service is already in the database\n-          scope.messageProducersApiUrl = gnHttp.getService('wfsMessageProducers');\n+          scope.messageProducersApiUrl = '../api/msg_producers';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6991fffabc8566339c48cb8b23b919d259dbe9b8"}, "originalPosition": 67}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5564f93fae7881dfebfe657c2a52ed4c1129fdd7", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/5564f93fae7881dfebfe657c2a52ed4c1129fdd7", "committedDate": "2020-11-02T21:00:07Z", "message": "WFS Indexing / Dashboard to start/stop/schedule harvesting.\n\n* Fix URL containing special character\n* Add missing translations\n* Use similar icons used in other app pages eg. start/remove...\n* AppProfile may be empty or null\n* Migrate code to JPA update and OpenAPI\n\nInitially done by @cmangeat for Ifremer/Sextant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1997f409e7b340a2d42cf3f0607d9048939b98e0", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/1997f409e7b340a2d42cf3f0607d9048939b98e0", "committedDate": "2020-11-03T09:49:44Z", "message": "WFS Indexing / Add custom WFSClient to use GFI target namespace to define the strategy.\n\nThis allows to support QGIS.\nTested with GeoServer, MapServer and QGIS.\nIf typename not found, make a check without taking into account namespace."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49a6af1e6babc323194f226668e1702eeb38e223", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/49a6af1e6babc323194f226668e1702eeb38e223", "committedDate": "2020-11-03T11:10:05Z", "message": "Harvested records / Editable depending on config."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86e3f87ff3ec0776e20384b22f810483e2ef9864", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/86e3f87ff3ec0776e20384b22f810483e2ef9864", "committedDate": "2020-11-03T12:49:04Z", "message": "WFS Indexing / Parameters may be fine tuned using applicationProfile. Restore retreival of applicationProfile ..."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a009863c373047a5a7a70baeda6e9705f93f11b", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/7a009863c373047a5a7a70baeda6e9705f93f11b", "committedDate": "2020-11-03T13:12:46Z", "message": "WFS Indexing / Parameters may be fine tuned using applicationProfile. Restore retreival of applicationProfile ... / Missing changes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42581abbaa7df551f064e9697be66108bee7dcf2", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/42581abbaa7df551f064e9697be66108bee7dcf2", "committedDate": "2020-11-03T13:18:52Z", "message": "WFS Indexing / Do not log an error on report UPDATE which is fine."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90dd98aff6fd258484af8638d0c036fb7ac72898", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/90dd98aff6fd258484af8638d0c036fb7ac72898", "committedDate": "2020-11-03T13:56:16Z", "message": "WFS Indexing / Save strategy with job properties."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8659cd65a6445d92d559f3b0b313ce6c6affdd96", "author": {"user": {"login": "fxprunayre", "name": "Fran\u00e7ois Prunayre"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/8659cd65a6445d92d559f3b0b313ce6c6affdd96", "committedDate": "2020-11-03T15:08:09Z", "message": "WFS Indexing / Update test - JPA, Autowire required bean."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNjQ5Nzc5", "url": "https://github.com/geonetwork/core-geonetwork/pull/5140#pullrequestreview-522649779", "createdAt": "2020-11-03T16:06:19Z", "commit": {"oid": "8659cd65a6445d92d559f3b0b313ce6c6affdd96"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1767, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}