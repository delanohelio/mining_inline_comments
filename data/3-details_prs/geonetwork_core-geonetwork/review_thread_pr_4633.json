{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4Mzk5MTc4", "number": 4633, "reviewThreads": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTo0NDo1MVrOD1sF_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzo1MlrOD1uO2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjIzNTQ5OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTo0NDo1MVrOGLPkZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTo0NDo1MVrOGLPkZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ0MjU5Ng==", "bodyText": "typo", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414442596", "createdAt": "2020-04-24T09:44:51Z", "author": {"login": "fxprunayre"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -4,7 +4,7 @@\n  * and United Nations Environment Programme (UNEP)\n  *\n  * This program is free software; you can redistribute it and/or modify\n- * it under the terms of the GNU General Public License as published by\n+ * it under the terms of thgroupLengthNotMatchProfileLengthe GNU General Public License as published by", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc02a61a7769e47ef297a9e7b097fb7db82afc85"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU0MzYyOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowMjozOFrOGLSXqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNjo1Mjo0MFrOGMTfvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ4ODQ4OQ==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414488489", "createdAt": "2020-04-24T11:02:38Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -95,20 +98,47 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\tString username = getHeader(req, config.getUsernameKey(), \"\");\n \t\tString surname = getHeader(req, config.getSurnameKey(), \"\");\n \t\tString firstname = getHeader(req, config.getFirstnameKey(), \"\");\n+        String organisation = getHeader(req, config.getOrganisationKey(), \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU1NTUxNg==", "bodyText": "In the IDE looks fine, but showing whitespace chars, the file has a mix of spaces/tabs, fixing it to replace with spaces.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r415555516", "createdAt": "2020-04-27T06:52:40Z", "author": {"login": "josegar74"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -95,20 +98,47 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\tString username = getHeader(req, config.getUsernameKey(), \"\");\n \t\tString surname = getHeader(req, config.getSurnameKey(), \"\");\n \t\tString firstname = getHeader(req, config.getFirstnameKey(), \"\");\n+        String organisation = getHeader(req, config.getOrganisationKey(), \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ4ODQ4OQ=="}, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU1NjY2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNjowOFrOGLSfFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNjowOFrOGLSfFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5MDM4OA==", "bodyText": "You can init this with groups.length size.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414490388", "createdAt": "2020-04-24T11:06:08Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -95,20 +98,47 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\tString username = getHeader(req, config.getUsernameKey(), \"\");\n \t\tString surname = getHeader(req, config.getSurnameKey(), \"\");\n \t\tString firstname = getHeader(req, config.getFirstnameKey(), \"\");\n+        String organisation = getHeader(req, config.getOrganisationKey(), \"\");\n \t\tString email = getHeader(req, config.getEmailKey(), \"\");\n \t\tString arraySeparator = config.getArraySeparator();\n-\n-\t\tString profile_header = getHeader(req, config.getProfileKey(), Profile.Guest.name());\n-\t\tString[] profiles = new String[0];\n-\t\tif (!StringUtils.isEmpty(profile_header)) {\n-\t\t\tprofiles = profile_header.split(arraySeparator);\n-\t\t}\n-\n-\t\tString group_header = getHeader(req, config.getGroupKey(), config.getDefaultGroup());\n-\t\tString[] groups = new String[0];\n-\t\tif (!StringUtils.isEmpty(group_header)) {\n-\t\t\tgroups = group_header.split(arraySeparator);\n-\t\t}\n+\t\tString roleGroupSeparator = config.getRoleGroupSeparator();\n+\n+        // RoleGroupKey header format: sample,UserAdmin;sample,Editor\n+        // It has precedence over individual ProfileKey and GroupKey headers if all are provided.\n+        //      - ProfileKey header format: UserAdmin;Editor\n+        //      - GroupKey header format: sample;sample\n+        String roleGroup_header = getHeader(req, config.getRoleGroupKey(), \"\");\n+        String[] roleGroups = new String[0];\n+        if (!StringUtils.isEmpty(roleGroup_header)) {\n+            roleGroups = roleGroup_header.split(arraySeparator);\n+        } else {\n+            String profile_header = getHeader(req, config.getProfileKey(), Profile.Guest.name());\n+            String[] profiles = new String[0];\n+            if (!StringUtils.isEmpty(profile_header)) {\n+                profiles = profile_header.split(arraySeparator);\n+            }\n+\n+            String group_header = getHeader(req, config.getGroupKey(), config.getDefaultGroup());\n+            String[] groups = new String[0];\n+            if (!StringUtils.isEmpty(group_header)) {\n+                groups = group_header.split(arraySeparator);\n+            }\n+\n+            List<String> roleGroupsList = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU1OTE1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNjo0NFrOGLSgdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNjo0NFrOGLSgdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5MDc0Mg==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414490742", "createdAt": "2020-04-24T11:06:44Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -141,16 +172,18 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\t\t\tuser.setUsername(username);\n \t\t\t\tuser.setSurname(surname);\n \t\t\t\tuser.setName(firstname);\n+                user.setOrganisation(organisation);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU2MDM4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNzowMlrOGLShMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNzowMlrOGLShMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5MDkzMQ==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414490931", "createdAt": "2020-04-24T11:07:02Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -165,6 +198,7 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\t\t\tif (ldapUserDetails == null) {\n \t\t\t\t\tldapUserDetails = new LDAPUser(username);\n \t\t\t\t\tldapUserDetails.getUser().setName(firstname).setSurname(surname);\n+                    ldapUserDetails.getUser().setOrganisation(organisation);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU2MzIwOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNzo1M1rOGLSi7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowNzo1M1rOGLSi7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5MTM3NA==", "bodyText": "formatting: should be for (...", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414491374", "createdAt": "2020-04-24T11:07:53Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -95,20 +98,47 @@ protected UserDetails setupUser(ServletRequest request, ShibbolethUserConfigurat\n \t\tString username = getHeader(req, config.getUsernameKey(), \"\");\n \t\tString surname = getHeader(req, config.getSurnameKey(), \"\");\n \t\tString firstname = getHeader(req, config.getFirstnameKey(), \"\");\n+        String organisation = getHeader(req, config.getOrganisationKey(), \"\");\n \t\tString email = getHeader(req, config.getEmailKey(), \"\");\n \t\tString arraySeparator = config.getArraySeparator();\n-\n-\t\tString profile_header = getHeader(req, config.getProfileKey(), Profile.Guest.name());\n-\t\tString[] profiles = new String[0];\n-\t\tif (!StringUtils.isEmpty(profile_header)) {\n-\t\t\tprofiles = profile_header.split(arraySeparator);\n-\t\t}\n-\n-\t\tString group_header = getHeader(req, config.getGroupKey(), config.getDefaultGroup());\n-\t\tString[] groups = new String[0];\n-\t\tif (!StringUtils.isEmpty(group_header)) {\n-\t\t\tgroups = group_header.split(arraySeparator);\n-\t\t}\n+\t\tString roleGroupSeparator = config.getRoleGroupSeparator();\n+\n+        // RoleGroupKey header format: sample,UserAdmin;sample,Editor\n+        // It has precedence over individual ProfileKey and GroupKey headers if all are provided.\n+        //      - ProfileKey header format: UserAdmin;Editor\n+        //      - GroupKey header format: sample;sample\n+        String roleGroup_header = getHeader(req, config.getRoleGroupKey(), \"\");\n+        String[] roleGroups = new String[0];\n+        if (!StringUtils.isEmpty(roleGroup_header)) {\n+            roleGroups = roleGroup_header.split(arraySeparator);\n+        } else {\n+            String profile_header = getHeader(req, config.getProfileKey(), Profile.Guest.name());\n+            String[] profiles = new String[0];\n+            if (!StringUtils.isEmpty(profile_header)) {\n+                profiles = profile_header.split(arraySeparator);\n+            }\n+\n+            String group_header = getHeader(req, config.getGroupKey(), config.getDefaultGroup());\n+            String[] groups = new String[0];\n+            if (!StringUtils.isEmpty(group_header)) {\n+                groups = group_header.split(arraySeparator);\n+            }\n+\n+            List<String> roleGroupsList = new ArrayList<>();\n+            for(int i = 0; i < groups.length; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU3MzAxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMDozOVrOGLSoxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMDozOVrOGLSoxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5Mjg2OA==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414492868", "createdAt": "2020-04-24T11:10:39Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -251,7 +293,8 @@ private void assignProfile(String[] profiles, User user) {\n \t\tprivate String username;\n \t\tprivate String name;\n \t\tprivate String surname;\n-\t\tprivate String profile;\n+\t\tprivate String organisation;\n+        private String profile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 213}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU3MzgzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMDo1M1rOGLSpRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMDo1M1rOGLSpRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5Mjk5OQ==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414492999", "createdAt": "2020-04-24T11:10:53Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtils.java", "diffHunk": "@@ -261,6 +304,7 @@ static MinimalUser create(ServletRequest request, ShibbolethUserConfiguration co\n \t\t\tString username = getHeader(req, config.getUsernameKey(), \"\");\n \t\t\tString surname = getHeader(req, config.getSurnameKey(), \"\");\n \t\t\tString firstname = getHeader(req, config.getFirstnameKey(), \"\");\n+            String organisation = getHeader(req, config.getOrganisationKey(), \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 221}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4MTI0OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMjo0NVrOGLSteg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMjo0NVrOGLSteg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDA3NA==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494074", "createdAt": "2020-04-24T11:12:45Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -80,7 +81,9 @@ public void setUp() {\n \t\tconfig.setSurnameKey(\"SURNAME_KEY\");\n \t\tconfig.setUpdateGroup(true);\n \t\tconfig.setUpdateProfile(true);\n-\t\tconfig.setUsernameKey(\"USERNAME_KEY\");\n+        config.setUsernameKey(\"USERNAME_KEY\");\n+\t\tconfig.setOrganisationKey(\"ORGANISATION_KEY\");\n+        config.setRoleGroupSeparator(\",\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4MTk4OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMjo1NFrOGLSt3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMjo1NFrOGLSt3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDE3NQ==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494175", "createdAt": "2020-04-24T11:12:54Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -106,12 +109,13 @@ public void twoConsecutiveLogins() throws Exception {\n \t\tassertNull(\"User already exists\", user);\n \n \t\tString group = groupname + \"1\";\n-\t\tString profile = Profile.UserAdmin.name() + config.getArraySeparator() + Profile.Administrator.name();\n+\t\tString groups = group + config.getArraySeparator() + group;\n+        String profile = Profile.UserAdmin.name() + config.getArraySeparator() + Profile.Administrator.name();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4MjcxOnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzowNFrOGLSuQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzowNFrOGLSuQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDI3Mw==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494273", "createdAt": "2020-04-24T11:13:04Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -129,11 +133,12 @@ public void twoConsecutiveLogins() throws Exception {\n \n \t\t// Second round, same user different authorization\n \t\tgroup = groupname + \"3\";\n-\t\tprofile = Profile.Guest.name() + config.getArraySeparator() + Profile.Editor.name();\n+        groups = group + config.getArraySeparator() + group;\n+        profile = Profile.Guest.name() + config.getArraySeparator() + Profile.Editor.name();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4MzcxOnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzoxOFrOGLSu0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzoxOFrOGLSu0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDQxNg==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494416", "createdAt": "2020-04-24T11:13:18Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -160,12 +165,13 @@ public void twoConsecutiveLoginsNoAuthorization() throws Exception {\n \t\tassertNull(\"User already exists\", user);\n \n \t\tString group = groupname + \"1\";\n+        String groups = group + config.getArraySeparator() + group ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4NTM3OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzo0NVrOGLSvvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzo0NVrOGLSvvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDY1NQ==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494655", "createdAt": "2020-04-24T11:13:45Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -183,10 +189,12 @@ public void twoConsecutiveLoginsNoAuthorization() throws Exception {\n \n \t\t// Second round, same user different authorization but the original\n \t\t// authorization should be kept (no updateProfile, updateGroups)\n+        String groupNew = groupname + \"3\";\n+        String groupsgroupNew = groupNew + config.getArraySeparator() + groupNew ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjU4NTg2OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzo1MlrOGLSwBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMToxMzo1MlrOGLSwBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ5NDcyNg==", "bodyText": "Indentation", "url": "https://github.com/geonetwork/core-geonetwork/pull/4633#discussion_r414494726", "createdAt": "2020-04-24T11:13:52Z", "author": {"login": "juanluisrp"}, "path": "core/src/test/java/org/fao/geonet/kernel/security/shibboleth/ShibbolethUserUtilsTest.java", "diffHunk": "@@ -221,6 +229,7 @@ public void groupLengthNotMatchProfileLength() throws Exception {\n \t\trequest.addHeader(this.config.getProfileKey(), profile);\n \t\trequest.addHeader(this.config.getSurnameKey(), surname);\n \t\trequest.addHeader(this.config.getUsernameKey(), username);\n+        request.addHeader(this.config.getOrganisationKey(), organisation);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea3b60d68195aefcb270f5dc4ebcc7a282a068db"}, "originalPosition": 83}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4162, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}