{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMzIxMDM2", "number": 4488, "title": "Migrate to GeoTools 23.0", "bodyText": "Modifications for migrate to GeoTools 23.0\nCompile OK with mvn clean install\nStart without error in JAVA11 / Tomcat9\nStill have to test :\n\nJAVA8 compatibility\nUsage tests\n\nRelated to #3882", "createdAt": "2020-03-02T11:07:25Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488", "merged": true, "mergeCommit": {"oid": "a0782c9af6339a6727df6c03a20b08a445a964a9"}, "closed": true, "closedAt": "2020-05-04T09:33:30Z", "author": {"login": "jusabatier"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJrie7gH2gAyMzgyMzIxMDM2OjkwOGRmOWJlNTlkNTc4ODZkM2ZiODk0ZTY0YWQyZjExMDUyYWQzYmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceU4lZgFqTQwNTgzOTYwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "908df9be59d57886d3fb894e64ad2f11052ad3bf", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/908df9be59d57886d3fb894e64ad2f11052ad3bf", "committedDate": "2020-03-02T10:54:59Z", "message": "Migrate to GeoTools 22.3"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d99d810f757bf12582c3da53769fd7ccb4eea1c", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/5d99d810f757bf12582c3da53769fd7ccb4eea1c", "committedDate": "2020-03-04T12:39:29Z", "message": "Correct handle axis order for WFS features indexing"}, "afterCommit": {"oid": "908df9be59d57886d3fb894e64ad2f11052ad3bf", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/908df9be59d57886d3fb894e64ad2f11052ad3bf", "committedDate": "2020-03-02T10:54:59Z", "message": "Migrate to GeoTools 22.3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/aeb4ab8c300110815d5952ced12aa1274835534f", "committedDate": "2020-03-06T09:41:27Z", "message": "Correct feature reprojection in WFS indexation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMTg5MDcy", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-381189072", "createdAt": "2020-03-25T14:16:34Z", "commit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDoxNjozNFrOF7dJ9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDoxNjozNFrOF7dJ9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg4Nzk4OQ==", "bodyText": "Note 23-RC is out now.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#discussion_r397887989", "createdAt": "2020-03-25T14:16:34Z", "author": {"login": "jodygarnett"}, "path": "pom.xml", "diffHunk": "@@ -1432,8 +1443,8 @@\n \n     <!-- NOTE: When updating GeoTools, check which version\n     of Postgres is used and update pg.version if needed. -->\n-    <geotools.version>16.0</geotools.version>\n-    <pg.version>9.4.1211</pg.version>\n+    <geotools.version>22.3</geotools.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMTkxOTk4", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-381191998", "createdAt": "2020-03-25T14:19:32Z", "commit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDoxOTozMlrOF7dS0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDoxOTozMlrOF7dS0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg5MDI1Nw==", "bodyText": "I like this approach, very safe to retroject to something you know (CRS:84) just based on the returned features.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#discussion_r397890257", "createdAt": "2020-03-25T14:19:32Z", "author": {"login": "jodygarnett"}, "path": "workers/wfsfeature-harvester/src/main/java/org/fao/geonet/harvester/wfsfeatures/worker/EsWFSFeatureIndexer.java", "diffHunk": "@@ -260,7 +256,10 @@ public void indexFeatures(Exchange exchange) throws Exception {\n             BulkResutHandler brh = new AsyncBulkResutHandler(phaser, typeName, url, nbOfFeatures, report);\n \n             long begin = System.currentTimeMillis();\n-            FeatureIterator<SimpleFeature> features = wfs.getFeatureSource(typeName).getFeatures(query).features();\n+\n+            ReprojectingFeatureCollection rfc = new ReprojectingFeatureCollection(wfs.getFeatureSource(typeName).getFeatures(query), CRS.decode(\"urn:ogc:def:crs:OGC:1.3:CRS84\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDQ0ODQ2", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-394044846", "createdAt": "2020-04-15T18:50:48Z", "commit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxODo1MDo0OVrOGGHFJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxODo1MDo0OVrOGGHFJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTA2MDY0NA==", "bodyText": "Use try/finally block to ensure FeatureIterator is closed.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#discussion_r409060644", "createdAt": "2020-04-15T18:50:49Z", "author": {"login": "jodygarnett"}, "path": "workers/wfsfeature-harvester/src/main/java/org/fao/geonet/harvester/wfsfeatures/worker/EsWFSFeatureIndexer.java", "diffHunk": "@@ -260,7 +256,10 @@ public void indexFeatures(Exchange exchange) throws Exception {\n             BulkResutHandler brh = new AsyncBulkResutHandler(phaser, typeName, url, nbOfFeatures, report);\n \n             long begin = System.currentTimeMillis();\n-            FeatureIterator<SimpleFeature> features = wfs.getFeatureSource(typeName).getFeatures(query).features();\n+\n+            ReprojectingFeatureCollection rfc = new ReprojectingFeatureCollection(wfs.getFeatureSource(typeName).getFeatures(query), CRS.decode(\"urn:ogc:def:crs:OGC:1.3:CRS84\"));\n+\n+            FeatureIterator<SimpleFeature> features = rfc.features();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aeb4ab8c300110815d5952ced12aa1274835534f"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b1aa9213f772c1ee4e1d0155001a2b240e26b88", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/5b1aa9213f772c1ee4e1d0155001a2b240e26b88", "committedDate": "2020-04-15T19:07:53Z", "message": "Upgrade to GeoTools 23.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5c638567530ff5976451d86af071b3e30f3fd62", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/b5c638567530ff5976451d86af071b3e30f3fd62", "committedDate": "2020-04-16T17:23:15Z", "message": "Remove unusefull query and add final statement to close iterator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MDcxMDk5", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-395071099", "createdAt": "2020-04-16T23:41:55Z", "commit": {"oid": "5b1aa9213f772c1ee4e1d0155001a2b240e26b88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzo0MTo1NVrOGG69Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzo0MTo1NVrOGG69Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkxMDUzMA==", "bodyText": "We should build once more when GeoTools is officially anounced, we are currently having a build issue due to the new osgeo repo ... performing faster and allowing multi-threaded builds to trip on themselves. The Maven local repository is not thread safe apparently ...", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#discussion_r409910530", "createdAt": "2020-04-16T23:41:55Z", "author": {"login": "jodygarnett"}, "path": "pom.xml", "diffHunk": "@@ -1443,7 +1446,7 @@\n \n     <!-- NOTE: When updating GeoTools, check which version\n     of Postgres is used and update pg.version if needed. -->\n-    <geotools.version>22.3</geotools.version>\n+    <geotools.version>23.0</geotools.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1aa9213f772c1ee4e1d0155001a2b240e26b88"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d1adfa3809a35b88c576e7f0cd33c1479057bb1", "author": {"user": {"login": "jusabatier", "name": "Julien Sabatier"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/5d1adfa3809a35b88c576e7f0cd33c1479057bb1", "committedDate": "2020-04-17T12:42:14Z", "message": "Merge remote-tracking branch 'origin/master' into patch-geotools-22.3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODM0MzU5", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-404834359", "createdAt": "2020-05-04T09:33:17Z", "commit": {"oid": "5d1adfa3809a35b88c576e7f0cd33c1479057bb1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1ODM5NjA0", "url": "https://github.com/geonetwork/core-geonetwork/pull/4488#pullrequestreview-405839604", "createdAt": "2020-05-05T14:23:43Z", "commit": {"oid": "5d1adfa3809a35b88c576e7f0cd33c1479057bb1"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1674, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}