{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MTc0MzAy", "number": 4669, "title": "Set encoding to UTF-8 in metadata notifier requests", "bodyText": "Set encoding to UTF-8 in metadata notifier requests, otherwise the xml special chars like accents are not encoded properly.", "createdAt": "2020-05-08T10:51:27Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/4669", "merged": true, "mergeCommit": {"oid": "a3fbd28483f34d4b76b4a60801b26cf232930da6"}, "closed": true, "closedAt": "2020-05-11T07:46:50Z", "author": {"login": "josegar74"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfPoJtAH2gAyNDE1MTc0MzAyOjRmODFhZGE1OTBhOTBlZGUzOGEzM2UwZWFiNmRiMzRjMDc5YzIwMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgKxz7gFqTQwODkzNDUxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4f81ada590a90ede38a33e0eab6db34c079c2001", "author": {"user": {"login": "josegar74", "name": "Jose Garc\u00eda"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/4f81ada590a90ede38a33e0eab6db34c079c2001", "committedDate": "2020-05-08T10:50:10Z", "message": "Set encoding to UTF-8 in metadata notifier requests, otherwise the xml special chars like accents are not encoded properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc38f0d29fcb3eb60031c90c0a624c852ea85604", "author": {"user": {"login": "josegar74", "name": "Jose Garc\u00eda"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/bc38f0d29fcb3eb60031c90c0a624c852ea85604", "committedDate": "2020-05-08T12:01:57Z", "message": "Add accept-header to avoid the following error if the notifier application runs in Jetty: org.eclipse.jetty.http.BadMessageException: 400: Unable to parse form content"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4OTEzOTg5", "url": "https://github.com/geonetwork/core-geonetwork/pull/4669#pullrequestreview-408913989", "createdAt": "2020-05-11T07:13:08Z", "commit": {"oid": "bc38f0d29fcb3eb60031c90c0a624c852ea85604"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzoxMzowOFrOGTPbPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNzoxNjo0MlrOGTPijg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgyODg2Mw==", "bodyText": "I would use StandardCharsets.UTF_8 constant here.", "url": "https://github.com/geonetwork/core-geonetwork/pull/4669#discussion_r422828863", "createdAt": "2020-05-11T07:13:08Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/notifier/MetadataNotifierClient.java", "diffHunk": "@@ -77,10 +78,11 @@ private void execute(final MetadataNotifier notifier, List<? extends NameValuePa\n \n             // Create a method instance.\n             HttpPost method = new HttpPost(notifier.getUrl());\n-            final UrlEncodedFormEntity entity = new UrlEncodedFormEntity(data);\n+            final UrlEncodedFormEntity entity = new UrlEncodedFormEntity(data, Charset.forName(\"UTF-8\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc38f0d29fcb3eb60031c90c0a624c852ea85604"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgzMDczNA==", "bodyText": "Use constants here:\n method.addHeader(org.apache.http.HttpHeaders.ACCEPT_CHARSET, java.nio.charset.StandardCharsets.UTF_8.name());", "url": "https://github.com/geonetwork/core-geonetwork/pull/4669#discussion_r422830734", "createdAt": "2020-05-11T07:16:42Z", "author": {"login": "juanluisrp"}, "path": "core/src/main/java/org/fao/geonet/notifier/MetadataNotifierClient.java", "diffHunk": "@@ -77,10 +78,11 @@ private void execute(final MetadataNotifier notifier, List<? extends NameValuePa\n \n             // Create a method instance.\n             HttpPost method = new HttpPost(notifier.getUrl());\n-            final UrlEncodedFormEntity entity = new UrlEncodedFormEntity(data);\n+            final UrlEncodedFormEntity entity = new UrlEncodedFormEntity(data, Charset.forName(\"UTF-8\"));\n             final RequestConfig.Builder configBuilder = RequestConfig.custom();\n             configBuilder.setMaxRedirects(3);\n \n+            method.addHeader(\"accept-charset\", \"UTF-8\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc38f0d29fcb3eb60031c90c0a624c852ea85604"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a2ace7cec5dd544ad4da31d984af586dc4354a0", "author": {"user": {"login": "josegar74", "name": "Jose Garc\u00eda"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/4a2ace7cec5dd544ad4da31d984af586dc4354a0", "committedDate": "2020-05-11T07:42:09Z", "message": "Set encoding to UTF-8 in metadata notifier requests - use constants"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4OTM0NTE2", "url": "https://github.com/geonetwork/core-geonetwork/pull/4669#pullrequestreview-408934516", "createdAt": "2020-05-11T07:45:07Z", "commit": {"oid": "4a2ace7cec5dd544ad4da31d984af586dc4354a0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1637, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}