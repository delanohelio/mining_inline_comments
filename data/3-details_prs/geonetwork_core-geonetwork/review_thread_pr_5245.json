{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNjg3NDYz", "number": 5245, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNDoxNzo0N1rOFBzTUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNDoxNzo0N1rOFBzTUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3NDMzNDI3OnYy", "diffSide": "RIGHT", "path": "web-ui/src/main/resources/catalog/js/CatController.js", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNDoxNzo0N1rOIAo5Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxMjozODowNFrOIBYZDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA==", "bodyText": "The site API should take care of this https://github.com/geonetwork/core-geonetwork/blob/4.0.x/services/src/main/java/org/fao/geonet/api/site/SiteApi.java#L192-L207\nNode id and name should be set properly https://apps.titellus.net/geonetwork/wise/api/site\nAlso some setup have more than 200 portals and this approach would be slow.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r537540934", "createdAt": "2020-12-07T14:17:47Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU5NzU4NQ==", "bodyText": "Thanks, will try to rewrite it a bit.\n(200 portals?)", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r537597585", "createdAt": "2020-12-07T15:29:43Z", "author": {"login": "MichelGabriel"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYwMzI3Mg==", "bodyText": "It is not really about rewriting something. It should work eg. https://apps.titellus.net/geonetwork/wise/eng/catalog.search#/home maybe something which is not in master or 3 ?", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r537603272", "createdAt": "2020-12-07T15:37:05Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYwODU2OQ==", "bodyText": "I mean rewriting the toolbar file.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r537608569", "createdAt": "2020-12-07T15:44:01Z", "author": {"login": "MichelGabriel"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYwOTQ3OA==", "bodyText": "The code in \n  \n    \n      core-geonetwork/services/src/main/java/org/fao/geonet/api/site/SiteApi.java\n    \n    \n        Lines 209 to 224\n      in\n      3028d14\n    \n    \n    \n    \n\n        \n          \n           if (!NodeInfo.DEFAULT_NODE.equals(node.getId())) { \n        \n\n        \n          \n               Source source = sourceRepository.findOne(node.getId()); \n        \n\n        \n          \n               if (source != null) { \n        \n\n        \n          \n                   String iso3langCode = languageUtils.getIso3langCode(request.getLocales()); \n        \n\n        \n          \n                   final List<Setting> settings = response.getSettings(); \n        \n\n        \n          \n                   settings.add( \n        \n\n        \n          \n                       new Setting().setName(Settings.NODE_DEFAULT) \n        \n\n        \n          \n                           .setValue(\"false\")); \n        \n\n        \n          \n                   settings.add( \n        \n\n        \n          \n                       new Setting().setName(Settings.NODE) \n        \n\n        \n          \n                           .setValue(source.getUuid())); \n        \n\n        \n          \n                   settings.add( \n        \n\n        \n          \n                       new Setting().setName(Settings.NODE_NAME) \n        \n\n        \n          \n                           .setValue(source != null ? source.getLabel(iso3langCode) : source.getName())); \n        \n\n        \n          \n               } \n        \n\n        \n          \n           } \n        \n    \n  \n\n seem the same\nThe value \"node/name\" of the response for /api/site seem should have the translated node value.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r537609478", "createdAt": "2020-12-07T15:45:11Z", "author": {"login": "josegar74"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODExNDIzMA==", "bodyText": "I had another look at some code, and saw this line: https://github.com/geonetwork/core-geonetwork/blob/master/services/src/main/java/org/fao/geonet/api/site/SiteApi.java#L209\nIt looks like (I'm no Java developer) the NODE information is only included when you're not on the 'default' node/site. It would have been nice if this information was always there, but maybe there is a good reason not to do so.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r538114230", "createdAt": "2020-12-08T07:57:41Z", "author": {"login": "MichelGabriel"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODMxOTExOA==", "bodyText": "if this information was always there,\n\nYep could be easier.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5245#discussion_r538319118", "createdAt": "2020-12-08T12:38:04Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/js/CatController.js", "diffHunk": "@@ -679,7 +679,17 @@ goog.require('gn_alert');\n               });\n         });\n \n-\n+        // Retreive portal information\n+        var getPortalSources = promiseStart.then(function(value) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0MDkzNA=="}, "originalCommit": {"oid": "6d02d829382855dabb700dd58f160b05569c41ab"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4238, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}