{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MjYxMDYw", "number": 5220, "title": "Fixed unhandled error and its xsl regular expression. Fixed root element in Schematron title translation.", "bodyText": "Fixed xsl regular expression due to the parser error message change to translate language text. Pass codelist into the validate-fn.xsl to get multilingual support for topic category list.", "createdAt": "2020-11-26T20:43:17Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220", "merged": true, "mergeCommit": {"oid": "5e8d1d13f1b07ab906f439364ed9a0ca37d049c9"}, "closed": true, "closedAt": "2021-01-29T07:00:09Z", "author": {"login": "wangf1122"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgZIndgH2gAyNTI4MjYxMDYwOmY4ZWUyYjk3NjdmYTI1ZGU4MDMzNzBhMWE2YzQzYzQ0NmIzYjgwYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdyBPOZgFqTU3MjMxMDEwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f8ee2b9767fa25de803370a1a6c43c446b3b80ac", "author": {"user": {"login": "wangf1122", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/f8ee2b9767fa25de803370a1a6c43c446b3b80ac", "committedDate": "2020-11-26T20:39:51Z", "message": "Fixed xsl regular expression due to the parser error message change to translate language text. Pass codelist into the validate-fn.xsl to get multilingual support for topic category list."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5OTAwMTU3", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220#pullrequestreview-539900157", "createdAt": "2020-11-27T11:14:53Z", "commit": {"oid": "f8ee2b9767fa25de803370a1a6c43c446b3b80ac"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMToxNDo1M1rOH66kWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMToxNDo1M1rOH66kWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUzOTAzMw==", "bodyText": "I don't believe you can hard code the reference the gmd:MD_TopicCategoryCode in the enumeration-valid error as the enumeration-valid is used to generate error messages for all kinds of invalid code list.  I believe this has to be a generic error handler for all enumeration-valid.\nThis  will most likely break validations of other code lists.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220#discussion_r531539033", "createdAt": "2020-11-27T11:14:53Z", "author": {"login": "ianwallen"}, "path": "web/src/main/webapp/xslt/services/metadata/validate-fn.xsl", "diffHunk": "@@ -186,14 +187,10 @@\n                   </xsl:if>\n                 </xsl:when>\n                 <xsl:when test=\"$errorType = 'enumeration-valid'\">\n-                  <xsl:value-of select=\"$strings/enum1\"/> '<xsl:value-of\n-                  select=\"regex-group(1)\"/>'\n-                  <xsl:value-of select=\"$strings/enum2\"/>\n-                  <xsl:value-of\n-                    select=\"geonet:getTitleWithoutContext($schema, concat(regex-group(3), ':', regex-group(4)), $labels)\"\n-                  /> (<xsl:value-of select=\"concat(regex-group(3), ':', regex-group(4))\"/>).\n+                  <!--The topic category must be found in the following list-->\n                   <xsl:value-of select=\"$strings/enum3\"/>\n-                  <xsl:value-of select=\"regex-group(2)\"/>.\n+                  <!--The code list with translation text-->\n+                  (<xsl:value-of select=\"$codelists//codelist[@name='gmd:MD_TopicCategoryCode']/entry/value\" separator=\", \" />)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8ee2b9767fa25de803370a1a6c43c446b3b80ac"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9df8527bbac71f0a3ff8882b28bc9c452bcca4a", "author": {"user": {"login": "wangf1122", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/a9df8527bbac71f0a3ff8882b28bc9c452bcca4a", "committedDate": "2020-11-30T15:41:29Z", "message": "Added enumeration-validwithparent, datatype-valid.1.2.3withparent and datatype-valid.1.2.3 error reg expression patterns."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMDM4NzEw", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220#pullrequestreview-541038710", "createdAt": "2020-11-30T15:49:26Z", "commit": {"oid": "a9df8527bbac71f0a3ff8882b28bc9c452bcca4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTo0OToyNlrOH8BTUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNTo0OToyNlrOH8BTUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY5NzkzOA==", "bodyText": "I put test code like\nxsl:otherwise\nxsl:messageSkiped $error=<xsl:value-of select=\"$error\"></xsl:value-of></xsl:message>\n<xsl:value-of select=\"$error\"/>\n</xsl:otherwise>\nSo I summarized all skipped patterns:\nSkiped $error='' is not a valid value of union type 'Date_Type'.\nSkiped $error='' is not a valid value of union type 'Date_Type'.\nSkiped $error='' is not a valid value of union type 'Date_Type'. (Element: gco:Date with parent element: gmd:date)\nSkiped $error='' is not a valid value of union type 'Date_Type'. (Element: gco:Date with parent element: gmd:date)\nSkiped $error=Value '' is not facet-valid with respect to enumeration '[farming, biota, boundaries, climatologyMeteorologyAtmosphere, economy, elevation, environment, geoscientificInformation, health, imageryBaseMapsEarthCover, intelligenceMilitary, inlandWaters, location, oceans, planningCadastre, society, structure, transportation, utilitiesCommunication]'. It must be a value from the enumeration. (Element: gmd:MD_TopicCategoryCode with parent element: gmd:topicCategory)\nRealized there are three uncaught errors: enumeration-validwithparent, datatype-valid.1.2.3withparent, datatype-valid.1.2.3. So I added them accordingly.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220#discussion_r532697938", "createdAt": "2020-11-30T15:49:26Z", "author": {"login": "wangf1122"}, "path": "web/src/main/webapp/xslt/services/metadata/validate-fn.xsl", "diffHunk": "@@ -97,7 +97,12 @@\n       <!--cvc-type.3.1.3: The value 'DUMMY_DENOMINATOR' of element 'gco:Integer' is not valid. (Element: gco:Integer with parent element: gmd:denominator)-->\n       <rule errorType=\"type.3.1.3withparent\">The value '(.*)' of element '(.*)' is not valid\\. \\(Element: ([a-z]{3}):(.*) with parent element: (.*)\\)</rule>\n       <rule errorType=\"type.3.1.3\">The value '(.*)' of element '(.*)' is not valid\\.</rule>\n-      <rule errorType=\"enumeration-valid\">Value '(.*)' is not facet-valid with respect to enumeration '\\[(.*)\\]'\\. It must be a value from the enumeration\\. \\(Element: ([a-z]{3}):(.*) with parent element: (.*)\\)</rule>\n+      <rule errorType=\"enumeration-validwithparent\">Value '(.*)' is not facet-valid with respect to enumeration '\\[(.*)\\]'\\. It must be a value from the enumeration\\. \\(Element: ([a-z]{3}):(.*) with parent element: (.*)\\)</rule>\n+      <rule errorType=\"enumeration-valid\">Value '(.*)' is not facet-valid with respect to enumeration '\\[(.*)\\]'\\. It must be a value from the enumeration\\.</rule>\n+      <!--datatype-valid.1.2.3: '' is not a valid value of union type 'Date_Type'.-->\n+      <rule errorType=\"datatype-valid.1.2.3withparent\">'(.*)' is not a valid value of union type '(.*)'\\. \\(Element: ([a-z]{3}):(.*) with parent element:(.*)\\)</rule>\n+      <rule errorType=\"datatype-valid.1.2.3\">'(.*)' is not a valid value of union type '(.*)'\\.</rule>\n+\n     </xsl:variable>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9df8527bbac71f0a3ff8882b28bc9c452bcca4a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc26cf949cb6e86526a6261725cad0d8c5404fa3", "author": {"user": {"login": "wangf1122", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/fc26cf949cb6e86526a6261725cad0d8c5404fa3", "committedDate": "2020-12-17T17:14:30Z", "message": "Fixed root element for schematronTranslations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyMzEwMTAw", "url": "https://github.com/geonetwork/core-geonetwork/pull/5220#pullrequestreview-572310100", "createdAt": "2021-01-20T15:00:00Z", "commit": {"oid": "fc26cf949cb6e86526a6261725cad0d8c5404fa3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1707, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}