{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MjQ5NjA1", "number": 4784, "title": "Enhance ESRI REST API support", "bodyText": "This transaction is to enhance the GN ESRI REST API support to cover one of the commonly used subtype \"Map Server\" protocol.\nEsri supports a various protocol types:\nESRI REST,\nESRI REST: Feature Server,\nESRI REST: Image Service,\nESRI REST: Map Server,\nESRI REST: Tiled Map Service,\nOGC WMS\nMore than half of the datasets (maybe close to 80%) from FGP (https://maps.canada.ca/en/index.html)  with the Esri mapping capabilities use the ESRI REST: Map Server protocol instead.\nGeonetwork adds the ESRI Rest API support in 3.10, but it only supports one type ESRI REST.\nThere are a few reports for the issue from the community:\nhttps://gis.stackexchange.com/questions/352239/geonetwork-3-10-esri-rest-map-view-issue\nMy DFO co-worker Ian @ianwallen also filed an issue against the hnap\nmetadata101/iso19139.ca.HNAP#55\nTo reproduce the issue:\na. From a fresh geonetwork \"master' install, login admin,\n\nb. Choose one of the dataset record with ESRI service link and click add to the map:\n\nc.1. Before the fix\n\nc.2. After the fix", "createdAt": "2020-06-19T18:49:05Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784", "merged": true, "mergeCommit": {"oid": "ac25308e2bf6b31b49cf2e4dea8979a5bce36a2f"}, "closed": true, "closedAt": "2020-07-03T13:07:18Z", "author": {"login": "kingwang-git"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcs3eSwgH2gAyNDM3MjQ5NjA1OmQyOTZkOWUxMmFjZWNlYmE2MTUwMjE4ZmUyMGNiNGFhNTQzYjk0MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxTJkQgFqTQ0MjQwMDk3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d296d9e12aceceba6150218fe20cb4aa543b9402", "author": {"user": {"login": "kingwang-git", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/d296d9e12aceceba6150218fe20cb4aa543b9402", "committedDate": "2020-06-19T18:36:37Z", "message": "Enhance ESRI REST API support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjU0MTc2", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784#pullrequestreview-434654176", "createdAt": "2020-06-22T07:09:10Z", "commit": {"oid": "d296d9e12aceceba6150218fe20cb4aa543b9402"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNzowOToxMVrOGm0U-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNzowOToxMVrOGm0U-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM1NjQwOQ==", "bodyText": "If you don't add the value in ISO19139 list of protocol, that will never be used ?\nSee https://github.com/geonetwork/core-geonetwork/pull/3914/files#diff-9edb196db9b6857e1f3e578db9328026R2270", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784#discussion_r443356409", "createdAt": "2020-06-22T07:09:11Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/views/default/config.js", "diffHunk": "@@ -111,7 +111,8 @@\n               'OGC:WMS-1.1.1-http-get-map',\n               'OGC:WMS-1.3.0-http-get-map',\n               'OGC:WFS',\n-              'ESRI:REST'\n+              'ESRI:REST',\n+              'ESRI REST: Map Server'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d296d9e12aceceba6150218fe20cb4aa543b9402"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjU0NDgz", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784#pullrequestreview-434654483", "createdAt": "2020-06-22T07:09:38Z", "commit": {"oid": "d296d9e12aceceba6150218fe20cb4aa543b9402"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNzowOTozOFrOGm0V6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNzowOTozOFrOGm0V6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM1NjY1MQ==", "bodyText": "Maybe we can use starts with here if we are going to support all ESRI types ?", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784#discussion_r443356651", "createdAt": "2020-06-22T07:09:38Z", "author": {"login": "fxprunayre"}, "path": "web-ui/src/main/resources/catalog/views/default/module.js", "diffHunk": "@@ -261,7 +261,7 @@\n             uuid: md ? md.getUuid() : null,\n             type:\n               link.protocol.indexOf('WMTS') > -1 ? 'wmts' :\n-              (link.protocol == 'ESRI:REST' ? 'esrirest' : 'wms'),\n+                ((link.protocol == 'ESRI:REST') || (link.protocol == 'ESRI REST: Map Server') ? 'esrirest' : 'wms'),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d296d9e12aceceba6150218fe20cb4aa543b9402"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1618f43bca12e945d2b435fc02a8472bf0d14ff", "author": {"user": {"login": "kingwang-git", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/e1618f43bca12e945d2b435fc02a8472bf0d14ff", "committedDate": "2020-06-22T16:45:30Z", "message": "Enhance ESRI REST API support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ff465b281361aaee8ccf98520e8b550fd915305", "author": {"user": {"login": "kingwang-git", "name": null}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/4ff465b281361aaee8ccf98520e8b550fd915305", "committedDate": "2020-06-23T17:11:48Z", "message": "Enhance ESRI REST API support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNDAwOTcz", "url": "https://github.com/geonetwork/core-geonetwork/pull/4784#pullrequestreview-442400973", "createdAt": "2020-07-03T13:07:01Z", "commit": {"oid": "4ff465b281361aaee8ccf98520e8b550fd915305"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1589, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}