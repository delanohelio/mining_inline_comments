{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NjcxMDM4", "number": 5112, "title": "java 8 only", "bodyText": "The master branch requires JDK 8 for building and running. This PR adds a couple checks to ensure Java 8 is used.\nWith this PR, when tomcat is configured with Java 11, geonetwork will refuse to start with geonetwork.log:\n2020-10-22 21:18:54,047 FATAL [jeeves.engine] - Raised exception during init\n2020-10-22 21:18:54,047 FATAL [jeeves.engine] -    Exception : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.7\"\n2020-10-22 21:18:54,047 FATAL [jeeves.engine] -    Message   : Java 8 required, cannot start with \"11.0.7\"\n2020-10-22 21:18:54,052 FATAL [jeeves.engine] -    Stack     : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.7\"", "createdAt": "2020-10-23T03:19:36Z", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112", "merged": true, "mergeCommit": {"oid": "cc572eb4f380fe4877931aafad77f977b77ee791"}, "closed": true, "closedAt": "2021-01-05T08:04:50Z", "author": {"login": "jodygarnett"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVOdirgBqjM5MTIwMDQyMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtGTdpgFqTU2MTU4MTE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae16244e34bdec7d74ad9c4b4735320afc9a7aa7", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/ae16244e34bdec7d74ad9c4b4735320afc9a7aa7", "committedDate": "2020-10-23T03:18:23Z", "message": "java 8 only"}, "afterCommit": {"oid": "318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "committedDate": "2020-10-23T04:00:12Z", "message": "java 8 only"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "committedDate": "2020-10-23T04:00:12Z", "message": "java 8 only"}, "afterCommit": {"oid": "953e963cbf5315674950f171b6d7c973c9dbbe4f", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/953e963cbf5315674950f171b6d7c973c9dbbe4f", "committedDate": "2020-10-23T04:15:11Z", "message": "java 8 only"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzY2MzAy", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#pullrequestreview-515366302", "createdAt": "2020-10-23T06:02:01Z", "commit": {"oid": "953e963cbf5315674950f171b6d7c973c9dbbe4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMjowMVrOHm_LTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMjowMVrOHm_LTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0MzAyMQ==", "bodyText": "From the pom.xml it should be ~/.m2/toolchains.xml instead of ~/.m2/toolchain.xml\nI tested the configuration and seem pick up, but the startup error about the version occurs if the default version is 11:\n[INFO] --- maven-toolchains-plugin:3.0.0:toolchain (default) @ web-app ---\n[INFO] Required toolchain: jdk [ version='8' ]\n[INFO] Found matching toolchain for type jdk: JDK[/PATH/candidates/java/8.0.201-oracle]\n\n...\n\n[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ web-app ---\n[INFO] Toolchain in maven-compiler-plugin: JDK[/PATH/candidates/java/8.0.201-oracle]\n[INFO] Changes detected - recompiling the module!\n[INFO] Compiling 11 source files to /core-geonetwork/web/target/test-classes\n...\n2020-10-23 07:58:42,184 FATAL [jeeves.engine] -    Exception : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.8\"\n2020-10-23 07:58:42,189 FATAL [jeeves.engine] -    Message   : Java 8 required, cannot start with \"11.0.8\"\n2020-10-23 07:58:42,192 FATAL [jeeves.engine] -    Stack     : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.8\"\n\tat jeeves.config.springutil.JeevesContextLoaderListener.contextInitialized(JeevesContextLoaderListener.java:63)\n\n\nApart of the toolchain stuff, the change works fine, starts up fine with Java 8 and throws the exception if other version is used.", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#discussion_r510643021", "createdAt": "2020-10-23T06:02:01Z", "author": {"login": "josegar74"}, "path": "software_development/BUILDING.md", "diffHunk": "@@ -97,3 +97,26 @@ For changes related to the user interface in the `web-ui` module or the metadata\n ```\n mvn process-resources\n ```\n+\n+Tool chain\n+----------\n+\n+GeoNetwork requires Java 8 at this time. If you have multiple JDK environments installed\n+our build can make use of an optional `~/.m2/toolchain.xml` file.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "953e963cbf5315674950f171b6d7c973c9dbbe4f"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611220a19af3160ef1071a8aecaae25335398c58", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/611220a19af3160ef1071a8aecaae25335398c58", "committedDate": "2020-10-23T07:00:24Z", "message": "Check java 8 on Jeeves startup\n\nFailing here will prevent geonetwork from loading in an unsupported environment (and provide a clear error message)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "committedDate": "2020-10-23T07:01:03Z", "message": "Optional use of toolchains.xml to always build on JDK 8"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "953e963cbf5315674950f171b6d7c973c9dbbe4f", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/953e963cbf5315674950f171b6d7c973c9dbbe4f", "committedDate": "2020-10-23T04:15:11Z", "message": "java 8 only"}, "afterCommit": {"oid": "77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "author": {"user": {"login": "jodygarnett", "name": "Jody Garnett"}}, "url": "https://github.com/geonetwork/core-geonetwork/commit/77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "committedDate": "2020-10-23T07:01:03Z", "message": "Optional use of toolchains.xml to always build on JDK 8"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTgxMTQz", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#pullrequestreview-561581143", "createdAt": "2021-01-05T08:04:31Z", "commit": {"oid": "77e8618942869f2496ed4b8c4ed98fbf1b2d652f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1761, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}