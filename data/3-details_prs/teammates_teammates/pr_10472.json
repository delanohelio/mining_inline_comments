{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2ODg3NzE1", "number": 10472, "title": "[#10470] Add v6 instructor join link support", "bodyText": "Fixes #10470\nOutline of Solution: Add institute mac when institute is present during routing from old join link to new one", "createdAt": "2020-07-27T04:20:57Z", "url": "https://github.com/TEAMMATES/teammates/pull/10472", "merged": true, "mergeCommit": {"oid": "1ff44d2b020b4d0d00c4db3af80825f05b1df3ce"}, "closed": true, "closedAt": "2020-07-28T16:39:11Z", "author": {"login": "madanalogy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc462E2AFqTQ1NTQ3Njk1OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5YyHzAH2gAyNDU2ODg3NzE1OmVjNmI2NTRkNjUxYWRlMDIxYjFlZjYyZmFkZTZiOTcwZWJkODcxYmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDc2OTU4", "url": "https://github.com/TEAMMATES/teammates/pull/10472#pullrequestreview-455476958", "createdAt": "2020-07-27T05:18:54Z", "commit": {"oid": "0b9cb408a10604b9c55514c519025633295a53ba"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNToxODo1NFrOG3T81g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNToxODo1NFrOG3T81g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY1MTczNA==", "bodyText": "You can just put this into the the template html.", "url": "https://github.com/TEAMMATES/teammates/pull/10472#discussion_r460651734", "createdAt": "2020-07-27T05:18:54Z", "author": {"login": "xpdavid"}, "path": "src/web/app/user-join-page.component.ts", "diffHunk": "@@ -18,6 +18,8 @@ import { ErrorMessageOutput } from './error-message-output';\n })\n export class UserJoinPageComponent implements OnInit {\n \n+  link: string = '/web/front/request';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b9cb408a10604b9c55514c519025633295a53ba"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NTEzNzIw", "url": "https://github.com/TEAMMATES/teammates/pull/10472#pullrequestreview-455513720", "createdAt": "2020-07-27T06:54:48Z", "commit": {"oid": "b53fdfec676532d4d9147f6218017f55576a9c7d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNjo1NDo0OFrOG3Vx6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNjo1NTowMlrOG3VyZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY4MTcwNg==", "bodyText": "Requesting a new join link is not the same as requesting a new account; the latter creates a duplicate sample course.", "url": "https://github.com/TEAMMATES/teammates/pull/10472#discussion_r460681706", "createdAt": "2020-07-27T06:54:48Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/user-join-page.component.html", "diffHunk": "@@ -12,7 +12,8 @@ <h3>Not logged in</h3>\n       <h3>Invalid course join link</h3>\n     </div>\n     <div class=\"card-body\" *ngIf=\"!validUrl\">\n-      You are using an invalid join link. Please <a [routerLink]=\"link\">request for a new join link</a> or check that you copied the URL entirely.\n+      You are using an invalid join link. Please <a routerLink=\"/web/front/request\">request for a new join link</a>\n+      or check that you copied the URL entirely.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b53fdfec676532d4d9147f6218017f55576a9c7d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY4MTgyOA==", "bodyText": "Not necessary; this can be removed.", "url": "https://github.com/TEAMMATES/teammates/pull/10472#discussion_r460681828", "createdAt": "2020-07-27T06:55:02Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/app.module.ts", "diffHunk": "@@ -84,6 +84,12 @@ const routes: Routes = [\n       },\n     ],\n   },\n+  {\n+    // This path is added to support redirection of v6 join link to v7\n+    path: 'page/instructorCourseJoin',\n+    pathMatch: 'full',\n+    redirectTo: 'web/join',\n+  },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b53fdfec676532d4d9147f6218017f55576a9c7d"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b53fdfec676532d4d9147f6218017f55576a9c7d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b53fdfec676532d4d9147f6218017f55576a9c7d", "committedDate": "2020-07-27T06:29:38Z", "message": "Move routerLink to html"}, "afterCommit": {"oid": "2b89ff77c6c44be1ce283ed12f7d02556c1b720d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2b89ff77c6c44be1ce283ed12f7d02556c1b720d", "committedDate": "2020-07-28T03:34:54Z", "message": "Remove institution validation for v6 join link support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b17b7e8835c5d3dab0535432c462179f352f27e2", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b17b7e8835c5d3dab0535432c462179f352f27e2", "committedDate": "2020-07-28T04:16:39Z", "message": "Add v6 instructor join link support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b89ff77c6c44be1ce283ed12f7d02556c1b720d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2b89ff77c6c44be1ce283ed12f7d02556c1b720d", "committedDate": "2020-07-28T03:34:54Z", "message": "Remove institution validation for v6 join link support"}, "afterCommit": {"oid": "b17b7e8835c5d3dab0535432c462179f352f27e2", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b17b7e8835c5d3dab0535432c462179f352f27e2", "committedDate": "2020-07-28T04:16:39Z", "message": "Add v6 instructor join link support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDgyNzI2", "url": "https://github.com/TEAMMATES/teammates/pull/10472#pullrequestreview-456482726", "createdAt": "2020-07-28T09:57:54Z", "commit": {"oid": "b17b7e8835c5d3dab0535432c462179f352f27e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Nzc2NzM1", "url": "https://github.com/TEAMMATES/teammates/pull/10472#pullrequestreview-456776735", "createdAt": "2020-07-28T15:54:10Z", "commit": {"oid": "a9e134d3fc75f388b92601f57855bd43f29c6234"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTo1NDoxMVrOG4TXgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTo1NDoxMVrOG4TXgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY5MDc1NQ==", "bodyText": "Not necessary. This entire class will be removed in the first place once V6 is decommissioned.", "url": "https://github.com/TEAMMATES/teammates/pull/10472#discussion_r461690755", "createdAt": "2020-07-28T15:54:11Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/action/LegacyUrlMapper.java", "diffHunk": "@@ -31,10 +33,17 @@ public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOExc\n         switch (uri) {\n         case Const.LegacyURIs.INSTRUCTOR_COURSE_JOIN:\n             key = req.getParameter(Const.ParamsNames.REGKEY);\n-            redirectUrl = Config.getFrontEndAppUrl(Const.WebPageURIs.JOIN_PAGE)\n+            String institute = req.getParameter(Const.ParamsNames.INSTRUCTOR_INSTITUTION);\n+            AppUrl newUrl = Config.getFrontEndAppUrl(Const.WebPageURIs.JOIN_PAGE)\n                     .withRegistrationKey(key)\n-                    .withParam(Const.ParamsNames.ENTITY_TYPE, Const.EntityType.INSTRUCTOR)\n-                    .toString();\n+                    .withParam(Const.ParamsNames.ENTITY_TYPE, Const.EntityType.INSTRUCTOR);\n+            // TODO: Remove the following code block for mac generation once v6 join links stop being supported", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e134d3fc75f388b92601f57855bd43f29c6234"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9e134d3fc75f388b92601f57855bd43f29c6234", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a9e134d3fc75f388b92601f57855bd43f29c6234", "committedDate": "2020-07-28T15:15:03Z", "message": "Add TODO comment for future removal"}, "afterCommit": {"oid": "b17b7e8835c5d3dab0535432c462179f352f27e2", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b17b7e8835c5d3dab0535432c462179f352f27e2", "committedDate": "2020-07-28T04:16:39Z", "message": "Add v6 instructor join link support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec6b654d651ade021b1ef62fade6b970ebd871bc", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ec6b654d651ade021b1ef62fade6b970ebd871bc", "committedDate": "2020-07-28T16:12:14Z", "message": "Merge branch 'master' into 10470-joinLink"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4313, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}