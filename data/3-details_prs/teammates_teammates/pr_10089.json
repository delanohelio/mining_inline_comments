{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMDU0MzYw", "number": 10089, "title": "[#9382] Add almost all comment features for result page", "bodyText": "Part of #9382\nContinue from #10011 and close #10011 (also close #9778) when merged.\nFeatures\nInstructor Comment:\n\n\n\nParticipant Comment:\n\n\nOutline of Solution\nThe components of comment features have been highly modularized. Here is the hierarchy.\n\nCommentTableModalComponent\n\nCommentTableComponent\n\nCommentRowComponent\n\nCommentEditFormComponent\n\n\n\n\n\n\n\nFor several considerations, the instructor comments are NOT updated in sectionsModel and questionsModel:\n\nThere are two points of truth sectionsModel and questionsModel. It is hard to sync them\nThere are many data transformations in the result page. For performance consideration, we shall not update those two models (as every time the models change, the sub-components will recompute the transformation, we purposely design this as the page is read-only except for the instructor comment)\n\nInstead, we make a map at the root page from responseId to CommentTableModel.\ninstructorCommentTableModel: Record<string, CommentTableModel> = {};\nWe make here as the single point of truth for instructor comments.\nAll API requests are sent from the root page (so this would close #10010) and the coupling within components are minimized.", "createdAt": "2020-05-20T22:38:28Z", "url": "https://github.com/TEAMMATES/teammates/pull/10089", "merged": true, "mergeCommit": {"oid": "7ab5310cc81203fa8d09f694ace958142faf4842"}, "closed": true, "closedAt": "2020-05-22T01:13:23Z", "author": {"login": "xpdavid"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjQGJzAH2gAyNDIxMDU0MzYwOjgyNjc3ZGMzNmVlYmEzYzI5YjVjMDI2MmQ3N2M3NjkxYjRkMzFlMzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjk-o9AH2gAyNDIxMDU0MzYwOjZjYjZhNmIzNDhiYWUxMGU3MjE5MzA3YTJjYWNmY2RkZTIwMGQ5NGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "82677dc36eeba3c29b5c0262d77c7691b4d31e32", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/82677dc36eeba3c29b5c0262d77c7691b4d31e32", "committedDate": "2020-05-20T21:38:38Z", "message": "finish get instructor endpoint, also fix regression from #10004"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9613774003b3d1f897287d4ebbd8e0dcabe256b9", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9613774003b3d1f897287d4ebbd8e0dcabe256b9", "committedDate": "2020-05-20T22:11:27Z", "message": "add participant comment for gqr gqr per-question view"}, "afterCommit": {"oid": "69378de3684d1e75d7d6e19a5b858827b639e74e", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/69378de3684d1e75d7d6e19a5b858827b639e74e", "committedDate": "2020-05-21T00:06:05Z", "message": "add participant comment for gqr gqr per-question view"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b177e3a13d20f015ccaa18c6d36865effd8953af", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b177e3a13d20f015ccaa18c6d36865effd8953af", "committedDate": "2020-05-21T00:28:52Z", "message": "add comment feature for per-question view"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2bff871a1cbc27254360995d3d2e4610a0ec8db", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c2bff871a1cbc27254360995d3d2e4610a0ec8db", "committedDate": "2020-05-21T00:28:52Z", "message": "add comment feature for gqr rqg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9da40635722100c9d12e2f3f0654defe770144c6", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9da40635722100c9d12e2f3f0654defe770144c6", "committedDate": "2020-05-21T00:28:52Z", "message": "add comment feature for rgq grq view"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35420267c93e71551e9100823e055c5655d689e9", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/35420267c93e71551e9100823e055c5655d689e9", "committedDate": "2020-05-21T00:28:52Z", "message": "add participant comment for grq rgq view"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7174a16093fa737069a03b4a215a37ad7c352890", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7174a16093fa737069a03b4a215a37ad7c352890", "committedDate": "2020-05-21T00:28:53Z", "message": "fix bug in #10066"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a1ae2e6e3a53533fac967da0d742808d782eef1", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7a1ae2e6e3a53533fac967da0d742808d782eef1", "committedDate": "2020-05-21T00:28:53Z", "message": "add participant comment for gqr gqr per-question view"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "69378de3684d1e75d7d6e19a5b858827b639e74e", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/69378de3684d1e75d7d6e19a5b858827b639e74e", "committedDate": "2020-05-21T00:06:05Z", "message": "add participant comment for gqr gqr per-question view"}, "afterCommit": {"oid": "7a1ae2e6e3a53533fac967da0d742808d782eef1", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7a1ae2e6e3a53533fac967da0d742808d782eef1", "committedDate": "2020-05-21T00:28:53Z", "message": "add participant comment for gqr gqr per-question view"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MTQ1MDUy", "url": "https://github.com/TEAMMATES/teammates/pull/10089#pullrequestreview-416145052", "createdAt": "2020-05-21T13:29:53Z", "commit": {"oid": "7a1ae2e6e3a53533fac967da0d742808d782eef1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMzoyOTo1M1rOGYyzUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMzoyOTo1M1rOGYyzUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODY1MTM0NQ==", "bodyText": "This line should not be here?", "url": "https://github.com/TEAMMATES/teammates/pull/10089#discussion_r428651345", "createdAt": "2020-05-21T13:29:53Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -257,12 +290,23 @@ public String getQuestionStatistics() {\n             this.recipientTeam = recipientTeam;\n             this.recipientSection = recipientSection;\n             this.responseDetails = responseDetails;\n+            this.participantComment = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a1ae2e6e3a53533fac967da0d742808d782eef1"}, "originalPosition": 182}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c989cc2731cd3f010a795dcc8c3d415d633a16b", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4c989cc2731cd3f010a795dcc8c3d415d633a16b", "committedDate": "2020-05-21T15:44:36Z", "message": "Merge branch 'master' into 9382-partial-comment-feature"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cb6a6b348bae10e7219307a2cacfcdde200d94d", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6cb6a6b348bae10e7219307a2cacfcdde200d94d", "committedDate": "2020-05-21T21:58:26Z", "message": "remove redundant null assignment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4408, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}