{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMjY0Nzk0", "number": 10259, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxNTo0NFrOEKMtkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0ODozMFrOEKWgXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MTI5NDkwOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxNTo0NFrOGrGlKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwMjo0OTowMlrOGr7nkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA==", "bodyText": "Use triggerModelChange('isCollapsed', !model.isCollapsed)", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447849768", "createdAt": "2020-06-30T17:15:44Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxNTE5NA==", "bodyText": "What's the difference using triggerModelChange? I don't think it matters for saving the model?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448315194", "createdAt": "2020-07-01T12:02:35Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxNDQ0OQ==", "bodyText": "If we don't fire event to change the model explicitly but change it silently like this. This will cause hard-to-find bug like this (more technically, the information flow between child and parent component is broken):\nDo you expect the model to change if you do this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [formModel]=\"questionEditFormModels[i]\"></tm-question-edit-form>\nOr this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [(formModel)]=\"questionEditFormModels[i]\"></tm-question-edit-form>\nOr this?\n<tm-question-edit-form [formMode]=\"QuestionEditFormMode.EDIT\"\n                         [formModel]=\"questionEditFormModels[i]\" (formModelChange)=\"questionEditFormModels[i] = $event\"></tm-question-edit-form>\nP.S. The behavior of the second and the third one are the same.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448614449", "createdAt": "2020-07-01T21:02:08Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcxODczOA==", "bodyText": "So the point of emitting the event is to force Angular to detect the change and update the model right?\nMy thought was that since saveExistingQuestionHandler doesn't make use of the isChanged field, it wouldn't break anything, even if the parent and child are de-synced. But I guess it is better to be future-proof.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448718738", "createdAt": "2020-07-02T02:49:02Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA=="}, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MTMwNDA5OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxODoxNVrOGrGq5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxODoxNVrOGrGq5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTIzNg==", "bodyText": "I hope you can understand why you can directly change the model here.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851236", "createdAt": "2020-06-30T17:18:15Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -884,6 +893,18 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       { courseid: this.courseId, fsname: this.feedbackSessionName, previewas: this.emailOfInstructorToPreview });\n   }\n \n+  expandAll(): void {\n+    this.questionEditFormModels.forEach(((model: QuestionEditFormModel): void => {\n+      model.isCollapsed = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MTMwNzE1OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/rich-text-editor/rich-text-editor.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxOTowNVrOGrGs2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxOTowNVrOGrGs2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTczNw==", "bodyText": "I think this will cause the style of rich-texst-editor to be changed globally. Can we just pass the property in the place where you need?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851737", "createdAt": "2020-06-30T17:19:05Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/rich-text-editor/rich-text-editor.component.ts", "diffHunk": "@@ -17,7 +17,7 @@ export class RichTextEditorComponent implements OnInit {\n   isInlineMode: boolean = true;\n \n   @Input()\n-  minHeightInPx: number = 150;\n+  minHeightInPx: number = 80;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b594bf6f34092b63fb98a09897f654e3353ae313"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5Mjg5MDc3OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0MTo1N1rOGrVu4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0MTo1N1rOGrVu4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODAxNg==", "bodyText": "I think this should be put at the top.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098016", "createdAt": "2020-07-01T03:41:57Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -306,3 +318,5 @@ export class QuestionEditFormComponent implements OnInit {\n     }, () => {});\n   }\n }\n+\n+const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5Mjg5MTc2OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0Mjo0NVrOGrVveg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0Mjo0NVrOGrVveg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODE3MA==", "bodyText": "I think we can just delete the comment.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098170", "createdAt": "2020-07-01T03:42:45Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -447,14 +448,14 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n    * Converts feedback question to the question edit form model.\n    */\n   private getQuestionEditFormModel(feedbackQuestion: FeedbackQuestion): QuestionEditFormModel {\n-    return {\n+    const model: QuestionEditFormModel = {\n       feedbackQuestionId: feedbackQuestion.feedbackQuestionId,\n \n       questionNumber: feedbackQuestion.questionNumber,\n       questionBrief: feedbackQuestion.questionBrief,\n       questionDescription: feedbackQuestion.questionDescription,\n \n-      isQuestionHasResponses: false, // TODO use API to determine\n+      isQuestionHasResponses: false, // Using loadResponseStatusForQuestion to determine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5Mjg5NDM2OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0NDo0MVrOGrVxHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwMzowMzowM1rOGr700w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA==", "bodyText": "If we just want to fix the bug for not popping up the alert model when saving the second time, I think the root cause is the response status is not updated when saving. Therefore, it is not necessary to add isChanged to the model?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098588", "createdAt": "2020-07-01T03:44:41Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODc1OQ==", "bodyText": "In addition, I don't think this is the correct place to call the method.\n\nget*** should not trigger any side-effect.\nloadResponseStatusForQuestion will be called twice I believe when the page is loaded.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098759", "createdAt": "2020-07-01T03:45:30Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQyNjExMg==", "bodyText": "If we just want to fix the bug for not popping up the alert model when saving the second time, I think the root cause is the response status is not updated when saving. Therefore, it is not necessary to add isChanged to the model?\n\nI added the isChanged as an initial value for the model, since it is definitely unchanged upon creating the edit form model. Not related to the bug.\n\nIn addition, I don't think this is the correct place to call the method.\n* `get***` should not trigger any side-effect.\n\n* `loadResponseStatusForQuestion` will be called twice I believe when the page is loaded.\n\n\nYep. I moved it to within saveExistingQuestionHandler.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448426112", "createdAt": "2020-07-01T15:01:25Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxMjMyMw==", "bodyText": "I added the isChanged as an initial value for the model, since it is definitely unchanged upon creating the edit form model. Not related to the bug.\n\nSo the isChange field is added for better user experience?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448612323", "createdAt": "2020-07-01T20:57:17Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODcyMjEzMQ==", "bodyText": "Yes", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448722131", "createdAt": "2020-07-02T03:03:03Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5Mjg5OTUwOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0ODozMFrOGrV0FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMDo1NjozNlrOGr1Gsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA==", "bodyText": "f?\n\n\nSince we are here. I think we can just create new component for the modal instead of appending it here.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448099348", "createdAt": "2020-07-01T03:48:30Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -277,6 +264,21 @@ <h5>Changing the visibility after collecting responses is not recommended.</h5>\n     </div>\n   </div>\n </div>\n+<ng-template #discardModal let-modal>f", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c891b5e0e55ec1ff9ef61f7a3fd94e129a3e1d6c"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQyMzE2OA==", "bodyText": "* Since we are here. I think we can just create new component for the modal instead of appending it here.\n\n\nI think can deter to UI / UX improvements? I think there are plans to standardize the modals.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448423168", "createdAt": "2020-07-01T14:57:16Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -277,6 +264,21 @@ <h5>Changing the visibility after collecting responses is not recommended.</h5>\n     </div>\n   </div>\n </div>\n+<ng-template #discardModal let-modal>f", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA=="}, "originalCommit": {"oid": "c891b5e0e55ec1ff9ef61f7a3fd94e129a3e1d6c"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODYxMjAxOQ==", "bodyText": "Ok", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448612019", "createdAt": "2020-07-01T20:56:36Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -277,6 +264,21 @@ <h5>Changing the visibility after collecting responses is not recommended.</h5>\n     </div>\n   </div>\n </div>\n+<ng-template #discardModal let-modal>f", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA=="}, "originalCommit": {"oid": "c891b5e0e55ec1ff9ef61f7a3fd94e129a3e1d6c"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3898, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}