{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MTk0NTEz", "number": 10765, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOToxMDowMVrOEqoxyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyNzo0M1rOEwy1nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQzNzUzOnYy", "diffSide": "LEFT", "path": "src/main/java/teammates/logic/core/DataBundleLogic.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOToxMDowMVrOHc9GzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOToxMDowMVrOHc9GzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEyMzM0MQ==", "bodyText": "\ud83d\udc4d this is a major bug in the testing infrastructure, but it seems to be a major widespread change if this is changed now. Let's revert this first and think about what to do to achieve this method's removal.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r500123341", "createdAt": "2020-10-06T09:10:01Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/core/DataBundleLogic.java", "diffHunk": "@@ -409,37 +311,10 @@ private void populateNullSection(StudentAttributes student) {\n         student.section = student.section == null ? \"None\" : student.section;\n     }\n \n-    private AccountAttributes makeAccount(InstructorAttributes instructor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8414b2d36c3af1dd18af9e327417c7f80f14a4c8"}, "originalPosition": 188}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNjU3MjQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/logic/api/Logic.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMTowNjo1MFrOHduFeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMTowNjo1MFrOHduFeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkyNTgxOA==", "bodyText": "I think we need a distinction between \"completed\" and \"attempted\".", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r500925818", "createdAt": "2020-10-07T11:06:50Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/api/Logic.java", "diffHunk": "@@ -719,13 +719,23 @@ public StudentAttributes joinCourseForStudent(String key, String googleId)\n         return studentsLogic.getUnregisteredStudentsForCourse(courseId);\n     }\n \n+    /**\n+     * Checks whether an instructor has completed a feedback session.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c0e721aa47e51917061c7c807e0663e5ee5d6e8"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTk2NDEwOnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/logic/core/FeedbackSessionsLogic.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyMDoxNVrOHmkOdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNFQyMTo0MDo1M1rOHn0iRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMTQ2Mw==", "bodyText": "Can this be extended to also check for student's team name? I don't think this was done before so this can be a future improvement.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510201463", "createdAt": "2020-10-22T14:20:15Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/core/FeedbackSessionsLogic.java", "diffHunk": "@@ -228,8 +227,13 @@ public boolean isFeedbackSessionHasQuestionForStudents(\n         return !allQuestions.isEmpty();\n     }\n \n+    /**\n+     * Checks whether a student has completed a feedback session.\n+     *\n+     * <p> If there is no question for students, the feedback session is completed</p>\n+     */\n     public boolean isFeedbackSessionCompletedByStudent(FeedbackSessionAttributes fsa, String userEmail) {\n-        if (fsa.getRespondingStudentList().contains(userEmail)) {\n+        if (frLogic.hasGiverRespondedForSession(userEmail, fsa.getFeedbackSessionName(), fsa.getCourseId())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUxNzI1NA==", "bodyText": "The function is able to check as we can set the team name to be userEmail.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r511517254", "createdAt": "2020-10-24T21:40:53Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/logic/core/FeedbackSessionsLogic.java", "diffHunk": "@@ -228,8 +227,13 @@ public boolean isFeedbackSessionHasQuestionForStudents(\n         return !allQuestions.isEmpty();\n     }\n \n+    /**\n+     * Checks whether a student has completed a feedback session.\n+     *\n+     * <p> If there is no question for students, the feedback session is completed</p>\n+     */\n     public boolean isFeedbackSessionCompletedByStudent(FeedbackSessionAttributes fsa, String userEmail) {\n-        if (fsa.getRespondingStudentList().contains(userEmail)) {\n+        if (frLogic.hasGiverRespondedForSession(userEmail, fsa.getFeedbackSessionName(), fsa.getCourseId())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMTQ2Mw=="}, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTk3NTM4OnYy", "diffSide": "LEFT", "path": "src/test/java/teammates/logic/core/FeedbackQuestionsLogicTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyMjozOFrOHmkV2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMjo0MzozN1rOHqFrOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMzM1Mw==", "bodyText": "I think this is still a valid test though? Just that the last part should check for giver set instead of the removed field.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510203353", "createdAt": "2020-10-22T14:22:38Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackQuestionsLogicTest.java", "diffHunk": "@@ -601,35 +600,6 @@ public void testDeleteFeedbackQuestionCascade_nonExistentQuestion_shouldFailSile\n         assertNotNull(getQuestionFromDatastore(\"qn3InSession1InCourse1\"));\n     }\n \n-    @Test\n-    public void testDeleteFeedbackQuestionCascade_cascadeDeleteResponseOfStudent_shouldUpdateRespondents() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg5NTIyNg==", "bodyText": "Yup. Added back.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r513895226", "createdAt": "2020-10-29T02:43:37Z", "author": {"login": "xpdavid"}, "path": "src/test/java/teammates/logic/core/FeedbackQuestionsLogicTest.java", "diffHunk": "@@ -601,35 +600,6 @@ public void testDeleteFeedbackQuestionCascade_nonExistentQuestion_shouldFailSile\n         assertNotNull(getQuestionFromDatastore(\"qn3InSession1InCourse1\"));\n     }\n \n-    @Test\n-    public void testDeleteFeedbackQuestionCascade_cascadeDeleteResponseOfStudent_shouldUpdateRespondents() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMzM1Mw=="}, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTk3NzkyOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/ui/webapi/FeedbackSessionRemindEmailWorkerActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyMzowOFrOHmkXbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyMzowOFrOHmkXbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMzc1Nw==", "bodyText": "I don't think this is necessary anymore. See if removing this line entirely affects anything.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510203757", "createdAt": "2020-10-22T14:23:08Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/ui/webapi/FeedbackSessionRemindEmailWorkerActionTest.java", "diffHunk": "@@ -47,7 +47,7 @@ public void testExecute() throws Exception {\n         FeedbackSessionAttributes session1 = typicalBundle.feedbackSessions.get(\"session1InCourse1\");\n         InstructorAttributes instructor1 = typicalBundle.instructors.get(\"instructor1OfCourse1\");\n \n-        // re-read from Datastore to update the respondents list\n+        // re-read from Datastore to get updated attributes\n         session1 = logic.getFeedbackSession(session1.getFeedbackSessionName(), session1.getCourseId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTk5ODEzOnYy", "diffSide": "LEFT", "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyNzoyMVrOHmkkiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMjo1MDo0MVrOHqF5Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwNzExMg==", "bodyText": "Similarly, this is still a valid test? Just need to change the assertion step.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510207112", "createdAt": "2020-10-22T14:27:21Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "diffHunk": "@@ -836,103 +798,6 @@ public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldDeleteR\n         assertTrue(frcLogic.getFeedbackResponseCommentForResponse(fra2GivenByTeam.getId()).isEmpty());\n     }\n \n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldUpdateInstructorRespondentsCorrectly()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 244}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg5ODg0Nw==", "bodyText": "Method deleteFeedbackResponsesInvolvedTeamOfCourseCascade, deleteFeedbackResponsesInvolvedStudentOfCourseCascade  and deleteFeedbackResponsesInvolvedInstructorOfCourseCascade  are combined to deleteFeedbackResponsesInvolvedEntityOfCourseCascade . Previously the main logic of them are the same except for respondent lists update.\nSo I just make sure we have all test case covered for deleteFeedbackResponsesInvolvedEntityOfCourseCascade", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r513898847", "createdAt": "2020-10-29T02:50:41Z", "author": {"login": "xpdavid"}, "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "diffHunk": "@@ -836,103 +798,6 @@ public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldDeleteR\n         assertTrue(frcLogic.getFeedbackResponseCommentForResponse(fra2GivenByTeam.getId()).isEmpty());\n     }\n \n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldUpdateInstructorRespondentsCorrectly()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwNzExMg=="}, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 244}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NjAwMDMxOnYy", "diffSide": "LEFT", "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyNzo0M1rOHmkl5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyNzo0M1rOHmkl5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwNzQ2Mw==", "bodyText": "Similarly here", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510207463", "createdAt": "2020-10-22T14:27:43Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "diffHunk": "@@ -836,103 +798,6 @@ public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldDeleteR\n         assertTrue(frcLogic.getFeedbackResponseCommentForResponse(fra2GivenByTeam.getId()).isEmpty());\n     }\n \n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldUpdateInstructorRespondentsCorrectly()\n-            throws Exception {\n-        String teamName = \"Team 2.1\";\n-        FeedbackResponseAttributes fra = getResponseFromDatastore(\"response1ForQ1S1C2\");\n-        InstructorAttributes instructor1OfCourse2 = dataBundle.instructors.get(\"instructor1OfCourse2\");\n-        // giver is instructor\n-        assertEquals(FeedbackParticipantType.INSTRUCTORS,\n-                fqLogic.getFeedbackQuestion(fra.getFeedbackQuestionId()).getGiverType());\n-        assertEquals(fra.getGiver(), instructor1OfCourse2.getEmail());\n-        // team is the recipient\n-        assertEquals(fra.getRecipient(), teamName);\n-\n-        // this is the only response the giver has given for the session\n-        assertEquals(1, frLogic.getFeedbackResponsesFromGiverForCourse(fra.getCourseId(), fra.getGiver()).stream()\n-                .filter(response -> response.getFeedbackSessionName().equals(fra.getFeedbackSessionName()))\n-                .count());\n-        // suppose the instructor is in the respondent list\n-        fsLogic.addInstructorRespondent(fra.getGiver(), fra.getFeedbackSessionName(), fra.getCourseId());\n-        assertTrue(\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId())\n-                        .getRespondingInstructorList().contains(fra.getGiver()));\n-\n-        Set<String> studentRespondentsBefore =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingStudentList();\n-\n-        // after the team's responses are deleted\n-        frLogic.deleteFeedbackResponsesInvolvedTeamOfCourseCascade(instructor1OfCourse2.getCourseId(), teamName);\n-\n-        Set<String> studentRespondentsAfter =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingStudentList();\n-        Set<String> instructorRespondentsAfter =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingInstructorList();\n-        // student respondents not change\n-        assertEquals(studentRespondentsBefore, studentRespondentsAfter);\n-        // there is no instructor1OfCourse2 in instructor respondents\n-        assertFalse(instructorRespondentsAfter.contains(fra.getGiver()));\n-    }\n-\n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedInstructorOfCourseCascade_shouldDeleteRelevantResponses()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 283}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3378, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}