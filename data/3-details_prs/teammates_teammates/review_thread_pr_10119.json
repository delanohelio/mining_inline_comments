{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzMTAwMjAz", "number": 10119, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxMzo1OVrOD_z7Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNDowMDoyMVrOD_7WWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MjM3NTk0OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxMzo1OVrOGaskJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwMjowNDo1MFrOGa2_fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0NjMwOQ==", "bodyText": "Let's follow V6 where we should use mailto here.\nhttps://www.w3schools.com/tags/tag_address.asp", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430646309", "createdAt": "2020-05-26T19:13:59Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -32,8 +32,11 @@\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n       {{ isGqr ? 'From' : 'To' }}: {{ userInfo }}\n+      <span *ngIf=\"userToEmail[userInfo]\">\n+        [{{ userToEmail[userInfo] }}]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxNzE1MA==", "bodyText": "Alright will use that!", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430817150", "createdAt": "2020-05-27T02:04:50Z", "author": {"login": "t-cheepeng"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -32,8 +32,11 @@\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n       {{ isGqr ? 'From' : 'To' }}: {{ userInfo }}\n+      <span *ngIf=\"userToEmail[userInfo]\">\n+        [{{ userToEmail[userInfo] }}]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0NjMwOQ=="}, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MjM5MTg1OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxODozM1rOGast9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxODozM1rOGast9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0ODgyMA==", "bodyText": "Whats this indoxOf for?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430648820", "createdAt": "2020-05-26T19:18:33Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -100,6 +106,11 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.recipientTeam].push(response.recipient);\n             this.teamExpanded[response.recipientTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.recipient] = this.userToEmail[response.recipient] || '';\n+          if (this.userToEmail[response.recipient].indexOf(response.recipient) === -1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MjM5MzQxOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxOTowMVrOGasu9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwMjoxOToyMFrOGa3M1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw==", "bodyText": "If you want to check something not to be undefined.\nYou can do\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {\n          \n          \n            \n                      if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail) {", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430649077", "createdAt": "2020-05-26T19:19:01Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';\n+          if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTIyNQ==", "bodyText": "Same here, what the indexOf for?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430649225", "createdAt": "2020-05-26T19:19:17Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';\n+          if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw=="}, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgyMDU2Nw==", "bodyText": "Initially was to check for undefined keys in the map but I forgot to remove it after adding the initialization. Have removed it now", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430820567", "createdAt": "2020-05-27T02:19:20Z", "author": {"login": "t-cheepeng"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';\n+          if (this.userToEmail[response.giver].indexOf(response.giver) === -1 && response.giverEmail !== undefined) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTA3Nw=="}, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MjQwMzM2OnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToyMjowMFrOGas1Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwMjoxNzowNVrOGa3KvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ==", "bodyText": "I think giverEmail will never be null in this case, it would be Anonymous Student xxx@Anonymous Student xxx.com for anonymous response in this case. However this is not what we want right? Maybe follow the hint by checking isGiverVisible and isRecipientVisible?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430650671", "createdAt": "2020-05-26T19:22:00Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -163,6 +164,8 @@ private static String removeAnonymousHash(String identifier) {\n \n             for (FeedbackResponseAttributes response : responsesForRecipient) {\n                 String giverName = removeAnonymousHash(bundle.getGiverNameForResponse(response));\n+                String giverEmail = bundle.getDisplayableEmailGiver(response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxNzMyOQ==", "bodyText": "So we send a null from backend if the Giver/Recipient is not visible right?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430817329", "createdAt": "2020-05-27T02:05:36Z", "author": {"login": "t-cheepeng"}, "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -163,6 +164,8 @@ private static String removeAnonymousHash(String identifier) {\n \n             for (FeedbackResponseAttributes response : responsesForRecipient) {\n                 String giverName = removeAnonymousHash(bundle.getGiverNameForResponse(response));\n+                String giverEmail = bundle.getDisplayableEmailGiver(response);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ=="}, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgyMDAyOA==", "bodyText": "Of course or why we use @Nullable?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430820028", "createdAt": "2020-05-27T02:17:05Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -163,6 +164,8 @@ private static String removeAnonymousHash(String identifier) {\n \n             for (FeedbackResponseAttributes response : responsesForRecipient) {\n                 String giverName = removeAnonymousHash(bundle.getGiverNameForResponse(response));\n+                String giverEmail = bundle.getDisplayableEmailGiver(response);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY1MDY3MQ=="}, "originalCommit": {"oid": "1b847c7042e36945fd049d25e2d778cf2dc7cdc0"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MzU5MjM2OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNDowMDoxNVrOGa4pNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNDoxODozNFrOGa44BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDIxNQ==", "bodyText": "This is no necessary if you have *ngIf=\"userToEmail[userInfo]\"?", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430844215", "createdAt": "2020-05-27T04:00:15Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0ODAwNQ==", "bodyText": "done", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430848005", "createdAt": "2020-05-27T04:18:34Z", "author": {"login": "t-cheepeng"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -83,6 +85,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n             this.teamExpanded[response.giverTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.giver] = this.userToEmail[response.giver] || '';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDIxNQ=="}, "originalCommit": {"oid": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MzU5MjU2OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNDowMDoyMVrOGa4pUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNDowMDoyMVrOGa4pUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg0NDI0Mg==", "bodyText": "Same here and other places", "url": "https://github.com/TEAMMATES/teammates/pull/10119#discussion_r430844242", "createdAt": "2020-05-27T04:00:21Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -100,6 +106,10 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             this.teamsToUsers[response.recipientTeam].push(response.recipient);\n             this.teamExpanded[response.recipientTeam] = this.isExpandAll;\n           }\n+          this.userToEmail[response.recipient] = this.userToEmail[response.recipient] || '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e61f4cd0e56f83597d842510ef12e0cfdf7b6d77"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4005, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}