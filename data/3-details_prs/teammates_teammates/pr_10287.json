{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1OTM2ODA5", "number": 10287, "title": "[#10264] Remove Student Google ID from Output", "bodyText": "Part of #10264\nAdded new method in StudentData to manage data output obfuscation.", "createdAt": "2020-07-08T04:18:24Z", "url": "https://github.com/TEAMMATES/teammates/pull/10287", "merged": true, "mergeCommit": {"oid": "a5f15f9f634d1b988b3f6f50a85959365da48b1b"}, "closed": true, "closedAt": "2020-07-11T04:13:50Z", "author": {"login": "madanalogy"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcy1DAigFqTQ0NDQ2NzczNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczm7WHAH2gAyNDQ1OTM2ODA5OjQ5ZDZkMGZjMTFlZDdiMTlkOWU2NjgzOWY5NGU3YmQ4MDBhMDY1MjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NDY3NzM0", "url": "https://github.com/TEAMMATES/teammates/pull/10287#pullrequestreview-444467734", "createdAt": "2020-07-08T07:10:33Z", "commit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjIxNjY4", "url": "https://github.com/TEAMMATES/teammates/pull/10287#pullrequestreview-444621668", "createdAt": "2020-07-08T10:39:08Z", "commit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDozOTowOFrOGuiJ6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDo0NTo1NFrOGuiXHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ0NzI3NQ==", "bodyText": "This is insufficient as googleId still leaks", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r451447275", "createdAt": "2020-07-08T10:39:08Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/action/GetStudentsAction.java", "diffHunk": "@@ -43,18 +44,14 @@ public ActionResult execute() {\n         if (teamName == null) {\n             // request to get all students of a course by instructor\n             List<StudentAttributes> studentsForCourse = logic.getStudentsForCourse(courseId);\n-            return new JsonResult(new StudentsData(studentsForCourse));\n+            StudentsData studentsData = new StudentsData(studentsForCourse);\n+            studentsData.getStudents().forEach(StudentData::hideInformationForInstructor);\n+            return new JsonResult(studentsData);\n         } else {\n             // request to get team members by current student\n             List<StudentAttributes> studentsForTeam = logic.getStudentsForTeam(teamName, courseId);\n             StudentsData studentsData = new StudentsData(studentsForTeam);\n-\n-            // hide information for students\n-            studentsData.getStudents().forEach(s -> {\n-                s.setComments(null);\n-                s.setJoinState(null);\n-            });\n-\n+            studentsData.getStudents().forEach(StudentData::hideInformationForStudent);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ0ODc2OQ==", "bodyText": "I don't think this is necessary because the registration key is not set as part of constructor (i.e. it needs to be explicitly set).\nBut having said that, googleId also needs to be treated the same, i.e. needs to be explicitly set. This will also make the line before this redundant.", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r451448769", "createdAt": "2020-07-08T10:42:04Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/output/StudentData.java", "diffHunk": "@@ -116,12 +116,29 @@ public void hideLastName() {\n         setLastName(null);\n     }\n \n+    /**\n+     * Hides some attributes to instructor on a search.\n+     */\n+    public void hideInformationForInstructorSearch() {\n+        hideInformationForInstructor();\n+        setComments(null);\n+        setInstitute(null);\n+    }\n+\n     /**\n      * Hides some attributes to instructor.\n      */\n     public void hideInformationForInstructor() {\n         setGoogleId(null);\n+        setKey(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1MDY1Mg==", "bodyText": "This is not necessary if the information is not sensitive because:\n\nIt does not save any DB retrieval cost\nIt does save the byte transferred, but comments and institute are never that large to warrant that kind of saving\nThese information are accessible from some other instructor endpoints that are not search, which defeats any goal of information hiding\nHaving this method requires some maintenance effort, e.g. \"why these fields?\", \"why only for instructor search?\"\n\nAdd: I realize I included institute in the issue description (although I did put it as \"good to hide\"). Let's invert the way we look at this: in which situation do we need institute, comments, etc.? Only during those time then we include the said fields.", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r451450652", "createdAt": "2020-07-08T10:45:54Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/output/StudentData.java", "diffHunk": "@@ -116,12 +116,29 @@ public void hideLastName() {\n         setLastName(null);\n     }\n \n+    /**\n+     * Hides some attributes to instructor on a search.\n+     */\n+    public void hideInformationForInstructorSearch() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57a83972d927d5d21aaffbbfe7fe6b6d85c3b299", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/57a83972d927d5d21aaffbbfe7fe6b6d85c3b299", "committedDate": "2020-07-08T04:15:50Z", "message": "Remove unnecessary student googleId output"}, "afterCommit": {"oid": "4a71e3752492a3b3f4ce224834d29e0ce70e316b", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4a71e3752492a3b3f4ce224834d29e0ce70e316b", "committedDate": "2020-07-08T14:51:08Z", "message": "Remove unnecessary student googleId output"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MzM5ODI5", "url": "https://github.com/TEAMMATES/teammates/pull/10287#pullrequestreview-445339829", "createdAt": "2020-07-09T07:03:29Z", "commit": {"oid": "86fc456c3ddc6a4fef4d0e3b97c7641f59ce03c9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNzowMzoyOVrOGvEQPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNzowNDoxM1rOGvERbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAwNTk0OQ==", "bodyText": "Even this is not necessary. This is not really hiding anything.", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r452005949", "createdAt": "2020-07-09T07:03:29Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/ui/webapi/action/SearchStudentsAction.java", "diffHunk": "@@ -93,9 +93,9 @@ public ActionResult execute() {\n             if (userInfo.isAdmin && entity.equals(Const.EntityType.ADMIN)) {\n                 studentData.addAdditionalInformationForAdminSearch(\n                         StringHelper.encrypt(s.getKey()),\n-                        getInstituteFromCourseId(s.getCourse()));\n+                        getInstituteFromCourseId(s.getCourse()), s.getGoogleId());\n             } else {\n-                studentData.hideInformationForInstructor();\n+                studentData.hideInformationForSearch();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86fc456c3ddc6a4fef4d0e3b97c7641f59ce03c9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjAwNjI1Mg==", "bodyText": "Need to assertNull the registration key as well", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r452006252", "createdAt": "2020-07-09T07:04:13Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/test/cases/webapi/GetStudentActionTest.java", "diffHunk": "@@ -32,6 +32,7 @@ protected String getRequestMethod() {\n \n     private void assertStudentDataMatches(StudentData studentData, StudentAttributes student,\n                                           boolean isRequestFromInstructor) {\n+        assertNull(studentData.getGoogleId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86fc456c3ddc6a4fef4d0e3b97c7641f59ce03c9"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "09c617350198a05223137c023cf125b95e433c1a", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/09c617350198a05223137c023cf125b95e433c1a", "committedDate": "2020-07-10T01:25:46Z", "message": "Remove student search as instructor obfuscation"}, "afterCommit": {"oid": "1646911bf61820f67bbe29762ed5ea696b90069d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1646911bf61820f67bbe29762ed5ea696b90069d", "committedDate": "2020-07-10T03:27:20Z", "message": "Remove googleId from StudentData output"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3169e8006251ed6aaed31b28ac2b261e013a5ee", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c3169e8006251ed6aaed31b28ac2b261e013a5ee", "committedDate": "2020-07-10T07:38:56Z", "message": "Remove googleId from StudentData output"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1646911bf61820f67bbe29762ed5ea696b90069d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1646911bf61820f67bbe29762ed5ea696b90069d", "committedDate": "2020-07-10T03:27:20Z", "message": "Remove googleId from StudentData output"}, "afterCommit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7aed6ca688f7b744c264673c59a38a5655397a6a", "committedDate": "2020-07-10T07:54:25Z", "message": "Refactor frontend use of JoinState"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MTk4NTIx", "url": "https://github.com/TEAMMATES/teammates/pull/10287#pullrequestreview-446198521", "createdAt": "2020-07-10T07:58:12Z", "commit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwNzo1ODoxMlrOGvtuCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwNzo1ODo0M1rOGvtu6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY4NTMyMA==", "bodyText": "Can shorten to joinState?: JoinState", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r452685320", "createdAt": "2020-07-10T07:58:12Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/student-list/join-state.pipe.ts", "diffHunk": "@@ -12,7 +12,7 @@ export class JoinStatePipe implements PipeTransform {\n   /**\n    * Transforms {@code JoinState} to a join state display for the student list component.\n    */\n-  transform(joinState: JoinState): any {\n+  transform(joinState: JoinState | undefined): any {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY4NTQwNg==", "bodyText": "Similarly can shorten to status?: JoinState", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r452685406", "createdAt": "2020-07-10T07:58:27Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/student-list/student-list-section-data.ts", "diffHunk": "@@ -16,7 +16,7 @@ export interface StudentListSectionData {\n export interface StudentListStudentData {\n   name: string;\n   email: string;\n-  status: JoinState;\n+  status: JoinState | undefined;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY4NTU0Ng==", "bodyText": "I don't think this file needs any change", "url": "https://github.com/TEAMMATES/teammates/pull/10287#discussion_r452685546", "createdAt": "2020-07-10T07:58:43Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/student.service.ts", "diffHunk": "@@ -158,13 +158,12 @@ export class StudentService {\n           || this.tableComparatorService.compare(SortBy.TEAM_NAME, SortOrder.ASC, a.teamName, b.teamName)\n           || this.tableComparatorService.compare(SortBy.STUDENT_NAME, SortOrder.ASC, a.name, b.name);\n     });\n-    const joinStatePipe: JoinStatePipe = new JoinStatePipe();\n     students.forEach((student: Student) => {\n       const studentRow: string[] = [\n         student.teamName ? student.teamName : '',\n         student.name,\n         student.lastName ? student.lastName : '',\n-        joinStatePipe.transform(student.joinState),\n+        new JoinStatePipe().transform(student.joinState),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5671e67a5e063a08fa2cbe596936668be99eebfe", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5671e67a5e063a08fa2cbe596936668be99eebfe", "committedDate": "2020-07-10T10:53:26Z", "message": "Refactor frontend use of JoinState"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7aed6ca688f7b744c264673c59a38a5655397a6a", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7aed6ca688f7b744c264673c59a38a5655397a6a", "committedDate": "2020-07-10T07:54:25Z", "message": "Refactor frontend use of JoinState"}, "afterCommit": {"oid": "5671e67a5e063a08fa2cbe596936668be99eebfe", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5671e67a5e063a08fa2cbe596936668be99eebfe", "committedDate": "2020-07-10T10:53:26Z", "message": "Refactor frontend use of JoinState"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MzM0MTc4", "url": "https://github.com/TEAMMATES/teammates/pull/10287#pullrequestreview-446334178", "createdAt": "2020-07-10T11:41:27Z", "commit": {"oid": "5671e67a5e063a08fa2cbe596936668be99eebfe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15fab3988b514364ed5769309f098c269fe760a7", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/15fab3988b514364ed5769309f098c269fe760a7", "committedDate": "2020-07-10T13:06:08Z", "message": "Merge branch 'master' into 10264-googleId"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49d6d0fc11ed7b19d9e66839f94e7bd800a06521", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/49d6d0fc11ed7b19d9e66839f94e7bd800a06521", "committedDate": "2020-07-10T17:17:26Z", "message": "Merge branch 'master' into 10264-googleId"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4277, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}