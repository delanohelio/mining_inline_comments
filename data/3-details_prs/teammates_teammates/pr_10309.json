{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTczNDE1", "number": 10309, "title": "[#9356] Improve UI for loading indicators", "bodyText": "Fixes #9356, Close #9810\nCredits to @erjillsison for the ground work on the loading spinner component\nSample Screenshots\n\n\n\nOutline of Solution\n\nAdded a directive that uses the loading-spinner-component and tweaked the component look to always be centralised\nUse directive in relevant pages. See commits for exact pages.\nAdded some additional loading indicators to buttons that cause requests to be made to backend, like saving.", "createdAt": "2020-07-13T10:46:01Z", "url": "https://github.com/TEAMMATES/teammates/pull/10309", "merged": true, "mergeCommit": {"oid": "3feb12a4040089305849ac9602a35cb523bbf3ac"}, "closed": true, "closedAt": "2020-07-21T05:28:48Z", "author": {"login": "t-cheepeng"}, "timelineItems": {"totalCount": 32, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1DgDwABqjM1NDY4ODAwOTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc29ZJSAH2gAyNDQ4MTczNDE1OjYzMGY2NjhmZDAxMTQwNmEzMWI5NzVkODNkYjZiM2Q4YTY3NWZhOTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa04f9d5da840508c67c95ce9b197fc20d98c594", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fa04f9d5da840508c67c95ce9b197fc20d98c594", "committedDate": "2020-07-13T10:30:35Z", "message": "Update tests"}, "afterCommit": {"oid": "c575773ec8c71d958016446b0bab865be689a754", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c575773ec8c71d958016446b0bab865be689a754", "committedDate": "2020-07-15T05:07:50Z", "message": "Add spinner to student pages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7466232addb2ccbfb007d1d5d955ac4007d51635", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7466232addb2ccbfb007d1d5d955ac4007d51635", "committedDate": "2020-07-15T05:11:55Z", "message": "Add loading indicator from old PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcffacb10decbab40a3f6e80252dc4a3d8e60176", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bcffacb10decbab40a3f6e80252dc4a3d8e60176", "committedDate": "2020-07-15T05:11:55Z", "message": "Add loading spinner directive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9a68d61189877b7af89c84b8ede96d702555b92", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c9a68d61189877b7af89c84b8ede96d702555b92", "committedDate": "2020-07-15T05:11:56Z", "message": "Add spinner to base page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7", "committedDate": "2020-07-15T05:11:57Z", "message": "Add spinner to instructor home page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fb0d3ed9b4b058552760ef810f09297d618e494", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8fb0d3ed9b4b058552760ef810f09297d618e494", "committedDate": "2020-07-15T05:11:58Z", "message": "Add spinner to instructor course related page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dbffc77c72d15f69fcd6841253e51e998a01516", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1dbffc77c72d15f69fcd6841253e51e998a01516", "committedDate": "2020-07-15T05:12:28Z", "message": "Add spinner to instructor sessions related page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ad04a59367a31acd4bdf6a92951c6ac809951f2", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2ad04a59367a31acd4bdf6a92951c6ac809951f2", "committedDate": "2020-07-15T05:12:31Z", "message": "Add spinner to instructor student related page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fb4bd26b039593630bb104a25339513e0ec3356", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8fb4bd26b039593630bb104a25339513e0ec3356", "committedDate": "2020-07-15T05:12:32Z", "message": "Add spinner to admin pages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "222890e0c8e24f0d140b32f59d4d0e5adc0a0417", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/222890e0c8e24f0d140b32f59d4d0e5adc0a0417", "committedDate": "2020-07-15T05:12:32Z", "message": "Add spinner to session pages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "139b38ccfbee47337ec063b1b3621736926c438e", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/139b38ccfbee47337ec063b1b3621736926c438e", "committedDate": "2020-07-15T05:17:43Z", "message": "Add spinner to student pages"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c575773ec8c71d958016446b0bab865be689a754", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c575773ec8c71d958016446b0bab865be689a754", "committedDate": "2020-07-15T05:07:50Z", "message": "Add spinner to student pages"}, "afterCommit": {"oid": "139b38ccfbee47337ec063b1b3621736926c438e", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/139b38ccfbee47337ec063b1b3621736926c438e", "committedDate": "2020-07-15T05:17:43Z", "message": "Add spinner to student pages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4OTQ4MzQ3", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-448948347", "createdAt": "2020-07-15T13:23:56Z", "commit": {"oid": "bcffacb10decbab40a3f6e80252dc4a3d8e60176"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMzoyMzo1NlrOGx96Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMzoyMzo1NlrOGx96Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0Nzc1NQ==", "bodyText": "Just a small nit haha\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Module for loading spinner\n          \n          \n            \n             * Module for the loading spinner", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455047755", "createdAt": "2020-07-15T13:23:56Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/loading-spinner/loading-spinner.module.ts", "diffHunk": "@@ -1,19 +1,17 @@\n import { CommonModule } from '@angular/common';\n import { NgModule } from '@angular/core';\n import { LoadingSpinnerComponent } from './loading-spinner.component';\n+import { LoadingSpinnerDirective } from './loading-spinner.directive';\n \n /**\n- * Module for the loading-spinner.\n+ * Module for loading spinner", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcffacb10decbab40a3f6e80252dc4a3d8e60176"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDc4NDIz", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-449478423", "createdAt": "2020-07-16T03:14:34Z", "commit": {"oid": "c9a68d61189877b7af89c84b8ede96d702555b92"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMzoxNDozNFrOGyYjxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMzoyNDowM1rOGyYtZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NDM1Ng==", "bodyText": "Yup \ud83d\udc4d  That's exactly the cleanest way to add loading indicator.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455484356", "createdAt": "2020-07-16T03:14:34Z", "author": {"login": "xpdavid"}, "path": "src/web/app/page.component.html", "diffHunk": "@@ -42,9 +42,8 @@\n   </div>\n </nav>\n <tm-loader-bar></tm-loader-bar>\n-<tm-loading-spinner *ngIf=\"isFetchingAuthDetails\"></tm-loading-spinner>\n <tm-toast [(toast)]=\"toast\" aria-live=\"polite\" aria-atomic=\"true\"></tm-toast>\n-<div *ngIf=\"!isFetchingAuthDetails\" id=\"main-content\" class=\"container main-content\">\n+<div *tmIsLoading=\"isFetchingAuthDetails\" id=\"main-content\" class=\"container main-content\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a68d61189877b7af89c84b8ede96d702555b92"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NDgyMA==", "bodyText": "Is the deletion of the snapshot intended? Look like we do have concrete content in the container?", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455484820", "createdAt": "2020-07-16T03:16:09Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-home-page/__snapshots__/instructor-home-page.component.spec.ts.snap", "diffHunk": "@@ -282,475 +226,35 @@ exports[`InstructorHomePageComponent should snap with one course with one feedba\n         </div>\n       </div>\n     </div>\n-  </div><div\n-    class=\"row mb-3\"\n-  >\n+  </div><tm-loading-spinner>\n     <div\n-      class=\"col-4\"\n-    >\n-      <a\n-        class=\"btn btn-primary text-white\"\n-        href=\"/web/instructor/courses?isAddNewCourse=true\"\n-        routerlink=\"/web/instructor/courses\"\n-      >\n-        Add New Course\n-      </a>\n-    </div>\n-    \n-    <div\n-      class=\"col-8\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"float-right\"\n+        class=\"row spinner-border text-primary\"\n+        role=\"status\"\n+      />\n+      <div\n+        class=\"row text-secondary\"\n       >\n-        <strong\n-          class=\"d-inline\"\n-        >\n-           Sort By: \n-        </strong>\n-        <div\n-          class=\"btn-group\"\n-          data-toggle=\"buttons\"\n-        >\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course ID\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course Name\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-            disabled=\"\"\n-          >\n-            Creation Date\n-          </button>\n-        </div>\n+        Loading...\n       </div>\n     </div>\n-  </div><div>\n-    \n+  </tm-loading-spinner><tm-loading-spinner>\n     <div\n-      class=\"card\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"card-header bg-primary text-white course-tab-header\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NTAyMw==", "bodyText": "I think the indentation is not correct.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455485023", "createdAt": "2020-07-16T03:16:53Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-home-page/instructor-home-page.component.html", "diffHunk": "@@ -36,15 +36,16 @@ <h1>Home</h1>\n   </div>\n </div>\n \n-<div *ngIf=\"courseTabModels.length > 0\">\n-  <div class=\"card\" *ngFor=\"let courseTabModel of courseTabModels; let idx = index\">\n-    <div class=\"card-header bg-primary text-white course-tab-header\" (click)=\"courseTabModel.isTabExpanded = handleClick($event, courseTabModel); this.loadFeedbackSessions(courseTabModel);\">\n-      <div class=\"row\">\n-        <div class=\"course-header col-md-6\">\n-          <b>[{{ courseTabModel.course.courseId }}]: {{ courseTabModel.course.courseName }}</b>\n-        </div>\n-        <div class=\"btn-toolbar col-md-6\">\n-          <div class=\"float-right\" *ngIf=\"courseTabModel.isAjaxSuccess; else errorLoadingFeedbackSessions\">\n+<div *tmIsLoading=\"!hasCoursesLoaded\">\n+  <div *ngIf=\"courseTabModels.length > 0\">\n+    <div class=\"card\" *ngFor=\"let courseTabModel of courseTabModels; let idx = index\">\n+      <div class=\"card-header bg-primary text-white course-tab-header\" (click)=\"courseTabModel.isTabExpanded = handleClick($event, courseTabModel); this.loadFeedbackSessions(courseTabModel);\">\n+        <div class=\"row\">\n+          <div class=\"course-header col-md-6\">\n+            <b>[{{ courseTabModel.course.courseId }}]: {{ courseTabModel.course.courseName }}</b>\n+          </div>\n+          <div class=\"btn-toolbar col-md-6\">\n+            <div class=\"float-right\" *ngIf=\"courseTabModel.isAjaxSuccess; else errorLoadingFeedbackSessions\">\n             <span ngbDropdown class=\"padding-right-10px\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NTE4OQ==", "bodyText": "Looks like you need update set hasCoursesLoaded  when testing. Let's check similar case in other tests also.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455485189", "createdAt": "2020-07-16T03:17:34Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-home-page/__snapshots__/instructor-home-page.component.spec.ts.snap", "diffHunk": "@@ -282,475 +226,35 @@ exports[`InstructorHomePageComponent should snap with one course with one feedba\n         </div>\n       </div>\n     </div>\n-  </div><div\n-    class=\"row mb-3\"\n-  >\n+  </div><tm-loading-spinner>\n     <div\n-      class=\"col-4\"\n-    >\n-      <a\n-        class=\"btn btn-primary text-white\"\n-        href=\"/web/instructor/courses?isAddNewCourse=true\"\n-        routerlink=\"/web/instructor/courses\"\n-      >\n-        Add New Course\n-      </a>\n-    </div>\n-    \n-    <div\n-      class=\"col-8\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"float-right\"\n+        class=\"row spinner-border text-primary\"\n+        role=\"status\"\n+      />\n+      <div\n+        class=\"row text-secondary\"\n       >\n-        <strong\n-          class=\"d-inline\"\n-        >\n-           Sort By: \n-        </strong>\n-        <div\n-          class=\"btn-group\"\n-          data-toggle=\"buttons\"\n-        >\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course ID\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course Name\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-            disabled=\"\"\n-          >\n-            Creation Date\n-          </button>\n-        </div>\n+        Loading...\n       </div>\n     </div>\n-  </div><div>\n-    \n+  </tm-loading-spinner><tm-loading-spinner>\n     <div\n-      class=\"card\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"card-header bg-primary text-white course-tab-header\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NDgyMA=="}, "originalCommit": {"oid": "8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NTI2OA==", "bodyText": "In addition, we shall have test case when the courses are loading.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455485268", "createdAt": "2020-07-16T03:17:54Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-home-page/__snapshots__/instructor-home-page.component.spec.ts.snap", "diffHunk": "@@ -282,475 +226,35 @@ exports[`InstructorHomePageComponent should snap with one course with one feedba\n         </div>\n       </div>\n     </div>\n-  </div><div\n-    class=\"row mb-3\"\n-  >\n+  </div><tm-loading-spinner>\n     <div\n-      class=\"col-4\"\n-    >\n-      <a\n-        class=\"btn btn-primary text-white\"\n-        href=\"/web/instructor/courses?isAddNewCourse=true\"\n-        routerlink=\"/web/instructor/courses\"\n-      >\n-        Add New Course\n-      </a>\n-    </div>\n-    \n-    <div\n-      class=\"col-8\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"float-right\"\n+        class=\"row spinner-border text-primary\"\n+        role=\"status\"\n+      />\n+      <div\n+        class=\"row text-secondary\"\n       >\n-        <strong\n-          class=\"d-inline\"\n-        >\n-           Sort By: \n-        </strong>\n-        <div\n-          class=\"btn-group\"\n-          data-toggle=\"buttons\"\n-        >\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course ID\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-          >\n-            Course Name\n-          </button>\n-          <button\n-            class=\"btn btn-light\"\n-            disabled=\"\"\n-          >\n-            Creation Date\n-          </button>\n-        </div>\n+        Loading...\n       </div>\n     </div>\n-  </div><div>\n-    \n+  </tm-loading-spinner><tm-loading-spinner>\n     <div\n-      class=\"card\"\n+      class=\"loading-container\"\n     >\n       <div\n-        class=\"card-header bg-primary text-white course-tab-header\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NDgyMA=="}, "originalCommit": {"oid": "8c2b91ad5b0e74b7efdd083d7a1219ccf4297ea7"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4NjgyMQ==", "bodyText": "This should be in the complete callback?", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r455486821", "createdAt": "2020-07-16T03:24:03Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-student/student-profile-page/student-profile-page.component.ts", "diffHunk": "@@ -66,24 +69,28 @@ export class StudentProfilePageComponent implements OnInit {\n    * Loads the student profile details for this page.\n    */\n   loadStudentProfile(): void {\n+    this.isLoadingStudentProfile = true;\n     this.authService.getAuthUser().subscribe((auth: AuthInfo) => {\n       if (auth.user) {\n         this.id = auth.user.id;\n \n         this.profilePicLink = `${this.backendUrl}/webapi/student/profilePic?user=${this.id}`;\n \n         // retrieve profile once we have the student's googleId\n-        this.studentProfileService.getStudentProfile().subscribe((response: StudentProfile) => {\n-          if (response) {\n-            this.student = response;\n-            this.name = response.name;\n-            this.initStudentProfileForm(this.student);\n-          } else {\n-            this.statusMessageService.showErrorToast('Error retrieving student profile');\n-          }\n-        }, (response: ErrorMessageOutput) => {\n-          this.statusMessageService.showErrorToast(response.error.message);\n-        });\n+        this.studentProfileService.getStudentProfile()\n+            .pipe(finalize(() => this.isLoadingStudentProfile = false))\n+            .subscribe((response: StudentProfile) => {\n+              if (response) {\n+                this.student = response;\n+                this.name = response.name;\n+                this.initStudentProfileForm(this.student);\n+              } else {\n+                this.statusMessageService.showErrorToast('Error retrieving student profile');\n+              }\n+            }, (response: ErrorMessageOutput) => {\n+              this.isLoadingStudentProfile = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "139b38ccfbee47337ec063b1b3621736926c438e"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "666860a91ccec21eaff0719b3badb24a573d87be", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/666860a91ccec21eaff0719b3badb24a573d87be", "committedDate": "2020-07-16T03:49:38Z", "message": "Merge branch 'master' into add-loading-indicator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df679f856389e912501ee399a9dac5d8b66bc8f5", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/df679f856389e912501ee399a9dac5d8b66bc8f5", "committedDate": "2020-07-16T08:33:07Z", "message": "Fix indentation and documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02e33bcdd4297a8bef0a2386f366b69b5689750d", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/02e33bcdd4297a8bef0a2386f366b69b5689750d", "committedDate": "2020-07-16T08:33:11Z", "message": "Remove unnecessary code and hide student home page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdbd4b7825c6b0dd95a35336ff6db13d8f7031a9", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bdbd4b7825c6b0dd95a35336ff6db13d8f7031a9", "committedDate": "2020-07-16T08:33:11Z", "message": "Fix snapshots and add loading snapshots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1faab85770fb24df2a7b2d608052f46de8105054", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1faab85770fb24df2a7b2d608052f46de8105054", "committedDate": "2020-07-16T08:33:13Z", "message": "Change ajax loading gif"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fefd3f270d1e32d36ccad707d9fb4f8b00d45d1b", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fefd3f270d1e32d36ccad707d9fb4f8b00d45d1b", "committedDate": "2020-07-19T06:52:12Z", "message": "Merge branch 'master' into add-loading-indicator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b", "committedDate": "2020-07-19T06:53:38Z", "message": "Remove redundant variable in course details page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ebb3aeedf2f729668af58062d6afef64a60db86", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0ebb3aeedf2f729668af58062d6afef64a60db86", "committedDate": "2020-07-20T04:22:46Z", "message": "Change ajax loading gif to bootstrap spinner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMjg4MzQ5", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-451288349", "createdAt": "2020-07-20T04:28:02Z", "commit": {"oid": "e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNDoyODowMlrOGz3Ygg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNDozMTowNlrOGz3dHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzAzNzk1NA==", "bodyText": "I think we can just delete the if check. There is no need to have a variable to store the csv result.\nThis can just the normal flow where we set isLoadingCsv to true and then to false", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r457037954", "createdAt": "2020-07-20T04:28:02Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-details-page/instructor-course-details-page.component.ts", "diffHunk": "@@ -190,16 +193,16 @@ export class InstructorCourseDetailsPageComponent implements OnInit {\n     let blob: any;\n \n     // Calling REST API only the first time to load the downloadable data\n-    if (this.loading) {\n+    if (this.isLoadingCsv) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzAzODcwMg==", "bodyText": "By right, this field should go to InstructorEditPanelDetail model.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r457038702", "createdAt": "2020-07-20T04:30:03Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-edit-page/instructor-course-edit-page.component.ts", "diffHunk": "@@ -151,6 +151,12 @@ export class InstructorCourseEditPageComponent implements OnInit {\n   allSections: string[] = [];\n   allSessions: string[] = [];\n \n+  isCourseLoading: boolean = false;\n+  isInstructorsLoading: boolean = false;\n+  isSavingCourseEdit: boolean = false;\n+  isSavingNewInstructor: boolean = false;\n+  isSavingInstructorEdit: boolean[] = [];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzAzOTEzMw==", "bodyText": "And therefore we should have panelDetail.isSavingInstructorEdit  = true here.", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r457039133", "createdAt": "2020-07-20T04:31:06Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-edit-page/instructor-course-edit-page.component.ts", "diffHunk": "@@ -374,6 +386,7 @@ export class InstructorCourseEditPageComponent implements OnInit {\n    */\n   saveInstructor(index: number): void {\n     const panelDetail: InstructorEditPanelDetail = this.instructorDetailPanels[index];\n+    this.isSavingInstructorEdit[index] = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5add23f1edcc95022a5b8e55b88d2ecdfdddd6b"}, "originalPosition": 67}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6eb5d75d3e7835c0c2915c254581eac81ba23e37", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6eb5d75d3e7835c0c2915c254581eac81ba23e37", "committedDate": "2020-07-20T05:11:38Z", "message": "Remove check and shift field to model"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e410735170046b1cd7abf34aeccc8640880ac63", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9e410735170046b1cd7abf34aeccc8640880ac63", "committedDate": "2020-07-20T05:11:46Z", "message": "Update snapshots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24b49dda6359f88fc9eb29cd9efd699b89fc05a4", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/24b49dda6359f88fc9eb29cd9efd699b89fc05a4", "committedDate": "2020-07-20T05:12:35Z", "message": "Merge branch 'master' into add-loading-indicator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzAxODg2", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-451301886", "createdAt": "2020-07-20T05:19:23Z", "commit": {"oid": "6eb5d75d3e7835c0c2915c254581eac81ba23e37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNToxOToyNFrOGz4vyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNToxOToyNFrOGz4vyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2MDI5Ng==", "bodyText": "We can delete this line and the variable courseStudentListAsCsv", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r457060296", "createdAt": "2020-07-20T05:19:24Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-details-page/instructor-course-details-page.component.ts", "diffHunk": "@@ -189,24 +189,19 @@ export class InstructorCourseDetailsPageComponent implements OnInit {\n    * Download all the students from a course.\n    */\n   downloadAllStudentsFromCourse(courseId: string): void {\n+    this.isLoadingCsv = true;\n     const filename: string = `${courseId.concat('_studentList')}.csv`;\n     let blob: any;\n \n-    // Calling REST API only the first time to load the downloadable data\n-    if (this.isLoadingCsv) {\n-      blob = new Blob([this.courseStudentListAsCsv], { type: 'text/csv' });\n-      saveAs(blob, filename);\n-    } else {\n-      this.studentService.loadStudentListAsCsv({ courseId })\n-        .pipe(finalize(() => this.isLoadingCsv = false))\n-        .subscribe((resp: string) => {\n-          blob = new Blob([resp], { type: 'text/csv' });\n-          saveAs(blob, filename);\n-          this.courseStudentListAsCsv = resp;\n-        }, (resp: ErrorMessageOutput) => {\n-          this.statusMessageService.showErrorToast(resp.error.message);\n-        });\n-    }\n+    this.studentService.loadStudentListAsCsv({ courseId })\n+      .pipe(finalize(() => this.isLoadingCsv = false))\n+      .subscribe((resp: string) => {\n+        blob = new Blob([resp], { type: 'text/csv' });\n+        saveAs(blob, filename);\n+        this.courseStudentListAsCsv = resp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eb5d75d3e7835c0c2915c254581eac81ba23e37"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzAyMjk4", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-451302298", "createdAt": "2020-07-20T05:20:39Z", "commit": {"oid": "6eb5d75d3e7835c0c2915c254581eac81ba23e37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNToyMDozOVrOGz4yNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNToyMDozOVrOGz4yNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2MDkxOA==", "bodyText": "Sorry about the confusion, I think the field should go to InstructorEditPanel", "url": "https://github.com/TEAMMATES/teammates/pull/10309#discussion_r457060918", "createdAt": "2020-07-20T05:20:39Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-edit-page/instructor-course-edit-page.component.ts", "diffHunk": "@@ -486,14 +486,14 @@ export class InstructorCourseEditPageComponent implements OnInit {\n             originalInstructor: Object.assign({}, resp),\n             originalPanel: this.getInstructorEditPanelModel(resp),\n             editPanel: this.getInstructorEditPanelModel(resp),\n+            isSavingInstructorEdit: false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eb5d75d3e7835c0c2915c254581eac81ba23e37"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "979d8cf8ccd119a55b35fbbd25d61ea00982b222", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/979d8cf8ccd119a55b35fbbd25d61ea00982b222", "committedDate": "2020-07-20T06:02:17Z", "message": "Remove redundant csv variable and shift field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMDgzNjIy", "url": "https://github.com/TEAMMATES/teammates/pull/10309#pullrequestreview-452083622", "createdAt": "2020-07-21T02:30:09Z", "commit": {"oid": "979d8cf8ccd119a55b35fbbd25d61ea00982b222"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c09dc9bc741cd65900f6c51da758e29cd80ce60", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/3c09dc9bc741cd65900f6c51da758e29cd80ce60", "committedDate": "2020-07-21T03:09:05Z", "message": "Merge branch 'master' into add-loading-indicator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "630f668fd011406a31b975d83db6b3d8a675fa96", "author": {"user": {"login": "t-cheepeng", "name": "t-cheepeng"}}, "url": "https://github.com/TEAMMATES/teammates/commit/630f668fd011406a31b975d83db6b3d8a675fa96", "committedDate": "2020-07-21T03:09:40Z", "message": "Update snapshots"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4287, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}