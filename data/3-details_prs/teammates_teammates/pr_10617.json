{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4NDE2MTY2", "number": 10617, "title": "[#10614][#10616] Fix session results page issues", "bodyText": "Fixes #10614\nFixes #10616\n\nOther fixes:\n\nAdd \"not applicable\" for results visible from time for unpublished sessions\nMake the style of merge/expand all button consistent with edit session page", "createdAt": "2020-08-16T08:31:43Z", "url": "https://github.com/TEAMMATES/teammates/pull/10617", "merged": true, "mergeCommit": {"oid": "f48c9579da351f9bc68edede51186e004208eb11"}, "closed": true, "closedAt": "2020-08-18T02:56:28Z", "author": {"login": "niqiukun"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_ZjIxgH2gAyNDY4NDE2MTY2Ojg3MTdiYjg1MjNhNWJjMjQ5MDQzMGQxNjg2N2M5MmY1MjQxMTAyZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc_0SuxAH2gAyNDY4NDE2MTY2OmFhMjM2MDdhZWY0MDM0ZGQ0N2Q1NjVhNWYyODA5OTdjMTlhMjRhOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8717bb8523a5bc2490430d16867c92f5241102d4", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8717bb8523a5bc2490430d16867c92f5241102d4", "committedDate": "2020-08-16T08:29:19Z", "message": "Fix session results page issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d578510243c177beca774f5b144db6cfe791593", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2d578510243c177beca774f5b144db6cfe791593", "committedDate": "2020-08-16T08:51:36Z", "message": "Fix lint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MjAzMTI0", "url": "https://github.com/TEAMMATES/teammates/pull/10617#pullrequestreview-468203124", "createdAt": "2020-08-17T06:51:45Z", "commit": {"oid": "2d578510243c177beca774f5b144db6cfe791593"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MzU2OTQ3", "url": "https://github.com/TEAMMATES/teammates/pull/10617#pullrequestreview-468356947", "createdAt": "2020-08-17T10:44:39Z", "commit": {"oid": "2d578510243c177beca774f5b144db6cfe791593"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMDo0NDozOVrOHBjsPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMDo0NDozOVrOHBjsPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTM5NTM5MQ==", "bodyText": "I might be wrong, but I don't think you need this. Both (unpublish|publish)FeedbackSession endpoint should return the session object itself, which you can use straightaway to construct the new visible from time.", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471395391", "createdAt": "2020-08-17T10:44:39Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -383,7 +402,13 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n       ;\n \n       response.subscribe(() => {\n-        this.router.navigateByUrl('/web/instructor/sessions');\n+        this.loadFeedbackSessionVisibleFromTime(this.courseId, this.fsName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d578510243c177beca774f5b144db6cfe791593"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47", "committedDate": "2020-08-17T12:50:50Z", "message": "Use response from endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NDU2OTI0", "url": "https://github.com/TEAMMATES/teammates/pull/10617#pullrequestreview-468456924", "createdAt": "2020-08-17T13:22:00Z", "commit": {"oid": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMzoyMjowMFrOHBof9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMzoyMjo0MlrOHBohkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ3NDE2Nw==", "bodyText": "If this variable is not read by the HTML file, you can move it to outside the export class definition. That way you don't need this.TIME_FORMAT.", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471474167", "createdAt": "2020-08-17T13:22:00Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -109,6 +109,8 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n   FeedbackSessionPublishStatus: typeof FeedbackSessionPublishStatus = FeedbackSessionPublishStatus;\n   isExpandAll: boolean = false;\n \n+  readonly TIME_FORMAT: string = 'ddd, DD MMM, YYYY, hh:mm A zz';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ3NDU3Nw==", "bodyText": "Are the conditionals isPublished and this.session.resultVisibleFromTimestamp equivalent?", "url": "https://github.com/TEAMMATES/teammates/pull/10617#discussion_r471474577", "createdAt": "2020-08-17T13:22:42Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -382,8 +384,20 @@ export class InstructorSessionResultPageComponent extends InstructorCommentsComp\n           )\n       ;\n \n-      response.subscribe(() => {\n-        this.router.navigateByUrl('/web/instructor/sessions');\n+      response.subscribe((res: FeedbackSession) => {\n+        this.session = res;\n+        if (this.session.resultVisibleFromTimestamp) {\n+          this.formattedResultVisibleFromTime = this.timezoneService\n+            .formatToString(this.session.resultVisibleFromTimestamp, this.session.timeZone, this.TIME_FORMAT);\n+        } else {\n+          this.formattedResultVisibleFromTime = 'Not applicable';\n+        }\n+        if (isPublished) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dba0c88e93d025f1b0a1fa65b091ce05d6c4eb47"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ebd08cfe378583547a27927a9ffe79944dea3d", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/08ebd08cfe378583547a27927a9ffe79944dea3d", "committedDate": "2020-08-17T13:35:29Z", "message": "Move TIME_FORMAT outside class and remove if"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NTY4MDU4", "url": "https://github.com/TEAMMATES/teammates/pull/10617#pullrequestreview-468568058", "createdAt": "2020-08-17T15:29:50Z", "commit": {"oid": "08ebd08cfe378583547a27927a9ffe79944dea3d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa23607aef4034dd47d565a5f280997c19a24a95", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/aa23607aef4034dd47d565a5f280997c19a24a95", "committedDate": "2020-08-17T15:38:50Z", "message": "Merge branch 'master' into result-page-fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4240, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}