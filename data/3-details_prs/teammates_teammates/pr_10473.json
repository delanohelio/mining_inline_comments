{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2ODk1MjIz", "number": 10473, "title": "[#10448] Add question to session: team-contribution questions should not inherit custom visibility from previous question", "bodyText": "Fixes #10448\nThere are two UAT fixes also.\nThe first is button alignment in the question edit form:\nBefore:\n\nAfter:\n\nLooks like it is not fixed and I am wrong in my previous PR.\nThe second is the to add default empty handler when modal is closed (promise is rejected) (or there will be an error in the console)", "createdAt": "2020-07-27T04:50:31Z", "url": "https://github.com/TEAMMATES/teammates/pull/10473", "merged": true, "mergeCommit": {"oid": "b51fcc023dcdf92015d29a6e7cbab711acc48bcb"}, "closed": true, "closedAt": "2020-07-29T09:42:09Z", "author": {"login": "xpdavid"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc46gh8ABqjM1ODgwMjE0OTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5mx-wgH2gAyNDU2ODk1MjIzOjcyY2Q1ZjZlNjgyNWIzZjk4YTc3ZTBhNTUwMzUwZjM1MjBkYTJlYzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bdd8c3692b9d153b7f933cd7ba95300d07f7f1d", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/3bdd8c3692b9d153b7f933cd7ba95300d07f7f1d", "committedDate": "2020-07-27T04:45:18Z", "message": "add empty reject handler to handle modal close event"}, "afterCommit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bccbc4780de4817c3f4b319193b2b339e2ab6b28", "committedDate": "2020-07-27T04:55:16Z", "message": "add empty reject handler to handle modal close event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDcxNDc1", "url": "https://github.com/TEAMMATES/teammates/pull/10473#pullrequestreview-455471475", "createdAt": "2020-07-27T04:58:37Z", "commit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNDo1ODozN1rOG3TqaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNDo1ODozN1rOG3TqaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY0NzAxNw==", "bodyText": "The original issue was only for team contribution questions but it seems this will prevent any inheritance for questions without custom visibility settings allowed? Or are team contribution questions the only with that setting?", "url": "https://github.com/TEAMMATES/teammates/pull/10473#discussion_r460647017", "createdAt": "2020-07-27T04:58:37Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -758,18 +762,50 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n         SHOW_GIVER_NAME: lastQuestionEditFormModel.showGiverNameTo,\n         SHOW_RECIPIENT_NAME: lastQuestionEditFormModel.showRecipientNameTo,\n       });\n-      this.newQuestionEditFormModel.showResponsesTo =\n+      const newQuestionShowResponsesTo: FeedbackVisibilityType[]  =\n           newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_RESPONSE);\n-      this.newQuestionEditFormModel.showGiverNameTo =\n+      const newQuestionShowGiverNameTo: FeedbackVisibilityType[] =\n           newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_GIVER_NAME);\n-      this.newQuestionEditFormModel.showRecipientNameTo =\n-          newQuestionVisibilityStateMachine.getVisibilityTypesUnderVisibilityControl(\n-              VisibilityControl.SHOW_RECIPIENT_NAME);\n+      const newQuestionShowRecipientNameTo: FeedbackVisibilityType[] =\n+          newQuestionVisibilityStateMachine\n+              .getVisibilityTypesUnderVisibilityControl(VisibilityControl.SHOW_RECIPIENT_NAME);\n+\n+      let isAllowedToUseInheritedVisibility: boolean = false;\n+      if (this.feedbackQuestionsService\n+          .isCustomFeedbackVisibilitySettingAllowed(this.newQuestionEditFormModel.questionType)) {\n+        isAllowedToUseInheritedVisibility = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDcyMzQ1", "url": "https://github.com/TEAMMATES/teammates/pull/10473#pullrequestreview-455472345", "createdAt": "2020-07-27T05:01:41Z", "commit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDkzMTM3", "url": "https://github.com/TEAMMATES/teammates/pull/10473#pullrequestreview-456493137", "createdAt": "2020-07-28T10:12:08Z", "commit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e83313567c34ac16b23d2c44f775bcb17c17c27", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9e83313567c34ac16b23d2c44f775bcb17c17c27", "committedDate": "2020-07-29T01:48:47Z", "message": "check whether it is allowed to use custom visibility settings before doing inheritance from previous question"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0882b61b337cfd026d14e5a7582ce528cb93a67", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/f0882b61b337cfd026d14e5a7582ce528cb93a67", "committedDate": "2020-07-29T02:08:56Z", "message": "adjust question edit UI to make save buttons aligned"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "committedDate": "2020-07-29T02:08:56Z", "message": "add empty reject handler to handle modal close event"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bccbc4780de4817c3f4b319193b2b339e2ab6b28", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bccbc4780de4817c3f4b319193b2b339e2ab6b28", "committedDate": "2020-07-27T04:55:16Z", "message": "add empty reject handler to handle modal close event"}, "afterCommit": {"oid": "d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d2fa9884d311f2ec32149eeff92fbd167e85ba2b", "committedDate": "2020-07-29T02:08:56Z", "message": "add empty reject handler to handle modal close event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72cd5f6e6825b3f98a77e0a550350f3520da2ec2", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/72cd5f6e6825b3f98a77e0a550350f3520da2ec2", "committedDate": "2020-07-29T08:30:45Z", "message": "Merge branch 'master' into 10448-question-inheritence"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4314, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}