{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NzU1MTk4", "number": 10145, "title": "[#10141] Extract common code for section filtering to FeedbackResponsesService", "bodyText": "Fixes #10141\nOutline of Solution\n\nextract common code for section filtering to FeedbackResponsesService\ninject the service to all relevant components: GqrRqgViewResponsesComponent, GrqRgqViewResponsesComponent, PerQuestionViewResponsesComponent\nupdate the .spec files for corresponding components", "createdAt": "2020-06-01T05:07:44Z", "url": "https://github.com/TEAMMATES/teammates/pull/10145", "merged": true, "mergeCommit": {"oid": "0d56a74b3b4b1f05b9d8876191f24aa17c4dfef1"}, "closed": true, "closedAt": "2020-06-02T02:41:49Z", "author": {"login": "Derek-Hardy"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm5BWWAH2gAyNDI1NzU1MTk4OjJmNDFjMWEyMjVkMTA0NWIwMzhlZDNmMGE4NGIwYTM2Y2Y0YjY3MTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnLFGHgH2gAyNDI1NzU1MTk4OmJjZGQ5MzRiMmRkMzU5YjQ4NzAxYTFjZGI5ODk0NmU0NDE0NmU5MTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2f41c1a225d1045b038ed3f0a84b0a36cf4b6713", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2f41c1a225d1045b038ed3f0a84b0a36cf4b6713", "committedDate": "2020-06-01T05:01:16Z", "message": "extract common section filtering code to feedbackResponsesService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5008ec3d1e884a20b7d5d4145d7456ce99d33e02", "committedDate": "2020-06-01T05:02:22Z", "message": "updated spec files with HttpClientTestingModule"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjgyMjMx", "url": "https://github.com/TEAMMATES/teammates/pull/10145#pullrequestreview-421682231", "createdAt": "2020-06-01T08:40:26Z", "commit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwODo0MDoyNlrOGdDBbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwODo0MzozOVrOGdDHHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTQwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      const shouldDisplayBasedOnSection: boolean\n          \n          \n            \n                        = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n          \n          \n            \n                            this.sectionType, response);\n          \n          \n            \n                      const shouldDisplayBasedOnSection: boolean = this.feedbackResponsesService\n          \n          \n            \n                        .isFeedbackResponsesDisplayedOnSection(this.section, this.sectionType, response);\n          \n      \n    \n    \n  \n\nMight be worthwhile having this as two lines instead of three, feels cleaner in my opinion", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111405", "createdAt": "2020-06-01T08:40:26Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.ts", "diffHunk": "@@ -129,32 +130,17 @@ export class GqrRqgViewResponsesComponent extends ResponsesInstructorCommentsBas\n             return false;\n           }\n \n-          let shouldDisplayBasedOnSection: boolean = true;\n-          if (this.section) {\n-            switch (this.sectionType) {\n-              case InstructorSessionResultSectionType.EITHER:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section || response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.GIVER:\n-                shouldDisplayBasedOnSection = response.giverSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.EVALUEE:\n-                shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.BOTH:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section && response.recipientSection === this.section;\n-                break;\n-              default:\n-            }\n-          }\n+          const shouldDisplayBasedOnSection: boolean\n+            = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+                this.sectionType, response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTc1NA==", "bodyText": "Similarly here", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111754", "createdAt": "2020-06-01T08:41:10Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -129,32 +130,17 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n             return false;\n           }\n \n-          let shouldDisplayBasedOnSection: boolean = true;\n-          if (this.section) {\n-            switch (this.sectionType) {\n-              case InstructorSessionResultSectionType.EITHER:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section || response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.GIVER:\n-                shouldDisplayBasedOnSection = response.giverSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.EVALUEE:\n-                shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-                break;\n-              case InstructorSessionResultSectionType.BOTH:\n-                shouldDisplayBasedOnSection =\n-                    response.giverSection === this.section && response.recipientSection === this.section;\n-                break;\n-              default:\n-            }\n-          }\n+          const shouldDisplayBasedOnSection: boolean\n+            = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+                this.sectionType, response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMTg5MQ==", "bodyText": "Here as well", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433111891", "createdAt": "2020-06-01T08:41:29Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-responses/per-question-view-responses/per-question-view-responses.component.ts", "diffHunk": "@@ -80,29 +82,15 @@ export class PerQuestionViewResponsesComponent extends ResponsesInstructorCommen\n       if (response.giverEmail) {\n         this.userToEmail[response.giver] = response.giverEmail;\n       }\n-      if (this.section) {\n-        let shouldDisplayBasedOnSection: boolean = true;\n-        switch (this.sectionType) {\n-          case InstructorSessionResultSectionType.EITHER:\n-            shouldDisplayBasedOnSection =\n-                response.giverSection === this.section || response.recipientSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.GIVER:\n-            shouldDisplayBasedOnSection = response.giverSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.EVALUEE:\n-            shouldDisplayBasedOnSection = response.recipientSection === this.section;\n-            break;\n-          case InstructorSessionResultSectionType.BOTH:\n-            shouldDisplayBasedOnSection =\n-                response.giverSection === this.section && response.recipientSection === this.section;\n-            break;\n-          default:\n-        }\n-        if (!shouldDisplayBasedOnSection) {\n-          continue;\n-        }\n+\n+      const shouldDisplayBasedOnSection: boolean\n+        = this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(this.section,\n+            this.sectionType, response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzExMjg2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    default:\n          \n      \n    \n    \n  \n\nCould do without the empty default imo, clean the code up a little since you're doing the refactoring haha", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433112861", "createdAt": "2020-06-01T08:43:39Z", "author": {"login": "madanalogy"}, "path": "src/web/services/feedback-responses.service.ts", "diffHunk": "@@ -122,6 +126,35 @@ export class FeedbackResponsesService {\n     }\n   }\n \n+  /**\n+   * Determines whether responses should be displayed based on the selected section.\n+   */\n+  isFeedbackResponsesDisplayedOnSection(section: string, sectionType: InstructorSessionResultSectionType,\n+      response: ResponseOutput): boolean {\n+\n+    let isDisplayed: boolean = true;\n+\n+    if (section) {\n+      switch (sectionType) {\n+        case InstructorSessionResultSectionType.EITHER:\n+          isDisplayed = response.giverSection === section || response.recipientSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.GIVER:\n+          isDisplayed = response.giverSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.EVALUEE:\n+          isDisplayed = response.recipientSection === section;\n+          break;\n+        case InstructorSessionResultSectionType.BOTH:\n+          isDisplayed = response.giverSection === section && response.recipientSection === section;\n+          break;\n+        default:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5008ec3d1e884a20b7d5d4145d7456ce99d33e02"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55847d91d336df31377de8ee100452ebcef02395", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/55847d91d336df31377de8ee100452ebcef02395", "committedDate": "2020-06-01T14:43:02Z", "message": "improved line breaks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f1609102eb654c67f5164d46016a249612007b4", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7f1609102eb654c67f5164d46016a249612007b4", "committedDate": "2020-06-01T14:44:28Z", "message": "Merge branch 'master' into 10141-extract-section-filter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxOTU0NDkx", "url": "https://github.com/TEAMMATES/teammates/pull/10145#pullrequestreview-421954491", "createdAt": "2020-06-01T15:34:30Z", "commit": {"oid": "7f1609102eb654c67f5164d46016a249612007b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMDg3NDkz", "url": "https://github.com/TEAMMATES/teammates/pull/10145#pullrequestreview-422087493", "createdAt": "2020-06-01T18:39:10Z", "commit": {"oid": "7f1609102eb654c67f5164d46016a249612007b4"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxODozOToxMFrOGdVrtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxODozOToxMFrOGdVrtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQxNzE0MQ==", "bodyText": "A more logic way of organizing parameters would be to put response as the first argument.", "url": "https://github.com/TEAMMATES/teammates/pull/10145#discussion_r433417141", "createdAt": "2020-06-01T18:39:10Z", "author": {"login": "xpdavid"}, "path": "src/web/services/feedback-responses.service.ts", "diffHunk": "@@ -122,6 +126,35 @@ export class FeedbackResponsesService {\n     }\n   }\n \n+  /**\n+   * Determines whether responses should be displayed based on the selected section.\n+   */\n+  isFeedbackResponsesDisplayedOnSection(section: string, sectionType: InstructorSessionResultSectionType,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f1609102eb654c67f5164d46016a249612007b4"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "432e7797e63fdca6a36cf435d8f14e82c1ea50b5", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/432e7797e63fdca6a36cf435d8f14e82c1ea50b5", "committedDate": "2020-06-02T01:22:37Z", "message": "rearraged param order in service method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcc4f3005b590c8cfbc9723eecabf8f995a8287f", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bcc4f3005b590c8cfbc9723eecabf8f995a8287f", "committedDate": "2020-06-02T01:24:14Z", "message": "Merge https://github.com/TEAMMATES/teammates into 10141-extract-section-filter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61817862a8a4f2f9f9e2e82639e0eb676a4922d0", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/61817862a8a4f2f9f9e2e82639e0eb676a4922d0", "committedDate": "2020-06-02T01:26:24Z", "message": "Merge branch '10141-extract-section-filter' of https://github.com/Derek-Hardy/teammates into 10141-extract-section-filter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcdd934b2dd359b48701a1cdb98946e44146e914", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bcdd934b2dd359b48701a1cdb98946e44146e914", "committedDate": "2020-06-02T02:03:39Z", "message": "Merge branch 'master' into 10141-extract-section-filter"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4329, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}