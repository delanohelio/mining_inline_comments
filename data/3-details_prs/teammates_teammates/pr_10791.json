{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NDA5Mjgz", "number": 10791, "title": "[#10750] Add institute to footer for unregistered key", "bodyText": "Fixes #10750\nLoad the institute when loading public pages if registration key, student email, and course ID are present", "createdAt": "2020-10-18T06:09:53Z", "url": "https://github.com/TEAMMATES/teammates/pull/10791", "merged": true, "mergeCommit": {"oid": "5733eac9e0f4e7962901c8e8fcb0a19425cc50fe"}, "closed": true, "closedAt": "2020-12-26T05:13:04Z", "author": {"login": "madanalogy"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTSq0-AH2gAyNTA1NDA5MjgzOjhmNzQ0MGQzZjBlMzJiMmVhMDg3MmUwY2Y0MDY2NDRjOTJlZTgzNDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpekVRAH2gAyNTA1NDA5MjgzOjE3ZjgzOTA5MWM0N2E1YTc3NWVlZGZlNmUyNDg0MTQ5OWFjMGZiNTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8f7440d3f0e32b2ea0872e0cf406644c92ee8344", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8f7440d3f0e32b2ea0872e0cf406644c92ee8344", "committedDate": "2020-10-17T03:46:52Z", "message": "Add institute to StudentData in GetStudentAction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65f1c346576fe16bcb85d8c99f476b47c2ba1490", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/65f1c346576fe16bcb85d8c99f476b47c2ba1490", "committedDate": "2020-10-18T06:06:49Z", "message": "TODO commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "785624a1dc43d7eb7c60a62fcf3ff8677e33a5a3", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/785624a1dc43d7eb7c60a62fcf3ff8677e33a5a3", "committedDate": "2020-12-11T01:54:16Z", "message": "Merge branch 'master' into 10750-institute"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2477112e8a6b8e99aca26fd3b445f7b54a6d6f60", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2477112e8a6b8e99aca26fd3b445f7b54a6d6f60", "committedDate": "2020-12-11T03:40:20Z", "message": "Populate institute for public pages"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0005d80147cf63427834c9525cbecaec6f054768", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0005d80147cf63427834c9525cbecaec6f054768", "committedDate": "2020-12-11T03:37:39Z", "message": "Populate institute for public pages"}, "afterCommit": {"oid": "2477112e8a6b8e99aca26fd3b445f7b54a6d6f60", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2477112e8a6b8e99aca26fd3b445f7b54a6d6f60", "committedDate": "2020-12-11T03:40:20Z", "message": "Populate institute for public pages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwOTM3MDEw", "url": "https://github.com/TEAMMATES/teammates/pull/10791#pullrequestreview-550937010", "createdAt": "2020-12-13T16:31:45Z", "commit": {"oid": "2477112e8a6b8e99aca26fd3b445f7b54a6d6f60"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QxNjozMTo0NlrOIE2hGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QxNjozMTo0NlrOIE2hGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk1ODQyNA==", "bodyText": "I believe we can do away with the ternary operations here.\nconst courseId: string = queryParams.courseid;\nconst regKey: string = queryParams.key;\nconst studentEmail: string = queryParams.studentemail;\nif (courseId && regKey && studentEmail) {\n  this.studentService.getStudent(courseId, studentEmail, regKey).subscribe((student: Student) => {\n      this.institute = student.institute || \"\";\n  });\n}", "url": "https://github.com/TEAMMATES/teammates/pull/10791#discussion_r541958424", "createdAt": "2020-12-13T16:31:46Z", "author": {"login": "rrtheonlyone"}, "path": "src/web/app/public-page.component.ts", "diffHunk": "@@ -2,24 +2,40 @@ import { Component } from '@angular/core';\n import { ActivatedRoute } from '@angular/router';\n import { environment } from '../environments/environment';\n import { AuthService } from '../services/auth.service';\n+import { StudentService } from '../services/student.service';\n+import { Student } from '../types/api-output';\n \n /**\n  * Component for publicly available pages.\n  */\n @Component({\n   selector: 'tm-public-page',\n-  template: '<tm-page [isValidUser]=\"true\" [hideAuthInfo]=\"true\"></tm-page>',\n+  template: '<tm-page [isValidUser]=\"true\" [hideAuthInfo]=\"true\" [institute]=\"institute\"></tm-page>',\n })\n export class PublicPageComponent {\n+  institute: string = '';\n \n   constructor(private route: ActivatedRoute,\n-              private authService: AuthService) {\n+              private authService: AuthService,\n+              private studentService: StudentService) {\n     if (environment.maintenance) {\n       return;\n     }\n     this.route.queryParams.subscribe((queryParams: any) => {\n       this.authService.getAuthUser(queryParams.user).subscribe(() => {\n-        // No need to do anything; this is necessary to get CSRF token\n+        // No need to do anything with result; this is necessary to get CSRF token\n+\n+        // Loads institute for student session submission and result\n+        const courseId: string = queryParams.courseid ? queryParams.courseid : '';\n+        const regKey: string = queryParams.key ? queryParams.key : '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2477112e8a6b8e99aca26fd3b445f7b54a6d6f60"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ed4db6b8e52c6107df2260993406c5f5ccfeb9c", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4ed4db6b8e52c6107df2260993406c5f5ccfeb9c", "committedDate": "2020-12-22T11:47:52Z", "message": "Refactor ternary operators"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MTg4NDgz", "url": "https://github.com/TEAMMATES/teammates/pull/10791#pullrequestreview-557188483", "createdAt": "2020-12-22T16:03:48Z", "commit": {"oid": "4ed4db6b8e52c6107df2260993406c5f5ccfeb9c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba13c1acac5dc5684150a82c0d02baf4b067e460", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ba13c1acac5dc5684150a82c0d02baf4b067e460", "committedDate": "2020-12-25T01:59:22Z", "message": "Merge branch 'master' into 10750-institute"}, "afterCommit": {"oid": "4ed4db6b8e52c6107df2260993406c5f5ccfeb9c", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4ed4db6b8e52c6107df2260993406c5f5ccfeb9c", "committedDate": "2020-12-22T11:47:52Z", "message": "Refactor ternary operators"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17f839091c47a5a775eedfe6e24841499ac0fb50", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/17f839091c47a5a775eedfe6e24841499ac0fb50", "committedDate": "2020-12-25T02:04:58Z", "message": "Merge branch 'master' into 10750-institute"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4202, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}