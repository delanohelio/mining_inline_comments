{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwNTUwMTk1", "number": 10692, "title": "[#10655] Instructor enroll students: incorrect intermediate state shown while loading page", "bodyText": "Fixes #10655\nOutline of Solution\nAdded an isLoading flag that is set to false when the page has finished loading. This is to differentiate between whether the page is still loading or it has failed to retrieve data.\nScreenshots of page when loading:", "createdAt": "2020-09-05T17:00:11Z", "url": "https://github.com/TEAMMATES/teammates/pull/10692", "merged": true, "mergeCommit": {"oid": "c8cdf2821adf28833a19b29219a43459e6d7962c"}, "closed": true, "closedAt": "2020-09-20T01:58:55Z", "author": {"login": "helloImHai"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEBE4RAH2gAyNDgwNTUwMTk1OmFiZmRiNTYxMzI0N2MzYmYyMjJjYTdmZDdjZDRjNTkzYmFiNjQyZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKcGZ-gH2gAyNDgwNTUwMTk1OjhlZDc5MzkwMDJiZWZkMTU4MTgyYmJlY2EwNzgwNWFlYmRkZmI3Mzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "abfdb5613247c3bf222ca7fd7cd4c593bab642e2", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/abfdb5613247c3bf222ca7fd7cd4c593bab642e2", "committedDate": "2020-08-30T16:48:10Z", "message": "Add loading description with retry button during load"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMTE4Nzc1", "url": "https://github.com/TEAMMATES/teammates/pull/10692#pullrequestreview-483118775", "createdAt": "2020-09-06T07:24:43Z", "commit": {"oid": "abfdb5613247c3bf222ca7fd7cd4c593bab642e2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzODIzNjEz", "url": "https://github.com/TEAMMATES/teammates/pull/10692#pullrequestreview-483823613", "createdAt": "2020-09-08T06:19:17Z", "commit": {"oid": "abfdb5613247c3bf222ca7fd7cd4c593bab642e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNjoxOToxN1rOHOOOxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNjoxOToxN1rOHOOOxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY3NTI2OA==", "bodyText": "I think the more serious problem here is that you should not use tm-loading-retry to show the loading message.", "url": "https://github.com/TEAMMATES/teammates/pull/10692#discussion_r484675268", "createdAt": "2020-09-08T06:19:17Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-enroll-page/instructor-course-enroll-page.component.html", "diffHunk": "@@ -1,4 +1,5 @@\n-<tm-loading-retry [shouldShowRetry]=\"!coursePresent\" [message]=\"'Failed to load course'\" (retryEvent)=\"getCourseEnrollPageData(courseId)\">\n+<tm-loading-retry [shouldShowRetry]=\"isLoading\" [message]=\"'Loading course...'\" (retryEvent)=\"getCourseEnrollPageData(courseId)\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abfdb5613247c3bf222ca7fd7cd4c593bab642e2"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dacaf9e7a63fa38fa6127bb0d95851ea96e52fc8", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/dacaf9e7a63fa38fa6127bb0d95851ea96e52fc8", "committedDate": "2020-09-08T06:39:41Z", "message": "Add loading spinner when course page is loading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7667999f4333e58ec4c6bfc655d53ceba9c86047", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7667999f4333e58ec4c6bfc655d53ceba9c86047", "committedDate": "2020-09-08T06:54:05Z", "message": "Edit code for minimal changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bb51822f33809f30faaca88c878fc53e5e8e0ea", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6bb51822f33809f30faaca88c878fc53e5e8e0ea", "committedDate": "2020-09-08T06:58:29Z", "message": "Remove redundant div"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "986a5b5fa19c8d8288f573aa32cbdb312c5a07bd", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/986a5b5fa19c8d8288f573aa32cbdb312c5a07bd", "committedDate": "2020-09-08T07:41:49Z", "message": "Remove trailing whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "671865611ab2b345b25c97d3b137b01c24f8409b", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/671865611ab2b345b25c97d3b137b01c24f8409b", "committedDate": "2020-09-08T12:49:16Z", "message": "Empty commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NDM2OTQ0", "url": "https://github.com/TEAMMATES/teammates/pull/10692#pullrequestreview-484436944", "createdAt": "2020-09-08T19:36:29Z", "commit": {"oid": "671865611ab2b345b25c97d3b137b01c24f8409b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxOTozNjoyOVrOHOrSqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxOTo0MDoyNFrOHOrahQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTE1MTQwMw==", "bodyText": "I think there is no need to mark it as optional. It can be false at the begining", "url": "https://github.com/TEAMMATES/teammates/pull/10692#discussion_r485151403", "createdAt": "2020-09-08T19:36:29Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-enroll-page/instructor-course-enroll-page.component.ts", "diffHunk": "@@ -37,6 +37,7 @@ export class InstructorCourseEnrollPageComponent implements OnInit {\n   EnrollStatus: typeof EnrollStatus = EnrollStatus;\n   courseId: string = '';\n   coursePresent?: boolean;\n+  isLoading?: boolean;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "671865611ab2b345b25c97d3b137b01c24f8409b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTE1MzQxMw==", "bodyText": "The statement can go to the complete callback (the third argument of .subscribe function) to reduce the redundancy in both success and error case .", "url": "https://github.com/TEAMMATES/teammates/pull/10692#discussion_r485153413", "createdAt": "2020-09-08T19:40:24Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-course-enroll-page/instructor-course-enroll-page.component.ts", "diffHunk": "@@ -356,8 +357,10 @@ export class InstructorCourseEnrollPageComponent implements OnInit {\n   getCourseEnrollPageData(courseid: string): void {\n     this.existingStudents = [];\n     this.hasLoadingStudentsFailed = false;\n+    this.isLoading = true;\n     this.courseService.hasResponsesForCourse(courseid).subscribe((resp: HasResponses) => {\n       this.coursePresent = true;\n+      this.isLoading = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "671865611ab2b345b25c97d3b137b01c24f8409b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fca2ad686d04715459e72b8a826b377b7db52835", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fca2ad686d04715459e72b8a826b377b7db52835", "committedDate": "2020-09-09T05:06:19Z", "message": "More descriptive variable names and make use of complete callback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NjY4ODQ0", "url": "https://github.com/TEAMMATES/teammates/pull/10692#pullrequestreview-484668844", "createdAt": "2020-09-09T05:22:28Z", "commit": {"oid": "fca2ad686d04715459e72b8a826b377b7db52835"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMDA2NzQx", "url": "https://github.com/TEAMMATES/teammates/pull/10692#pullrequestreview-492006741", "createdAt": "2020-09-19T15:40:39Z", "commit": {"oid": "fca2ad686d04715459e72b8a826b377b7db52835"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ed7939002befd158182bbeca07805aebddfb738", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8ed7939002befd158182bbeca07805aebddfb738", "committedDate": "2020-09-19T15:40:49Z", "message": "Merge branch 'master' into 10655-loading-state"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4258, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}