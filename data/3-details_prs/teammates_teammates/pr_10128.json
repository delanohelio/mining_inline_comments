{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MzE4MzU3", "number": 10128, "title": "[#10122] Make relatedGiverEmail optional and hide moderate response button on null", "bodyText": "Fixes #10122\nOutline of Solution\n\nadd @Nullable to relatedGiverEmail field\nset relatedGiverEmail  to null when giver is not visible\nadd users to relateGiverEmail map in gqr and grq view for existence check by userInfo\ninclude existence check in ngIf for moderate response button", "createdAt": "2020-05-28T08:03:32Z", "url": "https://github.com/TEAMMATES/teammates/pull/10128", "merged": true, "mergeCommit": {"oid": "bfcd2ab3eaf020c15d11de0edc1f0f695edcd049"}, "closed": true, "closedAt": "2020-05-29T05:52:39Z", "author": {"login": "Derek-Hardy"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcloN8ngH2gAyNDI0MzE4MzU3OjQ4NzRmNDg3OWJhMTcwMTM4N2NjYjE5YmRhYjgxZmM3OGQ4YzNmNmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcl6rIUgFqTQyMDY0MzIwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4874f4879ba1701387ccb19bdab81fc78d8c3f6b", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4874f4879ba1701387ccb19bdab81fc78d8c3f6b", "committedDate": "2020-05-28T06:52:43Z", "message": "made relatedGiverEmail optional and moderate response button shown only relatedGiverEmail exists"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjk0Njg1", "url": "https://github.com/TEAMMATES/teammates/pull/10128#pullrequestreview-420294685", "createdAt": "2020-05-28T16:36:17Z", "commit": {"oid": "4874f4879ba1701387ccb19bdab81fc78d8c3f6b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDY0Mzgw", "url": "https://github.com/TEAMMATES/teammates/pull/10128#pullrequestreview-420464380", "createdAt": "2020-05-28T20:24:21Z", "commit": {"oid": "4874f4879ba1701387ccb19bdab81fc78d8c3f6b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDoyNDoyMVrOGcFb3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDoyNTozM1rOGcFeQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEwMjM2NA==", "bodyText": "So we shall update the documentation also?", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432102364", "createdAt": "2020-05-28T20:24:21Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/SessionResultsData.java", "diffHunk": "@@ -271,6 +275,7 @@ public String getQuestionStatistics() {\n          * Depending on the question giver type, {@code giverIdentifier} may contain the giver's email, any team member's\n          * email or \"anonymous\".", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4874f4879ba1701387ccb19bdab81fc78d8c3f6b"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEwMjk3OA==", "bodyText": "I think you also want to update tm-response-moderation-button component and remove the anonymous check.", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432102978", "createdAt": "2020-05-28T20:25:33Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/per-question-view-responses/per-question-view-responses.component.html", "diffHunk": "@@ -44,7 +44,7 @@\n           <div *ngIf=\"response.participantComment\" [innerHTML]=\"response.participantComment.commentText | safeHtml\"></div>\n         </td>\n         <td>\n-          <tm-response-moderation-button [session]=\"session\" [relatedGiverEmail]=\"response.relatedGiverEmail\" [moderatedQuestionId]=\"question.feedbackQuestionId\"></tm-response-moderation-button>\n+          <tm-response-moderation-button *ngIf=\"response.relatedGiverEmail\" [session]=\"session\" [relatedGiverEmail]=\"response.relatedGiverEmail\" [moderatedQuestionId]=\"question.feedbackQuestionId\"></tm-response-moderation-button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4874f4879ba1701387ccb19bdab81fc78d8c3f6b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b64ccd05f8f8dbfef0de94539f9f2256da6b790", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5b64ccd05f8f8dbfef0de94539f9f2256da6b790", "committedDate": "2020-05-29T02:13:19Z", "message": "updated documentation and removed unnecessary ngIf check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNjEyNTA4", "url": "https://github.com/TEAMMATES/teammates/pull/10128#pullrequestreview-420612508", "createdAt": "2020-05-29T02:25:20Z", "commit": {"oid": "5b64ccd05f8f8dbfef0de94539f9f2256da6b790"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMjoyNToyMFrOGcMwuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMjoyNToyMFrOGcMwuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIyMjM5Mg==", "bodyText": "Why is this removed?", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432222392", "createdAt": "2020-05-29T02:25:20Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/response-moderation-button/response-moderation-button.component.ts", "diffHunk": "@@ -35,20 +34,11 @@ export class ResponseModerationButtonComponent implements OnInit {\n     createdAtTimestamp: 0,\n   };\n \n-  @Input()\n-  relatedGiverEmail: string = '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b64ccd05f8f8dbfef0de94539f9f2256da6b790"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8deb22ff5c3c2676f7a978121e34daaa0ffa5c1b", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8deb22ff5c3c2676f7a978121e34daaa0ffa5c1b", "committedDate": "2020-05-29T02:43:33Z", "message": "fixed missing input"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "838c6301a3784f679f44537e02572f887eb040f0", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/838c6301a3784f679f44537e02572f887eb040f0", "committedDate": "2020-05-29T03:26:33Z", "message": "Merge branch 'master' into 10122-make-related-giver-email-optional"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNjM0NzQz", "url": "https://github.com/TEAMMATES/teammates/pull/10128#pullrequestreview-420634743", "createdAt": "2020-05-29T03:50:21Z", "commit": {"oid": "838c6301a3784f679f44537e02572f887eb040f0"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMzo1MDoyMVrOGcN5OA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMzo1MToyN1rOGcN6OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0MDk1Mg==", "bodyText": "The relatedGiverEmail here should be userToRelatedEmail[userInfo]?", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432240952", "createdAt": "2020-05-29T03:50:21Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/gqr-rqg-view-responses/gqr-rqg-view-responses.component.html", "diffHunk": "@@ -36,7 +36,7 @@\n         [{{ userToEmail[userInfo] }}]\n       </a>\n       <div class=\"float-right\">\n-        <tm-response-moderation-button class=\"mr-md-3\" *ngIf=\"isGqr\" [session]=\"session\" [relatedGiverEmail]=\"userInfo\"></tm-response-moderation-button>\n+        <tm-response-moderation-button class=\"mr-md-3\" *ngIf=\"isGqr && userToRelatedEmail[userInfo]\" [session]=\"session\" [relatedGiverEmail]=\"userInfo\"></tm-response-moderation-button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "838c6301a3784f679f44537e02572f887eb040f0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0MTA2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <tm-response-moderation-button *ngIf=\"isGrq && userToRelatedEmail[userInfo]\" [relatedGiverEmail]=\"userInfo\"></tm-response-moderation-button>\n          \n          \n            \n                    <tm-response-moderation-button *ngIf=\"isGrq && userToRelatedEmail[userInfo]\" [relatedGiverEmail]=\"userToRelatedEmail[userInfo]\"></tm-response-moderation-button>", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432241068", "createdAt": "2020-05-29T03:50:50Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.html", "diffHunk": "@@ -38,7 +38,7 @@\n         [{{ userToEmail[userInfo] }}]\n       </a>\n       <div class=\"float-right\">\n-        <tm-response-moderation-button *ngIf=\"isGrq\" [relatedGiverEmail]=\"userInfo\"></tm-response-moderation-button>\n+        <tm-response-moderation-button *ngIf=\"isGrq && userToRelatedEmail[userInfo]\" [relatedGiverEmail]=\"userInfo\"></tm-response-moderation-button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "838c6301a3784f679f44537e02572f887eb040f0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0MTIwOA==", "bodyText": "You can also remove the const I believe.", "url": "https://github.com/TEAMMATES/teammates/pull/10128#discussion_r432241208", "createdAt": "2020-05-29T03:51:27Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/response-moderation-button/response-moderation-button.component.ts", "diffHunk": "@@ -5,7 +5,6 @@ import {\n   ResponseVisibleSetting,\n   SessionVisibleSetting,\n } from '../../../../types/api-output';\n-import { ANONYMOUS_PREFIX } from '../../../../types/feedback-response-details';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "838c6301a3784f679f44537e02572f887eb040f0"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "997722b081eded9eb338709e19bcb14f88e9e295", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/997722b081eded9eb338709e19bcb14f88e9e295", "committedDate": "2020-05-29T03:56:46Z", "message": "removed unused const"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d0cba71a70be69ddc64ceb8edf5bbb5964a9976", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5d0cba71a70be69ddc64ceb8edf5bbb5964a9976", "committedDate": "2020-05-29T04:03:10Z", "message": "updated relatedGiverEmail input"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "590eb603b63e5a422ad0a139cb58dda433393666", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/590eb603b63e5a422ad0a139cb58dda433393666", "committedDate": "2020-05-29T04:03:41Z", "message": "Merge branch 'master' into 10122-make-related-giver-email-optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9c047fd6c1fabb0727bd86d01c07ed38c3de8af", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b9c047fd6c1fabb0727bd86d01c07ed38c3de8af", "committedDate": "2020-05-29T04:07:47Z", "message": "Merge branch 'master' into 10122-make-related-giver-email-optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d3ee34356259956d481a2fd23040acbf6aab602", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6d3ee34356259956d481a2fd23040acbf6aab602", "committedDate": "2020-05-29T04:09:01Z", "message": "Merge branch '10122-make-related-giver-email-optional' of https://github.com/Derek-Hardy/teammates into 10122-make-related-giver-email-optional"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNjQzMjA2", "url": "https://github.com/TEAMMATES/teammates/pull/10128#pullrequestreview-420643206", "createdAt": "2020-05-29T04:22:53Z", "commit": {"oid": "6d3ee34356259956d481a2fd23040acbf6aab602"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4321, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}