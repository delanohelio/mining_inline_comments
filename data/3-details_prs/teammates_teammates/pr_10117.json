{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyOTc1OTEw", "number": 10117, "title": "[#10104] Append team name to participants name", "bodyText": "Resolves #10104\nGRQ View\n\nRGQ View", "createdAt": "2020-05-26T04:11:52Z", "url": "https://github.com/TEAMMATES/teammates/pull/10117", "merged": true, "mergeCommit": {"oid": "0e168752753ffdd1f1a85e71c15878edb5ae9a1d"}, "closed": true, "closedAt": "2020-05-26T11:24:36Z", "author": {"login": "madanalogy"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckyNX6gH2gAyNDIyOTc1OTEwOjU1N2RjYmU4MGI4ODVmZDBhYzcxNWU1ZDc4MGEyZThlNjhkNjZjYzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclA-q8AH2gAyNDIyOTc1OTEwOjI5NjZkMzE4NGM0MzU0ZDFkMTFjM2I2MmViOGM4OGRiNzhmYTFmMDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "557dcbe80b885fd0ac715e5d780a2e8e68d66cc3", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/557dcbe80b885fd0ac715e5d780a2e8e68d66cc3", "committedDate": "2020-05-25T15:57:13Z", "message": "Add usersToTeams map for grq-rgq-view-responses.component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "440090fc9d0bb24340d2e7935bf9971b705e441b", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/440090fc9d0bb24340d2e7935bf9971b705e441b", "committedDate": "2020-05-26T03:52:58Z", "message": "Fix empty bracket bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bbfcda22de5ddb9c45b51eb38e87a434030b1883", "committedDate": "2020-05-26T04:04:58Z", "message": "Convert string literals to template string"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTU5Njk5", "url": "https://github.com/TEAMMATES/teammates/pull/10117#pullrequestreview-417959699", "createdAt": "2020-05-26T04:16:54Z", "commit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNDoxNjo1NVrOGaOGcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNDoxOTowNlrOGaOICg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzE4Nw==", "bodyText": "Till this point, you are still dealing with data. So let's not do data formatting here (i.e. remove the brackets)", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147187", "createdAt": "2020-05-26T04:16:55Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -68,31 +69,35 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   private filterResponses(): void {\n     this.responsesToShow = {};\n     this.teamsToUsers = {};\n+    this.usersToTeams = {};\n     this.teamExpanded = {};\n     this.userExpanded = {};\n     for (const question of this.responses) {\n       for (const response of question.allResponses) {\n         if (this.isGrq) {\n           this.teamsToUsers[response.giverTeam] = this.teamsToUsers[response.giverTeam] || [];\n+          this.usersToTeams[response.giver] = this.usersToTeams[response.giver] || [];\n           if (this.teamsToUsers[response.giverTeam].indexOf(response.giver) === -1) {\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n+            this.usersToTeams[response.giver].push(`(${response.giverTeam})`);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzM4MQ==", "bodyText": "Do you accidentally change the if statement?", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147381", "createdAt": "2020-05-26T04:17:59Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -68,31 +69,35 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   private filterResponses(): void {\n     this.responsesToShow = {};\n     this.teamsToUsers = {};\n+    this.usersToTeams = {};\n     this.teamExpanded = {};\n     this.userExpanded = {};\n     for (const question of this.responses) {\n       for (const response of question.allResponses) {\n         if (this.isGrq) {\n           this.teamsToUsers[response.giverTeam] = this.teamsToUsers[response.giverTeam] || [];\n+          this.usersToTeams[response.giver] = this.usersToTeams[response.giver] || [];\n           if (this.teamsToUsers[response.giverTeam].indexOf(response.giver) === -1) {\n             this.teamsToUsers[response.giverTeam].push(response.giver);\n+            this.usersToTeams[response.giver].push(`(${response.giverTeam})`);\n             this.teamExpanded[response.giverTeam] = false;\n           }\n           this.userExpanded[response.giver] = false;\n-        } else {\n-          if (!response.recipientTeam) {\n-            // Recipient is team\n-            this.teamsToUsers[response.recipient] = this.teamsToUsers[response.recipient] || [];\n-            if (this.teamsToUsers[response.recipient].indexOf(response.recipient) === -1) {\n-              this.teamsToUsers[response.recipient].push(response.recipient);\n-              this.teamExpanded[response.recipient] = false;\n-            }\n-            this.userExpanded[response.recipient] = false;\n-            continue;\n+        } else if (!response.recipientTeam) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzU0Mg==", "bodyText": "Try this https://stackoverflow.com/a/43710820", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147542", "createdAt": "2020-05-26T04:18:49Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ isGrq ? responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : '' : '(' + responses[0].allResponses[0].giverTeam + ')'}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE0NzU5NA==", "bodyText": "Same here", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430147594", "createdAt": "2020-05-26T04:19:06Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ isGrq ? responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : '' : '(' + responses[0].allResponses[0].giverTeam + ')'}}\n     </div>\n     <div class=\"top-padded\">\n-      {{ isGrq ? 'From' : 'To' }}: {{ responses[0].allResponses[0][isGrq ? 'giver' : 'recipient']}}\n+      {{ isGrq ? 'From' : 'To' }}: {{ responses[0].allResponses[0][isGrq ? 'giver' : 'recipient']}} {{ isGrq ? '(' + responses[0].allResponses[0].giverTeam + ')' : responses[0].allResponses[0].recipientTeam != '' ? '(' + responses[0].allResponses[0].recipientTeam + ')' : ''}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbfcda22de5ddb9c45b51eb38e87a434030b1883"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e252a3b7c820cd013ab3d88bb9796ce939c56dc", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8e252a3b7c820cd013ab3d88bb9796ce939c56dc", "committedDate": "2020-05-26T06:16:06Z", "message": "Move formatting to html"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "030d221240ac4b7218122ad50edf5905c7455195", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/030d221240ac4b7218122ad50edf5905c7455195", "committedDate": "2020-05-26T06:33:41Z", "message": "Move fromTo logic to ts file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73ae6401c2fcca3875d6169e636f14fb0d2b7817", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/73ae6401c2fcca3875d6169e636f14fb0d2b7817", "committedDate": "2020-05-26T06:38:34Z", "message": "Merge branch 'master' into 10104-usersToTeams\n\n# Conflicts:\n#\tsrc/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDE1Mjg2", "url": "https://github.com/TEAMMATES/teammates/pull/10117#pullrequestreview-418015286", "createdAt": "2020-05-26T06:54:38Z", "commit": {"oid": "73ae6401c2fcca3875d6169e636f14fb0d2b7817"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjo1NDozOFrOGaQ4aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjo1OTowNFrOGaRACw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5Mjc0Nw==", "bodyText": "A thing to note here is that you do not need to combine the string. It would make thing more complicated.. At least, you will find it is hard to give a proper name to it.\nMy suggestions is that you only need to append the suffix:\n{{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}} {{ teamInfo }}", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430192747", "createdAt": "2020-05-26T06:54:38Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grouped-responses/grouped-responses.component.html", "diffHunk": "@@ -2,10 +2,10 @@\n     *ngIf=\"responses.length && responses[0].allResponses.length\">\n   <div class=\"col-md-3\">\n     <div>\n-      {{ isGrq ? 'To' : 'From' }}: {{ responses[0].allResponses[0][isGrq ? 'recipient' : 'giver']}}\n+      {{ fromToTop }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73ae6401c2fcca3875d6169e636f14fb0d2b7817"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5NDY5OQ==", "bodyText": "A user can only belong to one team right?", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430194699", "createdAt": "2020-05-26T06:59:04Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.ts", "diffHunk": "@@ -46,6 +47,7 @@ export class GrqRgqViewResponsesComponent extends ResponsesInstructorCommentsBas\n   @Input() isGrq: boolean = true;\n \n   teamsToUsers: Record<string, string[]> = {};\n+  usersToTeams: Record<string, string[]> = {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73ae6401c2fcca3875d6169e636f14fb0d2b7817"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b9b00962e45182bd9f62a7e8643be85eafdb140", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9b9b00962e45182bd9f62a7e8643be85eafdb140", "committedDate": "2020-05-26T08:36:21Z", "message": "Apply suggestions from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a394072ab3390c85f4a75493fda4052a31bf68e2", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a394072ab3390c85f4a75493fda4052a31bf68e2", "committedDate": "2020-05-26T08:39:12Z", "message": "Fix lint errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTAzNDIz", "url": "https://github.com/TEAMMATES/teammates/pull/10117#pullrequestreview-418103423", "createdAt": "2020-05-26T09:00:18Z", "commit": {"oid": "a394072ab3390c85f4a75493fda4052a31bf68e2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTowMDoxOVrOGaVFOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTowMDoxOVrOGaVFOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2MTU2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] != '' ? '(' + usersToTeams[userInfo] + ')' : ''}}\n          \n          \n            \n                  {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] !== '' ? '(' + usersToTeams[userInfo] + ')' : ''}}", "url": "https://github.com/TEAMMATES/teammates/pull/10117#discussion_r430261560", "createdAt": "2020-05-26T09:00:19Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.html", "diffHunk": "@@ -33,7 +33,7 @@\n <ng-template #userTab let-userInfo='userInfo'>\n   <div class=\"card top-padded\">\n     <div class=\"card-header bg-primary text-white\" (click)=\"userExpanded[userInfo] = !userExpanded[userInfo]\">\n-      {{ isGrq ? 'From' : 'To' }}: {{ userInfo }}\n+      {{ isGrq ? 'From' : 'To' }}: {{ userInfo }} {{ usersToTeams[userInfo] != '' ? '(' + usersToTeams[userInfo] + ')' : ''}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a394072ab3390c85f4a75493fda4052a31bf68e2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2966d3184c4354d1d11c3b62eb8c88db78fa1f09", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2966d3184c4354d1d11c3b62eb8c88db78fa1f09", "committedDate": "2020-05-26T09:09:44Z", "message": "Update src/web/app/components/question-responses/grq-rgq-view-responses/grq-rgq-view-responses.component.html\n\nCo-authored-by: Xiao Pu <xp.xiaopu@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4413, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}