{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MDkxNDY1", "number": 10160, "title": "[#10155] Add sort function to numerical scale summary", "bodyText": "Part of #10155\n\nOutline of Solution\n\nadd the sortable header and icons template\nadd sortable data structure to support various sorting functions\nadd sort function on click\nadd enum to the sort-properties", "createdAt": "2020-06-03T09:53:05Z", "url": "https://github.com/TEAMMATES/teammates/pull/10160", "merged": true, "mergeCommit": {"oid": "0c4bdb603c139d8e15a040b4b50b94a153f4b37e"}, "closed": true, "closedAt": "2020-06-05T05:55:48Z", "author": {"login": "Derek-Hardy"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnkL8AgH2gAyNDI3MDkxNDY1OjJiNzAyZjU4MGYwYWZmMjRiNDNmZWRiY2I3MjVlMjQ0YzBmZDZkNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoKa4gAH2gAyNDI3MDkxNDY1OjAxNzgxZGZiMzY4ZGMxYWU5YjRjODkwM2I5ODAzNWYwNTg4ZGQ1M2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b702f580f0aff24b43fedbcb725e244c0fd6d66", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2b702f580f0aff24b43fedbcb725e244c0fd6d66", "committedDate": "2020-06-03T07:18:45Z", "message": "added sort icon template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "836dabadd854b5a9e440c7448a6a7b3638752e74", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/836dabadd854b5a9e440c7448a6a7b3638752e74", "committedDate": "2020-06-03T09:38:06Z", "message": "added sort function to numerical scale summary"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca", "committedDate": "2020-06-03T09:48:37Z", "message": "updated method naming, removed unused code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDE0MjA5", "url": "https://github.com/TEAMMATES/teammates/pull/10160#pullrequestreview-423414209", "createdAt": "2020-06-03T10:17:36Z", "commit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDoxNzozNlrOGeVc4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMDoxOTowN1rOGeVgFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MTkyMA==", "bodyText": "You might want to prefix the properties", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434461920", "createdAt": "2020-06-03T10:17:36Z", "author": {"login": "xpdavid"}, "path": "src/web/types/sort-properties.ts", "diffHunk": "@@ -121,6 +121,26 @@ export enum SortBy {\n      * Name of the recipient of the feedback response.\n      */\n     RECIPIENT_NAME,\n+\n+    /**\n+     * Average score of the numerical scale question.\n+     */\n+    AVERAGE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MjMwOA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462308", "createdAt": "2020-06-03T10:18:20Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -1,11 +1,21 @@\n-import { Component, OnChanges, OnInit } from '@angular/core';\n+import { Component, Input, OnChanges, OnInit } from '@angular/core';\n import {\n   FeedbackNumericalScaleQuestionDetails,\n   FeedbackNumericalScaleResponseDetails,\n } from '../../../../types/api-output';\n import { DEFAULT_NUMSCALE_QUESTION_DETAILS } from '../../../../types/default-question-structs';\n+import { SortBy, SortOrder } from '../../../../types/sort-properties';\n import { QuestionStatistics } from './question-statistics';\n \n+interface NumericalScaleStatsRowModel {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2MjYzNQ==", "bodyText": "Why you need it to be @Input?", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462635", "createdAt": "2020-06-03T10:18:55Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -18,8 +28,21 @@ export class NumScaleQuestionStatisticsComponent\n     extends QuestionStatistics<FeedbackNumericalScaleQuestionDetails, FeedbackNumericalScaleResponseDetails>\n     implements OnInit, OnChanges {\n \n+  // enum\n+  SortBy: typeof SortBy = SortBy;\n+  SortOrder: typeof SortOrder = SortOrder;\n+\n+  @Input()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ2Mjc0MQ==", "bodyText": "Consider using TableComparatorService", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r434462741", "createdAt": "2020-06-03T10:19:07Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -32,6 +55,49 @@ export class NumScaleQuestionStatisticsComponent\n     this.calculateStatistics();\n   }\n \n+  sortNumericalScaleStatsRowModel(by: SortBy): void {\n+    this.teamToRecipientToScoresSortBy = by;\n+    this.teamToRecipientToScoresSortOrder =\n+      (this.teamToRecipientToScoresSortOrder === SortOrder.DESC) ? SortOrder.ASC : SortOrder.DESC;\n+\n+    this.numericalScaleStatsRowModel.sort(this.sortStatsRowBy(by, this.teamToRecipientToScoresSortOrder));\n+  }\n+\n+  sortStatsRowBy(by: SortBy, order: SortOrder):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTQyMDEy", "url": "https://github.com/TEAMMATES/teammates/pull/10160#pullrequestreview-424142012", "createdAt": "2020-06-04T06:40:28Z", "commit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0MDoyOVrOGe3x_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0MDoyOVrOGe3x_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNDM4Mw==", "bodyText": "Do you think that we can have some sort of component like SortableTable that gets rid of the need for all these boilerplate code?", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435024383", "createdAt": "2020-06-04T06:40:29Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.html", "diffHunk": "@@ -11,23 +11,53 @@\n       <table class=\"table table-bordered striped margin-0\">\n         <thead>\n         <tr>\n-          <td>Team</td>\n-          <td>Recipient</td>\n-          <td><span ngbTooltip=\"Average of the visible responses\">Average</span></td>\n-          <td><span ngbTooltip=\"Maximum of the visible responses\">Max</span></td>\n-          <td><span ngbTooltip=\"Minimum of the visible responses\">Min</span></td>\n-          <td><span ngbTooltip=\"Average of the visible responses excluding recipient's own response to himself/herself\">Average excluding self response</span></td>\n+          <th class=\"sortable-header\" (click)=\"sortNumericalScaleStatsRowModel(SortBy.TEAM_NAME)\">\n+              Team\n+              <span *ngIf=\"teamToRecipientToScoresSortBy !== SortBy.TEAM_NAME\"><i class=\"fas fa-sort\"></i></span>\n+              <span *ngIf=\"teamToRecipientToScoresSortBy === SortBy.TEAM_NAME && teamToRecipientToScoresSortOrder === SortOrder.DESC\"><i class=\"fas fa-sort-down\"></i></span>\n+              <span *ngIf=\"teamToRecipientToScoresSortBy === SortBy.TEAM_NAME && teamToRecipientToScoresSortOrder === SortOrder.ASC\"><i class=\"fas fa-sort-up\"></i></span>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e70ef9e5d86400e8b97dfbded3d59aebec0c5ca"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/81c01c6c3d0cbcf9a6c3d1169295788a9395f56a", "committedDate": "2020-06-04T10:23:45Z", "message": "adopt tableComparatorService, add number comparator, add prefix to enum"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODEzMjk3", "url": "https://github.com/TEAMMATES/teammates/pull/10160#pullrequestreview-424813297", "createdAt": "2020-06-04T20:43:36Z", "commit": {"oid": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDo0MzozNlrOGfXF7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDo0NTo1MFrOGfXKMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzNzM4OA==", "bodyText": "The @Input here is for?", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435537388", "createdAt": "2020-06-04T20:43:36Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-statistics/num-scale-question-statistics.component.ts", "diffHunk": "@@ -18,9 +29,21 @@ export class NumScaleQuestionStatisticsComponent\n     extends QuestionStatistics<FeedbackNumericalScaleQuestionDetails, FeedbackNumericalScaleResponseDetails>\n     implements OnInit, OnChanges {\n \n+  // enum\n+  SortBy: typeof SortBy = SortBy;\n+  SortOrder: typeof SortOrder = SortOrder;\n+\n+  teamToRecipientToScoresSortBy: SortBy = SortBy.NONE;\n+\n+  @Input()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzODQ4Mg==", "bodyText": "My indentation is actually suggest you to use compare in the service. The comparison logic here is essentially the same as compareNaturally.", "url": "https://github.com/TEAMMATES/teammates/pull/10160#discussion_r435538482", "createdAt": "2020-06-04T20:45:50Z", "author": {"login": "xpdavid"}, "path": "src/web/services/table-comparator.service.ts", "diffHunk": "@@ -11,6 +11,27 @@ export class TableComparatorService {\n \n   constructor() { }\n \n+  /**\n+   * Compares two numbers naturally depending on order given.\n+   */\n+  compareAsNumber(order: SortOrder, numA: number, numB: number): number {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81c01c6c3d0cbcf9a6c3d1169295788a9395f56a"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec7272c155923a58e8f1ede71329259f7025d2a3", "author": {"user": {"login": "Derek-Hardy", "name": "Derek-Hardy"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ec7272c155923a58e8f1ede71329259f7025d2a3", "committedDate": "2020-06-05T00:29:03Z", "message": "removed unnecessary @input and improved sort logic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTQ1NzMx", "url": "https://github.com/TEAMMATES/teammates/pull/10160#pullrequestreview-424945731", "createdAt": "2020-06-05T01:50:10Z", "commit": {"oid": "ec7272c155923a58e8f1ede71329259f7025d2a3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01781dfb368dc1ae9b4c8903b98035f0588dd53e", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/01781dfb368dc1ae9b4c8903b98035f0588dd53e", "committedDate": "2020-06-05T03:51:28Z", "message": "Merge branch 'master' into 10155-sort-numerical-summary"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4338, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}