{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MDc0MzIw", "number": 10398, "reviewThreads": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDo1Mjo0NVrOET5MLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNzoxMjo0MFrOEaW6Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5Mjk1NDA3OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDo1Mjo0NVrOG54mcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwNzo1MTozOFrOG9uXqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0OTM2Mg==", "bodyText": "You might also want to disable the submit button", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463349362", "createdAt": "2020-07-31T00:52:45Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "diffHunk": "@@ -531,7 +533,11 @@ export class SessionSubmissionPageComponent implements OnInit, AfterViewInit {\n \n     this.questionSubmissionForms.forEach((questionSubmissionFormModel: QuestionSubmissionFormModel) => {\n       let isQuestionFullyAnswered: boolean = true;\n-\n+      if (!questionSubmissionFormModel.isValid) {\n+        failToSaveQuestions[questionSubmissionFormModel.questionNumber] =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM3NjA0MA==", "bodyText": "I think this might not be possible, since the validity of each question in a submission is independent of each other, and maybe the user might still want to save the questions that are valid", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r467376040", "createdAt": "2020-08-08T07:51:38Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "diffHunk": "@@ -531,7 +533,11 @@ export class SessionSubmissionPageComponent implements OnInit, AfterViewInit {\n \n     this.questionSubmissionForms.forEach((questionSubmissionFormModel: QuestionSubmissionFormModel) => {\n       let isQuestionFullyAnswered: boolean = true;\n-\n+      if (!questionSubmissionFormModel.isValid) {\n+        failToSaveQuestions[questionSubmissionFormModel.questionNumber] =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0OTM2Mg=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA2NTM2OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMTo1OTo0MlrOG55nlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNTo0OTo0MFrOG6NZhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjAzNg==", "bodyText": "This will only work when the component is initialized.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463366036", "createdAt": "2020-07-31T01:59:42Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();\n \n   @Input()\n   recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] = [];\n \n-  constructor() { }\n+  constructor() {\n+    super();\n+  }\n \n   ngOnInit(): void {\n+    this.isValidEvent.emit(this.isValid());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5MDExNw==", "bodyText": "For this and your next 2 comments, see #10398 (comment)", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463690117", "createdAt": "2020-07-31T15:49:40Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();\n \n   @Input()\n   recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] = [];\n \n-  constructor() { }\n+  constructor() {\n+    super();\n+  }\n \n   ngOnInit(): void {\n+    this.isValidEvent.emit(this.isValid());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjAzNg=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA2NjQ0OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMDoyNlrOG55oPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMDoyNlrOG55oPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjIwNg==", "bodyText": "Why can't we do?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              isValidEvent: EventEmitter<Observable<boolean>> = new EventEmitter();\n          \n          \n            \n              isValidEvent: EventEmitter<boolean> = new EventEmitter();", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463366206", "createdAt": "2020-07-31T02:00:26Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "diffHunk": "@@ -0,0 +1,12 @@\n+import { EventEmitter, Output } from '@angular/core';\n+import { Observable } from 'rxjs';\n+\n+/**\n+ * Base class for constraint components.\n+ */\n+export abstract class QuestionConstraintComponent {\n+  @Output()\n+  isValidEvent: EventEmitter<Observable<boolean>> = new EventEmitter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA2ODk5OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMTo1OFrOG55pug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMTo1OFrOG55pug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjU4Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              abstract isValid(): Observable<boolean>;\n          \n          \n            \n              abstract isValid(): boolean;", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463366586", "createdAt": "2020-07-31T02:01:58Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "diffHunk": "@@ -0,0 +1,12 @@\n+import { EventEmitter, Output } from '@angular/core';\n+import { Observable } from 'rxjs';\n+\n+/**\n+ * Base class for constraint components.\n+ */\n+export abstract class QuestionConstraintComponent {\n+  @Output()\n+  isValidEvent: EventEmitter<Observable<boolean>> = new EventEmitter();\n+\n+  abstract isValid(): Observable<boolean>;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA3MTQwOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMzoxN1rOG55rEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwMzowNjo1MVrOG6bB1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjkzMA==", "bodyText": "Try to use setter method here.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463366930", "createdAt": "2020-07-31T02:03:17Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();\n \n   @Input()\n   recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] = [];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4OTU2Mw==", "bodyText": "What do you mean by this? To set the form model as an alternative to @Input?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463689563", "createdAt": "2020-07-31T15:48:39Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();\n \n   @Input()\n   recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] = [];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjkzMA=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMzQzMA==", "bodyText": "And thus, if you use setter method (https://angular.io/guide/component-interaction#intercept-input-property-changes-with-a-setter) here:\nThis is where you should fire the event.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463913430", "createdAt": "2020-08-01T03:06:51Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();\n \n   @Input()\n   recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] = [];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NjkzMA=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA3MTc0OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMzoyNlrOG55rQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowMzoyNlrOG55rQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2Njk3Ng==", "bodyText": "The field can go to the parent class.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463366976", "createdAt": "2020-07-31T02:03:26Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.ts", "diffHunk": "@@ -20,17 +22,20 @@ import {\n   templateUrl: './rank-recipients-question-constraint.component.html',\n   styleUrls: ['./rank-recipients-question-constraint.component.scss'],\n })\n-export class RankRecipientsQuestionConstraintComponent implements OnInit {\n+export class RankRecipientsQuestionConstraintComponent extends QuestionConstraintComponent implements OnInit {\n \n   @Input()\n   questionDetails: FeedbackRankRecipientsQuestionDetails = DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA3NDQ4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowNTowNVrOG55s2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowNTowNVrOG55s2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NzM4NA==", "bodyText": "with the help of generic class\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export abstract class QuestionConstraintComponent {\n          \n          \n            \n            export abstract class QuestionConstraintComponent<Q extends FeedbackQuestionDetails> {\n          \n      \n    \n    \n  \n\nAnd therefore the isValid check can be here (The child component will only need care about whether the isValid or not. They don't need to fire event!).", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463367384", "createdAt": "2020-07-31T02:05:05Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "diffHunk": "@@ -0,0 +1,12 @@\n+import { EventEmitter, Output } from '@angular/core';\n+import { Observable } from 'rxjs';\n+\n+/**\n+ * Base class for constraint components.\n+ */\n+export abstract class QuestionConstraintComponent {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA3NTgzOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/constsum-recipients-question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowNTo1OFrOG55tnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowNTo1OFrOG55tnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2NzU4MQ==", "bodyText": "Why we don't use this. isAllPointsDistributed  and so on?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463367581", "createdAt": "2020-07-31T02:05:58Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/constsum-recipients-question-constraint.component.ts", "diffHunk": "@@ -101,4 +106,74 @@ export class ConstsumRecipientsQuestionConstraintComponent implements OnInit {\n \n     return set.size !== 1;\n   }\n+\n+  /**\n+   * Checks if all points have been distributed.\n+   */\n+  get isAllPointsDistributed(): boolean {\n+    return this.totalAnsweredPoints === this.totalRequiredPoints;\n+  }\n+\n+  /**\n+   * Checks if the points have been insufficiently distributed.\n+   */\n+  get isInsufficientPointsDistributed(): boolean {\n+    return this.totalAnsweredPoints < this.totalRequiredPoints;\n+  }\n+\n+  /**\n+   * Checks if the points have been over allocated.\n+   */\n+  get isPointsOverAllocated(): boolean {\n+    return this.totalAnsweredPoints > this.totalRequiredPoints;\n+  }\n+\n+  /**\n+   * Returns true if the question requires uneven distribution but the points are not unevenly distributed.\n+   */\n+  get isWronglyAllUneven(): boolean {\n+    return this.questionDetails.distributePointsFor === FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY\n+        && !this.isAllPointsUneven;\n+  }\n+\n+  /**\n+   * Returns true if the question requires uneven distribution and the points are unevenly distributed.\n+   */\n+  get isCorrectlyAllUneven(): boolean {\n+    return this.questionDetails.distributePointsFor === FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY\n+        && this.isAllPointsUneven;\n+  }\n+\n+  /**\n+   * Returns true if the question requires some uneven distribution but points are not unevenly distributed for some.\n+   */\n+  get isWronglySomeUneven(): boolean {\n+    return this.questionDetails.distributePointsFor === FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY\n+        && !this.isSomePointsUneven;\n+  }\n+\n+  /**\n+   * Returns true if the question requires some uneven distribution and points are unevenly distributed for some.\n+   */\n+  get isCorrectlySomeUneven(): boolean {\n+    return this.questionDetails.distributePointsFor === FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY\n+        && this.isSomePointsUneven;\n+  }\n+\n+  isValid(): Observable<boolean> {\n+    return new Observable((observer: Subscriber<boolean>) => {\n+      observer.next(\n+          (this.questionDetails.distributePointsFor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 98}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MzA4MTA0OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMjowOToyMFrOG55wqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMjowMjo1OVrOG9-G7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2ODM2Mg==", "bodyText": "You should use formModelChange to fire event rather than change directly here.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463368362", "createdAt": "2020-07-31T02:09:20Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -136,6 +139,9 @@ export class QuestionSubmissionFormComponent implements OnInit {\n    * Triggers the change of the recipient submission form.\n    */\n   triggerRecipientSubmissionFormChange(index: number, field: string, data: any): void {\n+    this.isQuestionValid.subscribe((isValid: boolean) => {\n+      this.model.isValid = isValid;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM3NjQ1Ng==", "bodyText": "Ideally since the model is being emitted in this method, I'd want to ensure that its isValid attribute is up to date", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r467376456", "createdAt": "2020-08-08T07:56:37Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -136,6 +139,9 @@ export class QuestionSubmissionFormComponent implements OnInit {\n    * Triggers the change of the recipient submission form.\n    */\n   triggerRecipientSubmissionFormChange(index: number, field: string, data: any): void {\n+    this.isQuestionValid.subscribe((isValid: boolean) => {\n+      this.model.isValid = isValid;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2ODM2Mg=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYzMzkwMw==", "bodyText": "It's not about safe or not. It's violating the principle we want to enforce: child component should communicate with parent component by emitting events.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r467633903", "createdAt": "2020-08-09T22:02:59Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -136,6 +139,9 @@ export class QuestionSubmissionFormComponent implements OnInit {\n    * Triggers the change of the recipient submission form.\n    */\n   triggerRecipientSubmissionFormChange(index: number, field: string, data: any): void {\n+    this.isQuestionValid.subscribe((isValid: boolean) => {\n+      this.model.isValid = isValid;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM2ODM2Mg=="}, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjY5MDYwOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwMzowNTozNlrOG6bBVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwMzowNTozNlrOG6bBVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMzMwMQ==", "bodyText": "To answer your question:\n\nWe don't need to do listen to validation event here. There are better places.\nPlus: This is wrong. You are subscribing the observable multiple times.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r463913301", "createdAt": "2020-08-01T03:05:36Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -136,6 +139,9 @@ export class QuestionSubmissionFormComponent implements OnInit {\n    * Triggers the change of the recipient submission form.\n    */\n   triggerRecipientSubmissionFormChange(index: number, field: string, data: any): void {\n+    this.isQuestionValid.subscribe((isValid: boolean) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b82e1081fe78b9912d9df8e9f8776794cf105ac"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTUwNDc4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMjowNTowMFrOG9-Htw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwMDo0NzozM1rOHBWuLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYzNDEwMw==", "bodyText": "Why we need to create a new field and trigger the change indirectly?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r467634103", "createdAt": "2020-08-09T22:05:00Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -93,6 +94,7 @@ export class QuestionSubmissionFormComponent implements OnInit {\n \n   visibilityStateMachine: VisibilityStateMachine;\n   allowedToHaveParticipantComment: boolean = false;\n+  isQuestionValid: boolean = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec04de49231b1f653746977f8526780d22f5f3b1"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTEzNTU3OQ==", "bodyText": "I didn't think we could do the model assignment directly in the html template? Or is that possible? i.e. (isValidEvent)=\"model.isValid=$event\"", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471135579", "createdAt": "2020-08-16T17:07:01Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -93,6 +94,7 @@ export class QuestionSubmissionFormComponent implements OnInit {\n \n   visibilityStateMachine: VisibilityStateMachine;\n   allowedToHaveParticipantComment: boolean = false;\n+  isQuestionValid: boolean = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYzNDEwMw=="}, "originalCommit": {"oid": "ec04de49231b1f653746977f8526780d22f5f3b1"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE4Mjg5Mw==", "bodyText": "You should create a new method and fire the event with newly updated model.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471182893", "createdAt": "2020-08-17T00:47:33Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -93,6 +94,7 @@ export class QuestionSubmissionFormComponent implements OnInit {\n \n   visibilityStateMachine: VisibilityStateMachine;\n   allowedToHaveParticipantComment: boolean = false;\n+  isQuestionValid: boolean = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYzNDEwMw=="}, "originalCommit": {"oid": "ec04de49231b1f653746977f8526780d22f5f3b1"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTUwNTI4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMjowNTozMlrOG9-H8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMjowNTozMlrOG9-H8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYzNDE2MQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r467634161", "createdAt": "2020-08-09T22:05:32Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-constraint/question-constraint.component.ts", "diffHunk": "@@ -0,0 +1,32 @@\n+import { EventEmitter, Input, Output } from '@angular/core';\n+import { FeedbackQuestionDetails } from '../../../../types/api-output';\n+import { FeedbackResponseRecipientSubmissionFormModel } from '../../question-submission-form/question-submission-form-model';\n+\n+/**\n+ * Base class for constraint components.\n+ */\n+export abstract class QuestionConstraintComponent<Q extends FeedbackQuestionDetails> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec04de49231b1f653746977f8526780d22f5f3b1"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NTQ2MTg1OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNTo1OToxOVrOHBapog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNjozOTowOFrOHBbaUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0NzI2Ng==", "bodyText": "The outer this.questionSubmissionForms.forEach will still be executed? Is that intended?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471247266", "createdAt": "2020-08-17T05:59:19Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "diffHunk": "@@ -546,9 +550,13 @@ export class SessionSubmissionPageComponent implements OnInit, AfterViewInit {\n \n     this.questionSubmissionForms.forEach((questionSubmissionFormModel: QuestionSubmissionFormModel) => {\n       let isQuestionFullyAnswered: boolean = true;\n-\n       questionSubmissionFormModel.recipientSubmissionForms\n           .forEach((recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) => {\n+            if (!recipientSubmissionFormModel.isValid) {\n+              failToSaveQuestions[questionSubmissionFormModel.questionNumber] =\n+                  'Invalid responses provided. Please check question constraints.';\n+              return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d02bc35d2749df929e8d61752e2f3b7508224c9"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1OTcyOA==", "bodyText": "Yes, because the isValid check is in the FeedbackResponseRecipientSubmissionFormModel per-response, which is embedded in the QuestionSubmissionFormModel. This is the natural result of implementing per-response validation instead of per-question", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471259728", "createdAt": "2020-08-17T06:39:08Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-session/session-submission-page/session-submission-page.component.ts", "diffHunk": "@@ -546,9 +550,13 @@ export class SessionSubmissionPageComponent implements OnInit, AfterViewInit {\n \n     this.questionSubmissionForms.forEach((questionSubmissionFormModel: QuestionSubmissionFormModel) => {\n       let isQuestionFullyAnswered: boolean = true;\n-\n       questionSubmissionFormModel.recipientSubmissionForms\n           .forEach((recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) => {\n+            if (!recipientSubmissionFormModel.isValid) {\n+              failToSaveQuestions[questionSubmissionFormModel.questionNumber] =\n+                  'Invalid responses provided. Please check question constraints.';\n+              return;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0NzI2Ng=="}, "originalCommit": {"oid": "7d02bc35d2749df929e8d61752e2f3b7508224c9"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NTQ3ODY5OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNjowODowNVrOHBazrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNjozNTowOFrOHBbVMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0OTgzOQ==", "bodyText": "I think I need to emphasize this again :(\nThis is not the correct way to change the value passed by the parent component. In other word, you do NOT own the model so you should not change it directly. Instead, please use event to emit the changes.\nI think we need pass this knowledge down:\n\nAll these efforts are to make the parent component who own the model to become a single point of truth\n\nThe parent component is free to make any change. It can also ignore the event omit by the child component.\nImage that if child components make the change directly (like in this case and it works), how do you trace the control flow? In other word, you are breaking the contract that the @Input() annotation tells. It should be read-only and input property only.\n(NOT relevant to this but useful to know)If you want to make the change to @Input() property, create a new variable and sync it between the input property when its value changes (see StudentList for example).", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471249839", "createdAt": "2020-08-17T06:08:05Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,13 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    this.model.recipientSubmissionForms.forEach((model: FeedbackResponseRecipientSubmissionFormModel) => {\n+      model.isValid = isValid;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d02bc35d2749df929e8d61752e2f3b7508224c9"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1MjUzOQ==", "bodyText": "In case you are interested, using events might cause very deep passing of event handler from child all the way to root. Therefore, we have a more proper solution called [Redux](https://redux.js.org/ mostly used for React app) (or NGRX for Angular). We will see if we can leverage it in due course (we might not in that state yet, see below).\n\nIn general, use Redux when you have reasonable amounts of data changing over time, you need a single source of truth, and you find that approaches like keeping everything in a top-level React component's state are no longer sufficient.\n\n\nIt's intended to help answer the question \"When did a certain slice of state change, and where did the data come from?\", with predictable behavior.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471252539", "createdAt": "2020-08-17T06:16:59Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,13 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    this.model.recipientSubmissionForms.forEach((model: FeedbackResponseRecipientSubmissionFormModel) => {\n+      model.isValid = isValid;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0OTgzOQ=="}, "originalCommit": {"oid": "7d02bc35d2749df929e8d61752e2f3b7508224c9"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1ODQxOQ==", "bodyText": "Could I use the formModelChange emitter to fire the event or should I create a new @Output? I will make use of the formModelChange emitter", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r471258419", "createdAt": "2020-08-17T06:35:08Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,13 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    this.model.recipientSubmissionForms.forEach((model: FeedbackResponseRecipientSubmissionFormModel) => {\n+      model.isValid = isValid;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0OTgzOQ=="}, "originalCommit": {"oid": "7d02bc35d2749df929e8d61752e2f3b7508224c9"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1NDA4NjE5OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMjoxMjoxMFrOHCs3gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMjozNDoyMFrOHCtm2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU5NDMwNA==", "bodyText": "This is shallow copy actually.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r472594304", "createdAt": "2020-08-19T02:12:10Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,19 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] =\n+        this.model.recipientSubmissionForms.slice();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "726f96639227dbb75663d7402a0a2df2738e0599"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjYwMTcxOA==", "bodyText": "I just took this from triggerRecipientSubmissionFormChange() haha, would you like me to change that method too?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r472601718", "createdAt": "2020-08-19T02:26:50Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,19 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] =\n+        this.model.recipientSubmissionForms.slice();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU5NDMwNA=="}, "originalCommit": {"oid": "726f96639227dbb75663d7402a0a2df2738e0599"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjYwNjQyNQ==", "bodyText": "That method is actually doing thing correctly :P\nThis is the trick:\n\n  \n    \n      teammates/src/web/app/components/question-submission-form/question-submission-form.component.ts\n    \n    \n        Lines 138 to 141\n      in\n      f48c957\n    \n    \n    \n    \n\n        \n          \n           recipientSubmissionForms[index] = { \n        \n\n        \n          \n             ...recipientSubmissionForms[index], \n        \n\n        \n          \n             [field]: data, \n        \n\n        \n          \n           };", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r472606425", "createdAt": "2020-08-19T02:34:20Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,19 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] =\n+        this.model.recipientSubmissionForms.slice();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU5NDMwNA=="}, "originalCommit": {"oid": "726f96639227dbb75663d7402a0a2df2738e0599"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1NDA4NzYyOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMjoxMjo1OFrOHCs4Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMjoxMjo1OFrOHCs4Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU5NDUwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.model.recipientSubmissionForms.slice();\n          \n          \n            \n                    this.model.recipientSubmissionForms.slice().map((model) => Object.assign({}, model, {isValid}))\n          \n      \n    \n    \n  \n\nThis might be what you want.", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r472594507", "createdAt": "2020-08-19T02:12:58Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,19 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] =\n+        this.model.recipientSubmissionForms.slice();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "726f96639227dbb75663d7402a0a2df2738e0599"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MDczNzk4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNzoxMjo0MFrOHDvHsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNzoxMjo0MFrOHDvHsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY3OTc5NQ==", "bodyText": "So you should remove this line also? It is redundant as L206 already did the job?", "url": "https://github.com/TEAMMATES/teammates/pull/10398#discussion_r473679795", "createdAt": "2020-08-20T07:12:40Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-submission-form/question-submission-form.component.ts", "diffHunk": "@@ -197,4 +196,20 @@ export class QuestionSubmissionFormComponent implements OnInit {\n     return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(\n         this.model.questionType, responseDetails);\n   }\n+\n+  /**\n+   * Updates validity of all responses in a question.\n+   */\n+  updateValidity(isValid: boolean): void {\n+    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] =\n+        this.model.recipientSubmissionForms.slice().map(\n+            (model: FeedbackResponseRecipientSubmissionFormModel) => Object.assign({}, model, { isValid }));\n+    recipientSubmissionForms.forEach((model: FeedbackResponseRecipientSubmissionFormModel) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "306e1c77afd5463a0301a2a02c34530a832cce56"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3696, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}