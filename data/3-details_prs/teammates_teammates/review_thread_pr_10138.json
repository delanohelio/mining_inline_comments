{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NDAwODQ5", "number": 10138, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQwMjozMToyM1rOEBFD9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDozOVrOEBO9dA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NTY2OTY1OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQwMjozMToyNFrOGcwJ3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQwMzowMzoxN1rOGcwRdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwMjI3MA==", "bodyText": "Are you copying from the result page? I think most of the comment related features are the same. Can we extract to a common parent class?", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432802270", "createdAt": "2020-05-30T02:31:24Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "diffHunk": "@@ -188,4 +201,89 @@ export class InstructorStudentRecordsPageComponent implements OnInit {\n       isEditing: false,\n     };\n   }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c08575d94c36528a3e6fae809290d2a16aa33475"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwMzQxOA==", "bodyText": "Are you copying from the result page?\n\nYeap\n\nCan we extract to a common parent class?\n\nSounds good, I'll put it in the root of pages-instructor?", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432803418", "createdAt": "2020-05-30T02:50:30Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "diffHunk": "@@ -188,4 +201,89 @@ export class InstructorStudentRecordsPageComponent implements OnInit {\n       isEditing: false,\n     };\n   }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwMjI3MA=="}, "originalCommit": {"oid": "c08575d94c36528a3e6fae809290d2a16aa33475"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwNDIxMg==", "bodyText": "Actually, I will hold off on this until #10136 is resolved since there's quite an extensive refactoring going on there that would affect how we extract the methods here", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432804212", "createdAt": "2020-05-30T03:03:17Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "diffHunk": "@@ -188,4 +201,89 @@ export class InstructorStudentRecordsPageComponent implements OnInit {\n       isEditing: false,\n     };\n   }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwMjI3MA=="}, "originalCommit": {"oid": "c08575d94c36528a3e6fae809290d2a16aa33475"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjQyMTQyOnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQwMjo0MDoxNFrOGc2W8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQwMjo0MDoxNFrOGc2W8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkwMzkyMQ==", "bodyText": "We can be consistent with subscribe taking its own line?", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432903921", "createdAt": "2020-05-31T02:40:14Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/pages-instructor/instructor-student-records-page/instructor-student-records-page.component.ts", "diffHunk": "@@ -188,4 +201,89 @@ export class InstructorStudentRecordsPageComponent implements OnInit {\n       isEditing: false,\n     };\n   }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentToDelete: FeedbackResponseComment =\n+        // tslint:disable-next-line:no-non-null-assertion\n+        this.instructorCommentTableModel[data.responseId].commentRows[data.index].originalComment!;\n+\n+    this.commentService.deleteComment(commentToDelete.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe(() => {\n+          commentTableModel.commentRows.splice(data.index, 1);\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Updates an instructor comment.\n+   */\n+  updateComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentRowToUpdate: CommentRowModel = commentTableModel.commentRows[data.index];\n+    // tslint:disable-next-line:no-non-null-assertion\n+    const commentToUpdate: FeedbackResponseComment = commentRowToUpdate.originalComment!;\n+\n+    this.commentService.updateComment({\n+      commentText: commentRowToUpdate.commentEditFormModel.commentText,\n+      showCommentTo: commentRowToUpdate.commentEditFormModel.showCommentTo,\n+      showGiverNameTo: commentRowToUpdate.commentEditFormModel.showGiverNameTo,\n+    }, commentToUpdate.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe((commentResponse: FeedbackResponseComment) => {\n+          commentTableModel.commentRows[data.index] = this.getCommentRowModel({\n+            ...commentResponse,\n+            commentGiverName: commentRowToUpdate.commentGiverName,\n+            // the current instructor will become the last editor\n+            lastEditorName: this.currInstructorName,\n+          });\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Saves an instructor comment.\n+   */\n+  saveNewComment(responseId: string): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[responseId];\n+    const commentRowToAdd: CommentRowModel = commentTableModel.newCommentRow;\n+\n+    this.commentService.createComment({\n+      commentText: commentRowToAdd.commentEditFormModel.commentText,\n+      showCommentTo: commentRowToAdd.commentEditFormModel.showCommentTo,\n+      showGiverNameTo: commentRowToAdd.commentEditFormModel.showGiverNameTo,\n+    }, responseId, Intent.INSTRUCTOR_RESULT).subscribe((commentResponse: FeedbackResponseComment) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c08575d94c36528a3e6fae809290d2a16aa33475"}, "originalPosition": 116}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc3NTA2OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoxOTowMVrOGc5SOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzoxMjowNFrOGc6JoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MTg2NQ==", "bodyText": "Since the class is abstract, the keyword protected for constructor is optional.", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432951865", "createdAt": "2020-05-31T14:19:01Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -0,0 +1,132 @@\n+import { FeedbackResponseCommentService } from '../../services/feedback-response-comment.service';\n+import { StatusMessageService } from '../../services/status-message.service';\n+import {\n+    FeedbackResponseComment,\n+    FeedbackSession, FeedbackSessionPublishStatus, FeedbackSessionSubmissionStatus,\n+    ResponseVisibleSetting,\n+    SessionVisibleSetting,\n+} from '../../types/api-output';\n+import { Intent } from '../../types/api-request';\n+import { CommentRowModel } from '../components/comment-box/comment-row/comment-row.component';\n+import { CommentTableModel } from '../components/comment-box/comment-table/comment-table.component';\n+import { CommentToCommentRowModelPipe } from '../components/comment-box/comment-to-comment-row-model.pipe';\n+import { ErrorMessageOutput } from '../error-message-output';\n+\n+/**\n+ * Base class for instructor comment CRUD operations.\n+ */\n+export abstract class InstructorCommentsComponent {\n+\n+  session: FeedbackSession = {\n+    courseId: '',\n+    timeZone: '',\n+    feedbackSessionName: '',\n+    instructions: '',\n+    submissionStartTimestamp: 0,\n+    submissionEndTimestamp: 0,\n+    gracePeriod: 0,\n+    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,\n+    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,\n+    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,\n+    publishStatus: FeedbackSessionPublishStatus.NOT_PUBLISHED,\n+    isClosingEmailEnabled: true,\n+    isPublishedEmailEnabled: true,\n+    createdAtTimestamp: 0,\n+  };\n+  currInstructorName?: string;\n+\n+  // this is a separate model for instructor comments\n+  // from responseID to comment table model\n+  instructorCommentTableModel: Record<string, CommentTableModel> = {};\n+\n+  protected constructor(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8307b4d4a5e3b4f776cc6e53e3a88b7f2b91ecfd"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2NjA0OA==", "bodyText": "I'm gonna leave it there then if that's alright, cause otherwise my IDE shows a red squiggly line :P", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432966048", "createdAt": "2020-05-31T17:12:04Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -0,0 +1,132 @@\n+import { FeedbackResponseCommentService } from '../../services/feedback-response-comment.service';\n+import { StatusMessageService } from '../../services/status-message.service';\n+import {\n+    FeedbackResponseComment,\n+    FeedbackSession, FeedbackSessionPublishStatus, FeedbackSessionSubmissionStatus,\n+    ResponseVisibleSetting,\n+    SessionVisibleSetting,\n+} from '../../types/api-output';\n+import { Intent } from '../../types/api-request';\n+import { CommentRowModel } from '../components/comment-box/comment-row/comment-row.component';\n+import { CommentTableModel } from '../components/comment-box/comment-table/comment-table.component';\n+import { CommentToCommentRowModelPipe } from '../components/comment-box/comment-to-comment-row-model.pipe';\n+import { ErrorMessageOutput } from '../error-message-output';\n+\n+/**\n+ * Base class for instructor comment CRUD operations.\n+ */\n+export abstract class InstructorCommentsComponent {\n+\n+  session: FeedbackSession = {\n+    courseId: '',\n+    timeZone: '',\n+    feedbackSessionName: '',\n+    instructions: '',\n+    submissionStartTimestamp: 0,\n+    submissionEndTimestamp: 0,\n+    gracePeriod: 0,\n+    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,\n+    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,\n+    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,\n+    publishStatus: FeedbackSessionPublishStatus.NOT_PUBLISHED,\n+    isClosingEmailEnabled: true,\n+    isPublishedEmailEnabled: true,\n+    createdAtTimestamp: 0,\n+  };\n+  currInstructorName?: string;\n+\n+  // this is a separate model for instructor comments\n+  // from responseID to comment table model\n+  instructorCommentTableModel: Record<string, CommentTableModel> = {};\n+\n+  protected constructor(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MTg2NQ=="}, "originalCommit": {"oid": "8307b4d4a5e3b4f776cc6e53e3a88b7f2b91ecfd"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc3NzM2OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoyMjozNlrOGc5TdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMDozODowN1rOGc8VIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjE4MQ==", "bodyText": "I think services can be all private here, since there is no more class extends from InstructorSessionResultPageComponent .\nhttps://stackoverflow.com/a/48571668/9421552", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432952181", "createdAt": "2020-05-31T14:22:36Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -139,12 +113,15 @@ export class InstructorSessionResultPageComponent implements OnInit {\n               private courseService: CourseService,\n               private studentService: StudentService,\n               private instructorService: InstructorService,\n-              private commentService: FeedbackResponseCommentService,\n               private route: ActivatedRoute,\n-      private timezoneService: TimezoneService, private statusMessageService: StatusMessageService,\n-      private modalService: NgbModal, private router: Router,\n-      private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n-      private commentToCommentRowModel: CommentToCommentRowModelPipe) {\n+              private timezoneService: TimezoneService,\n+              private modalService: NgbModal,\n+              private router: Router,\n+              private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n+              protected statusMessageService: StatusMessageService,\n+              protected commentService: FeedbackResponseCommentService,\n+              protected commentToCommentRowModel: CommentToCommentRowModelPipe) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8307b4d4a5e3b4f776cc6e53e3a88b7f2b91ecfd"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2NjQ1MQ==", "bodyText": "I can't make these private, only protected or no access modifier, otherwise I get error TS6138: Property 'commentToCommentRowModel' is declared but its value is never read. when running the front end test suite.\nAlso, I think the link you shared explains the difference between having an access modifier vs not having one, not about the difference between levels of access modifiers. So it matches up here since the distinction is between protected vs no access modifier and not protected vs private (if that makes sense).", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r432966451", "createdAt": "2020-05-31T17:17:16Z", "author": {"login": "madanalogy"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -139,12 +113,15 @@ export class InstructorSessionResultPageComponent implements OnInit {\n               private courseService: CourseService,\n               private studentService: StudentService,\n               private instructorService: InstructorService,\n-              private commentService: FeedbackResponseCommentService,\n               private route: ActivatedRoute,\n-      private timezoneService: TimezoneService, private statusMessageService: StatusMessageService,\n-      private modalService: NgbModal, private router: Router,\n-      private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n-      private commentToCommentRowModel: CommentToCommentRowModelPipe) {\n+              private timezoneService: TimezoneService,\n+              private modalService: NgbModal,\n+              private router: Router,\n+              private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n+              protected statusMessageService: StatusMessageService,\n+              protected commentService: FeedbackResponseCommentService,\n+              protected commentToCommentRowModel: CommentToCommentRowModelPipe) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjE4MQ=="}, "originalCommit": {"oid": "8307b4d4a5e3b4f776cc6e53e3a88b7f2b91ecfd"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAwMTc2Mw==", "bodyText": "My mistake. I think no access modifier is right here to inherit from base class?\nhttps://stackoverflow.com/a/49520067/9421552", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r433001763", "createdAt": "2020-06-01T00:38:07Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/pages-instructor/instructor-session-result-page/instructor-session-result-page.component.ts", "diffHunk": "@@ -139,12 +113,15 @@ export class InstructorSessionResultPageComponent implements OnInit {\n               private courseService: CourseService,\n               private studentService: StudentService,\n               private instructorService: InstructorService,\n-              private commentService: FeedbackResponseCommentService,\n               private route: ActivatedRoute,\n-      private timezoneService: TimezoneService, private statusMessageService: StatusMessageService,\n-      private modalService: NgbModal, private router: Router,\n-      private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n-      private commentToCommentRowModel: CommentToCommentRowModelPipe) {\n+              private timezoneService: TimezoneService,\n+              private modalService: NgbModal,\n+              private router: Router,\n+              private commentsToCommentTableModel: CommentsToCommentTableModelPipe,\n+              protected statusMessageService: StatusMessageService,\n+              protected commentService: FeedbackResponseCommentService,\n+              protected commentToCommentRowModel: CommentToCommentRowModelPipe) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjE4MQ=="}, "originalCommit": {"oid": "8307b4d4a5e3b4f776cc6e53e3a88b7f2b91ecfd"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI4ODk3OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMjozNVrOGc9oyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMjozNVrOGc9oyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzE3OQ==", "bodyText": "The indentation is not correct?", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r433023179", "createdAt": "2020-06-01T03:02:35Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -0,0 +1,132 @@\n+import { FeedbackResponseCommentService } from '../../services/feedback-response-comment.service';\n+import { StatusMessageService } from '../../services/status-message.service';\n+import {\n+    FeedbackResponseComment,\n+    FeedbackSession, FeedbackSessionPublishStatus, FeedbackSessionSubmissionStatus,\n+    ResponseVisibleSetting,\n+    SessionVisibleSetting,\n+} from '../../types/api-output';\n+import { Intent } from '../../types/api-request';\n+import { CommentRowModel } from '../components/comment-box/comment-row/comment-row.component';\n+import { CommentTableModel } from '../components/comment-box/comment-table/comment-table.component';\n+import { CommentToCommentRowModelPipe } from '../components/comment-box/comment-to-comment-row-model.pipe';\n+import { ErrorMessageOutput } from '../error-message-output';\n+\n+/**\n+ * Base class for instructor comment CRUD operations.\n+ */\n+export abstract class InstructorCommentsComponent {\n+\n+  session: FeedbackSession = {\n+    courseId: '',\n+    timeZone: '',\n+    feedbackSessionName: '',\n+    instructions: '',\n+    submissionStartTimestamp: 0,\n+    submissionEndTimestamp: 0,\n+    gracePeriod: 0,\n+    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,\n+    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,\n+    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,\n+    publishStatus: FeedbackSessionPublishStatus.NOT_PUBLISHED,\n+    isClosingEmailEnabled: true,\n+    isPublishedEmailEnabled: true,\n+    createdAtTimestamp: 0,\n+  };\n+  currInstructorName?: string;\n+\n+  // this is a separate model for instructor comments\n+  // from responseID to comment table model\n+  instructorCommentTableModel: Record<string, CommentTableModel> = {};\n+\n+  protected constructor(\n+        protected commentToCommentRowModel: CommentToCommentRowModelPipe,\n+        protected commentService: FeedbackResponseCommentService,\n+        protected statusMessageService: StatusMessageService) { }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentToDelete: FeedbackResponseComment =\n+            // tslint:disable-next-line:no-non-null-assertion\n+            this.instructorCommentTableModel[data.responseId].commentRows[data.index].originalComment!;\n+\n+    this.commentService.deleteComment(commentToDelete.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe(() => {\n+          commentTableModel.commentRows.splice(data.index, 1);\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Updates an instructor comment.\n+   */\n+  updateComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentRowToUpdate: CommentRowModel = commentTableModel.commentRows[data.index];\n+        // tslint:disable-next-line:no-non-null-assertion", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b510ae016430eee17a492d9124a312c3b6b2ec"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MDI3OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMzozM1rOGc9pdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMzozM1rOGc9pdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzM0OA==", "bodyText": "Same here?", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r433023348", "createdAt": "2020-06-01T03:03:33Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -0,0 +1,132 @@\n+import { FeedbackResponseCommentService } from '../../services/feedback-response-comment.service';\n+import { StatusMessageService } from '../../services/status-message.service';\n+import {\n+    FeedbackResponseComment,\n+    FeedbackSession, FeedbackSessionPublishStatus, FeedbackSessionSubmissionStatus,\n+    ResponseVisibleSetting,\n+    SessionVisibleSetting,\n+} from '../../types/api-output';\n+import { Intent } from '../../types/api-request';\n+import { CommentRowModel } from '../components/comment-box/comment-row/comment-row.component';\n+import { CommentTableModel } from '../components/comment-box/comment-table/comment-table.component';\n+import { CommentToCommentRowModelPipe } from '../components/comment-box/comment-to-comment-row-model.pipe';\n+import { ErrorMessageOutput } from '../error-message-output';\n+\n+/**\n+ * Base class for instructor comment CRUD operations.\n+ */\n+export abstract class InstructorCommentsComponent {\n+\n+  session: FeedbackSession = {\n+    courseId: '',\n+    timeZone: '',\n+    feedbackSessionName: '',\n+    instructions: '',\n+    submissionStartTimestamp: 0,\n+    submissionEndTimestamp: 0,\n+    gracePeriod: 0,\n+    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,\n+    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,\n+    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,\n+    publishStatus: FeedbackSessionPublishStatus.NOT_PUBLISHED,\n+    isClosingEmailEnabled: true,\n+    isPublishedEmailEnabled: true,\n+    createdAtTimestamp: 0,\n+  };\n+  currInstructorName?: string;\n+\n+  // this is a separate model for instructor comments\n+  // from responseID to comment table model\n+  instructorCommentTableModel: Record<string, CommentTableModel> = {};\n+\n+  protected constructor(\n+        protected commentToCommentRowModel: CommentToCommentRowModelPipe,\n+        protected commentService: FeedbackResponseCommentService,\n+        protected statusMessageService: StatusMessageService) { }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentToDelete: FeedbackResponseComment =\n+            // tslint:disable-next-line:no-non-null-assertion\n+            this.instructorCommentTableModel[data.responseId].commentRows[data.index].originalComment!;\n+\n+    this.commentService.deleteComment(commentToDelete.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe(() => {\n+          commentTableModel.commentRows.splice(data.index, 1);\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Updates an instructor comment.\n+   */\n+  updateComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentRowToUpdate: CommentRowModel = commentTableModel.commentRows[data.index];\n+        // tslint:disable-next-line:no-non-null-assertion\n+    const commentToUpdate: FeedbackResponseComment = commentRowToUpdate.originalComment!;\n+\n+    this.commentService.updateComment({\n+      commentText: commentRowToUpdate.commentEditFormModel.commentText,\n+      showCommentTo: commentRowToUpdate.commentEditFormModel.showCommentTo,\n+      showGiverNameTo: commentRowToUpdate.commentEditFormModel.showGiverNameTo,\n+    }, commentToUpdate.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe((commentResponse: FeedbackResponseComment) => {\n+          commentTableModel.commentRows[data.index] = this.commentToCommentRowModel.transform({\n+            ...commentResponse,\n+            commentGiverName: commentRowToUpdate.commentGiverName,\n+                    // the current instructor will become the last editor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b510ae016430eee17a492d9124a312c3b6b2ec"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MTQwOnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDozOVrOGc9qGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDozOVrOGc9qGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzUxNQ==", "bodyText": "And here", "url": "https://github.com/TEAMMATES/teammates/pull/10138#discussion_r433023515", "createdAt": "2020-06-01T03:04:39Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-comments.component.ts", "diffHunk": "@@ -0,0 +1,132 @@\n+import { FeedbackResponseCommentService } from '../../services/feedback-response-comment.service';\n+import { StatusMessageService } from '../../services/status-message.service';\n+import {\n+    FeedbackResponseComment,\n+    FeedbackSession, FeedbackSessionPublishStatus, FeedbackSessionSubmissionStatus,\n+    ResponseVisibleSetting,\n+    SessionVisibleSetting,\n+} from '../../types/api-output';\n+import { Intent } from '../../types/api-request';\n+import { CommentRowModel } from '../components/comment-box/comment-row/comment-row.component';\n+import { CommentTableModel } from '../components/comment-box/comment-table/comment-table.component';\n+import { CommentToCommentRowModelPipe } from '../components/comment-box/comment-to-comment-row-model.pipe';\n+import { ErrorMessageOutput } from '../error-message-output';\n+\n+/**\n+ * Base class for instructor comment CRUD operations.\n+ */\n+export abstract class InstructorCommentsComponent {\n+\n+  session: FeedbackSession = {\n+    courseId: '',\n+    timeZone: '',\n+    feedbackSessionName: '',\n+    instructions: '',\n+    submissionStartTimestamp: 0,\n+    submissionEndTimestamp: 0,\n+    gracePeriod: 0,\n+    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,\n+    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,\n+    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,\n+    publishStatus: FeedbackSessionPublishStatus.NOT_PUBLISHED,\n+    isClosingEmailEnabled: true,\n+    isPublishedEmailEnabled: true,\n+    createdAtTimestamp: 0,\n+  };\n+  currInstructorName?: string;\n+\n+  // this is a separate model for instructor comments\n+  // from responseID to comment table model\n+  instructorCommentTableModel: Record<string, CommentTableModel> = {};\n+\n+  protected constructor(\n+        protected commentToCommentRowModel: CommentToCommentRowModelPipe,\n+        protected commentService: FeedbackResponseCommentService,\n+        protected statusMessageService: StatusMessageService) { }\n+\n+  /**\n+   * Deletes an instructor comment.\n+   */\n+  deleteComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentToDelete: FeedbackResponseComment =\n+            // tslint:disable-next-line:no-non-null-assertion\n+            this.instructorCommentTableModel[data.responseId].commentRows[data.index].originalComment!;\n+\n+    this.commentService.deleteComment(commentToDelete.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe(() => {\n+          commentTableModel.commentRows.splice(data.index, 1);\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Updates an instructor comment.\n+   */\n+  updateComment(data: { responseId: string, index: number}): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[data.responseId];\n+    const commentRowToUpdate: CommentRowModel = commentTableModel.commentRows[data.index];\n+        // tslint:disable-next-line:no-non-null-assertion\n+    const commentToUpdate: FeedbackResponseComment = commentRowToUpdate.originalComment!;\n+\n+    this.commentService.updateComment({\n+      commentText: commentRowToUpdate.commentEditFormModel.commentText,\n+      showCommentTo: commentRowToUpdate.commentEditFormModel.showCommentTo,\n+      showGiverNameTo: commentRowToUpdate.commentEditFormModel.showGiverNameTo,\n+    }, commentToUpdate.feedbackResponseCommentId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe((commentResponse: FeedbackResponseComment) => {\n+          commentTableModel.commentRows[data.index] = this.commentToCommentRowModel.transform({\n+            ...commentResponse,\n+            commentGiverName: commentRowToUpdate.commentGiverName,\n+                    // the current instructor will become the last editor\n+            lastEditorName: this.currInstructorName,\n+          }, this.session.timeZone);\n+          this.instructorCommentTableModel[data.responseId] = {\n+            ...commentTableModel,\n+          };\n+        }, (resp: ErrorMessageOutput) => {\n+          this.statusMessageService.showErrorMessage(resp.error.message);\n+        });\n+  }\n+\n+  /**\n+   * Saves an instructor comment.\n+   */\n+  saveNewComment(responseId: string): void {\n+    const commentTableModel: CommentTableModel = this.instructorCommentTableModel[responseId];\n+    const commentRowToAdd: CommentRowModel = commentTableModel.newCommentRow;\n+\n+    this.commentService.createComment({\n+      commentText: commentRowToAdd.commentEditFormModel.commentText,\n+      showCommentTo: commentRowToAdd.commentEditFormModel.showCommentTo,\n+      showGiverNameTo: commentRowToAdd.commentEditFormModel.showGiverNameTo,\n+    }, responseId, Intent.INSTRUCTOR_RESULT)\n+        .subscribe((commentResponse: FeedbackResponseComment) => {\n+          commentTableModel.commentRows.push(this.commentToCommentRowModel.transform({\n+            ...commentResponse,\n+                // the giver and editor name will be the current login instructor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b510ae016430eee17a492d9124a312c3b6b2ec"}, "originalPosition": 111}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3749, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}