{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NjY2MTUy", "number": 9990, "title": "[#9946] Add additional fields for Student Search Migration", "bodyText": "Fixes #9946\nOutline of Solution\nSince the course and links PR are going to be closed in favor of using the existing course endpoint and link generation, this PR adds two fields to the existingStudentData class\nThe first is key, which is the registration key. This will be used for link generation.\nThe second is institute. This field is currently only in the admin search endpoint, so we add it here.", "createdAt": "2020-03-17T07:18:45Z", "url": "https://github.com/TEAMMATES/teammates/pull/9990", "merged": true, "mergeCommit": {"oid": "b4010c49d817d509c62760d075029c40e33e956b"}, "closed": true, "closedAt": "2020-04-07T11:45:22Z", "author": {"login": "hcwong"}, "timelineItems": {"totalCount": 43, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPgXM3gBqjMxNDkyNzk0OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVRURMgH2gAyMzg5NjY2MTUyOjZmMzg0YmZjNWJhNDdkZmMwZDFjNTc4M2FmZTE3NDIyZGQ5MTc2YzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d33e1e24034e38795a60f20a5511d6499e45f397", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d33e1e24034e38795a60f20a5511d6499e45f397", "committedDate": "2020-03-17T07:48:11Z", "message": "More linter bugs"}, "afterCommit": {"oid": "a11bc8bc7d3233b9b10ee5beeca841afda100779", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a11bc8bc7d3233b9b10ee5beeca841afda100779", "committedDate": "2020-03-20T13:17:01Z", "message": "Fix str equality\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a11bc8bc7d3233b9b10ee5beeca841afda100779", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a11bc8bc7d3233b9b10ee5beeca841afda100779", "committedDate": "2020-03-20T13:17:01Z", "message": "Fix str equality\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}, "afterCommit": {"oid": "e203a8fb2fa4bbd0d0e74b7283c36cff84f8db72", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e203a8fb2fa4bbd0d0e74b7283c36cff84f8db72", "committedDate": "2020-03-21T14:34:06Z", "message": "Fix str equality\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a9764c1722a7657a283641dccf25a671f9f3d30", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7a9764c1722a7657a283641dccf25a671f9f3d30", "committedDate": "2020-03-21T16:22:04Z", "message": "Add mapping for courseId to instructorId\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}, "afterCommit": {"oid": "f4ee3b0f3d99e59890a6442450143a347551188f", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/f4ee3b0f3d99e59890a6442450143a347551188f", "committedDate": "2020-03-23T02:44:11Z", "message": "Add mapping for courseId to instructorId\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5OTQwOTE5", "url": "https://github.com/TEAMMATES/teammates/pull/9990#pullrequestreview-379940919", "createdAt": "2020-03-24T01:26:04Z", "commit": {"oid": "f4ee3b0f3d99e59890a6442450143a347551188f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwMToyNjowNVrOF6d_pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwMToyNjowNVrOF6d_pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg1MzE1OQ==", "bodyText": "Why do we need institute  and courseIdToInstructorGoogleIdMap?\nAgain, we have already violated the principle that StudentData.java should only contains information related to a student. institute is technically yes but definitely not courseIdToInstructorGoogleIdMap/", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r396853159", "createdAt": "2020-03-24T01:26:05Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/StudentData.java", "diffHunk": "@@ -19,6 +21,12 @@\n     private String lastName;\n     @Nullable\n     private String comments;\n+    @Nullable\n+    private String key;\n+    @Nullable\n+    private String institute;\n+    @Nullable\n+    private Map<String, String> courseIdToInstructorGoogleIdMap;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4ee3b0f3d99e59890a6442450143a347551188f"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMzg2OTAx", "url": "https://github.com/TEAMMATES/teammates/pull/9990#pullrequestreview-383386901", "createdAt": "2020-03-29T08:40:03Z", "commit": {"oid": "2583b25cafc9a34b00658e780476f33aa90bdae7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQwODo0MDowM1rOF9PwxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQwODo0MDowM1rOF9PwxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTc2NTcwMQ==", "bodyText": "I think we might want to improve this?\nIterating the whole array to find the corresponding element is not really attracting.", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r399765701", "createdAt": "2020-03-29T08:40:03Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/StudentData.java", "diffHunk": "@@ -89,6 +106,16 @@ public void setJoinState(JoinState joinState) {\n         this.joinState = joinState;\n     }\n \n+    public void setKey(List<StudentAttributes> studentAttributes) {\n+        this.key = StringHelper.encrypt(studentAttributes.stream()\n+                .filter((StudentAttributes s) -> s.getGoogleId().equals(this.googleId))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2583b25cafc9a34b00658e780476f33aa90bdae7"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Nzc4ODU0", "url": "https://github.com/TEAMMATES/teammates/pull/9990#pullrequestreview-387778854", "createdAt": "2020-04-05T03:49:06Z", "commit": {"oid": "bf81370198af2d697e8f312333b1a251ae684e6d"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo0OTowN1rOGA8hlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1OTozNVrOGA8kTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDgyMA==", "bodyText": "Since it doesn't make sense to have a StudentsData object with no students, do you think we can make this constructor take List<StudentData> as an argument? Then we can leave students as final and remove the setter.", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r403644820", "createdAt": "2020-04-05T03:49:07Z", "author": {"login": "dvrylc"}, "path": "src/main/java/teammates/ui/webapi/output/StudentsData.java", "diffHunk": "@@ -10,7 +10,11 @@\n  */\n public class StudentsData extends ApiOutput {\n \n-    private final List<StudentData> students;\n+    private List<StudentData> students;\n+\n+    public StudentsData() {\n+        // Use this constructor if StudentData is to be sent with the key\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf81370198af2d697e8f312333b1a251ae684e6d"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NTUxNg==", "bodyText": "Instead of creating the StudentsData > setting the students > getting the students > setting the institute data, could we do all the data manipulation (setting key and institute) on the studentDataList first? Then once we have a finalized studentDataList, pass it to the StudentsData constructor as mentioned above.", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r403645516", "createdAt": "2020-04-05T03:59:35Z", "author": {"login": "dvrylc"}, "path": "src/main/java/teammates/ui/webapi/action/SearchStudentsAction.java", "diffHunk": "@@ -39,11 +88,28 @@ public ActionResult execute() {\n             List<InstructorAttributes> instructors = logic.getInstructorsForGoogleId(userInfo.id);\n             students = logic.searchStudents(searchKey, instructors).studentList;\n         }\n-        studentsData = new StudentsData(students);\n+\n+        for (StudentAttributes s : students) {\n+            courseIds.add(s.getCourse());\n+            StudentData studentData = new StudentData(s);\n+            if (userInfo.isAdmin) {\n+                studentData.setKey(StringHelper.encrypt(s.getKey()));\n+            }\n+\n+            studentDataList.add(studentData);\n+        }\n+        StudentsData studentsData = new StudentsData();\n+        studentsData.setStudents(studentDataList);\n+\n+        // Set Institute\n+        populateCourseIdToInstituteMap();\n+        studentsData.getStudents().forEach((StudentData student) -> {\n+            student.setInstitute(courseIdToInstituteMap.get(student.getCourseId()));\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf81370198af2d697e8f312333b1a251ae684e6d"}, "originalPosition": 103}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8976077987ee94e58b24acf8a643ed0a541d1132", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8976077987ee94e58b24acf8a643ed0a541d1132", "committedDate": "2020-04-05T14:11:56Z", "message": "Implement search student endpoint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d6dd4b482d3a686569db64006e20801bd2cb4a2", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2d6dd4b482d3a686569db64006e20801bd2cb4a2", "committedDate": "2020-04-05T14:11:56Z", "message": "Implement instructors search endpoint (#2)\n\n* Add instructor search endpoint\r\n\r\n* Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c20913529fcd6758d3ed0db4bc84b72beffd3db", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7c20913529fcd6758d3ed0db4bc84b72beffd3db", "committedDate": "2020-04-05T14:11:56Z", "message": "Switch from SearchInstructorsData to InstructorsData (#6)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "169e85f31dac0ef61d147c0f0bc7f060af7678dc", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/169e85f31dac0ef61d147c0f0bc7f060af7678dc", "committedDate": "2020-04-05T14:11:56Z", "message": "Switch from SearchStudentsData to StudentsData (#7)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4398bc2ae0ea9ae3c794a8fc681d64d61f4b798", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d4398bc2ae0ea9ae3c794a8fc681d64d61f4b798", "committedDate": "2020-04-05T14:11:56Z", "message": "Allow travis to build search migration branch (#5)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75c88b484b25d8735e3328420e9cc20d08792d86", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/75c88b484b25d8735e3328420e9cc20d08792d86", "committedDate": "2020-04-05T14:11:56Z", "message": "Implement sessions search endpoint (#3)\n\n* Add sessions search endpoint\r\n\r\n* Add tests\r\n\r\n* Fix lint errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fcfc517511a2059d6f7325f26fc821e13c84f2f", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5fcfc517511a2059d6f7325f26fc821e13c84f2f", "committedDate": "2020-04-05T14:11:56Z", "message": "Add course endpoint (#8)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74ff704ea85e44ed76ae6e1f64e354fafedbd780", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/74ff704ea85e44ed76ae6e1f64e354fafedbd780", "committedDate": "2020-04-05T14:21:49Z", "message": "Implement Links Endpoint (#4)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "154c779f231969915d19e08412f05a16d8c55923", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/154c779f231969915d19e08412f05a16d8c55923", "committedDate": "2020-04-05T14:21:49Z", "message": "Add googleId  field to StudentData (#9)\n\n* Add googleid to studentdata\r\n\r\n* Add nullable to student data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "086e873f9aead5c20b0324fcbbcb52cd2d3fa4c4", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/086e873f9aead5c20b0324fcbbcb52cd2d3fa4c4", "committedDate": "2020-04-05T14:21:50Z", "message": "Improve search response classes (#12)\n\n* Improve students endpoint classes\r\n\r\n* Move joinState attribute from common to student\r\n\r\n* Improve instructors endpoint classes\r\n\r\n* Revert \"Add googleId  field to StudentData (#9)\"\r\n\r\nThis reverts commit b5d46cabc092bf3bedc429ae1c771515bf149606.\r\n\r\n* Revert unnecessary InstructorData changes\r\n\r\n* Fix typo\r\n\r\n* Make joinState common\r\n\r\n* Make names sane again\r\n\r\n* Remove unused setters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2411eb88b03ea1f1687445bbf097016fca4713d5", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2411eb88b03ea1f1687445bbf097016fca4713d5", "committedDate": "2020-04-05T14:21:50Z", "message": "Standardize search endpoints (#13)\n\n* Improve course endpoint class names\r\n\r\n* Improve links endpoint class names\r\n\r\n* Improve sessions endpoint class names\r\n\r\n* Standardize comments\r\n\r\n* Fix import order"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ca329e9da254f5ea62d7c246a6728b81981ae4b", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5ca329e9da254f5ea62d7c246a6728b81981ae4b", "committedDate": "2020-04-05T14:21:50Z", "message": "Revert travis config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "416a40f1fc52664a0227da6709981e8ccfd3d6a7", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/416a40f1fc52664a0227da6709981e8ccfd3d6a7", "committedDate": "2020-04-05T14:22:11Z", "message": "Split PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67e554428fd8fbf1bdcde82aa0195136484f91b9", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/67e554428fd8fbf1bdcde82aa0195136484f91b9", "committedDate": "2020-04-05T14:22:11Z", "message": "Revert to existing response classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a2be961c05168240b170de2a3e591c0a61235b4", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0a2be961c05168240b170de2a3e591c0a61235b4", "committedDate": "2020-04-05T14:22:11Z", "message": "Allow some attributes to be optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2835f3a95aefba40701f1ec21c3fbbd9f7c1012", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c2835f3a95aefba40701f1ec21c3fbbd9f7c1012", "committedDate": "2020-04-05T14:22:11Z", "message": "Improve information hiding logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76ca309ec02780bef8ffcb531326c5d9964a7741", "author": {"user": {"login": "dvrylc", "name": "Daryl Chan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/76ca309ec02780bef8ffcb531326c5d9964a7741", "committedDate": "2020-04-05T14:22:11Z", "message": "Improve resource name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e21e282429b46a399f876438773051dba808046", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4e21e282429b46a399f876438773051dba808046", "committedDate": "2020-04-05T14:22:11Z", "message": "Add key and institute field to students"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1aba3bd1835dd7fb25d1090d0368432e0fee6441", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1aba3bd1835dd7fb25d1090d0368432e0fee6441", "committedDate": "2020-04-05T14:22:12Z", "message": "Fix rebase issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bf05df5ce63af12af7eba81b57a5175dafa4139", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6bf05df5ce63af12af7eba81b57a5175dafa4139", "committedDate": "2020-04-05T14:22:12Z", "message": "lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6bac0ddf9cd55c0107ead7d3386c15df1d7a29a", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a6bac0ddf9cd55c0107ead7d3386c15df1d7a29a", "committedDate": "2020-04-05T14:22:12Z", "message": "Fix str equality\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e380a3559e1b1c3ec6c99d12d595e03904a684a7", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e380a3559e1b1c3ec6c99d12d595e03904a684a7", "committedDate": "2020-04-05T14:22:12Z", "message": "Add mapping for courseId to instructorId\n\nCo-authored-by: Daryl Chan <6095637+dvrylc@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d65409e57b0eb71762bb8961a4175968949409c", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8d65409e57b0eb71762bb8961a4175968949409c", "committedDate": "2020-04-05T14:22:12Z", "message": "Fix some comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "242581293cc995f174b7e37c864bd9dc90a5f9b5", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/242581293cc995f174b7e37c864bd9dc90a5f9b5", "committedDate": "2020-04-05T14:22:12Z", "message": "Move key generation logic to studentData"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a7b65f9670437bbb4aa46509b16d798fb0a71f4", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7a7b65f9670437bbb4aa46509b16d798fb0a71f4", "committedDate": "2020-04-05T14:22:12Z", "message": "Modify to avoid O(n^2) calls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeafd1f27ea7f9f99f74dbb710515f32ab02fd81", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/eeafd1f27ea7f9f99f74dbb710515f32ab02fd81", "committedDate": "2020-04-05T14:22:12Z", "message": "Hide Key for instructor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf81370198af2d697e8f312333b1a251ae684e6d", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bf81370198af2d697e8f312333b1a251ae684e6d", "committedDate": "2020-03-30T08:47:17Z", "message": "Hide Key for instructor"}, "afterCommit": {"oid": "eeafd1f27ea7f9f99f74dbb710515f32ab02fd81", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/eeafd1f27ea7f9f99f74dbb710515f32ab02fd81", "committedDate": "2020-04-05T14:22:12Z", "message": "Hide Key for instructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4545bd01230fce25bb3a1c10da0037a46b7b8ed", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/f4545bd01230fce25bb3a1c10da0037a46b7b8ed", "committedDate": "2020-04-05T15:16:46Z", "message": "Fix comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad1dcac1569e7a402b0eef3551a750df313f267a", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ad1dcac1569e7a402b0eef3551a750df313f267a", "committedDate": "2020-04-05T15:23:20Z", "message": "Add helpful comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzYwNjAy", "url": "https://github.com/TEAMMATES/teammates/pull/9990#pullrequestreview-388760602", "createdAt": "2020-04-07T03:32:17Z", "commit": {"oid": "ad1dcac1569e7a402b0eef3551a750df313f267a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMzozMjoxOFrOGBxpSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMzozMzozMVrOGBxqag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUxNTE0Ng==", "bodyText": "I think there is no need to mention this.", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r404515146", "createdAt": "2020-04-07T03:32:18Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/output/StudentsData.java", "diffHunk": "@@ -10,7 +11,13 @@\n  */\n public class StudentsData extends ApiOutput {\n \n-    private final List<StudentData> students;\n+    private List<StudentData> students;\n+\n+    public StudentsData() {\n+        // Only use this constructor for the SearchStudentsAction action,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad1dcac1569e7a402b0eef3551a750df313f267a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUxNTQzNA==", "bodyText": "Please standardized the information hiding as mentioned in #9991", "url": "https://github.com/TEAMMATES/teammates/pull/9990#discussion_r404515434", "createdAt": "2020-04-07T03:33:31Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/action/SearchStudentsAction.java", "diffHunk": "@@ -39,11 +90,23 @@ public ActionResult execute() {\n             List<InstructorAttributes> instructors = logic.getInstructorsForGoogleId(userInfo.id);\n             students = logic.searchStudents(searchKey, instructors).studentList;\n         }\n-        studentsData = new StudentsData(students);\n+\n+        for (StudentAttributes s : students) {\n+            courseIds.add(s.getCourse());\n+            StudentData studentData = new StudentData(s);\n+            if (userInfo.isAdmin) {\n+                studentData.setKey(StringHelper.encrypt(s.getKey()));\n+            }\n+            studentData.setInstitute(courseIdToInstituteMap.get(s.getCourse()));\n+\n+            studentDataList.add(studentData);\n+        }\n+        StudentsData studentsData = new StudentsData();\n+        studentsData.setStudents(studentDataList);\n \n         // Hide information\n         studentsData.getStudents().forEach(StudentData::hideLastName);\n-        if (!(userInfo.isAdmin)) {\n+        if (userInfo.isInstructor) {\n             studentsData.getStudents().forEach(StudentData::hideInformationForInstructor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad1dcac1569e7a402b0eef3551a750df313f267a"}, "originalPosition": 106}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "328f7a6f6aa388a7bb9ed78041bc3af186542052", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/328f7a6f6aa388a7bb9ed78041bc3af186542052", "committedDate": "2020-04-07T05:14:22Z", "message": "Fix comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f907ce5c669ab0276779a67baa7d8f400816081", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2f907ce5c669ab0276779a67baa7d8f400816081", "committedDate": "2020-04-07T05:49:23Z", "message": "Fix comments again"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6a07a53bd9ee7ce4142e69d0be81119b23f4e9e", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b6a07a53bd9ee7ce4142e69d0be81119b23f4e9e", "committedDate": "2020-04-07T05:47:55Z", "message": "Fix comments again"}, "afterCommit": {"oid": "2f907ce5c669ab0276779a67baa7d8f400816081", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2f907ce5c669ab0276779a67baa7d8f400816081", "committedDate": "2020-04-07T05:49:23Z", "message": "Fix comments again"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b579d6d1e2419bd0a491ba48b20d602a6072d14", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2b579d6d1e2419bd0a491ba48b20d602a6072d14", "committedDate": "2020-04-07T09:49:18Z", "message": "Retrigger travis"}, "afterCommit": {"oid": "fc962f3e674b38e6c1028882cd701de6ddc311ac", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fc962f3e674b38e6c1028882cd701de6ddc311ac", "committedDate": "2020-04-07T10:16:26Z", "message": "Retrigger travis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be46296773e4b40da28def8df32b72876b86bcec", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/be46296773e4b40da28def8df32b72876b86bcec", "committedDate": "2020-04-07T10:21:55Z", "message": "Rebuild travis"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "554605021bfaebf3d467753a3d9d61ba2b3062a9", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/554605021bfaebf3d467753a3d9d61ba2b3062a9", "committedDate": "2020-04-07T10:18:56Z", "message": "Add back"}, "afterCommit": {"oid": "be46296773e4b40da28def8df32b72876b86bcec", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/be46296773e4b40da28def8df32b72876b86bcec", "committedDate": "2020-04-07T10:21:55Z", "message": "Rebuild travis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f384bfc5ba47dfc0d1c5783afe17422dd9176c0", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6f384bfc5ba47dfc0d1c5783afe17422dd9176c0", "committedDate": "2020-04-07T11:09:01Z", "message": "Merge branch 'master' into 9946-search-migration-students-addons"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4381, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}