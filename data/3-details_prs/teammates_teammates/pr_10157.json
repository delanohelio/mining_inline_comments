{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2OTEyNTg4", "number": 10157, "title": "[#10156] Add frontend CSV generation framework", "bodyText": "Part of #10156\nWhat is missing:\n\nParticipant comment and Instructor comments\nStudents CSV generation\n\nCommit Organization\nSee below", "createdAt": "2020-06-03T01:36:48Z", "url": "https://github.com/TEAMMATES/teammates/pull/10157", "merged": true, "mergeCommit": {"oid": "1c9ddd8ed487f3fbfb6ddf6354b6e913bf32190b"}, "closed": true, "closedAt": "2020-06-22T01:48:51Z", "author": {"login": "xpdavid"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnr9ojAFqTQyMzU0Njg4Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABctmOqegFqTQzNDU1MjcyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNTQ2ODg2", "url": "https://github.com/TEAMMATES/teammates/pull/10157#pullrequestreview-423546886", "createdAt": "2020-06-03T13:23:48Z", "commit": {"oid": "c246907a9f3c4ee82189a263518fc5f67ddcb252"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMzoyMzo0OFrOGebmhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNDoyOToxOFrOGeektw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU2MjY5Mg==", "bodyText": "Let's not reinvent the wheel, even if the previous way in the back end did. Use this library, for example.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434562692", "createdAt": "2020-06-03T13:23:48Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/csv-helper.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+/**\n+ * CSV related utility functions.\n+ */\n+export class CsvHelper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c246907a9f3c4ee82189a263518fc5f67ddcb252"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NzE0MQ==", "bodyText": "This is not a good way. Above all, this adds a tight coupling between front-end testing and back-end testing. Let generateTypes be the only exception for that.\nLet's just generate one good test data file to be used by all test cases (I believe it's possible) and put it within this folder (it will be tree-shaken so it won't appear in production).\nThis will make the second commit obsolete.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434577141", "createdAt": "2020-06-03T13:43:56Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/session-result-csv.service.spec.ts", "diffHunk": "@@ -0,0 +1,293 @@\n+import { HttpClientTestingModule } from '@angular/common/http/testing';\n+import { TestBed } from '@angular/core/testing';\n+import {\n+  InstructorSessionResultSectionType,\n+} from '../app/pages-instructor/instructor-session-result-page/instructor-session-result-section-type.enum';\n+import {\n+  SectionTypeDescriptionPipe,\n+} from '../app/pages-instructor/instructor-session-result-page/section-type-description.pipe';\n+import { SessionResults } from '../types/api-output';\n+import { SessionResultCsvService } from './session-result-csv.service';\n+\n+/**\n+ * Loads data for testing.\n+ */\n+const loadTestData: (filename: string) => SessionResults = (filename: string): SessionResults => {\n+  try {\n+    return require(`../../test/resources/generated-data/${filename}`);\n+  } catch (error) {\n+    console.error('Fail to load test data, did you run GenerateSessionResults?');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab014db51cde3248c1edf3c8001e93a2a2e9ea17"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NzU0Mw==", "bodyText": "Even though it's done this way before, let's not make this a snapshot test: make this a normal assertion so that we can easily see what the method does.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434577543", "createdAt": "2020-06-03T13:44:28Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/session-result-csv.service.spec.ts", "diffHunk": "@@ -0,0 +1,293 @@\n+import { HttpClientTestingModule } from '@angular/common/http/testing';\n+import { TestBed } from '@angular/core/testing';\n+import {\n+  InstructorSessionResultSectionType,\n+} from '../app/pages-instructor/instructor-session-result-page/instructor-session-result-section-type.enum';\n+import {\n+  SectionTypeDescriptionPipe,\n+} from '../app/pages-instructor/instructor-session-result-page/section-type-description.pipe';\n+import { SessionResults } from '../types/api-output';\n+import { SessionResultCsvService } from './session-result-csv.service';\n+\n+/**\n+ * Loads data for testing.\n+ */\n+const loadTestData: (filename: string) => SessionResults = (filename: string): SessionResults => {\n+  try {\n+    return require(`../../test/resources/generated-data/${filename}`);\n+  } catch (error) {\n+    console.error('Fail to load test data, did you run GenerateSessionResults?');\n+    throw error;\n+  }\n+};\n+\n+/**\n+ * Substitutes values that are different across different properties configuration.\n+ */\n+const replaceUnpredictableValuesWithPlaceholders: (str: string) => string = (str: string): string => {\n+  // tslint:disable-next-line:no-invalid-template-strings\n+  return str.replace(/Anonymous (student|instructor|team) [0-9]{1,10}/g, 'Anonymous $1 ${participant.hash}');\n+};\n+\n+describe('replaceUnpredictableValuesWithPlaceholders', () => {\n+  it('should replace unpredictable values with placeholders', () => {\n+    const sampleCsvFile: string = `Header 1,Header 2,Header 3\n+Content 1,Content 2,Content 3\n+Anonymous student 1234567,Anonymous instructor 4567890,Anonymous team 87654321\n+`;\n+    expect(replaceUnpredictableValuesWithPlaceholders(sampleCsvFile)).toMatchSnapshot();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab014db51cde3248c1edf3c8001e93a2a2e9ea17"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3OTU5Mw==", "bodyText": "Nitpicking, but this line is really too short to be line-broken like this. Same for the one below.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434579593", "createdAt": "2020-06-03T13:47:14Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/session-result-csv.service.spec.ts", "diffHunk": "@@ -0,0 +1,293 @@\n+import { HttpClientTestingModule } from '@angular/common/http/testing';\n+import { TestBed } from '@angular/core/testing';\n+import {\n+  InstructorSessionResultSectionType,\n+} from '../app/pages-instructor/instructor-session-result-page/instructor-session-result-section-type.enum';\n+import {\n+  SectionTypeDescriptionPipe,\n+} from '../app/pages-instructor/instructor-session-result-page/section-type-description.pipe';\n+import { SessionResults } from '../types/api-output';\n+import { SessionResultCsvService } from './session-result-csv.service';\n+\n+/**\n+ * Loads data for testing.\n+ */\n+const loadTestData: (filename: string) => SessionResults = (filename: string): SessionResults => {\n+  try {\n+    return require(`../../test/resources/generated-data/${filename}`);\n+  } catch (error) {\n+    console.error('Fail to load test data, did you run GenerateSessionResults?');\n+    throw error;\n+  }\n+};\n+\n+/**\n+ * Substitutes values that are different across different properties configuration.\n+ */\n+const replaceUnpredictableValuesWithPlaceholders: (str: string) => string = (str: string): string => {\n+  // tslint:disable-next-line:no-invalid-template-strings\n+  return str.replace(/Anonymous (student|instructor|team) [0-9]{1,10}/g, 'Anonymous $1 ${participant.hash}');\n+};\n+\n+describe('replaceUnpredictableValuesWithPlaceholders', () => {\n+  it('should replace unpredictable values with placeholders', () => {\n+    const sampleCsvFile: string = `Header 1,Header 2,Header 3\n+Content 1,Content 2,Content 3\n+Anonymous student 1234567,Anonymous instructor 4567890,Anonymous team 87654321\n+`;\n+    expect(replaceUnpredictableValuesWithPlaceholders(sampleCsvFile)).toMatchSnapshot();\n+  });\n+});\n+\n+describe('SessionResultCsvService', () => {\n+  let service: SessionResultCsvService;\n+\n+  beforeEach(() => {\n+    TestBed.configureTestingModule({\n+      providers: [\n+        SectionTypeDescriptionPipe,\n+      ],\n+      imports: [\n+        HttpClientTestingModule,\n+      ],\n+    });\n+\n+    service = TestBed.get(SessionResultCsvService);\n+    expect(service).toBeTruthy();\n+  });\n+\n+  it('should show responses for feedbackSessionResultsC1S1', () => {\n+    const sessionResult: SessionResults = loadTestData('feedbackSessionResultsC1S1.json');\n+\n+    const result: string = service.getCsvForSessionResult(sessionResult,\n+        false, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab014db51cde3248c1edf3c8001e93a2a2e9ea17"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU4MDQ1Mg==", "bodyText": "This has no meaning once the mentioned CSV file is removed. Let's not add this kind of line.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434580452", "createdAt": "2020-06-03T13:48:24Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/session-result-csv.service.spec.ts", "diffHunk": "@@ -0,0 +1,293 @@\n+import { HttpClientTestingModule } from '@angular/common/http/testing';\n+import { TestBed } from '@angular/core/testing';\n+import {\n+  InstructorSessionResultSectionType,\n+} from '../app/pages-instructor/instructor-session-result-page/instructor-session-result-section-type.enum';\n+import {\n+  SectionTypeDescriptionPipe,\n+} from '../app/pages-instructor/instructor-session-result-page/section-type-description.pipe';\n+import { SessionResults } from '../types/api-output';\n+import { SessionResultCsvService } from './session-result-csv.service';\n+\n+/**\n+ * Loads data for testing.\n+ */\n+const loadTestData: (filename: string) => SessionResults = (filename: string): SessionResults => {\n+  try {\n+    return require(`../../test/resources/generated-data/${filename}`);\n+  } catch (error) {\n+    console.error('Fail to load test data, did you run GenerateSessionResults?');\n+    throw error;\n+  }\n+};\n+\n+/**\n+ * Substitutes values that are different across different properties configuration.\n+ */\n+const replaceUnpredictableValuesWithPlaceholders: (str: string) => string = (str: string): string => {\n+  // tslint:disable-next-line:no-invalid-template-strings\n+  return str.replace(/Anonymous (student|instructor|team) [0-9]{1,10}/g, 'Anonymous $1 ${participant.hash}');\n+};\n+\n+describe('replaceUnpredictableValuesWithPlaceholders', () => {\n+  it('should replace unpredictable values with placeholders', () => {\n+    const sampleCsvFile: string = `Header 1,Header 2,Header 3\n+Content 1,Content 2,Content 3\n+Anonymous student 1234567,Anonymous instructor 4567890,Anonymous team 87654321\n+`;\n+    expect(replaceUnpredictableValuesWithPlaceholders(sampleCsvFile)).toMatchSnapshot();\n+  });\n+});\n+\n+describe('SessionResultCsvService', () => {\n+  let service: SessionResultCsvService;\n+\n+  beforeEach(() => {\n+    TestBed.configureTestingModule({\n+      providers: [\n+        SectionTypeDescriptionPipe,\n+      ],\n+      imports: [\n+        HttpClientTestingModule,\n+      ],\n+    });\n+\n+    service = TestBed.get(SessionResultCsvService);\n+    expect(service).toBeTruthy();\n+  });\n+\n+  it('should show responses for feedbackSessionResultsC1S1', () => {\n+    const sessionResult: SessionResults = loadTestData('feedbackSessionResultsC1S1.json');\n+\n+    const result: string = service.getCsvForSessionResult(sessionResult,\n+        false, false);\n+    expect(replaceUnpredictableValuesWithPlaceholders(result)).toMatchSnapshot();\n+    // feedbackSessionResultsC1S1_actionTest.csv", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab014db51cde3248c1edf3c8001e93a2a2e9ea17"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDYxMTM4Mw==", "bodyText": "On top of having a snapshot file, the old CSV testing makes it such that you can directly open the CSV file to see the content. We lost that ability now, but it's not a big price to pay.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r434611383", "createdAt": "2020-06-03T14:29:18Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/__snapshots__/session-result-csv.service.spec.ts.snap", "diffHunk": "@@ -0,0 +1,782 @@\n+// Jest Snapshot v1, https://goo.gl/fbAQLP\n+\n+exports[`SessionResultCsvService should display student last name displayed properly for feedbackSessionResultsC1S1NewLastName 1`] = `", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab014db51cde3248c1edf3c8001e93a2a2e9ea17"}, "originalPosition": 3}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c246907a9f3c4ee82189a263518fc5f67ddcb252", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c246907a9f3c4ee82189a263518fc5f67ddcb252", "committedDate": "2020-06-03T01:06:21Z", "message": "add contribution stats"}, "afterCommit": {"oid": "2e52dc3c20a3fa9ffe63a023218e2fea40936844", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2e52dc3c20a3fa9ffe63a023218e2fea40936844", "committedDate": "2020-06-06T01:49:11Z", "message": "add contribution stats"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MTI4NTIz", "url": "https://github.com/TEAMMATES/teammates/pull/10157#pullrequestreview-429128523", "createdAt": "2020-06-11T17:26:56Z", "commit": {"oid": "2e52dc3c20a3fa9ffe63a023218e2fea40936844"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNzoyNjo1NlrOGinYbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNzoyODo0NFrOGincSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODk0OTk5Ng==", "bodyText": "Then for now, at least you can instead make use of this method to expedite many of the processes:\nconvertCsvContentsToCsvString(rows: string[][]): string {\n  return rows.map((columns: string[]) => columns.map((entry: string) => {\n    if (entry.indexOf(',') >= 0 || entry.indexOf('\"') >= 0) {\n      return `\"${entry.replace(/\"/g, '\"\"')}\"`;\n    }\n    return entry;\n  }).join(',')).join('\\n');\n}", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r438949996", "createdAt": "2020-06-11T17:26:56Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/csv-helper.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+/**\n+ * CSV related utility functions.\n+ */\n+export class CsvHelper {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU2MjY5Mg=="}, "originalCommit": {"oid": "c246907a9f3c4ee82189a263518fc5f67ddcb252"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODk1MDk4Ng==", "bodyText": "Typo in the file name quesiton", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r438950986", "createdAt": "2020-06-11T17:28:44Z", "author": {"login": "wkurniawan07"}, "path": "src/web/types/question-details-impl/feedback-question-details-factory.ts", "diffHunk": "@@ -0,0 +1,62 @@\n+import {\n+  FeedbackConstantSumQuestionDetails,\n+  FeedbackContributionQuestionDetails,\n+  FeedbackMcqQuestionDetails,\n+  FeedbackMsqQuestionDetails,\n+  FeedbackNumericalScaleQuestionDetails,\n+  FeedbackQuestionDetails,\n+  FeedbackQuestionType,\n+  FeedbackRankOptionsQuestionDetails,\n+  FeedbackRankRecipientsQuestionDetails,\n+  FeedbackRubricQuestionDetails,\n+  FeedbackTextQuestionDetails,\n+} from '../api-output';\n+import { AbstractFeedbackQuestionDetails } from './abstract-feedback-question-details';\n+import { FeedbackConstantSumOptionsQuestionDetailsImpl } from './feedback-constsum-options-question-details.impl';\n+import { FeedbackConstantSumRecipientsQuestionDetailsImpl } from './feedback-constsum-recipient-question-details.impl';\n+import { FeedbackContributionQuestionDetailsImpl } from './feedback-contribution-question-details.impl';\n+import { FeedbackMcqQuestionDetailsImpl } from './feedback-mcq-question-details.impl';\n+import { FeedbackMsqQuestionDetailsImpl } from './feedback-msq-question-details.impl';\n+import { FeedbackNumericalScaleQuestionDetailsImpl } from './feedback-num-scale-question-details.impl';\n+import { FeedbackRankOptionsQuestionDetailsImpl } from './feedback-rank-options-question-details.impl';\n+import { FeedbackRankRecipientsQuestionDetailsImpl } from './feedback-rank-recipients-question-details.impl';\n+import { FeedbackRubricQuestionDetailsImpl } from './feedback-rubric-quesiton-details.impl';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e52dc3c20a3fa9ffe63a023218e2fea40936844"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e52dc3c20a3fa9ffe63a023218e2fea40936844", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2e52dc3c20a3fa9ffe63a023218e2fea40936844", "committedDate": "2020-06-06T01:49:11Z", "message": "add contribution stats"}, "afterCommit": {"oid": "a63762565dff60b9d7d5bd2a39582631418a43b3", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a63762565dff60b9d7d5bd2a39582631418a43b3", "committedDate": "2020-06-11T23:38:45Z", "message": "add contribution stats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a63762565dff60b9d7d5bd2a39582631418a43b3", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a63762565dff60b9d7d5bd2a39582631418a43b3", "committedDate": "2020-06-11T23:38:45Z", "message": "add contribution stats"}, "afterCommit": {"oid": "2573c993cc9806779682f66ce05f161268a5568d", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2573c993cc9806779682f66ce05f161268a5568d", "committedDate": "2020-06-12T00:39:23Z", "message": "add contribution stats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2573c993cc9806779682f66ce05f161268a5568d", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2573c993cc9806779682f66ce05f161268a5568d", "committedDate": "2020-06-12T00:39:23Z", "message": "add contribution stats"}, "afterCommit": {"oid": "2a3c9f6425978c6a12e808212915023546ae2eae", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2a3c9f6425978c6a12e808212915023546ae2eae", "committedDate": "2020-06-17T22:26:12Z", "message": "add stats for rubric question"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a3c9f6425978c6a12e808212915023546ae2eae", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2a3c9f6425978c6a12e808212915023546ae2eae", "committedDate": "2020-06-17T22:26:12Z", "message": "add stats for rubric question"}, "afterCommit": {"oid": "e6a3ba76e444aec912a3215c0b8fd9896b9c69a9", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e6a3ba76e444aec912a3215c0b8fd9896b9c69a9", "committedDate": "2020-06-17T23:05:44Z", "message": "add stats for rubric question"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6a3ba76e444aec912a3215c0b8fd9896b9c69a9", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e6a3ba76e444aec912a3215c0b8fd9896b9c69a9", "committedDate": "2020-06-17T23:05:44Z", "message": "add stats for rubric question"}, "afterCommit": {"oid": "e761aad8d277b4aae99dbb24d7233b2126dd974b", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e761aad8d277b4aae99dbb24d7233b2126dd974b", "committedDate": "2020-06-17T23:38:42Z", "message": "add stats for rubric question"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NzM1NjE3", "url": "https://github.com/TEAMMATES/teammates/pull/10157#pullrequestreview-429735617", "createdAt": "2020-06-12T13:23:05Z", "commit": {"oid": "2573c993cc9806779682f66ce05f161268a5568d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMzoyMzowNVrOGjDxbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwNToyMDo0MFrOGmIXAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQxNTE0OA==", "bodyText": "Based on RFC4180, if the entry contains \\r or \\n it also needs to be escaped. Let's add that check as well, even though it's unlikely to happen.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r439415148", "createdAt": "2020-06-12T13:23:05Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/csv-helper.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+\n+const LINE_SEPARATOR: string = '\\n';\n+\n+/**\n+ * CSV related utility functions.\n+ */\n+export class CsvHelper {\n+\n+  /**\n+   * Converts CSV contents to a standard CSV string.\n+   *\n+   * @param rows list of rows, each row contains elements for each column\n+   * @see <a href=\"http://tools.ietf.org/html/rfc4180\">http://tools.ietf.org/html/rfc4180</a>\n+   */\n+  static convertCsvContentsToCsvString(rows: string[][]): string {\n+    return rows.map((columns: string[]) => columns.map((entry: string) => {\n+      if (entry.indexOf(',') >= 0 || entry.indexOf('\"') >= 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2573c993cc9806779682f66ce05f161268a5568d"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQxNTI3Ng==", "bodyText": "Based on RFC4180, the line separator is \\r\\n.", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r439415276", "createdAt": "2020-06-12T13:23:19Z", "author": {"login": "wkurniawan07"}, "path": "src/web/services/csv-helper.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+\n+const LINE_SEPARATOR: string = '\\n';\n+\n+/**\n+ * CSV related utility functions.\n+ */\n+export class CsvHelper {\n+\n+  /**\n+   * Converts CSV contents to a standard CSV string.\n+   *\n+   * @param rows list of rows, each row contains elements for each column\n+   * @see <a href=\"http://tools.ietf.org/html/rfc4180\">http://tools.ietf.org/html/rfc4180</a>\n+   */\n+  static convertCsvContentsToCsvString(rows: string[][]): string {\n+    return rows.map((columns: string[]) => columns.map((entry: string) => {\n+      if (entry.indexOf(',') >= 0 || entry.indexOf('\"') >= 0) {\n+        return `\"${entry.replace(/\"/g, '\"\"')}\"`;\n+      }\n+      return entry;\n+    }).join(',')).join(LINE_SEPARATOR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2573c993cc9806779682f66ce05f161268a5568d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYzNjAzMg==", "bodyText": "Typo in filename statstics", "url": "https://github.com/TEAMMATES/teammates/pull/10157#discussion_r442636032", "createdAt": "2020-06-19T05:20:40Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-statistics/constsum-options-question-statistics.component.ts", "diffHunk": "@@ -1,9 +1,10 @@\n import { Component, OnChanges, OnInit } from '@angular/core';\n-import { FeedbackConstantSumQuestionDetails, FeedbackConstantSumResponseDetails } from '../../../../types/api-output';\n import { DEFAULT_CONSTSUM_RECIPIENTS_QUESTION_DETAILS } from '../../../../types/default-question-structs';\n import { SortBy } from '../../../../types/sort-properties';\n import { ColumnData, SortableTableCellData } from '../../sortable-table/sortable-table.component';\n-import { QuestionStatistics } from './question-statistics';\n+import {\n+  ConstsumOptionsQuestionStatisticsCalculation,\n+} from './question-statistics-calculation/constsum-options-question-statstics-calculation';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e761aad8d277b4aae99dbb24d7233b2126dd974b"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd6b197e698d6d6c0edbf15f63f2fb81dc385367", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fd6b197e698d6d6c0edbf15f63f2fb81dc385367", "committedDate": "2020-06-20T02:39:43Z", "message": "remove all code relates to result page (including csv generation)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a9c4e6cb8327f285bed1d711f7ffe830f5306b4", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2a9c4e6cb8327f285bed1d711f7ffe830f5306b4", "committedDate": "2020-06-20T02:39:43Z", "message": "add sample API responses from backend"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ec4037ecbd7b96e0e0aba60976dbd73c1d317f", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/09ec4037ecbd7b96e0e0aba60976dbd73c1d317f", "committedDate": "2020-06-20T02:39:43Z", "message": "abstract section type description generation to a pipe"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17ac3185268a4c5afcf2ea2862c2b4fbb8fc0c39", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/17ac3185268a4c5afcf2ea2862c2b4fbb8fc0c39", "committedDate": "2020-06-20T20:01:00Z", "message": "add last name to the session result response output in backend"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26ba57c32cd41b3585e48c6db9f0571711980be6", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/26ba57c32cd41b3585e48c6db9f0571711980be6", "committedDate": "2020-06-20T20:19:17Z", "message": "add framework to generate csv in the frontend"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d45e367a52200cca9348a95df335ade4b358754", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4d45e367a52200cca9348a95df335ade4b358754", "committedDate": "2020-06-20T20:22:04Z", "message": "add stats for contribution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea15c237609b528add88fe6587939efdaef86797", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ea15c237609b528add88fe6587939efdaef86797", "committedDate": "2020-06-20T20:22:04Z", "message": "add stats for constsum options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb750433218bc4759d71eb78a9145b9b9e5fe2c5", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/eb750433218bc4759d71eb78a9145b9b9e5fe2c5", "committedDate": "2020-06-20T20:22:04Z", "message": "add stats for constsum recipients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a90580b41063c1bf64ea312cd0de556ec7c2cf2b", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a90580b41063c1bf64ea312cd0de556ec7c2cf2b", "committedDate": "2020-06-20T20:22:04Z", "message": "add stats for mcq/msq question"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51a67737d9d3f35320cd99266d2b990702baa65a", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/51a67737d9d3f35320cd99266d2b990702baa65a", "committedDate": "2020-06-20T20:22:05Z", "message": "add stats for num scale question"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bc1cfb3440e46b8063818e52056cfa92e77c3ed", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6bc1cfb3440e46b8063818e52056cfa92e77c3ed", "committedDate": "2020-06-20T20:22:05Z", "message": "add stats for rank options question"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e34643930a97892aee07406e2ec43063b02b3b1", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8e34643930a97892aee07406e2ec43063b02b3b1", "committedDate": "2020-06-20T20:22:05Z", "message": "add stats for rank recipients question"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55232f48d449b432c3f4f1a603bac891c1c8f56f", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/55232f48d449b432c3f4f1a603bac891c1c8f56f", "committedDate": "2020-06-20T20:22:05Z", "message": "add stats for rubric question"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e761aad8d277b4aae99dbb24d7233b2126dd974b", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e761aad8d277b4aae99dbb24d7233b2126dd974b", "committedDate": "2020-06-17T23:38:42Z", "message": "add stats for rubric question"}, "afterCommit": {"oid": "55232f48d449b432c3f4f1a603bac891c1c8f56f", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/55232f48d449b432c3f4f1a603bac891c1c8f56f", "committedDate": "2020-06-20T20:22:05Z", "message": "add stats for rubric question"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTUyNzI3", "url": "https://github.com/TEAMMATES/teammates/pull/10157#pullrequestreview-434552727", "createdAt": "2020-06-22T01:05:05Z", "commit": {"oid": "55232f48d449b432c3f4f1a603bac891c1c8f56f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4335, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}