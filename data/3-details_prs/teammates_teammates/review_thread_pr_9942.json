{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5OTE2ODgx", "number": 9942, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNTo1MVrODfnJjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNTowMzoyMFrODiNl-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NDczODcxOnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-student/student-course-details-page/student-course-details-page.component.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNTo1MVrOFpailw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQxNTo0MzozMVrOFqUA5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDc3NQ==", "bodyText": "Correct me if I am wrong. Looks like from your conversation history this is a potential security glitch says that \"the long term email should not be shown to student\". If this is the case, doing override in the frontend won't work. We need hide the field from the backend.", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r378970775", "createdAt": "2020-02-13T16:25:51Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-student/student-course-details-page/student-course-details-page.component.ts", "diffHunk": "@@ -114,17 +114,18 @@ export class StudentCourseDetailsPageComponent implements OnInit {\n             this.studentProfileService.getStudentProfile(student.email, courseId)\n                   .subscribe((studentProfile: StudentProfile) => {\n                     const newPhotoUrl: string =\n-              `${environment.backendUrl}/webapi/student/profilePic?courseid=${courseId}&studentemail=${student.email}`;\n+                      `${environment.backendUrl}/webapi/student/profilePic`\n+                      + `?courseid=${courseId}&studentemail=${student.email}`;\n \n                     const newTeammateProfile: StudentProfileWithPicture = {\n-                      studentProfile,\n+                      // Use student.email as studentProfile.email is the long term email which should not be shown", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTkxMjQyMA==", "bodyText": "Yea you're right. Since this got larger in scale I'll KIV this first and return after the search migration API epic", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r379912420", "createdAt": "2020-02-16T15:43:31Z", "author": {"login": "hcwong"}, "path": "src/web/app/pages-student/student-course-details-page/student-course-details-page.component.ts", "diffHunk": "@@ -114,17 +114,18 @@ export class StudentCourseDetailsPageComponent implements OnInit {\n             this.studentProfileService.getStudentProfile(student.email, courseId)\n                   .subscribe((studentProfile: StudentProfile) => {\n                     const newPhotoUrl: string =\n-              `${environment.backendUrl}/webapi/student/profilePic?courseid=${courseId}&studentemail=${student.email}`;\n+                      `${environment.backendUrl}/webapi/student/profilePic`\n+                      + `?courseid=${courseId}&studentemail=${student.email}`;\n \n                     const newTeammateProfile: StudentProfileWithPicture = {\n-                      studentProfile,\n+                      // Use student.email as studentProfile.email is the long term email which should not be shown", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDc3NQ=="}, "originalCommit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjAwODkwOnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/ui/webapi/action/GetStudentProfileAction.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNTowMzoyMFrOFtVxIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNjoyODozMFrOFyaoQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4Njg4Mw==", "bodyText": "I think you should change StudentProfileData instead. See how FeedbackSessionData is done.", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r383086883", "createdAt": "2020-02-24T05:03:20Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/action/GetStudentProfileAction.java", "diffHunk": "@@ -72,6 +72,12 @@ public ActionResult execute() {\n             studentProfile = StudentProfileAttributes.builder(studentId).build();\n         }\n \n+        // If student requesting and is not the student's own profile, hide some fields\n+        if (userInfo.isStudent && studentId.equals(userInfo.id)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1NDI3Nw==", "bodyText": "Thanks, I've added a hide feature to StudentProfileData", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r384254277", "createdAt": "2020-02-26T03:14:39Z", "author": {"login": "hcwong"}, "path": "src/main/java/teammates/ui/webapi/action/GetStudentProfileAction.java", "diffHunk": "@@ -72,6 +72,12 @@ public ActionResult execute() {\n             studentProfile = StudentProfileAttributes.builder(studentId).build();\n         }\n \n+        // If student requesting and is not the student's own profile, hide some fields\n+        if (userInfo.isStudent && studentId.equals(userInfo.id)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4Njg4Mw=="}, "originalCommit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQwOTQxMQ==", "bodyText": "Hey @xpdavid, is the fix for this alright? Thanks!", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r388409411", "createdAt": "2020-03-05T16:28:30Z", "author": {"login": "hcwong"}, "path": "src/main/java/teammates/ui/webapi/action/GetStudentProfileAction.java", "diffHunk": "@@ -72,6 +72,12 @@ public ActionResult execute() {\n             studentProfile = StudentProfileAttributes.builder(studentId).build();\n         }\n \n+        // If student requesting and is not the student's own profile, hide some fields\n+        if (userInfo.isStudent && studentId.equals(userInfo.id)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4Njg4Mw=="}, "originalCommit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4052, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}