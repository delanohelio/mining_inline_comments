{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MjE0ODkx", "number": 10166, "title": "[#10155] Add sortable table, with MCQ statistics calling it", "bodyText": "Part of #10155\nOutline of Solution\n\nAdd sortable-table component\nChange MCQ question statistics to call the sortable-table component", "createdAt": "2020-06-05T04:32:14Z", "url": "https://github.com/TEAMMATES/teammates/pull/10166", "merged": true, "mergeCommit": {"oid": "949d600b9703214f793e1d179b09b1803cd1baf6"}, "closed": true, "closedAt": "2020-06-06T04:34:08Z", "author": {"login": "ccyccyccy"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoLHxjABqjM0MDk2NDU4NDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoe5L4AH2gAyNDI4MjE0ODkxOjdmNDYyNmVkMDRlMjg1MjcyNDE4MGU0OTZkMGYzYmM5ZTk4NDg3ZjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea2285f2b1d92b39d1122d184c32a7af2cecaa13", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ea2285f2b1d92b39d1122d184c32a7af2cecaa13", "committedDate": "2020-06-05T04:30:31Z", "message": "Add sortable table, with MCQ statistics calling it"}, "afterCommit": {"oid": "30ea6ee7de23fd7afe7d69fc5b735de3c585426d", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/30ea6ee7de23fd7afe7d69fc5b735de3c585426d", "committedDate": "2020-06-05T04:40:12Z", "message": "Add sortable table, with MCQ statistics calling it"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTkwODEy", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-424990812", "createdAt": "2020-06-05T04:39:05Z", "commit": {"oid": "ea2285f2b1d92b39d1122d184c32a7af2cecaa13"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNDozOTowNVrOGfgJvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNDo0NzowOVrOGfgQpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NTgyMw==", "bodyText": "Should this be in the TableComparatorService?", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435685823", "createdAt": "2020-06-05T04:39:05Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-statistics/mcq-question-statistics.component.ts", "diffHunk": "@@ -124,4 +132,31 @@ export class McqQuestionStatisticsComponent\n     }\n   }\n \n+  private sortChoices = (item1: string, item2: string): number => {\n+    return this.tableComparatorService.compareLexicographically(item1, item2, SortOrder.ASC);\n+  }\n+\n+  private sortNumbers(item1: number, item2: number): number {\n+    return item1 - item2;\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea2285f2b1d92b39d1122d184c32a7af2cecaa13"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NzU5MA==", "bodyText": "Not sure if we can use typescript to enforce that the types of items in the columns and rows arrays are properly aligned. Searched around for quite a bit and couldn't find any solutions.", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435687590", "createdAt": "2020-06-05T04:47:09Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,78 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData<T> {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?(item1: T, item2: T): number; // Don't provide this field if you don't want this column to be sortable\n+}\n+\n+/**\n+ * Displays a sortable table, sorting by clicking on the header\n+ * Optional sorting function to be inputted provided for each column\n+ * Columns and rows provided must be aligned\n+ */\n+@Component({\n+  selector: 'tm-sortable-table',\n+  templateUrl: './sortable-table.component.html',\n+  styleUrls: ['./sortable-table.component.scss'],\n+})\n+export class SortableTableComponent implements OnInit {\n+\n+  @Input()\n+  columns: ColumnData<any>[] = [];\n+\n+  @Input()\n+  rows: any[][] = [];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30ea6ee7de23fd7afe7d69fc5b735de3c585426d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MDA0NTgz", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-425004583", "createdAt": "2020-06-05T05:26:54Z", "commit": {"oid": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNToyNjo1NFrOGfg1mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNToyOTozMVrOGfg35A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5NzA1MA==", "bodyText": "You can take a look at my PR #10155 for the use of TableComparatorService . Basically all comparison should be delegated to this.tableComparatorService.compare().", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435697050", "createdAt": "2020-06-05T05:26:54Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/components/question-types/question-statistics/mcq-question-statistics.component.ts", "diffHunk": "@@ -124,4 +132,31 @@ export class McqQuestionStatisticsComponent\n     }\n   }\n \n+  private sortChoices = (item1: string, item2: string): number => {\n+    return this.tableComparatorService.compareLexicographically(item1, item2, SortOrder.ASC);\n+  }\n+\n+  private sortNumbers(item1: number, item2: number): number {\n+    return item1 - item2;\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY4NTgyMw=="}, "originalCommit": {"oid": "ea2285f2b1d92b39d1122d184c32a7af2cecaa13"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5NzYzNg==", "bodyText": "You should use this.tableComparatorService.compare(), declare the respective enum in src/web/types/sort-properties.ts for switch case in the function.", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435697636", "createdAt": "2020-06-05T05:29:31Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/components/question-types/question-statistics/mcq-question-statistics.component.ts", "diffHunk": "@@ -124,4 +132,31 @@ export class McqQuestionStatisticsComponent\n     }\n   }\n \n+  private sortChoices = (item1: string, item2: string): number => {\n+    return this.tableComparatorService.compareLexicographically(item1, item2, SortOrder.ASC);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MDE5NzE2", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-425019716", "createdAt": "2020-06-05T06:11:29Z", "commit": {"oid": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMToyOVrOGfhkow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMToyOVrOGfhkow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwOTA5MQ==", "bodyText": "I think it would be better to name as headerData? Else it might be misinterpreted as data for the whole column.", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435709091", "createdAt": "2020-06-05T06:11:29Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,78 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData<T> {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?(item1: T, item2: T): number; // Don't provide this field if you don't want this column to be sortable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8d06e91ee94d3459521e87c23d9a1931d5a28a1"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21e1e2df03d4fbd0e24edc37786d5f5f957bbe7a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/21e1e2df03d4fbd0e24edc37786d5f5f957bbe7a", "committedDate": "2020-06-05T06:35:38Z", "message": "Add sortable table, with MCQ statistics calling it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e34e8297a4d75552ac6694a8e29e8f31094ad67a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e34e8297a4d75552ac6694a8e29e8f31094ad67a", "committedDate": "2020-06-05T06:35:38Z", "message": "Fix CSS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae1d51d3ac7595560f6ba47e7e946046d78c240f", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ae1d51d3ac7595560f6ba47e7e946046d78c240f", "committedDate": "2020-06-05T06:38:24Z", "message": "Refactor to use more of table comparator service"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "902234aa143b039ba39a0d10fc52bc1dbea2cb71", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/902234aa143b039ba39a0d10fc52bc1dbea2cb71", "committedDate": "2020-06-05T06:31:58Z", "message": "Refactor to use more of table comparator service"}, "afterCommit": {"oid": "ae1d51d3ac7595560f6ba47e7e946046d78c240f", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ae1d51d3ac7595560f6ba47e7e946046d78c240f", "committedDate": "2020-06-05T06:38:24Z", "message": "Refactor to use more of table comparator service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ca4a521cc9604415cc2dcf5123ebed67b9d8470", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4ca4a521cc9604415cc2dcf5123ebed67b9d8470", "committedDate": "2020-06-05T06:47:22Z", "message": "Fix doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2a8441deaca0843a232f8930356d124edc63d77", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a2a8441deaca0843a232f8930356d124edc63d77", "committedDate": "2020-06-05T06:57:25Z", "message": "Clone original row instead of assigning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MTA3Njk4", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-425107698", "createdAt": "2020-06-05T08:41:09Z", "commit": {"oid": "a2a8441deaca0843a232f8930356d124edc63d77"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwODo0MToxMFrOGflo1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwODo0NDowNVrOGfluxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NTcwMg==", "bodyText": "We should follow the enum convention to have all letters capitalised.", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435775702", "createdAt": "2020-06-05T08:41:10Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/types/sort-properties.ts", "diffHunk": "@@ -141,6 +141,31 @@ export enum SortBy {\n      * Average score (exclude self-review) of the numerical scale question.\n      */\n     NUMERICAL_SCALE_AVERAGE_EXCLUDE_SELF,\n+\n+    /**\n+     * Option text\n+     */\n+    MCQ_Choice,\n+\n+    /**\n+     * Weight assigned to the option\n+     */\n+    MCQ_Weight,\n+\n+    /**\n+     * Number of selection of that option\n+     */\n+    MCQ_Response_Count,\n+\n+    /**\n+     * Percentage of selection of that option\n+     */\n+    MCQ_Percentage,\n+\n+    /**\n+     * Weighted percentage of selection of that option\n+     */\n+    MCQ_Weighted_Percentage,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a8441deaca0843a232f8930356d124edc63d77"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc3NzIyMw==", "bodyText": "To be consistent with other files, we put enum declaration at the top of class.", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r435777223", "createdAt": "2020-06-05T08:44:05Z", "author": {"login": "Derek-Hardy"}, "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,79 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { TableComparatorService } from '../../../services/table-comparator.service';\n+import { SortBy, SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable\n+}\n+\n+/**\n+ * Displays a sortable table, sorting by clicking on the header\n+ * Optional sortBy option provided for each column\n+ * Columns and rows provided must be aligned\n+ */\n+@Component({\n+  selector: 'tm-sortable-table',\n+  templateUrl: './sortable-table.component.html',\n+  styleUrls: ['./sortable-table.component.scss'],\n+})\n+export class SortableTableComponent implements OnInit {\n+\n+  @Input()\n+  columns: ColumnData[] = [];\n+\n+  @Input()\n+  rows: any[][] = [];\n+\n+  columnToSortBy: string = '';\n+  sortOrder: SortOrder = SortOrder.ASC;\n+  tableRows: any[][] = [];\n+\n+  // enum\n+  SortOrder: typeof SortOrder = SortOrder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a8441deaca0843a232f8930356d124edc63d77"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a885c9b6e62f94b380c0cf52b38ec4c11a45d037", "committedDate": "2020-06-05T08:54:51Z", "message": "Fix enum casing, change enum placement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NDY1NjI2", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-425465626", "createdAt": "2020-06-05T16:52:28Z", "commit": {"oid": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NTQ0Nzg0", "url": "https://github.com/TEAMMATES/teammates/pull/10166#pullrequestreview-425544784", "createdAt": "2020-06-05T18:49:29Z", "commit": {"oid": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxODo0OToyOVrOGf5sqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxODo0OToyOVrOGf5sqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNDM2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable\n          \n          \n            \n              sortBy?: SortBy; // optional if the column is not sortable\n          \n      \n    \n    \n  \n\nI would say comment like this is better :P", "url": "https://github.com/TEAMMATES/teammates/pull/10166#discussion_r436104360", "createdAt": "2020-06-05T18:49:29Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/sortable-table/sortable-table.component.ts", "diffHunk": "@@ -0,0 +1,79 @@\n+import { Component, Input, OnInit } from '@angular/core';\n+import { TableComparatorService } from '../../../services/table-comparator.service';\n+import { SortBy, SortOrder } from '../../../types/sort-properties';\n+\n+/**\n+ * Column data for sortable table\n+ */\n+export interface ColumnData {\n+  header: string;\n+  headerToolTip?: string;\n+  sortBy?: SortBy; // Don't provide this field if you don't want this column to be sortable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a885c9b6e62f94b380c0cf52b38ec4c11a45d037"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79d7fef05270e7e858f8147201e80ee9abe25b26", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/79d7fef05270e7e858f8147201e80ee9abe25b26", "committedDate": "2020-06-06T02:50:37Z", "message": "Make sortBy comment more concise\n\nCo-authored-by: Xiao Pu <xp.xiaopu@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f4626ed04e2852724180e496d0f3bc9e98487f4", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7f4626ed04e2852724180e496d0f3bc9e98487f4", "committedDate": "2020-06-06T03:42:40Z", "message": "Merge branch 'master' into 10155-sort-mcq-summary"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4340, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}