{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5NDk5NTE2", "number": 10316, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDo1NToyOFrOEOuWpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MzoyMVrOEQdeoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODc0OTgwOnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDo1NToyOFrOGyCKEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoyOTo1MVrOGz60YQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTExNzMyOQ==", "bodyText": "Have you manually verified that this works as intended? Just not sure whether returning undefined might provide the intended effect.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455117329", "createdAt": "2020-07-15T14:55:28Z", "author": {"login": "madanalogy"}, "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "diffHunk": "@@ -5,7 +5,7 @@\n       Recommended length\n     </span>\n     for the response:\n-    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">\n+    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength !== 0 ? model.recommendedLength : undefined\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUxNjY0OA==", "bodyText": "Yup it works. But I will change it to use '' instead for better clarity", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455516648", "createdAt": "2020-07-16T05:22:20Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "diffHunk": "@@ -5,7 +5,7 @@\n       Recommended length\n     </span>\n     for the response:\n-    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">\n+    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength !== 0 ? model.recommendedLength : undefined\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTExNzMyOQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5NDI0MQ==", "bodyText": "Is this still necessary?", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457094241", "createdAt": "2020-07-20T06:29:51Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "diffHunk": "@@ -5,7 +5,7 @@\n       Recommended length\n     </span>\n     for the response:\n-    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">\n+    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength !== 0 ? model.recommendedLength : undefined\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTExNzMyOQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODc5Njg0OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-statistics/question-statistics-calculation/num-scale-question-statistics-calculation.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNTowNToyNFrOGyCnXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMzoxMzoxOFrOGyqThQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDgzMA==", "bodyText": "toFixed has a weakness in that it can add unnecessary 0s (e.g. 1 becomes 1.00, as you see how the snapshots change). Depending on the use case, it may be fine, but here we're talking about display so it's an issue.\nThis situation calls more for multiply by 100, Math.round, and divide by 100.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455124830", "createdAt": "2020-07-15T15:05:24Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-statistics/question-statistics-calculation/num-scale-question-statistics-calculation.ts", "diffHunk": "@@ -41,13 +41,13 @@ export class NumScaleQuestionStatisticsCalculation\n         const answersAsArray: number[] = stats.responses.map((resp: any) => resp.answer);\n         stats.max = Math.max(...answersAsArray);\n         stats.min = Math.min(...answersAsArray);\n-        stats.average = answersAsArray.reduce((a: number, b: number) => a + b, 0) / answersAsArray.length;\n+        stats.average = (answersAsArray.reduce((a: number, b: number) => a + b, 0) / answersAsArray.length).toFixed(2);\n \n         const answersExcludingSelfAsArray: number[] = stats.responses.filter((resp: any) => !resp.isSelf)\n             .map((resp: any) => resp.answer);\n         if (answersExcludingSelfAsArray.length) {\n-          stats.averageExcludingSelf = answersExcludingSelfAsArray.reduce((a: number, b: number) => a + b, 0)\n-              / answersExcludingSelfAsArray.length;\n+          stats.averageExcludingSelf = (answersExcludingSelfAsArray.reduce((a: number, b: number) => a + b, 0)\n+              / answersExcludingSelfAsArray.length).toFixed(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc3NTEwOQ==", "bodyText": "This situation calls more for multiply by 100, Math.round, and divide by 100.\n\nWow thanks for the suggestion!", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455775109", "createdAt": "2020-07-16T13:13:18Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-statistics/question-statistics-calculation/num-scale-question-statistics-calculation.ts", "diffHunk": "@@ -41,13 +41,13 @@ export class NumScaleQuestionStatisticsCalculation\n         const answersAsArray: number[] = stats.responses.map((resp: any) => resp.answer);\n         stats.max = Math.max(...answersAsArray);\n         stats.min = Math.min(...answersAsArray);\n-        stats.average = answersAsArray.reduce((a: number, b: number) => a + b, 0) / answersAsArray.length;\n+        stats.average = (answersAsArray.reduce((a: number, b: number) => a + b, 0) / answersAsArray.length).toFixed(2);\n \n         const answersExcludingSelfAsArray: number[] = stats.responses.filter((resp: any) => !resp.isSelf)\n             .map((resp: any) => resp.answer);\n         if (answersExcludingSelfAsArray.length) {\n-          stats.averageExcludingSelf = answersExcludingSelfAsArray.reduce((a: number, b: number) => a + b, 0)\n-              / answersExcludingSelfAsArray.length;\n+          stats.averageExcludingSelf = (answersExcludingSelfAsArray.reduce((a: number, b: number) => a + b, 0)\n+              / answersExcludingSelfAsArray.length).toFixed(2);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDgzMA=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODc5Njk4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "isResolved": false, "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNTowNToyNlrOGyCndw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoxNzoyN1rOGzq5Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ==", "bodyText": "I don't think this is the right fix.\nSomewhere in the code there is a logic such that if responseDetails.answers is initialized for the first time, it will be padded with zeroes. That's what needs to be changed.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455124855", "createdAt": "2020-07-15T15:05:26Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc3MzkzNQ==", "bodyText": "It is padded with zeroes due to the submission parameters requiring 0s in the model. Otherwise the half-filled array would fail the model submission when the user clicks save. I couldn't find any way to intercept the process between the user clicking save and actually submitting to server to change the value right before the actual submission. I could change the backend to accept null values though.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455773935", "createdAt": "2020-07-16T13:11:28Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkzOTg5Mw==", "bodyText": "The 0's is not padded. It is placeholder to enable you update the second/thrid/... option.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455939893", "createdAt": "2020-07-16T17:08:13Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIyNDgxNg==", "bodyText": "@xpdavid so what do you suggest we do here? Or is the fix proposed here sufficient?", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456224816", "createdAt": "2020-07-17T05:23:34Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIyODc1Mw==", "bodyText": "I think I can directly give the fix to solve the problem :P\n\n  \n    \n      teammates/src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.ts\n    \n    \n        Lines 38 to 41\n      in\n      dd9977e\n    \n    \n    \n    \n\n        \n          \n           if (newAnswers.length !== this.questionDetails.numOfConstSumOptions) { \n        \n\n        \n          \n             // initialize answers array on the fly \n        \n\n        \n          \n             newAnswers = Array(this.questionDetails.numOfConstSumOptions).fill(0); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nChange 0 to RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED constant.\nKeep the current logic, add a check for RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED and display it as empty string also.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456228753", "createdAt": "2020-07-17T05:39:00Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIyOTcyMw==", "bodyText": "That variable is for rank recipients question though, although the purpose do otherwise fit", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456229723", "createdAt": "2020-07-17T05:42:27Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI4MTYwMA==", "bodyText": "Keep the current logic, add a check for RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED and display it as empty string also.\n\nI don't understand how this is better. Where would this check happen? Similar to [ngModel]=\"responseDetails.answers[i] || ''\" except that it is now [ngModel]=\"responseDetails.answers[i] === RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED ? responseDetails.answers[i] : ''\"?", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456281600", "createdAt": "2020-07-17T07:56:52Z", "author": {"login": "ccyccyccy"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxNTYwMQ==", "bodyText": "Sorry for the confusion. There are several things here.\n\n0 is a valid answer so it should not be displayed as '' (I might be wrong of this)\nTherefore, we should only display *_NOT_SUBMITTED as empty string for input box\nRANK_CONSTANT_ANSWER_NOT_SUBMITTED is not zero and is a special value (try search it in the code base).", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456615601", "createdAt": "2020-07-17T18:47:02Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc2MzEzMw==", "bodyText": "@xpdavid I hate to be the bearer of bad news, but the back-end doesn't have any special treatment for that kind of value for constant sum question type. It does have for rank question, but this is not what the issue at hand is.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456763133", "createdAt": "2020-07-18T07:54:02Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzM1MQ==", "bodyText": "Understood. However, if we want to achieve the behavior of having empty string displayed when user does not touch the box, we will need a special value here.\nI think it needs more discussion on how do we want to achieve the behavior. Can we remove the commit and continue with other commits on this PR.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r456833351", "createdAt": "2020-07-18T22:17:27Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html", "diffHunk": "@@ -4,7 +4,7 @@\n   </div>\n   <div class=\"col-12 col-sm-5\">\n     <input type=\"number\" class=\"form-control\"\n-           [ngModel]=\"i < responseDetails.answers.length ? responseDetails.answers[i] : ''\"\n+           [ngModel]=\"responseDetails.answers[i] || ''\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyNDg1NQ=="}, "originalCommit": {"oid": "f088ac03e3a746a56812911d5e2639938bd7ffbb"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MjA2MzM4OnYy", "diffSide": "RIGHT", "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTowNTo1MFrOGyh7aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTowNTo1MFrOGyh7aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYzNzg2NA==", "bodyText": "Similarly, I don't think this is not the right fix.\nThe cause is recommendedLength defaults to 0 in all the default data structures. It should default to undefined. You may need to indicate the field as @Nullable in the back-end such that the API output is marked as nullable.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r455637864", "createdAt": "2020-07-16T09:05:50Z", "author": {"login": "wkurniawan07"}, "path": "src/web/app/components/question-types/question-edit-details-form/text-question-edit-details-form.component.html", "diffHunk": "@@ -5,7 +5,7 @@\n       Recommended length\n     </span>\n     for the response:\n-    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">\n+    <input type=\"number\" class=\"form-control\" [ngModel]=\"model.recommendedLength !== 0 ? model.recommendedLength : ''\" (ngModelChange)=\"triggerModelChange('recommendedLength', $event)\" [disabled]=\"!isEditable\" min=\"0\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "654af2d08e80298432a278bc4c90d83d8a1c686d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MjAwNzY5OnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoyODoyNlrOGz6xQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoyODoyNlrOGz6xQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5MzQ0MA==", "bodyText": "Let's take this time to also fix the validation logic: recommendedLength should always be more than 0, because recommendedLength = 0 doesn't make sense.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457093440", "createdAt": "2020-07-20T06:28:26Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "diffHunk": "@@ -28,7 +31,7 @@ public boolean shouldChangesRequireResponseDeletion(FeedbackQuestionDetails newD\n     @Override\n     public List<String> validateQuestionDetails() {\n         List<String> errors = new ArrayList<>();\n-        if (recommendedLength < 0) {\n+        if (recommendedLength != null && recommendedLength < 0) {\n             errors.add(Const.FeedbackQuestion.TEXT_ERROR_INVALID_RECOMMENDED_LENGTH);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e75227aa3bd527d07df82fd2a07f56091677d6"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Njk1MTI5OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackQuestionActionTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MDoxNVrOG0n0_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MDoxNVrOG0n0_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMTY3Nw==", "bodyText": "Shouldn't this just be assertNull?", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457831677", "createdAt": "2020-07-21T04:40:15Z", "author": {"login": "xpdavid"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackQuestionActionTest.java", "diffHunk": "@@ -297,7 +297,7 @@ public void testExecute_invalidRecommendedLength_shouldThrowException() {\n                 logic.getFeedbackQuestion(typicalQuestion.getId()).getQuestionDescription());\n \n         // recommended length does not change\n-        assertEquals(0, ((FeedbackTextQuestionDetails) typicalQuestion.getQuestionDetails())\n+        assertEquals(null, ((FeedbackTextQuestionDetails) typicalQuestion.getQuestionDetails())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Njk1NDI1OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/datatransfer/FeedbackQuestionAttributesTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MjowN1rOG0n2wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MjowN1rOG0n2wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMjEzMA==", "bodyText": "And in other places.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457832130", "createdAt": "2020-07-21T04:42:07Z", "author": {"login": "xpdavid"}, "path": "src/test/java/teammates/test/cases/datatransfer/FeedbackQuestionAttributesTest.java", "diffHunk": "@@ -187,14 +187,14 @@ public void testValueOf_textQuestions_shouldDeserializeCorrectly() throws Invali\n \n         FeedbackQuestionAttributes fqa = FeedbackQuestionAttributes.valueOf(qn);\n         assertEquals(\"singleWord\", fqa.questionDetails.getQuestionText());\n-        assertEquals(0, ((FeedbackTextQuestionDetails) fqa.questionDetails).getRecommendedLength());\n+        assertEquals(null, ((FeedbackTextQuestionDetails) fqa.questionDetails).getRecommendedLength());\n \n         ______TS(\"legacy data: plain text: multiple words, should deserialize correctly\");\n         qn.setQuestionText(\"multiple words text\");\n \n         FeedbackQuestionAttributes fqaMulti = FeedbackQuestionAttributes.valueOf(qn);\n         assertEquals(\"multiple words text\", fqaMulti.questionDetails.getQuestionText());\n-        assertEquals(0, ((FeedbackTextQuestionDetails) fqaMulti.questionDetails).getRecommendedLength());\n+        assertEquals(null, ((FeedbackTextQuestionDetails) fqaMulti.questionDetails).getRecommendedLength());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Njk1NjQ4OnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNDo0MzoyMVrOG0n4DQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMzozMjoyNlrOG2iMjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMjQ2MQ==", "bodyText": "Just a note. This will change the things stored in database (should be backward-compatible though)", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457832461", "createdAt": "2020-07-21T04:43:21Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "diffHunk": "@@ -3,21 +3,24 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import javax.annotation.Nullable;\n+\n import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;\n import teammates.common.util.Const;\n \n public class FeedbackTextQuestionDetails extends FeedbackQuestionDetails {\n \n-    private int recommendedLength;\n+    @Nullable\n+    private Integer recommendedLength;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg0MDU4MA==", "bodyText": "I added this line if (recommendedLength != null && recommendedLength < 1) which would make all forms using the previous default value show an error if they tried to save. Would this be an issue?", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457840580", "createdAt": "2020-07-21T05:12:37Z", "author": {"login": "ccyccyccy"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "diffHunk": "@@ -3,21 +3,24 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import javax.annotation.Nullable;\n+\n import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;\n import teammates.common.util.Const;\n \n public class FeedbackTextQuestionDetails extends FeedbackQuestionDetails {\n \n-    private int recommendedLength;\n+    @Nullable\n+    private Integer recommendedLength;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMjQ2MQ=="}, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg0MzczMQ==", "bodyText": "This is fine as the frontend is bundled with the backend in production.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r457843731", "createdAt": "2020-07-21T05:23:43Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "diffHunk": "@@ -3,21 +3,24 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import javax.annotation.Nullable;\n+\n import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;\n import teammates.common.util.Const;\n \n public class FeedbackTextQuestionDetails extends FeedbackQuestionDetails {\n \n-    private int recommendedLength;\n+    @Nullable\n+    private Integer recommendedLength;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMjQ2MQ=="}, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTgzNjU1Nw==", "bodyText": "This should be backward compatible because it's equivalent to removing a field. If it's adding a field then we need to worry.", "url": "https://github.com/TEAMMATES/teammates/pull/10316#discussion_r459836557", "createdAt": "2020-07-24T03:32:26Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackTextQuestionDetails.java", "diffHunk": "@@ -3,21 +3,24 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import javax.annotation.Nullable;\n+\n import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;\n import teammates.common.util.Const;\n \n public class FeedbackTextQuestionDetails extends FeedbackQuestionDetails {\n \n-    private int recommendedLength;\n+    @Nullable\n+    private Integer recommendedLength;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgzMjQ2MQ=="}, "originalCommit": {"oid": "f7219fbfcdf4a6e0a1aac3ff521d8e4ccada5121"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3641, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}