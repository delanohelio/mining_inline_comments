{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5OTE2ODgx", "number": 9942, "title": "[#9939] View Team on Student Page does not show teammates details", "bodyText": "Fixes #9939\nPR Checklist\nOutline of Solution\nJust add conditional check. Quick question, why are the student profiles seen by the student different from those seen by instructor? Is it because one has more info?", "createdAt": "2020-02-01T16:54:43Z", "url": "https://github.com/TEAMMATES/teammates/pull/9942", "merged": true, "mergeCommit": {"oid": "7961e89d556fa127d8854597b532a229fd4e9fd0"}, "closed": true, "closedAt": "2020-03-19T17:46:05Z", "author": {"login": "hcwong"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC67m-AFqTM1NTg0NDY3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcO449LgH2gAyMzY5OTE2ODgxOmIxNTYxZGY3MWJiY2ExNTA4ZGNhZjE1NWVlNmFiOTRmNzdjMDg2OWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1ODQ0Njc4", "url": "https://github.com/TEAMMATES/teammates/pull/9942#pullrequestreview-355844678", "createdAt": "2020-02-10T10:53:32Z", "commit": {"oid": "40e484ea6cdcb0f51b7d53e59e4a862f02df4be2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "054fd7baaaf3b8bf850d592038bd2f82a4232176", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/054fd7baaaf3b8bf850d592038bd2f82a4232176", "committedDate": "2020-02-12T14:36:56Z", "message": "Do not show long term email"}, "afterCommit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3", "committedDate": "2020-02-12T14:40:59Z", "message": "Do not show long term email"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MDMxMTkx", "url": "https://github.com/TEAMMATES/teammates/pull/9942#pullrequestreview-358031191", "createdAt": "2020-02-13T08:33:24Z", "commit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MzYxNDM0", "url": "https://github.com/TEAMMATES/teammates/pull/9942#pullrequestreview-358361434", "createdAt": "2020-02-13T16:25:51Z", "commit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNTo1MVrOFpailw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNTo1MVrOFpailw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDc3NQ==", "bodyText": "Correct me if I am wrong. Looks like from your conversation history this is a potential security glitch says that \"the long term email should not be shown to student\". If this is the case, doing override in the frontend won't work. We need hide the field from the backend.", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r378970775", "createdAt": "2020-02-13T16:25:51Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-student/student-course-details-page/student-course-details-page.component.ts", "diffHunk": "@@ -114,17 +114,18 @@ export class StudentCourseDetailsPageComponent implements OnInit {\n             this.studentProfileService.getStudentProfile(student.email, courseId)\n                   .subscribe((studentProfile: StudentProfile) => {\n                     const newPhotoUrl: string =\n-              `${environment.backendUrl}/webapi/student/profilePic?courseid=${courseId}&studentemail=${student.email}`;\n+                      `${environment.backendUrl}/webapi/student/profilePic`\n+                      + `?courseid=${courseId}&studentemail=${student.email}`;\n \n                     const newTeammateProfile: StudentProfileWithPicture = {\n-                      studentProfile,\n+                      // Use student.email as studentProfile.email is the long term email which should not be shown", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3446e6b8e0d7d07f22f237d13b6c79ce8439c8f3"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a64b67466b6d132cb12c016321609617e08806e2", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a64b67466b6d132cb12c016321609617e08806e2", "committedDate": "2020-02-24T03:21:46Z", "message": "Hide some fields that should not be shown to students"}, "afterCommit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9", "committedDate": "2020-02-24T03:25:36Z", "message": "Fix lint error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMTcwODQ4", "url": "https://github.com/TEAMMATES/teammates/pull/9942#pullrequestreview-363170848", "createdAt": "2020-02-24T05:03:20Z", "commit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNTowMzoyMFrOFtVxIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNTowMzoyMFrOFtVxIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4Njg4Mw==", "bodyText": "I think you should change StudentProfileData instead. See how FeedbackSessionData is done.", "url": "https://github.com/TEAMMATES/teammates/pull/9942#discussion_r383086883", "createdAt": "2020-02-24T05:03:20Z", "author": {"login": "xpdavid"}, "path": "src/main/java/teammates/ui/webapi/action/GetStudentProfileAction.java", "diffHunk": "@@ -72,6 +72,12 @@ public ActionResult execute() {\n             studentProfile = StudentProfileAttributes.builder(studentId).build();\n         }\n \n+        // If student requesting and is not the student's own profile, hide some fields\n+        if (userInfo.isStudent && studentId.equals(userInfo.id)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae1661c96d68b96c8b02e7a58036b42ca7e9dfb9"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "55494c988a9a3399438042a8bd5934b42287a3cf", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/55494c988a9a3399438042a8bd5934b42287a3cf", "committedDate": "2020-02-24T06:01:14Z", "message": "Fix comments"}, "afterCommit": {"oid": "0b730ef2cea4db54636a83b992f97d544d8724a8", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0b730ef2cea4db54636a83b992f97d544d8724a8", "committedDate": "2020-03-05T16:23:42Z", "message": "Fix comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5Nzk1MzYz", "url": "https://github.com/TEAMMATES/teammates/pull/9942#pullrequestreview-369795363", "createdAt": "2020-03-05T18:05:47Z", "commit": {"oid": "0b730ef2cea4db54636a83b992f97d544d8724a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fafd836ad0bb3b6b1ebc42c4b1e414699d675ce3", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fafd836ad0bb3b6b1ebc42c4b1e414699d675ce3", "committedDate": "2020-03-11T04:35:48Z", "message": "Fix names not showing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d597fc06348aec5780dc805b33bdb60728395b44", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d597fc06348aec5780dc805b33bdb60728395b44", "committedDate": "2020-03-11T04:35:48Z", "message": "Fix lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb5ed1cb9d6353ce1bbe5f52f9a86f783eef7f94", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/cb5ed1cb9d6353ce1bbe5f52f9a86f783eef7f94", "committedDate": "2020-03-11T04:35:48Z", "message": "Update snapshot"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "909cd3732bf1349a5aa01cb0997b4987545485f3", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/909cd3732bf1349a5aa01cb0997b4987545485f3", "committedDate": "2020-03-11T04:35:48Z", "message": "Do not show long term email"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d46a0fd1d156a1907edaa8134a82353577994bac", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d46a0fd1d156a1907edaa8134a82353577994bac", "committedDate": "2020-03-11T04:35:48Z", "message": "Hide some fields that should not be shown to students"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba4fc35bb356c983a3c6705ce9fb69a618bb5dfd", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ba4fc35bb356c983a3c6705ce9fb69a618bb5dfd", "committedDate": "2020-03-11T04:35:48Z", "message": "Fix lint error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "397654dda46c0a9168f330aebd78b16e4cfc1937", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/397654dda46c0a9168f330aebd78b16e4cfc1937", "committedDate": "2020-03-11T04:35:48Z", "message": "Fix comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe1db603664c5102db5edccc72725e85c57d3e45", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fe1db603664c5102db5edccc72725e85c57d3e45", "committedDate": "2020-03-11T04:37:23Z", "message": "Fix linter errors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c91024245e67ddca9457942252f353ba682c940", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/4c91024245e67ddca9457942252f353ba682c940", "committedDate": "2020-03-07T18:54:56Z", "message": "Merge branch 'master' into fix/names-not-showing-student-team"}, "afterCommit": {"oid": "fe1db603664c5102db5edccc72725e85c57d3e45", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fe1db603664c5102db5edccc72725e85c57d3e45", "committedDate": "2020-03-11T04:37:23Z", "message": "Fix linter errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a80d3c0a0623b4b0329fe970d8688072a29f78a0", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a80d3c0a0623b4b0329fe970d8688072a29f78a0", "committedDate": "2020-03-17T06:50:39Z", "message": "Fix failing test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a0cb6bb28133f7ec5b126939d3944a01329022a1", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a0cb6bb28133f7ec5b126939d3944a01329022a1", "committedDate": "2020-03-17T05:06:16Z", "message": "Fix failing test"}, "afterCommit": {"oid": "a80d3c0a0623b4b0329fe970d8688072a29f78a0", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/a80d3c0a0623b4b0329fe970d8688072a29f78a0", "committedDate": "2020-03-17T06:50:39Z", "message": "Fix failing test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1561df71bbca1508dcaf155ee6ab94f77c0869b", "author": {"user": {"login": "joanneong", "name": "Joanne Ong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b1561df71bbca1508dcaf155ee6ab94f77c0869b", "committedDate": "2020-03-18T15:17:55Z", "message": "Merge branch 'master' into fix/names-not-showing-student-team"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4429, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}