{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMDg5Nzg4", "number": 10327, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNToxMFrOEPy5Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMjo0MTo0NVrOEQcQFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTk3OTkxOnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNToxMFrOGzq7OA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOVQwOToyODozOVrOGzuDIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzg0OA==", "bodyText": "Will this result in NPE?", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456833848", "createdAt": "2020-07-18T22:25:10Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -82,6 +82,12 @@ protected static Url createLocalUrl(String testFileName) throws IOException {\n      * Logs in a page using admin credentials (i.e. in masquerade mode).\n      */\n     protected <T extends AppPage> T loginAdminToPage(AppUrl url, Class<T> typeOfPage) {\n+        // When not using dev server, Google blocks log in by automation.\n+        // To log in, log in manually to teammates in your browser before running e2e tests.\n+        // Refer to teammates.e2e.pageobjects.Browser for more information.\n+        if (!TestProperties.isDevServer()) {\n+            return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg4NTAyNQ==", "bodyText": "I have changed it to return the AppPage of the url it should navigate to instead.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456885025", "createdAt": "2020-07-19T09:28:39Z", "author": {"login": "jtankw3"}, "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -82,6 +82,12 @@ protected static Url createLocalUrl(String testFileName) throws IOException {\n      * Logs in a page using admin credentials (i.e. in masquerade mode).\n      */\n     protected <T extends AppPage> T loginAdminToPage(AppUrl url, Class<T> typeOfPage) {\n+        // When not using dev server, Google blocks log in by automation.\n+        // To log in, log in manually to teammates in your browser before running e2e tests.\n+        // Refer to teammates.e2e.pageobjects.Browser for more information.\n+        if (!TestProperties.isDevServer()) {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzg0OA=="}, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTk4MDQyOnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNTo1M1rOGzq7bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNTo1M1rOGzq7bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzkwMQ==", "bodyText": "We should also delete code for google login?", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456833901", "createdAt": "2020-07-18T22:25:53Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -82,6 +82,12 @@ protected static Url createLocalUrl(String testFileName) throws IOException {\n      * Logs in a page using admin credentials (i.e. in masquerade mode).\n      */\n     protected <T extends AppPage> T loginAdminToPage(AppUrl url, Class<T> typeOfPage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTk4MDY3OnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/pageobjects/Browser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNjoyM1rOGzq7iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNjoyM1rOGzq7iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzkyOQ==", "bodyText": "I think we should do check the existing of the profile here. It's more user friendly.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456833929", "createdAt": "2020-07-18T22:26:23Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/pageobjects/Browser.java", "diffHunk": "@@ -126,10 +127,19 @@ private WebDriver createWebDriver() {\n             }\n             System.setProperty(\"webdriver.gecko.driver\", TestProperties.GECKODRIVER_PATH);\n \n+            FirefoxProfile profile;\n+            if (TestProperties.isDevServer()) {\n+                profile = new FirefoxProfile();\n+            } else {\n+                // Get user data from browser to bypass google blocking automated log in.\n+                // Log in manually to teammates to use that log in data for e2e tests.\n+                ProfilesIni profileIni = new ProfilesIni();\n+                profile = profileIni.getProfile(TestProperties.FIREFOX_PROFILE_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTk4MDgwOnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/pageobjects/Browser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNjozMVrOGzq7lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNjozMVrOGzq7lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzMzk0Mw==", "bodyText": "Same here.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456833943", "createdAt": "2020-07-18T22:26:31Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/pageobjects/Browser.java", "diffHunk": "@@ -146,6 +156,12 @@ private WebDriver createWebDriver() {\n \n             ChromeOptions options = new ChromeOptions();\n             options.addArguments(\"--allow-file-access-from-files\");\n+            if (!TestProperties.isDevServer()) {\n+                // Get user data from browser to bypass google blocking automated log in.\n+                // Log in manually to teammates to use that log in data for e2e tests.\n+                options.addArguments(\"user-data-dir=\" + TestProperties.CHROME_USER_DATA_PATH);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTk4MTUxOnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMjoyNzo0NFrOGzq76g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOVQwOTozMDo1NlrOGzuEDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzNDAyNg==", "bodyText": "I think it is more appropriate to throw exception with this message (and result in test fail). It is more explicit than a random NPE error where we need to trace down it to this line.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456834026", "createdAt": "2020-07-18T22:27:44Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -82,6 +82,12 @@ protected static Url createLocalUrl(String testFileName) throws IOException {\n      * Logs in a page using admin credentials (i.e. in masquerade mode).\n      */\n     protected <T extends AppPage> T loginAdminToPage(AppUrl url, Class<T> typeOfPage) {\n+        // When not using dev server, Google blocks log in by automation.\n+        // To log in, log in manually to teammates in your browser before running e2e tests.\n+        // Refer to teammates.e2e.pageobjects.Browser for more information.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg4NTI2MA==", "bodyText": "I was actually intending to skip the login process when the production server is used and not to cause failure.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r456885260", "createdAt": "2020-07-19T09:30:56Z", "author": {"login": "jtankw3"}, "path": "src/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -82,6 +82,12 @@ protected static Url createLocalUrl(String testFileName) throws IOException {\n      * Logs in a page using admin credentials (i.e. in masquerade mode).\n      */\n     protected <T extends AppPage> T loginAdminToPage(AppUrl url, Class<T> typeOfPage) {\n+        // When not using dev server, Google blocks log in by automation.\n+        // To log in, log in manually to teammates in your browser before running e2e tests.\n+        // Refer to teammates.e2e.pageobjects.Browser for more information.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzNDAyNg=="}, "originalCommit": {"oid": "220d2c59e5bf96c387585b2f35c8fba363254894"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Njc1NTQyOnYy", "diffSide": "RIGHT", "path": "src/e2e/java/teammates/e2e/pageobjects/GoogleLoginPage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMjo0MTo0NVrOG0mC4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMDo0ODo1MVrOG0yfmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgwMjQ2Nw==", "bodyText": "Actually this entire page can be deleted", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r457802467", "createdAt": "2020-07-21T02:41:45Z", "author": {"login": "xpdavid"}, "path": "src/e2e/java/teammates/e2e/pageobjects/GoogleLoginPage.java", "diffHunk": "@@ -1,38 +1,15 @@\n package teammates.e2e.pageobjects;\n \n-import org.openqa.selenium.By;\n-import org.openqa.selenium.NoSuchElementException;\n-import org.openqa.selenium.WebElement;\n-import org.openqa.selenium.support.FindBy;\n-import org.openqa.selenium.support.ui.ExpectedConditions;\n-\n-import com.google.common.base.Preconditions;\n-\n-import teammates.e2e.util.TestProperties;\n-\n /**\n  * Page Object Model for the official Google Accounts login page.\n  */\n public class GoogleLoginPage extends LoginPage {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "596b46044196bfb20ebf149a06535727fdbba1cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAwNjQyNA==", "bodyText": "Let's keep it for now. I have a feeling we might be using this again some time; if I'm wrong we can always delete it later.", "url": "https://github.com/TEAMMATES/teammates/pull/10327#discussion_r458006424", "createdAt": "2020-07-21T10:48:51Z", "author": {"login": "wkurniawan07"}, "path": "src/e2e/java/teammates/e2e/pageobjects/GoogleLoginPage.java", "diffHunk": "@@ -1,38 +1,15 @@\n package teammates.e2e.pageobjects;\n \n-import org.openqa.selenium.By;\n-import org.openqa.selenium.NoSuchElementException;\n-import org.openqa.selenium.WebElement;\n-import org.openqa.selenium.support.FindBy;\n-import org.openqa.selenium.support.ui.ExpectedConditions;\n-\n-import com.google.common.base.Preconditions;\n-\n-import teammates.e2e.util.TestProperties;\n-\n /**\n  * Page Object Model for the official Google Accounts login page.\n  */\n public class GoogleLoginPage extends LoginPage {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgwMjQ2Nw=="}, "originalCommit": {"oid": "596b46044196bfb20ebf149a06535727fdbba1cb"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3659, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}