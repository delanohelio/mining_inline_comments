{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzkwNTA5", "number": 9930, "reviewThreads": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo0NzozM1rODb_DRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODozNTozN1rODej8sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjcxMTc0OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo0NzozM1rOFjyI1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQwMTo1ODoxM1rOFj_i9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NTk0MQ==", "bodyText": "verifyCannotAccess(studentAccessOtherTeamParams)", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373065941", "createdAt": "2020-01-30T16:47:33Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -158,7 +215,273 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",\n+        };\n+\n+        assertThrows(EntityNotFoundException.class, () -> getAction(nonExistParams).checkAccessControl());\n+\n+        ______TS(\"Unknown intent, should not be accessible\");\n+\n+        loginAsInstructor(instructor2OfCourse1.getGoogleId());\n+\n+        String[] unknownIntentParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.FULL_DETAIL.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse3.getId(),\n+        };\n+\n+        assertThrows(InvalidHttpParameterException.class, () -> getAction(unknownIntentParams).checkAccessControl());\n+    }\n+\n+    @Test\n+    protected void testAccessControl_giverNotModeratedStudent_inaccessible() {\n+\n+        ______TS(\"Instructor moderates student's response, but response not given by moderated student, \"\n+                + \"should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(testModerateResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student1InCourse1.getEmail(), testModerateResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(instructor1OfCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] moderatedStudentSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, testModerateResponse.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, student1InCourse1.getEmail(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, moderatedStudentSubmissionParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherStudent_inaccessible() throws Exception {\n+\n+        ______TS(\"Student intends to access other person's response, should not be accessible\");\n+\n+        loginAsStudent(student2InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(typicalResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student2InCourse1.getEmail(), typicalResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(typicalResponse.getRecipient());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherPersonParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherPersonParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherTeam_inaccessible() {\n+\n+        ______TS(\"Student intends to access other team's response, should not be accessible\");\n+\n+        loginAsStudent(student5InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.TEAMS,\n+                logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student5InCourse1.getTeam(), typicalResponse2.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(student5InCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherTeamParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherTeamParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1bca228674adeeff92cdaf4ff31cad633f1a459"}, "originalPosition": 243}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzI4NTYyMw==", "bodyText": "I did this initially because verifyCannotAccess() can't take in an UpdateRequest as a parameter. But now that I think about it I could overload the method thanks for the inspiration! :)", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373285623", "createdAt": "2020-01-31T01:58:13Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -158,7 +215,273 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",\n+        };\n+\n+        assertThrows(EntityNotFoundException.class, () -> getAction(nonExistParams).checkAccessControl());\n+\n+        ______TS(\"Unknown intent, should not be accessible\");\n+\n+        loginAsInstructor(instructor2OfCourse1.getGoogleId());\n+\n+        String[] unknownIntentParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.FULL_DETAIL.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse3.getId(),\n+        };\n+\n+        assertThrows(InvalidHttpParameterException.class, () -> getAction(unknownIntentParams).checkAccessControl());\n+    }\n+\n+    @Test\n+    protected void testAccessControl_giverNotModeratedStudent_inaccessible() {\n+\n+        ______TS(\"Instructor moderates student's response, but response not given by moderated student, \"\n+                + \"should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(testModerateResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student1InCourse1.getEmail(), testModerateResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(instructor1OfCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] moderatedStudentSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, testModerateResponse.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, student1InCourse1.getEmail(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, moderatedStudentSubmissionParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherStudent_inaccessible() throws Exception {\n+\n+        ______TS(\"Student intends to access other person's response, should not be accessible\");\n+\n+        loginAsStudent(student2InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(typicalResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student2InCourse1.getEmail(), typicalResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(typicalResponse.getRecipient());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherPersonParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherPersonParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherTeam_inaccessible() {\n+\n+        ______TS(\"Student intends to access other team's response, should not be accessible\");\n+\n+        loginAsStudent(student5InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.TEAMS,\n+                logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student5InCourse1.getTeam(), typicalResponse2.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(student5InCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherTeamParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherTeamParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NTk0MQ=="}, "originalCommit": {"oid": "a1bca228674adeeff92cdaf4ff31cad633f1a459"}, "originalPosition": 243}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjcyMTU4OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo1MDoyN1rOFjyPIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQwMjowMTozMFrOFj_lRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NzU1NQ==", "bodyText": "Already logged in?", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373067555", "createdAt": "2020-01-30T16:50:27Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -158,7 +215,273 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1bca228674adeeff92cdaf4ff31cad633f1a459"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzI4NjIxMg==", "bodyText": "Yea this would make more sense when I separate the test cases into their individual methods haha", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373286212", "createdAt": "2020-01-31T02:01:30Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -158,7 +215,273 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NzU1NQ=="}, "originalCommit": {"oid": "a1bca228674adeeff92cdaf4ff31cad633f1a459"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjczODU3OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo1NToxMVrOFjyZzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo1NToxMVrOFjyZzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA3MDI4NA==", "bodyText": "I think it would be good to enwrap this code into a helper method, since you're using it a lot. You can add things like recipient identifier as parameters and reuse the method instead of copy and pasting this.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373070284", "createdAt": "2020-01-30T16:55:11Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -158,7 +215,273 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",\n+        };\n+\n+        assertThrows(EntityNotFoundException.class, () -> getAction(nonExistParams).checkAccessControl());\n+\n+        ______TS(\"Unknown intent, should not be accessible\");\n+\n+        loginAsInstructor(instructor2OfCourse1.getGoogleId());\n+\n+        String[] unknownIntentParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.FULL_DETAIL.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse3.getId(),\n+        };\n+\n+        assertThrows(InvalidHttpParameterException.class, () -> getAction(unknownIntentParams).checkAccessControl());\n+    }\n+\n+    @Test\n+    protected void testAccessControl_giverNotModeratedStudent_inaccessible() {\n+\n+        ______TS(\"Instructor moderates student's response, but response not given by moderated student, \"\n+                + \"should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(testModerateResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student1InCourse1.getEmail(), testModerateResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(instructor1OfCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] moderatedStudentSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, testModerateResponse.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, student1InCourse1.getEmail(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, moderatedStudentSubmissionParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherStudent_inaccessible() throws Exception {\n+\n+        ______TS(\"Student intends to access other person's response, should not be accessible\");\n+\n+        loginAsStudent(student2InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.STUDENTS,\n+                logic.getFeedbackQuestion(typicalResponse.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student2InCourse1.getEmail(), typicalResponse.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(typicalResponse.getRecipient());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherPersonParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherPersonParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_studentAccessOtherTeam_inaccessible() {\n+\n+        ______TS(\"Student intends to access other team's response, should not be accessible\");\n+\n+        loginAsStudent(student5InCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.TEAMS,\n+                logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(student5InCourse1.getTeam(), typicalResponse2.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(student5InCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] studentAccessOtherTeamParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, studentAccessOtherTeamParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_instructorAccessOtherGiver_inaccessible() {\n+\n+        ______TS(\"Instructor intends to access other person's response, should not be accessible\");\n+\n+        loginAsInstructor(instructor2OfCourse1.getGoogleId());\n+\n+        assertEquals(FeedbackParticipantType.SELF,\n+                logic.getFeedbackQuestion(typicalResponse3.getFeedbackQuestionId()).getGiverType());\n+        assertNotEquals(instructor2OfCourse1.getEmail(), typicalResponse3.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(instructor2OfCourse1.getEmail());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+\n+        String[] instructorAccessOtherPersonParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse3.getId(),\n+        };\n+\n+        UpdateFeedbackResponseAction a = getAction(updateRequest, instructorAccessOtherPersonParams);\n+        assertThrows(UnauthorizedAccessException.class, a::checkAccessControl);\n     }\n \n+    @Test\n+    protected void testAccessControl_instructorAccessOwnResponse_accessible() {\n+\n+        ______TS(\"Instructor intends to access own response, should be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertEquals(instructor1OfCourse1.getEmail(), typicalResponse3.getGiver());\n+\n+        // send update request\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(typicalResponse3.getRecipient());\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1bca228674adeeff92cdaf4ff31cad633f1a459"}, "originalPosition": 289}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMTM3NzI1OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxODozMjoxMFrOFkenlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNjo1ODoyMlrOFknzBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5NDcxMA==", "bodyText": "Similar to the other tests, assert that a feedback response with ID \"randomNonExistId\" doesn't exist.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373794710", "createdAt": "2020-02-01T18:32:10Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -155,10 +201,263 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n         AssertHelper.assertContains(Const.FeedbackQuestion.MCQ_ERROR_INVALID_OPTION, e.getMessage());\n     }\n \n+    private FeedbackResponseUpdateRequest getUpdateRequest(String recipientIdentifier) {\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(recipientIdentifier);\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+        return updateRequest;\n+    }\n+\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+        // See individual test cases below\n+    }\n+\n+    @Test\n+    protected void testAccessControl_wrongGiver_inaccessible() {\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_previewMode_inaccessible() {\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+    }\n+\n+    @Test\n+    protected void testAccessControl_responseSessionNotOpen_inaccessible() {\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_containsQuestionNotForInstructor_inaccessible() {\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_noFeedbackResponse_inaccessible() {\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4950d373cec823cc061f740b311b107717bb62"}, "originalPosition": 204}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzkxOTcwNQ==", "bodyText": "Just checking my understanding on this, but isn't this already being done by this test case in the assertThrows() method call?", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373919705", "createdAt": "2020-02-03T04:38:48Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -155,10 +201,263 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n         AssertHelper.assertContains(Const.FeedbackQuestion.MCQ_ERROR_INVALID_OPTION, e.getMessage());\n     }\n \n+    private FeedbackResponseUpdateRequest getUpdateRequest(String recipientIdentifier) {\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(recipientIdentifier);\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+        return updateRequest;\n+    }\n+\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+        // See individual test cases below\n+    }\n+\n+    @Test\n+    protected void testAccessControl_wrongGiver_inaccessible() {\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_previewMode_inaccessible() {\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+    }\n+\n+    @Test\n+    protected void testAccessControl_responseSessionNotOpen_inaccessible() {\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_containsQuestionNotForInstructor_inaccessible() {\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_noFeedbackResponse_inaccessible() {\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5NDcxMA=="}, "originalCommit": {"oid": "ca4950d373cec823cc061f740b311b107717bb62"}, "originalPosition": 204}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk0NTA5Mw==", "bodyText": "Not exactly, the assertThrows method call verifies that the method says that the feedback response doesn't exist. However, we want to verify that this is indeed correct (i.e. what if there's actually a feedback response ID with \"randomNonExistId\"? This is similar to your testAccessControl_studentAccessOtherTeam_inaccessible method, where before the check you verify that (1) the question is indeed for responding as a team and (2) the team giving the response is not the team of the logged in student.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373945093", "createdAt": "2020-02-03T06:58:22Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -155,10 +201,263 @@ public void testExecute_instructorFeedbackSubmissionMcqGenerateOptionsForTeams_s\n         AssertHelper.assertContains(Const.FeedbackQuestion.MCQ_ERROR_INVALID_OPTION, e.getMessage());\n     }\n \n+    private FeedbackResponseUpdateRequest getUpdateRequest(String recipientIdentifier) {\n+        FeedbackResponseUpdateRequest updateRequest = new FeedbackResponseUpdateRequest();\n+        updateRequest.setQuestionType(FeedbackQuestionType.MCQ);\n+        updateRequest.setRecipientIdentifier(recipientIdentifier);\n+        FeedbackMcqResponseDetails newDetails = new FeedbackMcqResponseDetails();\n+        newDetails.setAnswer(\"TEAM_NOT_EXIST\");\n+        updateRequest.setResponseDetails(newDetails);\n+        return updateRequest;\n+    }\n+\n     @Test\n     @Override\n     protected void testAccessControl() throws Exception {\n-        // TODO\n+        // See individual test cases below\n+    }\n+\n+    @Test\n+    protected void testAccessControl_wrongGiver_inaccessible() {\n+\n+        ______TS(\"wrong giver type\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] wrongGiverTypeParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+        };\n+\n+        verifyCannotAccess(wrongGiverTypeParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_previewMode_inaccessible() {\n+\n+        ______TS(\"preview mode, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        String[] previewParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.PREVIEWAS, instructor1OfCourse1.email,\n+        };\n+\n+        verifyCannotAccess(previewParams);\n+\n+    }\n+\n+    @Test\n+    protected void testAccessControl_responseSessionNotOpen_inaccessible() {\n+\n+        ______TS(\"response in session not open, cannot access\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertFalse(closedSession.isOpened());\n+\n+        String[] sessionNotOpenParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, responseInClosedSession.getId(),\n+        };\n+\n+        verifyCannotAccess(sessionNotOpenParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_containsQuestionNotForInstructor_inaccessible() {\n+\n+        ______TS(\"Response contains question not intended shown to instructor, \"\n+                + \"moderated instructor should not be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.googleId);\n+\n+        assertFalse(logic.getFeedbackQuestion(typicalResponse2.getFeedbackQuestionId())\n+                .getShowResponsesTo().contains(FeedbackParticipantType.INSTRUCTORS));\n+\n+        String[] invalidModeratedInstructorSubmissionParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.INSTRUCTOR_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse2.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, instructor1OfCourse1.getEmail(),\n+        };\n+\n+        verifyCannotAccess(invalidModeratedInstructorSubmissionParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_noFeedbackResponse_inaccessible() {\n+\n+        ______TS(\"non-existent feedback response\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] nonExistParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5NDcxMA=="}, "originalCommit": {"oid": "ca4950d373cec823cc061f740b311b107717bb62"}, "originalPosition": 204}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMTM3ODg0OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxODozNjo1MlrOFkeogQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxODozNjo1MlrOFkeogQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5NDk0NQ==", "bodyText": "Let's try to reduce the amount of class variables used, where possible.\nclosedSession (and responseInClosedSession) is only used in one method (testAccessControl_responseSessionNotOpen_inaccessible), we can refactor all the code into there.\nAlso let's have more descriptive names for the responses. Instead of typicalResponse, how about \"student1ResponseToStudent1\".", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r373794945", "createdAt": "2020-02-01T18:36:52Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,18 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;\n+    private InstructorAttributes instructor2OfCourse1;\n+    private InstructorAttributes instructor1OfCourse1;\n+    private FeedbackResponseAttributes typicalResponse;\n+    private FeedbackResponseAttributes testModerateResponse;\n+    private FeedbackResponseAttributes typicalResponse2;\n+    private FeedbackResponseAttributes typicalResponse3;\n+    private FeedbackResponseAttributes responseInClosedSession;\n+    private FeedbackSessionAttributes closedSession;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4950d373cec823cc061f740b311b107717bb62"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk1MDQ4OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowNjoxMVrOFlI-Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowNjoxMVrOFlI-Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ4ODYzNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertThrows(NullHttpParameterException.class, () -> getAction(missingResponseIdParams).checkAccessControl());\n          \n          \n            \n            verifyHttpParameterFailure(missingResponseIdParams);", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374488634", "createdAt": "2020-02-04T06:06:11Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -301,6 +302,34 @@ protected void testAccessControl_noFeedbackResponse_inaccessible() {\n         assertThrows(EntityNotFoundException.class, () -> getAction(nonExistParams).checkAccessControl());\n     }\n \n+    @Test\n+    protected void testAccessControl_missingIntent_inaccessible() {\n+\n+        ______TS(\"missing intent response parameters\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] missingIntentParams = new String[] {\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",\n+        };\n+\n+        assertThrows(EntityNotFoundException.class, () -> getAction(missingIntentParams).checkAccessControl());\n+    }\n+\n+    @Test\n+    protected void testAccessControl_missingResponseId_inaccessible() {\n+\n+        ______TS(\"missing response id parameters\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] missingResponseIdParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+        };\n+\n+        assertThrows(NullHttpParameterException.class, () -> getAction(missingResponseIdParams).checkAccessControl());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52581d7a03f61357c4e1c6fcff3537f084fb202c"}, "originalPosition": 145}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk1MjgyOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowODowNVrOFlI_vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowODowNVrOFlI_vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ4OTAyMw==", "bodyText": "A bit of a renaming, since this effectively comes down to a permission issue\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ______TS(\"Student intends to access own response, but logged in as instructor, should be accessible\");\n          \n          \n            \n                    ______TS(\"Instructor attempts to edit student's response with appropriate permission, should be accessible\");", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374489023", "createdAt": "2020-02-04T06:08:05Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -449,15 +497,58 @@ protected void testAccessControl_studentAccessOwnResponse_accessible() {\n \n         loginAsStudent(student1InCourse1.getGoogleId());\n \n-        assertEquals(student1InCourse1.getEmail(), typicalResponse.getGiver());\n+        assertEquals(student1InCourse1.getEmail(), student1ResponseToStudent1.getGiver());\n \n-        FeedbackResponseUpdateRequest updateRequest = getUpdateRequest(typicalResponse.getRecipient());\n+        FeedbackResponseUpdateRequest updateRequest = getUpdateRequest(student1ResponseToStudent1.getRecipient());\n \n         String[] studentAccessOwnPersonParams = new String[] {\n                 Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n-                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, student1ResponseToStudent1.getId(),\n         };\n \n         verifyCanAccess(updateRequest, studentAccessOwnPersonParams);\n     }\n+\n+    @Test\n+    protected void testAccessControl_instructorSubmitStudentResponse_accessible() {\n+\n+        ______TS(\"Student intends to access own response, but logged in as instructor, should be accessible\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52581d7a03f61357c4e1c6fcff3537f084fb202c"}, "originalPosition": 297}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk2NDM3OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoxNjo1OFrOFlJG0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoxNjo1OFrOFlJG0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5MDgzNA==", "bodyText": "Use a valid ID for this other than randomNonExistId. Then you shouldn't get the EntityNotFoundException and should instead properly get NullHttpParameterException.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374490834", "createdAt": "2020-02-04T06:16:58Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -301,6 +302,34 @@ protected void testAccessControl_noFeedbackResponse_inaccessible() {\n         assertThrows(EntityNotFoundException.class, () -> getAction(nonExistParams).checkAccessControl());\n     }\n \n+    @Test\n+    protected void testAccessControl_missingIntent_inaccessible() {\n+\n+        ______TS(\"missing intent response parameters\");\n+\n+        loginAsStudent(student1InCourse1.getGoogleId());\n+\n+        String[] missingIntentParams = new String[] {\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, \"randomNonExistId\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52581d7a03f61357c4e1c6fcff3537f084fb202c"}, "originalPosition": 128}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk4OTEwOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozMzozNlrOFlJV3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozMzozNlrOFlJV3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5NDY4NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ______TS(\"Student intends to access own response, but logged in as instructor without permission, \"\n          \n          \n            \n                    ______TS(\"Instructor attempts to edit student's response, but without appropriate permission, \"", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374494685", "createdAt": "2020-02-04T06:33:36Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -449,15 +497,58 @@ protected void testAccessControl_studentAccessOwnResponse_accessible() {\n \n         loginAsStudent(student1InCourse1.getGoogleId());\n \n-        assertEquals(student1InCourse1.getEmail(), typicalResponse.getGiver());\n+        assertEquals(student1InCourse1.getEmail(), student1ResponseToStudent1.getGiver());\n \n-        FeedbackResponseUpdateRequest updateRequest = getUpdateRequest(typicalResponse.getRecipient());\n+        FeedbackResponseUpdateRequest updateRequest = getUpdateRequest(student1ResponseToStudent1.getRecipient());\n \n         String[] studentAccessOwnPersonParams = new String[] {\n                 Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n-                Const.ParamsNames.FEEDBACK_RESPONSE_ID, typicalResponse.getId(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, student1ResponseToStudent1.getId(),\n         };\n \n         verifyCanAccess(updateRequest, studentAccessOwnPersonParams);\n     }\n+\n+    @Test\n+    protected void testAccessControl_instructorSubmitStudentResponse_accessible() {\n+\n+        ______TS(\"Student intends to access own response, but logged in as instructor, should be accessible\");\n+\n+        loginAsInstructor(instructor1OfCourse1.getGoogleId());\n+\n+        assertEquals(student1InCourse1.getEmail(), student1ResponseToStudent1.getGiver());\n+\n+        FeedbackResponseUpdateRequest updateRequest = getUpdateRequest(student1ResponseToStudent1.getRecipient());\n+\n+        String[] studentAccessOwnPersonParams = new String[] {\n+                Const.ParamsNames.INTENT, Intent.STUDENT_SUBMISSION.toString(),\n+                Const.ParamsNames.FEEDBACK_RESPONSE_ID, student1ResponseToStudent1.getId(),\n+                Const.ParamsNames.FEEDBACK_SESSION_MODERATED_PERSON, student1InCourse1.getEmail(),\n+        };\n+\n+        verifyCanAccess(updateRequest, studentAccessOwnPersonParams);\n+    }\n+\n+    @Test\n+    protected void testAccessControl_instructorSubmitStudentResponseNoPermission_inaccessible() {\n+\n+        ______TS(\"Student intends to access own response, but logged in as instructor without permission, \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52581d7a03f61357c4e1c6fcff3537f084fb202c"}, "originalPosition": 317}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzQ4MTUzOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTowOTo1MlrOFlXkrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMTowNDoyMFrOFmXQmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyNzg1Mw==", "bodyText": "This is only utilized in testAccessControl_studentAccessOtherStudent_inaccessible.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374727853", "createdAt": "2020-02-04T15:09:52Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc3MTI5MA==", "bodyText": "It's also needed in testAccessControl_giverNotModeratedStudent_inaccessible because it's required by testModerateResponse which in turn requires two additional students of which neither should be the moderated person", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r375771290", "createdAt": "2020-02-06T11:04:20Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyNzg1Mw=="}, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzQ4NDQ0OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNToxMDozNFrOFlXmjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMTowNDo1MlrOFmXRXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyODMzNA==", "bodyText": "This is only utilized in testAccessControl_studentAccessOtherTeam_inaccessible", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374728334", "createdAt": "2020-02-04T15:10:34Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc3MTQ4NA==", "bodyText": "It's also needed in testAccessControl_giverNotModeratedStudent_inaccessible because it's required by testModerateResponse which in turn requires two additional students of which neither should be the moderated person\n\nSame requirement here as above", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r375771484", "createdAt": "2020-02-06T11:04:52Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyODMzNA=="}, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzQ4NzQxOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNToxMToxNVrOFlXoVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNToxMToxNVrOFlXoVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyODc4OQ==", "bodyText": "This is only utilized in testAccessControl_instructorAccessOtherGiver_inaccessible. It's also used in unknown intent, but any other instructor / student will do too.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374728789", "createdAt": "2020-02-04T15:11:15Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;\n+    private InstructorAttributes instructor2OfCourse1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzQ5MTcwOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNToxMjoxM1rOFlXq9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNToxMjoxM1rOFlXq9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyOTQ2Mw==", "bodyText": "This is only utilized in testAccessControl_giverNotModeratedStudent_inaccessible", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374729463", "createdAt": "2020-02-04T15:12:13Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;\n+    private InstructorAttributes instructor2OfCourse1;\n+    private InstructorAttributes instructor1OfCourse1;\n+    private FeedbackResponseAttributes student1ResponseToStudent1;\n+    private FeedbackResponseAttributes testModerateResponse;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzYzMjIxOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTo0NTozN1rOFlZCPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMDo1Nzo0MlrOFmXE3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc1MTgwNw==", "bodyText": "This is used in testAccessControl_containsQuestionNotForInstructor_inaccessible and testAccessControl_studentAccessOtherTeam_inaccessible, can testAccessControl_containsQuestionNotForInstructor_inaccessible use some other response?", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r374751807", "createdAt": "2020-02-04T15:45:37Z", "author": {"login": "ChooJeremy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;\n+    private InstructorAttributes instructor2OfCourse1;\n+    private InstructorAttributes instructor1OfCourse1;\n+    private FeedbackResponseAttributes student1ResponseToStudent1;\n+    private FeedbackResponseAttributes testModerateResponse;\n+    private FeedbackResponseAttributes student4ResponseToTeam;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc2ODI4Nw==", "bodyText": "Hmm the assertion fails when I use student1ResponseToStudent1 or instructor1ResponseToAll. I've resorted to declaring the variable locally anyway for easier reference.", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r375768287", "createdAt": "2020-02-06T10:57:42Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/UpdateFeedbackResponseActionTest.java", "diffHunk": "@@ -25,6 +27,16 @@\n  */\n public class UpdateFeedbackResponseActionTest extends BaseActionTest<UpdateFeedbackResponseAction> {\n \n+    private StudentAttributes student1InCourse1;\n+    private StudentAttributes student2InCourse1;\n+    private StudentAttributes student5InCourse1;\n+    private InstructorAttributes instructor2OfCourse1;\n+    private InstructorAttributes instructor1OfCourse1;\n+    private FeedbackResponseAttributes student1ResponseToStudent1;\n+    private FeedbackResponseAttributes testModerateResponse;\n+    private FeedbackResponseAttributes student4ResponseToTeam;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc1MTgwNw=="}, "originalCommit": {"oid": "0aba0486482fe7951288c7cead14e23f7a3d0d4c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMzcyODUxOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/test/cases/webapi/BaseActionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODozNTozN1rOFnxBAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwMjoyMzowNVrOFn7__A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0MTg1Nw==", "bodyText": "The type is too specific for BaseActionTest? (i.e. what if we want to add this method for FeedbackResponseCreateRequest, FeedbackSessionCreateRequest etc.)", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r377241857", "createdAt": "2020-02-10T18:35:37Z", "author": {"login": "xpdavid"}, "path": "src/test/java/teammates/test/cases/webapi/BaseActionTest.java", "diffHunk": "@@ -433,12 +434,22 @@ protected void verifyCanAccess(String... params) {\n         c.checkAccessControl();\n     }\n \n+    protected void verifyCanAccess(FeedbackResponseUpdateRequest updateRequest, String... params) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21995a1d89b4d7ab983e5b8d3aba8e2244855bcc"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQyMTgyMA==", "bodyText": "Updated to now take in a BasicRequest instead", "url": "https://github.com/TEAMMATES/teammates/pull/9930#discussion_r377421820", "createdAt": "2020-02-11T02:23:05Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/test/cases/webapi/BaseActionTest.java", "diffHunk": "@@ -433,12 +434,22 @@ protected void verifyCanAccess(String... params) {\n         c.checkAccessControl();\n     }\n \n+    protected void verifyCanAccess(FeedbackResponseUpdateRequest updateRequest, String... params) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI0MTg1Nw=="}, "originalCommit": {"oid": "21995a1d89b4d7ab983e5b8d3aba8e2244855bcc"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4030, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}