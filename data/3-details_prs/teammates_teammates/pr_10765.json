{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MTk0NTEz", "number": 10765, "title": "[#10678] Complete removal of respondingInstructorList and respondingStudentList in FeedbackSessionAttributes", "bodyText": "Fixes #10678\nOutline of Solution\n\nSimply delete the two attributes and fix all errors in prod and tests.\nWARNING: This change is not backward-compatible with V6 (but with V7)", "createdAt": "2020-10-06T00:40:32Z", "url": "https://github.com/TEAMMATES/teammates/pull/10765", "merged": true, "mergeCommit": {"oid": "f8fc1c4dbf68552d8dda0aaa43c03bd6277afd6c"}, "closed": true, "closedAt": "2020-10-31T14:28:17Z", "author": {"login": "xpdavid"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP5I7BAFqTUwMjczNjMwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdX7Z6qAH2gAyNDk4MTk0NTEzOjllODUwOTBiZDkyMGMwYTdiMzQzMzU3ZTkyYTlhZmQ2OWI2MDhkYjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNzM2MzA4", "url": "https://github.com/TEAMMATES/teammates/pull/10765#pullrequestreview-502736308", "createdAt": "2020-10-06T09:10:01Z", "commit": {"oid": "8414b2d36c3af1dd18af9e327417c7f80f14a4c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOToxMDowMVrOHc9GzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOToxMDowMVrOHc9GzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEyMzM0MQ==", "bodyText": "\ud83d\udc4d this is a major bug in the testing infrastructure, but it seems to be a major widespread change if this is changed now. Let's revert this first and think about what to do to achieve this method's removal.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r500123341", "createdAt": "2020-10-06T09:10:01Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/core/DataBundleLogic.java", "diffHunk": "@@ -409,37 +311,10 @@ private void populateNullSection(StudentAttributes student) {\n         student.section = student.section == null ? \"None\" : student.section;\n     }\n \n-    private AccountAttributes makeAccount(InstructorAttributes instructor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8414b2d36c3af1dd18af9e327417c7f80f14a4c8"}, "originalPosition": 188}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8414b2d36c3af1dd18af9e327417c7f80f14a4c8", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8414b2d36c3af1dd18af9e327417c7f80f14a4c8", "committedDate": "2020-10-06T00:37:45Z", "message": "update unit tests"}, "afterCommit": {"oid": "0c0e721aa47e51917061c7c807e0663e5ee5d6e8", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0c0e721aa47e51917061c7c807e0663e5ee5d6e8", "committedDate": "2020-10-07T00:22:12Z", "message": "update unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNzY1NDk2", "url": "https://github.com/TEAMMATES/teammates/pull/10765#pullrequestreview-503765496", "createdAt": "2020-10-07T11:06:50Z", "commit": {"oid": "0c0e721aa47e51917061c7c807e0663e5ee5d6e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMTowNjo1MFrOHduFeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMTowNjo1MFrOHduFeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkyNTgxOA==", "bodyText": "I think we need a distinction between \"completed\" and \"attempted\".", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r500925818", "createdAt": "2020-10-07T11:06:50Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/api/Logic.java", "diffHunk": "@@ -719,13 +719,23 @@ public StudentAttributes joinCourseForStudent(String key, String googleId)\n         return studentsLogic.getUnregisteredStudentsForCourse(courseId);\n     }\n \n+    /**\n+     * Checks whether an instructor has completed a feedback session.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c0e721aa47e51917061c7c807e0663e5ee5d6e8"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c0e721aa47e51917061c7c807e0663e5ee5d6e8", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0c0e721aa47e51917061c7c807e0663e5ee5d6e8", "committedDate": "2020-10-07T00:22:12Z", "message": "update unit tests"}, "afterCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b296769c7531374276980a6cd5d72483d2c3d692", "committedDate": "2020-10-09T00:58:18Z", "message": "update unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NzgxMDgx", "url": "https://github.com/TEAMMATES/teammates/pull/10765#pullrequestreview-514781081", "createdAt": "2020-10-22T14:20:15Z", "commit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyMDoxNVrOHmkOdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDoyNzo0M1rOHmkl5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMTQ2Mw==", "bodyText": "Can this be extended to also check for student's team name? I don't think this was done before so this can be a future improvement.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510201463", "createdAt": "2020-10-22T14:20:15Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/logic/core/FeedbackSessionsLogic.java", "diffHunk": "@@ -228,8 +227,13 @@ public boolean isFeedbackSessionHasQuestionForStudents(\n         return !allQuestions.isEmpty();\n     }\n \n+    /**\n+     * Checks whether a student has completed a feedback session.\n+     *\n+     * <p> If there is no question for students, the feedback session is completed</p>\n+     */\n     public boolean isFeedbackSessionCompletedByStudent(FeedbackSessionAttributes fsa, String userEmail) {\n-        if (fsa.getRespondingStudentList().contains(userEmail)) {\n+        if (frLogic.hasGiverRespondedForSession(userEmail, fsa.getFeedbackSessionName(), fsa.getCourseId())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMzM1Mw==", "bodyText": "I think this is still a valid test though? Just that the last part should check for giver set instead of the removed field.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510203353", "createdAt": "2020-10-22T14:22:38Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackQuestionsLogicTest.java", "diffHunk": "@@ -601,35 +600,6 @@ public void testDeleteFeedbackQuestionCascade_nonExistentQuestion_shouldFailSile\n         assertNotNull(getQuestionFromDatastore(\"qn3InSession1InCourse1\"));\n     }\n \n-    @Test\n-    public void testDeleteFeedbackQuestionCascade_cascadeDeleteResponseOfStudent_shouldUpdateRespondents() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwMzc1Nw==", "bodyText": "I don't think this is necessary anymore. See if removing this line entirely affects anything.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510203757", "createdAt": "2020-10-22T14:23:08Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/ui/webapi/FeedbackSessionRemindEmailWorkerActionTest.java", "diffHunk": "@@ -47,7 +47,7 @@ public void testExecute() throws Exception {\n         FeedbackSessionAttributes session1 = typicalBundle.feedbackSessions.get(\"session1InCourse1\");\n         InstructorAttributes instructor1 = typicalBundle.instructors.get(\"instructor1OfCourse1\");\n \n-        // re-read from Datastore to update the respondents list\n+        // re-read from Datastore to get updated attributes\n         session1 = logic.getFeedbackSession(session1.getFeedbackSessionName(), session1.getCourseId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwNzExMg==", "bodyText": "Similarly, this is still a valid test? Just need to change the assertion step.", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510207112", "createdAt": "2020-10-22T14:27:21Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "diffHunk": "@@ -836,103 +798,6 @@ public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldDeleteR\n         assertTrue(frcLogic.getFeedbackResponseCommentForResponse(fra2GivenByTeam.getId()).isEmpty());\n     }\n \n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldUpdateInstructorRespondentsCorrectly()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 244}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwNzQ2Mw==", "bodyText": "Similarly here", "url": "https://github.com/TEAMMATES/teammates/pull/10765#discussion_r510207463", "createdAt": "2020-10-22T14:27:43Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/logic/core/FeedbackResponsesLogicTest.java", "diffHunk": "@@ -836,103 +798,6 @@ public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldDeleteR\n         assertTrue(frcLogic.getFeedbackResponseCommentForResponse(fra2GivenByTeam.getId()).isEmpty());\n     }\n \n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedTeamOfCourseCascade_shouldUpdateInstructorRespondentsCorrectly()\n-            throws Exception {\n-        String teamName = \"Team 2.1\";\n-        FeedbackResponseAttributes fra = getResponseFromDatastore(\"response1ForQ1S1C2\");\n-        InstructorAttributes instructor1OfCourse2 = dataBundle.instructors.get(\"instructor1OfCourse2\");\n-        // giver is instructor\n-        assertEquals(FeedbackParticipantType.INSTRUCTORS,\n-                fqLogic.getFeedbackQuestion(fra.getFeedbackQuestionId()).getGiverType());\n-        assertEquals(fra.getGiver(), instructor1OfCourse2.getEmail());\n-        // team is the recipient\n-        assertEquals(fra.getRecipient(), teamName);\n-\n-        // this is the only response the giver has given for the session\n-        assertEquals(1, frLogic.getFeedbackResponsesFromGiverForCourse(fra.getCourseId(), fra.getGiver()).stream()\n-                .filter(response -> response.getFeedbackSessionName().equals(fra.getFeedbackSessionName()))\n-                .count());\n-        // suppose the instructor is in the respondent list\n-        fsLogic.addInstructorRespondent(fra.getGiver(), fra.getFeedbackSessionName(), fra.getCourseId());\n-        assertTrue(\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId())\n-                        .getRespondingInstructorList().contains(fra.getGiver()));\n-\n-        Set<String> studentRespondentsBefore =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingStudentList();\n-\n-        // after the team's responses are deleted\n-        frLogic.deleteFeedbackResponsesInvolvedTeamOfCourseCascade(instructor1OfCourse2.getCourseId(), teamName);\n-\n-        Set<String> studentRespondentsAfter =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingStudentList();\n-        Set<String> instructorRespondentsAfter =\n-                fsLogic.getFeedbackSession(fra.getFeedbackSessionName(), fra.getCourseId()).getRespondingInstructorList();\n-        // student respondents not change\n-        assertEquals(studentRespondentsBefore, studentRespondentsAfter);\n-        // there is no instructor1OfCourse2 in instructor respondents\n-        assertFalse(instructorRespondentsAfter.contains(fra.getGiver()));\n-    }\n-\n-    @Test\n-    public void testDeleteFeedbackResponsesInvolvedInstructorOfCourseCascade_shouldDeleteRelevantResponses()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692"}, "originalPosition": 283}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "528ae3275e0991e88f8eee65166f2002fc1f5476", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/528ae3275e0991e88f8eee65166f2002fc1f5476", "committedDate": "2020-10-29T02:38:46Z", "message": "remove respondents list from production code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "707afec2ae6f4b2164d56b03bf35f11840ae4777", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/707afec2ae6f4b2164d56b03bf35f11840ae4777", "committedDate": "2020-10-29T02:53:54Z", "message": "update unit tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b296769c7531374276980a6cd5d72483d2c3d692", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b296769c7531374276980a6cd5d72483d2c3d692", "committedDate": "2020-10-09T00:58:18Z", "message": "update unit tests"}, "afterCommit": {"oid": "707afec2ae6f4b2164d56b03bf35f11840ae4777", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/707afec2ae6f4b2164d56b03bf35f11840ae4777", "committedDate": "2020-10-29T02:53:54Z", "message": "update unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMTA0Njg3", "url": "https://github.com/TEAMMATES/teammates/pull/10765#pullrequestreview-521104687", "createdAt": "2020-10-31T02:14:22Z", "commit": {"oid": "707afec2ae6f4b2164d56b03bf35f11840ae4777"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e85090bd920c0a7b343357e92a9afd69b608db7", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9e85090bd920c0a7b343357e92a9afd69b608db7", "committedDate": "2020-10-31T13:30:12Z", "message": "Merge branch 'master' into removal_respondents_list"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4193, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}