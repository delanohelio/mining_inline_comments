{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MjEzNTE4", "number": 10892, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNjo1NDo1NlrOFIOjlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxMTo0MjoxMlrOFI6j7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MTcxNDEzOnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetails.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNjo1NDo1NlrOIKB7tA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwMToxMjowOVrOIKOBvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODM0MA==", "bodyText": "The logic is wrong here. The remainder should be taken over answer - minScale, not simply answer. This logic will return no error with setting of minscale = 6, maxscale = 10, step = 0.7, answer = 7, while it should have returned error as the nearest answers are 6.7 and 7.4.", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r547388340", "createdAt": "2020-12-22T16:54:56Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetails.java", "diffHunk": "@@ -60,15 +58,16 @@ private static double convertTo5dp(double num) {\n             }\n \n             // when the answer is within range but not one of the possible values\n-            double interval = details.getAnswer() - minScale;\n-            double remainder = convertTo5dp(interval - Math.floor(interval / step) * step);\n-            boolean isAnswerNotAPossibleValueWithinRange = remainder != 0.0 && !isAnswerOutOfRange;\n+            BigDecimal answer = BigDecimal.valueOf(details.getAnswer());\n+            BigDecimal stepBd = BigDecimal.valueOf(step);\n+            BigDecimal remainder = answer.remainder(stepBd);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b851c0ebf8842d51d23d9c4e82428d688903597"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzU4NjQ5Mg==", "bodyText": "oh yes, your right - I have updated this", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r547586492", "createdAt": "2020-12-23T01:12:09Z", "author": {"login": "rrtheonlyone"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetails.java", "diffHunk": "@@ -60,15 +58,16 @@ private static double convertTo5dp(double num) {\n             }\n \n             // when the answer is within range but not one of the possible values\n-            double interval = details.getAnswer() - minScale;\n-            double remainder = convertTo5dp(interval - Math.floor(interval / step) * step);\n-            boolean isAnswerNotAPossibleValueWithinRange = remainder != 0.0 && !isAnswerOutOfRange;\n+            BigDecimal answer = BigDecimal.valueOf(details.getAnswer());\n+            BigDecimal stepBd = BigDecimal.valueOf(step);\n+            BigDecimal remainder = answer.remainder(stepBd);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODM0MA=="}, "originalCommit": {"oid": "6b851c0ebf8842d51d23d9c4e82428d688903597"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MTcxNjMzOnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNjo1NTozMFrOIKB89A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwMToxMjoxNFrOIKOBzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODY2MA==", "bodyText": "Use assertEquals instead?", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r547388660", "createdAt": "2020-12-22T16:55:30Z", "author": {"login": "wkurniawan07"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.size() == 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b851c0ebf8842d51d23d9c4e82428d688903597"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzU4NjUxMQ==", "bodyText": "done!", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r547586511", "createdAt": "2020-12-23T01:12:14Z", "author": {"login": "rrtheonlyone"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.size() == 1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODY2MA=="}, "originalCommit": {"oid": "6b851c0ebf8842d51d23d9c4e82428d688903597"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0Nzc2ODg4OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwMToxMjoyMFrOIK78tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwMTozNjowNlrOIK8O8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODMzODg3MA==", "bodyText": "Your test description says 1.33333 but the answer here is 1.333, I'm assuming the description is the correct one?", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r548338870", "createdAt": "2020-12-24T01:12:20Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.2 and 1.3.\", errors.get(0));\n+\n+        ______TS(\"Test Val=1.333 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.3 and 1.4.\", errors.get(0));\n+\n+        ______TS(\"Test Val=2 and Step=0.1 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(2);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        numScaleQuestion.setStep(0.00001);\n+\n+        ______TS(\"Test Val=1.33333 and Step=0.00001 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb860e22962671a3d85ed6720df9b336655bdc6e"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODM0MzUzOQ==", "bodyText": "yes updated", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r548343539", "createdAt": "2020-12-24T01:36:06Z", "author": {"login": "rrtheonlyone"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.2 and 1.3.\", errors.get(0));\n+\n+        ______TS(\"Test Val=1.333 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.3 and 1.4.\", errors.get(0));\n+\n+        ______TS(\"Test Val=2 and Step=0.1 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(2);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        numScaleQuestion.setStep(0.00001);\n+\n+        ______TS(\"Test Val=1.33333 and Step=0.00001 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODMzODg3MA=="}, "originalCommit": {"oid": "eb860e22962671a3d85ed6720df9b336655bdc6e"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0Nzc3MDk1OnYy", "diffSide": "RIGHT", "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwMToxMzo1NlrOIK796Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQwMTozNjoyMVrOIK8PMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODMzOTE3Nw==", "bodyText": "All the tests below reference Step=1 but you set it to 0.7 here, just to confirm that this was intentional to trigger an error right?", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r548339177", "createdAt": "2020-12-24T01:13:56Z", "author": {"login": "madanalogy"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.2 and 1.3.\", errors.get(0));\n+\n+        ______TS(\"Test Val=1.333 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.3 and 1.4.\", errors.get(0));\n+\n+        ______TS(\"Test Val=2 and Step=0.1 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(2);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        numScaleQuestion.setStep(0.00001);\n+\n+        ______TS(\"Test Val=1.33333 and Step=0.00001 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.333333 and Step=0.00001 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.33333 and 1.33334.\",\n+                errors.get(0));\n+\n+        numScaleQuestion.setStep(0.7);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb860e22962671a3d85ed6720df9b336655bdc6e"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODM0MzYwMA==", "bodyText": "yes this was a recent change above - I updated description!", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r548343600", "createdAt": "2020-12-24T01:36:21Z", "author": {"login": "rrtheonlyone"}, "path": "src/test/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetailsTest.java", "diffHunk": "@@ -21,4 +25,122 @@ public void testIsFeedbackParticipantCommentsOnResponsesAllowed_shouldReturnFals\n         assertFalse(feedbackQuestionDetails.isFeedbackParticipantCommentsOnResponsesAllowed());\n     }\n \n+    @Test\n+    public void tesValidateResponseDetails() {\n+        FeedbackNumericalScaleQuestionDetails numScaleQuestion = new FeedbackNumericalScaleQuestionDetails();\n+        numScaleQuestion.setStep(0.1);\n+\n+        ______TS(\"Test Val=1.2 and Step=0.1 does no trigger error\");\n+        FeedbackNumericalScaleResponseDetails resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.2);\n+        List<String> errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.22 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.22);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.2 and 1.3.\", errors.get(0));\n+\n+        ______TS(\"Test Val=1.333 and Step=0.1 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.3 and 1.4.\", errors.get(0));\n+\n+        ______TS(\"Test Val=2 and Step=0.1 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(2);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        numScaleQuestion.setStep(0.00001);\n+\n+        ______TS(\"Test Val=1.33333 and Step=0.00001 does not trigger error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertTrue(errors.isEmpty());\n+\n+        ______TS(\"Test Val=1.333333 and Step=0.00001 triggers error\");\n+        resp = new FeedbackNumericalScaleResponseDetails();\n+        resp.setAnswer(1.333333);\n+        errors = numScaleQuestion.validateResponsesDetails(Arrays.asList(resp), 1);\n+        assertEquals(1, errors.size());\n+        assertEquals(\"Please enter a valid value. The two nearest valid values are 1.33333 and 1.33334.\",\n+                errors.get(0));\n+\n+        numScaleQuestion.setStep(0.7);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODMzOTE3Nw=="}, "originalCommit": {"oid": "eb860e22962671a3d85ed6720df9b336655bdc6e"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0ODkyMzk5OnYy", "diffSide": "RIGHT", "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetails.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxMTo0MjoxMlrOILGENw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxMTo0MjoxMlrOILGENw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODUwNDYzMQ==", "bodyText": "Previous variable names represent what they mean better, although admittedly a bit on the verbose side", "url": "https://github.com/TEAMMATES/teammates/pull/10892#discussion_r548504631", "createdAt": "2020-12-24T11:42:12Z", "author": {"login": "wkurniawan07"}, "path": "src/main/java/teammates/common/datatransfer/questions/FeedbackNumericalScaleQuestionDetails.java", "diffHunk": "@@ -60,15 +58,17 @@ private static double convertTo5dp(double num) {\n             }\n \n             // when the answer is within range but not one of the possible values\n-            double interval = details.getAnswer() - minScale;\n-            double remainder = convertTo5dp(interval - Math.floor(interval / step) * step);\n-            boolean isAnswerNotAPossibleValueWithinRange = remainder != 0.0 && !isAnswerOutOfRange;\n+            BigDecimal minval = BigDecimal.valueOf(this.minScale);\n+            BigDecimal answer = BigDecimal.valueOf(details.getAnswer());\n+            BigDecimal stepBd = BigDecimal.valueOf(step);\n+            BigDecimal remainder = answer.subtract(minval).remainder(stepBd);\n+            boolean isAnsMultipleOfStep = remainder.compareTo(BigDecimal.ZERO) == 0;\n+            if (!isAnsMultipleOfStep && !isAnswerOutOfRange) {\n+                double posValSmall = answer.subtract(remainder).setScale(5, RoundingMode.HALF_UP).doubleValue();\n+                double posValBig = answer.subtract(remainder).add(stepBd).setScale(5, RoundingMode.HALF_UP).doubleValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6fcd6ec528ffe227bcef4c9c4e9f1565781f343"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3351, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}