{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NDM1MjU2", "number": 10717, "title": "[#10703] Fix warning when instructor change visibility of question", "bodyText": "Fixes #10703\nOutline of Solution\nSimilar to the outline in #10703\n\nI think we should leave the isChanged variable as it is, and make it such that the visibility alone will not set this flag true. Instead, I'll make a isVisibilityChanged boolean that will be changed when visibility is changed, so that if only visibility is changed, we'll render a separate warning model so the user knows that responses will not be deleted. This is also for modularity so that the warning of deletion for feedback change can be done at a later date.\n\nSet a new isVisibilityChanged, create FILTER_PROPERTIES and add them into CLEAN_PROPERTIES so that it will not set isChanged flag true. Based on the isVisibilityChanged variable, we will render the warning respectively.\nOnly visibility changes:\n\nOnly non-visibility changes (No change from before):\n\nBoth visibility and other changes (No change from before):", "createdAt": "2020-09-18T16:59:42Z", "url": "https://github.com/TEAMMATES/teammates/pull/10717", "merged": true, "mergeCommit": {"oid": "633cbe88eab52e1a64ee6449c8321950abd9d3ec"}, "closed": true, "closedAt": "2020-10-02T15:51:09Z", "author": {"login": "helloImHai"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKIgFnAH2gAyNDg5NDM1MjU2OmJmNDdlYzU4MjQ0ZjkwY2Y0M2U2MWM5ZTMyNjY3NzkxNTE4OWJjZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOhsOigH2gAyNDg5NDM1MjU2OjI5ZTUwNjY5ZDMxZDFlZGNlOWVkNjA5Zjc3NDQwOTcxYzBjNjY0NGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bf47ec58244f90cf43e61c9e326677915189bcd0", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bf47ec58244f90cf43e61c9e326677915189bcd0", "committedDate": "2020-09-18T16:50:46Z", "message": "Add isVisibilityChanged flag and alert user accordingly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "672ecfc4d468b4cdac3f8d4c9b03dbe5b7bd8d25", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/672ecfc4d468b4cdac3f8d4c9b03dbe5b7bd8d25", "committedDate": "2020-09-19T04:10:27Z", "message": "Empty commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2b18a5f7d68afd1e54a1e07b7358d7a177a8018", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/d2b18a5f7d68afd1e54a1e07b7358d7a177a8018", "committedDate": "2020-09-19T04:33:36Z", "message": "Empty commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dca87d2c6b1da0ffddec2338582c64c66920527b", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/dca87d2c6b1da0ffddec2338582c64c66920527b", "committedDate": "2020-09-19T08:24:21Z", "message": "Edit message to instructor to be more descriptive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5fbcde4c42374a64967407c95afc95650aa244", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fe5fbcde4c42374a64967407c95afc95650aa244", "committedDate": "2020-09-19T08:36:37Z", "message": "Remove trailing white space"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7da7ba52100385a60d9bc176b57ad804174f65fb", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/7da7ba52100385a60d9bc176b57ad804174f65fb", "committedDate": "2020-09-20T15:33:44Z", "message": "Add correct warning for editing question feedback path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bc649a1a044be92ee0673f23843fdb44b8fd4e6", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2bc649a1a044be92ee0673f23843fdb44b8fd4e6", "committedDate": "2020-09-20T16:46:35Z", "message": "Empty commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "author": {"user": {"login": "niqiukun", "name": "Ni Tianzhen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1d8bd3c76f3da16ec0b32629ed110e07e5f25488", "committedDate": "2020-09-21T08:06:52Z", "message": "Merge branch 'master' into 10703-visibility-warning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMzc3OTQ4", "url": "https://github.com/TEAMMATES/teammates/pull/10717#pullrequestreview-492377948", "createdAt": "2020-09-21T08:32:23Z", "commit": {"oid": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwODozMjoyM1rOHVFcag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwODozNDo1NFrOHVFh_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg3MTMzOA==", "bodyText": "Typo", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r491871338", "createdAt": "2020-09-21T08:32:23Z", "author": {"login": "niqiukun"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n+  'giverType',\n+  'recipientType',\n+  'isUsingOtherFeedbackPath',\n+  'numberOfEntitiesToGiveFeedbackToSetting',\n+  'customNumberOfEntitiesToGiveFeedbackTo',\n+]);\n+const VISIBILITY_PROPTERIES: Set<string> = new Set<string>([", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg3Mjc2NA==", "bodyText": "I wouldn't put visibilities inside clean properties because clean properties represent UI properties that does not affect the question at the backend. Visibilities do change the question at the backend.", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r491872764", "createdAt": "2020-09-21T08:34:54Z", "author": {"login": "niqiukun"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n+  'giverType',\n+  'recipientType',\n+  'isUsingOtherFeedbackPath',\n+  'numberOfEntitiesToGiveFeedbackToSetting',\n+  'customNumberOfEntitiesToGiveFeedbackTo',\n+]);\n+const VISIBILITY_PROPTERIES: Set<string> = new Set<string>([\n+  'isUsingOtherVisibilitySetting',\n+  'showResponsesTo',\n+  'showGiverNameTo',\n+  'showRecipientNameTo',\n+  'commonVisibilitySettingName',\n+]);\n+const CLEAN_PROPERTIES: Set<string> = new Set<string>([\n+  ...VISIBILITY_PROPTERIES,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d8bd3c76f3da16ec0b32629ed110e07e5f25488"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5766d6865cdc377e62200465327c1f12610c7367", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/5766d6865cdc377e62200465327c1f12610c7367", "committedDate": "2020-09-25T02:04:17Z", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into 10703-visibility-warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35fd98dcfced4dac6c0778c3eaf707b504c3a1ec", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/35fd98dcfced4dac6c0778c3eaf707b504c3a1ec", "committedDate": "2020-09-25T02:17:48Z", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd1698a9cee2fe821829899ad51f69f9badeed4", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ebd1698a9cee2fe821829899ad51f69f9badeed4", "committedDate": "2020-09-25T02:53:41Z", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6246c37769b4a3a60f074f561894bbd329fc2b1a", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/6246c37769b4a3a60f074f561894bbd329fc2b1a", "committedDate": "2020-09-25T02:54:09Z", "message": "Merge branch '10703-visibility-warning' of https://github.com/helloImHai/teammates into 10703-visibility-warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "113e83b209a89325d0408606a607db097867a9b7", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/113e83b209a89325d0408606a607db097867a9b7", "committedDate": "2020-09-25T03:00:30Z", "message": "Make changes for lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ec0c72c326a6851e15d34f879aee0b78e7d7c17", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9ec0c72c326a6851e15d34f879aee0b78e7d7c17", "committedDate": "2020-09-25T03:39:56Z", "message": "Empty commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTAyMjI0", "url": "https://github.com/TEAMMATES/teammates/pull/10717#pullrequestreview-496102224", "createdAt": "2020-09-25T04:26:42Z", "commit": {"oid": "9ec0c72c326a6851e15d34f879aee0b78e7d7c17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNDoyNjo0MlrOHX0iYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNDoyNjo0MlrOHX0iYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc0MDA2Nw==", "bodyText": "Can we remove isChanged then?", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r494740067", "createdAt": "2020-09-25T04:26:42Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form-model.ts", "diffHunk": "@@ -54,4 +54,7 @@ export interface QuestionEditFormModel {\n   isSaving: boolean;\n   isCollapsed: boolean;\n   isChanged: boolean;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec0c72c326a6851e15d34f879aee0b78e7d7c17"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ccfc80e3b907413bcc7b8b4710affdeba271333", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/1ccfc80e3b907413bcc7b8b4710affdeba271333", "committedDate": "2020-09-25T05:20:15Z", "message": "Remove isChanged flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cb77403b1b91287f6536a2cdebc5b2620a8ec43", "author": {"user": {"login": "helloImHai", "name": "Hai Nguyen"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2cb77403b1b91287f6536a2cdebc5b2620a8ec43", "committedDate": "2020-09-25T06:06:42Z", "message": "Empty commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTMyMTE0", "url": "https://github.com/TEAMMATES/teammates/pull/10717#pullrequestreview-496132114", "createdAt": "2020-09-25T06:06:07Z", "commit": {"oid": "1ccfc80e3b907413bcc7b8b4710affdeba271333"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNjowNjowOFrOHX2ILw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNjowNjowOFrOHX2ILw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NjEyNw==", "bodyText": "We can use a more strict type here (and similarly below)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([\n          \n          \n            \n            const FEEDBACK_PATH_PROPERTIES: Set<keyof QuestionEditFormModel> = new Set<string>([", "url": "https://github.com/TEAMMATES/teammates/pull/10717#discussion_r494766127", "createdAt": "2020-09-25T06:06:08Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -15,7 +15,26 @@ import { SimpleModalType } from '../simple-modal/simple-modal-type';\n import { collapseAnim } from '../teammates-common/collapse-anim';\n import { QuestionEditFormMode, QuestionEditFormModel } from './question-edit-form-model';\n \n-const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);\n+const FEEDBACK_PATH_PROPERTIES: Set<string> = new Set<string>([", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ccfc80e3b907413bcc7b8b4710affdeba271333"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MzcwMDE5", "url": "https://github.com/TEAMMATES/teammates/pull/10717#pullrequestreview-496370019", "createdAt": "2020-09-25T12:23:27Z", "commit": {"oid": "2cb77403b1b91287f6536a2cdebc5b2620a8ec43"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29e50669d31d1edce9ed609f77440971c0c6644d", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/29e50669d31d1edce9ed609f77440971c0c6644d", "committedDate": "2020-10-02T08:27:21Z", "message": "Merge branch 'master' into 10703-visibility-warning"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4266, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}