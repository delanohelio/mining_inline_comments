{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMjY0Nzk0", "number": 10259, "title": "[#10213] Fix instructor session edit UI UX", "bodyText": "Part of #10213\nFixes most issues with instructor session edit UI.\n\nAdds a way to collapse question\n\nDefault is expanded\nAdded with a \"Collapse All\" button, similar to that at the result page\nOnly caret is clickable because of the other clickable elements on the header\n\n\n\nMake optional description box smaller\n\nBox will expand according to content\n\n\nFix clicking on feedback path that expands to show possible paths dismissing the tab\n\nFix cancel and save modal popping out when no changes are made.\n\nAlso fixed save modal only popping out once, but not on subsequent clicks\n\n\nAdd divider between \u201cChoose from template questions\u201d and the rest of the options under \u201cAdd new question\u201d\nRename \u201cDiscard\u201d to \u201cCancel\u201d to avoid confusion between \"Discard\" and \"Delete\"\nMCQ / MSQ / Distribution points(options) / Rank options: Add animation for clicking the \u2018X\u201d button\n\nIncrease distance between questions\nAdd tick icon to \"Save Changes\" button to make it look more similar to the \"Save\" button above.\nAdd cancel button below the question beside the \"Save Changes\" button", "createdAt": "2020-06-29T07:52:51Z", "url": "https://github.com/TEAMMATES/teammates/pull/10259", "merged": true, "mergeCommit": {"oid": "9d1a44fbf2afcc02507a57482ae39ccabdc200fd"}, "closed": true, "closedAt": "2020-07-04T07:41:18Z", "author": {"login": "ccyccyccy"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwBVa-gFqTQzOTE2MDY3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxiZHzgH2gAyNDQxMjY0Nzk0OmJkYTY0ZmIyMTAyMTlkY2FiNzdmYTUzNzY1MDFiMWU0YzZjZDY3YjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MTYwNjcw", "url": "https://github.com/TEAMMATES/teammates/pull/10259#pullrequestreview-439160670", "createdAt": "2020-06-29T13:47:45Z", "commit": {"oid": "98592bfd5e505c5a7b208e064f207e1ddfb6d4ff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/630f9b6fe853c7885103ffaf61193c550cdc7c57", "committedDate": "2020-06-30T04:00:58Z", "message": "Add collapsing for editing question"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "98592bfd5e505c5a7b208e064f207e1ddfb6d4ff", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/98592bfd5e505c5a7b208e064f207e1ddfb6d4ff", "committedDate": "2020-06-29T07:35:05Z", "message": "Lint and test fix"}, "afterCommit": {"oid": "52886c84b53bc217503ea9d61616ce1507cc0940", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/52886c84b53bc217503ea9d61616ce1507cc0940", "committedDate": "2020-06-30T04:09:03Z", "message": "Lint and test fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NzA4NTUz", "url": "https://github.com/TEAMMATES/teammates/pull/10259#pullrequestreview-439708553", "createdAt": "2020-06-30T06:35:38Z", "commit": {"oid": "52886c84b53bc217503ea9d61616ce1507cc0940"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTg0NzE1", "url": "https://github.com/TEAMMATES/teammates/pull/10259#pullrequestreview-439984715", "createdAt": "2020-06-30T12:56:26Z", "commit": {"oid": "52886c84b53bc217503ea9d61616ce1507cc0940"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjI2OTkw", "url": "https://github.com/TEAMMATES/teammates/pull/10259#pullrequestreview-440226990", "createdAt": "2020-06-30T17:15:44Z", "commit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzoxNTo0NFrOGrGlKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMzo0ODozMFrOGrV0FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0OTc2OA==", "bodyText": "Use triggerModelChange('isCollapsed', !model.isCollapsed)", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447849768", "createdAt": "2020-06-30T17:15:44Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -1,20 +1,24 @@\n <div class=\"card\" xmlns=\"http://www.w3.org/1999/html\">\n-  <div class=\"card-header text-white question-header\">\n+  <div class=\"card-header text-white question-header cursor-pointer\" (click)=\"model.isCollapsed = !model.isCollapsed\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTIzNg==", "bodyText": "I hope you can understand why you can directly change the model here.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851236", "createdAt": "2020-06-30T17:18:15Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -884,6 +893,18 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       { courseid: this.courseId, fsname: this.feedbackSessionName, previewas: this.emailOfInstructorToPreview });\n   }\n \n+  expandAll(): void {\n+    this.questionEditFormModels.forEach(((model: QuestionEditFormModel): void => {\n+      model.isCollapsed = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630f9b6fe853c7885103ffaf61193c550cdc7c57"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg1MTczNw==", "bodyText": "I think this will cause the style of rich-texst-editor to be changed globally. Can we just pass the property in the place where you need?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r447851737", "createdAt": "2020-06-30T17:19:05Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/rich-text-editor/rich-text-editor.component.ts", "diffHunk": "@@ -17,7 +17,7 @@ export class RichTextEditorComponent implements OnInit {\n   isInlineMode: boolean = true;\n \n   @Input()\n-  minHeightInPx: number = 150;\n+  minHeightInPx: number = 80;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b594bf6f34092b63fb98a09897f654e3353ae313"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODAxNg==", "bodyText": "I think this should be put at the top.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098016", "createdAt": "2020-07-01T03:41:57Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.ts", "diffHunk": "@@ -306,3 +318,5 @@ export class QuestionEditFormComponent implements OnInit {\n     }, () => {});\n   }\n }\n+\n+const CLEAN_PROPERTIES: Set<string> = new Set<string>(['isEditable', 'isCollapsed', 'isChanged']);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODE3MA==", "bodyText": "I think we can just delete the comment.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098170", "createdAt": "2020-07-01T03:42:45Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -447,14 +448,14 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n    * Converts feedback question to the question edit form model.\n    */\n   private getQuestionEditFormModel(feedbackQuestion: FeedbackQuestion): QuestionEditFormModel {\n-    return {\n+    const model: QuestionEditFormModel = {\n       feedbackQuestionId: feedbackQuestion.feedbackQuestionId,\n \n       questionNumber: feedbackQuestion.questionNumber,\n       questionBrief: feedbackQuestion.questionBrief,\n       questionDescription: feedbackQuestion.questionDescription,\n \n-      isQuestionHasResponses: false, // TODO use API to determine\n+      isQuestionHasResponses: false, // Using loadResponseStatusForQuestion to determine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA==", "bodyText": "If we just want to fix the bug for not popping up the alert model when saving the second time, I think the root cause is the response status is not updated when saving. Therefore, it is not necessary to add isChanged to the model?", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098588", "createdAt": "2020-07-01T03:44:41Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODc1OQ==", "bodyText": "In addition, I don't think this is the correct place to call the method.\n\nget*** should not trigger any side-effect.\nloadResponseStatusForQuestion will be called twice I believe when the page is loaded.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448098759", "createdAt": "2020-07-01T03:45:30Z", "author": {"login": "xpdavid"}, "path": "src/web/app/pages-instructor/instructor-session-edit-page/instructor-session-edit-page.component.ts", "diffHunk": "@@ -473,7 +474,10 @@ export class InstructorSessionEditPageComponent extends InstructorSessionBasePag\n       isEditable: false,\n       isSaving: false,\n       isCollapsed: false,\n+      isChanged: false,\n     };\n+    this.loadResponseStatusForQuestion(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5ODU4OA=="}, "originalCommit": {"oid": "44e1daec14248d89882f60ad8510e0dcacb32253"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA5OTM0OA==", "bodyText": "f?\n\n\nSince we are here. I think we can just create new component for the modal instead of appending it here.", "url": "https://github.com/TEAMMATES/teammates/pull/10259#discussion_r448099348", "createdAt": "2020-07-01T03:48:30Z", "author": {"login": "xpdavid"}, "path": "src/web/app/components/question-edit-form/question-edit-form.component.html", "diffHunk": "@@ -277,6 +264,21 @@ <h5>Changing the visibility after collecting responses is not recommended.</h5>\n     </div>\n   </div>\n </div>\n+<ng-template #discardModal let-modal>f", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c891b5e0e55ec1ff9ef61f7a3fd94e129a3e1d6c"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "694f072f06848cf462a0664bbeb409e1f0de6ea7", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/694f072f06848cf462a0664bbeb409e1f0de6ea7", "committedDate": "2020-07-01T12:11:15Z", "message": "Reduce size of optional description box"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52f70dc13e1ebf593e956480a2441f534f33b3c9", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/52f70dc13e1ebf593e956480a2441f534f33b3c9", "committedDate": "2020-07-01T12:11:23Z", "message": "Add click on hover submenu not dismiss menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4263dc00b5f7fac49073ba692326e15f3361a90", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/f4263dc00b5f7fac49073ba692326e15f3361a90", "committedDate": "2020-07-01T12:11:23Z", "message": "Add stricter typing for some functions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45c1bcaccf65f269196d60c8cdb07efcfabbcc00", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/45c1bcaccf65f269196d60c8cdb07efcfabbcc00", "committedDate": "2020-07-01T14:47:00Z", "message": "Add no modal saving and cancelling if no change detected. Side-effect include hasResponse modal for saving popping up more than once for multiple saves\""}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b79ef5d5b093fcdf7aa7988b1847bbf24e53677", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/0b79ef5d5b093fcdf7aa7988b1847bbf24e53677", "committedDate": "2020-07-01T14:47:12Z", "message": "Add red highlight on click for delete option buttons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc4c845c39c199f73c5c08e4783de1d3929fa129", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/cc4c845c39c199f73c5c08e4783de1d3929fa129", "committedDate": "2020-07-01T14:47:12Z", "message": "Add divider below 'Choose from template questions'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2739673403b517e5abb1cfc7efa7be3be68b6ade", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2739673403b517e5abb1cfc7efa7be3be68b6ade", "committedDate": "2020-07-01T14:47:12Z", "message": "Add some space between questions to more distinctly separate them"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "259caa42e8a78cf6678c6b06c764ec753312e65e", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/259caa42e8a78cf6678c6b06c764ec753312e65e", "committedDate": "2020-07-01T14:47:12Z", "message": "Add icon for 'Save Changes' button to make it more similar to the other save button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74cdd42878187fb95bc9adb33e11a770e52f5713", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/74cdd42878187fb95bc9adb33e11a770e52f5713", "committedDate": "2020-07-01T14:47:12Z", "message": "Rename cancel to discard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ae441c3191e479c311433f0bc64c4a8c9c2c47a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/2ae441c3191e479c311433f0bc64c4a8c9c2c47a", "committedDate": "2020-07-01T14:51:37Z", "message": "Add cancel to the bottom of the question beside 'Save Changes'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "52886c84b53bc217503ea9d61616ce1507cc0940", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/52886c84b53bc217503ea9d61616ce1507cc0940", "committedDate": "2020-06-30T04:09:03Z", "message": "Lint and test fix"}, "afterCommit": {"oid": "ec433d7e230225485b8f0e911fbce2e261663a72", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ec433d7e230225485b8f0e911fbce2e261663a72", "committedDate": "2020-07-01T14:51:42Z", "message": "Lint and test fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10e30d5134bc433731141daf686928545d0fa41a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/10e30d5134bc433731141daf686928545d0fa41a", "committedDate": "2020-07-01T15:32:01Z", "message": "Lint and test fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec433d7e230225485b8f0e911fbce2e261663a72", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/ec433d7e230225485b8f0e911fbce2e261663a72", "committedDate": "2020-07-01T14:51:42Z", "message": "Lint and test fix"}, "afterCommit": {"oid": "10e30d5134bc433731141daf686928545d0fa41a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/10e30d5134bc433731141daf686928545d0fa41a", "committedDate": "2020-07-01T15:32:01Z", "message": "Lint and test fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8b952c00e0ea3564d4772008dd36c3e2880680a", "author": {"user": {"login": "ccyccyccy", "name": "Chong Chee Yuan"}}, "url": "https://github.com/TEAMMATES/teammates/commit/e8b952c00e0ea3564d4772008dd36c3e2880680a", "committedDate": "2020-07-03T05:53:39Z", "message": "Change direct assignment to triggerModelChange for isCollapsed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTUzMDk1", "url": "https://github.com/TEAMMATES/teammates/pull/10259#pullrequestreview-442553095", "createdAt": "2020-07-03T20:26:54Z", "commit": {"oid": "e8b952c00e0ea3564d4772008dd36c3e2880680a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bda64fb210219dcab77fa5376501b1e4c6cd67b0", "author": {"user": {"login": "madanalogy", "name": "Ahmed Bahajjaj"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bda64fb210219dcab77fa5376501b1e4c6cd67b0", "committedDate": "2020-07-04T06:52:35Z", "message": "Merge branch 'master' into 10213-instructor-session-edit-ui-ux"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4375, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}