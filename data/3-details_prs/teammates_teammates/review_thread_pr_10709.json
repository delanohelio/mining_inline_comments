{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MTg4MjI2", "number": 10709, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMDoxN1rOEj2idw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMDowODo1N1rOEmw6MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDI5MTc1OnYy", "diffSide": "RIGHT", "path": "src/web/services/search.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMDoxN1rOHScywA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMDoxN1rOHScywA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwODE2MA==", "bodyText": "But right now we loss the type information by doing this?", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r489108160", "createdAt": "2020-09-16T01:30:17Z", "author": {"login": "xpdavid"}, "path": "src/web/services/search.service.ts", "diffHunk": "@@ -473,11 +459,10 @@ export class SearchService {\n }\n \n /**\n- * The typings for the response object returned by the instructor search service.\n+ * Generic search result type.\n  */\n-export interface InstructorSearchResult {\n-  searchStudentsTables: SearchStudentsListRowTable[];\n-  searchCommentsTables: SearchCommentsTable[];\n+export interface SearchResult {\n+  searchResult: any;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "121c3c39e77be366ddc759c654c0949c7da3c5b3"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDI5NDE2OnYy", "diffSide": "LEFT", "path": "src/web/services/search.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMTo0M1rOHSc0Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMTo0M1rOHSc0Ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwODUxNA==", "bodyText": "Why can't this just be comments: CommentSearchResult[]?", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r489108514", "createdAt": "2020-09-16T01:31:43Z", "author": {"login": "xpdavid"}, "path": "src/web/services/search.service.ts", "diffHunk": "@@ -473,11 +459,10 @@ export class SearchService {\n }\n \n /**\n- * The typings for the response object returned by the instructor search service.\n+ * Generic search result type.\n  */\n-export interface InstructorSearchResult {\n-  searchStudentsTables: SearchStudentsListRowTable[];\n-  searchCommentsTables: SearchCommentsTable[];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "121c3c39e77be366ddc759c654c0949c7da3c5b3"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDI5NDU5OnYy", "diffSide": "LEFT", "path": "src/web/services/search.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMTo0OVrOHSc0VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMTozMTo0OVrOHSc0VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwODU2NQ==", "bodyText": "And similar here", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r489108565", "createdAt": "2020-09-16T01:31:49Z", "author": {"login": "xpdavid"}, "path": "src/web/services/search.service.ts", "diffHunk": "@@ -473,11 +459,10 @@ export class SearchService {\n }\n \n /**\n- * The typings for the response object returned by the instructor search service.\n+ * Generic search result type.\n  */\n-export interface InstructorSearchResult {\n-  searchStudentsTables: SearchStudentsListRowTable[];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "121c3c39e77be366ddc759c654c0949c7da3c5b3"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjMzMDY3OnYy", "diffSide": "RIGHT", "path": "angular.json", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozNTo1NVrOHTXd-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozNTo1NVrOHTXd-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA2OTQ5OA==", "bodyText": "unnecessary changes? u can disable angular analytics globally with  ng analytics off so you don't get these changes", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r490069498", "createdAt": "2020-09-17T08:35:55Z", "author": {"login": "t-cheepeng"}, "path": "angular.json", "diffHunk": "@@ -158,5 +158,8 @@\n       }\n     }\n   },\n-  \"defaultProject\": \"teammates\"\n-}\n+  \"defaultProject\": \"teammates\",\n+  \"cli\": {\n+    \"analytics\": false\n+  }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6c932272f44001e515b7ecb2303c432374f655e"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0Mjc0OnYy", "diffSide": "RIGHT", "path": "src/web/app/pages-instructor/instructor-search-page/instructor-search-page.component.ts", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTowMlrOHTXlog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1Nzo1OFrOHTYWUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTQ1OA==", "bodyText": "\ud83d\udc4d . Yup this is what we were looking for with the refactoring!", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r490071458", "createdAt": "2020-09-17T08:39:02Z", "author": {"login": "t-cheepeng"}, "path": "src/web/app/pages-instructor/instructor-search-page/instructor-search-page.component.ts", "diffHunk": "@@ -84,4 +106,85 @@ export class InstructorSearchPageComponent implements OnInit {\n       this.statusMessageService.showErrorToast(resp.error.message);\n     });\n   }\n+\n+  private getSearchCommentsTable(searchResults: CommentSearchResult[]): SearchCommentsTable[] {\n+    return searchResults.map((res: CommentSearchResult) => ({\n+      feedbackSession: res.feedbackSession,\n+      questions: res.questions,\n+    }));\n+  }\n+\n+  private getCoursesWithStudents(students: Student[]): SearchStudentsListRowTable[] {\n+    const distinctCourses: string[] = Array.from(\n+        new Set(students.map((s: Student) => s.courseId)),\n+    );\n+    const coursesWithStudents: SearchStudentsListRowTable[] = distinctCourses.map(\n+        (courseId: string) => ({\n+          courseId,\n+          students: Array.from(\n+              new Set(\n+                  students\n+                      .filter((s: Student) => s.courseId === courseId),\n+              ),\n+          ).map((s: Student) => ({", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6c932272f44001e515b7ecb2303c432374f655e"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3Nzk0Ng==", "bodyText": "Got it. Could I just remove the tests for the functions removed? Or do I port them over to the components that are using them?", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r490077946", "createdAt": "2020-09-17T08:49:26Z", "author": {"login": "moziliar"}, "path": "src/web/app/pages-instructor/instructor-search-page/instructor-search-page.component.ts", "diffHunk": "@@ -84,4 +106,85 @@ export class InstructorSearchPageComponent implements OnInit {\n       this.statusMessageService.showErrorToast(resp.error.message);\n     });\n   }\n+\n+  private getSearchCommentsTable(searchResults: CommentSearchResult[]): SearchCommentsTable[] {\n+    return searchResults.map((res: CommentSearchResult) => ({\n+      feedbackSession: res.feedbackSession,\n+      questions: res.questions,\n+    }));\n+  }\n+\n+  private getCoursesWithStudents(students: Student[]): SearchStudentsListRowTable[] {\n+    const distinctCourses: string[] = Array.from(\n+        new Set(students.map((s: Student) => s.courseId)),\n+    );\n+    const coursesWithStudents: SearchStudentsListRowTable[] = distinctCourses.map(\n+        (courseId: string) => ({\n+          courseId,\n+          students: Array.from(\n+              new Set(\n+                  students\n+                      .filter((s: Student) => s.courseId === courseId),\n+              ),\n+          ).map((s: Student) => ({", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTQ1OA=="}, "originalCommit": {"oid": "b6c932272f44001e515b7ecb2303c432374f655e"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MzkyMw==", "bodyText": "If you could port them over in this PR, it would be great", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r490083923", "createdAt": "2020-09-17T08:57:58Z", "author": {"login": "t-cheepeng"}, "path": "src/web/app/pages-instructor/instructor-search-page/instructor-search-page.component.ts", "diffHunk": "@@ -84,4 +106,85 @@ export class InstructorSearchPageComponent implements OnInit {\n       this.statusMessageService.showErrorToast(resp.error.message);\n     });\n   }\n+\n+  private getSearchCommentsTable(searchResults: CommentSearchResult[]): SearchCommentsTable[] {\n+    return searchResults.map((res: CommentSearchResult) => ({\n+      feedbackSession: res.feedbackSession,\n+      questions: res.questions,\n+    }));\n+  }\n+\n+  private getCoursesWithStudents(students: Student[]): SearchStudentsListRowTable[] {\n+    const distinctCourses: string[] = Array.from(\n+        new Set(students.map((s: Student) => s.courseId)),\n+    );\n+    const coursesWithStudents: SearchStudentsListRowTable[] = distinctCourses.map(\n+        (courseId: string) => ({\n+          courseId,\n+          students: Array.from(\n+              new Set(\n+                  students\n+                      .filter((s: Student) => s.courseId === courseId),\n+              ),\n+          ).map((s: Student) => ({", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTQ1OA=="}, "originalCommit": {"oid": "b6c932272f44001e515b7ecb2303c432374f655e"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDgyNjcyOnYy", "diffSide": "RIGHT", "path": "src/web/services/search.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMDowODo1N1rOHW_H0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMDowODo1N1rOHW_H0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg2NDkxNQ==", "bodyText": "You can just call the method directly.\n\nThere is no need to use search service as a proxy\nThe naming is also a bit misleading as we are not searching instructor privilege.", "url": "https://github.com/TEAMMATES/teammates/pull/10709#discussion_r493864915", "createdAt": "2020-09-23T20:08:57Z", "author": {"login": "xpdavid"}, "path": "src/web/services/search.service.ts", "diffHunk": "@@ -120,87 +116,10 @@ export class SearchService {\n     return this.httpRequestService.get(ResourceEndpoints.SEARCH_COMMENTS, paramMap);\n   }\n \n-  getCoursesWithStudents(studentsRes: Students): SearchStudentsListRowTable[] {\n-    const { students }: { students: Student[] } = studentsRes;\n-\n-    const distinctCourses: string[] = Array.from(\n-      new Set(students.map((s: Student) => s.courseId)),\n+  searchInstructorPrivilege(courseId: string, sectionName: string): Observable<InstructorPrivilege> {\n+    return this.instructorService.loadInstructorPrivilege(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84ccac6f84e238bff1c9bae3d36037dd99ddc265"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3562, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}