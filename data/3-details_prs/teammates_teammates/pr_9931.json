{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3ODU3MDM1", "number": 9931, "title": "[#9382] Add ActionFactoryTest", "bodyText": "Part of #9382\nOutline of Solution\nAdd tests.", "createdAt": "2020-01-28T07:00:13Z", "url": "https://github.com/TEAMMATES/teammates/pull/9931", "merged": true, "mergeCommit": {"oid": "01a717c4b67fef90b8e18c8b36df1415a421cb36"}, "closed": true, "closedAt": "2020-02-02T18:58:43Z", "author": {"login": "hcwong"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_8oBzgFqTM1MTg2NjA0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcASD4ogH2gAyMzY3ODU3MDM1OmZmZjViZDNjNGFjYjMzYTc1Zjk1NWJiYmM0MjU4M2EzMDY4YWFjZTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxODY2MDQ5", "url": "https://github.com/TEAMMATES/teammates/pull/9931#pullrequestreview-351866049", "createdAt": "2020-02-01T05:04:02Z", "commit": {"oid": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQwNTowNDowM1rOFkcanQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQwNTowODozOVrOFkcbUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODYyMQ==", "bodyText": "This comment does not seem to be necessary because it does not add much information. You might want to remove this (and for the other tests below as well).", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758621", "createdAt": "2020-02-01T05:04:03Z", "author": {"login": "joanneong"}, "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODc2Ng==", "bodyText": "Besides just checking whether the exception is thrown, is it possible for you to check the error message? This is because even with ActionFactory.java, there can be ActionMappingException thrown for different reasons.\n(Same for the test below)", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758766", "createdAt": "2020-02-01T05:08:00Z", "author": {"login": "joanneong"}, "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing\n+        existingActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        Action existingAction = actionFactory.getAction(existingActionServletRequest, HttpGet.METHOD_NAME);\n+        assertTrue(existingAction instanceof GetAuthInfoAction);\n+\n+        ______TS(\"Action does not exist and ActionMappingException is thrown\");\n+\n+        MockHttpServletRequest nonExistentActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + \"blahblahblah\");\n+        // Use this value for testing\n+        nonExistentActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        assertThrows(ActionMappingException.class, () -> {\n+            actionFactory.getAction(nonExistentActionServletRequest, HttpGet.METHOD_NAME);\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1ODgwMA==", "bodyText": "There is a slight grammatical error here for \"Method does not on action exist\".", "url": "https://github.com/TEAMMATES/teammates/pull/9931#discussion_r373758800", "createdAt": "2020-02-01T05:08:39Z", "author": {"login": "joanneong"}, "path": "src/test/java/teammates/test/cases/webapi/ActionFactoryTest.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package teammates.test.cases.webapi;\n+\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.exception.ActionMappingException;\n+import teammates.common.util.Const;\n+import teammates.test.cases.BaseTestCase;\n+import teammates.test.driver.MockHttpServletRequest;\n+import teammates.ui.webapi.action.Action;\n+import teammates.ui.webapi.action.ActionFactory;\n+import teammates.ui.webapi.action.GetAuthInfoAction;\n+\n+/**\n+ * SUT: {@link ActionFactory}.\n+ */\n+public class ActionFactoryTest extends BaseTestCase {\n+\n+    @Test\n+    public void testGetAction() throws Exception {\n+        ActionFactory actionFactory = new ActionFactory();\n+\n+        ______TS(\"Action exists and is retrieved\");\n+\n+        MockHttpServletRequest existingActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + Const.ResourceURIs.AUTH);\n+        // Use this value for testing\n+        existingActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        Action existingAction = actionFactory.getAction(existingActionServletRequest, HttpGet.METHOD_NAME);\n+        assertTrue(existingAction instanceof GetAuthInfoAction);\n+\n+        ______TS(\"Action does not exist and ActionMappingException is thrown\");\n+\n+        MockHttpServletRequest nonExistentActionServletRequest = new MockHttpServletRequest(\n+                HttpGet.METHOD_NAME, Const.ResourceURIs.URI_PREFIX + \"blahblahblah\");\n+        // Use this value for testing\n+        nonExistentActionServletRequest.addHeader(\"Backdoor-Key\", \"samplekey\");\n+        assertThrows(ActionMappingException.class, () -> {\n+            actionFactory.getAction(nonExistentActionServletRequest, HttpGet.METHOD_NAME);\n+        });\n+\n+        ______TS(\"Method does not on action exist and ActionMappingException is thrown\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d6822e18f22fd2a8a91b688f9d15e191ea770c5"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "869e596aaf36b8b3d25657482ecdbabadc3e5cdf", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/869e596aaf36b8b3d25657482ecdbabadc3e5cdf", "committedDate": "2020-02-01T09:47:24Z", "message": "WIP ActionFactoryTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b808bd1a2594b321fbd4d48dee5a73da65b9a2d9", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/b808bd1a2594b321fbd4d48dee5a73da65b9a2d9", "committedDate": "2020-02-01T09:47:24Z", "message": "Add more tests for ActionFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f9512c03d38f1e8e543468d2a709581bc4f7a28", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/8f9512c03d38f1e8e543468d2a709581bc4f7a28", "committedDate": "2020-02-01T09:47:24Z", "message": "Add newline at end"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "130bb9c94d6c32b16142aacd4f3c34f6513c91ae", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/130bb9c94d6c32b16142aacd4f3c34f6513c91ae", "committedDate": "2020-02-01T09:47:24Z", "message": "Add comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c88847058c24a19b70132fc57b9672d05ecbec40", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/c88847058c24a19b70132fc57b9672d05ecbec40", "committedDate": "2020-02-01T09:47:24Z", "message": "Fix lint errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bcf326939bfc90b038d3015feea663f27962b5c1", "committedDate": "2020-02-01T09:47:24Z", "message": "Fix comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9ba88ab8c29333cc555ac70b296d8f4783e73615", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/9ba88ab8c29333cc555ac70b296d8f4783e73615", "committedDate": "2020-02-01T09:46:57Z", "message": "Fix comments"}, "afterCommit": {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1", "author": {"user": {"login": "hcwong", "name": "Joshua Wong"}}, "url": "https://github.com/TEAMMATES/teammates/commit/bcf326939bfc90b038d3015feea663f27962b5c1", "committedDate": "2020-02-01T09:47:24Z", "message": "Fix comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxODgxMDQ2", "url": "https://github.com/TEAMMATES/teammates/pull/9931#pullrequestreview-351881046", "createdAt": "2020-02-01T11:51:10Z", "commit": {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTE4OTcw", "url": "https://github.com/TEAMMATES/teammates/pull/9931#pullrequestreview-351918970", "createdAt": "2020-02-02T05:02:35Z", "commit": {"oid": "bcf326939bfc90b038d3015feea663f27962b5c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fff5bd3c4acb33a75f955bbbc42583a3068aace7", "author": {"user": {"login": "xpdavid", "name": "Xiao Pu"}}, "url": "https://github.com/TEAMMATES/teammates/commit/fff5bd3c4acb33a75f955bbbc42583a3068aace7", "committedDate": "2020-02-02T06:08:37Z", "message": "Merge branch 'master' into tests/add-action-factory-test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4423, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}