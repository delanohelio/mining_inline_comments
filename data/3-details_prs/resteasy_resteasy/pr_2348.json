{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNTQ4MTQ0", "number": 2348, "title": "[RESTEASY-2542] ignore any IOException in SSEOutputStream.close()", "bodyText": "This PR contains the change made in resteasy-core/src/main/java/org/jboss/resteasy/plugins/providers/sse/SseEventOutputImpl.java\nby FroMage in a special test branch , see PR\n#2347\n... In the PR 2347 FroMage wrote ....\nSo this bug is that we're calling SSEOutputStream.close() whose docs say \"we close and if it's already closed then it's fine, you can keep closing it forever you will not get an exception\", which is the right thing to do IMO.\nBut the implementation calls ResteasyAsynchronousResponse.complete(), which then forwards to a vertxFlush() which throws because it's already closed (by the client).\nNow, perhaps the right thing to do is to ignore any IOException in SSEOutputStream.close() but I do wonder what the behaviour of ResteasyAsynchronousResponse.complete() should be. Should it consider that complete() should throw if already closed or not?", "createdAt": "2020-04-09T17:19:05Z", "url": "https://github.com/resteasy/resteasy/pull/2348", "merged": true, "mergeCommit": {"oid": "f86e9948c1481ef62125a2f9e9b13f79f59f1a89"}, "closed": true, "closedAt": "2020-04-27T15:49:19Z", "author": {"login": "rsearls"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWOOYsAFqTM5MTM2OTQ3NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbwcK5gBqjMyNzYxNDUyOTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzY5NDc0", "url": "https://github.com/resteasy/resteasy/pull/2348#pullrequestreview-391369474", "createdAt": "2020-04-10T10:06:35Z", "commit": {"oid": "f4f3665a9c63e719e084292313ef3d3e25e2621d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMDowNjozNVrOGD2owQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMDowNjozNVrOGD2owQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY5NDA4MQ==", "bodyText": "cause.getCause() != null && cause.getCause() != cause", "url": "https://github.com/resteasy/resteasy/pull/2348#discussion_r406694081", "createdAt": "2020-04-10T10:06:35Z", "author": {"login": "asoldano"}, "path": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/providers/sse/SseEventOutputImpl.java", "diffHunk": "@@ -107,7 +107,19 @@ protected void close(boolean flushBeforeClose)\n             ResteasyAsynchronousResponse asyncResponse = asyncContext.getAsyncResponse();\n             if (asyncResponse != null)\n             {\n-               asyncResponse.complete();\n+               try {\n+                  asyncResponse.complete();\n+               } catch(RuntimeException x) {\n+                  Throwable cause = x;\n+                  while(cause.getCause() != null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4f3665a9c63e719e084292313ef3d3e25e2621d"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c17e313e149cce32b1961733083e8c90e6fc94c8", "author": {"user": {"login": "rsearls", "name": null}}, "url": "https://github.com/resteasy/resteasy/commit/c17e313e149cce32b1961733083e8c90e6fc94c8", "committedDate": "2020-04-27T14:47:31Z", "message": "[RESTEASY-2542] ignore any IOException in SSEOutputStream.close()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "551b7f127e24dd40beca0f14c54482893ee206cb", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/resteasy/resteasy/commit/551b7f127e24dd40beca0f14c54482893ee206cb", "committedDate": "2020-04-10T12:17:21Z", "message": "Suggestion by Alessio"}, "afterCommit": {"oid": "c17e313e149cce32b1961733083e8c90e6fc94c8", "author": {"user": {"login": "rsearls", "name": null}}, "url": "https://github.com/resteasy/resteasy/commit/c17e313e149cce32b1961733083e8c90e6fc94c8", "committedDate": "2020-04-27T14:47:31Z", "message": "[RESTEASY-2542] ignore any IOException in SSEOutputStream.close()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1696, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}