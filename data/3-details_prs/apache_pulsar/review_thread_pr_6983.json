{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5OTE2NTIx", "number": 6983, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMTo0OTo0MlrOD-Zz2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMTo1MTo0N1rOD-Z2JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NzYxMTc4OnYy", "diffSide": "RIGHT", "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMTo0OTo0MlrOGYfDEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMjoxNTozMFrOGYftUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMyNzY5OQ==", "bodyText": "Please use ObjectMapperFactory.getThreadLocal", "url": "https://github.com/apache/pulsar/pull/6983#discussion_r428327699", "createdAt": "2020-05-20T21:49:42Z", "author": {"login": "jerrypeng"}, "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "diffHunk": "@@ -580,4 +595,24 @@ public static SinkConfig validateUpdate(SinkConfig existingConfig, SinkConfig ne\n         }\n         return mergedConfig;\n     }\n+\n+    public static void validateConnectorConfig(SinkConfig sinkConfig, ClassLoader classLoader) {\n+        try {\n+            ConnectorDefinition defn = ConnectorUtils.getConnectorDefinition(classLoader);\n+            if (defn.getSinkConfigClass() != null) {\n+                Class configClass = Class.forName(defn.getSinkConfigClass(),  true, classLoader);\n+                ObjectMapper mapper = new ObjectMapper();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550f585fcb60571220b2f5ed6b5deb1b06b3edf4"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMzODUxMw==", "bodyText": "Changed", "url": "https://github.com/apache/pulsar/pull/6983#discussion_r428338513", "createdAt": "2020-05-20T22:15:30Z", "author": {"login": "srkukarni"}, "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "diffHunk": "@@ -580,4 +595,24 @@ public static SinkConfig validateUpdate(SinkConfig existingConfig, SinkConfig ne\n         }\n         return mergedConfig;\n     }\n+\n+    public static void validateConnectorConfig(SinkConfig sinkConfig, ClassLoader classLoader) {\n+        try {\n+            ConnectorDefinition defn = ConnectorUtils.getConnectorDefinition(classLoader);\n+            if (defn.getSinkConfigClass() != null) {\n+                Class configClass = Class.forName(defn.getSinkConfigClass(),  true, classLoader);\n+                ObjectMapper mapper = new ObjectMapper();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMyNzY5OQ=="}, "originalCommit": {"oid": "550f585fcb60571220b2f5ed6b5deb1b06b3edf4"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NzYxNzY0OnYy", "diffSide": "RIGHT", "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMTo1MTo0N1rOGYfGoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMjoxNTozMlrOGYftZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMyODYwOQ==", "bodyText": "You can achieve the same thing by using the following method\nmapper.convertValue(map, MyPojo.class);", "url": "https://github.com/apache/pulsar/pull/6983#discussion_r428328609", "createdAt": "2020-05-20T21:51:47Z", "author": {"login": "jerrypeng"}, "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "diffHunk": "@@ -580,4 +595,24 @@ public static SinkConfig validateUpdate(SinkConfig existingConfig, SinkConfig ne\n         }\n         return mergedConfig;\n     }\n+\n+    public static void validateConnectorConfig(SinkConfig sinkConfig, ClassLoader classLoader) {\n+        try {\n+            ConnectorDefinition defn = ConnectorUtils.getConnectorDefinition(classLoader);\n+            if (defn.getSinkConfigClass() != null) {\n+                Class configClass = Class.forName(defn.getSinkConfigClass(),  true, classLoader);\n+                ObjectMapper mapper = new ObjectMapper();\n+                Object configObject = mapper.readValue(new ObjectMapper().writeValueAsString(sinkConfig.getConfigs()), configClass);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550f585fcb60571220b2f5ed6b5deb1b06b3edf4"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMzODUzMw==", "bodyText": "Changed", "url": "https://github.com/apache/pulsar/pull/6983#discussion_r428338533", "createdAt": "2020-05-20T22:15:32Z", "author": {"login": "srkukarni"}, "path": "pulsar-functions/utils/src/main/java/org/apache/pulsar/functions/utils/SinkConfigUtils.java", "diffHunk": "@@ -580,4 +595,24 @@ public static SinkConfig validateUpdate(SinkConfig existingConfig, SinkConfig ne\n         }\n         return mergedConfig;\n     }\n+\n+    public static void validateConnectorConfig(SinkConfig sinkConfig, ClassLoader classLoader) {\n+        try {\n+            ConnectorDefinition defn = ConnectorUtils.getConnectorDefinition(classLoader);\n+            if (defn.getSinkConfigClass() != null) {\n+                Class configClass = Class.forName(defn.getSinkConfigClass(),  true, classLoader);\n+                ObjectMapper mapper = new ObjectMapper();\n+                Object configObject = mapper.readValue(new ObjectMapper().writeValueAsString(sinkConfig.getConfigs()), configClass);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMyODYwOQ=="}, "originalCommit": {"oid": "550f585fcb60571220b2f5ed6b5deb1b06b3edf4"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1762, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}