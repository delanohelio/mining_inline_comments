{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNDkxNTEy", "number": 8386, "title": "[Issue 6231][Build] Configure maven http connection pool setting and maven http retry setting in Github Flows", "bodyText": "Fixes #6231\nMotivation\nSee #6231 . This is a common problem in Pulsar CI running on Github Actions.\nModifications\n\nSet MAVEN_OPTS to -Dmaven.wagon.httpconnectionManager.ttlSeconds=25 -Dmaven.wagon.http.retryHandler.count=3\nin Github Flows environment.\n\nThis will set the http connection pool TTL to 25 seconds. In addition, http requests will be retried 3 times.\nhttps://issues.apache.org/jira/browse/WAGON-545 is a close match to the issue #6231 .\nIn the last comment, it says \"Azure users shall set the TTL to 240 seconds or less.\"", "createdAt": "2020-10-27T05:56:13Z", "url": "https://github.com/apache/pulsar/pull/8386", "merged": true, "mergeCommit": {"oid": "03f71d97436ec1d16edd08108cb0e93580438898"}, "closed": true, "closedAt": "2020-10-27T21:41:09Z", "author": {"login": "lhotari"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWil_LAFqTUxNzM2OTg5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWrDbhAFqTUxNzg2NjAzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MzY5ODkw", "url": "https://github.com/apache/pulsar/pull/8386#pullrequestreview-517369890", "createdAt": "2020-10-27T06:01:50Z", "commit": {"oid": "1377e6cc3495b35b436294fff858d442634d6ba8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1377e6cc3495b35b436294fff858d442634d6ba8", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/1377e6cc3495b35b436294fff858d442634d6ba8", "committedDate": "2020-10-27T05:51:25Z", "message": "Configure maven to retry downloads 3 times\n\nFixes #6231\n\n- use ${maven.projectBasedir}/.mvn/maven.config config file to configure\n  options that should be set for all mvn command executions (since Maven\n  3.3.1+)\n  - see https://maven.apache.org/configure.html#mvn-maven-config-file"}, "afterCommit": {"oid": "5781f66cc0f93d364db0d5284021f7e99eb83af3", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/5781f66cc0f93d364db0d5284021f7e99eb83af3", "committedDate": "2020-10-27T08:27:04Z", "message": "Disable maven http pool and keep alive in Github flows\n\nFixes #6231\n\nSolution from https://stackoverflow.com/a/58769870"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/3caa9cc85194d0d4226c41fdd7509d2409827d41", "committedDate": "2020-10-27T08:54:34Z", "message": "Limit maven http connection pool TTL in Github flows\n\nFixes #6231\n\nMaven's wagon-http documentation:\nhttps://maven.apache.org/wagon/wagon-providers/wagon-http/\n\nSet maven.wagon.httpconnectionManager.ttlSeconds to\n25 seconds.\nmaven.wagon.httpconnectionManager.ttlSeconds documentation in source code:\nhttps://github.com/apache/maven-wagon/blob/a7c8e3470dd968961e87a7cb9a3829d3bec77383/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/AbstractHttpClientWagon.java#L297-L305\n\nAlso add -Dmaven.wagon.http.retryHandler.count=3 which\nwill retry http calls 3 times. However this has no impact on\nretrying downloads. (documentatation: \"Any retry handler can\nonly react to exceptions when executing the request and receiving\nthe response head. It will not salvage in-flight failures of\nongoing response body streams.\")"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5781f66cc0f93d364db0d5284021f7e99eb83af3", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/5781f66cc0f93d364db0d5284021f7e99eb83af3", "committedDate": "2020-10-27T08:27:04Z", "message": "Disable maven http pool and keep alive in Github flows\n\nFixes #6231\n\nSolution from https://stackoverflow.com/a/58769870"}, "afterCommit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/3caa9cc85194d0d4226c41fdd7509d2409827d41", "committedDate": "2020-10-27T08:54:34Z", "message": "Limit maven http connection pool TTL in Github flows\n\nFixes #6231\n\nMaven's wagon-http documentation:\nhttps://maven.apache.org/wagon/wagon-providers/wagon-http/\n\nSet maven.wagon.httpconnectionManager.ttlSeconds to\n25 seconds.\nmaven.wagon.httpconnectionManager.ttlSeconds documentation in source code:\nhttps://github.com/apache/maven-wagon/blob/a7c8e3470dd968961e87a7cb9a3829d3bec77383/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/AbstractHttpClientWagon.java#L297-L305\n\nAlso add -Dmaven.wagon.http.retryHandler.count=3 which\nwill retry http calls 3 times. However this has no impact on\nretrying downloads. (documentatation: \"Any retry handler can\nonly react to exceptions when executing the request and receiving\nthe response head. It will not salvage in-flight failures of\nongoing response body streams.\")"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NTkyOTM3", "url": "https://github.com/apache/pulsar/pull/8386#pullrequestreview-517592937", "createdAt": "2020-10-27T11:19:27Z", "commit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMToxOToyN1rOHo3HQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMToxOToyN1rOHo3HQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYwODA2NA==", "bodyText": "shall we use 240 seconds as you written in your comment ?", "url": "https://github.com/apache/pulsar/pull/8386#discussion_r512608064", "createdAt": "2020-10-27T11:19:27Z", "author": {"login": "eolivelli"}, "path": ".github/workflows/ci-cpp.yaml", "diffHunk": "@@ -26,6 +26,9 @@ on:\n     branches:\n       - branch-*\n \n+env:\n+  MAVEN_OPTS: -Dmaven.wagon.httpconnectionManager.ttlSeconds=25 -Dmaven.wagon.http.retryHandler.count=3", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjE5OTQy", "url": "https://github.com/apache/pulsar/pull/8386#pullrequestreview-517619942", "createdAt": "2020-10-27T11:52:07Z", "commit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODY2MDM4", "url": "https://github.com/apache/pulsar/pull/8386#pullrequestreview-517866038", "createdAt": "2020-10-27T15:53:14Z", "commit": {"oid": "3caa9cc85194d0d4226c41fdd7509d2409827d41"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1123, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}