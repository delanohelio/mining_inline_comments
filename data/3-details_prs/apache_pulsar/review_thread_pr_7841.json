{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NTkxMzI2", "number": 7841, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMjoyMjozNVrOEbwxkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMjoyMjozNVrOEbwxkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3NTQ2MTI4OnYy", "diffSide": "RIGHT", "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractTopic.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMjoyMjozNVrOHF4Svg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwMjowOTozMFrOHGAw5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyNzIzMA==", "bodyText": "should we log an error message?", "url": "https://github.com/apache/pulsar/pull/7841#discussion_r475927230", "createdAt": "2020-08-24T22:22:35Z", "author": {"login": "sijie"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractTopic.java", "diffHunk": "@@ -140,6 +141,38 @@ protected boolean isProducersExceeded() {\n         return false;\n     }\n \n+    protected boolean isConsumersExceededOnTopic() {\n+        Policies policies;\n+        try {\n+            // Use getDataIfPresent from zk cache to make the call non-blocking and prevent deadlocks\n+            policies = brokerService.pulsar().getConfigurationCache().policiesCache()\n+                    .getDataIfPresent(AdminResource.path(POLICIES, TopicName.get(topic).getNamespace()));\n+\n+            if (policies == null) {\n+                policies = new Policies();\n+            }\n+        } catch (Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8962717c114679f2ddcc390b77c20797dc4c9af0"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA2NjAyMA==", "bodyText": "@sijie Added warning log here.", "url": "https://github.com/apache/pulsar/pull/7841#discussion_r476066020", "createdAt": "2020-08-25T02:09:30Z", "author": {"login": "massakam"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractTopic.java", "diffHunk": "@@ -140,6 +141,38 @@ protected boolean isProducersExceeded() {\n         return false;\n     }\n \n+    protected boolean isConsumersExceededOnTopic() {\n+        Policies policies;\n+        try {\n+            // Use getDataIfPresent from zk cache to make the call non-blocking and prevent deadlocks\n+            policies = brokerService.pulsar().getConfigurationCache().policiesCache()\n+                    .getDataIfPresent(AdminResource.path(POLICIES, TopicName.get(topic).getNamespace()));\n+\n+            if (policies == null) {\n+                policies = new Policies();\n+            }\n+        } catch (Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkyNzIzMA=="}, "originalCommit": {"oid": "8962717c114679f2ddcc390b77c20797dc4c9af0"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2261, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}