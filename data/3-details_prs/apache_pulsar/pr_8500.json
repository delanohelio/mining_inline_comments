{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MjkzNDA3", "number": 8500, "title": "Add cherry-pick bot for the pulsar", "bodyText": "Motivation\nWe want to make the pulsar can cherry-pick automatically. This action will make a closed PR can cherry-pick by the command /pulsarbot cherry-pick to branch-X.Y.\nWhen a PR is merged, the bot will say,\nHey. If you want to cherry-pick this pr to a target branch, please comments '/pulsarbot cherry-pick to branch-X.Y'.\nThen you can comment /pulsarbot cherry-pick to branch-X.Y, the bot will open a new PR for cherry-picking the closed PR.\nIf we open a new PR to do the cherry-pick, we can also use the CI to check the branch.", "createdAt": "2020-11-10T07:47:07Z", "url": "https://github.com/apache/pulsar/pull/8500", "merged": true, "mergeCommit": {"oid": "26dacd68cb4eaf4727c09dbcf8af15116cf7fc1f"}, "closed": true, "closedAt": "2020-11-11T06:39:43Z", "author": {"login": "zymap"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbEhXHgBqjM5Nzc0ODQyNTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbYH0RgFqTUyNzg5NzQyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "48d395576295ae0fad04b7d4bafa4f3b7de91161", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/48d395576295ae0fad04b7d4bafa4f3b7de91161", "committedDate": "2020-11-10T07:45:33Z", "message": "Add cherry-pick bot for the pulsar"}, "afterCommit": {"oid": "7c25e5e530f44969491cffb6fb40ab7f4c3075a6", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/7c25e5e530f44969491cffb6fb40ab7f4c3075a6", "committedDate": "2020-11-10T07:48:45Z", "message": "Add cherry-pick bot for the pulsar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c25e5e530f44969491cffb6fb40ab7f4c3075a6", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/7c25e5e530f44969491cffb6fb40ab7f4c3075a6", "committedDate": "2020-11-10T07:48:45Z", "message": "Add cherry-pick bot for the pulsar"}, "afterCommit": {"oid": "9420e704dc3d71647e97c53db750f5e8d0b59e13", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/9420e704dc3d71647e97c53db750f5e8d0b59e13", "committedDate": "2020-11-10T07:49:52Z", "message": "Add cherry-pick bot for the pulsar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d", "committedDate": "2020-11-10T07:51:50Z", "message": "Add cherry-pick bot for the pulsar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9420e704dc3d71647e97c53db750f5e8d0b59e13", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/9420e704dc3d71647e97c53db750f5e8d0b59e13", "committedDate": "2020-11-10T07:49:52Z", "message": "Add cherry-pick bot for the pulsar"}, "afterCommit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d", "committedDate": "2020-11-10T07:51:50Z", "message": "Add cherry-pick bot for the pulsar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2OTM1Mjg5", "url": "https://github.com/apache/pulsar/pull/8500#pullrequestreview-526935289", "createdAt": "2020-11-10T07:54:05Z", "commit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwNzo1NDowNVrOHwP_EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwNzo1NDowNVrOHwP_EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDM1NTYwMA==", "bodyText": "Just use a github user who has permission to create a branch on the apache/pulsar repo. We can consider creating a bot user to do this.", "url": "https://github.com/apache/pulsar/pull/8500#discussion_r520355600", "createdAt": "2020-11-10T07:54:05Z", "author": {"login": "zymap"}, "path": ".github/workflows/ci-pulsarbot.yaml", "diffHunk": "@@ -41,6 +41,28 @@ jobs:\n \n       - name: Execute pulsarbot command\n         id:   pulsarbot\n+        if: github.event_name == 'issue_comment' && startsWith(github.event.comment.body, '/pulsarbot')\n         env:\n           GITHUB_TOKEN: ${{ secrets.PULSARBOT_TOKEN }}\n         uses: apache/pulsar-test-infra/pulsarbot@master\n+\n+      - name: Cherry-pick prompt\n+        if: github.event_name == 'pull_request' && github.event.pull_request.merged == true\n+        uses: apache/pulsar-test-infra/cherry-pick@master\n+        env:\n+          GITHUB_TOKEN: ${{ secrets.PULSARBOT_TOKEN }}\n+        with:\n+          type: prompt-comment\n+          github_user: codelipenghui", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2OTQyMTk4", "url": "https://github.com/apache/pulsar/pull/8500#pullrequestreview-526942198", "createdAt": "2020-11-10T08:04:47Z", "commit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2OTk3Mzc2", "url": "https://github.com/apache/pulsar/pull/8500#pullrequestreview-526997376", "createdAt": "2020-11-10T09:14:58Z", "commit": {"oid": "20e5b4f1d091af0a9f0d6d67f6f90665c67fe56d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4c4f3dda800cba45984ef859bb99c02318238f3", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/e4c4f3dda800cba45984ef859bb99c02318238f3", "committedDate": "2020-11-10T11:14:46Z", "message": "Leave comment on the file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3ODk3NDI5", "url": "https://github.com/apache/pulsar/pull/8500#pullrequestreview-527897429", "createdAt": "2020-11-11T06:39:27Z", "commit": {"oid": "e4c4f3dda800cba45984ef859bb99c02318238f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1198, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}