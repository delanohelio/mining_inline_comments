{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyOTAyOTky", "number": 7240, "title": "Add tests and documentation for subscribing to non-persistent with topic pattern", "bodyText": "Fixes #7205\nMotivation\nAdd tests and documentation for subscribing to non-persistent with topic pattern\nDoes this pull request potentially affect one of the following parts:\nIf yes was chosen, please highlight the changes\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API: (no)\nThe schema: (no)\nThe default values of configurations: (no)\nThe wire protocol: (no)\nThe rest endpoints: (no)\nThe admin cli options: (no)\nAnything that affects deployment: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (no)", "createdAt": "2020-06-11T07:52:41Z", "url": "https://github.com/apache/pulsar/pull/7240", "merged": true, "mergeCommit": {"oid": "3ff532d5fe5ae44fb13f72ed780f2ffd000ba6cd"}, "closed": true, "closedAt": "2020-06-12T13:19:50Z", "author": {"login": "codelipenghui"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqJcUrgH2gAyNDMyOTAyOTkyOjJiNWVjM2ZkNDk1ZDI3ZjdkZTZiM2ExOGNkZjVhNzBjZjk4NGY3Y2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqXmUFAFqTQyOTM4NTgwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb", "author": {"user": {"login": "codelipenghui", "name": "lipenghui"}}, "url": "https://github.com/apache/pulsar/commit/2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb", "committedDate": "2020-06-11T07:50:59Z", "message": "Add tests and documentation for subscribe to non-persistent with topic pattern ."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NzEyMTg2", "url": "https://github.com/apache/pulsar/pull/7240#pullrequestreview-428712186", "createdAt": "2020-06-11T08:45:55Z", "commit": {"oid": "2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NzkzMTEy", "url": "https://github.com/apache/pulsar/pull/7240#pullrequestreview-428793112", "createdAt": "2020-06-11T10:41:09Z", "commit": {"oid": "2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxMDo0MTowOVrOGiX6Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxMDo0MjoyMVrOGiX8SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY5NjQ1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            > Note:\n          \n          \n            \n            > \n          \n          \n            \n            > By default, the `subscriptionTopicsMode` of the consumer is `PersistentOnly`. Available options are `PersistentOnly`, `NonPersistentOnly` and `AllTopics`\n          \n          \n            \n            > #### Note\n          \n          \n            \n            > \n          \n          \n            \n            > By default, the `subscriptionTopicsMode` of the consumer is `PersistentOnly`. Available options of `subscriptionTopicsMode` are `PersistentOnly`, `NonPersistentOnly`, and `AllTopics`.", "url": "https://github.com/apache/pulsar/pull/7240#discussion_r438696458", "createdAt": "2020-06-11T10:41:09Z", "author": {"login": "Anonymitaet"}, "path": "site2/docs/client-libraries-java.md", "diffHunk": "@@ -379,18 +379,35 @@ ConsumerBuilder consumerBuilder = pulsarClient.newConsumer()\n         .subscriptionName(subscription);\n \n // Subscribe to all topics in a namespace\n-Pattern allTopicsInNamespace = Pattern.compile(\"persistent://public/default/.*\");\n+Pattern allTopicsInNamespace = Pattern.compile(\"public/default/.*\");\n Consumer allTopicsConsumer = consumerBuilder\n         .topicsPattern(allTopicsInNamespace)\n         .subscribe();\n \n // Subscribe to a subsets of topics in a namespace, based on regex\n-Pattern someTopicsInNamespace = Pattern.compile(\"persistent://public/default/foo.*\");\n+Pattern someTopicsInNamespace = Pattern.compile(\"public/default/foo.*\");\n Consumer allTopicsConsumer = consumerBuilder\n         .topicsPattern(someTopicsInNamespace)\n         .subscribe();\n ```\n \n+In the above example, the consumer subscribes to the `persistent` topics that can match the topic name pattern,\n+If you want the consumer subscribes to all `persistent` and `non-persistent` topics that can match the topic pattern,\n+You need to set `subscriptionTopicsMode` to `RegexSubscriptionMode.AllTopics`.\n+\n+```java\n+Pattern pattern = Pattern.compile(\"public/default/.*\");\n+pulsarClient.newConsumer()\n+        .subscriptionName(\"my-sub\")\n+        .topicsPattern(pattern)\n+        .subscriptionTopicsMode(RegexSubscriptionMode.AllTopics)\n+        .subscribe();\n+```\n+\n+> Note:\n+> \n+> By default, the `subscriptionTopicsMode` of the consumer is `PersistentOnly`. Available options are `PersistentOnly`, `NonPersistentOnly` and `AllTopics`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY5NzAzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In the above example, the consumer subscribes to the `persistent` topics that can match the topic name pattern,\n          \n          \n            \n            If you want the consumer subscribes to all `persistent` and `non-persistent` topics that can match the topic pattern,\n          \n          \n            \n            You need to set `subscriptionTopicsMode` to `RegexSubscriptionMode.AllTopics`.\n          \n          \n            \n            In the above example, the consumer subscribes to the `persistent` topics that can match the topic name pattern. If you want the consumer subscribes to all `persistent` and `non-persistent` topics that can match the topic name pattern, set `subscriptionTopicsMode` to `RegexSubscriptionMode.AllTopics`.", "url": "https://github.com/apache/pulsar/pull/7240#discussion_r438697033", "createdAt": "2020-06-11T10:42:21Z", "author": {"login": "Anonymitaet"}, "path": "site2/docs/client-libraries-java.md", "diffHunk": "@@ -379,18 +379,35 @@ ConsumerBuilder consumerBuilder = pulsarClient.newConsumer()\n         .subscriptionName(subscription);\n \n // Subscribe to all topics in a namespace\n-Pattern allTopicsInNamespace = Pattern.compile(\"persistent://public/default/.*\");\n+Pattern allTopicsInNamespace = Pattern.compile(\"public/default/.*\");\n Consumer allTopicsConsumer = consumerBuilder\n         .topicsPattern(allTopicsInNamespace)\n         .subscribe();\n \n // Subscribe to a subsets of topics in a namespace, based on regex\n-Pattern someTopicsInNamespace = Pattern.compile(\"persistent://public/default/foo.*\");\n+Pattern someTopicsInNamespace = Pattern.compile(\"public/default/foo.*\");\n Consumer allTopicsConsumer = consumerBuilder\n         .topicsPattern(someTopicsInNamespace)\n         .subscribe();\n ```\n \n+In the above example, the consumer subscribes to the `persistent` topics that can match the topic name pattern,\n+If you want the consumer subscribes to all `persistent` and `non-persistent` topics that can match the topic pattern,\n+You need to set `subscriptionTopicsMode` to `RegexSubscriptionMode.AllTopics`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b5ec3fd495d27f7de6b3a18cdf5a70cf984f7cb"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c538623f3c255613dec8bc0c98c2cecabfd8d81", "author": {"user": {"login": "codelipenghui", "name": "lipenghui"}}, "url": "https://github.com/apache/pulsar/commit/5c538623f3c255613dec8bc0c98c2cecabfd8d81", "committedDate": "2020-06-11T13:48:05Z", "message": "Update site2/docs/client-libraries-java.md\n\nCo-authored-by: Yu Liu <50226895+Anonymitaet@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6cd1f066bcd7b41cbd54a0e9cfc4d1d2276517e", "author": {"user": {"login": "codelipenghui", "name": "lipenghui"}}, "url": "https://github.com/apache/pulsar/commit/f6cd1f066bcd7b41cbd54a0e9cfc4d1d2276517e", "committedDate": "2020-06-11T13:48:17Z", "message": "Update site2/docs/client-libraries-java.md\n\nCo-authored-by: Yu Liu <50226895+Anonymitaet@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5Mzg1ODAz", "url": "https://github.com/apache/pulsar/pull/7240#pullrequestreview-429385803", "createdAt": "2020-06-12T00:20:34Z", "commit": {"oid": "f6cd1f066bcd7b41cbd54a0e9cfc4d1d2276517e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 662, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}