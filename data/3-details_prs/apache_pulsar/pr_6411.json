{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MTIyMDQ1", "number": 6411, "title": "[functions] Allow custom resources for k8s", "bodyText": "Motivation\nCurrently for functions running in kubernetes both the request and limit for cpu and memory are specified by resources arguments. The problem is that sometimes it makes sense for the request and limit to be different values.\nModifications\nThis commit adds the ability to the BasicKubernetesCustomizer to individualy override the request and limit values for cpu and memory.\nVerifying this change\n\n Make sure that the change passes the CI checks.\n\nThis change added tests and can be verified as follows:\n\nAdded test to ensure that the values specified in the custom runtime options are passed to the containers\n\nDoes this pull request potentially affect one of the following parts:\nIf yes was chosen, please highlight the changes\n\nDependencies (does it add or upgrade a dependency): (no\nThe public API: no\nThe schema: no\nThe default values of configurations: no\nThe wire protocol: no\nThe rest endpoints: no\nThe admin cli options: yes  (Adds additional configuration options for custom runtime options)\nAnything that affects deployment: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? yes\nIf yes, how is the feature documented? In the \"functions-runtime\" doc", "createdAt": "2020-02-24T17:49:18Z", "url": "https://github.com/apache/pulsar/pull/6411", "merged": true, "mergeCommit": {"oid": "25d313f24399cc353c7b3056338df0eed77cd0e8"}, "closed": true, "closedAt": "2020-04-05T19:39:57Z", "author": {"login": "rivernate"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHhPgCgH2gAyMzc5MTIyMDQ1Ojg0MjhjMWFiZmM0YjI5NDUyN2ZjNTg0MmUwNDU2MTI5ZjAxNDhiMzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUvbI-gFqTM4Nzg1MzI5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8428c1abfc4b294527fc5842e0456129f0148b30", "author": {"user": {"login": "rivernate", "name": "Nathan Mills"}}, "url": "https://github.com/apache/pulsar/commit/8428c1abfc4b294527fc5842e0456129f0148b30", "committedDate": "2020-02-24T17:47:21Z", "message": "[functions] Allow custom resources for k8s\n\nThis commit adds additional arguments to the\nBasicKubernetesManifestCustomizer for resource requirements. Currently\nboth the request and limit for cpu and memory are specified by resources\narguments, with no way to change the limit. This commit allows both the\nlimit and request to be set independently."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNjUxODA3", "url": "https://github.com/apache/pulsar/pull/6411#pullrequestreview-363651807", "createdAt": "2020-02-24T19:43:51Z", "commit": {"oid": "8428c1abfc4b294527fc5842e0456129f0148b30"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxOTo0Mzo1MVrOFttdXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxOTo0NDoxMFrOFtteBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTAzNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String RESOURCE_CPU = \"cpu\";\n          \n          \n            \n                private static final String RESOURCE_CPU = \"cpu\";", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475037", "createdAt": "2020-02-24T19:43:51Z", "author": {"login": "sijie"}, "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8428c1abfc4b294527fc5842e0456129f0148b30"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTEzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String RESOURCE_MEMORY = \"memory\";\n          \n          \n            \n                private static final String RESOURCE_MEMORY = \"memory\";", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475130", "createdAt": "2020-02-24T19:44:01Z", "author": {"login": "sijie"}, "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";\n+    String RESOURCE_MEMORY = \"memory\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8428c1abfc4b294527fc5842e0456129f0148b30"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTIwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};\n          \n          \n            \n                private static final String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475206", "createdAt": "2020-02-24T19:44:10Z", "author": {"login": "sijie"}, "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";\n+    String RESOURCE_MEMORY = \"memory\";\n+    String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8428c1abfc4b294527fc5842e0456129f0148b30"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc", "author": {"user": {"login": "rivernate", "name": "Nathan Mills"}}, "url": "https://github.com/apache/pulsar/commit/56d4f90e3807697502a283489ed1e4b72dbc38fc", "committedDate": "2020-02-25T17:20:56Z", "message": "Make constants private static final"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzEzMjg0", "url": "https://github.com/apache/pulsar/pull/6411#pullrequestreview-364313284", "createdAt": "2020-02-25T17:22:57Z", "commit": {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODE5NTMx", "url": "https://github.com/apache/pulsar/pull/6411#pullrequestreview-366819531", "createdAt": "2020-02-29T20:52:11Z", "commit": {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDQxMTAz", "url": "https://github.com/apache/pulsar/pull/6411#pullrequestreview-386041103", "createdAt": "2020-04-02T00:42:09Z", "commit": {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3ODUzMjk1", "url": "https://github.com/apache/pulsar/pull/6411#pullrequestreview-387853295", "createdAt": "2020-04-05T19:39:45Z", "commit": {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4942, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}