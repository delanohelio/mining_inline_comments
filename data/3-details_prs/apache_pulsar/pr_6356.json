{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2Njg5NDM4", "number": 6356, "title": "Independent schema is set for each consumer generated by topic", "bodyText": "Motivation\nMaster Issue: #5454\nWhen one Consumer subscribe multi topic, setSchemaInfoPorvider() will be covered by the consumer generated by the last topic.\nModification\nclone schema for each consumer generated by topic.\nVerifying this change\nAdd the schemaTest for it.\nDoes this pull request potentially affect one of the following parts:\nIf yes was chosen, please highlight the changes\nDependencies (does it add or upgrade a dependency): (no)\nThe public API: (no)\nThe schema: (yes)\nThe default values of configurations: (no)\nThe wire protocol: (no)\nThe rest endpoints: (no)\nThe admin cli options: (no)\nAnything that affects deployment: (no)", "createdAt": "2020-02-18T15:41:39Z", "url": "https://github.com/apache/pulsar/pull/6356", "merged": true, "mergeCommit": {"oid": "8003d08e5ca325867d2e825921f18ddda8d4e1d4"}, "closed": true, "closedAt": "2020-03-06T06:28:31Z", "author": {"login": "congbobo184"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbhFNj3AH2gAyMzc2Njg5NDM4OmNkZjc3MzUzYTMwNjE1ZTc1NmQ0NWY2OTU0MTFhNTM5ZTc1MDU3ODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcK6HkQgFqTM3MDEwNTMyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cdf77353a30615e756d45f695411a539e7505780", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/cdf77353a30615e756d45f695411a539e7505780", "committedDate": "2019-10-28T07:38:46Z", "message": "no message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "145f97e6bf1b652c54bfb58f43c8bca8f7489ccf", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/145f97e6bf1b652c54bfb58f43c8bca8f7489ccf", "committedDate": "2019-10-28T07:41:11Z", "message": "Revert \"no message\"\n\nThis reverts commit cdf77353a30615e756d45f695411a539e7505780."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f27d4152f500055864e1f4cad686c702a2d61d8e", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/f27d4152f500055864e1f4cad686c702a2d61d8e", "committedDate": "2019-10-28T08:10:24Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc85737481a4bddd07226a85bf24cae904efd527", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/dc85737481a4bddd07226a85bf24cae904efd527", "committedDate": "2019-11-08T02:18:40Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65e6f83a4a1ccab376563e5030d84cd6a23e866f", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/65e6f83a4a1ccab376563e5030d84cd6a23e866f", "committedDate": "2019-11-13T10:48:56Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "260b1374d19a96fea4c8beb8dd5afce1f16446ce", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/260b1374d19a96fea4c8beb8dd5afce1f16446ce", "committedDate": "2019-11-27T06:15:28Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09e1e40db21307dcb4c9da5cc38d8e0aa07606d5", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/09e1e40db21307dcb4c9da5cc38d8e0aa07606d5", "committedDate": "2019-11-28T02:26:37Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8e1c03bed853a2cc378f14f7cd7e8a003bb8196", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/d8e1c03bed853a2cc378f14f7cd7e8a003bb8196", "committedDate": "2019-11-29T09:40:03Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "605061bf5d3d854aa28ec4ea8c26888df75c5aca", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/605061bf5d3d854aa28ec4ea8c26888df75c5aca", "committedDate": "2019-12-10T09:09:12Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b39049a556401babdb534306c9cca8079305f8b", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/3b39049a556401babdb534306c9cca8079305f8b", "committedDate": "2020-02-18T07:23:30Z", "message": "Merge remote-tracking branch 'apache/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1e24bd03249828f9709edd58e543111cf149d0", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/9c1e24bd03249828f9709edd58e543111cf149d0", "committedDate": "2020-02-18T15:26:17Z", "message": "Clone schema to different consumer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNjA2MDA0", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-360606004", "createdAt": "2020-02-18T19:20:25Z", "commit": {"oid": "9c1e24bd03249828f9709edd58e543111cf149d0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToyMDoyNlrOFrPMtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToyMTo0NlrOFrPPxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg4MjEwMQ==", "bodyText": "missing license header", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r380882101", "createdAt": "2020-02-18T19:20:26Z", "author": {"login": "sijie"}, "path": "pulsar-broker/src/test/java/org/apache/pulsar/schema/SchemaTest.java", "diffHunk": "@@ -0,0 +1,119 @@\n+\n+package org.apache.pulsar.schema;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1e24bd03249828f9709edd58e543111cf149d0"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg4Mjg4Ng==", "bodyText": "I think we need to implement the clone method for each schema implementation. So you can then just call schema.clone() to clone a schema.", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r380882886", "createdAt": "2020-02-18T19:21:46Z", "author": {"login": "sijie"}, "path": "pulsar-client/src/main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java", "diffHunk": "@@ -813,4 +817,22 @@ public TransactionBuilder newTransaction() {\n         return new TransactionBuilderImpl(this);\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    private static Schema cloneSchema(Schema schema){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1e24bd03249828f9709edd58e543111cf149d0"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f18e24898d19f8fae5649dfd611d1eec807b92d9", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/f18e24898d19f8fae5649dfd611d1eec807b92d9", "committedDate": "2020-02-19T07:23:44Z", "message": "Add the clone method for each schema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ef0e8dfedf9a117d8e3a2dc1f6fc8dfc413aa3b", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/4ef0e8dfedf9a117d8e3a2dc1f6fc8dfc413aa3b", "committedDate": "2020-02-19T07:51:57Z", "message": "Fix the clone schema method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3285b7fc733dbb6421afdfccc0ef03777bc1088", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/a3285b7fc733dbb6421afdfccc0ef03777bc1088", "committedDate": "2020-02-19T14:06:01Z", "message": "Fix single topic consumer get clone schema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c580a1ce1fb0324d15def8f28dceb77b76d9318", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/2c580a1ce1fb0324d15def8f28dceb77b76d9318", "committedDate": "2020-02-20T16:55:29Z", "message": "fix the reader get schema"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDMwMTYx", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-363030161", "createdAt": "2020-02-22T13:58:31Z", "commit": {"oid": "2c580a1ce1fb0324d15def8f28dceb77b76d9318"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMzo1ODozMVrOFtLPyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMzo1ODozMVrOFtLPyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkxNDUwNw==", "bodyText": "Looks the imports are unused.", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r382914507", "createdAt": "2020-02-22T13:58:31Z", "author": {"login": "codelipenghui"}, "path": "pulsar-client/src/main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java", "diffHunk": "@@ -70,6 +70,9 @@\n import org.apache.pulsar.client.impl.conf.ReaderConfigurationData;\n import org.apache.pulsar.client.impl.schema.AutoConsumeSchema;\n import org.apache.pulsar.client.impl.schema.AutoProduceBytesSchema;\n+import org.apache.pulsar.client.impl.schema.AvroSchema;\n+import org.apache.pulsar.client.impl.schema.KeyValueSchema;\n+import org.apache.pulsar.client.impl.schema.generic.GenericAvroSchema;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c580a1ce1fb0324d15def8f28dceb77b76d9318"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/91471ef48c19c8715a78ce62f3989cd76ae044d4", "committedDate": "2020-02-23T01:21:36Z", "message": "delete the unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNjM1ODIw", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-363635820", "createdAt": "2020-02-24T19:18:35Z", "commit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxOToxODozNVrOFtsq0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxOToxODozNVrOFtsq0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ2MjA5Nw==", "bodyText": "When you implementing cloneSchema, don't you need to copy the fields to the new instance?", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r383462097", "createdAt": "2020-02-24T19:18:35Z", "author": {"login": "sijie"}, "path": "pulsar-client/src/main/java/org/apache/pulsar/client/impl/schema/AutoConsumeSchema.java", "diffHunk": "@@ -132,6 +132,11 @@ public void configureSchemaInfo(String topicName,\n         }\n     }\n \n+    @Override\n+    public Schema<GenericRecord> cloneSchema() {\n+        return Schema.AUTO_CONSUME();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1Mjc1NzMz", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-365275733", "createdAt": "2020-02-26T22:01:04Z", "commit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjowMTowNFrOFu98UQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMjowMVrOFu-QgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc5MzY4MQ==", "bodyText": "Could you please explain why the access modifiers were switched to public?", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r384793681", "createdAt": "2020-02-26T22:01:04Z", "author": {"login": "vzhikserg"}, "path": "pulsar-broker/src/test/java/org/apache/pulsar/schema/Schemas.java", "diffHunk": "@@ -29,36 +29,36 @@\n     @NoArgsConstructor\n     @AllArgsConstructor\n     public static class PersonOne{\n-        int id;\n+        public int id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc5ODg0OA==", "bodyText": "Did you consider to use the standard Cloneable interface with the clone method?", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r384798848", "createdAt": "2020-02-26T22:12:01Z", "author": {"login": "vzhikserg"}, "path": "pulsar-client-api/src/main/java/org/apache/pulsar/client/api/Schema.java", "diffHunk": "@@ -136,6 +136,15 @@ default void configureSchemaInfo(String topic, String componentName,\n         // no-op\n     }\n \n+    /**\n+     * Clone schema.\n+     *\n+     * @return cloned schema.\n+     */\n+    default Schema<T> cloneSchema() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91471ef48c19c8715a78ce62f3989cd76ae044d4"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "266cc9e94f9521e8856067c22d0e06dd328d949c", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/266cc9e94f9521e8856067c22d0e06dd328d949c", "committedDate": "2020-03-03T15:58:11Z", "message": "Extend the Cloneable implementation and fix the AutoConsumeSchema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1da1611f2afe135fa51da166f16cf41077376767", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/1da1611f2afe135fa51da166f16cf41077376767", "committedDate": "2020-03-04T08:34:33Z", "message": "Merge remote-tracking branch 'apache/master' into fix_schemaProvider_be_covered"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjcwMzg4", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-368670388", "createdAt": "2020-03-04T10:39:14Z", "commit": {"oid": "1da1611f2afe135fa51da166f16cf41077376767"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMDozOToxNFrOFxoKBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMDozOToxNFrOFxoKBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU4MjQ3MA==", "bodyText": "The Data annotation already includes Getter and Setter", "url": "https://github.com/apache/pulsar/pull/6356#discussion_r387582470", "createdAt": "2020-03-04T10:39:14Z", "author": {"login": "vzhikserg"}, "path": "pulsar-broker/src/test/java/org/apache/pulsar/schema/Schemas.java", "diffHunk": "@@ -16,25 +16,31 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.pulsar.schema.compatibility;\n+package org.apache.pulsar.schema;\n \n import lombok.AllArgsConstructor;\n import lombok.Data;\n+import lombok.Getter;\n import lombok.NoArgsConstructor;\n+import lombok.Setter;\n import org.apache.avro.reflect.AvroDefault;\n \n public class Schemas {\n \n     @Data\n     @NoArgsConstructor\n     @AllArgsConstructor\n+    @Getter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1da1611f2afe135fa51da166f16cf41077376767"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e4192c31c8ce9cf557441e7770a39d3af539b7d", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/4e4192c31c8ce9cf557441e7770a39d3af539b7d", "committedDate": "2020-03-04T16:10:22Z", "message": "Add the kafkaSchema clone implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e97dece609a4efd9022e4e6cd4ecf28b4c27aab9", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/e97dece609a4efd9022e4e6cd4ecf28b4c27aab9", "committedDate": "2020-03-05T02:59:33Z", "message": "Merge remote-tracking branch 'apache/master' into fix_schemaProvider_be_covered"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54c6782a1617dd43a69641989584fa081f7a0118", "author": {"user": {"login": "congbobo", "name": null}}, "url": "https://github.com/apache/pulsar/commit/54c6782a1617dd43a69641989584fa081f7a0118", "committedDate": "2020-03-05T03:00:33Z", "message": "Add the jugement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMTA1MzIx", "url": "https://github.com/apache/pulsar/pull/6356#pullrequestreview-370105321", "createdAt": "2020-03-06T06:28:05Z", "commit": {"oid": "54c6782a1617dd43a69641989584fa081f7a0118"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 67, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}