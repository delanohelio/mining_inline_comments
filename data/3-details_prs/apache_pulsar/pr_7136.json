{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2Mzg4Mzg3", "number": 7136, "title": "[Doc]--Update documents for support consumer priority level in failover mode", "bodyText": "(If this PR fixes a github issue, please add Fixes #<xyz>.)\nFixes #\n(or if this PR is one task of a github issue, please add Master Issue: #<xyz> to link to the master issue.)\nMaster Issue: #\nMotivation\nExplain here the context, and why you're making that change. What is the problem you're trying to solve.\nModifications\nDescribe the modifications you've done.\nVerifying this change\n\n Make sure that the change passes the CI checks.\n\n(Please pick either of the following options)\nThis change is a trivial rework / code cleanup without any test coverage.\n(or)\nThis change is already covered by existing tests, such as (please describe tests).\n(or)\nThis change added tests and can be verified as follows:\n(example:)\n\nAdded integration tests for end-to-end deployment with large payloads (10MB)\nExtended integration test for recovery after broker failure\n\nDoes this pull request potentially affect one of the following parts:\nIf yes was chosen, please highlight the changes\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API: (yes / no)\nThe schema: (yes / no / don't know)\nThe default values of configurations: (yes / no)\nThe wire protocol: (yes / no)\nThe rest endpoints: (yes / no)\nThe admin cli options: (yes / no)\nAnything that affects deployment: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? ( no)\nIf yes, how is the feature documented? (docs)\nIf a feature is not applicable for documentation, explain why?\nIf a feature is not documented yet in this PR, please create a followup issue for adding the documentation", "createdAt": "2020-06-02T06:55:15Z", "url": "https://github.com/apache/pulsar/pull/7136", "merged": true, "mergeCommit": {"oid": "971ab0e2777900b2e8cf9d11c60e60bfd8842ffc"}, "closed": true, "closedAt": "2020-06-04T13:09:45Z", "author": {"login": "Huanli-Meng"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnPO09AH2gAyNDI2Mzg4Mzg3OjIyMDY0MDNjZWI3NGY0YTNmMjkzOTZiMDI4N2QzYmFhNTYwZWYxMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn9zaxAFqTQyNDQyMjg1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2206403ceb74f4a3f29396b0287d3baa560ef12c", "author": {"user": {"login": "Huanli-Meng", "name": "Huanli Meng"}}, "url": "https://github.com/apache/pulsar/commit/2206403ceb74f4a3f29396b0287d3baa560ef12c", "committedDate": "2020-06-02T06:53:54Z", "message": "Update Consumer priority level in failover mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzAyNTQ1", "url": "https://github.com/apache/pulsar/pull/7136#pullrequestreview-422702545", "createdAt": "2020-06-02T13:56:39Z", "commit": {"oid": "2206403ceb74f4a3f29396b0287d3baa560ef12c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NjozOVrOGdy20A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NjozOVrOGdy20A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg5NTEyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In *failover* mode, multiple consumers can attach to the same subscription. In failover mode, the broker selects the master consumer based on the priority level and the lexicographical sorting of a consumer name. If two consumers have the identical priority level, the broker selects the master consumer based on the lexicographical sorting. If these two consumers have different priority levels, the broker selects the consumer with higher priority level as the master consumer. The master consumer is initially the only one receiving messages. When the master consumer disconnects, all (non-acknowledged and subsequent) messages are delivered to the next consumer in line.\n          \n          \n            \n            In *failover* mode, multiple consumers can attach to the same subscription. In failover mode, the broker selects the master consumer based on the priority level and the lexicographical sorting of a consumer name. If two consumers have an identical priority level, the broker selects the master consumer based on the lexicographical sorting. If these two consumers have different priority levels, the broker selects the consumer with a higher priority level as the master consumer. The master consumer is initially the only one receiving messages. When the master consumer disconnects, all (non-acknowledged and subsequent) messages are delivered to the next consumer in line.", "url": "https://github.com/apache/pulsar/pull/7136#discussion_r433895120", "createdAt": "2020-06-02T13:56:39Z", "author": {"login": "Anonymitaet"}, "path": "site2/docs/concepts-messaging.md", "diffHunk": "@@ -207,11 +207,11 @@ In the diagram below, only **Consumer A-0** is allowed to consume messages.\n \n ### Failover\n \n-In *failover* mode, multiple consumers can attach to the same subscription. The consumers will be lexically sorted by the consumer's name and the first consumer will initially be the only one receiving messages. This consumer is called the *master consumer*.\n+In *failover* mode, multiple consumers can attach to the same subscription. In failover mode, the broker selects the master consumer based on the priority level and the lexicographical sorting of a consumer name. If two consumers have the identical priority level, the broker selects the master consumer based on the lexicographical sorting. If these two consumers have different priority levels, the broker selects the consumer with higher priority level as the master consumer. The master consumer is initially the only one receiving messages. When the master consumer disconnects, all (non-acknowledged and subsequent) messages are delivered to the next consumer in line.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2206403ceb74f4a3f29396b0287d3baa560ef12c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43c9c17e7a3e208b8e52b20529731b606f06724b", "author": {"user": {"login": "Huanli-Meng", "name": "Huanli Meng"}}, "url": "https://github.com/apache/pulsar/commit/43c9c17e7a3e208b8e52b20529731b606f06724b", "committedDate": "2020-06-03T06:45:54Z", "message": "Update site2/docs/concepts-messaging.md\n\nCo-authored-by: Yu Liu <50226895+Anonymitaet@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NDIyODU4", "url": "https://github.com/apache/pulsar/pull/7136#pullrequestreview-424422858", "createdAt": "2020-06-04T13:09:30Z", "commit": {"oid": "43c9c17e7a3e208b8e52b20529731b606f06724b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2749, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}