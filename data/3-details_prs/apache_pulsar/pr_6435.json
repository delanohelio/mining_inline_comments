{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMTc0NTMz", "number": 6435, "title": "Make tests more stable by using JSONAssert equals", "bodyText": "Similar to the change you already merged for AvroSchemaTest.java(#6247):\njsonSchema.getSchemaInfo().getSchema() in pulsar-client/src/test/java/org/apache/pulsar/client/impl/schema/JSONSchemaTest.java returns a JSON object. schemaJson compares with hard-coded JSON String. However, the order of entries in schemaJson is not guaranteed. Similarly, test testKeyValueSchemaInfoToString in pulsar-client/src/test/java/org/apache/pulsar/client/impl/schema/KeyValueSchemaInfoTest.java returns a JSON object. havePrimitiveType compares with hard-coded JSON String, and the order of entries in havePrimitiveType is not guaranteed.\nThis PR proposes to use JSONAssert and modify the corresponding JSON test assertions so that the test is more stable.\nMotivation\nUsing JSONAssert and modifying the corresponding JSON test assertions so that the test is more stable.\nModifications\nAdding assertJSONEqual method and replacing assertEquals with it in tests testAllowNullSchema, testNotAllowNullSchema and testKeyValueSchemaInfoToString.\nVerifying this change\n\n Make sure that the change passes the CI checks.\n\n(Please pick either of the following options)\nThis change is already covered by existing tests, such as (please describe tests).\nDoes this pull request potentially affect one of the following parts:\nIf yes was chosen, please highlight the changes\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API: (no)\nThe schema: (don't know)\nThe default values of configurations: (no)\nThe wire protocol: (no)\nThe rest endpoints: ( no)\nThe admin cli options: ( no)\nAnything that affects deployment: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)\nIf a feature is not applicable for documentation, explain why?\nIf a feature is not documented yet in this PR, please create a followup issue for adding the documentation", "createdAt": "2020-02-28T02:48:50Z", "url": "https://github.com/apache/pulsar/pull/6435", "merged": true, "mergeCommit": {"oid": "17f71d3f73fe1bcb6723c8b0718d9a6e05574146"}, "closed": true, "closedAt": "2020-03-05T01:34:42Z", "author": {"login": "testfixer"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcImYr9AH2gAyMzgxMTc0NTMzOjhkZTVkYTMxMTkyMjFlYmUzZWVkZTNhMjE3YmE3MjMwMWM3MWY2N2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJWPGGAFqTM2Njg0ODE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8de5da3119221ebe3eede3a217ba72301c71f67a", "author": {"user": {"login": "testfixer", "name": null}}, "url": "https://github.com/apache/pulsar/commit/8de5da3119221ebe3eede3a217ba72301c71f67a", "committedDate": "2020-02-28T02:20:50Z", "message": "Make tests more stable by using JSONAssert equals"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODE5NDU2", "url": "https://github.com/apache/pulsar/pull/6435#pullrequestreview-366819456", "createdAt": "2020-02-29T20:50:44Z", "commit": {"oid": "8de5da3119221ebe3eede3a217ba72301c71f67a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODQ4MTQz", "url": "https://github.com/apache/pulsar/pull/6435#pullrequestreview-366848143", "createdAt": "2020-03-01T10:05:48Z", "commit": {"oid": "8de5da3119221ebe3eede3a217ba72301c71f67a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMDowNTo0OFrOFwNVYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMDowNTo0OFrOFwNVYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA5NDQzNA==", "bodyText": "For me, it seems like overkill to create a separate method for one line", "url": "https://github.com/apache/pulsar/pull/6435#discussion_r386094434", "createdAt": "2020-03-01T10:05:48Z", "author": {"login": "vzhikserg"}, "path": "pulsar-client/src/test/java/org/apache/pulsar/client/impl/schema/JSONSchemaTest.java", "diffHunk": "@@ -44,13 +46,16 @@\n @Slf4j\n public class JSONSchemaTest {\n \n+    public static void assertJSONEqual(String s1, String s2) throws JSONException{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8de5da3119221ebe3eede3a217ba72301c71f67a"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4961, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}