{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwODE2Nzgx", "number": 6560, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNTozMTo1OFrODpj2ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNTozMTo1OFrODpj2ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0OTA1NjMwOnYy", "diffSide": "LEFT", "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNTozMTo1OFrOF4z_4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo0Nzo1MVrOF45xhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTExNjUxMw==", "bodyText": "Shouldn't this be changed into < 1 ?", "url": "https://github.com/apache/pulsar/pull/6560#discussion_r395116513", "createdAt": "2020-03-19T15:31:58Z", "author": {"login": "merlimat"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java", "diffHunk": "@@ -2162,11 +2162,6 @@ private PersistentReplicator getReplicatorReference(String replName, PersistentT\n         String path = path(PARTITIONED_TOPIC_PATH_ZNODE, topicName.getPersistenceNamingEncoding());\n         CompletableFuture<Void> result = new CompletableFuture<>();\n         pulsar().getBrokerService().fetchPartitionedTopicMetadataAsync(topicName).thenAccept(partitionMetadata -> {\n-            if (partitionMetadata.partitions <= 1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b8aeac3a63ccaf6df276457beb934a4649b3e7d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIwODkxNw==", "bodyText": "No, it means to throw exception if partitionMetadata.partitions == 0 (which is the case when topic is not partitioned), though not throwing it when partitionMetadata.partitions == 1 (as we're incorrectly doing now) or when partitionMetadata.partitions > 1 (which is already correctly handled).", "url": "https://github.com/apache/pulsar/pull/6560#discussion_r395208917", "createdAt": "2020-03-19T17:44:14Z", "author": {"login": "merlimat"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java", "diffHunk": "@@ -2162,11 +2162,6 @@ private PersistentReplicator getReplicatorReference(String replName, PersistentT\n         String path = path(PARTITIONED_TOPIC_PATH_ZNODE, topicName.getPersistenceNamingEncoding());\n         CompletableFuture<Void> result = new CompletableFuture<>();\n         pulsar().getBrokerService().fetchPartitionedTopicMetadataAsync(topicName).thenAccept(partitionMetadata -> {\n-            if (partitionMetadata.partitions <= 1) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTExNjUxMw=="}, "originalCommit": {"oid": "4b8aeac3a63ccaf6df276457beb934a4649b3e7d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMTE0Mg==", "bodyText": "will fix", "url": "https://github.com/apache/pulsar/pull/6560#discussion_r395211142", "createdAt": "2020-03-19T17:47:51Z", "author": {"login": "jerrypeng"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java", "diffHunk": "@@ -2162,11 +2162,6 @@ private PersistentReplicator getReplicatorReference(String replName, PersistentT\n         String path = path(PARTITIONED_TOPIC_PATH_ZNODE, topicName.getPersistenceNamingEncoding());\n         CompletableFuture<Void> result = new CompletableFuture<>();\n         pulsar().getBrokerService().fetchPartitionedTopicMetadataAsync(topicName).thenAccept(partitionMetadata -> {\n-            if (partitionMetadata.partitions <= 1) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTExNjUxMw=="}, "originalCommit": {"oid": "4b8aeac3a63ccaf6df276457beb934a4649b3e7d"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1947, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}