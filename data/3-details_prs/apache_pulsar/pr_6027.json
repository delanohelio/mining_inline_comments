{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMjkyNjU4", "number": 6027, "title": "[Issue 5999] Support create/update tenant with empty cluster", "bodyText": "Motivation\nFixes #5999\nModifications\nAdd the logic to handle the blank cluster name.", "createdAt": "2020-01-10T06:13:27Z", "url": "https://github.com/apache/pulsar/pull/6027", "merged": true, "mergeCommit": {"oid": "e9083f5592035b4812e086040d4a758379fdd349"}, "closed": true, "closedAt": "2020-02-16T05:37:08Z", "author": {"login": "murong00"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb44SzzgH2gAyMzYxMjkyNjU4OmY3NzcyZWNmYTJhMGI5ODZhOGI0NWZlOTg0NGNjYzY5YmY3MWNkZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcEQxqHAH2gAyMzYxMjkyNjU4OmRiZjJjNDE2MjI2ZTNhODg0MjI2ZjUzYWRkODE4ZGZmM2Q5ODNjZjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f7772ecfa2a0b986a8b45fe9844ccc69bf71cddf", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/f7772ecfa2a0b986a8b45fe9844ccc69bf71cddf", "committedDate": "2020-01-10T06:09:55Z", "message": "Support create/update tenant with empty cluster."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTIyMzM5", "url": "https://github.com/apache/pulsar/pull/6027#pullrequestreview-341522339", "createdAt": "2020-01-11T13:20:48Z", "commit": {"oid": "f7772ecfa2a0b986a8b45fe9844ccc69bf71cddf"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdadf6c9b9406e821c5545ca7fb0af0343e6b924", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/bdadf6c9b9406e821c5545ca7fb0af0343e6b924", "committedDate": "2020-01-13T04:20:06Z", "message": "treat a blank cluster as a cluster is not specified"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxODA5MDQz", "url": "https://github.com/apache/pulsar/pull/6027#pullrequestreview-341809043", "createdAt": "2020-01-13T12:27:02Z", "commit": {"oid": "bdadf6c9b9406e821c5545ca7fb0af0343e6b924"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjoyNzowM1rOFc1STQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjoyNzowM1rOFc1STQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3NzQ4NQ==", "bodyText": "Ah, I don't think this is a good fix.\nA better fix would be:\nSet<String> allowedClusters;\nSet<String> nonBlankClusters = new HashSet<String>();\nfor (String c : allowedClusters) {\n      if (!StringUtils.isBlank(c)) {\n           nonBlankClusters.add(c);\n      }\n}\n\nif (info == null || nonBlankClusters.isEmpty()) {\n   info = new TenantInfo();\n}", "url": "https://github.com/apache/pulsar/pull/6027#discussion_r365777485", "createdAt": "2020-01-13T12:27:03Z", "author": {"login": "sijie"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/TenantsBase.java", "diffHunk": "@@ -220,10 +221,19 @@ public void deleteTenant(\n         }\n     }\n \n+    private boolean isBlankCluster(Set<String> allowedClusters) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdadf6c9b9406e821c5545ca7fb0af0343e6b924"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c690b5948dc746bac93cad2b6ce26527657d4b8", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/3c690b5948dc746bac93cad2b6ce26527657d4b8", "committedDate": "2020-01-14T03:22:26Z", "message": "Improve non cluster logic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNjE3OTMy", "url": "https://github.com/apache/pulsar/pull/6027#pullrequestreview-343617932", "createdAt": "2020-01-16T00:57:19Z", "commit": {"oid": "3c690b5948dc746bac93cad2b6ce26527657d4b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwMDo1NzoyMFrOFeLH5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwMDo1NzoyMFrOFeLH5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE4Mzg0Ng==", "bodyText": "What's the purpose of this check?\nIf a caller passes a list like [\"\", \"\"] the request will fail because the empty string is not a valid cluster in allowedClusters.", "url": "https://github.com/apache/pulsar/pull/6027#discussion_r367183846", "createdAt": "2020-01-16T00:57:20Z", "author": {"login": "merlimat"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/TenantsBase.java", "diffHunk": "@@ -220,10 +222,21 @@ public void deleteTenant(\n         }\n     }\n \n+    private Set<String> getNonBlankClusters(Set<String> allowedClusters) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c690b5948dc746bac93cad2b6ce26527657d4b8"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20a8def4ec20811747b9f3405007d62c60c23ad6", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/20a8def4ec20811747b9f3405007d62c60c23ad6", "committedDate": "2020-02-11T09:59:44Z", "message": "Merge branch 'master' of https://github.com/apache/pulsar into branch-6027"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65f8e0aa4cbf9c70bd656d4312f2a634a14112d7", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/65f8e0aa4cbf9c70bd656d4312f2a634a14112d7", "committedDate": "2020-02-11T10:01:04Z", "message": "Improve the error message when clusters are empty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7af32b11d8a87fbfab8ef77bf56fbcd81732f331", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/7af32b11d8a87fbfab8ef77bf56fbcd81732f331", "committedDate": "2020-02-11T10:05:29Z", "message": "Remove unused test methond"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjM0MDc4", "url": "https://github.com/apache/pulsar/pull/6027#pullrequestreview-358634078", "createdAt": "2020-02-13T23:54:31Z", "commit": {"oid": "7af32b11d8a87fbfab8ef77bf56fbcd81732f331"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjcyNDYx", "url": "https://github.com/apache/pulsar/pull/6027#pullrequestreview-358672461", "createdAt": "2020-02-14T02:00:22Z", "commit": {"oid": "7af32b11d8a87fbfab8ef77bf56fbcd81732f331"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f531363c8777fc3a5384d2e20ce53ac1e43a854b", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/f531363c8777fc3a5384d2e20ce53ac1e43a854b", "committedDate": "2020-02-14T08:45:28Z", "message": "Fix some unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "319ebe25b1012c2f580690c6f9fe4761c8ef5506", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/319ebe25b1012c2f580690c6f9fe4761c8ef5506", "committedDate": "2020-02-14T13:48:24Z", "message": "Merge branch 'master' of https://github.com/apache/pulsar into branch-6027"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbf2c416226e3a884226f53add818dff3d983cf9", "author": {"user": {"login": "murong00", "name": "Fangbin Sun"}}, "url": "https://github.com/apache/pulsar/commit/dbf2c416226e3a884226f53add818dff3d983cf9", "committedDate": "2020-02-14T14:54:30Z", "message": "Fix a unit test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1436, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}