{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNzc2Nzcz", "number": 6705, "title": "expose managedLedgerCache, managedLedger, loadBalance metrics to prometheus", "bodyText": "Motivation\nThe managed ledger read cache monitor metric is export via /admin/broker-stats/metrics with json format, it is hard to parse, collect and display, what's more the read cache is a very import module for message consuming throughput and latency. So collect and display the read cache metrics is extremely urgent for pulsar in production.\nChanges\nI parse the json format metric to prometheus message type and export to prometheus monitor port, so those metrics can be displayed in grafana.\nPlease help check those changes, if it's ok, i will update the metric document.", "createdAt": "2020-04-10T06:26:45Z", "url": "https://github.com/apache/pulsar/pull/6705", "merged": true, "mergeCommit": {"oid": "a9ed984f4ccac656fe09f65009efa977cc4e033c"}, "closed": true, "closedAt": "2020-04-25T06:46:42Z", "author": {"login": "hangc0276"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWpp0WAFqTM5MTc4Nzg0Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaFZ1BgBqjMyNTk4NDA2MDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzg3ODQy", "url": "https://github.com/apache/pulsar/pull/6705#pullrequestreview-391787842", "createdAt": "2020-04-11T18:03:52Z", "commit": {"oid": "fb38ca10cb0af37b66f125bb0828ed53a94d08d6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxODowMzo1MlrOGEO-XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxODowMzo1MlrOGEO-XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA5MjgyOQ==", "bodyText": "@hangc0276 can we avoid wildcard import?", "url": "https://github.com/apache/pulsar/pull/6705#discussion_r407092829", "createdAt": "2020-04-11T18:03:52Z", "author": {"login": "sijie"}, "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/stats/prometheus/PrometheusMetricsGenerator.java", "diffHunk": "@@ -20,10 +20,14 @@\n \n import java.io.IOException;\n import java.io.OutputStream;\n-import java.util.Enumeration;\n+import java.util.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb38ca10cb0af37b66f125bb0828ed53a94d08d6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMDA1MTAz", "url": "https://github.com/apache/pulsar/pull/6705#pullrequestreview-392005103", "createdAt": "2020-04-13T07:42:35Z", "commit": {"oid": "fb38ca10cb0af37b66f125bb0828ed53a94d08d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f588766f96d6248a0ee9e21d13b051372b87e82", "author": {"user": {"login": "codelipenghui", "name": "lipenghui"}}, "url": "https://github.com/apache/pulsar/commit/5f588766f96d6248a0ee9e21d13b051372b87e82", "committedDate": "2020-04-14T00:16:13Z", "message": "Merge remote-tracking branch 'apache/master' into expose_metric"}, "afterCommit": {"oid": "68381c9be474c36b247d30a5a009d5dd334ef884", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/68381c9be474c36b247d30a5a009d5dd334ef884", "committedDate": "2020-04-19T04:48:18Z", "message": "update reference-metrics document"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1OTk0MTgy", "url": "https://github.com/apache/pulsar/pull/6705#pullrequestreview-395994182", "createdAt": "2020-04-19T09:07:14Z", "commit": {"oid": "68381c9be474c36b247d30a5a009d5dd334ef884"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abf10ddeeaa7d4c8aff1bf69fb14834e8b2913cb", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/abf10ddeeaa7d4c8aff1bf69fb14834e8b2913cb", "committedDate": "2020-04-22T09:58:18Z", "message": "expose managedLedgerCache, managedLedger, loadBalance metrics to prometheus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d6bee776044d1cd29be9f8de27fc2c289dcd593", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/3d6bee776044d1cd29be9f8de27fc2c289dcd593", "committedDate": "2020-04-22T09:58:18Z", "message": "delete unnecessary codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ce44ca1033202e05a223f528f41793d5a82b990", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/4ce44ca1033202e05a223f528f41793d5a82b990", "committedDate": "2020-04-22T09:58:18Z", "message": "format code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81c2a79325fc8e3f562c54ce3bc5cd751d9ae4da", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/81c2a79325fc8e3f562c54ce3bc5cd751d9ae4da", "committedDate": "2020-04-22T10:01:37Z", "message": "update reference-metrics document"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68381c9be474c36b247d30a5a009d5dd334ef884", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/68381c9be474c36b247d30a5a009d5dd334ef884", "committedDate": "2020-04-19T04:48:18Z", "message": "update reference-metrics document"}, "afterCommit": {"oid": "81c2a79325fc8e3f562c54ce3bc5cd751d9ae4da", "author": {"user": {"login": "hangc0276", "name": "Hang Chen"}}, "url": "https://github.com/apache/pulsar/commit/81c2a79325fc8e3f562c54ce3bc5cd751d9ae4da", "committedDate": "2020-04-22T10:01:37Z", "message": "update reference-metrics document"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4914, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}