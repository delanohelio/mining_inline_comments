{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMzI2NjU5", "number": 6028, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjowNzoxNlrODXIoow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjowNToyMlrODXf6cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTg1MzE1OnYy", "diffSide": "RIGHT", "path": "pulsar-io/elastic-search/src/main/java/org/apache/pulsar/io/elasticsearch/ElasticSearchConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjowNzoxNlrOFcSUTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQyMjoxMzo0OVrOFchYvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNDU1Ng==", "bodyText": "Please align the indentation level with other annotations", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365204556", "createdAt": "2020-01-10T12:07:16Z", "author": {"login": "vzhikserg"}, "path": "pulsar-io/elastic-search/src/main/java/org/apache/pulsar/io/elasticsearch/ElasticSearchConfig.java", "diffHunk": "@@ -52,6 +52,15 @@\n     )\n     private String indexName;\n \n+    @FieldDoc(\n+            required = false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94f9b32baeb84ec2df815e0fac451d1b7c92187a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ1MTQ1Mg==", "bodyText": "Fixed it, thanks!", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365451452", "createdAt": "2020-01-10T22:13:49Z", "author": {"login": "fantapsody"}, "path": "pulsar-io/elastic-search/src/main/java/org/apache/pulsar/io/elasticsearch/ElasticSearchConfig.java", "diffHunk": "@@ -52,6 +52,15 @@\n     )\n     private String indexName;\n \n+    @FieldDoc(\n+            required = false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNDU1Ng=="}, "originalCommit": {"oid": "94f9b32baeb84ec2df815e0fac451d1b7c92187a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1OTE5MTI5OnYy", "diffSide": "RIGHT", "path": "site2/docs/io-elasticsearch-sink.md", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwOTowNzo1NFrOFcwYng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjowMjo0NVrOFc0vYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5NzE4Mg==", "bodyText": "IMHO this example section should still belong to the ## Configuration part.  ### Configuration looks weird in this context.", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365697182", "createdAt": "2020-01-13T09:07:54Z", "author": {"login": "vzhikserg"}, "path": "site2/docs/io-elasticsearch-sink.md", "diffHunk": "@@ -16,21 +16,26 @@ The configuration of the ElasticSearch sink connector has the following properti\n |------|----------|----------|---------|-------------|\n | `elasticSearchUrl` | String| true |\" \" (empty string)| The URL of elastic search cluster to which the connector connects. |\n | `indexName` | String| true |\" \" (empty string)| The index name to which the connector writes messages. |\n+| `typeName` | String | false | \"_doc\" | The type name to which the connector writes messages to. <br><br> The value should be set explicitly to a valid type name other than \"_doc\" for Elasticsearch version before 6.2, and left to default otherwise. |\n | `indexNumberOfShards` | int| false |1| The number of shards of the index. |\n | `indexNumberOfReplicas` | int| false |1 | The number of replicas of the index. |\n | `username` | String| false |\" \" (empty string)| The username used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided. |\n | `password` | String| false | \" \" (empty string)|The password used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided.  |\n \n-### Example\n+## Example", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c686e19f597f3248c7094baa70e73bfc80defaca"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcwNzg1OQ==", "bodyText": "Thanks, the modification here is to follow the structure of https://raw.githubusercontent.com/apache/pulsar/master/site2/docs/io-cdc-debezium.md . @tuteng @Anonymitaet Could you give some suggestion here?", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365707859", "createdAt": "2020-01-13T09:34:37Z", "author": {"login": "fantapsody"}, "path": "site2/docs/io-elasticsearch-sink.md", "diffHunk": "@@ -16,21 +16,26 @@ The configuration of the ElasticSearch sink connector has the following properti\n |------|----------|----------|---------|-------------|\n | `elasticSearchUrl` | String| true |\" \" (empty string)| The URL of elastic search cluster to which the connector connects. |\n | `indexName` | String| true |\" \" (empty string)| The index name to which the connector writes messages. |\n+| `typeName` | String | false | \"_doc\" | The type name to which the connector writes messages to. <br><br> The value should be set explicitly to a valid type name other than \"_doc\" for Elasticsearch version before 6.2, and left to default otherwise. |\n | `indexNumberOfShards` | int| false |1| The number of shards of the index. |\n | `indexNumberOfReplicas` | int| false |1 | The number of replicas of the index. |\n | `username` | String| false |\" \" (empty string)| The username used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided. |\n | `password` | String| false | \" \" (empty string)|The password used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided.  |\n \n-### Example\n+## Example", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5NzE4Mg=="}, "originalCommit": {"oid": "c686e19f597f3248c7094baa70e73bfc80defaca"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc2ODU0Ng==", "bodyText": "OK, it is fine if you wanted to make it consistent with description of other connectors", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365768546", "createdAt": "2020-01-13T12:02:45Z", "author": {"login": "vzhikserg"}, "path": "site2/docs/io-elasticsearch-sink.md", "diffHunk": "@@ -16,21 +16,26 @@ The configuration of the ElasticSearch sink connector has the following properti\n |------|----------|----------|---------|-------------|\n | `elasticSearchUrl` | String| true |\" \" (empty string)| The URL of elastic search cluster to which the connector connects. |\n | `indexName` | String| true |\" \" (empty string)| The index name to which the connector writes messages. |\n+| `typeName` | String | false | \"_doc\" | The type name to which the connector writes messages to. <br><br> The value should be set explicitly to a valid type name other than \"_doc\" for Elasticsearch version before 6.2, and left to default otherwise. |\n | `indexNumberOfShards` | int| false |1| The number of shards of the index. |\n | `indexNumberOfReplicas` | int| false |1 | The number of replicas of the index. |\n | `username` | String| false |\" \" (empty string)| The username used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided. |\n | `password` | String| false | \" \" (empty string)|The password used by the connector to connect to the elastic search cluster. <br><br>If `username` is set, then `password` should also be provided.  |\n \n-### Example\n+## Example", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5NzE4Mg=="}, "originalCommit": {"oid": "c686e19f597f3248c7094baa70e73bfc80defaca"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1OTY2NzA0OnYy", "diffSide": "RIGHT", "path": "site2/docs/io-elasticsearch-sink.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjowNToyMlrOFc0zCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMjowNToyMlrOFc0zCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc2OTQ4Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ```bash\n          \n          \n            \n                    ```json", "url": "https://github.com/apache/pulsar/pull/6028#discussion_r365769483", "createdAt": "2020-01-13T12:05:22Z", "author": {"login": "vzhikserg"}, "path": "site2/docs/io-elasticsearch-sink.md", "diffHunk": "@@ -40,10 +45,95 @@ Before using the ElasticSearch sink connector, you need to create a configuratio\n \n     ```yaml\n     configs:\n-        elasticSearchUrl: \"http://localhost:90902\"\n-        indexName: \"myIndex\"\n+        elasticSearchUrl: \"http://localhost:9200\"\n+        indexName: \"my_index\"\n         username: \"scooby\"\n         password: \"doobie\"\n     ```\n \n+#### For Elasticsearch Before 6.2\n+\n+* JSON \n+\n+    ```json\n+    {\n+        \"elasticSearchUrl\": \"http://localhost:9200\",\n+        \"indexName\": \"my_index\",\n+        \"typeName\": \"doc\",\n+        \"username\": \"scooby\",\n+        \"password\": \"doobie\"\n+    }\n+    ```\n+\n+* YAML\n+\n+    ```yaml\n+    configs:\n+        elasticSearchUrl: \"http://localhost:9200\"\n+        indexName: \"my_index\"\n+        typeName: \"doc\"\n+        username: \"scooby\"\n+        password: \"doobie\"\n+    ```\n+\n+### Usage\n+\n+1. Start a single node Elasticsearch cluster.\n+\n+    ```bash\n+    $ docker run -p 9200:9200 -p 9300:9300 \\\n+        -e \"discovery.type=single-node\" \\\n+        docker.elastic.co/elasticsearch/elasticsearch:7.5.1\n+    ```\n+\n+2. Start a Pulsar service locally in standalone mode.\n+    ```bash\n+    $ bin/pulsar standalone\n+    ```\n+    Make sure the nar file is available at `connectors/pulsar-io-elastic-search-{{pulsar:version}}.nar`.\n+\n+3. Start the Pulsar Elasticsearch connector in local run mode using one of the following methods.\n+    * Use the **JSON** configuration as shown previously. \n+        ```bash\n+        $ bin/pulsar-admin sinks localrun \\\n+            --archive connectors/pulsar-io-elastic-search-{{pulsar:version}}.nar \\\n+            --tenant public \\\n+            --namespace default \\\n+            --name elasticsearch-test-sink \\\n+            --sink-type elastic_search \\\n+            --sink-config '{\"elasticSearchUrl\":\"http://localhost:9200\",\"indexName\": \"my_index\",\"username\": \"scooby\",\"password\": \"doobie\"}' \\\n+            --inputs elasticsearch_test\n+        ```\n+    * Use the **YAML** configuration file as shown previously.\n+    \n+        ```bash\n+        $ bin/pulsar-admin sinks localrun \\\n+            --archive connectors/pulsar-io-elastic-search-{{pulsar:version}}.nar \\\n+            --tenant public \\\n+            --namespace default \\\n+            --name elasticsearch-test-sink \\\n+            --sink-type elastic_search \\\n+            --sink-config-file elasticsearch-sink.yml \\\n+            --inputs elasticsearch_test\n+        ```\n+\n+4. Publish records to the topic.\n+\n+    ```bash\n+    $ bin/pulsar-client produce elasticsearch_test --messages \"{\\\"a\\\":1}\"\n+    ```\n \n+5. Check documents in Elasticsearch.\n+    \n+    * refresh the index\n+        ```bash\n+            $ curl -s http://localhost:9200/my_index/_refresh\n+        ``` \n+    * search documents\n+        ```bash\n+            $ curl -s http://localhost:9200/my_index/_search\n+        ```\n+        You can see the record that published earlier has been successfully written into Elasticsearch.\n+        ```bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c686e19f597f3248c7094baa70e73bfc80defaca"}, "originalPosition": 125}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2057, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}