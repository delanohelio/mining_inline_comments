{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4ODQ3MzMy", "number": 8358, "title": "[Issue 8346][Admin API] Validate retention policy", "bodyText": "Fixes #8346\nMotivation\nSee #8346, #8345\nModifications\nPrevent setting invalid retention policy where either size or time limit is set to zero while the other limit has a non-zero value.\nThe reason for this is that setting either size or time limit to zero will effectively disable the retention policy.\nIt is confusing for the end-user if it's possible to set a value for the other limit while it's ignored when the other limit has\nthe value of zero. This might lead to the incorrect assumption that the value of 0 has the meaning that the limit isn't effective.\nThe validation will provide the Admin API end user a useful error message if the validation fails.", "createdAt": "2020-10-23T09:43:15Z", "url": "https://github.com/apache/pulsar/pull/8358", "merged": true, "mergeCommit": {"oid": "db5320df3470f89f6790340e888019c4f6e12983"}, "closed": true, "closedAt": "2020-10-26T08:16:01Z", "author": {"login": "lhotari"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVYhFNAFqTUxNTc5MDUyMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVvfilAH2gAyNTA4ODQ3MzMyOmEyYTBiMTQ2ZmFhNGYxYTZmMTAxYTQ0NGU1ZjZjYzIzOGZkOGFjMTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NzkwNTIw", "url": "https://github.com/apache/pulsar/pull/8358#pullrequestreview-515790520", "createdAt": "2020-10-23T15:42:48Z", "commit": {"oid": "e6601bae5a353bbd7cecfc43f4b65905cba9cc8d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTo0Mjo0OFrOHnTZyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTo0Mjo0OFrOHnTZyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk3NDQwOQ==", "bodyText": "Is this change related? If not, I'd suggest removing this change from this pull request. Especially we can the way how we define the dependency to using grpc-bom. It should be done in a separate PR.", "url": "https://github.com/apache/pulsar/pull/8358#discussion_r510974409", "createdAt": "2020-10-23T15:42:48Z", "author": {"login": "sijie"}, "path": "pom.xml", "diffHunk": "@@ -126,7 +126,7 @@ flexible messaging model and an intuitive client API.</description>\n     <protobuf3.version>3.11.4</protobuf3.version>\n     <protoc3.version>3.11.4</protoc3.version>\n     <grpc.version>1.31.0</grpc.version>\n-    <protoc-gen-grpc-java.version>1.12.0</protoc-gen-grpc-java.version>\n+    <protoc-gen-grpc-java.version>${grpc.version}</protoc-gen-grpc-java.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6601bae5a353bbd7cecfc43f4b65905cba9cc8d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12a463a3e809a8e4253f786ee7cfc2118cbaed21", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/12a463a3e809a8e4253f786ee7cfc2118cbaed21", "committedDate": "2020-10-23T19:49:36Z", "message": "Validate retention policy in Admin API\n\nFixes #8346\n\n- prevent setting invalid retention policy where either size or time\n  limit is set to zero while the other limit has a non-zero value.\n  - the reason for this is that setting either size or time limit to\n    zero will effectively disable the retention policy.\n    - it is confusing for the end-user if it's possible to set a value\n      for the other limit while it's ignored when the other limit has\n      the value of zero"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30aa4c852368a970ffc18db7b5b1cfe743417ba8", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/30aa4c852368a970ffc18db7b5b1cfe743417ba8", "committedDate": "2020-10-23T17:47:00Z", "message": "Revert \"PLSR-1240 upgrade GRPC to 1.31 to avoid deadlock (#8351)\"\n\nThis reverts commit 647d3c22ee219e091fc29d809e8da982a25b6541."}, "afterCommit": {"oid": "12a463a3e809a8e4253f786ee7cfc2118cbaed21", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/12a463a3e809a8e4253f786ee7cfc2118cbaed21", "committedDate": "2020-10-23T19:49:36Z", "message": "Validate retention policy in Admin API\n\nFixes #8346\n\n- prevent setting invalid retention policy where either size or time\n  limit is set to zero while the other limit has a non-zero value.\n  - the reason for this is that setting either size or time limit to\n    zero will effectively disable the retention policy.\n    - it is confusing for the end-user if it's possible to set a value\n      for the other limit while it's ignored when the other limit has\n      the value of zero"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2Mjg1MzE5", "url": "https://github.com/apache/pulsar/pull/8358#pullrequestreview-516285319", "createdAt": "2020-10-24T15:21:58Z", "commit": {"oid": "12a463a3e809a8e4253f786ee7cfc2118cbaed21"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2a0b146faa4f1a6f101a444e5f6cc238fd8ac18", "author": {"user": {"login": "lhotari", "name": "Lari Hotari"}}, "url": "https://github.com/apache/pulsar/commit/a2a0b146faa4f1a6f101a444e5f6cc238fd8ac18", "committedDate": "2020-10-24T18:29:38Z", "message": "Fix invalid retention policies in tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1289, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}