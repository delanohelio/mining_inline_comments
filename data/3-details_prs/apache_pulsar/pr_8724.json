{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MTAyOTY5", "number": 8724, "title": "[WebSocket] Fix the initial sequence id error", "bodyText": "Motivation\nThe WebSocket ProducerHandler parse a wrong string so the client's query param initialSequenceId will always fail.\nModifications\n\nParse the real initialSequenceId value.\nAdd unit tests to ensure that all params from the WebSocket url can be converted to the right config.\n\nVerifying this change\n\n Make sure that the change passes the CI checks.\n\nThis change added tests and can be verified as follows:\n\nAbstractWebSocketHandlerTest#producerBuilderTest\nAbstractWebSocketHandlerTest#consumerBuilderTest", "createdAt": "2020-11-26T14:13:58Z", "url": "https://github.com/apache/pulsar/pull/8724", "merged": true, "mergeCommit": {"oid": "be39f502de0f5055c6db1b9d3688abd25d9ccc0f"}, "closed": true, "closedAt": "2020-11-30T03:42:20Z", "author": {"login": "BewareMyPower"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgTpQKAH2gAyNTI4MTAyOTY5OjIzZGM3MDU3NzMwNTU3ZDU3NGFkZjRjZjRiN2UxNzVhZWYyM2FkYzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhck0xAFqTU0MDU3NTAzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "23dc7057730557d574adf4cf4b7e175aef23adc8", "author": {"user": {"login": "BewareMyPower", "name": "Yunze Xu"}}, "url": "https://github.com/apache/pulsar/commit/23dc7057730557d574adf4cf4b7e175aef23adc8", "committedDate": "2020-11-26T14:16:04Z", "message": "Fix the initial sequence id error"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90b03ced31b781aea85f4d779c92fcff53b0c1bc", "author": {"user": {"login": "BewareMyPower", "name": "Yunze Xu"}}, "url": "https://github.com/apache/pulsar/commit/90b03ced31b781aea85f4d779c92fcff53b0c1bc", "committedDate": "2020-11-26T13:34:41Z", "message": "Fix the initial sequence id error"}, "afterCommit": {"oid": "23dc7057730557d574adf4cf4b7e175aef23adc8", "author": {"user": {"login": "BewareMyPower", "name": "Yunze Xu"}}, "url": "https://github.com/apache/pulsar/commit/23dc7057730557d574adf4cf4b7e175aef23adc8", "committedDate": "2020-11-26T14:16:04Z", "message": "Fix the initial sequence id error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NjIzMTcz", "url": "https://github.com/apache/pulsar/pull/8724#pullrequestreview-539623173", "createdAt": "2020-11-27T00:21:23Z", "commit": {"oid": "23dc7057730557d574adf4cf4b7e175aef23adc8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwMDoyMToyM1rOH6plSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwMDoyMToyM1rOH6plSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTI2MDc0NQ==", "bodyText": "Add a test for getProducerBuilder methods? We can verify the producer applied all we gave configurations.", "url": "https://github.com/apache/pulsar/pull/8724#discussion_r531260745", "createdAt": "2020-11-27T00:21:23Z", "author": {"login": "zymap"}, "path": "pulsar-websocket/src/main/java/org/apache/pulsar/websocket/ProducerHandler.java", "diffHunk": "@@ -298,7 +298,7 @@ private void updateSentMsgStats(long msgSize, long latencyUsec) {\n         }\n \n         if (queryParams.containsKey(\"initialSequenceId\")) {\n-            builder.initialSequenceId(Long.parseLong(\"initialSequenceId\"));\n+            builder.initialSequenceId(Long.parseLong(queryParams.get(\"initialSequenceId\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23dc7057730557d574adf4cf4b7e175aef23adc8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d4c604bf4f9353a72f010a21c73cbe190e3e5cd", "author": {"user": {"login": "BewareMyPower", "name": "Yunze Xu"}}, "url": "https://github.com/apache/pulsar/commit/5d4c604bf4f9353a72f010a21c73cbe190e3e5cd", "committedDate": "2020-11-27T04:47:11Z", "message": "Add test for producer builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dc07c64d70fb7ef05e2971a17510039018915a8", "author": {"user": {"login": "BewareMyPower", "name": "Yunze Xu"}}, "url": "https://github.com/apache/pulsar/commit/4dc07c64d70fb7ef05e2971a17510039018915a8", "committedDate": "2020-11-27T07:30:22Z", "message": "Add test for consumer builder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODUwODQ3", "url": "https://github.com/apache/pulsar/pull/8724#pullrequestreview-539850847", "createdAt": "2020-11-27T10:02:38Z", "commit": {"oid": "4dc07c64d70fb7ef05e2971a17510039018915a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNTc1MDMz", "url": "https://github.com/apache/pulsar/pull/8724#pullrequestreview-540575033", "createdAt": "2020-11-30T03:14:18Z", "commit": {"oid": "4dc07c64d70fb7ef05e2971a17510039018915a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 989, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}