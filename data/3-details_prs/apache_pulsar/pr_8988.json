{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxOTA2NDc2", "number": 8988, "title": "Support create and update source with package name", "bodyText": "Master Issue: #8676\nMotivation\nWe have a new package management service that can manage all\nthe source packages. We can use that in the Pulsar Source to manage\nsource packages.\nI reuse the 'packageUrl' for downloading the package from the packages\nmanagement service. So user can use the package name as the 'packageUrl'\nto download it.\nModifications\n\nSupport create and update the source with package name\nAdd test for this", "createdAt": "2020-12-17T14:34:22Z", "url": "https://github.com/apache/pulsar/pull/8988", "merged": true, "mergeCommit": {"oid": "f1dbbd11283f9700861760baad0b77f96234d1aa"}, "closed": true, "closedAt": "2020-12-30T06:20:45Z", "author": {"login": "zymap"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnEcjCgH2gAyNTQxOTA2NDc2OjQwMzMzNTkyY2M5NjI2OTI3NGIwMTkxM2U1NDRjOTk5Yzg3YTNkYmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdrJOE7AFqTU1OTg5MjA5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/40333592cc96269274b01913e544c999c87a3dbd", "committedDate": "2020-12-17T14:31:05Z", "message": "Support create and update source with package name\n---\n\nMaster Issue: #8676\n\n*Motivation*\n\nWe have a new package management service that can manage all\nthe source packages. We can use that in the Pulsar Source to manage\nsource pakcages.\n\n*Modifications*\n\n- Support create and update source with package name\n- Add test for this"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjU5NjE1", "url": "https://github.com/apache/pulsar/pull/8988#pullrequestreview-557259615", "createdAt": "2020-12-22T17:54:25Z", "commit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjYwNTk1", "url": "https://github.com/apache/pulsar/pull/8988#pullrequestreview-557260595", "createdAt": "2020-12-22T17:56:05Z", "commit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzo1NjowNVrOIKDw0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzo1NjowNVrOIKDw0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQxODMyMw==", "bodyText": "Why do we need to download the package?", "url": "https://github.com/apache/pulsar/pull/8988#discussion_r547418323", "createdAt": "2020-12-22T17:56:05Z", "author": {"login": "sijie"}, "path": "pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/rest/api/SourcesImpl.java", "diffHunk": "@@ -719,4 +728,14 @@ public SourceConfig getSourceInfo(final String tenant,\n                 worker().getWorkerConfig().getValidateConnectorConfig());\n         return SourceConfigUtils.convert(sourceConfig, sourceDetails);\n     }\n+\n+    private static boolean hasPackageTypePrefix(String destPkgUrl) {\n+        return Arrays.stream(PackageType.values()).anyMatch(type -> destPkgUrl.startsWith(type.toString()));\n+    }\n+\n+    private File downloadPackageFile(String packageName) throws IOException, PulsarAdminException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDYzMDM2", "url": "https://github.com/apache/pulsar/pull/8988#pullrequestreview-559463036", "createdAt": "2020-12-29T10:08:40Z", "commit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5ODkyMDkx", "url": "https://github.com/apache/pulsar/pull/8988#pullrequestreview-559892091", "createdAt": "2020-12-30T06:20:30Z", "commit": {"oid": "40333592cc96269274b01913e544c999c87a3dbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 793, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}