{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NzY0OTkw", "number": 8893, "title": "Add auth action for package management service", "bodyText": "Master Issue: #8676\nMotivation\nAdd auth action 'package' for package management operations.\nOnly the role who is granted the 'package' permission can do\nthe package operations.\nModifications\n\nAdd 'package' auth action and check the permissions when access the REST API\nAdd integration test for this\n\nVerify this change\n\nAdd integration test for this", "createdAt": "2020-12-10T08:47:16Z", "url": "https://github.com/apache/pulsar/pull/8893", "merged": true, "mergeCommit": {"oid": "7c5d6b1ce091df2adbadf06a1374848faf6de273"}, "closed": true, "closedAt": "2021-01-21T04:34:06Z", "author": {"login": "zymap"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkvWFRABqjQwOTM4OTU4ODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdyLKhlAFqTU3MjkzODU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59ed5cd9690dcf353a0ec247a6e0f121e4702576", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/59ed5cd9690dcf353a0ec247a6e0f121e4702576", "committedDate": "2020-12-10T04:09:39Z", "message": "Add auth action for package management service\n---\n\nMaster Issue: #8676\n\n*Motivation*\n\nAdd auth action 'package' for package management operations.\nOnly the role who is granted the 'package' permission can do\nthe package operations.\n\n*Modifications*\n\n- Add 'package' auth action and check the permissions when access the REST API\n- Add integration test for this\n\n*Verify this change*\n\n- Add integraion test for this"}, "afterCommit": {"oid": "310c877eb1986fdcfa15cf5ffca8de3214775415", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/310c877eb1986fdcfa15cf5ffca8de3214775415", "committedDate": "2020-12-10T06:03:21Z", "message": "Add integration tests for this"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0150d1c2d4fa742feacbee911dc8ba77fd4182ee", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/0150d1c2d4fa742feacbee911dc8ba77fd4182ee", "committedDate": "2020-12-14T11:52:38Z", "message": "Add auth action for package management service\n---\n\nMaster Issue: #8676\n\n*Motivation*\n\nAdd auth action 'package' for package management operations.\nOnly the role who is granted the 'package' permission can do\nthe package operations.\n\n*Modifications*\n\n- Add 'package' auth action and check the permissions when access the REST API\n- Add integration test for this\n\n*Verify this change*\n\n- Add integraion test for this"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6627693d24ba9aff120ea6a1c42da89c1945561", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/e6627693d24ba9aff120ea6a1c42da89c1945561", "committedDate": "2020-12-14T11:52:41Z", "message": "Add integration tests for this"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45cc6226f2ab2a169bd64ea5ff6f35a4a7e2082c", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/45cc6226f2ab2a169bd64ea5ff6f35a4a7e2082c", "committedDate": "2020-12-15T02:23:33Z", "message": "Fix the tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "310c877eb1986fdcfa15cf5ffca8de3214775415", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/310c877eb1986fdcfa15cf5ffca8de3214775415", "committedDate": "2020-12-10T06:03:21Z", "message": "Add integration tests for this"}, "afterCommit": {"oid": "45cc6226f2ab2a169bd64ea5ff6f35a4a7e2082c", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/45cc6226f2ab2a169bd64ea5ff6f35a4a7e2082c", "committedDate": "2020-12-15T02:23:33Z", "message": "Fix the tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e489081b66504aa234fba771f220f9f6b95ff756", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/e489081b66504aa234fba771f220f9f6b95ff756", "committedDate": "2020-12-15T09:05:50Z", "message": "Complete the future when disable the auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21737aef58c1e8e3fb5f8bb88e99dfd252a9298f", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/21737aef58c1e8e3fb5f8bb88e99dfd252a9298f", "committedDate": "2020-12-15T13:20:34Z", "message": "Remove the unused auth tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MTAzNzQ1", "url": "https://github.com/apache/pulsar/pull/8893#pullrequestreview-555103745", "createdAt": "2020-12-18T01:03:11Z", "commit": {"oid": "21737aef58c1e8e3fb5f8bb88e99dfd252a9298f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjY5OTQ2", "url": "https://github.com/apache/pulsar/pull/8893#pullrequestreview-557269946", "createdAt": "2020-12-22T18:12:33Z", "commit": {"oid": "21737aef58c1e8e3fb5f8bb88e99dfd252a9298f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODoxMjozM1rOIKENEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODoxMjozM1rOIKENEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQyNTU1NA==", "bodyText": "We need to add a method like https://github.com/apache/pulsar/pull/8893/files#diff-cea47b9766438a068de61669ccde5f4e8435941c8953edf176aa62ffddf80545R248. This is the new method of defining the permissions. Don't use the old pattern.", "url": "https://github.com/apache/pulsar/pull/8893#discussion_r547425554", "createdAt": "2020-12-22T18:12:33Z", "author": {"login": "sijie"}, "path": "pulsar-broker-common/src/main/java/org/apache/pulsar/broker/authorization/AuthorizationProvider.java", "diffHunk": "@@ -162,6 +162,24 @@\n     CompletableFuture<Boolean> allowSinkOpsAsync(NamespaceName namespaceName, String role,\n                                                  AuthenticationDataSource authenticationData);\n \n+    /**\n+     * Check the a role has the permission to do the package operations in a namespace.\n+     *\n+     * @param namespaceName\n+     *              the namespace name you want to check\n+     * @param role\n+     *              the role to check\n+     * @param authenticationData\n+     *              authentication data related to the role\n+     * @return\n+     *              a boolean value to determine whether authorized or not\n+     */\n+    default CompletableFuture<Boolean> canDoPackageOpsAsync(NamespaceName namespaceName, String role,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21737aef58c1e8e3fb5f8bb88e99dfd252a9298f"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aedc6ae60c1d288b67da85a08e06da1af5a35526", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/aedc6ae60c1d288b67da85a08e06da1af5a35526", "committedDate": "2020-12-25T09:40:47Z", "message": "Using new auth api for the package auth"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "517fd34243c74363f5804c17c747c2d5372d9dce", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/517fd34243c74363f5804c17c747c2d5372d9dce", "committedDate": "2020-12-25T09:36:46Z", "message": "Using new auth api for the package auth"}, "afterCommit": {"oid": "aedc6ae60c1d288b67da85a08e06da1af5a35526", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/aedc6ae60c1d288b67da85a08e06da1af5a35526", "committedDate": "2020-12-25T09:40:47Z", "message": "Using new auth api for the package auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef264156112f321ef5faf98e2310316a52bd4bf4", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/ef264156112f321ef5faf98e2310316a52bd4bf4", "committedDate": "2020-12-29T07:36:18Z", "message": "Merge remote-tracking branch 'apache/master' into package-management-auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6aa3b6d8bb44c8959407a3473757462e2d196f60", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/6aa3b6d8bb44c8959407a3473757462e2d196f60", "committedDate": "2020-12-29T13:58:26Z", "message": "Fix the build issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "421c3997cbb31b2f3c1ea02a79ed5d8908d2c4d4", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/421c3997cbb31b2f3c1ea02a79ed5d8908d2c4d4", "committedDate": "2021-01-04T01:33:28Z", "message": "Fix the tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c4b3359a627f8818493e616c2d7aa794047cf94", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/0c4b3359a627f8818493e616c2d7aa794047cf94", "committedDate": "2021-01-10T10:16:43Z", "message": "Fix the authorization of the packages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "078b63f3c27bc5538df85dc14f28d0cbdaef4e0f", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/078b63f3c27bc5538df85dc14f28d0cbdaef4e0f", "committedDate": "2021-01-11T08:20:00Z", "message": "Revert \"Fix the authorization of the packages\"\n\nThis reverts commit 0c4b3359a627f8818493e616c2d7aa794047cf94."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d79d7833edf1cd682a4ee9cb5a70413c5affc9ea", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/d79d7833edf1cd682a4ee9cb5a70413c5affc9ea", "committedDate": "2021-01-11T08:20:17Z", "message": "Revert \"Fix the tests\"\n\nThis reverts commit 421c3997cbb31b2f3c1ea02a79ed5d8908d2c4d4."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a7de279d3916ab29d58060a255bde733902a5c6", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/4a7de279d3916ab29d58060a255bde733902a5c6", "committedDate": "2021-01-11T08:20:27Z", "message": "Revert \"Fix the build issue\"\n\nThis reverts commit 6aa3b6d8bb44c8959407a3473757462e2d196f60."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f16d29158531865d751e033ce03b13b3b04e5d9f", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/f16d29158531865d751e033ce03b13b3b04e5d9f", "committedDate": "2021-01-11T08:21:07Z", "message": "Revert \"Using new auth api for the package auth\"\n\nThis reverts commit aedc6ae60c1d288b67da85a08e06da1af5a35526."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1f7473c9fc079e647aa97dc45c55a36a68c3735", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/f1f7473c9fc079e647aa97dc45c55a36a68c3735", "committedDate": "2021-01-18T00:50:31Z", "message": "Update the package autorization and authentication implements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78b1bfe5de741598302620db80aca7638d172680", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/78b1bfe5de741598302620db80aca7638d172680", "committedDate": "2021-01-18T05:59:03Z", "message": "Merge remote-tracking branch 'apache/master' into package-management-auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ffa28b68b26aa1e82a7ea02c307d15d2d6035a", "author": {"user": {"login": "zymap", "name": "Yong Zhang"}}, "url": "https://github.com/apache/pulsar/commit/c4ffa28b68b26aa1e82a7ea02c307d15d2d6035a", "committedDate": "2021-01-18T07:35:24Z", "message": "Fix the CI error and authorization error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyOTM4NTQ4", "url": "https://github.com/apache/pulsar/pull/8893#pullrequestreview-572938548", "createdAt": "2021-01-21T02:33:54Z", "commit": {"oid": "c4ffa28b68b26aa1e82a7ea02c307d15d2d6035a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 914, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}