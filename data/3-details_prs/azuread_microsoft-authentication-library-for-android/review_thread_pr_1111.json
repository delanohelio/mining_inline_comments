{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2Nzc2Mjcz", "number": 1111, "reviewThreads": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozMzo1MFrOEScSxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyOTozMVrOESfI3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzczMzgyOnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozMzo1MFrOG3n9dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NDozMlrOG3qv1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3OTU3Mg==", "bodyText": "nit: extra line.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460979572", "createdAt": "2020-07-27T15:33:50Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r\n+\r\n+        return signature;\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTIzNw==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461025237", "createdAt": "2020-07-27T16:44:32Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r\n+\r\n+        return signature;\r\n+\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3OTU3Mg=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzczNzM2OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNDozOVrOG3n_lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NDo0MVrOG3qwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MDExOA==", "bodyText": "nits: final parameter,- can this be a primitive?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460980118", "createdAt": "2020-07-27T15:34:39Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTMyOQ==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461025329", "createdAt": "2020-07-27T16:44:41Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MDExOA=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc2NDM1OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0MDo1M1rOG3oQHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0Njo1MFrOG3q1fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDM0OQ==", "bodyText": "I think we should be explicit here, since this is truly a \"can't happen\" case as UTF-8 has been folded into Java.  This isn't thrown for any random error encoding the string, it's thrown if the character set specified by name is not supported.  It's \"Character encoding \" + AuthenticationConstants.ENCODING_UTF8 + \" is not supported.\"  You could even use Lombok to @SneakyThrows an UnsupportedEncodingException, supposing that the upper layer can responsibly handle a \"WorldIsBrokenException\".", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460984349", "createdAt": "2020-07-27T15:40:53Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNjY4Nw==", "bodyText": "I don't expect this to happen... ;-).  Ack on suggestion for logging message.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461026687", "createdAt": "2020-07-27T16:46:50Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDM0OQ=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc2NjI3OnYy", "diffSide": "RIGHT", "path": "msal/src/main/res/layout/broker_helper.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0MToyNlrOG3oRWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0Njo1NVrOG3q1tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDY2Nw==", "bodyText": "nit: extra lines?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460984667", "createdAt": "2020-07-27T15:41:26Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/res/layout/broker_helper.xml", "diffHunk": "@@ -0,0 +1,111 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n+    xmlns:tools=\"http://schemas.android.com/tools\"\r\n+    android:layout_width=\"match_parent\"\r\n+    android:layout_height=\"match_parent\">\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNjc0Mg==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461026742", "createdAt": "2020-07-27T16:46:55Z", "author": {"login": "shoatman"}, "path": "msal/src/main/res/layout/broker_helper.xml", "diffHunk": "@@ -0,0 +1,111 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n+    xmlns:tools=\"http://schemas.android.com/tools\"\r\n+    android:layout_width=\"match_parent\"\r\n+    android:layout_height=\"match_parent\">\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDY2Nw=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc3MDk4OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0MjozN1rOG3oUWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0MjozN1rOG3oUWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NTQzNQ==", "bodyText": "nit: extra lines", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460985435", "createdAt": "2020-07-27T15:42:37Z", "author": {"login": "AdamBJohnsonx"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "diffHunk": "@@ -118,6 +122,8 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mPopSection = view.findViewById(R.id.pop_section);\n         mLoginHintSection = view.findViewById(R.id.login_hint_section);\n \n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc4NjE4OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0NjoxNFrOG3odvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NzowMFrOG3q15w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NzgzNg==", "bodyText": "nit: extra lines?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460987836", "createdAt": "2020-07-27T15:46:14Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNjc5MQ==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461026791", "createdAt": "2020-07-27T16:47:00Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NzgzNg=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgwMTkyOnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0OTo1NlrOG3oncA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NzoxMlrOG3q2VA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MDMyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\n          \n          \n            \n                String mManifestTemplate = \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460990320", "createdAt": "2020-07-27T15:49:56Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNjkwMA==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461026900", "createdAt": "2020-07-27T16:47:12Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MDMyMA=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgxODg5OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0OVrOG3ox2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NDoxOFrOG3qvSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5Mjk4NQ==", "bodyText": "Needs javadoc.....Also should we rename this to something like showExpectedMsalRedirectUriInfo (to indicate that the redirect uri displayed here isn't the one they have already registered (in case they have) but rather the one that we actually expect)?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460992985", "createdAt": "2020-07-27T15:53:49Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1213,6 +1214,10 @@ public static String getSdkVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n+    public static void showMsalRedirectUriInfo(Activity activity){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTA5OA==", "bodyText": "I like that suggestion.  Thanks", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461025098", "createdAt": "2020-07-27T16:44:18Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1213,6 +1214,10 @@ public static String getSdkVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n+    public static void showMsalRedirectUriInfo(Activity activity){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5Mjk4NQ=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgyMzUyOnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NDo1MlrOG3o0sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NDoyN1rOG3qvqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MzcxNQ==", "bodyText": "Could add some javadoc here", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460993715", "createdAt": "2020-07-27T15:54:52Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTE5NA==", "bodyText": "ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461025194", "createdAt": "2020-07-27T16:44:27Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MzcxNQ=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgyODI2OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NTo1OFrOG3o3lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0NzozMFrOG3q3Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NDQ1Mw==", "bodyText": "Could be private", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460994453", "createdAt": "2020-07-27T15:55:58Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTczMA==", "bodyText": "... and final.  and a constant?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460995730", "createdAt": "2020-07-27T15:57:45Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NDQ1Mw=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNzA4Mw==", "bodyText": "ack, ack", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461027083", "createdAt": "2020-07-27T16:47:30Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NDQ1Mw=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgzNTI1OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NzozNVrOG3o8Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyMDo0N1rOG3sGdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTYyMg==", "bodyText": "Do we also want to display an error on the BrokerHelperActivity when this happens? Looks like an empty string will be shown", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460995622", "createdAt": "2020-07-27T15:57:35Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNzUxMw==", "bodyText": "Hadn't considered that since I don't expect this to happen... wondering in this case if I should convert this to a runtime exception.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461027513", "createdAt": "2020-07-27T16:48:17Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTYyMg=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAzODQ4NA==", "bodyText": "If you sneaky it out it'll land in the same place. ;-)", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461038484", "createdAt": "2020-07-27T17:05:12Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTYyMg=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NzQxMg==", "bodyText": "I chose to convert checked exception to runtime in this case.  So I'll log and then throw a runtime exception.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461047412", "createdAt": "2020-07-27T17:20:47Z", "author": {"login": "shoatman"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTYyMg=="}, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3ODE5MDA3OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyNjo1NlrOG3sVIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyNjo1NlrOG3sVIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MTE3MA==", "bodyText": "may be shows instead of includes?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461051170", "createdAt": "2020-07-27T17:26:56Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1213,6 +1214,14 @@ public static String getSdkVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n+    /**\n+     * Presents an activity that includes the package name, signature, redirect URI and manifest entry required for your application", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3ODE5OTk2OnYy", "diffSide": "RIGHT", "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyOTozMVrOG3sbMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyOTozMVrOG3sbMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MjcyMg==", "bodyText": "should we not attach the causing exception?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461052722", "createdAt": "2020-07-27T17:29:31Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+/**\r\n+ * Activity to show the expected redirect URL (which includes support for Broker)\r\n+ */\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    private final String MANIFEST_TEMPLATE = \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+        return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(MANIFEST_TEMPLATE, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+    }\r\n+\r\n+    private String getSignature(final boolean urlEncode) {\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if (urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            } else {\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Character encoding \" + AuthenticationConstants.ENCODING_UTF8 + \" is not supported.\", e);\r\n+            throw new RuntimeException(\"Unexpected: Unable to get the signature for this application package.\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "originalPosition": 76}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1798, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}