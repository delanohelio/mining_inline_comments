{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMDQ5NTI0", "number": 1227, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozNDozNFrOE7wVvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQyMzo0MDoyNVrOE9x_0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDkzNDM3OnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozNDozNFrOH3k7Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDozNzozNFrOH4QOfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODY5OQ==", "bodyText": "will need to uninstall prior to install", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528038699", "createdAt": "2020-11-21T00:34:34Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODc0ODE1Ng==", "bodyText": "added azureSampleapp.uninstall();", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528748156", "createdAt": "2020-11-23T14:37:34Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODY5OQ=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 111}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDkzNTk2OnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozNTozMlrOH3k7_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxMjozMzo0NlrOH8qlSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODkxMA==", "bodyText": "You don't need to launch and handle first run just to clear storage....you can just call clear directly.....and you already handle launch first run below so you don't need to do it twice", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528038910", "createdAt": "2020-11-21T00:35:32Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODc0NzkzOA==", "bodyText": "whenever I cleared the history and launched the chrome app it is opening from accepting terms and conditions that's why I added chrome.handleFirstRun() method.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528747938", "createdAt": "2020-11-23T14:37:17Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODkxMA=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTI1MzM3OA==", "bodyText": "As discussed the other day....doing the launch and handle first run should not be needed prior to doing the clear", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r531253378", "createdAt": "2020-11-26T23:33:49Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODkxMA=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzM3NDI4Mg==", "bodyText": "done.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r533374282", "createdAt": "2020-12-01T12:33:46Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzODkxMA=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 119}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDkzNjY5OnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozNjoxMFrOH3k8ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNTo1NToyNlrOH5kMzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTAxMg==", "bodyText": "navigateTo is not working....I see this method is TODO....do you have separate PR in common to implement this? Can you link these PRs?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528039012", "createdAt": "2020-11-21T00:36:10Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 125}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODc0Njc5Mw==", "bodyText": "i added new function named navigateTo(string url);", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528746793", "createdAt": "2020-11-23T14:35:44Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTAxMg=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 125}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEyMzk4Mw==", "bodyText": "I have implemented the NavigatTo function in Browser Chrome and the link was provided in the description.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r530123983", "createdAt": "2020-11-25T05:55:26Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTAxMg=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 125}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDkzNzg1OnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozNzowMVrOH3k9AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDozMjo1NFrOH4QBbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTE2OQ==", "bodyText": "Let's use specific names like nextButton\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    UiObject button = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");\n          \n          \n            \n                    UiObject nextButton = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528039169", "createdAt": "2020-11-21T00:37:01Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");\n+        UiAutomatorUtils.handleInput(\"i0116\", username);\n+        UiObject button = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 127}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODc0NDgxMg==", "bodyText": "changed button to nextButton", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528744812", "createdAt": "2020-11-23T14:32:54Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");\n+        UiAutomatorUtils.handleInput(\"i0116\", username);\n+        UiObject button = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTE2OQ=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 127}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDkzOTMwOnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQwMDozODowMlrOH3k90Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNDozNDowNFrOH4QERQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTM3Nw==", "bodyText": "This name is confusing....it saves account but the text on it seems to be No? Let's use more appropriate variable names", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528039377", "createdAt": "2020-11-21T00:38:02Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");\n+        UiAutomatorUtils.handleInput(\"i0116\", username);\n+        UiObject button = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");\n+        button.click();\n+        UiAutomatorUtils.handleInput(\"i0118\", password);\n+        UiAutomatorUtils.handleButtonClick(\"idSIButton9\");\n+        final UiObject saveAccount = UiAutomatorUtils.obtainUiObjectWithText(\"No\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODc0NTU0MQ==", "bodyText": "I change to noButton. I hope it is an appropriate name.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r528745541", "createdAt": "2020-11-23T14:34:04Z", "author": {"login": "kkrishnareddy"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,179 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {\n+        // pca should be in MULTIPLE account mode starting out\n+        Assert.assertTrue(mApplication instanceof MultipleAccountPublicClientApplication);\n+\n+        //we should NOT be in shared device mode\n+        Assert.assertFalse(mApplication.isSharedDevice());\n+\n+        // perform shared device registration\n+        mBroker.performSharedDeviceRegistration(\n+                mLoginHint, LabConfig.getCurrentLabConfig().getLabUserPassword()\n+        );\n+\n+        // re-create PCA after device registration\n+        mApplication = PublicClientApplication.create(mContext, getConfigFileResourceId());\n+\n+        // pca should now be in SINGLE account mode\n+        Assert.assertTrue(mApplication instanceof SingleAccountPublicClientApplication);\n+\n+        // we should be in shared device mode\n+        Assert.assertTrue(mApplication.isSharedDevice());\n+\n+        //creating a basic temp user account\n+        final String newUser = LabConstants.TempUserType.BASIC;\n+        final String username = LabUserHelper.loadTempUser(newUser);\n+        String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(30));\n+\n+\n+        final SingleAccountPublicClientApplication singleAccountPCA =\n+                (SingleAccountPublicClientApplication) mApplication;\n+\n+        final CountDownLatch latch = new CountDownLatch(1);\n+\n+        // try sign in with an account from the same tenant\n+        singleAccountPCA.signIn(mActivity, username, mScopes, successfulInteractiveCallback(latch));\n+\n+        final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                .loginHint(username)\n+                .sessionExpected(false)\n+                .consentPageExpected(false)\n+                .broker(mBroker)\n+                .prompt(PromptParameter.SELECT_ACCOUNT)\n+                .expectingBrokerAccountChooserActivity(false)\n+                .build();\n+\n+        AadPromptHandler aadPromptHandler = new AadPromptHandler(promptHandlerParameters);\n+        aadPromptHandler.handlePrompt(username, password);\n+\n+        latch.await();\n+\n+        //launching azure sample app and confirming user signed in or not.\n+        final AzureSampleApp azureSampleApp = new AzureSampleApp();\n+        azureSampleApp.install();\n+        azureSampleApp.launch();\n+        Thread.sleep(TimeUnit.SECONDS.toMillis(5));\n+        azureSampleApp.confirmSignedIn(username);\n+\n+        //signing in chrome browser.\n+        IBrowser chrome = new BrowserChrome();\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.clear();\n+\n+        //relaunching chrome after clearing history of chrome.\n+        chrome.launch();\n+        chrome.handleFirstRun();\n+        chrome.navigateTo(\"https://myapps.microsoft.com\");\n+        UiAutomatorUtils.handleInput(\"i0116\", username);\n+        UiObject button = UiAutomatorUtils.obtainUiObjectWithText(\"Next\");\n+        button.click();\n+        UiAutomatorUtils.handleInput(\"i0118\", password);\n+        UiAutomatorUtils.handleButtonClick(\"idSIButton9\");\n+        final UiObject saveAccount = UiAutomatorUtils.obtainUiObjectWithText(\"No\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTM3Nw=="}, "originalCommit": {"oid": "c58bfa23f56376e16598c7a93ddf9ed89dc34200"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMjE3NzQ0OnYy", "diffSide": "RIGHT", "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQyMzo0MDoyNVrOH6pMiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQyMzo0MDoyNVrOH6pMiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTI1NDQwOA==", "bodyText": "Can we avoid throwing the MsalException and UiObjectNotFoundException directly from the test? and rather just handle them within the test and throw it from the test by wrapping it into an AssertionError", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1227#discussion_r531254408", "createdAt": "2020-11-26T23:40:25Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase833515.java", "diffHunk": "@@ -0,0 +1,184 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import androidx.test.platform.app.InstrumentationRegistry;\n+import androidx.test.uiautomator.UiDevice;\n+import androidx.test.uiautomator.UiObject;\n+import androidx.test.uiautomator.UiObjectNotFoundException;\n+\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.ui.automation.annotations.SupportedBrokers;\n+import com.microsoft.identity.client.ui.automation.app.AzureSampleApp;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerHost;\n+import com.microsoft.identity.client.ui.automation.broker.BrokerMicrosoftAuthenticator;\n+import com.microsoft.identity.client.ui.automation.browser.BrowserChrome;\n+import com.microsoft.identity.client.ui.automation.browser.IBrowser;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.client.ui.automation.utils.UiAutomatorUtils;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserHelper;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+// End My Shift - In Shared device mode, global sign out should work.\n+// https://identitydivision.visualstudio.com/DevEx/_workitems/edit/833515\n+@SupportedBrokers(brokers = {BrokerMicrosoftAuthenticator.class, BrokerHost.class})\n+public class TestCase833515 extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_833515() throws MsalException, InterruptedException, UiObjectNotFoundException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "551795a605b301f8cbbf24f80affb226923f24a2"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1867, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}