{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4Nzc3NzEx", "number": 944, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzowOTo1N1rODiaBlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMzo0OTozNVrODihMTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NDA0NTY2OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/ResultFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzowOTo1N1rOFtoqLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzowOTo1N1rOFtoqLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NjM5Nw==", "bodyText": "This is great \ud83d\udc4d", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383396397", "createdAt": "2020-02-24T17:09:57Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/ResultFragment.java", "diffHunk": "@@ -69,6 +74,18 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mTextView.setMovementMethod(new ScrollingMovementMethod());\n \n         previousAccessToken = accessToken;\n+\n+        mCopyAuthResultButton = (Button) view.findViewById(R.id.btn_copyAuthResult);\n+        mCopyAuthResultButton.setOnClickListener(new View.OnClickListener() {\n+            @Override\n+            public void onClick(View v) {\n+                ClipboardManager clipboard = (ClipboardManager)\n+                        getActivity().getSystemService(Context.CLIPBOARD_SERVICE);\n+                ClipData clip = ClipData.newPlainText(\"Auth Result\", mTextView.getText());\n+                clipboard.setPrimaryClip(clip);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NDA0NzE5OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/RequestOptions.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMDoyNVrOFtorGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMDoyNVrOFtorGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NjYzNQ==", "bodyText": "Copyright", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383396635", "createdAt": "2020-02-24T17:10:25Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/RequestOptions.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package com.microsoft.identity.client.testapp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NDA1MDc5OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MultipleAccountModeWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMToxOFrOFtotKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMToxOFrOFtotKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NzE2MA==", "bodyText": "Copyright here and everywhere else", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383397160", "createdAt": "2020-02-24T17:11:18Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MultipleAccountModeWrapper.java", "diffHunk": "@@ -0,0 +1,85 @@\n+package com.microsoft.identity.client.testapp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NDA4MDA1OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxOTo0NlrOFto_Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxOTo0NlrOFto_Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwMTc5MQ==", "bodyText": "nit : trim to \"default: account's authority\"", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383401791", "createdAt": "2020-02-24T17:19:46Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "diffHunk": "@@ -90,103 +99,128 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mAcquireTokenSilent = view.findViewById(R.id.btn_acquiretokensilent);\n         mAcquireTokenWithResource = view.findViewById(R.id.btn_acquiretokenWithResource);\n         mAcquireTokenSilentWithResource = view.findViewById(R.id.btn_acquiretokensilentWithResource);\n-        mAADEnvironments = view.findViewById(R.id.environment);\n+        mConfigFileSpinner = view.findViewById(R.id.configFile);\n+        mAuthScheme = view.findViewById(R.id.authentication_scheme);\n         mPublicApplicationMode = view.findViewById(R.id.public_application_mode);\n+        mDefaultBrowser = view.findViewById(R.id.default_browser);\n \n-        bindSpinnerChoice(mPrompt, Prompt.class);\n-        bindSpinnerChoice(mUserAgent, Constants.UserAgent.class);\n-        bindSpinnerChoice(mAADEnvironments, Constants.AzureActiveDirectoryEnvironment.class);\n+        bindSelectAccountSpinner(mSelectAccount, null);\n+        mSelectAccount.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {\n+            @Override\n+            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {\n+                // If an account is selected.\n+                //  - Gray out mLoginhint.\n+                //  - Set hint in mAuthority.\n+                if (position == mLoadedAccounts.size()) {\n+                    // If an account is selected, grey out this option.\n+                    mLoginhint.setHint(\"\");\n+                    mLoginhint.setCursorVisible(true);\n+                    mLoginhint.setEnabled(true);\n+\n+                    mAuthority.setHint(\"\");\n+                } else {\n+                    mLoginhint.setText(\"\");\n+                    mLoginhint.setHint(\"Disabled\");\n+                    mLoginhint.setCursorVisible(false);\n+                    mLoginhint.setEnabled(false);\n+\n+                    mAuthority.setHint(\"For ATS: Selected account's authority will be used if nothing is provided here\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NTIxOTk2OnYy", "diffSide": "RIGHT", "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MsalWrapper.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMzo0OTozNVrOFtz_6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMTowMDowOFrOFuVAGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzU4MjE4NA==", "bodyText": "Can we add another Spinner and EditText to accept the HttpMethod and Resource URL? These could optionally be shown only when the Auth Scheme Spinner indicates PoP", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383582184", "createdAt": "2020-02-24T23:49:35Z", "author": {"login": "iambmelt"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MsalWrapper.java", "diffHunk": "@@ -166,9 +85,13 @@ public void acquireToken(final Activity activity,\n                                         .split(\" \")\n                         )\n                 )\n-                .withCallback(getAuthenticationCallback(notifyCallback));\n+                .withCallback(getAuthenticationCallback(callback));\n \n-        if (USE_POP) {\n+        if (requestOptions.getAuthority() != null && !requestOptions.getAuthority().isEmpty()) {\n+            builder.fromAuthority(requestOptions.getAuthority());\n+        }\n+\n+        if (requestOptions.getAuthScheme() == Constants.AuthScheme.POP) {\n             try {\n                 builder.withAuthenticationScheme(\n                         PoPAuthenticationScheme.builder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998"}, "originalPosition": 184}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDEyMjkwNA==", "bodyText": "sure np", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r384122904", "createdAt": "2020-02-25T21:00:08Z", "author": {"login": "rpdome"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MsalWrapper.java", "diffHunk": "@@ -166,9 +85,13 @@ public void acquireToken(final Activity activity,\n                                         .split(\" \")\n                         )\n                 )\n-                .withCallback(getAuthenticationCallback(notifyCallback));\n+                .withCallback(getAuthenticationCallback(callback));\n \n-        if (USE_POP) {\n+        if (requestOptions.getAuthority() != null && !requestOptions.getAuthority().isEmpty()) {\n+            builder.fromAuthority(requestOptions.getAuthority());\n+        }\n+\n+        if (requestOptions.getAuthScheme() == Constants.AuthScheme.POP) {\n             try {\n                 builder.withAuthenticationScheme(\n                         PoPAuthenticationScheme.builder()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzU4MjE4NA=="}, "originalCommit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998"}, "originalPosition": 184}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1896, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}