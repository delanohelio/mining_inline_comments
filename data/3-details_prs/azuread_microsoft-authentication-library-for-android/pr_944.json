{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4Nzc3NzEx", "number": 944, "title": "Update test app", "bodyText": "UI Changes\n\nReplace \"Environment\" and \"User Agent\" with a picker that allows you to set a \"config file\".\nAdd configs for sovereign clouds.\n\nI've created new app registrations in each cloud with the IDLAB account for temporary use. Will need your help here to get the actual ones @shahzaibj.\n\n\nAdd \"Auth Scheme\" spinner.\nAdd \"Authority\" text field.\nIn the \"Account\" section.\n\nAdd \"-- No Account Selected --\" as the last option in the list.\nIf an account is selected\n\nthe login_hint text field will be grayed out.\nthe authority text field will display a hint that if this value is not provided, the account's authority will be used.\n\n\n\n\nAdd buttons for copying logs & acquireTokenResult to clipboard.\n\nOther Fixes\n\nClean up the codes.\n\nMove unnecessary code in MainActivity back to AcquireTokenFragment.\nMsalWrapper now only init and load accounts only when necessary.\nExtract Single Account and Multiple Account logic out.\n\n\nFix crashes that could happen during navigation.\nFix the issue where default browser is not displayed.", "createdAt": "2020-02-24T01:21:09Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944", "merged": true, "mergeCommit": {"oid": "194a5f72a2344f4298e936af51388e32db836d2d"}, "closed": true, "closedAt": "2020-02-26T01:14:16Z", "author": {"login": "rpdome"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGqQC7AH2gAyMzc4Nzc3NzExOjQ4YjFmNDI3NjM5NmZiZmZmOWVlNDQxYTRiOTIyNDdiYzFlYmUzZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcH68sCAFqTM2NDUzMTQ1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "48b1f4276396fbfff9ee441a4b92247bc1ebe3f7", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/48b1f4276396fbfff9ee441a4b92247bc1ebe3f7", "committedDate": "2020-02-22T01:43:10Z", "message": "WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c125afa94c1521c8c9b576c30ba6f03644799bb", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/3c125afa94c1521c8c9b576c30ba6f03644799bb", "committedDate": "2020-02-22T06:53:18Z", "message": "WIP - need to register app in each cloud"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4d5150c1d3a0b168268c77790cf958428d0d90e", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/c4d5150c1d3a0b168268c77790cf958428d0d90e", "committedDate": "2020-02-22T07:58:11Z", "message": "Add app registration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f37a276239317c7fa383af814ae22a1003d074b", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/2f37a276239317c7fa383af814ae22a1003d074b", "committedDate": "2020-02-22T08:48:14Z", "message": "Add copy button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "391c76390aee7aee36d255cba885594367454f98", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/391c76390aee7aee36d255cba885594367454f98", "committedDate": "2020-02-24T01:07:39Z", "message": "Add clarity on UI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTU1NTAy", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-363555502", "createdAt": "2020-02-24T17:09:57Z", "commit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzowOTo1N1rOFtoqLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzowOTo1N1rOFtoqLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NjM5Nw==", "bodyText": "This is great \ud83d\udc4d", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383396397", "createdAt": "2020-02-24T17:09:57Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/ResultFragment.java", "diffHunk": "@@ -69,6 +74,18 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mTextView.setMovementMethod(new ScrollingMovementMethod());\n \n         previousAccessToken = accessToken;\n+\n+        mCopyAuthResultButton = (Button) view.findViewById(R.id.btn_copyAuthResult);\n+        mCopyAuthResultButton.setOnClickListener(new View.OnClickListener() {\n+            @Override\n+            public void onClick(View v) {\n+                ClipboardManager clipboard = (ClipboardManager)\n+                        getActivity().getSystemService(Context.CLIPBOARD_SERVICE);\n+                ClipData clip = ClipData.newPlainText(\"Auth Result\", mTextView.getText());\n+                clipboard.setPrimaryClip(clip);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTU1ODQ3", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-363555847", "createdAt": "2020-02-24T17:10:25Z", "commit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMDoyNVrOFtorGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMDoyNVrOFtorGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NjYzNQ==", "bodyText": "Copyright", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383396635", "createdAt": "2020-02-24T17:10:25Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/RequestOptions.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package com.microsoft.identity.client.testapp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTU2NDM0", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-363556434", "createdAt": "2020-02-24T17:11:18Z", "commit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMToxOFrOFtotKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxMToxOFrOFtotKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM5NzE2MA==", "bodyText": "Copyright here and everywhere else", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383397160", "createdAt": "2020-02-24T17:11:18Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MultipleAccountModeWrapper.java", "diffHunk": "@@ -0,0 +1,85 @@\n+package com.microsoft.identity.client.testapp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTYyMDg4", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-363562088", "createdAt": "2020-02-24T17:19:46Z", "commit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxOTo0NlrOFto_Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNzoxOTo0NlrOFto_Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQwMTc5MQ==", "bodyText": "nit : trim to \"default: account's authority\"", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383401791", "createdAt": "2020-02-24T17:19:46Z", "author": {"login": "kreedula"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "diffHunk": "@@ -90,103 +99,128 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mAcquireTokenSilent = view.findViewById(R.id.btn_acquiretokensilent);\n         mAcquireTokenWithResource = view.findViewById(R.id.btn_acquiretokenWithResource);\n         mAcquireTokenSilentWithResource = view.findViewById(R.id.btn_acquiretokensilentWithResource);\n-        mAADEnvironments = view.findViewById(R.id.environment);\n+        mConfigFileSpinner = view.findViewById(R.id.configFile);\n+        mAuthScheme = view.findViewById(R.id.authentication_scheme);\n         mPublicApplicationMode = view.findViewById(R.id.public_application_mode);\n+        mDefaultBrowser = view.findViewById(R.id.default_browser);\n \n-        bindSpinnerChoice(mPrompt, Prompt.class);\n-        bindSpinnerChoice(mUserAgent, Constants.UserAgent.class);\n-        bindSpinnerChoice(mAADEnvironments, Constants.AzureActiveDirectoryEnvironment.class);\n+        bindSelectAccountSpinner(mSelectAccount, null);\n+        mSelectAccount.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {\n+            @Override\n+            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {\n+                // If an account is selected.\n+                //  - Gray out mLoginhint.\n+                //  - Set hint in mAuthority.\n+                if (position == mLoadedAccounts.size()) {\n+                    // If an account is selected, grey out this option.\n+                    mLoginhint.setHint(\"\");\n+                    mLoginhint.setCursorVisible(true);\n+                    mLoginhint.setEnabled(true);\n+\n+                    mAuthority.setHint(\"\");\n+                } else {\n+                    mLoginhint.setText(\"\");\n+                    mLoginhint.setHint(\"Disabled\");\n+                    mLoginhint.setCursorVisible(false);\n+                    mLoginhint.setEnabled(false);\n+\n+                    mAuthority.setHint(\"For ATS: Selected account's authority will be used if nothing is provided here\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "391c76390aee7aee36d255cba885594367454f98"}, "originalPosition": 95}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ab262a0995e53b5a0fd3ffb54605f31a618794", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/83ab262a0995e53b5a0fd3ffb54605f31a618794", "committedDate": "2020-02-24T21:55:45Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "865f3de59dabacd09e6815ea4619859869b0ff52", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/865f3de59dabacd09e6815ea4619859869b0ff52", "committedDate": "2020-02-24T21:56:47Z", "message": "Clean up code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "931023245c35d70ebaf682579f5ccb391f98285a", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/931023245c35d70ebaf682579f5ccb391f98285a", "committedDate": "2020-02-24T22:05:08Z", "message": "Add instance_aware_organization:"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcc2e8f0d3cc40856c4583c8892e42e20694a689", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/fcc2e8f0d3cc40856c4583c8892e42e20694a689", "committedDate": "2020-02-24T22:46:46Z", "message": "Fix backstack issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/a2ec49864e80ce47a28653f0ceb1ec736e9d8998", "committedDate": "2020-02-24T23:05:20Z", "message": "Use class name as tag"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNzgyNTI5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-363782529", "createdAt": "2020-02-24T23:49:35Z", "commit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMzo0OTozNVrOFtz_6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMzo0OTozNVrOFtz_6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzU4MjE4NA==", "bodyText": "Can we add another Spinner and EditText to accept the HttpMethod and Resource URL? These could optionally be shown only when the Auth Scheme Spinner indicates PoP", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#discussion_r383582184", "createdAt": "2020-02-24T23:49:35Z", "author": {"login": "iambmelt"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/MsalWrapper.java", "diffHunk": "@@ -166,9 +85,13 @@ public void acquireToken(final Activity activity,\n                                         .split(\" \")\n                         )\n                 )\n-                .withCallback(getAuthenticationCallback(notifyCallback));\n+                .withCallback(getAuthenticationCallback(callback));\n \n-        if (USE_POP) {\n+        if (requestOptions.getAuthority() != null && !requestOptions.getAuthority().isEmpty()) {\n+            builder.fromAuthority(requestOptions.getAuthority());\n+        }\n+\n+        if (requestOptions.getAuthScheme() == Constants.AuthScheme.POP) {\n             try {\n                 builder.withAuthenticationScheme(\n                         PoPAuthenticationScheme.builder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998"}, "originalPosition": 184}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTU3OTc5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-364157979", "createdAt": "2020-02-25T13:56:28Z", "commit": {"oid": "a2ec49864e80ce47a28653f0ceb1ec736e9d8998"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95328ce91a62f78b2fb35e89e96844fada139458", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/95328ce91a62f78b2fb35e89e96844fada139458", "committedDate": "2020-02-25T21:47:58Z", "message": "Add POP options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTE3MDc4", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-364517078", "createdAt": "2020-02-25T23:09:02Z", "commit": {"oid": "95328ce91a62f78b2fb35e89e96844fada139458"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTMxNDUz", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/944#pullrequestreview-364531453", "createdAt": "2020-02-25T23:44:20Z", "commit": {"oid": "95328ce91a62f78b2fb35e89e96844fada139458"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1316, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}