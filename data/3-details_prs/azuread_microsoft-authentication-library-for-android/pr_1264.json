{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NDI2MjQw", "number": 1264, "title": "Aymeghwa/add msalsdk testcases", "bodyText": "add MSAl Automation TestCases with MSAL Sdk Wrapper\nPR for MSAL SDK Wrapper - #1263", "createdAt": "2020-12-24T16:55:04Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264", "merged": true, "mergeCommit": {"oid": "f953dfd0aa67ee02153be87af12427538523f7f3"}, "closed": true, "closedAt": "2021-01-08T18:39:30Z", "author": {"login": "ayushmeghwani"}, "timelineItems": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpSGRGAH2gAyNTQ1NDI2MjQwOmM5OWVkMmY0ZWFjODA2NDc5NzA0NGU1NzNmY2Q5NzZhMTFiMTAxY2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABduFsxngH2gAyNTQ1NDI2MjQwOmVlY2E4OTM1YTIwZDU2MGE5MzQwNjhlYzRlMmE0NTNhZDQ2ZjgyYTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c99ed2f4eac8064797044e573fcd976a11b101cb", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/c99ed2f4eac8064797044e573fcd976a11b101cb", "committedDate": "2020-12-24T11:33:16Z", "message": "add MSAL Sdk Wrapper for Automation Testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/32457cb697599d08d9cfd8e5c9d53828e31d8f56", "committedDate": "2020-12-24T16:52:04Z", "message": "add MSAl Automation TestCases with MSAL Sdk Wrapper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzEzNzM4", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562313738", "createdAt": "2021-01-06T04:10:41Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoxMDo0MVrOIOxR-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoxMDo0MVrOIOxR-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM1ODM5Mg==", "bodyText": "Remove this?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552358392", "createdAt": "2021-01-06T04:10:41Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);\n+\n+    @Override\n+    public MsalAuthResult acquireTokenInteractive(@NonNull MsalAuthTestParams authTestParams, OnInteractionRequired interactionRequiredCallback, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final AcquireTokenParameters.Builder acquireTokenParametersBuilder = new AcquireTokenParameters.Builder()\n+                .startAuthorizationFromActivity(authTestParams.getActivity())\n+                .withLoginHint(authTestParams.getLoginHint())\n+                .withPrompt(authTestParams.getPromptParameter())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireToken(acquireTokenParameters);\n+\n+        interactionRequiredCallback.handleUserInteraction();\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    @Override\n+    public MsalAuthResult acquireTokenSilent(@NonNull MsalAuthTestParams authTestParams, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+            authTestParams.getActivity(),\n+            authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final IAccount account = getAccount(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId(),\n+                authTestParams.getLoginHint()\n+        );\n+\n+        final AcquireTokenSilentParameters.Builder acquireTokenParametersBuilder = new AcquireTokenSilentParameters.Builder()\n+                .forAccount(account)\n+                .forceRefresh(authTestParams.isForceRefresh())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenSilentParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireTokenSilentAsync(acquireTokenParameters);\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    private IPublicClientApplication setupPCA(@NonNull final Context context,\n+                                             int msalConfigResourceId) {\n+        try {\n+            return PublicClientApplication.create(context, msalConfigResourceId);\n+        } catch (InterruptedException | MsalException e) {\n+            throw new AssertionError(e);\n+        }\n+    }\n+\n+    private AuthenticationCallback getAuthCallback(final ResultFuture<IAuthenticationResult, Exception> future) {\n+        return new AuthenticationCallback() {\n+            @Override\n+            public void onSuccess(IAuthenticationResult authenticationResult) {\n+                future.setResult(authenticationResult);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+\n+            @Override\n+            public void onCancel() {\n+                future.setException(new MsalUserCancelException());\n+            }\n+        };\n+    }\n+\n+    private IAccount getAccount(@NonNull final Activity activity,\n+                                final int msalConfigResourceId,\n+                                @NonNull final String username) {\n+        final IPublicClientApplication pca = setupPCA(\n+                activity,\n+                msalConfigResourceId\n+        );\n+\n+        if (pca instanceof SingleAccountPublicClientApplication) {\n+            return getAccountForSingleAccountPca((SingleAccountPublicClientApplication) pca);\n+        } else if (pca instanceof MultipleAccountPublicClientApplication) {\n+            return getAccountForMultipleAccountPca((MultipleAccountPublicClientApplication) pca, username);\n+        } else {\n+            throw new AssertionError(\"Weird\");\n+        }\n+    }\n+\n+    private IAccount getAccountForSingleAccountPca(SingleAccountPublicClientApplication pca) {\n+        final ResultFuture<IAccount, Exception> future = new ResultFuture<>();\n+\n+        pca.getCurrentAccountAsync(new ISingleAccountPublicClientApplication.CurrentAccountCallback() {\n+            @Override\n+            public void onAccountLoaded(@Nullable IAccount activeAccount) {\n+                future.setResult(activeAccount);\n+            }\n+\n+            @Override\n+            public void onAccountChanged(@Nullable IAccount priorAccount, @Nullable IAccount currentAccount) {\n+                future.setResult(currentAccount);\n+            }\n+\n+            @Override\n+            public void onError(@NonNull MsalException exception) {\n+                future.setException(exception);\n+            }\n+        });\n+\n+        try {\n+            return future.get();\n+        } catch (Exception exception) {\n+            throw new AssertionError(exception);\n+        }\n+    }\n+\n+    private IAccount getAccountForMultipleAccountPca(MultipleAccountPublicClientApplication pca,\n+                                                     final String username) {\n+        final ResultFuture<IAccount, Exception> future = new ResultFuture<>();\n+\n+        pca.getAccount(username, new IMultipleAccountPublicClientApplication.GetAccountCallback() {\n+            @Override\n+            public void onTaskCompleted(IAccount result) {\n+                future.setResult(result);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+        });\n+\n+        try {\n+            return future.get();\n+        } catch (Exception exception) {\n+            throw new AssertionError(exception);\n+        }\n+    }\n+\n+//    private AuthenticationContext createAuthContext(final Context context, final String authority) {\n+//        return new AuthenticationContext(context, authority, true);\n+//    }\n+//\n+//    private AuthenticationCallback getAuthenticationCallback(\n+//            final ResultFuture<AuthenticationResult, Exception> future) {\n+//        return new AuthenticationCallback<AuthenticationResult>() {\n+//            @Override\n+//            public void onSuccess(final AuthenticationResult authenticationResult) {\n+//                upnUserIdMap.put(\n+//                        authenticationResult.getUserInfo().getDisplayableId(),\n+//                        authenticationResult.getUserInfo().getUserId()\n+//                );\n+//                future.setResult(authenticationResult);\n+//            }\n+//\n+//            @Override\n+//            public void onError(final Exception e) {\n+//                future.setException(e);\n+//            }\n+//        };\n+//    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 253}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE1MDI4", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562315028", "createdAt": "2021-01-06T04:16:10Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoxNjoxMFrOIOxXNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoxNjoxMFrOIOxXNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM1OTczMw==", "bodyText": "add new line at end of file", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552359733", "createdAt": "2021-01-06T04:16:10Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase796048Clone.java", "diffHunk": "@@ -0,0 +1,104 @@\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.TestContext;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Test;\n+\n+public class TestCase796048Clone extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_796048Clone() throws Throwable {\n+        final String username = mLoginHint;\n+        final String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+\n+        final MsalSdk msalSdk = new MsalSdk();\n+\n+        final MsalAuthTestParams authTestParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .resource(mScopes[0])\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .promptParameter(Prompt.SELECT_ACCOUNT)\n+                .build();\n+\n+        final MsalAuthResult authResult = msalSdk.acquireTokenInteractive(authTestParams, new OnInteractionRequired() {\n+            @Override\n+            public void handleUserInteraction() {\n+                final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                        .prompt(PromptParameter.SELECT_ACCOUNT)\n+                        .loginHint(mLoginHint)\n+                        .sessionExpected(false)\n+                        .consentPageExpected(false)\n+                        .speedBumpExpected(false)\n+                        .broker(mBroker)\n+                        .expectingBrokerAccountChooserActivity(false)\n+                        .build();\n+\n+                new AadPromptHandler(promptHandlerParameters)\n+                        .handlePrompt(username, password);\n+            }\n+        },null);\n+\n+        authResult.assertSuccess();\n+\n+        // now expire AT\n+\n+        TestContext.getTestContext().getTestDevice().getSettings().forwardDeviceTimeForOneDay();\n+\n+        // SILENT REQUEST\n+\n+        final MsalAuthTestParams authTestSilentParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .resource(mScopes[0])\n+                .authority(getAuthority())\n+                .forceRefresh(true)\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .build();\n+\n+        final MsalAuthResult silentAuthResult = msalSdk.acquireTokenSilent(authTestSilentParams, null);\n+\n+        silentAuthResult.assertSuccess();\n+    }\n+\n+\n+    @Override\n+    public LabUserQuery getLabUserQuery() {\n+        final LabUserQuery query = new LabUserQuery();\n+        query.azureEnvironment = LabConstants.AzureEnvironment.AZURE_GERMANY_CLOUD;\n+        return query;\n+    }\n+\n+    @Override\n+    public String getTempUserType() {\n+        return null;\n+    }\n+\n+    @Override\n+    public String[] getScopes() {\n+        return new String[]{\"00000002-0000-0000-c000-000000000000\"};\n+    }\n+\n+    @Override\n+    public String getAuthority() {\n+        return \"https://login.microsoftonline.de/common\";\n+    }\n+\n+    @Override\n+    public int getConfigFileResourceId() {\n+        return R.raw.msal_config_instance_aware_common;\n+    }\n+\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 104}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE2NjM5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562316639", "createdAt": "2021-01-06T04:23:06Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyMzowNlrOIOxc4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyMzowNlrOIOxc4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MTE4NA==", "bodyText": "Can we move this as a generic interface to uiautomationutilities? that way it can used by both MSAL and ADAL automation", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552361184", "createdAt": "2021-01-06T04:23:06Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/IAuthSdk.java", "diffHunk": "@@ -0,0 +1,51 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+\n+/**\n+ * An interface describing methods of acquire token. Implementing this interface\n+ * on a test facilitates specifying the necessary parameters required to acquire\n+ * token either interactively or silently.\n+ */\n+public interface IAuthSdk {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE3MzAx", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562317301", "createdAt": "2021-01-06T04:25:58Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNTo1OFrOIOxfXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNTo1OFrOIOxfXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MTgyMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    } catch (Exception exception) {\n          \n          \n            \n                    } catch (final Exception exception) {", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552361822", "createdAt": "2021-01-06T04:25:58Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);\n+\n+    @Override\n+    public MsalAuthResult acquireTokenInteractive(@NonNull MsalAuthTestParams authTestParams, OnInteractionRequired interactionRequiredCallback, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final AcquireTokenParameters.Builder acquireTokenParametersBuilder = new AcquireTokenParameters.Builder()\n+                .startAuthorizationFromActivity(authTestParams.getActivity())\n+                .withLoginHint(authTestParams.getLoginHint())\n+                .withPrompt(authTestParams.getPromptParameter())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireToken(acquireTokenParameters);\n+\n+        interactionRequiredCallback.handleUserInteraction();\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    @Override\n+    public MsalAuthResult acquireTokenSilent(@NonNull MsalAuthTestParams authTestParams, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+            authTestParams.getActivity(),\n+            authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final IAccount account = getAccount(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId(),\n+                authTestParams.getLoginHint()\n+        );\n+\n+        final AcquireTokenSilentParameters.Builder acquireTokenParametersBuilder = new AcquireTokenSilentParameters.Builder()\n+                .forAccount(account)\n+                .forceRefresh(authTestParams.isForceRefresh())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenSilentParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireTokenSilentAsync(acquireTokenParameters);\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 132}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE3Mzcw", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562317370", "createdAt": "2021-01-06T04:26:16Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjoxNlrOIOxfqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjoxNlrOIOxfqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MTg5Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private IAccount getAccountForSingleAccountPca(SingleAccountPublicClientApplication pca) {\n          \n          \n            \n                private IAccount getAccountForSingleAccountPca(@NonNull final SingleAccountPublicClientApplication pca) {", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552361897", "createdAt": "2021-01-06T04:26:16Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);\n+\n+    @Override\n+    public MsalAuthResult acquireTokenInteractive(@NonNull MsalAuthTestParams authTestParams, OnInteractionRequired interactionRequiredCallback, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final AcquireTokenParameters.Builder acquireTokenParametersBuilder = new AcquireTokenParameters.Builder()\n+                .startAuthorizationFromActivity(authTestParams.getActivity())\n+                .withLoginHint(authTestParams.getLoginHint())\n+                .withPrompt(authTestParams.getPromptParameter())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireToken(acquireTokenParameters);\n+\n+        interactionRequiredCallback.handleUserInteraction();\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    @Override\n+    public MsalAuthResult acquireTokenSilent(@NonNull MsalAuthTestParams authTestParams, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+            authTestParams.getActivity(),\n+            authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final IAccount account = getAccount(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId(),\n+                authTestParams.getLoginHint()\n+        );\n+\n+        final AcquireTokenSilentParameters.Builder acquireTokenParametersBuilder = new AcquireTokenSilentParameters.Builder()\n+                .forAccount(account)\n+                .forceRefresh(authTestParams.isForceRefresh())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenSilentParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireTokenSilentAsync(acquireTokenParameters);\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    private IPublicClientApplication setupPCA(@NonNull final Context context,\n+                                             int msalConfigResourceId) {\n+        try {\n+            return PublicClientApplication.create(context, msalConfigResourceId);\n+        } catch (InterruptedException | MsalException e) {\n+            throw new AssertionError(e);\n+        }\n+    }\n+\n+    private AuthenticationCallback getAuthCallback(final ResultFuture<IAuthenticationResult, Exception> future) {\n+        return new AuthenticationCallback() {\n+            @Override\n+            public void onSuccess(IAuthenticationResult authenticationResult) {\n+                future.setResult(authenticationResult);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+\n+            @Override\n+            public void onCancel() {\n+                future.setException(new MsalUserCancelException());\n+            }\n+        };\n+    }\n+\n+    private IAccount getAccount(@NonNull final Activity activity,\n+                                final int msalConfigResourceId,\n+                                @NonNull final String username) {\n+        final IPublicClientApplication pca = setupPCA(\n+                activity,\n+                msalConfigResourceId\n+        );\n+\n+        if (pca instanceof SingleAccountPublicClientApplication) {\n+            return getAccountForSingleAccountPca((SingleAccountPublicClientApplication) pca);\n+        } else if (pca instanceof MultipleAccountPublicClientApplication) {\n+            return getAccountForMultipleAccountPca((MultipleAccountPublicClientApplication) pca, username);\n+        } else {\n+            throw new AssertionError(\"Weird\");\n+        }\n+    }\n+\n+    private IAccount getAccountForSingleAccountPca(SingleAccountPublicClientApplication pca) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 182}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE3NDU3", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562317457", "createdAt": "2021-01-06T04:26:32Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjozM1rOIOxf6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjozM1rOIOxf6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MTk2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private IAccount getAccountForMultipleAccountPca(MultipleAccountPublicClientApplication pca,\n          \n          \n            \n                private IAccount getAccountForMultipleAccountPca(@NonNull final MultipleAccountPublicClientApplication pca,", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552361963", "createdAt": "2021-01-06T04:26:33Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);\n+\n+    @Override\n+    public MsalAuthResult acquireTokenInteractive(@NonNull MsalAuthTestParams authTestParams, OnInteractionRequired interactionRequiredCallback, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final AcquireTokenParameters.Builder acquireTokenParametersBuilder = new AcquireTokenParameters.Builder()\n+                .startAuthorizationFromActivity(authTestParams.getActivity())\n+                .withLoginHint(authTestParams.getLoginHint())\n+                .withPrompt(authTestParams.getPromptParameter())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireToken(acquireTokenParameters);\n+\n+        interactionRequiredCallback.handleUserInteraction();\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    @Override\n+    public MsalAuthResult acquireTokenSilent(@NonNull MsalAuthTestParams authTestParams, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+            authTestParams.getActivity(),\n+            authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final IAccount account = getAccount(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId(),\n+                authTestParams.getLoginHint()\n+        );\n+\n+        final AcquireTokenSilentParameters.Builder acquireTokenParametersBuilder = new AcquireTokenSilentParameters.Builder()\n+                .forAccount(account)\n+                .forceRefresh(authTestParams.isForceRefresh())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenSilentParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireTokenSilentAsync(acquireTokenParameters);\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    private IPublicClientApplication setupPCA(@NonNull final Context context,\n+                                             int msalConfigResourceId) {\n+        try {\n+            return PublicClientApplication.create(context, msalConfigResourceId);\n+        } catch (InterruptedException | MsalException e) {\n+            throw new AssertionError(e);\n+        }\n+    }\n+\n+    private AuthenticationCallback getAuthCallback(final ResultFuture<IAuthenticationResult, Exception> future) {\n+        return new AuthenticationCallback() {\n+            @Override\n+            public void onSuccess(IAuthenticationResult authenticationResult) {\n+                future.setResult(authenticationResult);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+\n+            @Override\n+            public void onCancel() {\n+                future.setException(new MsalUserCancelException());\n+            }\n+        };\n+    }\n+\n+    private IAccount getAccount(@NonNull final Activity activity,\n+                                final int msalConfigResourceId,\n+                                @NonNull final String username) {\n+        final IPublicClientApplication pca = setupPCA(\n+                activity,\n+                msalConfigResourceId\n+        );\n+\n+        if (pca instanceof SingleAccountPublicClientApplication) {\n+            return getAccountForSingleAccountPca((SingleAccountPublicClientApplication) pca);\n+        } else if (pca instanceof MultipleAccountPublicClientApplication) {\n+            return getAccountForMultipleAccountPca((MultipleAccountPublicClientApplication) pca, username);\n+        } else {\n+            throw new AssertionError(\"Weird\");\n+        }\n+    }\n+\n+    private IAccount getAccountForSingleAccountPca(SingleAccountPublicClientApplication pca) {\n+        final ResultFuture<IAccount, Exception> future = new ResultFuture<>();\n+\n+        pca.getCurrentAccountAsync(new ISingleAccountPublicClientApplication.CurrentAccountCallback() {\n+            @Override\n+            public void onAccountLoaded(@Nullable IAccount activeAccount) {\n+                future.setResult(activeAccount);\n+            }\n+\n+            @Override\n+            public void onAccountChanged(@Nullable IAccount priorAccount, @Nullable IAccount currentAccount) {\n+                future.setResult(currentAccount);\n+            }\n+\n+            @Override\n+            public void onError(@NonNull MsalException exception) {\n+                future.setException(exception);\n+            }\n+        });\n+\n+        try {\n+            return future.get();\n+        } catch (Exception exception) {\n+            throw new AssertionError(exception);\n+        }\n+    }\n+\n+    private IAccount getAccountForMultipleAccountPca(MultipleAccountPublicClientApplication pca,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 209}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE3NDk5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562317499", "createdAt": "2021-01-06T04:26:42Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjo0MlrOIOxgHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNjo0MlrOIOxgHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MjAxNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    } catch (Exception exception) {\n          \n          \n            \n                    } catch (final Exception exception) {", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552362015", "createdAt": "2021-01-06T04:26:42Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);\n+\n+    @Override\n+    public MsalAuthResult acquireTokenInteractive(@NonNull MsalAuthTestParams authTestParams, OnInteractionRequired interactionRequiredCallback, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final AcquireTokenParameters.Builder acquireTokenParametersBuilder = new AcquireTokenParameters.Builder()\n+                .startAuthorizationFromActivity(authTestParams.getActivity())\n+                .withLoginHint(authTestParams.getLoginHint())\n+                .withPrompt(authTestParams.getPromptParameter())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireToken(acquireTokenParameters);\n+\n+        interactionRequiredCallback.handleUserInteraction();\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    @Override\n+    public MsalAuthResult acquireTokenSilent(@NonNull MsalAuthTestParams authTestParams, TokenRequestTimeout tokenRequestTimeout) throws Throwable {\n+        final IPublicClientApplication pca = setupPCA(\n+            authTestParams.getActivity(),\n+            authTestParams.getMsalConfigResourceId()\n+        );\n+\n+        final ResultFuture<IAuthenticationResult, Exception> future = new ResultFuture<>();\n+\n+        final IAccount account = getAccount(\n+                authTestParams.getActivity(),\n+                authTestParams.getMsalConfigResourceId(),\n+                authTestParams.getLoginHint()\n+        );\n+\n+        final AcquireTokenSilentParameters.Builder acquireTokenParametersBuilder = new AcquireTokenSilentParameters.Builder()\n+                .forAccount(account)\n+                .forceRefresh(authTestParams.isForceRefresh())\n+                .fromAuthority(authTestParams.getAuthority())\n+                .withCallback(getAuthCallback(future));\n+\n+        if (authTestParams.getScopes() == null || authTestParams.getScopes().isEmpty()) {\n+            acquireTokenParametersBuilder.withResource(authTestParams.getResource());\n+        } else {\n+            acquireTokenParametersBuilder.withScopes(new ArrayList<>(authTestParams.getScopes()));\n+        }\n+\n+        final AcquireTokenSilentParameters acquireTokenParameters = acquireTokenParametersBuilder.build();\n+\n+        pca.acquireTokenSilentAsync(acquireTokenParameters);\n+\n+        try {\n+            final IAuthenticationResult result = future.get();\n+            return new MsalAuthResult(result);\n+        } catch (Exception exception) {\n+            return new MsalAuthResult(exception);\n+        }\n+    }\n+\n+    private IPublicClientApplication setupPCA(@NonNull final Context context,\n+                                             int msalConfigResourceId) {\n+        try {\n+            return PublicClientApplication.create(context, msalConfigResourceId);\n+        } catch (InterruptedException | MsalException e) {\n+            throw new AssertionError(e);\n+        }\n+    }\n+\n+    private AuthenticationCallback getAuthCallback(final ResultFuture<IAuthenticationResult, Exception> future) {\n+        return new AuthenticationCallback() {\n+            @Override\n+            public void onSuccess(IAuthenticationResult authenticationResult) {\n+                future.setResult(authenticationResult);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+\n+            @Override\n+            public void onCancel() {\n+                future.setException(new MsalUserCancelException());\n+            }\n+        };\n+    }\n+\n+    private IAccount getAccount(@NonNull final Activity activity,\n+                                final int msalConfigResourceId,\n+                                @NonNull final String username) {\n+        final IPublicClientApplication pca = setupPCA(\n+                activity,\n+                msalConfigResourceId\n+        );\n+\n+        if (pca instanceof SingleAccountPublicClientApplication) {\n+            return getAccountForSingleAccountPca((SingleAccountPublicClientApplication) pca);\n+        } else if (pca instanceof MultipleAccountPublicClientApplication) {\n+            return getAccountForMultipleAccountPca((MultipleAccountPublicClientApplication) pca, username);\n+        } else {\n+            throw new AssertionError(\"Weird\");\n+        }\n+    }\n+\n+    private IAccount getAccountForSingleAccountPca(SingleAccountPublicClientApplication pca) {\n+        final ResultFuture<IAccount, Exception> future = new ResultFuture<>();\n+\n+        pca.getCurrentAccountAsync(new ISingleAccountPublicClientApplication.CurrentAccountCallback() {\n+            @Override\n+            public void onAccountLoaded(@Nullable IAccount activeAccount) {\n+                future.setResult(activeAccount);\n+            }\n+\n+            @Override\n+            public void onAccountChanged(@Nullable IAccount priorAccount, @Nullable IAccount currentAccount) {\n+                future.setResult(currentAccount);\n+            }\n+\n+            @Override\n+            public void onError(@NonNull MsalException exception) {\n+                future.setException(exception);\n+            }\n+        });\n+\n+        try {\n+            return future.get();\n+        } catch (Exception exception) {\n+            throw new AssertionError(exception);\n+        }\n+    }\n+\n+    private IAccount getAccountForMultipleAccountPca(MultipleAccountPublicClientApplication pca,\n+                                                     final String username) {\n+        final ResultFuture<IAccount, Exception> future = new ResultFuture<>();\n+\n+        pca.getAccount(username, new IMultipleAccountPublicClientApplication.GetAccountCallback() {\n+            @Override\n+            public void onTaskCompleted(IAccount result) {\n+                future.setResult(result);\n+            }\n+\n+            @Override\n+            public void onError(MsalException exception) {\n+                future.setException(exception);\n+            }\n+        });\n+\n+        try {\n+            return future.get();\n+        } catch (Exception exception) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 227}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE3NjM2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562317636", "createdAt": "2021-01-06T04:27:23Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNzoyM1rOIOxhCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDoyNzoyM1rOIOxhCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MjI0OA==", "bodyText": "I don't think we need this", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552362248", "createdAt": "2021-01-06T04:27:23Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalSdk.java", "diffHunk": "@@ -0,0 +1,254 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import android.app.Activity;\n+import android.content.Context;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+\n+import com.microsoft.identity.client.AcquireTokenParameters;\n+import com.microsoft.identity.client.AcquireTokenSilentParameters;\n+import com.microsoft.identity.client.AuthenticationCallback;\n+import com.microsoft.identity.client.IAccount;\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.IMultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.IPublicClientApplication;\n+import com.microsoft.identity.client.ISingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.MultipleAccountPublicClientApplication;\n+import com.microsoft.identity.client.PublicClientApplication;\n+import com.microsoft.identity.client.SingleAccountPublicClientApplication;\n+import com.microsoft.identity.client.exception.MsalException;\n+import com.microsoft.identity.client.exception.MsalUserCancelException;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.sdk.ResultFuture;\n+\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+/**\n+ * A Sdk wrapper for Microsoft Authentication Library (MSAL) which implements\n+ * both the methods of acquire token interactively and silently and returns back the\n+ * AuthResult, MSAL tests can leverage this sdk for acquiring token with specific\n+ * parameters and get back the final result.\n+ */\n+public class MsalSdk implements IAuthSdk {\n+\n+    protected Map<String, String> upnUserIdMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE4NDAw", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562318400", "createdAt": "2021-01-06T04:30:26Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDozMDoyNlrOIOxjrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDozMDoyNlrOIOxjrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MjkyNQ==", "bodyText": "not needed?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552362925", "createdAt": "2021-01-06T04:30:26Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/local/TestCase99267Clone.java", "diffHunk": "@@ -0,0 +1,117 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.local;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.AbstractMsalUiTest;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.UiResponse;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Test;\n+\n+import java.util.Arrays;\n+\n+// Interactive Auth with select_account (no consent record)\n+// https://identitydivision.visualstudio.com/DefaultCollection/IDDP/_workitems/edit/99267\n+public class TestCase99267Clone extends AbstractMsalUiTest {\n+\n+    @Test\n+    public void test_99267Clone() throws Throwable {\n+        final String username = mLoginHint;\n+        final String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+\n+        final MsalSdk msalSdk = new MsalSdk();\n+\n+        final MsalAuthTestParams authTestParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .scopes(Arrays.asList(mScopes))\n+                .promptParameter(Prompt.SELECT_ACCOUNT)\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .build();\n+\n+//        final AcquireTokenParameters parameters = new AcquireTokenParameters.Builder()\n+//                .startAuthorizationFromActivity(mActivity)\n+//                .withLoginHint(mLoginHint)\n+//                .withScopes(Arrays.asList(mScopes))\n+//                .withCallback(successfulInteractiveCallback(latch))\n+//                .withPrompt(Prompt.SELECT_ACCOUNT)\n+//                .build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 68}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE4NjE2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562318616", "createdAt": "2021-01-06T04:31:18Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDozMToxOFrOIOxkWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDozMToxOFrOIOxkWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2MzA5Nw==", "bodyText": "Can we just import the class directly at the top of the file?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552363097", "createdAt": "2021-01-06T04:31:18Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/local/TestCase99267Clone.java", "diffHunk": "@@ -0,0 +1,117 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.local;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.AbstractMsalUiTest;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.UiResponse;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Test;\n+\n+import java.util.Arrays;\n+\n+// Interactive Auth with select_account (no consent record)\n+// https://identitydivision.visualstudio.com/DefaultCollection/IDDP/_workitems/edit/99267\n+public class TestCase99267Clone extends AbstractMsalUiTest {\n+\n+    @Test\n+    public void test_99267Clone() throws Throwable {\n+        final String username = mLoginHint;\n+        final String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+\n+        final MsalSdk msalSdk = new MsalSdk();\n+\n+        final MsalAuthTestParams authTestParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .scopes(Arrays.asList(mScopes))\n+                .promptParameter(Prompt.SELECT_ACCOUNT)\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .build();\n+\n+//        final AcquireTokenParameters parameters = new AcquireTokenParameters.Builder()\n+//                .startAuthorizationFromActivity(mActivity)\n+//                .withLoginHint(mLoginHint)\n+//                .withScopes(Arrays.asList(mScopes))\n+//                .withCallback(successfulInteractiveCallback(latch))\n+//                .withPrompt(Prompt.SELECT_ACCOUNT)\n+//                .build();\n+\n+        final MsalAuthResult authResult = msalSdk.acquireTokenInteractive(authTestParams, new com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzE4OTQ2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562318946", "createdAt": "2021-01-06T04:32:44Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzIxNzc2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-562321776", "createdAt": "2021-01-06T04:43:53Z", "commit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDo0Mzo1M1rOIOxv6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNDo0Mzo1M1rOIOxv6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM2NjA1Ng==", "bodyText": "we should change the parent to make these private and the parent should initialize these...over here we would just call super", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r552366056", "createdAt": "2021-01-06T04:43:53Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/main/java/com/microsoft/identity/client/msal/automationapp/sdk/MsalAuthResult.java", "diffHunk": "@@ -0,0 +1,49 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.sdk;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.microsoft.identity.client.IAuthenticationResult;\n+import com.microsoft.identity.client.ui.automation.sdk.AuthResult;\n+\n+import java.util.Map;\n+\n+// MSAL Result Class to handle asserting success or failure on execution of Automated Test Cases\n+public class MsalAuthResult extends AuthResult {\n+\n+    private Map<String, ?> claims;\n+\n+    public MsalAuthResult(@NonNull final IAuthenticationResult authenticationResult) {\n+        this.accessToken = authenticationResult.getAccessToken();\n+        this.idToken = authenticationResult.getAccount().getIdToken();\n+        this.userId = authenticationResult.getAccount().getId();\n+        this.username = authenticationResult.getAccount().getUsername();\n+        this.authority = authenticationResult.getAccount().getAuthority();\n+        this.claims = authenticationResult.getAccount().getClaims();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32457cb697599d08d9cfd8e5c9d53828e31d8f56"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18aa26cd15a852c3a965a162a6dabc7f905fa0ec", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/18aa26cd15a852c3a965a162a6dabc7f905fa0ec", "committedDate": "2021-01-06T16:22:12Z", "message": "remove extra comments and make some parameters final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80f5f85f6e0db34e416e6f99b770bd8141ff4023", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/80f5f85f6e0db34e416e6f99b770bd8141ff4023", "committedDate": "2021-01-06T16:24:00Z", "message": "Merge branch 'aymeghwa/add-msal-wrapper' of https://github.com/AzureAD/microsoft-authentication-library-for-android into aymeghwa/add-msalsdk-testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccbb4d43bcd7308889dd52bb656ca430477fd2c7", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/ccbb4d43bcd7308889dd52bb656ca430477fd2c7", "committedDate": "2021-01-06T16:43:43Z", "message": "add extra line at eof and remove comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e2562572ff4247e81ca86a7f272bdeb81fcb23a", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/3e2562572ff4247e81ca86a7f272bdeb81fcb23a", "committedDate": "2021-01-06T16:47:53Z", "message": "make some parameters final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "248a7e6b957195e103816f08dadc4c6a93c7d3a6", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/248a7e6b957195e103816f08dadc4c6a93c7d3a6", "committedDate": "2021-01-06T17:06:51Z", "message": "use new generic Auth SDK from ui automation utilities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e9ba29f787afa7afa7affe0b28633829bf71b9f", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/6e9ba29f787afa7afa7affe0b28633829bf71b9f", "committedDate": "2021-01-06T17:10:18Z", "message": "Merge branch 'aymeghwa/add-msal-wrapper' of https://github.com/AzureAD/microsoft-authentication-library-for-android into aymeghwa/add-msalsdk-testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a131d5628a6164fc5bdd67cc9fecdbcf5475190", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/7a131d5628a6164fc5bdd67cc9fecdbcf5475190", "committedDate": "2021-01-06T17:20:01Z", "message": "make Exception parameter final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e7b07c65469da177456c149e4e89f96613a482e", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/0e7b07c65469da177456c149e4e89f96613a482e", "committedDate": "2021-01-06T17:21:01Z", "message": "Merge branch 'aymeghwa/add-msal-wrapper' of https://github.com/AzureAD/microsoft-authentication-library-for-android into aymeghwa/add-msalsdk-testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21c155575b59d821385d81359db5f4225b477841", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/21c155575b59d821385d81359db5f4225b477841", "committedDate": "2021-01-06T17:31:13Z", "message": "remove MSAL specific SDK"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d8aebd8c392c56f92ee0c714ee0f41b091b3f9", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/84d8aebd8c392c56f92ee0c714ee0f41b091b3f9", "committedDate": "2021-01-06T18:38:02Z", "message": "call super of parent class to initialize variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d449d6f01c04d653091ac18f088ad9b449d767d9", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/d449d6f01c04d653091ac18f088ad9b449d767d9", "committedDate": "2021-01-06T18:40:28Z", "message": "Merge branch 'aymeghwa/add-msal-wrapper' of https://github.com/AzureAD/microsoft-authentication-library-for-android into aymeghwa/add-msalsdk-testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/632d9c14700e355f95e1dc804712af55143c0a31", "committedDate": "2021-01-06T18:42:33Z", "message": "Revert \"make Exception parameter final\"\n\nThis reverts commit 7a131d5628a6164fc5bdd67cc9fecdbcf5475190."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2604a0b36c2f394de80fb2bb9c4aacdb3a7ffcfe", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/2604a0b36c2f394de80fb2bb9c4aacdb3a7ffcfe", "committedDate": "2021-01-06T18:49:15Z", "message": "make exception parameter final"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMjA3ODcx", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-563207871", "createdAt": "2021-01-07T04:47:05Z", "commit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNDo0NzowNVrOIPe9nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNDo0NzowNVrOIPe9nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzEwNjg0NQ==", "bodyText": "Missing license", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r553106845", "createdAt": "2021-01-07T04:47:05Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase796048Clone.java", "diffHunk": "@@ -0,0 +1,104 @@\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMjEzNzA5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-563213709", "createdAt": "2021-01-07T05:09:08Z", "commit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNTowOTowOFrOIPfRfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNTowOTowOFrOIPfRfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzExMTkzMg==", "bodyText": "Why no timeout supplied?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r553111932", "createdAt": "2021-01-07T05:09:08Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase796048Clone.java", "diffHunk": "@@ -0,0 +1,104 @@\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.TestContext;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Test;\n+\n+public class TestCase796048Clone extends AbstractMsalBrokerTest {\n+\n+    @Test\n+    public void test_796048Clone() throws Throwable {\n+        final String username = mLoginHint;\n+        final String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+\n+        final MsalSdk msalSdk = new MsalSdk();\n+\n+        final MsalAuthTestParams authTestParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .resource(mScopes[0])\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .promptParameter(Prompt.SELECT_ACCOUNT)\n+                .build();\n+\n+        final MsalAuthResult authResult = msalSdk.acquireTokenInteractive(authTestParams, new OnInteractionRequired() {\n+            @Override\n+            public void handleUserInteraction() {\n+                final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                        .prompt(PromptParameter.SELECT_ACCOUNT)\n+                        .loginHint(mLoginHint)\n+                        .sessionExpected(false)\n+                        .consentPageExpected(false)\n+                        .speedBumpExpected(false)\n+                        .broker(mBroker)\n+                        .expectingBrokerAccountChooserActivity(false)\n+                        .build();\n+\n+                new AadPromptHandler(promptHandlerParameters)\n+                        .handlePrompt(username, password);\n+            }\n+        },null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMjEzNzk1", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-563213795", "createdAt": "2021-01-07T05:09:25Z", "commit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNTowOToyNVrOIPfRvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNTowOToyNVrOIPfRvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzExMTk5Nw==", "bodyText": "Why no timeout supplied?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r553111997", "createdAt": "2021-01-07T05:09:25Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/local/TestCase99267Clone.java", "diffHunk": "@@ -0,0 +1,110 @@\n+//  Copyright (c) Microsoft Corporation.\n+//  All rights reserved.\n+//\n+//  This code is licensed under the MIT License.\n+//\n+//  Permission is hereby granted, free of charge, to any person obtaining a copy\n+//  of this software and associated documentation files(the \"Software\"), to deal\n+//  in the Software without restriction, including without limitation the rights\n+//  to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+//  copies of the Software, and to permit persons to whom the Software is\n+//  furnished to do so, subject to the following conditions :\n+//\n+//  The above copyright notice and this permission notice shall be included in\n+//  all copies or substantial portions of the Software.\n+//\n+//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+//  THE SOFTWARE.\n+package com.microsoft.identity.client.msal.automationapp.testpass.local;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.AbstractMsalUiTest;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.UiResponse;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+\n+import org.junit.Test;\n+\n+import java.util.Arrays;\n+\n+// Interactive Auth with select_account (no consent record)\n+// https://identitydivision.visualstudio.com/DefaultCollection/IDDP/_workitems/edit/99267\n+public class TestCase99267Clone extends AbstractMsalUiTest {\n+\n+    @Test\n+    public void test_99267Clone() throws Throwable {\n+        final String username = mLoginHint;\n+        final String password = LabConfig.getCurrentLabConfig().getLabUserPassword();\n+\n+        final MsalSdk msalSdk = new MsalSdk();\n+\n+        final MsalAuthTestParams authTestParams = MsalAuthTestParams.builder()\n+                .activity(mActivity)\n+                .loginHint(mLoginHint)\n+                .scopes(Arrays.asList(mScopes))\n+                .promptParameter(Prompt.SELECT_ACCOUNT)\n+                .msalConfigResourceId(getConfigFileResourceId())\n+                .build();\n+\n+        final MsalAuthResult authResult = msalSdk.acquireTokenInteractive(authTestParams, new OnInteractionRequired() {\n+            @Override\n+            public void handleUserInteraction() {\n+                final PromptHandlerParameters promptHandlerParameters = PromptHandlerParameters.builder()\n+                        .prompt(PromptParameter.SELECT_ACCOUNT)\n+                        .loginHint(mLoginHint)\n+                        .sessionExpected(false)\n+                        .consentPageExpected(true)\n+                        .speedBumpExpected(false)\n+                        .consentPageResponse(UiResponse.ACCEPT)\n+                        .build();\n+\n+                new AadPromptHandler(promptHandlerParameters)\n+                        .handlePrompt(username, password);\n+            }\n+        },null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d9c14700e355f95e1dc804712af55143c0a31"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0291d967412af4c9930e949d52d5c26342535fa0", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/0291d967412af4c9930e949d52d5c26342535fa0", "committedDate": "2021-01-07T12:28:10Z", "message": "make timeout required parameter for acquiring token"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "492cfdf03a53a5938f36779fb4e3ddf94b3aee95", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/492cfdf03a53a5938f36779fb4e3ddf94b3aee95", "committedDate": "2021-01-07T12:28:52Z", "message": "Merge branch 'aymeghwa/add-msal-wrapper' of https://github.com/AzureAD/microsoft-authentication-library-for-android into aymeghwa/add-msalsdk-testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "625ab13d9753c852176129a1ce887d4b501c7886", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/625ab13d9753c852176129a1ce887d4b501c7886", "committedDate": "2021-01-07T12:33:04Z", "message": "add timeout to MSAL Automation Test Cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzOTIwMTcx", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-563920171", "createdAt": "2021-01-08T00:18:29Z", "commit": {"oid": "625ab13d9753c852176129a1ce887d4b501c7886"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQwMDoxODoyOVrOIQBOJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQwMDoxODoyOVrOIQBOJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzY2ODEzMg==", "bodyText": "add link to test case in ADO (can just copy from the non-clone test case)", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#discussion_r553668132", "createdAt": "2021-01-08T00:18:29Z", "author": {"login": "shahzaibj"}, "path": "msalautomationapp/src/androidTest/java/com/microsoft/identity/client/msal/automationapp/testpass/broker/TestCase796048Clone.java", "diffHunk": "@@ -0,0 +1,105 @@\n+package com.microsoft.identity.client.msal.automationapp.testpass.broker;\n+\n+import com.microsoft.identity.client.Prompt;\n+import com.microsoft.identity.client.msal.automationapp.R;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthResult;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalAuthTestParams;\n+import com.microsoft.identity.client.msal.automationapp.sdk.MsalSdk;\n+import com.microsoft.identity.client.ui.automation.TestContext;\n+import com.microsoft.identity.client.ui.automation.TokenRequestTimeout;\n+import com.microsoft.identity.client.ui.automation.interaction.OnInteractionRequired;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptHandlerParameters;\n+import com.microsoft.identity.client.ui.automation.interaction.PromptParameter;\n+import com.microsoft.identity.client.ui.automation.interaction.microsoftsts.AadPromptHandler;\n+import com.microsoft.identity.internal.testutils.labutils.LabConfig;\n+import com.microsoft.identity.internal.testutils.labutils.LabConstants;\n+import com.microsoft.identity.internal.testutils.labutils.LabUserQuery;\n+\n+import org.junit.Test;\n+\n+public class TestCase796048Clone extends AbstractMsalBrokerTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "625ab13d9753c852176129a1ce887d4b501c7886"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzOTIwOTA2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1264#pullrequestreview-563920906", "createdAt": "2021-01-08T00:20:57Z", "commit": {"oid": "625ab13d9753c852176129a1ce887d4b501c7886"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d76da022c9c04979e3a91c4e70bc10f54b02a05", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/5d76da022c9c04979e3a91c4e70bc10f54b02a05", "committedDate": "2021-01-08T09:49:32Z", "message": "add liscence and description of testcase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeca8935a20d560a934068ec4e2a453ad46f82a8", "author": {"user": {"login": "ayushmeghwani", "name": "Ayush Meghwani"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/eeca8935a20d560a934068ec4e2a453ad46f82a8", "committedDate": "2021-01-08T09:56:11Z", "message": "remove old and add new wrapper test cases"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1224, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}