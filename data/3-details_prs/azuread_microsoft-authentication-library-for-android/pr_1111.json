{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2Nzc2Mjcz", "number": 1111, "title": "Added showMsalRedirectUriInfo command and activity to MSAL", "bodyText": "Hi Folks,\nGiven the very large number of customers confused about how to register their redirect URI and configure it within MSAL.  I added an activity to MSAL that can be launched using a static method of PublicClientApplication called showMsalRedirectUriInfo.  This method shows the following information.\n@hamiltonha - Take a look if you want to change any strings.  Let's explore if we can replace current instructions with just invoking this method.", "createdAt": "2020-07-26T16:54:44Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111", "merged": true, "mergeCommit": {"oid": "75a564bc5bed6dfd6d81c3088fe41b63e81fcd68"}, "closed": true, "closedAt": "2020-07-27T19:57:28Z", "author": {"login": "shoatman"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4wJH7gH2gAyNDU2Nzc2MjczOmUwYjU3YzYzNTk4NTc3OWM0MDRjNGZmNWI2Yjg0Mjg4MjNjZmZlNWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5HKMTAFqTQ1NjA3OTE3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c", "author": {"user": {"login": "shoatman", "name": "Shane Oatman"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/e0b57c635985779c404c4ff5b6b8428823cffe5c", "committedDate": "2020-07-26T16:51:15Z", "message": "Added showMsalRedirectUriInfo command and activity to MSAL"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTE0NTk0", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455914594", "createdAt": "2020-07-27T15:53:49Z", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0OVrOG3ox2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0OVrOG3ox2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5Mjk4NQ==", "bodyText": "Needs javadoc.....Also should we rename this to something like showExpectedMsalRedirectUriInfo (to indicate that the redirect uri displayed here isn't the one they have already registered (in case they have) but rather the one that we actually expect)?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460992985", "createdAt": "2020-07-27T15:53:49Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1213,6 +1214,10 @@ public static String getSdkVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n+    public static void showMsalRedirectUriInfo(Activity activity){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTE1NTYz", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455915563", "createdAt": "2020-07-27T15:54:52Z", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NDo1MlrOG3o0sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NDo1MlrOG3o0sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MzcxNQ==", "bodyText": "Could add some javadoc here", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460993715", "createdAt": "2020-07-27T15:54:52Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODk3MTgy", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455897182", "createdAt": "2020-07-27T15:33:49Z", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozMzo1MFrOG3n9dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo0OTo1NlrOG3oncA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3OTU3Mg==", "bodyText": "nit: extra line.", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460979572", "createdAt": "2020-07-27T15:33:50Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r\n+\r\n+        return signature;\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MDExOA==", "bodyText": "nits: final parameter,- can this be a primitive?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460980118", "createdAt": "2020-07-27T15:34:39Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDM0OQ==", "bodyText": "I think we should be explicit here, since this is truly a \"can't happen\" case as UTF-8 has been folded into Java.  This isn't thrown for any random error encoding the string, it's thrown if the character set specified by name is not supported.  It's \"Character encoding \" + AuthenticationConstants.ENCODING_UTF8 + \" is not supported.\"  You could even use Lombok to @SneakyThrows an UnsupportedEncodingException, supposing that the upper layer can responsibly handle a \"WorldIsBrokenException\".", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460984349", "createdAt": "2020-07-27T15:40:53Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NDY2Nw==", "bodyText": "nit: extra lines?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460984667", "createdAt": "2020-07-27T15:41:26Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/res/layout/broker_helper.xml", "diffHunk": "@@ -0,0 +1,111 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n+    xmlns:tools=\"http://schemas.android.com/tools\"\r\n+    android:layout_width=\"match_parent\"\r\n+    android:layout_height=\"match_parent\">\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NTQzNQ==", "bodyText": "nit: extra lines", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460985435", "createdAt": "2020-07-27T15:42:37Z", "author": {"login": "AdamBJohnsonx"}, "path": "testapps/testapp/src/main/java/com/microsoft/identity/client/testapp/AcquireTokenFragment.java", "diffHunk": "@@ -118,6 +122,8 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe\n         mPopSection = view.findViewById(R.id.pop_section);\n         mLoginHintSection = view.findViewById(R.id.login_hint_section);\n \n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4NzgzNg==", "bodyText": "nit: extra lines?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460987836", "createdAt": "2020-07-27T15:46:14Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5MDMyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\n          \n          \n            \n                String mManifestTemplate = \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460990320", "createdAt": "2020-07-27T15:49:56Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTE2NTAz", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455916503", "createdAt": "2020-07-27T15:55:58Z", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NTo1OFrOG3o3lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NTo1OFrOG3o3lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NDQ1Mw==", "bodyText": "Could be private", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460994453", "createdAt": "2020-07-27T15:55:58Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTE4MDI3", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455918027", "createdAt": "2020-07-27T15:57:35Z", "commit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NzozNVrOG3o8Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1NzozNVrOG3o8Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NTYyMg==", "bodyText": "Do we also want to display an error on the BrokerHelperActivity when this happens? Looks like an empty string will be shown", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r460995622", "createdAt": "2020-07-27T15:57:35Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    String mManifestTemplate= \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+          return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(mManifestTemplate, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+\r\n+\r\n+    }\r\n+\r\n+    private String getSignature(Boolean urlEncode){\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if(urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            }else{\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Error encoding signature digest\", e);\r\n+        }\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0b57c635985779c404c4ff5b6b8428823cffe5c"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a", "author": {"user": {"login": "shoatman", "name": "Shane Oatman"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/45c5c9d54553fe88a58343a9ee1961032bd76a7a", "committedDate": "2020-07-27T17:23:37Z", "message": "Feedback comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTg3OTc2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455987976", "createdAt": "2020-07-27T17:26:56Z", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyNjo1NlrOG3sVIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyNjo1NlrOG3sVIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MTE3MA==", "bodyText": "may be shows instead of includes?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461051170", "createdAt": "2020-07-27T17:26:56Z", "author": {"login": "shahzaibj"}, "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplication.java", "diffHunk": "@@ -1213,6 +1214,14 @@ public static String getSdkVersion() {\n         return BuildConfig.VERSION_NAME;\n     }\n \n+    /**\n+     * Presents an activity that includes the package name, signature, redirect URI and manifest entry required for your application", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTg4NDQ5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455988449", "createdAt": "2020-07-27T17:27:32Z", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTkwMDI5", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455990029", "createdAt": "2020-07-27T17:29:31Z", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyOTozMVrOG3sbMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyOTozMVrOG3sbMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MjcyMg==", "bodyText": "should we not attach the causing exception?", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#discussion_r461052722", "createdAt": "2020-07-27T17:29:31Z", "author": {"login": "AdamBJohnsonx"}, "path": "msal/src/main/java/com/microsoft/identity/client/helper/BrokerHelperActivity.java", "diffHunk": "@@ -0,0 +1,81 @@\n+package com.microsoft.identity.client.helper;\r\n+\r\n+import android.app.Activity;\r\n+import android.content.Context;\r\n+import android.content.Intent;\r\n+import android.os.Bundle;\r\n+import android.util.Log;\r\n+import android.widget.TextView;\r\n+\r\n+import androidx.annotation.Nullable;\r\n+\r\n+import com.microsoft.identity.common.adal.internal.AuthenticationConstants;\r\n+import com.microsoft.identity.common.internal.broker.BrokerValidator;\r\n+import com.microsoft.identity.common.internal.broker.PackageHelper;\r\n+import com.microsoft.identity.msal.R;\r\n+\r\n+import java.io.UnsupportedEncodingException;\r\n+import java.net.URLEncoder;\r\n+\r\n+/**\r\n+ * Activity to show the expected redirect URL (which includes support for Broker)\r\n+ */\r\n+public class BrokerHelperActivity extends Activity {\r\n+\r\n+    private final String MANIFEST_TEMPLATE = \"<activity android:name=\\\"com.microsoft.identity.client.BrowserTabActivity\\\">\\n\" +\r\n+            \"    <intent-filter>\\n\" +\r\n+            \"        <action android:name=\\\"android.intent.action.VIEW\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.DEFAULT\\\" />\\n\" +\r\n+            \"        <category android:name=\\\"android.intent.category.BROWSABLE\\\" />\\n\" +\r\n+            \"        <data\\n\" +\r\n+            \"            android:host=\\\"%s\\\"\\n\" +\r\n+            \"            android:path=\\\"%s\\\"\\n\" +\r\n+            \"            android:scheme=\\\"msauth\\\" />\\n\" +\r\n+            \"    </intent-filter>\\n\" +\r\n+            \"</activity>\";\r\n+    TextView mPackageName;\r\n+    TextView mSignature;\r\n+    TextView mRedirect;\r\n+    TextView mManifest;\r\n+\r\n+    public static Intent createStartIntent(final Context context) {\r\n+        final Intent intent = new Intent(context, BrokerHelperActivity.class);\r\n+        return intent;\r\n+    }\r\n+\r\n+    @Override\r\n+    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n+        super.onCreate(savedInstanceState);\r\n+        setContentView(R.layout.broker_helper);\r\n+\r\n+        mPackageName = findViewById(R.id.txtPackageName);\r\n+        mSignature = findViewById(R.id.txtSignature);\r\n+        mRedirect = findViewById(R.id.txtRedirect);\r\n+        mManifest = findViewById(R.id.txtManifest);\r\n+\r\n+        mSignature.append(getSignature(false));\r\n+        mRedirect.append(BrokerValidator.getBrokerRedirectUri(this.getApplicationContext(), this.getPackageName()));\r\n+        mManifest.append(String.format(MANIFEST_TEMPLATE, this.getPackageName(), getSignature(false)));\r\n+        mPackageName.append(this.getPackageName());\r\n+    }\r\n+\r\n+    private String getSignature(final boolean urlEncode) {\r\n+\r\n+        final PackageHelper info = new PackageHelper(this.getApplicationContext().getPackageManager());\r\n+        final String signatureDigest = info.getCurrentSignatureForPackage(this.getPackageName());\r\n+        String signature = \"\";\r\n+\r\n+        try {\r\n+            if (urlEncode) {\r\n+                signature = URLEncoder.encode(signatureDigest, AuthenticationConstants.ENCODING_UTF8);\r\n+            } else {\r\n+                signature = signatureDigest;\r\n+            }\r\n+        } catch (UnsupportedEncodingException e) {\r\n+            Log.e(\"getSignature\", \"Character encoding \" + AuthenticationConstants.ENCODING_UTF8 + \" is not supported.\", e);\r\n+            throw new RuntimeException(\"Unexpected: Unable to get the signature for this application package.\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTk5OTUw", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-455999950", "createdAt": "2020-07-27T17:43:24Z", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDc5MTc0", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1111#pullrequestreview-456079174", "createdAt": "2020-07-27T19:40:14Z", "commit": {"oid": "45c5c9d54553fe88a58343a9ee1961032bd76a7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1237, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}