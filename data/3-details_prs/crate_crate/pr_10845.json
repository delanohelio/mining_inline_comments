{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTEzNDM3", "number": 10845, "title": "Fix handling of spaces in `$CRATE_HOME`", "bodyText": "Included changes:\n\n\nDrops the unnecessary and potentially misleading hashbang from crate.in.sh\nbecause the file is meant to be sourced not executed.\n\n\nPuts $CRATE_HOME in double quotes when used in a for loop. This prevents sh\nfrom interpreting a space in this variable as an item terminator.\n\n\nWraps ${LOGGC} in nested double quotes. This prevents sh from interpreting\na space in this variable as an argument terminator when used in $JAVA_OPTS.\n\n\nSets -e on the bin/crate hashbang, ensuring the script exits immediately\nif an error is encountered. This prevents cascading errors.\n\n\nWraps the variables passed to exec in two sets of double quotes. This\npreserves one set of double quotes in the subcommand being executed, which is\nnecessary for paths with a space in them.\n\n\nSummary of the changes / Why this improves CrateDB\nright now, if you follow https://crate.io/docs/crate/tutorials/en/latest/install-run/macos.html with pwd that includes spaces (e.g., /Users/foo/Crate Sandbox), the user will experience cascading errors when the try script attempts to execute bin/crate\ncrate-4.3.2/bin/crate: line 129: /Users/foo/Crate: No such file or directory\ncrate-4.3.2/bin/crate: line 129: exec: /Users/foo/Crate: cannot execute: No such file or directory\n\nrunning bin/crate manually produces the same result\nthe changes in this commit fix this issue on my local computer. I'm not sure if the changes will work on Windows, but am hoping the CI checks will tell me that :D\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-12-02T15:54:06Z", "url": "https://github.com/crate/crate/pull/10845", "merged": true, "mergeCommit": {"oid": "3a578e445f22e924a6c000d0746a6bf3feb52231"}, "closed": true, "closedAt": "2020-12-09T17:44:37Z", "author": {"login": "norosa"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiV5hpABqjQwNjQ1NzI2MDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkh7p0AH2gAyNTMxMTEzNDM3OmViM2Y3ZjAxNmIzOGM0ZDUzMjc3OWNmYjIyZjVjNWFmMWQyNDlhNDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dfccc812c1c95b27ce1aed411c552e436f44de54", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/dfccc812c1c95b27ce1aed411c552e436f44de54", "committedDate": "2020-12-02T15:52:02Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps every file name added to `$CRATE_CLASSPATH` in double quotes (cf.\n  <https://stackoverflow.com/a/3003908>) and subsequently removes the (now\n  unnecessary) double quotes used to pass `$CRATE_CLASSPATH` as an argument.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wrap the arguments passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}, "afterCommit": {"oid": "06681845a687c302bfcdadee443b40e90a965b17", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/06681845a687c302bfcdadee443b40e90a965b17", "committedDate": "2020-12-02T22:01:15Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps every file name added to `$CRATE_CLASSPATH` in double quotes (cf.\n  <https://stackoverflow.com/a/3003908>) and subsequently removes the (now\n  unnecessary) double quotes used to pass `$CRATE_CLASSPATH` as an argument.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wrap the arguments passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzNzQxNjQx", "url": "https://github.com/crate/crate/pull/10845#pullrequestreview-543741641", "createdAt": "2020-12-03T09:10:24Z", "commit": {"oid": "06681845a687c302bfcdadee443b40e90a965b17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwOToxMDoyNVrOH-Muig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwOToxMDoyNVrOH-Muig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDk4MjI4Mg==", "bodyText": "We usually try to include a symptom that users may have seen when running into the fixed issue.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - Fixed handling of spaces in `$CRATE_HOME`.\n          \n          \n            \n            - Fixed handling of spaces in `$CRATE_HOME`. Users would get a `No such file or directory` error if the path set via `$CRATE_HOME` contained spaces.", "url": "https://github.com/crate/crate/pull/10845#discussion_r534982282", "createdAt": "2020-12-03T09:10:25Z", "author": {"login": "mfussenegger"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -94,3 +94,5 @@ Fixes\n \n - Fixed a regression introduced in CrateDB ``4.0`` preventing the global setting\n   ``cluster.info.update.interval`` to be changed.\n+\n+- Fixed handling of spaces in `$CRATE_HOME`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06681845a687c302bfcdadee443b40e90a965b17"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abc88effa4831b77a6507b835df71dc82df76145", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/abc88effa4831b77a6507b835df71dc82df76145", "committedDate": "2020-12-07T17:10:12Z", "message": "fixup! Fix handling of spaces in `$CRATE_HOME`"}, "afterCommit": {"oid": "6b08309a2f41ea2f241339d8627db81f0912d843", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/6b08309a2f41ea2f241339d8627db81f0912d843", "committedDate": "2020-12-07T17:58:10Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wrap the variables passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b08309a2f41ea2f241339d8627db81f0912d843", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/6b08309a2f41ea2f241339d8627db81f0912d843", "committedDate": "2020-12-07T17:58:10Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wrap the variables passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}, "afterCommit": {"oid": "1e675c6155404a98246fd45d17bc131bea804759", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/1e675c6155404a98246fd45d17bc131bea804759", "committedDate": "2020-12-07T17:58:56Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wraps the variables passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b7a3239969073b02b25eec4a94162ffb4a37bd", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/b1b7a3239969073b02b25eec4a94162ffb4a37bd", "committedDate": "2020-12-07T17:59:36Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wraps the variables passed to `exec` in two sets of double quotes. This\n  preserves one set of double quotes in the subcommand being executed, which is\n  necessary for paths with a space in them."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1e675c6155404a98246fd45d17bc131bea804759", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/1e675c6155404a98246fd45d17bc131bea804759", "committedDate": "2020-12-07T17:58:56Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wraps the variables passed to `exec` in double quotes. This preserves the use\n  of double quotes in the subcommand being executed."}, "afterCommit": {"oid": "b1b7a3239969073b02b25eec4a94162ffb4a37bd", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/b1b7a3239969073b02b25eec4a94162ffb4a37bd", "committedDate": "2020-12-07T17:59:36Z", "message": "Fix handling of spaces in `$CRATE_HOME`\n\nIncluded changes:\n\n- Drops the unnecessary and potentially misleading hashbang from `crate.in.sh`\n  because the file is meant to be sourced not executed.\n\n- Puts `$CRATE_HOME` in double quotes when used in a for loop. This prevents sh\n  from interpreting a space in this variable as an item terminator.\n\n- Wraps `${LOGGC}` in nested double quotes. This prevents sh from interpreting\n  a space in this variable as an argument terminator when used in `$JAVA_OPTS`.\n\n- Sets `-e` on the `bin/crate` hashbang, ensuring the script exits immediately\n  if an error is encountered. This prevents cascading errors.\n\n- Wraps the variables passed to `exec` in two sets of double quotes. This\n  preserves one set of double quotes in the subcommand being executed, which is\n  necessary for paths with a space in them."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3OTQ3ODQ3", "url": "https://github.com/crate/crate/pull/10845#pullrequestreview-547947847", "createdAt": "2020-12-09T08:36:36Z", "commit": {"oid": "b1b7a3239969073b02b25eec4a94162ffb4a37bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e563d03f5f3546f9b5b738299b697808f875065b", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/e563d03f5f3546f9b5b738299b697808f875065b", "committedDate": "2020-12-09T15:18:49Z", "message": "Merge branch 'master' into nomi/crate_home"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb3f7f016b38c4d532779cfb22f5c5af1d249a40", "author": {"user": {"login": "norosa", "name": "Naomi Rose"}}, "url": "https://github.com/crate/crate/commit/eb3f7f016b38c4d532779cfb22f5c5af1d249a40", "committedDate": "2020-12-09T17:10:32Z", "message": "Merge branch 'master' into nomi/crate_home"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3682, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}