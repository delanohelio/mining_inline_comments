{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNDc0MzYz", "number": 9798, "title": "Add an assertion to limit allocated bytes for current thread", "bodyText": "Checklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-03-25T09:22:57Z", "url": "https://github.com/crate/crate/pull/9798", "merged": true, "mergeCommit": {"oid": "9ebcc9597c24190e00fa38e4286cc3f9ecf9ecc5"}, "closed": true, "closedAt": "2020-03-25T13:46:43Z", "author": {"login": "mfussenegger"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcREV5eAFqTM4MDk5MDA3OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRHXFugFqTM4MTEzNTUyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwOTkwMDc5", "url": "https://github.com/crate/crate/pull/9798#pullrequestreview-380990079", "createdAt": "2020-03-25T09:44:20Z", "commit": {"oid": "4f3f5d6d2650d7de84f5c587e6b7b77fe114dbc6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwOTo0NDoyMFrOF7TEMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwOTo0NDoyMFrOF7TEMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcyMjY3NQ==", "bodyText": "Why is this limited to 8MB?", "url": "https://github.com/crate/crate/pull/9798#discussion_r397722675", "createdAt": "2020-03-25T09:44:20Z", "author": {"login": "seut"}, "path": "sql/src/test/java/io/crate/planner/operators/LogicalPlannerTest.java", "diffHunk": "@@ -60,16 +56,17 @@\n \n     @Before\n     public void prepare() throws IOException {\n+        tableStats = new TableStats();\n         sqlExecutor = SQLExecutor.builder(clusterService)\n             .enableDefaultTables()\n+            .setTableStats(tableStats)\n             .addView(new RelationName(\"doc\", \"v2\"), \"select a, x from doc.t1\")\n             .addView(new RelationName(\"doc\", \"v3\"), \"select a, x from doc.t1\")\n             .build();\n-        tableStats = new TableStats();\n     }\n \n     private LogicalPlan plan(String statement) {\n-        return plan(statement, sqlExecutor, clusterService, tableStats);\n+        return withMemoryLimit(ByteSizeUnit.MB.toBytes(8), () -> sqlExecutor.logicalPlan(statement));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f3f5d6d2650d7de84f5c587e6b7b77fe114dbc6"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6675a3ba852c02c2c4b84709648fd2b80ddd9d60", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/6675a3ba852c02c2c4b84709648fd2b80ddd9d60", "committedDate": "2020-03-25T13:02:20Z", "message": "Add an assertion to limit allocated bytes for current thread"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f3f5d6d2650d7de84f5c587e6b7b77fe114dbc6", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/4f3f5d6d2650d7de84f5c587e6b7b77fe114dbc6", "committedDate": "2020-03-25T09:22:06Z", "message": "Add an assertion to limit allocated bytes for current thread"}, "afterCommit": {"oid": "6675a3ba852c02c2c4b84709648fd2b80ddd9d60", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/6675a3ba852c02c2c4b84709648fd2b80ddd9d60", "committedDate": "2020-03-25T13:02:20Z", "message": "Add an assertion to limit allocated bytes for current thread"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMTM1NTI1", "url": "https://github.com/crate/crate/pull/9798#pullrequestreview-381135525", "createdAt": "2020-03-25T13:17:21Z", "commit": {"oid": "6675a3ba852c02c2c4b84709648fd2b80ddd9d60"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3446, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}