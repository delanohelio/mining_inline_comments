{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NDExMTgw", "number": 10200, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjowOTo0M1rOEgW6LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNTowMjo0N1rOEg97Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzY1MjI4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjowOTo0M1rOHNLGbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjowOTo0M1rOHNLGbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU3NTQwNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                                  \"Unable verify repository, [\" + metadata.name() + \"]\" +\n          \n          \n            \n                                                                  \"Unable to verify the repository, [\" + metadata.name() + \"]\" +", "url": "https://github.com/crate/crate/pull/10200#discussion_r483575404", "createdAt": "2020-09-04T12:09:43Z", "author": {"login": "seut"}, "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "diffHunk": "@@ -790,8 +790,11 @@ public String startVerification() {\n                 }\n                 return seed;\n             }\n-        } catch (IOException exp) {\n-            throw new RepositoryVerificationException(metadata.name(), \"path \" + basePath() + \" is not accessible on master node\", exp);\n+        } catch (Exception exp) {\n+            throw new RepositoryVerificationException(metadata.name(),\n+                                                      \"Unable verify repository, [\" + metadata.name() + \"]\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03390c1fcd918308e4b3e63ffe79cd1c1a4192d"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzY1ODcxOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoxMTozOVrOHNLKIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoxMTozOVrOHNLKIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU3NjM1Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                                  \" is not accessible on master node\",\n          \n          \n            \n                                                                  \" is not accessible on the master node\",", "url": "https://github.com/crate/crate/pull/10200#discussion_r483576353", "createdAt": "2020-09-04T12:11:39Z", "author": {"login": "seut"}, "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "diffHunk": "@@ -790,8 +790,11 @@ public String startVerification() {\n                 }\n                 return seed;\n             }\n-        } catch (IOException exp) {\n-            throw new RepositoryVerificationException(metadata.name(), \"path \" + basePath() + \" is not accessible on master node\", exp);\n+        } catch (Exception exp) {\n+            throw new RepositoryVerificationException(metadata.name(),\n+                                                      \"Unable verify repository, [\" + metadata.name() + \"]\" +\n+                                                      \" is not accessible on master node\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03390c1fcd918308e4b3e63ffe79cd1c1a4192d"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzY2OTM1OnYy", "diffSide": "RIGHT", "path": "docs/appendices/release-notes/unreleased.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoxNToxN1rOHNLQnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoxNToxN1rOHNLQnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU3ODAxMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - Changed the error message for failed repository creation, adding additional\n          \n          \n            \n              information of the underlying failure to make it easier to understand the\n          \n          \n            \n              root cause from the client side.\n          \n          \n            \n            - Added detailed information to possible errors on ``repository`` creation to\n          \n          \n            \n              give better insights in the root cause of the error.", "url": "https://github.com/crate/crate/pull/10200#discussion_r483578013", "createdAt": "2020-09-04T12:15:17Z", "author": {"login": "seut"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -56,6 +56,10 @@ Breaking Changes\n Changes\n =======\n \n+- Changed the error message for failed repository creation, adding additional\n+  information of the underlying failure to make it easier to understand the\n+  root cause from the client side.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb7b93309d6099c168f19e2a63b41922380dca69"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzc2MDcyOnYy", "diffSide": "RIGHT", "path": "docs/appendices/release-notes/unreleased.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjo0NToyNFrOHNMIDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNDozOTo0NVrOHNQGKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU5MjIwNQ==", "bodyText": "sorry my fault, I think it should be:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              give better insights in the root cause of the error.\n          \n          \n            \n              give better insights on the root cause of the error.", "url": "https://github.com/crate/crate/pull/10200#discussion_r483592205", "createdAt": "2020-09-04T12:45:24Z", "author": {"login": "seut"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -56,6 +56,9 @@ Breaking Changes\n Changes\n =======\n \n+- Added detailed information to possible errors on ``repository`` creation to\n+  give better insights in the root cause of the error.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956eea718f10ed47a3729d32d1a2a9b995810fa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NzI1Nw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/crate/crate/pull/10200#discussion_r483657257", "createdAt": "2020-09-04T14:39:45Z", "author": {"login": "mkleen"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -56,6 +56,9 @@ Breaking Changes\n Changes\n =======\n \n+- Added detailed information to possible errors on ``repository`` creation to\n+  give better insights in the root cause of the error.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU5MjIwNQ=="}, "originalCommit": {"oid": "5956eea718f10ed47a3729d32d1a2a9b995810fa"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMDAxMzg0OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNDo1Mjo0M1rOHOCKJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNDo1Mjo0M1rOHOCKJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ3NzQ3OA==", "bodyText": "This seems strange on the first view. The problem with propagating the underlying exception and handling the message creation later is, that the root cause might end up in a NotSerializableExceptionWrapper if it is not serializable across nodes and then the error message will differ whenever it was wrapped or not. This can cause flakiness depending on the cluster setup of the test. Now the error message is created before the exception is further propagated. If you have a better idea how to handle that let me know.", "url": "https://github.com/crate/crate/pull/10200#discussion_r484477478", "createdAt": "2020-09-07T14:52:43Z", "author": {"login": "mkleen"}, "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "diffHunk": "@@ -790,8 +791,10 @@ public String startVerification() {\n                 }\n                 return seed;\n             }\n-        } catch (IOException exp) {\n-            throw new RepositoryVerificationException(metadata.name(), \"path \" + basePath() + \" is not accessible on master node\", exp);\n+        } catch (Exception e) {\n+            throw new RepositoryVerificationException(metadata.name(),\n+                        String.format(Locale.ENGLISH, \"Unable to verify the repository, [%s] is not accessible on master node: %s '%s'\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c743e3410c2e9990a7fa8745e4c391561e55c6c"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMDA0NTExOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNTowMjo0N1rOHOCdFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNTowMjo0N1rOHOCdFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ4MjMyNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    String.format(Locale.ENGLISH, \"Unable to verify the repository, [%s] is not accessible on master node: %s '%s'\",\n          \n          \n            \n                                                  metadata.name(), e.getCause().getClass().getSimpleName(), e.getCause().getMessage()));\n          \n          \n            \n                                    String.format(Locale.ENGLISH,\n          \n          \n            \n                                                 \"Unable to verify the repository, it is not accessible on the master node: %s '%s'\",\n          \n          \n            \n                                                 e.getCause().getClass().getSimpleName(),\n          \n          \n            \n                                                 e.getCause().getMessage()));", "url": "https://github.com/crate/crate/pull/10200#discussion_r484482325", "createdAt": "2020-09-07T15:02:47Z", "author": {"login": "seut"}, "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "diffHunk": "@@ -790,8 +791,10 @@ public String startVerification() {\n                 }\n                 return seed;\n             }\n-        } catch (IOException exp) {\n-            throw new RepositoryVerificationException(metadata.name(), \"path \" + basePath() + \" is not accessible on master node\", exp);\n+        } catch (Exception e) {\n+            throw new RepositoryVerificationException(metadata.name(),\n+                        String.format(Locale.ENGLISH, \"Unable to verify the repository, [%s] is not accessible on master node: %s '%s'\",\n+                                      metadata.name(), e.getCause().getClass().getSimpleName(), e.getCause().getMessage()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c743e3410c2e9990a7fa8745e4c391561e55c6c"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1332, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}