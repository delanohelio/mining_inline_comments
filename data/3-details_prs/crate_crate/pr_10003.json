{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzMzAwMTIy", "number": 10003, "title": "Remove the cast function per data type mapping.", "bodyText": "Summary of the changes / Why this improves CrateDB\nCurrently, we maintained the cast function per data type mapping.\nThe name of the target data type is part of the cast function name,\nit looks as following to_<type> or for the try cast try_<type>.\nEach cast function has the following signature:\n`try_<target_type>(source_type, target_type):target_type`\n\nor\n`to_<target_type>(source_type, target_type):target_type`\n\nthat obviously duplicates information about the target type.\nThis commit replaces the cast function per data type mapping with\nthe two cast function with the following signatures:\n`cast(source_type, target_type):target_type`\n`try_cast(source_type, target_type):target_type`\n\ninstead of ~70 registered cast functions.\nThis is a backwards-compatible change. The cast functions were never\nstored in the metadata with names under which they were registered,\ne.g. to_bigint, etc. The symbol printer was always converting them\ninto the following format:\n`cast(source as target_type)`\n\nor\n`try_cast(source as target_type)`\n\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-05-26T16:01:18Z", "url": "https://github.com/crate/crate/pull/10003", "merged": true, "mergeCommit": {"oid": "8ab3144a4788f31a551c56bde0257765b46e3940"}, "closed": true, "closedAt": "2020-05-27T11:49:30Z", "author": {"login": "kovrus"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclLpiEAFqTQxODY5NjQ1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclXkq4gFqTQxOTEwMDMzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4Njk2NDUz", "url": "https://github.com/crate/crate/pull/10003#pullrequestreview-418696453", "createdAt": "2020-05-26T21:35:36Z", "commit": {"oid": "8eda863b2df7fe7f08aa845951b44f7c59dccea3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4OTExODEy", "url": "https://github.com/crate/crate/pull/10003#pullrequestreview-418911812", "createdAt": "2020-05-27T07:08:58Z", "commit": {"oid": "8eda863b2df7fe7f08aa845951b44f7c59dccea3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNzowODo1OVrOGa8HkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNzowODo1OVrOGa8HkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkwMTEzNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void test_cast_int_to_bigint() {\n          \n          \n            \n                public void test_cast_literal_return_function() {\n          \n      \n    \n    \n  \n\nPreviously this test asserted the already removed special Literal.cast logic.\nI've kept it to assert the opposite, ensuring that no special literal cast logic exist.\nNot sure if we should keep it but I'd suggest a different name expressing the current intention.", "url": "https://github.com/crate/crate/pull/10003#discussion_r430901137", "createdAt": "2020-05-27T07:08:59Z", "author": {"login": "seut"}, "path": "server/src/test/java/io/crate/expression/symbol/LiteralTest.java", "diffHunk": "@@ -111,8 +110,14 @@ public void testCompareNestedArrayValues() throws Exception {\n     }\n \n     @Test\n-    public void testCasting() {\n+    public void test_cast_int_to_bigint() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8eda863b2df7fe7f08aa845951b44f7c59dccea3"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8f3aaac243d74f3c37d5d0976ed94ce90546704", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/b8f3aaac243d74f3c37d5d0976ed94ce90546704", "committedDate": "2020-05-27T09:47:42Z", "message": "fixup! Remove the cast function per data type mapping."}, "afterCommit": {"oid": "ae25dbe1faffb4b388cb762e04224d7e36d4f49b", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/ae25dbe1faffb4b388cb762e04224d7e36d4f49b", "committedDate": "2020-05-27T09:48:18Z", "message": "fixup! Remove the cast function per data type mapping."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae25dbe1faffb4b388cb762e04224d7e36d4f49b", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/ae25dbe1faffb4b388cb762e04224d7e36d4f49b", "committedDate": "2020-05-27T09:48:18Z", "message": "fixup! Remove the cast function per data type mapping."}, "afterCommit": {"oid": "5f04f7e57a7c071bc8d7c5ba543b7fa9a0f7e419", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/5f04f7e57a7c071bc8d7c5ba543b7fa9a0f7e419", "committedDate": "2020-05-27T09:53:29Z", "message": "fixup! Remove the cast function per data type mapping."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86f2ab3b6b16d3b65e13c871b25ab30273b5286f", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/86f2ab3b6b16d3b65e13c871b25ab30273b5286f", "committedDate": "2020-05-27T11:13:54Z", "message": "Remove the cast function per data type mapping.\n\nCurrently, we maintained the cast function per data type mapping.\nThe name of the target data type is part of the cast function name,\nit looks as following `to_<type>` or for the try cast `try_<type>`.\nEach cast function has the following signatures:\n\n    `try_<target_type>(source_type, target_type):target_type`\nor\n    `to_<target_type>(source_type, target_type):target_type`\n\nthat obviously duplicates information about the target type.\n\nThis commit replaces the cast function per data type mapping with\nthe two cast function with the following signatures:\n\n    `cast(source_type, target_type):target_type`\n    `try_cast(source_type, target_type):target_type`\n\ninstead of ~70 registered per data type cast functions.\n\nThis is a backwards-compatible change. The cast functions were never\nstored in the metadata with names under which they were registered.\ne.g. `to_bigint`, etc. The symbol printer was always converting them\ninto the following format:\n\n    `cast(source as target_type)`.\nor\n    `try_cast(source as target_type)`."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f04f7e57a7c071bc8d7c5ba543b7fa9a0f7e419", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/5f04f7e57a7c071bc8d7c5ba543b7fa9a0f7e419", "committedDate": "2020-05-27T09:53:29Z", "message": "fixup! Remove the cast function per data type mapping."}, "afterCommit": {"oid": "86f2ab3b6b16d3b65e13c871b25ab30273b5286f", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/86f2ab3b6b16d3b65e13c871b25ab30273b5286f", "committedDate": "2020-05-27T11:13:54Z", "message": "Remove the cast function per data type mapping.\n\nCurrently, we maintained the cast function per data type mapping.\nThe name of the target data type is part of the cast function name,\nit looks as following `to_<type>` or for the try cast `try_<type>`.\nEach cast function has the following signatures:\n\n    `try_<target_type>(source_type, target_type):target_type`\nor\n    `to_<target_type>(source_type, target_type):target_type`\n\nthat obviously duplicates information about the target type.\n\nThis commit replaces the cast function per data type mapping with\nthe two cast function with the following signatures:\n\n    `cast(source_type, target_type):target_type`\n    `try_cast(source_type, target_type):target_type`\n\ninstead of ~70 registered per data type cast functions.\n\nThis is a backwards-compatible change. The cast functions were never\nstored in the metadata with names under which they were registered.\ne.g. `to_bigint`, etc. The symbol printer was always converting them\ninto the following format:\n\n    `cast(source as target_type)`.\nor\n    `try_cast(source as target_type)`."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MTAwMzM3", "url": "https://github.com/crate/crate/pull/10003#pullrequestreview-419100337", "createdAt": "2020-05-27T11:29:09Z", "commit": {"oid": "86f2ab3b6b16d3b65e13c871b25ab30273b5286f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3213, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}