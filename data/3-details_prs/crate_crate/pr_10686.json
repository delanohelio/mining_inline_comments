{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3NTIwMzI2", "number": 10686, "title": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.", "bodyText": "Summary of the changes / Why this improves CrateDB\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\nCREATE TABLE t (obj OBJECT(DYNAMIC));\nINSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\nSELECT obj['k'] FROM t;\n\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-10-21T13:03:40Z", "url": "https://github.com/crate/crate/pull/10686", "merged": true, "mergeCommit": {"oid": "16dc3833948b46d0217b4ce7d413806e130e180a"}, "closed": true, "closedAt": "2020-10-21T14:16:54Z", "author": {"login": "kovrus"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUtY09ABqjM5MDM4ODUzNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUtrt8ABqjM5MDQwMDg5ODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c81acfc8fedeeca128b25466d060593a8bc37b2", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/9c81acfc8fedeeca128b25466d060593a8bc37b2", "committedDate": "2020-10-21T13:02:35Z", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;"}, "afterCommit": {"oid": "c1b4219b761386cf7259fd282396cfc1926a4c1f", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/c1b4219b761386cf7259fd282396cfc1926a4c1f", "committedDate": "2020-10-21T13:28:11Z", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNjk3MjA1", "url": "https://github.com/crate/crate/pull/10686#pullrequestreview-513697205", "createdAt": "2020-10-21T13:42:30Z", "commit": {"oid": "c1b4219b761386cf7259fd282396cfc1926a4c1f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzo0MjozMFrOHls05w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzo0MjozMFrOHls05w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5Mzc5OQ==", "bodyText": "Maybe this could be rephrased to convey the user perspective a bit better. Something like this?\n\nFixed an issue that caused an error when a client using the PostgreSQL wire protocol is used to retrieve array values containing a escaped double quotes. For example, the JDBC client failed with Can't extract array data from JDBC array.\n\nNot sure if it's an improvement.", "url": "https://github.com/crate/crate/pull/10686#discussion_r509293799", "createdAt": "2020-10-21T13:42:30Z", "author": {"login": "mfussenegger"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -58,4 +58,5 @@ None\n Fixes\n =====\n \n-None\n+- Fixed encoding string array type values that contain escaped double\n+  quotes. The issue occurred when using the PostgreSQL wire protocol.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1b4219b761386cf7259fd282396cfc1926a4c1f"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "committedDate": "2020-10-21T13:49:03Z", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1b4219b761386cf7259fd282396cfc1926a4c1f", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/c1b4219b761386cf7259fd282396cfc1926a4c1f", "committedDate": "2020-10-21T13:28:11Z", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;"}, "afterCommit": {"oid": "9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "committedDate": "2020-10-21T13:49:03Z", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3718, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}