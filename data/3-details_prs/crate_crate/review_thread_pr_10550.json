{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MDUwMjE3", "number": 10550, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozODoxNlrOEkbc7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1Nzo0MVrOEkb87g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjMzOTY3OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozODoxNlrOHTXjsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozODoxNlrOHTXjsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MDk2MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Set the session and the current user of the current session.\n          \n          \n            \n            Set the user of the current session.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490070961", "createdAt": "2020-09-17T08:38:16Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0MjExOnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozODo1MlrOHTXlNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozODo1MlrOHTXlNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTM1MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            These statements set or reset the session and current user of the current\n          \n          \n            \n            These statements set or reset the user of the", "url": "https://github.com/crate/crate/pull/10550#discussion_r490071350", "createdAt": "2020-09-17T08:38:52Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0NTEzOnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTozMVrOHTXnAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTozMVrOHTXnAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTgxMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            session to the given or the initial session / authenticated user.\n          \n          \n            \n            session to the given or revert the user back to the original authenticated user.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490071810", "createdAt": "2020-09-17T08:39:31Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0NjI3OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTo0OFrOHTXnrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTo0OFrOHTXnrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MTk4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The session user can be changed only if the initial session / authenticated\n          \n          \n            \n            The session user can be changed only if the initial authenticated", "url": "https://github.com/crate/crate/pull/10550#discussion_r490071981", "createdAt": "2020-09-17T08:39:48Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.\n+\n+The session user can be changed only if the initial session / authenticated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0NjgwOnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTo1OFrOHTXoCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODozOTo1OFrOHTXoCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MjA3Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            user had the superuser privileges.  Otherwise, the statement is accepted only\n          \n          \n            \n            user had superuser privileges.  Otherwise, the statement is only accepted", "url": "https://github.com/crate/crate/pull/10550#discussion_r490072072", "createdAt": "2020-09-17T08:39:58Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.\n+\n+The session user can be changed only if the initial session / authenticated\n+user had the superuser privileges.  Otherwise, the statement is accepted only", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM0OTk2OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0MDo0MFrOHTXqCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0MDo0MFrOHTXqCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3MjU4NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if it specifies the originally authenticated user.\n          \n          \n            \n            if the specified username matches the originally authenticated user.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490072585", "createdAt": "2020-09-17T08:40:40Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.\n+\n+The session user can be changed only if the initial session / authenticated\n+user had the superuser privileges.  Otherwise, the statement is accepted only\n+if it specifies the originally authenticated user.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d4a5d1d5d809ffc3ea154f8de2bbfe59e3769af"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM2NDM2OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0NDoyOVrOHTXzGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0NDoyOVrOHTXzGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3NDkwNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Using this statement, it is possible to temporarily become an unprivileged\n          \n          \n            \n            user and later switch back to a superuser. In this case, the superuser must\n          \n          \n            \n            be the initial session / authenticated user. It can be achieved by providing\n          \n          \n            \n            the originally authenticated user name or the ``DEFAULT`` identifier.\n          \n          \n            \n            Using this statement, a superuser can temporarily become an unprivileged\n          \n          \n            \n            user and later switch back to a superuser. The supseruser would switch using ``SET SESSION AUTHORIZATION '<impersonating_user>'`` to drop privileges and become `impersonating_user`. Later the original privileges can be restored using ``SET SESSION AUTHORIZATION <real_username>`` or ``SET SESSION AUTHORIZATION DEFAULT``.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490074906", "createdAt": "2020-09-17T08:44:29Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.\n+\n+The session user can be changed only if the initial session / authenticated\n+user had the superuser privileges.  Otherwise, the statement is accepted only\n+if it specifies the originally authenticated user.\n+\n+Using this statement, it is possible to temporarily become an unprivileged\n+user and later switch back to a superuser. In this case, the superuser must\n+be the initial session / authenticated user. It can be achieved by providing\n+the originally authenticated user name or the ``DEFAULT`` identifier.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjM3MjY3OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/set-session-authorization.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0NjozMlrOHTX4Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo0NjozMlrOHTX4Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3NjE5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ``SET`` and ``SET SESSION`` may affect the current session.\n          \n      \n    \n    \n  \n\nI think this is already clear from the previous paragraphs.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490076199", "createdAt": "2020-09-17T08:46:32Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/set-session-authorization.rst", "diffHunk": "@@ -0,0 +1,54 @@\n+.. highlight:: psql\n+.. _ref-set-session-authorization:\n+\n+=======================================\n+``SET AND RESET SESSION AUTHORIZATION``\n+=======================================\n+\n+Set the session and the current user of the current session.\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+\n+Synopsis\n+========\n+\n+::\n+\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION username\n+    SET [ SESSION | LOCAL ] SESSION AUTHORIZATION DEFAULT\n+    RESET SESSION AUTHORIZATION\n+\n+Description\n+===========\n+\n+These statements set or reset the session and current user of the current\n+session to the given or the initial session / authenticated user.\n+\n+The session user can be changed only if the initial session / authenticated\n+user had the superuser privileges.  Otherwise, the statement is accepted only\n+if it specifies the originally authenticated user.\n+\n+Using this statement, it is possible to temporarily become an unprivileged\n+user and later switch back to a superuser. In this case, the superuser must\n+be the initial session / authenticated user. It can be achieved by providing\n+the originally authenticated user name or the ``DEFAULT`` identifier.\n+\n+``SET LOCAL`` does not have any effect on session. All ``SET LOCAL`` statements\n+will be ignored by CrateDB and logged with the ``INFO`` logging level.\n+\n+``SET`` and ``SET SESSION`` may affect the current session.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjQwOTcxOnYy", "diffSide": "RIGHT", "path": "libs/sql-parser/src/main/java/io/crate/sql/parser/AstBuilder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1NTowNlrOHTYOLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1NTowNlrOHTYOLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MTgzNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        var userName = ((StringLiteral) visit(context.username)).getValue();\n          \n          \n            \n                        var userLiteral = visit(context.username);\n          \n          \n            \n                        assert userLiteral instanceof StringLiteral\n          \n          \n            \n                            : \"username must be a StringLiteral because the parser grammar is restricted to string literals\";\n          \n          \n            \n                        var userName = ((StringLiteral) userLiteral).getValue();\n          \n      \n    \n    \n  \n\nJust a suggestion to make the contract between AstBuilder and parser grammar more explicit.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490081837", "createdAt": "2020-09-17T08:55:06Z", "author": {"login": "mfussenegger"}, "path": "libs/sql-parser/src/main/java/io/crate/sql/parser/AstBuilder.java", "diffHunk": "@@ -730,6 +730,28 @@ public Node visitResetGlobal(SqlBaseParser.ResetGlobalContext context) {\n         return new ResetStatement<>(visitCollection(context.primaryExpression(), Expression.class));\n     }\n \n+    @Override\n+    public Node visitSetSessionAuthorization(SqlBaseParser.SetSessionAuthorizationContext context) {\n+        SetSessionAuthorizationStatement.Scope scope;\n+        if (context.LOCAL() != null) {\n+            scope = SetSessionAuthorizationStatement.Scope.LOCAL;\n+        } else {\n+            scope = SetSessionAuthorizationStatement.Scope.SESSION;\n+        }\n+\n+        if (context.DEFAULT() != null) {\n+            return new SetSessionAuthorizationStatement(scope);\n+        } else {\n+            var userName = ((StringLiteral) visit(context.username)).getValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjQxMzczOnYy", "diffSide": "RIGHT", "path": "libs/sql-parser/src/main/java/io/crate/sql/tree/SetSessionAuthorizationStatement.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1NTo1NlrOHTYQnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1NTo1NlrOHTYQnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MjQ2MQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/crate/crate/pull/10550#discussion_r490082461", "createdAt": "2020-09-17T08:55:56Z", "author": {"login": "mfussenegger"}, "path": "libs/sql-parser/src/main/java/io/crate/sql/tree/SetSessionAuthorizationStatement.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to CRATE Technology GmbH (\"Crate\") under one or more contributor\n+ * license agreements.  See the NOTICE file distributed with this work for\n+ * additional information regarding copyright ownership.  Crate licenses\n+ * this file to you under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.  You may\n+ * obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ * However, if you have executed another commercial license agreement\n+ * with Crate these terms will supersede the license and you may use the\n+ * software solely pursuant to the terms of the relevant commercial agreement.\n+ */\n+\n+package io.crate.sql.tree;\n+\n+import javax.annotation.Nullable;\n+import java.util.Objects;\n+\n+public class SetSessionAuthorizationStatement extends Statement {\n+\n+    public enum Scope {\n+        SESSION, LOCAL\n+    }\n+\n+    @Nullable\n+    private final String user;\n+    private final Scope scope;\n+\n+    public SetSessionAuthorizationStatement(Scope scope) {\n+        this(null, scope);\n+    }\n+\n+    public SetSessionAuthorizationStatement(@Nullable String user, Scope scope) {\n+        this.scope = scope;\n+        this.user = user;\n+    }\n+\n+    /**\n+     * user is null for the following statements::", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjQxODE2OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/crate/analyze/AnalyzedSetSessionAuthorizationStatement.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1Njo1MVrOHTYTVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1Njo1MVrOHTYTVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MzE1Nw==", "bodyText": "Maybe add the same comment as in the statement class, or link to it?", "url": "https://github.com/crate/crate/pull/10550#discussion_r490083157", "createdAt": "2020-09-17T08:56:51Z", "author": {"login": "mfussenegger"}, "path": "server/src/main/java/io/crate/analyze/AnalyzedSetSessionAuthorizationStatement.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to CRATE Technology GmbH (\"Crate\") under one or more contributor\n+ * license agreements.  See the NOTICE file distributed with this work for\n+ * additional information regarding copyright ownership.  Crate licenses\n+ * this file to you under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.  You may\n+ * obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ * However, if you have executed another commercial license agreement\n+ * with Crate these terms will supersede the license and you may use the\n+ * software solely pursuant to the terms of the relevant commercial agreement.\n+ */\n+\n+package io.crate.analyze;\n+\n+import io.crate.sql.tree.SetSessionAuthorizationStatement;\n+\n+import javax.annotation.Nullable;\n+\n+public class AnalyzedSetSessionAuthorizationStatement implements AnalyzedStatement {\n+\n+    @Nullable\n+    private final String user;\n+    private final SetSessionAuthorizationStatement.Scope scope;\n+\n+    AnalyzedSetSessionAuthorizationStatement(@Nullable String user,\n+                                             SetSessionAuthorizationStatement.Scope scope) {\n+        this.user = user;\n+        this.scope = scope;\n+    }\n+\n+    @Nullable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjQyMTU4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/crate/analyze/SetSessionAuthorizationStatementAnalyzer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwODo1Nzo0MVrOHTYVhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwOToxNDowNVrOHTY-TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MzcxNw==", "bodyText": "Should we inline this into the Analyzer instead of creating a separate class? Seems overkill to extract this only for the call of a constructor", "url": "https://github.com/crate/crate/pull/10550#discussion_r490083717", "createdAt": "2020-09-17T08:57:41Z", "author": {"login": "mfussenegger"}, "path": "server/src/main/java/io/crate/analyze/SetSessionAuthorizationStatementAnalyzer.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to CRATE Technology GmbH (\"Crate\") under one or more contributor\n+ * license agreements.  See the NOTICE file distributed with this work for\n+ * additional information regarding copyright ownership.  Crate licenses\n+ * this file to you under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.  You may\n+ * obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ * However, if you have executed another commercial license agreement\n+ * with Crate these terms will supersede the license and you may use the\n+ * software solely pursuant to the terms of the relevant commercial agreement.\n+ */\n+\n+package io.crate.analyze;\n+\n+import io.crate.sql.tree.SetSessionAuthorizationStatement;\n+\n+class SetSessionAuthorizationStatementAnalyzer {\n+\n+    public static AnalyzedStatement analyze(SetSessionAuthorizationStatement statement) {\n+        return new AnalyzedSetSessionAuthorizationStatement(\n+            statement.user(),\n+            statement.scope()\n+        );\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA5NDE1Ng==", "bodyText": "\ud83d\udc4d yep, it looks like overkill.", "url": "https://github.com/crate/crate/pull/10550#discussion_r490094156", "createdAt": "2020-09-17T09:14:05Z", "author": {"login": "kovrus"}, "path": "server/src/main/java/io/crate/analyze/SetSessionAuthorizationStatementAnalyzer.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to CRATE Technology GmbH (\"Crate\") under one or more contributor\n+ * license agreements.  See the NOTICE file distributed with this work for\n+ * additional information regarding copyright ownership.  Crate licenses\n+ * this file to you under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.  You may\n+ * obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ * However, if you have executed another commercial license agreement\n+ * with Crate these terms will supersede the license and you may use the\n+ * software solely pursuant to the terms of the relevant commercial agreement.\n+ */\n+\n+package io.crate.analyze;\n+\n+import io.crate.sql.tree.SetSessionAuthorizationStatement;\n+\n+class SetSessionAuthorizationStatementAnalyzer {\n+\n+    public static AnalyzedStatement analyze(SetSessionAuthorizationStatement statement) {\n+        return new AnalyzedSetSessionAuthorizationStatement(\n+            statement.user(),\n+            statement.scope()\n+        );\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MzcxNw=="}, "originalCommit": {"oid": "9885f0589524abca7c8134940566cb69ef77f6f0"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1016, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}