{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NTc1MzI1", "number": 10492, "title": "Match all Exception types in KillIntegrationTest to fix flakiness", "bodyText": "Summary of the changes / Why this improves CrateDB\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-09-04T10:57:35Z", "url": "https://github.com/crate/crate/pull/10492", "merged": true, "mergeCommit": {"oid": "91eab4079418606c6800b03f9b438adabb1cb7f4"}, "closed": true, "closedAt": "2020-09-07T08:59:30Z", "author": {"login": "mkleen"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFjFT0AFqTQ4MjU1ODUwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGepnHgBqjM3MzU5Mzk0MTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNTU4NTA4", "url": "https://github.com/crate/crate/pull/10492#pullrequestreview-482558508", "createdAt": "2020-09-04T10:59:20Z", "commit": {"oid": "c6b92fd1e9ae38cdf7f6a63ec502840ea2f33c29"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMDo1OToyMFrOHNJRYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMDo1OToyMFrOHNJRYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU0NTQ0Mg==", "bodyText": "This handles the following case:\n\n  \n    \n      crate/libs/dex/src/test/java/io/crate/testing/FailingBatchIterator.java\n    \n    \n         Line 46\n      in\n      6814214\n    \n    \n    \n    \n\n        \n          \n           Exceptions.rethrowUnchecked(new InterruptedException(\"Job killed\")); \n        \n    \n  \n\n\nThe test used to match against SqlActionException which wrapped all underlying exceptions. Now since SqlActionException is gone we need to match each exception type.", "url": "https://github.com/crate/crate/pull/10492#discussion_r483545442", "createdAt": "2020-09-04T10:59:20Z", "author": {"login": "mkleen"}, "path": "server/src/test/java/io/crate/integrationtests/KillIntegrationTest.java", "diffHunk": "@@ -95,7 +95,7 @@ private void assertGotCancelled(final String statement, @Nullable final Object[]\n                 future.get(10, TimeUnit.SECONDS);\n             } catch (Throwable exception) {\n                 exception = SQLExceptions.unwrap(exception); // wrapped in ExecutionException\n-                assertThat(exception, instanceOf(JobKilledException.class));\n+                assertThat(exception, anyOf(instanceOf(JobKilledException.class), instanceOf(InterruptedException.class));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6b92fd1e9ae38cdf7f6a63ec502840ea2f33c29"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c6b92fd1e9ae38cdf7f6a63ec502840ea2f33c29", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/c6b92fd1e9ae38cdf7f6a63ec502840ea2f33c29", "committedDate": "2020-09-04T10:57:11Z", "message": "Add InterruptedException to matching to fix flaky KillIntegrationTest"}, "afterCommit": {"oid": "ba9f41233abcca7f66cf9326b9c001c079251b16", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/ba9f41233abcca7f66cf9326b9c001c079251b16", "committedDate": "2020-09-04T11:05:24Z", "message": "Add InterruptedException to matcher to fix flaky KillIntegrationTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba9f41233abcca7f66cf9326b9c001c079251b16", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/ba9f41233abcca7f66cf9326b9c001c079251b16", "committedDate": "2020-09-04T11:05:24Z", "message": "Add InterruptedException to matcher to fix flaky KillIntegrationTest"}, "afterCommit": {"oid": "d58acaa82afe317d1b9119a6b08a6bd3123fbda8", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/d58acaa82afe317d1b9119a6b08a6bd3123fbda8", "committedDate": "2020-09-04T11:06:13Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d58acaa82afe317d1b9119a6b08a6bd3123fbda8", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/d58acaa82afe317d1b9119a6b08a6bd3123fbda8", "committedDate": "2020-09-04T11:06:13Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "b40945eefe7ec9bbd536e9a1b51e00cfaf621c4a", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/b40945eefe7ec9bbd536e9a1b51e00cfaf621c4a", "committedDate": "2020-09-04T11:08:48Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b40945eefe7ec9bbd536e9a1b51e00cfaf621c4a", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/b40945eefe7ec9bbd536e9a1b51e00cfaf621c4a", "committedDate": "2020-09-04T11:08:48Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "d554177eef0f169318e0837a608ae6785ec9252e", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/d554177eef0f169318e0837a608ae6785ec9252e", "committedDate": "2020-09-04T11:11:25Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d554177eef0f169318e0837a608ae6785ec9252e", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/d554177eef0f169318e0837a608ae6785ec9252e", "committedDate": "2020-09-04T11:11:25Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "26cefd8456f7020f34ac4666c5ef6da88c23ebd6", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/26cefd8456f7020f34ac4666c5ef6da88c23ebd6", "committedDate": "2020-09-04T11:42:13Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26cefd8456f7020f34ac4666c5ef6da88c23ebd6", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/26cefd8456f7020f34ac4666c5ef6da88c23ebd6", "committedDate": "2020-09-04T11:42:13Z", "message": "Match InterruptedException in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "4cd259776de465f81af3f7a83e11e1fd9ef0a13f", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/4cd259776de465f81af3f7a83e11e1fd9ef0a13f", "committedDate": "2020-09-04T11:43:17Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4cd259776de465f81af3f7a83e11e1fd9ef0a13f", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/4cd259776de465f81af3f7a83e11e1fd9ef0a13f", "committedDate": "2020-09-04T11:43:17Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "4a9d56acca5d22a67617270940ce4d50d5667d5f", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/4a9d56acca5d22a67617270940ce4d50d5667d5f", "committedDate": "2020-09-04T11:54:41Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a9d56acca5d22a67617270940ce4d50d5667d5f", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/4a9d56acca5d22a67617270940ce4d50d5667d5f", "committedDate": "2020-09-04T11:54:41Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "3627707f0ba6a77078ceb29ad24d514a2e51b2a0", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/3627707f0ba6a77078ceb29ad24d514a2e51b2a0", "committedDate": "2020-09-04T12:06:18Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNTk2NDA5", "url": "https://github.com/crate/crate/pull/10492#pullrequestreview-482596409", "createdAt": "2020-09-04T12:07:20Z", "commit": {"oid": "3627707f0ba6a77078ceb29ad24d514a2e51b2a0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3627707f0ba6a77078ceb29ad24d514a2e51b2a0", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/3627707f0ba6a77078ceb29ad24d514a2e51b2a0", "committedDate": "2020-09-04T12:06:18Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "33209801336a207cb7ce7a11535e9f2e99c0641b", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/33209801336a207cb7ce7a11535e9f2e99c0641b", "committedDate": "2020-09-04T14:14:34Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7803147e21d4c7c14bbde1435e26baba121fb581", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/7803147e21d4c7c14bbde1435e26baba121fb581", "committedDate": "2020-09-04T14:15:34Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33209801336a207cb7ce7a11535e9f2e99c0641b", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/33209801336a207cb7ce7a11535e9f2e99c0641b", "committedDate": "2020-09-04T14:14:34Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}, "afterCommit": {"oid": "7803147e21d4c7c14bbde1435e26baba121fb581", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/7803147e21d4c7c14bbde1435e26baba121fb581", "committedDate": "2020-09-04T14:15:34Z", "message": "Match all Exception types in KillIntegrationTest to fix flakiness"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b02a13754f7b1c08fcfd2b44fadac0c5a4ffcfa", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/3b02a13754f7b1c08fcfd2b44fadac0c5a4ffcfa", "committedDate": "2020-09-07T08:23:15Z", "message": "Make TaskMissing an ElasticSearchException"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b7b8f5a4821d4260aa2625033b638ab81c83585", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/4b7b8f5a4821d4260aa2625033b638ab81c83585", "committedDate": "2020-09-07T08:21:24Z", "message": "Make TaskMissing an ElasticSearchException"}, "afterCommit": {"oid": "3b02a13754f7b1c08fcfd2b44fadac0c5a4ffcfa", "author": {"user": {"login": "mkleen", "name": "Michael Kleen"}}, "url": "https://github.com/crate/crate/commit/3b02a13754f7b1c08fcfd2b44fadac0c5a4ffcfa", "committedDate": "2020-09-07T08:23:15Z", "message": "Make TaskMissing an ElasticSearchException"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3058, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}