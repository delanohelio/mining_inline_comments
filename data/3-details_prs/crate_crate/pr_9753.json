{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTk2Mjgw", "number": 9753, "title": "Make sure inserts from lazy table functions are throttled", "bodyText": "Summary of the changes / Why this improves CrateDB\nTable functions like generate_series can generate a large result set.\nThis ensures that inserts from such tables are using the throttle\nmechanism to not overload the cluster.\nChecklist\n\n User relevant changes are recorded in CHANGES.txt\n Touched code is covered by tests\n Documentation has been updated if necessary\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-03-10T15:17:33Z", "url": "https://github.com/crate/crate/pull/9753", "merged": true, "mergeCommit": {"oid": "ac62329f46e16dba4ea8c2edaadad724f3a9238b"}, "closed": true, "closedAt": "2020-03-10T19:35:04Z", "author": {"login": "mfussenegger"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMUYFhgFqTM3MjA2NjgwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMXVpXABqjMxMTYwNjA5Mzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMDY2ODA3", "url": "https://github.com/crate/crate/pull/9753#pullrequestreview-372066807", "createdAt": "2020-03-10T15:32:36Z", "commit": {"oid": "197aac029405af6bfbc63db6135302ecec1bdc4f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNTozMjozNlrOF0UZlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNTozNzoyMVrOF0UntA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQwNDUwMQ==", "bodyText": "Shouldn't it return false if one is false?", "url": "https://github.com/crate/crate/pull/9753#discussion_r390404501", "createdAt": "2020-03-10T15:32:36Z", "author": {"login": "seut"}, "path": "dex/src/main/java/io/crate/data/join/JoinBatchIterator.java", "diffHunk": "@@ -113,10 +113,7 @@ public void kill(@Nonnull Throwable throwable) {\n     }\n \n     @Override\n-    public boolean involvesIO() {\n-        if (left.involvesIO()) {\n-            return true;\n-        }\n-        return right.involvesIO();\n+    public boolean hasLazyResultSet() {\n+        return left.hasLazyResultSet() || right.hasLazyResultSet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "197aac029405af6bfbc63db6135302ecec1bdc4f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQwODExNg==", "bodyText": "should we rename the instance var as well?", "url": "https://github.com/crate/crate/pull/9753#discussion_r390408116", "createdAt": "2020-03-10T15:37:21Z", "author": {"login": "seut"}, "path": "dex/src/main/java/io/crate/data/InMemoryBatchIterator.java", "diffHunk": "@@ -109,7 +109,7 @@ public void kill(@Nonnull Throwable throwable) {\n     }\n \n     @Override\n-    public boolean involvesIO() {\n+    public boolean hasLazyResultSet() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "197aac029405af6bfbc63db6135302ecec1bdc4f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMDk1NTc2", "url": "https://github.com/crate/crate/pull/9753#pullrequestreview-372095576", "createdAt": "2020-03-10T16:02:47Z", "commit": {"oid": "4c279eb1f9518460cdfe9e8bca97dceafc1ab09e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32b001abe2eb4e0305e03fb79d931cde6d10cefe", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/32b001abe2eb4e0305e03fb79d931cde6d10cefe", "committedDate": "2020-03-10T19:04:29Z", "message": "Make sure inserts from lazy table functions are throttled\n\nTable functions like `generate_series` can generate a large result set.\nThis ensures that inserts from such tables are using the throttle\nmechanism to not overload the cluster."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c279eb1f9518460cdfe9e8bca97dceafc1ab09e", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/4c279eb1f9518460cdfe9e8bca97dceafc1ab09e", "committedDate": "2020-03-10T16:00:48Z", "message": "fixup! Make sure inserts from lazy table functions are throttled"}, "afterCommit": {"oid": "32b001abe2eb4e0305e03fb79d931cde6d10cefe", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/32b001abe2eb4e0305e03fb79d931cde6d10cefe", "committedDate": "2020-03-10T19:04:29Z", "message": "Make sure inserts from lazy table functions are throttled\n\nTable functions like `generate_series` can generate a large result set.\nThis ensures that inserts from such tables are using the throttle\nmechanism to not overload the cluster."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3576, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}