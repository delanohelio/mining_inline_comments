{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MjkzMjIz", "number": 10386, "title": "Backport ES changes", "bodyText": "Summary of the changes / Why this improves CrateDB\nSee commits\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-08-18T08:27:40Z", "url": "https://github.com/crate/crate/pull/10386", "merged": true, "mergeCommit": {"oid": "857a6fccc41f43c40069433b9d1842c963995f92"}, "closed": true, "closedAt": "2020-08-18T09:20:02Z", "author": {"login": "mfussenegger"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdACt05AH2gAyNDY5MjkzMjIzOmM5M2FmZGU5ZDdkYTAxOWE2NDc1MmRmODBhMzMxYWVmZDM4NTRmZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdADXuiAFqTQ2OTEzOTgyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c93afde9d7da019a64752df80a331aefd3854fdf", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/c93afde9d7da019a64752df80a331aefd3854fdf", "committedDate": "2020-08-18T08:27:06Z", "message": "bp: Remove PRE_60_NODE_CHECKPOINT\n\nhttps://github.com/elastic/elasticsearch/commit/2c8440922f99e1ffc95487d2d3130168898d448b"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "677bf8dd916d9c1b7b2ac718bc956db85366242d", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/677bf8dd916d9c1b7b2ac718bc956db85366242d", "committedDate": "2020-08-18T08:27:06Z", "message": "bp: Avoid loading retention leases while writing them\n\nhttps://github.com/elastic/elasticsearch/commit/1ef00e368b4c25bacd59a2598c60b510044da163"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97871191c4d8588bec3d686cafbb59e3f556c4dd", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/97871191c4d8588bec3d686cafbb59e3f556c4dd", "committedDate": "2020-08-18T08:27:06Z", "message": "Remove obsolete `isWithinMultiField` check\n\nSee https://github.com/crate/crate/pull/10385/commits/0412817442fd370a2ecd2f4f7d4ca51552dfc494"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5068e3569f54e748c6fa86bba603972f6bdc844a", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/5068e3569f54e748c6fa86bba603972f6bdc844a", "committedDate": "2020-08-18T08:37:54Z", "message": "bp: Add a merge policy that prunes ID postings for soft-deleted but retained documents\n\nhttps://github.com/elastic/elasticsearch/commit/ae96c16f88f23cb771632672fe42942e6fb12e6a\n\nAlso includes a fix for the test:\n\nhttps://github.com/elastic/elasticsearch/commit/9f4e855ee82c8f4a3cc3bcb4f8f59f834957b2a4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83d86c74cf2ac878bce8d1722f35ce2dc40f5439", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/83d86c74cf2ac878bce8d1722f35ce2dc40f5439", "committedDate": "2020-08-18T08:38:08Z", "message": "bp: Improve translog corruption detection\n\nhttps://github.com/elastic/elasticsearch/commit/ca5771c1f4aeb37ff133540927a8c770c46693c3"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "863167b3c6acbd690b49a278b7579b85c03cea23", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/863167b3c6acbd690b49a278b7579b85c03cea23", "committedDate": "2020-08-18T08:27:06Z", "message": "bp: Improve translog corruption detection\n\nhttps://github.com/elastic/elasticsearch/commit/ca5771c1f4aeb37ff133540927a8c770c46693c3"}, "afterCommit": {"oid": "83d86c74cf2ac878bce8d1722f35ce2dc40f5439", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/83d86c74cf2ac878bce8d1722f35ce2dc40f5439", "committedDate": "2020-08-18T08:38:08Z", "message": "bp: Improve translog corruption detection\n\nhttps://github.com/elastic/elasticsearch/commit/ca5771c1f4aeb37ff133540927a8c770c46693c3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MTA1Nzkx", "url": "https://github.com/crate/crate/pull/10386#pullrequestreview-469105791", "createdAt": "2020-08-18T08:30:12Z", "commit": {"oid": "863167b3c6acbd690b49a278b7579b85c03cea23"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwODozMDoxMlrOHCJFhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwODozMjo0NVrOHCJLoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAwODA3MA==", "bodyText": "We need to wait for 5.0 to remove node.max_local_storage_nodes and this patch depends on that, so it is deferred.", "url": "https://github.com/crate/crate/pull/10386#discussion_r472008070", "createdAt": "2020-08-18T08:30:12Z", "author": {"login": "mfussenegger"}, "path": "devs/docs/es-backports.rst", "diffHunk": "@@ -386,19 +386,19 @@ components, so delaying it doesn't make applying other patches more difficult.\n - [ ] ef8f90cc2a5 Also mmap terms index (`.tip`) files for hybridfs (#43150)\n - [ ] 62620f28663 Remove usage of FileSwitchDirectory  (#42937)\n - [ ] 8159fdfcc9a Fix assertion in ReadOnlyEngine (#43010)\n-- [ ] ca5771c1f4a Improve translog corruption detection (#42744)\n-- [ ] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n-- [ ] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n-- [ ] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [x] ca5771c1f4a Improve translog corruption detection (#42744)\n+- [x] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [s] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n+- [s] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n - [x] 8ffb5a15d22 Fix Infinite Loops in ExceptionsHelper#unwrap (#42716)\n-- [ ] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)\n-- [ ] 56a662ed288 Remove Support for VERSION_CHECKPOINTS Translogs (#42782)\n-- [ ] 8e5812c4b32 remove v6.5.x and v6.6.x version constants (#42130)\n-- [ ] 6e39433cd53 Remove \"nodes/0\" folder prefix from data path (#42489)\n-- [ ] f07b90f3c35 Remove support for chained multi-fields. (#42333)\n-- [ ] 4a08b3d1c94 remove 6.4.x version constants (#42127)\n-- [ ] 1ef00e368b4 Avoid loading retention leases while writing them (#42620)\n-- [ ] 2c8440922f9 Remove PRE_60_NODE_CHECKPOINT (#42527)\n+- [s] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)\n+- [d] 56a662ed288 Remove Support for VERSION_CHECKPOINTS Translogs (#42782)\n+- [s] 8e5812c4b32 remove v6.5.x and v6.6.x version constants (#42130)\n+- [d] 6e39433cd53 Remove \"nodes/0\" folder prefix from data path (#42489)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "863167b3c6acbd690b49a278b7579b85c03cea23"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAwODI3Mw==", "bodyText": "Already on Lucene 8.6, where we removed the readerAttributes stuff", "url": "https://github.com/crate/crate/pull/10386#discussion_r472008273", "createdAt": "2020-08-18T08:30:32Z", "author": {"login": "mfussenegger"}, "path": "devs/docs/es-backports.rst", "diffHunk": "@@ -386,19 +386,19 @@ components, so delaying it doesn't make applying other patches more difficult.\n - [ ] ef8f90cc2a5 Also mmap terms index (`.tip`) files for hybridfs (#43150)\n - [ ] 62620f28663 Remove usage of FileSwitchDirectory  (#42937)\n - [ ] 8159fdfcc9a Fix assertion in ReadOnlyEngine (#43010)\n-- [ ] ca5771c1f4a Improve translog corruption detection (#42744)\n-- [ ] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n-- [ ] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n-- [ ] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [x] ca5771c1f4a Improve translog corruption detection (#42744)\n+- [x] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [s] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n+- [s] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n - [x] 8ffb5a15d22 Fix Infinite Loops in ExceptionsHelper#unwrap (#42716)\n-- [ ] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)\n-- [ ] 56a662ed288 Remove Support for VERSION_CHECKPOINTS Translogs (#42782)\n-- [ ] 8e5812c4b32 remove v6.5.x and v6.6.x version constants (#42130)\n-- [ ] 6e39433cd53 Remove \"nodes/0\" folder prefix from data path (#42489)\n-- [ ] f07b90f3c35 Remove support for chained multi-fields. (#42333)\n-- [ ] 4a08b3d1c94 remove 6.4.x version constants (#42127)\n-- [ ] 1ef00e368b4 Avoid loading retention leases while writing them (#42620)\n-- [ ] 2c8440922f9 Remove PRE_60_NODE_CHECKPOINT (#42527)\n+- [s] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "863167b3c6acbd690b49a278b7579b85c03cea23"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAwOTYzMg==", "bodyText": "If I'm not mistaken we need to wait for 5.0 for this, we may have people updating from 3.0 to 4.3 (although not recommended)", "url": "https://github.com/crate/crate/pull/10386#discussion_r472009632", "createdAt": "2020-08-18T08:32:45Z", "author": {"login": "mfussenegger"}, "path": "devs/docs/es-backports.rst", "diffHunk": "@@ -386,19 +386,19 @@ components, so delaying it doesn't make applying other patches more difficult.\n - [ ] ef8f90cc2a5 Also mmap terms index (`.tip`) files for hybridfs (#43150)\n - [ ] 62620f28663 Remove usage of FileSwitchDirectory  (#42937)\n - [ ] 8159fdfcc9a Fix assertion in ReadOnlyEngine (#43010)\n-- [ ] ca5771c1f4a Improve translog corruption detection (#42744)\n-- [ ] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n-- [ ] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n-- [ ] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [x] ca5771c1f4a Improve translog corruption detection (#42744)\n+- [x] ae96c16f88f Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n+- [s] b6213ffa52d Revert \"Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\"\n+- [s] 186b52c5738 Add a merge policy that prunes ID postings for soft-deleted but retained documents (#40741)\n - [x] 8ffb5a15d22 Fix Infinite Loops in ExceptionsHelper#unwrap (#42716)\n-- [ ] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)\n-- [ ] 56a662ed288 Remove Support for VERSION_CHECKPOINTS Translogs (#42782)\n-- [ ] 8e5812c4b32 remove v6.5.x and v6.6.x version constants (#42130)\n-- [ ] 6e39433cd53 Remove \"nodes/0\" folder prefix from data path (#42489)\n-- [ ] f07b90f3c35 Remove support for chained multi-fields. (#42333)\n-- [ ] 4a08b3d1c94 remove 6.4.x version constants (#42127)\n-- [ ] 1ef00e368b4 Avoid loading retention leases while writing them (#42620)\n-- [ ] 2c8440922f9 Remove PRE_60_NODE_CHECKPOINT (#42527)\n+- [s] 4dd5be8e3f3 Use reader attributes to control term dict memory useage (#42838)\n+- [d] 56a662ed288 Remove Support for VERSION_CHECKPOINTS Translogs (#42782)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "863167b3c6acbd690b49a278b7579b85c03cea23"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MTM5ODIz", "url": "https://github.com/crate/crate/pull/10386#pullrequestreview-469139823", "createdAt": "2020-08-18T09:12:52Z", "commit": {"oid": "83d86c74cf2ac878bce8d1722f35ce2dc40f5439"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3137, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}