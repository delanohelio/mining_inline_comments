{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNjg3NzI5", "number": 9508, "title": "Support pg array value input notation", "bodyText": "Summary of the changes / Why this improves CrateDB\nSee https://www.postgresql.org/docs/current/arrays.html#ARRAYS-INPUT\nThe PostgreSQL JDBC client uses some queries which makes use of this\nnotation.\nChecklist\n\n User relevant changes are recorded in CHANGES.txt\n Touched code is covered by tests\n Documentation has been updated if necessary\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-01-14T15:14:23Z", "url": "https://github.com/crate/crate/pull/9508", "merged": true, "mergeCommit": {"oid": "470eaa5acfa9b29df372d90c4f8d1cc371f512c0"}, "closed": true, "closedAt": "2020-01-15T09:27:10Z", "author": {"login": "mfussenegger"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6SnBZgFqTM0MjYxNDQ4Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6holcABqjI5NDk5NjQ5MTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyNjE0NDgz", "url": "https://github.com/crate/crate/pull/9508#pullrequestreview-342614483", "createdAt": "2020-01-14T15:23:26Z", "commit": {"oid": "3b507cb302c9891cb14d4c79451c7b56e16c796b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNToyMzoyNlrOFdbVbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNToyMzoyNlrOFdbVbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQwMDg3OA==", "bodyText": "Made the quoted/non-quoted distinction to be able to handle null without quotes as real null value instead of a null string literal. Not sure if there would be a better way to accomplish this.", "url": "https://github.com/crate/crate/pull/9508#discussion_r366400878", "createdAt": "2020-01-14T15:23:26Z", "author": {"login": "mfussenegger"}, "path": "pgwire/src/main/java/io/crate/protocols/postgres/parser/PgArrayASTVisitor.java", "diffHunk": "@@ -50,7 +50,27 @@ public Object visitArray(PgArrayParser.ArrayContext ctx) {\n \n     @Override\n     public Object visitValue(PgArrayParser.ValueContext ctx) {\n-        return convert.apply(processArrayItem(ctx.getText().getBytes(UTF_8)));\n+        PgArrayParser.StringContext stringContext = ctx.string();\n+        if (stringContext == null) {\n+            return convert.apply(processArrayItem(ctx.getText().getBytes(UTF_8)));\n+        }\n+        Object value = visit(stringContext);\n+        if (value == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b507cb302c9891cb14d4c79451c7b56e16c796b"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyODE4ODg5", "url": "https://github.com/crate/crate/pull/9508#pullrequestreview-342818889", "createdAt": "2020-01-14T20:31:11Z", "commit": {"oid": "6d08d27176ad29d46660e0b8e63b29402688b03a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "709d1960b342edd5205897beca565b29e2d3ab1f", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/709d1960b342edd5205897beca565b29e2d3ab1f", "committedDate": "2020-01-15T08:53:35Z", "message": "Support pg array value input notation\n\nSee https://www.postgresql.org/docs/current/arrays.html#ARRAYS-INPUT\n\nThe PostgreSQL JDBC client uses some queries which makes use of this\nnotation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d08d27176ad29d46660e0b8e63b29402688b03a", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/6d08d27176ad29d46660e0b8e63b29402688b03a", "committedDate": "2020-01-14T16:26:04Z", "message": "fixup! Support pg array value input notation"}, "afterCommit": {"oid": "709d1960b342edd5205897beca565b29e2d3ab1f", "author": {"user": {"login": "mfussenegger", "name": "Mathias Fu\u00dfenegger"}}, "url": "https://github.com/crate/crate/commit/709d1960b342edd5205897beca565b29e2d3ab1f", "committedDate": "2020-01-15T08:53:35Z", "message": "Support pg array value input notation\n\nSee https://www.postgresql.org/docs/current/arrays.html#ARRAYS-INPUT\n\nThe PostgreSQL JDBC client uses some queries which makes use of this\nnotation."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3903, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}