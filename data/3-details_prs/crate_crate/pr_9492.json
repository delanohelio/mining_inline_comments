{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwODQ2OTYx", "number": 9492, "title": "Expose the merge.scheduler.max_thread_count setting for non-SSD type disks", "bodyText": "Summary of the changes / Why this improves CrateDB\nExpose the merge.scheduler.max_thread_count setting for non-SSD type disks\nChecklist\n\n User relevant changes are recorded in CHANGES.txt\n Touched code is covered by tests\n Documentation has been updated if necessary\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-01-09T09:05:55Z", "url": "https://github.com/crate/crate/pull/9492", "merged": true, "mergeCommit": {"oid": "380f1d02f5f52c8e89df91272acde0f5f9424fe8"}, "closed": true, "closedAt": "2020-01-10T10:44:31Z", "author": {"login": "asdf2014"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4ml75gFqTM0MDM4NjUyOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb47tVKAH2gAyMzYwODQ2OTYxOjA1ODAxY2MyYmJlOGFlYTU5ZTRkN2RmYWIwNzEyY2JhMTFlYmUwNmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzg2NTI5", "url": "https://github.com/crate/crate/pull/9492#pullrequestreview-340386529", "createdAt": "2020-01-09T09:29:41Z", "commit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOToyOTo0MlrOFbvjhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOTozMToxMVrOFbvmkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzNTAxNA==", "bodyText": "I think this will be a bit problematic since the value depends on the environment where the test is running on. E.g. on our CI systems it will be lower.\nMaybe we can make the assertion a bit more lenient in that regard or fix the value in the create table statement, so that the tests are deterministic on all environments?", "url": "https://github.com/crate/crate/pull/9492#discussion_r364635014", "createdAt": "2020-01-09T09:29:42Z", "author": {"login": "mfussenegger"}, "path": "sql/src/test/java/io/crate/analyze/MetaDataToASTNodeResolverTest.java", "diffHunk": "@@ -96,6 +96,7 @@ public void testBuildCreateTableColumns() throws Exception {\n                      \"   \\\"mapping.total_fields.limit\\\" = 1000,\\n\" +\n                      \"   max_ngram_diff = 1,\\n\" +\n                      \"   max_shingle_diff = 3,\\n\" +\n+                     \"   \\\"merge.scheduler.max_thread_count\\\" = 4,\\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzNTMxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Defaults to Math.max(1, Math.min(4, Runtime.getRuntime().availableProcessors() / 2))\n          \n          \n            \n            Defaults to ``Math.max(1, Math.min(4, Runtime.getRuntime().availableProcessors() / 2))``", "url": "https://github.com/crate/crate/pull/9492#discussion_r364635316", "createdAt": "2020-01-09T09:30:15Z", "author": {"login": "mfussenegger"}, "path": "docs/sql/statements/create-table.rst", "diffHunk": "@@ -648,3 +648,11 @@ the NGramTokenizer or the NGramTokenFilter. The default is 1.\n \n Specifies the maximum difference between min_shingle_size and max_shingle_size\n when using the ShingleTokenFilter. The default is 3.\n+\n+``merge.scheduler.max_thread_count``\n+--------------------\n+\n+The maximum number of threads on a single shard that may be merging at once.\n+Defaults to Math.max(1, Math.min(4, Runtime.getRuntime().availableProcessors() / 2))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzNTc5Mg==", "bodyText": "Did you intend for this to be backported to 4.0? Usually this kind of change only goes into a feature release (4.1) - in which case we'd list it somewhere under Changes.", "url": "https://github.com/crate/crate/pull/9492#discussion_r364635792", "createdAt": "2020-01-09T09:31:11Z", "author": {"login": "mfussenegger"}, "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -248,6 +248,10 @@ Others\n Fixes\n =====\n \n+- Allow user to control the maximum number of threads on a single shard", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzkxNTY0", "url": "https://github.com/crate/crate/pull/9492#pullrequestreview-340391564", "createdAt": "2020-01-09T09:37:35Z", "commit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOTozNzozNVrOFbvy3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOTozNzozNVrOFbvy3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzODk0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            --------------------\n          \n          \n            \n            ------------------------------------", "url": "https://github.com/crate/crate/pull/9492#discussion_r364638942", "createdAt": "2020-01-09T09:37:35Z", "author": {"login": "kovrus"}, "path": "docs/sql/statements/create-table.rst", "diffHunk": "@@ -648,3 +648,11 @@ the NGramTokenizer or the NGramTokenFilter. The default is 1.\n \n Specifies the maximum difference between min_shingle_size and max_shingle_size\n when using the ShingleTokenFilter. The default is 3.\n+\n+``merge.scheduler.max_thread_count``\n+--------------------", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d24fa9e70a7927b47a190b433e98196dbf3e35a9"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMDY0MTM4", "url": "https://github.com/crate/crate/pull/9492#pullrequestreview-341064138", "createdAt": "2020-01-10T10:07:10Z", "commit": {"oid": "e0e3480ed6eceaa5966cdf239e55221aa9f33b05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05801cc2bbe8aea59e4d7dfab0712cba11ebe06c", "author": {"user": {"login": "asdf2014", "name": "Benedict Jin"}}, "url": "https://github.com/crate/crate/commit/05801cc2bbe8aea59e4d7dfab0712cba11ebe06c", "committedDate": "2020-01-10T10:08:36Z", "message": "Expose the merge.scheduler.max_thread_count setting for non-SSD type disks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3892, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}