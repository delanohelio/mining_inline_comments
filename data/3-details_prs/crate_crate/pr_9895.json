{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NDk1MDI2", "number": 9895, "title": "Use the new func registry for the _values and unnest functions.", "bodyText": "Summary of the changes / Why this improves CrateDB\nDepends on and should be only merged after #9903, so the first commit should not be reviewed, such as it is part of #9903.\nChecklist\n\n Added an entry in CHANGES.txt for user facing changes\n Updated documentation & sql_features table for user facing changes\n Touched code is covered by tests\n CLA is signed\n This does not contain breaking changes, or if it does:\n\nIt is released within a major release\nIt is recorded in CHANGES.txt\nIt was marked as deprecated in an earlier release if possible\nYou've thought about the consequences and other components are adapted\n(E.g. AdminUI)", "createdAt": "2020-04-24T11:27:44Z", "url": "https://github.com/crate/crate/pull/9895", "merged": true, "mergeCommit": {"oid": "468e81c77d0c7302a2443e10160845aa50b7cdd3"}, "closed": true, "closedAt": "2020-04-29T12:26:48Z", "author": {"login": "kovrus"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaxZs2ABqjMyNjkzODQzOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccW90qABqjMyODQyMDYxOTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4419ed8c1d6224e89b9c2a6e1475d826333723f0", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/4419ed8c1d6224e89b9c2a6e1475d826333723f0", "committedDate": "2020-04-24T13:05:09Z", "message": "fixup! Use the new func registry for the _values function."}, "afterCommit": {"oid": "09cee198b3c6e85b8723fc71545eaa8f890625e3", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/09cee198b3c6e85b8723fc71545eaa8f890625e3", "committedDate": "2020-04-24T13:20:39Z", "message": "Use the new func registry for the unnest function."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "09cee198b3c6e85b8723fc71545eaa8f890625e3", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/09cee198b3c6e85b8723fc71545eaa8f890625e3", "committedDate": "2020-04-24T13:20:39Z", "message": "Use the new func registry for the unnest function."}, "afterCommit": {"oid": "22c8b5f05176455ff4359cd2b9471e546e59d929", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/22c8b5f05176455ff4359cd2b9471e546e59d929", "committedDate": "2020-04-24T14:34:46Z", "message": "Use the new func registry for the unnest function."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "22c8b5f05176455ff4359cd2b9471e546e59d929", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/22c8b5f05176455ff4359cd2b9471e546e59d929", "committedDate": "2020-04-24T14:34:46Z", "message": "Use the new func registry for the unnest function."}, "afterCommit": {"oid": "c3006739c69c6323ed9526e4593595e2e5af1b3c", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/c3006739c69c6323ed9526e4593595e2e5af1b3c", "committedDate": "2020-04-28T13:47:57Z", "message": "Use the new func registry for the unnest function."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxOTIzMjEx", "url": "https://github.com/crate/crate/pull/9895#pullrequestreview-401923211", "createdAt": "2020-04-28T14:57:47Z", "commit": {"oid": "68decb6eaf61c153f257f79ff2dc2b92953eaeb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNDo1Nzo0N1rOGNYVmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNDo1Nzo0N1rOGNYVmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY4MzQxNw==", "bodyText": "Could we use functions.getQualified(ValuesFunction.SIGNATURE, Symbols.typeView(arrays)) instead? Looks like at this point all arguments are already validated and we could avoid signature matching...", "url": "https://github.com/crate/crate/pull/9895#discussion_r416683417", "createdAt": "2020-04-28T14:57:47Z", "author": {"login": "seut"}, "path": "sql/src/main/java/io/crate/analyze/relations/RelationAnalyzer.java", "diffHunk": "@@ -708,9 +709,17 @@ public AnalyzedRelation visitValues(Values values, StatementAnalysisContext cont\n                 columnValues\n             ));\n         }\n-        FunctionIdent functionIdent = new FunctionIdent(ValuesFunction.NAME, Symbols.typeView(arrays));\n-        FunctionImplementation implementation = functions.getQualified(functionIdent);\n-        Function function = new Function(implementation.info(), arrays);\n+\n+        FunctionImplementation implementation = functions.resolveBuiltInFunctionBySignature(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68decb6eaf61c153f257f79ff2dc2b92953eaeb8"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNDI1MDY3", "url": "https://github.com/crate/crate/pull/9895#pullrequestreview-402425067", "createdAt": "2020-04-29T07:35:08Z", "commit": {"oid": "17ba22cb516350a5beb48e075490878580e5b309"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26c8e90a1433a7830de5552232603e80f26617c2", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/26c8e90a1433a7830de5552232603e80f26617c2", "committedDate": "2020-04-29T11:41:12Z", "message": "Use the new func registry for the _values function."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0791fce3e128f2d36694fd5e41537fb5eba2a4eb", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/0791fce3e128f2d36694fd5e41537fb5eba2a4eb", "committedDate": "2020-04-29T11:41:12Z", "message": "Use the new func registry for the unnest function."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17ba22cb516350a5beb48e075490878580e5b309", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/17ba22cb516350a5beb48e075490878580e5b309", "committedDate": "2020-04-28T17:51:57Z", "message": "fixup! Use the new func registry for the _values function."}, "afterCommit": {"oid": "0791fce3e128f2d36694fd5e41537fb5eba2a4eb", "author": {"user": {"login": "kovrus", "name": "Ruslan Kovalov"}}, "url": "https://github.com/crate/crate/commit/0791fce3e128f2d36694fd5e41537fb5eba2a4eb", "committedDate": "2020-04-29T11:41:12Z", "message": "Use the new func registry for the unnest function."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3306, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}