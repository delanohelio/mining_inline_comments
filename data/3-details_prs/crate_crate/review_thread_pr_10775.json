{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxNjY4OTYz", "number": 10775, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDowNjo0MlrOE5gLVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoxNjoyMVrOE5gcXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NzMxNDc5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/crate/analyze/CopyFromParserProperties.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDowNjo0MlrOH0ANhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwOToxMzo1NlrOH0rNiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5MTQ2MQ==", "bodyText": "Could we set the default value in the CSV_COLUMN_SEPARATOR definition?\nIt might also be possible to change the type of the setting to  Setting<Char>, then the whole logic could be encapsulated within the setting itself and here we'd use CSV_COLUMN_SEPARATOR.get(settings) to retrieve the final value.", "url": "https://github.com/crate/crate/pull/10775#discussion_r524291461", "createdAt": "2020-11-16T14:06:42Z", "author": {"login": "mfussenegger"}, "path": "server/src/main/java/io/crate/analyze/CopyFromParserProperties.java", "diffHunk": "@@ -39,29 +41,47 @@\n     public static final CopyFromParserProperties DEFAULT = CopyFromParserProperties.of(Settings.EMPTY);\n \n     private final boolean emptyStringAsNull;\n+    private final char columnSeparator;\n \n     public static CopyFromParserProperties of(Settings settings) {\n+        var csvColumnSeparatorAsString = settings.get(CSV_COLUMN_SEPARATOR.getKey());\n+        char csvColumnSeparator;\n+        if (csvColumnSeparatorAsString == null) {\n+            csvColumnSeparator = CsvSchema.DEFAULT_COLUMN_SEPARATOR;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d012c42bc639d3202f12c7adbfa48ef5ee2a3b9"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM0MDkwMQ==", "bodyText": "But the default value is always going to have the String type, so I am not sure whether we can use Setting<Character> without changing the Setting.class.\n    private Setting(Key key, @Nullable Setting<T> fallbackSetting, Function<Settings, String> defaultValue, Function<String, T> parser,\n                    Validator<T> validator, Property... properties) {", "url": "https://github.com/crate/crate/pull/10775#discussion_r524340901", "createdAt": "2020-11-16T15:13:08Z", "author": {"login": "kovrus"}, "path": "server/src/main/java/io/crate/analyze/CopyFromParserProperties.java", "diffHunk": "@@ -39,29 +41,47 @@\n     public static final CopyFromParserProperties DEFAULT = CopyFromParserProperties.of(Settings.EMPTY);\n \n     private final boolean emptyStringAsNull;\n+    private final char columnSeparator;\n \n     public static CopyFromParserProperties of(Settings settings) {\n+        var csvColumnSeparatorAsString = settings.get(CSV_COLUMN_SEPARATOR.getKey());\n+        char csvColumnSeparator;\n+        if (csvColumnSeparatorAsString == null) {\n+            csvColumnSeparator = CsvSchema.DEFAULT_COLUMN_SEPARATOR;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5MTQ2MQ=="}, "originalCommit": {"oid": "6d012c42bc639d3202f12c7adbfa48ef5ee2a3b9"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDk2NzQzOQ==", "bodyText": "Something like this should work, no?\npublic static final Setting<Character> CSV_COLUMN_SEPARATOR = new Setting<Character>(\n    \"delimiter\",\n    \",\",\n    value -> {\n        if (value.length() != 1) {\n            throw new IllegalArgumentException(\n                \"Invalid CSV fields delimiter: \" + value + \". The delimiter must be a single character.\");\n        }\n        return value.charAt(0);\n    },\n    Setting.Property.Dynamic\n);", "url": "https://github.com/crate/crate/pull/10775#discussion_r524967439", "createdAt": "2020-11-17T08:28:23Z", "author": {"login": "mfussenegger"}, "path": "server/src/main/java/io/crate/analyze/CopyFromParserProperties.java", "diffHunk": "@@ -39,29 +41,47 @@\n     public static final CopyFromParserProperties DEFAULT = CopyFromParserProperties.of(Settings.EMPTY);\n \n     private final boolean emptyStringAsNull;\n+    private final char columnSeparator;\n \n     public static CopyFromParserProperties of(Settings settings) {\n+        var csvColumnSeparatorAsString = settings.get(CSV_COLUMN_SEPARATOR.getKey());\n+        char csvColumnSeparator;\n+        if (csvColumnSeparatorAsString == null) {\n+            csvColumnSeparator = CsvSchema.DEFAULT_COLUMN_SEPARATOR;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5MTQ2MQ=="}, "originalCommit": {"oid": "6d012c42bc639d3202f12c7adbfa48ef5ee2a3b9"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDk5NTk3Nw==", "bodyText": "hmm indeed.. was confused about default string value.", "url": "https://github.com/crate/crate/pull/10775#discussion_r524995977", "createdAt": "2020-11-17T09:13:56Z", "author": {"login": "kovrus"}, "path": "server/src/main/java/io/crate/analyze/CopyFromParserProperties.java", "diffHunk": "@@ -39,29 +41,47 @@\n     public static final CopyFromParserProperties DEFAULT = CopyFromParserProperties.of(Settings.EMPTY);\n \n     private final boolean emptyStringAsNull;\n+    private final char columnSeparator;\n \n     public static CopyFromParserProperties of(Settings settings) {\n+        var csvColumnSeparatorAsString = settings.get(CSV_COLUMN_SEPARATOR.getKey());\n+        char csvColumnSeparator;\n+        if (csvColumnSeparatorAsString == null) {\n+            csvColumnSeparator = CsvSchema.DEFAULT_COLUMN_SEPARATOR;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5MTQ2MQ=="}, "originalCommit": {"oid": "6d012c42bc639d3202f12c7adbfa48ef5ee2a3b9"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NzM1ODM4OnYy", "diffSide": "RIGHT", "path": "docs/sql/statements/copy-from.rst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoxNjoyMVrOH0AnoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoxNjoyMVrOH0AnoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5ODE0NQ==", "bodyText": "this might be better phrased like so:\n\nSpecifies a single one-byte character that separates columns within each line of the file. The default delimiter is ,.", "url": "https://github.com/crate/crate/pull/10775#discussion_r524298145", "createdAt": "2020-11-16T14:16:21Z", "author": {"login": "norosa"}, "path": "docs/sql/statements/copy-from.rst", "diffHunk": "@@ -334,6 +334,16 @@ execution.\n The option is only supported when using the ``CSV`` format,\n otherwise, it will be ignored.\n \n+``delimiter``\n+'''''''''''''\n+\n+Specifies the character that separates columns within each line of the file.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d012c42bc639d3202f12c7adbfa48ef5ee2a3b9"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 914, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}