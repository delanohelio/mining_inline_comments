{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxODg4NDU5", "number": 4274, "title": "DB-10460 fix default value for bit data type in show_create_table sta\u2026", "bodyText": "\u2026tement", "createdAt": "2020-10-13T00:02:09Z", "url": "https://github.com/splicemachine/spliceengine/pull/4274", "merged": true, "mergeCommit": {"oid": "5e621ec11db244a2f5d63787a04e5938384ba6ea"}, "closed": true, "closedAt": "2020-10-14T06:36:11Z", "author": {"login": "yxia92"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR854-gH2gAyNTAxODg4NDU5OmI0MzI1MTcwZThkMzYyZTNlZGFkYzZjZTIwODU0Njc5Yzk4NDVhMmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSWcIxgFqTUwODAwNzc4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e", "author": {"user": {"login": "yxia92", "name": "Yi Xia"}}, "url": "https://github.com/splicemachine/spliceengine/commit/b4325170e8d362e3edadc6ce20854679c9845a2e", "committedDate": "2020-10-12T23:51:29Z", "message": "DB-10460 fix default value for bit data type in show_create_table statement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjA0NTM3", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-507204537", "createdAt": "2020-10-13T08:44:40Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjE5MDM3", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-507219037", "createdAt": "2020-10-13T09:01:14Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjI4NTk1", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-507228595", "createdAt": "2020-10-13T09:12:22Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOToxMjoyM1rOHgdGWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOToxMjoyM1rOHgdGWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc5MzI0Mw==", "bodyText": "this is necessary since we are putting that generated DDL string into this\nStringBuilder sb = new StringBuilder(\"SELECT * FROM (VALUES '\");\nsb.append(DDL);\nString extStr = extTblString.toString();\nif (extStr.length() > 0)\n\tsb.append(extStr);\nsb.append(\";') FOO (DDL)\");\nresultSet[0] = executeStatement(sb);\n\nand therefore all quotes like ' have to be escaped, resulting in double quotes \u2018'. For X\u2019000' this means X''000''.\nThis scheme of creating a `\u201dSELECT * FROM (VALUES \u2018\u201c + result + \u201c;) FOO(col1, col2)\u2019 is used in all of SpliceAdmin.java, might be up for some more surprises.\nActually maybe simple would have been to solve escaping generally here by using sth like\nString escapeAsValue(String val) {\n  return val.replaceAll(\"'\", \"''\"); \n}\n\nand then use everywhere sth  like \u201dSELECT * FROM (VALUES \u2018\u201c + doEscaping(result) + \u201c;) FOO(col1, col2)\u201d;", "url": "https://github.com/splicemachine/spliceengine/pull/4274#discussion_r503793243", "createdAt": "2020-10-13T09:12:23Z", "author": {"login": "martinrupp"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/utils/SpliceAdmin.java", "diffHunk": "@@ -2387,6 +2387,10 @@ private static String createColumn(ColumnDescriptor columnDescriptor) throws SQL\n                         ) {\n                     if ((defaultText = defaultText.toUpperCase()).startsWith(\"'\"))\n                         defaultText = \"'\" + defaultText + \"'\";\n+                    if (columnDescriptor.getType().getTypeId().isBitTypeId() &&\n+                            defaultText.startsWith(\"X'\")) {\n+                        defaultText = \"X'\" + defaultText.substring(1) + \"'\";\n+                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjM4MDkx", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-507238091", "createdAt": "2020-10-13T09:23:23Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTcxOTUz", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-507971953", "createdAt": "2020-10-14T03:38:48Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDA3Nzg5", "url": "https://github.com/splicemachine/spliceengine/pull/4274#pullrequestreview-508007789", "createdAt": "2020-10-14T05:36:31Z", "commit": {"oid": "b4325170e8d362e3edadc6ce20854679c9845a2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1095, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}