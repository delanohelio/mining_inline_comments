{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxODI3ODU1", "number": 4614, "title": "DB-10503 fix foreign key child interceptor's checks for parent row existence", "bodyText": "", "createdAt": "2020-11-16T17:49:00Z", "url": "https://github.com/splicemachine/spliceengine/pull/4614", "merged": true, "mergeCommit": {"oid": "d0e22c46d5cd08d9ed47a5ba88a28421ba928bec"}, "closed": true, "closedAt": "2020-11-17T15:45:47Z", "author": {"login": "hatyo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddIrjVgH2gAyNTIxODI3ODU1OjViMzBkNTk0YTFmZWFhZjAxYmQwNzk5ZDZmNWQ1MjVmMzI2ZTM4MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddbSo1AFqTUzMjQ4OTk2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5b30d594a1feaaf01bd0799d6f5d525f326e3824", "author": {"user": {"login": "hatyo", "name": "Youssef Hatem"}}, "url": "https://github.com/splicemachine/spliceengine/commit/5b30d594a1feaaf01bd0799d6f5d525f326e3824", "committedDate": "2020-11-16T17:47:51Z", "message": "DB-10503 fix FK child intercerptor checks for row existence in parent."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2", "author": {"user": {"login": "hatyo", "name": "Youssef Hatem"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7b466eac594b38926069598ed3f427eda2ba99c2", "committedDate": "2020-11-16T17:48:11Z", "message": "DB-10503 add test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTg4Mzc2", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532188376", "createdAt": "2020-11-17T09:48:20Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwOTo0ODoyMFrOH0spYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwOTo0ODoyMFrOH0spYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTAxOTQ4OA==", "bodyText": "does it make sense still to use switch here, as most of the cases empty? Maybe \"if\" will look simpler", "url": "https://github.com/splicemachine/spliceengine/pull/4614#discussion_r525019488", "createdAt": "2020-11-17T09:48:20Z", "author": {"login": "ipraznik-splice"}, "path": "splice_machine/src/main/java/com/splicemachine/pipeline/foreignkey/ForeignKeyChildInterceptWriteHandler.java", "diffHunk": "@@ -159,24 +159,20 @@ public void close(WriteContext ctx) throws IOException {\n \n     private boolean hasData(DataResult result,SimpleTxnFilter filter) throws IOException {\n         if(result!=null && !result.isEmpty()) {\n-            int cellCount = result.size();\n             for (DataCell dc : result) {\n                 DataFilter.ReturnCode returnCode = filter.filterCell(dc);\n                 switch (returnCode) {\n-                    case NEXT_ROW:\n-                        return false; //the entire row is filtered\n-                    case SKIP:\n-                    case NEXT_COL:\n-                    case SEEK:\n-                        cellCount--; //the cell is filtered\n-                        break;\n-                    case INCLUDE:\n+                    case INCLUDE: // fallthrough\n                     case INCLUDE_AND_NEXT_COL: //the cell is included, so we have some data\n-                    default: //do nothing\n+                        return true;\n+                    case SKIP: // fallthrough\n+                    case NEXT_COL: // fallthrough\n+                    case SEEK: // fallthrough\n+                    case NEXT_ROW: // fallthrough\n+                    default: //do nothing, keep trying", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTkwMTIz", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532190123", "createdAt": "2020-11-17T09:50:16Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTkwODg2", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532190886", "createdAt": "2020-11-17T09:51:07Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTkxMTUx", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532191151", "createdAt": "2020-11-17T09:51:24Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTkzNTM5", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532193539", "createdAt": "2020-11-17T09:54:07Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNDg5OTYz", "url": "https://github.com/splicemachine/spliceengine/pull/4614#pullrequestreview-532489963", "createdAt": "2020-11-17T15:28:50Z", "commit": {"oid": "7b466eac594b38926069598ed3f427eda2ba99c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1054, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}