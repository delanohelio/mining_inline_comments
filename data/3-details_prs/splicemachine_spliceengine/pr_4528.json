{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MjA5ODMy", "number": 4528, "title": "DB-10685 Fix SYSCS_INVALIDATE_STORED_STATEMENTS", "bodyText": "The SYSCS_INVALIDATE_STORED_STATEMENTS procedure should clear stored statements from the dictionary cache so that they will be recompiled the next time they are executed.  Currently it does not, it only invalidates stored statements on disk.", "createdAt": "2020-11-10T04:56:26Z", "url": "https://github.com/splicemachine/spliceengine/pull/4528", "merged": true, "mergeCommit": {"oid": "160a471acef5ee7859d889fd4119d675e0b8f2f4"}, "closed": true, "closedAt": "2020-11-12T04:59:48Z", "author": {"login": "msirek"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbQmOAgFqTUyNzYzNzM1Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbrSPfAFqTUyODc1MDEyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NjM3MzU3", "url": "https://github.com/splicemachine/spliceengine/pull/4528#pullrequestreview-527637357", "createdAt": "2020-11-10T21:52:42Z", "commit": {"oid": "14e02cc38decdc47746196734eefb95d0899a0cd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMTo1Mjo0M1rOHwxDCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMTo1Mjo0M1rOHwxDCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg5NzI5MQ==", "bodyText": "This is not needed. If software version is higher than data dictionary catalog version, createOrUpdateAllSystemProcedures() recreates all system procedures.", "url": "https://github.com/splicemachine/spliceengine/pull/4528#discussion_r520897291", "createdAt": "2020-11-10T21:52:43Z", "author": {"login": "jyuanca"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/upgrade/UpgradeScriptToCreateNewInvalidateStoredStatementsProcedure.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Copyright (c) 2012 - 2020 Splice Machine, Inc.\n+ *\n+ * This file is part of Splice Machine.\n+ * Splice Machine is free software: you can redistribute it and/or modify it under the terms of the\n+ * GNU Affero General Public License as published by the Free Software Foundation, either\n+ * version 3, or (at your option) any later version.\n+ * Splice Machine is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n+ * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n+ * See the GNU Affero General Public License for more details.\n+ * You should have received a copy of the GNU Affero General Public License along with Splice Machine.\n+ * If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package com.splicemachine.derby.impl.sql.catalog.upgrade;\n+\n+import com.splicemachine.db.iapi.error.StandardException;\n+import com.splicemachine.db.iapi.store.access.TransactionController;\n+import com.splicemachine.derby.impl.sql.catalog.SpliceDataDictionary;\n+import com.splicemachine.utils.SpliceLogUtils;\n+\n+/**\n+ * Created by msirek on 11/7/20.\n+ */\n+public class UpgradeScriptToCreateNewInvalidateStoredStatementsProcedure extends UpgradeScriptBase {\n+    public UpgradeScriptToCreateNewInvalidateStoredStatementsProcedure(SpliceDataDictionary sdd, TransactionController tc) {\n+        super(sdd, tc);\n+    }\n+\n+    @Override\n+    protected void upgradeSystemTables() throws StandardException {\n+        sdd.replaceInvalidateStoredStatementsAndDependentProcedures(tc);\n+\n+        SpliceLogUtils.info(LOG, \"Catalog upgraded: created new version of SYSCS_UTIL.SYSCS_INVALIDATE_STORED_STATEMENTS.\");\n+\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14e02cc38decdc47746196734eefb95d0899a0cd"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NjQ0NTYz", "url": "https://github.com/splicemachine/spliceengine/pull/4528#pullrequestreview-527644563", "createdAt": "2020-11-10T22:03:45Z", "commit": {"oid": "14e02cc38decdc47746196734eefb95d0899a0cd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbc54a01f8e961b87ecaa7bed84ec590d360a1fb", "author": {"user": {"login": "msirek", "name": "Mark Sirek"}}, "url": "https://github.com/splicemachine/spliceengine/commit/fbc54a01f8e961b87ecaa7bed84ec590d360a1fb", "committedDate": "2020-11-12T03:44:36Z", "message": "DB-10685 SYSCS_INVALIDATE_STORED_STATEMENTS should clear\n         stored statements from the dictionary cache."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14e02cc38decdc47746196734eefb95d0899a0cd", "author": {"user": {"login": "msirek", "name": "Mark Sirek"}}, "url": "https://github.com/splicemachine/spliceengine/commit/14e02cc38decdc47746196734eefb95d0899a0cd", "committedDate": "2020-11-10T15:44:05Z", "message": "DB-10685 Fix spotbugs"}, "afterCommit": {"oid": "fbc54a01f8e961b87ecaa7bed84ec590d360a1fb", "author": {"user": {"login": "msirek", "name": "Mark Sirek"}}, "url": "https://github.com/splicemachine/spliceengine/commit/fbc54a01f8e961b87ecaa7bed84ec590d360a1fb", "committedDate": "2020-11-12T03:44:36Z", "message": "DB-10685 SYSCS_INVALIDATE_STORED_STATEMENTS should clear\n         stored statements from the dictionary cache."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NzUwMTI3", "url": "https://github.com/splicemachine/spliceengine/pull/4528#pullrequestreview-528750127", "createdAt": "2020-11-12T04:59:02Z", "commit": {"oid": "fbc54a01f8e961b87ecaa7bed84ec590d360a1fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1063, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}