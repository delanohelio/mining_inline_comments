{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NjYzNDk3", "number": 4206, "title": "DB-10193 Multidatabase support ", "bodyText": "This feature is still experimental. However, it should not disrupt our main branch as long as multi database is disabled.\nMotivationMultidatabase is a new feature of splice machine. It creates a new hierarchical layer above schemas allowing multiple databases to live in the same Splice Machine instance, effectively reducing the cost for customers who can then run multiple databases on a given set of OLTP nodes and OLAP nodes. A database contains its own set of schemas, users and roles. We provide a proper isolation of privileges between databases, so no database user (besides the instance superuser) can get access to another database\u2019s object. Current workJira: DB-10193 Github: spliceengine | spliceengine-ee\nData dictionaryData dictionary had to be modified to support this new feature:New tables / columns\nNew core system table:\nSYS.SYSDATABASES\nCOLUMN_NAME           |TYPE_NAME|DEC&|NUM&|COLUMN_SI&|COLUMN_DEF|CHAR_OCTE&|IS_NU&\n-----------------------------------------------------------------------------------\nDATABASEID            |CHAR     |NULL|NULL|36        |NULL      |72        |NO\nDATABASENAME          |VARCHAR  |NULL|NULL|128       |NULL      |256       |NO\nAUTHORIZATIONID       |VARCHAR  |NULL|NULL|128       |NULL      |256       |NO\nAUTHORIZATIONID will contain the name of the database owner.If no additional database was created, SYS.SYSDATABASES will contain only one row:splice> select * from sys.sysdatabases;\nDATABASEID                          |DATABASENAME|AUTHORIZATIONID\n------------------------------------------------------------------\na816c00e-0178-45af-3af1-0000135c3d30|SPLICEDB    |SPLICESPLICEDB is owned by SPLICE\u00a0A new DATABASEID column was added to three existing system tables: SYS.SYSSCHEMAS SYS.SYSROLES, SYS.SYSUSERSThis DATABASEID matches the DATABASEID column of SYS.SYSDATABASES:splice> select * from sys.sysschemas where SCHEMANAME = 'SPLICE';\nSCHEMAID|SCHEMANAME|AUTHORIZATIONID|DATABASEID\n----------------------------------------------\n80000000-00d2-b38f-4cda-000a0a412c00|SPLICE|SPLICE|a816c00e-0178-45af-3af1-0000135c3d30Special behavior for system schemas:Most system schemas are special in that they are not duplicated in other databases. Therefore, all databases have internal to SPLICEDB's SYS, SYSIBM, SYSIBMADM, SYSFUN, SYSVW, SYSCAT.Although any database owner can query schemas from system views, only SPLICEDB.SPLICE can query SYS directly:-- From SPLICEDB.SPLICE:\n\nsplice> select * from sys.sysschemas;\nSCHEMAID            |SCHEMANAME          |AUTHORIZATIONID     |DATABASEID\n-----------------------------------------------------------------------------------\nc013800d-00f8-5b53-&|SYSIBM              |SPLICE              |a816c00e-0178-45af-&\n62bfdcdb-ea53-4339-&|SYSIBMADM           |SPLICE              |a816c00e-0178-45af-&\n8000000d-00d0-fd77-&|SYS                 |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2641-&|SYSCAT              |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2642-&|SYSFUN              |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2643-&|SYSPROC             |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2644-&|SYSSTAT             |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2647-&|NULLID              |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2648-&|SQLJ                |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2646-&|SYSCS_DIAG          |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-2649-&|SYSCS_UTIL          |SPLICE              |a816c00e-0178-45af-&\nc013800d-00fb-264d-&|SYSVW               |SPLICE              |a816c00e-0178-45af-&\n80000000-00d2-b38f-&|SPLICE              |SPLICE              |a816c00e-0178-45af-&\n15048295-0178-45af-&|SPLICE              |SPLICE              |2c5f8294-0178-45af-&\n3da9c296-0178-45af-&|SYSCS_UTIL          |SPLICE              |2c5f8294-0178-45af-&\n\nsplice> select * from sysvw.sysschemasview;\nSCHEMAID            |SCHEMANAME          |AUTHORIZATIONID\n--------------------------------------------------------------\n3da9c296-0178-45af-&|SYSCS_UTIL          |SPLICE\n62bfdcdb-ea53-4339-&|SYSIBMADM           |SPLICE\n80000000-00d2-b38f-&|SPLICE              |SPLICE\n8000000d-00d0-fd77-&|SYS                 |SPLICE\nc013800d-00f8-5b53-&|SYSIBM              |SPLICE\nc013800d-00fb-2641-&|SYSCAT              |SPLICE\nc013800d-00fb-2642-&|SYSFUN              |SPLICE\nc013800d-00fb-2643-&|SYSPROC             |SPLICE\nc013800d-00fb-2644-&|SYSSTAT             |SPLICE\nc013800d-00fb-2646-&|SYSCS_DIAG          |SPLICE\nc013800d-00fb-2647-&|NULLID              |SPLICE\nc013800d-00fb-2648-&|SQLJ                |SPLICE\nc013800d-00fb-2649-&|SYSCS_UTIL          |SPLICE\nc013800d-00fb-264d-&|SYSVW               |SPLICE\n\n\n-- From SPLICEDB2.SPLICE:\n\nsplice> select * from sys.sysschemas;\nERROR 42Y07: Schema 'SYS' does not exist\n\nsplice> select * from sysvw.sysschemasview;\nSCHEMAID            |SCHEMANAME          |AUTHORIZATIONID\n--------------------------------------------------------------\n15048295-0178-45af-&|SPLICE              |SPLICE\n3da9c296-0178-45af-&|SYSCS_UTIL          |SPLICE\n62bfdcdb-ea53-4339-&|SYSIBMADM           |SPLICE\n8000000d-00d0-fd77-&|SYS                 |SPLICE\nc013800d-00f8-5b53-&|SYSIBM              |SPLICE\nc013800d-00fb-2642-&|SYSFUN              |SPLICE\nc013800d-00fb-2649-&|SYSCS_UTIL          |SPLICE\nc013800d-00fb-264d-&|SYSVW               |SPLICE\n\n\u00a0SYSCS_UTIL is duplicated in all databases, so that permissions can be granted individually on its procedures.New system view behavior:System views are now database specific and should be the primary access to our data dictionary to see a database-filtered view of our system tables.Only splicedb.splice should be able to access to the non-filtered SYS tables.UpgradeUpgrading from a previous version of Splice Machine will: Create the new SYS.SYSDATABASES tableInsert the default SPLICEDB line in itCreate new DATABASEID column in SYS.SYSSCHEMAS, SYS.SYSROLES SYS.SYSUSERSFill these new columns with the database UUID of SPLICEDBRefresh all views that were affected (almost all views)Using multidbEnable / disable multidatabaseMulti database is currently disabled and can be enabled / disable with the following commands:call syscs_util.syscs_enable_multidatabase();\n\ncall syscs_util.syscs_disable_multidatabase();Connect to a specific databaseconnect 'jdbc:splice://localhost:1527/SPLICEDB2;user=splice;password=adminCreate databasesWe currently support two different ways of creating new databases:CREATE commandCREATE DATABASE SPLICEDB2This will create a new database SPLICEDB2 and a new user in that database that will own that new database.The new user will be a duplicate to the user that issues the CREATE command. create=true parameter in the connection stringconnect 'jdbc:splice://localhost:1527/SPLICEDB2;user=NEW_OWNER;password=NEW_OWNER_PW;create=true';This will create a new database SPLICEDB2 and a new user NEW_OWNER in that database that will own that new database.If create=true is specified but the database already exists, we silently ignore the create parameter.Drop databasesDropping databases can be done via DROP DATABASE SPLICEDB2 CASCADEThis should only be done by SPLICEDB.SPLICE and connections to that database should be dropped (still TODO)We also support the syntax for RESTRICT, but it will always fail, as it is currently not possible to drop the owner of a database from another database.", "createdAt": "2020-09-30T17:23:14Z", "url": "https://github.com/splicemachine/spliceengine/pull/4206", "merged": true, "mergeCommit": {"oid": "30b6ae8cbf9045a375e9da09feaf7c1138294cf6"}, "closed": true, "closedAt": "2021-06-15T21:32:09Z", "author": {"login": "arnaud-splice"}, "timelineItems": {"totalCount": 58, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI2AAzgH2gAyNDk1NjYzNDk3OjY5MjM4YmYwZDk1NWRkYjI0MmQzZWU1MWVjN2NiNTI5NGEyZGI3OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABehGWD8gFqTY4NDUwOTA3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "69238bf0d955ddb242d3ee51ec7cb5294a2db798", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/69238bf0d955ddb242d3ee51ec7cb5294a2db798", "committedDate": "2020-09-14T16:43:31Z", "message": "DB-10194 Create new database through JDBC connect (#4093)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10194 Use sysvw instead of sys in 'show databases'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31adfa194ad39ae7433beba3a876f3f767859fb3", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/31adfa194ad39ae7433beba3a876f3f767859fb3", "committedDate": "2020-09-14T17:11:16Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5d7eee95ba6f9a46364487e499820b1eb31654a", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/a5d7eee95ba6f9a46364487e499820b1eb31654a", "committedDate": "2020-09-16T16:20:37Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66945e114c661b637dd664f6fa95d457f9167faf", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/66945e114c661b637dd664f6fa95d457f9167faf", "committedDate": "2020-09-23T15:28:17Z", "message": "DB-10195 Support 2 schemas with the same name in 2 different DBs (#4105)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* IBEX-10195 Address review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a81d3e1088ae7f527d6c5aff3c62a47512a119e", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/4a81d3e1088ae7f527d6c5aff3c62a47512a119e", "committedDate": "2020-09-30T16:36:06Z", "message": "DB-10196 Create new SPLICE schema for new database (#4119)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc53b299d5b304b3a58e1df5cf370949682b2bd7", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/fc53b299d5b304b3a58e1df5cf370949682b2bd7", "committedDate": "2020-09-30T17:11:18Z", "message": "DB-10200 Filter SYS tables for each DB in SYSVW (#4172)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6edb3cdca8c59a9e19ed108450c6286be0eacb9", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/b6edb3cdca8c59a9e19ed108450c6286be0eacb9", "committedDate": "2020-09-30T17:29:54Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77dcac136ab4f6f307de38a2d567476aebda1047", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/77dcac136ab4f6f307de38a2d567476aebda1047", "committedDate": "2020-09-30T17:22:11Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}, "afterCommit": {"oid": "b6edb3cdca8c59a9e19ed108450c6286be0eacb9", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/b6edb3cdca8c59a9e19ed108450c6286be0eacb9", "committedDate": "2020-09-30T17:29:54Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd47ff27159a35292e120137e9c4aee1d5d895eb", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/dd47ff27159a35292e120137e9c4aee1d5d895eb", "committedDate": "2020-10-07T14:55:09Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e7c850d7d171670be38341d8a2cc33c9c9ab1fa", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7e7c850d7d171670be38341d8a2cc33c9c9ab1fa", "committedDate": "2020-10-14T10:53:02Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f581828b93c534d702a5a873d8d4a424b9d7cdfc", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/f581828b93c534d702a5a873d8d4a424b9d7cdfc", "committedDate": "2020-10-20T13:30:27Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a156ecf97719de587d9fc0dfb6ef579bd7d3c77", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/8a156ecf97719de587d9fc0dfb6ef579bd7d3c77", "committedDate": "2020-10-21T15:33:07Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b3ff4b177fa3015de57629e2ffa64a547ce6cb8", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7b3ff4b177fa3015de57629e2ffa64a547ce6cb8", "committedDate": "2020-12-10T17:45:54Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ded724ea8ae5c45e6cb33c71e6e14db01ff1adb1", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/ded724ea8ae5c45e6cb33c71e6e14db01ff1adb1", "committedDate": "2020-12-10T19:34:19Z", "message": "DB-10222 Support CREATE/DROP database (#4240)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-10222 Fix spotbugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e06e56b1d3a5932d458c2fb9768ebc31f322148f", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/e06e56b1d3a5932d458c2fb9768ebc31f322148f", "committedDate": "2020-12-10T19:57:30Z", "message": "DB-10486 Support DROP DATABASE CASCADE (#4294)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82bb64ba2ab97ab2ba6527b301214d95680ed6b7", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/82bb64ba2ab97ab2ba6527b301214d95680ed6b7", "committedDate": "2020-12-10T21:53:47Z", "message": "DB-10199 Tie roles and users to their own database (#4280)\n\n* DB-10194 Multidatabase first commit\n\n* DB-10194 Support 'show databases' in sqlshell\n\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\n\n* DB-10194 Use placeholders in database authorizationId\n\n* DB-10194 Fix spotbugs\n\n* DB-10194 Fix more spotbugs\n\n* DB-10194 Fix even more spotbugs\n\n* DB-10194 Fix even more spotbugs\n\n* DB-10194 Fix aggressive assert\n\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\n\n* DB-10195 Fix spotbugs\n\n* DB-10195 Fix more spotbugs\n\n* DB-10195 Fix error\n\n* DB-10240 Rework test infra to accept DB parameter in connections\n\n* DB-10240 Fix CheckConstraintIT\n\n* DB-10240 Fix more tests\n\n* DB-10241 Remove old pass\n\n* DB-10240 Fix error with getDefaultLocalURL\n\n* DB-10196 Create new SPLICE schema for new database\n\n* IBEX-10195 Address review\n\n* DB-10200 Filter SYS tables for each DB in SYSVW\n\n* DB-10327 Add dbId to SchemaWatcher\n\n* DB-10200 Add ITs for multidatabase\n\n* DB-10327 Fix more ITs\n\n* Revert \"DB-10327 Fix more ITs\"\n\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\n\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\n\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\n\n* DB-10327 Keep original one parameter constructor\n\n* DB-10222 Support CREATE DATABASE\n\n* DB-10222 Support DROP DATABASE and rework DB creation\n\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\n\n* DB-10222 Cleanup\n\n* DB-10424 Fix spotbugs\n\n* DB-10424 Remove overzealous try-with-resources\n\n* DB-10024 support drop schema cascade\n\n* DB-10199 Tie sysroles to their own database\n\nSeems to work\n\nWIP Sysroles work\n\n* DB-10199 Tie sysusers to their own DB\n\n* DB-10199 Fix spotbugs\n\n* DB-10024 take care of cyclic dependency\n\n* DB-10496 Support drop database cascade\n\n* DB-10199 Drop cascade roles and user when drop DB cascade\n\n* DB-10486 Fix merge issue\n\n* DB-10424 Revert unwanted change in spotbugs\n\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\n\n* DB-10222 Fix spanish error message\n\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\n\n* DB-10199 Fix post merge issue\n\n* DB-10222 Fix more spotbugs\n\n* DB-10222 Fix compilation issues\n\n* DB-10562 Invalidate remote caches before dropping schema\n\n* DB-10199 Fix spotbugs\n\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c49ef3bea0b4f6818c86eb495331bd1b23cd44dc", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c49ef3bea0b4f6818c86eb495331bd1b23cd44dc", "committedDate": "2020-12-11T12:04:58Z", "message": "DB-10471 Restrict PERMS tables to their own DB (#4324)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a6bf39214f0ee17e9500d72bf23dbd7b9561f56", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/8a6bf39214f0ee17e9500d72bf23dbd7b9561f56", "committedDate": "2021-01-04T12:19:40Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f39065d3e5c9b0c481094cc77c0cf488a2a62e5c", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/f39065d3e5c9b0c481094cc77c0cf488a2a62e5c", "committedDate": "2021-01-04T12:06:21Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}, "afterCommit": {"oid": "8a6bf39214f0ee17e9500d72bf23dbd7b9561f56", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/8a6bf39214f0ee17e9500d72bf23dbd7b9561f56", "committedDate": "2021-01-04T12:19:40Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff31c50e12564db094e82c4cb18f56114b5d8e8f", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/ff31c50e12564db094e82c4cb18f56114b5d8e8f", "committedDate": "2021-01-22T18:43:04Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f74ce222020953ba8807a155cf5b55ebc2e957bf", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/f74ce222020953ba8807a155cf5b55ebc2e957bf", "committedDate": "2021-01-22T18:52:22Z", "message": "DB-10193 Fix merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41834d6865d8c80494006bdd6617ba9525b76e6f", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/41834d6865d8c80494006bdd6617ba9525b76e6f", "committedDate": "2021-01-25T10:29:58Z", "message": "DB-10472 Restrict sys visibility to only splicedb.splice - Other db owners can see everything in their db (#4850)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10472 Set sysdatabases.authorizationId to DB owner\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10472 Restrict SYS visibility to only spliceDB owner\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-11073 Serialize current schema in ActivationHolder\r\n\r\n* DB-10472 Properly set authorization and duplicate SYSCS_UTIL\r\n\r\n* DB-10472 Fix spotbugs\r\n\r\n* DB-10472 Address comments\r\n\r\n* DB-10472 Address comment\r\n\r\n* DB-10472 Fix merge conflict\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b25079b467bbff09afa33026717d38847caa887b", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/b25079b467bbff09afa33026717d38847caa887b", "committedDate": "2021-01-29T10:47:19Z", "message": "DB-11108 Use correct database ID in all DDLUtils.preDrop* (#4942)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10472 Set sysdatabases.authorizationId to DB owner\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10472 Restrict SYS visibility to only spliceDB owner\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-11073 Serialize current schema in ActivationHolder\r\n\r\n* DB-10472 Properly set authorization and duplicate SYSCS_UTIL\r\n\r\n* DB-10472 Fix spotbugs\r\n\r\n* DB-11108 Use correct database ID in all DDLUtils.preDrop*\r\n\r\n* DB-11108 Fix spotbgus\r\n\r\n* DB-10472 Address comments\r\n\r\n* DB-10472 Address comment\r\n\r\n* DB-10472 Fix merge conflict\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "451bd1dfff251fbcf1ea93419c39b67cb717b039", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/451bd1dfff251fbcf1ea93419c39b67cb717b039", "committedDate": "2021-01-29T11:36:04Z", "message": "DB-10554 Fix create parameter results (#4963)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10472 Set sysdatabases.authorizationId to DB owner\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10472 Restrict SYS visibility to only spliceDB owner\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-11073 Serialize current schema in ActivationHolder\r\n\r\n* DB-10472 Properly set authorization and duplicate SYSCS_UTIL\r\n\r\n* DB-10472 Fix spotbugs\r\n\r\n* DB-11108 Use correct database ID in all DDLUtils.preDrop*\r\n\r\n* DB-11108 Fix spotbgus\r\n\r\n* DB-10554 Fix create parameter results\r\n\r\nIf the DB already exists, connecting with create=true is properly ignored\r\nIf the DB does not exist, connecting with create=false now properly\r\nthrows 42Y18\r\n\r\n* DB-10472 Address comments\r\n\r\n* DB-10554 Fix start error\r\n\r\n* DB-10472 Address comment\r\n\r\n* DB-10472 Fix merge conflict\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e4523a534322265feebb664777822dabec30a06", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/0e4523a534322265feebb664777822dabec30a06", "committedDate": "2021-02-24T11:28:27Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db1311a767afbb6698edee1dd2d062093a76770e", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/db1311a767afbb6698edee1dd2d062093a76770e", "committedDate": "2021-02-26T12:01:04Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff927aee737b1ab85dbf086decdbaad37608866a", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/ff927aee737b1ab85dbf086decdbaad37608866a", "committedDate": "2021-02-26T12:07:11Z", "message": "DB-10201 Upgrade script for multi database (#5067)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10472 Set sysdatabases.authorizationId to DB owner\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10472 Restrict SYS visibility to only spliceDB owner\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-11073 Serialize current schema in ActivationHolder\r\n\r\n* DB-10472 Properly set authorization and duplicate SYSCS_UTIL\r\n\r\n* DB-10472 Fix spotbugs\r\n\r\n* DB-11108 Use correct database ID in all DDLUtils.preDrop*\r\n\r\n* DB-11108 Fix spotbgus\r\n\r\n* DB-10554 Fix create parameter results\r\n\r\nIf the DB already exists, connecting with create=true is properly ignored\r\nIf the DB does not exist, connecting with create=false now properly\r\nthrows 42Y18\r\n\r\n* DB-10472 Address comments\r\n\r\n* DB-10554 Fix start error\r\n\r\n* DB-10201 Upgrade script for multidb\r\n\r\n* DB-10472 Address comment\r\n\r\n* DB-10472 Fix merge conflict\r\n\r\n* DB-10201 Fix merge issue\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7a83910dbe38458357190af1897d02bdce20593", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/d7a83910dbe38458357190af1897d02bdce20593", "committedDate": "2021-03-02T14:14:19Z", "message": "DB-11130 Fix ITs in multidb branch (#5237)\n\n* DB-10194 Multidatabase first commit\r\n\r\n* DB-10194 Support 'show databases' in sqlshell\r\n\r\n* DB-10194 Create new database with correct uuid. New schemas use that uuid\r\n\r\n* DB-10194 Use placeholders in database authorizationId\r\n\r\n* DB-10194 Fix spotbugs\r\n\r\n* DB-10194 Fix more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix even more spotbugs\r\n\r\n* DB-10194 Fix aggressive assert\r\n\r\n* DB-10195 Support 2 schemas with the same name in 2 different DBs\r\n\r\n* DB-10195 Fix spotbugs\r\n\r\n* DB-10195 Fix more spotbugs\r\n\r\n* DB-10195 Fix error\r\n\r\n* DB-10240 Rework test infra to accept DB parameter in connections\r\n\r\n* DB-10240 Fix CheckConstraintIT\r\n\r\n* DB-10240 Fix more tests\r\n\r\n* DB-10241 Remove old pass\r\n\r\n* DB-10240 Fix error with getDefaultLocalURL\r\n\r\n* DB-10196 Create new SPLICE schema for new database\r\n\r\n* IBEX-10195 Address review\r\n\r\n* DB-10200 Filter SYS tables for each DB in SYSVW\r\n\r\n* DB-10327 Add dbId to SchemaWatcher\r\n\r\n* DB-10200 Add ITs for multidatabase\r\n\r\n* DB-10327 Fix more ITs\r\n\r\n* Revert \"DB-10327 Fix more ITs\"\r\n\r\nThis reverts commit 1de8fa0b193a8d8d9650db8737e030f5cd294bd2.\r\n\r\n* Revert \"DB-10327 Add dbId to SchemaWatcher\"\r\n\r\nThis reverts commit f7e29bb28b0a781b8b5dfae18c3032a333fd05f7.\r\n\r\n* DB-10327 Keep original one parameter constructor\r\n\r\n* DB-10222 Support CREATE DATABASE\r\n\r\n* DB-10222 Support DROP DATABASE and rework DB creation\r\n\r\n* DB-10222 Use dataDict.createNewDatabase instead of the system procedure\r\n\r\n* DB-10222 Cleanup\r\n\r\n* DB-10424 Fix spotbugs\r\n\r\n* DB-10424 Remove overzealous try-with-resources\r\n\r\n* DB-10024 support drop schema cascade\r\n\r\n* DB-10199 Tie sysroles to their own database\r\n\r\nSeems to work\r\n\r\nWIP Sysroles work\r\n\r\n* DB-10199 Tie sysusers to their own DB\r\n\r\n* DB-10199 Fix spotbugs\r\n\r\n* DB-10024 take care of cyclic dependency\r\n\r\n* DB-10496 Support drop database cascade\r\n\r\n* DB-10199 Drop cascade roles and user when drop DB cascade\r\n\r\n* DB-10471 Restrict PERMS tables to their own DB\r\n\r\n* DB-10486 Fix merge issue\r\n\r\n* DB-10471 Add tests\r\n\r\n* DB-10472 Set sysdatabases.authorizationId to DB owner\r\n\r\n* DB-10424 Revert unwanted change in spotbugs\r\n\r\n* DB-10562 Refactor SpliceTransactionResourceImpl.getMarshallTransaction\r\n\r\n* DB-10222 Fix spanish error message\r\n\r\n* DB-10222 Simplify LanguageConnectionContext creation to avoid throwing StandardExceptions\r\n\r\n* DB-10199 Fix post merge issue\r\n\r\n* DB-10222 Fix more spotbugs\r\n\r\n* DB-10472 Restrict SYS visibility to only spliceDB owner\r\n\r\n* DB-10222 Fix compilation issues\r\n\r\n* DB-10562 Invalidate remote caches before dropping schema\r\n\r\n* DB-11073 Serialize current schema in ActivationHolder\r\n\r\n* DB-10472 Properly set authorization and duplicate SYSCS_UTIL\r\n\r\n* DB-10472 Fix spotbugs\r\n\r\n* DB-11108 Use correct database ID in all DDLUtils.preDrop*\r\n\r\n* DB-11108 Fix spotbgus\r\n\r\n* DB-10554 Fix create parameter results\r\n\r\nIf the DB already exists, connecting with create=true is properly ignored\r\nIf the DB does not exist, connecting with create=false now properly\r\nthrows 42Y18\r\n\r\n* DB-10472 Address comments\r\n\r\n* DB-10554 Fix start error\r\n\r\n* DB-10201 Upgrade script for multidb\r\n\r\n* DB-10472 Address comment\r\n\r\n* DB-10472 Fix merge conflict\r\n\r\n* DB-11130 Fix unit tests\r\n\r\n* DB-10201 Fix merge issue\r\n\r\n* DB-11130 Fix unit test\r\n\r\n* DB-11130 Set current roles in SQLSessionContext\r\n\r\n* DB-11130 Do not use cached transaction if user requests another pastTxn\r\n\r\n* DB-11130 Fix more tests\r\n\r\n* DB-11130 Fix more tests\r\n\r\nLeft to fix:\r\n[ERROR] Tests run: 14, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 2.807 s <<< FAILURE! - in com.splicemachine.triggers.LoadReplaceModeIT\r\n[ERROR] Tests run: 38, Failures: 0, Errors: 3, Skipped: 0, Time elapsed: 32.802 s <<< FAILURE! - in com.splicemachine.triggers.Trigger_Referencing_Clause_IT\r\n[ERROR] Tests run: 17, Failures: 3, Errors: 0, Skipped: 0, Time elapsed: 2.249 s <<< FAILURE! - in com.splicemachine.derby.security.MetaDataAccessControlIT\r\n\r\n* DB-11130 Fix kryo serialization\r\n\r\n* DB-11130 Add more schemas to public views\r\n\r\n* DB-11130 Fix dbname in InternalDriver\r\n\r\n* DB-11130 Tag XXX in UpgradeScript\r\n\r\nCo-authored-by: yxia92 <yxia@splicemachine.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a18792fd694a066d7378ed82ab1355ec9eac562", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/4a18792fd694a066d7378ed82ab1355ec9eac562", "committedDate": "2021-03-10T13:29:26Z", "message": "DB-10258 Create parameter to disallow multidatabase creation (#5251)\n\n* DB-10258 Create parameter to disallow multidatabase creation\r\n\r\n* DB-10258 Fix spotbugs\r\n\r\n* DB-10258 Address comments\r\n\r\n* DB-11592 CREATE DATABASE FOODB creates dbOwner based on current user (#5252)\r\n\r\n* DB-11592 CREATE DATABASE FOO creates dbOwner based on current user\r\n\r\n* DB-11592 normalize user id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3de30864cd7e5007859781279585c4d4e0505675", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/3de30864cd7e5007859781279585c4d4e0505675", "committedDate": "2021-03-10T16:19:35Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA5MTg5MDgy", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-609189082", "createdAt": "2021-03-10T21:36:20Z", "commit": {"oid": "3de30864cd7e5007859781279585c4d4e0505675"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1c8354a591f495f7a8952e2373828483d81c016", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c1c8354a591f495f7a8952e2373828483d81c016", "committedDate": "2021-03-11T13:00:21Z", "message": "DB-10193 Fix upgrade"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87e05eb1b3bb25f18efc49c0f7a0f85d6d257c07", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/87e05eb1b3bb25f18efc49c0f7a0f85d6d257c07", "committedDate": "2021-03-17T18:26:01Z", "message": "DB-11603 Properly separate privileges drop when dropping roles (#5271)\n\n* DB-10258 Create parameter to disallow multidatabase creation\r\n\r\n* DB-10258 Fix spotbugs\r\n\r\n* DB-11592 CREATE DATABASE FOO creates dbOwner based on current user\r\n\r\n* DB-11592 normalize user id\r\n\r\n* DB-10258 Address comments\r\n\r\n* DB-11603 Properly separate privileges drop when dropping roles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a5132ff2b51317c4acc95a2001638a6fe941c7f", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/9a5132ff2b51317c4acc95a2001638a6fe941c7f", "committedDate": "2021-03-17T23:07:31Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c3e89f1d6bb56e65f484d9a9d03222f4a5ded31", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/1c3e89f1d6bb56e65f484d9a9d03222f4a5ded31", "committedDate": "2021-03-17T23:08:21Z", "message": "Merge branch 'DB-10193' of github.com:splicemachine/spliceengine into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c244443f633165d1fce03b4be7b693dc0d793dc", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/3c244443f633165d1fce03b4be7b693dc0d793dc", "committedDate": "2021-03-18T17:17:59Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f3b29d11e67a3284d5cff25fb965bbc0cdeece4", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/6f3b29d11e67a3284d5cff25fb965bbc0cdeece4", "committedDate": "2021-03-23T10:56:13Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ce32800afd37287977c023a290169c2371c61de", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/6ce32800afd37287977c023a290169c2371c61de", "committedDate": "2021-03-23T17:49:24Z", "message": "DB-10193 Fix IT error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a479ce983de9eb03ba7eae9fc965bd8f132f0921", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/a479ce983de9eb03ba7eae9fc965bd8f132f0921", "committedDate": "2021-04-21T20:46:16Z", "message": "DB-11024 Remove XXX comments to prepare multidb merge (#5342)\n\n* DB-10258 Create parameter to disallow multidatabase creation\r\n\r\n* DB-10258 Fix spotbugs\r\n\r\n* DB-11592 CREATE DATABASE FOO creates dbOwner based on current user\r\n\r\n* DB-11592 normalize user id\r\n\r\n* DB-10258 Address comments\r\n\r\n* DB-11603 Properly separate privileges drop when dropping roles\r\n\r\n* DB-11024 Remove first batch of XXX\r\n\r\n* DB-11024 More XXX removed\r\n\r\n* DB-11024 Remove more XXX\r\n\r\n* DB-11204 remove more XXX\r\n\r\n* DB-11024 Remove more XXX\r\n\r\n* DB-11024 Fix more XXX issues\r\n\r\n* DB-11024 Do not use database name to start the service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "818de4e55bd9ac4bfe995a77ed984287778e259d", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/818de4e55bd9ac4bfe995a77ed984287778e259d", "committedDate": "2021-05-14T23:40:53Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c61e81afcb14e3986ffbd8df8cd60389082f6165", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c61e81afcb14e3986ffbd8df8cd60389082f6165", "committedDate": "2021-05-15T00:06:30Z", "message": "DB-10193 Fix unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a0323037dd2aad3bd22b9046c9b2bbf75aad69e", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/8a0323037dd2aad3bd22b9046c9b2bbf75aad69e", "committedDate": "2021-05-17T12:49:19Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0e0ec372cc9bbf0151f80276059849040cd4355", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/e0e0ec372cc9bbf0151f80276059849040cd4355", "committedDate": "2021-05-17T12:52:21Z", "message": "DB-10193 Set proper upgrade version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18489270339c5c32a40201ef5e72c838f3fac5a5", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/18489270339c5c32a40201ef5e72c838f3fac5a5", "committedDate": "2021-05-27T09:24:31Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjY5OTk2MDQx", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-669996041", "createdAt": "2021-05-27T10:09:29Z", "commit": {"oid": "18489270339c5c32a40201ef5e72c838f3fac5a5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2becec2c77f6e0f014c8f2bd64738b3cb08aa3df", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/2becec2c77f6e0f014c8f2bd64738b3cb08aa3df", "committedDate": "2021-05-27T10:59:05Z", "message": "DB-10193 Make upgrade easier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a03bf7ec678bdb89b42094af620b7eace56dfa8", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7a03bf7ec678bdb89b42094af620b7eace56dfa8", "committedDate": "2021-05-27T14:34:45Z", "message": "DB-10193 Bump upgrade version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjcwMjg2OTMw", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-670286930", "createdAt": "2021-05-27T14:50:55Z", "commit": {"oid": "7a03bf7ec678bdb89b42094af620b7eace56dfa8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njc2OTA2ODEy", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-676906812", "createdAt": "2021-06-06T22:02:07Z", "commit": {"oid": "7a03bf7ec678bdb89b42094af620b7eace56dfa8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNi0wNlQyMjowMjowN1rOJoQiNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNi0wNlQyMjowMjowN1rOJoQiNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjE5MzcxNw==", "bodyText": "This is not necessary because it is always executed(SpliceCatalogUpgradeScripts.runUpgrades) for database upgrade", "url": "https://github.com/splicemachine/spliceengine/pull/4206#discussion_r646193717", "createdAt": "2021-06-06T22:02:07Z", "author": {"login": "jyuanca"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/upgrade/UpgradeScriptToAddMultiDatabaseSupport.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright (c) 2012 - 2020 Splice Machine, Inc.\n+ *\n+ * This file is part of Splice Machine.\n+ * Splice Machine is free software: you can redistribute it and/or modify it under the terms of the\n+ * GNU Affero General Public License as published by the Free Software Foundation, either\n+ * version 3, or (at your option) any later version.\n+ * Splice Machine is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n+ * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n+ * See the GNU Affero General Public License for more details.\n+ * You should have received a copy of the GNU Affero General Public License along with Splice Machine.\n+ * If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package com.splicemachine.derby.impl.sql.catalog.upgrade;\n+\n+import com.splicemachine.db.iapi.error.StandardException;\n+import com.splicemachine.db.iapi.store.access.TransactionController;\n+import com.splicemachine.derby.impl.sql.catalog.SpliceDataDictionary;\n+import com.splicemachine.utils.SpliceLogUtils;\n+\n+import java.util.Properties;\n+\n+public class UpgradeScriptToAddMultiDatabaseSupport extends UpgradeScriptBase {\n+    public UpgradeScriptToAddMultiDatabaseSupport(SpliceDataDictionary sdd, TransactionController tc, Properties startParams) {\n+        super(sdd, tc);\n+        this.startParams = startParams;\n+    }\n+\n+    private Properties startParams;\n+\n+    @Override\n+    protected void upgradeSystemTables() throws StandardException {\n+        sdd.createSysDatabasesTableAndAddDatabaseIdColumnsToSysTables(tc, startParams);\n+\n+        // Refresh views\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSSCHEMASVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSALLROLES\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSTABLESVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSCOLPERMSVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSPERMSVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSROUTINEPERMSVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSSCHEMAPERMSVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSTABLEPERMSVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSIBM\", \"SYSCOLUMNS\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSIBM\", \"SYSTABLES\");\n+\n+        // Add new views\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSSEQUENCESVIEW\");\n+        sdd.createOrUpdateSystemView(tc, \"SYSVW\", \"SYSDATABASESVIEW\");\n+\n+        sdd.updateMetadataSPSes(tc);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a03bf7ec678bdb89b42094af620b7eace56dfa8"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07d836c5cfae026477c32a43aaf935a3b0855ead", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/07d836c5cfae026477c32a43aaf935a3b0855ead", "committedDate": "2021-06-07T15:18:24Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "530a58f52fc94fb2aa4502cc12cd1597dac444c5", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/530a58f52fc94fb2aa4502cc12cd1597dac444c5", "committedDate": "2021-06-08T09:04:07Z", "message": "DB-10193 Fix merge issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92d359cdffd230828e11e8163e2a635c391385f4", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/92d359cdffd230828e11e8163e2a635c391385f4", "committedDate": "2021-06-10T12:34:55Z", "message": "DB-10193 Simplify upgrade script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "330aed3f82ce86c3075ed5d9d66310818352c590", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/330aed3f82ce86c3075ed5d9d66310818352c590", "committedDate": "2021-06-10T12:36:18Z", "message": "DB-10193 Target sprint 2020"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb88f45993ab4f898b4c3d80f2486a179ecaa109", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/fb88f45993ab4f898b4c3d80f2486a179ecaa109", "committedDate": "2021-06-10T12:39:20Z", "message": "Merge remote-tracking branch 'origin/master' into DB-10193"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjgwNzkxODc4", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-680791878", "createdAt": "2021-06-10T13:35:31Z", "commit": {"oid": "fb88f45993ab4f898b4c3d80f2486a179ecaa109"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjgxMjkwODc4", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-681290878", "createdAt": "2021-06-10T21:52:29Z", "commit": {"oid": "fb88f45993ab4f898b4c3d80f2486a179ecaa109"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cdeb7f6939891f496511e455c5dc7879efcf738", "author": {"user": {"login": "arnaud-splice", "name": "Arnaud Lacurie"}}, "url": "https://github.com/splicemachine/spliceengine/commit/3cdeb7f6939891f496511e455c5dc7879efcf738", "committedDate": "2021-06-11T08:56:53Z", "message": "DB-10193 Fix unit test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg0NTA5MDc0", "url": "https://github.com/splicemachine/spliceengine/pull/4206#pullrequestreview-684509074", "createdAt": "2021-06-15T21:31:25Z", "commit": {"oid": "3cdeb7f6939891f496511e455c5dc7879efcf738"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1137, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}