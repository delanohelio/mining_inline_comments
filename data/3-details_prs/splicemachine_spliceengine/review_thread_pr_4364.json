{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4OTQ2MjEx", "number": 4364, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoxNzoyNlrOExM6hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoxNzoyNlrOExM6hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDI3MjcxOnYy", "diffSide": "RIGHT", "path": "hbase_storage/src/main/java/com/splicemachine/si/impl/region/HBaseTxnFinder.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoxNzoyNlrOHnNbpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOTo0NjowNFrOHozUxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NjU4MA==", "bodyText": "filterRowKey should only filter based on the rowkey, here you are looking at specific values. This is most likely called only once per row.\nI'm guessing the current implementation wouldn't work on SPLICE_TXN, since we'd inspect the latest written cell (COMMITTED or ROLLEDBACK), see that it's not the ACTIVE state and filter it out, which would filter out the whole row.", "url": "https://github.com/splicemachine/spliceengine/pull/4364#discussion_r510876580", "createdAt": "2020-10-23T13:17:26Z", "author": {"login": "dgomezferro"}, "path": "hbase_storage/src/main/java/com/splicemachine/si/impl/region/HBaseTxnFinder.java", "diffHunk": "@@ -89,15 +92,81 @@ public void close() throws IOException {\n         }\n     }\n \n+    private static class TxWithTimestampFilter extends FilterBase {\n+\n+        @Override\n+        public boolean filterRowKey(Cell cell) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "270ff9bda427f8729fb83714d5079c0ee176643e"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyOTg0NA==", "bodyText": "Thanks Daniel, I fixed it, now we simply return false in filterRowKey() method and I provided an implementation for filterCell instead, which returns INCLUDE for ACTIVE state.", "url": "https://github.com/splicemachine/spliceengine/pull/4364#discussion_r511029844", "createdAt": "2020-10-23T17:22:33Z", "author": {"login": "hatyo"}, "path": "hbase_storage/src/main/java/com/splicemachine/si/impl/region/HBaseTxnFinder.java", "diffHunk": "@@ -89,15 +92,81 @@ public void close() throws IOException {\n         }\n     }\n \n+    private static class TxWithTimestampFilter extends FilterBase {\n+\n+        @Override\n+        public boolean filterRowKey(Cell cell) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NjU4MA=="}, "originalCommit": {"oid": "270ff9bda427f8729fb83714d5079c0ee176643e"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0NTk5MA==", "bodyText": "Looks good, I think you don't need to implement it at all, the implementation on the super class should be good too, but it's OK with me.", "url": "https://github.com/splicemachine/spliceengine/pull/4364#discussion_r512545990", "createdAt": "2020-10-27T09:46:04Z", "author": {"login": "dgomezferro"}, "path": "hbase_storage/src/main/java/com/splicemachine/si/impl/region/HBaseTxnFinder.java", "diffHunk": "@@ -89,15 +92,81 @@ public void close() throws IOException {\n         }\n     }\n \n+    private static class TxWithTimestampFilter extends FilterBase {\n+\n+        @Override\n+        public boolean filterRowKey(Cell cell) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3NjU4MA=="}, "originalCommit": {"oid": "270ff9bda427f8729fb83714d5079c0ee176643e"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2831, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}