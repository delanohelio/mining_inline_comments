{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2ODE5NjQy", "number": 3461, "title": "DB-9109 Fix sporadics in jenkins due to overwrite of git data in tests", "bodyText": "", "createdAt": "2020-04-21T18:01:09Z", "url": "https://github.com/splicemachine/spliceengine/pull/3461", "merged": true, "mergeCommit": {"oid": "324fe95228559f6e90cf7ce17792eae860a8e969"}, "closed": true, "closedAt": "2020-04-29T01:33:53Z", "author": {"login": "martinrupp"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ3jdfAH2gAyNDA2ODE5NjQyOjJiMGRjNzliMjJkNDZlZWY4YmM1YmMzZmI4MDE4N2U3MDIyMTA1ZGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccOReNgFqTQwMjMxODYyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b0dc79b22d46eef8bc5bc3fb80187e7022105da", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/2b0dc79b22d46eef8bc5bc3fb80187e7022105da", "committedDate": "2020-04-21T17:57:42Z", "message": "DB-9109 Fix sporadics in jenkins due to overwrite of git data in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Nzc2ODI5", "url": "https://github.com/splicemachine/spliceengine/pull/3461#pullrequestreview-397776829", "createdAt": "2020-04-22T01:15:04Z", "commit": {"oid": "2b0dc79b22d46eef8bc5bc3fb80187e7022105da"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMToxNTowNVrOGJe9ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMToxNTowNVrOGJe9ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU5NzY5OQ==", "bodyText": "There are currently four ITs putting the test files in this directory: ExternalTableIT, ExternalTablePartitionIT, ShowCreateTableIT, ViewsInSysibmIT. When these tests are running in parallel, would this call accidentally delete the files that are generated by other tests?  Could this be a possible source of intermittent test failure or wrong result?", "url": "https://github.com/splicemachine/spliceengine/pull/3461#discussion_r412597699", "createdAt": "2020-04-22T01:15:05Z", "author": {"login": "yxia92"}, "path": "hbase_sql/src/test/java/com/splicemachine/derby/impl/sql/execute/operations/ExternalTableIT.java", "diffHunk": "@@ -54,19 +54,13 @@\n     public static TestRule chain = RuleChain.outerRule(spliceClassWatcher)\n             .around(spliceSchemaWatcher);\n \n+    // this will cleanup all files created in the dir getExternalResourceDirectory()\n+    // (if you insert into external tables, you create files)\n     @BeforeClass\n     public static void cleanoutDirectory() {\n-        try {\n-            File file = new File(getExternalResourceDirectory());\n-            if (file.exists())\n-                FileUtils.deleteDirectory(new File(getExternalResourceDirectory()));\n-            file.mkdir();\n-        } catch (Exception e) {\n-            throw new RuntimeException(e);\n-        }\n+        SpliceUnitTest.clearDirectory( getExternalResourceDirectory() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b0dc79b22d46eef8bc5bc3fb80187e7022105da"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjUzOTAy", "url": "https://github.com/splicemachine/spliceengine/pull/3461#pullrequestreview-399653902", "createdAt": "2020-04-24T05:42:28Z", "commit": {"oid": "2b0dc79b22d46eef8bc5bc3fb80187e7022105da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78feb4af840d0cf88b288f3878fa380054ff4915", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/78feb4af840d0cf88b288f3878fa380054ff4915", "committedDate": "2020-04-24T16:40:16Z", "message": "DB-9109 fix problems with parallel runs of tests all writing to xxx/target/external\n\nevery test that needs a temporary output dir will now on-demand create a temp directory,\nthat will be deleted automatically after the test has run, using the @After annotation of JUnit."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7c41c757d6f4733c74959e34b1b6c100f03d0cf", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c7c41c757d6f4733c74959e34b1b6c100f03d0cf", "committedDate": "2020-04-24T17:30:17Z", "message": "Merge remote-tracking branch 'origin/branch-3.0' into DB-9109-3.0"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de2c82486153894b993b9229a9acaf88db78d376", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/de2c82486153894b993b9229a9acaf88db78d376", "committedDate": "2020-04-24T17:27:42Z", "message": "Merge remote-tracking branch 'origin/branch-3.0' into DB-9109-3.0"}, "afterCommit": {"oid": "c7c41c757d6f4733c74959e34b1b6c100f03d0cf", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c7c41c757d6f4733c74959e34b1b6c100f03d0cf", "committedDate": "2020-04-24T17:30:17Z", "message": "Merge remote-tracking branch 'origin/branch-3.0' into DB-9109-3.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c98fa107630c6c75d836d51d7b54678fdcbe1b8", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7c98fa107630c6c75d836d51d7b54678fdcbe1b8", "committedDate": "2020-04-27T17:44:28Z", "message": "DB-9109 fix / missing in directory leading to temp dir leak\n\ndelete temporary files created in two places"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d9c0b75037e33311c34480dd1972a0453552c05", "author": {"user": {"login": "martinrupp", "name": "Martin Rupp"}}, "url": "https://github.com/splicemachine/spliceengine/commit/4d9c0b75037e33311c34480dd1972a0453552c05", "committedDate": "2020-04-27T17:44:33Z", "message": "DB-9109 create temp files in /target/external so build is self-contained"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzAxMDA1", "url": "https://github.com/splicemachine/spliceengine/pull/3461#pullrequestreview-401301005", "createdAt": "2020-04-27T20:28:07Z", "commit": {"oid": "4d9c0b75037e33311c34480dd1972a0453552c05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMjc2MDkw", "url": "https://github.com/splicemachine/spliceengine/pull/3461#pullrequestreview-402276090", "createdAt": "2020-04-28T23:14:21Z", "commit": {"oid": "4d9c0b75037e33311c34480dd1972a0453552c05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzE4NjIx", "url": "https://github.com/splicemachine/spliceengine/pull/3461#pullrequestreview-402318621", "createdAt": "2020-04-29T01:33:43Z", "commit": {"oid": "4d9c0b75037e33311c34480dd1972a0453552c05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1372, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}