{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2Njk4Mjk5", "number": 4321, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDoyMzoxN1rOEyRvww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwNTo0MjoxMlrOE3j92w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTU1MDExOnYy", "diffSide": "RIGHT", "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/upgrade/SpliceCatalogUpgradeScripts.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDoyMzoxN1rOHo00tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTo0MDoyMlrOHxyZWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU3MDU1MA==", "bodyText": "i think we're now at 1983", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r512570550", "createdAt": "2020-10-27T10:23:17Z", "author": {"login": "martinrupp"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/upgrade/SpliceCatalogUpgradeScripts.java", "diffHunk": "@@ -78,6 +78,7 @@ else if(v1==v2)\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1977), new UpgradeScriptToAddSysKeyColUseViewInSYSIBM(sdd, tc));\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1979), new UpgradeScriptForTablePriorities(sdd, tc));\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1979), new UpgradeScriptToSetJavaClassNameColumnInSYSALIASES(sdd, tc));\n+        scripts.put(new Splice_DD_Version(sdd,3,1,0, 1981), new UpgradeScriptToAddSysNaturalNumbersTable(sdd, tc));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2Nzk2Mw==", "bodyText": "Done, changed the version number to 3.2.0.1985.", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r521967963", "createdAt": "2020-11-12T09:40:22Z", "author": {"login": "ascend1"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/upgrade/SpliceCatalogUpgradeScripts.java", "diffHunk": "@@ -78,6 +78,7 @@ else if(v1==v2)\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1977), new UpgradeScriptToAddSysKeyColUseViewInSYSIBM(sdd, tc));\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1979), new UpgradeScriptForTablePriorities(sdd, tc));\n         scripts.put(new Splice_DD_Version(sdd,3,1,0, 1979), new UpgradeScriptToSetJavaClassNameColumnInSYSALIASES(sdd, tc));\n+        scripts.put(new Splice_DD_Version(sdd,3,1,0, 1981), new UpgradeScriptToAddSysNaturalNumbersTable(sdd, tc));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU3MDU1MA=="}, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzQyMTc5OnYy", "diffSide": "RIGHT", "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMDoyOTozMFrOHsomeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDoxNjoxM1rOHxz2aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU2NDYwMQ==", "bodyText": "why 2048? should be a constant in my opinion", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r516564601", "createdAt": "2020-11-03T10:29:30Z", "author": {"login": "martinrupp"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -367,6 +370,51 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    private TabInfoImpl getNaturalNumbersTable() throws StandardException{\n+        if(naturalNumbersTable==null){\n+            naturalNumbersTable=new TabInfoImpl(new SYSNATURALNUMBERSRowFactory(uuidFactory,exFactory,dvf, this));\n+        }\n+        initSystemIndexVariables(naturalNumbersTable);\n+        return naturalNumbersTable;\n+    }\n+\n+    /**\n+     * Populate SYSNATURALNUMBERS table with 1-2048.\n+     *\n+     * @throws StandardException Standard Derby error policy\n+     */\n+    private void populateSYSNATURALNUMBERS(TransactionController tc) throws StandardException{\n+        TabInfoImpl ti = getNonCoreTI(SYSNATURALNUMBERS_CATALOG_NUM);\n+        for (int i = 1; i <= 2048; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk5MTc4Nw==", "bodyText": "No particular reason for this, just that SQL Server has this table (similar purpose but not exactly the same ofc) with 2048 values.\nSince I move the loop to row factory, I make a new constant in row factory class.", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r521991787", "createdAt": "2020-11-12T10:16:13Z", "author": {"login": "ascend1"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -367,6 +370,51 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    private TabInfoImpl getNaturalNumbersTable() throws StandardException{\n+        if(naturalNumbersTable==null){\n+            naturalNumbersTable=new TabInfoImpl(new SYSNATURALNUMBERSRowFactory(uuidFactory,exFactory,dvf, this));\n+        }\n+        initSystemIndexVariables(naturalNumbersTable);\n+        return naturalNumbersTable;\n+    }\n+\n+    /**\n+     * Populate SYSNATURALNUMBERS table with 1-2048.\n+     *\n+     * @throws StandardException Standard Derby error policy\n+     */\n+    private void populateSYSNATURALNUMBERS(TransactionController tc) throws StandardException{\n+        TabInfoImpl ti = getNonCoreTI(SYSNATURALNUMBERS_CATALOG_NUM);\n+        for (int i = 1; i <= 2048; i++) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU2NDYwMQ=="}, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzQzMDUxOnYy", "diffSide": "RIGHT", "path": "splice_machine/src/test/java/com/splicemachine/derby/test/framework/SpliceUnitTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMDozMTozOFrOHsorsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMDozMTozOFrOHsorsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU2NTkzNw==", "bodyText": "cool", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r516565937", "createdAt": "2020-11-03T10:31:38Z", "author": {"login": "martinrupp"}, "path": "splice_machine/src/test/java/com/splicemachine/derby/test/framework/SpliceUnitTest.java", "diffHunk": "@@ -319,6 +319,25 @@ protected void rowContainsQuery(int level, String query, String contains, Splice\n         }\n     }\n \n+    protected void columnInRowsContainsQuery(int[] levels, int columnPosition, String query, SpliceWatcher methodWatcher, String... contains) throws Exception {\n+        try(ResultSet resultSet = methodWatcher.executeQuery(query)){\n+            int i=0;\n+            int k=0;\n+            while(resultSet.next()){\n+                i++;\n+                for(int level : levels){\n+                    if(level==i){\n+                        Assert.assertTrue(\"failed query at level (\"+level+\"): \\n\"+query+\"\\nExpected: \"+contains[k]+\"\\nWas: \"\n+                                +resultSet.getString(columnPosition),resultSet.getString(columnPosition).contains(contains[k]));\n+                        k++;\n+                    }\n+                }\n+            }\n+            if (k < contains.length)\n+                fail(\"fail to match the given strings\");\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzQzNDM3OnYy", "diffSide": "RIGHT", "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMDozMjo0NFrOHsouIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDoxNDo1MFrOHxzy3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU2NjU2MA==", "bodyText": "shouldn't we maybe put this in SYSNATURALNUMBERSRowFactory.java? Otherwise SpliceDataDictionary one day will be 20'000 lines long, basically taking care of \"everything\".", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r516566560", "createdAt": "2020-11-03T10:32:44Z", "author": {"login": "martinrupp"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -367,6 +370,51 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    private TabInfoImpl getNaturalNumbersTable() throws StandardException{\n+        if(naturalNumbersTable==null){\n+            naturalNumbersTable=new TabInfoImpl(new SYSNATURALNUMBERSRowFactory(uuidFactory,exFactory,dvf, this));\n+        }\n+        initSystemIndexVariables(naturalNumbersTable);\n+        return naturalNumbersTable;\n+    }\n+\n+    /**\n+     * Populate SYSNATURALNUMBERS table with 1-2048.\n+     *\n+     * @throws StandardException Standard Derby error policy\n+     */\n+    private void populateSYSNATURALNUMBERS(TransactionController tc) throws StandardException{\n+        TabInfoImpl ti = getNonCoreTI(SYSNATURALNUMBERS_CATALOG_NUM);\n+        for (int i = 1; i <= 2048; i++) {\n+            NaturalNumberDescriptor nnd = new NaturalNumberDescriptor(i);\n+            ExecRow row = ti.getCatalogRowFactory().makeRow(nnd, null);\n+            // ignore return value because sysnaturalnumbers does not have indexes\n+            ti.insertRow(row, tc);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk5MDg3OQ==", "bodyText": "Good point! I move the main logic to the row factory. However, is wrapper has to be in SpliceDataDictionary because we need to get the TabInfoImpl from data dictionary'snonCoreTI.", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r521990879", "createdAt": "2020-11-12T10:14:50Z", "author": {"login": "ascend1"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -367,6 +370,51 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    private TabInfoImpl getNaturalNumbersTable() throws StandardException{\n+        if(naturalNumbersTable==null){\n+            naturalNumbersTable=new TabInfoImpl(new SYSNATURALNUMBERSRowFactory(uuidFactory,exFactory,dvf, this));\n+        }\n+        initSystemIndexVariables(naturalNumbersTable);\n+        return naturalNumbersTable;\n+    }\n+\n+    /**\n+     * Populate SYSNATURALNUMBERS table with 1-2048.\n+     *\n+     * @throws StandardException Standard Derby error policy\n+     */\n+    private void populateSYSNATURALNUMBERS(TransactionController tc) throws StandardException{\n+        TabInfoImpl ti = getNonCoreTI(SYSNATURALNUMBERS_CATALOG_NUM);\n+        for (int i = 1; i <= 2048; i++) {\n+            NaturalNumberDescriptor nnd = new NaturalNumberDescriptor(i);\n+            ExecRow row = ti.getCatalogRowFactory().makeRow(nnd, null);\n+            // ignore return value because sysnaturalnumbers does not have indexes\n+            ti.insertRow(row, tc);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU2NjU2MA=="}, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2Njk2NDExOnYy", "diffSide": "RIGHT", "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/catalog/SYSNATURALNUMBERSRowFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwNTo0MjoxMlrOHw-9GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDoxODoyNlrOHxz70w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTEyNTE0NQ==", "bodyText": "This is a base table row, not an index row,  should we use getValueRow() instead?", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r521125145", "createdAt": "2020-11-11T05:42:12Z", "author": {"login": "yxia92"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/catalog/SYSNATURALNUMBERSRowFactory.java", "diffHunk": "@@ -0,0 +1,148 @@\n+/*\n+ * This file is part of Splice Machine.\n+ * Splice Machine is free software: you can redistribute it and/or modify it under the terms of the\n+ * GNU Affero General Public License as published by the Free Software Foundation, either\n+ * version 3, or (at your option) any later version.\n+ * Splice Machine is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n+ * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n+ * See the GNU Affero General Public License for more details.\n+ * You should have received a copy of the GNU Affero General Public License along with Splice Machine.\n+ * If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ * Some parts of this source code are based on Apache Derby, and the following notices apply to\n+ * Apache Derby:\n+ *\n+ * Apache Derby is a subproject of the Apache DB project, and is licensed under\n+ * the Apache License, Version 2.0 (the \"License\"); you may not use these files\n+ * except in compliance with the License. You may obtain a copy of the License at:\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed\n+ * under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n+ * CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * Splice Machine, Inc. has modified the Apache Derby code in this file.\n+ *\n+ * All such Splice Machine modifications are Copyright 2012 - 2020 Splice Machine, Inc.,\n+ * and are licensed to you under the GNU Affero General Public License.\n+ */\n+\n+package com.splicemachine.db.impl.sql.catalog;\n+\n+import com.splicemachine.db.iapi.error.StandardException;\n+import com.splicemachine.db.iapi.services.sanity.SanityManager;\n+import com.splicemachine.db.iapi.services.uuid.UUIDFactory;\n+import com.splicemachine.db.iapi.sql.dictionary.*;\n+import com.splicemachine.db.iapi.sql.execute.ExecIndexRow;\n+import com.splicemachine.db.iapi.sql.execute.ExecRow;\n+import com.splicemachine.db.iapi.sql.execute.ExecutionFactory;\n+import com.splicemachine.db.iapi.types.DataValueFactory;\n+import com.splicemachine.db.iapi.types.SQLInteger;\n+\n+import java.sql.Types;\n+\n+/**\n+ * Factory for creating a SYSNATURALNUMBERS row.\n+ */\n+\n+public class SYSNATURALNUMBERSRowFactory extends CatalogRowFactory\n+{\n+    private static final String TABLENAME_STRING = \"SYSNATURALNUMBERS\";\n+\n+    private static final int SYSNATURALNUMBERS_COLUMN_COUNT = 1;\n+    private static final int SYSNATURALNUMBERS_N = 1;\n+\n+    private static final String[] uuids =\n+    {\n+         \"9ddbc69f-c5fa-4ca8-8b95-aa3bd1e266a4\"    // catalog UUID\n+        ,\"9ddbc69f-c60b-4ca8-8b95-aa3bd1e266a4\"    // heap UUID\n+    };\n+\n+    /////////////////////////////////////////////////////////////////////////////\n+    //\n+    //    CONSTRUCTORS\n+    //\n+    /////////////////////////////////////////////////////////////////////////////\n+\n+    public SYSNATURALNUMBERSRowFactory(UUIDFactory uuidf, ExecutionFactory ef, DataValueFactory dvf, DataDictionary dd)\n+    {\n+        super(uuidf,ef,dvf,dd);\n+        initInfo(SYSNATURALNUMBERS_COLUMN_COUNT, TABLENAME_STRING, indexColumnPositions, null, uuids);\n+    }\n+\n+    /////////////////////////////////////////////////////////////////////////////\n+    //\n+    //    METHODS\n+    //\n+    /////////////////////////////////////////////////////////////////////////////\n+\n+    /**\n+     * Make a SYSNATURALNUMBERS row\n+     *\n+     * @param td NaturalNumberDescriptor\n+     *\n+     * @return Row suitable for inserting into SYSNATURALNUMBERS.\n+     *\n+     * @exception StandardException thrown on failure\n+     */\n+    public ExecRow makeRow(boolean latestVersion, TupleDescriptor td, TupleDescriptor parent)\n+\t\t\tthrows StandardException\n+    {\n+        ExecIndexRow row;\n+        int value = -1;\n+\n+        if (td != null) {\n+            if (!(td instanceof NaturalNumberDescriptor))\n+                throw new RuntimeException(\"Unexpected TupleDescriptor \" + td.getClass().getName());\n+\n+            NaturalNumberDescriptor nnd = (NaturalNumberDescriptor)td;\n+            value = nnd.getValue();\n+        }\n+\n+        row = getExecutionFactory().getIndexableRow(SYSNATURALNUMBERS_COLUMN_COUNT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk5MzE3MQ==", "bodyText": "Good catch! I changed it to ExecRow and use getValueRow() instead.", "url": "https://github.com/splicemachine/spliceengine/pull/4321#discussion_r521993171", "createdAt": "2020-11-12T10:18:26Z", "author": {"login": "ascend1"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/catalog/SYSNATURALNUMBERSRowFactory.java", "diffHunk": "@@ -0,0 +1,148 @@\n+/*\n+ * This file is part of Splice Machine.\n+ * Splice Machine is free software: you can redistribute it and/or modify it under the terms of the\n+ * GNU Affero General Public License as published by the Free Software Foundation, either\n+ * version 3, or (at your option) any later version.\n+ * Splice Machine is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n+ * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n+ * See the GNU Affero General Public License for more details.\n+ * You should have received a copy of the GNU Affero General Public License along with Splice Machine.\n+ * If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ * Some parts of this source code are based on Apache Derby, and the following notices apply to\n+ * Apache Derby:\n+ *\n+ * Apache Derby is a subproject of the Apache DB project, and is licensed under\n+ * the Apache License, Version 2.0 (the \"License\"); you may not use these files\n+ * except in compliance with the License. You may obtain a copy of the License at:\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed\n+ * under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n+ * CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * Splice Machine, Inc. has modified the Apache Derby code in this file.\n+ *\n+ * All such Splice Machine modifications are Copyright 2012 - 2020 Splice Machine, Inc.,\n+ * and are licensed to you under the GNU Affero General Public License.\n+ */\n+\n+package com.splicemachine.db.impl.sql.catalog;\n+\n+import com.splicemachine.db.iapi.error.StandardException;\n+import com.splicemachine.db.iapi.services.sanity.SanityManager;\n+import com.splicemachine.db.iapi.services.uuid.UUIDFactory;\n+import com.splicemachine.db.iapi.sql.dictionary.*;\n+import com.splicemachine.db.iapi.sql.execute.ExecIndexRow;\n+import com.splicemachine.db.iapi.sql.execute.ExecRow;\n+import com.splicemachine.db.iapi.sql.execute.ExecutionFactory;\n+import com.splicemachine.db.iapi.types.DataValueFactory;\n+import com.splicemachine.db.iapi.types.SQLInteger;\n+\n+import java.sql.Types;\n+\n+/**\n+ * Factory for creating a SYSNATURALNUMBERS row.\n+ */\n+\n+public class SYSNATURALNUMBERSRowFactory extends CatalogRowFactory\n+{\n+    private static final String TABLENAME_STRING = \"SYSNATURALNUMBERS\";\n+\n+    private static final int SYSNATURALNUMBERS_COLUMN_COUNT = 1;\n+    private static final int SYSNATURALNUMBERS_N = 1;\n+\n+    private static final String[] uuids =\n+    {\n+         \"9ddbc69f-c5fa-4ca8-8b95-aa3bd1e266a4\"    // catalog UUID\n+        ,\"9ddbc69f-c60b-4ca8-8b95-aa3bd1e266a4\"    // heap UUID\n+    };\n+\n+    /////////////////////////////////////////////////////////////////////////////\n+    //\n+    //    CONSTRUCTORS\n+    //\n+    /////////////////////////////////////////////////////////////////////////////\n+\n+    public SYSNATURALNUMBERSRowFactory(UUIDFactory uuidf, ExecutionFactory ef, DataValueFactory dvf, DataDictionary dd)\n+    {\n+        super(uuidf,ef,dvf,dd);\n+        initInfo(SYSNATURALNUMBERS_COLUMN_COUNT, TABLENAME_STRING, indexColumnPositions, null, uuids);\n+    }\n+\n+    /////////////////////////////////////////////////////////////////////////////\n+    //\n+    //    METHODS\n+    //\n+    /////////////////////////////////////////////////////////////////////////////\n+\n+    /**\n+     * Make a SYSNATURALNUMBERS row\n+     *\n+     * @param td NaturalNumberDescriptor\n+     *\n+     * @return Row suitable for inserting into SYSNATURALNUMBERS.\n+     *\n+     * @exception StandardException thrown on failure\n+     */\n+    public ExecRow makeRow(boolean latestVersion, TupleDescriptor td, TupleDescriptor parent)\n+\t\t\tthrows StandardException\n+    {\n+        ExecIndexRow row;\n+        int value = -1;\n+\n+        if (td != null) {\n+            if (!(td instanceof NaturalNumberDescriptor))\n+                throw new RuntimeException(\"Unexpected TupleDescriptor \" + td.getClass().getName());\n+\n+            NaturalNumberDescriptor nnd = (NaturalNumberDescriptor)td;\n+            value = nnd.getValue();\n+        }\n+\n+        row = getExecutionFactory().getIndexableRow(SYSNATURALNUMBERS_COLUMN_COUNT);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTEyNTE0NQ=="}, "originalCommit": {"oid": "f663cf992f8b7b8e90003d38f8f7b0a949a798d3"}, "originalPosition": 104}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2894, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}