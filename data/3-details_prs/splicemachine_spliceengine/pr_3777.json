{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MjU4MDg0", "number": 3777, "title": "DB-9171 Allow defining unique and PK constraint on same column(s)", "bodyText": "Some SQL generation tools (e.g. SQLAlchemy) generate a DDL\nstatement against SpliceMachine containing PK and UQ constraints\non the same set of columns.\nThe fix allow this syntax, but under the hood it ignores the UQ\nconstraint since it is redundant.\nIf a user attempts to add a redundant UQ constraint via ALTER table\nthen we still throw an exception.\nAdd tests and address SpotBug reported issues on affected files.", "createdAt": "2020-07-08T13:51:23Z", "url": "https://github.com/splicemachine/spliceengine/pull/3777", "merged": true, "mergeCommit": {"oid": "a12f0d1f89b5e00fafe5a3505b456e2bda2681fd"}, "closed": true, "closedAt": "2020-07-14T23:37:07Z", "author": {"login": "hatyo"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcy6sZcgH2gAyNDQ2MjU4MDg0OmUyYjkyY2UxN2I4NzgxY2NiZGU2MDFkMWFlNjM0ZjFmYjBiNTQyNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0Z6qpgFqTQ0Njk3NzA1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e2b92ce17b8781ccbde601d1ae634f1fb0b5424a", "author": {"user": {"login": "hatyo", "name": "Youssef Hatem"}}, "url": "https://github.com/splicemachine/spliceengine/commit/e2b92ce17b8781ccbde601d1ae634f1fb0b5424a", "committedDate": "2020-07-08T13:45:17Z", "message": "DB-9171 Allow defining unique constraint and PK constraint on same column.\n\n- Some tools (e.g. SQLAlchemy) is reported to generate a DDL statement\n  against SpliceMachine containing PK and UQ constraints on the same\n  set of columns.\n- The fix allow this syntax, but under the hood it ignores the UQ\n  constraint since it is redundant.\n- If a user attempts to add a redundant UQ constraint via ALTER table\n  then we still throw an exception.\n- Add tests and address SpotBug reported issues on affected files."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MzIxMzg2", "url": "https://github.com/splicemachine/spliceengine/pull/3777#pullrequestreview-446321386", "createdAt": "2020-07-10T11:16:32Z", "commit": {"oid": "e2b92ce17b8781ccbde601d1ae634f1fb0b5424a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxMToxNjozMlrOGvzmpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxMToxNjozMlrOGvzmpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4MTczNQ==", "bodyText": "Please use lower case method names", "url": "https://github.com/splicemachine/spliceengine/pull/3777#discussion_r452781735", "createdAt": "2020-07-10T11:16:32Z", "author": {"login": "dgomezferro"}, "path": "splice_machine/src/test/java/com/splicemachine/derby/impl/sql/execute/operations/CreateTableIT.java", "diffHunk": "@@ -0,0 +1,114 @@\n+package com.splicemachine.derby.impl.sql.execute.operations;\n+\n+import com.splicemachine.derby.test.framework.SpliceSchemaWatcher;\n+import com.splicemachine.derby.test.framework.SpliceWatcher;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+import org.junit.Assert;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static org.junit.Assert.fail;\n+\n+public class CreateTableIT {\n+    private static final String SCHEMA = CreateTableIT.class.getSimpleName().toUpperCase();\n+\n+    @ClassRule\n+    public final static SpliceWatcher watcher = new SpliceWatcher(SCHEMA);\n+\n+    @ClassRule\n+    public static SpliceSchemaWatcher spliceSchemaWatcher = new SpliceSchemaWatcher(SCHEMA);\n+\n+    static int counter = 0;\n+    private static String GenerateTableName() {\n+        return \"T\" + counter++;\n+    }\n+\n+    private void ShouldContains(String tableName, List<List<Integer>> rows) throws SQLException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b92ce17b8781ccbde601d1ae634f1fb0b5424a"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MzIxNjEy", "url": "https://github.com/splicemachine/spliceengine/pull/3777#pullrequestreview-446321612", "createdAt": "2020-07-10T11:16:56Z", "commit": {"oid": "e2b92ce17b8781ccbde601d1ae634f1fb0b5424a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "977b0f0ad3ef714779e5615445a1524af13502f1", "author": {"user": {"login": "hatyo", "name": "Youssef Hatem"}}, "url": "https://github.com/splicemachine/spliceengine/commit/977b0f0ad3ef714779e5615445a1524af13502f1", "committedDate": "2020-07-10T17:21:27Z", "message": "Addressed comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "223a3ab08c10431ebf38c606aa256e3f766180b1", "author": {"user": {"login": "hatyo", "name": "Youssef Hatem"}}, "url": "https://github.com/splicemachine/spliceengine/commit/223a3ab08c10431ebf38c606aa256e3f766180b1", "committedDate": "2020-07-10T17:21:47Z", "message": "Merge remote-tracking branch 'origin/master' into DB-9171"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NTg0OTY1", "url": "https://github.com/splicemachine/spliceengine/pull/3777#pullrequestreview-446584965", "createdAt": "2020-07-10T17:45:48Z", "commit": {"oid": "223a3ab08c10431ebf38c606aa256e3f766180b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2OTc3MDUz", "url": "https://github.com/splicemachine/spliceengine/pull/3777#pullrequestreview-446977053", "createdAt": "2020-07-13T04:41:51Z", "commit": {"oid": "223a3ab08c10431ebf38c606aa256e3f766180b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1295, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}