{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5OTUzODE2", "number": 4250, "title": "DB-10431 Fix row decoding in inserting into table with expr index", "bodyText": "", "createdAt": "2020-10-08T14:10:43Z", "url": "https://github.com/splicemachine/spliceengine/pull/4250", "merged": true, "mergeCommit": {"oid": "ef45d010ebdaa51d7425c76c9da428809ed2f63e"}, "closed": true, "closedAt": "2020-10-22T16:29:08Z", "author": {"login": "ascend1"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQhmmRgH2gAyNDk5OTUzODE2OmJkY2M0YzZiZDk1MjJmMWYzNGRjZjBiNjI2MDcyNjUwMDI5ZTRmOGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdU4x9BAFqTUxNDMyMTI1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/bdcc4c6bd9522f1f34dcf0b626072650029e4f8c", "committedDate": "2020-10-08T13:29:03Z", "message": "DB-10431 Fix row decoding in inserting into table with expr index"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjU3MzM4", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-507257338", "createdAt": "2020-10-13T09:45:38Z", "commit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOTo0NTozOFrOHgediA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOTo0NTozOFrOHgediA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzgxNTU2MA==", "bodyText": "could you also verify the results of these operations?", "url": "https://github.com/splicemachine/spliceengine/pull/4250#discussion_r503815560", "createdAt": "2020-10-13T09:45:38Z", "author": {"login": "hatyo"}, "path": "splice_machine/src/test/java/com/splicemachine/derby/impl/sql/actions/index/IndexIT.java", "diffHunk": "@@ -964,6 +964,21 @@ public void testCreateIndexAndInsertWithExpressionsNullInput() throws Exception\n          */\n     }\n \n+    // DB-10431\n+    @Test\n+    public void testCreateIndexAndInsertWithExpressionsBatchWithFullNullRow() throws Exception {\n+        String tableName = \"TEST_IDX_BATCH_INSERT\";\n+        methodWatcher.executeUpdate(format(\"create table %s (c char(4), i int, d double)\", tableName));\n+        methodWatcher.executeUpdate(format(\"insert into %s values ('abc', 10, 1.1), ('def', 20, 2.2)\", tableName));\n+\n+        methodWatcher.executeUpdate(format(\"CREATE INDEX %s_IDX ON %s (upper(c), i + 2)\", tableName, tableName));\n+\n+        // Without the fix, the following insert fails sporadically. It depends on the order of inserting rows. If\n+        // (NULL, NULL, NULL) is inserted first, it fails. With the fix, it should never fail.\n+        methodWatcher.executeUpdate(format(\"insert into %s values ('jkl', 30, 2.2), (NULL, NULL, NULL)\", tableName));\n+        methodWatcher.executeUpdate(format(\"update %s set c = 'def' where i = 10\", tableName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjcyOTUy", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-507272952", "createdAt": "2020-10-13T10:04:28Z", "commit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NzQyOTEz", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-507742913", "createdAt": "2020-10-13T19:01:45Z", "commit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NTEzMjk1", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-508513295", "createdAt": "2020-10-14T16:14:10Z", "commit": {"oid": "bdcc4c6bd9522f1f34dcf0b626072650029e4f8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4731e2fde88f6cc20ef50faaab242d6f11b9e833", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/4731e2fde88f6cc20ef50faaab242d6f11b9e833", "committedDate": "2020-10-14T20:56:17Z", "message": "DB-10431 Address comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16e476a80bec213c622115102d08d57328d84e9e", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/16e476a80bec213c622115102d08d57328d84e9e", "committedDate": "2020-10-14T20:57:02Z", "message": "Merge branch 'master' into DB-10431"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NzMxNzg5", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-508731789", "createdAt": "2020-10-14T21:12:00Z", "commit": {"oid": "16e476a80bec213c622115102d08d57328d84e9e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MzIxMjU5", "url": "https://github.com/splicemachine/spliceengine/pull/4250#pullrequestreview-514321259", "createdAt": "2020-10-22T02:44:59Z", "commit": {"oid": "16e476a80bec213c622115102d08d57328d84e9e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1153, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}