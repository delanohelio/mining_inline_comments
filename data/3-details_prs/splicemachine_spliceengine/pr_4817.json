{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1MjMyNDA3", "number": 4817, "title": "DB-10976 Add SYSCAT.INDEXCOLUSE system view", "bodyText": "", "createdAt": "2020-12-09T14:47:25Z", "url": "https://github.com/splicemachine/spliceengine/pull/4817", "merged": true, "mergeCommit": {"oid": "461f1b8e93d362039f19f0d1025cd58226e8e2b0"}, "closed": true, "closedAt": "2020-12-10T06:43:33Z", "author": {"login": "ascend1"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkf1FggH2gAyNTM1MjMyNDA3OjBjM2Q1ZWU0NjBjOThmZWE5NjQ2NTg0ZTIxY2Q0YWVlNTBiOTRlMjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdktUbagFqTU0ODg4NjY2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c3d5ee460c98fea9646584e21cd4aee50b94e29", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/0c3d5ee460c98fea9646584e21cd4aee50b94e29", "committedDate": "2020-12-09T14:43:33Z", "message": "DB-10976 Add SYSCAT.INDEXCOLUSE system view"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MzcxMDQ1", "url": "https://github.com/splicemachine/spliceengine/pull/4817#pullrequestreview-548371045", "createdAt": "2020-12-09T16:33:15Z", "commit": {"oid": "0c3d5ee460c98fea9646584e21cd4aee50b94e29"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNjozMzoxNVrOICd71w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNjozMzoxNVrOICd71w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ1ODUxOQ==", "bodyText": "If it already exists, skip dropping and recreating the view.", "url": "https://github.com/splicemachine/spliceengine/pull/4817#discussion_r539458519", "createdAt": "2020-12-09T16:33:15Z", "author": {"login": "jyuanca"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -351,6 +351,25 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    public void createIndexColumnUseViewInSysCat(TransactionController tc) throws StandardException {\n+        TableDescriptor td = getTableDescriptor(\"INDEXCOLUSE\", sysCatSchemaDesc, tc);\n+\n+        // drop it if it exists\n+        if (td != null) {\n+            ViewDescriptor vd = getViewDescriptor(td);\n+\n+            // drop the view deifnition\n+            dropAllColumnDescriptors(td.getUUID(), tc);\n+            dropViewDescriptor(vd, tc);\n+            dropTableDescriptor(td, sysCatSchemaDesc, tc);\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c3d5ee460c98fea9646584e21cd4aee50b94e29"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MzcyNzUy", "url": "https://github.com/splicemachine/spliceengine/pull/4817#pullrequestreview-548372752", "createdAt": "2020-12-09T16:34:57Z", "commit": {"oid": "0c3d5ee460c98fea9646584e21cd4aee50b94e29"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNjozNDo1N1rOICeBUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNjozNDo1N1rOICeBUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ1OTkyMg==", "bodyText": "I accidentally approved it. Changing to \"request cahnges\"", "url": "https://github.com/splicemachine/spliceengine/pull/4817#discussion_r539459922", "createdAt": "2020-12-09T16:34:57Z", "author": {"login": "jyuanca"}, "path": "splice_machine/src/main/java/com/splicemachine/derby/impl/sql/catalog/SpliceDataDictionary.java", "diffHunk": "@@ -351,6 +351,25 @@ public void createKeyColumnUseViewInSysIBM(TransactionController tc) throws Stan\n         SpliceLogUtils.info(LOG, \"View SYSKEYCOLUSE in SYSIBM is created!\");\n     }\n \n+    public void createIndexColumnUseViewInSysCat(TransactionController tc) throws StandardException {\n+        TableDescriptor td = getTableDescriptor(\"INDEXCOLUSE\", sysCatSchemaDesc, tc);\n+\n+        // drop it if it exists\n+        if (td != null) {\n+            ViewDescriptor vd = getViewDescriptor(td);\n+\n+            // drop the view deifnition\n+            dropAllColumnDescriptors(td.getUUID(), tc);\n+            dropViewDescriptor(vd, tc);\n+            dropTableDescriptor(td, sysCatSchemaDesc, tc);\n+        }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ1ODUxOQ=="}, "originalCommit": {"oid": "0c3d5ee460c98fea9646584e21cd4aee50b94e29"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c0b0626e4e1d5dccb540a109b7208a41b2f70e1", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/5c0b0626e4e1d5dccb540a109b7208a41b2f70e1", "committedDate": "2020-12-09T18:01:20Z", "message": "DB-10976 Fix isAscending() and isDescending() in IndexDescriptorImpl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTEyNTY1", "url": "https://github.com/splicemachine/spliceengine/pull/4817#pullrequestreview-548512565", "createdAt": "2020-12-09T19:00:28Z", "commit": {"oid": "5c0b0626e4e1d5dccb540a109b7208a41b2f70e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTg5MjM5", "url": "https://github.com/splicemachine/spliceengine/pull/4817#pullrequestreview-548589239", "createdAt": "2020-12-09T20:38:47Z", "commit": {"oid": "5c0b0626e4e1d5dccb540a109b7208a41b2f70e1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDozODo0N1rOICocUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDozODo0N1rOICocUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTYzMDY3NQ==", "bodyText": "The code looks good.  I'm just wondering in the base code why both isAscending and isDescending return false for an out-of-range column.  I would assume that since ascending is the default, an out-of-range column should return true (unless we want to catch the out-of-range condition and throw an exception.", "url": "https://github.com/splicemachine/spliceengine/pull/4817#discussion_r539630675", "createdAt": "2020-12-09T20:38:47Z", "author": {"login": "msirek"}, "path": "db-engine/src/main/java/com/splicemachine/db/catalog/types/IndexDescriptorImpl.java", "diffHunk": "@@ -259,15 +259,15 @@ public String indexType()\n \t/** @see IndexDescriptor#isAscending */\n \tpublic boolean isAscending(Integer keyColumnPosition) {\n \t\tint i = keyColumnPosition - 1;\n-\t\tif (i < 0 || i >= baseColumnPositions.length)\n+\t\tif (i < 0 || i >= isAscending.length)\n \t\t\treturn false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c0b0626e4e1d5dccb540a109b7208a41b2f70e1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4ODg2NjYy", "url": "https://github.com/splicemachine/spliceengine/pull/4817#pullrequestreview-548886662", "createdAt": "2020-12-10T06:26:33Z", "commit": {"oid": "5c0b0626e4e1d5dccb540a109b7208a41b2f70e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1001, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}