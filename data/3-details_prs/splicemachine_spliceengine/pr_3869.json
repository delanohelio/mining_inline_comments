{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNjA4NDk1", "number": 3869, "title": "DB-9760 Make temporary tables local to their sessions", "bodyText": "jenkins please test branch @cdh6.3.0,skipTestsLongerThan2Minutes", "createdAt": "2020-07-20T16:18:40Z", "url": "https://github.com/splicemachine/spliceengine/pull/3869", "merged": true, "mergeCommit": {"oid": "bc05b26d7af4273926fb5932900faed3f8ec2593"}, "closed": true, "closedAt": "2020-09-24T17:13:20Z", "author": {"login": "ascend1"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc26F3zABqjM1NjgyNDU0ODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdL81cigH2gAyNDUzNjA4NDk1OmE2Yzk5NDYxOTNhMzVjZTdmYWYzMzkyNTY3MzM0YjkyMzI2YjMzYzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c689cb40c75c63dabc401238b7aba325b743de7e", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/c689cb40c75c63dabc401238b7aba325b743de7e", "committedDate": "2020-07-20T16:04:23Z", "message": "DB-9760 Make temporary tables local to their sessions"}, "afterCommit": {"oid": "7c51095f4ba09111b4eada3156ce4be4c10f1fe2", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7c51095f4ba09111b4eada3156ce4be4c10f1fe2", "committedDate": "2020-07-20T23:12:56Z", "message": "DB-9760 Make temporary tables local to their sessions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c51095f4ba09111b4eada3156ce4be4c10f1fe2", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/7c51095f4ba09111b4eada3156ce4be4c10f1fe2", "committedDate": "2020-07-20T23:12:56Z", "message": "DB-9760 Make temporary tables local to their sessions"}, "afterCommit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/9b10842d89126273d5d2d0eae46939cb8dfb81ed", "committedDate": "2020-07-21T09:29:18Z", "message": "DB-9760 Make temporary tables local to their sessions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4OTI2NjI1", "url": "https://github.com/splicemachine/spliceengine/pull/3869#pullrequestreview-468926625", "createdAt": "2020-08-18T01:09:22Z", "commit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwMTowOToyM1rOHB_1zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwNDowMzo1MVrOHCCiHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1NjU4OA==", "bodyText": "Remove this?", "url": "https://github.com/splicemachine/spliceengine/pull/3869#discussion_r471856588", "createdAt": "2020-08-18T01:09:23Z", "author": {"login": "jyuanca"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/compile/CreateIndexNode.java", "diffHunk": "@@ -59,7 +57,7 @@\n {\n \tboolean\t\t\t\tunique;\n \tboolean\t\t\t\tuniqueWithDuplicateNulls;\n-\tDataDictionary\t\tdd = null;\n+//\tDataDictionary\t\tdd = null;\n \tProperties\t\t\tproperties;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1NjY2NA==", "bodyText": "Same here", "url": "https://github.com/splicemachine/spliceengine/pull/3869#discussion_r471856664", "createdAt": "2020-08-18T01:09:43Z", "author": {"login": "jyuanca"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/compile/CreateIndexNode.java", "diffHunk": "@@ -292,9 +297,9 @@ public ConstantAction\tmakeConstantAction() throws StandardException\n \t{\n \t\tSchemaDescriptor\t\tsd = getSchemaDescriptor();\n \n-\t\tint columnCount = columnNames.length;\n+//\t\tint columnCount = columnNames.length;\n \t\tint approxLength = 0;\n-\t\tboolean index_has_long_column = false;\n+//\t\tboolean index_has_long_column = false;\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkwMDcwMg==", "bodyText": "Session schema is for storing global temporary tables.\nhttp://db.apache.org/derby/docs/10.0/manuals/reference/sqlj33.html\nHowever, it seems we never implement global temporary tables correctly. We may want to file a Jira and fix it.", "url": "https://github.com/splicemachine/spliceengine/pull/3869#discussion_r471900702", "createdAt": "2020-08-18T04:03:51Z", "author": {"login": "jyuanca"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/compile/QueryTreeNode.java", "diffHunk": "@@ -1408,13 +1424,20 @@ protected final TableDescriptor getTableDescriptor(String tableName,\n         if(schema.getUUID()==null)\n             return null;\n \n+        //If not in session schema, look for local temporary table first.\n+        //If tables is not under SESSION schema, don't get it from LCC. Table version is not set there.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b10842d89126273d5d2d0eae46939cb8dfb81ed", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/9b10842d89126273d5d2d0eae46939cb8dfb81ed", "committedDate": "2020-07-21T09:29:18Z", "message": "DB-9760 Make temporary tables local to their sessions"}, "afterCommit": {"oid": "a7bb26dbcb9bc02ba2a10d8846083892a1012eeb", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/a7bb26dbcb9bc02ba2a10d8846083892a1012eeb", "committedDate": "2020-08-21T13:42:31Z", "message": "DB-9760 Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66c676e435459fd9a9e43be92eaae91deafff981", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/66c676e435459fd9a9e43be92eaae91deafff981", "committedDate": "2020-08-25T13:18:07Z", "message": "DB-9760 Make temporary tables local to their sessions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd881e2ffec2a8f4c2915e18b989fd15e2f65ff8", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/bd881e2ffec2a8f4c2915e18b989fd15e2f65ff8", "committedDate": "2020-08-25T13:18:07Z", "message": "DB-9760 Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5377cf04dbe5ee201b03f4a5bf5d986bf4e1d3b8", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/5377cf04dbe5ee201b03f4a5bf5d986bf4e1d3b8", "committedDate": "2020-08-25T13:35:43Z", "message": "DB-9760 Fix SpotBugs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a7bb26dbcb9bc02ba2a10d8846083892a1012eeb", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/a7bb26dbcb9bc02ba2a10d8846083892a1012eeb", "committedDate": "2020-08-21T13:42:31Z", "message": "DB-9760 Address comments"}, "afterCommit": {"oid": "5377cf04dbe5ee201b03f4a5bf5d986bf4e1d3b8", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/5377cf04dbe5ee201b03f4a5bf5d986bf4e1d3b8", "committedDate": "2020-08-25T13:35:43Z", "message": "DB-9760 Fix SpotBugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b58251a06a63731e7d1241b7405c4671387ac02", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/1b58251a06a63731e7d1241b7405c4671387ac02", "committedDate": "2020-09-09T14:09:51Z", "message": "Merge branch 'master' into DB-9760"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48c041520ea001c74236dec86737d79924881211", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/48c041520ea001c74236dec86737d79924881211", "committedDate": "2020-09-15T10:14:04Z", "message": "Merge branch 'master' into DB-9760"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzQ0Mjcw", "url": "https://github.com/splicemachine/spliceengine/pull/3869#pullrequestreview-493344270", "createdAt": "2020-09-22T10:59:35Z", "commit": {"oid": "48c041520ea001c74236dec86737d79924881211"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDo1OTozNlrOHV0uZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDo1OTozNlrOHV0uZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjY0NTk4OQ==", "bodyText": "setValid() ?", "url": "https://github.com/splicemachine/spliceengine/pull/3869#discussion_r492645989", "createdAt": "2020-09-22T10:59:36Z", "author": {"login": "martinrupp"}, "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/GenericPreparedStatement.java", "diffHunk": "@@ -905,7 +905,9 @@ public void completeCompile(StatementNode qt) throws StandardException {\n                 updateMode = cursorInfo.updateMode;\n             }\n         }\n-        isValid = true;\n+        synchronized (this) {\n+            isValid = true;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48c041520ea001c74236dec86737d79924881211"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc2f814ce0cc8ede4089aa1beedb7e754b87eaf6", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/fc2f814ce0cc8ede4089aa1beedb7e754b87eaf6", "committedDate": "2020-09-22T17:18:33Z", "message": "Merge branch 'master' into DB-9760"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0b87efdd38309df1be9a58732648ee9e4b9f730", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/f0b87efdd38309df1be9a58732648ee9e4b9f730", "committedDate": "2020-09-22T18:55:12Z", "message": "DB-9760 Fix new SpotBugs after merging latest head"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47e6e56b01a9a55cb521becdd524f7a70a9518b2", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/47e6e56b01a9a55cb521becdd524f7a70a9518b2", "committedDate": "2020-09-23T09:00:16Z", "message": "Merge branch 'master' into DB-9760"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MTYwNDgx", "url": "https://github.com/splicemachine/spliceengine/pull/3869#pullrequestreview-495160481", "createdAt": "2020-09-24T01:29:18Z", "commit": {"oid": "47e6e56b01a9a55cb521becdd524f7a70a9518b2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6c9946193a35ce7faf3392567334b92326b33c3", "author": {"user": {"login": "ascend1", "name": "Zhen Li"}}, "url": "https://github.com/splicemachine/spliceengine/commit/a6c9946193a35ce7faf3392567334b92326b33c3", "committedDate": "2020-09-24T08:23:05Z", "message": "DB-9760 Address comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1260, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}