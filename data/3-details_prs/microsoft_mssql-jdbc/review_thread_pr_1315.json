{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NjgzMzk5", "number": 1315, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNjoxMFrOD04DAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMTo0NVrOD1Z5Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NzcwODE4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNjoxMFrOGKCKQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNjoxMFrOGKCKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE3NDMzOQ==", "bodyText": "Can't you put this into try with resources?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413174339", "createdAt": "2020-04-22T17:26:10Z", "author": {"login": "ulvii"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -81,10 +81,15 @@\n     private static KeyManager[] readPKCS12Certificate(String certPath,\r\n             String keyPassword) throws NoSuchAlgorithmException, CertificateException, FileNotFoundException, IOException, UnrecoverableKeyException, KeyStoreException, SQLServerException {\r\n         KeyStore keystore = KeyStore.getInstance(PKCS12_ALG);\r\n+        FileInputStream certStream = null;\r\n         try {\r\n-            keystore.load(new FileInputStream(certPath), keyPassword.toCharArray());\r\n+            certStream = new FileInputStream(certPath);\r\n+            keystore.load(certStream, keyPassword.toCharArray());\r\n         } catch (FileNotFoundException e) {\r\n             throw new SQLServerException(SQLServerException.getErrString(\"R_clientCertError\"), null, 0, null);\r\n+        } finally {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODY5MDU4OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/microsoft/sqlserver/jdbc/clientcertauth/ClientCertificateAuthenticationTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo1Nzo1M1rOGKLhgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo1Nzo1M1rOGKLhgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMyNzc0Nw==", "bodyText": "This line is already covered in PR 1313, you should remove this in one of them (probably in the other one)", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413327747", "createdAt": "2020-04-22T20:57:53Z", "author": {"login": "peterbae"}, "path": "src/test/java/com/microsoft/sqlserver/jdbc/clientcertauth/ClientCertificateAuthenticationTest.java", "diffHunk": "@@ -2,7 +2,7 @@\n  * Microsoft JDBC Driver for SQL Server Copyright(c) Microsoft Corporation All rights reserved. This program is made\r\n  * available under the terms of the MIT License. See the LICENSE file in the project root for more information.\r\n  */\r\n-package com.microsoft.sqlserver.clientcertauth;\r\n+package com.microsoft.sqlserver.jdbc.clientcertauth;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2OTIzOTgwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMzo0Njo1NFrOGKQbiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMzo0Njo1NFrOGKQbiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzQwODEzNg==", "bodyText": "can use try with resource here too", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413408136", "createdAt": "2020-04-22T23:46:54Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -277,7 +287,7 @@ private static InputStream fileToStream(String fname) throws IOException, SQLSer\n             dis.readFully(bytes);\r\n             ByteArrayInputStream bais = new ByteArrayInputStream(bytes);\r\n             return bais;\r\n-        } catch (FileNotFoundException e) { \r\n+        } catch (FileNotFoundException e) {\r\n             throw new SQLServerException(SQLServerException.getErrString(\"R_clientCertError\"), null, 0, null);\r\n         } finally {\r\n             if (null != dis) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzI1MzE0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMTo0NVrOGK1IlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMTo0NVrOGK1IlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAwOTQ5Mw==", "bodyText": "use the autocloseable syntax for InputStream here instead of manually calling certStream.close()?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r414009493", "createdAt": "2020-04-23T18:01:45Z", "author": {"login": "peterbae"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -203,10 +203,15 @@ private static PrivateKey loadPrivateKeyFromPVK(String keyPath,\n         }\r\n     }\r\n \r\n-    private static Certificate loadCertificate(String certificatePem) throws IOException, GeneralSecurityException, SQLServerException {\r\n+    private static Certificate loadCertificate(\r\n+            String certificatePem) throws IOException, GeneralSecurityException, SQLServerException {\r\n         CertificateFactory certificateFactory = CertificateFactory.getInstance(\"X509\");\r\n-        InputStream certstream = fileToStream(certificatePem);\r\n-        return certificateFactory.generateCertificate(certstream);\r\n+        InputStream certStream = fileToStream(certificatePem);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16171d8af739c987a5fc5320fbad15b54833f803"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1067, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}