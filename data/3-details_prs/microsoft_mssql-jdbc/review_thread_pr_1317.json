{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1MjI2ODUx", "number": 1317, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODozMTowMVrOD4cojA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwMToxMTozNlrOD4iHzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNTE1OTgwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODozMTowMVrOGPR5Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjo0ODowOVrOGQyWVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NTAxNA==", "bodyText": "Why are these else cases handled differently? I think these should also be replaced by result.append(ch);?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r418675014", "createdAt": "2020-05-01T18:31:01Z", "author": {"login": "peterbae"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -370,7 +357,7 @@ else if (ch == ':')\n                         }\n                         // same state\n                     } else {\n-                        builder = new StringBuilder();\n+                        StringBuilder builder = new StringBuilder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI1NTMxNg==", "bodyText": "Because this appends name and not result. This method has fall through logic that forces us to retain some original logic.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r420255316", "createdAt": "2020-05-05T16:48:09Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -370,7 +357,7 @@ else if (ch == ':')\n                         }\n                         // same state\n                     } else {\n-                        builder = new StringBuilder();\n+                        StringBuilder builder = new StringBuilder();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NTAxNA=="}, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNTE3MDA4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODozNDo1MVrOGPR_6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzowNzowNlrOGQzMjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NjcxNQ==", "bodyText": "Lines 477 and 484 will probably error out, because property variable is actually not defined here. You should declare property as a String every time, or move up the declaration of line 468 to somewhere above.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r418676715", "createdAt": "2020-05-01T18:34:51Z", "author": {"login": "peterbae"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -478,27 +465,27 @@ else if (ch == ':')\n         // Exit\n         switch (state) {\n             case inServerName:\n-                result = result.trim();\n-                if (result.length() > 0) {\n+                String property = result.toString().trim();\n+                if (property.length() > 0) {\n                     if (logger.isLoggable(Level.FINE)) {\n-                        logger.fine(\"Property:serverName \" + \"Value:\" + result);\n+                        logger.fine(\"Property:serverName \" + \"Value:\" + property);\n                     }\n-                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), result);\n+                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), property);\n                 }\n                 break;\n             case inPort:\n-                result = result.trim();\n+                property = result.toString().trim();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc3OTgzMQ==", "bodyText": "odd, I'm surprised it's not complaining about that", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r419779831", "createdAt": "2020-05-04T23:06:21Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -478,27 +465,27 @@ else if (ch == ':')\n         // Exit\n         switch (state) {\n             case inServerName:\n-                result = result.trim();\n-                if (result.length() > 0) {\n+                String property = result.toString().trim();\n+                if (property.length() > 0) {\n                     if (logger.isLoggable(Level.FINE)) {\n-                        logger.fine(\"Property:serverName \" + \"Value:\" + result);\n+                        logger.fine(\"Property:serverName \" + \"Value:\" + property);\n                     }\n-                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), result);\n+                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), property);\n                 }\n                 break;\n             case inPort:\n-                result = result.trim();\n+                property = result.toString().trim();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NjcxNQ=="}, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI1MzYzNQ==", "bodyText": "It doesn't error out, it's declared in the first case statement. Cases can fall through into each other if you don't provide a break; at the end of a case, variable declaration scope is more obvious with that taken into consideration. The cases are also not scoped by { } brackets. Also CI tests passing rules out compile errors.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r420253635", "createdAt": "2020-05-05T16:45:25Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -478,27 +465,27 @@ else if (ch == ':')\n         // Exit\n         switch (state) {\n             case inServerName:\n-                result = result.trim();\n-                if (result.length() > 0) {\n+                String property = result.toString().trim();\n+                if (property.length() > 0) {\n                     if (logger.isLoggable(Level.FINE)) {\n-                        logger.fine(\"Property:serverName \" + \"Value:\" + result);\n+                        logger.fine(\"Property:serverName \" + \"Value:\" + property);\n                     }\n-                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), result);\n+                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), property);\n                 }\n                 break;\n             case inPort:\n-                result = result.trim();\n+                property = result.toString().trim();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NjcxNQ=="}, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2OTE5OQ==", "bodyText": "But there is a break; after the inServerName case. I think the tests are not failing because every test case had inServerName get called before other cases. Can you test this method by providing it a connection string that has maybe the port number come before the server name?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r420269199", "createdAt": "2020-05-05T17:07:06Z", "author": {"login": "peterbae"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -478,27 +465,27 @@ else if (ch == ':')\n         // Exit\n         switch (state) {\n             case inServerName:\n-                result = result.trim();\n-                if (result.length() > 0) {\n+                String property = result.toString().trim();\n+                if (property.length() > 0) {\n                     if (logger.isLoggable(Level.FINE)) {\n-                        logger.fine(\"Property:serverName \" + \"Value:\" + result);\n+                        logger.fine(\"Property:serverName \" + \"Value:\" + property);\n                     }\n-                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), result);\n+                    p.put(SQLServerDriverStringProperty.SERVER_NAME.toString(), property);\n                 }\n                 break;\n             case inPort:\n-                result = result.trim();\n+                property = result.toString().trim();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY3NjcxNQ=="}, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 162}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNjA1OTAyOnYy", "diffSide": "LEFT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwMToxMTozNlrOGPaB2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjo1MTozOFrOGQylMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODgwODI4MQ==", "bodyText": "Please add tests for the changes you are making.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r418808281", "createdAt": "2020-05-02T01:11:36Z", "author": {"login": "ulvii"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -242,10 +242,9 @@ static void writeLong(long value, byte valueBytes[], int offset) {\n         Properties p = new Properties();\n         String tmpUrl = url;\n         String sPrefix = \"jdbc:sqlserver://\";\n-        String result = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI1OTEyMA==", "bodyText": "The PR is to change a String variable to a StringBuilder, I don't believe testing will be possible. Regarding code coverage, the lines changed are being used in the driver anytime our tests set a connection string property.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1317#discussion_r420259120", "createdAt": "2020-05-05T16:51:38Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/Util.java", "diffHunk": "@@ -242,10 +242,9 @@ static void writeLong(long value, byte valueBytes[], int offset) {\n         Properties p = new Properties();\n         String tmpUrl = url;\n         String sPrefix = \"jdbc:sqlserver://\";\n-        String result = \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODgwODI4MQ=="}, "originalCommit": {"oid": "f8e32471968abcd799ee5305179e845105bf4920"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1070, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}