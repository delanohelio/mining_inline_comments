{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NjgzMzk5", "number": 1315, "title": "Fix | Close resources and skip AE tests by default", "bodyText": "Moved Client Certificate Authentication tests to proper folder.\nExplicitly close closable resources.\nSkip AE tests by default so users don't require the AE folder to run tests.", "createdAt": "2020-04-16T20:10:08Z", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315", "merged": true, "mergeCommit": {"oid": "3f3faf2e3c39eeea49d5076b4b40cafe0c56eacf"}, "closed": true, "closedAt": "2020-04-24T18:45:37Z", "author": {"login": "rene-ye"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYSbdegH2gAyNDA0NjgzMzk5OjMzOTdhYWM1NTdlZGMxN2YwNWY4ZGQ0OGU4YmUyYmUxZmNhNjJmODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABca1bb9gFqTQwMDE2MTkxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80", "author": {"user": {"login": "rene-ye", "name": "v-reye"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/3397aac557edc17f05f8dd48e8be2be1fca62f80", "committedDate": "2020-04-16T20:08:33Z", "message": "Closable resource fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDEzOTQ3", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-398413947", "createdAt": "2020-04-22T17:26:10Z", "commit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNjoxMFrOGKCKQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNjoxMFrOGKCKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE3NDMzOQ==", "bodyText": "Can't you put this into try with resources?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413174339", "createdAt": "2020-04-22T17:26:10Z", "author": {"login": "ulvii"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -81,10 +81,15 @@\n     private static KeyManager[] readPKCS12Certificate(String certPath,\r\n             String keyPassword) throws NoSuchAlgorithmException, CertificateException, FileNotFoundException, IOException, UnrecoverableKeyException, KeyStoreException, SQLServerException {\r\n         KeyStore keystore = KeyStore.getInstance(PKCS12_ALG);\r\n+        FileInputStream certStream = null;\r\n         try {\r\n-            keystore.load(new FileInputStream(certPath), keyPassword.toCharArray());\r\n+            certStream = new FileInputStream(certPath);\r\n+            keystore.load(certStream, keyPassword.toCharArray());\r\n         } catch (FileNotFoundException e) {\r\n             throw new SQLServerException(SQLServerException.getErrString(\"R_clientCertError\"), null, 0, null);\r\n+        } finally {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTgzNjA0", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-398583604", "createdAt": "2020-04-22T20:57:53Z", "commit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo1Nzo1M1rOGKLhgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo1Nzo1M1rOGKLhgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMyNzc0Nw==", "bodyText": "This line is already covered in PR 1313, you should remove this in one of them (probably in the other one)", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413327747", "createdAt": "2020-04-22T20:57:53Z", "author": {"login": "peterbae"}, "path": "src/test/java/com/microsoft/sqlserver/jdbc/clientcertauth/ClientCertificateAuthenticationTest.java", "diffHunk": "@@ -2,7 +2,7 @@\n  * Microsoft JDBC Driver for SQL Server Copyright(c) Microsoft Corporation All rights reserved. This program is made\r\n  * available under the terms of the MIT License. See the LICENSE file in the project root for more information.\r\n  */\r\n-package com.microsoft.sqlserver.clientcertauth;\r\n+package com.microsoft.sqlserver.jdbc.clientcertauth;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NjY2NTY4", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-398666568", "createdAt": "2020-04-22T23:46:54Z", "commit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMzo0Njo1NFrOGKQbiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMzo0Njo1NFrOGKQbiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzQwODEzNg==", "bodyText": "can use try with resource here too", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r413408136", "createdAt": "2020-04-22T23:46:54Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -277,7 +287,7 @@ private static InputStream fileToStream(String fname) throws IOException, SQLSer\n             dis.readFully(bytes);\r\n             ByteArrayInputStream bais = new ByteArrayInputStream(bytes);\r\n             return bais;\r\n-        } catch (FileNotFoundException e) { \r\n+        } catch (FileNotFoundException e) {\r\n             throw new SQLServerException(SQLServerException.getErrString(\"R_clientCertError\"), null, 0, null);\r\n         } finally {\r\n             if (null != dis) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3397aac557edc17f05f8dd48e8be2be1fca62f80"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16171d8af739c987a5fc5320fbad15b54833f803", "author": {"user": {"login": "rene-ye", "name": "v-reye"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/16171d8af739c987a5fc5320fbad15b54833f803", "committedDate": "2020-04-23T16:23:35Z", "message": "address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MzQ2OTk1", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399346995", "createdAt": "2020-04-23T18:01:45Z", "commit": {"oid": "16171d8af739c987a5fc5320fbad15b54833f803"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMTo0NVrOGK1IlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMTo0NVrOGK1IlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAwOTQ5Mw==", "bodyText": "use the autocloseable syntax for InputStream here instead of manually calling certStream.close()?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#discussion_r414009493", "createdAt": "2020-04-23T18:01:45Z", "author": {"login": "peterbae"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerCertificateUtils.java", "diffHunk": "@@ -203,10 +203,15 @@ private static PrivateKey loadPrivateKeyFromPVK(String keyPath,\n         }\r\n     }\r\n \r\n-    private static Certificate loadCertificate(String certificatePem) throws IOException, GeneralSecurityException, SQLServerException {\r\n+    private static Certificate loadCertificate(\r\n+            String certificatePem) throws IOException, GeneralSecurityException, SQLServerException {\r\n         CertificateFactory certificateFactory = CertificateFactory.getInstance(\"X509\");\r\n-        InputStream certstream = fileToStream(certificatePem);\r\n-        return certificateFactory.generateCertificate(certstream);\r\n+        InputStream certStream = fileToStream(certificatePem);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16171d8af739c987a5fc5320fbad15b54833f803"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845", "author": {"user": {"login": "rene-ye", "name": "v-reye"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/d9674304fca6d2b130617341e2a908ff8faaa845", "committedDate": "2020-04-23T18:53:35Z", "message": "comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MzkwMDI1", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399390025", "createdAt": "2020-04-23T18:59:52Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDY1Njgz", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399465683", "createdAt": "2020-04-23T20:50:01Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjU0Mjc0", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399654274", "createdAt": "2020-04-24T05:43:36Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjU1NTk0", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399655594", "createdAt": "2020-04-24T05:47:29Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjU1NjM5", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-399655639", "createdAt": "2020-04-24T05:47:42Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMTYxOTE0", "url": "https://github.com/microsoft/mssql-jdbc/pull/1315#pullrequestreview-400161914", "createdAt": "2020-04-24T18:03:03Z", "commit": {"oid": "d9674304fca6d2b130617341e2a908ff8faaa845"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2521, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}