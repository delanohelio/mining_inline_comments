{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2Mzg0ODgz", "number": 1406, "title": "Fix | Sort column ordinal mapping during bulk copy", "bodyText": "Fixes issue #1391.\nStraightforward fix, sorts the 'columnOrdinals' object if the returned set happens to be unordered.", "createdAt": "2020-08-11T22:17:34Z", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406", "merged": true, "mergeCommit": {"oid": "4e72ac53ae7e2f1ecea75dc250243c1bca8c8482"}, "closed": true, "closedAt": "2020-09-09T20:10:49Z", "author": {"login": "peterbae"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9-X-lAH2gAyNDY2Mzg0ODgzOmQzOGVjYzgyZWYxZTQ0ZGY5Yzg5YTJlMzZjODk5YWMxMDdmNjBiZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHQw4vgFqTQ4NTMwMDY3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d38ecc82ef1e44df9c89a2e36c899ac107f60be3", "author": {"user": {"login": "peterbae", "name": "Peter Bae"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/d38ecc82ef1e44df9c89a2e36c899ac107f60be3", "committedDate": "2020-08-11T22:15:46Z", "message": "sort"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef5318b286454424e5dba00071e602fc2bae83b", "author": {"user": {"login": "peterbae", "name": "Peter Bae"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/3ef5318b286454424e5dba00071e602fc2bae83b", "committedDate": "2020-08-26T00:23:24Z", "message": "test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4Nzc4ODc5", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-478778879", "createdAt": "2020-08-31T16:52:21Z", "commit": {"oid": "3ef5318b286454424e5dba00071e602fc2bae83b"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4Nzg1ODcw", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-478785870", "createdAt": "2020-08-31T17:01:14Z", "commit": {"oid": "3ef5318b286454424e5dba00071e602fc2bae83b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNzowMToxNFrOHKA-yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNzowMToxNFrOHKA-yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI2Mzg4Mw==", "bodyText": "If the columnMetadata Map objects implemented in the SQLServerBulkRecord classes were TreeMap objects instead of HashMap, you wouldn't need to sort the keyset you retrieve here. However I'm not sure if the cost of lookups/inserts going from O(1) to O(logN) would be worth that trade off.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#discussion_r480263883", "createdAt": "2020-08-31T17:01:14Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerBulkCopy.java", "diffHunk": "@@ -1839,7 +1840,9 @@ private void validateColumnMappings() throws SQLServerException {\n                 // if no mapping is provided for csv file and metadata is missing for some columns throw error\n                 if (null != serverBulkData) {\n                     Set<Integer> columnOrdinals = serverBulkData.getColumnOrdinals();\n-                    Iterator<Integer> columnsIterator = columnOrdinals.iterator();\n+                    List<Integer> sortedList = new ArrayList<>(columnOrdinals);\n+                    Collections.sort(sortedList);\n+                    Iterator<Integer> columnsIterator = sortedList.iterator();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef5318b286454424e5dba00071e602fc2bae83b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d08f8de4449ca31dd506e84047e16795828d772f", "author": {"user": {"login": "peterbae", "name": "Peter Bae"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/d08f8de4449ca31dd506e84047e16795828d772f", "committedDate": "2020-09-02T22:02:18Z", "message": "changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODg4MTQ5", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-482888149", "createdAt": "2020-09-04T19:10:46Z", "commit": {"oid": "d08f8de4449ca31dd506e84047e16795828d772f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxOToxMDo0NlrOHNY-YA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxOToxMDo0NlrOHNY-YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgwMjcyMA==", "bodyText": "Why is this in a different file? Please move this to the same file as the test.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#discussion_r483802720", "createdAt": "2020-09-04T19:10:46Z", "author": {"login": "ulvii"}, "path": "src/test/java/com/microsoft/sqlserver/jdbc/bulkCopy/ISQLServerBulkRecordIssuesTest.java", "diffHunk": "@@ -253,6 +256,26 @@ public void afterEachTests() throws SQLException {\n     }\n }\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d08f8de4449ca31dd506e84047e16795828d772f"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzUxNzM3", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-484351737", "createdAt": "2020-09-08T17:28:51Z", "commit": {"oid": "d08f8de4449ca31dd506e84047e16795828d772f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc9e0ba8df2e6c6390cb1637927af10509592524", "author": {"user": {"login": "peterbae", "name": "Peter Bae"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/dc9e0ba8df2e6c6390cb1637927af10509592524", "committedDate": "2020-09-08T19:26:28Z", "message": "update test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NTU4MjUz", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-484558253", "createdAt": "2020-09-08T23:23:19Z", "commit": {"oid": "dc9e0ba8df2e6c6390cb1637927af10509592524"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MjUxNjMx", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-485251631", "createdAt": "2020-09-09T17:36:38Z", "commit": {"oid": "dc9e0ba8df2e6c6390cb1637927af10509592524"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzAwNjcw", "url": "https://github.com/microsoft/mssql-jdbc/pull/1406#pullrequestreview-485300670", "createdAt": "2020-09-09T18:46:35Z", "commit": {"oid": "dc9e0ba8df2e6c6390cb1637927af10509592524"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2611, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}