{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjQ5MTUx", "number": 1321, "title": "Fix | Add certificate expire validation when using Always Encrypted with secure enclaves", "bodyText": "Explicitly check certificate expiry.", "createdAt": "2020-04-28T17:10:01Z", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321", "merged": true, "mergeCommit": {"oid": "088b738e1eaea7fd0da4baa21b0755f3b69179c5"}, "closed": true, "closedAt": "2020-04-30T17:44:03Z", "author": {"login": "rene-ye"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZiW_CAH2gAyNDEwMjQ5MTUxOmMxNzUyZGZmMGY1MzVkNjE2NDE4OTA0NWY4MmI3NTBlNDIyYWUyOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccgOAEgFqTQwMzA4NDY0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c1752dff0f535d6164189045f82b750e422ae296", "author": {"user": {"login": "rene-ye", "name": "v-reye"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/c1752dff0f535d6164189045f82b750e422ae296", "committedDate": "2020-04-20T17:16:04Z", "message": "Check certificate expiry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3", "author": {"user": {"login": "rene-ye", "name": "v-reye"}}, "url": "https://github.com/microsoft/mssql-jdbc/commit/4f144fed1197baed87538c4f01b911978fbb1af3", "committedDate": "2020-04-28T17:09:27Z", "message": "Merge branch 'dev' of https://github.com/microsoft/mssql-jdbc into CertExpiry"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMjMyNDE3", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#pullrequestreview-402232417", "createdAt": "2020-04-28T21:40:01Z", "commit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMjMyODc2", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#pullrequestreview-402232876", "createdAt": "2020-04-28T21:40:47Z", "commit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzg2MDgz", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#pullrequestreview-402386083", "createdAt": "2020-04-29T06:14:25Z", "commit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjoxNDoyNVrOGNw_0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjoxNDoyNVrOGNw_0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NzQ0Mw==", "bodyText": "should we log a warning?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#discussion_r417087443", "createdAt": "2020-04-29T06:14:25Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/SQLServerVSMEnclaveProvider.java", "diffHunk": "@@ -275,9 +276,10 @@ void validateCert(byte[] b) throws SQLServerException {\n                         .generateCertificates(new ByteArrayInputStream(b));\n                 for (X509Certificate cert : certs) {\n                     try {\n+                        cert.checkValidity();\n                         healthCert.verify(cert.getPublicKey());\n                         return;\n-                    } catch (SignatureException e) {\n+                    } catch (SignatureException | CertificateExpiredException e) {\n                         // Doesn't match, but continue looping through the rest of the certificates", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMDg0NjQ4", "url": "https://github.com/microsoft/mssql-jdbc/pull/1321#pullrequestreview-403084648", "createdAt": "2020-04-29T22:28:13Z", "commit": {"oid": "4f144fed1197baed87538c4f01b911978fbb1af3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2530, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}