{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjcxNjQx", "number": 1322, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODowOTowMFrOD3UaTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjowOToxOVrOD3fNPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzMyNjg3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODowOTowMFrOGNgrCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODowOTowMFrOGNgrCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgxOTk3Nw==", "bodyText": "There is already SSLProtocol enum in the driver", "url": "https://github.com/microsoft/mssql-jdbc/pull/1322#discussion_r416819977", "createdAt": "2020-04-28T18:09:00Z", "author": {"login": "ulvii"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "diffHunk": "@@ -1593,6 +1594,9 @@ private void validateServerNameInCertificate(X509Certificate cert) throws Certif\n         SSL_HANDHSAKE_COMPLETE\n     }\n \n+    static final String TLS_1 = \"TLSv1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "672370e6f64620131b11524f4d60169620af3b5e"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NTA4ODI4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjowNjoxM1rOGNw1mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQyMTo1MzowMVrOGOSaDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NDgyNg==", "bodyText": "add to SQLServerResource?", "url": "https://github.com/microsoft/mssql-jdbc/pull/1322#discussion_r417084826", "createdAt": "2020-04-29T06:06:13Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "diffHunk": "@@ -1826,6 +1826,16 @@ else if (con.getTrustManagerClass() != null) {\n             // SSL is now enabled; switch over the channel socket\n             channelSocket = sslSocket;\n \n+            // Check the TLS version\n+            String tlsProtocol = sslSocket.getSession().getProtocol();\n+            if (SSLProtocol.TLS_V10.toString().equalsIgnoreCase(tlsProtocol)\n+                    || SSLProtocol.TLS_V11.toString().equalsIgnoreCase(tlsProtocol)) {\n+                String warningMsg = tlsProtocol\n+                        + \" was negotiated. Please update server and client to use TLSv1.2 at minimum.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f1e6e8dc4e2240fd833fea988ef6a57903eee3"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzYzNDgzMQ==", "bodyText": "Not an error message.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1322#discussion_r417634831", "createdAt": "2020-04-29T21:53:01Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "diffHunk": "@@ -1826,6 +1826,16 @@ else if (con.getTrustManagerClass() != null) {\n             // SSL is now enabled; switch over the channel socket\n             channelSocket = sslSocket;\n \n+            // Check the TLS version\n+            String tlsProtocol = sslSocket.getSession().getProtocol();\n+            if (SSLProtocol.TLS_V10.toString().equalsIgnoreCase(tlsProtocol)\n+                    || SSLProtocol.TLS_V11.toString().equalsIgnoreCase(tlsProtocol)) {\n+                String warningMsg = tlsProtocol\n+                        + \" was negotiated. Please update server and client to use TLSv1.2 at minimum.\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NDgyNg=="}, "originalCommit": {"oid": "a7f1e6e8dc4e2240fd833fea988ef6a57903eee3"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NTA5NTY3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjowOToxOVrOGNw5lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQyMTo1Mjo0MFrOGOSZjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NTg0NQ==", "bodyText": "I think it might be better to put add a isMinTLS() (or something) method in SQLServerDriver? That way when a new version comes out it can be changed in 1 place only.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1322#discussion_r417085845", "createdAt": "2020-04-29T06:09:19Z", "author": {"login": "lilgreenbird"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "diffHunk": "@@ -1826,6 +1826,16 @@ else if (con.getTrustManagerClass() != null) {\n             // SSL is now enabled; switch over the channel socket\n             channelSocket = sslSocket;\n \n+            // Check the TLS version\n+            String tlsProtocol = sslSocket.getSession().getProtocol();\n+            if (SSLProtocol.TLS_V10.toString().equalsIgnoreCase(tlsProtocol)\n+                    || SSLProtocol.TLS_V11.toString().equalsIgnoreCase(tlsProtocol)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f1e6e8dc4e2240fd833fea988ef6a57903eee3"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzYzNDcwMg==", "bodyText": "this is the only place we check tls version.", "url": "https://github.com/microsoft/mssql-jdbc/pull/1322#discussion_r417634702", "createdAt": "2020-04-29T21:52:40Z", "author": {"login": "rene-ye"}, "path": "src/main/java/com/microsoft/sqlserver/jdbc/IOBuffer.java", "diffHunk": "@@ -1826,6 +1826,16 @@ else if (con.getTrustManagerClass() != null) {\n             // SSL is now enabled; switch over the channel socket\n             channelSocket = sslSocket;\n \n+            // Check the TLS version\n+            String tlsProtocol = sslSocket.getSession().getProtocol();\n+            if (SSLProtocol.TLS_V10.toString().equalsIgnoreCase(tlsProtocol)\n+                    || SSLProtocol.TLS_V11.toString().equalsIgnoreCase(tlsProtocol)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA4NTg0NQ=="}, "originalCommit": {"oid": "a7f1e6e8dc4e2240fd833fea988ef6a57903eee3"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1078, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}