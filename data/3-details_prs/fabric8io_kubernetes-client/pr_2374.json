{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3NjMxMDU1", "number": 2374, "title": "Fix #2316: Cannot load resource from stream without apiVersion", "bodyText": "Fix #2316\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null\nDescription\n\nType of change\n\n\n Bug fix (non-breaking change which fixes an issue)\n Feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to change\n Chore (non-breaking change which doesn't affect codebase;\ntest, version modification, documentation, etc.)\n\nChecklist\n\n Code contributed by me aligns with current project license: Apache 2.0\n I Added CHANGELOG entry regarding this change\n I have implemented unit tests to cover my changes\n I have added/updated the javadocs and other documentation accordingly\n No new bugs, code smells, etc. in SonarCloud report\n I tested my code in Kubernetes\n I tested my code in OpenShift", "createdAt": "2020-07-28T08:09:43Z", "url": "https://github.com/fabric8io/kubernetes-client/pull/2374", "merged": true, "mergeCommit": {"oid": "25c09cd5d790e55407f999b73502344b2d5f6d49"}, "closed": true, "closedAt": "2020-07-29T08:25:20Z", "author": {"login": "rohanKanojia"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5SKnTgFqTQ1NjQxNDQ4Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5XmtoAFqTQ1NjcxNDMxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDE0NDgy", "url": "https://github.com/fabric8io/kubernetes-client/pull/2374#pullrequestreview-456414482", "createdAt": "2020-07-28T08:29:39Z", "commit": {"oid": "492d18ed5beedd517fd6c358f64bbc92cf8c8cae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NTIzMDA1", "url": "https://github.com/fabric8io/kubernetes-client/pull/2374#pullrequestreview-456523005", "createdAt": "2020-07-28T11:00:05Z", "commit": {"oid": "492d18ed5beedd517fd6c358f64bbc92cf8c8cae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMTowMDowNVrOG4HdIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMTowMDowNVrOG4HdIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ5NTU4Ng==", "bodyText": "Are we sure we want to return the first item found.\nThis means that PACKAGES must be sorted by order of preference (for packages providing same Types/Kinds). If so maybe we should document this somewhere.", "url": "https://github.com/fabric8io/kubernetes-client/pull/2374#discussion_r461495586", "createdAt": "2020-07-28T11:00:05Z", "author": {"login": "manusa"}, "path": "kubernetes-model-generator/kubernetes-model-core/src/main/java/io/fabric8/kubernetes/internal/KubernetesDeserializer.java", "diffHunk": "@@ -248,16 +248,20 @@ private String getClassName(String key) {\n             // If only one class found, return it\n             if (possibleResults.size() == 1) {\n                 return possibleResults.get(0);\n-            }\n-\n-            // Compare with apiVersions being compared for set of classes found\n-            for (Class<? extends KubernetesResource> result : possibleResults) {\n+            } else if (possibleResults.size() > 1) {\n+              // Compare with apiVersions being compared for set of classes found\n+              for (Class<? extends KubernetesResource> result : possibleResults) {\n                 String defaultKeyFromClass = getKeyFromClass(result);\n                 if (key.equals(defaultKeyFromClass)) {\n-                    return result;\n+                  return result;\n                 }\n+              }\n+              // Not able to compare with apiVersions, perhaps it was not provided;\n+              // return first item found\n+              return possibleResults.get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "492d18ed5beedd517fd6c358f64bbc92cf8c8cae"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "492d18ed5beedd517fd6c358f64bbc92cf8c8cae", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/492d18ed5beedd517fd6c358f64bbc92cf8c8cae", "committedDate": "2020-07-28T06:53:07Z", "message": "Fix #2316: Cannot load resource from stream without apiVersion\n\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null"}, "afterCommit": {"oid": "ef19997f3ef0060e51ab67dd6d6b01165e3f44d4", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/ef19997f3ef0060e51ab67dd6d6b01165e3f44d4", "committedDate": "2020-07-28T14:21:41Z", "message": "Fix #2316: Cannot load resource from stream without apiVersion\n\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "522b07b73b7ab00f6b0f41bf76fe22a2e0553ceb", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/522b07b73b7ab00f6b0f41bf76fe22a2e0553ceb", "committedDate": "2020-07-28T14:48:19Z", "message": "Fix #2316: Cannot load resource from stream without apiVersion\n\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef19997f3ef0060e51ab67dd6d6b01165e3f44d4", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/ef19997f3ef0060e51ab67dd6d6b01165e3f44d4", "committedDate": "2020-07-28T14:21:41Z", "message": "Fix #2316: Cannot load resource from stream without apiVersion\n\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null"}, "afterCommit": {"oid": "522b07b73b7ab00f6b0f41bf76fe22a2e0553ceb", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/522b07b73b7ab00f6b0f41bf76fe22a2e0553ceb", "committedDate": "2020-07-28T14:48:19Z", "message": "Fix #2316: Cannot load resource from stream without apiVersion\n\nIn case of duplicate Kubernetes resources found, when no apiVersion\nis provided return first item found instead of null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NzE0MzE5", "url": "https://github.com/fabric8io/kubernetes-client/pull/2374#pullrequestreview-456714319", "createdAt": "2020-07-28T14:49:52Z", "commit": {"oid": "ef19997f3ef0060e51ab67dd6d6b01165e3f44d4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3724, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}