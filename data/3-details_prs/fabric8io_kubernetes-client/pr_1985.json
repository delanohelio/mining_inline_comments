{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNjk5MTY4", "number": 1985, "title": "Fix: authenticator uses id-token from ~/.kube/config", "bodyText": "Fixes #1177\nAccording to the official documentation:\n\nthe authenticator uses the id_token (not the access_token) from the OAuth2 token response as a bearer token\n\nThis explains why there is no access-token in the file.", "createdAt": "2020-02-04T08:09:23Z", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985", "merged": true, "mergeCommit": {"oid": "a87b704644123ac51f52343909014be114b1631a"}, "closed": true, "closedAt": "2020-02-05T16:19:19Z", "author": {"login": "matthyx"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcA9A6IgFqTM1Mjc4NDYwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBCL2zAFqTM1MzAwNDI5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzg0NjA0", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985#pullrequestreview-352784604", "createdAt": "2020-02-04T08:11:17Z", "commit": {"oid": "a65eb089e23454df31d08a2061c2c0de8aec36b6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyOTM1MjY3", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985#pullrequestreview-352935267", "createdAt": "2020-02-04T12:24:41Z", "commit": {"oid": "a65eb089e23454df31d08a2061c2c0de8aec36b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjoyNDo0MVrOFlSNCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjoyNDo0MVrOFlSNCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzOTg4Mw==", "bodyText": "I'm not really sure if this will introduce any regression as we are completely ditching ACCES_TOKEN which was added in #636 > #650\nI would probably do as the issue suggests (\"...Probably this code needs to be adapted to use either access-token or id-token, depending on what is available..\"): so try to use ID_TOKEN or try to fallback to ACCESS_TOKEN", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985#discussion_r374639883", "createdAt": "2020-02-04T12:24:41Z", "author": {"login": "manusa"}, "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/Config.java", "diffHunk": "@@ -537,8 +537,9 @@ private static boolean loadFromKubeconfig(Config config, String context, String\n           config.setUsername(currentAuthInfo.getUsername());\n           config.setPassword(currentAuthInfo.getPassword());\n \n-          if (Utils.isNullOrEmpty(config.getOauthToken()) && currentAuthInfo.getAuthProvider() != null && !Utils.isNullOrEmpty(currentAuthInfo.getAuthProvider().getConfig().get(ACCESS_TOKEN))) {\n-            config.setOauthToken(currentAuthInfo.getAuthProvider().getConfig().get(ACCESS_TOKEN));\n+          if (Utils.isNullOrEmpty(config.getOauthToken()) && currentAuthInfo.getAuthProvider() != null && !Utils.isNullOrEmpty(currentAuthInfo.getAuthProvider().getConfig().get(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a65eb089e23454df31d08a2061c2c0de8aec36b6"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a65eb089e23454df31d08a2061c2c0de8aec36b6", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/a65eb089e23454df31d08a2061c2c0de8aec36b6", "committedDate": "2020-02-04T08:04:38Z", "message": "Fix: authenticator uses id-token from ~/.kube/config"}, "afterCommit": {"oid": "9a544ba01a83ba65ebaa229f8bb7543150b8c842", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/9a544ba01a83ba65ebaa229f8bb7543150b8c842", "committedDate": "2020-02-04T13:13:47Z", "message": "Adding support for id-token from ~/.kube/config"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a544ba01a83ba65ebaa229f8bb7543150b8c842", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/9a544ba01a83ba65ebaa229f8bb7543150b8c842", "committedDate": "2020-02-04T13:13:47Z", "message": "Adding support for id-token from ~/.kube/config"}, "afterCommit": {"oid": "258c352bb5dc52276f085a824b78ff9a54e4cac1", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/258c352bb5dc52276f085a824b78ff9a54e4cac1", "committedDate": "2020-02-04T13:18:49Z", "message": "Added support for OpenID Connect token in kubeconfig"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0076f343478cfa24e2924d0dc552ff211d279d6", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/d0076f343478cfa24e2924d0dc552ff211d279d6", "committedDate": "2020-02-04T13:39:51Z", "message": "Added support for OpenID Connect token in kubeconfig"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "258c352bb5dc52276f085a824b78ff9a54e4cac1", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/258c352bb5dc52276f085a824b78ff9a54e4cac1", "committedDate": "2020-02-04T13:18:49Z", "message": "Added support for OpenID Connect token in kubeconfig"}, "afterCommit": {"oid": "d0076f343478cfa24e2924d0dc552ff211d279d6", "author": {"user": null}, "url": "https://github.com/fabric8io/kubernetes-client/commit/d0076f343478cfa24e2924d0dc552ff211d279d6", "committedDate": "2020-02-04T13:39:51Z", "message": "Added support for OpenID Connect token in kubeconfig"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDAzNDYw", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985#pullrequestreview-353003460", "createdAt": "2020-02-04T14:11:41Z", "commit": {"oid": "d0076f343478cfa24e2924d0dc552ff211d279d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDA0Mjk3", "url": "https://github.com/fabric8io/kubernetes-client/pull/1985#pullrequestreview-353004297", "createdAt": "2020-02-04T14:12:46Z", "commit": {"oid": "d0076f343478cfa24e2924d0dc552ff211d279d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3480, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}