{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3ODE1MjEw", "number": 2160, "title": "Tekton Backwards Compatibility & Code Sharing", "bodyText": "This PR implements the ideas outlined in #2159\nIt aims to make the tekton client backward compatible. You can use client.v1alpha1().xxx targeting tekton-pipelines <= v0.10.x (supporting only v1alpha1) but also >= v0.11.x (supporting both v1alpha1 and v1beta1).\nAs a result of using schemas based on v0.10.x for v1alpha1 and v0.11.x for v1beta1, the Java APIs contain only the fields supported by the version (e.g. inputsfor Task Spec v1alpha1 and not params which is only included in v1beta1).\nAs always, I\u00b4m looking forward to your feedback!\nBest regards,\nFabian\nA detailed list of changes:\n[common]\n\nextract go generation logic to shared package\nextract common model-annotator\nsupport for omitempty in the shared generator and model-annotator logic\nadded required indentation style for Makefile in the .editorconfig\n\n[tekton-annotator]\n\nreplace tekton-annotator with shared model-annotator\n\n[tekton-generator]\n\ngenerate separate tekton schema for versions using different go source dependency version\nuse shared go generation logic for tekton generators\nuse go vendor directory for tekton generators\nskip building the generator binary for tekton, instead only run the code\n\n[tekton-model]\n\nsplit tekton model by version into v1alpha1 and v1beta1\nremove the generated *Schema class for tekton", "createdAt": "2020-04-23T10:11:01Z", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160", "merged": true, "mergeCommit": {"oid": "8f0ecd906ecaf461037ff2762ae1694c09dbc7f7"}, "closed": true, "closedAt": "2020-05-03T07:58:09Z", "author": {"login": "Fabian-K"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaaIUiAFqTM5ODk1NzE1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccu2oaAFqTQwMzYzNTE1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTU3MTUz", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#pullrequestreview-398957153", "createdAt": "2020-04-23T10:14:44Z", "commit": {"oid": "cc4c2b38028c33967f4aa791e3c455db5c817c11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12ce385d5f899e24e53c07afd2d3c80d8ad0930a", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/12ce385d5f899e24e53c07afd2d3c80d8ad0930a", "committedDate": "2020-04-24T08:20:29Z", "message": "[common]\n- extract go generation logic to shared package\n- extract common model-annotator\n- support for omitempty in the shared generator and model-annotator logic\n- added required indentation style for Makefile in the .editorconfig\n\n[tekton-annotator]\n- replace tekton-annotator with shared model-annotator\n\n[tekton-generator]\n- generate separate tekton schema for versions using different go source dependency version\n- use shared go generation logic for tekton generators\n- use go vendor directory for tekton generators\n- skip building the generator binary for tekton, instead only run the code\n\n[tekton-model]\n- split tekton model by version into v1alpha1 and v1beta1\n- remove the generated *Schema class for tekton"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6075e9d0f2cec1139d2aa4d56f40620a96e2f49", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/f6075e9d0f2cec1139d2aa4d56f40620a96e2f49", "committedDate": "2020-04-24T08:22:10Z", "message": "tekton: fix wrong MappingProvider registrations causing #2158"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "428f8b4df89f5a437a9784dc712c9f5452f19230", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/428f8b4df89f5a437a9784dc712c9f5452f19230", "committedDate": "2020-04-23T14:23:49Z", "message": "tekton: fix wrong MappingProvider registrations causing #2158"}, "afterCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/d67bd94275d427ccd0577586ac33be82a7266f6d", "committedDate": "2020-04-24T08:44:00Z", "message": "tekton: update dependency to kubernetes model after split"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzA0Nzgw", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#pullrequestreview-401704780", "createdAt": "2020-04-28T10:30:26Z", "commit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMDozMDoyNlrOGNNgJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMDo1OToyNFrOGNOgLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUwNTg5Mg==", "bodyText": "I remember you said v1alpha1  needed to be built under go 1.13, Does v1beta1 requires it too?", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416505892", "createdAt": "2020-04-28T10:30:26Z", "author": {"login": "rohanKanojia"}, "path": "extensions/tekton/generator-v1beta1/go.mod", "diffHunk": "@@ -0,0 +1,11 @@\n+module github.com/fabric8io/kubernetes-client/extensions/tekton/generator\n+\n+require (\n+\tgithub.com/fabric8io/kubernetes-client/generator v0.0.0\n+\tgithub.com/tektoncd/pipeline v0.11.2\n+\tk8s.io/apimachinery v0.17.2\n+)\n+\n+replace github.com/fabric8io/kubernetes-client/generator v0.0.0 => ./../../../generator\n+\n+go 1.13", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMTgxMQ==", "bodyText": "Umm, the same goes for having a global generator. I would rather have it inside extensions rather than at the root of kubernetes client", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416511811", "createdAt": "2020-04-28T10:40:53Z", "author": {"login": "rohanKanojia"}, "path": "generator/go.mod", "diffHunk": "@@ -0,0 +1,3 @@\n+module github.com/fabric8io/kubernetes-client/generator", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMjQ2OQ==", "bodyText": "Umm, not sure whether it's a good idea to have global model-annotator. I would rather keep an annotator specific to all extensions or maybe to tekton only as it was earlier", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416512469", "createdAt": "2020-04-28T10:41:54Z", "author": {"login": "rohanKanojia"}, "path": "model-annotator/pom.xml", "diffHunk": "@@ -16,17 +16,18 @@\n     limitations under the License.\n \n -->\n-<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n     <groupId>io.fabric8</groupId>\n-    <artifactId>tekton-extension-pom</artifactId>\n+    <artifactId>kubernetes-client-project</artifactId>\n     <version>4.9-SNAPSHOT</version>\n   </parent>\n \n-  <artifactId>tekton-model-annotator</artifactId>\n+  <artifactId>model-annotator</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUyMjI4Nw==", "bodyText": "I remember @iocanel added our own ArrayOrString #2140 Maybe it got lost when we merged some changes", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416522287", "createdAt": "2020-04-28T10:59:24Z", "author": {"login": "rohanKanojia"}, "path": "extensions/tekton/generator-v1alpha1/cmd/generate/generate.go", "diffHunk": "@@ -16,48 +16,41 @@\n package main\n \n import (\n-\t\"bytes\"\n-\t\"encoding/json\"\n \t\"fmt\"\n-\t\"github.com/fabric8io/kubernetes-client/extensions/tekton/generator/pkg/schemagen\"\n+\t\"github.com/fabric8io/kubernetes-client/generator/pkg/schemagen\"\n \t\"github.com/tektoncd/pipeline/pkg/apis/pipeline/v1alpha1\"\n-\t\"github.com/tektoncd/pipeline/pkg/apis/pipeline/v1beta1\"\n \tresource \"github.com/tektoncd/pipeline/pkg/apis/resource/v1alpha1\"\n \tmachinery \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n-\t\"log\"\n \t\"reflect\"\n )\n \n func main() {\n \n+\t// continue from here -> somehow the ArrayOrString is fucked up\n+\t// and local changes of common part are not considered ?!\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24720d570b0788e182cb29e7c0e2757ffdca2731", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/24720d570b0788e182cb29e7c0e2757ffdca2731", "committedDate": "2020-04-29T08:05:13Z", "message": "tekton: update dependency to kubernetes model after split"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/d67bd94275d427ccd0577586ac33be82a7266f6d", "committedDate": "2020-04-24T08:44:00Z", "message": "tekton: update dependency to kubernetes model after split"}, "afterCommit": {"oid": "24720d570b0788e182cb29e7c0e2757ffdca2731", "author": {"user": {"login": "Fabian-K", "name": null}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/24720d570b0788e182cb29e7c0e2757ffdca2731", "committedDate": "2020-04-29T08:05:13Z", "message": "tekton: update dependency to kubernetes model after split"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNjM1MTU0", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#pullrequestreview-403635154", "createdAt": "2020-04-30T15:31:16Z", "commit": {"oid": "24720d570b0788e182cb29e7c0e2757ffdca2731"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3771, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}