{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3MDA3NjY5", "number": 2339, "title": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService", "bodyText": "Description\n\nFix #2299\nType of change\n\n\n Bug fix (non-breaking change which fixes an issue)\n Feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to change\n Chore (non-breaking change which doesn't affect codebase;\ntest, version modification, documentation, etc.)\n\nChecklist\n\n Code contributed by me aligns with current project license: Apache 2.0\n I Added CHANGELOG entry regarding this change\n I have implemented unit tests to cover my changes\n I have added/updated the javadocs and other documentation accordingly\n No new bugs, code smells, etc. in SonarCloud report\n I tested my code in Kubernetes\n I tested my code in OpenShift", "createdAt": "2020-07-09T17:53:12Z", "url": "https://github.com/fabric8io/kubernetes-client/pull/2339", "merged": true, "mergeCommit": {"oid": "00cd1337e0d8ef962c6bfb0307be3d1fd81f86a9"}, "closed": true, "closedAt": "2020-07-13T12:47:19Z", "author": {"login": "rohanKanojia"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczTUdnABqjM1MzA5MzYxOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0g1N5AFqTQ0NzIxNTMzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "893efdef986e32387edb5158063d302841e9b151", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/893efdef986e32387edb5158063d302841e9b151", "committedDate": "2020-07-09T17:50:52Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}, "afterCommit": {"oid": "7c7ff796f9b07c3e965fbeb05c2a6e1991bca107", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/7c7ff796f9b07c3e965fbeb05c2a6e1991bca107", "committedDate": "2020-07-09T18:26:03Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MjA0MTc3", "url": "https://github.com/fabric8io/kubernetes-client/pull/2339#pullrequestreview-446204177", "createdAt": "2020-07-10T08:07:27Z", "commit": {"oid": "7c7ff796f9b07c3e965fbeb05c2a6e1991bca107"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwODowNzoyN1rOGvt_sQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwODowNzoyN1rOGvt_sQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY4OTg0MQ==", "bodyText": "Not really sure if this Exception we'll be ever reached (at least for the cause described in the message). The exectorService.isShutdown()  check should prevent the exception for the alleged causes described in the message.", "url": "https://github.com/fabric8io/kubernetes-client/pull/2339#discussion_r452689841", "createdAt": "2020-07-10T08:07:27Z", "author": {"login": "manusa"}, "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/ExecWebSocketListener.java", "diffHunk": "@@ -205,11 +206,15 @@ public void onOpen(WebSocket webSocket, Response response) {\n             }\n \n             webSocketRef.set(webSocket);\n-            executorService.submit(pumper);\n-            started.set(true);\n-            queue.add(true);\n+            if (!executorService.isShutdown()) {\n+              executorService.submit(pumper);\n+              started.set(true);\n+              queue.add(true);\n+            }\n         } catch (IOException e) {\n-            queue.add(new KubernetesClientException(OperationSupport.createStatus(response)));\n+          queue.add(new KubernetesClientException(OperationSupport.createStatus(response)));\n+        } catch (RejectedExecutionException rejectedTaskException) {\n+          throw new KubernetesClientException(\"Unable to write to OutputStream since close() has been called.\", rejectedTaskException.getCause());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c7ff796f9b07c3e965fbeb05c2a6e1991bca107"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c7ff796f9b07c3e965fbeb05c2a6e1991bca107", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/7c7ff796f9b07c3e965fbeb05c2a6e1991bca107", "committedDate": "2020-07-09T18:26:03Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}, "afterCommit": {"oid": "5a68719e82368ce575a6b10d3dc10ed597d9d37c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/5a68719e82368ce575a6b10d3dc10ed597d9d37c", "committedDate": "2020-07-10T13:27:49Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDU2NDc0", "url": "https://github.com/fabric8io/kubernetes-client/pull/2339#pullrequestreview-446456474", "createdAt": "2020-07-10T14:39:13Z", "commit": {"oid": "5a68719e82368ce575a6b10d3dc10ed597d9d37c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8723537303845eb4572bbd47097ac332e81b9f2", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/b8723537303845eb4572bbd47097ac332e81b9f2", "committedDate": "2020-07-13T12:18:54Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a68719e82368ce575a6b10d3dc10ed597d9d37c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/5a68719e82368ce575a6b10d3dc10ed597d9d37c", "committedDate": "2020-07-10T13:27:49Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}, "afterCommit": {"oid": "b8723537303845eb4572bbd47097ac332e81b9f2", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/fabric8io/kubernetes-client/commit/b8723537303845eb4572bbd47097ac332e81b9f2", "committedDate": "2020-07-13T12:18:54Z", "message": "Fix #2299: Improve error handling of RejectedExecutionException from ExecutorService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MjE1MzM2", "url": "https://github.com/fabric8io/kubernetes-client/pull/2339#pullrequestreview-447215336", "createdAt": "2020-07-13T12:45:14Z", "commit": {"oid": "b8723537303845eb4572bbd47097ac332e81b9f2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3715, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}