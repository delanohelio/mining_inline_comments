{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMDkxMDAz", "number": 2283, "title": "Add possibility to register post-discovery filters via SPI", "bodyText": "Overview\nfixes #1997\nAs we discussed before, I introduced additional configuration property for LauncherConfig that allows users to control post-discovery filter auto registration and related methods. For consistency reasons, I introduced an additional method to manually add required post-discovery filters.\nThis part of changes available in separate commit cb24d1c\nThen, additional filters are populated to EngineDiscoveryOrchestrator. I don't feel right about introduced changes in Launcher interface, It would be nice to hear your opinion on that point. The other option would be to modify the constructor of DefaultLauncher (or add a constructor that creates DefaultLauncher  from provided EngineDiscoveryOrchestrator.\nThe same way I feel about EngineDiscoveryOrchestrator -- I decided to not change constructor and use fluent setter, but maybe it would be better to change existed EngineDiscoveryOrchestrator to accept post-discovery filters in addition to engines.\nWhen we agree, I'll add more tests and, probably, we should add support for these changes to TestKit as well\n\nI hereby agree to the terms of the JUnit Contributor License Agreement.\n\nDefinition of Done\n\n There are no TODOs left in the code\n Method preconditions are checked and documented in the method's Javadoc\n Coding conventions (e.g. for logging) have been followed\n Change is covered by automated tests including corner cases, errors, and exception handling\n Public API has Javadoc and @API annotations\n Change is documented in the User Guide and Release Notes\n All continuous integration builds pass", "createdAt": "2020-05-01T11:13:13Z", "url": "https://github.com/junit-team/junit5/pull/2283", "merged": true, "mergeCommit": {"oid": "7ae529fc87433707458d5df74da5eb2922a6874f"}, "closed": true, "closedAt": "2020-05-31T19:31:55Z", "author": {"login": "baev"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcc-yXGgH2gAyNDEyMDkxMDAzOmNiMjRkMWNmNTE1YzljZTZlNDFlYTU5Y2JlNmY3MDM5MThhYTljNTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmwsmpAH2gAyNDEyMDkxMDAzOjY3YzJjNTlmOWExYTI5MTgwODhhMjQ3YjZiZTM3ZGQ1NTEzOTdhN2E=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cb24d1cf515c9ce6e41ea59cbe6f703918aa9c56", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/cb24d1cf515c9ce6e41ea59cbe6f703918aa9c56", "committedDate": "2020-05-01T10:05:05Z", "message": "introduce post discovery filters configuration properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9623ff6d94296b033cb0e13acb56dc72d21f195f", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/9623ff6d94296b033cb0e13acb56dc72d21f195f", "committedDate": "2020-05-01T11:11:12Z", "message": "add additional post discovery filters to engine discovery orchestrator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "059975404539eb05b2b0833b64a906171ef356aa", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/059975404539eb05b2b0833b64a906171ef356aa", "committedDate": "2020-05-01T12:01:24Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b424bb5abef5b7dcac375dde28f910dcc2d9e790", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/b424bb5abef5b7dcac375dde28f910dcc2d9e790", "committedDate": "2020-05-01T12:27:34Z", "message": "review fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "094dcb38f841bdb6e7ecf1b2262e3e2db47c6668", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/094dcb38f841bdb6e7ecf1b2262e3e2db47c6668", "committedDate": "2020-05-01T12:25:34Z", "message": "review fixes"}, "afterCommit": {"oid": "b424bb5abef5b7dcac375dde28f910dcc2d9e790", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/b424bb5abef5b7dcac375dde28f910dcc2d9e790", "committedDate": "2020-05-01T12:27:34Z", "message": "review fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32311177f3aabadc91e3d0fd2308708706dad926", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/32311177f3aabadc91e3d0fd2308708706dad926", "committedDate": "2020-05-01T12:46:39Z", "message": "add new service to module info"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a43108cf915c196e28706b9b0d6ea2b2186cec46", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/a43108cf915c196e28706b9b0d6ea2b2186cec46", "committedDate": "2020-05-01T13:14:04Z", "message": "add spi tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "committedDate": "2020-05-01T13:26:41Z", "message": "fix tooling tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8b5ca94d4f545bf231074e468d94e2b5598ec69", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/c8b5ca94d4f545bf231074e468d94e2b5598ec69", "committedDate": "2020-05-01T13:14:13Z", "message": "fix tooling tests"}, "afterCommit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/67ebd891b45fe985fb78ab8d5beb0e6f1a96536c", "committedDate": "2020-05-01T13:26:41Z", "message": "fix tooling tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MTg3MDA1", "url": "https://github.com/junit-team/junit5/pull/2283#pullrequestreview-404187005", "createdAt": "2020-05-01T14:25:19Z", "commit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNDoyNToxOVrOGPLHHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNDozMTowMVrOGPLRhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2Mzg2OQ==", "bodyText": "nit: we don't use final for local variables.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal List<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);\n          \n          \n            \n            \t\tList<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418563869", "createdAt": "2020-05-01T14:25:19Z", "author": {"login": "marcphilipp"}, "path": "junit-platform-launcher/src/main/java/org/junit/platform/launcher/core/EngineDiscoveryOrchestrator.java", "diffHunk": "@@ -82,7 +86,10 @@ public LauncherDiscoveryResult discover(LauncherDiscoveryRequest request, String\n \t\t\ttestEngineDescriptors.put(testEngine, rootDescriptor);\n \t\t}\n \n-\t\tapplyPostDiscoveryFilters(testEngineDescriptors, request.getPostDiscoveryFilters());\n+\t\tfinal List<PostDiscoveryFilter> filters = new LinkedList<>(postDiscoveryFilters);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NDg5NQ==", "bodyText": "\u2753 I'm not sure we should be using a Set here but then again it's consistent with engines above. Thoughts?", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418564895", "createdAt": "2020-05-01T14:27:32Z", "author": {"login": "marcphilipp"}, "path": "junit-platform-launcher/src/main/java/org/junit/platform/launcher/core/LauncherFactory.java", "diffHunk": "@@ -93,7 +94,13 @@ public static Launcher create(LauncherConfig config) throws PreconditionViolatio\n \t\t}\n \t\tengines.addAll(config.getAdditionalTestEngines());\n \n-\t\tLauncher launcher = new DefaultLauncher(engines);\n+\t\tSet<PostDiscoveryFilter> filters = new LinkedHashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NTI1Mw==", "bodyText": "Ditto.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal boolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);\n          \n          \n            \n            \t\tboolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418565253", "createdAt": "2020-05-01T14:28:18Z", "author": {"login": "marcphilipp"}, "path": "platform-tests/src/test/java/org/junit/platform/launcher/TestPostDiscoveryFilter.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junit.platform.launcher;\n+\n+import org.junit.platform.engine.FilterResult;\n+import org.junit.platform.engine.TestDescriptor;\n+import org.junit.platform.engine.TestTag;\n+\n+public class TestPostDiscoveryFilter implements PostDiscoveryFilter {\n+\t@Override\n+\tpublic FilterResult apply(final TestDescriptor object) {\n+\t\tfinal boolean include = object.getTags().stream().map(TestTag::getName).anyMatch(\"test-post-discovery\"::equals);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2NjUzMg==", "bodyText": "How about TestPostDiscoveryTagFilter?", "url": "https://github.com/junit-team/junit5/pull/2283#discussion_r418566532", "createdAt": "2020-05-01T14:31:01Z", "author": {"login": "marcphilipp"}, "path": "platform-tests/src/test/java/org/junit/platform/launcher/TestPostDiscoveryFilter.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junit.platform.launcher;\n+\n+import org.junit.platform.engine.FilterResult;\n+import org.junit.platform.engine.TestDescriptor;\n+import org.junit.platform.engine.TestTag;\n+\n+public class TestPostDiscoveryFilter implements PostDiscoveryFilter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67ebd891b45fe985fb78ab8d5beb0e6f1a96536c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "689fcf17021e45f33e4221f03381ff6bef47a6de", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/689fcf17021e45f33e4221f03381ff6bef47a6de", "committedDate": "2020-05-01T14:58:55Z", "message": "get rid of final modifier\n\nCo-authored-by: Marc Philipp <marc@gradle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c92a9f9f6338e961de48443a80656fda7cf76483", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/c92a9f9f6338e961de48443a80656fda7cf76483", "committedDate": "2020-05-01T14:59:23Z", "message": "get rid of final modifier 2\n\nCo-authored-by: Marc Philipp <marc@gradle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d2bcf760cc42763191e7569e3d5345acd382ef1", "author": {"user": {"login": "baev", "name": "Dmitry Baev"}}, "url": "https://github.com/junit-team/junit5/commit/5d2bcf760cc42763191e7569e3d5345acd382ef1", "committedDate": "2020-05-01T15:41:53Z", "message": "review fixes 2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTcwNzI5", "url": "https://github.com/junit-team/junit5/pull/2283#pullrequestreview-419970729", "createdAt": "2020-05-28T10:19:21Z", "commit": {"oid": "5d2bcf760cc42763191e7569e3d5345acd382ef1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a4b3cf93d1f55ed6114793b4682ab2e2a2f9b21", "author": {"user": {"login": "marcphilipp", "name": "Marc Philipp"}}, "url": "https://github.com/junit-team/junit5/commit/4a4b3cf93d1f55ed6114793b4682ab2e2a2f9b21", "committedDate": "2020-05-31T19:11:02Z", "message": "Document SPI support for PostDiscoveryFilter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8ae6d8ee2bab799427a4df6a06a23d2abac1e56", "author": {"user": {"login": "marcphilipp", "name": "Marc Philipp"}}, "url": "https://github.com/junit-team/junit5/commit/d8ae6d8ee2bab799427a4df6a06a23d2abac1e56", "committedDate": "2020-05-31T19:18:15Z", "message": "Add missing API annotations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67c2c59f9a1a2918088a247b6be37dd551397a7a", "author": {"user": {"login": "marcphilipp", "name": "Marc Philipp"}}, "url": "https://github.com/junit-team/junit5/commit/67c2c59f9a1a2918088a247b6be37dd551397a7a", "committedDate": "2020-05-31T19:19:22Z", "message": "Merge branch 'master' into 1997-spi-post-discovery-filter"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3538, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}