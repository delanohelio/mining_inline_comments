{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMDcyMTg4", "number": 645, "title": "CXF-8222 OIDC Refresh Response: ID Token iat Claim MUST represent the time that the new ID Token is issued", "bodyText": "", "createdAt": "2020-03-01T17:38:02Z", "url": "https://github.com/apache/cxf/pull/645", "merged": true, "mergeCommit": {"oid": "6e828d6f0fea652231d0cdc9990169c3583ad03a"}, "closed": true, "closedAt": "2020-03-06T20:44:59Z", "author": {"login": "amarkevich"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJcnQKgH2gAyMzgyMDcyMTg4OjdjOGNiMDQ5MDdjNDkxZGQ4NGE4NWFjMWU4MWUxYTllZTY3YzAzMjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLC9CsAFqTM3MDQ2NzY3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c8cb04907c491dd84a85ac1e81e1a9ee67c0320", "author": {"user": {"login": "amarkevich", "name": "Alexey Markevich"}}, "url": "https://github.com/apache/cxf/commit/7c8cb04907c491dd84a85ac1e81e1a9ee67c0320", "committedDate": "2020-03-01T17:31:37Z", "message": "CXF-8222 OIDC Refresh Response: ID Token iat Claim MUST represent the\ntime that the new ID Token is issued"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "963470dfe8dcca8f5daf0e0105d0643b8aecea66", "author": {"user": {"login": "amarkevich", "name": "Alexey Markevich"}}, "url": "https://github.com/apache/cxf/commit/963470dfe8dcca8f5daf0e0105d0643b8aecea66", "committedDate": "2020-03-02T07:56:15Z", "message": "Merge remote-tracking branch 'cxf/master' into CXF-8222"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5636943e92e3f3012b8b784a8cf15971156b641", "author": {"user": {"login": "amarkevich", "name": "Alexey Markevich"}}, "url": "https://github.com/apache/cxf/commit/d5636943e92e3f3012b8b784a8cf15971156b641", "committedDate": "2020-03-02T07:57:21Z", "message": "adjust test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3MTcyNTc5", "url": "https://github.com/apache/cxf/pull/645#pullrequestreview-367172579", "createdAt": "2020-03-02T12:49:26Z", "commit": {"oid": "d5636943e92e3f3012b8b784a8cf15971156b641"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjo0OToyNlrOFweUgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjo0OToyNlrOFweUgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3MjczNg==", "bodyText": "Could you explain the logic here? Why set issued at / expiry only if st.getResponseType() is null?", "url": "https://github.com/apache/cxf/pull/645#discussion_r386372736", "createdAt": "2020-03-02T12:49:26Z", "author": {"login": "coheigea"}, "path": "rt/rs/security/sso/oidc/src/main/java/org/apache/cxf/rs/security/oidc/idp/IdTokenResponseFilter.java", "diffHunk": "@@ -78,7 +78,12 @@ private String getProcessedIdToken(ServerAccessToken st) {\n                 idToken.setAudience(st.getClient().getClientId());\n                 idToken.setAuthorizedParty(st.getClient().getClientId());\n                 // if this token was refreshed then the cloned IDToken might need to have its\n-                // issuedAt and expiry time properties adjusted if it proves to be necessary\n+                // issuedAt and expiry time properties adjusted\n+                if (null == st.getResponseType()) {\n+                    final Long iat = st.getIssuedAt();\n+                    idToken.setExpiryTime(iat + (idToken.getExpiryTime() - idToken.getIssuedAt()));\n+                    idToken.setIssuedAt(iat);\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5636943e92e3f3012b8b784a8cf15971156b641"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "934cb96848468e05b6ec829182b03624b6bee9b5", "author": {"user": {"login": "amarkevich", "name": "Alexey Markevich"}}, "url": "https://github.com/apache/cxf/commit/934cb96848468e05b6ec829182b03624b6bee9b5", "committedDate": "2020-03-05T12:50:29Z", "message": "Merge remote-tracking branch 'origin/master' into CXF-8222"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0286e8bc16e39054a02ceeadf67b3733e48e1fbb", "author": {"user": {"login": "amarkevich", "name": "Alexey Markevich"}}, "url": "https://github.com/apache/cxf/commit/0286e8bc16e39054a02ceeadf67b3733e48e1fbb", "committedDate": "2020-03-05T18:53:57Z", "message": "set \"refresh_token\" grantType in RefreshTokenGrantHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNDY3Njcx", "url": "https://github.com/apache/cxf/pull/645#pullrequestreview-370467671", "createdAt": "2020-03-06T16:45:44Z", "commit": {"oid": "0286e8bc16e39054a02ceeadf67b3733e48e1fbb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2207, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}