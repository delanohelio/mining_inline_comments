{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MDg2OTc3", "number": 236, "title": "[MOB-1482] Add Device Attributes methods", "bodyText": "Adding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods.", "createdAt": "2020-05-27T20:05:29Z", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236", "merged": true, "mergeCommit": {"oid": "c5c45e5cf5e90aa2c4eafe31b18ce8e14a0f2573"}, "closed": true, "closedAt": "2020-06-03T21:56:25Z", "author": {"login": "Ayyanchira"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnJTHMgFqTQyMjI1NDc4NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnwQ_mABqjM0MDQxMTg0Nzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMjU0Nzg1", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#pullrequestreview-422254785", "createdAt": "2020-06-01T23:54:16Z", "commit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMzo1NDoxNlrOGddrzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMzo1OTowNFrOGddw4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU0ODIzNw==", "bodyText": "Why not initialize it here?", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r433548237", "createdAt": "2020-06-01T23:54:16Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -52,6 +55,7 @@\n \n     private IterableInAppManager inAppManager;\n     private String inboxSessionId;\n+    private HashMap<String, String> deviceAttributes;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU0ODM2NQ==", "bodyText": "You can remove these checks if you initialize it above.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r433548365", "createdAt": "2020-06-01T23:54:40Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -201,6 +205,23 @@ void setNotificationData(IterableNotificationData data) {\n             setAttributionInfo(new IterableAttributionInfo(data.getCampaignId(), data.getTemplateId(), data.getMessageId()));\n         }\n     }\n+\n+    HashMap getDeviceAttributes() {\n+        return deviceAttributes;\n+    }\n+\n+    public void setDeviceAttribute(String key, String value) {\n+        if (deviceAttributes == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU0OTE3NA==", "bodyText": "You can just do for(HashMap.Entry<String, String> entry : deviceAttributes.entrySet())", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r433549174", "createdAt": "2020-06-01T23:57:36Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -1114,6 +1135,15 @@ protected void registerDeviceToken(@Nullable String email, @Nullable String user\n             if (dataFields == null) {\n                 dataFields = new JSONObject();\n             }\n+\n+            if (deviceAttributes != null) {\n+                Iterator<HashMap.Entry<String, String>> deviceAttributesIterator = deviceAttributes.entrySet().iterator();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU0OTUzOA==", "bodyText": "Hmmm I'm wondering if we should put device attributes in iterablePushRegistrationData since we store everything else related to the push registration there.. I don't think this will make a significant difference, but could be better for consistency. Your call.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r433549538", "createdAt": "2020-06-01T23:59:04Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterablePushRegistration.java", "diffHunk": "@@ -33,7 +34,8 @@ protected Void doInBackground(IterablePushRegistrationData... params) {\n                             iterablePushRegistrationData.email,\n                             iterablePushRegistrationData.userId,\n                             iterablePushRegistrationData.pushIntegrationName,\n-                            pushRegistrationObject.token);\n+                            pushRegistrationObject.token,\n+                            IterableApi.getInstance().getDeviceAttributes());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ad48161970de903d9c93961d25831d91c0301fc", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/3ad48161970de903d9c93961d25831d91c0301fc", "committedDate": "2020-05-27T20:04:55Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}, "afterCommit": {"oid": "d414ab544e176144e3b8dc348aef61f81ce5b44d", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/d414ab544e176144e3b8dc348aef61f81ce5b44d", "committedDate": "2020-06-02T07:37:09Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d414ab544e176144e3b8dc348aef61f81ce5b44d", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/d414ab544e176144e3b8dc348aef61f81ce5b44d", "committedDate": "2020-06-02T07:37:09Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}, "afterCommit": {"oid": "1e28fa4e61fb2c96564245e8d4f8b7fa5c706015", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/1e28fa4e61fb2c96564245e8d4f8b7fa5c706015", "committedDate": "2020-06-02T15:39:58Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/36ffccfe6231f22c2f49b5bcf3ceef0404f32263", "committedDate": "2020-06-02T15:57:06Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1e28fa4e61fb2c96564245e8d4f8b7fa5c706015", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/1e28fa4e61fb2c96564245e8d4f8b7fa5c706015", "committedDate": "2020-06-02T15:39:58Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}, "afterCommit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/36ffccfe6231f22c2f49b5bcf3ceef0404f32263", "committedDate": "2020-06-02T15:57:06Z", "message": "[MOB-1482] Add Device Attributes methods\n\nAdding methods to add custom device attributes, remove device attributes. Integrated it with existing push registration and test methods."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzOTM1NzY4", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#pullrequestreview-423935768", "createdAt": "2020-06-03T21:04:31Z", "commit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QyMTowNDozMVrOGetaVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QyMTowNDozMVrOGetaVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg1NDQ4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void removeFromDeviceAttribute(String key) {\n          \n          \n            \n                public void removeDeviceAttribute(String key) {", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r434854484", "createdAt": "2020-06-03T21:04:31Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -201,6 +203,18 @@ void setNotificationData(IterableNotificationData data) {\n             setAttributionInfo(new IterableAttributionInfo(data.getCampaignId(), data.getTemplateId(), data.getMessageId()));\n         }\n     }\n+\n+    HashMap getDeviceAttributes() {\n+        return deviceAttributes;\n+    }\n+\n+    public void setDeviceAttribute(String key, String value) {\n+        deviceAttributes.put(key, value);\n+    }\n+\n+    public void removeFromDeviceAttribute(String key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzOTM2MDY0", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#pullrequestreview-423936064", "createdAt": "2020-06-03T21:04:56Z", "commit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QyMTowNDo1NlrOGetbtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QyMTowNDo1NlrOGetbtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg1NDgzOQ==", "bodyText": "It is never null", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#discussion_r434854839", "createdAt": "2020-06-03T21:04:56Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -1114,6 +1128,13 @@ protected void registerDeviceToken(@Nullable String email, @Nullable String user\n             if (dataFields == null) {\n                 dataFields = new JSONObject();\n             }\n+\n+            if (deviceAttributes != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36ffccfe6231f22c2f49b5bcf3ceef0404f32263"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzOTQyNzI3", "url": "https://github.com/Iterable/iterable-android-sdk/pull/236#pullrequestreview-423942727", "createdAt": "2020-06-03T21:15:29Z", "commit": {"oid": "b611fb5164e855cf811a60e817efd4909b7bdcfc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b611fb5164e855cf811a60e817efd4909b7bdcfc", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/b611fb5164e855cf811a60e817efd4909b7bdcfc", "committedDate": "2020-06-03T21:13:13Z", "message": "Update iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java\n\nCo-authored-by: Victor Babenko <victor@iterable.com>"}, "afterCommit": {"oid": "8fb232dc16386291a75fd3191a8d643ac8f8193d", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/8fb232dc16386291a75fd3191a8d643ac8f8193d", "committedDate": "2020-06-03T21:22:07Z", "message": "Update iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java\n\nCo-authored-by: Victor Babenko <victor@iterable.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e3fbee0e95dfd3a573b6390df69510e315adef4", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/0e3fbee0e95dfd3a573b6390df69510e315adef4", "committedDate": "2020-06-03T21:22:58Z", "message": "Update iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java\n\nCo-authored-by: Victor Babenko <victor@iterable.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8fb232dc16386291a75fd3191a8d643ac8f8193d", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/8fb232dc16386291a75fd3191a8d643ac8f8193d", "committedDate": "2020-06-03T21:22:07Z", "message": "Update iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java\n\nCo-authored-by: Victor Babenko <victor@iterable.com>"}, "afterCommit": {"oid": "0e3fbee0e95dfd3a573b6390df69510e315adef4", "author": {"user": {"login": "Ayyanchira", "name": "Akshay Ayyanchira"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/0e3fbee0e95dfd3a573b6390df69510e315adef4", "committedDate": "2020-06-03T21:22:58Z", "message": "Update iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java\n\nCo-authored-by: Victor Babenko <victor@iterable.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 630, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}