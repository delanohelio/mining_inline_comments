{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NzUyNzA3", "number": 223, "title": "Adds Campaign ID to IterableInAppMessage", "bodyText": "This is a very simple edit which exposes the campaignId in the IterableInAppMessage.  It converts a missing clientId key or a null value to an empty string, just like the Swift SDK\nI didn't touch anything regarding tests, but I see that there are quite a few test suites that use IterableInAppMessage.  If updating tests is something that should be included in this PR, let me know and I can get on it.  All tests are passing on my machine with this change included.", "createdAt": "2020-04-19T23:02:06Z", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223", "merged": true, "mergeCommit": {"oid": "c1620b867b3df1eb13b6931ec9320213cd038df3"}, "closed": true, "closedAt": "2020-04-28T21:14:26Z", "author": {"login": "nkotula"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYnyipAH2gAyNDA1NzUyNzA3OjI0NjgxNzg2NjE3ZDJhNTNhZGEwZWY5MTJhODM2Njc4MzJmNTE1NzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccKOEpgH2gAyNDA1NzUyNzA3OjM0ZmE0ODA2NGQ1OTdmY2Q5OTBmZGFiZWRkMTFhMTM3YjFmNzRlZTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24681786617d2a53ada0ef912a83667832f51573", "author": {"user": {"login": "nkotula", "name": "Nikolai Kotula"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/24681786617d2a53ada0ef912a83667832f51573", "committedDate": "2020-04-17T21:01:46Z", "message": "Adds campaignId to IterableInAppMessage\n\nThis parses a missing key or a null value for the JSON `clientId` as an\nempty string, just like the Swift SDK"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDczMTMy", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-396073132", "createdAt": "2020-04-19T23:08:58Z", "commit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzowODo1OFrOGH-Mxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzowODo1OFrOGH-Mxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTAxMjI5NA==", "bodyText": "Removed redundant import.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#discussion_r411012294", "createdAt": "2020-04-19T23:08:58Z", "author": {"login": "nkotula"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppMessage.java", "diffHunk": "@@ -7,7 +7,6 @@\n import androidx.annotation.RestrictTo;\n import androidx.core.util.ObjectsCompat;\n \n-import org.json.JSONArray;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDczMTkx", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-396073191", "createdAt": "2020-04-19T23:09:38Z", "commit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzowOTozOFrOGH-NPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzowOTozOFrOGH-NPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTAxMjQxMw==", "bodyText": "I reorganized the code here because I find this easier to read, but this is solely a code style change and I could revert this back to one line if that's preferred.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#discussion_r411012413", "createdAt": "2020-04-19T23:09:38Z", "author": {"login": "nkotula"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppMessage.java", "diffHunk": "@@ -30,8 +30,18 @@\n     private boolean loadedHtmlFromJson = false;\n     private @Nullable IterableInAppStorage inAppStorageInterface;\n \n-    IterableInAppMessage(@NonNull String messageId, @NonNull Content content, @NonNull JSONObject customPayload, @NonNull Date createdAt, @NonNull Date expiresAt, @NonNull Trigger trigger, @Nullable Boolean saveToInbox, @Nullable InboxMetadata inboxMetadata) {\n+    IterableInAppMessage(@NonNull String messageId,\n+                         @NonNull String campaignId,\n+                         @NonNull Content content,\n+                         @NonNull JSONObject customPayload,\n+                         @NonNull Date createdAt,\n+                         @NonNull Date expiresAt,\n+                         @NonNull Trigger trigger,\n+                         @Nullable Boolean saveToInbox,\n+                         @Nullable InboxMetadata inboxMetadata) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDczNDEy", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-396073412", "createdAt": "2020-04-19T23:11:41Z", "commit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzoxMTo0MVrOGH-O1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQyMzoxMTo0MVrOGH-O1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTAxMjgyMQ==", "bodyText": "Again, I find this style of constructor/method invocation where parameters are on individual lines much more readable, but I could very easily revert this as it is only code-style related.  The core change is to simply add the campaignId to the constructor invocation.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#discussion_r411012821", "createdAt": "2020-04-19T23:11:41Z", "author": {"login": "nkotula"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppMessage.java", "diffHunk": "@@ -306,8 +322,17 @@ static IterableInAppMessage fromJSONObject(@NonNull JSONObject messageJson, @Nul\n         JSONObject inboxPayloadJson = messageJson.optJSONObject(IterableConstants.ITERABLE_IN_APP_INBOX_METADATA);\n         InboxMetadata inboxMetadata = InboxMetadata.fromJSONObject(inboxPayloadJson);\n \n-        IterableInAppMessage message = new IterableInAppMessage(messageId,\n-                new Content(html, padding, backgroundAlpha), customPayload, createdAt, expiresAt, trigger, saveToInbox, inboxMetadata);\n+        IterableInAppMessage message = new IterableInAppMessage(\n+                messageId,\n+                campaignId,\n+                new Content(html, padding, backgroundAlpha),\n+                customPayload,\n+                createdAt,\n+                expiresAt,\n+                trigger,\n+                saveToInbox,\n+                inboxMetadata);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24681786617d2a53ada0ef912a83667832f51573"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "768a55ea6ca04c7ce017c0294216524d7b3abcc2", "author": {"user": {"login": "nkotula", "name": "Nikolai Kotula"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/768a55ea6ca04c7ce017c0294216524d7b3abcc2", "committedDate": "2020-04-22T17:46:31Z", "message": "Changes clientId to Long with validation checks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDQxMDY2", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-398441066", "createdAt": "2020-04-22T17:58:33Z", "commit": {"oid": "768a55ea6ca04c7ce017c0294216524d7b3abcc2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzo1ODozM1rOGKDmFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzo1ODozM1rOGKDmFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE5Nzg0Nw==", "bodyText": "I'd make it return long and default to 0. Long is here only to serialize/deserialize properly, for a consumer of this API it shouldn't matter whether it is 0 or null.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#discussion_r413197847", "createdAt": "2020-04-22T17:58:33Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppMessage.java", "diffHunk": "@@ -193,6 +203,11 @@ public String getMessageId() {\n         return messageId;\n     }\n \n+    @Nullable\n+    public Long getCampaignId() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "768a55ea6ca04c7ce017c0294216524d7b3abcc2"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "079f84fe0d797d99b2590bdb9f146af22259724f", "author": {"user": {"login": "nkotula", "name": "Nikolai Kotula"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/079f84fe0d797d99b2590bdb9f146af22259724f", "committedDate": "2020-04-23T14:51:10Z", "message": "Make public campaign ID getter non-null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDMyMTQy", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-399432142", "createdAt": "2020-04-23T20:00:04Z", "commit": {"oid": "079f84fe0d797d99b2590bdb9f146af22259724f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QyMDowMDowNFrOGK5uxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QyMDowMDowNFrOGK5uxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA4NDgwNA==", "bodyText": "Why not just use an inline ternary rather than creating separate retrieval/validation methods?\nfinal Long campaignId = (messageJson.isNull(IterableConstants.KEY_CAMPAIGN_ID)) ? null :\njsonObject.optLong(IterableConstants.KEY_CAMPAIGN_ID);", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#discussion_r414084804", "createdAt": "2020-04-23T20:00:04Z", "author": {"login": "davidtruong"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppMessage.java", "diffHunk": "@@ -281,6 +299,7 @@ static IterableInAppMessage fromJSONObject(@NonNull JSONObject messageJson, @Nul\n         }\n \n         String messageId = messageJson.optString(IterableConstants.KEY_MESSAGE_ID);\n+        final Long campaignId = IterableUtil.retrieveValidCampaignIdOrNull(messageJson, IterableConstants.KEY_CAMPAIGN_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "079f84fe0d797d99b2590bdb9f146af22259724f"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a17487fdfc88eb05e3c19b4ff1e061af2ac19a7f", "author": {"user": {"login": "nkotula", "name": "Nikolai Kotula"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/a17487fdfc88eb05e3c19b4ff1e061af2ac19a7f", "committedDate": "2020-04-24T18:12:28Z", "message": "Revert \"Make public campaign ID getter non-null\"\n\nThis reverts commit 079f84fe0d797d99b2590bdb9f146af22259724f.\nPer discussion in PR, this value is indeed optional in the JSON, so it\nis appropriate to leave it nullable."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMTI1MzU3", "url": "https://github.com/Iterable/iterable-android-sdk/pull/223#pullrequestreview-401125357", "createdAt": "2020-04-27T16:32:19Z", "commit": {"oid": "a17487fdfc88eb05e3c19b4ff1e061af2ac19a7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34fa48064d597fcd990fdabedd11a137b1f74ee6", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/34fa48064d597fcd990fdabedd11a137b1f74ee6", "committedDate": "2020-04-28T20:50:23Z", "message": "Merge branch 'master' into feature/campaign-id-visibility"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 616, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}