{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NzY0NDM2", "number": 253, "title": "[MOB-1896] allow token to be set with same email or userId", "bodyText": "", "createdAt": "2020-07-21T21:48:22Z", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253", "merged": true, "mergeCommit": {"oid": "040722484291b95ee6cce855137a2c49fcc96827"}, "closed": true, "closedAt": "2020-07-27T19:52:03Z", "author": {"login": "roninopf"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3NY23AH2gAyNDU0NzY0NDM2OmZkMWNiYWFiYjkxMGJjNjAyZDI2MjJkYTA0M2YzMzY1MDdmNzcxMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5HHTugFqTQ1NjA3NzIyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fd1cbaabb910bc602d2622da043f336507f7711d", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/fd1cbaabb910bc602d2622da043f336507f7711d", "committedDate": "2020-07-21T21:47:50Z", "message": "allow token to be set with same email or userId"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyODYxODM2", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-452861836", "createdAt": "2020-07-21T22:03:30Z", "commit": {"oid": "fd1cbaabb910bc602d2622da043f336507f7711d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjowMzozMVrOG1LcHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjowMzozMVrOG1LcHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQxNTEzNQ==", "bodyText": "I think it should be\nelse if (email == _email && (_authToken == null || _authToken != authToken)) {\n//update the authToken\n}\n\nOnly if the email passed in the function is the one already been set in Iterable, we should update the token.\nIf the email is new, we should perform log out, log in and then store the auth.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r458415135", "createdAt": "2020-07-21T22:03:31Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -288,20 +288,20 @@ public void setEmail(@Nullable String email) {\n      * @param authToken Authorization token\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n-        if (_email != null && _email.equals(email)) {\n-            return;\n-        }\n+        if (_email != null && !_email.equals(email)) {\n+            onLogOut();\n \n-        if (_email == null && _userId == null && email == null) {\n-            return;\n-        }\n+            _email = email;\n+            _userId = null;\n+            _authToken = authToken;\n+\n+            storeAuthData();\n \n-        onLogOut();\n-        _email = email;\n-        _userId = null;\n-        _authToken = authToken;\n-        storeAuthData();\n-        onLogIn();\n+            onLogIn();\n+        } else if (email != null && (_authToken == null || _authToken != authToken)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1cbaabb910bc602d2622da043f336507f7711d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyODYyNjI2", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-452862626", "createdAt": "2020-07-21T22:05:05Z", "commit": {"oid": "fd1cbaabb910bc602d2622da043f336507f7711d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjowNTowNVrOG1LezQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjowNTowNVrOG1LezQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQxNTgyMQ==", "bodyText": "Just like with email,\nwe might have to check if userId == !userId && (_authToken == null || _authToken != authToken)) {\n//update authToken\n}", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r458415821", "createdAt": "2020-07-21T22:05:05Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -324,20 +324,20 @@ public void setUserId(@Nullable String userId) {\n      * @param authToken Authorization token\n      */\n     public void setUserId(@Nullable String userId, @Nullable String authToken) {\n-        if (_userId != null && _userId.equals(userId)) {\n-            return;\n-        }\n+        if (_userId != null && !_userId.equals(userId)) {\n+            onLogOut();\n \n-        if (_email == null && _userId == null && userId == null) {\n-            return;\n-        }\n+            _email = null;\n+            _userId = userId;\n+            _authToken = authToken;\n+\n+            storeAuthData();\n \n-        onLogOut();\n-        _email = null;\n-        _userId = userId;\n-        _authToken = authToken;\n-        storeAuthData();\n-        onLogIn();\n+            onLogIn();\n+        } else if (userId != null & (_authToken == null || _authToken != authToken)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1cbaabb910bc602d2622da043f336507f7711d"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3648b4944ab08b771426e18caef749dbb5064454", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/3648b4944ab08b771426e18caef749dbb5064454", "committedDate": "2020-07-21T23:43:24Z", "message": "add stricter checks for setting auth data"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyOTM3NTM5", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-452937539", "createdAt": "2020-07-22T01:39:16Z", "commit": {"oid": "3648b4944ab08b771426e18caef749dbb5064454"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozOToxNlrOG1Pm1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozOToxNlrOG1Pm1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MzQxMw==", "bodyText": "we will need to set _email to new email", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r458483413", "createdAt": "2020-07-22T01:39:16Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -288,20 +288,20 @@ public void setEmail(@Nullable String email) {\n      * @param authToken Authorization token\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n-        if (_email != null && _email.equals(email)) {\n-            return;\n-        }\n+        if (_email != null && !_email.equals(email)) {\n+            onLogOut();\n \n-        if (_email == null && _userId == null && email == null) {\n-            return;\n-        }\n+            _email = email;\n+            _userId = null;\n+            _authToken = authToken;\n+\n+            storeAuthData();\n \n-        onLogOut();\n-        _email = email;\n-        _userId = null;\n-        _authToken = authToken;\n-        storeAuthData();\n-        onLogIn();\n+            onLogIn();\n+        } else if (email != null && email.equals(_email) && (_authToken == null || _authToken != authToken)) {\n+            _authToken = authToken;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3648b4944ab08b771426e18caef749dbb5064454"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjgxMDI3", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-453681027", "createdAt": "2020-07-22T20:59:58Z", "commit": {"oid": "3648b4944ab08b771426e18caef749dbb5064454"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDo1OTo1OFrOG10A9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDo1OTo1OFrOG10A9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3OTkyNA==", "bodyText": "This will skip execution if _email (current email) is null. The tests caught that.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r459079924", "createdAt": "2020-07-22T20:59:58Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -288,20 +288,20 @@ public void setEmail(@Nullable String email) {\n      * @param authToken Authorization token\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n-        if (_email != null && _email.equals(email)) {\n-            return;\n-        }\n+        if (_email != null && !_email.equals(email)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3648b4944ab08b771426e18caef749dbb5064454"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efea88220596dbd60c1dcd7126ca14b2f5a88e12", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/efea88220596dbd60c1dcd7126ca14b2f5a88e12", "committedDate": "2020-07-23T00:01:08Z", "message": "simplify auth flow conditions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NDI3MDQ5", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-454427049", "createdAt": "2020-07-23T19:19:46Z", "commit": {"oid": "efea88220596dbd60c1dcd7126ca14b2f5a88e12"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxOToxOTo0NlrOG2YRQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxOToxOTo0NlrOG2YRQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY3MzkyMg==", "bodyText": "I think this still doesn't do what we want it to do.. We don't want to run logout/login if current email & userId are null, and the new email is also null.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r459673922", "createdAt": "2020-07-23T19:19:46Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -288,20 +288,29 @@ public void setEmail(@Nullable String email) {\n      * @param authToken Authorization token\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n-        if (_email != null && _email.equals(email)) {\n-            return;\n-        }\n+        if (email == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efea88220596dbd60c1dcd7126ca14b2f5a88e12"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NDI3NTIx", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-454427521", "createdAt": "2020-07-23T19:20:26Z", "commit": {"oid": "efea88220596dbd60c1dcd7126ca14b2f5a88e12"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxOToyMDoyNlrOG2YSyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxOToyMDoyNlrOG2YSyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY3NDMxNA==", "bodyText": "Since we don't check for nullity of _email here, if we pass an non-null email when the current _email is null, it will throw an exception.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r459674314", "createdAt": "2020-07-23T19:20:26Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -288,20 +288,29 @@ public void setEmail(@Nullable String email) {\n      * @param authToken Authorization token\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n-        if (_email != null && _email.equals(email)) {\n-            return;\n-        }\n+        if (email == null) {\n+            onLogOut();\n \n-        if (_email == null && _userId == null && email == null) {\n-            return;\n-        }\n+            _email = null;\n+            _userId = null;\n+            _authToken = null;\n+\n+            storeAuthData();\n+        } else if (_email.equals(email) && _authToken != authToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efea88220596dbd60c1dcd7126ca14b2f5a88e12"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9289d2f90dae400b87ce93490afc7dccd675cb9a", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/9289d2f90dae400b87ce93490afc7dccd675cb9a", "committedDate": "2020-07-24T00:12:32Z", "message": "add token cases after reverting to existing flow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NTg1NTY2", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-454585566", "createdAt": "2020-07-24T00:57:55Z", "commit": {"oid": "9289d2f90dae400b87ce93490afc7dccd675cb9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDo1Nzo1NlrOG2gUBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDo1Nzo1NlrOG2gUBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTgwNTcwMw==", "bodyText": "if we return here,\nwe won't perform setEmail for where developer doesnt want to implement authToken at all. authToken and _authToken being null should still allow setEmail operation", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r459805703", "createdAt": "2020-07-24T00:57:56Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -289,6 +289,17 @@ public void setEmail(@Nullable String email) {\n      */\n     public void setEmail(@Nullable String email, @Nullable String authToken) {\n         if (_email != null && _email.equals(email)) {\n+            if (_authToken == null && authToken == null) {\n+                return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9289d2f90dae400b87ce93490afc7dccd675cb9a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c1f2e4e07e5b3729722ca0b375ac981faf562f8", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/0c1f2e4e07e5b3729722ca0b375ac981faf562f8", "committedDate": "2020-07-24T19:54:22Z", "message": "add auth consistency unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MjU1OTIy", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-455255922", "createdAt": "2020-07-25T03:02:39Z", "commit": {"oid": "0c1f2e4e07e5b3729722ca0b375ac981faf562f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwMzowMjozOVrOG3B58w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwMzowMjozOVrOG3B58w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NjA4Mw==", "bodyText": "What do we need this for?", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r460356083", "createdAt": "2020-07-25T03:02:39Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableApi.java", "diffHunk": "@@ -1223,6 +1245,10 @@ protected void registerDeviceToken(@Nullable String email, @Nullable String user\n         }\n     }\n \n+    protected String getAuthToken() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c1f2e4e07e5b3729722ca0b375ac981faf562f8"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MjU2MDQ5", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-455256049", "createdAt": "2020-07-25T03:05:02Z", "commit": {"oid": "0c1f2e4e07e5b3729722ca0b375ac981faf562f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwMzowNTowM1rOG3B6ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwMzowNTowM1rOG3B6ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NjI4Mg==", "bodyText": "Since these tests aren't testing persistence, I think these shouldn't have *Persistence suffixes.\nThe tests checking persistence create a new instance of IterableApi to make sure it doesn't have values in memory and loads them from disk.", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r460356282", "createdAt": "2020-07-25T03:05:03Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java", "diffHunk": "@@ -630,4 +630,194 @@ public void testTrackInAppDeleteWithNullParameters() throws Exception {\n         assertNull(requestJson.optString(IterableConstants.KEY_INBOX_SESSION_ID, null));\n     }\n \n+    @Test\n+    public void testSetEmailWithTokenPersistence() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c1f2e4e07e5b3729722ca0b375ac981faf562f8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5df512bdcd0c04cb2ee1df721a5a8a26bdeca3c4", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/5df512bdcd0c04cb2ee1df721a5a8a26bdeca3c4", "committedDate": "2020-07-27T18:07:01Z", "message": "split authentication tests to separate file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ba4515e3102cab95c979797a6e353c0c24a0cd2", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/5ba4515e3102cab95c979797a6e353c0c24a0cd2", "committedDate": "2020-07-27T18:43:07Z", "message": "rename auth tests for clarity"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDQ0NDIw", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-456044420", "createdAt": "2020-07-27T18:47:15Z", "commit": {"oid": "5ba4515e3102cab95c979797a6e353c0c24a0cd2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxODo0NzoxNVrOG3vGAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxODo0NzoxNVrOG3vGAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA5NjQ1MA==", "bodyText": "What does *Status suffix mean?", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#discussion_r461096450", "createdAt": "2020-07-27T18:47:15Z", "author": {"login": "vbabenkoru"}, "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableApiAuthTests.java", "diffHunk": "@@ -0,0 +1,232 @@\n+package com.iterable.iterableapi;\n+\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.robolectric.RuntimeEnvironment;\n+\n+import java.io.IOException;\n+\n+import static junit.framework.Assert.assertEquals;\n+import static junit.framework.Assert.assertNull;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.spy;\n+\n+public class IterableApiAuthTests extends BaseTest {\n+\n+    private IterableUtil.IterableUtilImpl originalIterableUtil;\n+    private IterableUtil.IterableUtilImpl iterableUtilSpy;\n+\n+    @Before\n+    public void setUp() {\n+        reInitIterableApi();\n+\n+        originalIterableUtil = IterableUtil.instance;\n+        iterableUtilSpy = spy(originalIterableUtil);\n+        IterableUtil.instance = iterableUtilSpy;\n+    }\n+\n+    @After\n+    public void tearDown() throws IOException {\n+        IterableUtil.instance = originalIterableUtil;\n+        iterableUtilSpy = null;\n+    }\n+\n+    private void reInitIterableApi() {\n+        IterableApi.sharedInstance = spy(new IterableApi());\n+        IterableInAppManager inAppManagerMock = mock(IterableInAppManager.class);\n+        doReturn(inAppManagerMock).when(IterableApi.sharedInstance).getInAppManager();\n+    }\n+\n+    @Test\n+    public void testSetEmailWithTokenStatus() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ba4515e3102cab95c979797a6e353c0c24a0cd2"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f12d63659051eb25fff7f658b133a4f48f17fa2", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/1f12d63659051eb25fff7f658b133a4f48f17fa2", "committedDate": "2020-07-27T18:56:08Z", "message": "remove suffix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d9aa1d4144b86e4235e1b994b1114b2aa7fcaa7", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/3d9aa1d4144b86e4235e1b994b1114b2aa7fcaa7", "committedDate": "2020-07-27T18:58:31Z", "message": "add userId logout test, make them more rigorous"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8553e73c501c8763bafb0c33b5ae000b090b5b91", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/8553e73c501c8763bafb0c33b5ae000b090b5b91", "committedDate": "2020-07-27T19:05:04Z", "message": "set auth token accessor to package-protected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2157dc6d41300e43a92665963be297e8aa6df6f", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/b2157dc6d41300e43a92665963be297e8aa6df6f", "committedDate": "2020-07-27T19:28:45Z", "message": "Merge branch 'master' into MOB-1896-allow-token-change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3f29c2dd3036a83f27e8ccde78a922aa333500f", "author": {"user": {"login": "roninopf", "name": "Jay Kim"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/d3f29c2dd3036a83f27e8ccde78a922aa333500f", "committedDate": "2020-07-27T19:31:58Z", "message": "set authentication functions to package private"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDc3MjIw", "url": "https://github.com/Iterable/iterable-android-sdk/pull/253#pullrequestreview-456077220", "createdAt": "2020-07-27T19:37:05Z", "commit": {"oid": "d3f29c2dd3036a83f27e8ccde78a922aa333500f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 643, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}