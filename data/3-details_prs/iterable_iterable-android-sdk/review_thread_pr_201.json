{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4Nzc3OTgy", "number": 201, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNjo0MTo0NVrODiOQJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyMzozNVrODiPTFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjExNjg3OnYy", "diffSide": "RIGHT", "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/util/DataManager.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNjo0MTo0NVrOFtWuKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNjo0MTo0NVrOFtWuKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEwMjUwNg==", "bodyText": "Too good!!!", "url": "https://github.com/Iterable/iterable-android-sdk/pull/201#discussion_r383102506", "createdAt": "2020-02-24T06:41:45Z", "author": {"login": "Ayyanchira"}, "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/util/DataManager.kt", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.iterable.inbox_customization.util\n+\n+import android.content.Context\n+import android.os.StrictMode\n+import com.iterable.iterableapi.IterableApi\n+import com.iterable.iterableapi.IterableInternal\n+import okhttp3.mockwebserver.MockResponse\n+import okhttp3.mockwebserver.MockWebServer\n+import okio.Buffer\n+import okio.source\n+\n+class DataManager {\n+    var context: Context? = null\n+    val server = MockWebServer()\n+    val serverUrl: String\n+    val dispatcher = PathBasedStaticDispatcher()\n+\n+    init {\n+        // Required for `server.url(\"\")` to work on main thread without throwing an exception\n+        // DO NOT USE THIS in production. This is for demo purposes only.\n+        StrictMode.setThreadPolicy(StrictMode.ThreadPolicy.Builder().permitAll().build())\n+\n+        server.dispatcher = dispatcher\n+        serverUrl = server.url(\"\").toString()\n+    }\n+\n+    fun initializeIterableApi(context: Context) {\n+        this.context = context\n+        initHttpMocks()\n+        IterableApi.overrideURLEndpointPath(serverUrl)\n+        IterableApi.initialize(context, \"apiKey\")\n+        IterableApi.getInstance().setEmail(\"user@example.com\")\n+        loadData(\"simple-inbox-messages.json\")\n+    }\n+\n+    fun initHttpMocks() {\n+        loadFileMock(\"mocha.png\")\n+        loadFileMock(\"black-coffee.png\")\n+        loadFileMock(\"cappuccino.png\")\n+        loadFileMock(\"latte.png\")\n+    }\n+\n+    fun loadFileMock(imageName: String) {\n+        val buffer = Buffer()\n+        context!!.resources.assets.open(imageName).source().use {\n+            buffer.writeAll(it)\n+        }\n+        dispatcher.setResponse(\"/$imageName\", MockResponse().setBody(buffer))\n+    }\n+\n+    companion object {\n+        val instance = DataManager()\n+\n+        fun initializeIterableApi(context: Context) {\n+            instance.initializeIterableApi(context)\n+        }\n+\n+        fun loadData(resourceName: String) {\n+            val body = getAssetString(resourceName).replace(\"https://somewhere.com/\", instance.serverUrl)\n+            instance.dispatcher.setResponse(\"/inApp/getMessages\", MockResponse().setBody(body))\n+            IterableInternal.syncInApp()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54061f00a8e319b1c1295c5438b349786a7c2baf"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjE4MTgxOnYy", "diffSide": "RIGHT", "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/customizations/MultipleCellTypes.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNzoyNzozN1rOFtXTDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNzoyNzozN1rOFtXTDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzExMTk1MQ==", "bodyText": "\ud83d\udc4c", "url": "https://github.com/Iterable/iterable-android-sdk/pull/201#discussion_r383111951", "createdAt": "2020-02-24T07:27:37Z", "author": {"login": "Ayyanchira"}, "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/customizations/MultipleCellTypes.kt", "diffHunk": "@@ -0,0 +1,63 @@\n+package com.iterable.inbox_customization.customizations\n+\n+import android.os.Bundle\n+import android.text.format.DateUtils\n+import android.view.View\n+import com.iterable.inbox_customization.MainFragment\n+import com.iterable.inbox_customization.R\n+import com.iterable.inbox_customization.util.DataManager\n+import com.iterable.inbox_customization.util.SingleFragmentActivity\n+import com.iterable.iterableapi.IterableInAppMessage\n+import com.iterable.iterableapi.ui.inbox.IterableInboxAdapter\n+import com.iterable.iterableapi.ui.inbox.IterableInboxAdapterExtension\n+import com.iterable.iterableapi.ui.inbox.IterableInboxFragment\n+import java.util.*\n+\n+fun MainFragment.onInboxWithMultipleCellTypesClicked() {\n+    DataManager.loadData(\"inbox-with-multiple-cell-types-messages.json\")\n+    val intent = SingleFragmentActivity.createIntentWithFragment(\n+        activity!!,\n+        MultipleCellTypesInboxFragment::class.java\n+    )\n+    startActivity(intent)\n+}\n+\n+class MultipleCellTypesInboxFragment : IterableInboxFragment(),\n+    IterableInboxAdapterExtension<Nothing> {\n+\n+    val ITEM_TYPE_DEFAULT = 0\n+    val ITEM_TYPE_LIGHT = 1\n+    val ITEM_TYPE_DARK = 2\n+\n+    override fun onCreate(savedInstanceState: Bundle?) {\n+        super.onCreate(savedInstanceState)\n+        setAdapterExtension(this)\n+    }\n+\n+    override fun getItemViewType(message: IterableInAppMessage): Int {\n+        return when (message.customPayload.optString(\"messageType\")) {\n+            \"light\" -> ITEM_TYPE_LIGHT\n+            \"dark\" -> ITEM_TYPE_DARK\n+            else -> ITEM_TYPE_DEFAULT\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54061f00a8e319b1c1295c5438b349786a7c2baf"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjI4ODIwOnYy", "diffSide": "RIGHT", "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/util/PathBasedStaticDispatcher.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyMzozNVrOFtYPfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyMzozNVrOFtYPfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyNzQyMg==", "bodyText": "\ud83d\udc4c", "url": "https://github.com/Iterable/iterable-android-sdk/pull/201#discussion_r383127422", "createdAt": "2020-02-24T08:23:35Z", "author": {"login": "Ayyanchira"}, "path": "sample-apps/inbox-customization/app/src/main/java/com/iterable/inbox_customization/util/PathBasedStaticDispatcher.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package com.iterable.inbox_customization.util\n+\n+import okhttp3.mockwebserver.Dispatcher\n+import okhttp3.mockwebserver.MockResponse\n+import okhttp3.mockwebserver.RecordedRequest\n+import java.util.*\n+\n+class PathBasedStaticDispatcher : Dispatcher() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54061f00a8e319b1c1295c5438b349786a7c2baf"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2254, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}