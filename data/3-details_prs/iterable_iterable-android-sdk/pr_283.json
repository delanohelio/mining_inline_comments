{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5NDg1MzI4", "number": 283, "title": "[MOB-2341] Refactor tests to not depend on partial mocks", "bodyText": "This only removes some of them; ApiClient split is required to remove the others, so I'll do that there.", "createdAt": "2020-11-11T22:25:44Z", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283", "merged": true, "mergeCommit": {"oid": "8169115832277912fe62fe8ebb7bd4ee39503fe6"}, "closed": true, "closedAt": "2020-11-13T04:08:08Z", "author": {"login": "vbabenkoru"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdblpOBAH2gAyNTE5NDg1MzI4OmQxMDY3Nzg2MGUwZWZiMmVjMTI0MTFhNjU1Y2Y3OGViNWEyZDdhMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdb-8-FABqjM5OTE2NzY5MjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d10677860e0efb2ec12411a655cf78eb5a2d7a1d", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/d10677860e0efb2ec12411a655cf78eb5a2d7a1d", "committedDate": "2020-11-11T22:24:42Z", "message": "Replace partial mocking with constructor injection for InAppManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dcccc1177490cb6547293a661150a93bfe77c06", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/8dcccc1177490cb6547293a661150a93bfe77c06", "committedDate": "2020-11-11T22:29:08Z", "message": "Remove individual iterableUtilSpy, use IterableUtilRule instead"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd445a805d8df13a07e3aa74cdae561919ca03f0", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/fd445a805d8df13a07e3aa74cdae561919ca03f0", "committedDate": "2020-11-11T22:59:14Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}, "afterCommit": {"oid": "e1862dcbc0b8a812ad0515839636da80d31a7b35", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/e1862dcbc0b8a812ad0515839636da80d31a7b35", "committedDate": "2020-11-11T23:36:34Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e1862dcbc0b8a812ad0515839636da80d31a7b35", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/e1862dcbc0b8a812ad0515839636da80d31a7b35", "committedDate": "2020-11-11T23:36:34Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}, "afterCommit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/4406d19119044d0fb34793b1820cd1208deeebd0", "committedDate": "2020-11-12T00:48:37Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NjYxODE2", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#pullrequestreview-528661816", "createdAt": "2020-11-12T01:02:52Z", "commit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMTowMjo1MlrOHxlL0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMTowMjo1MlrOHxlL0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc1MTUwNg==", "bodyText": "\ud83d\udc4c", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#discussion_r521751506", "createdAt": "2020-11-12T01:02:52Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableInAppManagerSyncTest.java", "diffHunk": "@@ -75,11 +75,9 @@ public void testSyncOnLaunch() throws Exception {\n     @Test\n     public void testSyncOnLogin() throws Exception {\n         IterableInAppManager inAppManagerMock = mock(IterableInAppManager.class);\n-        IterableApi apiSpy = spy(new IterableApi());\n-        IterableApi.sharedInstance = apiSpy;\n+        IterableApi.sharedInstance = new IterableApi(inAppManagerMock);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NjYyNjc0", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#pullrequestreview-528662674", "createdAt": "2020-11-12T01:05:16Z", "commit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMTowNToxNlrOHxlRkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMTowNToxNlrOHxlRkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc1Mjk3Ng==", "bodyText": "few more line breaks here and down.. especially after \"fake key\"", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#discussion_r521752976", "createdAt": "2020-11-12T01:05:16Z", "author": {"login": "Ayyanchira"}, "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java", "diffHunk": "@@ -205,7 +196,8 @@ public void testHandleUniversalLinkRewrite() throws Exception {\n \n     @Test\n     public void testSetEmailWithAutomaticPushRegistration() throws Exception {\n-        IterableApi.initialize(RuntimeEnvironment.application, \"fake_key\", new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());\n+        IterableApi.initialize(getContext(), \"fake_key\",\n+                new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0"}, "originalPosition": 143}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NjcwOTgy", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#pullrequestreview-528670982", "createdAt": "2020-11-12T01:30:13Z", "commit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "committedDate": "2020-11-13T03:53:45Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/4406d19119044d0fb34793b1820cd1208deeebd0", "committedDate": "2020-11-12T00:48:37Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}, "afterCommit": {"oid": "7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "author": {"user": {"login": "vbabenkoru", "name": "Victor Babenko"}}, "url": "https://github.com/Iterable/iterable-android-sdk/commit/7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "committedDate": "2020-11-13T03:53:45Z", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 546, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}