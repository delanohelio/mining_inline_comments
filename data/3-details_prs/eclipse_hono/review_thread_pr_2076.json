{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MDQ3Nzc0", "number": 2076, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDo1OTo0NVrOEMb8DA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDo1OTo0NVrOEMb8DA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNDc2MTA4OnYy", "diffSide": "RIGHT", "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDo1OTo0NVrOGuiyJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMjo1ODo0OFrOGum2yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw==", "bodyText": "My first intuition here would have been to keep the order of the checks and do the (usually less expensive) tenant and device checks first. But, thinking more about it, I agree that doing the connection limit check first seems more intuitive and logical. In any case, that is also how it is done in the MQTT adapter.", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451457573", "createdAt": "2020-07-08T10:59:45Z", "author": {"login": "calohmn"}, "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "diffHunk": "@@ -377,6 +377,36 @@ private void processRemoteOpen(final ProtonConnection con) {\n             TracingHelper.setDeviceTags(span, authenticatedDevice.getTenantId(), authenticatedDevice.getDeviceId());\n         }\n \n+        checkConnectionLimitForAdapter()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "863cdbebed65665989a3c5b95ee644c0f0107c3d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ2MDE5Ng==", "bodyText": "actually, the adapter connection limit check is the cheapest one of all as it doesn't require any remote service invocation at all but simply checks an integer that is managed within the Metrics implementation class ...", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451460196", "createdAt": "2020-07-08T11:04:56Z", "author": {"login": "sophokles73"}, "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "diffHunk": "@@ -377,6 +377,36 @@ private void processRemoteOpen(final ProtonConnection con) {\n             TracingHelper.setDeviceTags(span, authenticatedDevice.getTenantId(), authenticatedDevice.getDeviceId());\n         }\n \n+        checkConnectionLimitForAdapter()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw=="}, "originalCommit": {"oid": "863cdbebed65665989a3c5b95ee644c0f0107c3d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTUyNDI5Nw==", "bodyText": "right, I confused it with the message limit check.", "url": "https://github.com/eclipse/hono/pull/2076#discussion_r451524297", "createdAt": "2020-07-08T12:58:48Z", "author": {"login": "calohmn"}, "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "diffHunk": "@@ -377,6 +377,36 @@ private void processRemoteOpen(final ProtonConnection con) {\n             TracingHelper.setDeviceTags(span, authenticatedDevice.getTenantId(), authenticatedDevice.getDeviceId());\n         }\n \n+        checkConnectionLimitForAdapter()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ1NzU3Mw=="}, "originalCommit": {"oid": "863cdbebed65665989a3c5b95ee644c0f0107c3d"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3195, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}