{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNTE2NTE2", "number": 2339, "title": "[#2338] Fix NPE in AMQP adapter when content-type is null.", "bodyText": "This patch fixes #2338 by setting \"application/octet-stream\" as the content-type if nothing is set (analogous to the MQTT adapter).", "createdAt": "2020-12-01T19:15:40Z", "url": "https://github.com/eclipse/hono/pull/2339", "merged": true, "mergeCommit": {"oid": "e4f3a3555e566bf2af94c10cccc43a62ce9eb554"}, "closed": true, "closedAt": "2020-12-03T06:19:02Z", "author": {"login": "b-abel"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiJlXQgFqTU0MjU2NDczOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiME_FAFqTU0MjcwMTcxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTY0NzM4", "url": "https://github.com/eclipse/hono/pull/2339#pullrequestreview-542564738", "createdAt": "2020-12-02T07:40:36Z", "commit": {"oid": "ecbd560356b4d198626378234b063dc302799dad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo0MDozN1rOH9N9Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo0MDozN1rOH9N9Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1Mzg4Mg==", "bodyText": "A hint in the javadoc about the default value would be good here (like in MqttContext#contentType).", "url": "https://github.com/eclipse/hono/pull/2339#discussion_r533953882", "createdAt": "2020-12-02T07:40:37Z", "author": {"login": "calohmn"}, "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/AmqpContext.java", "diffHunk": "@@ -105,7 +105,7 @@ final int getPayloadSize() {\n      * @return The content type of the AMQP 1.0 message.\n      */\n     final String getMessageContentType() {\n-        return message.getContentType();\n+        return Optional.ofNullable(message.getContentType()).orElse(MessageHelper.CONTENT_TYPE_OCTET_STREAM);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecbd560356b4d198626378234b063dc302799dad"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e0963e13d285023a606b85355b6006859ee3339", "author": {"user": {"login": "b-abel", "name": "Abel B\u00fcchner-Mihaljevi\u0107"}}, "url": "https://github.com/eclipse/hono/commit/7e0963e13d285023a606b85355b6006859ee3339", "committedDate": "2020-12-02T10:12:42Z", "message": "[#2338] AmqpContext.getMessageContentType() no longer returns null.\n\nIf the AMQP message in AmqpContext does not contain a content type, the default\ncontent type is returned. This is necessary because Telemetry and Event API\nrequire a content type to be set.\n\nSigned-off-by: Abel Buechner-Mihaljevic <abel.buechner-mihaljevic@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecbd560356b4d198626378234b063dc302799dad", "author": {"user": {"login": "b-abel", "name": "Abel B\u00fcchner-Mihaljevi\u0107"}}, "url": "https://github.com/eclipse/hono/commit/ecbd560356b4d198626378234b063dc302799dad", "committedDate": "2020-12-01T19:14:16Z", "message": "[#2338] Fix NPE in AMQP adapter when content-type is null.\n\nSigned-off-by: Abel Buechner-Mihaljevic <abel.buechner-mihaljevic@bosch.io>"}, "afterCommit": {"oid": "7e0963e13d285023a606b85355b6006859ee3339", "author": {"user": {"login": "b-abel", "name": "Abel B\u00fcchner-Mihaljevi\u0107"}}, "url": "https://github.com/eclipse/hono/commit/7e0963e13d285023a606b85355b6006859ee3339", "committedDate": "2020-12-02T10:12:42Z", "message": "[#2338] AmqpContext.getMessageContentType() no longer returns null.\n\nIf the AMQP message in AmqpContext does not contain a content type, the default\ncontent type is returned. This is necessary because Telemetry and Event API\nrequire a content type to be set.\n\nSigned-off-by: Abel Buechner-Mihaljevic <abel.buechner-mihaljevic@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNzAxNzEz", "url": "https://github.com/eclipse/hono/pull/2339#pullrequestreview-542701713", "createdAt": "2020-12-02T10:34:58Z", "commit": {"oid": "7e0963e13d285023a606b85355b6006859ee3339"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 470, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}