{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4NDY2NzA4", "number": 2185, "title": "[#2166] Improve 503 error messages in HTTP adapter", "bodyText": "Also improve the corresponding documentation for the HTTP adapter and CoAP adapter.\nThis fixes #2166.", "createdAt": "2020-09-17T07:28:36Z", "url": "https://github.com/eclipse/hono/pull/2185", "merged": true, "mergeCommit": {"oid": "52155998f4f563aaa39d1b53cfac5002b593e753"}, "closed": true, "closedAt": "2020-09-30T18:01:46Z", "author": {"login": "calohmn"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJsJQMgFqTQ5MDMyMDkzOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN7OeyAFqTQ5OTMzODU1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMzIwOTM4", "url": "https://github.com/eclipse/hono/pull/2185#pullrequestreview-490320938", "createdAt": "2020-09-17T07:37:33Z", "commit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "state": "COMMENTED", "comments": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNzozNzozM1rOHTVTkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNzo0ODoyMFrOHTVrhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzNDA2Nw==", "bodyText": "this looks like it would be helpful in both ClientErrorException and ServerErrorException. Thus, IMHO we should add this to ServiceInvocationException.", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490034067", "createdAt": "2020-09-17T07:37:33Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/ServerErrorException.java", "diffHunk": "@@ -21,6 +21,8 @@\n \n     private static final long serialVersionUID = 1L;\n \n+    private String clientFacingMessage;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzNDIzNQ==", "bodyText": "final?", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490034235", "createdAt": "2020-09-17T07:37:53Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/ServerErrorException.java", "diffHunk": "@@ -115,4 +117,22 @@ public ServerErrorException(final String tenant, final int errorCode, final Stri\n             throw new IllegalArgumentException(\"client error code must be >= 500 and < 600\");\n         }\n     }\n+\n+    /**\n+     * Gets the error message suitable to be propagated to an external client.\n+     *\n+     * @return The message or {@code null}.\n+     */\n+    public String getClientFacingMessage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzNDI5MQ==", "bodyText": "final ?", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490034291", "createdAt": "2020-09-17T07:38:00Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/ServerErrorException.java", "diffHunk": "@@ -115,4 +117,22 @@ public ServerErrorException(final String tenant, final int errorCode, final Stri\n             throw new IllegalArgumentException(\"client error code must be >= 500 and < 600\");\n         }\n     }\n+\n+    /**\n+     * Gets the error message suitable to be propagated to an external client.\n+     *\n+     * @return The message or {@code null}.\n+     */\n+    public String getClientFacingMessage() {\n+        return clientFacingMessage;\n+    }\n+\n+    /**\n+     * Sets the error message suitable to be propagated to an external client.\n+     *\n+     * @param clientFacingMessage The message.\n+     */\n+    public void setClientFacingMessage(final String clientFacingMessage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzNTg4MQ==", "bodyText": "FMPOV you have now opened Pandora's Box of (localized) messages ;-)\nI do not think that we should populate our constants classes with full fledged error messages ...\nInstead, we should probably use resource bundles which have been designed for this purpose.", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490035881", "createdAt": "2020-09-17T07:40:48Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/impl/AbstractSender.java", "diffHunk": "@@ -56,6 +56,24 @@\n  */\n public abstract class AbstractSender extends AbstractHonoClient implements MessageSender {\n \n+    /**\n+     * Client facing error message for the case of a message sender not receiving a delivery update in time.\n+     * May be used as {@link ServerErrorException#clientFacingMessage}.\n+     */\n+    public static final String ERROR_SEND_MESSAGE_TIMEOUT = \"consumer failed to indicate in time whether it has processed the message\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzNzg5Mg==", "bodyText": "no comma here", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490037892", "createdAt": "2020-09-17T07:44:22Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -86,15 +86,18 @@ The device is authenticated using PSK.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzODk4MA==", "bodyText": "payload is unspecific here, analogously to how people is usually used...", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490038980", "createdAt": "2020-09-17T07:46:09Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -131,7 +134,7 @@ coap-client -u sensor1@DEFAULT_TENANT -k hono-secret -m POST coaps://hono.eclips\n ~~~\n \n {{% note %}}\n-In the example above the response actually contains payload that should be used as input to a command to be executed by the device.\n+In the example above the response actually contains a payload that should be used as input to a command to be executed by the device.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTA1Nw==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039057", "createdAt": "2020-09-17T07:46:18Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -171,16 +174,19 @@ send any commands to the device.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTE0MA==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039140", "createdAt": "2020-09-17T07:46:27Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -245,7 +251,7 @@ coap-client -m PUT coap://hono.eclipseprojects.io/telemetry/DEFAULT_TENANT/4711?\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTIwNQ==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039205", "createdAt": "2020-09-17T07:46:35Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -329,15 +338,14 @@ The device is authenticated using PSK.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTQwNQ==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039405", "createdAt": "2020-09-17T07:46:57Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -329,15 +338,14 @@ The device is authenticated using PSK.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.\n   * 4.03 (Forbidden): The request cannot be processed because the device's registration status cannot be asserted.\n     Possible reasons for this include:\n         * The given tenant is not allowed to use this protocol adapter.\n   * 4.04 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 4.13 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 4.29 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of telemetry data for the given tenant\n-    connected to Hono.\n+  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTU1Mw==", "bodyText": "unspecific", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039553", "createdAt": "2020-09-17T07:47:14Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -368,7 +376,7 @@ coap-client -u sensor1@DEFAULT_TENANT -k hono-secret -m POST coaps://hono.eclips\n ~~~\n \n {{% note %}}\n-In the example above the response actually contains payload that should be used as input to a command to be executed by the device.\n+In the example above the response actually contains a payload that should be used as input to a command to be executed by the device.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTYyMQ==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039621", "createdAt": "2020-09-17T07:47:23Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -406,16 +414,15 @@ send any commands to the device.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTczMw==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039733", "createdAt": "2020-09-17T07:47:34Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -406,16 +414,15 @@ send any commands to the device.\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.\n   * 4.03 (Forbidden): The request cannot be processed because the device's registration status cannot be asserted.\n     Possible reasons for this include:\n         * The given tenant is not allowed to use this protocol adapter.\n         * The given device does not belong to the given tenant.\n   * 4.04 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 4.13 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 4.29 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of telemetry data for the given tenant\n-    connected to Hono.\n+  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTc5MQ==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039791", "createdAt": "2020-09-17T07:47:41Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -472,7 +479,7 @@ coap-client -m PUT coap://hono.eclipseprojects.io/event/DEFAULT_TENANT/4711?hono\n     delivered to any potential consumer (yet). However, if the message type is `CON` (*at least once* semantics), then the adapter waits\n     for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n   * 4.00 (Bad Request): The request cannot be processed. Possible reasons include:\n-         * the request body is empty and the *URI-query* option doesn't contain the `empty` parameter\n+         * the request body is empty, and the *URI-query* option doesn't contain the `empty` parameter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAzOTg3NA==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490039874", "createdAt": "2020-09-17T07:47:49Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -482,8 +489,7 @@ coap-client -m PUT coap://hono.eclipseprojects.io/event/DEFAULT_TENANT/4711?hono\n   * 4.04 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 4.13 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 4.29 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of telemetry data for the given tenant\n-    connected to Hono.\n+  * 5.03 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 147}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA0MDAxOA==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490040018", "createdAt": "2020-09-17T07:48:03Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/http-adapter.md", "diffHunk": "@@ -306,7 +318,7 @@ content-length: 23\n   * 404 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 413 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 429 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono.\n+  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA0MDExNw==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490040117", "createdAt": "2020-09-17T07:48:12Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/http-adapter.md", "diffHunk": "@@ -350,7 +362,7 @@ content-length: 0\n   * 404 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 413 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 429 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono.\n+  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA0MDE5Nw==", "bodyText": "no comma", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r490040197", "createdAt": "2020-09-17T07:48:20Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/user-guide/http-adapter.md", "diffHunk": "@@ -399,7 +411,7 @@ content-length: 0\n   * 404 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n   * 413 (Request Entity Too Large): The request cannot be processed because the request body exceeds the maximum supported size.\n   * 429 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n-  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono.\n+  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of events for the given tenant connected to Hono, or the consumer didn't process the event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7"}, "originalPosition": 62}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/6d907b5a0687dc3fcb4b4608d69c0a11e56ca3e7", "committedDate": "2020-09-17T07:26:37Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "35184383e626aa3b817db80aca0c95def4460594", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/35184383e626aa3b817db80aca0c95def4460594", "committedDate": "2020-09-18T07:01:24Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35184383e626aa3b817db80aca0c95def4460594", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/35184383e626aa3b817db80aca0c95def4460594", "committedDate": "2020-09-18T07:01:24Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b", "committedDate": "2020-09-29T06:34:13Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTQ0NDU2", "url": "https://github.com/eclipse/hono/pull/2185#pullrequestreview-498144456", "createdAt": "2020-09-29T06:53:34Z", "commit": {"oid": "3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjo1MzozNFrOHZdXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjo1ODozMlrOHZdgpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ1NzUzNw==", "bodyText": "how about sorting these alphabetically?", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r496457537", "createdAt": "2020-09-29T06:53:34Z", "author": {"login": "sophokles73"}, "path": "client/src/main/resources/org/eclipse/hono/client/ServiceInvocationException_messages.properties", "diffHunk": "@@ -0,0 +1,17 @@\n+###############################################################################\n+# Copyright (c) 2020 Contributors to the Eclipse Foundation\n+#\n+# See the NOTICE file(s) distributed with this work for additional\n+# information regarding copyright ownership.\n+#\n+# This program and the accompanying materials are made available under the\n+# terms of the Eclipse Public License 2.0 which is available at\n+# http://www.eclipse.org/legal/epl-2.0\n+#\n+# SPDX-License-Identifier: EPL-2.0\n+###############################################################################\n+\n+# ServiceInvocationException messages\n+SERVER_ERROR_SEND_MESSAGE_TIMEOUT=consumer failed to indicate in time whether it has processed the message\n+SERVER_ERROR_MESSAGE_NOT_PROCESSED=consumer didn't process the message\n+SERVER_ERROR_NO_CONSUMER=no consumer available", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ1OTk0MA==", "bodyText": "the consumer did not process the message in this case as well", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r496459940", "createdAt": "2020-09-29T06:58:32Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/impl/AbstractSender.java", "diffHunk": "@@ -304,10 +307,15 @@ protected final Span startSpan(final Message message) {\n                                 : new ClientErrorException(HttpURLConnection.HTTP_BAD_REQUEST, rejected.getError().getDescription());\n                     } else if (Released.class.isInstance(remoteState)) {\n                         e = new ServerErrorException(HttpURLConnection.HTTP_UNAVAILABLE);\n+                        ((ServerErrorException) e).setClientFacingMessage(ServerErrorMessage.MESSAGE_NOT_PROCESSED);\n                     } else if (Modified.class.isInstance(remoteState)) {\n                         final Modified modified = (Modified) deliveryUpdated.getRemoteState();\n-                        e = modified.getUndeliverableHere() ? new ClientErrorException(HttpURLConnection.HTTP_NOT_FOUND)\n-                                : new ServerErrorException(HttpURLConnection.HTTP_UNAVAILABLE);\n+                        if (modified.getUndeliverableHere()) {\n+                            e = new ClientErrorException(HttpURLConnection.HTTP_NOT_FOUND);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b"}, "originalPosition": 36}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/3d02ff00b51af7d1e9e08e4d8e3516ca5bd9019b", "committedDate": "2020-09-29T06:34:13Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234", "committedDate": "2020-09-29T12:51:08Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NDc5NDI4", "url": "https://github.com/eclipse/hono/pull/2185#pullrequestreview-498479428", "createdAt": "2020-09-29T13:39:32Z", "commit": {"oid": "a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMzozOTozM1rOHZtq8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMzozOTozM1rOHZtq8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcyNDcyMA==", "bodyText": "wow, this looks terrible, doesn't it ;-)\nMaybe we can add a static String ServiceInvocationException.getLocalizedMessage(String) method which accepts a key instead?", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r496724720", "createdAt": "2020-09-29T13:39:33Z", "author": {"login": "sophokles73"}, "path": "tests/src/test/java/org/eclipse/hono/tests/http/TelemetryHttpIT.java", "diffHunk": "@@ -214,6 +221,10 @@ public void testUploadQos1MessageFailsIfDeliveryStateNotUpdated(final VertxTestC\n \n         httpResponseFuture\n                 .onComplete(ctx.succeeding(response -> {\n+                    ctx.verify(() -> {\n+                        assertThat(response.bodyAsString())\n+                                .isEqualTo(new SendMessageTimeoutException(\"\").getClientFacingMessage());\n+                    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234"}, "originalPosition": 30}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/a9a6ebfe1ce61c1445638fdbc7feb2a8f0118234", "committedDate": "2020-09-29T12:51:08Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "5b11db74260a05f84f8cdacafb8bece5ac116630", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/5b11db74260a05f84f8cdacafb8bece5ac116630", "committedDate": "2020-09-29T14:22:30Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MTEzNjQx", "url": "https://github.com/eclipse/hono/pull/2185#pullrequestreview-499113641", "createdAt": "2020-09-30T06:20:08Z", "commit": {"oid": "5b11db74260a05f84f8cdacafb8bece5ac116630"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNjoyMDowOFrOHaOwyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNjoyMDowOFrOHaOwyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI2Njg4OA==", "bodyText": "IMHO it would be helpful to explain that apart from the given message, the clientFacingMessage will be set to a certain key. This is also true for the other exception classes. WDYT?", "url": "https://github.com/eclipse/hono/pull/2185#discussion_r497266888", "createdAt": "2020-09-30T06:20:08Z", "author": {"login": "sophokles73"}, "path": "client/src/main/java/org/eclipse/hono/client/NoConsumerException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+\n+package org.eclipse.hono.client;\n+\n+import java.net.HttpURLConnection;\n+\n+/**\n+ * A {@link ServerErrorException} indicating that there is no consumer for the request message.\n+ */\n+public class NoConsumerException extends ServerErrorException {\n+\n+    /**\n+     * Resource key for the client facing error message.\n+     */\n+    public static final String CLIENT_FACING_MESSAGE_KEY = \"SERVER_ERROR_NO_CONSUMER\";\n+\n+    /**\n+     * Creates a new NoConsumerException.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b11db74260a05f84f8cdacafb8bece5ac116630"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d7b8c9d8bb722d10a23f18854efec5311cebbed", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/6d7b8c9d8bb722d10a23f18854efec5311cebbed", "committedDate": "2020-09-30T10:07:42Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b11db74260a05f84f8cdacafb8bece5ac116630", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/5b11db74260a05f84f8cdacafb8bece5ac116630", "committedDate": "2020-09-29T14:22:30Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "6d7b8c9d8bb722d10a23f18854efec5311cebbed", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/6d7b8c9d8bb722d10a23f18854efec5311cebbed", "committedDate": "2020-09-30T10:07:42Z", "message": "[#2166] Improve 503 error messages in HTTP adapter.\n\nAlso improve the corresponding documentation for the\nHTTP adapter and CoAP adapter.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MzM4NTU2", "url": "https://github.com/eclipse/hono/pull/2185#pullrequestreview-499338556", "createdAt": "2020-09-30T11:38:28Z", "commit": {"oid": "6d7b8c9d8bb722d10a23f18854efec5311cebbed"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 572, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}