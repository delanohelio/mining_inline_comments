{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwODIzNDM4", "number": 1889, "title": "Add more values to coap-adapter configuration.", "bodyText": "dtls threads: improve handshake processing\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\nSigned-off-by: Achim Kraus achim.kraus@bosch.io", "createdAt": "2020-04-08T12:38:58Z", "url": "https://github.com/eclipse/hono/pull/1889", "merged": true, "mergeCommit": {"oid": "135f8203309dac6c79397fab8183975e80834647"}, "closed": true, "closedAt": "2020-04-09T12:01:35Z", "author": {"login": "boaks"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVnc3TgFqTM4OTk0NTMyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV6GzagFqTM5MDY4MTU5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTQ1MzIz", "url": "https://github.com/eclipse/hono/pull/1889#pullrequestreview-389945323", "createdAt": "2020-04-08T12:54:48Z", "commit": {"oid": "d00bb8c56f6e6e30b490a370739165f22697f6d8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1NDo0OFrOGCt2pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1NTo1MlrOGCt5Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwMTYwNw==", "bodyText": "There is no need for the @value tag here as this is already the place where it is defined.\nUsing the @value tag makes sense in JavaDoc comments of other methods where you would like to refer to the value of the constant instead of the definition (as you already do below) ...", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405501607", "createdAt": "2020-04-08T12:54:48Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -23,16 +23,52 @@\n public class CoapAdapterProperties extends ProtocolAdapterProperties {\n \n     /**\n-     * The default regular expression to split the identity into authority and tenant.\n+     * The default regular expression to split the identity into authority and tenant. Value", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d00bb8c56f6e6e30b490a370739165f22697f6d8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwMjIzNA==", "bodyText": "are these values supposed to be per processor core?", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405502234", "createdAt": "2020-04-08T12:55:52Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -23,16 +23,52 @@\n public class CoapAdapterProperties extends ProtocolAdapterProperties {\n \n     /**\n-     * The default regular expression to split the identity into authority and tenant.\n+     * The default regular expression to split the identity into authority and tenant. Value\n+     * {@value #DEFAULT_ID_SPLIT_REGEX}.\n      */\n     public static final String DEFAULT_ID_SPLIT_REGEX = \"@\";\n+    /**\n+     * The default number of threads for the connector. Value {@value #DEFAULT_CONNECTOR_THREADS}.\n+     */\n+    public static final int DEFAULT_CONNECTOR_THREADS = 2;\n+    /**\n+     * The default number of threads for the coap protocol stack. Value {@value #DEFAULT_COAP_THREADS}.\n+     */\n+    public static final int DEFAULT_COAP_THREADS = 16;\n+    /**\n+     * The default number of threads for the dtls connector. Value {@value #DEFAULT_DTLS_THREADS}.\n+     */\n+    public static final int DEFAULT_DTLS_THREADS = 32;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d00bb8c56f6e6e30b490a370739165f22697f6d8"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d00bb8c56f6e6e30b490a370739165f22697f6d8", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/d00bb8c56f6e6e30b490a370739165f22697f6d8", "committedDate": "2020-04-08T12:37:34Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/52824c9bbadd7714c700d66e635f10991960da4a", "committedDate": "2020-04-08T14:10:48Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTM3Mjgx", "url": "https://github.com/eclipse/hono/pull/1889#pullrequestreview-390137281", "createdAt": "2020-04-08T16:28:12Z", "commit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjoyODoxM1rOGC3L2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjoyOToxMFrOGC3OTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1NDQ4OA==", "bodyText": "is milliseconds the right unit here? My understanding is that the lifetime is defined in seconds rather than millis ...", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405654488", "createdAt": "2020-04-08T16:28:13Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/admin-guide/coap-adapter-config.md", "diffHunk": "@@ -28,8 +28,11 @@ The following table provides an overview of the configuration variables and corr\n | `HONO_COAP_BIND_ADDRESS`<br>`--hono.coap.bindAddress` | no | `127.0.0.1` | The IP address of the network interface that the secure port should be bound to.<br>See [Port Configuration]({{< relref \"#port-configuration\" >}}) below for details. |\n | `HONO_COAP_CERT_PATH`<br>`--hono.coap.certPath` | no | - | The absolute path to the PEM file containing the certificate that the protocol adapter should use for authenticating to clients. This option must be used in conjunction with `HONO_COAP_KEY_PATH`.<br>Alternatively, the `HONO_COAP_KEY_STORE_PATH` option can be used to configure a key store containing both the key as well as the certificate. |\n | `HONO_COAP_COAP_THREADS`<br>`--hono.coap.coapThreads` | no | 2 | The number of threads to use for processing CoAP message exchanges at the protocol layer. |\n-| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 1 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 2 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_DTLS_THREADS`<br>`--hono.coap.dtlsThreads` | no | 32 | The number of threads to use for processing DTLS message exchanges at the connection layer. |\n+| `HONO_COAP_DTLS_RETRANSMISSION_TIMEOUT`<br>`--hono.coap.dtlsRetransmissionTimeout` | no | 2000 | The timeout in milliseconds for DTLS retransmissionsnumber. |\n | `HONO_COAP_DEFAULTS_ENABLED`<br>`--hono.coap.defaultsEnabled` | no | `true` | If set to `true` the protocol adapter uses *default values* registered for a device to augment messages published by the device with missing information like a content type. In particular, the protocol adapter adds default values registered for the device as (application) properties with the same name to the AMQP 1.0 messages it sends downstream to the AMQP Messaging Network. |\n+| `HONO_COAP_EXCHANGE_LIFETIME`<br>`--hono.coap.exchangeLifetime` | no | 247000 | The exchange lifetime in milliseconds. According RFC 7252, that value is 247s. Such a large time requires also a huge amount of heap. That time includes a processing time of 100s and retransmissions of CON messages. Therefore a practical value could be much smaller.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1NDY0OA==", "bodyText": "retransmissionsnumber ?", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405654648", "createdAt": "2020-04-08T16:28:26Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/admin-guide/coap-adapter-config.md", "diffHunk": "@@ -28,8 +28,11 @@ The following table provides an overview of the configuration variables and corr\n | `HONO_COAP_BIND_ADDRESS`<br>`--hono.coap.bindAddress` | no | `127.0.0.1` | The IP address of the network interface that the secure port should be bound to.<br>See [Port Configuration]({{< relref \"#port-configuration\" >}}) below for details. |\n | `HONO_COAP_CERT_PATH`<br>`--hono.coap.certPath` | no | - | The absolute path to the PEM file containing the certificate that the protocol adapter should use for authenticating to clients. This option must be used in conjunction with `HONO_COAP_KEY_PATH`.<br>Alternatively, the `HONO_COAP_KEY_STORE_PATH` option can be used to configure a key store containing both the key as well as the certificate. |\n | `HONO_COAP_COAP_THREADS`<br>`--hono.coap.coapThreads` | no | 2 | The number of threads to use for processing CoAP message exchanges at the protocol layer. |\n-| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 1 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 2 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_DTLS_THREADS`<br>`--hono.coap.dtlsThreads` | no | 32 | The number of threads to use for processing DTLS message exchanges at the connection layer. |\n+| `HONO_COAP_DTLS_RETRANSMISSION_TIMEOUT`<br>`--hono.coap.dtlsRetransmissionTimeout` | no | 2000 | The timeout in milliseconds for DTLS retransmissionsnumber. |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1NTExNw==", "bodyText": "serialized messages from the CoAP stack's deduplicator", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405655117", "createdAt": "2020-04-08T16:29:10Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/admin-guide/coap-adapter-config.md", "diffHunk": "@@ -39,6 +42,7 @@ The following table provides an overview of the configuration variables and corr\n | `HONO_COAP_KEY_STORE_PATH`<br>`--hono.coap.keyStorePath` | no | - | The absolute path to the Java key store containing the private key and certificate that the protocol adapter should use for authenticating to clients. Either this option or the `HONO_COAP_KEY_PATH` and `HONO_COAP_CERT_PATH` options need to be set in order to enable TLS secured connections with clients. The key store format can be either `JKS` or `PKCS12` indicated by a `.jks` or `.p12` file suffix respectively. |\n | `HONO_COAP_MAX_CONNECTIONS`<br>`--hono.coap.maxConnections` | no | `0` | The maximum number of concurrent DTLS connections that the protocol adapter should accept. If set to `0`, the protocol adapter determines a reasonable value based on the available resources like memory and CPU. |\n | `HONO_COAP_MAX_PAYLOAD_SIZE`<br>`--hono.coap.maxPayloadSize` | no | `2048` | The maximum allowed size of an incoming CoAP request's body in bytes. Requests with a larger body size are rejected with a 4.13 `Request entity too large` response. |\n+| `HONO_COAP_MESSAGE_OFFLOADING`<br>`--hono.coap.messageOffloading` | no | true | Enables to clear payload and serilaized messages in order to reduce the heap consumpion. Experimental. |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/52824c9bbadd7714c700d66e635f10991960da4a", "committedDate": "2020-04-08T14:10:48Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18", "committedDate": "2020-04-09T06:36:36Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNTQxMTY1", "url": "https://github.com/eclipse/hono/pull/1889#pullrequestreview-390541165", "createdAt": "2020-04-09T07:11:13Z", "commit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzoxMToxNFrOGDMQ4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNzoxMzoxMlrOGDMUzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5OTg0MA==", "bodyText": "this can be removed as well", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r405999840", "createdAt": "2020-04-09T07:11:14Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -26,13 +26,47 @@\n      * The default regular expression to split the identity into authority and tenant.\n      */\n     public static final String DEFAULT_ID_SPLIT_REGEX = \"@\";\n+    /**\n+     * The default number of threads for the connector.\n+     */\n+    public static final int DEFAULT_CONNECTOR_THREADS = 2;\n+    /**\n+     * The default number of threads for the coap protocol stack.\n+     */\n+    public static final int DEFAULT_COAP_THREADS = 2;\n+    /**\n+     * The default number of threads for the dtls connector.\n+     */\n+    public static final int DEFAULT_DTLS_THREADS = 32;\n+    /**\n+     * The default timeout in milliseconds for DTLS retransmissions.\n+     */\n+    public static final int DEFAULT_DTLS_RETRANSMISSION_TIMEOUT = 2000;\n+    /**\n+     * The default exchange lifetime in milliseconds.\n+     * \n+     * According <a href= \"https://tools.ietf.org/html/rfc7252#page-30\"> RFC 7252 - 4.8. Transmission Parameters</a> the\n+     * default value is 247 seconds. Such a large time requires also a huge amount of heap. That time includes a\n+     * processing time of 100s and retransmissions of CON messages. Therefore a practical value could be much smaller.\n+     */\n+    public static final int DEFAULT_EXCHANGE_LIFETIME = 247000;\n+    /**\n+     * The default for message offloading. When messages are kept for deduplication, some parts of the messages are not\n+     * longer required and could be release earlier. That helps to reduce the heap consumption. Value\n+     * {@value #DEFAULT_MESSAGE_OFFLOADING}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAwMDMxMw==", "bodyText": "please rename this to messageOffloadingEnabled", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r406000313", "createdAt": "2020-04-09T07:12:05Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -26,13 +26,47 @@\n      * The default regular expression to split the identity into authority and tenant.\n      */\n     public static final String DEFAULT_ID_SPLIT_REGEX = \"@\";\n+    /**\n+     * The default number of threads for the connector.\n+     */\n+    public static final int DEFAULT_CONNECTOR_THREADS = 2;\n+    /**\n+     * The default number of threads for the coap protocol stack.\n+     */\n+    public static final int DEFAULT_COAP_THREADS = 2;\n+    /**\n+     * The default number of threads for the dtls connector.\n+     */\n+    public static final int DEFAULT_DTLS_THREADS = 32;\n+    /**\n+     * The default timeout in milliseconds for DTLS retransmissions.\n+     */\n+    public static final int DEFAULT_DTLS_RETRANSMISSION_TIMEOUT = 2000;\n+    /**\n+     * The default exchange lifetime in milliseconds.\n+     * \n+     * According <a href= \"https://tools.ietf.org/html/rfc7252#page-30\"> RFC 7252 - 4.8. Transmission Parameters</a> the\n+     * default value is 247 seconds. Such a large time requires also a huge amount of heap. That time includes a\n+     * processing time of 100s and retransmissions of CON messages. Therefore a practical value could be much smaller.\n+     */\n+    public static final int DEFAULT_EXCHANGE_LIFETIME = 247000;\n+    /**\n+     * The default for message offloading. When messages are kept for deduplication, some parts of the messages are not\n+     * longer required and could be release earlier. That helps to reduce the heap consumption. Value\n+     * {@value #DEFAULT_MESSAGE_OFFLOADING}.\n+     */\n+    public static final boolean DEFAULT_MESSAGE_OFFLOADING = true;\n \n     private String idSplitRegex = DEFAULT_ID_SPLIT_REGEX;\n     private String networkConfig = null;\n     private String secureNetworkConfig = null;\n     private String insecureNetworkConfig = null;\n-    private int connectorThreads = 1;\n-    private int coapThreads = 2;\n+    private int connectorThreads = DEFAULT_CONNECTOR_THREADS;\n+    private int coapThreads = DEFAULT_COAP_THREADS;\n+    private int dtlsThreads = DEFAULT_DTLS_THREADS;\n+    private int dtlsRetransmissionTimeout = DEFAULT_DTLS_RETRANSMISSION_TIMEOUT;\n+    private int exchangeLifetime = DEFAULT_EXCHANGE_LIFETIME;\n+    private boolean messageOffloading = DEFAULT_MESSAGE_OFFLOADING;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAwMDUwOA==", "bodyText": "please rename to isMessageOffloadingEnabled", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r406000508", "createdAt": "2020-04-09T07:12:30Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -201,4 +235,122 @@ public final void setCoapThreads(final int threads) {\n         this.coapThreads = threads;\n     }\n \n+    /**\n+     * Gets the number of threads used for processing DTLS message exchanges at the\n+     * connection layer.\n+     * <p>\n+     * The default value of this property is {@value #DEFAULT_DTLS_THREADS}.\n+     * \n+     * @return The number of threads.\n+     */\n+    public final int getDtlsThreads() {\n+        return dtlsThreads;\n+    }\n+\n+    /**\n+     * Sets the number of threads to be used for processing DTLS message exchanges at the\n+     * connection layer.\n+     * <p>\n+     * The default value of this property is {@value #DEFAULT_DTLS_THREADS}.\n+     * \n+     * @param threads The number of threads.\n+     * @throws IllegalArgumentException if threads is &lt; 1.\n+     */\n+    public final void setDtlsThreads(final int threads) {\n+        if (threads < 1) {\n+            throw new IllegalArgumentException(\"dtls thread count must be at least 1\");\n+        }\n+        this.dtlsThreads = threads;\n+    }\n+\n+    /**\n+     * Gets the DTLS retransmission timeout.\n+     * <p>\n+     * Timeout to wait before retransmit a flight, if no response is received.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT},\n+     * {@value #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT} milliseconds.\n+     * \n+     * @return The timeout in milliseconds.\n+     */\n+    public final int getDtlsRetransmissionTimeout() {\n+        return dtlsRetransmissionTimeout;\n+    }\n+\n+    /**\n+     * Sets the DTLS retransmission timeout.\n+     * <p>\n+     * Timeout to wait before retransmit a flight, if no response is received.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT},\n+     * {@value #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT} milliseconds.\n+     * \n+     * @param dtlsRetransmissionTimeout timeout in milliseconds to retransmit a flight.\n+     * @throws IllegalArgumentException if dtlsRetransmissionTimeout is &lt; 1.\n+     */\n+    public final void setDtlsRetransmissionTimeout(final int dtlsRetransmissionTimeout) {\n+        if (dtlsRetransmissionTimeout < 1) {\n+            throw new IllegalArgumentException(\"dtls retransmission timeout must be at least 1\");\n+        }\n+        this.dtlsRetransmissionTimeout = dtlsRetransmissionTimeout;\n+    }\n+\n+    /**\n+     * Gets the exchange lifetime.\n+     * <p>\n+     * Time to keep coap request for deduplication.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_EXCHANGE_LIFETIME}, {@value #DEFAULT_EXCHANGE_LIFETIME}\n+     * milliseconds.\n+     * \n+     * @return The exchange lifetime in milliseconds.\n+     */\n+    public final int getExchangeLifetime() {\n+        return exchangeLifetime;\n+    }\n+\n+    /**\n+     * Gets the exchange lifetime.\n+     * <p>\n+     * Time to keep coap request for deduplication.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_EXCHANGE_LIFETIME}, {@value #DEFAULT_EXCHANGE_LIFETIME}\n+     * milliseconds.\n+     * \n+     * @param exchangeLifetime the exchange lifetime in milliseconds to keep the request for deduplication.\n+     * @throws IllegalArgumentException if exchangeLifetime is &lt; 1.\n+     */\n+    public final void setExchangeLifetime(final int exchangeLifetime) {\n+        if (exchangeLifetime < 1) {\n+            throw new IllegalArgumentException(\"exchange lifetime must be at least -1\");\n+        }\n+        this.exchangeLifetime = exchangeLifetime;\n+    }\n+\n+    /**\n+     * Gets the message offloading mode.\n+     * <p>\n+     * When messages are kept for deduplication, parts of the message could be offloaded to reduce the heap consumption.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_MESSAGE_OFFLOADING}, {@value #DEFAULT_MESSAGE_OFFLOADING}.\n+     * \n+     * @return {@code true} enable message offloading, {@code false} disable message offloading.\n+     */\n+    public final boolean getMessageOffloading() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18"}, "originalPosition": 191}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAwMDcxMQ==", "bodyText": "please rename to setMessageOffloadingEnabled", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r406000711", "createdAt": "2020-04-09T07:12:53Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/CoapAdapterProperties.java", "diffHunk": "@@ -201,4 +235,122 @@ public final void setCoapThreads(final int threads) {\n         this.coapThreads = threads;\n     }\n \n+    /**\n+     * Gets the number of threads used for processing DTLS message exchanges at the\n+     * connection layer.\n+     * <p>\n+     * The default value of this property is {@value #DEFAULT_DTLS_THREADS}.\n+     * \n+     * @return The number of threads.\n+     */\n+    public final int getDtlsThreads() {\n+        return dtlsThreads;\n+    }\n+\n+    /**\n+     * Sets the number of threads to be used for processing DTLS message exchanges at the\n+     * connection layer.\n+     * <p>\n+     * The default value of this property is {@value #DEFAULT_DTLS_THREADS}.\n+     * \n+     * @param threads The number of threads.\n+     * @throws IllegalArgumentException if threads is &lt; 1.\n+     */\n+    public final void setDtlsThreads(final int threads) {\n+        if (threads < 1) {\n+            throw new IllegalArgumentException(\"dtls thread count must be at least 1\");\n+        }\n+        this.dtlsThreads = threads;\n+    }\n+\n+    /**\n+     * Gets the DTLS retransmission timeout.\n+     * <p>\n+     * Timeout to wait before retransmit a flight, if no response is received.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT},\n+     * {@value #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT} milliseconds.\n+     * \n+     * @return The timeout in milliseconds.\n+     */\n+    public final int getDtlsRetransmissionTimeout() {\n+        return dtlsRetransmissionTimeout;\n+    }\n+\n+    /**\n+     * Sets the DTLS retransmission timeout.\n+     * <p>\n+     * Timeout to wait before retransmit a flight, if no response is received.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT},\n+     * {@value #DEFAULT_DTLS_RETRANSMISSION_TIMEOUT} milliseconds.\n+     * \n+     * @param dtlsRetransmissionTimeout timeout in milliseconds to retransmit a flight.\n+     * @throws IllegalArgumentException if dtlsRetransmissionTimeout is &lt; 1.\n+     */\n+    public final void setDtlsRetransmissionTimeout(final int dtlsRetransmissionTimeout) {\n+        if (dtlsRetransmissionTimeout < 1) {\n+            throw new IllegalArgumentException(\"dtls retransmission timeout must be at least 1\");\n+        }\n+        this.dtlsRetransmissionTimeout = dtlsRetransmissionTimeout;\n+    }\n+\n+    /**\n+     * Gets the exchange lifetime.\n+     * <p>\n+     * Time to keep coap request for deduplication.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_EXCHANGE_LIFETIME}, {@value #DEFAULT_EXCHANGE_LIFETIME}\n+     * milliseconds.\n+     * \n+     * @return The exchange lifetime in milliseconds.\n+     */\n+    public final int getExchangeLifetime() {\n+        return exchangeLifetime;\n+    }\n+\n+    /**\n+     * Gets the exchange lifetime.\n+     * <p>\n+     * Time to keep coap request for deduplication.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_EXCHANGE_LIFETIME}, {@value #DEFAULT_EXCHANGE_LIFETIME}\n+     * milliseconds.\n+     * \n+     * @param exchangeLifetime the exchange lifetime in milliseconds to keep the request for deduplication.\n+     * @throws IllegalArgumentException if exchangeLifetime is &lt; 1.\n+     */\n+    public final void setExchangeLifetime(final int exchangeLifetime) {\n+        if (exchangeLifetime < 1) {\n+            throw new IllegalArgumentException(\"exchange lifetime must be at least -1\");\n+        }\n+        this.exchangeLifetime = exchangeLifetime;\n+    }\n+\n+    /**\n+     * Gets the message offloading mode.\n+     * <p>\n+     * When messages are kept for deduplication, parts of the message could be offloaded to reduce the heap consumption.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_MESSAGE_OFFLOADING}, {@value #DEFAULT_MESSAGE_OFFLOADING}.\n+     * \n+     * @return {@code true} enable message offloading, {@code false} disable message offloading.\n+     */\n+    public final boolean getMessageOffloading() {\n+        return messageOffloading;\n+    }\n+\n+    /**\n+     * Sets the message offloading mode.\n+     * <p>\n+     * When messages are kept for deduplication, parts of the message could be offloaded to reduce the heap consumption.\n+     * <p>\n+     * The default value of this property is {@link #DEFAULT_MESSAGE_OFFLOADING}, {@value #DEFAULT_MESSAGE_OFFLOADING}.\n+     * \n+     * @param messageOffloading {@code true} enable message offloading, {@code false} disable message offloading.\n+     */\n+    public final void setMessageOffloading(final boolean messageOffloading) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18"}, "originalPosition": 204}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAwMDg0NA==", "bodyText": "Then let's stick to millis for the time being", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r406000844", "createdAt": "2020-04-09T07:13:12Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/admin-guide/coap-adapter-config.md", "diffHunk": "@@ -28,8 +28,11 @@ The following table provides an overview of the configuration variables and corr\n | `HONO_COAP_BIND_ADDRESS`<br>`--hono.coap.bindAddress` | no | `127.0.0.1` | The IP address of the network interface that the secure port should be bound to.<br>See [Port Configuration]({{< relref \"#port-configuration\" >}}) below for details. |\n | `HONO_COAP_CERT_PATH`<br>`--hono.coap.certPath` | no | - | The absolute path to the PEM file containing the certificate that the protocol adapter should use for authenticating to clients. This option must be used in conjunction with `HONO_COAP_KEY_PATH`.<br>Alternatively, the `HONO_COAP_KEY_STORE_PATH` option can be used to configure a key store containing both the key as well as the certificate. |\n | `HONO_COAP_COAP_THREADS`<br>`--hono.coap.coapThreads` | no | 2 | The number of threads to use for processing CoAP message exchanges at the protocol layer. |\n-| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 1 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_CONNECTOR_THREADS`<br>`--hono.coap.connectorThreads` | no | 2 | The number of threads to use for receiving/sending UDP packets. The connector will start the given number of threads for each direction, outbound (sending) as well as inbound (receiving). |\n+| `HONO_COAP_DTLS_THREADS`<br>`--hono.coap.dtlsThreads` | no | 32 | The number of threads to use for processing DTLS message exchanges at the connection layer. |\n+| `HONO_COAP_DTLS_RETRANSMISSION_TIMEOUT`<br>`--hono.coap.dtlsRetransmissionTimeout` | no | 2000 | The timeout in milliseconds for DTLS retransmissionsnumber. |\n | `HONO_COAP_DEFAULTS_ENABLED`<br>`--hono.coap.defaultsEnabled` | no | `true` | If set to `true` the protocol adapter uses *default values* registered for a device to augment messages published by the device with missing information like a content type. In particular, the protocol adapter adds default values registered for the device as (application) properties with the same name to the AMQP 1.0 messages it sends downstream to the AMQP Messaging Network. |\n+| `HONO_COAP_EXCHANGE_LIFETIME`<br>`--hono.coap.exchangeLifetime` | no | 247000 | The exchange lifetime in milliseconds. According RFC 7252, that value is 247s. Such a large time requires also a huge amount of heap. That time includes a processing time of 100s and retransmissions of CON messages. Therefore a practical value could be much smaller.|", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1NDQ4OA=="}, "originalCommit": {"oid": "52824c9bbadd7714c700d66e635f10991960da4a"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/cdaaf79e1fefed071b7b5682ab0d4d20a92e9d18", "committedDate": "2020-04-09T06:36:36Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "1ac40fb72c5a179504246ca13f9fdeb65cadea8e", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/1ac40fb72c5a179504246ca13f9fdeb65cadea8e", "committedDate": "2020-04-09T07:35:44Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNjQ1Nzkw", "url": "https://github.com/eclipse/hono/pull/1889#pullrequestreview-390645790", "createdAt": "2020-04-09T09:46:21Z", "commit": {"oid": "1ac40fb72c5a179504246ca13f9fdeb65cadea8e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwOTo0NjoyMlrOGDRh6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwOTo0NjoyMlrOGDRh6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA4NjEyMA==", "bodyText": "HONO_COAP_MESSAGE_OFFLOADING_ENABLED", "url": "https://github.com/eclipse/hono/pull/1889#discussion_r406086120", "createdAt": "2020-04-09T09:46:22Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/admin-guide/coap-adapter-config.md", "diffHunk": "@@ -39,6 +42,7 @@ The following table provides an overview of the configuration variables and corr\n | `HONO_COAP_KEY_STORE_PATH`<br>`--hono.coap.keyStorePath` | no | - | The absolute path to the Java key store containing the private key and certificate that the protocol adapter should use for authenticating to clients. Either this option or the `HONO_COAP_KEY_PATH` and `HONO_COAP_CERT_PATH` options need to be set in order to enable TLS secured connections with clients. The key store format can be either `JKS` or `PKCS12` indicated by a `.jks` or `.p12` file suffix respectively. |\n | `HONO_COAP_MAX_CONNECTIONS`<br>`--hono.coap.maxConnections` | no | `0` | The maximum number of concurrent DTLS connections that the protocol adapter should accept. If set to `0`, the protocol adapter determines a reasonable value based on the available resources like memory and CPU. |\n | `HONO_COAP_MAX_PAYLOAD_SIZE`<br>`--hono.coap.maxPayloadSize` | no | `2048` | The maximum allowed size of an incoming CoAP request's body in bytes. Requests with a larger body size are rejected with a 4.13 `Request entity too large` response. |\n+| `HONO_COAP_MESSAGE_OFFLOADING`<br>`--hono.coap.messageOffloading` | no | true | Enables to clear payload and serilaized messages kept for deduplication in order to reduce the heap consumpion. Experimental. |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac40fb72c5a179504246ca13f9fdeb65cadea8e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bea25d7fb644d9de884feb97e4379f3ad8f0d4d1", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/bea25d7fb644d9de884feb97e4379f3ad8f0d4d1", "committedDate": "2020-04-09T09:51:33Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ac40fb72c5a179504246ca13f9fdeb65cadea8e", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/1ac40fb72c5a179504246ca13f9fdeb65cadea8e", "committedDate": "2020-04-09T07:35:44Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "bea25d7fb644d9de884feb97e4379f3ad8f0d4d1", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/bea25d7fb644d9de884feb97e4379f3ad8f0d4d1", "committedDate": "2020-04-09T09:51:33Z", "message": "Add more values to coap-adapter configuration.\n\ndtls threads: improve handshake processing\ndtls retransmission timeout: support constraint embedded devices.\nexchange lifetime: reduce heap consumption\nmessage offloading: reduce heap consumption\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNjgxNTky", "url": "https://github.com/eclipse/hono/pull/1889#pullrequestreview-390681592", "createdAt": "2020-04-09T10:40:25Z", "commit": {"oid": "bea25d7fb644d9de884feb97e4379f3ad8f0d4d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 860, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}