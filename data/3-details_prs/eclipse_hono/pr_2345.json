{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMzA2ODUw", "number": 2345, "title": "[#2133] Improve message mapping API", "bodyText": "Signed-off-by: Alfusainey Jallow alf.jallow@gmail.com\n@BobClaerhout @sophokles73 sorry, this took quiet sometime :-) This patch addresses the cases discussed in #2133\n\nNo mapping service is configured for the gateway.\n\nThe default mapper now returns a null result in this case. The MQTT adapter checks for the presence of a null value and forwards the original message without any mapping\n\nMapping service is configured for the gateway but invocation of the service results in an error status code.\n\nWe distinguish between success codes (2XX) and error codes (4XX, 5XX). The 200 status code results in a mapped message with the mapped payload and target address while status codes > 200 results in a mapped message with the original payload  and target address", "createdAt": "2020-12-07T00:54:25Z", "url": "https://github.com/eclipse/hono/pull/2345", "merged": true, "mergeCommit": {"oid": "c069bc740e3f9ab93765b3981d35332033f223e3"}, "closed": true, "closedAt": "2020-12-15T07:27:22Z", "author": {"login": "Alfusainey"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkvvgOAFqTU0ODk4OTAwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmVKaMAFqTU1MjE2NjgzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTg5MDAx", "url": "https://github.com/eclipse/hono/pull/2345#pullrequestreview-548989001", "createdAt": "2020-12-10T09:14:49Z", "commit": {"oid": "750a0ea5dde9fe902e2852b151cba892438c7883"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwOToxNDo0OVrOIC-8ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwOToxNDo0OVrOIC-8ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5OTM3MA==", "bodyText": "why do we need to introduce this additional case that the client needs to check for? Can't we simply do the same as for a 2xx != 200 status code, i.e. completing the future with a mapped message containing the original device payload and target address? That way the client wouldn't need to handle a null result specifically, would it?", "url": "https://github.com/eclipse/hono/pull/2345#discussion_r539999370", "createdAt": "2020-12-10T09:14:49Z", "author": {"login": "sophokles73"}, "path": "adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java", "diffHunk": "@@ -31,15 +31,23 @@\n \n     /**\n      * Maps a message uploaded by a device.\n+     * <p>\n+     * If a mapping service is not configured for a gateway or a protocol adapter, this method returns\n+     * a successful future containing a {@code null} value. If a mapping service is configured for a gateway", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750a0ea5dde9fe902e2852b151cba892438c7883"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d60c71cd1809466170f74a931d4f4abfc12efd18", "author": {"user": {"login": "Alfusainey", "name": "Alfusainey Jallow"}}, "url": "https://github.com/eclipse/hono/commit/d60c71cd1809466170f74a931d4f4abfc12efd18", "committedDate": "2020-12-15T00:11:55Z", "message": "[#2133] Improve message mapping API\n\nSigned-off-by: Alfusainey Jallow <alf.jallow@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "750a0ea5dde9fe902e2852b151cba892438c7883", "author": {"user": {"login": "Alfusainey", "name": "Alfusainey Jallow"}}, "url": "https://github.com/eclipse/hono/commit/750a0ea5dde9fe902e2852b151cba892438c7883", "committedDate": "2020-12-07T00:45:15Z", "message": "[#2133] Improve message mapping API\n\nSigned-off-by: Alfusainey Jallow <alf.jallow@gmail.com>"}, "afterCommit": {"oid": "d60c71cd1809466170f74a931d4f4abfc12efd18", "author": {"user": {"login": "Alfusainey", "name": "Alfusainey Jallow"}}, "url": "https://github.com/eclipse/hono/commit/d60c71cd1809466170f74a931d4f4abfc12efd18", "committedDate": "2020-12-15T00:11:55Z", "message": "[#2133] Improve message mapping API\n\nSigned-off-by: Alfusainey Jallow <alf.jallow@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTY2ODM3", "url": "https://github.com/eclipse/hono/pull/2345#pullrequestreview-552166837", "createdAt": "2020-12-15T07:25:44Z", "commit": {"oid": "d60c71cd1809466170f74a931d4f4abfc12efd18"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 474, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}