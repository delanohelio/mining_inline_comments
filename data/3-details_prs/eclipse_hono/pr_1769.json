{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0MzU4MjUz", "number": 1769, "title": "[#1736] Make the body optional in tenant creation request", "bodyText": "Signed-off-by: Jean-Baptiste Trystram jbtrystram@redhat.com", "createdAt": "2020-02-12T15:03:48Z", "url": "https://github.com/eclipse/hono/pull/1769", "merged": true, "mergeCommit": {"oid": "dc312233c986d11a37115e1ed3f2489fad8c6350"}, "closed": true, "closedAt": "2020-02-20T10:41:45Z", "author": {"login": "jbtrystram"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcD3W5zgFqTM1ODA1ODE0MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGIRzjgFqTM2MTc3NTY2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MDU4MTQw", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-358058140", "createdAt": "2020-02-13T09:17:39Z", "commit": {"oid": "81f5097431852f2b41fcb0d1d2815c97daf3d0e2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81f5097431852f2b41fcb0d1d2815c97daf3d0e2", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/81f5097431852f2b41fcb0d1d2815c97daf3d0e2", "committedDate": "2020-02-12T14:58:06Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7", "committedDate": "2020-02-13T10:40:46Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MTUyNzQx", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-358152741", "createdAt": "2020-02-13T11:44:43Z", "commit": {"oid": "e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMTo0NDo0M1rOFpQyYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMTo0NDo0M1rOFpQyYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODgxMDk3OA==", "bodyText": "I think this should be false for the case where tenant id is supplied as well", "url": "https://github.com/eclipse/hono/pull/1769#discussion_r378810978", "createdAt": "2020-02-13T11:44:43Z", "author": {"login": "dejanb"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -86,7 +86,7 @@ paths:\n                application/json:\n                   schema:\n                      $ref: '#/components/schemas/Tenant'\n-            required: true\n+            required: false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/e26c4d9c7c1424f18d3d56eb1919f6390fafe9d7", "committedDate": "2020-02-13T10:40:46Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "3dc7ad1f2db8655e142bd59c770815620644bdf7", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/3dc7ad1f2db8655e142bd59c770815620644bdf7", "committedDate": "2020-02-14T12:46:05Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3dc7ad1f2db8655e142bd59c770815620644bdf7", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/3dc7ad1f2db8655e142bd59c770815620644bdf7", "committedDate": "2020-02-14T12:46:05Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "c5726b62cd34a5629069ebebd7faf66018e27688", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/c5726b62cd34a5629069ebebd7faf66018e27688", "committedDate": "2020-02-14T12:57:54Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4OTk2MzAw", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-358996300", "createdAt": "2020-02-14T14:54:54Z", "commit": {"oid": "c5726b62cd34a5629069ebebd7faf66018e27688"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxNDo1NDo1NFrOFp5Mxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxNDo1ODoxNVrOFp5UHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ3MzA5NA==", "bodyText": "is there a particular reason why you want to remove this?", "url": "https://github.com/eclipse/hono/pull/1769#discussion_r379473094", "createdAt": "2020-02-14T14:54:54Z", "author": {"login": "sophokles73"}, "path": "service-base/src/main/java/org/eclipse/hono/service/management/tenant/AbstractTenantManagementHttpEndpoint.java", "diffHunk": "@@ -310,11 +310,6 @@ protected final boolean isValidRequestPayload(final JsonObject payload) {\n      *       or the JsonArray contains elements that are not of type {@link JsonObject}.\n      */\n     protected final void addNotPresentFieldsWithDefaultValuesForTenant(final JsonObject checkedPayload) {\n-        if (!checkedPayload.containsKey(RegistryManagementConstants.FIELD_ENABLED)) {\n-            logger.trace(\"adding 'enabled' key to payload\");\n-            checkedPayload.put(RegistryManagementConstants.FIELD_ENABLED, Boolean.TRUE);\n-        }\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5726b62cd34a5629069ebebd7faf66018e27688"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ3NDk3NA==", "bodyText": "this needs to be indented ...", "url": "https://github.com/eclipse/hono/pull/1769#discussion_r379474974", "createdAt": "2020-02-14T14:58:15Z", "author": {"login": "sophokles73"}, "path": "tests/src/test/java/org/eclipse/hono/tests/registry/TenantHttpIT.java", "diffHunk": "@@ -164,6 +165,38 @@ public void testAddTenantSucceedsForEmptyBody(final VertxTestContext context) {\n         .setHandler(context.completing());\n     }\n \n+    /**\n+     * Verifies that the service successfully create a tenant from a request without a body.\n+     *\n+     * @param context The vert.x test context.\n+     */\n+    @Test\n+    public void testAddTenantSucceedsWithNoRequestBody(final VertxTestContext context) {\n+\n+        registry.addTenant(tenantId)\n+                .setHandler(context.completing());\n+    }\n+\n+    /**\n+     * Verifies that the service successfully create a tenant with a generated tenant ID.\n+     *\n+     * @param context The vert.x test context.\n+     */\n+    @Test\n+    public void testAddTenantSucceedsWithAGeneratedId(final VertxTestContext context) {\n+\n+        registry.addTenant(\"\")\n+                .compose(res -> {\n+                    // compare the changed field only\n+                    context.verify(() -> {\n+                        assertNotNull(res.get(\"location\"));\n+                        // update the global tenantId value for cleanup\n+                        tenantId = res.get(\"location\");\n+                    });\n+        return Future.succeededFuture();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5726b62cd34a5629069ebebd7faf66018e27688"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMTcxMDMz", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-360171033", "createdAt": "2020-02-18T09:11:54Z", "commit": {"oid": "a4c6e8f0d22357438cd01635b27d082106e94050"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4c6e8f0d22357438cd01635b27d082106e94050", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a4c6e8f0d22357438cd01635b27d082106e94050", "committedDate": "2020-02-17T13:35:25Z", "message": "indentation"}, "afterCommit": {"oid": "a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b", "committedDate": "2020-02-18T15:10:03Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzI3MTI1", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-361727125", "createdAt": "2020-02-20T08:59:02Z", "commit": {"oid": "a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwODo1OTowMlrOFsK_4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwODo1OTowMlrOFsK_4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2MTg1Nw==", "bodyText": "since you also allow to create a device without providing a body, shouldn't we also add a corresponding test case to the suite for the /devices resources?", "url": "https://github.com/eclipse/hono/pull/1769#discussion_r381861857", "createdAt": "2020-02-20T08:59:02Z", "author": {"login": "sophokles73"}, "path": "tests/src/test/java/org/eclipse/hono/tests/registry/TenantHttpIT.java", "diffHunk": "@@ -164,6 +165,38 @@ public void testAddTenantSucceedsForEmptyBody(final VertxTestContext context) {\n         .setHandler(context.completing());\n     }\n \n+    /**\n+     * Verifies that the service successfully create a tenant from a request without a body.\n+     *\n+     * @param context The vert.x test context.\n+     */\n+    @Test\n+    public void testAddTenantSucceedsWithNoRequestBody(final VertxTestContext context) {\n+\n+        registry.addTenant(tenantId)\n+                .setHandler(context.completing());\n+    }\n+\n+    /**\n+     * Verifies that the service successfully create a tenant with a generated tenant ID.\n+     *\n+     * @param context The vert.x test context.\n+     */\n+    @Test\n+    public void testAddTenantSucceedsWithAGeneratedId(final VertxTestContext context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86fc4e42ebd93551d6a3653317a5828ed417ae2a", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/86fc4e42ebd93551d6a3653317a5828ed417ae2a", "committedDate": "2020-02-20T10:03:28Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a6fb3b2e7e7575a3364a63bbc1f15bdf265fc95b", "committedDate": "2020-02-18T15:10:03Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "86fc4e42ebd93551d6a3653317a5828ed417ae2a", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/86fc4e42ebd93551d6a3653317a5828ed417ae2a", "committedDate": "2020-02-20T10:03:28Z", "message": "[#1736] Management api : make the body optional in the creation request for a tenant\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzc1NjYx", "url": "https://github.com/eclipse/hono/pull/1769#pullrequestreview-361775661", "createdAt": "2020-02-20T10:08:19Z", "commit": {"oid": "86fc4e42ebd93551d6a3653317a5828ed417ae2a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 971, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}