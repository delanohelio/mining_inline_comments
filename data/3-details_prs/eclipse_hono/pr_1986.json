{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NDA0OTQ0", "number": 1986, "title": "Use async psk for dtls", "bodyText": "Requires Californium 2.3.0 release, scheduled for 16.06.2020.\nSo, on hold, as preview.\nSigned-off-by: Achim Kraus achim.kraus@bosch.io", "createdAt": "2020-05-28T10:47:47Z", "url": "https://github.com/eclipse/hono/pull/1986", "merged": true, "mergeCommit": {"oid": "d280651667fb597eaa55ad6a3a7cccbc37557738"}, "closed": true, "closedAt": "2020-07-03T07:25:53Z", "author": {"login": "boaks"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmSwCfABqjMzODk1MzE2ODg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxOQGvAFqTQ0MjIwMDY4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccdcda77d4264e0be4fcb7e5871086a5db8b04bb", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/ccdcda77d4264e0be4fcb7e5871086a5db8b04bb", "committedDate": "2020-05-28T10:43:30Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "449efa81cc4bd73cdfa3da660bba5aa7ca355699", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/449efa81cc4bd73cdfa3da660bba5aa7ca355699", "committedDate": "2020-05-30T08:13:13Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "449efa81cc4bd73cdfa3da660bba5aa7ca355699", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/449efa81cc4bd73cdfa3da660bba5aa7ca355699", "committedDate": "2020-05-30T08:13:13Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "9979394c2ce7587b0ed2ef196101e04120d4c1c7", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/9979394c2ce7587b0ed2ef196101e04120d4c1c7", "committedDate": "2020-06-02T07:45:55Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9979394c2ce7587b0ed2ef196101e04120d4c1c7", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/9979394c2ce7587b0ed2ef196101e04120d4c1c7", "committedDate": "2020-06-02T07:45:55Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "333feca4c6ee076d1fc2b020ad438027ac55a19d", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/333feca4c6ee076d1fc2b020ad438027ac55a19d", "committedDate": "2020-06-17T13:06:03Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore and\nAdvancedApplicationLevelInfoSupplier.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b0d7d5faf7a01743f748def0e7ce10750c31208", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/3b0d7d5faf7a01743f748def0e7ce10750c31208", "committedDate": "2020-06-24T15:18:01Z", "message": "Update Californium to 2.3.0.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3ae340201a2843433fc1f84ee4278f0557361bf", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/e3ae340201a2843433fc1f84ee4278f0557361bf", "committedDate": "2020-06-24T15:18:20Z", "message": "Use peers based deduplicator for coap-adapter.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6c19f90f57abfbdfb48331b82cd2e9d1012cfad", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/a6c19f90f57abfbdfb48331b82cd2e9d1012cfad", "committedDate": "2020-06-24T15:18:33Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore and\nAdvancedApplicationLevelInfoSupplier.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "333feca4c6ee076d1fc2b020ad438027ac55a19d", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/333feca4c6ee076d1fc2b020ad438027ac55a19d", "committedDate": "2020-06-17T13:06:03Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore and\nAdvancedApplicationLevelInfoSupplier.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}, "afterCommit": {"oid": "a6c19f90f57abfbdfb48331b82cd2e9d1012cfad", "author": {"user": {"login": "boaks", "name": "Achim Kraus"}}, "url": "https://github.com/eclipse/hono/commit/a6c19f90f57abfbdfb48331b82cd2e9d1012cfad", "committedDate": "2020-06-24T15:18:33Z", "message": "Adapt DefaultDeviceResolver to use AdvancedPskStore and\nAdvancedApplicationLevelInfoSupplier.\n\nUse new asynchronous PSK-API of Californium to reduce resource\nconsumption on accessing the remote credentials store.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNjE5NDU4", "url": "https://github.com/eclipse/hono/pull/1986#pullrequestreview-441619458", "createdAt": "2020-07-02T12:14:37Z", "commit": {"oid": "a6c19f90f57abfbdfb48331b82cd2e9d1012cfad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMjoxNDozN1rOGsKMSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMjoxNDozN1rOGsKMSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODk1NzUxNQ==", "bodyText": "which component invokes this method and when?", "url": "https://github.com/eclipse/hono/pull/1986#discussion_r448957515", "createdAt": "2020-07-02T12:14:37Z", "author": {"login": "sophokles73"}, "path": "adapters/coap-vertx-base/src/main/java/org/eclipse/hono/adapter/coap/DefaultDeviceResolver.java", "diffHunk": "@@ -240,4 +256,24 @@ private PreSharedKeyDeviceIdentity getHandshakeIdentity(final Span span, final S\n         final String splitRegex = config.isSingleTenant() ? null : config.getIdSplitRegex();\n         return PreSharedKeyDeviceIdentity.create(span, identity, splitRegex);\n     }\n+\n+    @Override\n+    public boolean hasEcdhePskSupported() {\n+        return true;\n+    }\n+\n+    @Override\n+    public PskSecretResult requestPskSecretResult(final ConnectionId cid, final ServerNames serverName,\n+            final PskPublicInformation identity, final String hmacAlgorithm, final SecretKey otherSecret,\n+            final byte[] seed) {\n+\n+        context.runOnContext((v) -> loadCredentialsForDevice(cid, identity));\n+        return null;\n+    }\n+\n+    @Override\n+    public void setResultHandler(final PskSecretResultHandler resultHandler) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6c19f90f57abfbdfb48331b82cd2e9d1012cfad"}, "originalPosition": 281}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMjAwNjg0", "url": "https://github.com/eclipse/hono/pull/1986#pullrequestreview-442200684", "createdAt": "2020-07-03T07:24:38Z", "commit": {"oid": "a6c19f90f57abfbdfb48331b82cd2e9d1012cfad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 633, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}