{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NzM1NDY4", "number": 2016, "title": "[#1960] add status section for devices in API spec", "bodyText": "Signed-off-by: Jean-Baptiste Trystram jbtrystram@redhat.com", "createdAt": "2020-06-04T10:20:07Z", "url": "https://github.com/eclipse/hono/pull/2016", "merged": true, "mergeCommit": {"oid": "91225bccae085d08e658108e09a0a50c8fd77d0f"}, "closed": true, "closedAt": "2020-07-07T07:46:41Z", "author": {"login": "jbtrystram"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn8WM8gFqTQyNDM0Nzg4Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxNxoigFqTQ0MjE4Mzc2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MzQ3ODgz", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-424347883", "createdAt": "2020-06-04T11:27:34Z", "commit": {"oid": "8f470a76e80d589902ba6b1c9d433f312a9ecec8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxMToyNzozNVrOGfBcpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxMToyNzozNVrOGfBcpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE4Mjc1Ng==", "bodyText": "I would recommend to put an explicit expectation of the format here. And put a requirement on the timezone. I would propose to always enforce UTC.", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r435182756", "createdAt": "2020-06-04T11:27:35Z", "author": {"login": "ctron"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -778,6 +778,25 @@ components:\n                description: The IDs of the gateway groups that this device is a member of. Note that \"via\" and \"memberOf\" must not be set at the same time. The same applies for \"viaGroups\" and \"memberOf\" which must be set at the same time too. The reason is that Eclipse Hono does not support groups of gateway groups.\n             \"ext\":\n                $ref: '#/components/schemas/Extensions'\n+            \"status\":\n+               $ref: '#/components/schemas/Status'\n+\n+      Status:\n+         type: object\n+         additionalProperties: false\n+         description: Optional and written only by the device registry implementation.\n+            It can not be updated by the user.\n+            Any data inserted in the status section by the user in a PUT request will be ignored.\n+         properties:\n+            \"created\":\n+               type: date-time", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f470a76e80d589902ba6b1c9d433f312a9ecec8"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f470a76e80d589902ba6b1c9d433f312a9ecec8", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/8f470a76e80d589902ba6b1c9d433f312a9ecec8", "committedDate": "2020-06-04T10:19:37Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "62d7eede360592c91db4e4619521b0ee8c20e512", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/62d7eede360592c91db4e4619521b0ee8c20e512", "committedDate": "2020-06-04T12:25:42Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NDYxMjk1", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-424461295", "createdAt": "2020-06-04T13:42:06Z", "commit": {"oid": "62d7eede360592c91db4e4619521b0ee8c20e512"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NjIwMjUx", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-424620251", "createdAt": "2020-06-04T16:22:26Z", "commit": {"oid": "62d7eede360592c91db4e4619521b0ee8c20e512"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjoyMjoyNlrOGfN4lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjoyMjoyNlrOGfN4lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4NjUxOA==", "bodyText": "FMPOV this constitutes a minor version change ...", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r435386518", "createdAt": "2020-06-04T16:22:26Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -778,6 +778,30 @@ components:\n                description: The IDs of the gateway groups that this device is a member of. Note that \"via\" and \"memberOf\" must not be set at the same time. The same applies for \"viaGroups\" and \"memberOf\" which must be set at the same time too. The reason is that Eclipse Hono does not support groups of gateway groups.\n             \"ext\":\n                $ref: '#/components/schemas/Extensions'\n+            \"status\":\n+               $ref: '#/components/schemas/Status'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62d7eede360592c91db4e4619521b0ee8c20e512"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2ODY0NDE3", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-426864417", "createdAt": "2020-06-09T07:36:27Z", "commit": {"oid": "587a42aab7524ea07c556688a53c156fd07f6f44"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNzozNjoyN1rOGg8a-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNzozOTowM1rOGg8gTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE5NzU2Mg==", "bodyText": "I do not think that the user id will match the date/time pattern very oftenly ;-)", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r437197562", "createdAt": "2020-06-09T07:36:27Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -778,6 +778,30 @@ components:\n                description: The IDs of the gateway groups that this device is a member of. Note that \"via\" and \"memberOf\" must not be set at the same time. The same applies for \"viaGroups\" and \"memberOf\" which must be set at the same time too. The reason is that Eclipse Hono does not support groups of gateway groups.\n             \"ext\":\n                $ref: '#/components/schemas/Extensions'\n+            \"status\":\n+               $ref: '#/components/schemas/Status'\n+\n+      Status:\n+         type: object\n+         additionalProperties: false\n+         description: Optional and written only by the device registry implementation.\n+            It can not be updated by the user.\n+            Any data inserted in the status section by the user in a PUT request will be ignored.\n+         properties:\n+            \"created\":\n+               type: string\n+               format: date-time\n+               description: The date and time when the device was created.\n+                  The format must comply with RFC 3339, section 5.6. The representation must be UTC (no timezone offset).\n+            \"updated\":\n+               type: string\n+               format: date-time\n+               description: The date and time when the device was last updated.\n+                  The format must comply with RFC 3339, section 5.6. The representation must be UTC (no timezone offset).\n+            \"last-user\":\n+               type: string\n+               description: The user who made the last edit on this device.\n+                  The format must comply with RFC 3339, section 5.6. The representation must be UTC (no timezone offset).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "587a42aab7524ea07c556688a53c156fd07f6f44"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE5ODkyNQ==", "bodyText": "My understanding is that the status is a generic concept which will most likely also be added to other entities (Tenant, Credentials), right? If so, I wonder if it deserves to be represented by a dedicated class instead of a map. In particular, since the type is defined to allow no additional properties in the API spec ...", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r437198925", "createdAt": "2020-06-09T07:39:03Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Device.java", "diffHunk": "@@ -61,6 +61,10 @@\n     @JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)\n     private List<String> memberOf = new LinkedList<>();\n \n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS)\n+    @JsonInclude(value = Include.NON_EMPTY)\n+    private Map<String, Object> status = new HashMap<>();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "587a42aab7524ea07c556688a53c156fd07f6f44"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODEyMDQ1", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-427812045", "createdAt": "2020-06-10T08:09:21Z", "commit": {"oid": "63afeb804e6a6a3eee5f710536ef8eb32695b656"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODowOToyMlrOGhpsmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODoxMDo0M1rOGhpvww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkzOTM1NQ==", "bodyText": "I guess this should be JsonInclude.Include.NOT_NULL. AFAIK JsonInclude.Include.NON_EMPTY is used for collections only, isn't it?", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r437939355", "createdAt": "2020-06-10T08:09:22Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Status.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A status used in Device value object.\n+ */\n+public final class Status {\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63afeb804e6a6a3eee5f710536ef8eb32695b656"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk0MDE2Mw==", "bodyText": "how about passing in the user who performs the update as a parameter and remove the setLastUser method as well?\nThe constructor should then also accept the user parameter ...\nWDYT?", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r437940163", "createdAt": "2020-06-10T08:10:43Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Status.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A status used in Device value object.\n+ */\n+public final class Status {\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private final Instant creationTime;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_LAST_UPDATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant lastUpdate;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_LAST_USER)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    private String lastUser;\n+\n+    /**\n+     * Create a new Status initialised at the creation time.\n+     */\n+    public Status() {\n+\n+        this.creationTime = Instant.now();\n+        this.lastUpdate = creationTime;\n+    }\n+\n+    public Instant getCreationTime() {\n+        return creationTime;\n+    }\n+\n+    public Instant getLastUpdate() {\n+        return lastUpdate;\n+    }\n+\n+\n+    /**\n+     * Update the lastUpdate field with the current time.\n+     */\n+    public void update() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63afeb804e6a6a3eee5f710536ef8eb32695b656"}, "originalPosition": 64}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47e5b21438d90653812e48d9f91af3d4efb00ac4", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/47e5b21438d90653812e48d9f91af3d4efb00ac4", "committedDate": "2020-06-17T09:29:07Z", "message": "update Status with Kai suggestion\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "44abae7a71490d7828974b3404df3c25459fc4db", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/44abae7a71490d7828974b3404df3c25459fc4db", "committedDate": "2020-06-25T13:27:56Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b81fb4ec87517c2106e3af57beb97ae12c9410f7", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/b81fb4ec87517c2106e3af57beb97ae12c9410f7", "committedDate": "2020-06-30T12:17:17Z", "message": "add unit tests and fix systemtests\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "e367a8f9ccb410ac5c5b74ee03dd5968217dfb6e", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/e367a8f9ccb410ac5c5b74ee03dd5968217dfb6e", "committedDate": "2020-07-01T07:01:02Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e367a8f9ccb410ac5c5b74ee03dd5968217dfb6e", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/e367a8f9ccb410ac5c5b74ee03dd5968217dfb6e", "committedDate": "2020-07-01T07:01:02Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "6323d31b071ec53b4337c40cabf0a538d711b768", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/6323d31b071ec53b4337c40cabf0a538d711b768", "committedDate": "2020-07-01T08:39:19Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6323d31b071ec53b4337c40cabf0a538d711b768", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/6323d31b071ec53b4337c40cabf0a538d711b768", "committedDate": "2020-07-01T08:39:19Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/6ffe10798eddc25c97da8f4ac273f11978a250b3", "committedDate": "2020-07-01T08:42:24Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODA3MDkx", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-440807091", "createdAt": "2020-07-01T12:05:41Z", "commit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxMjowNTo0MVrOGrjFaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxMjoxMjozNFrOGrjSpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxNjc3Ng==", "bodyText": "2020?", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r448316776", "createdAt": "2020-07-01T12:05:41Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Status.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019 Contributors to the Eclipse Foundation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxNzcwOA==", "bodyText": "Updates ...\n\nplease add an empty line between the description and the parameters and remove the empty line between the parameters and the return value", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r448317708", "createdAt": "2020-07-01T12:07:39Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Status.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A status used in Device value object.\n+ */\n+public final class Status {\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private final Instant creationTime;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_LAST_UPDATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant lastUpdate;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_LAST_USER)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    private String lastUser;\n+\n+    /**\n+     * Create a new Status initialised at the creation time.\n+     */\n+    public Status() {\n+\n+        this.creationTime = Instant.now();\n+        this.lastUpdate = creationTime;\n+    }\n+\n+    public Instant getCreationTime() {\n+        return creationTime;\n+    }\n+\n+    public Instant getLastUpdate() {\n+        return lastUpdate;\n+    }\n+\n+\n+    /**\n+     * Update the lastUpdate and lastUser fields with the current time and user.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxOTMxNw==", "bodyText": "I'd rather increase the version number with each PR so that we do not run at risk of losing track of it. That way, the PRs are more self contained as well and we can decide on each one of them what type of version change it constitutes ...", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r448319317", "createdAt": "2020-07-01T12:10:43Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -778,6 +778,30 @@ components:\n                description: The IDs of the gateway groups that this device is a member of. Note that \"via\" and \"memberOf\" must not be set at the same time. The same applies for \"viaGroups\" and \"memberOf\" which must be set at the same time too. The reason is that Eclipse Hono does not support groups of gateway groups.\n             \"ext\":\n                $ref: '#/components/schemas/Extensions'\n+            \"status\":\n+               $ref: '#/components/schemas/Status'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4NjUxOA=="}, "originalCommit": {"oid": "62d7eede360592c91db4e4619521b0ee8c20e512"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMxOTYzOQ==", "bodyText": "please add the status to the example payloads for the device management endpoint as well ...", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r448319639", "createdAt": "2020-07-01T12:11:22Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -951,6 +951,29 @@ components:\n                   notice.\n             \"ext\":\n                $ref: '#/components/schemas/Extensions'\n+            \"status\":\n+               $ref: '#/components/schemas/Status'\n+\n+      Status:\n+         type: object\n+         additionalProperties: false\n+         description: Optional and written only by the device registry implementation.\n+            It can not be updated by the user.\n+            Any data inserted in the status section by the user in a PUT request will be ignored.\n+         properties:\n+            \"created\":\n+               type: string\n+               format: date-time\n+               description: The date and time when the device was created.\n+                  The format must comply with RFC 3339, section 5.6. The representation must be UTC (no timezone offset).\n+            \"updated\":\n+               type: string\n+               format: date-time\n+               description: The date and time when the device was last updated.\n+                  The format must comply with RFC 3339, section 5.6. The representation must be UTC (no timezone offset).\n+            \"last-user\":\n+               type: string\n+               description: The user who made the last edit on this device.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMyMDE2Nw==", "bodyText": "nice \ud83d\udc4d", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r448320167", "createdAt": "2020-07-01T12:12:34Z", "author": {"login": "sophokles73"}, "path": "tests/src/test/java/org/eclipse/hono/tests/registry/DeviceManagementIT.java", "diffHunk": "@@ -468,6 +470,11 @@ private static void assertRegistrationInformation(\n             final String expectedDeviceId,\n             final Device expectedData) {\n \n-        assertThat(response).usingRecursiveComparison().isEqualTo(expectedData);\n+        final Comparator<Instant> close = (Instant d1, Instant d2) -> d1.compareTo(d2) < 1000 ? 0 : 1;\n+\n+        assertThat(response)\n+                .usingRecursiveComparison()\n+                .withComparatorForFields(close, \"status.creationTime\", \"status.lastUpdate\")\n+                .isEqualTo(expectedData);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ffe10798eddc25c97da8f4ac273f11978a250b3", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/6ffe10798eddc25c97da8f4ac273f11978a250b3", "committedDate": "2020-07-01T08:42:24Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "cd004a5d88ad9acf55b8c0d091416ff05144845e", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/cd004a5d88ad9acf55b8c0d091416ff05144845e", "committedDate": "2020-07-02T13:18:05Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNzc5MDY3", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-441779067", "createdAt": "2020-07-02T15:13:44Z", "commit": {"oid": "cd004a5d88ad9acf55b8c0d091416ff05144845e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNToxMzo0NFrOGsRS1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNToxMzo0NFrOGsRS1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3Mzg3OA==", "bodyText": "are you sure that these strings follow the definition of the properties? IIRC the times must not contain a time zone offset but be in UTC, right?", "url": "https://github.com/eclipse/hono/pull/2016#discussion_r449073878", "createdAt": "2020-07-02T15:13:44Z", "author": {"login": "sophokles73"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -391,6 +391,11 @@ paths:\n                                  \"via\": [\n                                     \"gw-1\", \"gw-4\"\n                                  ],\n+                                 \"status\": {\n+                                    \"created\": \"2019-10-03T13:45:16+02:00\"\n+                                    \"updated\": \"2020-05-04T10:11:12+02:00\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd004a5d88ad9acf55b8c0d091416ff05144845e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "392aafd0ff44636d1068f159f5d38715830a8f72", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/392aafd0ff44636d1068f159f5d38715830a8f72", "committedDate": "2020-07-03T06:31:26Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd004a5d88ad9acf55b8c0d091416ff05144845e", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/cd004a5d88ad9acf55b8c0d091416ff05144845e", "committedDate": "2020-07-02T13:18:05Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "392aafd0ff44636d1068f159f5d38715830a8f72", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/392aafd0ff44636d1068f159f5d38715830a8f72", "committedDate": "2020-07-03T06:31:26Z", "message": "[1960] add status section for devices in API spec\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMTgzNzY1", "url": "https://github.com/eclipse/hono/pull/2016#pullrequestreview-442183765", "createdAt": "2020-07-03T06:51:21Z", "commit": {"oid": "392aafd0ff44636d1068f159f5d38715830a8f72"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 661, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}