{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4NjgzNTQ1", "number": 2189, "title": "[#1960] Implementing status property for device registrations.", "bodyText": "The idea was to separate the Device class into two: one with a status property and one without (this emerged from a discussion with @kaniyan and personally I think this simplifies a lot of things and I do like the idea \ud83d\ude03).\nBecause of that separation it is easier to make sure that a user is actually not able to change the status (which is in fact system internal as far as I understood)\nIn order to make as much logic as possible generic I also refactored the Device and the MongoDb based registry so that they both use DTOs and introduced a new BaseDTO class. By this we can separate internal and user-editable state. Also, I hope this fits the JDBC based registry (given I understood the code in the current PRs correctly): it is still a JSON based object as the Device class itself.\nThe generic wildcard in DeviceManagementService / AbstractDeviceManagementService was intended to allow merging this first without having to implement this in the JDBC registry (or in general: to allow implementations without a status property...)\nThe BaseDTO should also allow for adding corresponding TenantWithStatus and CredentialsWithStatus implementations. Since status implementations will differ (at least we need the two status properties auto-provisioned and auto-provisioning-notification-sent for #2053 which do not make sense for tenants or credentials) I think it is easier to have concrete subclasses for that.\nLet me know what you think!", "createdAt": "2020-09-17T13:50:06Z", "url": "https://github.com/eclipse/hono/pull/2189", "merged": true, "mergeCommit": {"oid": "962c77aa1ca75661c8091b5e8a2b31c2ea97023b"}, "closed": true, "closedAt": "2020-10-27T08:26:14Z", "author": {"login": "fkaltner"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKA8tFgBqjM3ODE0MjYxMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWkp0rAFqTUxNzQ0NjU0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "adff02457d53203abf6419135def1345f676c042", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/adff02457d53203abf6419135def1345f676c042", "committedDate": "2020-09-17T13:39:36Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "926511c335791fbb71a9650fe377087d113669e6", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/926511c335791fbb71a9650fe377087d113669e6", "committedDate": "2020-09-18T08:02:36Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "926511c335791fbb71a9650fe377087d113669e6", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/926511c335791fbb71a9650fe377087d113669e6", "committedDate": "2020-09-18T08:02:36Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "024ad73fefed865751d22b56e47946fe79ffab30", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/024ad73fefed865751d22b56e47946fe79ffab30", "committedDate": "2020-09-18T09:02:58Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MzM2Njg5", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-495336689", "createdAt": "2020-09-24T08:30:03Z", "commit": {"oid": "024ad73fefed865751d22b56e47946fe79ffab30"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwODozMDowM1rOHXPiaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwODozMzozMVrOHXPq5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDEzMzg2Nw==", "bodyText": "What about JavaDocs for these?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r494133867", "createdAt": "2020-09-24T08:30:03Z", "author": {"login": "dejanb"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,159 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.Objects;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(value = FIELD_VERSION, required = true)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(value = FIELD_UPDATED_ON, required = true)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Creates a new DTO object holding the given data with its creation time initialized at <pre>now</pre>.\n+     *\n+     * @param data The data object\n+     */\n+    public BaseDto(final T data) {\n+        this(Instant.now(), null, data);\n+    }\n+\n+    /**\n+     * Creates a new DTO object.\n+     *\n+     * @param creationTime The time when the data object was created.\n+     * @param updatedOn The time when the data object was most recently updated.\n+     * @param data The data object.\n+     */\n+    public BaseDto(final Instant creationTime, final Instant updatedOn, final T data) {\n+        this.creationTime = creationTime;\n+        this.updatedOn = updatedOn;\n+        this.data = data;\n+    }\n+\n+    /**\n+     * Gets the version of the document.\n+     *\n+     * @return The version of the document.\n+     */\n+    public final String getVersion() {\n+        return version;\n+    }\n+\n+    /**\n+     * Sets the version of the document.\n+     *\n+     * @param version The version of the document or {@code null} if not set.\n+     * @throws NullPointerException if the version is {@code null}.\n+     */\n+    public final void setVersion(final String version) {\n+        this.version = Objects.requireNonNull(version);\n+    }\n+\n+    /**\n+     * Gets the date and time of last modification.\n+     *\n+     * @return The date and time of last modification.\n+     */\n+    public final Instant getUpdatedOn() {\n+        return updatedOn;\n+    }\n+\n+    /**\n+     * Sets the date and time of last modification.\n+     *\n+     * @param updatedOn The date and time of last modification.\n+     * @throws NullPointerException if the last modification date and time is {@code null}.\n+     */\n+    public final void setUpdatedOn(final Instant updatedOn) {\n+        this.updatedOn = Objects.requireNonNull(updatedOn);\n+    }\n+\n+    public Instant getLastUpdate() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "024ad73fefed865751d22b56e47946fe79ffab30"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDEzNjAzOQ==", "bodyText": "Can this be a more generic class, that could probably be reused for other implementation? I don't see anything specific to File implementation.", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r494136039", "createdAt": "2020-09-24T08:33:31Z", "author": {"login": "dejanb"}, "path": "services/device-registry-file/src/main/java/org/eclipse/hono/deviceregistry/file/FileBasedRegistrationService.java", "diffHunk": "@@ -538,12 +551,33 @@ public String toString() {\n      */\n     private String generateDeviceId(final String tenantId) {\n \n-        final ConcurrentMap<String, Versioned<Device>> devices = getDevicesForTenant(tenantId);\n+        final ConcurrentMap<String, FileBasedDeviceDto> devices = getDevicesForTenant(tenantId);\n         String tempDeviceId;\n         do {\n             tempDeviceId = UUID.randomUUID().toString();\n         } while (devices.containsKey(tempDeviceId));\n         return tempDeviceId;\n     }\n \n+    private static final class FileBasedDeviceDto extends BaseDto<Versioned<Device>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "024ad73fefed865751d22b56e47946fe79ffab30"}, "originalPosition": 241}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea8cbe3a7b6145bfb7e46f03d3f079c507a8abf1", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/ea8cbe3a7b6145bfb7e46f03d3f079c507a8abf1", "committedDate": "2020-09-24T11:22:19Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "9307d19843e2529c90e3ce0abd57c6d097607b59", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/9307d19843e2529c90e3ce0abd57c6d097607b59", "committedDate": "2020-09-25T08:39:14Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "694896ecab58bd2bb764e9a36ff95c6a5be13e17", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/694896ecab58bd2bb764e9a36ff95c6a5be13e17", "committedDate": "2020-09-29T06:09:58Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "5a77d35480ff029a8d5f8f41deb810370a867398", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/5a77d35480ff029a8d5f8f41deb810370a867398", "committedDate": "2020-09-29T08:08:40Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a77d35480ff029a8d5f8f41deb810370a867398", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/5a77d35480ff029a8d5f8f41deb810370a867398", "committedDate": "2020-09-29T08:08:40Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "2f7d39016477f0b3ae26c86af4f15d5c37f47993", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/2f7d39016477f0b3ae26c86af4f15d5c37f47993", "committedDate": "2020-09-29T12:30:47Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f7d39016477f0b3ae26c86af4f15d5c37f47993", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/2f7d39016477f0b3ae26c86af4f15d5c37f47993", "committedDate": "2020-09-29T12:30:47Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "337c3193dfce1294b123f1da33e128e3d85cf789", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/337c3193dfce1294b123f1da33e128e3d85cf789", "committedDate": "2020-09-29T13:54:48Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "337c3193dfce1294b123f1da33e128e3d85cf789", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/337c3193dfce1294b123f1da33e128e3d85cf789", "committedDate": "2020-09-29T13:54:48Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "1ce0f3d4b2a44325174d13edbf95f6ae65dd8014", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/1ce0f3d4b2a44325174d13edbf95f6ae65dd8014", "committedDate": "2020-09-29T14:00:20Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMjcyMDUw", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-500272050", "createdAt": "2020-10-01T11:59:21Z", "commit": {"oid": "1ce0f3d4b2a44325174d13edbf95f6ae65dd8014"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ce0f3d4b2a44325174d13edbf95f6ae65dd8014", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/1ce0f3d4b2a44325174d13edbf95f6ae65dd8014", "committedDate": "2020-09-29T14:00:20Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "fa4babfa962986fc5123a4c432313ec1309472d4", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/fa4babfa962986fc5123a4c432313ec1309472d4", "committedDate": "2020-10-05T14:53:16Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa4babfa962986fc5123a4c432313ec1309472d4", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/fa4babfa962986fc5123a4c432313ec1309472d4", "committedDate": "2020-10-05T14:53:16Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "aedbda1806521d612ac98ddf849a95eeca10d57d", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/aedbda1806521d612ac98ddf849a95eeca10d57d", "committedDate": "2020-10-05T15:20:04Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aedbda1806521d612ac98ddf849a95eeca10d57d", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/aedbda1806521d612ac98ddf849a95eeca10d57d", "committedDate": "2020-10-05T15:20:04Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "225bffae5df807fa4d8a9afa319e0ea8e7dc64d5", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/225bffae5df807fa4d8a9afa319e0ea8e7dc64d5", "committedDate": "2020-10-06T07:28:21Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "225bffae5df807fa4d8a9afa319e0ea8e7dc64d5", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/225bffae5df807fa4d8a9afa319e0ea8e7dc64d5", "committedDate": "2020-10-06T07:28:21Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/cbef61b521732623eecc82ddc5731adf0c71df43", "committedDate": "2020-10-06T12:14:12Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNzc3NDk4", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-503777498", "createdAt": "2020-10-07T11:24:46Z", "commit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMToyNDo0NlrOHduqAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxMTo1ODoxOFrOHdvvHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkzNTE3MQ==", "bodyText": "IMHO we should not decide on this here but let subclasses decide whether they want to ignore unknown properties or not.", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500935171", "createdAt": "2020-10-07T11:24:46Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,208 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkzNTg1MA==", "bodyText": "setting required = true has no meaning when annotating a property. If you want an exception to be thrown if this JSON property is missing, then you need to use the constructor for setting the property.", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500935850", "createdAt": "2020-10-07T11:26:03Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,208 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(value = FIELD_VERSION, required = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkzNjAwNw==", "bodyText": "see above", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500936007", "createdAt": "2020-10-07T11:26:19Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,208 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(value = FIELD_VERSION, required = true)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(value = FIELD_UPDATED_ON, required = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk0MjQ1OA==", "bodyText": "New classes usually only sport the current year in the header ...", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500942458", "createdAt": "2020-10-07T11:39:00Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DeviceWithStatus.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019, 2020 Contributors to the Eclipse Foundation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk0NTA5Mg==", "bodyText": "why don't we use aggregation instead of inheritance here? Wouldn't that improve decoupling and would also allow to use the Device class as-is (apart from moving the status property, of course)?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500945092", "createdAt": "2020-10-07T11:44:00Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DeviceWithStatus.java", "diffHunk": "@@ -0,0 +1,82 @@\n+/*******************************************************************************\n+ * Copyright (c) 2019, 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+\n+package org.eclipse.hono.service.management.device;\n+\n+\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonInclude.Include;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * Device Information.\n+ */\n+@JsonIgnoreProperties()\n+@JsonInclude(value = Include.NON_NULL)\n+public class DeviceWithStatus extends Device {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk1MTY5MA==", "bodyText": "it looks like this method is suppose to be used with arbitrary types of data, e.g. Device, Tenant, CommonCredential, right? If so, then the field name used here should not be specific to the Device class, shouldn't it?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500951690", "createdAt": "2020-10-07T11:56:01Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-mongodb/src/main/java/org/eclipse/hono/deviceregistry/mongodb/utils/MongoDbDocumentBuilder.java", "diffHunk": "@@ -56,6 +57,36 @@ public static MongoDbDocumentBuilder builder() {\n         return new MongoDbDocumentBuilder();\n     }\n \n+    /**\n+     * Creates a MongoDb update document for the update of the given DTO.\n+     *\n+     * @param baseDto The DTO for which an update should be generated.\n+     *\n+     * @return a reference to this for fluent use.\n+     */\n+    public MongoDbDocumentBuilder forUpdateOf(final BaseDto<?> baseDto) {\n+        final JsonObject updates = new JsonObject();\n+\n+        if (baseDto.getData() != null) {\n+            updates.put(MongoDbDeviceRegistryUtils.FIELD_DEVICE, JsonObject.mapFrom(baseDto.getData()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk1Mjg2MA==", "bodyText": "I see value in having this kind of factory methods in the subclasses in order to know in which context we want to create the instance. But in this class, a simple constructor accepting the parameters that are managed by this abstract class would suffice.", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r500952860", "createdAt": "2020-10-07T11:58:18Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,208 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(value = FIELD_VERSION, required = true)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(value = FIELD_UPDATED_ON, required = true)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forCreation(final Supplier<T> supplier, final P data, final String version) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 71}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzOTIxNTY2", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-503921566", "createdAt": "2020-10-07T14:09:55Z", "commit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowOTo1NVrOHd1TOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDowOTo1NVrOHd1TOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA0NDAyNw==", "bodyText": "Do we need this here? FMPOV Device has no property named status defined. In order to include the status we have a new class DeviceWithStatus. If needed, then RegistryManagementConstants.FIELD_STATUS could be used instead of the string literal \"status\".", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r501044027", "createdAt": "2020-10-07T14:09:55Z", "author": {"login": "kaniyan"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Device.java", "diffHunk": "@@ -33,6 +34,7 @@\n  * Device Information.\n  */\n @JsonInclude(value = Include.NON_NULL)\n+@JsonIgnoreProperties({ \"status\" })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbef61b521732623eecc82ddc5731adf0c71df43"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee486e35a165c0d0098d63bf8aeae449170fd096", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/ee486e35a165c0d0098d63bf8aeae449170fd096", "committedDate": "2020-10-08T12:48:10Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "9c34194ea5331343513ba233adf79f0d07300c6c", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/9c34194ea5331343513ba233adf79f0d07300c6c", "committedDate": "2020-10-13T09:54:54Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MDQzOTYx", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-509043961", "createdAt": "2020-10-15T06:32:51Z", "commit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwNjozMjo1MVrOHhzJqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwNjozMjo1MVrOHhzJqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTIwMzExNA==", "bodyText": "I think it may good to avoid null cases here. Having an empty object object is better IMHO than null.", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r505203114", "createdAt": "2020-10-15T06:32:51Z", "author": {"login": "ctron"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Device.java", "diffHunk": "@@ -63,7 +65,7 @@\n \n     @JsonProperty(RegistryManagementConstants.FIELD_STATUS)\n     @JsonInclude(value = Include.NON_EMPTY)\n-    private Status status = new Status();\n+    private Status status;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2NTk2MzE5", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-516596319", "createdAt": "2020-10-26T09:28:34Z", "commit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "state": "COMMENTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwOToyODozNFrOHoHGtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwOTo1ODo0NlrOHoIP8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyMTQ5NQ==", "bodyText": "are these methods supposed to be overridden? If not, I would suggest to make them final ...", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511821495", "createdAt": "2020-10-26T09:28:34Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/Device.java", "diffHunk": "@@ -280,4 +283,23 @@ public String getMapper() {\n         return mapper;\n     }\n \n+    /**\n+     * Sets the registry internal status information of this device.\n+     *\n+     * @param status The status information to be set or {@code null} if there is none.\n+     * @return A reference to this for fluent use.\n+     */\n+    public Device setStatus(final Status status) {\n+        this.status = status;\n+        return this;\n+    }\n+\n+    /**\n+     * Gets the registry internal status information of this device.\n+     *\n+     * @return The registry internal status information or {@code null} if there is none.\n+     */\n+    public Status getStatus() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNTA0Mg==", "bodyText": "Will this constructor ever be invoked from anywhere but a subclass?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511825042", "createdAt": "2020-10-26T09:33:56Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,207 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(FIELD_VERSION)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(FIELD_UPDATED_ON)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjUxNw==", "bodyText": "final ?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511826517", "createdAt": "2020-10-26T09:36:19Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,207 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(FIELD_VERSION)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(FIELD_UPDATED_ON)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forCreation(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forUpdate(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setUpdatedOn(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forRead(final Supplier<T> supplier, final P data, final Instant created, final Instant updated, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(created);\n+        dto.setUpdatedOn(updated);\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Gets the version of the document.\n+     *\n+     * @return The version of the document.\n+     */\n+    public final String getVersion() {\n+        return version;\n+    }\n+\n+    /**\n+     * Sets the version of the document.\n+     *\n+     * @param version The version of the document or {@code null} if not set.\n+     */\n+    protected final void setVersion(final String version) {\n+        this.version = version;\n+    }\n+\n+    /**\n+     * Gets the date and time of last modification.\n+     *\n+     * @return The date and time of last modification.\n+     */\n+    public final Instant getUpdatedOn() {\n+        return updatedOn;\n+    }\n+\n+    /**\n+     * Sets the date and time of last modification.\n+     *\n+     * @param updatedOn The date and time of last modification.\n+     */\n+    protected final void setUpdatedOn(final Instant updatedOn) {\n+        this.updatedOn = updatedOn;\n+    }\n+\n+    /**\n+     * Gets the date and time when the entity detailed by this status was created.\n+     *\n+     * @return The entity's creation time.\n+     */\n+    public Instant getCreationTime() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 166}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjU4NA==", "bodyText": "final ?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511826584", "createdAt": "2020-10-26T09:36:27Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,207 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(FIELD_VERSION)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(FIELD_UPDATED_ON)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forCreation(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forUpdate(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setUpdatedOn(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forRead(final Supplier<T> supplier, final P data, final Instant created, final Instant updated, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(created);\n+        dto.setUpdatedOn(updated);\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Gets the version of the document.\n+     *\n+     * @return The version of the document.\n+     */\n+    public final String getVersion() {\n+        return version;\n+    }\n+\n+    /**\n+     * Sets the version of the document.\n+     *\n+     * @param version The version of the document or {@code null} if not set.\n+     */\n+    protected final void setVersion(final String version) {\n+        this.version = version;\n+    }\n+\n+    /**\n+     * Gets the date and time of last modification.\n+     *\n+     * @return The date and time of last modification.\n+     */\n+    public final Instant getUpdatedOn() {\n+        return updatedOn;\n+    }\n+\n+    /**\n+     * Sets the date and time of last modification.\n+     *\n+     * @param updatedOn The date and time of last modification.\n+     */\n+    protected final void setUpdatedOn(final Instant updatedOn) {\n+        this.updatedOn = updatedOn;\n+    }\n+\n+    /**\n+     * Gets the date and time when the entity detailed by this status was created.\n+     *\n+     * @return The entity's creation time.\n+     */\n+    public Instant getCreationTime() {\n+        return creationTime;\n+    }\n+\n+    /**\n+     * Sets the date and time when the entity detailed by this status was created.\n+     *\n+     * @param creationTime The entity's creation time.\n+     */\n+    protected void setCreationTime(final Instant creationTime) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNzM2Mw==", "bodyText": "final ?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511827363", "createdAt": "2020-10-26T09:37:43Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,207 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(FIELD_VERSION)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(FIELD_UPDATED_ON)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forCreation(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forUpdate(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setUpdatedOn(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forRead(final Supplier<T> supplier, final P data, final Instant created, final Instant updated, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(created);\n+        dto.setUpdatedOn(updated);\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Gets the version of the document.\n+     *\n+     * @return The version of the document.\n+     */\n+    public final String getVersion() {\n+        return version;\n+    }\n+\n+    /**\n+     * Sets the version of the document.\n+     *\n+     * @param version The version of the document or {@code null} if not set.\n+     */\n+    protected final void setVersion(final String version) {\n+        this.version = version;\n+    }\n+\n+    /**\n+     * Gets the date and time of last modification.\n+     *\n+     * @return The date and time of last modification.\n+     */\n+    public final Instant getUpdatedOn() {\n+        return updatedOn;\n+    }\n+\n+    /**\n+     * Sets the date and time of last modification.\n+     *\n+     * @param updatedOn The date and time of last modification.\n+     */\n+    protected final void setUpdatedOn(final Instant updatedOn) {\n+        this.updatedOn = updatedOn;\n+    }\n+\n+    /**\n+     * Gets the date and time when the entity detailed by this status was created.\n+     *\n+     * @return The entity's creation time.\n+     */\n+    public Instant getCreationTime() {\n+        return creationTime;\n+    }\n+\n+    /**\n+     * Sets the date and time when the entity detailed by this status was created.\n+     *\n+     * @param creationTime The entity's creation time.\n+     */\n+    protected void setCreationTime(final Instant creationTime) {\n+        this.creationTime = creationTime;\n+    }\n+\n+    /**\n+     * Gets the data object (i.e. what should be editable by clients) of this DTO.\n+     * This method may be overridden by subclasses to set the JSON property name to a more meaningful one.\n+     *\n+     * @return The data object.\n+     */\n+    @JsonProperty(FIELD_DATA)\n+    public T getData() {\n+        return data;\n+    }\n+\n+    /**\n+     * Sets the data object of this DTO.\n+     *\n+     * @param data The data object.\n+     */\n+    protected void setData(final T data) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 195}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNzYxMg==", "bodyText": "does this return null by intention?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511827612", "createdAt": "2020-10-26T09:38:13Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/BaseDto.java", "diffHunk": "@@ -0,0 +1,207 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management;\n+\n+import java.time.Instant;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.annotation.HonoTimestamp;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * The base class for implementing a DTO (Data Transfer Object) to store data in registry implementations.\n+ *\n+ * @param <T> The type of the data object\n+ */\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public abstract class BaseDto<T> {\n+\n+    public static final String FIELD_UPDATED_ON = \"updatedOn\";\n+    public static final String FIELD_VERSION = \"version\";\n+    public static final String FIELD_DATA = \"data\";\n+\n+    @JsonProperty(FIELD_VERSION)\n+    private String version;\n+\n+    @JsonProperty(RegistryManagementConstants.FIELD_STATUS_CREATION_DATE)\n+    @JsonInclude(value = JsonInclude.Include.NON_EMPTY)\n+    @HonoTimestamp\n+    private Instant creationTime;\n+\n+    @JsonProperty(FIELD_UPDATED_ON)\n+    @HonoTimestamp\n+    private Instant updatedOn;\n+\n+    private T data;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public BaseDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forCreation(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forUpdate(final Supplier<T> supplier, final P data, final String version) {\n+        final T dto = supplier.get();\n+        dto.setUpdatedOn(Instant.now());\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param data The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P, T extends BaseDto<P>> T forRead(final Supplier<T> supplier, final P data, final Instant created, final Instant updated, final String version) {\n+        final T dto = supplier.get();\n+        dto.setCreationTime(created);\n+        dto.setUpdatedOn(updated);\n+        dto.setData(data);\n+        dto.setVersion(version);\n+\n+        return dto;\n+    }\n+\n+    /**\n+     * Gets the version of the document.\n+     *\n+     * @return The version of the document.\n+     */\n+    public final String getVersion() {\n+        return version;\n+    }\n+\n+    /**\n+     * Sets the version of the document.\n+     *\n+     * @param version The version of the document or {@code null} if not set.\n+     */\n+    protected final void setVersion(final String version) {\n+        this.version = version;\n+    }\n+\n+    /**\n+     * Gets the date and time of last modification.\n+     *\n+     * @return The date and time of last modification.\n+     */\n+    public final Instant getUpdatedOn() {\n+        return updatedOn;\n+    }\n+\n+    /**\n+     * Sets the date and time of last modification.\n+     *\n+     * @param updatedOn The date and time of last modification.\n+     */\n+    protected final void setUpdatedOn(final Instant updatedOn) {\n+        this.updatedOn = updatedOn;\n+    }\n+\n+    /**\n+     * Gets the date and time when the entity detailed by this status was created.\n+     *\n+     * @return The entity's creation time.\n+     */\n+    public Instant getCreationTime() {\n+        return creationTime;\n+    }\n+\n+    /**\n+     * Sets the date and time when the entity detailed by this status was created.\n+     *\n+     * @param creationTime The entity's creation time.\n+     */\n+    protected void setCreationTime(final Instant creationTime) {\n+        this.creationTime = creationTime;\n+    }\n+\n+    /**\n+     * Gets the data object (i.e. what should be editable by clients) of this DTO.\n+     * This method may be overridden by subclasses to set the JSON property name to a more meaningful one.\n+     *\n+     * @return The data object.\n+     */\n+    @JsonProperty(FIELD_DATA)\n+    public T getData() {\n+        return data;\n+    }\n+\n+    /**\n+     * Sets the data object of this DTO.\n+     *\n+     * @param data The data object.\n+     */\n+    protected void setData(final T data) {\n+        this.data = data;\n+    }\n+\n+    /**\n+     * Gets the name of the user who did the most recent modification.\n+     *\n+     * @return The user's name.\n+     */\n+    public String getLastUser() {\n+        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 205}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyODQxNQ==", "bodyText": "<p>", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511828415", "createdAt": "2020-10-26T09:39:32Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DeviceDto.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+import java.util.Objects;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.service.management.BaseDto;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A base class for a device DTO.\n+ */\n+public class DeviceDto extends BaseDto<Device> {\n+    @JsonProperty(value = RegistryManagementConstants.FIELD_PAYLOAD_TENANT_ID, required = true)\n+    private String tenantId;\n+\n+    @JsonProperty(value = RegistryManagementConstants.FIELD_PAYLOAD_DEVICE_ID, required = true)\n+    private String deviceId;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public DeviceDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P extends Device, T extends DeviceDto> T forCreation(final Supplier<T> supplier, final String tenantId, final String deviceId, final Device device, final String version) {\n+        final T deviceDto = BaseDto.forCreation(supplier,\n+                withoutStatus(device),\n+                version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @return A DTO instance for reading an entry.\n+     */\n+    public static DeviceDto forRead(final String tenantId, final String deviceId, final Device device,\n+                                    final Instant created, final Instant updated, final String version) {\n+        final DeviceDto deviceDto = BaseDto.forRead(DeviceDto::new, device, created, updated, version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P extends Device, T extends DeviceDto> T forUpdate(final Supplier<T> supplier, final String tenantId, final String deviceId, final Device device, final String version) {\n+        final T deviceDto = BaseDto.forUpdate(supplier, withoutStatus(device), version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Returns a new device without internal status.\n+     * <br><br>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyOTcxNA==", "bodyText": "required = true has no effect here, Jackson will only enforce this if used on an argument to a constructor/factory method ...", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511829714", "createdAt": "2020-10-26T09:41:37Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DeviceDto.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+import java.util.Objects;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.service.management.BaseDto;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A base class for a device DTO.\n+ */\n+public class DeviceDto extends BaseDto<Device> {\n+    @JsonProperty(value = RegistryManagementConstants.FIELD_PAYLOAD_TENANT_ID, required = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgzMDMxMQ==", "bodyText": "are the getters and setters supposed to be overridden?", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511830311", "createdAt": "2020-10-26T09:42:37Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DeviceDto.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *******************************************************************************/\n+package org.eclipse.hono.service.management.device;\n+\n+import java.time.Instant;\n+import java.util.Objects;\n+import java.util.function.Supplier;\n+\n+import org.eclipse.hono.service.management.BaseDto;\n+import org.eclipse.hono.util.RegistryManagementConstants;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+/**\n+ * A base class for a device DTO.\n+ */\n+public class DeviceDto extends BaseDto<Device> {\n+    @JsonProperty(value = RegistryManagementConstants.FIELD_PAYLOAD_TENANT_ID, required = true)\n+    private String tenantId;\n+\n+    @JsonProperty(value = RegistryManagementConstants.FIELD_PAYLOAD_DEVICE_ID, required = true)\n+    private String deviceId;\n+\n+    /**\n+     * Default constructor for serialisation/deserialization.\n+     */\n+    public DeviceDto() {\n+        // Explicit default constructor.\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>creation of a new</b> persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for creating a new entry.\n+     */\n+    public static <P extends Device, T extends DeviceDto> T forCreation(final Supplier<T> supplier, final String tenantId, final String deviceId, final Device device, final String version) {\n+        final T deviceDto = BaseDto.forCreation(supplier,\n+                withoutStatus(device),\n+                version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO to be returned by a read operation.\n+     *\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param created The instant when the object was created.\n+     * @param updated The instant of the most recent update.\n+     * @param version The version of the DTO\n+     *\n+     * @return A DTO instance for reading an entry.\n+     */\n+    public static DeviceDto forRead(final String tenantId, final String deviceId, final Device device,\n+                                    final Instant created, final Instant updated, final String version) {\n+        final DeviceDto deviceDto = BaseDto.forRead(DeviceDto::new, device, created, updated, version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Constructs a new DTO for use with the <b>updating</b> a persistent entry.\n+     *\n+     * @param supplier A DTO subclass' constructor of which a new instance shall be created.\n+     * @param tenantId The id of the tenant.\n+     * @param deviceId The id of the device.\n+     * @param device The data of the DTO.\n+     * @param version The version of the DTO\n+     *\n+     * @param <P> The type of the DTO's payload.\n+     * @param <T> The type of the DTO subclass.\n+     *\n+     * @return A DTO instance for updating an entry.\n+     */\n+    public static <P extends Device, T extends DeviceDto> T forUpdate(final Supplier<T> supplier, final String tenantId, final String deviceId, final Device device, final String version) {\n+        final T deviceDto = BaseDto.forUpdate(supplier, withoutStatus(device), version);\n+        deviceDto.setTenantId(tenantId);\n+        deviceDto.setDeviceId(deviceId);\n+\n+        return deviceDto;\n+    }\n+\n+    /**\n+     * Returns a new device without internal status.\n+     * <br><br>\n+     * The status should be null anyway, since it should not be deserialized in the given device value object.\n+     * Also it will be overwritten with the actual internal status when devices are retrieved.\n+     * Nevertheless this makes sure that status information will never be persisted.\n+     *\n+     * @param device The device which should be copied without status.\n+     *\n+     * @return The copied device.\n+     */\n+    protected static Device withoutStatus(final Device device) {\n+        return new Device(device).setStatus(null);\n+    }\n+\n+    /**\n+     * Gets the identifier of the tenant.\n+     *\n+     * @return The identifier of the tenant.\n+     */\n+    public String getTenantId() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgzMTE2MQ==", "bodyText": "testEncodeStatus", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511831161", "createdAt": "2020-10-26T09:44:05Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/test/java/org/eclipse/hono/service/management/device/DeviceTest.java", "diffHunk": "@@ -185,4 +185,30 @@ public void testEncodeMapper() {\n         assertThat(json).isNotNull();\n         assertThat(json.getString(\"mapper\")).isEqualTo(\"test\");\n     }\n+\n+    /**\n+     * Tests that the status property is serialized to JSON.\n+     */\n+    @Test\n+    public void testDecodeStatus() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgzMTQ2Mg==", "bodyText": "whenDecoding", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511831462", "createdAt": "2020-10-26T09:44:34Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-base/src/test/java/org/eclipse/hono/service/management/device/DeviceTest.java", "diffHunk": "@@ -185,4 +185,30 @@ public void testEncodeMapper() {\n         assertThat(json).isNotNull();\n         assertThat(json.getString(\"mapper\")).isEqualTo(\"test\");\n     }\n+\n+    /**\n+     * Tests that the status property is serialized to JSON.\n+     */\n+    @Test\n+    public void testDecodeStatus() {\n+        final var device = new Device();\n+        device.setStatus(new Status().setCreationTime(Instant.now()));\n+        final var json = JsonObject.mapFrom(device);\n+        assertThat(json).isNotNull();\n+        assertThat(json.getJsonObject(\"status\")).isNotNull();\n+        assertThat(json.getJsonObject(\"status\").getString(\"created\")).isNotEmpty();\n+    }\n+\n+    /**\n+     * Tests that the status property is ignored on deserialization, since it should not be editable by a user of the\n+     * device management API.\n+     */\n+    @Test\n+    public void testStatusIsIgnoredWhenEncoding() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg0MDI0Mg==", "bodyText": "looks like all of this is only needed if baseDto.getData() != null ....", "url": "https://github.com/eclipse/hono/pull/2189#discussion_r511840242", "createdAt": "2020-10-26T09:58:46Z", "author": {"login": "sophokles73"}, "path": "services/device-registry-mongodb/src/main/java/org/eclipse/hono/deviceregistry/mongodb/utils/MongoDbDocumentBuilder.java", "diffHunk": "@@ -56,6 +64,41 @@ public static MongoDbDocumentBuilder builder() {\n         return new MongoDbDocumentBuilder();\n     }\n \n+    /**\n+     * Creates a MongoDb update document for the update of the given DTO.\n+     *\n+     * @param baseDto The DTO for which an update should be generated.\n+     *\n+     * @return a reference to this for fluent use.\n+     */\n+    public MongoDbDocumentBuilder forUpdateOf(final BaseDto<?> baseDto) {\n+        final JsonObject updates = new JsonObject();\n+\n+        final JavaType baseDtoJavaType = OBJECT_MAPPER.getTypeFactory().constructType(baseDto.getClass());\n+        final BeanDescription beanDescription = OBJECT_MAPPER.getSerializationConfig().introspect(baseDtoJavaType);\n+        final AnnotatedMethod getDataMethod = beanDescription.findMethod(\"getData\", null);\n+        final JsonProperty jsonProperty = getDataMethod.getAnnotation(JsonProperty.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "859ed92f1cbd62c23f7c42c0fb9457b031a36c48"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "801022e974ff8fadcc3af42acaf07f9be207a87f", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/801022e974ff8fadcc3af42acaf07f9be207a87f", "committedDate": "2020-10-26T16:25:59Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1be622f59a99404a8bb92cf642b620c6fb68a21b", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/1be622f59a99404a8bb92cf642b620c6fb68a21b", "committedDate": "2020-10-26T16:26:06Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39fd7d21a1ca7c5799c6a48f645810fa6690b3ed", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/39fd7d21a1ca7c5799c6a48f645810fa6690b3ed", "committedDate": "2020-10-26T16:26:06Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da5c493881815e35dacf5d34fb46c39cc6e34444", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/da5c493881815e35dacf5d34fb46c39cc6e34444", "committedDate": "2020-10-26T16:30:55Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1e5abc020ec134a6bda7dd74c76d858f82240f21", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/1e5abc020ec134a6bda7dd74c76d858f82240f21", "committedDate": "2020-10-26T15:59:01Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}, "afterCommit": {"oid": "da5c493881815e35dacf5d34fb46c39cc6e34444", "author": {"user": {"login": "fkaltner", "name": "Florian Kaltner"}}, "url": "https://github.com/eclipse/hono/commit/da5c493881815e35dacf5d34fb46c39cc6e34444", "committedDate": "2020-10-26T16:30:55Z", "message": "[#1960] Implementing status property for device registrations.\n\nPutting the status property to work which now properly indicates when a device was created and updated.\n\nThis fixes #1960\n\nSigned-off-by: Florian Kaltner <florian.kaltner@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDE0Mjcy", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-517414272", "createdAt": "2020-10-27T07:37:36Z", "commit": {"oid": "da5c493881815e35dacf5d34fb46c39cc6e34444"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDQwNjQw", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-517440640", "createdAt": "2020-10-27T08:17:45Z", "commit": {"oid": "da5c493881815e35dacf5d34fb46c39cc6e34444"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDQ2NTQ1", "url": "https://github.com/eclipse/hono/pull/2189#pullrequestreview-517446545", "createdAt": "2020-10-27T08:25:50Z", "commit": {"oid": "da5c493881815e35dacf5d34fb46c39cc6e34444"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 580, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}