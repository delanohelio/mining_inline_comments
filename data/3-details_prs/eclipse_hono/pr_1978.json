{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNzk5NzYz", "number": 1978, "title": "Add regexp validations for tenant ID, device ID, credentials types and auth-ID.", "bodyText": "This is a proposal to fix #1956\nSigned-off-by: Jean-Baptiste Trystram jbtrystram@redhat.com", "createdAt": "2020-05-25T15:16:39Z", "url": "https://github.com/eclipse/hono/pull/1978", "merged": true, "mergeCommit": {"oid": "f2680c8b921f0d3a4156a5e8f0188610c5603c38"}, "closed": true, "closedAt": "2020-05-29T13:01:46Z", "author": {"login": "jbtrystram"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckxqyDABqjMzNzA2MTE0Nzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcl-J9EABqjMzODYxNjk1MjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d17fbfa2fc139bcffa19ed29e59cfb79b0de5dd5", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/d17fbfa2fc139bcffa19ed29e59cfb79b0de5dd5", "committedDate": "2020-05-25T14:29:48Z", "message": "initial implementation for regexp validations\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a882af252e1d1e65522c83437b1e84e6400bc631", "committedDate": "2020-05-25T15:17:40Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MjE5NTMy", "url": "https://github.com/eclipse/hono/pull/1978#pullrequestreview-418219532", "createdAt": "2020-05-26T11:48:53Z", "commit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMTo0ODo1M1rOGaapAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMTo0ODo1M1rOGaapAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MjY0MA==", "bodyText": "I think it would be better to do this check within span, so that we have a proper tracing/logging for the errors. Like it's done for the credentials endpoint.", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r430352640", "createdAt": "2020-05-26T11:48:53Z", "author": {"login": "dejanb"}, "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DelegatingDeviceManagementHttpEndpoint.java", "diffHunk": "@@ -93,21 +93,25 @@ public void addRoutes(final Router router) {\n \n         // CREATE device\n         router.post(pathWithTenantAndDeviceId)\n+                .handler(this::verifyDeviceId)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MjIwMTQ5", "url": "https://github.com/eclipse/hono/pull/1978#pullrequestreview-418220149", "createdAt": "2020-05-26T11:49:49Z", "commit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMTo0OTo0OVrOGaaq3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMTo0OTo0OVrOGaaq3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MzExOQ==", "bodyText": "Maybe you can define default regex at one place, like DEFAULT_ID_REGEX and reuse that value.", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r430353119", "createdAt": "2020-05-26T11:49:49Z", "author": {"login": "dejanb"}, "path": "core/src/main/java/org/eclipse/hono/util/CredentialsConstants.java", "diffHunk": "@@ -116,6 +116,14 @@\n      * The vert.x event bus address to which inbound credentials messages are published.\n      */\n     public static final String EVENT_BUS_ADDRESS_CREDENTIALS_IN = \"credentials.in\";\n+    /**\n+     * The regular expression to validate that the auth-id field supplied in credentials is legal.\n+     */\n+    public static final String AUTH_ID_VALUE_REGEX = \"^[a-z0-9-=]+$\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a882af252e1d1e65522c83437b1e84e6400bc631", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a882af252e1d1e65522c83437b1e84e6400bc631", "committedDate": "2020-05-25T15:17:40Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "committedDate": "2020-05-26T14:23:07Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "committedDate": "2020-05-26T14:23:07Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "d8168b04200b0ed5dac139b22be412f279538fed", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/d8168b04200b0ed5dac139b22be412f279538fed", "committedDate": "2020-05-26T14:24:43Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8168b04200b0ed5dac139b22be412f279538fed", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/d8168b04200b0ed5dac139b22be412f279538fed", "committedDate": "2020-05-26T14:24:43Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "54a0ac2ee92b4780784907eb519b78c3fc56e062", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/54a0ac2ee92b4780784907eb519b78c3fc56e062", "committedDate": "2020-05-27T11:35:04Z", "message": "do the regexp verification for ID in span and update samples values"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be276eb1958faaf6e3ac352ff9e59077d4243c4a", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/be276eb1958faaf6e3ac352ff9e59077d4243c4a", "committedDate": "2020-05-27T14:23:34Z", "message": "Revert \"some more changing DEFAULT_TENANT to lowercase\"\n\nThis reverts commit d9d6378f37b0a2b8ee5a260fb583dd7b1d3dc760."}, "afterCommit": {"oid": "6620699686511be361560805aacb7468f825afc8", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/6620699686511be361560805aacb7468f825afc8", "committedDate": "2020-05-27T14:32:10Z", "message": "Revert \"some more changing DEFAULT_TENANT to lowercase\"\n\nThis reverts commit d9d6378f37b0a2b8ee5a260fb583dd7b1d3dc760."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTMyNjY5", "url": "https://github.com/eclipse/hono/pull/1978#pullrequestreview-419932669", "createdAt": "2020-05-28T09:26:36Z", "commit": {"oid": "ba4c18ee3d1c5e3b2d0d18b1230fcc37cd32696e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwOToyNjozNlrOGbs_iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwOToyNjozNlrOGbs_iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcwMTg5OQ==", "bodyText": "We should update a default patterns for different identifiers and add some docs on the configuration.", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r431701899", "createdAt": "2020-05-28T09:26:36Z", "author": {"login": "dejanb"}, "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -810,8 +810,10 @@ components:\n          properties:\n             \"type\":\n                type: string\n+               pattern: [a-z0-9-]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba4c18ee3d1c5e3b2d0d18b1230fcc37cd32696e"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a2f04106996f46c3c66e2945c325b66287992112", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/a2f04106996f46c3c66e2945c325b66287992112", "committedDate": "2020-05-28T11:42:30Z", "message": "add configuration info in documentation\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "committedDate": "2020-05-28T11:46:48Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ce37d69f56168e69bc3478742bf8fba80a3f35a", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/3ce37d69f56168e69bc3478742bf8fba80a3f35a", "committedDate": "2020-05-29T08:26:09Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "committedDate": "2020-05-28T11:46:48Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}, "afterCommit": {"oid": "3ce37d69f56168e69bc3478742bf8fba80a3f35a", "author": {"user": {"login": "jbtrystram", "name": "Jean-Baptiste Trystram"}}, "url": "https://github.com/eclipse/hono/commit/3ce37d69f56168e69bc3478742bf8fba80a3f35a", "committedDate": "2020-05-29T08:26:09Z", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 630, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}