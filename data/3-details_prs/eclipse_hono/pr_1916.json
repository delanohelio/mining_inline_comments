{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MDM0NDI5", "number": 1916, "title": "[#1858] Use ttd as command consumer lifespan", "bodyText": "This is for #1858.", "createdAt": "2020-04-22T04:15:53Z", "url": "https://github.com/eclipse/hono/pull/1916", "merged": true, "mergeCommit": {"oid": "d99f19ed48b936c45a7a4f5c7afc9a42dda35248"}, "closed": true, "closedAt": "2020-04-23T14:48:41Z", "author": {"login": "calohmn"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaIC2aAFqTM5ODE3MTU2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcabVm0gFqTM5OTAxMzQ1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MTcxNTY4", "url": "https://github.com/eclipse/hono/pull/1916#pullrequestreview-398171568", "createdAt": "2020-04-22T13:08:41Z", "commit": {"oid": "27fca7377d904b20bade1ec6c3422965a9a7ac60"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzowODo0MVrOGJ1eGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzoxMDoxM1rOGJ1ijA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk2NjQyNQ==", "bodyText": "I would prefer the use of Duration rather then int, which prevents any confusion around the unit.", "url": "https://github.com/eclipse/hono/pull/1916#discussion_r412966425", "createdAt": "2020-04-22T13:08:41Z", "author": {"login": "ctron"}, "path": "client/src/main/java/org/eclipse/hono/client/ProtocolAdapterCommandConsumerFactory.java", "diffHunk": "@@ -83,6 +85,7 @@ void initialize(CommandTargetMapper commandTargetMapper,\n             String tenantId,\n             String deviceId,\n             Handler<CommandContext> commandHandler,\n+            int lifespanSeconds,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27fca7377d904b20bade1ec6c3422965a9a7ac60"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk2NjUwNQ==", "bodyText": "Same here.", "url": "https://github.com/eclipse/hono/pull/1916#discussion_r412966505", "createdAt": "2020-04-22T13:08:48Z", "author": {"login": "ctron"}, "path": "client/src/main/java/org/eclipse/hono/client/ProtocolAdapterCommandConsumerFactory.java", "diffHunk": "@@ -121,6 +126,7 @@ void initialize(CommandTargetMapper commandTargetMapper,\n             String deviceId,\n             String gatewayId,\n             Handler<CommandContext> commandHandler,\n+            int lifespanSeconds,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27fca7377d904b20bade1ec6c3422965a9a7ac60"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk2NzU2NA==", "bodyText": "If the parameter is optional, then maybe consider using Optional. Or maybe null when using Duration (see other comments on \"int\").", "url": "https://github.com/eclipse/hono/pull/1916#discussion_r412967564", "createdAt": "2020-04-22T13:10:13Z", "author": {"login": "ctron"}, "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/VertxBasedAmqpProtocolAdapter.java", "diffHunk": "@@ -864,10 +864,10 @@ private Span newSpan(final String operationName, final Device authenticatedDevic\n         if (authenticatedDevice != null && !authenticatedDevice.getDeviceId().equals(sourceAddress.getResourceId())) {\n             // gateway scenario\n             return getCommandConsumerFactory().createCommandConsumer(sourceAddress.getTenantId(),\n-                    sourceAddress.getResourceId(), authenticatedDevice.getDeviceId(), commandHandler, span.context());\n+                    sourceAddress.getResourceId(), authenticatedDevice.getDeviceId(), commandHandler, -1, span.context());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27fca7377d904b20bade1ec6c3422965a9a7ac60"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "27fca7377d904b20bade1ec6c3422965a9a7ac60", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/27fca7377d904b20bade1ec6c3422965a9a7ac60", "committedDate": "2020-04-22T04:11:56Z", "message": "[#1858] Use ttd as command consumer lifespan.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "036decd592b80dc161d294c926b5722f2eaf08f4", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/036decd592b80dc161d294c926b5722f2eaf08f4", "committedDate": "2020-04-23T09:37:34Z", "message": "[#1858] Use ttd value as command consumer lifespan.\n\nAlso change the type of the lifespan parameter\nfrom int to Duration in the methods of the\nDeviceConnectionInfo, DeviceConnectionClient and\nDeviceConnectionService interfaces.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb317829bcc34bf3ad9ea63d511d79af6e346150", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/cb317829bcc34bf3ad9ea63d511d79af6e346150", "committedDate": "2020-04-23T10:42:53Z", "message": "[#1858] Use ttd value as command consumer lifespan.\n\nAlso change the type of the lifespan parameter\nfrom int to Duration in the methods of the\nDeviceConnectionInfo, DeviceConnectionClient and\nDeviceConnectionService interfaces.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "036decd592b80dc161d294c926b5722f2eaf08f4", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/036decd592b80dc161d294c926b5722f2eaf08f4", "committedDate": "2020-04-23T09:37:34Z", "message": "[#1858] Use ttd value as command consumer lifespan.\n\nAlso change the type of the lifespan parameter\nfrom int to Duration in the methods of the\nDeviceConnectionInfo, DeviceConnectionClient and\nDeviceConnectionService interfaces.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}, "afterCommit": {"oid": "cb317829bcc34bf3ad9ea63d511d79af6e346150", "author": {"user": {"login": "calohmn", "name": "Carsten Lohmann"}}, "url": "https://github.com/eclipse/hono/commit/cb317829bcc34bf3ad9ea63d511d79af6e346150", "committedDate": "2020-04-23T10:42:53Z", "message": "[#1858] Use ttd value as command consumer lifespan.\n\nAlso change the type of the lifespan parameter\nfrom int to Duration in the methods of the\nDeviceConnectionInfo, DeviceConnectionClient and\nDeviceConnectionService interfaces.\n\nSigned-off-by: Carsten Lohmann <carsten.lohmann@bosch.io>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MDEzNDU0", "url": "https://github.com/eclipse/hono/pull/1916#pullrequestreview-399013454", "createdAt": "2020-04-23T11:39:09Z", "commit": {"oid": "cb317829bcc34bf3ad9ea63d511d79af6e346150"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 881, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}