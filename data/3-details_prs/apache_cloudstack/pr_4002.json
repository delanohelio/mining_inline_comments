{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1OTAyNjEy", "number": 4002, "title": "server: Search zone-wide storage pool when allocation algothrim is firstfitleastconsumed", "bodyText": "Description\n\nWhen vm.allocation.algorithm is set to 'firstfitleastconsumed', we are unable to create vm or volume if all storage pools are zone-wide (which have cluster_id=NULL)\n\n\n\n\n\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nScreenshots (if appropriate):\nHow Has This Been Tested?\n\n\n\n\ncreate zone with zone-wide storage pool\ndeploy vm successfully.", "createdAt": "2020-03-30T21:06:06Z", "url": "https://github.com/apache/cloudstack/pull/4002", "merged": true, "mergeCommit": {"oid": "6bf92fb13620b56a1d644840a42cd2590a4f4131"}, "closed": true, "closedAt": "2020-04-06T20:01:41Z", "author": {"login": "ustcweizhou"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS0_JEgH2gAyMzk1OTAyNjEyOjA4OTgzNWI2NzMwNmRjOGZhMDlkMzFjZDFmZjk4NjgwY2FkODAxOWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVDe_-AFqTM4ODUzNDQzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "089835b67306dc8fa09d31cd1ff98680cad8019f", "author": {"user": {"login": "ustcweizhou", "name": "Wei Zhou"}}, "url": "https://github.com/apache/cloudstack/commit/089835b67306dc8fa09d31cd1ff98680cad8019f", "committedDate": "2020-03-30T21:00:45Z", "message": "server: Search zone-wide storage pool when allocation algothrim is firstfitleastconsumed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTM5ODkz", "url": "https://github.com/apache/cloudstack/pull/4002#pullrequestreview-387539893", "createdAt": "2020-04-03T19:53:51Z", "commit": {"oid": "089835b67306dc8fa09d31cd1ff98680cad8019f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MDA0NTU3", "url": "https://github.com/apache/cloudstack/pull/4002#pullrequestreview-388004557", "createdAt": "2020-04-06T07:46:42Z", "commit": {"oid": "089835b67306dc8fa09d31cd1ff98680cad8019f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNzo0Njo0MlrOGBLgog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNzo0Njo0MlrOGBLgog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg5MDMzOA==", "bodyText": "@weizhouapache wouldn't a cluster imply a zone? we wouldn't have to pass a zone if we already know the cluster.", "url": "https://github.com/apache/cloudstack/pull/4002#discussion_r403890338", "createdAt": "2020-04-06T07:46:42Z", "author": {"login": "DaanHoogland"}, "path": "engine/schema/src/main/java/com/cloud/capacity/dao/CapacityDaoImpl.java", "diffHunk": "@@ -903,20 +903,28 @@ public boolean removeBy(Short capacityType, Long zoneId, Long podId, Long cluste\n     }\n \n     @Override\n-    public List<Long> orderHostsByFreeCapacity(Long clusterId, short capacityTypeForOrdering){\n+    public List<Long> orderHostsByFreeCapacity(Long zoneId, Long clusterId, short capacityTypeForOrdering){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "089835b67306dc8fa09d31cd1ff98680cad8019f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTM0NDM0", "url": "https://github.com/apache/cloudstack/pull/4002#pullrequestreview-388534434", "createdAt": "2020-04-06T19:02:04Z", "commit": {"oid": "089835b67306dc8fa09d31cd1ff98680cad8019f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4159, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}