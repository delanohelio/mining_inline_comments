{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjYwOTkx", "number": 4048, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowNzozMlrOD3gF-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNjo0OTozN1rOD3trWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NTI0MDg4OnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowNzozMlrOGNyOLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNjowNDoyNlrOGOGDtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEwNzUwMg==", "bodyText": "could you put only this vland_mode and tag in the if-block and the rest around it. The other parts of the string do not depend on the condition and there is nothing that should go in the else-block.", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417107502", "createdAt": "2020-04-29T07:07:32Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,9 +70,15 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n+        \n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n+                    \"vlan_mode=access tag=%s \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e44f406037e58cd5e2e58395db247e07fabe7935"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQzMjUwMg==", "bodyText": "updated", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417432502", "createdAt": "2020-04-29T16:04:26Z", "author": {"login": "mbrashearnttglobalnet"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,9 +70,15 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n+        \n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n+                    \"vlan_mode=access tag=%s \" +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEwNzUwMg=="}, "originalCommit": {"oid": "e44f406037e58cd5e2e58395db247e07fabe7935"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NzQ2NjUxOnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNjo0OTozN1rOGOH4mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxODo1MjoyNVrOGOMfTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ2MjQyNQ==", "bodyText": "Packages failing with:\n[ERROR] /jenkins/workspace/acs-pr-centos7-pkg-builder/dist/rpmbuild/BUILD/cloudstack-4.14.0.0-SNAPSHOT/plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java:78: Line has trailing spaces. [RegexpSingleline]\n\n@mbrashearnttglobalnet can you refactor this line space as a linux carriage?", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417462425", "createdAt": "2020-04-29T16:49:37Z", "author": {"login": "nvazquez"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,10 +70,12 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n-\n+        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \", bridgeName, port));\n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"vlan_mode=access tag=%s \", vlan));\n+        }\n+        stringBuilder.append(String.format(\"-- set Interface %s type=%s\", port, type));\n+        ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUzNzg2OA==", "bodyText": "removed the white spaces on the blank line.", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417537868", "createdAt": "2020-04-29T18:52:25Z", "author": {"login": "mbrashearnttglobalnet"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,10 +70,12 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n-\n+        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \", bridgeName, port));\n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"vlan_mode=access tag=%s \", vlan));\n+        }\n+        stringBuilder.append(String.format(\"-- set Interface %s type=%s\", port, type));\n+        ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ2MjQyNQ=="}, "originalCommit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3879, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}