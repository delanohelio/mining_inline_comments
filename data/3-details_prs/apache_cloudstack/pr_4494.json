{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1NjIzNDc5", "number": 4494, "title": "sql: Fix Zones are returned in a random order (#3934)", "bodyText": "Description\nThis PR updates sort_key to id if sort_key of all zones are 0 (including removed zones, which means sort_key is not set by customers), so zones will be ordered by id in listZones response.\nFixes: #3934\n\n\n\n\n\n\n\n\n\n\nTypes of changes\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nFeature/Enhancement Scale or Bug Severity\nFeature/Enhancement Scale\n\n Major\n Minor\n\nBug Severity\n\n BLOCKER\n Critical\n Major\n Minor\n Trivial\n\nScreenshots (if appropriate):\nHow Has This Been Tested?", "createdAt": "2020-11-23T10:26:19Z", "url": "https://github.com/apache/cloudstack/pull/4494", "merged": true, "mergeCommit": {"oid": "4fb69e695c1f01afc116db788f0f44fbf4707464"}, "closed": true, "closedAt": "2020-11-25T10:00:44Z", "author": {"login": "ustcweizhou"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdemt6JAH2gAyNTI1NjIzNDc5OjZhZTZkMmI3M2ZlMDEwYTI5MzZmZGQ4MDJjY2ZiOWEzNmU4MjM5MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdf7Y8gAFqTUzODMzMTU4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924", "author": {"user": {"login": "ustcweizhou", "name": "Wei Zhou"}}, "url": "https://github.com/apache/cloudstack/commit/6ae6d2b73fe010a2936fdd802ccfb9a36e823924", "committedDate": "2020-11-21T07:21:30Z", "message": "sql: Fix Zones are returned in a random order (#3934)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MzU3NTUw", "url": "https://github.com/apache/cloudstack/pull/4494#pullrequestreview-536357550", "createdAt": "2020-11-23T10:50:05Z", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MzY5MzI5", "url": "https://github.com/apache/cloudstack/pull/4494#pullrequestreview-536369329", "createdAt": "2020-11-23T11:06:20Z", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxMTowNjoyMFrOH4IpyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxMTowNjoyMFrOH4IpyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODYyNDA3Mg==", "bodyText": "excuse my ignorance. why not just\nUPDATE `cloud`.`data_center` SET `sort_key` = `id` WHERE `sort_key` = 0;\n\nthis seems like it going to work as well, but i'm missing the point, i guess. at worst the first in the sortorder has to be put back at the fron, but this should be a onetime effort.", "url": "https://github.com/apache/cloudstack/pull/4494#discussion_r528624072", "createdAt": "2020-11-23T11:06:20Z", "author": {"login": "DaanHoogland"}, "path": "engine/schema/src/main/resources/META-INF/db/schema-41400to41500.sql", "diffHunk": "@@ -837,3 +837,6 @@ UPDATE `cloud`.`guest_os` SET category_id = 7 WHERE id = 275 AND display_name =\n -- Add flag 'hidden' in tables usage_ip_address and cloud_usage\n ALTER TABLE `cloud_usage`.`usage_ip_address` ADD COLUMN `is_hidden` smallint(1) NOT NULL DEFAULT '0' COMMENT 'is usage hidden';\n ALTER TABLE `cloud_usage`.`cloud_usage` ADD COLUMN `is_hidden` smallint(1) NOT NULL DEFAULT '0' COMMENT 'is usage hidden';\n+\n+-- Fix Zones are returned in a random order (#3934)\n+UPDATE `cloud`.`data_center` JOIN (SELECT COUNT(1) AS count FROM `cloud`.`data_center` WHERE `sort_key` != 0) AS tbl_tmp SET `sort_key` = `id` WHERE count = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NTM3NzEx", "url": "https://github.com/apache/cloudstack/pull/4494#pullrequestreview-536537711", "createdAt": "2020-11-23T14:44:05Z", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MTU4ODAz", "url": "https://github.com/apache/cloudstack/pull/4494#pullrequestreview-538158803", "createdAt": "2020-11-25T05:02:30Z", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MzMxNTg4", "url": "https://github.com/apache/cloudstack/pull/4494#pullrequestreview-538331588", "createdAt": "2020-11-25T10:00:33Z", "commit": {"oid": "6ae6d2b73fe010a2936fdd802ccfb9a36e823924"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4825, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}