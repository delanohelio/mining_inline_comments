{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MzI5MTcx", "number": 4377, "title": "server: fix issue that vm guest os type is reset after updatetemplate", "bodyText": "Description\n\nSteps to reproduce the issue\n(1) change vm guest os type\n(2) update vm template (guest os type is not changed)\n(3) vm guest os type is reset to guest os type of template.\n\n\n\n\n\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nScreenshots (if appropriate):\nHow Has This Been Tested?", "createdAt": "2020-10-06T07:24:00Z", "url": "https://github.com/apache/cloudstack/pull/4377", "merged": true, "mergeCommit": {"oid": "f7a3701c7a2fc49ccd2105e600b01cb985fb8127"}, "closed": true, "closedAt": "2020-10-15T17:55:00Z", "author": {"login": "ustcweizhou"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPy717gH2gAyNDk4MzI5MTcxOmMxOTc1NDY5Nzc1OGIyZmI1Yjk3NzA0MmFjNjIzZTZjZGZjZDQwZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSxv_FAFqTUwOTM3NTU2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c19754697758b2fb5b977042ac623e6cdfcd40e3", "author": {"user": {"login": "ustcweizhou", "name": "Wei Zhou"}}, "url": "https://github.com/apache/cloudstack/commit/c19754697758b2fb5b977042ac623e6cdfcd40e3", "committedDate": "2020-10-06T07:06:43Z", "message": "server: fix issue that vm guest os type is reset after updatetemplate\n\nSteps to reproduce the issue\n(1) change vm guest os type\n(2) update vm template (guest os type is not changed)\n(3) vm guest os type is reset to guest os type of template."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyODM0NDYz", "url": "https://github.com/apache/cloudstack/pull/4377#pullrequestreview-502834463", "createdAt": "2020-10-06T11:20:53Z", "commit": {"oid": "c19754697758b2fb5b977042ac623e6cdfcd40e3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzQyNzEw", "url": "https://github.com/apache/cloudstack/pull/4377#pullrequestreview-509342710", "createdAt": "2020-10-15T12:51:51Z", "commit": {"oid": "c19754697758b2fb5b977042ac623e6cdfcd40e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjo1MTo1MVrOHiGNRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjo1MTo1MVrOHiGNRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUxNTMzMg==", "bodyText": "moving before this line L#2096 template = _tmpltDao.createForUpdate(id); should be ok?", "url": "https://github.com/apache/cloudstack/pull/4377#discussion_r505515332", "createdAt": "2020-10-15T12:51:51Z", "author": {"login": "sureshanaparti"}, "path": "server/src/main/java/com/cloud/template/TemplateManagerImpl.java", "diffHunk": "@@ -2063,6 +2063,7 @@ private VMTemplateVO updateTemplateOrIso(BaseUpdateTemplateOrIsoCmd cmd) {\n             ex.addProxyObject(String.valueOf(id), \"templateId\");\n             throw ex;\n         }\n+        long oldGuestOSId = template.getGuestOSId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c19754697758b2fb5b977042ac623e6cdfcd40e3"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mzc1NTY3", "url": "https://github.com/apache/cloudstack/pull/4377#pullrequestreview-509375567", "createdAt": "2020-10-15T13:25:38Z", "commit": {"oid": "c19754697758b2fb5b977042ac623e6cdfcd40e3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4958, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}