{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjYwOTkx", "number": 4048, "title": "Update DpdkDriverImpl.java to support DPDK trunk interfaces", "bodyText": "Update to support trunk interfaces for DPDK enabled hosts.\nDescription\n\n\n\n\n\n\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nScreenshots (if appropriate):\nHow Has This Been Tested?", "createdAt": "2020-04-28T17:34:10Z", "url": "https://github.com/apache/cloudstack/pull/4048", "merged": true, "mergeCommit": {"oid": "9727548dbc2103f7728ec601bfe0fa3d17ef136c"}, "closed": true, "closedAt": "2020-06-12T04:47:37Z", "author": {"login": "mbrashearnttglobalnet"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb28CIgH2gAyNDEwMjYwOTkxOjJlODVlMGY3OTMzMTk5YmRkOGE5YTZlNDFiZDU5OThhNTZlYmQzZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpOWkdAFqTQyNjEyMTQ3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e85e0f7933199bdd8a9a6e41bd5998a56ebd3d8", "author": {"user": {"login": "mbrashearnttglobalnet", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/2e85e0f7933199bdd8a9a6e41bd5998a56ebd3d8", "committedDate": "2020-04-27T22:22:29Z", "message": "Update DpdkDriverImpl.java\n\nUpdate to support trunk interfaces for DPDK enabled hosts."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e44f406037e58cd5e2e58395db247e07fabe7935", "author": {"user": {"login": "mbrashearnttglobalnet", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/e44f406037e58cd5e2e58395db247e07fabe7935", "committedDate": "2020-04-28T22:39:35Z", "message": "Update DpdkDriverImpl.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNDA5NDg3", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-402409487", "createdAt": "2020-04-29T07:07:32Z", "commit": {"oid": "e44f406037e58cd5e2e58395db247e07fabe7935"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowNzozMlrOGNyOLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowNzozMlrOGNyOLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEwNzUwMg==", "bodyText": "could you put only this vland_mode and tag in the if-block and the rest around it. The other parts of the string do not depend on the condition and there is nothing that should go in the else-block.", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417107502", "createdAt": "2020-04-29T07:07:32Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,9 +70,15 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n+        \n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n+                    \"vlan_mode=access tag=%s \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e44f406037e58cd5e2e58395db247e07fabe7935"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67", "author": {"user": {"login": "mbrashearnttglobalnet", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/b3303594e8e15cd7840b92165b42d1ec3e942a67", "committedDate": "2020-04-29T16:03:34Z", "message": "Update DpdkDriverImpl.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyODMzNDQ4", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-402833448", "createdAt": "2020-04-29T16:24:16Z", "commit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyODUzODY4", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-402853868", "createdAt": "2020-04-29T16:49:37Z", "commit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNjo0OTozN1rOGOH4mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNjo0OTozN1rOGOH4mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ2MjQyNQ==", "bodyText": "Packages failing with:\n[ERROR] /jenkins/workspace/acs-pr-centos7-pkg-builder/dist/rpmbuild/BUILD/cloudstack-4.14.0.0-SNAPSHOT/plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java:78: Line has trailing spaces. [RegexpSingleline]\n\n@mbrashearnttglobalnet can you refactor this line space as a linux carriage?", "url": "https://github.com/apache/cloudstack/pull/4048#discussion_r417462425", "createdAt": "2020-04-29T16:49:37Z", "author": {"login": "nvazquez"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/dpdk/DpdkDriverImpl.java", "diffHunk": "@@ -70,10 +70,12 @@ public void addDpdkPort(String bridgeName, String port, String vlan, DpdkHelper.\n                 dpdkPortVhostUserClientType;\n \n         StringBuilder stringBuilder = new StringBuilder();\n-        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \" +\n-                \"vlan_mode=access tag=%s \" +\n-                \"-- set Interface %s type=%s\", bridgeName, port, vlan, port, type));\n-\n+        stringBuilder.append(String.format(\"ovs-vsctl add-port %s %s \", bridgeName, port));\n+        if (Integer.parseInt(vlan) > 0 && Integer.parseInt(vlan) < 4095) {\n+            stringBuilder.append(String.format(\"vlan_mode=access tag=%s \", vlan));\n+        }\n+        stringBuilder.append(String.format(\"-- set Interface %s type=%s\", port, type));\n+        ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3303594e8e15cd7840b92165b42d1ec3e942a67"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df2e06c9a60b54d977e48e95f93dcfe91e5082b9", "author": {"user": {"login": "mbrashearnttglobalnet", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/df2e06c9a60b54d977e48e95f93dcfe91e5082b9", "committedDate": "2020-04-29T18:50:30Z", "message": "Update DpdkDriverImpl.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDU3MDE1", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-424057015", "createdAt": "2020-06-04T02:20:35Z", "commit": {"oid": "df2e06c9a60b54d977e48e95f93dcfe91e5082b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1OTk2ODIz", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-425996823", "createdAt": "2020-06-08T08:04:30Z", "commit": {"oid": "df2e06c9a60b54d977e48e95f93dcfe91e5082b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTIxNDc3", "url": "https://github.com/apache/cloudstack/pull/4048#pullrequestreview-426121477", "createdAt": "2020-06-08T11:00:18Z", "commit": {"oid": "df2e06c9a60b54d977e48e95f93dcfe91e5082b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4235, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}