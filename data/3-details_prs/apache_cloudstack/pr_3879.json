{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNTczODY5", "number": 3879, "title": "kvm: Enable virtio drivers based on guest os display name", "bodyText": "Description\n\nWhen we add new guest os, sometimes we missed the records in guest_os_hypervisor.\nHowever, the guest disk model (virtio/ide) is determined by record in the table.\nIt causes the issue that some new guest os(eg Debian 8/9) uses e1000 instead of virtio nic, and ide disk instead of virtio disk.\nTo fix the issue permanantly, pass the guest os name in guest_os if the record for kvm is not found in guest_os_hypervisor.\nRelated commit:7ac9f00eeeb4cd37ec39efeba066e799b581b1a0\n\n\n\n\n\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nScreenshots (if appropriate):\nHow Has This Been Tested?", "createdAt": "2020-02-11T10:19:52Z", "url": "https://github.com/apache/cloudstack/pull/3879", "merged": true, "mergeCommit": {"oid": "37d2b8537c454cdafdaf240dba37a4e1767afe2e"}, "closed": true, "closedAt": "2020-02-19T07:42:20Z", "author": {"login": "ustcweizhou"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDO59bAH2gAyMzczNTczODY5OjdlYTBlOTA4ZTRlM2QyYThmNmE3NmU3Njg1MGE0NzEyNjdhMTBkYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFxjpJgFqTM2MDg5MzY1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ea0e908e4e3d2a8f6a76e76850a471267a10dc5", "author": {"user": {"login": "ustcweizhou", "name": "Wei Zhou"}}, "url": "https://github.com/apache/cloudstack/commit/7ea0e908e4e3d2a8f6a76e76850a471267a10dc5", "committedDate": "2020-02-11T10:09:50Z", "message": "kvm: Enable virtio drivers based on guest os display name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NzM0Njg2", "url": "https://github.com/apache/cloudstack/pull/3879#pullrequestreview-358734686", "createdAt": "2020-02-14T06:31:09Z", "commit": {"oid": "7ea0e908e4e3d2a8f6a76e76850a471267a10dc5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjozMTowOVrOFpsvrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjozMTowOVrOFpsvrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2OTAzNg==", "bodyText": "@ustcweizhou how about we check and fallback to \"Other\" in case guestOS.getDisplayName() is null or empty (unlikely but just to make code more defensive)?", "url": "https://github.com/apache/cloudstack/pull/3879#discussion_r379269036", "createdAt": "2020-02-14T06:31:09Z", "author": {"login": "rhtyd"}, "path": "server/src/main/java/com/cloud/hypervisor/KVMGuru.java", "diffHunk": "@@ -132,7 +132,7 @@ public VirtualMachineTO implement(VirtualMachineProfile vm) {\n             guestOsMapping = _guestOsHypervisorDao.findByOsIdAndHypervisor(guestOS.getId(), getHypervisorType().toString(), host.getHypervisorVersion());\n         }\n         if (guestOsMapping == null || host == null) {\n-            to.setPlatformEmulator(\"Other\");\n+            to.setPlatformEmulator(guestOS.getDisplayName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ea0e908e4e3d2a8f6a76e76850a471267a10dc5"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NzM0OTQw", "url": "https://github.com/apache/cloudstack/pull/3879#pullrequestreview-358734940", "createdAt": "2020-02-14T06:32:04Z", "commit": {"oid": "7ea0e908e4e3d2a8f6a76e76850a471267a10dc5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6fae5afbc6d147da81d6f186c5744b6110a520b", "author": {"user": {"login": "DaanHoogland", "name": "dahn"}}, "url": "https://github.com/apache/cloudstack/commit/d6fae5afbc6d147da81d6f186c5744b6110a520b", "committedDate": "2020-02-14T15:24:43Z", "message": "fall back if null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d69839e6b20ccf056e13b291df286c934bbc7f8", "author": {"user": {"login": "ustcweizhou", "name": "Wei Zhou"}}, "url": "https://github.com/apache/cloudstack/commit/8d69839e6b20ccf056e13b291df286c934bbc7f8", "committedDate": "2020-02-14T16:57:01Z", "message": "use Other instead unknown"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwODkzNjU4", "url": "https://github.com/apache/cloudstack/pull/3879#pullrequestreview-360893658", "createdAt": "2020-02-19T07:39:59Z", "commit": {"oid": "8d69839e6b20ccf056e13b291df286c934bbc7f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4397, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}