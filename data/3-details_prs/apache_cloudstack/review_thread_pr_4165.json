{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MTQ4NzQ3", "number": 4165, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMDowNTowOVrOEHtidA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxOTozNjoyNFrOEPRntQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTIxNTg4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/cloud/resource/RollingMaintenanceManagerImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMDowNTowOVrOGnPHPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMToyOTo1OFrOGoOI0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5NTI2MA==", "bodyText": "@nvazquez can you please take a look at it?\nI changed API parameter handling from separate parameters on the method call to an object of UpdateClusterCmd class. Therefore, I needed to change this tiny piece of RollingMaintenanceManagerImpl.", "url": "https://github.com/apache/cloudstack/pull/4165#discussion_r443795260", "createdAt": "2020-06-22T20:05:09Z", "author": {"login": "GabrielBrascher"}, "path": "server/src/main/java/com/cloud/resource/RollingMaintenanceManagerImpl.java", "diffHunk": "@@ -114,12 +115,15 @@ public boolean configure(String name, Map<String, Object> params) throws Configu\n         return true;\n     }\n \n-    private void updateCluster(long clusterId, String state) {\n+    private void updateCluster(long clusterId, String allocationState) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38e69e5afa11ba9a4d383e97609073b5ab1876d7"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNzg1Nw==", "bodyText": "Thanks @GabrielBrascher, looks good to me. The change needed in RollingMaintenanceManagerImpl will be just the same as you've done below", "url": "https://github.com/apache/cloudstack/pull/4165#discussion_r444827857", "createdAt": "2020-06-24T11:29:58Z", "author": {"login": "nvazquez"}, "path": "server/src/main/java/com/cloud/resource/RollingMaintenanceManagerImpl.java", "diffHunk": "@@ -114,12 +115,15 @@ public boolean configure(String name, Map<String, Object> params) throws Configu\n         return true;\n     }\n \n-    private void updateCluster(long clusterId, String state) {\n+    private void updateCluster(long clusterId, String allocationState) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5NTI2MA=="}, "originalCommit": {"oid": "38e69e5afa11ba9a4d383e97609073b5ab1876d7"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDUyNzg5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/cloud/resource/ResourceManagerImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxOTozNjoyNFrOGy5waw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxOTozNjoyNFrOGy5waw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjAyODI2Nw==", "bodyText": "@rhtyd considering your concerns with issues caused by renaming VMware clusters I added this line.", "url": "https://github.com/apache/cloudstack/pull/4165#discussion_r456028267", "createdAt": "2020-07-16T19:36:24Z", "author": {"login": "GabrielBrascher"}, "path": "server/src/main/java/com/cloud/resource/ResourceManagerImpl.java", "diffHunk": "@@ -1026,12 +1027,26 @@ public void doInTransactionWithoutResult(final TransactionStatus status) {\n \n     @Override\n     @DB\n-    public Cluster updateCluster(final Cluster clusterToUpdate, final String clusterType, final String hypervisor, final String allocationState, final String managedstate) {\n+    public Cluster updateCluster(UpdateClusterCmd cmd) {\n+        ClusterVO cluster = (ClusterVO) getCluster(cmd.getId());\n+        String clusterType = cmd.getClusterType();\n+        String hypervisor = cmd.getHypervisor();\n+        String allocationState = cmd.getAllocationState();\n+        String managedstate = cmd.getManagedstate();\n+        String name = cmd.getClusterName();\n \n-        final ClusterVO cluster = (ClusterVO)clusterToUpdate;\n         // Verify cluster information and update the cluster if needed\n         boolean doUpdate = false;\n \n+        if (org.apache.commons.lang.StringUtils.isNotBlank(name)) {\n+            if(cluster.getHypervisorType() == HypervisorType.VMware) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9176e290e296ced915e831dc403f5971948aa701"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3712, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}