{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4OTk1Mzgy", "number": 4459, "title": "createkubertetesbinariesiso: Saving images in network and dashboard yaml", "bodyText": "Description\nDownloads images int the network and dashboard yaml while creating the kubernetes binaries iso\nThis step was skipped, so bringing up a cluster on a node that does not have access to the internet failed since the weavenet and dashboard images were not found locally\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nHow Has This Been Tested?\n./create-kubernetes-binaries-iso.sh ./ 1.11.4 0.7.1 1.11.1 https://github.com/weaveworks/weave/releases/download/latest_release/weave-daemonset-k8s-1.11.yaml https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.0/src/deploy/recommended/kubernetes-dashboard.yaml\n..........\nDownloading docker image k8s.gcr.io/kube-apiserver-amd64:v1.11.4 ---\nDownloading docker image k8s.gcr.io/kube-controller-manager-amd64:v1.11.4 ---\nDownloading docker image k8s.gcr.io/kube-scheduler-amd64:v1.11.4 ---\nDownloading docker image k8s.gcr.io/kube-proxy-amd64:v1.11.4 ---\nDownloading docker image k8s.gcr.io/pause:3.1 ---\nDownloading docker image k8s.gcr.io/etcd-amd64:3.2.18 ---\nDownloading docker image k8s.gcr.io/coredns:1.1.3 ---\nDownloading docker image weaveworks/weave-kube:2.7.0 ---                       << Added image from network yaml\nDownloading docker image weaveworks/weave-npc:2.7.0 ---                        << Added image from network yaml\nDownloading docker image k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.0 ---     << Added image from dashboard yaml", "createdAt": "2020-11-11T06:57:48Z", "url": "https://github.com/apache/cloudstack/pull/4459", "merged": true, "mergeCommit": {"oid": "1398dfff65df5251cf378ae9f752fbe04787c4a0"}, "closed": true, "closedAt": "2020-11-20T08:19:26Z", "author": {"login": "davidjumani"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbYYpbABqjM5ODI0MjQ4NDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdd8bgLgFqTUzNDEwNDk1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "609590671496d0b70b01f20ee1e9d3ad8678eb12", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/609590671496d0b70b01f20ee1e9d3ad8678eb12", "committedDate": "2020-11-11T06:51:47Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "453615bfc1474d130a7b253108ac817cf9223c8a", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/453615bfc1474d130a7b253108ac817cf9223c8a", "committedDate": "2020-11-11T06:57:40Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "453615bfc1474d130a7b253108ac817cf9223c8a", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/453615bfc1474d130a7b253108ac817cf9223c8a", "committedDate": "2020-11-11T06:57:40Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "208ad442cf80eca0cac9a2fed75a4369fdc05fbe", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/208ad442cf80eca0cac9a2fed75a4369fdc05fbe", "committedDate": "2020-11-11T06:58:29Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "208ad442cf80eca0cac9a2fed75a4369fdc05fbe", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/208ad442cf80eca0cac9a2fed75a4369fdc05fbe", "committedDate": "2020-11-11T06:58:29Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "83b611fe439b08381563f81b8cba18ce9dc07a00", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/83b611fe439b08381563f81b8cba18ce9dc07a00", "committedDate": "2020-11-11T07:49:42Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83b611fe439b08381563f81b8cba18ce9dc07a00", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/83b611fe439b08381563f81b8cba18ce9dc07a00", "committedDate": "2020-11-11T07:49:42Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "62c286467ba90c03723ecc85ab3739f16817b6ec", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/62c286467ba90c03723ecc85ab3739f16817b6ec", "committedDate": "2020-11-11T08:33:14Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62c286467ba90c03723ecc85ab3739f16817b6ec", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/62c286467ba90c03723ecc85ab3739f16817b6ec", "committedDate": "2020-11-11T08:33:14Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "f356da2c48c5e8b4dc15d8efdb4657165760b87a", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/f356da2c48c5e8b4dc15d8efdb4657165760b87a", "committedDate": "2020-11-11T09:04:31Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f356da2c48c5e8b4dc15d8efdb4657165760b87a", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/f356da2c48c5e8b4dc15d8efdb4657165760b87a", "committedDate": "2020-11-11T09:04:31Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "4860f60102265ac1737f1f4d97dcd63db7f2c1a4", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/4860f60102265ac1737f1f4d97dcd63db7f2c1a4", "committedDate": "2020-11-11T09:10:30Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4860f60102265ac1737f1f4d97dcd63db7f2c1a4", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/4860f60102265ac1737f1f4d97dcd63db7f2c1a4", "committedDate": "2020-11-11T09:10:30Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "bf3c782cf979ae9d8b2df3c0ed144846792e5dff", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/bf3c782cf979ae9d8b2df3c0ed144846792e5dff", "committedDate": "2020-11-11T09:11:04Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMTcxNjM1", "url": "https://github.com/apache/cloudstack/pull/4459#pullrequestreview-533171635", "createdAt": "2020-11-18T07:43:34Z", "commit": {"oid": "bf3c782cf979ae9d8b2df3c0ed144846792e5dff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzo0MzozNFrOH1gn0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzo0MzozNFrOH1gn0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg3MTA1Ng==", "bodyText": "printf has only one specifier in the format and two arguments. What is intended here?", "url": "https://github.com/apache/cloudstack/pull/4459#discussion_r525871056", "createdAt": "2020-11-18T07:43:34Z", "author": {"login": "DaanHoogland"}, "path": "scripts/util/create-kubernetes-binaries-iso.sh", "diffHunk": "@@ -87,6 +91,14 @@ if [ $? -ne 0 ]; then\n fi\n mkdir -p \"${working_dir}/docker\"\n output=`${k8s_dir}/kubeadm config images list --kubernetes-version=${RELEASE}`\n+\n+# Don't forget about the yaml images !\n+for i in ${network_conf_file} ${dashboard_conf_file}\n+do\n+  images=`grep \"image:\" $i | cut -d ':' -f2- | tr -d ' ' | tr -d \"'\"`\n+  output=`printf \"%s\\n\" ${output} ${images}`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf3c782cf979ae9d8b2df3c0ed144846792e5dff"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1", "committedDate": "2020-11-18T10:54:19Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf3c782cf979ae9d8b2df3c0ed144846792e5dff", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/bf3c782cf979ae9d8b2df3c0ed144846792e5dff", "committedDate": "2020-11-11T09:11:04Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}, "afterCommit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1", "committedDate": "2020-11-18T10:54:19Z", "message": "createkubertetesbinariesiso: Saving images in network and dashboard yaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMzc3MTcy", "url": "https://github.com/apache/cloudstack/pull/4459#pullrequestreview-533377172", "createdAt": "2020-11-18T12:03:28Z", "commit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjowMzoyOVrOH1qluQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjowMzoyOVrOH1qluQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjAzNDM2MQ==", "bodyText": "\ud83c\uddf9\ud83c\uddf7 red flag ;) but fine by me. we allow this script to exit and leave garbage behind. in view of the function of this script fine. (a comment or so would be appropriate, i think)", "url": "https://github.com/apache/cloudstack/pull/4459#discussion_r526034361", "createdAt": "2020-11-18T12:03:29Z", "author": {"login": "DaanHoogland"}, "path": "scripts/util/create-kubernetes-binaries-iso.sh", "diffHunk": "@@ -16,9 +16,11 @@\n # specific language governing permissions and limitations\n # under the License.\n \n+set -e", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMzc3NDg3", "url": "https://github.com/apache/cloudstack/pull/4459#pullrequestreview-533377487", "createdAt": "2020-11-18T12:03:55Z", "commit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MTA0OTU3", "url": "https://github.com/apache/cloudstack/pull/4459#pullrequestreview-534104957", "createdAt": "2020-11-19T06:05:23Z", "commit": {"oid": "efb11c9c0c30104a0eef34bd0c1706ca63cfb1c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4779, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}