{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMDc5OTE1", "number": 4478, "title": "Adding memoryallocatedpercentage & memoryallocatedbytes to HostsResponse & HostsForMigrationResponse", "bodyText": "Description\nFixes #4460\nAdds memoryallocatedpercentage & memoryallocatedbytes to HostsResponse as well as HostsForMigrationResponse and deprecates memoryallocated\nTypes of changes\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nHow Has This Been Tested?\n(localhost) \ud83d\udc31 > list hosts filter=cpuallocated,memoryallocated,memoryallocatedbytes,memoryallocatedpercentage, type=Routing\n{\n  \"count\": 2,\n  \"host\": [\n    {\n      \"cpuallocated\": \"6.25%\",\n      \"memoryallocated\": 2415919104,\n      \"memoryallocatedbytes\": 2415919104,\n      \"memoryallocatedpercentage\": \"28.12%\"\n    },\n    {\n      \"cpuallocated\": \"1.56%\",\n      \"memoryallocated\": 536870912,\n      \"memoryallocatedbytes\": 536870912,\n      \"memoryallocatedpercentage\": \"6.25%\"\n    }\n  ]\n}\n(localhost) \ud83d\udc31 > find hostsformigration virtualmachineid=e3c2c89a-26b3-427e-bc4a-34caeedf466a filter=cpuallocated,memoryallocated,memoryallocatedbytes,memoryallocatedpercentage, type=Routing\n{\n  \"count\": 2,\n  \"host\": [\n    {\n      \"cpuallocated\": \"1.56%\",\n      \"memoryallocated\": \"6.25%\",\n      \"memoryallocatedbytes\": 536870912,\n      \"memoryallocatedpercentage\": \"6.25%\"\n    }\n  ]\n}", "createdAt": "2020-11-18T10:27:08Z", "url": "https://github.com/apache/cloudstack/pull/4478", "merged": true, "mergeCommit": {"oid": "d79d24261a69769a481b71e6a74e197b76fcdf58"}, "closed": true, "closedAt": "2020-11-20T11:27:48Z", "author": {"login": "davidjumani"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddroPxgBqjQwMDk5MzQyMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeTJsigFqTUzNTIxMzcwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c88d2975e230da5e5dbbd7c92e964261069797d6", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/c88d2975e230da5e5dbbd7c92e964261069797d6", "committedDate": "2020-11-18T10:24:38Z", "message": "hostformigrationresponse: Setting memory allocated to long"}, "afterCommit": {"oid": "1c938d99c5a55076c4deb1329616baae6a8c9e3b", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/1c938d99c5a55076c4deb1329616baae6a8c9e3b", "committedDate": "2020-11-18T10:30:40Z", "message": "hostformigrationresponse: Setting memory allocated to long"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzOTU2NjU1", "url": "https://github.com/apache/cloudstack/pull/4478#pullrequestreview-533956655", "createdAt": "2020-11-18T23:11:51Z", "commit": {"oid": "1c938d99c5a55076c4deb1329616baae6a8c9e3b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMzoxMTo1MVrOH2GEYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMzoxMTo1MVrOH2GEYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4NDU3OQ==", "bodyText": "Will this cause regression?", "url": "https://github.com/apache/cloudstack/pull/4478#discussion_r526484579", "createdAt": "2020-11-18T23:11:51Z", "author": {"login": "rhtyd"}, "path": "server/src/main/java/com/cloud/api/query/dao/HostJoinDaoImpl.java", "diffHunk": "@@ -321,7 +321,7 @@ public HostForMigrationResponse newHostForMigrationResponse(HostJoinVO host, Enu\n                 hostResponse.setMemoryTotal(host.getTotalMemory());\n                 Float memWithOverprovisioning = host.getTotalMemory() * ApiDBUtils.getMemOverprovisioningFactor(host.getClusterId());\n                 hostResponse.setMemWithOverprovisioning(decimalFormat.format(memWithOverprovisioning));\n-                hostResponse.setMemoryAllocated(decimalFormat.format((float) mem / memWithOverprovisioning * 100.0f) +\"%\");\n+                hostResponse.setMemoryAllocated(mem);\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c938d99c5a55076c4deb1329616baae6a8c9e3b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8226351eb0b580a16d8b803bf0973dcd3dea6be1", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/8226351eb0b580a16d8b803bf0973dcd3dea6be1", "committedDate": "2020-11-20T05:55:57Z", "message": "Adding memoryallocatedpercentage & memoryallocatedbytes to HostsResponse & HostsForMigrationResponse"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c938d99c5a55076c4deb1329616baae6a8c9e3b", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/1c938d99c5a55076c4deb1329616baae6a8c9e3b", "committedDate": "2020-11-18T10:30:40Z", "message": "hostformigrationresponse: Setting memory allocated to long"}, "afterCommit": {"oid": "8226351eb0b580a16d8b803bf0973dcd3dea6be1", "author": {"user": {"login": "davidjumani", "name": null}}, "url": "https://github.com/apache/cloudstack/commit/8226351eb0b580a16d8b803bf0973dcd3dea6be1", "committedDate": "2020-11-20T05:55:57Z", "message": "Adding memoryallocatedpercentage & memoryallocatedbytes to HostsResponse & HostsForMigrationResponse"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MjA0NzU0", "url": "https://github.com/apache/cloudstack/pull/4478#pullrequestreview-535204754", "createdAt": "2020-11-20T08:20:06Z", "commit": {"oid": "8226351eb0b580a16d8b803bf0973dcd3dea6be1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MjEzNzA0", "url": "https://github.com/apache/cloudstack/pull/4478#pullrequestreview-535213704", "createdAt": "2020-11-20T08:33:45Z", "commit": {"oid": "8226351eb0b580a16d8b803bf0973dcd3dea6be1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4806, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}