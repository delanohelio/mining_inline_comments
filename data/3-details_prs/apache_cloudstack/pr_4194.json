{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNjg2ODAx", "number": 4194, "title": "enable update tags on disk offerings", "bodyText": "Description\n\nOn this PR #2636, @rafaelweingartner proposed a consistent validation mechanism to select a storage pool to deploy a volume when a virtual machine is deployed or when a new data disk is allocated.\nThe following table presents the scenarios when the storage_pool supports or not a new data disk.\n\n\n\n#\nDisk offering tags\nStorage tags\nDoes the storage support the disk offering?\n\n\n\n\n1\nA,B\nA\nNO\n\n\n2\nA,B,C\nA,B,C,D,X\nYES\n\n\n3\nA,B,C\nX,Y,Z\nNO\n\n\n4\nnull\nA,S,D\nYES\n\n\n5\nA\nnull\nNO\n\n\n6\nnull\nnull\nYES\n\n\n\nWith that in mind, this PR enables updateDiskOfferingCmd to edit storage pool tags for diskoffering. Thus, providing greater control to ADMINS decide where disks will be allocated.\n\n\n\n\n\nTypes of changes\n\n\n Breaking change (fix or feature that would cause existing functionality to change)\n New feature (non-breaking change which adds functionality)\n Bug fix (non-breaking change which fixes an issue)\n Enhancement (improves an existing feature and functionality)\n Cleanup (Code refactoring and cleanup, that may add test cases)\n\nScreenshots (if appropriate):\n\nHow Has This Been Tested?\n\n\n\nTo test the PR i created 2 storage pools.\nStorage Pools:\n\nspool01 \t        with tag hdd\nspool02\t\twith tag hdd2\n\nAnd create one disk Offering:\n\nTest \t\twithout tag\n\nTest 01\n\nCreate a volume using Test diskoffering\nAttach the volume to an instance\nUpdate the disk's diskoffering to another one that has a tag that does not have a corresponding Storage pool\nDetach the volume\ntry to migrate the disk\n\nExpected: we expect an exception since no storage tags match with the diskoffering tag\nResult:\nMigration target pool [null, tags:null] has no matching tags for volume [small, uuid:ce026b50-8b04-44d6-bb66-3d324b64ca7d, tags:fake]\n\nTest 02\n\nUsing the same volume from Test 01\nUpdate the disk's diskoffering tag to hdd2\ntry to migrate the disk to spool02\n\nExpected: Migrate the volume to spool02 storage.\nResult: all good, as expected", "createdAt": "2020-07-01T13:06:00Z", "url": "https://github.com/apache/cloudstack/pull/4194", "merged": true, "mergeCommit": {"oid": "c222d0bf607efd5685f49cc24d3538f5a4722b39"}, "closed": true, "closedAt": "2020-10-16T07:22:42Z", "author": {"login": "RodrigoDLopez"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwqDSXgH2gAyNDQyNjg2ODAxOmU3OGRlMmUxYzZiODViM2U5MDNmYWUzYmUxODNhZmQzMmZjNDg4YWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDRgL6gFqTQ3NzU3OTAxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e78de2e1c6b85b3e903fae3be183afd32fc488af", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/e78de2e1c6b85b3e903fae3be183afd32fc488af", "committedDate": "2020-07-01T13:14:03Z", "message": "enable update tags on disk offerings\n\nThis PR enables `updateDiskOfferingCmd` to edit storage pool tags for `diskoffering`. Thus, providing greater control to ADMINS decide where disks will be allocated.\n\nChanges on UI to enable the user to edit diskoffering tags"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "80684533cc013c3a017ca243afb8515ec70e4ffc", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/80684533cc013c3a017ca243afb8515ec70e4ffc", "committedDate": "2020-06-30T19:43:20Z", "message": "enable update tags on disk offerings\n\n\na"}, "afterCommit": {"oid": "e78de2e1c6b85b3e903fae3be183afd32fc488af", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/e78de2e1c6b85b3e903fae3be183afd32fc488af", "committedDate": "2020-07-01T13:14:03Z", "message": "enable update tags on disk offerings\n\nThis PR enables `updateDiskOfferingCmd` to edit storage pool tags for `diskoffering`. Thus, providing greater control to ADMINS decide where disks will be allocated.\n\nChanges on UI to enable the user to edit diskoffering tags"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwOTM2Mjkz", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-440936293", "createdAt": "2020-07-01T14:43:10Z", "commit": {"oid": "e78de2e1c6b85b3e903fae3be183afd32fc488af"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNDo0MzoxMFrOGro-RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNTowMjo1M1rOGrp0GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQxMzI1Mg==", "bodyText": "Comma-separated list of tags to be added to disk offering\n\nWhat do you think of changing this description to somethings as:\n\"comma-separated list of tags for the disk offering, tags should match with existing storage pool tags\"", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r448413252", "createdAt": "2020-07-01T14:43:10Z", "author": {"login": "GabrielBrascher"}, "path": "api/src/main/java/org/apache/cloudstack/api/command/admin/offering/UpdateDiskOfferingCmd.java", "diffHunk": "@@ -77,6 +77,13 @@\n             since = \"4.13\")\n     private String zoneIds;\n \n+    @Parameter(name = ApiConstants.TAGS,\n+            type = CommandType.STRING,\n+            description = \"Comma-separated list of tags to be added to disk offering\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e78de2e1c6b85b3e903fae3be183afd32fc488af"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQyNzAzMw==", "bodyText": "Can you please update the code formation according to the CloudStack coding conventions?\nExample of code formated:\nif (tags != null) {\n    if (tags.isBlank()) {\n        diskOffering.setTags(null);\n    } else {\n        diskOffering.setTags(tags);\n    }\n}\n\nDocumentation: https://cwiki.apache.org/confluence/display/CLOUDSTACK/Coding+conventions", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r448427033", "createdAt": "2020-07-01T15:02:53Z", "author": {"login": "GabrielBrascher"}, "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3207,30 +3208,13 @@ public DiskOffering updateDiskOffering(final UpdateDiskOfferingCmd cmd) {\n             diskOffering.setDisplayOffering(displayDiskOffering);\n         }\n \n-        // Note: tag editing commented out for now;keeping the code intact,\n-        // might need to re-enable in next releases\n-        // if (tags != null)\n-        // {\n-        // if (tags.trim().isEmpty() && diskOfferingHandle.getTags() == null)\n-        // {\n-        // //no new tags; no existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(null));\n-        // }\n-        // else if (!tags.trim().isEmpty() && diskOfferingHandle.getTags() !=\n-        // null)\n-        // {\n-        // //new tags + existing tags\n-        // List<String> oldTags = csvTagsToList(diskOfferingHandle.getTags());\n-        // List<String> newTags = csvTagsToList(tags);\n-        // oldTags.addAll(newTags);\n-        // diskOffering.setTagsArray(oldTags);\n-        // }\n-        // else if(!tags.trim().isEmpty())\n-        // {\n-        // //new tags; NO existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(tags));\n-        // }\n-        // }\n+        if (tags != null){\n+            if(tags.isBlank()){\n+                diskOffering.setTags(null);\n+            }else {\n+                diskOffering.setTags(tags);\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e78de2e1c6b85b3e903fae3be183afd32fc488af"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca08e28d35af4c81f0404ef7d0f828d87469d681", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/ca08e28d35af4c81f0404ef7d0f828d87469d681", "committedDate": "2020-07-01T16:33:05Z", "message": "improve api msg and fix checkstyle issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMTY3OTgy", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-441167982", "createdAt": "2020-07-01T20:15:56Z", "commit": {"oid": "ca08e28d35af4c81f0404ef7d0f828d87469d681"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MjgxMTEy", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-447281112", "createdAt": "2020-07-13T14:03:05Z", "commit": {"oid": "ca08e28d35af4c81f0404ef7d0f828d87469d681"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxNDowMzowNlrOGwqA8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxNDowMzowNlrOGwqA8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY3MzIwMQ==", "bodyText": "authorized = {RoleType.Admin}\n?", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r453673201", "createdAt": "2020-07-13T14:03:06Z", "author": {"login": "weizhouapache"}, "path": "api/src/main/java/org/apache/cloudstack/api/command/admin/offering/UpdateDiskOfferingCmd.java", "diffHunk": "@@ -77,6 +77,13 @@\n             since = \"4.13\")\n     private String zoneIds;\n \n+    @Parameter(name = ApiConstants.TAGS,\n+            type = CommandType.STRING,\n+            description = \"comma-separated list of tags for the disk offering, tags should match with existing storage pool tags\",\n+            since = \"4.15\")\n+    private String tags;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca08e28d35af4c81f0404ef7d0f828d87469d681"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5d13d91c4868efdd5c89c00d6b71db9ae15d81d", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/d5d13d91c4868efdd5c89c00d6b71db9ae15d81d", "committedDate": "2020-07-13T14:31:44Z", "message": "add RoleType.Admin when updating tag for diskoffering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mjg0NzM4", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-455284738", "createdAt": "2020-07-25T13:18:38Z", "commit": {"oid": "d5d13d91c4868efdd5c89c00d6b71db9ae15d81d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQxMzoxODozOFrOG3E2cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQxMzoyMDowMFrOG3E29w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwNDMzNw==", "bodyText": "Can you extract this name != null || displayText != null || sortKey != null || displayDiskOffering != null || tags != null to a method? Then, you can document it (explain what it checks, and why), and after that, you can write unit tests for all of the cases that the method must return true/false.\nMoreover, instead of checking if it is different from null, you could use String.Utils.isNotBlank", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r460404337", "createdAt": "2020-07-25T13:18:38Z", "author": {"login": "rafaelweingartner"}, "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3183,7 +3184,7 @@ public DiskOffering updateDiskOffering(final UpdateDiskOfferingCmd cmd) {\n             throw new InvalidParameterValueException(String.format(\"Unable to update disk offering: %s by id user: %s because it is not root-admin or domain-admin\", diskOfferingHandle.getUuid(), user.getUuid()));\n         }\n \n-        final boolean updateNeeded = name != null || displayText != null || sortKey != null || displayDiskOffering != null;\n+        final boolean updateNeeded = name != null || displayText != null || sortKey != null || displayDiskOffering != null || tags != null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5d13d91c4868efdd5c89c00d6b71db9ae15d81d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwNDM3Mw==", "bodyText": "Use the String utils here, then you do not need two ifs", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r460404373", "createdAt": "2020-07-25T13:19:03Z", "author": {"login": "rafaelweingartner"}, "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3207,30 +3208,13 @@ public DiskOffering updateDiskOffering(final UpdateDiskOfferingCmd cmd) {\n             diskOffering.setDisplayOffering(displayDiskOffering);\n         }\n \n-        // Note: tag editing commented out for now;keeping the code intact,\n-        // might need to re-enable in next releases\n-        // if (tags != null)\n-        // {\n-        // if (tags.trim().isEmpty() && diskOfferingHandle.getTags() == null)\n-        // {\n-        // //no new tags; no existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(null));\n-        // }\n-        // else if (!tags.trim().isEmpty() && diskOfferingHandle.getTags() !=\n-        // null)\n-        // {\n-        // //new tags + existing tags\n-        // List<String> oldTags = csvTagsToList(diskOfferingHandle.getTags());\n-        // List<String> newTags = csvTagsToList(tags);\n-        // oldTags.addAll(newTags);\n-        // diskOffering.setTagsArray(oldTags);\n-        // }\n-        // else if(!tags.trim().isEmpty())\n-        // {\n-        // //new tags; NO existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(tags));\n-        // }\n-        // }\n+        if (tags != null){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5d13d91c4868efdd5c89c00d6b71db9ae15d81d"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwNDQ3MQ==", "bodyText": "So, whenever updating the offering, we need to send the old(already configured) tags? Even when we do not want to update them?\nOtherwise, it seems that you would always set it to null (even if we do not want that)", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r460404471", "createdAt": "2020-07-25T13:20:00Z", "author": {"login": "rafaelweingartner"}, "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3207,30 +3208,13 @@ public DiskOffering updateDiskOffering(final UpdateDiskOfferingCmd cmd) {\n             diskOffering.setDisplayOffering(displayDiskOffering);\n         }\n \n-        // Note: tag editing commented out for now;keeping the code intact,\n-        // might need to re-enable in next releases\n-        // if (tags != null)\n-        // {\n-        // if (tags.trim().isEmpty() && diskOfferingHandle.getTags() == null)\n-        // {\n-        // //no new tags; no existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(null));\n-        // }\n-        // else if (!tags.trim().isEmpty() && diskOfferingHandle.getTags() !=\n-        // null)\n-        // {\n-        // //new tags + existing tags\n-        // List<String> oldTags = csvTagsToList(diskOfferingHandle.getTags());\n-        // List<String> newTags = csvTagsToList(tags);\n-        // oldTags.addAll(newTags);\n-        // diskOffering.setTagsArray(oldTags);\n-        // }\n-        // else if(!tags.trim().isEmpty())\n-        // {\n-        // //new tags; NO existing tags\n-        // diskOffering.setTagsArray(csvTagsToList(tags));\n-        // }\n-        // }\n+        if (tags != null){\n+            if(tags.isBlank()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5d13d91c4868efdd5c89c00d6b71db9ae15d81d"}, "originalPosition": 46}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "319b5ce739b9ad21c4255f6f6f28f6e3b8b31d35", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/319b5ce739b9ad21c4255f6f6f28f6e3b8b31d35", "committedDate": "2020-07-27T20:43:27Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods"}, "afterCommit": {"oid": "96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b", "committedDate": "2020-07-28T19:36:33Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MDkxNzc5", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-457091779", "createdAt": "2020-07-28T23:14:33Z", "commit": {"oid": "96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzoxNDozM1rOG4i8Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzoxNDozM1rOG4i8Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk0NTkxMQ==", "bodyText": "shouldUpdateDiskOffering sounds better to me. However, I am not a native speaker. Therefore, change only if you also agree with me.", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r461945911", "createdAt": "2020-07-28T23:14:33Z", "author": {"login": "rafaelweingartner"}, "path": "server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java", "diffHunk": "@@ -3183,7 +3184,7 @@ public DiskOffering updateDiskOffering(final UpdateDiskOfferingCmd cmd) {\n             throw new InvalidParameterValueException(String.format(\"Unable to update disk offering: %s by id user: %s because it is not root-admin or domain-admin\", diskOfferingHandle.getUuid(), user.getUuid()));\n         }\n \n-        final boolean updateNeeded = name != null || displayText != null || sortKey != null || displayDiskOffering != null;\n+        final boolean updateNeeded = isUpdateDiskOfferingNeeded(name, displayText, sortKey, displayDiskOffering, tags);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/96b3aef5df9d8f26a442d6cdabcc14cf1303bd5b", "committedDate": "2020-07-28T19:36:33Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods"}, "afterCommit": {"oid": "81e086bb1d9da5a248c6725ecb905bc59ed5ece8", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/81e086bb1d9da5a248c6725ecb905bc59ed5ece8", "committedDate": "2020-07-29T18:05:30Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods\n\n\nfix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8fa15703b36f40be2d510660346561973d617ea", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/c8fa15703b36f40be2d510660346561973d617ea", "committedDate": "2020-07-29T19:05:52Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81e086bb1d9da5a248c6725ecb905bc59ed5ece8", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/81e086bb1d9da5a248c6725ecb905bc59ed5ece8", "committedDate": "2020-07-29T18:05:30Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods\n\n\nfix"}, "afterCommit": {"oid": "c8fa15703b36f40be2d510660346561973d617ea", "author": {"user": null}, "url": "https://github.com/apache/cloudstack/commit/c8fa15703b36f40be2d510660346561973d617ea", "committedDate": "2020-07-29T19:05:52Z", "message": "Extract new methods\n\nadd two new methods: updateDiskOfferingTagsIfIsNotNull that will check  and set tags to the diskOffering; isUpdateDiskOfferingNeeded that verify if any update is needed.\n\nCreate unit tests do cover all those new methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTUwNTk2", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-463550596", "createdAt": "2020-08-07T19:09:18Z", "commit": {"oid": "c8fa15703b36f40be2d510660346561973d617ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NTc5MDE4", "url": "https://github.com/apache/cloudstack/pull/4194#pullrequestreview-477579018", "createdAt": "2020-08-28T09:22:32Z", "commit": {"oid": "c8fa15703b36f40be2d510660346561973d617ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQwOToyMjozMlrOHI0gCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQwOToyMjozMlrOHI0gCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTAxMDgyNA==", "bodyText": "@RodrigoDLopez does this require any changes in Primate?\nCan you check and send a PR to Primate? Thnx", "url": "https://github.com/apache/cloudstack/pull/4194#discussion_r479010824", "createdAt": "2020-08-28T09:22:32Z", "author": {"login": "rhtyd"}, "path": "ui/scripts/configuration.js", "diffHunk": "@@ -2939,7 +2940,41 @@\n                                         label: 'label.cache.mode'\n                                     },\n                                     tags: {\n-                                        label: 'label.storage.tags'\n+                                        label: 'label.storage.tags',\n+                                        docID: 'helpPrimaryStorageTags',\n+                                        isEditable: true,\n+                                        isTokenInput: true,\n+                                        dataProvider: function(args) {\n+                                            $.ajax({\n+                                                url: createURL(\"listStorageTags\"),\n+                                                dataType: \"json\",\n+                                                success: function(json) {\n+                                                    var item = json.liststoragetagsresponse.storagetag;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8fa15703b36f40be2d510660346561973d617ea"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3921, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}