{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MzAyNzkz", "number": 3839, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzozNjo1OFrODa4Pew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwODo0NDo0NFrODmlm0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NTExMDM1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/cloud/vm/UserVmManagerImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzozNjo1OFrOFiC2zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNjo0MTozN1rOFiagxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjcwMw==", "bodyText": "I previously saw code like this in https://github.com/apache/cloudstack/pull/3759/files. Does this belong into this PR?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r371242703", "createdAt": "2020-01-27T13:36:58Z", "author": {"login": "DennisKonrad"}, "path": "server/src/main/java/com/cloud/vm/UserVmManagerImpl.java", "diffHunk": "@@ -1015,11 +1015,12 @@ public UserVm upgradeVirtualMachine(UpgradeVMCmd cmd) throws ResourceAllocationE\n         int currentCpu = currentServiceOffering.getCpu();\n         int currentMemory = currentServiceOffering.getRamSize();\n \n+        Account owner = _accountMgr.getActiveAccountById(vmInstance.getAccountId());\n         if (newCpu > currentCpu) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.cpu, newCpu - currentCpu);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.cpu, newCpu - currentCpu);\n         }\n         if (newMemory > currentMemory) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.memory, newMemory - currentMemory);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.memory, newMemory - currentMemory);\n         }\n \n         // Check that the specified service offering ID is valid", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a923209e535a10c52b2eb3910c7b9929027709f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMxMjk2MQ==", "bodyText": "@DennisKonrad I do not think so.\n@bwsw could you use \"git rebase\" with latest master, instead of \"git merge\" ?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r371312961", "createdAt": "2020-01-27T15:38:08Z", "author": {"login": "weizhouapache"}, "path": "server/src/main/java/com/cloud/vm/UserVmManagerImpl.java", "diffHunk": "@@ -1015,11 +1015,12 @@ public UserVm upgradeVirtualMachine(UpgradeVMCmd cmd) throws ResourceAllocationE\n         int currentCpu = currentServiceOffering.getCpu();\n         int currentMemory = currentServiceOffering.getRamSize();\n \n+        Account owner = _accountMgr.getActiveAccountById(vmInstance.getAccountId());\n         if (newCpu > currentCpu) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.cpu, newCpu - currentCpu);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.cpu, newCpu - currentCpu);\n         }\n         if (newMemory > currentMemory) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.memory, newMemory - currentMemory);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.memory, newMemory - currentMemory);\n         }\n \n         // Check that the specified service offering ID is valid", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjcwMw=="}, "originalCommit": {"oid": "4a923209e535a10c52b2eb3910c7b9929027709f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYzMDI3OA==", "bodyText": "@weizhouapache @DennisKonrad resolved.", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r371630278", "createdAt": "2020-01-28T06:41:37Z", "author": {"login": "bwsw"}, "path": "server/src/main/java/com/cloud/vm/UserVmManagerImpl.java", "diffHunk": "@@ -1015,11 +1015,12 @@ public UserVm upgradeVirtualMachine(UpgradeVMCmd cmd) throws ResourceAllocationE\n         int currentCpu = currentServiceOffering.getCpu();\n         int currentMemory = currentServiceOffering.getRamSize();\n \n+        Account owner = _accountMgr.getActiveAccountById(vmInstance.getAccountId());\n         if (newCpu > currentCpu) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.cpu, newCpu - currentCpu);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.cpu, newCpu - currentCpu);\n         }\n         if (newMemory > currentMemory) {\n-            _resourceLimitMgr.checkResourceLimit(caller, ResourceType.memory, newMemory - currentMemory);\n+            _resourceLimitMgr.checkResourceLimit(owner, ResourceType.memory, newMemory - currentMemory);\n         }\n \n         // Check that the specified service offering ID is valid", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjcwMw=="}, "originalCommit": {"oid": "4a923209e535a10c52b2eb3910c7b9929027709f"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjkxMjU2OnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxODozNVrOFuD9_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxODozNVrOFuD9_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0MzgzNg==", "bodyText": "can you add a call configureAgentHooks()?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r383843836", "createdAt": "2020-02-25T12:18:35Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "diffHunk": "@@ -1065,6 +1089,48 @@ public boolean configure(final String name, final Map<String, Object> params) th\n         value = (String) params.get(\"vm.migrate.pauseafter\");\n         _migratePauseAfter = NumbersUtil.parseInt(value, -1);\n \n+        value = (String) params.get(\"agent.hooks.basedir\");\n+        if (null != value) {\n+            _agentHooksBasedir = value;\n+        }\n+        s_logger.debug(\"agent.hooks.basedir is \" + _agentHooksBasedir);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_xml_transformer.script\");\n+        if (null != value) {\n+            _agentHooksLibvirtXmlScript = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_xml_transformer.script is \" + _agentHooksLibvirtXmlScript);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_xml_transformer.method\");\n+        if (null != value) {\n+            _agentHooksLibvirtXmlMethod = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_xml_transformer.method is \" + _agentHooksLibvirtXmlMethod);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_on_start.script\");\n+        if (null != value) {\n+            _agentHooksVmOnStartScript = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_on_start.script is \" + _agentHooksVmOnStartScript);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_on_start.method\");\n+        if (null != value) {\n+            _agentHooksVmOnStartMethod = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_on_start.method is \" + _agentHooksVmOnStartMethod);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_on_stop.script\");\n+        if (null != value) {\n+            _agentHooksVmOnStopScript = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_on_stop.script is \" + _agentHooksVmOnStopScript);\n+\n+        value = (String) params.get(\"agent.hooks.libvirt_vm_on_stop.method\");\n+        if (null != value) {\n+            _agentHooksVmOnStopMethod = value;\n+        }\n+        s_logger.debug(\"agent.hooks.libvirt_vm_on_stop.method is \" + _agentHooksVmOnStopMethod);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjkxNTUyOnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStartCommandWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxOTozNlrOFuD_xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxOTozNlrOFuD_xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDI5Mg==", "bodyText": "can you add a call performAgentTransformHook(..) here?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r383844292", "createdAt": "2020-02-25T12:19:36Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStartCommandWrapper.java", "diffHunk": "@@ -79,7 +79,28 @@ public Answer execute(final StartCommand command, final LibvirtComputingResource\n             libvirtComputingResource.createVifs(vmSpec, vm);\n \n             s_logger.debug(\"starting \" + vmName + \": \" + vm.toString());\n-            libvirtComputingResource.startVM(conn, vmName, vm.toString());\n+            String vmInitialSpecification = vm.toString();\n+            String vmFinalSpecification;\n+            try {\n+                // if transformer fails, everything must go as it's just skipped.\n+                LibvirtKvmAgentHook t = libvirtComputingResource.getTransformer();\n+                vmFinalSpecification = (String) t.handle(vmInitialSpecification);\n+                if (null == vmFinalSpecification) {\n+                    s_logger.warn(\"Libvirt XML transformer returned NULL, will use XML specification unchanged.\");\n+                    vmFinalSpecification = vmInitialSpecification;\n+                }\n+            } catch(Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt XML transformer hook: {}\", e);\n+                vmFinalSpecification = vmInitialSpecification;\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjkxNjQ2OnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStartCommandWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxOTo1OFrOFuEAUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoxOTo1OFrOFuEAUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDQzNA==", "bodyText": "and performAgentStartHook(..) here?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r383844434", "createdAt": "2020-02-25T12:19:58Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStartCommandWrapper.java", "diffHunk": "@@ -79,7 +79,28 @@ public Answer execute(final StartCommand command, final LibvirtComputingResource\n             libvirtComputingResource.createVifs(vmSpec, vm);\n \n             s_logger.debug(\"starting \" + vmName + \": \" + vm.toString());\n-            libvirtComputingResource.startVM(conn, vmName, vm.toString());\n+            String vmInitialSpecification = vm.toString();\n+            String vmFinalSpecification;\n+            try {\n+                // if transformer fails, everything must go as it's just skipped.\n+                LibvirtKvmAgentHook t = libvirtComputingResource.getTransformer();\n+                vmFinalSpecification = (String) t.handle(vmInitialSpecification);\n+                if (null == vmFinalSpecification) {\n+                    s_logger.warn(\"Libvirt XML transformer returned NULL, will use XML specification unchanged.\");\n+                    vmFinalSpecification = vmInitialSpecification;\n+                }\n+            } catch(Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt XML transformer hook: {}\", e);\n+                vmFinalSpecification = vmInitialSpecification;\n+            }\n+            libvirtComputingResource.startVM(conn, vmName, vmFinalSpecification);\n+\n+            try {\n+                LibvirtKvmAgentHook onStartHook = libvirtComputingResource.getStartHook();\n+                onStartHook.handle(vmName);\n+            } catch (Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt VM onStart hook: {}\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjkxOTY5OnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStopCommandWrapper.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMjoyMTowMFrOFuECOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1NTo0N1rOF19qWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDkyMg==", "bodyText": "can you put this in a separate method?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r383844922", "createdAt": "2020-02-25T12:21:00Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStopCommandWrapper.java", "diffHunk": "@@ -92,6 +93,13 @@ public Answer execute(final StopCommand command, final LibvirtComputingResource\n             libvirtComputingResource.destroyNetworkRulesForVM(conn, vmName);\n             final String result = libvirtComputingResource.stopVM(conn, vmName, command.isForceStop());\n \n+            try {\n+                LibvirtKvmAgentHook onStopHook = libvirtComputingResource.getStopHook();\n+                onStopHook.handle(vmName);\n+            } catch (Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt VM onStop hook: {}\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDMwNDAzMQ==", "bodyText": "@DaanHoogland I'll handle all your comments tomorrow.", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r384304031", "createdAt": "2020-02-26T06:59:46Z", "author": {"login": "bwsw"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStopCommandWrapper.java", "diffHunk": "@@ -92,6 +93,13 @@ public Answer execute(final StopCommand command, final LibvirtComputingResource\n             libvirtComputingResource.destroyNetworkRulesForVM(conn, vmName);\n             final String result = libvirtComputingResource.stopVM(conn, vmName, command.isForceStop());\n \n+            try {\n+                LibvirtKvmAgentHook onStopHook = libvirtComputingResource.getStopHook();\n+                onStopHook.handle(vmName);\n+            } catch (Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt VM onStop hook: {}\", e);\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDkyMg=="}, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA0OTIxMg==", "bodyText": "ping, did you manage?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r386049212", "createdAt": "2020-02-29T19:16:42Z", "author": {"login": "DaanHoogland"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStopCommandWrapper.java", "diffHunk": "@@ -92,6 +93,13 @@ public Answer execute(final StopCommand command, final LibvirtComputingResource\n             libvirtComputingResource.destroyNetworkRulesForVM(conn, vmName);\n             final String result = libvirtComputingResource.stopVM(conn, vmName, command.isForceStop());\n \n+            try {\n+                LibvirtKvmAgentHook onStopHook = libvirtComputingResource.getStopHook();\n+                onStopHook.handle(vmName);\n+            } catch (Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt VM onStop hook: {}\", e);\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDkyMg=="}, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEyOTExMw==", "bodyText": "@DaanHoogland fixed every your notes.", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r392129113", "createdAt": "2020-03-13T09:55:47Z", "author": {"login": "bwsw"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/wrapper/LibvirtStopCommandWrapper.java", "diffHunk": "@@ -92,6 +93,13 @@ public Answer execute(final StopCommand command, final LibvirtComputingResource\n             libvirtComputingResource.destroyNetworkRulesForVM(conn, vmName);\n             final String result = libvirtComputingResource.stopVM(conn, vmName, command.isForceStop());\n \n+            try {\n+                LibvirtKvmAgentHook onStopHook = libvirtComputingResource.getStopHook();\n+                onStopHook.handle(vmName);\n+            } catch (Exception e) {\n+                s_logger.warn(\"Exception occured when handling LibVirt VM onStop hook: {}\", e);\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg0NDkyMg=="}, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4ODAyNjIyOnYy", "diffSide": "RIGHT", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwOTowMToxNFrOFvtxwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNTowMToyN1rOFwTrLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU3NzQwOQ==", "bodyText": "@bwsw I did not review the whole PR, is it related or similar to http://docs.cloudstack.apache.org/en/latest/adminguide/hosts.html#kvm-libvirt-hook-script-include ?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r385577409", "createdAt": "2020-02-28T09:01:14Z", "author": {"login": "rhtyd"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "diffHunk": "@@ -284,6 +284,18 @@\n     protected String _rngPath = \"/dev/random\";\n     protected int _rngRatePeriod = 1000;\n     protected int _rngRateBytes = 2048;\n+    protected String _agentHooksBasedir = \"/etc/cloudstack/agent/hooks\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5NzcxNQ==", "bodyText": "@rhtyd no it's not exactly what does qemu-hooks:\n\nthere is no qemu hook to override/mangle XML\nqemu hooks deadlocks in certain cases (for onStart/onStop):\n\nA hook script must not call back into libvirt, as the libvirt daemon is already waiting for the script to exit.\n\nA deadlock is likely to occur.\n\nFrom: https://www.libvirt.org/hooks.html\nSo, libvirt qemu hooks are pretty tough stuff:", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r386197715", "createdAt": "2020-03-02T04:57:55Z", "author": {"login": "bwsw"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "diffHunk": "@@ -284,6 +284,18 @@\n     protected String _rngPath = \"/dev/random\";\n     protected int _rngRatePeriod = 1000;\n     protected int _rngRateBytes = 2048;\n+    protected String _agentHooksBasedir = \"/etc/cloudstack/agent/hooks\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU3NzQwOQ=="}, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5ODMxOA==", "bodyText": "Initially I tried to use qemu-hooks for my task, but lately moved my code to security groups python code, because, otherwise, it works unstable because of the reasons listed above.", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r386198318", "createdAt": "2020-03-02T05:01:27Z", "author": {"login": "bwsw"}, "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "diffHunk": "@@ -284,6 +284,18 @@\n     protected String _rngPath = \"/dev/random\";\n     protected int _rngRatePeriod = 1000;\n     protected int _rngRateBytes = 2048;\n+    protected String _agentHooksBasedir = \"/etc/cloudstack/agent/hooks\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU3NzQwOQ=="}, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNzg4NjI2OnYy", "diffSide": "RIGHT", "path": ".gitlab-ci.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwODo0NDo0NFrOF0FofQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwODo0NDo0NFrOF0FofQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE2MjU1Nw==", "bodyText": "@bwsw could you explain what this file is used for and how to use it ?", "url": "https://github.com/apache/cloudstack/pull/3839#discussion_r390162557", "createdAt": "2020-03-10T08:44:44Z", "author": {"login": "weizhouapache"}, "path": ".gitlab-ci.yml", "diffHunk": "@@ -0,0 +1,46 @@\n+# Licensed to the Apache Software Foundation (ASF) under one", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934552b79101ca02622fc4a799d02b188532d1bc"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4006, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}