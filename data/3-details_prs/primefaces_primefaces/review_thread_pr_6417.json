{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MjU1Mjg3", "number": 6417, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxMjozNDozOVrOEu0NgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzoxMDowMFrOEu1doQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTI1Mzc3OnYy", "diffSide": "RIGHT", "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxMjozNDozOVrOHjdGFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxMzowNjoxNlrOHjdQTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjkzODkwMw==", "bodyText": "I think it might be becaue you are missing:\nsource: _self.id,\n                    process: _self.id,\n                    update: _self.id,\n                    formId: _self.cfg.formId,", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506938903", "createdAt": "2020-10-17T12:34:39Z", "author": {"login": "melloware"}, "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "diffHunk": "@@ -278,64 +278,58 @@ PrimeFaces.widget.DatePicker = PrimeFaces.widget.BaseWidget.extend({\n         var _self = this;\n         this.cfg.onViewDateChange = function(event, date) {\n             _self.viewDateOption = date;\n-\n-            if(_self.hasBehavior('viewChange')) {\n-                _self.fireViewChangeEvent(date.getFullYear(), date.getMonth());\n-            }\n-            if (_self.cfg.lazyModel) {\n-                var options = {\n-                    source: _self.id,\n-                    process: _self.id,\n-                    update: _self.id,\n-                    formId: _self.cfg.formId,\n-                    params: [\n-                        {name: _self.id + '_year', value: date.getFullYear()},\n-                        {name: _self.id + '_month', value: date.getMonth()}\n-                    ],\n-                    onsuccess: function(responseXML, status, xhr) {\n-                        PrimeFaces.ajax.Response.handle(responseXML, status, xhr, {\n-                            widget: _self,\n-                            handle: function(content) {\n-                                var dateMetadata = JSON.parse(content).dateMetadata;\n-                                var disabledDates = [];\n-                                for (date in dateMetadata) {\n-                                    if (dateMetadata[date].disabled) {\n-                                        disabledDates.push(date);\n-                                    }\n-                                }\n-                                _self.setDisabledDates(disabledDates);\n-                            }\n-                        });\n-\n-                        return true;\n-                    }\n-                };\n-                PrimeFaces.ajax.Request.handle(options);\n-            }\n+            _self.fireViewChangeEvent(date);\n         };\n     },\n \n     /**\n      * Triggers the event for when the date picker changed to a different month or year page.\n      * @private\n-     * @param {number} year The year to which the date picker changed.\n-     * @param {number} month The year to which the date picker changed, starting with `0` for `Janurary`.\n+     * @param {Date} date The date to which the date picker changed.\n      */\n-    fireViewChangeEvent: function(year, month) {\n-        if(this.cfg.behaviors) {\n+    fireViewChangeEvent: function(date) {\n+        var _self = this, fired = false;\n+        var options = {\n+            params: [\n+                {name: this.id + '_year', value: date.getFullYear()},\n+                {name: this.id + '_month', value: date.getMonth()}\n+            ]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "334d1b3a44eaaed2eeee06cbe4f15dbdc3c858a4"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0MTUxNw==", "bodyText": "Yes, update did the job!", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506941517", "createdAt": "2020-10-17T13:06:16Z", "author": {"login": "jepsar"}, "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "diffHunk": "@@ -278,64 +278,58 @@ PrimeFaces.widget.DatePicker = PrimeFaces.widget.BaseWidget.extend({\n         var _self = this;\n         this.cfg.onViewDateChange = function(event, date) {\n             _self.viewDateOption = date;\n-\n-            if(_self.hasBehavior('viewChange')) {\n-                _self.fireViewChangeEvent(date.getFullYear(), date.getMonth());\n-            }\n-            if (_self.cfg.lazyModel) {\n-                var options = {\n-                    source: _self.id,\n-                    process: _self.id,\n-                    update: _self.id,\n-                    formId: _self.cfg.formId,\n-                    params: [\n-                        {name: _self.id + '_year', value: date.getFullYear()},\n-                        {name: _self.id + '_month', value: date.getMonth()}\n-                    ],\n-                    onsuccess: function(responseXML, status, xhr) {\n-                        PrimeFaces.ajax.Response.handle(responseXML, status, xhr, {\n-                            widget: _self,\n-                            handle: function(content) {\n-                                var dateMetadata = JSON.parse(content).dateMetadata;\n-                                var disabledDates = [];\n-                                for (date in dateMetadata) {\n-                                    if (dateMetadata[date].disabled) {\n-                                        disabledDates.push(date);\n-                                    }\n-                                }\n-                                _self.setDisabledDates(disabledDates);\n-                            }\n-                        });\n-\n-                        return true;\n-                    }\n-                };\n-                PrimeFaces.ajax.Request.handle(options);\n-            }\n+            _self.fireViewChangeEvent(date);\n         };\n     },\n \n     /**\n      * Triggers the event for when the date picker changed to a different month or year page.\n      * @private\n-     * @param {number} year The year to which the date picker changed.\n-     * @param {number} month The year to which the date picker changed, starting with `0` for `Janurary`.\n+     * @param {Date} date The date to which the date picker changed.\n      */\n-    fireViewChangeEvent: function(year, month) {\n-        if(this.cfg.behaviors) {\n+    fireViewChangeEvent: function(date) {\n+        var _self = this, fired = false;\n+        var options = {\n+            params: [\n+                {name: this.id + '_year', value: date.getFullYear()},\n+                {name: this.id + '_month', value: date.getMonth()}\n+            ]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjkzODkwMw=="}, "originalCommit": {"oid": "334d1b3a44eaaed2eeee06cbe4f15dbdc3c858a4"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTI5MTYzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxMzoyOTowMFrOHjdXuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzowMzo1MVrOHjej1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0MzQxNw==", "bodyText": "Not sure if you need to add process too?", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506943417", "createdAt": "2020-10-17T13:29:00Z", "author": {"login": "melloware"}, "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "diffHunk": "@@ -318,6 +318,7 @@ PrimeFaces.widget.DatePicker = PrimeFaces.widget.BaseWidget.extend({\n             var viewChangeBehavior = this.cfg.behaviors['viewChange'];\n \n             if(viewChangeBehavior) {\n+                options.update = (options.update||'') +' '+ this.id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7e8544f340f4399b0a879f1c486a22496408e11"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk2MjkwMg==", "bodyText": "I'm not sure. Did some minor improvements and tested with the showcase PR I submitted (I've added events) and it's all working for me.", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506962902", "createdAt": "2020-10-17T17:03:51Z", "author": {"login": "jepsar"}, "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "diffHunk": "@@ -318,6 +318,7 @@ PrimeFaces.widget.DatePicker = PrimeFaces.widget.BaseWidget.extend({\n             var viewChangeBehavior = this.cfg.behaviors['viewChange'];\n \n             if(viewChangeBehavior) {\n+                options.update = (options.update||'') +' '+ this.id;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0MzQxNw=="}, "originalCommit": {"oid": "d7e8544f340f4399b0a879f1c486a22496408e11"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTQ1NzkzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzowODo0NVrOHjelug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzowODo0NVrOHjelug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk2MzM4Ng==", "bodyText": "Please add spaces before/after || and +", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506963386", "createdAt": "2020-10-17T17:08:45Z", "author": {"login": "tandraschko"}, "path": "src/main/resources/META-INF/resources/primefaces/datepicker/1-datepicker.js", "diffHunk": "@@ -278,63 +278,55 @@ PrimeFaces.widget.DatePicker = PrimeFaces.widget.BaseWidget.extend({\n         var _self = this;\n         this.cfg.onViewDateChange = function(event, date) {\n             _self.viewDateOption = date;\n-\n-            if(_self.hasBehavior('viewChange')) {\n-                _self.fireViewChangeEvent(date.getFullYear(), date.getMonth());\n-            }\n-            if (_self.cfg.lazyModel) {\n-                var options = {\n-                    source: _self.id,\n-                    process: _self.id,\n-                    update: _self.id,\n-                    formId: _self.cfg.formId,\n-                    params: [\n-                        {name: _self.id + '_year', value: date.getFullYear()},\n-                        {name: _self.id + '_month', value: date.getMonth()}\n-                    ],\n-                    onsuccess: function(responseXML, status, xhr) {\n-                        PrimeFaces.ajax.Response.handle(responseXML, status, xhr, {\n-                            widget: _self,\n-                            handle: function(content) {\n-                                var dateMetadata = JSON.parse(content).dateMetadata;\n-                                var disabledDates = [];\n-                                for (date in dateMetadata) {\n-                                    if (dateMetadata[date].disabled) {\n-                                        disabledDates.push(date);\n-                                    }\n-                                }\n-                                _self.setDisabledDates(disabledDates);\n-                            }\n-                        });\n-\n-                        return true;\n-                    }\n-                };\n-                PrimeFaces.ajax.Request.handle(options);\n-            }\n+            _self.fireViewChangeEvent(date);\n         };\n     },\n \n     /**\n      * Triggers the event for when the date picker changed to a different month or year page.\n      * @private\n-     * @param {number} year The year to which the date picker changed.\n-     * @param {number} month The year to which the date picker changed, starting with `0` for `Janurary`.\n+     * @param {Date} date The date to which the date picker changed.\n      */\n-    fireViewChangeEvent: function(year, month) {\n-        if(this.cfg.behaviors) {\n-            var viewChangeBehavior = this.cfg.behaviors['viewChange'];\n-\n-            if(viewChangeBehavior) {\n-                var ext = {\n-                        params: [\n-                            {name: this.id + '_month', value: month},\n-                            {name: this.id + '_year', value: year}\n-                        ]\n-                };\n+    fireViewChangeEvent: function(date) {\n+        var _self = this;\n+        var lazy = this.cfg.lazyModel;\n+        var options = {\n+            params: [\n+                {name: this.id + '_year', value: date.getFullYear()},\n+                {name: this.id + '_month', value: date.getMonth()}\n+            ]\n+        }\n+        if (lazy) {\n+            options.onsuccess = function(responseXML, status, xhr) {\n+                PrimeFaces.ajax.Response.handle(responseXML, status, xhr, {\n+                    widget: _self,\n+                    handle: function(content) {\n+                        var dateMetadata = JSON.parse(content).dateMetadata;\n+                        var disabledDates = [];\n+                        for (date in dateMetadata) {\n+                            if (dateMetadata[date].disabled) {\n+                                disabledDates.push(date);\n+                            }\n+                        }\n+                        _self.setDisabledDates(disabledDates);\n+                    }\n+                });\n+                return true;\n+            };\n+        }\n \n-                viewChangeBehavior.call(this, ext);\n+        if (this.hasBehavior('viewChange')) {\n+            if (lazy) {\n+                options.update = (options.update||'') +' '+ this.id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "797f878c89dfc0d7be534e0747ca97a4f35968a0"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTQ1ODg5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/primefaces/component/datepicker/DatePickerRenderer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzoxMDowMFrOHjemMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNzoxMDowMFrOHjemMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk2MzUwNg==", "bodyText": "isRequestSource && eventName == viewChange && lazy=true\nthen you also dont need to the _year+_month null check next", "url": "https://github.com/primefaces/primefaces/pull/6417#discussion_r506963506", "createdAt": "2020-10-17T17:10:00Z", "author": {"login": "tandraschko"}, "path": "src/main/java/org/primefaces/component/datepicker/DatePickerRenderer.java", "diffHunk": "@@ -41,21 +41,25 @@\n import org.primefaces.component.calendar.BaseCalendarRenderer;\n import org.primefaces.expression.SearchExpressionFacade;\n import org.primefaces.expression.SearchExpressionUtils;\n+import org.primefaces.model.datepicker.DateMetadata;\n+import org.primefaces.model.datepicker.DateMetadataModel;\n import org.primefaces.model.datepicker.LazyDateMetadataModel;\n import org.primefaces.util.CalendarUtils;\n import org.primefaces.util.ComponentUtils;\n import org.primefaces.util.WidgetBuilder;\n-import org.primefaces.model.datepicker.DateMetadata;\n-import org.primefaces.model.datepicker.DateMetadataModel;\n \n public class DatePickerRenderer extends BaseCalendarRenderer {\n \n     @Override\n     public void encodeEnd(FacesContext context, UIComponent component) throws IOException {\n         DatePicker datePicker = (DatePicker) component;\n \n-        if (context.getExternalContext().getRequestParameterMap().containsKey(datePicker.getClientId(context))) {\n-            encodeDateMetadata(context, datePicker);\n+        if (ComponentUtils.isRequestSource(datePicker, context)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "797f878c89dfc0d7be534e0747ca97a4f35968a0"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2032, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}