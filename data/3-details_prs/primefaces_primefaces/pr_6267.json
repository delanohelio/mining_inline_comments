{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1OTIxODk2", "number": 6267, "title": "Fix #5978: FileDownload: add Ajax support", "bodyText": "Fix #5978\nPlease note that documentation (and showcase) is still to do. I'd like to wait on feedback first and then add the documentation.", "createdAt": "2020-08-30T14:58:46Z", "url": "https://github.com/primefaces/primefaces/pull/6267", "merged": true, "mergeCommit": {"oid": "2581606ec125bd9a8647a1172bf17a2773779e29"}, "closed": true, "closedAt": "2020-09-02T08:35:03Z", "author": {"login": "jepsar"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdD_cPAAH2gAyNDc1OTIxODk2OjFmMDMzYzc1YWFkZWQyYjRjYWJiN2U2MGQ2ZjcwZDk1YjQwMjlhZWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEsmNAgH2gAyNDc1OTIxODk2OjRiMDAwYjM4MTMzMTEwNTBkYmE1ZDk1NDZmY2QwYWViNzFiODYxMTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1f033c75aaded2b4cabb7e60d6f70d95b4029aeb", "author": {"user": {"login": "jepsar", "name": "Jasper de Vries"}}, "url": "https://github.com/primefaces/primefaces/commit/1f033c75aaded2b4cabb7e60d6f70d95b4029aeb", "committedDate": "2020-08-30T14:53:52Z", "message": "fileDownload add Ajax support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MjEwODM0", "url": "https://github.com/primefaces/primefaces/pull/6267#pullrequestreview-478210834", "createdAt": "2020-08-30T15:04:09Z", "commit": {"oid": "1f033c75aaded2b4cabb7e60d6f70d95b4029aeb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c31f130ccbcddc42ae1d95dba6d746cd7be4f084", "author": {"user": {"login": "jepsar", "name": "Jasper de Vries"}}, "url": "https://github.com/primefaces/primefaces/commit/c31f130ccbcddc42ae1d95dba6d746cd7be4f084", "committedDate": "2020-08-30T18:15:36Z", "message": "Reverted indexed for loop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d50cd9461425101047c1cced3bea35b31f64b43", "author": {"user": {"login": "melloware", "name": "Melloware"}}, "url": "https://github.com/primefaces/primefaces/commit/0d50cd9461425101047c1cced3bea35b31f64b43", "committedDate": "2020-09-01T17:37:57Z", "message": "Merge branch 'master' into fix_5978"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTk3OTMy", "url": "https://github.com/primefaces/primefaces/pull/6267#pullrequestreview-479997932", "createdAt": "2020-09-01T18:12:15Z", "commit": {"oid": "0d50cd9461425101047c1cced3bea35b31f64b43"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODoxMjoxNVrOHLCg5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODoxMjoxNVrOHLCg5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzNzU3NA==", "bodyText": "@tandraschko are you referring to this line? If so, src could be null originally:\n\n  \n    \n      primefaces/src/main/java/org/primefaces/util/DynamicContentSrcBuilder.java\n    \n    \n         Line 127\n      in\n      d05387b\n    \n    \n    \n    \n\n        \n          \n           src = ResourceUtils.appendCacheBuster(src, cache); \n        \n    \n  \n\n\nShall I change that into throwing a FacesException?", "url": "https://github.com/primefaces/primefaces/pull/6267#discussion_r481337574", "createdAt": "2020-09-01T18:12:15Z", "author": {"login": "jepsar"}, "path": "src/main/java/org/primefaces/util/DynamicContentSrcBuilder.java", "diffHunk": "@@ -65,36 +63,43 @@ public static String build(FacesContext context, Object value, UIComponent compo\n         }\n         else if (value instanceof String) {\n             src = ResourceUtils.getResourceURL(context, (String) value);\n+            return encodeResourceURL(context, src, cache);\n         }\n         else if (value instanceof StreamedContent) {\n             StreamedContent streamedContent = (StreamedContent) value;\n-\n-            if (stream) {\n-                Resource resource = context.getApplication().getResourceHandler().createResource(\n-                        \"dynamiccontent.properties\", \"primefaces\", streamedContent.getContentType());\n-                String resourcePath = resource.getRequestPath();\n-\n-                Map<String, Object> session = context.getExternalContext().getSessionMap();\n-                Map<String, String> dynamicResourcesMapping = (Map) session.get(Constants.DYNAMIC_RESOURCES_MAPPING);\n-                if (dynamicResourcesMapping == null) {\n-                    dynamicResourcesMapping = new LimitedSizeHashMap<>(200);\n-                    session.put(Constants.DYNAMIC_RESOURCES_MAPPING, dynamicResourcesMapping);\n-                }\n-\n-                ValueExpression expression = ValueExpressionAnalyzer.getExpression(\n+            ValueExpression expression = ValueExpressionAnalyzer.getExpression(\n                         context.getELContext(), component.getValueExpression(attributeName));\n+            return build(context, streamedContent, component, cache, type, stream, expression);\n+        }\n+        return encodeResourceURL(context, src, cache);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d50cd9461425101047c1cced3bea35b31f64b43"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94d24f6cfa42c89e53b6e34aa8de3b198bddd14b", "author": {"user": {"login": "jepsar", "name": "Jasper de Vries"}}, "url": "https://github.com/primefaces/primefaces/commit/94d24f6cfa42c89e53b6e34aa8de3b198bddd14b", "committedDate": "2020-09-01T18:21:16Z", "message": "Return null if no supported value type was found"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ffc3e58fca6ac393c21a1af16af2d1bf872a78e", "author": {"user": {"login": "jepsar", "name": "Jasper de Vries"}}, "url": "https://github.com/primefaces/primefaces/commit/2ffc3e58fca6ac393c21a1af16af2d1bf872a78e", "committedDate": "2020-09-01T18:23:59Z", "message": "Added download.js"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMDM1NTc3", "url": "https://github.com/primefaces/primefaces/pull/6267#pullrequestreview-480035577", "createdAt": "2020-09-01T19:03:07Z", "commit": {"oid": "2ffc3e58fca6ac393c21a1af16af2d1bf872a78e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxOTowMzowOFrOHLEW1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxOTowMzowOFrOHLEW1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM2Nzc2Nw==", "bodyText": "I usually put these in alphabatical order to make them easier to find.", "url": "https://github.com/primefaces/primefaces/pull/6267#discussion_r481367767", "createdAt": "2020-09-01T19:03:08Z", "author": {"login": "melloware"}, "path": "docs/9_0/core/thirdpartylibs.md", "diffHunk": "@@ -42,4 +42,4 @@ are many other third party libraries and plugins used to support features.\n | [Timeline](../jsdocs/classes/timeline.html) | 7.3.7 | https://github.com/visjs/vis-timeline |\n | [TouchSwipe](../jsdocs/modules/jquery.html#swipe) | 1.6.18 | https://github.com/mattbryson/TouchSwipe-Jquery-Plugin |\n | [WebcamJS](../jsdocs/modules/webcam.html) | 1.0.26 | http://github.com/jhuckaby |\n-\n+| download.js | 4.2 | http://danml.com/download.html |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ffc3e58fca6ac393c21a1af16af2d1bf872a78e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b000b3813311050dba5d9546fcd0aeb71b86116", "author": {"user": {"login": "jepsar", "name": "Jasper de Vries"}}, "url": "https://github.com/primefaces/primefaces/commit/4b000b3813311050dba5d9546fcd0aeb71b86116", "committedDate": "2020-09-01T19:30:29Z", "message": "Alphabetical order"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2760, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}