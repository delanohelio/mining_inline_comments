{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MzUxMzI5", "number": 6419, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMTo0NjowNVrOEvvD2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzowNjowN1rOEv5AMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NDg5NTYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/primefaces/component/selectonemenu/SelectOneMenuRenderer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMTo0NjowNVrOHk4ShQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMTo0NjowNVrOHk4ShQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMzAyOQ==", "bodyText": "I think its safe to get rid of these loggers and system.nanotime calls?", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508433029", "createdAt": "2020-10-20T11:46:05Z", "author": {"login": "melloware"}, "path": "src/main/java/org/primefaces/component/selectonemenu/SelectOneMenuRenderer.java", "diffHunk": "@@ -143,10 +152,17 @@ protected void encodeMarkup(FacesContext context, SelectOneMenu menu) throws IOE\n         }\n         renderARIACombobox(context, menu);\n \n+        long t1 = System.nanoTime();\n         encodeInput(context, menu, clientId, selectItems, values, submittedValues, converter);\n+        long t2 = System.nanoTime();\n         encodeLabel(context, menu, selectItems);\n         encodeMenuIcon(context, menu, valid);\n+        long t3 = System.nanoTime();\n         encodePanel(context, menu, selectItems);\n+        long t4 = System.nanoTime();\n+\n+        LOGGER.log(Level.INFO, \"SelectOneMenuRenderer#encodeInput \" + ((t2 - t1) / 1000000));\n+        LOGGER.log(Level.INFO, \"SelectOneMenuRenderer#encodePanel \" + ((t4 - t3) / 1000000));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8587e4aedc6f84fca9741ddfc17d96f7c10cba9"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NDg5NjYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/primefaces/component/selectonemenu/SelectOneMenuRenderer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMTo0NjoyNVrOHk4TJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMTo0NjoyNVrOHk4TJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMzE4OQ==", "bodyText": "Remove LOGGER and System.nanoTime calls?", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508433189", "createdAt": "2020-10-20T11:46:25Z", "author": {"login": "melloware"}, "path": "src/main/java/org/primefaces/component/selectonemenu/SelectOneMenuRenderer.java", "diffHunk": "@@ -105,8 +108,14 @@ public void encodeEnd(FacesContext context, UIComponent component) throws IOExce\n             Object values = getValues(menu);\n             Object submittedValues = getSubmittedValues(menu);\n \n+            long t1 = System.nanoTime();\n             encodeHiddenSelect(context, menu, clientId, selectItems, values, submittedValues, converter);\n+            long t2 = System.nanoTime();\n             encodePanelContent(context, menu, selectItems);\n+            long t3 = System.nanoTime();\n+\n+            LOGGER.log(Level.INFO, \"SelectOneMenuRenderer#encodeHiddenSelect \" + ((t2 - t1) / 1000000));\n+            LOGGER.log(Level.INFO, \"SelectOneMenuRenderer#encodePanelContent \" + ((t3 - t2) / 1000000));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8587e4aedc6f84fca9741ddfc17d96f7c10cba9"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NjUyMjgyOnYy", "diffSide": "RIGHT", "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzowNTozNFrOHlIWCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzoyNTo1NFrOHlJIMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY5NjA3NQ==", "bodyText": "can't you just do:\n this.cfg.renderPanelContentOnClient = this.cfg.renderPanelContentOnClient === true;", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508696075", "createdAt": "2020-10-20T17:05:34Z", "author": {"login": "melloware"}, "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "diffHunk": "@@ -94,16 +95,17 @@ PrimeFaces.widget.SelectOneMenu = PrimeFaces.widget.DeferredWidget.extend({\n         this.panel = $(this.panelId);\n         this.disabled = this.jq.hasClass('ui-state-disabled');\n         this.itemsWrapper = this.panel.children('.ui-selectonemenu-items-wrapper');\n-        this.options = this.input.children('option');\n+        this.options = this.input.find('option');\n         this.cfg.effect = this.cfg.effect||'fade';\n \n         this.cfg.effectSpeed = this.cfg.effectSpeed||'normal';\n         this.cfg.autoWidth = this.cfg.autoWidth === false ? false : true;\n         this.cfg.dynamic = this.cfg.dynamic === true ? true : false;\n         this.cfg.appendTo = this.getAppendTo();\n+        this.cfg.renderPanelContentOnClient = this.cfg.renderPanelContentOnClient === true ? true : false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81478852a82dc7a713cb1097831786b18af108d8"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcwODkxNA==", "bodyText": "done", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508708914", "createdAt": "2020-10-20T17:25:54Z", "author": {"login": "christophs78"}, "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "diffHunk": "@@ -94,16 +95,17 @@ PrimeFaces.widget.SelectOneMenu = PrimeFaces.widget.DeferredWidget.extend({\n         this.panel = $(this.panelId);\n         this.disabled = this.jq.hasClass('ui-state-disabled');\n         this.itemsWrapper = this.panel.children('.ui-selectonemenu-items-wrapper');\n-        this.options = this.input.children('option');\n+        this.options = this.input.find('option');\n         this.cfg.effect = this.cfg.effect||'fade';\n \n         this.cfg.effectSpeed = this.cfg.effectSpeed||'normal';\n         this.cfg.autoWidth = this.cfg.autoWidth === false ? false : true;\n         this.cfg.dynamic = this.cfg.dynamic === true ? true : false;\n         this.cfg.appendTo = this.getAppendTo();\n+        this.cfg.renderPanelContentOnClient = this.cfg.renderPanelContentOnClient === true ? true : false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY5NjA3NQ=="}, "originalCommit": {"oid": "81478852a82dc7a713cb1097831786b18af108d8"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NjUyNDY2OnYy", "diffSide": "RIGHT", "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzowNjowN1rOHlIXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzoyNzowMlrOHlJKzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY5NjM4NQ==", "bodyText": "This is ES6 syntax is it not?  I think you will have to write it as traditional ES5 javascript.", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508696385", "createdAt": "2020-10-20T17:06:07Z", "author": {"login": "melloware"}, "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "diffHunk": "@@ -1298,10 +1303,105 @@ PrimeFaces.widget.SelectOneMenu = PrimeFaces.widget.DeferredWidget.extend({\n             }, 10);\n         }\n         else {\n+            this.renderPanelContentFromHiddenSelect(true);\n+\n             handleMethod.call(this, event);\n         }\n     },\n \n+    /**\n+     * Renders panel content based on hidden select.\n+     * @param {boolean} initContentsAndBindItemEvents Call initContents and bindItemEvents after rendering?\n+     * @private\n+     */\n+    renderPanelContentFromHiddenSelect: function(initContentsAndBindItemEvents) {\n+         if (this.cfg.renderPanelContentOnClient && this.itemsWrapper.children().length === 0) {\n+             var panelContent = '<ul id=\"' + this.jqId + '_items\" class=\"ui-selectonemenu-items ui-selectonemenu-list ui-widget-content ui-widget ui-corner-all ui-helper-reset\" role=\"listbox\">';\n+             panelContent += this.renderSelectItems(this.input);\n+             panelContent += '</ul>';\n+\n+             this.itemsWrapper.append(panelContent);\n+\n+             if (initContentsAndBindItemEvents) {\n+                 this.initContents();\n+                 this.bindItemEvents();\n+             }\n+         }\n+    },\n+\n+    /**\n+     * Renders Panel-HTML-code for SelectItems.\n+     * @private\n+     * @param {JQuery} parentItem An parentItem (select, optgroup) for which to render HTML-code.\n+     * @return {string} Rendered HTML-code.\n+     */\n+    renderSelectItems: function(parentItem) {\n+        var content = \"\";\n+\n+        var opts = parentItem.children(\"option, optgroup\");\n+\n+        opts.each((i, opt) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81478852a82dc7a713cb1097831786b18af108d8"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcwOTU4Mg==", "bodyText": "Done. Maybe we should rethink after IE11 is gone whether we relay want to stick to ES5 forever.", "url": "https://github.com/primefaces/primefaces/pull/6419#discussion_r508709582", "createdAt": "2020-10-20T17:27:02Z", "author": {"login": "christophs78"}, "path": "src/main/resources/META-INF/resources/primefaces/forms/forms.selectonemenu.js", "diffHunk": "@@ -1298,10 +1303,105 @@ PrimeFaces.widget.SelectOneMenu = PrimeFaces.widget.DeferredWidget.extend({\n             }, 10);\n         }\n         else {\n+            this.renderPanelContentFromHiddenSelect(true);\n+\n             handleMethod.call(this, event);\n         }\n     },\n \n+    /**\n+     * Renders panel content based on hidden select.\n+     * @param {boolean} initContentsAndBindItemEvents Call initContents and bindItemEvents after rendering?\n+     * @private\n+     */\n+    renderPanelContentFromHiddenSelect: function(initContentsAndBindItemEvents) {\n+         if (this.cfg.renderPanelContentOnClient && this.itemsWrapper.children().length === 0) {\n+             var panelContent = '<ul id=\"' + this.jqId + '_items\" class=\"ui-selectonemenu-items ui-selectonemenu-list ui-widget-content ui-widget ui-corner-all ui-helper-reset\" role=\"listbox\">';\n+             panelContent += this.renderSelectItems(this.input);\n+             panelContent += '</ul>';\n+\n+             this.itemsWrapper.append(panelContent);\n+\n+             if (initContentsAndBindItemEvents) {\n+                 this.initContents();\n+                 this.bindItemEvents();\n+             }\n+         }\n+    },\n+\n+    /**\n+     * Renders Panel-HTML-code for SelectItems.\n+     * @private\n+     * @param {JQuery} parentItem An parentItem (select, optgroup) for which to render HTML-code.\n+     * @return {string} Rendered HTML-code.\n+     */\n+    renderSelectItems: function(parentItem) {\n+        var content = \"\";\n+\n+        var opts = parentItem.children(\"option, optgroup\");\n+\n+        opts.each((i, opt) => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY5NjM4NQ=="}, "originalCommit": {"oid": "81478852a82dc7a713cb1097831786b18af108d8"}, "originalPosition": 79}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2035, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}