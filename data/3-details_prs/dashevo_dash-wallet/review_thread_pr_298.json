{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMTYxMjU1", "number": 298, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwODozMzoyNVrODXFPag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOTozMjo1MFrODZnH_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTI5NzA2OnYy", "diffSide": "RIGHT", "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwODozMzoyNVrOFcNI_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwMDoyNjo1OFrOFeKq3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTExOTc0MA==", "bodyText": "Should we put USDC here as well?", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r365119740", "createdAt": "2020-01-10T08:33:25Z", "author": {"login": "dn-l"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Copyright 2019 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dash.wallet.common.data;\n+\n+import android.annotation.TargetApi;\n+import android.os.Build;\n+\n+import java.util.Currency;\n+import java.util.HashMap;\n+\n+/**\n+    @author: Eric Britten\n+ */\n+\n+public class CurrencyInfo {\n+\n+    /*\n+        Older android devices will have obsolete currency codes\n+        that do not match what the prices sources currently used.\n+\n+        e.g. in Belarus (BY), the currency changed from BYR to BYN\n+        at the end of 2016.  Older phones have BYR.\n+\n+        This app will read BYR from the device and then query BYN\n+        in the exchange rates list, but must get the name of BYR\n+        from the device.\n+     */\n+    private static HashMap<String, String> obsoleteCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data, but are not\n+        ISO 4217 currency codes.  This will map those codes to the\n+        currency names.\n+     */\n+    private static HashMap<String, String> otherCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data and have the\n+        same name as a different currency.  This differs from\n+        obsoleteCurrencyMap because both of these codes exist in the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d508ac5b4565acd38ff2d6b0bcff4429dc4d5ecd"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTEyNDQzOA==", "bodyText": "It's in the bitpay response", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r365124438", "createdAt": "2020-01-10T08:45:19Z", "author": {"login": "dn-l"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Copyright 2019 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dash.wallet.common.data;\n+\n+import android.annotation.TargetApi;\n+import android.os.Build;\n+\n+import java.util.Currency;\n+import java.util.HashMap;\n+\n+/**\n+    @author: Eric Britten\n+ */\n+\n+public class CurrencyInfo {\n+\n+    /*\n+        Older android devices will have obsolete currency codes\n+        that do not match what the prices sources currently used.\n+\n+        e.g. in Belarus (BY), the currency changed from BYR to BYN\n+        at the end of 2016.  Older phones have BYR.\n+\n+        This app will read BYR from the device and then query BYN\n+        in the exchange rates list, but must get the name of BYR\n+        from the device.\n+     */\n+    private static HashMap<String, String> obsoleteCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data, but are not\n+        ISO 4217 currency codes.  This will map those codes to the\n+        currency names.\n+     */\n+    private static HashMap<String, String> otherCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data and have the\n+        same name as a different currency.  This differs from\n+        obsoleteCurrencyMap because both of these codes exist in the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTExOTc0MA=="}, "originalCommit": {"oid": "d508ac5b4565acd38ff2d6b0bcff4429dc4d5ecd"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIzMjMyNA==", "bodyText": "Yes, good idea.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r365232324", "createdAt": "2020-01-10T13:27:50Z", "author": {"login": "HashEngineering"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Copyright 2019 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dash.wallet.common.data;\n+\n+import android.annotation.TargetApi;\n+import android.os.Build;\n+\n+import java.util.Currency;\n+import java.util.HashMap;\n+\n+/**\n+    @author: Eric Britten\n+ */\n+\n+public class CurrencyInfo {\n+\n+    /*\n+        Older android devices will have obsolete currency codes\n+        that do not match what the prices sources currently used.\n+\n+        e.g. in Belarus (BY), the currency changed from BYR to BYN\n+        at the end of 2016.  Older phones have BYR.\n+\n+        This app will read BYR from the device and then query BYN\n+        in the exchange rates list, but must get the name of BYR\n+        from the device.\n+     */\n+    private static HashMap<String, String> obsoleteCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data, but are not\n+        ISO 4217 currency codes.  This will map those codes to the\n+        currency names.\n+     */\n+    private static HashMap<String, String> otherCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data and have the\n+        same name as a different currency.  This differs from\n+        obsoleteCurrencyMap because both of these codes exist in the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTExOTc0MA=="}, "originalCommit": {"oid": "d508ac5b4565acd38ff2d6b0bcff4429dc4d5ecd"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk5ODA5MQ==", "bodyText": "this was added", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r365998091", "createdAt": "2020-01-13T19:55:15Z", "author": {"login": "HashEngineering"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Copyright 2019 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dash.wallet.common.data;\n+\n+import android.annotation.TargetApi;\n+import android.os.Build;\n+\n+import java.util.Currency;\n+import java.util.HashMap;\n+\n+/**\n+    @author: Eric Britten\n+ */\n+\n+public class CurrencyInfo {\n+\n+    /*\n+        Older android devices will have obsolete currency codes\n+        that do not match what the prices sources currently used.\n+\n+        e.g. in Belarus (BY), the currency changed from BYR to BYN\n+        at the end of 2016.  Older phones have BYR.\n+\n+        This app will read BYR from the device and then query BYN\n+        in the exchange rates list, but must get the name of BYR\n+        from the device.\n+     */\n+    private static HashMap<String, String> obsoleteCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data, but are not\n+        ISO 4217 currency codes.  This will map those codes to the\n+        currency names.\n+     */\n+    private static HashMap<String, String> otherCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data and have the\n+        same name as a different currency.  This differs from\n+        obsoleteCurrencyMap because both of these codes exist in the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTExOTc0MA=="}, "originalCommit": {"oid": "d508ac5b4565acd38ff2d6b0bcff4429dc4d5ecd"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NjQxMw==", "bodyText": "There are other currencies to add text for that come from BtcPay, so I will add those also.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r367176413", "createdAt": "2020-01-16T00:26:58Z", "author": {"login": "HashEngineering"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Copyright 2019 Dash Core Group\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dash.wallet.common.data;\n+\n+import android.annotation.TargetApi;\n+import android.os.Build;\n+\n+import java.util.Currency;\n+import java.util.HashMap;\n+\n+/**\n+    @author: Eric Britten\n+ */\n+\n+public class CurrencyInfo {\n+\n+    /*\n+        Older android devices will have obsolete currency codes\n+        that do not match what the prices sources currently used.\n+\n+        e.g. in Belarus (BY), the currency changed from BYR to BYN\n+        at the end of 2016.  Older phones have BYR.\n+\n+        This app will read BYR from the device and then query BYN\n+        in the exchange rates list, but must get the name of BYR\n+        from the device.\n+     */\n+    private static HashMap<String, String> obsoleteCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data, but are not\n+        ISO 4217 currency codes.  This will map those codes to the\n+        currency names.\n+     */\n+    private static HashMap<String, String> otherCurrencyMap;\n+\n+    /*\n+        These currencies are listed in the price data and have the\n+        same name as a different currency.  This differs from\n+        obsoleteCurrencyMap because both of these codes exist in the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTExOTc0MA=="}, "originalCommit": {"oid": "d508ac5b4565acd38ff2d6b0bcff4429dc4d5ecd"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2OTIwMDg5OnYy", "diffSide": "RIGHT", "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwNzoxNjozNVrOFeP6fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNDoxNToyMVrOFffqQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI2MjMzNQ==", "bodyText": "Will not be used I suppose? afc6bd3#diff-d59db2bdbe7841e4cb222c288bc4e156R76", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r367262335", "createdAt": "2020-01-16T07:16:35Z", "author": {"login": "dn-l"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -60,15 +60,20 @@\n \n     static {\n         obsoleteCurrencyMap = new HashMap<>();\n-        obsoleteCurrencyMap.put(\"BYR\", \"BYN\");\n+        obsoleteCurrencyMap.put(\"BYR\", \"BYN\"); // Belarus Ruble, changed in 2016\n+        obsoleteCurrencyMap.put(\"MRO\", \"MRU\"); // Mauritania Ouguiya, changed in 2018\n \n         otherCurrencyMap = new HashMap<>();\n         otherCurrencyMap.put(\"VES\", \"Venezuelan Bol\u00edvar\");\n         otherCurrencyMap.put(\"GGP\", \"Guernsey Pound\");\n         otherCurrencyMap.put(\"JEP\", \"Jersey Pound\");\n         otherCurrencyMap.put(\"IMP\", \"Isle of Man Pound\");\n         otherCurrencyMap.put(\"USDC\", \"USD Coin\");\n-\n+        otherCurrencyMap.put(\"LTC\", \"Litecoin\");\n+        otherCurrencyMap.put(\"ETH\", \"Etherium\");\n+        otherCurrencyMap.put(\"BTC\", \"Bitcoin\");\n+        otherCurrencyMap.put(\"PAX\", \"Paxos Standard\");\n+        otherCurrencyMap.put(\"GUSD\", \"Gemini Dollar\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afc6bd3719960f8810489950a47e0c3b0026e5ec"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU2ODg5Ng==", "bodyText": "There is one currency, USDT, that will be 4 letters long.  This check will prevent the exception that occurs for currency codes that are not 3 letters.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r368568896", "createdAt": "2020-01-20T14:15:21Z", "author": {"login": "HashEngineering"}, "path": "common/src/main/java/org/dash/wallet/common/data/CurrencyInfo.java", "diffHunk": "@@ -60,15 +60,20 @@\n \n     static {\n         obsoleteCurrencyMap = new HashMap<>();\n-        obsoleteCurrencyMap.put(\"BYR\", \"BYN\");\n+        obsoleteCurrencyMap.put(\"BYR\", \"BYN\"); // Belarus Ruble, changed in 2016\n+        obsoleteCurrencyMap.put(\"MRO\", \"MRU\"); // Mauritania Ouguiya, changed in 2018\n \n         otherCurrencyMap = new HashMap<>();\n         otherCurrencyMap.put(\"VES\", \"Venezuelan Bol\u00edvar\");\n         otherCurrencyMap.put(\"GGP\", \"Guernsey Pound\");\n         otherCurrencyMap.put(\"JEP\", \"Jersey Pound\");\n         otherCurrencyMap.put(\"IMP\", \"Isle of Man Pound\");\n         otherCurrencyMap.put(\"USDC\", \"USD Coin\");\n-\n+        otherCurrencyMap.put(\"LTC\", \"Litecoin\");\n+        otherCurrencyMap.put(\"ETH\", \"Etherium\");\n+        otherCurrencyMap.put(\"BTC\", \"Bitcoin\");\n+        otherCurrencyMap.put(\"PAX\", \"Paxos Standard\");\n+        otherCurrencyMap.put(\"GUSD\", \"Gemini Dollar\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI2MjMzNQ=="}, "originalCommit": {"oid": "afc6bd3719960f8810489950a47e0c3b0026e5ec"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTgyMDE0OnYy", "diffSide": "RIGHT", "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOTozMjo1MFrOFgGNSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQyMTo1NzozMFrOFgKJjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIwMDQ1Ng==", "bodyText": "Please remove empty spaces.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r369200456", "createdAt": "2020-01-21T19:32:50Z", "author": {"login": "sambarboza"}, "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -1080,24 +1082,70 @@ private void detectUserCountry() {\n         try {\n             final TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);\n             final String simCountry = tm.getSimCountryIso();\n+\n+            log.info(\"Detecting currency based on device, mobile network or locale:\");\n             if (simCountry != null && simCountry.length() == 2) { // SIM country code is available\n+                log.info(\"Device Sim Country: \" + simCountry);\n                 updateCurrencyExchange(simCountry.toUpperCase());\n             } else if (tm.getPhoneType() != TelephonyManager.PHONE_TYPE_CDMA) { // device is not 3G (would be unreliable)\n                 String networkCountry = tm.getNetworkCountryIso();\n+                log.info(\"Network Country: \" + simCountry);\n                 if (networkCountry != null && networkCountry.length() == 2) { // network country code is available\n                     updateCurrencyExchange(networkCountry.toUpperCase());\n                 } else {\n                     //Couldn't obtain country code - Use Default\n                     if (config.getExchangeCurrencyCode() == null)\n-                        config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                        setDefaultCurrency();\n                 }\n             } else {\n                 //No cellular network - Wifi Only\n                 if (config.getExchangeCurrencyCode() == null)\n-                    config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                    setDefaultCurrency();\n             }\n         } catch (Exception e) {\n             //fail safe\n+            log.info(\"NMA-243:  Exception thrown obtaining Locale information: \", e);\n+            if (config.getExchangeCurrencyCode() == null)\n+                setDefaultCurrency();\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afc6bd3719960f8810489950a47e0c3b0026e5ec"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTI1MDYxMw==", "bodyText": "This will be done before merging.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r369250613", "createdAt": "2020-01-21T21:24:46Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -1080,24 +1082,70 @@ private void detectUserCountry() {\n         try {\n             final TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);\n             final String simCountry = tm.getSimCountryIso();\n+\n+            log.info(\"Detecting currency based on device, mobile network or locale:\");\n             if (simCountry != null && simCountry.length() == 2) { // SIM country code is available\n+                log.info(\"Device Sim Country: \" + simCountry);\n                 updateCurrencyExchange(simCountry.toUpperCase());\n             } else if (tm.getPhoneType() != TelephonyManager.PHONE_TYPE_CDMA) { // device is not 3G (would be unreliable)\n                 String networkCountry = tm.getNetworkCountryIso();\n+                log.info(\"Network Country: \" + simCountry);\n                 if (networkCountry != null && networkCountry.length() == 2) { // network country code is available\n                     updateCurrencyExchange(networkCountry.toUpperCase());\n                 } else {\n                     //Couldn't obtain country code - Use Default\n                     if (config.getExchangeCurrencyCode() == null)\n-                        config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                        setDefaultCurrency();\n                 }\n             } else {\n                 //No cellular network - Wifi Only\n                 if (config.getExchangeCurrencyCode() == null)\n-                    config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                    setDefaultCurrency();\n             }\n         } catch (Exception e) {\n             //fail safe\n+            log.info(\"NMA-243:  Exception thrown obtaining Locale information: \", e);\n+            if (config.getExchangeCurrencyCode() == null)\n+                setDefaultCurrency();\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIwMDQ1Ng=="}, "originalCommit": {"oid": "afc6bd3719960f8810489950a47e0c3b0026e5ec"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTI2NTAzNg==", "bodyText": "This has been fixed.", "url": "https://github.com/dashevo/dash-wallet/pull/298#discussion_r369265036", "createdAt": "2020-01-21T21:57:30Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -1080,24 +1082,70 @@ private void detectUserCountry() {\n         try {\n             final TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);\n             final String simCountry = tm.getSimCountryIso();\n+\n+            log.info(\"Detecting currency based on device, mobile network or locale:\");\n             if (simCountry != null && simCountry.length() == 2) { // SIM country code is available\n+                log.info(\"Device Sim Country: \" + simCountry);\n                 updateCurrencyExchange(simCountry.toUpperCase());\n             } else if (tm.getPhoneType() != TelephonyManager.PHONE_TYPE_CDMA) { // device is not 3G (would be unreliable)\n                 String networkCountry = tm.getNetworkCountryIso();\n+                log.info(\"Network Country: \" + simCountry);\n                 if (networkCountry != null && networkCountry.length() == 2) { // network country code is available\n                     updateCurrencyExchange(networkCountry.toUpperCase());\n                 } else {\n                     //Couldn't obtain country code - Use Default\n                     if (config.getExchangeCurrencyCode() == null)\n-                        config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                        setDefaultCurrency();\n                 }\n             } else {\n                 //No cellular network - Wifi Only\n                 if (config.getExchangeCurrencyCode() == null)\n-                    config.setExchangeCurrencyCode(Constants.DEFAULT_EXCHANGE_CURRENCY);\n+                    setDefaultCurrency();\n             }\n         } catch (Exception e) {\n             //fail safe\n+            log.info(\"NMA-243:  Exception thrown obtaining Locale information: \", e);\n+            if (config.getExchangeCurrencyCode() == null)\n+                setDefaultCurrency();\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIwMDQ1Ng=="}, "originalCommit": {"oid": "afc6bd3719960f8810489950a47e0c3b0026e5ec"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 693, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}