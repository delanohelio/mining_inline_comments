{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NTA2NTU0", "number": 501, "title": "NMA-407 - Scan QR Code | Strangers", "bodyText": "Issue being fixed or feature implemented\n\n\n\nRelated PR's and Dependencies\n\nScreenshots / Videos\n\nHow Has This Been Tested?\n\n\n\n\n QA (Mobile Team)\n\nChecklist:\n\n\n I have performed a self-review of my own code and added comments where necessary\n I have added or updated relevant unit/integration/functional/e2e tests", "createdAt": "2020-09-02T01:29:08Z", "url": "https://github.com/dashevo/dash-wallet/pull/501", "merged": true, "mergeCommit": {"oid": "0ab8a9264de1ccda93fe824c42b9ff5a148c312a"}, "closed": true, "closedAt": "2020-09-11T00:12:38Z", "author": {"login": "sambarboza"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5ieaCgH2gAyNDc3NTA2NTU0OjA2OThmMTA2OTE0MDFhMmY2NGQyMjI4NjEwN2QyZWY1MThlZTU3NzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHp_4HgFqTQ4NjM5MTA5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0698f10691401a2f64d22286107d2ef518ee5775", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/0698f10691401a2f64d22286107d2ef518ee5775", "committedDate": "2020-07-29T03:29:45Z", "message": "Removing wallet fragment before recreating activity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f0887126c03331e63c5729290419fcbb5575141", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/6f0887126c03331e63c5729290419fcbb5575141", "committedDate": "2020-07-30T13:41:11Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bbb7598abab4ffc34bd3c578cda2496b50c0421", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/6bbb7598abab4ffc34bd3c578cda2496b50c0421", "committedDate": "2020-08-05T17:08:30Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42c99c400b9faed66507cd112361e0eb460cd554", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/42c99c400b9faed66507cd112361e0eb460cd554", "committedDate": "2020-08-06T18:55:08Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af16683d92f479f92f64fa02ef78592c37abbd44", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/af16683d92f479f92f64fa02ef78592c37abbd44", "committedDate": "2020-08-18T00:28:48Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTQ1Mzgx", "url": "https://github.com/dashevo/dash-wallet/pull/501#pullrequestreview-480945381", "createdAt": "2020-09-02T15:32:05Z", "commit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozMjowNlrOHL1C1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozMjowNlrOHL1C1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NTQ2MQ==", "bodyText": "This should be a liveData similar to searchUsernames/searchUsernamesLiveData.\nIf a user scans one user's QR code follows by a second QR code that results in an error, then once the payment completes, the first user's profile page will be displayed.", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482165461", "createdAt": "2020-09-02T15:32:06Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/dashpay/DashPayViewModel.kt", "diffHunk": "@@ -96,6 +96,16 @@ class DashPayViewModel(application: Application) : AndroidViewModel(application)\n         userSearchLiveData.value = text\n     }\n \n+    fun loadUser(username: String) {\n+        getUserLiveData.value = username\n+        viewModelScope.launch(Dispatchers.IO) {\n+            val result = platformRepo.searchUsernames(username, true)\n+            if (result.exception == null && result.data != null && result.data.isNotEmpty()) {\n+                platformRepo.lastLoadedUser = result.data.first()\n+            }\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTQ1ODI3", "url": "https://github.com/dashevo/dash-wallet/pull/501#pullrequestreview-480945827", "createdAt": "2020-09-02T15:32:36Z", "commit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozMjozNlrOHL1EGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozMjozNlrOHL1EGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NTc4NQ==", "bodyText": "great idea.", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482165785", "createdAt": "2020-09-02T15:32:36Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/dashpay/PlatformRepo.kt", "diffHunk": "@@ -164,13 +166,17 @@ class PlatformRepo private constructor(val walletApplication: WalletApplication)\n         }\n     }\n \n+    suspend fun getUser(username: String): Resource<List<UsernameSearchResult>> {\n+        return searchUsernames(username, true)\n+    }\n+\n     /**\n      * gets all the name documents for usernames starting with text\n      *\n      * @param text The beginning of a username to search for\n      * @return\n      */\n-    suspend fun searchUsernames(text: String): Resource<List<UsernameSearchResult>> {\n+    suspend fun searchUsernames(text: String, onlyExactUsername: Boolean = false): Resource<List<UsernameSearchResult>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTQ3NzA1", "url": "https://github.com/dashevo/dash-wallet/pull/501#pullrequestreview-480947705", "createdAt": "2020-09-02T15:34:35Z", "commit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozNDozNlrOHL1Jow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTozNDozNlrOHL1Jow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NzIwMw==", "bodyText": "lastLoadedUser should come from observing liveData. https://github.com/dashevo/dash-wallet/pull/501/files#r482165461", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482167203", "createdAt": "2020-09-02T15:34:36Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/TransactionResultActivity.kt", "diffHunk": "@@ -164,6 +172,15 @@ class TransactionResultActivity : AbstractWalletActivity() {\n         dashPayViewModel = ViewModelProvider(this).get(DashPayViewModel::class.java)\n     }\n \n+    override fun finish() {\n+        val dashPayUsername = intent.extras?.getString(EXTRA_DASHPAY_USERNAME)\n+        val lastLoadedUser = PlatformRepo.getInstance().lastLoadedUser", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "originalPosition": 73}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTc1Mjk0", "url": "https://github.com/dashevo/dash-wallet/pull/501#pullrequestreview-480975294", "createdAt": "2020-09-02T16:04:33Z", "commit": {"oid": "821007f27568c7c560626e2ca4140f2dfe1429ef"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "committedDate": "2020-09-08T01:25:25Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3622f6c519060a3c379ef8bd9405c2f604b99c6e", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/3622f6c519060a3c379ef8bd9405c2f604b99c6e", "committedDate": "2020-09-08T01:34:04Z", "message": "Added contact suggestion layout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72126ed8b7b6827f2f26be53dd3539b2be033b12", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/72126ed8b7b6827f2f26be53dd3539b2be033b12", "committedDate": "2020-09-08T01:34:04Z", "message": "Showing User activity after paying to qr with username"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c174a3e3f729060862b2a5606bf827cbfbf3aaf8", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/c174a3e3f729060862b2a5606bf827cbfbf3aaf8", "committedDate": "2020-09-08T01:34:05Z", "message": "Showing disclaimer when paying to non-contact"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ff3db55c2958bd9a7344cc9bfd254de7c14ffa8", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/8ff3db55c2958bd9a7344cc9bfd254de7c14ffa8", "committedDate": "2020-09-08T01:34:05Z", "message": "Layout adjustments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "761a51dc9f9b4000883724ffcf0587a18acc5459", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/761a51dc9f9b4000883724ffcf0587a18acc5459", "committedDate": "2020-09-08T01:34:05Z", "message": "Notifications livedata trigger and layout fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3496ae9c2366e14bbeb17c076f8068288946a992", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/3496ae9c2366e14bbeb17c076f8068288946a992", "committedDate": "2020-09-08T01:34:05Z", "message": "organize imports on PaymentIntent.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f92492512e1d9b3bf80554cd0f6c84ea3959125", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/5f92492512e1d9b3bf80554cd0f6c84ea3959125", "committedDate": "2020-09-10T00:35:52Z", "message": "Disclaimer layout and scrolling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MzkxMDkx", "url": "https://github.com/dashevo/dash-wallet/pull/501#pullrequestreview-486391091", "createdAt": "2020-09-11T00:10:35Z", "commit": {"oid": "5f92492512e1d9b3bf80554cd0f6c84ea3959125"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2817, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}