{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MzE4MTgz", "number": 518, "title": "Change order that is used to connect to peers (DNM, seeds, dns seeders)", "bodyText": "Original order: DNS Seeders, DMN Masternode List, Hard coded Seeds which are Masternodes\nNew Order:  DMN Masternode List, Hard coded Seeds which are Masternodes, DNS Seeders (will only be used if the previous two return less than 16 total nodes)\nIssue being fixed or feature implemented\n\n\n\nRelated PR's and Dependencies\n\nNone\nScreenshots / Videos\n\nNone\nHow Has This Been Tested?\n\n\n\n\n QA (Mobile Team)\n\nChecklist:\n\n\n I have performed a self-review of my own code and added comments where necessary\n I have added or updated relevant unit/integration/functional/e2e tests", "createdAt": "2020-10-01T14:45:25Z", "url": "https://github.com/dashevo/dash-wallet/pull/518", "merged": true, "mergeCommit": {"oid": "aad73a6d8b7736cfe031347bacb4486ee35acf72"}, "closed": true, "closedAt": "2020-10-02T02:03:37Z", "author": {"login": "HashEngineering"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOSGqygH2gAyNDk2MzE4MTgzOjUwZWFhMDQ1Mzg5MjkwNDBhOGY1YWEwMzA3MTYwZTczMWNkOTVhOTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOcEA1AH2gAyNDk2MzE4MTgzOjEyZDEyMWRiMmQ1NWZiNmJhMTA5Y2E1ZjZiODFiZjBkZTgzNTVhMGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "50eaa04538929040a8f5aa0307160e731cd95a91", "author": {"user": {"login": "HashEngineering", "name": "Hash Engineering Solutions"}}, "url": "https://github.com/dashevo/dash-wallet/commit/50eaa04538929040a8f5aa0307160e731cd95a91", "committedDate": "2020-10-01T14:17:45Z", "message": "Change order that is used to connect to peers (DNM, seeds, dns seeders)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwODA0NTIx", "url": "https://github.com/dashevo/dash-wallet/pull/518#pullrequestreview-500804521", "createdAt": "2020-10-02T00:48:25Z", "commit": {"oid": "50eaa04538929040a8f5aa0307160e731cd95a91"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMDo0ODoyNVrOHbetyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMDo0ODoyNVrOHbetyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU3Njg0MQ==", "bodyText": "Since 16 is used twice, it could be stored in a variable to ensure consistent usage through the code.", "url": "https://github.com/dashevo/dash-wallet/pull/518#discussion_r498576841", "createdAt": "2020-10-02T00:48:25Z", "author": {"login": "sambarboza"}, "path": "wallet/src/de/schildbach/wallet/service/BlockchainServiceImpl.java", "diffHunk": "@@ -518,34 +518,36 @@ private void check() {\n                         }\n \n                         if (!connectTrustedPeerOnly) {\n+                            // First use the masternode list that is included\n                             try {\n-                                peers.addAll(\n-                                        Arrays.asList(normalPeerDiscovery.getPeers(services, timeoutValue, timeoutUnit)));\n+                                SimplifiedMasternodeList mnlist = org.bitcoinj.core.Context.get().masternodeListManager.getListAtChainTip();\n+                                MasternodePeerDiscovery discovery = new MasternodePeerDiscovery(mnlist);\n+                                peers.addAll(Arrays.asList(discovery.getPeers(services, timeoutValue, timeoutUnit)));\n                             } catch (PeerDiscoveryException x) {\n-                                //swallow and continue with another method of connection.\n-                                log.info(\"DNS peer discovery failed: \"+ x.getMessage());\n-                                if(x.getCause() != null)\n-                                    log.info(  \"cause:  \" + x.getCause().getMessage());\n+                                //swallow and continue with another method of connection\n+                                log.info(\"DMN List peer discovery failed: \"+ x.getMessage());\n                             }\n-                            if(peers.size() < 10) {\n-                                log.info(\"DNS peer discovery returned less than 10 nodes.  Adding DMN peers to the list to increase connections\");\n-                                try {\n-                                    SimplifiedMasternodeList mnlist = org.bitcoinj.core.Context.get().masternodeListManager.getListAtChainTip();\n-                                    MasternodePeerDiscovery discovery = new MasternodePeerDiscovery(mnlist);\n-                                    peers.addAll(Arrays.asList(discovery.getPeers(services, timeoutValue, timeoutUnit)));\n-                                } catch (PeerDiscoveryException x) {\n-                                    //swallow and continue with another method of connection\n-                                    log.info(\"DMN List peer discovery failed: \"+ x.getMessage());\n \n+                            if(peers.size() < 16) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50eaa04538929040a8f5aa0307160e731cd95a91"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12d121db2d55fb6ba109ca5f6b81bf0de8355a0d", "author": {"user": {"login": "HashEngineering", "name": "Hash Engineering Solutions"}}, "url": "https://github.com/dashevo/dash-wallet/commit/12d121db2d55fb6ba109ca5f6b81bf0de8355a0d", "committedDate": "2020-10-02T01:53:54Z", "message": "Use constant for minimum peer count"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2836, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}