{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyNTM0NDU1", "number": 438, "title": "Contact Request UI - Part 1", "bodyText": "Issue being fixed or feature implemented\nShowing user screen when tapping on a user from the search results.\nWhat was done?\n\nCreated layout for User representation when clicking on a result from user search, with its respective sections for sending/accepting contact requests. (DashPayUserActivity)\nFixed small visual bug in SearchUserActivity where the results were being clipped at the end of the screen. (activity_search_dashpay_profile\u2026)\nAdded fromDocument method in DashPayProfile class to allow its creation from a Platform Document.\nCreated UserAvatarPlaceholderDrawable class to show a default avatar image with the first letter of the username. This class is being used at home screen, search results and user screen. (HeaderBalanceFragment, UsernameSearchResultsAdapter, DashPayUserActivity)", "createdAt": "2020-06-10T15:28:35Z", "url": "https://github.com/dashevo/dash-wallet/pull/438", "merged": true, "mergeCommit": {"oid": "3ac082ed2b0493f09a8307be4216682d298b7512"}, "closed": true, "closedAt": "2020-06-12T21:28:45Z", "author": {"login": "sambarboza"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcp7X7rgH2gAyNDMyNTM0NDU1OjlhMzYyM2VkNTYxYmE0ZDU3ODRkM2RjMTIxODMzYTY3NDNmZDUxNjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqptoXgFqTQzMDA0NjU4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/9a3623ed561ba4d5784d3dc121833a6743fd5168", "committedDate": "2020-06-10T15:27:31Z", "message": "Contact Request UI - Part 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDQ1MjQ1", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428445245", "createdAt": "2020-06-10T21:35:11Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTozNToxMlrOGiHHtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTozNToxMlrOGiHHtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTQyOA==", "bodyText": "In my PR the profileDocument is non-nullable and it is assigned a default \"empty\" profile if no profile exists.  In the database, we will be storing the username associated with a profile.\nThis does not need to be changed in this PR.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438421428", "createdAt": "2020-06-10T21:35:12Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/data/UsernameSearchResult.kt", "diffHunk": "@@ -9,8 +9,10 @@ import org.dashevo.dpp.document.Document\n \n data class UsernameSearchResult(val username: String,\n                                 val domainDocument: Document,\n+                                //TODO: Make non-nullable after profile creation is implemented in iOS\n+                                val profileDocument: Document?,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDQ1NTM2", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428445536", "createdAt": "2020-06-10T21:35:43Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTozNTo0M1rOGiHIng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTozNTo0M1rOGiHIng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyMTY2Mg==", "bodyText": "In my PR, I also renamed these, but I like these names better.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438421662", "createdAt": "2020-06-10T21:35:43Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/data/UsernameSearchResult.kt", "diffHunk": "@@ -9,8 +9,10 @@ import org.dashevo.dpp.document.Document\n \n data class UsernameSearchResult(val username: String,\n                                 val domainDocument: Document,\n+                                //TODO: Make non-nullable after profile creation is implemented in iOS\n+                                val profileDocument: Document?,\n                                 val toContactRequest: Document?,\n                                 val fromContactRequest: Document?) {\n-    val hasRequested = toContactRequest != null\n-    val hasAccepted = fromContactRequest != null\n+    val requestSent = toContactRequest != null\n+    val requestReceived = fromContactRequest != null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU0MjUw", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428454250", "createdAt": "2020-06-10T21:52:07Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1MjowN1rOGiHkQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1MjowN1rOGiHkQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyODczNw==", "bodyText": "This file might be useful in my Contact Request Row.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438428737", "createdAt": "2020-06-10T21:52:07Z", "author": {"login": "HashEngineering"}, "path": "ui-redesign/src/main/res/drawable/medium_gray_button.xml", "diffHunk": "@@ -0,0 +1,21 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<selector xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+    <item android:state_enabled=\"false\">\n+        <shape android:shape=\"rectangle\">\n+            <corners android:radius=\"10dp\" />\n+            <solid android:color=\"@color/dash_light_gray\" />\n+        </shape>\n+    </item>\n+    <item android:state_pressed=\"true\">\n+        <shape android:shape=\"rectangle\">\n+            <corners android:radius=\"10dp\" />\n+            <solid android:color=\"@color/dash_gray\" />\n+        </shape>\n+    </item>\n+    <item>\n+        <shape android:shape=\"rectangle\">\n+            <corners android:radius=\"10dp\" />\n+            <solid android:color=\"@color/dash_medium_gray\" />\n+        </shape>\n+    </item>\n+</selector>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU1NDEx", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428455411", "createdAt": "2020-06-10T21:54:31Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1NDozMVrOGiHn9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1NDozMVrOGiHn9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyOTY4NQ==", "bodyText": "On my PR, I added the username to the profile so there is an associated between userId and username.  I like the fromDocument method which will probably get used a lot.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438429685", "createdAt": "2020-06-10T21:54:31Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/data/DashPayProfile.kt", "diffHunk": "@@ -1,8 +1,25 @@\n package de.schildbach.wallet.data\n \n+import android.os.Parcelable\n import androidx.room.Entity\n import androidx.room.PrimaryKey\n+import kotlinx.android.parcel.Parcelize\n+import org.dashevo.dpp.document.Document\n \n+@Parcelize\n @Entity(tableName = \"dashpay_profile\")\n data class DashPayProfile(@PrimaryKey val userId: String, val displayName: String,\n-                          val publicMessage: String, val avatarUrl: String)\n\\ No newline at end of file\n+                          val publicMessage: String, val avatarUrl: String) : Parcelable {\n+    companion object {\n+        fun fromDocument(document: Document): DashPayProfile? {\n+            return try {\n+                DashPayProfile(document.userId,\n+                        document.data[\"displayName\"] as String,\n+                        document.data[\"publicMessage\"] as String,\n+                        document.data[\"avatarUrl\"] as String)\n+            } catch (e: Exception) {\n+                null\n+            }\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU2NDM2", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428456436", "createdAt": "2020-06-10T21:56:33Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1NjozM1rOGiHrIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1NjozM1rOGiHrIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzMDQ5Ng==", "bodyText": "This will be used instead of my method in my PR.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438430496", "createdAt": "2020-06-10T21:56:33Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/HeaderBalanceFragment.java", "diffHunk": "@@ -201,23 +201,8 @@ private void setDefaultUserAvatar(String letters) {\n             return;\n         }\n         dashpayUserAvatar.setVisibility(View.VISIBLE);\n-        float[] hsv = new float[3];\n-        //Ascii codes for A: 65 - Z: 90, 0: 48 - 9: 57\n-        float firstChar = letters.charAt(0);\n-        float charIndex;\n-        if (firstChar <= 57) { //57 == '9' in Ascii table\n-            charIndex = (firstChar - 48f) / 36f; // 48 == '0', 36 == total count of supported\n-        } else {\n-            charIndex = (firstChar - 65f + 10f) / 36f; // 65 == 'A', 10 == count of digits\n-        }\n-        hsv[0] = charIndex * 360f;\n-        hsv[1] = 0.3f;\n-        hsv[2] = 0.6f;\n-        int bgColor = Color.HSVToColor(hsv);\n-        final TextDrawable defaultAvatar = TextDrawable.builder().beginConfig().textColor(Color.WHITE)\n-                .useFont(ResourcesCompat.getFont(getContext(), R.font.montserrat_regular))\n-                .endConfig().buildRound(letters, bgColor);\n-        dashpayUserAvatar.setBackground(defaultAvatar);\n+        dashpayUserAvatar.setBackground(UserAvatarPlaceholderDrawable.getDrawable(getContext(),\n+                letters.charAt(0)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU3MTI1", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428457125", "createdAt": "2020-06-10T21:57:53Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1Nzo1M1rOGiHtSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1Nzo1M1rOGiHtSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzMTA1MA==", "bodyText": "Good point on the 100 items.", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438431050", "createdAt": "2020-06-10T21:57:53Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/dashpay/PlatformRepo.kt", "diffHunk": "@@ -96,7 +97,13 @@ class PlatformRepo(val walletApplication: WalletApplication) {\n             val creditFundingTx = wallet.getCreditFundingTransaction(wallet.getTransaction(blockchainIdentity!!.creditFundingTxId))\n             val userId = creditFundingTx.creditBurnIdentityIdentifier.toStringBase58()\n             // Names.search does support retrieving 100 names at a time if retrieveAll = false\n-            val nameDocuments = platform.names.search(text, Names.DEFAULT_PARENT_DOMAIN, true)\n+            //TODO: Maybe add pagination later? Is very unlikely that a user will scroll past 100 search results", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU3ODI5", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428457829", "createdAt": "2020-06-10T21:59:24Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1OToyNFrOGiHvbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMTo1OToyNFrOGiHvbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzMTU5Nw==", "bodyText": "This could use DashPayProfile.fromDocument()", "url": "https://github.com/dashevo/dash-wallet/pull/438#discussion_r438431597", "createdAt": "2020-06-10T21:59:24Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/dashpay/PlatformRepo.kt", "diffHunk": "@@ -378,7 +387,7 @@ class PlatformRepo(val walletApplication: WalletApplication) {\n             // blockchainIdentity doesn't yet keep track of the profile, so we will load it\n             // into the database directly\n             val dashPayProfile = DashPayProfile(blockchainIdentity.uniqueIdString,\n-                    profile!!.data[\"displayName\"] as String,\n+                    profile.data[\"displayName\"] as String,\n                     profile.data[\"publicMessage\"] as String,\n                     profile.data[\"avatarUrl\"] as String)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDU4OTg4", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-428458988", "createdAt": "2020-06-10T22:01:42Z", "commit": {"oid": "9a3623ed561ba4d5784d3dc121833a6743fd5168"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6783a04d42461b98658f9f189f6ac791ffb53617", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/6783a04d42461b98658f9f189f6ac791ffb53617", "committedDate": "2020-06-12T16:59:59Z", "message": "Manifest inclusion and repo small change\n\n- Added DashPayUserActivity in AndroidManifest.xml\n- Using DashPayProfile.fromDocument in PlatformRepo profile recovery method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ddbcf97a96e1e441f57d2d985886724f3ab1700", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/9ddbcf97a96e1e441f57d2d985886724f3ab1700", "committedDate": "2020-06-12T17:13:13Z", "message": "Removing obsolete TODO\n\n- Profile creation will not be enforced."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5bcb9026cb5099adceba5d8c1519193ee97a7c2", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/a5bcb9026cb5099adceba5d8c1519193ee97a7c2", "committedDate": "2020-06-12T17:18:17Z", "message": "Added TODO regarding contact request mocked states"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDQ2NTgx", "url": "https://github.com/dashevo/dash-wallet/pull/438#pullrequestreview-430046581", "createdAt": "2020-06-12T21:26:51Z", "commit": {"oid": "a5bcb9026cb5099adceba5d8c1519193ee97a7c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2932, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}