{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2NDkxMDE3", "number": 519, "title": "NMA-615 | Contacts Page | Unregistered Users", "bodyText": "Issue being fixed or feature implemented\n\n\n\nRelated PR's and Dependencies\n\nScreenshots / Videos\n\nHow Has This Been Tested?\n\n\n\n\n QA (Mobile Team)\n\nChecklist:\n\n\n I have performed a self-review of my own code and added comments where necessary\n I have added or updated relevant unit/integration/functional/e2e tests", "createdAt": "2020-10-01T19:18:42Z", "url": "https://github.com/dashevo/dash-wallet/pull/519", "merged": true, "mergeCommit": {"oid": "19a683edb64a1839652a053fb4552d113375ca05"}, "closed": true, "closedAt": "2020-10-06T21:27:41Z", "author": {"login": "sambarboza"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5ieaCgH2gAyNDk2NDkxMDE3OjA2OThmMTA2OTE0MDFhMmY2NGQyMjI4NjEwN2QyZWY1MThlZTU3NzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP9okMgFqTUwMzI5NTAwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0698f10691401a2f64d22286107d2ef518ee5775", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/0698f10691401a2f64d22286107d2ef518ee5775", "committedDate": "2020-07-29T03:29:45Z", "message": "Removing wallet fragment before recreating activity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f0887126c03331e63c5729290419fcbb5575141", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/6f0887126c03331e63c5729290419fcbb5575141", "committedDate": "2020-07-30T13:41:11Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bbb7598abab4ffc34bd3c578cda2496b50c0421", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/6bbb7598abab4ffc34bd3c578cda2496b50c0421", "committedDate": "2020-08-05T17:08:30Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42c99c400b9faed66507cd112361e0eb460cd554", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/42c99c400b9faed66507cd112361e0eb460cd554", "committedDate": "2020-08-06T18:55:08Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af16683d92f479f92f64fa02ef78592c37abbd44", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/af16683d92f479f92f64fa02ef78592c37abbd44", "committedDate": "2020-08-18T00:28:48Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "committedDate": "2020-09-08T01:25:25Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "909ef0b512a0e9bc746c3f4936a3c8972d7fd476", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/909ef0b512a0e9bc746c3f4936a3c8972d7fd476", "committedDate": "2020-09-11T03:25:05Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4ce62cf12bccc17c7b3e3c89301788ec4bd0b16", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/e4ce62cf12bccc17c7b3e3c89301788ec4bd0b16", "committedDate": "2020-09-21T15:26:17Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "262c0bf6fd7c13751bea713a8b00ed1ba421f394", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/262c0bf6fd7c13751bea713a8b00ed1ba421f394", "committedDate": "2020-09-24T20:38:27Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80e59323720417df7fe10d1c42b1faba92391335", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/80e59323720417df7fe10d1c42b1faba92391335", "committedDate": "2020-09-29T16:50:21Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "088bbbb359610f4e4e7c5df6c0a4dae3ef69ea2c", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/088bbbb359610f4e4e7c5df6c0a4dae3ef69ea2c", "committedDate": "2020-10-01T18:42:52Z", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da1f349dc829fc9dbfb81c67d1807d8999022010", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/da1f349dc829fc9dbfb81c67d1807d8999022010", "committedDate": "2020-10-01T18:45:08Z", "message": "Upgrade to Evolution page."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/de3d53e2ab7a86e9f8b9801a192abf49314d506d", "committedDate": "2020-10-01T19:17:13Z", "message": "Removed commented code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzUzNDc3", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-500753477", "createdAt": "2020-10-01T22:13:19Z", "commit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMjoxMzoxOVrOHbcXhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMjoxMzoxOVrOHbcXhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUzODM3NQ==", "bodyText": "blockchainIdentityDataDao was renamed blockchainIdentityDataDaoAsync.  This PR must be based on an older commit from the evonet-develop branch.\nNot sure why this doesn't have a merge conflict.", "url": "https://github.com/dashevo/dash-wallet/pull/519#discussion_r498538375", "createdAt": "2020-10-01T22:13:19Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/ui/MainActivity.kt", "diffHunk": "@@ -115,6 +134,32 @@ class MainActivity : AbstractBindServiceActivity(), ActivityCompat.OnRequestPerm\n         handleIntent(intent!!)\n     }\n \n+    override fun onWalletFragmentViewCreated() {\n+        AppDatabase.getAppDatabase().blockchainStateDao().load().observe(this, Observer {\n+            blockchainState = it\n+            walletFragment.setBlockchainState(blockchainState)\n+        })\n+        dashPayViewModel = ViewModelProvider(this)[DashPayViewModel::class.java]\n+        dashPayViewModel!!.isPlatformAvailableLiveData.observe(this, Observer<Resource<Boolean?>?> { status ->\n+            if (status?.status === Status.SUCCESS) {\n+                if (status.data != null) {\n+                    isPlatformAvailable = status.data\n+                }\n+            } else {\n+                isPlatformAvailable = false\n+            }\n+            walletFragment.setPlatformAvailability(isPlatformAvailable)\n+        })\n+        AppDatabase.getAppDatabase().blockchainIdentityDataDao().loadBase().observe(this,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzU3MTg0", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-500757184", "createdAt": "2020-10-01T22:21:29Z", "commit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMjoyMToyOVrOHbchwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMjoyMToyOVrOHbchwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU0MDk5Mw==", "bodyText": "My question is not related to this PR, but what happens when the user only has 0.01 DASH and they try to register.  Will it succeed or fail?  The reason for the question is that there is a fee that is required to send the transaction.  Though, in the case of sending all the value, then the fee may be taken out of the 0.01.  What if the balance is 0.01 - something less than the fee?  We can have QA figure this out and make a new ticket if there is a problem.", "url": "https://github.com/dashevo/dash-wallet/pull/519#discussion_r498540993", "createdAt": "2020-10-01T22:21:29Z", "author": {"login": "HashEngineering"}, "path": "wallet/src/de/schildbach/wallet/util/WalletExtensions.kt", "diffHunk": "@@ -0,0 +1,11 @@\n+package de.schildbach.wallet.util\n+\n+import de.schildbach.wallet.Constants\n+import org.bitcoinj.core.Coin\n+import org.bitcoinj.wallet.Wallet\n+\n+fun Wallet.canAffordIdentityCreation(): Boolean {\n+    val walletBalance: Coin = getBalance(Wallet.BalanceType.ESTIMATED)\n+    return (walletBalance.isGreaterThan(Constants.DASH_PAY_FEE)\n+            || walletBalance == Constants.DASH_PAY_FEE)\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzU4Nzcx", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-500758771", "createdAt": "2020-10-01T22:25:16Z", "commit": {"oid": "de3d53e2ab7a86e9f8b9801a192abf49314d506d"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "964b74e840cd75422b5beaaee8e6c853f207c2c8", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/964b74e840cd75422b5beaaee8e6c853f207c2c8", "committedDate": "2020-10-02T00:59:46Z", "message": "Using Async version of db fetch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a50998a37768e18387caa24207f9b0606f60333f", "author": {"user": {"login": "sambarboza", "name": "Sam B."}}, "url": "https://github.com/dashevo/dash-wallet/commit/a50998a37768e18387caa24207f9b0606f60333f", "committedDate": "2020-10-02T01:36:36Z", "message": "Fixed stuck contacts icon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef6db8aabc49cef4ebfca621df5ca163ce24e5da", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/ef6db8aabc49cef4ebfca621df5ca163ce24e5da", "committedDate": "2020-10-02T08:06:42Z", "message": "Replaced old school callbacks-based communication model between activity and fragments with modern one based on shared view model."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwOTUyODY1", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-500952865", "createdAt": "2020-10-02T08:34:46Z", "commit": {"oid": "ef6db8aabc49cef4ebfca621df5ca163ce24e5da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwODozNDo0NlrOHbldtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwODozNDo0NlrOHbldtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY4NzQxMg==", "bodyText": "Those empty observers could be replaced by other way of triggering data loading but let's leave it as it is\nI'll fix it when working on \"JoinDash\" shortcut when #516 in merged (it will be merged after this PR)", "url": "https://github.com/dashevo/dash-wallet/pull/519#discussion_r498687412", "createdAt": "2020-10-02T08:34:46Z", "author": {"login": "tomasz-ludek"}, "path": "wallet/src/de/schildbach/wallet/ui/MainActivity.kt", "diffHunk": "@@ -102,6 +115,21 @@ class MainActivity : AbstractBindServiceActivity(), ActivityCompat.OnRequestPerm\n         setupBottomNavigation()\n     }\n \n+    fun initViewModel() {\n+        viewModel = ViewModelProvider(this)[MainActivityViewModel::class.java]\n+        viewModel.blockchainStateData.observe(this, Observer {\n+            // just to trigger data loading\n+        })\n+        viewModel.isPlatformAvailableData.observe(this, Observer {\n+            // just to trigger data loading\n+        })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6db8aabc49cef4ebfca621df5ca163ce24e5da"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwOTU0NTU0", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-500954554", "createdAt": "2020-10-02T08:37:21Z", "commit": {"oid": "ef6db8aabc49cef4ebfca621df5ca163ce24e5da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwODozNzoyMlrOHbli0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwODozNzoyMlrOHbli0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODY4ODcyMA==", "bodyText": "this shouldn't be needed when using LiveDatas", "url": "https://github.com/dashevo/dash-wallet/pull/519#discussion_r498688720", "createdAt": "2020-10-02T08:37:22Z", "author": {"login": "tomasz-ludek"}, "path": "wallet/src/de/schildbach/wallet/ui/WalletFragment.kt", "diffHunk": "@@ -119,27 +132,7 @@ class WalletFragment : Fragment() {\n         showHideJoinDashPayAction()\n     }\n \n-    fun setBlockchainState(blockchainState: BlockchainState?) {\n-        this.blockchainState = blockchainState\n-        if (isDetached || !isVisible) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6db8aabc49cef4ebfca621df5ca163ce24e5da"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cc66d32afe546523d074e6215bb63b195b9ce90", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/3cc66d32afe546523d074e6215bb63b195b9ce90", "committedDate": "2020-10-02T10:34:39Z", "message": "Further improvements of MainActivityViewModel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "620cc9858f40d2b05116981a3d2025669f5564bd", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/620cc9858f40d2b05116981a3d2025669f5564bd", "committedDate": "2020-10-02T10:48:28Z", "message": "Minor code refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd1d505b5bb5d3f79755cf828133984f3982c588", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/cd1d505b5bb5d3f79755cf828133984f3982c588", "committedDate": "2020-10-06T11:35:58Z", "message": "Merge branch 'master-into-evonet-develop' into dashpay-contacts-page-no-user\n\n# Conflicts:\n#\twallet/res/values-th/strings-extra.xml\n#\twallet/src/de/schildbach/wallet/ui/WalletFragment.kt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f7afd4f4989fc44a4350d5809068ca2f2c72b26", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/5f7afd4f4989fc44a4350d5809068ca2f2c72b26", "committedDate": "2020-10-06T15:59:20Z", "message": "Merge branch 'evonet-develop' into dashpay-contacts-page-no-user"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b912e2c10c01ff186adb06a36d489a1a760e6979", "author": {"user": {"login": "tomasz-ludek", "name": null}}, "url": "https://github.com/dashevo/dash-wallet/commit/b912e2c10c01ff186adb06a36d489a1a760e6979", "committedDate": "2020-10-06T17:03:18Z", "message": "Final improvements of handling Join DashPay button visibility.\nMinor code refactoring."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMjk1MDA2", "url": "https://github.com/dashevo/dash-wallet/pull/519#pullrequestreview-503295006", "createdAt": "2020-10-06T19:34:37Z", "commit": {"oid": "b912e2c10c01ff186adb06a36d489a1a760e6979"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2839, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}