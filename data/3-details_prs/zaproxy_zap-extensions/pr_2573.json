{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMjA4ODA3", "number": 2573, "title": "Expose GraphQL Options through the API", "bodyText": "Parse synchronously when using the API or the command line.\nFix script bugs.\nExpose Options through the API.\n  Screenshot \n\n\nSigned-off-by: ricekot ricekot@gmail.com", "createdAt": "2020-10-13T11:15:48Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2573", "merged": true, "mergeCommit": {"oid": "01cd5f45a2c4b08416a2e589d9e569f88ee7d9d7"}, "closed": true, "closedAt": "2020-10-16T11:21:28Z", "author": {"login": "ricekot"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSN5gZgBqjM4NzMxOTg2Nzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTEkd_gFqTUxMDM3OTQzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4db97c5c1f37b6515499d05c332cbeeb126e51e5", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/4db97c5c1f37b6515499d05c332cbeeb126e51e5", "committedDate": "2020-10-13T11:10:36Z", "message": "Expose Options through the API\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "db6a9a75cf6fec0c48b7811595b65a330d47cf30", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/db6a9a75cf6fec0c48b7811595b65a330d47cf30", "committedDate": "2020-10-13T19:38:23Z", "message": "Expose Options through the API\n\n- Expose Options through the API\n- Script Fixes\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db6a9a75cf6fec0c48b7811595b65a330d47cf30", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/db6a9a75cf6fec0c48b7811595b65a330d47cf30", "committedDate": "2020-10-13T19:38:23Z", "message": "Expose Options through the API\n\n- Expose Options through the API\n- Script Fixes\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "0b68c3c23580702af3a3e12a11acc1ec01feffca", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b68c3c23580702af3a3e12a11acc1ec01feffca", "committedDate": "2020-10-13T19:47:33Z", "message": "Expose Options through the API\n\n- Expose Options through the API\n- Script Fixes\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b68c3c23580702af3a3e12a11acc1ec01feffca", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b68c3c23580702af3a3e12a11acc1ec01feffca", "committedDate": "2020-10-13T19:47:33Z", "message": "Expose Options through the API\n\n- Expose Options through the API\n- Script Fixes\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "82297857ca88dbb1435b6c1bc29f5a72ab013e9a", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/82297857ca88dbb1435b6c1bc29f5a72ab013e9a", "committedDate": "2020-10-15T11:30:37Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Provide option to parse asynchronously.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82297857ca88dbb1435b6c1bc29f5a72ab013e9a", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/82297857ca88dbb1435b6c1bc29f5a72ab013e9a", "committedDate": "2020-10-15T11:30:37Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Provide option to parse asynchronously.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "5d88c63d9ac775f4e54279243da23d66b6746a4d", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/5d88c63d9ac775f4e54279243da23d66b6746a4d", "committedDate": "2020-10-15T15:13:41Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Pass synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d88c63d9ac775f4e54279243da23d66b6746a4d", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/5d88c63d9ac775f4e54279243da23d66b6746a4d", "committedDate": "2020-10-15T15:13:41Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Pass synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "3d9683cc3019a09a33b6234c9962042137876931", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3d9683cc3019a09a33b6234c9962042137876931", "committedDate": "2020-10-15T15:17:01Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Pass synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d9683cc3019a09a33b6234c9962042137876931", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3d9683cc3019a09a33b6234c9962042137876931", "committedDate": "2020-10-15T15:17:01Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Pass synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/1243146bd5b1d374ffc790220c61e4fd705d490e", "committedDate": "2020-10-15T15:19:39Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Parse synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NTk2NzY3", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#pullrequestreview-509596767", "createdAt": "2020-10-15T17:11:17Z", "commit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoxMToxOFrOHiR3bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoxNDo0NFrOHiR_Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNjM0OA==", "bodyText": "Core should already log the problem (in any case this should be less than error, since it's bad input not an issue with the code).", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505706348", "createdAt": "2020-10-15T17:11:18Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlParam.java", "diffHunk": "@@ -170,6 +171,17 @@ public ArgsTypeOption getArgsType() {\n         return argsType;\n     }\n \n+    // For generating an API action.\n+    public void setArgsType(String argsType) {\n+        try {\n+            setArgsType(ArgsTypeOption.valueOf(argsType.toUpperCase(Locale.ROOT)));\n+        } catch (IllegalArgumentException e) {\n+            LOG.error('\"' + argsType + \"\\\" is not a valid Arguments Specification Type.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNjM5Nw==", "bodyText": "It should throw as ApiException, otherwise this will be handled as an internal error.", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505706397", "createdAt": "2020-10-15T17:11:22Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlParam.java", "diffHunk": "@@ -170,6 +171,17 @@ public ArgsTypeOption getArgsType() {\n         return argsType;\n     }\n \n+    // For generating an API action.\n+    public void setArgsType(String argsType) {\n+        try {\n+            setArgsType(ArgsTypeOption.valueOf(argsType.toUpperCase(Locale.ROOT)));\n+        } catch (IllegalArgumentException e) {\n+            LOG.error('\"' + argsType + \"\\\" is not a valid Arguments Specification Type.\");\n+            // Rethrow for API.\n+            throw e;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNjc3OA==", "bodyText": "I'd suggest syncGeneration (or other variation), it's more clear what it is for.", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505706778", "createdAt": "2020-10-15T17:12:00Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/java/org/zaproxy/addon/graphql/GraphQlParser.java", "diffHunk": "@@ -50,6 +50,7 @@\n     private final ExtensionGraphQl extensionGraphQl =\n             Control.getSingleton().getExtensionLoader().getExtension(ExtensionGraphQl.class);\n     private final GraphQlParam param = extensionGraphQl.getParam();\n+    private boolean originApi;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNzI1Mg==", "bodyText": "Isn't this true? We might need to change the command line then, the import should be synchronous as well.", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505707252", "createdAt": "2020-10-15T17:12:49Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/javahelp/org/zaproxy/addon/graphql/resources/help/contents/graphql.html", "diffHunk": "@@ -47,8 +64,6 @@ <H2>Command Line</H2>\n <li>-graphqlendurl &lt;url&gt;  : Sets the Endpoint URL</li>\n </ul>\n \n-The definitions will be imported synchronously and any warnings will be displayed on the command line.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNzU4MA==", "bodyText": "The null check needs to be in the left?", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505707580", "createdAt": "2020-10-15T17:13:25Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/zapHomeFiles/scripts/scripts/variant/GraphQL Support.js", "diffHunk": "@@ -10,7 +10,8 @@ function getQuery(msg){\n \tvar query;\n \t\n \tif (header.getMethod() == \"POST\") {\n-\t\tif (header.getHeader(\"Content-Type\").contains(\"application/json\")) {\n+\t\tvar contentTypeHeader = header.getHeader(\"Content-Type\");\n+\t\tif (contentTypeHeader.contains(\"application/json\") || contentTypeHeader == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwODM1NA==", "bodyText": "'' \u2192 [] ?", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#discussion_r505708354", "createdAt": "2020-10-15T17:14:44Z", "author": {"login": "thc202"}, "path": "addOns/graphql/src/main/zapHomeFiles/scripts/scripts/variant/GraphQL Support.js", "diffHunk": "@@ -96,11 +98,11 @@ function getLeafName(helper, nodeName, msg) {\n function getTreePath(helper, msg) {\n \tvar query = getQuery(msg);\n \tif (query == null) {\n-\t\tprint(\"  not GraphQL\");\n+\t\t// print(\"  not GraphQL\");\n \t\treturn null;\t\n \t}\n \tvar uri = msg.getRequestHeader().getURI();\n-\tvar path = uri.getPath().split('/');\n+\tvar path = uri.getPath() != null ? uri.getPath().split('/') : '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e"}, "originalPosition": 66}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff97c68c5fc2f94e3a0014645484c45354ffe5cf", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/ff97c68c5fc2f94e3a0014645484c45354ffe5cf", "committedDate": "2020-10-15T20:33:30Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Parse synchronously when using API or Commandline.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1243146bd5b1d374ffc790220c61e4fd705d490e", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/1243146bd5b1d374ffc790220c61e4fd705d490e", "committedDate": "2020-10-15T15:19:39Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Parse synchronously when using API.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}, "afterCommit": {"oid": "ff97c68c5fc2f94e3a0014645484c45354ffe5cf", "author": {"user": {"login": "ricekot", "name": "Akshath Kothari"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/ff97c68c5fc2f94e3a0014645484c45354ffe5cf", "committedDate": "2020-10-15T20:33:30Z", "message": "Expose Options through the API\n\n- Expose Options through the API.\n- Fix script bugs.\n- Parse synchronously when using API or Commandline.\n\nSigned-off-by: ricekot <ricekot@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzM1NzI5", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#pullrequestreview-510335729", "createdAt": "2020-10-16T10:12:05Z", "commit": {"oid": "ff97c68c5fc2f94e3a0014645484c45354ffe5cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzc5NDMx", "url": "https://github.com/zaproxy/zap-extensions/pull/2573#pullrequestreview-510379431", "createdAt": "2020-10-16T11:21:15Z", "commit": {"oid": "ff97c68c5fc2f94e3a0014645484c45354ffe5cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 317, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}