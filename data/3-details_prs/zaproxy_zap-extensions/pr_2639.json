{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMzUyNDQy", "number": 2639, "title": "Update ascanrulesBeta to take advantage of 2.10 core", "bodyText": "Update scan rules to leverage new Custom Pages functionality.\nUpdate build file to target ZAP 2.10 and leverage the core snapshot library.\nUpdate CHANGELOG with a change note about the updates.\nFix naming mistake on RCE and Source Code Disclosure CVE-2012-1823 scan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com", "createdAt": "2020-12-02T23:25:38Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2639", "merged": true, "mergeCommit": {"oid": "36e6bddd71ff9a344fa45a577a211f8a2bbfa622"}, "closed": true, "closedAt": "2020-12-09T15:59:26Z", "author": {"login": "kingthorin"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiXWRMABqjQwNjQ4NjU0NDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkgkgqgFqTU0ODMwOTc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f59843eb1c617123a81a60653119b8ce25597a68", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/f59843eb1c617123a81a60653119b8ce25597a68", "committedDate": "2020-12-02T23:24:05Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "committedDate": "2020-12-02T23:42:40Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjUwNzM2", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#pullrequestreview-548250736", "createdAt": "2020-12-09T14:41:01Z", "commit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjUyODk4", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#pullrequestreview-548252898", "createdAt": "2020-12-09T14:43:03Z", "commit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzowNFrOICYIVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzoxMFrOICYIog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQxMg==", "bodyText": "The 0 check can be removed, the base messages now have a response always.", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363412", "createdAt": "2020-12-09T14:43:04Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java", "diffHunk": "@@ -101,12 +101,14 @@ public void scan() {\n         }\n \n         int originalStatusCode = getBaseMsg().getResponseHeader().getStatusCode();\n-        if (originalStatusCode == HttpStatusCode.NOT_FOUND || originalStatusCode == 0) {\n+        boolean was404 = isPage404(getBaseMsg());\n+        if (was404 || originalStatusCode == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA==", "bodyText": "Remove? It will be always false. (Same comment for following changes.)", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363490", "createdAt": "2020-12-09T14:43:10Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/58e1536ce6cc3059cceb99fcd7afcf47ae44b999", "committedDate": "2020-12-02T23:42:40Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "a5e8ce6b5362063ddde04d04e864af8dad3b6280", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a5e8ce6b5362063ddde04d04e864af8dad3b6280", "committedDate": "2020-12-09T15:24:22Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5e8ce6b5362063ddde04d04e864af8dad3b6280", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a5e8ce6b5362063ddde04d04e864af8dad3b6280", "committedDate": "2020-12-09T15:24:22Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "c3a161a27a7f01aaf04099831a5fc1215f72645e", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/c3a161a27a7f01aaf04099831a5fc1215f72645e", "committedDate": "2020-12-09T15:29:40Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/1a5601bb99898fce99cec4c1191bbac79037a7e2", "committedDate": "2020-12-09T15:32:23Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3a161a27a7f01aaf04099831a5fc1215f72645e", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/c3a161a27a7f01aaf04099831a5fc1215f72645e", "committedDate": "2020-12-09T15:29:40Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/1a5601bb99898fce99cec4c1191bbac79037a7e2", "committedDate": "2020-12-09T15:32:23Z", "message": "Update to take advantage of 2.10 core\n\n- Update scan rules to leverage new Custom Pages functionality.\n- Update build file to target ZAP 2.10 and leverage the core snapshot\nlibrary.\n- Update CHANGELOG with a change note about the updates.\n- Fix naming mistake on RCE and Source Code Disclosure CVE-2012-1823\nscan rules (the leading 2 on the year had been dropped).\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MzA4NjA0", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#pullrequestreview-548308604", "createdAt": "2020-12-09T15:34:15Z", "commit": {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MzA5NzU3", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#pullrequestreview-548309757", "createdAt": "2020-12-09T15:35:21Z", "commit": {"oid": "1a5601bb99898fce99cec4c1191bbac79037a7e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 252, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}