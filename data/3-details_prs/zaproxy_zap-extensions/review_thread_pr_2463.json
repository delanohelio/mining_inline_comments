{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5NjA0MjE1", "number": 2463, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMTo0MjozNVrOEIlYKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNToyMDo1NVrOEIzvwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NDM2NDU3OnYy", "diffSide": "RIGHT", "path": "addOns/pscanrulesAlpha/CHANGELOG.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMTo0MjozNVrOGoopGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMzoxNToxOFrOGop-Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI2MjEwNQ==", "bodyText": "Please move this up into the Unreleased block, you'll likely need to add a ### Fixed sub-heading as well.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445262105", "createdAt": "2020-06-25T01:42:35Z", "author": {"login": "kingthorin"}, "path": "addOns/pscanrulesAlpha/CHANGELOG.md", "diffHunk": "@@ -22,6 +22,7 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Fixed NullPointerException in Sub Resource Integrity Attribute Missing scan rule (Issue 5789).\n - Minor spacing issue in help content.\n - Base64 Disclosure do not keep looping after identifying a disclosure (Issue 5856), unless the Threshold is set to Low.\n+- Fixed bug where Sub Resource Integrity Attribute Missing scan rule alerts even when HTML asset is inline (Issue 6047).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a31d2f39c9aadeb91a3e12f8e5d1a7d8c7eed9"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI4MzkwNg==", "bodyText": "Will do.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445283906", "createdAt": "2020-06-25T03:15:18Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/CHANGELOG.md", "diffHunk": "@@ -22,6 +22,7 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Fixed NullPointerException in Sub Resource Integrity Attribute Missing scan rule (Issue 5789).\n - Minor spacing issue in help content.\n - Base64 Disclosure do not keep looping after identifying a disclosure (Issue 5856), unless the Threshold is set to Low.\n+- Fixed bug where Sub Resource Integrity Attribute Missing scan rule alerts even when HTML asset is inline (Issue 6047).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI2MjEwNQ=="}, "originalCommit": {"oid": "52a31d2f39c9aadeb91a3e12f8e5d1a7d8c7eed9"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NDM4NTA4OnYy", "diffSide": "RIGHT", "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMTo1NTo0NVrOGoo1jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMzoxNToxMVrOGop-Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI2NTI5Mg==", "bodyText": "The build is failing because of a missing semi-colon here.\n> Task :addOns:pscanrulesAlpha:compileJava FAILED\n/home/travis/build/zaproxy/zap-extensions/addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java:139: error: ';' expected\n        }\n         ^\n1 error", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445265292", "createdAt": "2020-06-25T01:55:45Z", "author": {"login": "kingthorin"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");\n+            } else if (element.getName() == HTMLElementName.LINK) {\n+                return !element.getAttributeValue(\"href\").startsWith(\"data:\");\n+            } else {\n+                return true;\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52a31d2f39c9aadeb91a3e12f8e5d1a7d8c7eed9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI4Mzg4Mg==", "bodyText": "On it, thanks.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445283882", "createdAt": "2020-06-25T03:15:11Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");\n+            } else if (element.getName() == HTMLElementName.LINK) {\n+                return !element.getAttributeValue(\"href\").startsWith(\"data:\");\n+            } else {\n+                return true;\n+            }\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI2NTI5Mg=="}, "originalCommit": {"oid": "52a31d2f39c9aadeb91a3e12f8e5d1a7d8c7eed9"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NDU2NzcxOnYy", "diffSide": "RIGHT", "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMzo1OTo1NlrOGoqj3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNToxMjo1MVrOGo_XLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5MzUzNQ==", "bodyText": "The test fails on this line with a NullPointerException. Not sure why, since the test HTML message includes a \"src\" attribute inside the script. What am I missing?", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445293535", "createdAt": "2020-06-25T03:59:56Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cc919f1e9fc42ed003321ba8fe043250007dacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5NTI4NQ==", "bodyText": "Oh, the failing test wasn't the one I wrote but shouldNotRaiseAlertGivenElementIsInline.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445295285", "createdAt": "2020-06-25T04:07:40Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5MzUzNQ=="}, "originalCommit": {"oid": "4cc919f1e9fc42ed003321ba8fe043250007dacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5NTQ0Mw==", "bodyText": "I'll add null checks in both places.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445295443", "createdAt": "2020-06-25T04:08:20Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5MzUzNQ=="}, "originalCommit": {"oid": "4cc919f1e9fc42ed003321ba8fe043250007dacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQxNjcyNA==", "bodyText": "This (method) is duplicating what SupportedElements does/provides, the scheme check should be added to #getHost(...).", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445416724", "createdAt": "2020-06-25T09:08:36Z", "author": {"login": "thc202"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5MzUzNQ=="}, "originalCommit": {"oid": "4cc919f1e9fc42ed003321ba8fe043250007dacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYzNDM0OA==", "bodyText": "On it, thanks.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445634348", "createdAt": "2020-06-25T15:12:51Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -124,6 +125,20 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n         };\n     }\n \n+    private static Predicate<Element> htmlNotInline() {\n+        // 'else' branch won't ever execute since everything evaluated is a SCRIPT/LINK.\n+        // Leaving it in place for clarity.\n+        return element -> {\n+            if (element.getName() == HTMLElementName.SCRIPT) {\n+                return !element.getAttributeValue(\"src\").startsWith(\"data:\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5MzUzNQ=="}, "originalCommit": {"oid": "4cc919f1e9fc42ed003321ba8fe043250007dacd"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NTY4OTQyOnYy", "diffSide": "RIGHT", "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMDo1Mzo0NlrOGo1i1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNToyNDozNlrOGo_4Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzQ5NA==", "bodyText": "The Base64 value can be trimmed/removed, not meaningful for the test.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445473494", "createdAt": "2020-06-25T10:53:46Z", "author": {"login": "thc202"}, "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "diffHunk": "@@ -208,6 +208,23 @@ public void shouldIgnoreInvalidFormattedHostname() throws HttpMalformedHeaderExc\n         assertThat(alertsRaised.size(), equalTo(1));\n     }\n \n+    @Test\n+    public void shouldNotRaiseAlertGivenHtmlAssetIsInline() throws HttpMalformedHeaderException {\n+        // Given\n+        HttpMessage msg =\n+                buildMessage(\n+                        \"<html><head>\"\n+                                + \"<script src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\"></script>\"\n+                                + \"<link href=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\">\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "437e24f1496ee33349a329f959448824f08fb9b3"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYzNTA2Nw==", "bodyText": "I'll switch to data:text/html payloads so that they're shorter.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445635067", "createdAt": "2020-06-25T15:13:48Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "diffHunk": "@@ -208,6 +208,23 @@ public void shouldIgnoreInvalidFormattedHostname() throws HttpMalformedHeaderExc\n         assertThat(alertsRaised.size(), equalTo(1));\n     }\n \n+    @Test\n+    public void shouldNotRaiseAlertGivenHtmlAssetIsInline() throws HttpMalformedHeaderException {\n+        // Given\n+        HttpMessage msg =\n+                buildMessage(\n+                        \"<html><head>\"\n+                                + \"<script src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\"></script>\"\n+                                + \"<link href=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\">\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzQ5NA=="}, "originalCommit": {"oid": "437e24f1496ee33349a329f959448824f08fb9b3"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYzNzcxMw==", "bodyText": "It's not necessary to change the type, the contents don't affect the outcome of the test so better not have them at all.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445637713", "createdAt": "2020-06-25T15:17:32Z", "author": {"login": "thc202"}, "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "diffHunk": "@@ -208,6 +208,23 @@ public void shouldIgnoreInvalidFormattedHostname() throws HttpMalformedHeaderExc\n         assertThat(alertsRaised.size(), equalTo(1));\n     }\n \n+    @Test\n+    public void shouldNotRaiseAlertGivenHtmlAssetIsInline() throws HttpMalformedHeaderException {\n+        // Given\n+        HttpMessage msg =\n+                buildMessage(\n+                        \"<html><head>\"\n+                                + \"<script src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\"></script>\"\n+                                + \"<link href=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\">\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzQ5NA=="}, "originalCommit": {"oid": "437e24f1496ee33349a329f959448824f08fb9b3"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY0MTQ2NA==", "bodyText": "Since the type doesn't either (affect the outcome, that is) I can strip that out too. I think data:, would be the minimally correct string.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445641464", "createdAt": "2020-06-25T15:22:44Z", "author": {"login": "kishorbhat"}, "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "diffHunk": "@@ -208,6 +208,23 @@ public void shouldIgnoreInvalidFormattedHostname() throws HttpMalformedHeaderExc\n         assertThat(alertsRaised.size(), equalTo(1));\n     }\n \n+    @Test\n+    public void shouldNotRaiseAlertGivenHtmlAssetIsInline() throws HttpMalformedHeaderException {\n+        // Given\n+        HttpMessage msg =\n+                buildMessage(\n+                        \"<html><head>\"\n+                                + \"<script src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\"></script>\"\n+                                + \"<link href=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\">\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzQ5NA=="}, "originalCommit": {"oid": "437e24f1496ee33349a329f959448824f08fb9b3"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY0MjgxNA==", "bodyText": "Sounds good.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445642814", "createdAt": "2020-06-25T15:24:36Z", "author": {"login": "thc202"}, "path": "addOns/pscanrulesAlpha/src/test/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScannerTest.java", "diffHunk": "@@ -208,6 +208,23 @@ public void shouldIgnoreInvalidFormattedHostname() throws HttpMalformedHeaderExc\n         assertThat(alertsRaised.size(), equalTo(1));\n     }\n \n+    @Test\n+    public void shouldNotRaiseAlertGivenHtmlAssetIsInline() throws HttpMalformedHeaderException {\n+        // Given\n+        HttpMessage msg =\n+                buildMessage(\n+                        \"<html><head>\"\n+                                + \"<script src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\"></script>\"\n+                                + \"<link href=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/TQBcNTh/AAAAAXRSTlPM0jRW/QAAAApJREFUeJxjYgAAAAYAAzY3fKgAAAAASUVORK5CYII=\\\">\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzQ5NA=="}, "originalCommit": {"oid": "437e24f1496ee33349a329f959448824f08fb9b3"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjcxODczOnYy", "diffSide": "RIGHT", "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNToyMDo1NVrOGo_t2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNToyMDo1NVrOGo_t2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY0MDE1NQ==", "bodyText": "Can be merged to the above if.\ndata: would be more accurate.", "url": "https://github.com/zaproxy/zap-extensions/pull/2463#discussion_r445640155", "createdAt": "2020-06-25T15:20:55Z", "author": {"login": "thc202"}, "path": "addOns/pscanrulesAlpha/src/main/java/org/zaproxy/zap/extension/pscanrulesAlpha/SubResourceIntegrityAttributeScanner.java", "diffHunk": "@@ -71,6 +71,8 @@ public static boolean contains(String tag) {\n                                     .attribute);\n             if (url == null) {\n                 return Optional.of(origin);\n+            } else if (url.startsWith(\"data\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e5574e5f558e75f746270c4742434e55c0eff46"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 706, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}