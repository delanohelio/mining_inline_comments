{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNzMwOTc1", "number": 2591, "title": "Retire: Add example alerts", "bodyText": "Signed-off-by: Simon Bennetts psiinon@gmail.com", "createdAt": "2020-10-28T17:50:21Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2591", "merged": true, "mergeCommit": {"oid": "cab652fcd585e5de3ba04c8c0857bb20a9c0b36c"}, "closed": true, "closedAt": "2020-10-29T09:29:40Z", "author": {"login": "psiinon"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXB2kSAFqTUxODk2NzA1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXOw1JAFqTUxOTQ3Njc5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4OTY3MDU2", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#pullrequestreview-518967056", "createdAt": "2020-10-28T18:27:00Z", "commit": {"oid": "e28418fc3c18d3ea0c4003f6b904879991746c9e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDEzNTkx", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#pullrequestreview-519413591", "createdAt": "2020-10-29T08:06:04Z", "commit": {"oid": "e28418fc3c18d3ea0c4003f6b904879991746c9e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwODowNjowNFrOHqQQ6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwODowNjowNFrOHqQQ6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA2ODcxNA==", "bodyText": "The types could be removed.", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#discussion_r514068714", "createdAt": "2020-10-29T08:06:04Z", "author": {"login": "thc202"}, "path": "addOns/retire/src/main/java/org/zaproxy/addon/retire/RetireScanRule.java", "diffHunk": "@@ -88,27 +91,39 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n                     otherInfo = otherInfo + result.getOtherinfo();\n                 }\n \n-                newAlert()\n-                        .setRisk(Alert.RISK_MEDIUM)\n-                        .setConfidence(Alert.CONFIDENCE_MEDIUM)\n-                        .setDescription(\n-                                Constant.messages.getString(\n-                                        \"retire.rule.desc\",\n-                                        result.getFilename(),\n-                                        result.getVersion()))\n-                        .setOtherInfo(otherInfo)\n-                        .setReference(getDetails(Result.INFO, result.getInfo()))\n-                        .setSolution(\n-                                Constant.messages.getString(\n-                                        \"retire.rule.soln\", result.getFilename()))\n-                        .setEvidence(result.getEvidence())\n-                        .setCweId(829) // CWE-829: Inclusion of Functionality from Untrusted Control\n-                        // Sphere\n-                        .raise();\n+                buildAlert(result, otherInfo).raise();\n             }\n         }\n     }\n \n+    private AlertBuilder buildAlert(Result result, String otherInfo) {\n+        return newAlert()\n+                .setRisk(Alert.RISK_MEDIUM)\n+                .setConfidence(Alert.CONFIDENCE_MEDIUM)\n+                .setDescription(\n+                        Constant.messages.getString(\n+                                \"retire.rule.desc\", result.getFilename(), result.getVersion()))\n+                .setOtherInfo(otherInfo)\n+                .setReference(getDetails(Result.INFO, result.getInfo()))\n+                .setSolution(Constant.messages.getString(\"retire.rule.soln\", result.getFilename()))\n+                .setEvidence(result.getEvidence())\n+                .setCweId(829); // CWE-829: Inclusion of Functionality from Untrusted Control Sphere\n+    }\n+\n+    public List<Alert> getExampleAlerts() {\n+        List<Alert> alerts = new ArrayList<Alert>();\n+        alerts.add(\n+                buildAlert(\n+                                new Result(\n+                                        \"ExampleLibrary\",\n+                                        \"x.y.z\",\n+                                        Collections.<String, Set<String>>emptyMap(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e28418fc3c18d3ea0c4003f6b904879991746c9e"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b54f2110354f66186f713a5d481c672307b2e8f", "committedDate": "2020-10-29T09:05:04Z", "message": "Retire: Add example alerts\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e28418fc3c18d3ea0c4003f6b904879991746c9e", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/e28418fc3c18d3ea0c4003f6b904879991746c9e", "committedDate": "2020-10-28T17:47:36Z", "message": "Retire: Add example alerts\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}, "afterCommit": {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b54f2110354f66186f713a5d481c672307b2e8f", "committedDate": "2020-10-29T09:05:04Z", "message": "Retire: Add example alerts\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDU5NDM1", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#pullrequestreview-519459435", "createdAt": "2020-10-29T09:08:40Z", "commit": {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDc2Nzkz", "url": "https://github.com/zaproxy/zap-extensions/pull/2591#pullrequestreview-519476793", "createdAt": "2020-10-29T09:29:30Z", "commit": {"oid": "0b54f2110354f66186f713a5d481c672307b2e8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 327, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}