{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzQwMDM4", "number": 2638, "title": "Include button elements in DOM XSS Scan Rule", "bodyText": "The goal of this MR is to have the DomXSS Plugin click on additional buttons within the DOM to see if XSS can be triggered.\nThe script is hitting buttons like this: <button onclick=\"onCancelClicked()\">Click me</button> , but doesn't test buttons formatted like this: but not like this <button type=\"button\">Cancel</button>\nTested against an internal site, screenshot here:", "createdAt": "2020-12-01T14:27:04Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2638", "merged": true, "mergeCommit": {"oid": "ba77036e6bbd533da149fad9955bd31a27ee14bc"}, "closed": true, "closedAt": "2020-12-15T11:03:19Z", "author": {"login": "mrod23"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdh668qgBqjQwNTc1MTc3OTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmYRceAFqTU1MjMzNzI4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86a4d43b0cbd1ab9bdc658b8c35f7dae4e7976d3", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/86a4d43b0cbd1ab9bdc658b8c35f7dae4e7976d3", "committedDate": "2020-12-01T14:24:00Z", "message": "mcr-DomXSSPlugin-cleanup"}, "afterCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "committedDate": "2020-12-01T14:35:26Z", "message": "mcr-DomXSSPlugin-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxOTg2NTQ3", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#pullrequestreview-541986547", "createdAt": "2020-12-01T15:00:19Z", "commit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNTowMDoxOVrOH8w-HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNTowMDoxOVrOH8w-HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA==", "bodyText": "You can combine this into just one line:\ninputElements.addAll(findHelper(driver, By.tagName(\"button\")))", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533478940", "createdAt": "2020-12-01T15:00:19Z", "author": {"login": "psiinon"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -453,9 +453,12 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n         }\n \n         List<WebElement> inputElements;\n+        List<WebElement> buttonElements;\n \n         try {\n             inputElements = findHelper(driver, By.tagName(\"input\"));\n+            buttonElements = findHelper(driver, By.tagName(\"button\"));\n+            inputElements.addAll(buttonElements);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMDA1OTA3", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#pullrequestreview-542005907", "createdAt": "2020-12-01T15:18:42Z", "commit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToxODo0MlrOH8x4FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToxODo0MlrOH8x4FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ5Mzc4MQ==", "bodyText": "This should be added to the above \"Changed\" section.", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533493781", "createdAt": "2020-12-01T15:18:42Z", "author": {"login": "thc202"}, "path": "addOns/domxss/CHANGELOG.md", "diffHunk": "@@ -15,6 +15,10 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Maintenance changes.\n - Promote to beta\n \n+## [10] - 2020-12-01\n+### Changed\n+- Now clicking on different buttons throughout the page to see if it triggers XSS.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "411436301f9bb68a430c72528b646922506b3fd7", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/411436301f9bb68a430c72528b646922506b3fd7", "committedDate": "2020-12-02T13:08:28Z", "message": "mcr-cleanup-and-adding-unit-test"}, "afterCommit": {"oid": "e2d83653ff8019598c8b0ea79a96a0e1b7dd2d9b", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/e2d83653ff8019598c8b0ea79a96a0e1b7dd2d9b", "committedDate": "2020-12-02T13:11:51Z", "message": "mcr-cleanup-and-adding-unit-test\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16b61b8d66501a083d4828b9f02f0e3820f465f7", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/16b61b8d66501a083d4828b9f02f0e3820f465f7", "committedDate": "2020-12-02T13:17:42Z", "message": "mcr-cleanup"}, "afterCommit": {"oid": "0ed9b060c81843c30ef3aab66fbd6aa42d20520c", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0ed9b060c81843c30ef3aab66fbd6aa42d20520c", "committedDate": "2020-12-02T13:20:32Z", "message": "mcr-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61ccd1c997b9921bbc19a34396e12e20a7428b11", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/61ccd1c997b9921bbc19a34396e12e20a7428b11", "committedDate": "2020-12-03T18:44:48Z", "message": "mrod-more-unit-test-changes"}, "afterCommit": {"oid": "3d359ded799011204eeaac241b7010c54c9ac6fc", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3d359ded799011204eeaac241b7010c54c9ac6fc", "committedDate": "2020-12-03T18:45:38Z", "message": "mrod-more-unit-test-changes\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5172d180d0d5f5ff905f994db2d0f312dc3a7ac7", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/5172d180d0d5f5ff905f994db2d0f312dc3a7ac7", "committedDate": "2020-12-04T16:46:41Z", "message": "mrod-cleanup"}, "afterCommit": {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed", "committedDate": "2020-12-04T16:47:29Z", "message": "mrod-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDUwNTE2", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#pullrequestreview-547450516", "createdAt": "2020-12-08T17:14:12Z", "commit": {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzoxNDoxM1rOIBqtCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzoxNDoxM1rOIBqtCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxOTE0Nw==", "bodyText": "I agree these names are more descriptive, but what if people are already using the existing ones?\nNo idea if thats the case, but if so then it would break things for them...", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r538619147", "createdAt": "2020-12-08T17:14:13Z", "author": {"login": "psiinon"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -476,10 +477,14 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n                 attributeId = element.getAttribute(\"id\");\n                 attributeName = element.getAttribute(\"name\");\n \n-                element.sendKeys(attackVector);\n+                if (tagName.equals(\"input\")) {\n+                    element.sendKeys(attackVector);\n+                }\n+\n                 element.click();\n+\n             } catch (UnhandledAlertException uae) {\n-                Stats.incCounter(\"domxss.vulns.input2\");\n+                Stats.incCounter(\"domxss.vulns.possibleXSSTriggers2\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed"}, "originalPosition": 39}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "638eb16102aefbabbd6904ecfd5d4398b62e13da", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/638eb16102aefbabbd6904ecfd5d4398b62e13da", "committedDate": "2020-12-09T14:24:16Z", "message": "mrod-cleaning-up-cancel-page-and-vars"}, "afterCommit": {"oid": "cf702b877eb07618f384f25290589a91da066c6e", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/cf702b877eb07618f384f25290589a91da066c6e", "committedDate": "2020-12-09T14:27:27Z", "message": "mrod-cleaning-up-cancel-page-and-vars\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf702b877eb07618f384f25290589a91da066c6e", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/cf702b877eb07618f384f25290589a91da066c6e", "committedDate": "2020-12-09T14:27:27Z", "message": "mrod-cleaning-up-cancel-page-and-vars\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}, "afterCommit": {"oid": "3abb0dfe2577cce23b121917d56d2b7fa0ca6da0", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3abb0dfe2577cce23b121917d56d2b7fa0ca6da0", "committedDate": "2020-12-09T14:29:36Z", "message": "squashing commits"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f8fd5a1c4e089b1d2af4557c357d9519eb2d405", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/4f8fd5a1c4e089b1d2af4557c357d9519eb2d405", "committedDate": "2020-12-09T14:39:35Z", "message": "mrod-more-cleanup"}, "afterCommit": {"oid": "0b7f271662a98df57b37862ffb8a49499e52b766", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b7f271662a98df57b37862ffb8a49499e52b766", "committedDate": "2020-12-09T14:41:16Z", "message": "mrod-squashing-commits"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b7f271662a98df57b37862ffb8a49499e52b766", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/0b7f271662a98df57b37862ffb8a49499e52b766", "committedDate": "2020-12-09T14:41:16Z", "message": "mrod-squashing-commits"}, "afterCommit": {"oid": "afdd7af7aa7ede3fe04a8d75ad1a53f867bbc2e3", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/afdd7af7aa7ede3fe04a8d75ad1a53f867bbc2e3", "committedDate": "2020-12-09T14:41:51Z", "message": "mrod-squashing-commits\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78cbd70e85986bca64b3b6e067a4e87fbf0b1059", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/78cbd70e85986bca64b3b6e067a4e87fbf0b1059", "committedDate": "2020-12-09T18:41:20Z", "message": "mrod-cleanup"}, "afterCommit": {"oid": "3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "committedDate": "2020-12-09T18:41:48Z", "message": "mrod-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "committedDate": "2020-12-09T18:41:48Z", "message": "mrod-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}, "afterCommit": {"oid": "3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "committedDate": "2020-12-09T18:43:23Z", "message": "squashing commitsh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/040b3d56b2e3f17dc7d6a13aa12453d047312af8", "committedDate": "2020-12-09T18:43:54Z", "message": "squashing commitsh\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "committedDate": "2020-12-09T18:43:23Z", "message": "squashing commitsh"}, "afterCommit": {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8", "author": {"user": {"login": "michael-rodriguez-ttd", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/040b3d56b2e3f17dc7d6a13aa12453d047312af8", "committedDate": "2020-12-09T18:43:54Z", "message": "squashing commitsh\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzIyNTQw", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#pullrequestreview-552322540", "createdAt": "2020-12-15T10:44:28Z", "commit": {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzM3Mjg2", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#pullrequestreview-552337286", "createdAt": "2020-12-15T11:03:08Z", "commit": {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 250, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}