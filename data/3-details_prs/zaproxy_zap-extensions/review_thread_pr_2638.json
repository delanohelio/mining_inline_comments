{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzQwMDM4", "number": 2638, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNTowMDoxOVrOE_MX6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzoxNDoxM1rOFCe16g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0Njk4NDcyOnYy", "diffSide": "RIGHT", "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNTowMDoxOVrOH8w-HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTo1MjoxOVrOH9vpUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA==", "bodyText": "You can combine this into just one line:\ninputElements.addAll(findHelper(driver, By.tagName(\"button\")))", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533478940", "createdAt": "2020-12-01T15:00:19Z", "author": {"login": "psiinon"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -453,9 +453,12 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n         }\n \n         List<WebElement> inputElements;\n+        List<WebElement> buttonElements;\n \n         try {\n             inputElements = findHelper(driver, By.tagName(\"input\"));\n+            buttonElements = findHelper(driver, By.tagName(\"button\"));\n+            inputElements.addAll(buttonElements);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwODk5Nw==", "bodyText": "Will do. I'll combine", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533508997", "createdAt": "2020-12-01T15:37:50Z", "author": {"login": "mrod23"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -453,9 +453,12 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n         }\n \n         List<WebElement> inputElements;\n+        List<WebElement> buttonElements;\n \n         try {\n             inputElements = findHelper(driver, By.tagName(\"input\"));\n+            buttonElements = findHelper(driver, By.tagName(\"button\"));\n+            inputElements.addAll(buttonElements);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA=="}, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUwNTgwOQ==", "bodyText": "combined", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r534505809", "createdAt": "2020-12-02T21:52:19Z", "author": {"login": "mrod23"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -453,9 +453,12 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n         }\n \n         List<WebElement> inputElements;\n+        List<WebElement> buttonElements;\n \n         try {\n             inputElements = findHelper(driver, By.tagName(\"input\"));\n+            buttonElements = findHelper(driver, By.tagName(\"button\"));\n+            inputElements.addAll(buttonElements);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA=="}, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NzA3NzMzOnYy", "diffSide": "RIGHT", "path": "addOns/domxss/CHANGELOG.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToxODo0MlrOH8x4FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNToxODo0MlrOH8x4FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ5Mzc4MQ==", "bodyText": "This should be added to the above \"Changed\" section.", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533493781", "createdAt": "2020-12-01T15:18:42Z", "author": {"login": "thc202"}, "path": "addOns/domxss/CHANGELOG.md", "diffHunk": "@@ -15,6 +15,10 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Maintenance changes.\n - Promote to beta\n \n+## [10] - 2020-12-01\n+### Changed\n+- Now clicking on different buttons throughout the page to see if it triggers XSS.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4MTQ2Nzk0OnYy", "diffSide": "RIGHT", "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzoxNDoxM1rOIBqtCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0NzoxNlrOICYWSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxOTE0Nw==", "bodyText": "I agree these names are more descriptive, but what if people are already using the existing ones?\nNo idea if thats the case, but if so then it would break things for them...", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r538619147", "createdAt": "2020-12-08T17:14:13Z", "author": {"login": "psiinon"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -476,10 +477,14 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n                 attributeId = element.getAttribute(\"id\");\n                 attributeName = element.getAttribute(\"name\");\n \n-                element.sendKeys(attackVector);\n+                if (tagName.equals(\"input\")) {\n+                    element.sendKeys(attackVector);\n+                }\n+\n                 element.click();\n+\n             } catch (UnhandledAlertException uae) {\n-                Stats.incCounter(\"domxss.vulns.input2\");\n+                Stats.incCounter(\"domxss.vulns.possibleXSSTriggers2\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2Njk4NA==", "bodyText": "Updated to possibleDomXSSTriggers2", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r539366984", "createdAt": "2020-12-09T14:47:16Z", "author": {"login": "mrod23"}, "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -476,10 +477,14 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n                 attributeId = element.getAttribute(\"id\");\n                 attributeName = element.getAttribute(\"name\");\n \n-                element.sendKeys(attackVector);\n+                if (tagName.equals(\"input\")) {\n+                    element.sendKeys(attackVector);\n+                }\n+\n                 element.click();\n+\n             } catch (UnhandledAlertException uae) {\n-                Stats.incCounter(\"domxss.vulns.input2\");\n+                Stats.incCounter(\"domxss.vulns.possibleXSSTriggers2\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxOTE0Nw=="}, "originalCommit": {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 655, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}