{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NDM0MDQ1", "number": 2500, "title": "CsrfTokenScanRule Ignore Non-HTML & Prepare Release", "bodyText": "ascanrulesBeta.gradle.kts > Update version for next iteration.\nCHANGELOG > Update for next iteration and add change note.\nCsrfTokenScanRule > Add conditional to bail if the original message was non-HTML.\nCsrfTokenScanRuleUnitTest > Add a new test method to assert the new behavior, that no message is sent when the content-type of the original isn't HTML.\n\nFixes zaproxy/zaproxy#6089\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com", "createdAt": "2020-07-23T01:29:10Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2500", "merged": true, "mergeCommit": {"oid": "65d2196d5b09044c3fce13a5803557ebac8a591d"}, "closed": true, "closedAt": "2020-07-23T12:51:43Z", "author": {"login": "kingthorin"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3lKqXgBqjM1NzgxMjAwNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3u6n9gFqTQ1NDA5NjcwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88d139c3d88e66bb973dce2fc02d30c9c19867b0", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/88d139c3d88e66bb973dce2fc02d30c9c19867b0", "committedDate": "2020-07-23T01:27:17Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "committedDate": "2020-07-23T01:29:54Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzOTE5ODI4", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#pullrequestreview-453919828", "createdAt": "2020-07-23T08:16:18Z", "commit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzOTU2MDI0", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#pullrequestreview-453956024", "createdAt": "2020-07-23T09:09:32Z", "commit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwOTowOTozMlrOG2CS4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwOToxODo0MVrOG2Cl6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxMzg5MQ==", "bodyText": "Maybe prepare another release? Or there are other changes lined up?", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459313891", "createdAt": "2020-07-23T09:09:32Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/CHANGELOG.md", "diffHunk": "@@ -3,6 +3,10 @@ All notable changes to this add-on will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## Unreleased", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxMzk0Mw==", "bodyText": "Could you add the d?", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459313943", "createdAt": "2020-07-23T09:09:37Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/CHANGELOG.md", "diffHunk": "@@ -3,6 +3,10 @@ All notable changes to this add-on will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## Unreleased\n+### Changed\n+- Anti-CSRF Tokens Check address potential false positives by only analyzing HTML responses (Issue 6089).\n+\n ## [29] - 2020-07-22\n ### Change", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxMzk3Mg==", "bodyText": "Remove?", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459313972", "createdAt": "2020-07-23T09:09:40Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/CsrfTokenScanRule.java", "diffHunk": "@@ -131,8 +131,11 @@ public void init() {\n      */\n     @Override\n     public void scan() {\n-        if (AlertThreshold.HIGH.equals(getAlertThreshold()) && !getBaseMsg().isInScope()) {\n-            return; // At HIGH threshold return if the msg isn't in scope\n+        if ((AlertThreshold.HIGH.equals(getAlertThreshold()) && !getBaseMsg().isInScope())\n+                || !getBaseMsg().getResponseHeader().isHtml()) {\n+            // At HIGH threshold return if the msg isn't in scope\n+            // If the original isn't an HTML response then we shouldn't analyze it.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTMxODc2Mw==", "bodyText": "shouldNotProcessNonHtml would be more accurate, it's not just JavaScript. It could also be parameterized with more types.", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#discussion_r459318763", "createdAt": "2020-07-23T09:18:41Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/test/java/org/zaproxy/zap/extension/ascanrulesBeta/CsrfTokenScanRuleUnitTest.java", "diffHunk": "@@ -98,6 +99,27 @@ public void shouldNotProcessWithoutForm() throws Exception {\n         assertThat(httpMessagesSent, hasSize(0));\n     }\n \n+    @Test\n+    public void shouldNotProcessJavaScript() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/5fa7f1c8c53238aaee2eb9f85dd49a2b34257951", "committedDate": "2020-07-23T01:29:54Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "74f50bfc68ef421a05caf131bcb4468fc445e728", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/74f50bfc68ef421a05caf131bcb4468fc445e728", "committedDate": "2020-07-23T10:53:42Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74f50bfc68ef421a05caf131bcb4468fc445e728", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/74f50bfc68ef421a05caf131bcb4468fc445e728", "committedDate": "2020-07-23T10:53:42Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare Next Dev Iteration\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next iteration and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "committedDate": "2020-07-23T10:55:51Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MDc0Mjkw", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#pullrequestreview-454074290", "createdAt": "2020-07-23T12:20:28Z", "commit": {"oid": "a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "committedDate": "2020-07-23T12:21:16Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a3d2f3c2a4eaa5b8142a424001d7640c25fb8f55", "committedDate": "2020-07-23T10:55:51Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/e7633b9706ee0b6cf0cc32936c4cb157bfe362e5", "committedDate": "2020-07-23T12:21:16Z", "message": "CsrfTokenScanRule Ignore Non-HTML & Prepare release\n\n- ascanrulesBeta.gradle.kts > Update version for next iteration.\n- CHANGELOG > Update for next release and add change note.\n- CsrfTokenScanRule > Add conditional to bail if the original message\nwas non-HTML.\n- CsrfTokenScanRuleUnitTest > Add a new test method to assert the new\nbehavior, that no message is sent when the content-type of the original\nisn't HTML.\n\nFixes zaproxy/zaproxy#6089\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MDk2NzAz", "url": "https://github.com/zaproxy/zap-extensions/pull/2500#pullrequestreview-454096703", "createdAt": "2020-07-23T12:51:35Z", "commit": {"oid": "e7633b9706ee0b6cf0cc32936c4cb157bfe362e5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 280, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}