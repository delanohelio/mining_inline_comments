{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMzUyNDQy", "number": 2639, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzowNFrOFC9d9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzoxMFrOFC9eLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjQ4NTY2OnYy", "diffSide": "RIGHT", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzowNFrOICYIVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzowNFrOICYIVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQxMg==", "bodyText": "The 0 check can be removed, the base messages now have a response always.", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363412", "createdAt": "2020-12-09T14:43:04Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/HttpsAsHttpScanRule.java", "diffHunk": "@@ -101,12 +101,14 @@ public void scan() {\n         }\n \n         int originalStatusCode = getBaseMsg().getResponseHeader().getStatusCode();\n-        if (originalStatusCode == HttpStatusCode.NOT_FOUND || originalStatusCode == 0) {\n+        boolean was404 = isPage404(getBaseMsg());\n+        if (was404 || originalStatusCode == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjQ4NjIxOnYy", "diffSide": "RIGHT", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDo0MzoxMFrOICYIog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNToxMToxNlrOICZnlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA==", "bodyText": "Remove? It will be always false. (Same comment for following changes.)", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539363490", "createdAt": "2020-12-09T14:43:10Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM3OTY1Mg==", "bodyText": "I figured it was good to be consistent with the logging, since the existing message lists the status code?", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539379652", "createdAt": "2020-12-09T15:01:40Z", "author": {"login": "kingthorin"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4MjkyNQ==", "bodyText": "I can revert it, just want to be sure we're on the same page.\nAlso for \"following changes\" did you mean just the logging or the other isPage200s as well? (I assume logging, but again want to assure we're aligned.)", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539382925", "createdAt": "2020-12-09T15:05:32Z", "author": {"login": "kingthorin"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4Njk0NQ==", "bodyText": "Right, that might be confusing, drop the status code instead? Just say  \"Got a non-200 response when ....\"?\nYeah, it was for the logging.", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539386945", "createdAt": "2020-12-09T15:10:12Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM4Nzc5OQ==", "bodyText": "Perfect  \ud83d\ude00", "url": "https://github.com/zaproxy/zap-extensions/pull/2639#discussion_r539387799", "createdAt": "2020-12-09T15:11:16Z", "author": {"login": "kingthorin"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/SessionFixationScanRule.java", "diffHunk": "@@ -388,6 +389,8 @@ public void scan() {\n                                             + \"] with param [\"\n                                             + currentHtmlParameter.getName()\n                                             + \"] = NULL (possibly somewhere in the redirects)\");\n+                            log.debug(\"isPage200 returned: \" + was200);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2MzQ5MA=="}, "originalCommit": {"oid": "58e1536ce6cc3059cceb99fcd7afcf47ae44b999"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 656, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}