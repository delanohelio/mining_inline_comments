{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NDIwMTU3", "number": 2599, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMTowNTowNFrOE0n6ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNTo0ODoyNlrOE1FGzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNjE1MzkwOnYy", "diffSide": "LEFT", "path": "addOns/ascanrulesAlpha/src/main/java/org/zaproxy/zap/extension/ascanrulesAlpha/LdapInjectionScanRule.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMTowNTowNFrOHsdKcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjoyMjozOVrOHs2iMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3NzIwMw==", "bodyText": "I'm not sure what issue this is addressing. Instead of sending originalmsg (which is actually the message passed into the scan method) should this simply leverage getBaseMsg() and not resend the msg being passed in?", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r516377203", "createdAt": "2020-11-03T01:05:04Z", "author": {"login": "kingthorin"}, "path": "addOns/ascanrulesAlpha/src/main/java/org/zaproxy/zap/extension/ascanrulesAlpha/LdapInjectionScanRule.java", "diffHunk": "@@ -222,7 +224,25 @@ public void scan(HttpMessage originalmsg, String paramname, String paramvalue) {\n             // get the response for the \"original\" unmodified request\n             // this fixes what seems to be a bug in the Zap core, where the request response is not\n             // actually available at this point via \"originalmsg\"\n-            sendAndReceive(originalmsg);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "495d3196d85312c0b872a63ef9d22cda0b972e2d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc5MTczMw==", "bodyText": "This was added to make sure that the message had a response (e.g. messages of temporary nodes). This is no longer needed as core ensures that the messages have a response.", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r516791733", "createdAt": "2020-11-03T16:21:11Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesAlpha/src/main/java/org/zaproxy/zap/extension/ascanrulesAlpha/LdapInjectionScanRule.java", "diffHunk": "@@ -222,7 +224,25 @@ public void scan(HttpMessage originalmsg, String paramname, String paramvalue) {\n             // get the response for the \"original\" unmodified request\n             // this fixes what seems to be a bug in the Zap core, where the request response is not\n             // actually available at this point via \"originalmsg\"\n-            sendAndReceive(originalmsg);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3NzIwMw=="}, "originalCommit": {"oid": "495d3196d85312c0b872a63ef9d22cda0b972e2d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc5Mjg4MQ==", "bodyText": "And to answer your question, yes, it can use the base message.", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r516792881", "createdAt": "2020-11-03T16:22:39Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesAlpha/src/main/java/org/zaproxy/zap/extension/ascanrulesAlpha/LdapInjectionScanRule.java", "diffHunk": "@@ -222,7 +224,25 @@ public void scan(HttpMessage originalmsg, String paramname, String paramvalue) {\n             // get the response for the \"original\" unmodified request\n             // this fixes what seems to be a bug in the Zap core, where the request response is not\n             // actually available at this point via \"originalmsg\"\n-            sendAndReceive(originalmsg);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM3NzIwMw=="}, "originalCommit": {"oid": "495d3196d85312c0b872a63ef9d22cda0b972e2d"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzODg3Nzc5OnYy", "diffSide": "RIGHT", "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/ProxyDisclosureScanRule.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjoyNTozMFrOHs2ptg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjoyNTozMFrOHs2ptg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc5NDgwNg==", "bodyText": "Should it return? If there's no response there's nothing to check?", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r516794806", "createdAt": "2020-11-03T16:25:30Z", "author": {"login": "thc202"}, "path": "addOns/ascanrulesBeta/src/main/java/org/zaproxy/zap/extension/ascanrulesBeta/ProxyDisclosureScanRule.java", "diffHunk": "@@ -674,7 +676,25 @@ public void scan() {\n             HttpMessage trackmsg = getNewMsg();\n             trackmsg.setRequestHeader(trackRequestHeader);\n \n-            sendAndReceive(trackmsg, false); // do not follow redirects.\n+            try {\n+                sendAndReceive(trackmsg, false); // do not follow redirects.\n+            } catch (SocketTimeoutException ste) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "495d3196d85312c0b872a63ef9d22cda0b972e2d"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MDkzNjQ3OnYy", "diffSide": "RIGHT", "path": "addOns/ascanrulesAlpha/CHANGELOG.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNTo0ODoyNlrOHtJ4qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNTo1NjozNlrOHtKBCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEwOTkyOA==", "bodyText": "I may be missing something, but I can't see a SocketTimeoutException being handled in the LDAP Injection scan rule?", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r517109928", "createdAt": "2020-11-04T05:48:26Z", "author": {"login": "ricekot"}, "path": "addOns/ascanrulesAlpha/CHANGELOG.md", "diffHunk": "@@ -9,7 +9,8 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Maintenance changes.\n \n ### Fixed\n- - Terminology\n+ - Terminology.\n+ - SocketTimeoutException in the LDAP Injection scan rule.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "023ba15680b7f2a3b1f5157ac84ea13c05d612d7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzExMjA3NA==", "bodyText": "My bad, didn't realise sendAndReceive(originalmsg); was what was causing a SocketTimeoutException.", "url": "https://github.com/zaproxy/zap-extensions/pull/2599#discussion_r517112074", "createdAt": "2020-11-04T05:56:36Z", "author": {"login": "ricekot"}, "path": "addOns/ascanrulesAlpha/CHANGELOG.md", "diffHunk": "@@ -9,7 +9,8 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Maintenance changes.\n \n ### Fixed\n- - Terminology\n+ - Terminology.\n+ - SocketTimeoutException in the LDAP Injection scan rule.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEwOTkyOA=="}, "originalCommit": {"oid": "023ba15680b7f2a3b1f5157ac84ea13c05d612d7"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 648, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}