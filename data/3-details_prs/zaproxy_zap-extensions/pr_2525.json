{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNzQxNjUz", "number": 2525, "title": "Allow to save and import HARs (HTTP archives)", "bodyText": "Fixes issue zaproxy/zaproxy#521 and replaces PR #2406.", "createdAt": "2020-08-26T08:25:31Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2525", "merged": true, "mergeCommit": {"oid": "c604ef5389e032986eea6889560014c863e5b08d"}, "closed": true, "closedAt": "2021-04-20T12:48:03Z", "author": {"login": "bunysae"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCniLngBqjM2OTM2MjI4MTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeO9BXrAFqTYzOTg4NDc3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46f5aa948451eb04a7dcf33b00ed70e067236f92", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/46f5aa948451eb04a7dcf33b00ed70e067236f92", "committedDate": "2020-08-26T08:14:14Z", "message": "Save and imoprts Hars (HTTP archives)"}, "afterCommit": {"oid": "a4749e52168b6d87c0cb27d573cabf3672ac754e", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a4749e52168b6d87c0cb27d573cabf3672ac754e", "committedDate": "2020-08-26T08:27:29Z", "message": "Save and imoprts Hars (HTTP archives)\n\nSigned-off-by: Bunyanuch Saengnet <bunyanuch.saengnet@kabelsurfer.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "902ca02b1af83e6d0a2247ec64149c287389e76c", "author": {"user": {"login": "thc202", "name": null}}, "url": "https://github.com/zaproxy/zap-extensions/commit/902ca02b1af83e6d0a2247ec64149c287389e76c", "committedDate": "2021-04-19T14:41:18Z", "message": "Tweaks\n\nAdd braces.\nRemove finals and type parameters.\nMerge catch clauses.\n\nSigned-off-by: thc202 <thc202@gmail.com>"}, "afterCommit": {"oid": "ed46a20926342837054f65f20ab9b0e7281d76d3", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/ed46a20926342837054f65f20ab9b0e7281d76d3", "committedDate": "2021-04-19T15:12:21Z", "message": "Save and import Hars (HTTP archives)\n\nSigned-off-by: Bunyanuch Saengnet <bunyanuch.saengnet@kabelsurfer.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d63f414d84d34853009373f4d8589af6efd70b16", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/d63f414d84d34853009373f4d8589af6efd70b16", "committedDate": "2021-04-19T15:13:34Z", "message": "Save and import Hars (HTTP archives)\n\nSigned-off-by: Bunyanuch Saengnet <bunyanuch.saengnet@kabelsurfer.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed46a20926342837054f65f20ab9b0e7281d76d3", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/ed46a20926342837054f65f20ab9b0e7281d76d3", "committedDate": "2021-04-19T15:12:21Z", "message": "Save and import Hars (HTTP archives)\n\nSigned-off-by: Bunyanuch Saengnet <bunyanuch.saengnet@kabelsurfer.com>"}, "afterCommit": {"oid": "d63f414d84d34853009373f4d8589af6efd70b16", "author": {"user": {"login": "bunysae", "name": "Bunyanuch Saengnet"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/d63f414d84d34853009373f4d8589af6efd70b16", "committedDate": "2021-04-19T15:13:34Z", "message": "Save and import Hars (HTTP archives)\n\nSigned-off-by: Bunyanuch Saengnet <bunyanuch.saengnet@kabelsurfer.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d75ee9abc00c9d4b920d1d0c1dc66e140765edd", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/6d75ee9abc00c9d4b920d1d0c1dc66e140765edd", "committedDate": "2021-04-19T15:52:51Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "a27a366da3cb6816596929cfa6e8add379764665", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a27a366da3cb6816596929cfa6e8add379764665", "committedDate": "2021-04-19T15:56:32Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a27a366da3cb6816596929cfa6e8add379764665", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/a27a366da3cb6816596929cfa6e8add379764665", "committedDate": "2021-04-19T15:56:32Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "4d2abbd2c062cdaeaf4103158696a732a32f1a37", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/4d2abbd2c062cdaeaf4103158696a732a32f1a37", "committedDate": "2021-04-19T16:00:45Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d2abbd2c062cdaeaf4103158696a732a32f1a37", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/4d2abbd2c062cdaeaf4103158696a732a32f1a37", "committedDate": "2021-04-19T16:00:45Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/af0648c8fce00d2fc9b228c00fe6ddda6c3e072c", "committedDate": "2021-04-20T02:13:17Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM5NTQ4NDA2", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#pullrequestreview-639548406", "createdAt": "2021-04-20T06:29:23Z", "commit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNC0yMFQwNjoyOToyM1rOJL025Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNC0yMFQwNjozMzo1MlrOJL0_7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjM4MDEzMw==", "bodyText": "URLs \u2192 data? It allows to import whole messages.", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#discussion_r616380133", "createdAt": "2021-04-20T06:29:23Z", "author": {"login": "thc202"}, "path": "addOns/exim/src/main/java/org/zaproxy/addon/exim/har/HarApi.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.exim.har;\n+\n+import java.io.File;\n+import net.sf.json.JSONObject;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.zaproxy.zap.extension.api.ApiAction;\n+import org.zaproxy.zap.extension.api.ApiException;\n+import org.zaproxy.zap.extension.api.ApiException.Type;\n+import org.zaproxy.zap.extension.api.ApiImplementor;\n+import org.zaproxy.zap.extension.api.ApiResponse;\n+import org.zaproxy.zap.extension.api.ApiResponseElement;\n+import org.zaproxy.zap.utils.ApiUtils;\n+\n+/** The API for importing URLs from a file. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjM4MDE1Mg==", "bodyText": "I'd suggest exim (the same as the add-on ID), to reduce the likelihood of conflicts with other add-ons.", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#discussion_r616380152", "createdAt": "2021-04-20T06:29:25Z", "author": {"login": "thc202"}, "path": "addOns/exim/src/main/java/org/zaproxy/addon/exim/har/HarApi.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.exim.har;\n+\n+import java.io.File;\n+import net.sf.json.JSONObject;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.zaproxy.zap.extension.api.ApiAction;\n+import org.zaproxy.zap.extension.api.ApiException;\n+import org.zaproxy.zap.extension.api.ApiException.Type;\n+import org.zaproxy.zap.extension.api.ApiImplementor;\n+import org.zaproxy.zap.extension.api.ApiResponse;\n+import org.zaproxy.zap.extension.api.ApiResponseElement;\n+import org.zaproxy.zap.utils.ApiUtils;\n+\n+/** The API for importing URLs from a file. */\n+public class HarApi extends ApiImplementor {\n+\n+    private static final Logger LOG = LogManager.getLogger(HarApi.class);\n+    private static final String PREFIX = \"importexport\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjM4MDIwNQ==", "bodyText": "Can be removed.", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#discussion_r616380205", "createdAt": "2021-04-20T06:29:33Z", "author": {"login": "thc202"}, "path": "addOns/exim/src/main/java/org/zaproxy/addon/exim/har/HarApi.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.exim.har;\n+\n+import java.io.File;\n+import net.sf.json.JSONObject;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.zaproxy.zap.extension.api.ApiAction;\n+import org.zaproxy.zap.extension.api.ApiException;\n+import org.zaproxy.zap.extension.api.ApiException.Type;\n+import org.zaproxy.zap.extension.api.ApiImplementor;\n+import org.zaproxy.zap.extension.api.ApiResponse;\n+import org.zaproxy.zap.extension.api.ApiResponseElement;\n+import org.zaproxy.zap.utils.ApiUtils;\n+\n+/** The API for importing URLs from a file. */\n+public class HarApi extends ApiImplementor {\n+\n+    private static final Logger LOG = LogManager.getLogger(HarApi.class);\n+    private static final String PREFIX = \"importexport\";\n+    private static final String ACTION_IMPORTHAR = \"importhar\";\n+    private static final String PARAM_FILE_PATH = \"filePath\";\n+\n+    /** Provided only for API client generator usage. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjM4MDg3MQ==", "bodyText": "This needs to be changed, if the view is not initialised it should not execute in the EDT.", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#discussion_r616380871", "createdAt": "2021-04-20T06:30:49Z", "author": {"login": "thc202"}, "path": "addOns/exim/src/main/java/org/zaproxy/addon/exim/har/HarImporter.java", "diffHunk": "@@ -0,0 +1,166 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.exim.har;\n+\n+import edu.umass.cs.benchlab.har.HarContent;\n+import edu.umass.cs.benchlab.har.HarEntries;\n+import edu.umass.cs.benchlab.har.HarEntry;\n+import edu.umass.cs.benchlab.har.HarHeader;\n+import edu.umass.cs.benchlab.har.HarLog;\n+import edu.umass.cs.benchlab.har.HarResponse;\n+import edu.umass.cs.benchlab.har.tools.HarFileReader;\n+import java.awt.EventQueue;\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.parosproxy.paros.db.DatabaseException;\n+import org.parosproxy.paros.extension.history.ExtensionHistory;\n+import org.parosproxy.paros.model.HistoryReference;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMalformedHeaderException;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpResponseHeader;\n+import org.zaproxy.zap.network.HttpResponseBody;\n+import org.zaproxy.zap.utils.HarUtils;\n+\n+public class HarImporter {\n+\n+    private static final Logger LOG = LogManager.getLogger(HarImporter.class);\n+\n+    public static List<HttpMessage> getHttpMessages(HarLog log)\n+            throws HttpMalformedHeaderException {\n+        List<HttpMessage> result = new ArrayList<>();\n+        HarEntries entries = log.getEntries();\n+        for (HarEntry entry : entries.getEntries()) {\n+            result.add(getHttpMessage(entry));\n+        }\n+        return result;\n+    }\n+\n+    private static HttpMessage getHttpMessage(HarEntry harEntry)\n+            throws HttpMalformedHeaderException {\n+        HttpMessage result = HarUtils.createHttpMessage(harEntry.getRequest());\n+        setHttpResponse(harEntry.getResponse(), result);\n+        setHistoryReference(harEntry, result);\n+        return result;\n+    }\n+\n+    private static void setHistoryReference(HarEntry harEntry, HttpMessage httpMessage) {\n+        if (harEntry.getCustomFields().getCustomFieldValue(HarUtils.MESSAGE_ID_CUSTOM_FIELD)\n+                == null) {\n+            return;\n+        }\n+\n+        Integer historyId =\n+                Integer.valueOf(\n+                        harEntry.getCustomFields()\n+                                .getCustomFieldValue(HarUtils.MESSAGE_ID_CUSTOM_FIELD));\n+        try {\n+            httpMessage.setHistoryRef(new HistoryReference(historyId.intValue()));\n+        } catch (DatabaseException | HttpMalformedHeaderException e) {\n+            // Ignore.\n+        }\n+    }\n+\n+    private static void setHttpResponse(HarResponse harResponse, HttpMessage message)\n+            throws HttpMalformedHeaderException {\n+        StringBuilder strBuilderResHeader = new StringBuilder();\n+\n+        // empty responses without status code are possible\n+        if (harResponse.getStatus() == 0) {\n+            return;\n+        }\n+\n+        strBuilderResHeader\n+                .append(harResponse.getHttpVersion())\n+                .append(' ')\n+                .append(harResponse.getStatus())\n+                .append(' ')\n+                .append(harResponse.getStatusText())\n+                .append(\"\\r\\n\");\n+\n+        for (HarHeader harHeader : harResponse.getHeaders().getHeaders()) {\n+            strBuilderResHeader\n+                    .append(harHeader.getName())\n+                    .append(\": \")\n+                    .append(harHeader.getValue())\n+                    .append(\"\\r\\n\");\n+        }\n+        strBuilderResHeader.append(\"\\r\\n\");\n+\n+        HarContent harContent = harResponse.getContent();\n+        message.setResponseHeader(new HttpResponseHeader(strBuilderResHeader.toString()));\n+        if (harContent != null) {\n+            message.setResponseBody(new HttpResponseBody(harContent.getText()));\n+        }\n+    }\n+\n+    static boolean importHarFile(File file) {\n+        try {\n+            processMessages(file);\n+            return true;\n+        } catch (IOException e) {\n+            LOG.error(e);\n+            return false;\n+        }\n+    }\n+\n+    public static void processMessages(File file) throws IOException {\n+        List<HttpMessage> messages =\n+                HarImporter.getHttpMessages(new HarFileReader().readHarFile(file));\n+        messages.forEach(message -> persistMessage(message));\n+    }\n+\n+    private static void persistMessage(HttpMessage message) {\n+        HistoryReference historyRef;\n+\n+        if (message.getHistoryRef() == null) {\n+            try {\n+                historyRef =\n+                        new HistoryReference(\n+                                Model.getSingleton().getSession(),\n+                                HistoryReference.TYPE_ZAP_USER,\n+                                message);\n+            } catch (Exception e) {\n+                LOG.warn(e.getMessage(), e);\n+                return;\n+            }\n+        } else {\n+            historyRef = message.getHistoryRef();\n+        }\n+\n+        ExtensionHistory extHistory =\n+                Control.getSingleton().getExtensionLoader().getExtension(ExtensionHistory.class);\n+        if (extHistory != null) {\n+            EventQueue.invokeLater(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "originalPosition": 156}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjM4MjQ0Ng==", "bodyText": "I'd suggest removing this (and related logic in persistMessage), it's very unlikely that the IDs would still match.", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#discussion_r616382446", "createdAt": "2021-04-20T06:33:52Z", "author": {"login": "thc202"}, "path": "addOns/exim/src/main/java/org/zaproxy/addon/exim/har/HarImporter.java", "diffHunk": "@@ -0,0 +1,166 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.addon.exim.har;\n+\n+import edu.umass.cs.benchlab.har.HarContent;\n+import edu.umass.cs.benchlab.har.HarEntries;\n+import edu.umass.cs.benchlab.har.HarEntry;\n+import edu.umass.cs.benchlab.har.HarHeader;\n+import edu.umass.cs.benchlab.har.HarLog;\n+import edu.umass.cs.benchlab.har.HarResponse;\n+import edu.umass.cs.benchlab.har.tools.HarFileReader;\n+import java.awt.EventQueue;\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.parosproxy.paros.control.Control;\n+import org.parosproxy.paros.db.DatabaseException;\n+import org.parosproxy.paros.extension.history.ExtensionHistory;\n+import org.parosproxy.paros.model.HistoryReference;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMalformedHeaderException;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpResponseHeader;\n+import org.zaproxy.zap.network.HttpResponseBody;\n+import org.zaproxy.zap.utils.HarUtils;\n+\n+public class HarImporter {\n+\n+    private static final Logger LOG = LogManager.getLogger(HarImporter.class);\n+\n+    public static List<HttpMessage> getHttpMessages(HarLog log)\n+            throws HttpMalformedHeaderException {\n+        List<HttpMessage> result = new ArrayList<>();\n+        HarEntries entries = log.getEntries();\n+        for (HarEntry entry : entries.getEntries()) {\n+            result.add(getHttpMessage(entry));\n+        }\n+        return result;\n+    }\n+\n+    private static HttpMessage getHttpMessage(HarEntry harEntry)\n+            throws HttpMalformedHeaderException {\n+        HttpMessage result = HarUtils.createHttpMessage(harEntry.getRequest());\n+        setHttpResponse(harEntry.getResponse(), result);\n+        setHistoryReference(harEntry, result);\n+        return result;\n+    }\n+\n+    private static void setHistoryReference(HarEntry harEntry, HttpMessage httpMessage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c"}, "originalPosition": 69}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af0648c8fce00d2fc9b228c00fe6ddda6c3e072c", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/af0648c8fce00d2fc9b228c00fe6ddda6c3e072c", "committedDate": "2021-04-20T02:13:17Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "aeebbba97cde9c68a4a60cac8fa349ead3c11090", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/aeebbba97cde9c68a4a60cac8fa349ead3c11090", "committedDate": "2021-04-20T12:13:01Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aeebbba97cde9c68a4a60cac8fa349ead3c11090", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/aeebbba97cde9c68a4a60cac8fa349ead3c11090", "committedDate": "2021-04-20T12:13:01Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "b5545c484a0688e0c8469e6ef2fefc14f15f2bc9", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/b5545c484a0688e0c8469e6ef2fefc14f15f2bc9", "committedDate": "2021-04-20T12:21:19Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5545c484a0688e0c8469e6ef2fefc14f15f2bc9", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/b5545c484a0688e0c8469e6ef2fefc14f15f2bc9", "committedDate": "2021-04-20T12:21:19Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "fa5a142830c1dc63217248d6068ddb7f9b236e32", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/fa5a142830c1dc63217248d6068ddb7f9b236e32", "committedDate": "2021-04-20T12:24:00Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03c816015082d97b23f457a779c301202ba0bb4f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/03c816015082d97b23f457a779c301202ba0bb4f", "committedDate": "2021-04-20T12:24:51Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa5a142830c1dc63217248d6068ddb7f9b236e32", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/fa5a142830c1dc63217248d6068ddb7f9b236e32", "committedDate": "2021-04-20T12:24:00Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "03c816015082d97b23f457a779c301202ba0bb4f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/03c816015082d97b23f457a779c301202ba0bb4f", "committedDate": "2021-04-20T12:24:51Z", "message": "exim: Add HAR functionality\n\nAdd HAR import/export functionality.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM5ODgxMTQy", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#pullrequestreview-639881142", "createdAt": "2021-04-20T12:25:28Z", "commit": {"oid": "03c816015082d97b23f457a779c301202ba0bb4f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM5ODg0Nzcz", "url": "https://github.com/zaproxy/zap-extensions/pull/2525#pullrequestreview-639884773", "createdAt": "2021-04-20T12:29:02Z", "commit": {"oid": "03c816015082d97b23f457a779c301202ba0bb4f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 291, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}