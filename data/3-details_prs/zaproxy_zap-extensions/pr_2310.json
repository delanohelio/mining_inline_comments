{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MjcwNTU3", "number": 2310, "title": "Extract more sharedutil methods", "bodyText": "Created PiiUtils from the PiiScanner.\nModify PiiScanner to use the shared utils, remove TODO note.\nModify InformationDisclosureReferrerScanner to use the shared utils.\nInformationDisclosureReferrerScannerUnitTest removed an un-used local variable in one of the tests (call it a clean code activity).\nAdd generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com", "createdAt": "2020-02-17T18:35:02Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2310", "merged": true, "mergeCommit": {"oid": "7371dc8f700e88d71bd401f9d06c3c8a3b71675a"}, "closed": true, "closedAt": "2020-02-18T15:37:47Z", "author": {"login": "kingthorin"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFSW4LgBqjMwNDQ3OTIzMjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFjyoYgFqTM2MDQ0MTE4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eb22fe073f8c7d1b21b59e125350aba9125a3137", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/eb22fe073f8c7d1b21b59e125350aba9125a3137", "committedDate": "2020-02-17T18:34:04Z", "message": "Extract more sharedutil methods\n\n- Created NumUtils and PiiUtils from methods in PiiScanner.\n- Modify PiiScanner to use the shared utils, remove TODO note.\n- Modify InformationDisclosureReferrerScanner to use the shared utils.\n- Add generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "164f14a3657708378fe5eb8f096123c08893018f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/164f14a3657708378fe5eb8f096123c08893018f", "committedDate": "2020-02-17T19:18:36Z", "message": "Extract more sharedutil methods\n\n- Created NumUtils and PiiUtils from methods in PiiScanner.\n- Modify PiiScanner to use the shared utils, remove TODO note.\n- Modify InformationDisclosureReferrerScanner to use the shared utils.\n- Add generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/d60736601b64179db257e47e0dc3d9e251b14f48", "committedDate": "2020-02-18T14:50:56Z", "message": "Extract more sharedutil methods\n\n- Created PiiUtils from the PiiScanner.\n- Modify PiiScanner to use the shared utils, remove TODO note.\n- Modify InformationDisclosureReferrerScanner to use the shared utils.\nInformationDisclosureReferrerScannerUnitTest removed an un-used local\nvariable in one of the tests (call it a clean code activity).\n- Add generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "164f14a3657708378fe5eb8f096123c08893018f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/164f14a3657708378fe5eb8f096123c08893018f", "committedDate": "2020-02-17T19:18:36Z", "message": "Extract more sharedutil methods\n\n- Created NumUtils and PiiUtils from methods in PiiScanner.\n- Modify PiiScanner to use the shared utils, remove TODO note.\n- Modify InformationDisclosureReferrerScanner to use the shared utils.\n- Add generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/d60736601b64179db257e47e0dc3d9e251b14f48", "committedDate": "2020-02-18T14:50:56Z", "message": "Extract more sharedutil methods\n\n- Created PiiUtils from the PiiScanner.\n- Modify PiiScanner to use the shared utils, remove TODO note.\n- Modify InformationDisclosureReferrerScanner to use the shared utils.\nInformationDisclosureReferrerScannerUnitTest removed an un-used local\nvariable in one of the tests (call it a clean code activity).\n- Add generic \"Maintenance changes\" note to CHANGELOGs.\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDAxMjA1", "url": "https://github.com/zaproxy/zap-extensions/pull/2310#pullrequestreview-360401205", "createdAt": "2020-02-18T14:52:32Z", "commit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNDo1MjozM1rOFrFWew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNDo1MjozM1rOFrFWew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcyMDc2Mw==", "bodyText": "I figured this javadoc may as well be kept in-case we come up with a reason to to split this out in the future.", "url": "https://github.com/zaproxy/zap-extensions/pull/2310#discussion_r380720763", "createdAt": "2020-02-18T14:52:33Z", "author": {"login": "kingthorin"}, "path": "addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/PiiScanner.java", "diffHunk": "@@ -95,30 +95,22 @@ public void scanHttpResponseReceive(HttpMessage msg, int id, Source source) {\n                 Matcher matcher = cc.matcher(candidate.getCandidate());\n                 while (matcher.find()) {\n                     String evidence = matcher.group();\n-                    if (validateLuhnChecksum(evidence) && !isSci(candidate.getContainingString())) {\n+                    if (PiiUtils.isValidLuhn(evidence) && !isSci(candidate.getContainingString())) {\n                         raiseAlert(msg, id, evidence, cc.name);\n                     }\n                 }\n             }\n         }\n     }\n \n-    private static boolean validateLuhnChecksum(String evidence) {\n-        int sum = 0;\n-        int parity = evidence.length() % 2;\n-        for (int index = 0; index < evidence.length(); index++) {\n-            int digit = Integer.parseInt(evidence.substring(index, index + 1));\n-            if ((index % 2) == parity) {\n-                digit *= 2;\n-                if (digit > 9) {\n-                    digit -= 9;\n-                }\n-            }\n-            sum += digit;\n-        }\n-        return (sum % 10) == 0;\n-    }\n-\n+    /**\n+     * Checks whether a particular {@code String} input appears to be a valid number in scientific\n+     * (exponent) notation. Ex: 2.14111111111111111e-2, 8.46786664623715E-47, 3.14111111111117293e5\n+     *\n+     * @param containingString the value to be checked.\n+     * @return {@code true} if the value successfully parses as a {@code Float}, {@code false}\n+     *     otherwise.\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDE4NTg0", "url": "https://github.com/zaproxy/zap-extensions/pull/2310#pullrequestreview-360418584", "createdAt": "2020-02-18T15:12:19Z", "commit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDQxMTg1", "url": "https://github.com/zaproxy/zap-extensions/pull/2310#pullrequestreview-360441185", "createdAt": "2020-02-18T15:37:41Z", "commit": {"oid": "d60736601b64179db257e47e0dc3d9e251b14f48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 445, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}