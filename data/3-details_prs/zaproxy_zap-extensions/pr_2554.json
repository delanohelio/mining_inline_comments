{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NDE0MDg4", "number": 2554, "title": "Support dark mode and dynamic Look and Feel switching", "bodyText": "Depends on zaproxy/zaproxy#6202\nPart of zaproxy/zaproxy#5542\nSigned-off-by: Simon Bennetts psiinon@gmail.com", "createdAt": "2020-09-30T10:36:14Z", "url": "https://github.com/zaproxy/zap-extensions/pull/2554", "merged": true, "mergeCommit": {"oid": "0f2f3b8b42fac6aedeeb489f340a4c46a1b74869"}, "closed": true, "closedAt": "2020-10-07T17:57:32Z", "author": {"login": "psiinon"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdN7VyjgFqTQ5OTM0MzY5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQQSw6ABqjM4NTE2NzYxMDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MzQzNjk2", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#pullrequestreview-499343696", "createdAt": "2020-09-30T11:45:52Z", "commit": {"oid": "3dfd4afaab93e23590c62d21822099ec1c0b7357"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMTo0NTo1MlrOHaZo7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMTo0NjoyM1rOHaZqBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NTEwMg==", "bodyText": "Since this same code appears 3 times with the only difference being the object it's being applied to maybe just extract a method?", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#discussion_r497445102", "createdAt": "2020-09-30T11:45:52Z", "author": {"login": "kingthorin"}, "path": "addOns/scripts/src/main/java/org/zaproxy/zap/extension/scripts/CommandPanel.java", "diffHunk": "@@ -94,10 +99,86 @@ private SyntaxHighlightTextArea getTxtOutput() {\n             if (listener != null) {\n                 this.syntaxTxtArea.addKeyListener(listener);\n             }\n+            if (isDarkLaF()) {\n+                darkLaF = true;\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/dark.xml\"));\n+                    theme.apply(this.syntaxTxtArea);\n+                } catch (IOException e) {\n+                    // Ignore\n+                }\n+            } else {\n+                darkLaF = false;\n+            }\n         }\n         return this.syntaxTxtArea;\n     }\n \n+    private Boolean supportsDarkLaF;\n+    private Method isDarkLookAndFeelMethod;\n+    private boolean darkLaF;\n+\n+    private boolean isDarkLaF() {\n+        // TODO Update to calling the DisplayUtils.isDarkLookAndFeel() method directly once it is\n+        // available\n+        if (supportsDarkLaF == null) {\n+            supportsDarkLaF = false;\n+            try {\n+                Class<DisplayUtils> cls = DisplayUtils.class;\n+                isDarkLookAndFeelMethod = cls.getMethod(\"isDarkLookAndFeel\");\n+                if (isDarkLookAndFeelMethod != null) {\n+                    supportsDarkLaF = true;\n+                }\n+            } catch (Exception e) {\n+                // Ignore\n+            }\n+        }\n+        if (isDarkLookAndFeelMethod != null) {\n+            try {\n+                Object obj = isDarkLookAndFeelMethod.invoke(null);\n+                if (obj instanceof Boolean) {\n+                    return (Boolean) obj;\n+                }\n+            } catch (Exception e) {\n+                // Ignore\n+            }\n+        }\n+        return false;\n+    }\n+\n+    @Override\n+    public void updateUI() {\n+        super.updateUI();\n+        if (darkLaF != isDarkLaF()) {\n+            if (isDarkLaF()) {\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/dark.xml\"));\n+                    theme.apply(getTxtOutput());\n+                } catch (IOException e) {\n+                    // Ignore\n+                }\n+                darkLaF = true;\n+            } else {\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/default.xml\"));\n+                    theme.apply(getTxtOutput());\n+                } catch (IOException e) {\n+                    // Ignore\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dfd4afaab93e23590c62d21822099ec1c0b7357"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NTM4MA==", "bodyText": "Maybe also extract the xml file path to a constant?", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#discussion_r497445380", "createdAt": "2020-09-30T11:46:23Z", "author": {"login": "kingthorin"}, "path": "addOns/scripts/src/main/java/org/zaproxy/zap/extension/scripts/CommandPanel.java", "diffHunk": "@@ -94,10 +99,86 @@ private SyntaxHighlightTextArea getTxtOutput() {\n             if (listener != null) {\n                 this.syntaxTxtArea.addKeyListener(listener);\n             }\n+            if (isDarkLaF()) {\n+                darkLaF = true;\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/dark.xml\"));\n+                    theme.apply(this.syntaxTxtArea);\n+                } catch (IOException e) {\n+                    // Ignore\n+                }\n+            } else {\n+                darkLaF = false;\n+            }\n         }\n         return this.syntaxTxtArea;\n     }\n \n+    private Boolean supportsDarkLaF;\n+    private Method isDarkLookAndFeelMethod;\n+    private boolean darkLaF;\n+\n+    private boolean isDarkLaF() {\n+        // TODO Update to calling the DisplayUtils.isDarkLookAndFeel() method directly once it is\n+        // available\n+        if (supportsDarkLaF == null) {\n+            supportsDarkLaF = false;\n+            try {\n+                Class<DisplayUtils> cls = DisplayUtils.class;\n+                isDarkLookAndFeelMethod = cls.getMethod(\"isDarkLookAndFeel\");\n+                if (isDarkLookAndFeelMethod != null) {\n+                    supportsDarkLaF = true;\n+                }\n+            } catch (Exception e) {\n+                // Ignore\n+            }\n+        }\n+        if (isDarkLookAndFeelMethod != null) {\n+            try {\n+                Object obj = isDarkLookAndFeelMethod.invoke(null);\n+                if (obj instanceof Boolean) {\n+                    return (Boolean) obj;\n+                }\n+            } catch (Exception e) {\n+                // Ignore\n+            }\n+        }\n+        return false;\n+    }\n+\n+    @Override\n+    public void updateUI() {\n+        super.updateUI();\n+        if (darkLaF != isDarkLaF()) {\n+            if (isDarkLaF()) {\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/dark.xml\"));\n+                    theme.apply(getTxtOutput());\n+                } catch (IOException e) {\n+                    // Ignore\n+                }\n+                darkLaF = true;\n+            } else {\n+                try {\n+                    Theme theme =\n+                            Theme.load(\n+                                    HttpPanelSyntaxHighlightTextArea.class.getResourceAsStream(\n+                                            \"/org/fife/ui/rsyntaxtextarea/themes/default.xml\"));\n+                    theme.apply(getTxtOutput());\n+                } catch (IOException e) {\n+                    // Ignore\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NTEwMg=="}, "originalCommit": {"oid": "3dfd4afaab93e23590c62d21822099ec1c0b7357"}, "originalPosition": 98}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3dfd4afaab93e23590c62d21822099ec1c0b7357", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/3dfd4afaab93e23590c62d21822099ec1c0b7357", "committedDate": "2020-09-30T10:35:47Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}, "afterCommit": {"oid": "91ee740c801aa3c5fa2e724f2bc999ff9d753037", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/91ee740c801aa3c5fa2e724f2bc999ff9d753037", "committedDate": "2020-10-07T15:31:58Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDMwNTM0", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#pullrequestreview-504030534", "createdAt": "2020-10-07T15:54:57Z", "commit": {"oid": "91ee740c801aa3c5fa2e724f2bc999ff9d753037"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91ee740c801aa3c5fa2e724f2bc999ff9d753037", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/91ee740c801aa3c5fa2e724f2bc999ff9d753037", "committedDate": "2020-10-07T15:31:58Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}, "afterCommit": {"oid": "20394bdb7b86392af6df7397214f3a0193f4f41b", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/20394bdb7b86392af6df7397214f3a0193f4f41b", "committedDate": "2020-10-07T15:56:04Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDQ0OTE0", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#pullrequestreview-504044914", "createdAt": "2020-10-07T16:10:18Z", "commit": {"oid": "20394bdb7b86392af6df7397214f3a0193f4f41b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDQ5NzQ1", "url": "https://github.com/zaproxy/zap-extensions/pull/2554#pullrequestreview-504049745", "createdAt": "2020-10-07T16:15:50Z", "commit": {"oid": "20394bdb7b86392af6df7397214f3a0193f4f41b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72fce44051344ce3117a86140998af2a386ca863", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/72fce44051344ce3117a86140998af2a386ca863", "committedDate": "2020-10-07T17:18:47Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20394bdb7b86392af6df7397214f3a0193f4f41b", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/20394bdb7b86392af6df7397214f3a0193f4f41b", "committedDate": "2020-10-07T15:56:04Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}, "afterCommit": {"oid": "72fce44051344ce3117a86140998af2a386ca863", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zap-extensions/commit/72fce44051344ce3117a86140998af2a386ca863", "committedDate": "2020-10-07T17:18:47Z", "message": "Support dark mode and dynamic Look and Feel switching\n\nDepends on https://github.com/zaproxy/zaproxy/pull/6202\n\nPart of https://github.com/zaproxy/zaproxy/issues/5542\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 306, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}