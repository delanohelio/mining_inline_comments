{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMTU0OTUw", "number": 1859, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjowOTo0NVrODyWgdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzo0ODo0NFrOD9rWYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTI0MTUwOnYy", "diffSide": "RIGHT", "path": "src/main/java/graphql/validation/Validator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjowOTo0NVrOGGV8Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxMzoyMjo1N1rOGGlCbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMwNDEwMg==", "bodyText": "Please change this back.  We use non .* imports", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r409304102", "createdAt": "2020-04-16T06:09:45Z", "author": {"login": "bbakerman"}, "path": "src/main/java/graphql/validation/Validator.java", "diffHunk": "@@ -4,32 +4,7 @@\n import graphql.Internal;\n import graphql.language.Document;\n import graphql.schema.GraphQLSchema;\n-import graphql.validation.rules.ArgumentsOfCorrectType;\n-import graphql.validation.rules.DeferredDirectiveOnNonNullableField;\n-import graphql.validation.rules.DeferredDirectiveOnQueryOperation;\n-import graphql.validation.rules.DeferredMustBeOnAllFields;\n-import graphql.validation.rules.ExecutableDefinitions;\n-import graphql.validation.rules.FieldsOnCorrectType;\n-import graphql.validation.rules.FragmentsOnCompositeType;\n-import graphql.validation.rules.KnownArgumentNames;\n-import graphql.validation.rules.KnownDirectives;\n-import graphql.validation.rules.KnownFragmentNames;\n-import graphql.validation.rules.KnownTypeNames;\n-import graphql.validation.rules.LoneAnonymousOperation;\n-import graphql.validation.rules.NoFragmentCycles;\n-import graphql.validation.rules.NoUndefinedVariables;\n-import graphql.validation.rules.NoUnusedFragments;\n-import graphql.validation.rules.NoUnusedVariables;\n-import graphql.validation.rules.OverlappingFieldsCanBeMerged;\n-import graphql.validation.rules.PossibleFragmentSpreads;\n-import graphql.validation.rules.ProvidedNonNullArguments;\n-import graphql.validation.rules.ScalarLeafs;\n-import graphql.validation.rules.UniqueDirectiveNamesPerLocation;\n-import graphql.validation.rules.UniqueFragmentNames;\n-import graphql.validation.rules.UniqueOperationNames;\n-import graphql.validation.rules.VariableDefaultValuesOfCorrectType;\n-import graphql.validation.rules.VariableTypesMatchRule;\n-import graphql.validation.rules.VariablesAreInputTypes;\n+import graphql.validation.rules.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2751c40c834f29ed842df4e196123eb3c5f0d9f0"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU1MTQ2OQ==", "bodyText": "Done, thanks for code review", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r409551469", "createdAt": "2020-04-16T13:22:57Z", "author": {"login": "dugenkui03"}, "path": "src/main/java/graphql/validation/Validator.java", "diffHunk": "@@ -4,32 +4,7 @@\n import graphql.Internal;\n import graphql.language.Document;\n import graphql.schema.GraphQLSchema;\n-import graphql.validation.rules.ArgumentsOfCorrectType;\n-import graphql.validation.rules.DeferredDirectiveOnNonNullableField;\n-import graphql.validation.rules.DeferredDirectiveOnQueryOperation;\n-import graphql.validation.rules.DeferredMustBeOnAllFields;\n-import graphql.validation.rules.ExecutableDefinitions;\n-import graphql.validation.rules.FieldsOnCorrectType;\n-import graphql.validation.rules.FragmentsOnCompositeType;\n-import graphql.validation.rules.KnownArgumentNames;\n-import graphql.validation.rules.KnownDirectives;\n-import graphql.validation.rules.KnownFragmentNames;\n-import graphql.validation.rules.KnownTypeNames;\n-import graphql.validation.rules.LoneAnonymousOperation;\n-import graphql.validation.rules.NoFragmentCycles;\n-import graphql.validation.rules.NoUndefinedVariables;\n-import graphql.validation.rules.NoUnusedFragments;\n-import graphql.validation.rules.NoUnusedVariables;\n-import graphql.validation.rules.OverlappingFieldsCanBeMerged;\n-import graphql.validation.rules.PossibleFragmentSpreads;\n-import graphql.validation.rules.ProvidedNonNullArguments;\n-import graphql.validation.rules.ScalarLeafs;\n-import graphql.validation.rules.UniqueDirectiveNamesPerLocation;\n-import graphql.validation.rules.UniqueFragmentNames;\n-import graphql.validation.rules.UniqueOperationNames;\n-import graphql.validation.rules.VariableDefaultValuesOfCorrectType;\n-import graphql.validation.rules.VariableTypesMatchRule;\n-import graphql.validation.rules.VariablesAreInputTypes;\n+import graphql.validation.rules.*;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMwNDEwMg=="}, "originalCommit": {"oid": "2751c40c834f29ed842df4e196123eb3c5f0d9f0"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NTAzMTI3OnYy", "diffSide": "RIGHT", "path": "src/test/groovy/graphql/validation/rules/UniqueVariableNamesRulerTest.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzozOTozMFrOGG66Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxNzowMTo1NVrOGHV97A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwOTc3OA==", "bodyText": "FYI - triple quoted single quotes means you never have to escape $ things\n    def query = '''\n             query($arg:Int,$arg:Int){\n                field(arg: $arg)\n             } \n          '''", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r409909778", "createdAt": "2020-04-16T23:39:30Z", "author": {"login": "bbakerman"}, "path": "src/test/groovy/graphql/validation/rules/UniqueVariableNamesRulerTest.groovy", "diffHunk": "@@ -0,0 +1,51 @@\n+package graphql.validation.rules\n+\n+import graphql.TestUtil\n+import graphql.parser.Parser\n+import graphql.validation.ValidationError\n+import graphql.validation.ValidationErrorType\n+import graphql.validation.Validator\n+import spock.lang.Specification\n+\n+class UniqueVariableNamesRulerTest extends Specification {\n+\n+    def schema = TestUtil.schema('''\n+            type Query {\n+                field(arg: Int) : String\n+            }\n+        ''')\n+\n+    def \"normal query \"() {\n+\n+        def query = \"\"\"\n+             query(\\$arg:Int){\n+                field(arg: \\$arg)\n+             } \n+          \"\"\"\n+\n+        when:\n+        def document = Parser.parse(query)\n+        def validationResult = new Validator().validateDocument(schema, document)\n+\n+        then:\n+        validationResult.size() == 0\n+    }\n+\n+    def \"duplicate variable name error\"() {\n+\n+        def query = \"\"\"\n+             query(\\$arg:Int,\\$arg:Int){\n+                field(arg: \\$arg)\n+             } \n+          \"\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52ab4771cc98b627bf1ab470d404c78f8edf4727"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM1MzEzMg==", "bodyText": "Thanks for you code review and information", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r410353132", "createdAt": "2020-04-17T17:01:55Z", "author": {"login": "dugenkui03"}, "path": "src/test/groovy/graphql/validation/rules/UniqueVariableNamesRulerTest.groovy", "diffHunk": "@@ -0,0 +1,51 @@\n+package graphql.validation.rules\n+\n+import graphql.TestUtil\n+import graphql.parser.Parser\n+import graphql.validation.ValidationError\n+import graphql.validation.ValidationErrorType\n+import graphql.validation.Validator\n+import spock.lang.Specification\n+\n+class UniqueVariableNamesRulerTest extends Specification {\n+\n+    def schema = TestUtil.schema('''\n+            type Query {\n+                field(arg: Int) : String\n+            }\n+        ''')\n+\n+    def \"normal query \"() {\n+\n+        def query = \"\"\"\n+             query(\\$arg:Int){\n+                field(arg: \\$arg)\n+             } \n+          \"\"\"\n+\n+        when:\n+        def document = Parser.parse(query)\n+        def validationResult = new Validator().validateDocument(schema, document)\n+\n+        then:\n+        validationResult.size() == 0\n+    }\n+\n+    def \"duplicate variable name error\"() {\n+\n+        def query = \"\"\"\n+             query(\\$arg:Int,\\$arg:Int){\n+                field(arg: \\$arg)\n+             } \n+          \"\"\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwOTc3OA=="}, "originalCommit": {"oid": "52ab4771cc98b627bf1ab470d404c78f8edf4727"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTk5ODI1OnYy", "diffSide": "RIGHT", "path": "src/main/java/graphql/validation/rules/UniqueVariableNamesRule.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzo0ODoxOVrOGXT8Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzo0ODoxOVrOGXT8Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5NzE3MQ==", "bodyText": "we use LinkedHashSet in general in favor of HashSet because it preserves the order.", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r427097171", "createdAt": "2020-05-19T07:48:19Z", "author": {"login": "andimarek"}, "path": "src/main/java/graphql/validation/rules/UniqueVariableNamesRule.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package graphql.validation.rules;\n+\n+import graphql.language.*;\n+import graphql.validation.AbstractRule;\n+import graphql.validation.ValidationContext;\n+import graphql.validation.ValidationErrorCollector;\n+import graphql.validation.ValidationErrorType;\n+\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+/**\n+ * Unique variable names\n+ * <p>\n+ * A GraphQL operation is only valid if all its variables are uniquely named.\n+ */\n+public class UniqueVariableNamesRule extends AbstractRule {\n+\n+    public UniqueVariableNamesRule(ValidationContext validationContext, ValidationErrorCollector validationErrorCollector) {\n+        super(validationContext, validationErrorCollector);\n+    }\n+\n+    @Override\n+    public void checkOperationDefinition(OperationDefinition operationDefinition) {\n+        List<VariableDefinition> variableDefinitions = operationDefinition.getVariableDefinitions();\n+        if (variableDefinitions == null || variableDefinitions.size() <= 1) {\n+            return;\n+        }\n+\n+        Set<String> variableNameList = new HashSet<>(variableDefinitions.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52ab4771cc98b627bf1ab470d404c78f8edf4727"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTk5OTY4OnYy", "diffSide": "RIGHT", "path": "src/main/java/graphql/validation/rules/UniqueVariableNamesRule.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzo0ODo0NFrOGXT9RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxNzo0NVrOGXs6XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5NzQxMg==", "bodyText": "please have a look at the intellij formatter inside the root folder: we don't use * imports.", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r427097412", "createdAt": "2020-05-19T07:48:44Z", "author": {"login": "andimarek"}, "path": "src/main/java/graphql/validation/rules/UniqueVariableNamesRule.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package graphql.validation.rules;\n+\n+import graphql.language.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52ab4771cc98b627bf1ab470d404c78f8edf4727"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUwNjI2OQ==", "bodyText": "Thanks for your review and guide, I have updated intellij setting and PR.", "url": "https://github.com/graphql-java/graphql-java/pull/1859#discussion_r427506269", "createdAt": "2020-05-19T18:17:45Z", "author": {"login": "dugenkui03"}, "path": "src/main/java/graphql/validation/rules/UniqueVariableNamesRule.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package graphql.validation.rules;\n+\n+import graphql.language.*;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5NzQxMg=="}, "originalCommit": {"oid": "52ab4771cc98b627bf1ab470d404c78f8edf4727"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4607, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}