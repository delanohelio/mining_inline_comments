{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2MDg0NDE5", "number": 2110, "title": "Improve AstPrinter performance", "bodyText": "Changes:\n\nRemoved use of StringWriter (which uses StringBuffer under the hood) with StringBuilder\nReplaced all PrintWriter.printf with StringBuilder.append\n\nFrom what I can see there's no point is using StringBuffer as the printing process is single threaded.\nI looked over this twice and I don't think I missed anything in this change. Please feel free to double check.\nIf you checkout 133b617 then there is a benchmark comparing the two implementations.\nBenchmark results:\nBenchmark                                             Mode  Cnt     Score    Error  Units\nAstPrinterBenchmark.benchMarkAstPrinterThroughput    thrpt   15   902.530 \u00b1 21.131  ops/s\nAstPrinterBenchmark.benchMarkAstPrinterV2Throughput  thrpt   15  4062.889 \u00b1 61.327  ops/s\nAstPrinterBenchmark.benchMarkAstPrinterAvgTime        avgt   15     1.079 \u00b1  0.016  ms/op\nAstPrinterBenchmark.benchMarkAstPrinterV2AvgTime      avgt   15     0.244 \u00b1  0.005  ms/op", "createdAt": "2020-11-24T00:52:02Z", "url": "https://github.com/graphql-java/graphql-java/pull/2110", "merged": true, "mergeCommit": {"oid": "be8025f9315362dc5c4ff38194313e4a8752975a"}, "closed": true, "closedAt": "2020-11-28T08:14:10Z", "author": {"login": "gnawf"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfeR8FAH2gAyNTI2MDg0NDE5OjEzM2I2MTdkMGIwNzllNmNlYTc5YjljODJmZmIzMmNjMjQ0NzkyOGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdg3pDhAFqTU0MDM1MTE1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "133b617d0b079e6cea79b9c82ffb32cc2447928a", "author": {"user": {"login": "gnawf", "name": "Franklin Wang"}}, "url": "https://github.com/graphql-java/graphql-java/commit/133b617d0b079e6cea79b9c82ffb32cc2447928a", "committedDate": "2020-11-24T00:05:38Z", "message": "Add new AST Printer and benchmark"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c2127596b6b1705a54d2bda4f1f1296cb24b087", "author": {"user": {"login": "gnawf", "name": "Franklin Wang"}}, "url": "https://github.com/graphql-java/graphql-java/commit/3c2127596b6b1705a54d2bda4f1f1296cb24b087", "committedDate": "2020-11-24T00:05:39Z", "message": "Migrate to new AST printer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "299778c5edc12cb0210712ecc7410d8c1fb0d89e", "author": {"user": {"login": "gnawf", "name": "Franklin Wang"}}, "url": "https://github.com/graphql-java/graphql-java/commit/299778c5edc12cb0210712ecc7410d8c1fb0d89e", "committedDate": "2020-11-24T00:59:48Z", "message": "Fix method signature"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3MTA3NTgw", "url": "https://github.com/graphql-java/graphql-java/pull/2110#pullrequestreview-537107580", "createdAt": "2020-11-24T06:22:20Z", "commit": {"oid": "299778c5edc12cb0210712ecc7410d8c1fb0d89e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQwNjoyMjoyMFrOH4tidA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQwNjoyMjoyMFrOH4tidA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTIyODQwNA==", "bodyText": "Seems fair enough", "url": "https://github.com/graphql-java/graphql-java/pull/2110#discussion_r529228404", "createdAt": "2020-11-24T06:22:20Z", "author": {"login": "bbakerman"}, "path": "src/main/java/graphql/language/AstPrinter.java", "diffHunk": "@@ -4,9 +4,7 @@\n import graphql.PublicApi;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "299778c5edc12cb0210712ecc7410d8c1fb0d89e"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMzUxMTU3", "url": "https://github.com/graphql-java/graphql-java/pull/2110#pullrequestreview-540351157", "createdAt": "2020-11-28T08:12:25Z", "commit": {"oid": "299778c5edc12cb0210712ecc7410d8c1fb0d89e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQwODoxMjoyNlrOH7W8Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQwODoxMjoyNlrOH7W8Tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjAwMzkxOA==", "bodyText": "Nice test example!", "url": "https://github.com/graphql-java/graphql-java/pull/2110#discussion_r532003918", "createdAt": "2020-11-28T08:12:26Z", "author": {"login": "bbakerman"}, "path": "src/test/java/benchmark/AstPrinterBenchmark.java", "diffHunk": "@@ -0,0 +1,236 @@\n+package benchmark;\n+\n+import graphql.language.AstPrinter;\n+import graphql.language.Document;\n+import graphql.parser.Parser;\n+import org.openjdk.jmh.annotations.Benchmark;\n+import org.openjdk.jmh.annotations.BenchmarkMode;\n+import org.openjdk.jmh.annotations.Measurement;\n+import org.openjdk.jmh.annotations.Mode;\n+import org.openjdk.jmh.annotations.OutputTimeUnit;\n+import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.infra.Blackhole;\n+\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * See http://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/ for more samples\n+ * on what you can do with JMH\n+ * <p>\n+ * You MUST have the JMH plugin for IDEA in place for this to work :  https://github.com/artyushov/idea-jmh-plugin\n+ * <p>\n+ * Install it and then just hit \"Run\" on a certain benchmark method\n+ */\n+@Warmup(iterations = 2, time = 5, batchSize = 3)\n+@Measurement(iterations = 3, time = 10, batchSize = 4)\n+public class AstPrinterBenchmark {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "299778c5edc12cb0210712ecc7410d8c1fb0d89e"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4306, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}