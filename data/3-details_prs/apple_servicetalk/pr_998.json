{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3ODc0MzEy", "number": 998, "title": "Work around SpotBugs JDK11 bug, make code more robust", "bodyText": "Motivation:\nSpotBugs has a bug impacting builds on JDK11 spotbugs/spotbugs#756. This also hinted at an area that could be made more robust.\nModifications:\n\nIgnore SpotBugs warning due to bug\nImprove robustness of handling null element from iterator\n\nResult:\nSpotBugs no longer fails on JDK11 builds.", "createdAt": "2020-04-03T00:30:44Z", "url": "https://github.com/apple/servicetalk/pull/998", "merged": true, "mergeCommit": {"oid": "9b45657ce86490b81708236e96b726bad885e1ed"}, "closed": true, "closedAt": "2020-04-03T19:23:02Z", "author": {"login": "Scottmitch"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcT1x2uAH2gAyMzk3ODc0MzEyOmFmOTg5MjhhNDg2YzkzNzI1MGViNDE4Y2EyNmY1OTk4Y2ZlYjlhYjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUFmSngH2gAyMzk3ODc0MzEyOjYyNWU1NjY2YTY4NDU2ZjRjODhkMzA5MjJkNGYyNGM2NGRhY2FmMmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/af98928a486c937250eb418ca26f5998cfeb9ab0", "committedDate": "2020-04-03T00:30:04Z", "message": "Work around SpotBugs JDK11 bug, make code more robust\n\nMotivation:\nSpotBugs has a bug impacting builds on JDK11 https://github.com/spotbugs/spotbugs/issues/756. This also hinted at an area that could be made more robust.\n\nModifications:\n- Ignore SpotBugs warning due to bug\n- Improve robustness of handling null element from iterator\n\nResult:\nSpotBugs no longer fails on JDK11 builds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODcwNTgz", "url": "https://github.com/apple/servicetalk/pull/998#pullrequestreview-386870583", "createdAt": "2020-04-03T00:45:21Z", "commit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDo0NToyMlrOGABYLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDo0NToyMlrOGABYLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3NTc1Ng==", "bodyText": "null value here is essentially OK from the context of this call and we generally pass through null.", "url": "https://github.com/apple/servicetalk/pull/998#discussion_r402675756", "createdAt": "2020-04-03T00:45:22Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/DefaultGrpcClientCallFactory.java", "diffHunk": "@@ -155,7 +156,10 @@\n                 newBlockingStreamingCall(serializationProvider, requestClass, responseClass);\n         return (metadata, request) -> {\n             try (BlockingIterator<Resp> iterator = streamingClientCall.request(metadata, request).iterator()) {\n-                final Resp firstItem = iterator.next();\n+                final Resp firstItem;\n+                if (!iterator.hasNext() || (firstItem = iterator.next()) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODcwOTE4", "url": "https://github.com/apple/servicetalk/pull/998#pullrequestreview-386870918", "createdAt": "2020-04-03T00:46:26Z", "commit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDo0NjoyNlrOGABZQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDo0NjoyNlrOGABZQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3NjAzMg==", "bodyText": "Same here, we should pass through null values.", "url": "https://github.com/apple/servicetalk/pull/998#discussion_r402676032", "createdAt": "2020-04-03T00:46:26Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/GrpcRouter.java", "diffHunk": "@@ -593,11 +593,10 @@ public void handle(final GrpcServiceContext ctx, final BlockingIterable<Req> req\n                                            final GrpcPayloadWriter<Resp> responseWriter) throws Exception {\n                             final Req firstItem;\n                             try (BlockingIterator<Req> requestIterator = request.iterator()) {\n-                                if (!requestIterator.hasNext()) {\n+                                if (!requestIterator.hasNext() || (firstItem = requestIterator.next()) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDA5NDU3", "url": "https://github.com/apple/servicetalk/pull/998#pullrequestreview-387409457", "createdAt": "2020-04-03T16:32:47Z", "commit": {"oid": "af98928a486c937250eb418ca26f5998cfeb9ab0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "625e5666a68456f4c88d30922d4f24c64dacaf2e", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/625e5666a68456f4c88d30922d4f24c64dacaf2e", "committedDate": "2020-04-03T18:55:55Z", "message": "use assert instead of runtime check per review"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3574, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}