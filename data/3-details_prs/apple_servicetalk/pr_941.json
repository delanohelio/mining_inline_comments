{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MjQwMzYw", "number": 941, "title": "Use `payloadBodyAndTrailers()` to drain payload body", "bodyText": "Motivation:\nIn some cases we need to consume payload body and trailers.\nWe usually use payloadBody().ignoreElements() pattern.\nHowever, since the request or response comes from the network,\nit's more efficient to do payloadBodyAndTrailers().ignoreElements()\nto avoid splitting trailers from payload body.\nModifications:\n\nReplace all payloadBody().ignoreElements() usages with\npayloadBodyAndTrailers().ignoreElements();\nDo the same in tests for consistency;\nUpdate performance.adoc to demonstrate payloadBodyAndTrailers\nfor the draining use-case;\n\nResult:\nLess overhead when we need to drain payload body.", "createdAt": "2020-02-17T17:05:04Z", "url": "https://github.com/apple/servicetalk/pull/941", "merged": true, "mergeCommit": {"oid": "f93880efae334019176560bd492eb2a7377114ce"}, "closed": true, "closedAt": "2020-02-18T20:58:38Z", "author": {"login": "idelpivnitskiy"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEaMSeAH2gAyMzc2MjQwMzYwOmVmNWE1OGRlMWYzMGRhMWE5YzIyODllNjMwOTZlY2NjMmI2ZGM3NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFmUwXAH2gAyMzc2MjQwMzYwOjM4NTgyYWJjNzQ3MDgwMGYyZDM3YmE3ZjZjYTY1OTZiMzgwY2VlNjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ef5a58de1f30da1a9c2289e63096eccc2b6dc751", "author": {"user": {"login": "idelpivnitskiy", "name": "Idel Pivnitskiy"}}, "url": "https://github.com/apple/servicetalk/commit/ef5a58de1f30da1a9c2289e63096eccc2b6dc751", "committedDate": "2020-02-15T01:52:44Z", "message": "Use `payloadBodyAndTrailers()` to drain payload body\n\nMotivation:\n\nIn some cases we need to consume payload body and trailers.\nWe usually use `payloadBody().ignoreElements()` pattern.\nHowever, since the request or response comes from the network,\nit's more efficient to do `payloadBodyAndTrailers().ignoreElements()`\nto avoid splitting trailers from payload body.\n\nModifications:\n\n- Replace all `payloadBody().ignoreElements()` usages with\n`payloadBodyAndTrailers().ignoreElements()`;\n- Do the same in tests for consistency;\n- Update `performance.adoc` to demonstrate `payloadBodyAndTrailers`\nfor the draining use-case;\n\nResult:\n\nLess overhead when we need to drain payload body."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNTcyNDk5", "url": "https://github.com/apple/servicetalk/pull/941#pullrequestreview-360572499", "createdAt": "2020-02-18T18:30:00Z", "commit": {"oid": "ef5a58de1f30da1a9c2289e63096eccc2b6dc751"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODozMDowMFrOFrNl2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODozMDowMFrOFrNl2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg1NTc3MQ==", "bodyText": "120", "url": "https://github.com/apple/servicetalk/pull/941#discussion_r380855771", "createdAt": "2020-02-18T18:30:00Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-http-router-jersey/src/testFixtures/java/io/servicetalk/http/router/jersey/CancellationTest.java", "diffHunk": "@@ -239,7 +239,7 @@ public void onSuccess(@Nullable final StreamingHttpResponse result) {\n                         errorRef.compareAndSet(null, new NullPointerException(\"result == null not expected.\"));\n                         cancelledLatch.countDown();\n                     } else {\n-                        result.payloadBody().ignoreElements().afterFinally(cancelledLatch::countDown).subscribe();\n+                        result.payloadBodyAndTrailers().ignoreElements().afterFinally(cancelledLatch::countDown).subscribe();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef5a58de1f30da1a9c2289e63096eccc2b6dc751"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38582abc7470800f2d37ba7f6ca6596b380cee63", "author": {"user": {"login": "idelpivnitskiy", "name": "Idel Pivnitskiy"}}, "url": "https://github.com/apple/servicetalk/commit/38582abc7470800f2d37ba7f6ca6596b380cee63", "committedDate": "2020-02-18T18:34:46Z", "message": "fix checkstyle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3285, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}