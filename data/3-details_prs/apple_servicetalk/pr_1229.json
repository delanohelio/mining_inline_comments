{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1MTgyMjU0", "number": 1229, "title": "Consolidate Test*Subscriber classes", "bodyText": "Motivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n\nLegacyMocked*ListenerRule\nconcurrent.api.Test*Subscriber\nconcurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\nModifications:\n\nRemove all the of test utilities mentioned above\nCreate a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses.", "createdAt": "2020-11-21T19:58:01Z", "url": "https://github.com/apple/servicetalk/pull/1229", "merged": true, "mergeCommit": {"oid": "298ae4f190c64e34177fb47a035bccb2e6549a7a"}, "closed": true, "closedAt": "2020-11-30T18:22:41Z", "author": {"login": "Scottmitch"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdexkE5gFqTUzNjAwNTA2NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhnsGQABqjQwNTI3NDg1NTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDA1MDY0", "url": "https://github.com/apple/servicetalk/pull/1229#pullrequestreview-536005064", "createdAt": "2020-11-21T19:59:43Z", "commit": {"oid": "07133e14b10da963171b6db907727b747a4d5688"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQxOTo1OTo0M1rOH3w_2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQxOTo1OTo0M1rOH3w_2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIzNjUwNw==", "bodyText": "this is a change to real code, caught by updating the test utilities.", "url": "https://github.com/apple/servicetalk/pull/1229#discussion_r528236507", "createdAt": "2020-11-21T19:59:43Z", "author": {"login": "Scottmitch"}, "path": "servicetalk-concurrent-api/src/main/java/io/servicetalk/concurrent/api/PublisherConcatMapIterable.java", "diffHunk": "@@ -172,17 +177,22 @@ private void tryDrainIterator(ErrorHandlingStrategyInDrain errorHandlingStrategy\n                         switch (errorHandlingStrategyInDrain) {\n                             case PropagateAndCancel:\n                                 terminated = true;\n-                                doCancel();\n                                 safeOnError(target, cause);\n+                                doCancel();\n                                 return; // hard return to avoid potential for duplicate terminal events\n                             case Propagate:\n                                 terminated = true;\n                                 safeOnError(target, cause);\n+                                tryClose(currentIterator);\n                                 return; // hard return to avoid potential for duplicate terminal events\n                             case Throw:\n                                 // since we only request 1 at a time we maybe holding requestN demand, in this case we\n                                 // discard the current iterator and request 1 more from upstream (if there is demand).\n                                 hasNext = false;\n+                                thrown = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07133e14b10da963171b6db907727b747a4d5688"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDA1MDkx", "url": "https://github.com/apple/servicetalk/pull/1229#pullrequestreview-536005091", "createdAt": "2020-11-21T20:00:15Z", "commit": {"oid": "07133e14b10da963171b6db907727b747a4d5688"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMDowMDoxNVrOH3xAEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMDowMDoxNVrOH3xAEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIzNjU2Mw==", "bodyText": "this is a change in real code, caught by test utility updates", "url": "https://github.com/apple/servicetalk/pull/1229#discussion_r528236563", "createdAt": "2020-11-21T20:00:15Z", "author": {"login": "Scottmitch"}, "path": "servicetalk-concurrent-api/src/main/java/io/servicetalk/concurrent/api/SingleConcatWithPublisher.java", "diffHunk": "@@ -120,20 +120,22 @@ public void request(long n) {\n                 if (oldVal == REQUESTED || oldVal == CANCELLED) {\n                     super.request(n);\n                     break;\n+                } else if (!isRequestNValid(n)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07133e14b10da963171b6db907727b747a4d5688"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07133e14b10da963171b6db907727b747a4d5688", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/07133e14b10da963171b6db907727b747a4d5688", "committedDate": "2020-11-21T19:55:40Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}, "afterCommit": {"oid": "0a4de04d7b60ba9978eb44f355aeb3aa3b27953b", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/0a4de04d7b60ba9978eb44f355aeb3aa3b27953b", "committedDate": "2020-11-21T21:33:39Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a4de04d7b60ba9978eb44f355aeb3aa3b27953b", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/0a4de04d7b60ba9978eb44f355aeb3aa3b27953b", "committedDate": "2020-11-21T21:33:39Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}, "afterCommit": {"oid": "325268879b1e3945fc9fd389969ebe6730bb621b", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/325268879b1e3945fc9fd389969ebe6730bb621b", "committedDate": "2020-11-21T21:47:31Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwOTUyODQ1", "url": "https://github.com/apple/servicetalk/pull/1229#pullrequestreview-540952845", "createdAt": "2020-11-30T14:22:16Z", "commit": {"oid": "325268879b1e3945fc9fd389969ebe6730bb621b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8e83bce333e427b4e06f4027fc6033361f842c6", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/f8e83bce333e427b4e06f4027fc6033361f842c6", "committedDate": "2020-11-30T16:10:52Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "325268879b1e3945fc9fd389969ebe6730bb621b", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/325268879b1e3945fc9fd389969ebe6730bb621b", "committedDate": "2020-11-21T21:47:31Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}, "afterCommit": {"oid": "f8e83bce333e427b4e06f4027fc6033361f842c6", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/f8e83bce333e427b4e06f4027fc6033361f842c6", "committedDate": "2020-11-30T16:10:52Z", "message": "Consolidate Test*Subscriber classes\n\nMotivation:\nThere are 3 variants of test subscriber classes that have organically\nbeen added over time:\n- LegacyMocked*ListenerRule\n- concurrent.api.Test*Subscriber\n- concurrent.api.TestCollecting*Subscriber\n\nThere is no technical justification for the duplication, and some older\ntest utilities lend themselves toward violating the reactive streams\nspecification.\n\nModifications:\n- Remove all the of test utilities mentioned above\n- Create a servicetalk-concurrent-test-internal module with\nTestSubscribers build from concurrent.api.TestCollecting*Subscriber\n\nResult:\nThere is a single set of low-level, currently internal, Test*Subscriber\nclasses."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3352, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}