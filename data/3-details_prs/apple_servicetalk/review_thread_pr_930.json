{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5OTMxOTc3", "number": 930, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo0ODozNFrODczYYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo1ODozNVrODczh7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTI4NTQ1OnYy", "diffSide": "RIGHT", "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/GrpcRouter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo0ODozNFrOFlCtBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo0ODozNFrOFlCtBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM4NTkyNA==", "bodyText": "nit: rename to mergeRoutes()?", "url": "https://github.com/apple/servicetalk/pull/930#discussion_r374385924", "createdAt": "2020-02-03T22:48:34Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/GrpcRouter.java", "diffHunk": "@@ -199,19 +201,26 @@ RouteProviders drainRoutes() {\n             final Map<String, RouteProvider> blockingRoutes = new HashMap<>();\n             final Map<String, RouteProvider> blockingStreamingRoutes = new HashMap<>();\n             for (Builder builder : builders) {\n-                routes.putAll(builder.routes);\n-                streamingRoutes.putAll(builder.streamingRoutes);\n-                blockingRoutes.putAll(builder.blockingRoutes);\n-                blockingStreamingRoutes.putAll(builder.blockingStreamingRoutes);\n+                mergeMaps(routes, builder.routes);\n+                mergeMaps(streamingRoutes, builder.streamingRoutes);\n+                mergeMaps(blockingRoutes, builder.blockingRoutes);\n+                mergeMaps(blockingStreamingRoutes, builder.blockingStreamingRoutes);\n             }\n             return new Builder(routes, streamingRoutes, blockingRoutes, blockingStreamingRoutes);\n         }\n \n+        private static void mergeMaps(final Map<String, RouteProvider> first, final Map<String, RouteProvider> second) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa226d4d79afbefea695dd8c73766a3c31f5a200"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTMwOTg4OnYy", "diffSide": "RIGHT", "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/GrpcRouter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo1ODozNVrOFlC79w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMjo1ODozNVrOFlC79w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM4OTc1MQ==", "bodyText": "It is somewhat non-intuitive that we are only checking for one alternative Map when we have 3 more Maps of routes.\nConsider adding a comment to explain that we only assume duplication across blocking and async variant of the same API and not between scalar and streaming.", "url": "https://github.com/apple/servicetalk/pull/930#discussion_r374389751", "createdAt": "2020-02-03T22:58:35Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-grpc-api/src/main/java/io/servicetalk/grpc/api/GrpcRouter.java", "diffHunk": "@@ -247,15 +256,15 @@ public Completable closeAsyncGracefully() {\n                         }\n                     }, strategy -> executionStrategy == null ? strategy : executionStrategy),\n                     () -> toStreaming(route), () -> toRequestStreamingRoute(route),\n-                    () -> toResponseStreamingRoute(route), () -> route, route));\n+                    () -> toResponseStreamingRoute(route), () -> route, route)), path, blockingRoutes);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa226d4d79afbefea695dd8c73766a3c31f5a200"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2834, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}