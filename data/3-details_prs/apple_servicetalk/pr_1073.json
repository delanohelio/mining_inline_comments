{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1MzIxMTk0", "number": 1073, "title": "Clarify exception when payload body can not be aggregated", "bodyText": "Motivation:\nAggregation of the payload body may fail due to some reasons.\nFor example, when data size does not fit into Integer.MAX_VALUE\nnetty throws IllegalArgumentException from the CompositeByteBuf.\nTo simplify understanding of the issue we need to wrap the cause\ninto a more meaningful exception type for this context.\nMotivation:\n\nThrow BufferOverflowException with the original cause;\n\nResult:\nBetter debuggabillity experience for users of aggregated API.", "createdAt": "2020-05-29T20:53:46Z", "url": "https://github.com/apple/servicetalk/pull/1073", "merged": true, "mergeCommit": {"oid": "8061128b08b61c9f90248112161bbbfb5182f7b7"}, "closed": true, "closedAt": "2020-06-01T16:02:00Z", "author": {"login": "idelpivnitskiy"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmI1lBAH2gAyNDI1MzIxMTk0OjA3ZjA2NjRkYmQ4MzJjM2I1MDg4Y2UyOWNmMWNmMDdmZjgzYTFlZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcm5qYUgFqTQyMTYwNTQ4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "07f0664dbd832c3b5088ce29cf1cf07ff83a1ed4", "author": {"user": {"login": "idelpivnitskiy", "name": "Idel Pivnitskiy"}}, "url": "https://github.com/apple/servicetalk/commit/07f0664dbd832c3b5088ce29cf1cf07ff83a1ed4", "committedDate": "2020-05-29T20:52:58Z", "message": "Clarify exception when payload body can not be aggregated\n\nMotivation:\n\nAggregation of the payload body may fail due to some reasons.\nFor example, when data size does not fit into `Integer.MAX_VALUE`\nnetty throws `IllegalArgumentException` from the `CompositeByteBuf`.\nTo simplify understanding of the issue we need to wrap the cause\ninto a more meaningful exception type for this context.\n\nMotivation:\n- Introduce `AggregationException` that will be thrown if we can\nnot aggregate payload body;\n\nResult:\n\nBetter debuggabillity experience for users of aggregated API."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMjg3MTEy", "url": "https://github.com/apple/servicetalk/pull/1073#pullrequestreview-421287112", "createdAt": "2020-05-29T21:05:48Z", "commit": {"oid": "07f0664dbd832c3b5088ce29cf1cf07ff83a1ed4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMTowNTo0OFrOGcsDWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMTowNTo0OFrOGcsDWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjczNTA2Nw==", "bodyText": "I question the value of this change after netty/netty#10330 is available. The only benefit I see is that the name of the exception is different in the logs. As the class is private, users can not use the exception to decide further actions. Is that what your intent is?\nIf we create a publicly accessible exception class like TooLongHttpPayloadException then the change makes more sense to me.", "url": "https://github.com/apple/servicetalk/pull/1073#discussion_r432735067", "createdAt": "2020-05-29T21:05:48Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/HttpDataSourceTransformations.java", "diffHunk": "@@ -433,4 +437,12 @@ static RuntimeException newTrailersExpectedButNotSeenException() {\n             }\n         });\n     }\n+\n+    private static final class AggregationException extends IllegalStateException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07f0664dbd832c3b5088ce29cf1cf07ff83a1ed4"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85887875dd2f387e2d9675940b78f3655f4f9366", "author": {"user": {"login": "idelpivnitskiy", "name": "Idel Pivnitskiy"}}, "url": "https://github.com/apple/servicetalk/commit/85887875dd2f387e2d9675940b78f3655f4f9366", "committedDate": "2020-05-29T21:33:31Z", "message": "Throw BufferOverflowException with the original cause"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjA1NDg1", "url": "https://github.com/apple/servicetalk/pull/1073#pullrequestreview-421605485", "createdAt": "2020-06-01T05:46:05Z", "commit": {"oid": "85887875dd2f387e2d9675940b78f3655f4f9366"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3725, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}