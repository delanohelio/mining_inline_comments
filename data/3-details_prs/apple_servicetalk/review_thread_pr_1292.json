{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNjk2NDMx", "number": 1292, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo0ODowOVrOFHXojQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo1MToxOVrOFHXq0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMjcxNTY1OnYy", "diffSide": "RIGHT", "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo0ODowOVrOII07Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMzoyMjo0M1rOII18dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNjYyMw==", "bodyText": "While you are here, can you please make this method private?\nBtw, are the previous two parseCookiePair method have to be public? They currently used only by HeaderUtils, where HeaderUtils#parseCookiePair is also public. If any of these methods have to be public, can we consolidate them all in one place?", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546126623", "createdAt": "2020-12-18T22:48:09Z", "author": {"login": "idelpivnitskiy"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEzMjcwOQ==", "bodyText": "While you are here, can you please make this method private?\n\ndone.\nI can make both of the parseCookiePair methods package private, they may have been used by the netty packages at some point during development. i'll do this as a followup PR.", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546132709", "createdAt": "2020-12-18T22:59:26Z", "author": {"login": "Scottmitch"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNjYyMw=="}, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE0MzM1MQ==", "bodyText": "package private PR: #1296", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546143351", "createdAt": "2020-12-18T23:22:43Z", "author": {"login": "Scottmitch"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNjYyMw=="}, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMjcxODYwOnYy", "diffSide": "RIGHT", "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo0OToyOFrOII08rA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo1Mzo0N1rOII1DFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNzAyMA==", "bodyText": "valueStart is always > 0, bcz we do +1", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546127020", "createdAt": "2020-12-18T22:49:28Z", "author": {"login": "idelpivnitskiy"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {\n         final int valueStart = nameStart + nameLength + 1;\n-        if (valueEnd - 1 < valueStart) {\n+        if (valueEnd <= valueStart || valueStart < 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyODY2MQ==", "bodyText": "Ignore the previous comment for now. Only if we validate each input param independently, it will make sense.", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546128661", "createdAt": "2020-12-18T22:53:47Z", "author": {"login": "idelpivnitskiy"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {\n         final int valueStart = nameStart + nameLength + 1;\n-        if (valueEnd - 1 < valueStart) {\n+        if (valueEnd <= valueStart || valueStart < 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNzAyMA=="}, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMjcyMTQ3OnYy", "diffSide": "RIGHT", "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMjo1MToxOVrOII0-YA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMzoxNjowMFrOII11vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNzQ1Ng==", "bodyText": "This exception is a bit confusing and doesn't tell what was wrong with the arguments. Consider validating some passed params independently and thow if any of them are incorrect. For example, if nameStart < 0 or nameLength is not positive.", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546127456", "createdAt": "2020-12-18T22:51:19Z", "author": {"login": "idelpivnitskiy"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {\n         final int valueStart = nameStart + nameLength + 1;\n-        if (valueEnd - 1 < valueStart) {\n+        if (valueEnd <= valueStart || valueStart < 0) {\n             throw new IllegalArgumentException(\"unexpected format of cookie pair, empty value\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjE0MTYyOA==", "bodyText": "I'll adjust the exception message to include more context.", "url": "https://github.com/apple/servicetalk/pull/1292#discussion_r546141628", "createdAt": "2020-12-18T23:16:00Z", "author": {"login": "Scottmitch"}, "path": "servicetalk-http-api/src/main/java/io/servicetalk/http/api/DefaultHttpCookiePair.java", "diffHunk": "@@ -87,7 +87,7 @@ public static HttpCookiePair parseCookiePair(final CharSequence sequence, int na\n \n     static HttpCookiePair parseCookiePair0(final CharSequence sequence, int nameStart, int nameLength, int valueEnd) {\n         final int valueStart = nameStart + nameLength + 1;\n-        if (valueEnd - 1 < valueStart) {\n+        if (valueEnd <= valueStart || valueStart < 0) {\n             throw new IllegalArgumentException(\"unexpected format of cookie pair, empty value\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEyNzQ1Ng=="}, "originalCommit": {"oid": "44b4b2f5d7445055c968c5c4cd375bd2be980eb8"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2506, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}