{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NjMzMjI2", "number": 1045, "title": "Consolidate concurrent.api NULL_TOKEN usage", "bodyText": "Motivation:\nSubscriberApiUtils exposes a NULL_TOKEN to the concurrent.api package\nand usages share common code to wrap/unwrap the null token. This could\ncould be shared into methods instead of duplicated.\nModifications:\n\nMake SubscriberApiUtils#NULL_TOKEN private\nAdd SubscriberApiUtils wrapNull and unwrapNull methods\n\nResult:\nMore shared code in concurrent.api for wrapping/unwrapping NULL_TOKEN.", "createdAt": "2020-05-09T21:31:32Z", "url": "https://github.com/apple/servicetalk/pull/1045", "merged": true, "mergeCommit": {"oid": "2d111d9fc7c6b0bca727d0026848f6ddcf5c850c"}, "closed": true, "closedAt": "2020-05-12T18:13:41Z", "author": {"login": "Scottmitch"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcftYGPgH2gAyNDE1NjMzMjI2OjFmNGNkNWU4Y2U4YWQ3Zjk1ODk1YjRmNTEwODZjMDBlNzZhNmNiODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgZmwWgH2gAyNDE1NjMzMjI2OmE2N2Y2OGEyMWQzOGRlODMwZWE0YWQxNTNmNjQzY2MzNDY4M2VhNjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85", "committedDate": "2020-05-09T21:29:47Z", "message": "Consolidate concurrent.api NULL_TOKEN usage\n\nMotivation:\nSubscriberApiUtils exposes a NULL_TOKEN to the concurrent.api package\nand usages share common code to wrap/unwrap the null token. This could\ncould be shared into methods instead of duplicated.\n\nModifications:\n- Make SubscriberApiUtils#NULL_TOKEN private\n- Add SubscriberApiUtils wrapNull and unwrapNull methods\n\nResult:\nMore shared code in concurrent.api for wrapping/unwrapping NULL_TOKEN."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzI0MjQ5", "url": "https://github.com/apple/servicetalk/pull/1045#pullrequestreview-409324249", "createdAt": "2020-05-11T16:16:36Z", "commit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NjIwOTI4", "url": "https://github.com/apple/servicetalk/pull/1045#pullrequestreview-409620928", "createdAt": "2020-05-12T00:30:12Z", "commit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMDozMDoxMlrOGTx_5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMDozMDoxMlrOGTx_5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM5NTMwMA==", "bodyText": "nit: rename to unwrapNullUnchecked to indicate that no attempt to verify the type is done.", "url": "https://github.com/apple/servicetalk/pull/1045#discussion_r423395300", "createdAt": "2020-05-12T00:30:12Z", "author": {"login": "NiteshKant"}, "path": "servicetalk-concurrent-api/src/main/java/io/servicetalk/concurrent/api/SubscriberApiUtils.java", "diffHunk": "@@ -15,13 +15,25 @@\n  */\n package io.servicetalk.concurrent.api;\n \n+import javax.annotation.Nullable;\n+\n final class SubscriberApiUtils {\n-    static final Object NULL_TOKEN = new Object();\n+    private static final Object NULL_TOKEN = new Object();\n     static final int SUBSCRIBER_STATE_IDLE = 0;\n     static final int SUBSCRIBER_STATE_ON_NEXT = 1;\n     static final int SUBSCRIBER_STATE_TERMINATED = 2;\n \n     private SubscriberApiUtils() {\n         // no instances\n     }\n+\n+    static Object wrapNull(@Nullable Object o) {\n+        return o == null ? NULL_TOKEN : o;\n+    }\n+\n+    @SuppressWarnings(\"unchecked\")\n+    @Nullable\n+    static <T> T unwrapNull(Object o) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NjE4NjIx", "url": "https://github.com/apple/servicetalk/pull/1045#pullrequestreview-409618621", "createdAt": "2020-05-12T00:23:23Z", "commit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMDoyMzoyM1rOGTx3ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMDoyMzoyM1rOGTx3ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM5MzIxOQ==", "bodyText": "Unused import.", "url": "https://github.com/apple/servicetalk/pull/1045#discussion_r423393219", "createdAt": "2020-05-12T00:23:23Z", "author": {"login": "idelpivnitskiy"}, "path": "servicetalk-concurrent-api/src/main/java/io/servicetalk/concurrent/api/PubFirstOrError.java", "diffHunk": "@@ -20,6 +20,8 @@\n import java.util.NoSuchElementException;\n import javax.annotation.Nullable;\n \n+import static io.servicetalk.concurrent.api.SubscriberApiUtils.wrapNull;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f4cd5e8ce8ad7f95895b4f51086c00e76a6cb85"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a67f68a21d38de830ea4ad153f643cc34683ea68", "author": {"user": {"login": "Scottmitch", "name": "Scott Mitchell"}}, "url": "https://github.com/apple/servicetalk/commit/a67f68a21d38de830ea4ad153f643cc34683ea68", "committedDate": "2020-05-12T01:01:37Z", "message": "unwrapNullUnchecked"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3675, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}