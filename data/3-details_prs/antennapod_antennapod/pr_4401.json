{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NTc3ODM0", "number": 4401, "title": "Use swipe to refresh", "bodyText": "This adds a swipe to refresh ability to the subscriptions screen.\nThis is just a sample, how this would work.\nThe swipe to refresh ability could be added to all ListViews and GridViews, which should be the next step, if this implementation looks fine.\nCloses #1797", "createdAt": "2020-09-03T11:56:21Z", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401", "merged": true, "mergeCommit": {"oid": "0de1cbad2f75e1ea2e7c1e18ae836a4f96d0943f"}, "closed": true, "closedAt": "2020-10-04T13:47:12Z", "author": {"login": "asdoi"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFPPnEgH2gAyNDc4NTc3ODM0OmFhYmFkYTQ5NTdjM2JlMGRmZGYyMTYzMDQyZDEyY2I5Y2RhMzI0M2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdO57XAAH2gAyNDc4NTc3ODM0OjNlMTgwYTA4OGZjNTU5NmI4YWU2NDE2YTExYmU2NWJiMzcxMTBmNmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "aabada4957c3be0dfdf2163042d12cb9cda3243f", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/aabada4957c3be0dfdf2163042d12cb9cda3243f", "committedDate": "2020-09-03T11:52:29Z", "message": "add swipe to refresh to subscriptions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjg4Njgw", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#pullrequestreview-500688680", "createdAt": "2020-10-01T20:20:16Z", "commit": {"oid": "aabada4957c3be0dfdf2163042d12cb9cda3243f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoyMDoxNlrOHbZiWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoyMDoxNlrOHbZiWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5MTk5Mg==", "bodyText": "I think this would be easier with new Handler().postDelayed(() -> ..., 800)", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498491992", "createdAt": "2020-10-01T20:20:16Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/SubscriptionFragment.java", "diffHunk": "@@ -102,6 +104,20 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container,\n \n         feedsFilteredMsg = root.findViewById(R.id.feeds_filtered_message);\n         feedsFilteredMsg.setOnClickListener((l) -> FeedFilterDialog.showDialog(requireContext()));\n+\n+        SwipeRefreshLayout swipeRefreshLayout = root.findViewById(R.id.swiperefresh);\n+        swipeRefreshLayout.setOnRefreshListener(() -> {\n+            AutoUpdateManager.runImmediate(requireContext());\n+            new Thread(() -> {\n+                try {\n+                    Thread.sleep(800);\n+                } catch (Exception ignore) {\n+                }\n+                getActivity().runOnUiThread(() -> {\n+                    swipeRefreshLayout.setRefreshing(false);\n+                });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aabada4957c3be0dfdf2163042d12cb9cda3243f"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53fcdfabc183f5c3d7c8b01b2bdb8e0ddfb2eb90", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/53fcdfabc183f5c3d7c8b01b2bdb8e0ddfb2eb90", "committedDate": "2020-10-02T15:00:14Z", "message": "use postDelayed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70b92a08cfe32a5d1250535ade2e7cc09811bae4", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/70b92a08cfe32a5d1250535ade2e7cc09811bae4", "committedDate": "2020-10-02T15:13:15Z", "message": "add swipeToRefresh to EpisodesListFragment and FeedItemlistFragment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMjI5ODY5", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#pullrequestreview-501229869", "createdAt": "2020-10-02T15:21:39Z", "commit": {"oid": "70b92a08cfe32a5d1250535ade2e7cc09811bae4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNToyMTozOVrOHbxxnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNToyMzo1NVrOHbx2yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg4OTExOQ==", "bodyText": "I think you don't need getActivity().runOnUiThread. Handlers that are created on the UI thread run their runnable on the UI thread, too.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498889119", "createdAt": "2020-10-02T15:21:39Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/EpisodesListFragment.java", "diffHunk": "@@ -214,6 +217,14 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,\n             ((SimpleItemAnimator) animator).setSupportsChangeAnimations(false);\n         }\n \n+        SwipeRefreshLayout swipeRefreshLayout = root.findViewById(R.id.swipeRefresh);\n+        swipeRefreshLayout.setOnRefreshListener(() -> {\n+            AutoUpdateManager.runImmediate(requireContext());\n+            new Handler().postDelayed(() ->\n+                            getActivity().runOnUiThread(() -> swipeRefreshLayout.setRefreshing(false))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70b92a08cfe32a5d1250535ade2e7cc09811bae4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg5MDQ0MQ==", "bodyText": "I have not tried it yet but I think this padding should be applied to the recyclerView, not the swipe layout. Otherwise, the scroll bar on big tablets will not be on the edge of the screen.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498890441", "createdAt": "2020-10-02T15:23:55Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/res/layout/feed_item_list_fragment.xml", "diffHunk": "@@ -48,12 +48,19 @@\n         </com.google.android.material.appbar.CollapsingToolbarLayout>\n     </com.google.android.material.appbar.AppBarLayout>\n \n-    <de.danoeh.antennapod.view.EpisodeItemListRecyclerView\n-            android:id=\"@+id/recyclerView\"\n-            android:layout_width=\"match_parent\"\n-            android:layout_height=\"match_parent\"\n-            android:paddingHorizontal=\"@dimen/additional_horizontal_spacing\"\n-            app:layout_behavior=\"@string/appbar_scrolling_view_behavior\" />\n+    <androidx.swiperefreshlayout.widget.SwipeRefreshLayout\n+        android:id=\"@+id/swipeRefresh\"\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"match_parent\"\n+        android:paddingHorizontal=\"@dimen/additional_horizontal_spacing\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70b92a08cfe32a5d1250535ade2e7cc09811bae4"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a8007b388491f931d73a55bea289148536478ad", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/6a8007b388491f931d73a55bea289148536478ad", "committedDate": "2020-10-02T15:41:08Z", "message": "update handler.postDelayed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMjc0MjI5", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#pullrequestreview-501274229", "createdAt": "2020-10-02T16:20:39Z", "commit": {"oid": "6a8007b388491f931d73a55bea289148536478ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjoyMDozOVrOHbzvLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjoyMDozOVrOHbzvLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkyMTI2MA==", "bodyText": "1 second feels a bit too much to me. This is sometimes more than what it takes to actually refresh. What about 500ms?", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498921260", "createdAt": "2020-10-02T16:20:39Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/EpisodesListFragment.java", "diffHunk": "@@ -214,6 +217,12 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,\n             ((SimpleItemAnimator) animator).setSupportsChangeAnimations(false);\n         }\n \n+        SwipeRefreshLayout swipeRefreshLayout = root.findViewById(R.id.swipeRefresh);\n+        swipeRefreshLayout.setOnRefreshListener(() -> {\n+            AutoUpdateManager.runImmediate(requireContext());\n+            new Handler().postDelayed(() -> swipeRefreshLayout.setRefreshing(false), 1000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a8007b388491f931d73a55bea289148536478ad"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69d1b4933f5ccc2e19ead25bd3abb088d1d7a995", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/69d1b4933f5ccc2e19ead25bd3abb088d1d7a995", "committedDate": "2020-10-02T18:11:27Z", "message": "fix padding"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMzQ5Mzgy", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#pullrequestreview-501349382", "createdAt": "2020-10-02T18:14:42Z", "commit": {"oid": "69d1b4933f5ccc2e19ead25bd3abb088d1d7a995"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxODoxNDo0MlrOHb3Fqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxODoxNzozOFrOHb3QcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk3NjE3MA==", "bodyText": "Is there any class where constants like this one are saved, I did not find an appropriate one.\nFurthermore I changed the duration to 750ms which is the time for one repetition.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498976170", "createdAt": "2020-10-02T18:14:42Z", "author": {"login": "asdoi"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/SubscriptionFragment.java", "diffHunk": "@@ -66,6 +69,8 @@\n     private static final String PREFS = \"SubscriptionFragment\";\n     private static final String PREF_NUM_COLUMNS = \"columns\";\n \n+    public static final int SWIPE_TO_REFRESH_DURATION = 750;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69d1b4933f5ccc2e19ead25bd3abb088d1d7a995"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk3ODkyOA==", "bodyText": "I am now unsure about that paddingBottom as it is needed for clipToPadding.\nAlso, please have a look about all other paddings to make sure that I did not make any mistakes \ud83d\ude09", "url": "https://github.com/AntennaPod/AntennaPod/pull/4401#discussion_r498978928", "createdAt": "2020-10-02T18:17:38Z", "author": {"login": "asdoi"}, "path": "app/src/main/res/layout/fragment_subscriptions.xml", "diffHunk": "@@ -28,17 +28,24 @@\n             android:textColor=\"?android:attr/textColorSecondary\"\n             android:textSize=\"@dimen/text_size_small\" />\n \n-    <GridView\n-            android:layout_below=\"@id/feeds_filtered_message\"\n-            android:id=\"@+id/subscriptions_grid\"\n-            android:layout_width=\"match_parent\"\n-            android:numColumns=\"3\"\n-            android:horizontalSpacing=\"2dp\"\n-            android:verticalSpacing=\"2dp\"\n-            android:layout_height=\"match_parent\"\n-            android:layout_gravity=\"center_horizontal\"\n-            android:paddingBottom=\"88dp\"\n-            android:clipToPadding=\"false\"/>\n+    <androidx.swiperefreshlayout.widget.SwipeRefreshLayout\n+        android:id=\"@+id/swipeRefresh\"\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"match_parent\"\n+        android:layout_below=\"@id/feeds_filtered_message\">\n+\n+        <GridView\n+                android:id=\"@+id/subscriptions_grid\"\n+                android:layout_width=\"match_parent\"\n+                android:numColumns=\"3\"\n+                android:horizontalSpacing=\"2dp\"\n+                android:verticalSpacing=\"2dp\"\n+                android:layout_height=\"match_parent\"\n+                android:layout_gravity=\"center_horizontal\"\n+                android:paddingBottom=\"88dp\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69d1b4933f5ccc2e19ead25bd3abb088d1d7a995"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81f33c24a62418f461ceac830500f01a5bcb528e", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/81f33c24a62418f461ceac830500f01a5bcb528e", "committedDate": "2020-10-02T21:14:05Z", "message": "move duration const to integers.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e180a088fc5596b8ae6416a11be65bb37110f6b", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/3e180a088fc5596b8ae6416a11be65bb37110f6b", "committedDate": "2020-10-03T12:41:36Z", "message": "update padding"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2680, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}