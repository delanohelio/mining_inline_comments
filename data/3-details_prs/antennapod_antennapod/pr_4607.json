{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNDMwNjMx", "number": 4607, "title": "Local feeds: honor file creation date", "bodyText": "Considers date in metadata or else date in file. Test added.\nFixes #4598", "createdAt": "2020-10-27T02:58:31Z", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607", "merged": true, "mergeCommit": {"oid": "370df3a26c9990a1b484b4e30145fa9a38f2b403"}, "closed": true, "closedAt": "2020-10-28T15:07:18Z", "author": {"login": "moralesg"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWf29BgH2gAyNTEwNDMwNjMxOjcyN2E1ZjYxYzk4NWFkNTAyNmU5NGE3MzA4MzQxYmNkYzYzN2QwNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWxIPTgH2gAyNTEwNDMwNjMxOjg5NWU0ZTc4MTdiMzNjODFjOWI4OWM5YWZkZTU2NTIwMTVhY2EyZDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "727a5f61c985ad5026e94a7308341bcdc637d072", "author": {"user": null}, "url": "https://github.com/AntennaPod/AntennaPod/commit/727a5f61c985ad5026e94a7308341bcdc637d072", "committedDate": "2020-10-27T02:50:39Z", "message": "Fix #4598"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab255afe68485976467e84806734fc83097e053a", "author": {"user": {"login": "moralesg", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/ab255afe68485976467e84806734fc83097e053a", "committedDate": "2020-10-27T03:21:24Z", "message": "Fix #4598, checkstyle fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDk5MDMw", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#pullrequestreview-517499030", "createdAt": "2020-10-27T09:29:08Z", "commit": {"oid": "ab255afe68485976467e84806734fc83097e053a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOToyOTowOVrOHoyqHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOToyOToyNVrOHoyq7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTA2OQ==", "bodyText": "The METADATA_KEY_DATE format is not specified, so I think it is good to try falling back to DateUtils.parse here. Only if that one returns null either, I would use the file last modified date.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512535069", "createdAt": "2020-10-27T09:29:09Z", "author": {"login": "ByteHamster"}, "path": "core/src/main/java/de/danoeh/antennapod/core/feed/LocalFeedUpdater.java", "diffHunk": "@@ -130,12 +134,28 @@ private static FeedItem feedContainsFile(Feed feed, String filename) {\n \n     private static FeedItem createFeedItem(Feed feed, DocumentFile file, Context context) {\n         String uuid = UUID.randomUUID().toString();\n-        FeedItem item = new FeedItem(0, file.getName(), uuid, file.getName(), new Date(),\n-                FeedItem.UNPLAYED, feed);\n-        item.setAutoDownload(false);\n \n         MediaMetadataRetriever mediaMetadataRetriever = new MediaMetadataRetriever();\n         mediaMetadataRetriever.setDataSource(context, file.getUri());\n+        String dateStr = mediaMetadataRetriever.extractMetadata(MediaMetadataRetriever.METADATA_KEY_DATE);\n+\n+        Date date = null;\n+        if (!TextUtils.isEmpty(dateStr)) {\n+            try {\n+                SimpleDateFormat simpleDateFormat = new SimpleDateFormat(\"yyyyMMdd'T'HHmmss\", Locale.getDefault());\n+                date = simpleDateFormat.parse(dateStr);\n+            } catch (ParseException parseException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab255afe68485976467e84806734fc83097e053a"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTI3Ng==", "bodyText": "The comment needs to be updated", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512535276", "createdAt": "2020-10-27T09:29:25Z", "author": {"login": "ByteHamster"}, "path": "core/src/test/java/de/danoeh/antennapod/core/feed/LocalFeedUpdaterTest.java", "diffHunk": "@@ -149,6 +153,28 @@ public void testUpdateFeed_FeedIconDefault() {\n         assertTrue(feedAfter.getImageUrl().contains(resourceEntryName));\n     }\n \n+    /**\n+     * Test default feed icon if there is no matching file in the local feed media folder.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab255afe68485976467e84806734fc83097e053a"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "731224074534bc92f646495de9f1362d3b4c1715", "author": {"user": null}, "url": "https://github.com/AntennaPod/AntennaPod/commit/731224074534bc92f646495de9f1362d3b4c1715", "committedDate": "2020-10-27T12:03:27Z", "message": "Fix #4598, defaults to DateUtils in case of exception, checkstyle fixed, test comment fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "895e4e7817b33c81c9b89c9afde5652015aca2d4", "author": {"user": null}, "url": "https://github.com/AntennaPod/AntennaPod/commit/895e4e7817b33c81c9b89c9afde5652015aca2d4", "committedDate": "2020-10-27T22:57:55Z", "message": "Fix #4598, removed unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2612, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}