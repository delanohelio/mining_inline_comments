{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwODEzMzI1", "number": 4020, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyMTowMFrODv95ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMjowOTozOVrODxGQ2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjIzODAzOnYy", "diffSide": "RIGHT", "path": "app/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyMTowMFrOGCsohA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyMTowMFrOGCsohA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4MTYwNA==", "bodyText": "Had to upgrade material version to use TabLayoutMediator which is added in 1.1.0.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r405481604", "createdAt": "2020-04-08T12:21:00Z", "author": {"login": "ebraminio"}, "path": "app/build.gradle", "diffHunk": "@@ -143,8 +143,9 @@ dependencies {\n     implementation \"androidx.recyclerview:recyclerview:1.0.0\"\n     implementation \"androidx.coordinatorlayout:coordinatorlayout:1.1.0\"\n     implementation \"androidx.media:media:1.1.0\"\n+    implementation \"androidx.viewpager2:viewpager2:1.0.0\"\n     implementation \"android.arch.work:work-runtime:$workManagerVersion\"\n-    implementation \"com.google.android.material:material:1.0.0\"\n+    implementation \"com.google.android.material:material:1.1.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daf062bbd1d1ec349e10ace47e44e3dab4684dce"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjI1MTI3OnYy", "diffSide": "LEFT", "path": "app/src/main/java/de/danoeh/antennapod/view/PagerIndicatorView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNDozN1rOGCswmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNDozN1rOGCswmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4MzY3NQ==", "bodyText": "It didn't build with the change and androidx one is apparently declared for internal use of the package.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r405483675", "createdAt": "2020-04-08T12:24:37Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/view/PagerIndicatorView.java", "diffHunk": "@@ -1,15 +1,17 @@\n package de.danoeh.antennapod.view;\n \n+import android.animation.ArgbEvaluator;\n import android.content.Context;\n import android.content.res.TypedArray;\n-import android.database.DataSetObserver;\n import android.graphics.Canvas;\n import android.graphics.Paint;\n import android.util.AttributeSet;\n import android.view.View;\n+\n import androidx.annotation.Nullable;\n-import androidx.vectordrawable.graphics.drawable.ArgbEvaluator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daf062bbd1d1ec349e10ace47e44e3dab4684dce"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjI1Nzk1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/view/PagerIndicatorView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNjozMVrOGCs0wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNjozMVrOGCs0wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NDczNg==", "bodyText": "Flips the pager dots for RTL languages, it can't be done once for the view as direction isn't specified at that time and should be done when the view is attached.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r405484736", "createdAt": "2020-04-08T12:26:31Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/view/PagerIndicatorView.java", "diffHunk": "@@ -38,26 +40,29 @@ private void setup() {\n         paint.setAntiAlias(true);\n         paint.setStyle(Paint.Style.FILL);\n \n-        int[] colorAttrs = new int[] { android.R.attr.textColorSecondary };\n+        int[] colorAttrs = new int[]{android.R.attr.textColorSecondary};\n         TypedArray a = getContext().obtainStyledAttributes(colorAttrs);\n         circleColorHighlight = a.getColor(0, 0xffffffff);\n         circleColor = (Integer) new ArgbEvaluator().evaluate(0.8f, 0x00ffffff, circleColorHighlight);\n         a.recycle();\n     }\n \n-    public void setViewPager(ViewPager pager) {\n-        numPages = pager.getAdapter().getCount();\n-        pager.getAdapter().registerDataSetObserver(new DataSetObserver() {\n+    public void setViewPager(ViewPager2 pager) {\n+        numPages = pager.getAdapter().getItemCount();\n+        pager.getAdapter().registerAdapterDataObserver(new RecyclerView.AdapterDataObserver() {\n             @Override\n             public void onChanged() {\n-                numPages = pager.getAdapter().getCount();\n+                numPages = pager.getAdapter().getItemCount();\n                 invalidate();\n             }\n         });\n-        pager.addOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {\n+        pager.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n             @Override\n             public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {\n                 PagerIndicatorView.this.position = position + positionOffset;\n+                if (ViewCompat.getLayoutDirection(pager) == ViewCompat.LAYOUT_DIRECTION_RTL) {\n+                    PagerIndicatorView.this.position = numPages - 1 - PagerIndicatorView.this.position;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daf062bbd1d1ec349e10ace47e44e3dab4684dce"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjI2MjQxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/de/danoeh/antennapod/core/storage/PodDBAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNzo0NVrOGCs3gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNzo0NVrOGCs3gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NTQ0MQ==", "bodyText": "It was causing\n\n(note \u06f5\u06f0 at the end of the query)\nA bug that was there before my changes but had to fix so can see the view.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r405485441", "createdAt": "2020-04-08T12:27:45Z", "author": {"login": "ebraminio"}, "path": "core/src/main/java/de/danoeh/antennapod/core/storage/PodDBAdapter.java", "diffHunk": "@@ -1031,7 +1032,7 @@ public final Cursor getCompletedMediaCursor(int limit) {\n \n         return db.query(TABLE_NAME_FEED_MEDIA, null,\n                 KEY_PLAYBACK_COMPLETION_DATE + \" > 0\", null, null,\n-                null, String.format(\"%s DESC LIMIT %d\", KEY_PLAYBACK_COMPLETION_DATE, limit));\n+                null, String.format(Locale.US, \"%s DESC LIMIT %d\", KEY_PLAYBACK_COMPLETION_DATE, limit));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daf062bbd1d1ec349e10ace47e44e3dab4684dce"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMjI0NjE4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxOTozOToxMlrOGDmulw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMTo1Mzo0MFrOGD4gbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQzMzQzMQ==", "bodyText": "Is this no longer supported? Without this, using ViewPager1, the views are recycled and getChildAt in ViewPagerBottomSheetBehavior returns the wrong page when looking for the currently active page.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406433431", "createdAt": "2020-04-09T19:39:12Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "diffHunk": "@@ -127,11 +130,10 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         sbPosition.setOnSeekBarChangeListener(this);\n \n         pager = root.findViewById(R.id.pager);\n-        AudioPlayerPagerAdapter pagerAdapter = new AudioPlayerPagerAdapter(getChildFragmentManager());\n-        pager.setAdapter(pagerAdapter);\n+        pager.setAdapter(new AudioPlayerPagerAdapter(this));\n         // Required for getChildAt(int) in ViewPagerBottomSheetBehavior to return the correct page\n-        pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);\n-        pager.addOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {\n+        // pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3MTUxNQ==", "bodyText": "Done. b30fae7\nRevealed a faulty check with the method documentation, https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2#setOffscreenPageLimit(int) it should  Valid values are all values >= 1 *or* OFFSCREEN_PAGE_LIMIT_DEFAULT instead and as the actual code also wants.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406471515", "createdAt": "2020-04-09T20:54:33Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "diffHunk": "@@ -127,11 +130,10 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         sbPosition.setOnSeekBarChangeListener(this);\n \n         pager = root.findViewById(R.id.pager);\n-        AudioPlayerPagerAdapter pagerAdapter = new AudioPlayerPagerAdapter(getChildFragmentManager());\n-        pager.setAdapter(pagerAdapter);\n+        pager.setAdapter(new AudioPlayerPagerAdapter(this));\n         // Required for getChildAt(int) in ViewPagerBottomSheetBehavior to return the correct page\n-        pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);\n-        pager.addOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {\n+        // pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQzMzQzMQ=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjcyNDcxOA==", "bodyText": "Ok, already filed as https://issuetracker.google.com/issues/144669596 will apply their work around also", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406724718", "createdAt": "2020-04-10T11:53:40Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "diffHunk": "@@ -127,11 +130,10 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         sbPosition.setOnSeekBarChangeListener(this);\n \n         pager = root.findViewById(R.id.pager);\n-        AudioPlayerPagerAdapter pagerAdapter = new AudioPlayerPagerAdapter(getChildFragmentManager());\n-        pager.setAdapter(pagerAdapter);\n+        pager.setAdapter(new AudioPlayerPagerAdapter(this));\n         // Required for getChildAt(int) in ViewPagerBottomSheetBehavior to return the correct page\n-        pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);\n-        pager.addOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {\n+        // pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQzMzQzMQ=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMjI5NjQwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxOTo1NDo1MVrOGDnOng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODozODozMFrOGD0xKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA==", "bodyText": "Hmm. I want to keep the amount of code that we need to take care of as small as possible. At some point, we have to upgrade the dependencies. We already use 64,945 out of 65,536 methods, so we can not go much longer without multidex, anyway.\nI will play around with ProGuard to see if we can get a bit more room for new methods without enabling MultiDex. I mean, even big apps like WhatsApp work without MultiDex. Something seems to waste methods...", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406441630", "createdAt": "2020-04-09T19:54:51Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3MjA2MQ==", "bodyText": "Hmm. I want to keep the amount of code that we need to take care of as small as possible. At some point, we have to upgrade the dependencies. We already use 64,945 out of 65,536 methods, so we can not go much longer without multidex, anyway.\n\nSo what do you suggest? It isn't a fork (except a new line that had added because of local lints), can (and should) be deleted after the upgrade.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406472061", "createdAt": "2020-04-09T20:55:42Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3MjY4Mw==", "bodyText": "I will play around with ProGuard to see if we can get a bit more room for new methods without enabling MultiDex. I mean, even big apps like WhatsApp work without MultiDex. Something seems to waste methods...\n\nThey may rely more on native codes I believe. I will also check what has consumed the methods number.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406472683", "createdAt": "2020-04-09T20:56:55Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ4MjU4MA==", "bodyText": "I brought it down to around 44k by removing -keep class androidx.** { *; } from the proguard config. Currently fine-tuning the proguard settings so that the tests pass.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406482580", "createdAt": "2020-04-09T21:17:09Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYzMjU0MA==", "bodyText": "Let me know when you landed it. Thanks!", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406632540", "createdAt": "2020-04-10T07:06:14Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY2MzQ2NQ==", "bodyText": "Done :) #4035 is merged, so we have a bit more room for library updates now", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406663465", "createdAt": "2020-04-10T08:38:30Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/com/google/android/material/tabs/TabLayoutMediator.java", "diffHunk": "@@ -0,0 +1,309 @@\n+/*\n+ * Copyright 2018 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.material.tabs;\n+\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\n+import static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.recyclerview.widget.RecyclerView;\n+import androidx.viewpager2.widget.ViewPager2;\n+import java.lang.ref.WeakReference;\n+\n+/**\n+ * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n+ * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n+ * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n+ * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n+ * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n+ * AdapterDataObserver to recreate tab content when dataset changes.\n+ *\n+ * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n+ * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n+ * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n+ * creating an instance of this class, you must supply an implementation of {@link\n+ * TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n+ * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n+ * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n+ * TabLayoutMediator.\n+ */\n+public final class TabLayoutMediator {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTYzMA=="}, "originalCommit": {"oid": "98277da26b79c8ab7cb8f348ecf4424d72c7e7cd"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzk0MjAyOnYy", "diffSide": "LEFT", "path": "app/src/main/java/de/danoeh/antennapod/fragment/gpodnet/GpodnetMainFragment.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwOTo0Njo0N1rOGD2PEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwOTo1MzoxMFrOGPGNMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY4NzUwNQ==", "bodyText": "Not in scope of this change but weird that NUM_PAGES is 2 but we have three pages here. Guess better to fix it after the PR.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406687505", "createdAt": "2020-04-10T09:46:47Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/gpodnet/GpodnetMainFragment.java", "diffHunk": "@@ -26,63 +35,59 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         toolbar.setTitle(R.string.gpodnet_main_label);\n         ((AppCompatActivity) getActivity()).setSupportActionBar(toolbar);\n \n-        ViewPager viewPager = root.findViewById(R.id.viewpager);\n-        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(getChildFragmentManager());\n+        ViewPager2 viewPager = root.findViewById(R.id.viewpager);\n+        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(this);\n         viewPager.setAdapter(pagerAdapter);\n \n         // Give the TabLayout the ViewPager\n         TabLayout tabLayout = root.findViewById(R.id.sliding_tabs);\n-        tabLayout.setupWithViewPager(viewPager);\n+\n+        new TabLayoutMediator(tabLayout, viewPager, (tab, position) -> {\n+            switch (position) {\n+                case POS_TAGS:\n+                    tab.setText(R.string.gpodnet_taglist_header);\n+                    break;\n+                case POS_TOPLIST:\n+                    tab.setText(R.string.gpodnet_toplist_header);\n+                    break;\n+                default:\n+                case POS_SUGGESTIONS:\n+                    tab.setText(R.string.gpodnet_suggestions_header);\n+                    break;\n+            }\n+        }).attach();\n \n         return root;\n     }\n \n-    public class GpodnetPagerAdapter extends FragmentPagerAdapter {\n-        private static final int NUM_PAGES = 2;\n-        private static final int POS_TOPLIST = 0;\n-        private static final int POS_TAGS = 1;\n-        private static final int POS_SUGGESTIONS = 2;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b1737e2958ec0f2b748274f7f6ca9b5da05ead7"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEyMDY1MA==", "bodyText": "@ByteHamster while this may take time if possile please have a look if NUM_PAGES = 2 is really desired and nothing has got hide by mistake if possible thanks.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r407120650", "createdAt": "2020-04-11T23:03:11Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/gpodnet/GpodnetMainFragment.java", "diffHunk": "@@ -26,63 +35,59 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         toolbar.setTitle(R.string.gpodnet_main_label);\n         ((AppCompatActivity) getActivity()).setSupportActionBar(toolbar);\n \n-        ViewPager viewPager = root.findViewById(R.id.viewpager);\n-        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(getChildFragmentManager());\n+        ViewPager2 viewPager = root.findViewById(R.id.viewpager);\n+        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(this);\n         viewPager.setAdapter(pagerAdapter);\n \n         // Give the TabLayout the ViewPager\n         TabLayout tabLayout = root.findViewById(R.id.sliding_tabs);\n-        tabLayout.setupWithViewPager(viewPager);\n+\n+        new TabLayoutMediator(tabLayout, viewPager, (tab, position) -> {\n+            switch (position) {\n+                case POS_TAGS:\n+                    tab.setText(R.string.gpodnet_taglist_header);\n+                    break;\n+                case POS_TOPLIST:\n+                    tab.setText(R.string.gpodnet_toplist_header);\n+                    break;\n+                default:\n+                case POS_SUGGESTIONS:\n+                    tab.setText(R.string.gpodnet_suggestions_header);\n+                    break;\n+            }\n+        }).attach();\n \n         return root;\n     }\n \n-    public class GpodnetPagerAdapter extends FragmentPagerAdapter {\n-        private static final int NUM_PAGES = 2;\n-        private static final int POS_TOPLIST = 0;\n-        private static final int POS_TAGS = 1;\n-        private static final int POS_SUGGESTIONS = 2;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY4NzUwNQ=="}, "originalCommit": {"oid": "3b1737e2958ec0f2b748274f7f6ca9b5da05ead7"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4MzUwNg==", "bodyText": "I created issue #4093 for this.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r418483506", "createdAt": "2020-05-01T09:53:10Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/gpodnet/GpodnetMainFragment.java", "diffHunk": "@@ -26,63 +35,59 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         toolbar.setTitle(R.string.gpodnet_main_label);\n         ((AppCompatActivity) getActivity()).setSupportActionBar(toolbar);\n \n-        ViewPager viewPager = root.findViewById(R.id.viewpager);\n-        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(getChildFragmentManager());\n+        ViewPager2 viewPager = root.findViewById(R.id.viewpager);\n+        GpodnetPagerAdapter pagerAdapter = new GpodnetPagerAdapter(this);\n         viewPager.setAdapter(pagerAdapter);\n \n         // Give the TabLayout the ViewPager\n         TabLayout tabLayout = root.findViewById(R.id.sliding_tabs);\n-        tabLayout.setupWithViewPager(viewPager);\n+\n+        new TabLayoutMediator(tabLayout, viewPager, (tab, position) -> {\n+            switch (position) {\n+                case POS_TAGS:\n+                    tab.setText(R.string.gpodnet_taglist_header);\n+                    break;\n+                case POS_TOPLIST:\n+                    tab.setText(R.string.gpodnet_toplist_header);\n+                    break;\n+                default:\n+                case POS_SUGGESTIONS:\n+                    tab.setText(R.string.gpodnet_suggestions_header);\n+                    break;\n+            }\n+        }).attach();\n \n         return root;\n     }\n \n-    public class GpodnetPagerAdapter extends FragmentPagerAdapter {\n-        private static final int NUM_PAGES = 2;\n-        private static final int POS_TOPLIST = 0;\n-        private static final int POS_TAGS = 1;\n-        private static final int POS_SUGGESTIONS = 2;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY4NzUwNQ=="}, "originalCommit": {"oid": "3b1737e2958ec0f2b748274f7f6ca9b5da05ead7"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNDIzMDM2OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMjoxMDo0OVrOGD42AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMjoxMDo0OVrOGD42AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjczMDI0MQ==", "bodyText": "Applied another solution based on https://issuetracker.google.com/issues/144669596", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406730241", "createdAt": "2020-04-10T12:10:49Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/AudioPlayerFragment.java", "diffHunk": "@@ -132,7 +132,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n         pager = root.findViewById(R.id.pager);\n         pager.setAdapter(new AudioPlayerPagerAdapter(this));\n         // Required for getChildAt(int) in ViewPagerBottomSheetBehavior to return the correct page\n-        // pager.setOffscreenPageLimit(NUM_CONTENT_FRAGMENTS);\n+        pager.setOffscreenPageLimit((int) NUM_CONTENT_FRAGMENTS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24fc4c2410b04ac08cf59a0810bd19bbf84dd506"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNDY2MjIwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/google/android/material/bottomsheet/ViewPagerBottomSheetBehavior.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNDo1ODo1NFrOGD82aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxOTo0MzoxMlrOGED-oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NTg4Mw==", "bodyText": "With your changes, it is no longer possible to scroll up in the chapters list and the shownotes list (because every time when scrolling up, the slide-up sheet is closed). Something like the following helps. Maybe you could even use recycler.findViewHolderForAdapterPosition, so that we no longer need to rely on setOffscreenPageLimit. I am not really happy about getChildAt(0), so maybe you have another idea about that, too (IDs?).\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        ViewPager2 viewPager = (ViewPager2) view;\n          \n          \n            \n                        View currentViewPagerChild = viewPager.getChildAt(viewPager.getCurrentItem());\n          \n          \n            \n                        ViewPager2 viewPager = (ViewPager2) view;\n          \n          \n            \n                        RecyclerView recycler = (RecyclerView) viewPager.getChildAt(0);\n          \n          \n            \n                        View currentViewPagerChild = recycler.getChildAt(viewPager.getCurrentItem());", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406795883", "createdAt": "2020-04-10T14:58:54Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/com/google/android/material/bottomsheet/ViewPagerBottomSheetBehavior.java", "diffHunk": "@@ -31,8 +32,8 @@ View findScrollingChild(View view) {\n             return view;\n         }\n \n-        if (view instanceof ViewPager) {\n-            ViewPager viewPager = (ViewPager) view;\n+        if (view instanceof ViewPager2) {\n+            ViewPager2 viewPager = (ViewPager2) view;\n             View currentViewPagerChild = viewPager.getChildAt(viewPager.getCurrentItem());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg0MTY2MA==", "bodyText": "With your changes, it is no longer possible to scroll up in the chapters list and the shownotes list (because every time when scrolling up, the slide-up sheet is closed).\n\nI did understand the reasoning behind the code existence and have tested it locally, however I don't see a difference before these changes, assuming it is working as expected as up scrolling is still possible if one first goes for down scrolling then up scrolling. I will investigate more but can you check also if this really worked before my changes also?\n\nI am not really happy about getChildAt(0), so maybe you have another idea about that, too (IDs?).\n\nYes, that's not reliable also in my experience. I used setBackground(Color.RED) to see if I've found the pages correctly. Should investigate more.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406841660", "createdAt": "2020-04-10T16:45:30Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/com/google/android/material/bottomsheet/ViewPagerBottomSheetBehavior.java", "diffHunk": "@@ -31,8 +32,8 @@ View findScrollingChild(View view) {\n             return view;\n         }\n \n-        if (view instanceof ViewPager) {\n-            ViewPager viewPager = (ViewPager) view;\n+        if (view instanceof ViewPager2) {\n+            ViewPager2 viewPager = (ViewPager2) view;\n             View currentViewPagerChild = viewPager.getChildAt(viewPager.getCurrentItem());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NTg4Mw=="}, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkwMjIzOA==", "bodyText": "assuming it is working as expected as up scrolling is still possible if one first goes for down scrolling then up scrolling\n\nUsing the old version, I do not need to scroll up before being able to scroll down. I can just directly scroll up. In your version, I am also unable to hide the audio player by scrolling on the cover page.\n\nI used setBackground(Color.RED) to see if I've found the pages correctly.\n\nWhen printing currentViewPagerChild in your current version, you can see that it always finds the RecyclerView that the ViewPager2 is based on. Not the Views within the pager.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406902238", "createdAt": "2020-04-10T19:13:51Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/com/google/android/material/bottomsheet/ViewPagerBottomSheetBehavior.java", "diffHunk": "@@ -31,8 +32,8 @@ View findScrollingChild(View view) {\n             return view;\n         }\n \n-        if (view instanceof ViewPager) {\n-            ViewPager viewPager = (ViewPager) view;\n+        if (view instanceof ViewPager2) {\n+            ViewPager2 viewPager = (ViewPager2) view;\n             View currentViewPagerChild = viewPager.getChildAt(viewPager.getCurrentItem());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NTg4Mw=="}, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkxMjY3Mw==", "bodyText": "Oh, I am sorry, you already had provided the fix \ud83e\udd26\ud83e\udd26\u200d\u2642\ufe0f works as expected, fca01a4", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406912673", "createdAt": "2020-04-10T19:43:12Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/com/google/android/material/bottomsheet/ViewPagerBottomSheetBehavior.java", "diffHunk": "@@ -31,8 +32,8 @@ View findScrollingChild(View view) {\n             return view;\n         }\n \n-        if (view instanceof ViewPager) {\n-            ViewPager viewPager = (ViewPager) view;\n+        if (view instanceof ViewPager2) {\n+            ViewPager2 viewPager = (ViewPager2) view;\n             View currentViewPagerChild = viewPager.getChildAt(viewPager.getCurrentItem());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NTg4Mw=="}, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNDY3MDg3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/fragment/ItemPagerFragment.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNTowMjowM1rOGD87sQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNjo0MDoxM1rOGD_gUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NzIzMw==", "bodyText": "When clicking an episode (not the first one in the list), I now see an animation scrolling through the pages of other episodes. Not sure what to do about that.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406797233", "createdAt": "2020-04-10T15:02:03Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/ItemPagerFragment.java", "diffHunk": "@@ -76,31 +77,21 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c\n         feedItems = getArguments().getLongArray(ARG_FEEDITEMS);\n         int feedItemPos = getArguments().getInt(ARG_FEEDITEM_POS);\n \n-        ViewPager pager = layout.findViewById(R.id.pager);\n+        ViewPager2 pager = layout.findViewById(R.id.pager);\n         // FragmentStatePagerAdapter documentation:\n         // > When using FragmentStatePagerAdapter the host ViewPager must have a valid ID set.\n         // When opening multiple ItemPagerFragments by clicking \"item\" -> \"visit podcast\" -> \"item\" -> etc,\n         // the ID is no longer unique and FragmentStatePagerAdapter does not display any pages.\n         int newId = ViewCompat.generateViewId();\n         pager.setId(newId);\n-        pager.setAdapter(new ItemPagerAdapter());\n+        pager.setAdapter(new ItemPagerAdapter(this));\n         pager.setCurrentItem(feedItemPos);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjgzOTM3Nw==", "bodyText": "Done e2ff176", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r406839377", "createdAt": "2020-04-10T16:40:13Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/de/danoeh/antennapod/fragment/ItemPagerFragment.java", "diffHunk": "@@ -76,31 +77,21 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c\n         feedItems = getArguments().getLongArray(ARG_FEEDITEMS);\n         int feedItemPos = getArguments().getInt(ARG_FEEDITEM_POS);\n \n-        ViewPager pager = layout.findViewById(R.id.pager);\n+        ViewPager2 pager = layout.findViewById(R.id.pager);\n         // FragmentStatePagerAdapter documentation:\n         // > When using FragmentStatePagerAdapter the host ViewPager must have a valid ID set.\n         // When opening multiple ItemPagerFragments by clicking \"item\" -> \"visit podcast\" -> \"item\" -> etc,\n         // the ID is no longer unique and FragmentStatePagerAdapter does not display any pages.\n         int newId = ViewCompat.generateViewId();\n         pager.setId(newId);\n-        pager.setAdapter(new ItemPagerAdapter());\n+        pager.setAdapter(new ItemPagerAdapter(this));\n         pager.setCurrentItem(feedItemPos);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5NzIzMw=="}, "originalCommit": {"oid": "0416230a0f076d02c5519220d5ec837ebcb722af"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyODA4NTE5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMTo1ODoyOVrOGEZAfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMTo1ODoyOVrOGEZAfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI1NzIxNQ==", "bodyText": "I think a better location would be de.danoeh.antennapod.view", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r407257215", "createdAt": "2020-04-12T21:58:29Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2019 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Source: https://github.com/android/views-widgets-samples/blob/87e58d1/ViewPager2/app/src/main/java/androidx/viewpager2/integration/testapp/NestedScrollableHost.kt\n+ */\n+\n+package androidx.viewpager2.integration;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e741c516d902898843b5da5e2eb07f4eb201a0c"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyODA5NDMzOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMjowOTozOVrOGEZFAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODozNzo0NFrOGFb4Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI1ODM2OQ==", "bodyText": "Scrolling generally works fine now but it sometimes feels a bit strange.\n\nIt is really easy to accidentally switch to another page when trying to scroll up/down. I think the sensitivity should be inverted: It should be easy to scroll up/down and harder to switch the page. Not sure how that would work, I have not looked at the code too closely yet.\nSometimes, flinging (move finger fast, then lift and the view continues to scroll) does not work. This might be caused by the thing above.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r407258369", "createdAt": "2020-04-12T22:09:39Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2019 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Source: https://github.com/android/views-widgets-samples/blob/87e58d1/ViewPager2/app/src/main/java/androidx/viewpager2/integration/testapp/NestedScrollableHost.kt\n+ */\n+\n+package androidx.viewpager2.integration;\n+\n+import android.content.Context;\n+import android.util.AttributeSet;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.view.ViewConfiguration;\n+import android.widget.FrameLayout;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.viewpager2.widget.ViewPager2;\n+\n+import static androidx.viewpager2.widget.ViewPager2.ORIENTATION_HORIZONTAL;\n+\n+/**\n+ * Layout to wrap a scrollable component inside a ViewPager2. Provided as a solution to the problem\n+ * where pages of ViewPager2 have nested scrollable elements that scroll in the same direction as\n+ * ViewPager2. The scrollable element needs to be the immediate and only child of this host layout.\n+ *\n+ * <p>This solution has limitations when using multiple levels of nested scrollable elements\n+ * (e.g. a horizontal RecyclerView in a vertical RecyclerView in a horizontal ViewPager2).</p>\n+ */\n+class NestedScrollableHost extends FrameLayout {\n+\n+    public NestedScrollableHost(@NonNull Context context) {\n+        super(context);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    public NestedScrollableHost(@NonNull Context context, @Nullable AttributeSet attrs) {\n+        super(context, attrs);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    private int touchSlop = 0;\n+    private float initialX = 0f;\n+    private float initialY = 0f;\n+\n+    private ViewPager2 getParentViewPager() {\n+        View v = (View) getParent();\n+        while (v != null && !(v instanceof ViewPager2)) {\n+            v = (View) v.getParent();\n+        }\n+        return v == null ? null : (ViewPager2) v;\n+    }\n+\n+    private View getChild() {\n+        return getChildCount() > 0 ? getChildAt(0) : null;\n+    }\n+\n+    private boolean canChildScroll(int orientation, float delta) {\n+        int direction = (int) -Math.copySign(1, delta);\n+        View child = getChild();\n+        if (child == null) {\n+            return false;\n+        }\n+        switch (orientation) {\n+            case 0:\n+                return child.canScrollHorizontally(direction);\n+            case 1:\n+                return child.canScrollVertically(direction);\n+            default:\n+                return false;\n+        }\n+    }\n+\n+    public boolean onInterceptTouchEvent(MotionEvent e) {\n+        handleInterceptTouchEvent(e);\n+        return super.onInterceptTouchEvent(e);\n+    }\n+\n+    private void handleInterceptTouchEvent(MotionEvent e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e741c516d902898843b5da5e2eb07f4eb201a0c"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3NTIwNQ==", "bodyText": "after playing some hours with it, no progress, guess need your help :)", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r407375205", "createdAt": "2020-04-13T08:26:00Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2019 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Source: https://github.com/android/views-widgets-samples/blob/87e58d1/ViewPager2/app/src/main/java/androidx/viewpager2/integration/testapp/NestedScrollableHost.kt\n+ */\n+\n+package androidx.viewpager2.integration;\n+\n+import android.content.Context;\n+import android.util.AttributeSet;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.view.ViewConfiguration;\n+import android.widget.FrameLayout;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.viewpager2.widget.ViewPager2;\n+\n+import static androidx.viewpager2.widget.ViewPager2.ORIENTATION_HORIZONTAL;\n+\n+/**\n+ * Layout to wrap a scrollable component inside a ViewPager2. Provided as a solution to the problem\n+ * where pages of ViewPager2 have nested scrollable elements that scroll in the same direction as\n+ * ViewPager2. The scrollable element needs to be the immediate and only child of this host layout.\n+ *\n+ * <p>This solution has limitations when using multiple levels of nested scrollable elements\n+ * (e.g. a horizontal RecyclerView in a vertical RecyclerView in a horizontal ViewPager2).</p>\n+ */\n+class NestedScrollableHost extends FrameLayout {\n+\n+    public NestedScrollableHost(@NonNull Context context) {\n+        super(context);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    public NestedScrollableHost(@NonNull Context context, @Nullable AttributeSet attrs) {\n+        super(context, attrs);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    private int touchSlop = 0;\n+    private float initialX = 0f;\n+    private float initialY = 0f;\n+\n+    private ViewPager2 getParentViewPager() {\n+        View v = (View) getParent();\n+        while (v != null && !(v instanceof ViewPager2)) {\n+            v = (View) v.getParent();\n+        }\n+        return v == null ? null : (ViewPager2) v;\n+    }\n+\n+    private View getChild() {\n+        return getChildCount() > 0 ? getChildAt(0) : null;\n+    }\n+\n+    private boolean canChildScroll(int orientation, float delta) {\n+        int direction = (int) -Math.copySign(1, delta);\n+        View child = getChild();\n+        if (child == null) {\n+            return false;\n+        }\n+        switch (orientation) {\n+            case 0:\n+                return child.canScrollHorizontally(direction);\n+            case 1:\n+                return child.canScrollVertically(direction);\n+            default:\n+                return false;\n+        }\n+    }\n+\n+    public boolean onInterceptTouchEvent(MotionEvent e) {\n+        handleInterceptTouchEvent(e);\n+        return super.onInterceptTouchEvent(e);\n+    }\n+\n+    private void handleInterceptTouchEvent(MotionEvent e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI1ODM2OQ=="}, "originalCommit": {"oid": "1e741c516d902898843b5da5e2eb07f4eb201a0c"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM3Njg5Mg==", "bodyText": "wrapping it in NestedScrollView make the pager not scroll easily but causes more harm on the content itself and make it similar to bottomsheet shownote issue, I think ideally both webviews should be wrap content to make nestedscrollview handle their scrolling but that seems also tricky.\nOr skip ViewPager2 for episodes shownotes fragments as it isn't that important as the other tablayout having ones.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r407376892", "createdAt": "2020-04-13T08:30:31Z", "author": {"login": "ebraminio"}, "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2019 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Source: https://github.com/android/views-widgets-samples/blob/87e58d1/ViewPager2/app/src/main/java/androidx/viewpager2/integration/testapp/NestedScrollableHost.kt\n+ */\n+\n+package androidx.viewpager2.integration;\n+\n+import android.content.Context;\n+import android.util.AttributeSet;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.view.ViewConfiguration;\n+import android.widget.FrameLayout;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.viewpager2.widget.ViewPager2;\n+\n+import static androidx.viewpager2.widget.ViewPager2.ORIENTATION_HORIZONTAL;\n+\n+/**\n+ * Layout to wrap a scrollable component inside a ViewPager2. Provided as a solution to the problem\n+ * where pages of ViewPager2 have nested scrollable elements that scroll in the same direction as\n+ * ViewPager2. The scrollable element needs to be the immediate and only child of this host layout.\n+ *\n+ * <p>This solution has limitations when using multiple levels of nested scrollable elements\n+ * (e.g. a horizontal RecyclerView in a vertical RecyclerView in a horizontal ViewPager2).</p>\n+ */\n+class NestedScrollableHost extends FrameLayout {\n+\n+    public NestedScrollableHost(@NonNull Context context) {\n+        super(context);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    public NestedScrollableHost(@NonNull Context context, @Nullable AttributeSet attrs) {\n+        super(context, attrs);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    private int touchSlop = 0;\n+    private float initialX = 0f;\n+    private float initialY = 0f;\n+\n+    private ViewPager2 getParentViewPager() {\n+        View v = (View) getParent();\n+        while (v != null && !(v instanceof ViewPager2)) {\n+            v = (View) v.getParent();\n+        }\n+        return v == null ? null : (ViewPager2) v;\n+    }\n+\n+    private View getChild() {\n+        return getChildCount() > 0 ? getChildAt(0) : null;\n+    }\n+\n+    private boolean canChildScroll(int orientation, float delta) {\n+        int direction = (int) -Math.copySign(1, delta);\n+        View child = getChild();\n+        if (child == null) {\n+            return false;\n+        }\n+        switch (orientation) {\n+            case 0:\n+                return child.canScrollHorizontally(direction);\n+            case 1:\n+                return child.canScrollVertically(direction);\n+            default:\n+                return false;\n+        }\n+    }\n+\n+    public boolean onInterceptTouchEvent(MotionEvent e) {\n+        handleInterceptTouchEvent(e);\n+        return super.onInterceptTouchEvent(e);\n+    }\n+\n+    private void handleInterceptTouchEvent(MotionEvent e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI1ODM2OQ=="}, "originalCommit": {"oid": "1e741c516d902898843b5da5e2eb07f4eb201a0c"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1MjgzNA==", "bodyText": "I think ideally both webviews should be wrap content to make nestedscrollview handle their scrolling\n\nThis is not ideal. Wrapping in nestedscrollview causes me headache already because it increases the memory footprint of the WebView. Setting it to wrap_content makes it render the whole page, even the parts that are not visible. If the page contains many images, this can lead to crashes. So ideally, I want to go completely without the nestedscrollview hack.\n\nafter playing some hours with it, no progress, guess need your help :)\n\nMaybe implementing NestedScrollingChild3 could be a starting point. I do not know much about that topic either, so I can not help too much, unfortunately.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4020#discussion_r408352834", "createdAt": "2020-04-14T18:37:44Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/androidx/viewpager2/integration/NestedScrollableHost.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2019 The Android Open Source Project\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Source: https://github.com/android/views-widgets-samples/blob/87e58d1/ViewPager2/app/src/main/java/androidx/viewpager2/integration/testapp/NestedScrollableHost.kt\n+ */\n+\n+package androidx.viewpager2.integration;\n+\n+import android.content.Context;\n+import android.util.AttributeSet;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.view.ViewConfiguration;\n+import android.widget.FrameLayout;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.viewpager2.widget.ViewPager2;\n+\n+import static androidx.viewpager2.widget.ViewPager2.ORIENTATION_HORIZONTAL;\n+\n+/**\n+ * Layout to wrap a scrollable component inside a ViewPager2. Provided as a solution to the problem\n+ * where pages of ViewPager2 have nested scrollable elements that scroll in the same direction as\n+ * ViewPager2. The scrollable element needs to be the immediate and only child of this host layout.\n+ *\n+ * <p>This solution has limitations when using multiple levels of nested scrollable elements\n+ * (e.g. a horizontal RecyclerView in a vertical RecyclerView in a horizontal ViewPager2).</p>\n+ */\n+class NestedScrollableHost extends FrameLayout {\n+\n+    public NestedScrollableHost(@NonNull Context context) {\n+        super(context);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    public NestedScrollableHost(@NonNull Context context, @Nullable AttributeSet attrs) {\n+        super(context, attrs);\n+        touchSlop = ViewConfiguration.get(context).getScaledTouchSlop();\n+    }\n+\n+    private int touchSlop = 0;\n+    private float initialX = 0f;\n+    private float initialY = 0f;\n+\n+    private ViewPager2 getParentViewPager() {\n+        View v = (View) getParent();\n+        while (v != null && !(v instanceof ViewPager2)) {\n+            v = (View) v.getParent();\n+        }\n+        return v == null ? null : (ViewPager2) v;\n+    }\n+\n+    private View getChild() {\n+        return getChildCount() > 0 ? getChildAt(0) : null;\n+    }\n+\n+    private boolean canChildScroll(int orientation, float delta) {\n+        int direction = (int) -Math.copySign(1, delta);\n+        View child = getChild();\n+        if (child == null) {\n+            return false;\n+        }\n+        switch (orientation) {\n+            case 0:\n+                return child.canScrollHorizontally(direction);\n+            case 1:\n+                return child.canScrollVertically(direction);\n+            default:\n+                return false;\n+        }\n+    }\n+\n+    public boolean onInterceptTouchEvent(MotionEvent e) {\n+        handleInterceptTouchEvent(e);\n+        return super.onInterceptTouchEvent(e);\n+    }\n+\n+    private void handleInterceptTouchEvent(MotionEvent e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI1ODM2OQ=="}, "originalCommit": {"oid": "1e741c516d902898843b5da5e2eb07f4eb201a0c"}, "originalPosition": 91}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4769, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}