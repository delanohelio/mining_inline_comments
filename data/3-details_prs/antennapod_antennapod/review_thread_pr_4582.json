{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4MTg0NzQ5", "number": 4582, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyMzo1OVrOEwuFCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDo0NFrOExXzCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTIyMDU5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyMzo1OVrOHmc_yA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyMzo1OVrOHmc_yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MzAxNg==", "bodyText": "I think this snackbar is no longer needed when the share dialog opens anyway", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510083016", "createdAt": "2020-10-22T11:23:59Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "diffHunk": "@@ -58,12 +64,35 @@ protected void onCreate(Bundle savedInstanceState) {\n                 filename.createNewFile();\n                 String cmd = \"logcat -d -f \" + filename.getAbsolutePath();\n                 Runtime.getRuntime().exec(cmd);\n-                Snackbar.make(findViewById(android.R.id.content),\n-                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT).show();\n+                Snackbar snack = Snackbar.make(findViewById(android.R.id.content),\n+                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTIzMzIxOnYy", "diffSide": "RIGHT", "path": "app/src/main/AndroidManifest.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyNzo0MFrOHmdH5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyNzo0MFrOHmdH5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4NTA5Mg==", "bodyText": "The file is located in AntennaPod's own directory, so the permission is not needed. What I meant with \"grant read permission\" is that AntennaPod should allow the other apps to read the file even if the other apps do not have the storage permission. You can see how this works by looking at: \n  \n    \n      AntennaPod/core/src/main/java/de/danoeh/antennapod/core/util/ShareUtils.java\n    \n    \n        Lines 75 to 83\n      in\n      72f7713\n    \n    \n    \n    \n\n        \n          \n           public static void shareFeedItemFile(Context context, FeedMedia media) { \n        \n\n        \n          \n           \tIntent i = new Intent(Intent.ACTION_SEND); \n        \n\n        \n          \n           \ti.setType(media.getMime_type()); \n        \n\n        \n          \n           \tUri fileUri = FileProvider.getUriForFile(context, context.getString(R.string.provider_authority), \n        \n\n        \n          \n           \t\t\tnew File(media.getLocalMediaUrl())); \n        \n\n        \n          \n           \ti.putExtra(Intent.EXTRA_STREAM,  fileUri); \n        \n\n        \n          \n           \ti.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); \n        \n\n        \n          \n           \tif (Build.VERSION.SDK_INT <= Build.VERSION_CODES.KITKAT) { \n        \n\n        \n          \n           \t\tList<ResolveInfo> resInfoList = context.getPackageManager().queryIntentActivities(i, PackageManager.MATCH_DEFAULT_ONLY);", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510085092", "createdAt": "2020-10-22T11:27:40Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/AndroidManifest.xml", "diffHunk": "@@ -5,6 +5,7 @@\n \n     <uses-permission android:name=\"android.permission.INTERNET\"/>\n     <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/>\n+    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTIzNjk2OnYy", "diffSide": "RIGHT", "path": "gradle/wrapper/gradle-wrapper.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyODo1NFrOHmdKUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyODo1NFrOHmdKUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4NTcxNQ==", "bodyText": "Please revert the changes to this file. We only update build tools when there is a good reason for it.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510085715", "createdAt": "2020-10-22T11:28:54Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n+#Wed Oct 21 18:27:31 BDT 2020\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.5-bin.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NzUwNTQ1OnYy", "diffSide": "RIGHT", "path": "gradle/wrapper/gradle-wrapper.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo0NzoxMVrOHmzMlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo0NzoxMVrOHmzMlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ0Njc0Mg==", "bodyText": "Please revert the full content of the file to its original state. This makes it easier to read to git commit history. Same applies to the manifest file.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510446742", "createdAt": "2020-10-22T20:47:11Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n+#Wed Oct 21 18:27:31 BDT 2020\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NzUyMzM5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo1MTo1OVrOHmzXTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo1MTo1OVrOHmzXTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ0OTQ4NQ==", "bodyText": "I think it would be better to create a new string here with a text like No compatible apps found.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510449485", "createdAt": "2020-10-22T20:51:59Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "diffHunk": "@@ -58,12 +69,36 @@ protected void onCreate(Bundle savedInstanceState) {\n                 filename.createNewFile();\n                 String cmd = \"logcat -d -f \" + filename.getAbsolutePath();\n                 Runtime.getRuntime().exec(cmd);\n-                Snackbar.make(findViewById(android.R.id.content),\n-                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT).show();\n+\n+                //share file\n+                try {\n+                    Intent shareIntent = new Intent(Intent.ACTION_SEND);\n+                    shareIntent.setType(\"text/*\");\n+                    Uri fileUri = FileProvider.getUriForFile(this, this.getString(de.danoeh.antennapod.core.R.string.provider_authority),\n+                            new File(filename.getAbsolutePath()));\n+                    shareIntent.putExtra(Intent.EXTRA_STREAM,  fileUri);\n+                    shareIntent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);\n+                    if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.KITKAT) {\n+                        List<ResolveInfo> resInfoList = this.getPackageManager().queryIntentActivities(shareIntent, PackageManager.MATCH_DEFAULT_ONLY);\n+                        for (ResolveInfo resolveInfo : resInfoList) {\n+                            String packageName = resolveInfo.activityInfo.packageName;\n+                            this.grantUriPermission(packageName, fileUri, Intent.FLAG_GRANT_READ_URI_PERMISSION);\n+                        }\n+                    }\n+                    this.startActivity(Intent.createChooser(shareIntent, this.getString(de.danoeh.antennapod.core.R.string.share_file_label)));\n+\n+                }\n+                catch (Exception e){\n+                    e.printStackTrace();\n+                    Snackbar.make(findViewById(android.R.id.content),\"Failed to share file\", Snackbar.LENGTH_LONG).show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMjA1NTI4OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/values/strings.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDozMlrOHneLHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDozMlrOHneLHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDg3OA==", "bodyText": "Please move this to the strings.xml file in the core folder, which has all the other translations. That allows our translators to localize the string.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r511150878", "createdAt": "2020-10-23T20:54:32Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -1,4 +1,5 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n <resources>\n     <string name=\"app_name\" translate=\"false\">AntennaPod</string>\n+    <string name=\"log_file_share_exception\">No compatible apps found</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMjA1NTc5OnYy", "diffSide": "RIGHT", "path": "gradle/wrapper/gradle-wrapper.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDo0NFrOHneLZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDo0NFrOHneLZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDk1MQ==", "bodyText": "There is still an unrelated change ;)", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r511150951", "createdAt": "2020-10-23T20:54:44Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -3,3 +3,4 @@ distributionPath=wrapper/dists\n distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4707, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}