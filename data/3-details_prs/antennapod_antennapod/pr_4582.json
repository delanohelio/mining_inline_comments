{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4MTg0NzQ5", "number": 4582, "title": "Share exported logs added", "bodyText": "**issue #4568 **\nWhat's new?\n\nshare feature add in 'export log'\n'export log' snackbar message repositioned in the center for a better view\n\nDo let me know if any change need or something is wrong.", "createdAt": "2020-10-22T10:26:15Z", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582", "merged": true, "mergeCommit": {"oid": "75b7b41fa07da5d7f4b8a036ddb84bd846dda2a8"}, "closed": true, "closedAt": "2020-10-24T07:32:23Z", "author": {"login": "zawad2221"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdU9A60AH2gAyNTA4MTg0NzQ5OmQ4NzI5NmZhZDEwYWIyMzNkZDU3MWE2M2I4NGRhMTFiYzhhOGE3YzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVkNawgH2gAyNTA4MTg0NzQ5OjRlZThhMzBhNjg2N2M5YjQ1MjRmY2ZhZjgxNjRlZjcxYzhkMzFhNTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/d87296fad10ab233dd571a63b84da11bc8a8a7c0", "committedDate": "2020-10-22T07:40:56Z", "message": "share feature added in export log and repositioned the export snack message in middle of screen"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NjIwOTUx", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#pullrequestreview-514620951", "createdAt": "2020-10-22T11:23:59Z", "commit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyMzo1OVrOHmc_yA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMToyODo1NFrOHmdKUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MzAxNg==", "bodyText": "I think this snackbar is no longer needed when the share dialog opens anyway", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510083016", "createdAt": "2020-10-22T11:23:59Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "diffHunk": "@@ -58,12 +64,35 @@ protected void onCreate(Bundle savedInstanceState) {\n                 filename.createNewFile();\n                 String cmd = \"logcat -d -f \" + filename.getAbsolutePath();\n                 Runtime.getRuntime().exec(cmd);\n-                Snackbar.make(findViewById(android.R.id.content),\n-                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT).show();\n+                Snackbar snack = Snackbar.make(findViewById(android.R.id.content),\n+                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4NTA5Mg==", "bodyText": "The file is located in AntennaPod's own directory, so the permission is not needed. What I meant with \"grant read permission\" is that AntennaPod should allow the other apps to read the file even if the other apps do not have the storage permission. You can see how this works by looking at: \n  \n    \n      AntennaPod/core/src/main/java/de/danoeh/antennapod/core/util/ShareUtils.java\n    \n    \n        Lines 75 to 83\n      in\n      72f7713\n    \n    \n    \n    \n\n        \n          \n           public static void shareFeedItemFile(Context context, FeedMedia media) { \n        \n\n        \n          \n           \tIntent i = new Intent(Intent.ACTION_SEND); \n        \n\n        \n          \n           \ti.setType(media.getMime_type()); \n        \n\n        \n          \n           \tUri fileUri = FileProvider.getUriForFile(context, context.getString(R.string.provider_authority), \n        \n\n        \n          \n           \t\t\tnew File(media.getLocalMediaUrl())); \n        \n\n        \n          \n           \ti.putExtra(Intent.EXTRA_STREAM,  fileUri); \n        \n\n        \n          \n           \ti.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); \n        \n\n        \n          \n           \tif (Build.VERSION.SDK_INT <= Build.VERSION_CODES.KITKAT) { \n        \n\n        \n          \n           \t\tList<ResolveInfo> resInfoList = context.getPackageManager().queryIntentActivities(i, PackageManager.MATCH_DEFAULT_ONLY);", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510085092", "createdAt": "2020-10-22T11:27:40Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/AndroidManifest.xml", "diffHunk": "@@ -5,6 +5,7 @@\n \n     <uses-permission android:name=\"android.permission.INTERNET\"/>\n     <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/>\n+    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4NTcxNQ==", "bodyText": "Please revert the changes to this file. We only update build tools when there is a good reason for it.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510085715", "createdAt": "2020-10-22T11:28:54Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n+#Wed Oct 21 18:27:31 BDT 2020\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.5-bin.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d87296fad10ab233dd571a63b84da11bc8a8a7c0"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/cf7ab4a17c75a45d1f024d37a8159c519b9e1303", "committedDate": "2020-10-22T14:37:06Z", "message": "export log snackbar removed and updated the log file share"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTA2MDE0", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#pullrequestreview-515106014", "createdAt": "2020-10-22T20:47:10Z", "commit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo0NzoxMVrOHmzMlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDo1MTo1OVrOHmzXTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ0Njc0Mg==", "bodyText": "Please revert the full content of the file to its original state. This makes it easier to read to git commit history. Same applies to the manifest file.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510446742", "createdAt": "2020-10-22T20:47:11Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n+#Wed Oct 21 18:27:31 BDT 2020\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ0OTQ4NQ==", "bodyText": "I think it would be better to create a new string here with a text like No compatible apps found.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r510449485", "createdAt": "2020-10-22T20:51:59Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/BugReportActivity.java", "diffHunk": "@@ -58,12 +69,36 @@ protected void onCreate(Bundle savedInstanceState) {\n                 filename.createNewFile();\n                 String cmd = \"logcat -d -f \" + filename.getAbsolutePath();\n                 Runtime.getRuntime().exec(cmd);\n-                Snackbar.make(findViewById(android.R.id.content),\n-                        filename.getAbsolutePath(), Snackbar.LENGTH_SHORT).show();\n+\n+                //share file\n+                try {\n+                    Intent shareIntent = new Intent(Intent.ACTION_SEND);\n+                    shareIntent.setType(\"text/*\");\n+                    Uri fileUri = FileProvider.getUriForFile(this, this.getString(de.danoeh.antennapod.core.R.string.provider_authority),\n+                            new File(filename.getAbsolutePath()));\n+                    shareIntent.putExtra(Intent.EXTRA_STREAM,  fileUri);\n+                    shareIntent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);\n+                    if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.KITKAT) {\n+                        List<ResolveInfo> resInfoList = this.getPackageManager().queryIntentActivities(shareIntent, PackageManager.MATCH_DEFAULT_ONLY);\n+                        for (ResolveInfo resolveInfo : resInfoList) {\n+                            String packageName = resolveInfo.activityInfo.packageName;\n+                            this.grantUriPermission(packageName, fileUri, Intent.FLAG_GRANT_READ_URI_PERMISSION);\n+                        }\n+                    }\n+                    this.startActivity(Intent.createChooser(shareIntent, this.getString(de.danoeh.antennapod.core.R.string.share_file_label)));\n+\n+                }\n+                catch (Exception e){\n+                    e.printStackTrace();\n+                    Snackbar.make(findViewById(android.R.id.content),\"Failed to share file\", Snackbar.LENGTH_LONG).show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ab4a17c75a45d1f024d37a8159c519b9e1303"}, "originalPosition": 56}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79b0d93d1a20710de59e4d9a9f83ebdeda6324c1", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/79b0d93d1a20710de59e4d9a9f83ebdeda6324c1", "committedDate": "2020-10-23T04:22:55Z", "message": "code style changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "638b7005ba5cb65499fee89c4ea0978948725afd", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/638b7005ba5cb65499fee89c4ea0978948725afd", "committedDate": "2020-10-23T04:53:56Z", "message": "change in code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/b1fa38a3f37fc38d77e761345358629e92ac04f5", "committedDate": "2020-10-23T05:03:37Z", "message": "code style changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2MDA0NjEz", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#pullrequestreview-516004613", "createdAt": "2020-10-23T20:54:32Z", "commit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDozMlrOHneLHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMDo1NDo0NFrOHneLZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDg3OA==", "bodyText": "Please move this to the strings.xml file in the core folder, which has all the other translations. That allows our translators to localize the string.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r511150878", "createdAt": "2020-10-23T20:54:32Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -1,4 +1,5 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n <resources>\n     <string name=\"app_name\" translate=\"false\">AntennaPod</string>\n+    <string name=\"log_file_share_exception\">No compatible apps found</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDk1MQ==", "bodyText": "There is still an unrelated change ;)", "url": "https://github.com/AntennaPod/AntennaPod/pull/4582#discussion_r511150951", "createdAt": "2020-10-23T20:54:44Z", "author": {"login": "ByteHamster"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -3,3 +3,4 @@ distributionPath=wrapper/dists\n distributionUrl=https\\://services.gradle.org/distributions/gradle-6.3-all.zip\n zipStoreBase=GRADLE_USER_HOME\n zipStorePath=wrapper/dists\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1fa38a3f37fc38d77e761345358629e92ac04f5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d4054d7eae53d6106dc0d41f98b0b38a2fa5b5b", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/0d4054d7eae53d6106dc0d41f98b0b38a2fa5b5b", "committedDate": "2020-10-24T05:08:19Z", "message": "string moved in core folder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ee8a30a6867c9b4524fcfaf8164ef71c8d31a52", "author": {"user": {"login": "zawad2221", "name": "zawad hossain"}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/4ee8a30a6867c9b4524fcfaf8164ef71c8d31a52", "committedDate": "2020-10-24T05:20:53Z", "message": "Update strings.xml"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2750, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}