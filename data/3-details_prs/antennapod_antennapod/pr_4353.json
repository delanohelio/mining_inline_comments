{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0NTgxMjg1", "number": 4353, "title": "WIP: Dynamical navigation drawer size", "bodyText": "While adding support for samsung's DeX (#4343 ), the issue appeared that the navigation drawer is too large on wide screens.\nThis could be solved by a screen-size-dynamical drawer size or a maximum width.", "createdAt": "2020-08-07T12:37:25Z", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353", "merged": true, "mergeCommit": {"oid": "5a4cb23877c4d7a33b578ab8b726774586c7c851"}, "closed": true, "closedAt": "2020-08-09T09:36:12Z", "author": {"login": "asdoi"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7P3gWgH2gAyNDY0NTgxMjg1OmRiMzVlYzk1MDdjOWU0NzhlMWY4MTU5Y2QzZTVkYjI2M2U3NGEwODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc851ZXgH2gAyNDY0NTgxMjg1OmIyMmY3NDAyNzNmYmNkYWNiYTM5Yjk2NTY4YWQ3NTliYzJmMjFkYzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "db35ec9507c9e478e1f8159cd3e5db263e74a084", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/db35ec9507c9e478e1f8159cd3e5db263e74a084", "committedDate": "2020-08-03T10:56:49Z", "message": "Add basic resize functionality"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "509b695b008b0e478c1b8d25edb039bc90998d15", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/509b695b008b0e478c1b8d25edb039bc90998d15", "committedDate": "2020-08-06T16:22:37Z", "message": "resize navigation drawer dynamically"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e9417168e3415afe014c6a7755590f03eb740f7", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/1e9417168e3415afe014c6a7755590f03eb740f7", "committedDate": "2020-08-07T12:33:06Z", "message": "Revert \"Add basic resize functionality\"\n\nThis reverts commit db35ec95"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0609f5658da950b580d96304a4be6d4913a66a5", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/e0609f5658da950b580d96304a4be6d4913a66a5", "committedDate": "2020-08-07T12:54:39Z", "message": "Add a maxwidth to nav drawer size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODAyMTM4", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#pullrequestreview-463802138", "createdAt": "2020-08-08T13:08:12Z", "commit": {"oid": "e0609f5658da950b580d96304a4be6d4913a66a5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxMzowODoxMlrOG9ztDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxMzowODo1MlrOG9ztOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2MzQzNw==", "bodyText": "You can store this in R.dimens to prevent having to convert between dp and px.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467463437", "createdAt": "2020-08-08T13:08:12Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,34 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) dpInPx(getResources().getInteger(R.integer.nav_drawer_max_screen_size_dp));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0609f5658da950b580d96304a4be6d4913a66a5"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2MzQ4Mg==", "bodyText": "Android Lint does not like manual min calculation. Something like Math.min() would be more clear.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467463482", "createdAt": "2020-08-08T13:08:52Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,34 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) dpInPx(getResources().getInteger(R.integer.nav_drawer_max_screen_size_dp));\n+\n+        if (width > maxWidth) {\n+            width = maxWidth;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0609f5658da950b580d96304a4be6d4913a66a5"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "660c6d2795ee624c61c809169c0c58a8c99d7c3d", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/660c6d2795ee624c61c809169c0c58a8c99d7c3d", "committedDate": "2020-08-08T14:04:53Z", "message": "add is tablet check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a5627dd23ebd4e1e59433ffefa126b5dd62f215", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/1a5627dd23ebd4e1e59433ffefa126b5dd62f215", "committedDate": "2020-08-08T14:08:00Z", "message": "add if braces"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODA1ODEw", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#pullrequestreview-463805810", "createdAt": "2020-08-08T14:19:03Z", "commit": {"oid": "1a5627dd23ebd4e1e59433ffefa126b5dd62f215"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNDoxOTowM1rOG90Ekw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNDoxOTowM1rOG90Ekw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2OTQ1OQ==", "bodyText": "It would be more reliable to check if drawerToggle == null to detect if we are using the tablet layout.", "url": "https://github.com/AntennaPod/AntennaPod/pull/4353#discussion_r467469459", "createdAt": "2020-08-08T14:19:03Z", "author": {"login": "ByteHamster"}, "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -323,6 +327,30 @@ public void onConfigurationChanged(Configuration newConfig) {\n         if (drawerToggle != null) { // Tablet layout does not have a drawer\n             drawerToggle.onConfigurationChanged(newConfig);\n         }\n+        setNavDrawerSize();\n+    }\n+\n+    private void setNavDrawerSize() {\n+        if (isTablet()) {\n+            return;\n+        }\n+        float screenPercent = getResources().getInteger(R.integer.nav_drawer_screen_size_percent) * 0.01f;\n+        int width = (int) (getScreenWidth() * screenPercent);\n+        int maxWidth = (int) getResources().getDimension(R.dimen.nav_drawer_max_screen_size);\n+\n+        navDrawer.getLayoutParams().width = Math.min(width, maxWidth);\n+    }\n+\n+    private int getScreenWidth() {\n+        DisplayMetrics displayMetrics = new DisplayMetrics();\n+        getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);\n+        return displayMetrics.widthPixels;\n+    }\n+\n+    private boolean isTablet() {\n+        return (getResources().getConfiguration().screenLayout\n+                & Configuration.SCREENLAYOUT_SIZE_MASK)\n+                >= Configuration.SCREENLAYOUT_SIZE_LARGE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a5627dd23ebd4e1e59433ffefa126b5dd62f215"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b22f740273fbcdacba39b96568ad759bc2f21dc4", "author": {"user": {"login": "asdoi", "name": null}}, "url": "https://github.com/AntennaPod/AntennaPod/commit/b22f740273fbcdacba39b96568ad759bc2f21dc4", "committedDate": "2020-08-08T14:24:27Z", "message": "change tablet check to drawerToggle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2816, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}