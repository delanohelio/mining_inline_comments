{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MzYxNzI1", "number": 571, "title": "fix: paging breaks with + sign on phone number", "bodyText": "Fixes #569\nChecklist\n\n I acknowledge that all my contributions will be made under the project's license", "createdAt": "2020-08-26T23:58:52Z", "url": "https://github.com/twilio/twilio-java/pull/571", "merged": true, "mergeCommit": {"oid": "2f5b9d570c844f2b2eebc741a97c7d302e5f6a32"}, "closed": true, "closedAt": "2020-09-17T21:22:02Z", "author": {"login": "thinkingserious"}, "timelineItems": {"totalCount": 50, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC0zNggH2gAyNDc0MzYxNzI1OjkyNzdjZTI5NzI0MDNkMzY0OTViMjM1MzJiNzIyYmUyYjc5MjY4NTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ3pjPgFqTQ5MDk5Mjg1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9277ce2972403d36495b23532b722be2b7926859", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/9277ce2972403d36495b23532b722be2b7926859", "committedDate": "2020-08-26T23:56:05Z", "message": "fix: paging breaks with + sign on phone number"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ace549d8f9924a0ffbccfd699ca87f2a0a08ab", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/c4ace549d8f9924a0ffbccfd699ca87f2a0a08ab", "committedDate": "2020-08-26T23:58:31Z", "message": "remove logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd465e722a8fb0914f576daa54336b70e35ba4cf", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/cd465e722a8fb0914f576daa54336b70e35ba4cf", "committedDate": "2020-08-27T00:32:32Z", "message": "moved logic to correct function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9e02fb47d2c90c6c2ea5ecdfcb94d16624c6ebd", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/d9e02fb47d2c90c6c2ea5ecdfcb94d16624c6ebd", "committedDate": "2020-08-27T00:33:39Z", "message": "decoder no longer needed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef0ca3a3dd04657b63c367f645a88c960d58e5b4", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/ef0ca3a3dd04657b63c367f645a88c960d58e5b4", "committedDate": "2020-08-27T01:02:37Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "616f00bfdd1a810fc4e9ab18bcfc3ccb0e302947", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/616f00bfdd1a810fc4e9ab18bcfc3ccb0e302947", "committedDate": "2020-08-27T01:43:24Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d000d44c11a75f33f8d556527819ef510daa777", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/0d000d44c11a75f33f8d556527819ef510daa777", "committedDate": "2020-08-27T01:55:51Z", "message": "fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzM1Mjk0", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-476735294", "createdAt": "2020-08-27T13:45:15Z", "commit": {"oid": "0d000d44c11a75f33f8d556527819ef510daa777"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzo0NToxNVrOHIRFKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzo0NToxNVrOHIRFKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQzMDUwNQ==", "bodyText": "This is not the proper solution and there are many other characters which this would not solve for. Proper changes are needed in com.twilio.http.Request.buildURL()", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r478430505", "createdAt": "2020-08-27T13:45:15Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -285,7 +285,12 @@ private static String encodeParameters(final Map<String, List<String>> params) {\n                         continue;\n                     }\n \n-                    String encodedValue = URLEncoder.encode(value, \"UTF-8\");\n+                    String encodedValue;\n+                    if (value.startsWith(\"+\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d000d44c11a75f33f8d556527819ef510daa777"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c772f7395bf046c23dfa952b9e805699a5ba3a5", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/0c772f7395bf046c23dfa952b9e805699a5ba3a5", "committedDate": "2020-08-27T21:01:50Z", "message": "revert improper solution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d4efb4623a7ecc61d5663238e9a219ddd339700", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/4d4efb4623a7ecc61d5663238e9a219ddd339700", "committedDate": "2020-08-27T21:51:51Z", "message": "do not re-encode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb6221e2788bfe45c4936acd54f0760414b16a0b", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/bb6221e2788bfe45c4936acd54f0760414b16a0b", "committedDate": "2020-08-28T18:45:10Z", "message": "revert URL builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ed30ad45b68e2469f1ad3979fabc5fab778f6e6", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/7ed30ad45b68e2469f1ad3979fabc5fab778f6e6", "committedDate": "2020-08-28T18:55:20Z", "message": "update test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f05dc8085f9e3bb7a077c93ea7decbd73cccb78e", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/f05dc8085f9e3bb7a077c93ea7decbd73cccb78e", "committedDate": "2020-08-28T21:50:07Z", "message": "avoid double encoding"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2737afd0198107e55f1f716f2178858cfa1a0ab", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/b2737afd0198107e55f1f716f2178858cfa1a0ab", "committedDate": "2020-08-28T21:53:16Z", "message": "clean up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MDQ4ODkx", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-478048891", "createdAt": "2020-08-28T22:05:58Z", "commit": {"oid": "b2737afd0198107e55f1f716f2178858cfa1a0ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQyMjowNTo1OVrOHJVpng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQyMjowNTo1OVrOHJVpng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTU1Mzk1MA==", "bodyText": "https://en.wikipedia.org/wiki/URI_fragment\n\nThe fragment identifier introduced by a hash mark # is the optional last part of a URL for a document.\n\nThis places it before the query.\nWhat about just decoding the query part before constructing the URI?", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r479553950", "createdAt": "2020-08-28T22:05:59Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -174,9 +174,14 @@ private String buildURL() {\n \n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n-\n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n+            String getQuery = \"\";\n+            if( parsedUrl.getQuery() != null ) {\n+                getQuery = \"?\" + parsedUrl.getQuery();\n+            }\n+            String constructedURI = new URI(\n+                    parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n+                    parsedUrl.getPath(), null, parsedUrl.getRef()).toString() + getQuery;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2737afd0198107e55f1f716f2178858cfa1a0ab"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca5d7c31772d4361cf10d807d9ada17afc88c259", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/ca5d7c31772d4361cf10d807d9ada17afc88c259", "committedDate": "2020-08-28T22:09:28Z", "message": "add fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5dfaebdebb31122ac77c3ecb90cb63dd34ae7e61", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/5dfaebdebb31122ac77c3ecb90cb63dd34ae7e61", "committedDate": "2020-08-28T22:17:48Z", "message": "remove logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef6c2d2826b1900f6d350aff6cbfd2b779d267fe", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/ef6c2d2826b1900f6d350aff6cbfd2b779d267fe", "committedDate": "2020-08-28T22:34:35Z", "message": "Merge branch 'main' into 569-paging-bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NzU3NzU5", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-478757759", "createdAt": "2020-08-31T16:21:59Z", "commit": {"oid": "ef6c2d2826b1900f6d350aff6cbfd2b779d267fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoyMTo1OVrOHJ_mSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoyMTo1OVrOHJ_mSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDI0MTIyNg==", "bodyText": "new URI().toString() from a new URI().toString()? This looks even more overly-complicated. Can we just drop the usage of URI and construct the URL similar to what we do in other languages?", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r480241226", "createdAt": "2020-08-31T16:21:59Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -174,9 +174,18 @@ private String buildURL() {\n \n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n-\n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n+            String getQuery = \"\";\n+            if( parsedUrl.getQuery() != null ) {\n+                getQuery = \"?\" + parsedUrl.getQuery();\n+            }\n+            String getFragment = \"\";\n+            if( parsedUrl.getRef() != null ) {\n+                getFragment = \"#\" + parsedUrl.getRef();\n+            }\n+            String constructedURI = new URI(\n+                    parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n+                    parsedUrl.getPath(), null,null).toString() + getQuery + getFragment;\n+            return new URI(constructedURI).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6c2d2826b1900f6d350aff6cbfd2b779d267fe"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4511139ed393b429815dd8ee2da6e66e62b6dcff", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/4511139ed393b429815dd8ee2da6e66e62b6dcff", "committedDate": "2020-09-01T18:38:09Z", "message": "build the URL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d0e87c5a7d137b16e96d4126d2dcb7fbab32458", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/6d0e87c5a7d137b16e96d4126d2dcb7fbab32458", "committedDate": "2020-09-01T18:40:31Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775", "author": {"user": {"login": "childish-sambino", "name": null}}, "url": "https://github.com/twilio/twilio-java/commit/be4f84d3a15b8c63ecdeea13ea94308b14abd775", "committedDate": "2020-09-04T15:25:34Z", "message": "Merge branch 'main' into 569-paging-bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNzQ4NzY1", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-482748765", "createdAt": "2020-09-04T15:25:56Z", "commit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNToyNTo1N1rOHNR_sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNTozMDoxN1rOHNSNLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY4ODM2OA==", "bodyText": "Nooooooooo", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r483688368", "createdAt": "2020-09-04T15:25:57Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -284,7 +299,6 @@ private static String encodeParameters(final Map<String, List<String>> params) {\n                     if (value == null) {\n                         continue;\n                     }\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY4OTAyOQ==", "bodyText": "This var isn't needed.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r483689029", "createdAt": "2020-09-04T15:27:06Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +175,24 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            int port = -1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY5MTIxMQ==", "bodyText": "Does this handle URLs with embedded credentials.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r483691211", "createdAt": "2020-09-04T15:29:39Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +175,24 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            int port = -1;\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                port = parsedUrl.getPort();\n+                urlPort = \":\" + port;\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String path = parsedUrl.getPath().replace(\"|\", \"%7C\");\n+            String query = null;\n+            if (parsedUrl.getQuery() != null) {\n+                query = \"?\" + parsedUrl.getQuery();\n+            }\n+            String ref = null;\n+            if (parsedUrl.getRef() != null) {\n+                ref = \"#\" + parsedUrl.getRef();\n+            }\n+            return joinIgnoreNull(\"\", protocol, host, urlPort, path, query, ref);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY5MTgyMQ==", "bodyText": "This needs to use a proper encoder. There are many other characters that it would cover.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r483691821", "createdAt": "2020-09-04T15:30:17Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +175,24 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            int port = -1;\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                port = parsedUrl.getPort();\n+                urlPort = \":\" + port;\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String path = parsedUrl.getPath().replace(\"|\", \"%7C\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be4f84d3a15b8c63ecdeea13ea94308b14abd775"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26c8f6b47ba76494702b225de893322d159b193e", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/26c8f6b47ba76494702b225de893322d159b193e", "committedDate": "2020-09-08T22:10:48Z", "message": "Merge branch 'main' of https://github.com/twilio/twilio-java into 569-paging-bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccc351781bb274bb0d832b1591cf12e651e52e17", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/ccc351781bb274bb0d832b1591cf12e651e52e17", "committedDate": "2020-09-08T23:11:00Z", "message": "add credentails, user proper encoder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5acba8da96c60a7cbb0d9fd62cf15f14508120d", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/e5acba8da96c60a7cbb0d9fd62cf15f14508120d", "committedDate": "2020-09-08T23:11:15Z", "message": "Merge branch '569-paging-bug' of https://github.com/twilio/twilio-java into 569-paging-bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1da78503519aa5427ee2efa07820ec8ff09b7f24", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/1da78503519aa5427ee2efa07820ec8ff09b7f24", "committedDate": "2020-09-08T23:12:40Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36e94674b13366ed4272599b555e42c216ece26e", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/36e94674b13366ed4272599b555e42c216ece26e", "committedDate": "2020-09-08T23:17:48Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14e2a314df79e3d1388e3bde760f8201f6a146ba", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/14e2a314df79e3d1388e3bde760f8201f6a146ba", "committedDate": "2020-09-08T23:19:16Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a774590e3b09fdf8eb2d2b63ffa097bb91e2e6b", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/7a774590e3b09fdf8eb2d2b63ffa097bb91e2e6b", "committedDate": "2020-09-08T23:19:51Z", "message": "Update pom.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92c7ee6034716bf3651fac24ce37391fe17f0f8c", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/92c7ee6034716bf3651fac24ce37391fe17f0f8c", "committedDate": "2020-09-08T23:39:35Z", "message": "revert to java 7 friendly joiner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d080a42ef502f9ba40a5c0ef6281beb7e4c443e7", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/d080a42ef502f9ba40a5c0ef6281beb7e4c443e7", "committedDate": "2020-09-08T23:43:46Z", "message": "fix apache dependency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2ODk4MjUy", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-486898252", "createdAt": "2020-09-11T15:16:06Z", "commit": {"oid": "d080a42ef502f9ba40a5c0ef6281beb7e4c443e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNToxNjowNlrOHQjGRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNToxNjowNlrOHQjGRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzExNDMwOA==", "bodyText": "I don't like adding new dependencies when existing dependencies will do the job.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r487114308", "createdAt": "2020-09-11T15:16:06Z", "author": {"login": "childish-sambino"}, "path": "pom.xml", "diffHunk": "@@ -228,6 +228,11 @@\n       <version>3.4.1</version>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>commons-lang</groupId>\n+      <artifactId>commons-lang</artifactId>\n+      <version>2.4</version>\n+    </dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d080a42ef502f9ba40a5c0ef6281beb7e4c443e7"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85283077c8cf9ca0ce45afad981ec62ede2163a7", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/85283077c8cf9ca0ce45afad981ec62ede2163a7", "committedDate": "2020-09-15T04:52:02Z", "message": "revert to guava joiner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0bc241f52c7be29f0d5e43d35b9ffff87180938", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/b0bc241f52c7be29f0d5e43d35b9ffff87180938", "committedDate": "2020-09-15T04:52:41Z", "message": "revert to guava joiner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MTg1ODYx", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-489185861", "createdAt": "2020-09-16T00:02:09Z", "commit": {"oid": "b0bc241f52c7be29f0d5e43d35b9ffff87180938"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMDowMjowOVrOHSbUNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMDowMjowOVrOHSbUNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA4Mzk1Nw==", "bodyText": "Simplify these for readability: String query = parsedUrl.getQuery() != null ? \"?\" + parsedUrl.getQuery() : null;", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r489083957", "createdAt": "2020-09-16T00:02:09Z", "author": {"login": "eshanholtz"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,28 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String[] pathPieces = parsedUrl.getPath().split(\"/\", 0);\n+            pathPieces[pathPieces.length-1] = URLEncoder.encode(pathPieces[pathPieces.length-1], \"UTF-8\");\n+            String encodedPath = Joiner.on(\"/\").join(pathPieces);\n+            String query = null;\n+            if (parsedUrl.getQuery() != null) {\n+                query = \"?\" + parsedUrl.getQuery();\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0bc241f52c7be29f0d5e43d35b9ffff87180938"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "380c84cf831a92765ab1182162dd0ce72b74f926", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/380c84cf831a92765ab1182162dd0ce72b74f926", "committedDate": "2020-09-16T05:28:32Z", "message": "simplifications"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNjg4Mzg5", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-490688389", "createdAt": "2020-09-17T14:55:16Z", "commit": {"oid": "380c84cf831a92765ab1182162dd0ce72b74f926"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDo1NToxNlrOHTmrQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDo1NTo0MlrOHTmsxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMxODY1OQ==", "bodyText": "I don't understand this pathPieces logic. Needs a comment.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r490318659", "createdAt": "2020-09-17T14:55:16Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,19 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String[] pathPieces = parsedUrl.getPath().split(\"/\", 0);\n+            pathPieces[pathPieces.length-1] = URLEncoder.encode(pathPieces[pathPieces.length-1], \"UTF-8\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "380c84cf831a92765ab1182162dd0ce72b74f926"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMxOTA0NQ==", "bodyText": "Spacing looks off. Are you using IntelliJ to format?", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r490319045", "createdAt": "2020-09-17T14:55:42Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,19 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String[] pathPieces = parsedUrl.getPath().split(\"/\", 0);\n+            pathPieces[pathPieces.length-1] = URLEncoder.encode(pathPieces[pathPieces.length-1], \"UTF-8\");\n+            String encodedPath = Joiner.on(\"/\").join(pathPieces);\n+            String query = parsedUrl.getQuery() != null ? \"?\" + parsedUrl.getQuery() : null;\n+            String ref = parsedUrl.getRef() != null ? \"#\" + parsedUrl.getRef() : null;\n+            String credentials  = parsedUrl.getUserInfo() != null ? parsedUrl.getUserInfo() + \"@\" : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "380c84cf831a92765ab1182162dd0ce72b74f926"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70770a86f5b8d6b51f68562c2e551004298031f4", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/70770a86f5b8d6b51f68562c2e551004298031f4", "committedDate": "2020-09-17T15:11:41Z", "message": "add comment, formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e25c5d1ef274c27d3dc8ffd402120def87b5506", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/4e25c5d1ef274c27d3dc8ffd402120def87b5506", "committedDate": "2020-09-17T15:13:57Z", "message": "Merge branch 'main' into 569-paging-bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwOTA3NjQy", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-490907642", "createdAt": "2020-09-17T19:14:15Z", "commit": {"oid": "4e25c5d1ef274c27d3dc8ffd402120def87b5506"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxOToxNDoxNVrOHTxaVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxOToxNTo0OFrOHTxd0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5NDU1MQ==", "bodyText": "Default limit is already 0 so second arg not needed.", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r490494551", "createdAt": "2020-09-17T19:14:15Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,20 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String[] pathPieces = parsedUrl.getPath().split(\"/\", 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e25c5d1ef274c27d3dc8ffd402120def87b5506"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5NTQ0MQ==", "bodyText": "So if you have /foo|bar/baz|qux only baz/qux gets encoded?", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r490495441", "createdAt": "2020-09-17T19:15:48Z", "author": {"login": "childish-sambino"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,19 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }\n+            String protocol = parsedUrl.getProtocol() + \"://\";\n+            String[] pathPieces = parsedUrl.getPath().split(\"/\", 0);\n+            pathPieces[pathPieces.length-1] = URLEncoder.encode(pathPieces[pathPieces.length-1], \"UTF-8\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMxODY1OQ=="}, "originalCommit": {"oid": "380c84cf831a92765ab1182162dd0ce72b74f926"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b033626650c686922f3912f1f2fdd14563b1560", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/1b033626650c686922f3912f1f2fdd14563b1560", "committedDate": "2020-09-17T19:36:34Z", "message": "remove uncessary param"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d1e3a07a6beac9e1022e05fbc9e2498bf667119", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/1d1e3a07a6beac9e1022e05fbc9e2498bf667119", "committedDate": "2020-09-17T19:36:47Z", "message": "Merge branch '569-paging-bug' of https://github.com/twilio/twilio-java into 569-paging-bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "908953b80ecdc7030fa7995229b21abc331b1d73", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/908953b80ecdc7030fa7995229b21abc331b1d73", "committedDate": "2020-09-17T19:47:07Z", "message": "encode all pieces of the path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwOTM1NDg2", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-490935486", "createdAt": "2020-09-17T19:49:12Z", "commit": {"oid": "908953b80ecdc7030fa7995229b21abc331b1d73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeda0b263ab173e741adf56c8d3807ae02499bca", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/aeda0b263ab173e741adf56c8d3807ae02499bca", "committedDate": "2020-09-17T19:51:00Z", "message": "Merge branch 'main' into 569-paging-bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwOTcxMDU3", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-490971057", "createdAt": "2020-09-17T20:38:10Z", "commit": {"oid": "aeda0b263ab173e741adf56c8d3807ae02499bca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMDozODoxMFrOHT0quA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMDozODoxMFrOHT0quA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU0Nzg5Ng==", "bodyText": "Could do one more simplification here similar to below:\nString urlPort = parsedUrl.getPort() != -1 ? \":\" + parsedUrl.getPort() : null;", "url": "https://github.com/twilio/twilio-java/pull/571#discussion_r490547896", "createdAt": "2020-09-17T20:38:10Z", "author": {"login": "eshanholtz"}, "path": "src/main/java/com/twilio/http/Request.java", "diffHunk": "@@ -175,9 +176,21 @@ private String buildURL() {\n                 host = joinIgnoreNull(\".\", product, targetEdge, targetRegion, domain);\n             }\n \n-            return new URI(parsedUrl.getProtocol(), parsedUrl.getUserInfo(), host, parsedUrl.getPort(),\n-                    parsedUrl.getPath(), parsedUrl.getQuery(), parsedUrl.getRef()).toURL().toString();\n-        } catch (final MalformedURLException | URISyntaxException e) {\n+            String urlPort = null;\n+            if (parsedUrl.getPort() != -1) {\n+                urlPort = \":\" + parsedUrl.getPort();\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aeda0b263ab173e741adf56c8d3807ae02499bca"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "958a5588c12827e2d892cace357d7563d9e2bfc2", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/958a5588c12827e2d892cace357d7563d9e2bfc2", "committedDate": "2020-09-17T21:03:04Z", "message": "simplification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f973e481b9ebc2912b3326778f9365bc8da2eb48", "author": {"user": {"login": "thinkingserious", "name": "Elmer Thomas"}}, "url": "https://github.com/twilio/twilio-java/commit/f973e481b9ebc2912b3326778f9365bc8da2eb48", "committedDate": "2020-09-17T21:03:16Z", "message": "Merge branch '569-paging-bug' of https://github.com/twilio/twilio-java into 569-paging-bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwOTkyODU4", "url": "https://github.com/twilio/twilio-java/pull/571#pullrequestreview-490992858", "createdAt": "2020-09-17T21:12:43Z", "commit": {"oid": "f973e481b9ebc2912b3326778f9365bc8da2eb48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3136, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}