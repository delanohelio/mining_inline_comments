{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MzQ1NTE0", "number": 5360, "title": "Fix crafter", "bodyText": "Closes #5354\nCloses #5351\nCloses #5350\nCloses #5322\nChanges proposed in this pull request:\n\nFix crafrer issues\nFix memory leak\n\n\nReview please", "createdAt": "2020-07-08T16:12:26Z", "url": "https://github.com/ldtteam/minecolonies/pull/5360", "merged": true, "mergeCommit": {"oid": "d0c390dc50687eedb47c4ceed0682699ee15788b"}, "closed": true, "closedAt": "2020-07-09T11:34:15Z", "author": {"login": "Raycoms"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcySdR1AH2gAyNDQ2MzQ1NTE0OjkwOWE4Y2E3NjJjNjM5Yzk3YmJlODgwYmUxNzY4NDk2Mzg1NGYwZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczBOyygFqTQ0NTEzODUxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "909a8ca762c639c97bbe880be17684963854f0d3", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/909a8ca762c639c97bbe880be17684963854f0d3", "committedDate": "2020-07-06T14:52:34Z", "message": "try mark dirty here"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bbfb1e0a2078c0727a6b35f953f2da44b3e327f", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/4bbfb1e0a2078c0727a6b35f953f2da44b3e327f", "committedDate": "2020-07-06T16:28:34Z", "message": "Some crafting fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcc33b4058c818d0c905d57a347d14a93ee1bf7f", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/dcc33b4058c818d0c905d57a347d14a93ee1bf7f", "committedDate": "2020-07-07T08:20:17Z", "message": "improve performance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d61fbd27ad43342c8abebac98a95af0090e930b8", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/d61fbd27ad43342c8abebac98a95af0090e930b8", "committedDate": "2020-07-07T08:20:33Z", "message": "Merge remote-tracking branch 'origin/version/1.15' into dman-imp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc213d7b16db21ee5d5cb5cccd11a1e193a4745f", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/fc213d7b16db21ee5d5cb5cccd11a1e193a4745f", "committedDate": "2020-07-07T08:45:56Z", "message": "fix this"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9c8bc780932d5b82378b0070754ffb4867642bb", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/e9c8bc780932d5b82378b0070754ffb4867642bb", "committedDate": "2020-07-07T13:22:56Z", "message": "oopsy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17765d99da0b4ad3d4e37696817a911742944904", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/17765d99da0b4ad3d4e37696817a911742944904", "committedDate": "2020-07-07T13:36:15Z", "message": "fix this"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4505b7c8c96e1d63b29e131ff1edf6d07248bc4c", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/4505b7c8c96e1d63b29e131ff1edf6d07248bc4c", "committedDate": "2020-07-08T15:12:13Z", "message": "fix memory leak"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4cf0dfd5a52602fcc67235a3833c06dc8cceb5b", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/a4cf0dfd5a52602fcc67235a3833c06dc8cceb5b", "committedDate": "2020-07-08T16:05:12Z", "message": "fix crafter issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08387f11cac0e169e772560ac85dd00d19a5580a", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/08387f11cac0e169e772560ac85dd00d19a5580a", "committedDate": "2020-07-08T16:05:15Z", "message": "Merge remote-tracking branch 'origin/version/1.15' into dman-imp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00efa1a3d73546d7f6edce801036053fbe804814", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/00efa1a3d73546d7f6edce801036053fbe804814", "committedDate": "2020-07-08T16:06:17Z", "message": "wrong sign"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0OTI4MDMw", "url": "https://github.com/ldtteam/minecolonies/pull/5360#pullrequestreview-444928030", "createdAt": "2020-07-08T16:20:00Z", "commit": {"oid": "4505b7c8c96e1d63b29e131ff1edf6d07248bc4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNjoyMDowMFrOGuvnbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNjoyMDowMFrOGuvnbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY2NzgyMA==", "bodyText": "getCompletedRequestsByCitizen().computeIfAbsent(citizenThatRequested, ArrayList::new).add(request.getId());", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451667820", "createdAt": "2020-07-08T16:20:00Z", "author": {"login": "MatthiasMann"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuilding.java", "diffHunk": "@@ -1507,11 +1507,14 @@ public void onRequestedRequestComplete(@NotNull final IRequestManager manager, @\n             getOpenRequestsByRequestableType().remove(TypeToken.of(request.getRequest().getClass()));\n         }\n \n-        if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+        if (citizenThatRequested != 0)\n         {\n-            getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+            {\n+                getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            }\n+            getCompletedRequestsByCitizen().get(citizenThatRequested).add(request.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4505b7c8c96e1d63b29e131ff1edf6d07248bc4c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b429f5512d5fe5f2b45284add0f9bc2a5c0cea6", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/1b429f5512d5fe5f2b45284add0f9bc2a5c0cea6", "committedDate": "2020-07-08T16:25:50Z", "message": "fix #5322"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0OTM0MzM1", "url": "https://github.com/ldtteam/minecolonies/pull/5360#pullrequestreview-444934335", "createdAt": "2020-07-08T16:27:32Z", "commit": {"oid": "00efa1a3d73546d7f6edce801036053fbe804814"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e58139e0172e4837d2229160e15d743dd5356336", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/e58139e0172e4837d2229160e15d743dd5356336", "committedDate": "2020-07-08T16:31:27Z", "message": "adjust to review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "460c5662c9f43fb860ea2a5dbe8bf74dd089a009", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/460c5662c9f43fb860ea2a5dbe8bf74dd089a009", "committedDate": "2020-07-08T16:42:22Z", "message": "same for fuel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/3f82a21f120e96a2e750fb6c9a8ab449d1499035", "committedDate": "2020-07-08T18:09:05Z", "message": "fix buckets and pickup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MDIwMzYz", "url": "https://github.com/ldtteam/minecolonies/pull/5360#pullrequestreview-445020363", "createdAt": "2020-07-08T18:20:46Z", "commit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxODoyMDo0N1rOGu0Ciw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxODoyMDo0N1rOGu0Ciw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc0MDI5OQ==", "bodyText": "think this should only reduce if the addItemStackToItemHandler is successfull", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451740299", "createdAt": "2020-07-08T18:20:47Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -1776,21 +1776,16 @@ public static int transferXOfFirstSlotInItemHandlerWithIntoNextFreeSlotInItemHan\n                 break;\n             }\n \n-\n             final ItemStack returnStack = sourceHandler.extractItem(desiredItemSlot, currentAmount, false);\n \n             if (!ItemStackUtils.isEmpty(returnStack))\n             {\n                 if (!InventoryUtils.addItemStackToItemHandler(targetHandler, returnStack))\n                 {\n-                    sourceHandler.insertItem(desiredItemSlot, returnStack, false);\n                     break;\n                 }\n                 // Only reduce if successfully inserted.\n-                else\n-                {\n-                    currentAmount -= returnStack.getCount();\n-                }\n+                currentAmount -= returnStack.getCount();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d507e2c2fe3086eaeae3431417a3c1dc581b9571", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/d507e2c2fe3086eaeae3431417a3c1dc581b9571", "committedDate": "2020-07-08T21:09:25Z", "message": "Try this"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MTM4NTEz", "url": "https://github.com/ldtteam/minecolonies/pull/5360#pullrequestreview-445138513", "createdAt": "2020-07-08T21:22:17Z", "commit": {"oid": "d507e2c2fe3086eaeae3431417a3c1dc581b9571"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1967, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}