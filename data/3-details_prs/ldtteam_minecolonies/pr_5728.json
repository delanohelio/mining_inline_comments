{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwOTE4MjI1", "number": 5728, "title": "Improve tool usage in the cook and other crafters", "bodyText": "Changes proposed in this pull request:\n\nfix tool usage for larger stacks during crafting\nadd haybale decompression to farmer\nbit of cleanup here and there.\nMake compost a bit cheaper\nfix ingredient resolution for cookable foods - prestock of cookables should work now.\n\nReview please", "createdAt": "2020-09-06T22:43:42Z", "url": "https://github.com/ldtteam/minecolonies/pull/5728", "merged": true, "mergeCommit": {"oid": "eeea288c5d63086c8532d86e33725fad870820db"}, "closed": true, "closedAt": "2020-09-08T19:22:03Z", "author": {"login": "Mekle001"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGWRKHAH2gAyNDgwOTE4MjI1OjQzZDBkZDlmMzI5MzZmODllNDQ3MGExMjUyMmFjNGQyMzRmNzZhMzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdG7LpVAFqTQ4NDM1Nzk4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "43d0dd9f32936f89e4470a12522ac4d234f76a39", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/43d0dd9f32936f89e4470a12522ac4d234f76a39", "committedDate": "2020-09-06T22:37:26Z", "message": "Improve tool handling during crafting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0917a80931fb84d9d6db7ef10f9c9c32c38c681c", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/0917a80931fb84d9d6db7ef10f9c9c32c38c681c", "committedDate": "2020-09-06T22:37:44Z", "message": "reduce the item count needed for compost"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "001aac64c76453624124d43ead0ffd96e32f50cc", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/001aac64c76453624124d43ead0ffd96e32f50cc", "committedDate": "2020-09-06T22:38:08Z", "message": "Bit of cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b7934432cad125c91ff2e2b37b1398de40f5c82", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/5b7934432cad125c91ff2e2b37b1398de40f5c82", "committedDate": "2020-09-06T22:38:33Z", "message": "decompress hay"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMTgwNDc2", "url": "https://github.com/ldtteam/minecolonies/pull/5728#pullrequestreview-483180476", "createdAt": "2020-09-06T23:18:40Z", "commit": {"oid": "5b7934432cad125c91ff2e2b37b1398de40f5c82"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQyMzoxODo0MFrOHNssJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQyMzoxODo0MFrOHNssJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEyNTczNQ==", "bodyText": "I think you want to copy this stack before modifying it? else the \"recipe\" objects output stack might get changed for further uses", "url": "https://github.com/ldtteam/minecolonies/pull/5728#discussion_r484125735", "createdAt": "2020-09-06T23:18:40Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/util/FurnaceRecipes.java", "diffHunk": "@@ -55,16 +54,13 @@ private void loadRecipes(final MinecraftServer server)\n             final NonNullList<Ingredient> list = recipe.getIngredients();\n             if (list.size() == 1)\n             {\n-                for (final ItemStack stack : list.get(0).getMatchingStacks())\n-                {\n-                    final RecipeStorage storage = new RecipeStorage(new StandardToken(), Collections.singletonList(stack), 1, recipe.getRecipeOutput(), Blocks.FURNACE);\n+                final RecipeStorage storage = new RecipeStorage(new StandardToken(), Arrays.asList(list.get(0).getMatchingStacks()), 1, recipe.getRecipeOutput(), Blocks.FURNACE);\n \n-                    recipes.put(new ItemStorage(stack), storage);\n+                recipes.put(storage.getCleanedInput().get(0), storage);\n \n-                    final ItemStack output = recipe.getRecipeOutput();\n-                    output.setCount(1);\n-                    reverseRecipes.put(new ItemStorage(output), storage);\n-                }\n+                final ItemStack output = recipe.getRecipeOutput();\n+                output.setCount(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b7934432cad125c91ff2e2b37b1398de40f5c82"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7a6c21cdb0ef4738d915d64a296b1938e96a53e", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/f7a6c21cdb0ef4738d915d64a296b1938e96a53e", "committedDate": "2020-09-07T03:12:38Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "817fbc71a1ee8e6aa6c037e3321c2f4ffecc87df", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/817fbc71a1ee8e6aa6c037e3321c2f4ffecc87df", "committedDate": "2020-09-07T04:23:34Z", "message": "Fix resolution, and clean up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbaedcae6bc82089d9bfccd2b7a22d3e79bf7b68", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/bbaedcae6bc82089d9bfccd2b7a22d3e79bf7b68", "committedDate": "2020-09-07T16:25:42Z", "message": "Merge branch 'version/1.15' into improve/misc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79dd1645c8606ba50d4d4a36704c85581a92bedb", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/79dd1645c8606ba50d4d4a36704c85581a92bedb", "committedDate": "2020-09-07T17:03:20Z", "message": "Cleanup for clarity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f84e51892d6bffe82436a54dee8384a8bb2fc659", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/f84e51892d6bffe82436a54dee8384a8bb2fc659", "committedDate": "2020-09-07T17:03:48Z", "message": "Fix ingredient resolution of coocables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "025baab7f8a56e9fe0a1f94f59b9c1fc7c8d8735", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/025baab7f8a56e9fe0a1f94f59b9c1fc7c8d8735", "committedDate": "2020-09-08T13:40:35Z", "message": "Merge branch 'version/1.15' into improve/misc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "967499df38092bd77e5cd7a649d729a61190a0fe", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/967499df38092bd77e5cd7a649d729a61190a0fe", "committedDate": "2020-09-08T13:45:48Z", "message": "Remove unnecessary check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9", "committedDate": "2020-09-08T14:19:33Z", "message": "cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MjUxMDA3", "url": "https://github.com/ldtteam/minecolonies/pull/5728#pullrequestreview-484251007", "createdAt": "2020-09-08T15:21:37Z", "commit": {"oid": "4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNToyMTozN1rOHOiXhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNToyMTozN1rOHOiXhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAwNTE4OA==", "bodyText": "Will the cook keep all container items for forever? 20 buckets of milk or water too?", "url": "https://github.com/ldtteam/minecolonies/pull/5728#discussion_r485005188", "createdAt": "2020-09-08T15:21:37Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -103,6 +104,7 @@ public BuildingCook(final IColony c, final BlockPos l)\n         keepX.put(ItemStackUtils.ISFOOD, new Tuple<>(STACKSIZE, true));\n         keepX.put(ItemStackUtils.ISCOOKABLE, new Tuple<>(STACKSIZE, true));\n         keepX.put(stack -> isAllowedFuel(stack), new Tuple<>(STACKSIZE, true));\n+        keepX.put(stack -> !ItemStackUtils.isEmpty(stack.getContainerItem()), new Tuple<>(STACKSIZE, false));\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MjUyMDUy", "url": "https://github.com/ldtteam/minecolonies/pull/5728#pullrequestreview-484252052", "createdAt": "2020-09-08T15:22:50Z", "commit": {"oid": "4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNToyMjo1MFrOHOiawQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNToyMjo1MFrOHOiawQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAwNjAxNw==", "bodyText": "\"i\" might be bad, better stack", "url": "https://github.com/ldtteam/minecolonies/pull/5728#discussion_r485006017", "createdAt": "2020-09-08T15:22:50Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/cook/EntityAIWorkCook.java", "diffHunk": "@@ -271,16 +271,16 @@ protected IAIState checkForImportantJobs()\n             citizenToServe.addAll(citizenList);\n             playerToServe.addAll(playerList);\n \n-            if (InventoryUtils.hasItemInItemHandler(worker.getInventoryCitizen(), ItemStackUtils.CAN_EAT))\n+            if (InventoryUtils.hasItemInItemHandler(worker.getInventoryCitizen(), i -> ItemStackUtils.CAN_EAT.test(i) && !getOwnBuilding().isItemStackInRequest(i)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f2a9f6dcf7aeabb87d8ef57d3dece85fa33a5a9"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d46961018531bc85ff004876ad1a001e929ef6db", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/d46961018531bc85ff004876ad1a001e929ef6db", "committedDate": "2020-09-08T15:37:56Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0cfea64824ab84b9b34038fc4a40cd75f0641aa", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/c0cfea64824ab84b9b34038fc4a40cd75f0641aa", "committedDate": "2020-09-08T17:06:29Z", "message": "Stabilize Charcoal burning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzU3OTgw", "url": "https://github.com/ldtteam/minecolonies/pull/5728#pullrequestreview-484357980", "createdAt": "2020-09-08T17:37:54Z", "commit": {"oid": "c0cfea64824ab84b9b34038fc4a40cd75f0641aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1916, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}