{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3ODY1OTkz", "number": 5699, "title": "Add Min/max level of building to custom recipes", "bodyText": "Changes proposed in this pull request:\n\nChange validity check to take building rather than colony\nCheck building level against min and max levels\nFix the recipe removal code to queue removals during load, and execute on first access after load\nTweak XP pickup code to force-pickup within the larger range if it's tried for 5 seconds and failed.\n\nReview please", "createdAt": "2020-09-02T14:36:42Z", "url": "https://github.com/ldtteam/minecolonies/pull/5699", "merged": true, "mergeCommit": {"oid": "88f386be983841d55133ac381c9b5ff3929b2b9e"}, "closed": true, "closedAt": "2020-09-02T15:32:14Z", "author": {"login": "Mekle001"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE83mbAH2gAyNDc3ODY1OTkzOjY5MmUzYmZhYTFiYWI5N2E0YWJiNGZhMmZkOGNiNTU3NDIwZGFlMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE9wylAFqTQ4MDk0MzgxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "692e3bfaa1bab97a4abb4fa2fd8cb557420dae07", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/692e3bfaa1bab97a4abb4fa2fd8cb557420dae07", "committedDate": "2020-09-02T14:27:58Z", "message": "add building min and max level to custom recipes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4560afe0d18baebe1a1d6b86f1d02eab9c76d615", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/4560afe0d18baebe1a1d6b86f1d02eab9c76d615", "committedDate": "2020-09-02T14:28:31Z", "message": "Fix recipe removal in custom recipes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc2b3c6ccef9dc9d785d169edbf57807892585b0", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/dc2b3c6ccef9dc9d785d169edbf57807892585b0", "committedDate": "2020-09-02T14:33:44Z", "message": "Make citizen XP pickup try 5 times and force"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "334b249ffab6dcf56f45bc445afc5fab7a03dcfe", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/334b249ffab6dcf56f45bc445afc5fab7a03dcfe", "committedDate": "2020-09-02T14:54:59Z", "message": "Fix bad default recruitment item"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTA2NjQz", "url": "https://github.com/ldtteam/minecolonies/pull/5699#pullrequestreview-480906643", "createdAt": "2020-09-02T14:55:43Z", "commit": {"oid": "dc2b3c6ccef9dc9d785d169edbf57807892585b0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNDo1NTo0M1rOHLzK7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNDo1NTo0M1rOHLzK7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEzNDc2Ng==", "bodyText": "isnt that the same as recipeMap.get(toRemove)?", "url": "https://github.com/ldtteam/minecolonies/pull/5699#discussion_r482134766", "createdAt": "2020-09-02T14:55:43Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/crafting/CustomRecipeManager.java", "diffHunk": "@@ -85,6 +89,19 @@ public void removeRecipe(@NotNull final JsonObject recipeJson, @NotNull final Re\n      */\n     public Set<CustomRecipe> getRecipes(@NotNull final String crafter)\n     {\n+        if(!removedRecipes.isEmpty())\n+        {\n+            for(ResourceLocation toRemove: removedRecipes)\n+            {\n+                final Optional<HashMap<ResourceLocation, CustomRecipe>> crafterMap = recipeMap.entrySet().stream().map(r -> r.getValue()).filter(r1 -> r1.keySet().contains(toRemove)).findFirst();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2b3c6ccef9dc9d785d169edbf57807892585b0"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTQzODE5", "url": "https://github.com/ldtteam/minecolonies/pull/5699#pullrequestreview-480943819", "createdAt": "2020-09-02T15:30:26Z", "commit": {"oid": "334b249ffab6dcf56f45bc445afc5fab7a03dcfe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1899, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}