{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTI2NDg3", "number": 5383, "title": "Upgrade the cook, and a few more recipes", "bodyText": "Closes #5276\nChanges proposed in this pull request:\n\nThe cook will try to resolve furnace recipes (for food) without being taught.\nThe cook has a new assistant who does all the crafting, leaving the cook to focus on serving the colony, and basic cooking.\nThe cook's assistant is able to be hired at building level 3\nThe cook (and other crafters) will better handle secondary outputs for recipes. (1 pot for a full stack of output!)\nThe cook will now stop 'auto smelting' food while working on specific recipes, to avoid stealing from itself\nEnable the crusher to convert/decompress clay blocks into clay balls - Bricks, bricks galore!\nThe farmer is now capable of learning the composted dirt recipe\nAll pressure plates are now crafted at the mechanic. As a 2x2 recipe, the builders can also craft for themselves.\nMiscellaneous cleanup of unnecessary imports, as a result of my previous changes.\n\nReview please", "createdAt": "2020-07-13T22:17:17Z", "url": "https://github.com/ldtteam/minecolonies/pull/5383", "merged": true, "mergeCommit": {"oid": "81f9adfce133b06637050332050c2a28b1cb1f1b"}, "closed": true, "closedAt": "2020-07-28T18:21:12Z", "author": {"login": "Mekle001"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0h0LMAH2gAyNDQ4NTI2NDg3OjUxZTdmYWJmYmE3MWU4Y2NjN2FkNzk4YmE5NGJhM2U0ZGIyNDZhZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5JAWzAFqTQ1NjE2MDE1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "51e7fabfba71e8ccc7ad798ba94ba3e4db246ad0", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/51e7fabfba71e8ccc7ad798ba94ba3e4db246ad0", "committedDate": "2020-07-13T13:54:00Z", "message": "Move pressure plates to Mechanic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b6c6b5b5b9069c08527c39cb7ccad754a76ea1b", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/6b6c6b5b5b9069c08527c39cb7ccad754a76ea1b", "committedDate": "2020-07-13T13:54:25Z", "message": "Add Composted Dirt to farmer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a24e2226fe3f8c55b2e3899b9ba18cbc1d008d3c", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/a24e2226fe3f8c55b2e3899b9ba18cbc1d008d3c", "committedDate": "2020-07-13T13:57:41Z", "message": "Clean up unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd702bc9018f8b06668d892b538802b8e9edaf72", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/fd702bc9018f8b06668d892b538802b8e9edaf72", "committedDate": "2020-07-13T14:04:04Z", "message": "More import cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c23f4f0fbe62ef1a004835e624a07f3c1ab784e9", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/c23f4f0fbe62ef1a004835e624a07f3c1ab784e9", "committedDate": "2020-07-13T22:06:36Z", "message": "Add clay block to clay ball conversion to crusher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78857d4d9a50e6124165b41ae9b493b3a3d541b5", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/78857d4d9a50e6124165b41ae9b493b3a3d541b5", "committedDate": "2020-07-13T22:07:21Z", "message": "Enhance cook for smeltable recipes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e92403c6ab7b0f66584dad31a65ccd8f0eb5114d", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/e92403c6ab7b0f66584dad31a65ccd8f0eb5114d", "committedDate": "2020-07-13T22:08:18Z", "message": "Enable crafters to better handle 'tools' like pots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60f20a13b9563a32f73a005cd0ce49b2b1435dd8", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/60f20a13b9563a32f73a005cd0ce49b2b1435dd8", "committedDate": "2020-07-13T22:08:49Z", "message": "Keep Cook from processing ingredients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e082f0be87813e34b6a515895602b3f5255dbe97", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/e082f0be87813e34b6a515895602b3f5255dbe97", "committedDate": "2020-07-14T03:41:43Z", "message": "Fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODY5MzEw", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-447869310", "createdAt": "2020-07-14T07:49:08Z", "commit": {"oid": "e082f0be87813e34b6a515895602b3f5255dbe97"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo0OTowOFrOGxISuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo0OTowOFrOGxISuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE2OTI3NQ==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r454169275", "createdAt": "2020-07-14T07:49:08Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCrusher.java", "diffHunk": "@@ -123,6 +127,30 @@ private void loadCrusherMode()\n         }\n     }\n \n+    private void loadCurrentRecipes()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e082f0be87813e34b6a515895602b3f5255dbe97"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODcwODM3", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-447870837", "createdAt": "2020-07-14T07:51:24Z", "commit": {"oid": "e082f0be87813e34b6a515895602b3f5255dbe97"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo1MToyNFrOGxIXqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNzo1MToyNFrOGxIXqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDE3MDUzNg==", "bodyText": "I'm nt a fan at all of this. Adding a lot of automatic recipes slows down the colony (each time a request is executed all recipes have to be checked). Why do we need this explicitly?", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r454170536", "createdAt": "2020-07-14T07:51:24Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -175,6 +182,34 @@ public boolean canBeGathered()\n         return toKeep;\n     }\n \n+    // Adding request system aware versions of the furnace recipes, to make keeping stock easier, and allow crafting chains. \n+    // To find what to add, we'll run through the predefined ingredients, and if any of them are smeltable, we'll add the recipe\n+    // Something to consider in the future is adding the concept of 'free' recipes that don't count against the building limit. \n+    @Override\n+    public void checkForWorkerSpecificRecipes()\n+    {\n+\n+        ResourceLocation ingredients = new ResourceLocation(\"minecolonies\", this.getJobName().toLowerCase().concat(\"_ingredient\"));\n+\n+        for (final Item item : ItemTags.getCollection().getOrCreate(ingredients).getAllElements())\n+        {\n+            final ItemStack smeltingResult = FurnaceRecipes.getInstance().getSmeltingResult(new ItemStack(item, 1));\n+            if (ItemStackUtils.CAN_EAT.test(smeltingResult))\n+            {\n+\n+                final IRecipeStorage storage = StandardFactoryController.getInstance().getNewInstance(\n+                    TypeConstants.RECIPE,\n+                    StandardFactoryController.getInstance().getNewInstance(TypeConstants.ITOKEN),\n+                    ImmutableList.of(new ItemStack(item, 1)),\n+                    1,\n+                    smeltingResult,\n+                    Blocks.FURNACE);\n+          \n+                addRecipeToList(IColonyManager.getInstance().getRecipeManager().checkOrAddRecipe(storage));\n+            }\n+        }\n+    }\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e082f0be87813e34b6a515895602b3f5255dbe97"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89bdd421cff6832b964867289e7318af3b4f85b7", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/89bdd421cff6832b964867289e7318af3b4f85b7", "committedDate": "2020-07-14T14:07:17Z", "message": "Review Feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8917011ccd1a5c706c25109655f66741d6f027c4", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/8917011ccd1a5c706c25109655f66741d6f027c4", "committedDate": "2020-07-16T03:57:00Z", "message": "Add recipe lookup support for output"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b200efca67aba247ba77467d24d9c43f7e1647dd", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/b200efca67aba247ba77467d24d9c43f7e1647dd", "committedDate": "2020-07-16T05:15:09Z", "message": "Add on-demand recipe support for smelting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjAyNDY0", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-449602464", "createdAt": "2020-07-16T07:50:55Z", "commit": {"oid": "b200efca67aba247ba77467d24d9c43f7e1647dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzo1MDo1NVrOGyee9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzo1MDo1NVrOGyee9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU4MTQzMQ==", "bodyText": "I would only query this if ISFOOD", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r455581431", "createdAt": "2020-07-16T07:50:55Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -141,6 +138,50 @@ public boolean canBeGathered()\n         return builder.build();\n     }\n \n+    @Override\n+    @Nullable\n+    public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n+    {\n+        //First, do the normal check against taught recipes, and return those if found\n+        IRecipeStorage storage = super.getFirstRecipe(stackPredicate);\n+        if(storage != null)\n+        {\n+            return storage;\n+        }\n+\n+        //If we didn't have a stored recipe, see if there is a smelting recipe that is also a food output, and use it. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b200efca67aba247ba77467d24d9c43f7e1647dd"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "591537766ccc3462a4b1960437649e919cb0847c", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/591537766ccc3462a4b1960437649e919cb0847c", "committedDate": "2020-07-16T20:03:20Z", "message": "Merge branch 'version/1.15' into bettercook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7e217f375fc09b59c766fedebd4448843f03662", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/c7e217f375fc09b59c766fedebd4448843f03662", "committedDate": "2020-07-18T15:08:07Z", "message": "Add an assistant for the Cook, to do all crafting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "159148e3ff18f2b6187c42425d63a6356d3ae9d8", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/159148e3ff18f2b6187c42425d63a6356d3ae9d8", "committedDate": "2020-07-18T15:08:37Z", "message": "Merge branch 'version/1.15' into bettercook"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDYzOTIx", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-451063921", "createdAt": "2020-07-18T15:27:11Z", "commit": {"oid": "c7e217f375fc09b59c766fedebd4448843f03662"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNToyNzoxMlrOGzo4Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNToyNzoxMlrOGzo4Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDI2Nw==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r456800267", "createdAt": "2020-07-18T15:27:12Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -77,6 +84,16 @@ public BuildingCook(final IColony c, final BlockPos l)\n         keepX.put(FurnaceTileEntity::isFuel, new Tuple<>(STACKSIZE, true));\n     }\n \n+    public boolean getIsCooking()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7e217f375fc09b59c766fedebd4448843f03662"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39e66d6959da198388a10f54827b34249dee3018", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/39e66d6959da198388a10f54827b34249dee3018", "committedDate": "2020-07-18T15:29:38Z", "message": "Review Feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba7c2f8a7b2a0c84b87c0f389f58ebf5eff56f83", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/ba7c2f8a7b2a0c84b87c0f389f58ebf5eff56f83", "committedDate": "2020-07-19T22:56:57Z", "message": "Merge branch 'version/1.15' into bettercook"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MjY5NTgw", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-455269580", "createdAt": "2020-07-25T07:54:10Z", "commit": {"oid": "ba7c2f8a7b2a0c84b87c0f389f58ebf5eff56f83"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNzo1NDoxMFrOG3DS2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNzo1NDoyMlrOG3DS6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM3ODg0MA==", "bodyText": "hm I think this can cause issues, e.g. if the assistant stops working or is fired for some reason", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r460378840", "createdAt": "2020-07-25T07:54:10Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -73,6 +84,24 @@ public BuildingCook(final IColony c, final BlockPos l)\n         keepX.put(FurnaceTileEntity::isFuel, new Tuple<>(STACKSIZE, true));\n     }\n \n+    /**\n+     * Get the status of the assistant processing requests\n+     * @return true if currently crafting\n+     */\n+    public boolean getIsCooking()\n+    {\n+        return isCooking;\n+    }\n+\n+    /**\n+     * Record the state of the assistant processing requests\n+     * @param cookingState true if currently crafting\n+     */\n+    public void setIsCooking(final boolean cookingState)\n+    {\n+        isCooking = cookingState;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba7c2f8a7b2a0c84b87c0f389f58ebf5eff56f83"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM3ODg1OA==", "bodyText": "formatting", "url": "https://github.com/ldtteam/minecolonies/pull/5383#discussion_r460378858", "createdAt": "2020-07-25T07:54:22Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCook.java", "diffHunk": "@@ -90,6 +119,12 @@ public int getMaxBuildingLevel()\n     @Override\n     public IJob<?> createJob(final ICitizenData citizen)\n     {\n+        for (final ICitizenData leadCitizen : getAssignedCitizen())    {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba7c2f8a7b2a0c84b87c0f389f58ebf5eff56f83"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daa26657343b6e2209b7c6466a05a9d263476c97", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/daa26657343b6e2209b7c6466a05a9d263476c97", "committedDate": "2020-07-25T15:29:54Z", "message": "Merge branch 'version/1.15' into bettercook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e572a336275791b8d4b89e95a8dda7010c905763", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/e572a336275791b8d4b89e95a8dda7010c905763", "committedDate": "2020-07-26T02:14:06Z", "message": "Review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0f7ca9268ac068b401d51b1d96d9e077d28fcdd", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/e0f7ca9268ac068b401d51b1d96d9e077d28fcdd", "committedDate": "2020-07-27T21:44:18Z", "message": "Put a timeout on isCooking"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MTYwMTU5", "url": "https://github.com/ldtteam/minecolonies/pull/5383#pullrequestreview-456160159", "createdAt": "2020-07-27T21:49:18Z", "commit": {"oid": "e0f7ca9268ac068b401d51b1d96d9e077d28fcdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1985, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}