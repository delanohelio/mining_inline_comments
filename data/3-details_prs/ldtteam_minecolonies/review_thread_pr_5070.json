{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNDkxNzIx", "number": 5070, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxODoxMDoyOVrOD_clsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxOTo0ODowMVrOEAplmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3ODU1MjgyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxODoxMDoyOVrOGaHZ7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODozMjowOVrOGaUB_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzNzQ4NQ==", "bodyText": "This is actually more then needed. We have already a way to check on the sleep handler if a citizen is sleeping. So you only need to check this, no need for additional variables.", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430037485", "createdAt": "2020-05-25T18:10:29Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzOTE2Ng==", "bodyText": "this.isCitizensSleeping is used to mark that all citizens are sleeping, not just a particular citizen.", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430039166", "createdAt": "2020-05-25T18:17:28Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzNzQ4NQ=="}, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzOTczNw==", "bodyText": "I mean, that is not necessary. You can just, when a citizen lies down, check if all other citizen are sleeping already. And if so, print the message.", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430039737", "createdAt": "2020-05-25T18:19:52Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzNzQ4NQ=="}, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0MjkwMA==", "bodyText": "Oh, I remember now. The citizen, for some reason, calls trySleep multiple times even after they sleep which lead to several notifications being triggered. This was my way to reset the notifications until the next day.", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430042900", "createdAt": "2020-05-25T18:34:03Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzNzQ4NQ=="}, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0NDM1MA==", "bodyText": "Then there seems to be code missing in the PR, does this compile?", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430244350", "createdAt": "2020-05-26T08:32:09Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAzNzQ4NQ=="}, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3ODU3MDM5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxODoyMToxN1rOGaHkAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxODoyMToxN1rOGaHkAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0MDA2Ng==", "bodyText": "getImportantMessageEntityPlayers will notify any officers even when not inside the colony, e.g. your friend who is officer in your colony aswell. Think you want to use the nonimportant ones", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430040066", "createdAt": "2020-05-25T18:21:17Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +550,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.isCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+\n+\n+        for (final ICitizenData citizenData : citizens.values())\n+        {\n+            if (!(citizenData.isAsleep() || citizenData.getJob() instanceof AbstractJobGuard))\n+            {\n+                return;\n+            }\n+        }\n+\n+        if (!this.isCitizensSleeping)\n+        {\n+            LanguageHandler.sendPlayersMessage(colony.getImportantMessageEntityPlayers(), ALL_CITIZENS_ARE_SLEEPING);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59f2054e6a19371b0a3b97ca71b6ab3a35a30034"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MDIyNjg5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMDowMjowM1rOGaXUmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxOTozNDoyNFrOGcDm5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5ODI2NQ==", "bodyText": "areCitizensSleeping then", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r430298265", "createdAt": "2020-05-26T10:02:03Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -82,6 +84,11 @@\n      */\n     private Random random = new Random();\n \n+    /**\n+     * Whether all citizens excluding guards are sleeping\n+     */\n+    private boolean isCitizensSleeping;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d07c400561d7f31a603326a82217e5e36e01a4b"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA3MjQyMw==", "bodyText": "Still this here =D", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r432072423", "createdAt": "2020-05-28T19:34:24Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -82,6 +84,11 @@\n      */\n     private Random random = new Random();\n \n+    /**\n+     * Whether all citizens excluding guards are sleeping\n+     */\n+    private boolean isCitizensSleeping;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5ODI2NQ=="}, "originalCommit": {"oid": "9d07c400561d7f31a603326a82217e5e36e01a4b"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTE2ODI2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxOTo0ODowMVrOGcEE3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxOTo0ODowMVrOGcEE3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA4MDA5Mw==", "bodyText": "Just this 2 lines of whitespace here and then we can merge it =D", "url": "https://github.com/ldtteam/minecolonies/pull/5070#discussion_r432080093", "createdAt": "2020-05-28T19:48:01Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -548,4 +554,31 @@ public ICitizenData getRandomCitizen()\n     {\n         return (ICitizenData) citizens.values().toArray()[random.nextInt(citizens.values().size())];\n     }\n+\n+    @Override\n+    public void updateCitizenSleep(final boolean sleep)\n+    {\n+        this.areCitizensSleeping = sleep;\n+    }\n+\n+    @Override\n+    public void onCitizenSleep()\n+    {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ad771d974e0ea42b5f9ee0cf7bd03d57900ef85"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3079, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}