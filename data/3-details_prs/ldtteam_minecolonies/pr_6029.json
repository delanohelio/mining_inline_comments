{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1MDU0MTE4", "number": 6029, "title": "Invfixes", "bodyText": "Changes proposed in this pull request:\nImprove citizen inventory free slots and stop damaging/modifying internal stacks from outside\nFix cap invalidate only upon change\nFix racks(and their chunk) beeing marked dirty from the buildings getCap call all the time\nFix capability invalidates to be like chests\nFix Building cap returning values when the TE was removed\nFix Enchanter doing animations serverside and not calling super tick\nFix CombinedHandler not having isItemValid implemented\nReview please", "createdAt": "2020-11-03T23:55:31Z", "url": "https://github.com/ldtteam/minecolonies/pull/6029", "merged": true, "mergeCommit": {"oid": "9f951878b0cab3052989234897a02b827c8ab4cd"}, "closed": true, "closedAt": "2020-11-04T22:28:12Z", "author": {"login": "someaddons"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZBSZ6gH2gAyNTE1MDU0MTE4OmFkYzY4NzZmOWJjODNkODJkNjdjYWE4MjFiNGM4MDQwYzhmMmU5NzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZUW2UAFqTUyMzczNjE5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "adc6876f9bc83d82d67caa821b4c8040c8f2e972", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/adc6876f9bc83d82d67caa821b4c8040c8f2e972", "committedDate": "2020-11-03T22:55:21Z", "message": "Improve citizen inventory free slots and stop damaging items within without notice"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a5c6e3aa1935c30b485c945a9845cfabc3bf6ff", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/8a5c6e3aa1935c30b485c945a9845cfabc3bf6ff", "committedDate": "2020-11-03T23:31:24Z", "message": "Fix cap invalidate only upon change\nFix racks(and their chunk) beeing marked dirty from the buildings getCap call all the time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03d7e3a860f992949056f9b22d3b37146c8b6551", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/03d7e3a860f992949056f9b22d3b37146c8b6551", "committedDate": "2020-11-03T23:50:35Z", "message": "add freeslot counter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07a805ec401cdfbc1dd39f66fa9b1cec2353251f", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/07a805ec401cdfbc1dd39f66fa9b1cec2353251f", "committedDate": "2020-11-03T23:57:29Z", "message": "fix check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3085f5b6041ab06d1866d071e28896575f3da513", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/3085f5b6041ab06d1866d071e28896575f3da513", "committedDate": "2020-11-04T00:22:01Z", "message": "add capability returns"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDU5NzI4", "url": "https://github.com/ldtteam/minecolonies/pull/6029#pullrequestreview-523059728", "createdAt": "2020-11-04T05:52:48Z", "commit": {"oid": "3085f5b6041ab06d1866d071e28896575f3da513"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMTM1MTk1", "url": "https://github.com/ldtteam/minecolonies/pull/6029#pullrequestreview-523135195", "createdAt": "2020-11-04T08:30:32Z", "commit": {"oid": "3085f5b6041ab06d1866d071e28896575f3da513"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwODozMDozMlrOHtNnjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwODozMDozMlrOHtNnjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzE3MTA4NQ==", "bodyText": "Ehm, shouldn't we avoid returning this cached value here?", "url": "https://github.com/ldtteam/minecolonies/pull/6029#discussion_r517171085", "createdAt": "2020-11-04T08:30:32Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/tileentities/TileEntityRack.java", "diffHunk": "@@ -447,13 +445,13 @@ public void rotate(final Rotation rotationIn)\n     @Override\n     public <T> LazyOptional<T> getCapability(@Nonnull final Capability<T> capability, final Direction dir)\n     {\n-        if (lastOptional != null)\n-        {\n-            lastOptional.invalidate();\n-        }\n-\n         if (capability == CapabilityItemHandler.ITEM_HANDLER_CAPABILITY)\n         {\n+            if (lastOptional != null && lastOptional.isPresent())\n+            {\n+                return (LazyOptional<T>) lastOptional;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3085f5b6041ab06d1866d071e28896575f3da513"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNDk3MjM2", "url": "https://github.com/ldtteam/minecolonies/pull/6029#pullrequestreview-523497236", "createdAt": "2020-11-04T15:54:44Z", "commit": {"oid": "3085f5b6041ab06d1866d071e28896575f3da513"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "569c759e9310da80dd0f980157f91d0aa0f27c54", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/569c759e9310da80dd0f980157f91d0aa0f27c54", "committedDate": "2020-11-04T18:58:10Z", "message": "Fix capability invalidtes to be like chests\nFix Building cap returning values when the TE was removed\nFix Enchanter doing animations serverside and not calling super tick\nFix CombinedHandler not having isItemValid implemented"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzE2Nzk4", "url": "https://github.com/ldtteam/minecolonies/pull/6029#pullrequestreview-523716798", "createdAt": "2020-11-04T20:37:47Z", "commit": {"oid": "569c759e9310da80dd0f980157f91d0aa0f27c54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzM2MTkz", "url": "https://github.com/ldtteam/minecolonies/pull/6029#pullrequestreview-523736193", "createdAt": "2020-11-04T21:08:24Z", "commit": {"oid": "569c759e9310da80dd0f980157f91d0aa0f27c54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1808, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}