{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyMTIzMTYx", "number": 6004, "title": "Fix a few performance issues", "bodyText": "Changes proposed in this pull request:\nFixing a bunch of minor performance leaks, which though in total made for about ~30% of our citizens tick usage.\nFixed citizen inventories possibly running into issues with legacy armor slot code.\nFix NPE with inv utils, when it doesnt find the TE at the pos in world.\nReview please", "createdAt": "2020-10-29T09:04:16Z", "url": "https://github.com/ldtteam/minecolonies/pull/6004", "merged": true, "mergeCommit": {"oid": "e71e7832208c1a279882851004bfb2dcb14b649a"}, "closed": true, "closedAt": "2020-11-01T12:52:03Z", "author": {"login": "someaddons"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXOBveAH2gAyNTEyMTIzMTYxOmY1ZjdkYjVhZThlYzNjOTVkNjIyNmJhMjNkNDcyZDBiMThmNjNkZWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYPIy4AH2gAyNTEyMTIzMTYxOmJiZjc4MTEzZDJkY2RiZDQxNzUzOThmZDBjMmU2N2U1N2EyZGJhMTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f5f7db5ae8ec3c95d6226ba23d472d0b18f63dea", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/f5f7db5ae8ec3c95d6226ba23d472d0b18f63dea", "committedDate": "2020-10-29T08:38:04Z", "message": "Fix a few performance issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDYwOTk4", "url": "https://github.com/ldtteam/minecolonies/pull/6004#pullrequestreview-519460998", "createdAt": "2020-10-29T09:10:41Z", "commit": {"oid": "f5f7db5ae8ec3c95d6226ba23d472d0b18f63dea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwOToxMDo0MVrOHqShmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwOToxMDo0MVrOHqShmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEwNTc1Mw==", "bodyText": "I guess loading the inv from NBT loads things nicely too? Not sure armor slots should be dealt with as free slots? We practically only use armor slots for rendering.", "url": "https://github.com/ldtteam/minecolonies/pull/6004#discussion_r514105753", "createdAt": "2020-10-29T09:10:41Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/inventory/InventoryCitizen.java", "diffHunk": "@@ -41,6 +41,11 @@\n      */\n     private static final int ARMOR_SIZE = 5;\n \n+    /**\n+     * Amount of free slots\n+     */\n+    private int freeSlots = DEFAULT_INV_SIZE + ARMOR_SIZE;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f7db5ae8ec3c95d6226ba23d472d0b18f63dea"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9be230cce5694bb6010ce0bf39ae3b7ad3d52c16", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/9be230cce5694bb6010ce0bf39ae3b7ad3d52c16", "committedDate": "2020-10-29T09:41:32Z", "message": "Remove armor inventory leftovers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "674b0b8f1b7a06f56fa55ca97e0d10b70327e297", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/674b0b8f1b7a06f56fa55ca97e0d10b70327e297", "committedDate": "2020-10-29T10:38:35Z", "message": "Fix loading, fix racks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "465f591e1257ca1fd3f42666308ba9e9305863fc", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/465f591e1257ca1fd3f42666308ba9e9305863fc", "committedDate": "2020-10-29T10:42:25Z", "message": "remove duplicate isempty function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1658a68ed89b3532fc1dfd0c429a36ee7832328", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/f1658a68ed89b3532fc1dfd0c429a36ee7832328", "committedDate": "2020-10-29T11:15:07Z", "message": "fix possible npe when no TE is found in world"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTU4MDM5", "url": "https://github.com/ldtteam/minecolonies/pull/6004#pullrequestreview-519958039", "createdAt": "2020-10-29T18:27:00Z", "commit": {"oid": "f1658a68ed89b3532fc1dfd0c429a36ee7832328"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxODoyNzowMFrOHqpK-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxODoyNzowMFrOHqpK-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ3Njc5Mw==", "bodyText": "Can we use the supplier pattern that Ray put together here, and use TICKS_SECOND if there is a current recipe set? The AI goes back to START_WORKING constantly during actual processing, so a 5 second delay will be fairly noticeable between actions.", "url": "https://github.com/ldtteam/minecolonies/pull/6004#discussion_r514476793", "createdAt": "2020-10-29T18:27:00Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAIUsesFurnace.java", "diffHunk": "@@ -64,7 +64,7 @@ protected AbstractEntityAIUsesFurnace(@NotNull final J job)\n         super(job);\n         super.registerTargets(\n           new AITarget(IDLE, START_WORKING, STANDARD_DELAY),\n-          new AITarget(START_WORKING, this::startWorking, TICKS_SECOND),\n+          new AITarget(START_WORKING, this::startWorking, 100),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1658a68ed89b3532fc1dfd0c429a36ee7832328"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTYwMjI5", "url": "https://github.com/ldtteam/minecolonies/pull/6004#pullrequestreview-519960229", "createdAt": "2020-10-29T18:29:45Z", "commit": {"oid": "f1658a68ed89b3532fc1dfd0c429a36ee7832328"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7bcdeb767486e31bc02f7d816684ed310a48e50", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/f7bcdeb767486e31bc02f7d816684ed310a48e50", "committedDate": "2020-10-29T18:58:48Z", "message": "Use the fast method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTg1NDYx", "url": "https://github.com/ldtteam/minecolonies/pull/6004#pullrequestreview-519985461", "createdAt": "2020-10-29T19:02:48Z", "commit": {"oid": "f7bcdeb767486e31bc02f7d816684ed310a48e50"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cb736b13291df3ed190c7fbbe90c5f8b9dd571e", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/7cb736b13291df3ed190c7fbbe90c5f8b9dd571e", "committedDate": "2020-10-29T19:07:40Z", "message": "avoid doing actions too frequently unnecessarily"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMDE1Mjk2", "url": "https://github.com/ldtteam/minecolonies/pull/6004#pullrequestreview-520015296", "createdAt": "2020-10-29T19:44:51Z", "commit": {"oid": "7cb736b13291df3ed190c7fbbe90c5f8b9dd571e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d72a4b5d01f3bbd297651514cb901855170b7933", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/d72a4b5d01f3bbd297651514cb901855170b7933", "committedDate": "2020-11-01T09:07:35Z", "message": "Merge remote-tracking branch 'remotes/origin/version/1.15' into performanceimpr\n\n# Conflicts:\n#\tsrc/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/MovementHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbf78113d2dcdbd4175398fd0c2e67e57a2dba16", "author": {"user": {"login": "someaddons", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/bbf78113d2dcdbd4175398fd0c2e67e57a2dba16", "committedDate": "2020-11-01T12:29:36Z", "message": "ray is unreasonable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1801, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}