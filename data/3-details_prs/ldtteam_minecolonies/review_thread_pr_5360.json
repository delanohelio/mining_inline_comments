{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MzQ1NTE0", "number": 5360, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNjoyMDowMFrOEMj74g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxODoyMDo0N1rOEMmrQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNjA3MTM4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuilding.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNjoyMDowMFrOGuvnbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNjoyNjoyNlrOGuv3EQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY2NzgyMA==", "bodyText": "getCompletedRequestsByCitizen().computeIfAbsent(citizenThatRequested, ArrayList::new).add(request.getId());", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451667820", "createdAt": "2020-07-08T16:20:00Z", "author": {"login": "MatthiasMann"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuilding.java", "diffHunk": "@@ -1507,11 +1507,14 @@ public void onRequestedRequestComplete(@NotNull final IRequestManager manager, @\n             getOpenRequestsByRequestableType().remove(TypeToken.of(request.getRequest().getClass()));\n         }\n \n-        if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+        if (citizenThatRequested != 0)\n         {\n-            getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+            {\n+                getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            }\n+            getCompletedRequestsByCitizen().get(citizenThatRequested).add(request.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4505b7c8c96e1d63b29e131ff1edf6d07248bc4c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY3MTgyNQ==", "bodyText": "Good point, old code, but good point =D", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451671825", "createdAt": "2020-07-08T16:26:26Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuilding.java", "diffHunk": "@@ -1507,11 +1507,14 @@ public void onRequestedRequestComplete(@NotNull final IRequestManager manager, @\n             getOpenRequestsByRequestableType().remove(TypeToken.of(request.getRequest().getClass()));\n         }\n \n-        if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+        if (citizenThatRequested != 0)\n         {\n-            getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            if (!getCompletedRequestsByCitizen().containsKey(citizenThatRequested))\n+            {\n+                getCompletedRequestsByCitizen().put(citizenThatRequested, new ArrayList<>());\n+            }\n+            getCompletedRequestsByCitizen().get(citizenThatRequested).add(request.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY2NzgyMA=="}, "originalCommit": {"oid": "4505b7c8c96e1d63b29e131ff1edf6d07248bc4c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNjUyMDMzOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxODoyMDo0N1rOGu0Ciw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxOTo1NjoxN1rOGu3H6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc0MDI5OQ==", "bodyText": "think this should only reduce if the addItemStackToItemHandler is successfull", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451740299", "createdAt": "2020-07-08T18:20:47Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -1776,21 +1776,16 @@ public static int transferXOfFirstSlotInItemHandlerWithIntoNextFreeSlotInItemHan\n                 break;\n             }\n \n-\n             final ItemStack returnStack = sourceHandler.extractItem(desiredItemSlot, currentAmount, false);\n \n             if (!ItemStackUtils.isEmpty(returnStack))\n             {\n                 if (!InventoryUtils.addItemStackToItemHandler(targetHandler, returnStack))\n                 {\n-                    sourceHandler.insertItem(desiredItemSlot, returnStack, false);\n                     break;\n                 }\n                 // Only reduce if successfully inserted.\n-                else\n-                {\n-                    currentAmount -= returnStack.getCount();\n-                }\n+                currentAmount -= returnStack.getCount();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc4ODY5NA==", "bodyText": "If not, it breaks the loop.", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451788694", "createdAt": "2020-07-08T19:51:58Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -1776,21 +1776,16 @@ public static int transferXOfFirstSlotInItemHandlerWithIntoNextFreeSlotInItemHan\n                 break;\n             }\n \n-\n             final ItemStack returnStack = sourceHandler.extractItem(desiredItemSlot, currentAmount, false);\n \n             if (!ItemStackUtils.isEmpty(returnStack))\n             {\n                 if (!InventoryUtils.addItemStackToItemHandler(targetHandler, returnStack))\n                 {\n-                    sourceHandler.insertItem(desiredItemSlot, returnStack, false);\n                     break;\n                 }\n                 // Only reduce if successfully inserted.\n-                else\n-                {\n-                    currentAmount -= returnStack.getCount();\n-                }\n+                currentAmount -= returnStack.getCount();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc0MDI5OQ=="}, "originalCommit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc5MDgyNw==", "bodyText": "if !transfer\nbreak\nThat's why.", "url": "https://github.com/ldtteam/minecolonies/pull/5360#discussion_r451790827", "createdAt": "2020-07-08T19:56:17Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/util/InventoryUtils.java", "diffHunk": "@@ -1776,21 +1776,16 @@ public static int transferXOfFirstSlotInItemHandlerWithIntoNextFreeSlotInItemHan\n                 break;\n             }\n \n-\n             final ItemStack returnStack = sourceHandler.extractItem(desiredItemSlot, currentAmount, false);\n \n             if (!ItemStackUtils.isEmpty(returnStack))\n             {\n                 if (!InventoryUtils.addItemStackToItemHandler(targetHandler, returnStack))\n                 {\n-                    sourceHandler.insertItem(desiredItemSlot, returnStack, false);\n                     break;\n                 }\n                 // Only reduce if successfully inserted.\n-                else\n-                {\n-                    currentAmount -= returnStack.getCount();\n-                }\n+                currentAmount -= returnStack.getCount();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc0MDI5OQ=="}, "originalCommit": {"oid": "3f82a21f120e96a2e750fb6c9a8ab449d1499035"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3532, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}