{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MTM3NTgw", "number": 4968, "title": "Allow certain requests to have a minimum count", "bodyText": "This PR basically replaces the previous handling where specific workers were able to make requests that were partially fulfilled with a request specific handling. Thus worker can request something with a count and a min count, where the RS will try to fulfill the count and if this is not possible but the system has a bit less it will try to match the minCount.\nI also removed some of the heavy streams with quicker for loops.\nReview please", "createdAt": "2020-05-11T14:23:13Z", "url": "https://github.com/ldtteam/minecolonies/pull/4968", "merged": true, "mergeCommit": {"oid": "cddd6597683fad260f7c456561a0f336d678ce71"}, "closed": true, "closedAt": "2020-05-12T18:14:25Z", "author": {"login": "Raycoms"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgQcxbAH2gAyNDE2MTM3NTgwOjUzMGRjYzZmZTFmMWRmMDlkNzBkYThhOGE5YWVmNjg3MDA5YmI1Yjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgnslJgFqTQxMDI2NDU2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "530dcc6fe1f1df09d70da8a8a9aef687009bb5b7", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/530dcc6fe1f1df09d70da8a8a9aef687009bb5b7", "committedDate": "2020-05-11T14:21:34Z", "message": "Allow certain requests to have a minimum count"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc3e9866e1bc7c30c3be2ca2467e89102a54d900", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/fc3e9866e1bc7c30c3be2ca2467e89102a54d900", "committedDate": "2020-05-11T19:23:25Z", "message": "fix for public crafting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDAwNjMz", "url": "https://github.com/ldtteam/minecolonies/pull/4968#pullrequestreview-410000633", "createdAt": "2020-05-12T12:43:31Z", "commit": {"oid": "fc3e9866e1bc7c30c3be2ca2467e89102a54d900"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjo0MzozMVrOGUEt5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjo0NjoxMVrOGUE0QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcwMTk4OQ==", "bodyText": "Please add the Empty initialization back. It just prevents errors and is just a safeguard no reason to remove it.", "url": "https://github.com/ldtteam/minecolonies/pull/4968#discussion_r423701989", "createdAt": "2020-05-12T12:43:31Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/colony/requestsystem/requestable/Stack.java", "diffHunk": "@@ -28,50 +30,58 @@\n     /**\n      * If meta should match.\n      */\n-    private boolean matchMeta = false;\n+    private boolean matchMeta;\n \n     /**\n      * If NBT should match.\n      */\n-    private boolean matchNBT = false;\n+    private boolean matchNBT;\n \n     /**\n      * If oredict should match.\n      */\n-    private boolean matchOreDic = false;\n+    private boolean matchOreDic;\n \n     /**\n      * The required count.\n      */\n-    private int count = 0;\n+    private int count;\n+\n+    /**\n+     * The required count.\n+     */\n+    private int minCount;\n \n     @NotNull\n-    private ItemStack result = ItemStackUtils.EMPTY;\n+    private ItemStack result;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc3e9866e1bc7c30c3be2ca2467e89102a54d900"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcwMjMwMQ==", "bodyText": "Constant check.", "url": "https://github.com/ldtteam/minecolonies/pull/4968#discussion_r423702301", "createdAt": "2020-05-12T12:44:05Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/colony/requestsystem/requestable/Stack.java", "diffHunk": "@@ -153,10 +153,16 @@ public static Stack deserialize(final IFactoryController controller, final Compo\n         final boolean matchNBT = compound.getBoolean(NBT_MATCHNBT);\n         final boolean matchOreDic = compound.getBoolean(NBT_MATCHOREDIC);\n         final ItemStack result = compound.keySet().contains(NBT_RESULT) ? ItemStackUtils.deserializeFromNBT(compound.getCompound(NBT_RESULT)) : ItemStackUtils.EMPTY;\n-        final int size = compound.getInt(\"size\");\n-        final Stack theStack = new Stack(stack, matchMeta, matchNBT, matchOreDic, result);\n-        theStack.setCount(size);\n-        return theStack;\n+\n+        int count = compound.getInt(\"size\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc3e9866e1bc7c30c3be2ca2467e89102a54d900"}, "originalPosition": 161}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcwMzYxNg==", "bodyText": "Please add a setter as well. Additionally use the given count as the default minimum count not 1.\nIf the builder then wants to override his special behaviour can then set the minimum count to what ever is handy.\nSetting the default to one for every request type changes the behaviour.", "url": "https://github.com/ldtteam/minecolonies/pull/4968#discussion_r423703616", "createdAt": "2020-05-12T12:46:11Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/colony/requestsystem/requestable/IDeliverable.java", "diffHunk": "@@ -21,10 +20,17 @@\n     /**\n      * Method called to get the amount of items that need to be in the stack.\n      *\n-     * @return The amount of items that\n+     * @return The amount of items.\n      */\n     int getCount();\n \n+    /**\n+     * Method called to get the minimum amount required to fulfill this request.\n+     *\n+     * @return the minimum amount.\n+     */\n+    int getMinimumCount();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc3e9866e1bc7c30c3be2ca2467e89102a54d900"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "795d071f84655d718044521013e177211c7c46ce", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/795d071f84655d718044521013e177211c7c46ce", "committedDate": "2020-05-12T13:05:13Z", "message": "Merge branch 'version/1.15' into feature/min-count"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58d2cf07b2a7a5fba0800945c241c3d5c9666658", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/58d2cf07b2a7a5fba0800945c241c3d5c9666658", "committedDate": "2020-05-12T13:17:34Z", "message": "Merge branch 'version/1.15' into feature/min-count"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c008c8879df88a21c0c6664c61ff2e0102977fa9", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/c008c8879df88a21c0c6664c61ff2e0102977fa9", "committedDate": "2020-05-12T15:52:21Z", "message": "fix recipes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb32571ee4cc7377c8b4306ab0cc016a4d4de8ae", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/cb32571ee4cc7377c8b4306ab0cc016a4d4de8ae", "committedDate": "2020-05-12T15:52:27Z", "message": "Merge remote-tracking branch 'origin/feature/min-count' into feature/min-count"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjY0NTY3", "url": "https://github.com/ldtteam/minecolonies/pull/4968#pullrequestreview-410264567", "createdAt": "2020-05-12T17:26:39Z", "commit": {"oid": "cb32571ee4cc7377c8b4306ab0cc016a4d4de8ae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2117, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}