{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3OTY5OTMy", "number": 5469, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxODoyNTo0OFrOES7znw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwNzo1MzowNFrOETIzWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4Mjg5Njk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxODoyNTo0OFrOG4ZGKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxODoyNTo0OFrOG4ZGKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4NDYxNw==", "bodyText": "I also changed isAir to isSolid", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461784617", "createdAt": "2020-07-28T18:25:48Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "diffHunk": "@@ -196,18 +197,21 @@ private void findBedAndTryToSleep()\n                 {\n                     for (final BlockPos pos : ((BuildingHome) hut).getBedList())\n                     {\n-                        final World world = citizen.world;\n-                        BlockState state = world.getBlockState(pos);\n-                        state = state.getBlock().getExtendedState(state, world, pos);\n-                        if (state.getBlock().isIn(BlockTags.BEDS)\n-                              && !state.get(BedBlock.OCCUPIED)\n-                              && state.get(BedBlock.PART).equals(BedPart.HEAD)\n-                              && !isBedOccupied((BuildingHome) hut, pos)\n-                              && world.isAirBlock(pos.up()))\n+                        if (WorldUtil.isBlockLoaded(citizen.world, pos))\n                         {\n-                            usedBed = pos;\n-                            setBedOccupied((BuildingHome) hut, true);\n-                            return;\n+                            final World world = citizen.world;\n+                            BlockState state = world.getBlockState(pos);\n+                            state = state.getBlock().getExtendedState(state, world, pos);\n+                            if (state.getBlock().isIn(BlockTags.BEDS)\n+                                  && !state.get(BedBlock.OCCUPIED)\n+                                  && state.get(BedBlock.PART).equals(BedPart.HEAD)\n+                                  && !isBedOccupied((BuildingHome) hut, pos)\n+                                  && !world.getBlockState(pos.up()).getMaterial().isSolid())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzY3NDgxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MToyN1rOG4gboQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MToyN1rOG4gboQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwNDgwMQ==", "bodyText": "think this should be an entity block loaded check, as its for an existing citizen in a possibly not loaded chunk, we want to check if its a chunk which ticks entities", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461904801", "createdAt": "2020-07-28T21:51:27Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/CitizenManager.java", "diffHunk": "@@ -127,7 +128,7 @@ public void registerCivilian(final AbstractCivilianEntity entity)\n             return;\n         }\n \n-        if (!existingCitizen.get().isAlive() || !existingCitizen.get().world.isBlockPresent(existingCitizen.get().getPosition()))\n+        if (!existingCitizen.get().isAlive() || !WorldUtil.isBlockLoaded(existingCitizen.get().world, existingCitizen.get().getPosition()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzY3ODQ2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MjoxMlrOG4gdyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MjoxMlrOG4gdyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwNTM1NA==", "bodyText": "entity block loaded checks in this class, we're spawning entities", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461905354", "createdAt": "2020-07-28T21:52:12Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -285,7 +286,7 @@ public BlockPos calculateSpawnLocation()\n \n         for (final IBuilding building : colony.getBuildingManager().getBuildings().values())\n         {\n-            if (colony.getWorld().isBlockPresent(building.getPosition()))\n+            if (WorldUtil.isBlockLoaded(colony.getWorld(), building.getPosition()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzY4MTU4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/florist/EntityAIWorkFlorist.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1Mjo1M1rOG4gf3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1Mjo1M1rOG4gf3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwNTg4NQ==", "bodyText": "entity loaded check", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461905885", "createdAt": "2020-07-28T21:52:53Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/florist/EntityAIWorkFlorist.java", "diffHunk": "@@ -294,7 +295,7 @@ private BlockPos getFirstNotCompostedLand()\n     {\n         for (final BlockPos pos : getOwnBuilding().getPlantGround())\n         {\n-            if (world.isBlockPresent(pos))\n+            if (WorldUtil.isBlockLoaded(world, pos))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzY4Mzc5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/herders/EntityAIWorkChickenHerder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MzoxN1rOG4ghHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1MzoxN1rOG4ghHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwNjIwNw==", "bodyText": "oops :D", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461906207", "createdAt": "2020-07-28T21:53:17Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/herders/EntityAIWorkChickenHerder.java", "diffHunk": "@@ -74,6 +74,6 @@ protected IAIState breedAnimals()\n     protected IAIState butcherAnimals()\n     {\n         worker.getCitizenData().setVisibleStatus(FIND_CHICKEN);\n-        return super.breedAnimals();\n+        return super.butcherAnimals();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzY4NzUyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1NDowM1rOG4gjdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1NDowM1rOG4gjdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwNjgwNw==", "bodyText": "entity loaded check", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461906807", "createdAt": "2020-07-28T21:54:03Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "diffHunk": "@@ -196,18 +197,21 @@ private void findBedAndTryToSleep()\n                 {\n                     for (final BlockPos pos : ((BuildingHome) hut).getBedList())\n                     {\n-                        final World world = citizen.world;\n-                        BlockState state = world.getBlockState(pos);\n-                        state = state.getBlock().getExtendedState(state, world, pos);\n-                        if (state.getBlock().isIn(BlockTags.BEDS)\n-                              && !state.get(BedBlock.OCCUPIED)\n-                              && state.get(BedBlock.PART).equals(BedPart.HEAD)\n-                              && !isBedOccupied((BuildingHome) hut, pos)\n-                              && world.isAirBlock(pos.up()))\n+                        if (WorldUtil.isBlockLoaded(citizen.world, pos))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzcwMzg2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenSleepHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1NzowMlrOG4gtWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMTo1NzowMlrOG4gtWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkwOTMzOQ==", "bodyText": "entity loaded", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r461909339", "createdAt": "2020-07-28T21:57:02Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/entity/citizen/citizenhandlers/CitizenSleepHandler.java", "diffHunk": "@@ -103,7 +104,7 @@ public float getBedOrientationInDegrees()\n     @Override\n     public boolean trySleep(final BlockPos bedLocation)\n     {\n-        final BlockState state = citizen.world.isBlockPresent(bedLocation) ? citizen.world.getBlockState(bedLocation) : null;\n+        final BlockState state = WorldUtil.isBlockLoaded(citizen.world, bedLocation) ? citizen.world.getBlockState(bedLocation) : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTAyNjE4OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/util/constant/CitizenConstants.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwNzo1MzowNFrOG4s0yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwNzo1MzowNFrOG4s0yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjEwNzg0OQ==", "bodyText": "typo", "url": "https://github.com/ldtteam/minecolonies/pull/5469#discussion_r462107849", "createdAt": "2020-07-29T07:53:04Z", "author": {"login": "Asherslab"}, "path": "src/api/java/com/minecolonies/api/util/constant/CitizenConstants.java", "diffHunk": "@@ -115,6 +115,12 @@\n      * 20 ticks or also: once a second.\n      */\n     public static final int    TICKS_20                   = 20;\n+\n+    /**\n+     * 20 0ticks or also: once every 10 seconds.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "048ab0bceb7873d6a6f9aa05c1177d8b803b8095"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3587, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}