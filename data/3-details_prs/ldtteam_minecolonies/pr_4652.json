{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NzAwMjYx", "number": 4652, "title": "Fix #4181 Fisherman leaving line in water", "bodyText": "Closes #4181\nChanges proposed in this pull request:\n\nChecks when sending Citizen to home if the job of the Citizen is Fisherman. If so, retrieveRod is called. Added a null check incase the Fisherman didn't have a line out.\n\nReview please", "createdAt": "2020-04-16T20:28:23Z", "url": "https://github.com/ldtteam/minecolonies/pull/4652", "merged": true, "mergeCommit": {"oid": "700cc9fb7ba937f6e5402d037c520bb3a928d629"}, "closed": true, "closedAt": "2020-04-17T20:14:59Z", "author": {"login": "iiEpic"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYSnzhAH2gAyNDA0NzAwMjYxOjk4YjJmYzc1ZTJlYzExZGM0NTQzNTAzOTU2N2NjYmRkOGNmNjA0MzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYnGF6gFqTM5NTc0MzkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "98b2fc75e2ec11dc45435039567ccbdd8cf60434", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/98b2fc75e2ec11dc45435039567ccbdd8cf60434", "committedDate": "2020-04-16T20:22:02Z", "message": "Fix for #4181\n\n- Checks when sending citizen home to sleep.\n- If Job is Fisherman, retrieveRod method is called."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e037b350ccd72b3f4d485a7cd08cdeeef551511", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/6e037b350ccd72b3f4d485a7cd08cdeeef551511", "committedDate": "2020-04-16T20:23:02Z", "message": "Revert \"Fix for #4181\"\n\nThis reverts commit 98b2fc75e2ec11dc45435039567ccbdd8cf60434."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0", "committedDate": "2020-04-16T20:24:48Z", "message": "Fix for #4181\n\n- Checks when sending citizen home to sleep.\n- If Job is Fisherman, retrieveRod method is called."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0OTgyMDM4", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-394982038", "createdAt": "2020-04-16T20:39:43Z", "commit": {"oid": "535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMDozOTo0M1rOGG2UdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMDozOTo0M1rOGG2UdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgzNDYxMg==", "bodyText": "probably better to make this an instanceof JobFisherman", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r409834612", "createdAt": "2020-04-16T20:39:43Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/minimal/EntityAISleep.java", "diffHunk": "@@ -160,6 +162,13 @@ public void tick()\n         // Go home\n         if (!citizen.getCitizenColonyHandler().isAtHome())\n         {\n+            AbstractJob job = (AbstractJob) citizen.getCitizenData().getJob();\n+            if(job.getName() != null) {\n+                if (job.getName().contains(\"Fisherman\")) {\n+                    EntityAIWorkFisherman fishJob = (EntityAIWorkFisherman) citizen.getCitizenData().getJob().getWorkerAI();\n+                    fishJob.retrieveRod();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "535dd8a8e5a2811d795e2c7b1d6411fd5954f1d0"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d48691c0e06e694fa87070f9d579b9162945bbb8", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/d48691c0e06e694fa87070f9d579b9162945bbb8", "committedDate": "2020-04-16T20:51:36Z", "message": "Update to #4181\n\nChanged to instanceOf JobFisherman upon Raycoms request. (Makes alot more sense)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b4f050cdc05cce2c85ede22e193fa4eb7894cf5", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/4b4f050cdc05cce2c85ede22e193fa4eb7894cf5", "committedDate": "2020-04-16T21:19:51Z", "message": "Merge branch 'version/1.15' into version/1.15"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54904b299ed7d47c025fab18e48991648a9e3f09", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/54904b299ed7d47c025fab18e48991648a9e3f09", "committedDate": "2020-04-17T00:43:42Z", "message": "Fix for #4181 and others\n\n- Made retrieveRod() back to private\n- Removed added code to EntityAISleep\n- Added int tickRemove\n- Every 100 ticks it will check if the angler's status is set to sleeping, if so it will remove the bobber.\n\n- Thanks to Asher for the code!"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f36d59e695117ac737ef70397ebe2f0773363771", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/f36d59e695117ac737ef70397ebe2f0773363771", "committedDate": "2020-04-17T00:43:44Z", "message": "Merge branch 'version/1.15' of https://github.com/EpicUnknown/minecolonies into version/1.15"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MjM4MTIw", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-395238120", "createdAt": "2020-04-17T07:55:54Z", "commit": {"oid": "f36d59e695117ac737ef70397ebe2f0773363771"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72cc4ae17bbf3885593a7c801758dc04ef8b1c6a", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/72cc4ae17bbf3885593a7c801758dc04ef8b1c6a", "committedDate": "2020-04-17T17:59:52Z", "message": "Fix #4181"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da25287814ab1abdb6680389f307178ac5548496", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/da25287814ab1abdb6680389f307178ac5548496", "committedDate": "2020-04-17T19:03:11Z", "message": "Fix PathFinding of Fisherman\n\nFisherman now stops at the edge of the pond instead of trying to fish inside of the pond."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/b703118911373fc58903d1064f7b5dc9f09c1f5e", "committedDate": "2020-04-17T19:11:30Z", "message": "Formatting Changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NzA5MTI3", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-395709127", "createdAt": "2020-04-17T19:13:13Z", "commit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzoxM1rOGHaDLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzoxM1rOGHaDLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDAxNQ==", "bodyText": "missing", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420015", "createdAt": "2020-04-17T19:13:13Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/citizen/fisherman/EntityAIWorkFisherman.java", "diffHunk": "@@ -649,11 +649,13 @@ private boolean caughtFish()\n      */\n     private void retrieveRod()\n     {\n-        worker.swingArm(worker.getActiveHand());\n-        final int i = entityFishHook.getDamage();\n-        entityFishHook.remove();\n-        worker.getCitizenItemHandler().damageItemInHand(Hand.MAIN_HAND, i);\n-        entityFishHook = null;\n+        if(entityFishHook != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NzA5MzMz", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-395709333", "createdAt": "2020-04-17T19:13:32Z", "commit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzozM1rOGHaD1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzozM1rOGHaD1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDE4Mg==", "bodyText": "add javadoc and remove whitspace (also format)", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420182", "createdAt": "2020-04-17T19:13:33Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/NewBobberEntity.java", "diffHunk": "@@ -573,6 +587,8 @@ public boolean isReadyToCatch()\n         return readyToCatch;\n     }\n \n+    public void setInUse() { this.tickRemove = 100; }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NzA5NDcx", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-395709471", "createdAt": "2020-04-17T19:13:45Z", "commit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzo0NlrOGHaEMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOToxMzo0NlrOGHaEMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMDI3NA==", "bodyText": "also remove extra whitespace around here", "url": "https://github.com/ldtteam/minecolonies/pull/4652#discussion_r410420274", "createdAt": "2020-04-17T19:13:46Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/entity/NewBobberEntity.java", "diffHunk": "@@ -143,7 +145,18 @@ public void setPositionAndRotationDirect(double x, double y, double z, float yaw\n      */\n     public void tick()\n     {\n+\n         super.tick();\n+\n+        if(!this.world.isRemote())\n+        {\n+            if (--this.tickRemove <= 0)\n+            {\n+                this.remove();\n+                return;\n+            }\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b703118911373fc58903d1064f7b5dc9f09c1f5e"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "755a76198fdb7edff143aa4e0400d3562ee38c4f", "author": {"user": {"login": "iiEpic", "name": "_iEpic"}}, "url": "https://github.com/ldtteam/minecolonies/commit/755a76198fdb7edff143aa4e0400d3562ee38c4f", "committedDate": "2020-04-17T19:25:00Z", "message": "Formatting Changes\n\nI believe I got them all."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32f8687934f5221c602651fe601511eece62f358", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/32f8687934f5221c602651fe601511eece62f358", "committedDate": "2020-04-17T19:30:24Z", "message": "Merge branch 'version/1.15' into version/1.15"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NzQzOTM4", "url": "https://github.com/ldtteam/minecolonies/pull/4652#pullrequestreview-395743938", "createdAt": "2020-04-17T20:13:13Z", "commit": {"oid": "32f8687934f5221c602651fe601511eece62f358"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2196, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}