{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzNTU4MDEz", "number": 5756, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1NjozN1rOEiBNyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMDowMzozN1rOEiRccw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MTA2OTU0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/norsemenevent/NorsemenShipRaidEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1NjozN1rOHPp5gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1NjozN1rOHPp5gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3NzE1Mg==", "bodyText": "what, a public static constant without javadoc?", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486177152", "createdAt": "2020-09-10T08:56:37Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/norsemenevent/NorsemenShipRaidEvent.java", "diffHunk": "@@ -25,6 +25,8 @@\n      */\n     public static final ResourceLocation NORSEMEN_RAID_EVENT_TYPE_ID = new ResourceLocation(Constants.MOD_ID, \"norsemen_ship_raid\");\n \n+    public static final String SHIP_NAME = \"norsemen_ship\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MTA3MTgyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1NzoxNFrOHPp64w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1OToxNVrOHPqABw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3NzUwNw==", "bodyText": "Old I think?", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486177507", "createdAt": "2020-09-10T08:57:14Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -145,6 +152,8 @@\n      */\n     private int lostCitizens = 0;\n \n+    private static final HashMap<BiomeDictionary.Type, List<Consumer<IColony>>> raidBiomeMap = new HashMap<>();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODgyMw==", "bodyText": "ye", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486178823", "createdAt": "2020-09-10T08:59:15Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -145,6 +152,8 @@\n      */\n     private int lostCitizens = 0;\n \n+    private static final HashMap<BiomeDictionary.Type, List<Consumer<IColony>>> raidBiomeMap = new HashMap<>();\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3NzUwNw=="}, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MTA3NjA4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODo1ODoyNlrOHPp9ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwOTowNjozOFrOHPqSMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODI0Mw==", "bodyText": "but this way the egyptian raid is slighly more likely than the other ones. Can't we do a rand.nextInt(100) and then if numb == 1, egyptian, if numb == 2 then amazon, (or even a small range)", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486178243", "createdAt": "2020-09-10T08:58:26Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -284,15 +297,15 @@ else if (ShipBasedRaiderUtils.canSpawnShipAt(colony, targetSpawnPoint, amount, s\n             {\n                 final String biomePath = colony.getWorld().getBiome(targetSpawnPoint).getRegistryName().getPath();\n                 final HordeRaidEvent event;\n-                if (biomePath.contains(DESERT_BIOME_ID))\n+                if (biomePath.contains(DESERT_BIOME_ID) || rand.nextInt(100) < IGNORE_BIOME_CHANCE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3OTI3NA==", "bodyText": "hm in any case the egyptian would be rolled first", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486179274", "createdAt": "2020-09-10T08:59:56Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -284,15 +297,15 @@ else if (ShipBasedRaiderUtils.canSpawnShipAt(colony, targetSpawnPoint, amount, s\n             {\n                 final String biomePath = colony.getWorld().getBiome(targetSpawnPoint).getRegistryName().getPath();\n                 final HordeRaidEvent event;\n-                if (biomePath.contains(DESERT_BIOME_ID))\n+                if (biomePath.contains(DESERT_BIOME_ID) || rand.nextInt(100) < IGNORE_BIOME_CHANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODI0Mw=="}, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3OTcwMg==", "bodyText": "but ye we could make it one roll", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486179702", "createdAt": "2020-09-10T09:00:33Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -284,15 +297,15 @@ else if (ShipBasedRaiderUtils.canSpawnShipAt(colony, targetSpawnPoint, amount, s\n             {\n                 final String biomePath = colony.getWorld().getBiome(targetSpawnPoint).getRegistryName().getPath();\n                 final HordeRaidEvent event;\n-                if (biomePath.contains(DESERT_BIOME_ID))\n+                if (biomePath.contains(DESERT_BIOME_ID) || rand.nextInt(100) < IGNORE_BIOME_CHANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODI0Mw=="}, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE4MDgyMQ==", "bodyText": "yeah but if egyptian is 1 or 2, amazon is 3 or 4 next is 5 or 6 then the chance is equal", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486180821", "createdAt": "2020-09-10T09:02:25Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -284,15 +297,15 @@ else if (ShipBasedRaiderUtils.canSpawnShipAt(colony, targetSpawnPoint, amount, s\n             {\n                 final String biomePath = colony.getWorld().getBiome(targetSpawnPoint).getRegistryName().getPath();\n                 final HordeRaidEvent event;\n-                if (biomePath.contains(DESERT_BIOME_ID))\n+                if (biomePath.contains(DESERT_BIOME_ID) || rand.nextInt(100) < IGNORE_BIOME_CHANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODI0Mw=="}, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE4MzQ3NQ==", "bodyText": "check now^^", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486183475", "createdAt": "2020-09-10T09:06:38Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/RaidManager.java", "diffHunk": "@@ -284,15 +297,15 @@ else if (ShipBasedRaiderUtils.canSpawnShipAt(colony, targetSpawnPoint, amount, s\n             {\n                 final String biomePath = colony.getWorld().getBiome(targetSpawnPoint).getRegistryName().getPath();\n                 final HordeRaidEvent event;\n-                if (biomePath.contains(DESERT_BIOME_ID))\n+                if (biomePath.contains(DESERT_BIOME_ID) || rand.nextInt(100) < IGNORE_BIOME_CHANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE3ODI0Mw=="}, "originalCommit": {"oid": "c60473d6be69414837243818b4f3c4ab126f4f82"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MzcyMjI1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/pirateEvent/ShipBasedRaiderUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMDowMTo0MVrOHQDwBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMDowMTo0MVrOHQDwBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwMDcxMQ==", "bodyText": "Rename the field to be more accurate.", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486600711", "createdAt": "2020-09-10T20:01:41Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/pirateEvent/ShipBasedRaiderUtils.java", "diffHunk": "@@ -128,15 +127,15 @@ public static void setupSpawner(final BlockPos location, final World world, fina\n      * @param rotation   the rotation.\n      * @return true if successful.\n      */\n-    public static boolean canSpawnShipAt(final IColony colony, final BlockPos spawnPoint, final int raidLevel, final int rotation, final IColonyStructureSpawnEvent event)\n+    public static boolean canSpawnShipAt(final IColony colony, final BlockPos spawnPoint, final int raidLevel, final int rotation, final String shipName)\n     {\n         if (spawnPoint.equals(colony.getCenter()) || spawnPoint.getY() > MineColonies.getConfig().getCommon().maxYForBarbarians.get())\n         {\n             return false;\n         }\n \n         final World world = colony.getWorld();\n-        final String shipSize = ShipSize.getShipForRaiderAmount(raidLevel).schematicPrefix + event.getShipDesc();\n+        final String shipSize = ShipSize.getShipForRaiderAmount(raidLevel).schematicPrefix + shipName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c004b08be581c587c8c4b9878eab66d7d7ade9da"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MzcyODUxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/locations/EntityLocation.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMDowMzozN1rOHQDz2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMDoyMTowNlrOHQEWFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwMTY4OQ==", "bodyText": "This really does not matter at all..........\nNo change needed, just wanted to inform you that the HotSpot VM does this automatically, and as such these optimisations are not needed.\nNext time PRs with arbitrary changes like this will get rejected.", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486601689", "createdAt": "2020-09-10T20:03:37Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/locations/EntityLocation.java", "diffHunk": "@@ -70,13 +69,14 @@ private void checkEntity()\n     public BlockPos getInDimensionLocation()\n     {\n         checkEntity();\n-        if (entity == null || entity.get() == null)\n+        final Entity entityRef = entity.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c004b08be581c587c8c4b9878eab66d7d7ade9da"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwODQ2NQ==", "bodyText": "ah the JVM already does that, good to know", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486608465", "createdAt": "2020-09-10T20:17:19Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/locations/EntityLocation.java", "diffHunk": "@@ -70,13 +69,14 @@ private void checkEntity()\n     public BlockPos getInDimensionLocation()\n     {\n         checkEntity();\n-        if (entity == null || entity.get() == null)\n+        final Entity entityRef = entity.get();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwMTY4OQ=="}, "originalCommit": {"oid": "c004b08be581c587c8c4b9878eab66d7d7ade9da"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYxMDQ1Mw==", "bodyText": "This is a WeakReference - which has special semantics - you need to store the contained reference in a local variable or another field otherwise the GC can come and clear the WeakReference at any time. So calling get() twice in this case can result in different outcomes.", "url": "https://github.com/ldtteam/minecolonies/pull/5756#discussion_r486610453", "createdAt": "2020-09-10T20:21:06Z", "author": {"login": "MatthiasMann"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/locations/EntityLocation.java", "diffHunk": "@@ -70,13 +69,14 @@ private void checkEntity()\n     public BlockPos getInDimensionLocation()\n     {\n         checkEntity();\n-        if (entity == null || entity.get() == null)\n+        final Entity entityRef = entity.get();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwMTY4OQ=="}, "originalCommit": {"oid": "c004b08be581c587c8c4b9878eab66d7d7ade9da"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3488, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}