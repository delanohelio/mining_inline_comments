{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NDc1OTMz", "number": 5364, "title": "Add batching to miner resource request when mining", "bodyText": "Changes proposed in this pull request:\n\nWhen the miner is mining, inflate resource requests up to 32 to minimize dman trips\n\nReview please", "createdAt": "2020-07-10T14:34:58Z", "url": "https://github.com/ldtteam/minecolonies/pull/5364", "merged": true, "mergeCommit": {"oid": "1b856a8ba952342e575a66fab0371a5cca665b2e"}, "closed": true, "closedAt": "2020-07-11T16:51:39Z", "author": {"login": "Mekle001"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczkgBrgH2gAyNDQ3NDc1OTMzOjUzNjY4MWU0YjY5NzQwZTMyMzhkZTI0Y2NiMDJhY2YwM2M4ZWQ2M2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcz7GEjgFqTQ0NjgxNDU4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "536681e4b69740e3238de24ccb02acf03c8ed63c", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/536681e4b69740e3238de24ccb02acf03c8ed63c", "committedDate": "2020-07-10T14:27:47Z", "message": "Add batching to miner resource request when mining"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDU3MDc5", "url": "https://github.com/ldtteam/minecolonies/pull/5364#pullrequestreview-446457079", "createdAt": "2020-07-10T14:40:01Z", "commit": {"oid": "536681e4b69740e3238de24ccb02acf03c8ed63c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNDo0MDowMVrOGv5-OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNDo0MDowMVrOGv5-OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg4NjA3Mw==", "bodyText": "That looks simpler than what I would've expected even.\nI would make the resourceBatchSize a getter which on default returns 1  (in the abstract building of the structure builders) and in the miner returns 10.\nSuch that here we request requestCount * getResourceBatchSize", "url": "https://github.com/ldtteam/minecolonies/pull/5364#discussion_r452886073", "createdAt": "2020-07-10T14:40:01Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingStructureBuilder.java", "diffHunk": "@@ -669,7 +674,7 @@ public void checkOrRequestBucket(@Nullable final BuilderBucket requiredResources\n                         break;\n                     }\n \n-                    worker.createRequestAsync(new Stack(itemStack.getItemStack(), requestCount, requestCount));\n+                    worker.createRequestAsync(new Stack(itemStack.getItemStack(), Math.max(requestCount, resourceBatchSize), requestCount));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "536681e4b69740e3238de24ccb02acf03c8ed63c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0706c9b1e680438a35e6a121b4c03a0150f71ca1", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/0706c9b1e680438a35e6a121b4c03a0150f71ca1", "committedDate": "2020-07-10T15:52:48Z", "message": "Change to getter, with override in miner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NTU0NjEz", "url": "https://github.com/ldtteam/minecolonies/pull/5364#pullrequestreview-446554613", "createdAt": "2020-07-10T16:56:40Z", "commit": {"oid": "0706c9b1e680438a35e6a121b4c03a0150f71ca1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNjo1Njo0MFrOGv-lrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNjo1Njo0MFrOGv-lrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk2MTcwOA==", "bodyText": "bracket should go down.", "url": "https://github.com/ldtteam/minecolonies/pull/5364#discussion_r452961708", "createdAt": "2020-07-10T16:56:40Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingMiner.java", "diffHunk": "@@ -168,6 +168,15 @@ public int getMaxBuildingLevel()\n         return MAX_BUILDING_LEVEL;\n     }\n \n+    /**\n+     * The Miner wants to get multiple nodes/levels worth of stuff when requesting.\n+     */\n+    @Override\n+    public int getResourceBatchMultiplier() {\n+        //Ask for 10x the resources if possible", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0706c9b1e680438a35e6a121b4c03a0150f71ca1"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d9ddd457ca443a36dedf98c6c2475b40a326f85", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/8d9ddd457ca443a36dedf98c6c2475b40a326f85", "committedDate": "2020-07-10T16:56:49Z", "message": "Merge branch 'version/1.15' into MinerBatch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf479b7a21cb4dbd9e93c065c3835e8f88d0f0f8", "author": {"user": {"login": "Mekle001", "name": "Mike Garlick"}}, "url": "https://github.com/ldtteam/minecolonies/commit/bf479b7a21cb4dbd9e93c065c3835e8f88d0f0f8", "committedDate": "2020-07-10T16:58:59Z", "message": "Oops. Fix formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODE0NTgz", "url": "https://github.com/ldtteam/minecolonies/pull/5364#pullrequestreview-446814583", "createdAt": "2020-07-11T16:47:15Z", "commit": {"oid": "bf479b7a21cb4dbd9e93c065c3835e8f88d0f0f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1972, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}