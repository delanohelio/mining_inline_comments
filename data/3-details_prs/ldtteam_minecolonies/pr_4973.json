{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NDAyNzY2", "number": 4973, "title": "Allow buildings to opt-out from deliveryman", "bodyText": "Feature Suggestion\nCurrently, the deliveryman just randomly picks from all gatherable buildings.\nThis PR adds the option to opt-out from the deliveryman. The building will be left alone, except for when pickup requests (i.e. crafting complete) are sent by the building itself.\nBe careful though, you now have to clean up after the building yourself.\nImplementation\n\nAdditionally to \"Static\" and \"Automatic\", there is now a \"Pickup: Never\" option. Click it.\nSlightly changed the GUI of the buildings to better accomodate the new feature.\nSelecting \"Pickup: Never\" will hide the Priority numbers / decrementors/incrementors to avoid confusion.\n\n\n\nOpen Considerations\nI had to change the current \"isPriorityStatic()\"-boolean to an enum to fit the third state. This means I had to modify the NBT-data where this is stored. I have written a mini-migration/failsafe into the code, so on NBT-load the current data should be loaded, and then on chunksave the new format should be serialized. Since screwing this up would mean a bunch of trouble, please take special note of AbstractBuildingContainer:104 ff.", "createdAt": "2020-05-11T23:33:58Z", "url": "https://github.com/ldtteam/minecolonies/pull/4973", "merged": true, "mergeCommit": {"oid": "c8b4bade1d7ddb147f2dbf376454a74d43f19a5f"}, "closed": true, "closedAt": "2020-05-12T19:22:36Z", "author": {"login": "JiaYow"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgUEVvAH2gAyNDE2NDAyNzY2OmJlMjJjM2MxODJiNDA2YWU3NTdiOTljZmYyYjg5ZjYyODc1OGEyNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgoreigH2gAyNDE2NDAyNzY2OjM3N2UwYzE0MzMxNWQwYTIzYWIwZWIxNWNmZWQ4ZTkwMjg2MDYyZGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be22c3c182b406ae757b99cff2b89f628758a25a", "author": {"user": {"login": "JiaYow", "name": "JiaYow"}}, "url": "https://github.com/ldtteam/minecolonies/commit/be22c3c182b406ae757b99cff2b89f628758a25a", "committedDate": "2020-05-11T18:34:30Z", "message": "Roadfixed a possible index-out-of-bound exception in the building manager's getRandomBuilding."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c23c9e699023bdc335786b63755a4c9ab6fd4492", "author": {"user": {"login": "JiaYow", "name": "JiaYow"}}, "url": "https://github.com/ldtteam/minecolonies/commit/c23c9e699023bdc335786b63755a4c9ab6fd4492", "committedDate": "2020-05-11T22:56:18Z", "message": "Added opt-out from deliveryman gathering"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a62d597f05d390d104c1dbc7bce419729bf81b6", "author": {"user": {"login": "JiaYow", "name": "JiaYow"}}, "url": "https://github.com/ldtteam/minecolonies/commit/3a62d597f05d390d104c1dbc7bce419729bf81b6", "committedDate": "2020-05-11T23:16:52Z", "message": "Added PickUpPriorityState's toString() method, and formatted code. Also removed an unnecessary logger call."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDA4MTM2", "url": "https://github.com/ldtteam/minecolonies/pull/4973#pullrequestreview-410008136", "createdAt": "2020-05-12T12:52:55Z", "commit": {"oid": "3a62d597f05d390d104c1dbc7bce419729bf81b6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDU2Nzc1", "url": "https://github.com/ldtteam/minecolonies/pull/4973#pullrequestreview-410056775", "createdAt": "2020-05-12T13:45:29Z", "commit": {"oid": "3a62d597f05d390d104c1dbc7bce419729bf81b6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMzo0NToyOVrOGUHW5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMzo0NToyOVrOGUHW5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc0NTI1NQ==", "bodyText": "Why do we need the int representation, can't we pick the ordinal?", "url": "https://github.com/ldtteam/minecolonies/pull/4973#discussion_r423745255", "createdAt": "2020-05-12T13:45:29Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/colony/buildings/PickUpPriorityState.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package com.minecolonies.api.colony.buildings;\n+\n+public enum PickUpPriorityState\n+{\n+    NEVER(0),\n+    STATIC(1),\n+    AUTOMATIC(2);\n+\n+    /**\n+     * The internal serializable int-representation of this enum.\n+     * We could use Java's ordinal(), but that is VERY error-prone.\n+     * So, do our own instead.\n+     */\n+    private final int intRepresentation;\n+\n+    PickUpPriorityState(final int intRepresentation)\n+    {\n+        this.intRepresentation = intRepresentation;\n+    }\n+\n+    /**\n+     * The integer representation for this enum. Used for message serialization.\n+     *\n+     * @return The integer representation\n+     */\n+    public int getIntRepresentation()\n+    {\n+        return intRepresentation;\n+    }\n+\n+    /**\n+     * Creates the enum from an int. Used for message deserialization.\n+     * This is not DRY, but we're talking about 3 to maybe later 4 values here.\n+     *\n+     * @param intRepresentation The internal representation of the enum.\n+     * @return The corresponding enum.\n+     */\n+    public static PickUpPriorityState fromIntRepresentation(int intRepresentation)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a62d597f05d390d104c1dbc7bce419729bf81b6"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "377e0c143315d0a23ab0eb15cfed8e90286062dd", "author": {"user": {"login": "JiaYow", "name": "JiaYow"}}, "url": "https://github.com/ldtteam/minecolonies/commit/377e0c143315d0a23ab0eb15cfed8e90286062dd", "committedDate": "2020-05-12T18:35:21Z", "message": "Merge branch 'up/version/1.15' into feature/prevent-pickup\n\nConflicts:\n\tsrc/main/java/com/minecolonies/coremod/client/gui/AbstractWindowWorkerBuilding.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2120, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}