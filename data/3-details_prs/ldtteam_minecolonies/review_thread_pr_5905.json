{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTU0NzY4", "number": 5905, "reviewThreads": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzo1MDowMFrOEsgztw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNjoyOFrOEvStLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTEwMzI3OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzo1MDowMFrOHfy4Ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMzoyMjoxMFrOHf-hkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTQ5OQ==", "bodyText": "java.util.List?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503101499", "createdAt": "2020-10-12T07:50:00Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -46,6 +48,11 @@\n      */\n     private final Slot craftResultSlot;\n \n+    /**\n+     * The secondary outputs\n+     */\n+    private final java.util.List<ItemStack> remainingItems;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI4OTEyOQ==", "bodyText": "Yes, just List resolves to something else here.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503289129", "createdAt": "2020-10-12T13:16:58Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -46,6 +48,11 @@\n      */\n     private final Slot craftResultSlot;\n \n+    /**\n+     * The secondary outputs\n+     */\n+    private final java.util.List<ItemStack> remainingItems;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTQ5OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5MjMwNQ==", "bodyText": "Ok, I know what happened, and I have a fix.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503292305", "createdAt": "2020-10-12T13:22:10Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -46,6 +48,11 @@\n      */\n     private final Slot craftResultSlot;\n \n+    /**\n+     * The secondary outputs\n+     */\n+    private final java.util.List<ItemStack> remainingItems;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTQ5OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTEwNjM0OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzo1MDo0OVrOHfy6Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxODoxNDo1OFrOHgIvUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTk3OQ==", "bodyText": "this class might not load because it has the ClientRecipeBook in SMP. have you tested this in smp?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503101979", "createdAt": "2020-10-12T07:50:49Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -365,4 +375,38 @@ public BlockPos getPos()\n     {\n         return pos;\n     }\n+\n+    /**\n+     * Get for the remaining items. \n+     * @return\n+     */\n+    public java.util.List<ItemStack> getRemainingItems()\n+    {\n+        final Optional<ICraftingRecipe> iRecipe = this.world.getRecipeManager().getRecipe(IRecipeType.CRAFTING, craftMatrix, world);\n+        RecipeBook r;\n+        if(world.isRemote)\n+        {\n+            r = new ClientRecipeBook(this.world.getRecipeManager());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMjkzMQ==", "bodyText": "what do we need it for? Just do check if its unlocked? I don't think we should care about that", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503102931", "createdAt": "2020-10-12T07:52:25Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -365,4 +375,38 @@ public BlockPos getPos()\n     {\n         return pos;\n     }\n+\n+    /**\n+     * Get for the remaining items. \n+     * @return\n+     */\n+    public java.util.List<ItemStack> getRemainingItems()\n+    {\n+        final Optional<ICraftingRecipe> iRecipe = this.world.getRecipeManager().getRecipe(IRecipeType.CRAFTING, craftMatrix, world);\n+        RecipeBook r;\n+        if(world.isRemote)\n+        {\n+            r = new ClientRecipeBook(this.world.getRecipeManager());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTk3OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5MjU0OA==", "bodyText": "That's all it's used for. We probably don't need most of the checks there.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503292548", "createdAt": "2020-10-12T13:22:34Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -365,4 +375,38 @@ public BlockPos getPos()\n     {\n         return pos;\n     }\n+\n+    /**\n+     * Get for the remaining items. \n+     * @return\n+     */\n+    public java.util.List<ItemStack> getRemainingItems()\n+    {\n+        final Optional<ICraftingRecipe> iRecipe = this.world.getRecipeManager().getRecipe(IRecipeType.CRAFTING, craftMatrix, world);\n+        RecipeBook r;\n+        if(world.isRemote)\n+        {\n+            r = new ClientRecipeBook(this.world.getRecipeManager());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTk3OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5NjkyMg==", "bodyText": "yeah, remove it then. too error prone having this here.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503296922", "createdAt": "2020-10-12T13:29:59Z", "author": {"login": "Raycoms"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -365,4 +375,38 @@ public BlockPos getPos()\n     {\n         return pos;\n     }\n+\n+    /**\n+     * Get for the remaining items. \n+     * @return\n+     */\n+    public java.util.List<ItemStack> getRemainingItems()\n+    {\n+        final Optional<ICraftingRecipe> iRecipe = this.world.getRecipeManager().getRecipe(IRecipeType.CRAFTING, craftMatrix, world);\n+        RecipeBook r;\n+        if(world.isRemote)\n+        {\n+            r = new ClientRecipeBook(this.world.getRecipeManager());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTk3OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ1OTY2NQ==", "bodyText": "Gone", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503459665", "createdAt": "2020-10-12T18:14:58Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -365,4 +375,38 @@ public BlockPos getPos()\n     {\n         return pos;\n     }\n+\n+    /**\n+     * Get for the remaining items. \n+     * @return\n+     */\n+    public java.util.List<ItemStack> getRemainingItems()\n+    {\n+        final Optional<ICraftingRecipe> iRecipe = this.world.getRecipeManager().getRecipe(IRecipeType.CRAFTING, craftMatrix, world);\n+        RecipeBook r;\n+        if(world.isRemote)\n+        {\n+            r = new ClientRecipeBook(this.world.getRecipeManager());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMTk3OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTExNTI2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/client/gui/containers/WindowFurnaceCrafting.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzo1MzoxMFrOHfy_fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxODoyODo1OFrOHgJG0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMzM1OA==", "bodyText": "why not an empty list?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503103358", "createdAt": "2020-10-12T07:53:10Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/client/gui/containers/WindowFurnaceCrafting.java", "diffHunk": "@@ -100,7 +101,7 @@ public void onPress(final Button button)\n \n                 if (!ItemStackUtils.isEmpty(primaryOutput))\n                 {\n-                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, false));\n+                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, null, false));\n                 }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI4OTc0Nw==", "bodyText": "We could, but it will become an empty list either way due to the recipestorage constructor.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503289747", "createdAt": "2020-10-12T13:18:00Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/client/gui/containers/WindowFurnaceCrafting.java", "diffHunk": "@@ -100,7 +101,7 @@ public void onPress(final Button button)\n \n                 if (!ItemStackUtils.isEmpty(primaryOutput))\n                 {\n-                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, false));\n+                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, null, false));\n                 }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMzM1OA=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ2NTY4MQ==", "bodyText": "Went ahead and did an empty list.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503465681", "createdAt": "2020-10-12T18:28:58Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/client/gui/containers/WindowFurnaceCrafting.java", "diffHunk": "@@ -100,7 +101,7 @@ public void onPress(final Button button)\n \n                 if (!ItemStackUtils.isEmpty(primaryOutput))\n                 {\n-                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, false));\n+                    Network.getNetwork().sendToServer(new AddRemoveRecipeMessage(building, input, 1, primaryOutput, null, false));\n                 }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwMzM1OA=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTEyOTAwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzo1Njo0N1rOHfzHqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDo0MToyOVrOHhWjpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNTQ0OQ==", "bodyText": "Either we should \"break;\" at first found, or do something else, because we override firstfound with each iteration.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503105449", "createdAt": "2020-10-12T07:56:47Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -215,7 +215,12 @@ public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n                 final ItemStorage checkItem = foo.getKey().getCleanedInput().stream().max(Comparator.comparingInt(ItemStorage::getAmount)).get();\n                 candidates.put(foo.getKey(), getWarehouseCount(checkItem));\n             }\n-            return candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();\n+            firstFound = candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5NjIzMg==", "bodyText": "In the scan loop, we check against null before setting it, This highlighted one is in an \"If\", after populating counts, so we're only overriding it once in case we're adjusting for warehouse inventory.\nThis is followed by another if, where we check for a multi-output, and convert it to a simple if so.\nThat's a total of 3 sets maximum.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503296232", "createdAt": "2020-10-12T13:28:49Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -215,7 +215,12 @@ public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n                 final ItemStorage checkItem = foo.getKey().getCleanedInput().stream().max(Comparator.comparingInt(ItemStorage::getAmount)).get();\n                 candidates.put(foo.getKey(), getWarehouseCount(checkItem));\n             }\n-            return candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();\n+            firstFound = candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNTQ0OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5NzU2NA==", "bodyText": "But then \"firstFound\" is not exactly the right name, right?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503297564", "createdAt": "2020-10-12T13:30:58Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -215,7 +215,12 @@ public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n                 final ItemStorage checkItem = foo.getKey().getCleanedInput().stream().max(Comparator.comparingInt(ItemStorage::getAmount)).get();\n                 candidates.put(foo.getKey(), getWarehouseCount(checkItem));\n             }\n-            return candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();\n+            firstFound = candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNTQ0OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5OTI2MA==", "bodyText": "Fair point", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503299260", "createdAt": "2020-10-12T13:33:45Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -215,7 +215,12 @@ public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n                 final ItemStorage checkItem = foo.getKey().getCleanedInput().stream().max(Comparator.comparingInt(ItemStorage::getAmount)).get();\n                 candidates.put(foo.getKey(), getWarehouseCount(checkItem));\n             }\n-            return candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();\n+            firstFound = candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNTQ0OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDczNDYyOA==", "bodyText": "I should note that this has been renamed.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504734628", "createdAt": "2020-10-14T14:41:29Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -215,7 +215,12 @@ public IRecipeStorage getFirstRecipe(final Predicate<ItemStack> stackPredicate)\n                 final ItemStorage checkItem = foo.getKey().getCleanedInput().stream().max(Comparator.comparingInt(ItemStorage::getAmount)).get();\n                 candidates.put(foo.getKey(), getWarehouseCount(checkItem));\n             }\n-            return candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();\n+            firstFound = candidates.entrySet().stream().min(Map.Entry.comparingByValue(Comparator.reverseOrder())).get().getKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNTQ0OQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTE0NDIxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwODowMDozOVrOHfzQtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMzozMToxN1rOHf-22A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNzc2NQ==", "bodyText": "isMustExist seems weird", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503107765", "createdAt": "2020-10-12T08:00:39Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -851,16 +857,34 @@ public void checkForWorkerSpecificRecipes()\n                         }\n                         if(allMatch)\n                         {\n-                            duplicateFound = true;\n+                            duplicateFound = token;\n                             break;\n                         }\n                     }\n                 }\n-                if(!duplicateFound)\n+                if(duplicateFound == null)\n                 {\n                     addRecipeToList(recipeToken);    \n                     colony.getRequestManager().onColonyUpdate(request -> request.getRequest() instanceof IDeliverable && ((IDeliverable) request.getRequest()).matches(recipeStorage.getPrimaryOutput()));\n                 }\n+                else if(newRecipe.isMustExist() && duplicateFound != recipeToken)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5MDExNA==", "bodyText": "The name? or the functionality?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503290114", "createdAt": "2020-10-12T13:18:40Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -851,16 +857,34 @@ public void checkForWorkerSpecificRecipes()\n                         }\n                         if(allMatch)\n                         {\n-                            duplicateFound = true;\n+                            duplicateFound = token;\n                             break;\n                         }\n                     }\n                 }\n-                if(!duplicateFound)\n+                if(duplicateFound == null)\n                 {\n                     addRecipeToList(recipeToken);    \n                     colony.getRequestManager().onColonyUpdate(request -> request.getRequest() instanceof IDeliverable && ((IDeliverable) request.getRequest()).matches(recipeStorage.getPrimaryOutput()));\n                 }\n+                else if(newRecipe.isMustExist() && duplicateFound != recipeToken)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNzc2NQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5MDc5NQ==", "bodyText": "the name", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503290795", "createdAt": "2020-10-12T13:19:42Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -851,16 +857,34 @@ public void checkForWorkerSpecificRecipes()\n                         }\n                         if(allMatch)\n                         {\n-                            duplicateFound = true;\n+                            duplicateFound = token;\n                             break;\n                         }\n                     }\n                 }\n-                if(!duplicateFound)\n+                if(duplicateFound == null)\n                 {\n                     addRecipeToList(recipeToken);    \n                     colony.getRequestManager().onColonyUpdate(request -> request.getRequest() instanceof IDeliverable && ((IDeliverable) request.getRequest()).matches(recipeStorage.getPrimaryOutput()));\n                 }\n+                else if(newRecipe.isMustExist() && duplicateFound != recipeToken)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNzc2NQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5Nzc1Mg==", "bodyText": "Got it. Happy to 'break the standard' here of 'is' for boolean and switch to 'get'", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r503297752", "createdAt": "2020-10-12T13:31:17Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -851,16 +857,34 @@ public void checkForWorkerSpecificRecipes()\n                         }\n                         if(allMatch)\n                         {\n-                            duplicateFound = true;\n+                            duplicateFound = token;\n                             break;\n                         }\n                     }\n                 }\n-                if(!duplicateFound)\n+                if(duplicateFound == null)\n                 {\n                     addRecipeToList(recipeToken);    \n                     colony.getRequestManager().onColonyUpdate(request -> request.getRequest() instanceof IDeliverable && ((IDeliverable) request.getRequest()).matches(recipeStorage.getPrimaryOutput()));\n                 }\n+                else if(newRecipe.isMustExist() && duplicateFound != recipeToken)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwNzc2NQ=="}, "originalCommit": {"oid": "963f76978e4724fcb8052b85d225f4a0a12ea26f"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc0Mjg4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/resolvers/core/AbstractCraftingProductionResolver.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjozODoyMFrOHhESDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzo1Nzo1NVrOHhUcPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTIxMw==", "bodyText": "Why this change? Documentation is missing here. The original code makes more sense....", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504435213", "createdAt": "2020-10-14T06:38:20Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/resolvers/core/AbstractCraftingProductionResolver.java", "diffHunk": "@@ -148,13 +148,13 @@ protected boolean canBuildingCraftStack(@NotNull final IRequestManager manager,\n                 {\n                     materialRequests.add(createNewRequestForStack(manager, craftingHelperStack, ingredient.getAmount(), ingredient.getAmount()));\n                 }\n-                else if (!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(container, craftingHelperStack, false, true))\n+                else if (ItemStackUtils.isEmpty(container) || ItemStackUtils.compareItemStacksIgnoreStackSize(container, craftingHelperStack, false, true))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5OTk2Ng==", "bodyText": "reverted", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504699966", "createdAt": "2020-10-14T13:57:55Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/resolvers/core/AbstractCraftingProductionResolver.java", "diffHunk": "@@ -148,13 +148,13 @@ protected boolean canBuildingCraftStack(@NotNull final IRequestManager manager,\n                 {\n                     materialRequests.add(createNewRequestForStack(manager, craftingHelperStack, ingredient.getAmount(), ingredient.getAmount()));\n                 }\n-                else if (!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(container, craftingHelperStack, false, true))\n+                else if (ItemStackUtils.isEmpty(container) || ItemStackUtils.compareItemStacksIgnoreStackSize(container, craftingHelperStack, false, true))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTIxMw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc0NDc0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjozODo1N1rOHhETIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzo1ODowNVrOHhUcpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTQ4OQ==", "bodyText": "Again this change. These kind of suttle changes need to be documented if it is not a hotfix.\nWhy? This logic does not seem to make sense to me.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504435489", "createdAt": "2020-10-14T06:38:57Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "diffHunk": "@@ -173,13 +175,13 @@ protected IAIState getRecipe()\n             {\n                 remaining = inputStorage.getAmount();\n             }\n-            else if (!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))\n+            else if (ItemStackUtils.isEmpty(container) || !ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwMDA3MA==", "bodyText": "reverted", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504700070", "createdAt": "2020-10-14T13:58:05Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "diffHunk": "@@ -173,13 +175,13 @@ protected IAIState getRecipe()\n             {\n                 remaining = inputStorage.getAmount();\n             }\n-            else if (!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))\n+            else if (ItemStackUtils.isEmpty(container) || !ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTQ4OQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc0NzM5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjozOTo0NVrOHhEUmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzo1ODoxMVrOHhUc6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTg2Nw==", "bodyText": "and again! Here it is even worse, Since here the second part of the OR-Clause has a negation but in the previous cases where you patches this it did not. Why was this changed?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504435867", "createdAt": "2020-10-14T06:39:45Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "diffHunk": "@@ -251,13 +253,13 @@ protected IAIState checkForItems(@NotNull final IRecipeStorage storage)\n             {\n                 remaining = inputStorage.getAmount();\n             }\n-            else if(!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))\n+            else if(ItemStackUtils.isEmpty(container) || !ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwMDEzNg==", "bodyText": "reverted", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504700136", "createdAt": "2020-10-14T13:58:11Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/entity/ai/basic/AbstractEntityAICrafting.java", "diffHunk": "@@ -251,13 +253,13 @@ protected IAIState checkForItems(@NotNull final IRecipeStorage storage)\n             {\n                 remaining = inputStorage.getAmount();\n             }\n-            else if(!ItemStackUtils.isEmpty(container) && ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))\n+            else if(ItemStackUtils.isEmpty(container) || !ItemStackUtils.compareItemStacksIgnoreStackSize(inputStorage.getItemStack(), container , false, true))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNTg2Nw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc0OTMzOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0MDoyNVrOHhEVtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwNDozNjo0MFrOHjUMqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjE1MA==", "bodyText": "Not expandable!\nThis is part of the API. ENUMS are basically a nogo here.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504436150", "createdAt": "2020-10-14T06:40:25Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -8,12 +8,22 @@\n \n import java.util.Arrays;\n import java.util.List;\n+import java.util.function.Predicate;\n \n /**\n  * Interface which describes the RecipeStorage.\n  */\n public interface IRecipeStorage\n {\n+    /**\n+     * Enum of the different types of storage\n+     */\n+    public enum RecipeStorageType", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MzEyOQ==", "bodyText": "Switched to Registry", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r506793129", "createdAt": "2020-10-17T04:36:40Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -8,12 +8,22 @@\n \n import java.util.Arrays;\n import java.util.List;\n+import java.util.function.Predicate;\n \n /**\n  * Interface which describes the RecipeStorage.\n  */\n public interface IRecipeStorage\n {\n+    /**\n+     * Enum of the different types of storage\n+     */\n+    public enum RecipeStorageType", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjE1MA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc1MTk3OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorageFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0MToyM1rOHhEXOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDoxMTo0MFrOHhVFRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjUzNg==", "bodyText": "Documentation is not updated. What is source?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504436536", "createdAt": "2020-10-14T06:41:23Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorageFactory.java", "diffHunk": "@@ -70,6 +83,11 @@ RecipeStorage getNewInstance(\n       @NotNull final List<ItemStack> input,\n       final int gridSize,\n       @NotNull final ItemStack primaryOutput,\n-      @Nullable final Block intermediate);\n+      @Nullable final Block intermediate,\n+      @Nullable final String source,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcxMDQ2OA==", "bodyText": "documentation updated", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504710468", "createdAt": "2020-10-14T14:11:40Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorageFactory.java", "diffHunk": "@@ -70,6 +83,11 @@ RecipeStorage getNewInstance(\n       @NotNull final List<ItemStack> input,\n       final int gridSize,\n       @NotNull final ItemStack primaryOutput,\n-      @Nullable final Block intermediate);\n+      @Nullable final Block intermediate,\n+      @Nullable final String source,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjUzNg=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc1NDQyOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0MjoxM1rOHhEYpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo1MToxOFrOHhecdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjkwMQ==", "bodyText": "If this is supposed to be a registry name, or reference one, Make it return a ResourceLocation instead,\nIf the return value is optional, mark it with @Nullable or return an optional and make the use of it like a functional invocation.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504436901", "createdAt": "2020-10-14T06:42:13Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -72,6 +82,45 @@ default boolean fullFillRecipe(@NotNull final IItemHandler... inventories)\n      */\n     boolean fullfillRecipe(final List<IItemHandler> handlers);\n \n+    /**\n+     * Get which type this recipe is\n+     * CLASSIC or MULTI-OUTPUT are the only valid ones currently\n+     * @return The recipe type\n+     */\n+    public RecipeStorageType getRecipeType();\n+\n+    /**\n+     * Get a list of alternates to getPrimaryOutput\n+     * @return a list if Itemstacks that this recipe can produce instead of getPrimaryOutput\n+     */\n+    public List<ItemStack> getAlternateOutputs();\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param requiredOutput Which output wanted\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(ItemStack requiredOutput);\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param stackPredicate Predicate to select the right stack\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(final Predicate<ItemStack> stackPredicate);\n+\n+    /**\n+     * Source of the recipe, ie registry name.\n+     * @return\n+     */\n+    public String getRecipeSource();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY4NjA1Nw==", "bodyText": "I thought about that, I'd intended to support a variety of sources, including possibly player name. None of that is done yet though.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504686057", "createdAt": "2020-10-14T13:41:30Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -72,6 +82,45 @@ default boolean fullFillRecipe(@NotNull final IItemHandler... inventories)\n      */\n     boolean fullfillRecipe(final List<IItemHandler> handlers);\n \n+    /**\n+     * Get which type this recipe is\n+     * CLASSIC or MULTI-OUTPUT are the only valid ones currently\n+     * @return The recipe type\n+     */\n+    public RecipeStorageType getRecipeType();\n+\n+    /**\n+     * Get a list of alternates to getPrimaryOutput\n+     * @return a list if Itemstacks that this recipe can produce instead of getPrimaryOutput\n+     */\n+    public List<ItemStack> getAlternateOutputs();\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param requiredOutput Which output wanted\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(ItemStack requiredOutput);\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param stackPredicate Predicate to select the right stack\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(final Predicate<ItemStack> stackPredicate);\n+\n+    /**\n+     * Source of the recipe, ie registry name.\n+     * @return\n+     */\n+    public String getRecipeSource();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjkwMQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDczODU4Nw==", "bodyText": "Then document it as such.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504738587", "createdAt": "2020-10-14T14:46:24Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -72,6 +82,45 @@ default boolean fullFillRecipe(@NotNull final IItemHandler... inventories)\n      */\n     boolean fullfillRecipe(final List<IItemHandler> handlers);\n \n+    /**\n+     * Get which type this recipe is\n+     * CLASSIC or MULTI-OUTPUT are the only valid ones currently\n+     * @return The recipe type\n+     */\n+    public RecipeStorageType getRecipeType();\n+\n+    /**\n+     * Get a list of alternates to getPrimaryOutput\n+     * @return a list if Itemstacks that this recipe can produce instead of getPrimaryOutput\n+     */\n+    public List<ItemStack> getAlternateOutputs();\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param requiredOutput Which output wanted\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(ItemStack requiredOutput);\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param stackPredicate Predicate to select the right stack\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(final Predicate<ItemStack> stackPredicate);\n+\n+    /**\n+     * Source of the recipe, ie registry name.\n+     * @return\n+     */\n+    public String getRecipeSource();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjkwMQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2Mzg2Mg==", "bodyText": "I'll go ahead and convert to ResourceLocation, since there are difficulties in overloading it the way I planned with the way I ended up using it.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504863862", "createdAt": "2020-10-14T17:51:18Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/IRecipeStorage.java", "diffHunk": "@@ -72,6 +82,45 @@ default boolean fullFillRecipe(@NotNull final IItemHandler... inventories)\n      */\n     boolean fullfillRecipe(final List<IItemHandler> handlers);\n \n+    /**\n+     * Get which type this recipe is\n+     * CLASSIC or MULTI-OUTPUT are the only valid ones currently\n+     * @return The recipe type\n+     */\n+    public RecipeStorageType getRecipeType();\n+\n+    /**\n+     * Get a list of alternates to getPrimaryOutput\n+     * @return a list if Itemstacks that this recipe can produce instead of getPrimaryOutput\n+     */\n+    public List<ItemStack> getAlternateOutputs();\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param requiredOutput Which output wanted\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(ItemStack requiredOutput);\n+\n+    /**\n+     * Get the classic version of this recipe with GetPrimaryOutput targetted correctly from the chosen alternate\n+     * @param stackPredicate Predicate to select the right stack\n+     * @return the RecipeStorage that is \"right\" for that output\n+     */\n+    public RecipeStorage getClassicForMultiOutput(final Predicate<ItemStack> stackPredicate);\n+\n+    /**\n+     * Source of the recipe, ie registry name.\n+     * @return\n+     */\n+    public String getRecipeSource();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNjkwMQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc1NTU5OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0MjozNlrOHhEZVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0MjozNlrOHhEZVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNzA3Ng==", "bodyText": "See comments on the interface for this.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504437076", "createdAt": "2020-10-14T06:42:36Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -2,24 +2,40 @@\n \n import com.google.common.collect.ImmutableList;\n import com.ldtteam.structurize.items.ModItems;\n+import com.minecolonies.api.colony.requestsystem.StandardFactoryController;\n import com.minecolonies.api.colony.requestsystem.token.IToken;\n import com.minecolonies.api.util.CraftingUtils;\n import com.minecolonies.api.util.InventoryUtils;\n import com.minecolonies.api.util.ItemStackUtils;\n+import com.minecolonies.api.util.constant.TypeConstants;\n import net.minecraft.block.Block;\n import net.minecraft.item.ItemStack;\n import net.minecraftforge.items.IItemHandler;\n import org.jetbrains.annotations.NotNull;\n-\n+import org.jetbrains.annotations.Nullable;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n+import java.util.function.Predicate;\n+import java.util.stream.Collectors;\n \n /**\n  * Class used to represent a recipe in minecolonies.\n  */\n public class RecipeStorage implements IRecipeStorage\n {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc2MDI4OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0NDoyMFrOHhEcNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDowMjoxM1rOHhUo3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNzgxMg==", "bodyText": "I am not sure, but this does not look like it was autogenerated by IDEA!", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504437812", "createdAt": "2020-10-14T06:44:20Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -216,6 +312,22 @@ public int hashCode()\n         result = 31 * result + primaryOutput.hashCode();\n         result = 31 * result + (intermediate != null ? intermediate.hashCode() : 0);\n         result = 31 * result + gridSize;\n+        if(recipeSource != null && !recipeSource.isEmpty())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 185}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwMzE5Nw==", "bodyText": "I don't use IDEA, so I was trying to keep in line.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504703197", "createdAt": "2020-10-14T14:02:13Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -216,6 +312,22 @@ public int hashCode()\n         result = 31 * result + primaryOutput.hashCode();\n         result = 31 * result + (intermediate != null ? intermediate.hashCode() : 0);\n         result = 31 * result + gridSize;\n+        if(recipeSource != null && !recipeSource.isEmpty())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzNzgxMg=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 185}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc2MzkwOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0NTozMlrOHhEeQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo1MjozNFrOHhefZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODMzOQ==", "bodyText": "This does not work........\nThe API clearly states that the container Item is returned when the stack is consumed! You are not allowed to modify this stack willy nilly since that violates that contract. There might be mods out there which consume an entire stack and only return 1 container item!", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504438339", "createdAt": "2020-10-14T06:45:32Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +340,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 224}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5MzE5MA==", "bodyText": "Either way this does not work, since we operate off of cleaned inputs. In the case of cake, the stack is 2 milk buckets, and getContainerItem returns one bucket, but vanilla crafting returns 2. The good news is that this code is legacy/compat. With the secondary items list, we return what the recipe says gets returned.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504693190", "createdAt": "2020-10-14T13:49:18Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +340,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODMzOQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 224}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDczOTIxMg==", "bodyText": "If this is legacy code. Why was it added in your PR?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504739212", "createdAt": "2020-10-14T14:47:12Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +340,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODMzOQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 224}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2NDYxNQ==", "bodyText": "The container case becomes legacy code with this PR, there was a bug reported around producing too few buckets while I was working on it, so I included it to avoid more merge conflicts.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504864615", "createdAt": "2020-10-14T17:52:34Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +340,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODMzOQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 224}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc2NTIwOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0NjowMFrOHhEe9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0NjowMFrOHhEe9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODUxOA==", "bodyText": "Again see above this is not a legal use of the API as far as I am concerned.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504438518", "createdAt": "2020-10-14T06:46:00Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -329,29 +448,36 @@ public boolean fullfillRecipe(final List<IItemHandler> handlers)\n      *\n      * @param handlers the handlers.\n      */\n-    private void insertCraftedItems(final List<IItemHandler> handlers)\n+    private void insertCraftedItems(final List<IItemHandler> handlers, ItemStack outputStack)\n     {\n         for (final IItemHandler handler : handlers)\n         {\n-            if (InventoryUtils.addItemStackToItemHandler(handler, getPrimaryOutput().copy()))\n+            if (InventoryUtils.addItemStackToItemHandler(handler, outputStack.copy()))\n             {\n                 break;\n             }\n         }\n \n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n         {\n-            if (stack.getItem() == ModItems.buildTool)\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n+        {\n+            for (final ItemStack stack : input)\n             {\n-                continue;\n-            }\n+                if (stack.getItem() == ModItems.buildTool)\n+                {\n+                    continue;\n+                }\n \n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n-            {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 281}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc2ODA3OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0NzowOFrOHhEguw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo1NTo1OVrOHhen3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODk3MQ==", "bodyText": "You are in the API, no special casing of Minecolonies specific stuff.\nCreate a new Interface if you want to and smag that on the buildtool then do an instance of.\nOr create a behaviour registry.\nRegardless either refactor this class so that it is not part of the API or refactor it so that it does not do any special casing.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504438971", "createdAt": "2020-10-14T06:47:08Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -329,29 +448,36 @@ public boolean fullfillRecipe(final List<IItemHandler> handlers)\n      *\n      * @param handlers the handlers.\n      */\n-    private void insertCraftedItems(final List<IItemHandler> handlers)\n+    private void insertCraftedItems(final List<IItemHandler> handlers, ItemStack outputStack)\n     {\n         for (final IItemHandler handler : handlers)\n         {\n-            if (InventoryUtils.addItemStackToItemHandler(handler, getPrimaryOutput().copy()))\n+            if (InventoryUtils.addItemStackToItemHandler(handler, outputStack.copy()))\n             {\n                 break;\n             }\n         }\n \n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n         {\n-            if (stack.getItem() == ModItems.buildTool)\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n+        {\n+            for (final ItemStack stack : input)\n             {\n-                continue;\n-            }\n+                if (stack.getItem() == ModItems.buildTool)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 268}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2Njc4Mg==", "bodyText": "Ok, the buildTool exception is pre-existing. We make this exception in 3 places in this file.  Changing this item is a Structurize change.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504866782", "createdAt": "2020-10-14T17:55:59Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -329,29 +448,36 @@ public boolean fullfillRecipe(final List<IItemHandler> handlers)\n      *\n      * @param handlers the handlers.\n      */\n-    private void insertCraftedItems(final List<IItemHandler> handlers)\n+    private void insertCraftedItems(final List<IItemHandler> handlers, ItemStack outputStack)\n     {\n         for (final IItemHandler handler : handlers)\n         {\n-            if (InventoryUtils.addItemStackToItemHandler(handler, getPrimaryOutput().copy()))\n+            if (InventoryUtils.addItemStackToItemHandler(handler, outputStack.copy()))\n             {\n                 break;\n             }\n         }\n \n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n         {\n-            if (stack.getItem() == ModItems.buildTool)\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n+        {\n+            for (final ItemStack stack : input)\n             {\n-                continue;\n-            }\n+                if (stack.getItem() == ModItems.buildTool)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzODk3MQ=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 268}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc3MDIxOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0Nzo1M1rOHhEiCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo1NjozNlrOHhepMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzOTMwNA==", "bodyText": "You are in the concrete implementation, you do not need to use the factory controller......\nYou can invoke yourself just fine,", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504439304", "createdAt": "2020-10-14T06:47:53Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -365,4 +491,65 @@ private void insertCraftedItems(final List<IItemHandler> handlers)\n             }\n         }\n     }\n+\n+    @Override\n+    public RecipeStorage getClassicForMultiOutput(final ItemStack requiredOutput)\n+    {\n+        return StandardFactoryController.getInstance().getNewInstance(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 295}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2NzEyMw==", "bodyText": "Yeah, cleaning this up", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504867123", "createdAt": "2020-10-14T17:56:36Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -365,4 +491,65 @@ private void insertCraftedItems(final List<IItemHandler> handlers)\n             }\n         }\n     }\n+\n+    @Override\n+    public RecipeStorage getClassicForMultiOutput(final ItemStack requiredOutput)\n+    {\n+        return StandardFactoryController.getInstance().getNewInstance(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzOTMwNA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 295}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc3MjU2OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0ODo0MlrOHhEjWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzo1MTo1NVrOHhUJuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzOTY0Mg==", "bodyText": "Import of Client side only stuff.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504439642", "createdAt": "2020-10-14T06:48:42Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -2,6 +2,7 @@\n \n import com.ldtteam.structurize.api.util.ItemStackUtils;\n import com.minecolonies.api.inventory.ModContainers;\n+import net.minecraft.client.util.ClientRecipeBook;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5NTIyNA==", "bodyText": "Missed cleanup from earlier versions.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504695224", "createdAt": "2020-10-14T13:51:55Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/inventory/container/ContainerCrafting.java", "diffHunk": "@@ -2,6 +2,7 @@\n \n import com.ldtteam.structurize.api.util.ItemStackUtils;\n import com.minecolonies.api.inventory.ModContainers;\n+import net.minecraft.client.util.ClientRecipeBook;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQzOTY0Mg=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc3NTM3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/client/gui/WindowListRecipes.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo0OTo0MlrOHhElBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwNDozNjo1NFrOHjUMuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDA3MA==", "bodyText": "This comes with the teritory of writing Enums in the API.\nRefactor this so that the recipe type can handle it itself.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504440070", "createdAt": "2020-10-14T06:49:42Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/client/gui/WindowListRecipes.java", "diffHunk": "@@ -111,7 +119,23 @@ public void updateElement(final int index, @NotNull final Pane rowPane)\n             {\n                 @NotNull final IRecipeStorage recipe = recipes.get(index);\n                 final ItemIcon icon = rowPane.findPaneOfTypeByID(OUTPUT_ICON, ItemIcon.class);\n-                icon.setItem(recipe.getPrimaryOutput());\n+                if(recipe.getRecipeType() == RecipeStorageType.MULTI_OUTPUT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MzE0NA==", "bodyText": "See switch to registry", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r506793144", "createdAt": "2020-10-17T04:36:54Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/client/gui/WindowListRecipes.java", "diffHunk": "@@ -111,7 +119,23 @@ public void updateElement(final int index, @NotNull final Pane rowPane)\n             {\n                 @NotNull final IRecipeStorage recipe = recipes.get(index);\n                 final ItemIcon icon = rowPane.findPaneOfTypeByID(OUTPUT_ICON, ItemIcon.class);\n-                icon.setItem(recipe.getPrimaryOutput());\n+                if(recipe.getRecipeType() == RecipeStorageType.MULTI_OUTPUT)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDA3MA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc3OTk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo1MTowNFrOHhEnnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNDo1MjowNVrOHhXEmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDczMw==", "bodyText": "Is this not supposed to be default behaviour?\nWhy was this added here?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504440733", "createdAt": "2020-10-14T06:51:04Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "diffHunk": "@@ -284,6 +284,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.archery;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5Njg3Mg==", "bodyText": "All of our buildings where citizens sleep have this code. I missed porting it when I enabled sleeping in the Archery and the Combat Academy, which meant that the citizens would sleep one night, and go about there business the next day with the beds still marked occupied. The next night, they couldn't find a bed, so would stand around the hut sleeping.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504696872", "createdAt": "2020-10-14T13:54:02Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "diffHunk": "@@ -284,6 +284,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.archery;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDczMw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5ODY1Mg==", "bodyText": "This will be solved in the future when we modularize this", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504698652", "createdAt": "2020-10-14T13:56:14Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "diffHunk": "@@ -284,6 +284,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.archery;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDczMw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc0MDMyMg==", "bodyText": "Okey....\nThen create an interface with a default set of methods that handle this? ANd smag that on all buildings?+\nI see no reason this can not be cleaned up.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504740322", "createdAt": "2020-10-14T14:48:38Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "diffHunk": "@@ -284,6 +284,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.archery;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDczMw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc0MzA2Nw==", "bodyText": "I got a PR going atm that will clean that up. Might need another week to be mature though", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504743067", "createdAt": "2020-10-14T14:52:05Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingArchery.java", "diffHunk": "@@ -284,6 +284,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.archery;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MDczMw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc4MjA4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCombatAcademy.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo1MTozOFrOHhEoxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzo1NDoxN1rOHhUQ7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTAyOA==", "bodyText": "Again this is supposed to be default behaviour for the entity.\nWhy was this not handled there.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504441028", "createdAt": "2020-10-14T06:51:38Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCombatAcademy.java", "diffHunk": "@@ -378,6 +378,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.combatAcademy;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5NzA2OQ==", "bodyText": "The entities do not handle this for any of our buildings.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504697069", "createdAt": "2020-10-14T13:54:17Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingCombatAcademy.java", "diffHunk": "@@ -378,6 +378,30 @@ public BuildingEntry getBuildingRegistryEntry()\n         return ModBuildings.combatAcademy;\n     }\n \n+    @Override\n+    public void onWakeUp()\n+    {\n+        super.onWakeUp();\n+        \n+        final World world = getColony().getWorld();\n+        if (world == null)\n+        {\n+            return;\n+        }\n+\n+        for (final BlockPos pos : bedList)\n+        {\n+            BlockState state = world.getBlockState(pos);\n+            state = state.getBlock().getExtendedState(state, world, pos);\n+            if (state.getBlock() instanceof BedBlock\n+                  && state.get(BedBlock.OCCUPIED)\n+                  && state.get(BedBlock.PART).equals(BedPart.HEAD))\n+            {\n+                world.setBlockState(pos, state.with(BedBlock.OCCUPIED, false), 0x03);\n+            }\n+        }\n+    }    ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTAyOA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc4NDI1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/crafting/CustomRecipe.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo1MjoxNVrOHhEp7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwMzo0Nzo0MFrOHjT-ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTMyNw==", "bodyText": "e instanceof JsonElement is always true.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504441327", "createdAt": "2020-10-14T06:52:15Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/crafting/CustomRecipe.java", "diffHunk": "@@ -234,6 +268,27 @@ public static CustomRecipe parse(@NotNull final JsonObject recipeJson)\n             recipe.result = idToItemStack(recipeJson.get(RECIPE_RESULT_PROP).getAsString());\n         }\n \n+        if (recipeJson.has(RECIPE_ALTERNATE_PROP))\n+        {\n+            for (JsonElement e : recipeJson.get(RECIPE_ALTERNATE_PROP).getAsJsonArray())\n+            {\n+                if (e instanceof JsonElement && e.isJsonObject())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTQ3Ng==", "bodyText": "Yeah. got it.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r506789476", "createdAt": "2020-10-17T03:47:40Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/crafting/CustomRecipe.java", "diffHunk": "@@ -234,6 +268,27 @@ public static CustomRecipe parse(@NotNull final JsonObject recipeJson)\n             recipe.result = idToItemStack(recipeJson.get(RECIPE_RESULT_PROP).getAsString());\n         }\n \n+        if (recipeJson.has(RECIPE_ALTERNATE_PROP))\n+        {\n+            for (JsonElement e : recipeJson.get(RECIPE_ALTERNATE_PROP).getAsJsonArray())\n+            {\n+                if (e instanceof JsonElement && e.isJsonObject())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTMyNw=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1OTc4NzgxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/requests/StandardRequests.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjo1MzozNlrOHhEsLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwNDowNDoyNVrOHjUDGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTkwMA==", "bodyText": "This makes no sense.\nWhat are you trying to achieve here?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504441900", "createdAt": "2020-10-14T06:53:36Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/requests/StandardRequests.java", "diffHunk": "@@ -343,11 +343,9 @@ protected AbstractCraftingRequest(\n         public final ITextComponent getShortDisplayString()\n         {\n             final ITextComponent result = new NonSiblingFormattingTextComponent();\n-            final ITextComponent preType = new TranslationTextComponent(getTranslationKey());\n \n-            result.appendSibling(preType);\n-\n-            preType.appendSibling(getRequest().getStack().getTextComponent());\n+            result.appendSibling(new StringTextComponent(getRequest().getMinCount() + \" * Recipe:\"));\n+            result.appendSibling(getRequest().getStack().getTextComponent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MjAwOA==", "bodyText": "Also not localizable!", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r504442008", "createdAt": "2020-10-14T06:53:53Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/requests/StandardRequests.java", "diffHunk": "@@ -343,11 +343,9 @@ protected AbstractCraftingRequest(\n         public final ITextComponent getShortDisplayString()\n         {\n             final ITextComponent result = new NonSiblingFormattingTextComponent();\n-            final ITextComponent preType = new TranslationTextComponent(getTranslationKey());\n \n-            result.appendSibling(preType);\n-\n-            preType.appendSibling(getRequest().getStack().getTextComponent());\n+            result.appendSibling(new StringTextComponent(getRequest().getMinCount() + \" * Recipe:\"));\n+            result.appendSibling(getRequest().getStack().getTextComponent());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTkwMA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDY4MQ==", "bodyText": "Updated to be localizable, this now produces a string like \"8 * Recipe: [Plain Oak Timber Frame]\" for the crafting job entry in the request tree.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r506790681", "createdAt": "2020-10-17T04:04:25Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/requestsystem/requests/StandardRequests.java", "diffHunk": "@@ -343,11 +343,9 @@ protected AbstractCraftingRequest(\n         public final ITextComponent getShortDisplayString()\n         {\n             final ITextComponent result = new NonSiblingFormattingTextComponent();\n-            final ITextComponent preType = new TranslationTextComponent(getTranslationKey());\n \n-            result.appendSibling(preType);\n-\n-            preType.appendSibling(getRequest().getStack().getTextComponent());\n+            result.appendSibling(new StringTextComponent(getRequest().getMinCount() + \" * Recipe:\"));\n+            result.appendSibling(getRequest().getStack().getTextComponent());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ0MTkwMA=="}, "originalCommit": {"oid": "cd7d39c0f14a008ef8c185f0dc1698d5225498c0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTg5NDIyOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/AbstractRecipeType.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMDo1NzozMFrOHkI2Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNDoyMzowMFrOHkRFVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NTc4Mw==", "bodyText": "Missing override indicators in this class.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507655783", "createdAt": "2020-10-19T10:57:30Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/AbstractRecipeType.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.List;\n+import com.google.common.collect.ImmutableList;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public abstract class AbstractRecipeType<R extends IRecipeStorage>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY4NTU5Mg==", "bodyText": "and class jdoc", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507685592", "createdAt": "2020-10-19T11:53:58Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/crafting/AbstractRecipeType.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.List;\n+import com.google.common.collect.ImmutableList;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public abstract class AbstractRecipeType<R extends IRecipeStorage>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NTc4Mw=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY5MzIwMQ==", "bodyText": "Also that yes.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507693201", "createdAt": "2020-10-19T12:07:47Z", "author": {"login": "OrionDevelopment"}, "path": "src/api/java/com/minecolonies/api/crafting/AbstractRecipeType.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.List;\n+import com.google.common.collect.ImmutableList;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public abstract class AbstractRecipeType<R extends IRecipeStorage>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NTc4Mw=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzc5MDY3OQ==", "bodyText": "Happy to add the jdoc, but there are no override indicators in this class because it doesn't extend or implement anything.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507790679", "createdAt": "2020-10-19T14:23:00Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/AbstractRecipeType.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.List;\n+import com.google.common.collect.ImmutableList;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public abstract class AbstractRecipeType<R extends IRecipeStorage>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NTc4Mw=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDEwODc1OnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/MultiOutputRecipe.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo1OToxNFrOHkK2jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNDozNDozMFrOHkR1Iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY4ODU5MQ==", "bodyText": "class desc", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507688591", "createdAt": "2020-10-19T11:59:14Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/crafting/MultiOutputRecipe.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public class MultiOutputRecipe extends AbstractRecipeType<IRecipeStorage>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzgwMjkxNQ==", "bodyText": "Done", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507802915", "createdAt": "2020-10-19T14:34:30Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/MultiOutputRecipe.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package com.minecolonies.api.crafting;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.util.ResourceLocation;\n+\n+public class MultiOutputRecipe extends AbstractRecipeType<IRecipeStorage>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY4ODU5MQ=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDE5MTEyOnYy", "diffSide": "RIGHT", "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjoyMTo1MlrOHkLpAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNDozMzo0NlrOHkRxxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwMTUwNQ==", "bodyText": "if you're doing modifications in a simple checkForSpace() function you at least have to properly document/comment why that is there/whatfor it is. Or maybe even better rename the function", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507701505", "createdAt": "2020-10-19T12:21:52Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +353,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 237}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzgwMjA1Mg==", "bodyText": "Adding a few comments, renaming a variable, but not the function. It should be more clear now.", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507802052", "createdAt": "2020-10-19T14:33:46Z", "author": {"login": "Mekle001"}, "path": "src/api/java/com/minecolonies/api/crafting/RecipeStorage.java", "diffHunk": "@@ -228,13 +353,20 @@ public int hashCode()\n     private boolean checkForFreeSpace(final List<IItemHandler> handlers)\n     {\n         final List<ItemStack> secondaryStacks = new ArrayList<>();\n-        for (final ItemStack stack : input)\n+        if(!secondaryOutputs.isEmpty())\n+        {\n+            secondaryStacks.addAll(secondaryOutputs);\n+        }\n+        else\n         {\n-            final ItemStack container = stack.getItem().getContainerItem(stack);\n-            if (!ItemStackUtils.isEmpty(container))\n+            for (final ItemStack stack : input)\n             {\n-                container.setCount(stack.getCount());\n-                secondaryStacks.add(container);\n+                final ItemStack container = stack.getItem().getContainerItem(stack);\n+                if (!ItemStackUtils.isEmpty(container))\n+                {\n+                    container.setCount(stack.getCount());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwMTUwNQ=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 237}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDI1MDA2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNjoyOFrOHkMMlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNDozMzo1MVrOHkRyPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxMDYxMw==", "bodyText": "while you're at it, can you change the above warehouse search to use the building managers saved warehouse list?", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507710613", "createdAt": "2020-10-19T12:36:28Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -238,7 +244,7 @@ protected int getWarehouseCount(ItemStorage item)\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzgwMjE3Mw==", "bodyText": "done", "url": "https://github.com/ldtteam/minecolonies/pull/5905#discussion_r507802173", "createdAt": "2020-10-19T14:33:51Z", "author": {"login": "Mekle001"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingWorker.java", "diffHunk": "@@ -238,7 +244,7 @@ protected int getWarehouseCount(ItemStorage item)\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxMDYxMw=="}, "originalCommit": {"oid": "db9eda9ebfc06d082db43e945c68ab8af8924f06"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3338, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}