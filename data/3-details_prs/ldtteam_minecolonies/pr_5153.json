{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3ODk0NjAz", "number": 5153, "title": "Feature/vikings", "bodyText": "Closes #\nCloses #\nCloses #\nChanges proposed in this pull request:\n\nAdd Viking raider type\nAbstract ship based raids\nAdapt ship spawning to use correct groundlevel\nNew ships with loot\nFix enchanter GUI issue and healer stuck issue\nFix minor warehouse issue\n\n\nReview please", "createdAt": "2020-06-04T14:54:02Z", "url": "https://github.com/ldtteam/minecolonies/pull/5153", "merged": true, "mergeCommit": {"oid": "5990a2da92911a0dda555bddabdfcbf5b1451198"}, "closed": true, "closedAt": "2020-06-06T08:56:29Z", "author": {"login": "Raycoms"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmF4DIgH2gAyNDI3ODk0NjAzOjBjMTEyYmQyYmQ0N2JhNmE0OTY2ZjM3NjQ4YzRkNGJiYTE2ZGZmN2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcojOCoAFqTQyNTcyNTI1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c112bd2bd47ba6a4966f37648c4d4bba16dff7e", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/0c112bd2bd47ba6a4966f37648c4d4bba16dff7e", "committedDate": "2020-05-29T17:25:57Z", "message": "Add icons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1e4e10b05383450624c8ee8d58a05bc84394004", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/c1e4e10b05383450624c8ee8d58a05bc84394004", "committedDate": "2020-05-29T18:28:33Z", "message": "Vikings preparations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac3004a92bc1453c325333eea06b3943995404ae", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/ac3004a92bc1453c325333eea06b3943995404ae", "committedDate": "2020-05-29T19:40:34Z", "message": "initial setup 1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a197413dabe40f887bffd663d0ffdba9c505f424", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/a197413dabe40f887bffd663d0ffdba9c505f424", "committedDate": "2020-05-30T18:53:37Z", "message": "Stage 2 of viking raid"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9520a7cdc1392c1a06bccceed9f025d77e9736eb", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/9520a7cdc1392c1a06bccceed9f025d77e9736eb", "committedDate": "2020-05-30T18:53:50Z", "message": "alter dump counters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2baaa602d5e69e16f974a3dfab83a2b72bb4329c", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/2baaa602d5e69e16f974a3dfab83a2b72bb4329c", "committedDate": "2020-05-31T10:46:26Z", "message": "fix #5115"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4721d2d65908ce1266ca945da9f2a00777f5c54", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/e4721d2d65908ce1266ca945da9f2a00777f5c54", "committedDate": "2020-05-31T16:26:45Z", "message": "Vikings part 3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "693555d61be32ca66e9b2a40d403c684d9064ef3", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/693555d61be32ca66e9b2a40d403c684d9064ef3", "committedDate": "2020-06-01T15:28:56Z", "message": "Finish ship handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e548aaedbc55f7dda5ee786121fe1c42aa8e6406", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/e548aaedbc55f7dda5ee786121fe1c42aa8e6406", "committedDate": "2020-06-02T10:37:52Z", "message": "Merge branch 'version/1.15' into feature/vikings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c0429c241c0552d3bbf1279bf2a437afa63d6eb", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/2c0429c241c0552d3bbf1279bf2a437afa63d6eb", "committedDate": "2020-06-02T10:38:54Z", "message": "merge raiders fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c186c33b423e19901c20572c20cf13f1eaf501c", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/7c186c33b423e19901c20572c20cf13f1eaf501c", "committedDate": "2020-06-02T13:20:24Z", "message": "fix this up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53ae226f9d7452acc9a875cbfd60825360958afc", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/53ae226f9d7452acc9a875cbfd60825360958afc", "committedDate": "2020-06-02T14:49:28Z", "message": "fix enchanter GUI issue and healer stuck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "725852ab9c4c7b91a2683b869750bcb21cbbcf32", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/725852ab9c4c7b91a2683b869750bcb21cbbcf32", "committedDate": "2020-06-04T14:36:19Z", "message": "Merge branch 'version/1.15' into feature/vikings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/450a959a0093b5c372ef72f7ad73579b16a1c6d6", "committedDate": "2020-06-04T14:59:25Z", "message": "fix models and minor cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NTc4OTY3", "url": "https://github.com/ldtteam/minecolonies/pull/5153#pullrequestreview-424578967", "createdAt": "2020-06-04T15:36:18Z", "commit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "state": "COMMENTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozNjoxOVrOGfL56w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjoyMzozOFrOGfN7rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NDA5MQ==", "bodyText": "constants for all the NBT Tags please :D", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435354091", "createdAt": "2020-06-04T15:36:19Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/util/CreativeRaiderStructureHandler.java", "diffHunk": "@@ -0,0 +1,152 @@\n+package com.minecolonies.coremod.util;\n+\n+import com.ldtteam.structures.blueprints.v1.Blueprint;\n+import com.ldtteam.structurize.api.util.Log;\n+import com.ldtteam.structurize.blocks.interfaces.IBlueprintDataProvider;\n+import com.ldtteam.structurize.management.Manager;\n+import com.ldtteam.structurize.placement.StructurePlacer;\n+import com.ldtteam.structurize.placement.structure.CreativeStructureHandler;\n+import com.ldtteam.structurize.placement.structure.IStructureHandler;\n+import com.ldtteam.structurize.util.BlockInfo;\n+import com.ldtteam.structurize.util.PlacementSettings;\n+import com.ldtteam.structurize.util.TickedWorldOperation;\n+import com.minecolonies.api.colony.colonyEvents.IColonyRaidEvent;\n+import com.minecolonies.api.util.BlockPosUtil;\n+import com.minecolonies.coremod.colony.colonyEvents.raidEvents.pirateEvent.ShipBasedRaiderUtils;\n+import net.minecraft.block.Blocks;\n+import net.minecraft.entity.player.ServerPlayerEntity;\n+import net.minecraft.item.ItemStack;\n+import net.minecraft.nbt.CompoundNBT;\n+import net.minecraft.tileentity.TileEntity;\n+import net.minecraft.util.Mirror;\n+import net.minecraft.util.Rotation;\n+import net.minecraft.util.math.BlockPos;\n+import net.minecraft.world.World;\n+import org.jetbrains.annotations.NotNull;\n+import org.jetbrains.annotations.Nullable;\n+\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+\n+import static com.ldtteam.structurize.blocks.interfaces.IBlueprintDataProvider.TAG_BLUEPRINTDATA;\n+\n+/**\n+ * Raider specific creative structure handler.\n+ * Will correctly place spawners\n+ */\n+public final class CreativeRaiderStructureHandler extends CreativeStructureHandler\n+{\n+    /**\n+     * Map for the spawner positions.\n+     */\n+    private Map<BlockPos, List<String>> map;\n+\n+    /**\n+     * The raid event associated to this.\n+     */\n+    private IColonyRaidEvent event;\n+\n+    /**\n+     * The colony id.\n+     */\n+    private int colonyId;\n+\n+    /**\n+     * The minecolonies specific creative structure placer.\n+     * @param world the world.\n+     * @param pos the pos it is placed at.\n+     * @param structureName the name of the structure.\n+     * @param settings the placement settings.\n+     * @param fancyPlacement if fancy or complete.\n+     * @param event the raid event.\n+     * @param colonyId the colony id.\n+     */\n+    public CreativeRaiderStructureHandler(final World world, final BlockPos pos, final String structureName, final PlacementSettings settings, final boolean fancyPlacement, final IColonyRaidEvent event, final int colonyId)\n+    {\n+        super(world, pos, structureName, settings, fancyPlacement);\n+        getBluePrint().rotateWithMirror(settings.getRotation(), settings.getMirror(), world);\n+\n+        this.event = event;\n+        this.colonyId = colonyId;\n+        final BlockInfo info = getBluePrint().getBlockInfoAsMap().getOrDefault(getBluePrint().getPrimaryBlockOffset(), null);\n+        if (info.getTileEntityData() != null)\n+        {\n+            final CompoundNBT teData = getBluePrint().getTileEntityData(pos, getBluePrint().getPrimaryBlockOffset());\n+            if (teData != null && teData.contains(TAG_BLUEPRINTDATA))\n+            {\n+                final TileEntity entity = TileEntity.create(info.getTileEntityData());\n+                if (entity instanceof IBlueprintDataProvider)\n+                {\n+                    entity.setPos(pos);\n+                    this.map = ((IBlueprintDataProvider) entity).getWorldTagPosMap();\n+                }\n+            }\n+        }\n+    }\n+\n+    @Override\n+    public void triggerSuccess(final BlockPos pos, final List<ItemStack> list, final boolean placement)\n+    {\n+        super.triggerSuccess(pos, list, placement);\n+        final BlockPos worldPos = getProgressPosInWorld(pos);\n+        if (getWorld().getBlockState(worldPos).getBlock() == Blocks.GOLD_BLOCK)\n+        {\n+            final List<String> tags = map.getOrDefault(worldPos, Collections.emptyList());\n+            for (final String tag: tags)\n+            {\n+                switch (tag)\n+                {\n+                    case \"normal\":", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NTUzMA==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435355530", "createdAt": "2020-06-04T15:37:43Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/egyptians/IMeleeMummyEntity.java", "diffHunk": "@@ -1,7 +1,6 @@\n package com.minecolonies.api.entity.mobs.egyptians;\n \n import com.minecolonies.api.entity.mobs.IMeleeMobEntity;\n-import com.minecolonies.api.entity.mobs.pirates.IPirateEntity;\n \n public interface IMeleeMummyEntity extends IEgyptianEntity, IMeleeMobEntity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NTk5NQ==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435355995", "createdAt": "2020-06-04T15:38:10Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/vikings/IArcherNorsemenEntity.java", "diffHunk": "@@ -0,0 +1,8 @@\n+package com.minecolonies.api.entity.mobs.vikings;\n+\n+import com.minecolonies.api.entity.mobs.IArcherMobEntity;\n+\n+public interface IArcherNorsemenEntity extends IVikingEntity, IArcherMobEntity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NjI1Ng==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435356256", "createdAt": "2020-06-04T15:38:24Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/vikings/IMeleeNorsemenEntity.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package com.minecolonies.api.entity.mobs.vikings;\n+\n+import com.minecolonies.api.entity.mobs.IMeleeMobEntity;\n+import com.minecolonies.api.entity.mobs.egyptians.IEgyptianEntity;\n+import com.minecolonies.api.entity.mobs.pirates.IPirateEntity;\n+\n+public interface IMeleeNorsemenEntity extends IVikingEntity, IMeleeMobEntity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NjM5NA==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435356394", "createdAt": "2020-06-04T15:38:32Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/vikings/INorsemenChiefEntity.java", "diffHunk": "@@ -0,0 +1,8 @@\n+package com.minecolonies.api.entity.mobs.vikings;\n+\n+import com.minecolonies.api.entity.mobs.IChiefMobEntity;\n+\n+public interface INorsemenChiefEntity extends IVikingEntity, IChiefMobEntity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NjUwNQ==", "bodyText": "javadoc", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435356505", "createdAt": "2020-06-04T15:38:39Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/vikings/IVikingEntity.java", "diffHunk": "@@ -0,0 +1,11 @@\n+package com.minecolonies.api.entity.mobs.vikings;\n+\n+import net.minecraft.command.ICommandSource;\n+import net.minecraft.entity.monster.IMob;\n+import net.minecraft.nbt.CompoundNBT;\n+import net.minecraftforge.common.capabilities.ICapabilitySerializable;\n+\n+public interface IVikingEntity extends IMob, ICommandSource, ICapabilitySerializable<CompoundNBT>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NzEyOA==", "bodyText": "ICommandSource, ICapabilitySerializable whatfor does it use those?", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435357128", "createdAt": "2020-06-04T15:39:16Z", "author": {"login": "someaddons"}, "path": "src/api/java/com/minecolonies/api/entity/mobs/vikings/IVikingEntity.java", "diffHunk": "@@ -0,0 +1,11 @@\n+package com.minecolonies.api.entity.mobs.vikings;\n+\n+import net.minecraft.command.ICommandSource;\n+import net.minecraft.entity.monster.IMob;\n+import net.minecraft.nbt.CompoundNBT;\n+import net.minecraftforge.common.capabilities.ICapabilitySerializable;\n+\n+public interface IVikingEntity extends IMob, ICommandSource, ICapabilitySerializable<CompoundNBT>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1NjUwNQ=="}, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1ODM1MA==", "bodyText": "not sure why you're making the items for them, spawn items arent working for raiders anyways :D", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435358350", "createdAt": "2020-06-04T15:40:29Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/apiimp/initializer/ModItemsInitializer.java", "diffHunk": "@@ -115,6 +115,10 @@ public static void init(final IForgeRegistry<Item> registry)\n         registry.register(new SpawnEggItem(ModEntities.ARCHERMUMMY, PRIMARY_COLOR_EG, SECONDARY_COLOR_EG, (new Item.Properties()).group(ModCreativeTabs.MINECOLONIES)).setRegistryName(\"mummyarcheregg\"));\n         registry.register(new SpawnEggItem(ModEntities.PHARAO, PRIMARY_COLOR_EG, SECONDARY_COLOR_EG, (new Item.Properties()).group(ModCreativeTabs.MINECOLONIES)).setRegistryName(\"pharaoegg\"));\n \n+        registry.register(new SpawnEggItem(ModEntities.SHIELDMAIDEN, PRIMARY_COLOR_EG, SECONDARY_COLOR_EG, (new Item.Properties()).group(ModCreativeTabs.MINECOLONIES)).setRegistryName(\"shieldmaidenegg\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM2MDkzMA==", "bodyText": "what is the difference between those two textures? could maybe use that as name instead of var1 var2", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435360930", "createdAt": "2020-06-04T15:44:02Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/client/render/mobs/norsemen/RendererArcherNorsemen.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package com.minecolonies.coremod.client.render.mobs.norsemen;\n+\n+import com.minecolonies.api.entity.mobs.vikings.AbstractEntityNorsemen;\n+import com.minecolonies.coremod.client.model.raiders.ModelArcherNorsemen;\n+import net.minecraft.client.renderer.entity.EntityRendererManager;\n+import net.minecraft.entity.MobEntity;\n+import net.minecraft.util.ResourceLocation;\n+import org.jetbrains.annotations.NotNull;\n+\n+/**\n+ * Renderer used for archer amazons.\n+ */\n+public class RendererArcherNorsemen extends AbstractRendererNorsemen\n+{\n+    /**\n+     * Texture of the entity.\n+     */\n+    private static final ResourceLocation TEXTURE1 = new ResourceLocation(\"minecolonies:textures/entity/raiders/norsemen_archer1.png\");\n+    private static final ResourceLocation TEXTURE2 = new ResourceLocation(\"minecolonies:textures/entity/raiders/norsemen_archer2.png\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3OTk5MA==", "bodyText": "I just had nerfed it down to 1 captain, sure you want to buff it up again? :D", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435379990", "createdAt": "2020-06-04T16:12:05Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/pirateEvent/ShipSize.java", "diffHunk": "@@ -1,42 +1,33 @@\n package com.minecolonies.coremod.colony.colonyEvents.raidEvents.pirateEvent;\n \n import com.minecolonies.api.util.constant.ColonyConstants;\n-import net.minecraft.entity.EntityType;\n-\n-import static com.minecolonies.api.entity.ModEntities.*;\n \n /**\n  * Enum for ship sizes.\n  */\n public enum ShipSize\n {\n-    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_PIRATE_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 1, PIRATE, PIRATE),\n+    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 2, 2, 0, 0),\n     MEDIUM(ColonyConstants.MEDIUM_HORDE_SIZE,\n-      ColonyConstants.MEDIUM_PIRATE_SHIP,\n+      ColonyConstants.MEDIUM_SHIP,\n       ColonyConstants.MEDIUM_HORDE_MESSAGE_ID,\n-      3,\n-      PIRATE,\n-      ARCHERPIRATE,\n-      CHIEFPIRATE),\n+      4,\n+      1, 1, 1),\n     BIG(ColonyConstants.BIG_HORDE_SIZE,\n-      ColonyConstants.BIG_PIRATE_SHIP,\n+      ColonyConstants.BIG_SHIP,\n       ColonyConstants.BIG_HORDE_MESSAGE_ID,\n       11,\n-      PIRATE,\n-      PIRATE,\n-      ARCHERPIRATE,\n-      ARCHERPIRATE,\n-      CHIEFPIRATE);\n+      2, 2, 2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4MDk0NA==", "bodyText": "increased from 2 normal to 2 normal 2 archers, think 1 normal 1 archer fits best", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435380944", "createdAt": "2020-06-04T16:13:38Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/pirateEvent/ShipSize.java", "diffHunk": "@@ -1,42 +1,33 @@\n package com.minecolonies.coremod.colony.colonyEvents.raidEvents.pirateEvent;\n \n import com.minecolonies.api.util.constant.ColonyConstants;\n-import net.minecraft.entity.EntityType;\n-\n-import static com.minecolonies.api.entity.ModEntities.*;\n \n /**\n  * Enum for ship sizes.\n  */\n public enum ShipSize\n {\n-    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_PIRATE_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 1, PIRATE, PIRATE),\n+    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 2, 2, 0, 0),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4MTkyOA==", "bodyText": "medium ship now has 4 spawners?", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435381928", "createdAt": "2020-06-04T16:15:13Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/colonyEvents/raidEvents/pirateEvent/ShipSize.java", "diffHunk": "@@ -1,42 +1,33 @@\n package com.minecolonies.coremod.colony.colonyEvents.raidEvents.pirateEvent;\n \n import com.minecolonies.api.util.constant.ColonyConstants;\n-import net.minecraft.entity.EntityType;\n-\n-import static com.minecolonies.api.entity.ModEntities.*;\n \n /**\n  * Enum for ship sizes.\n  */\n public enum ShipSize\n {\n-    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_PIRATE_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 1, PIRATE, PIRATE),\n+    SMALL(ColonyConstants.SMALL_HORDE_SIZE, ColonyConstants.SMALL_SHIP, ColonyConstants.SMALL_HORDE_MESSAGE_ID, 2, 2, 0, 0),\n     MEDIUM(ColonyConstants.MEDIUM_HORDE_SIZE,\n-      ColonyConstants.MEDIUM_PIRATE_SHIP,\n+      ColonyConstants.MEDIUM_SHIP,\n       ColonyConstants.MEDIUM_HORDE_MESSAGE_ID,\n-      3,\n-      PIRATE,\n-      ARCHERPIRATE,\n-      CHIEFPIRATE),\n+      4,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4MzE4Nw==", "bodyText": "isnt the anchor structure.getPrimaryBlockOffset()?", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435383187", "createdAt": "2020-06-04T16:17:13Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/EventStructureManager.java", "diffHunk": "@@ -87,28 +94,55 @@ public boolean spawnTemporaryStructure(\n \n         final World world = colony.getWorld();\n \n-        final String backupPath = Structures.SCHEMATICS_PREFIX + STRUCTURE_BACKUP_FOLDER + colony.getID() + colony.getDimension() + targetSpawnPoint.down(3);\n-        final BlockPos zeroPos = targetSpawnPoint.subtract(structure.getPrimaryBlockOffset());\n+        int y = 3;\n+\n+        final BlockInfo info = structure.getBlockInfoAsMap().getOrDefault(structure.getPrimaryBlockOffset(), null);\n+        if (info.getTileEntityData() != null)\n+        {\n+            final CompoundNBT teData = structure.getTileEntityData(targetSpawnPoint, structure.getPrimaryBlockOffset());\n+            if (teData != null && teData.contains(TAG_BLUEPRINTDATA))\n+            {\n+                final TileEntity entity = TileEntity.create(info.getTileEntityData());\n+                if (entity instanceof IBlueprintDataProvider)\n+                {\n+                    for (final Map.Entry<BlockPos, List<String>> entry : ((IBlueprintDataProvider) entity).getPositionedTags().entrySet())\n+                    {\n+                        if (entry.getValue().contains(\"groundlevel\"))\n+                        {\n+                            y = entry.getKey().getY();\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n+        final BlockPos spawnPos = targetSpawnPoint.add(0, -y ,0);\n+\n+        final BlockPos zeroPos = targetSpawnPoint.subtract(structure.getPrimaryBlockOffset()).add(0, -y, 0);\n+        final BlockPos cornerPos = new BlockPos(zeroPos.getX() + structure.getSizeX() - 1, zeroPos.getY() + structure.getSizeY(), zeroPos.getZ() + structure.getSizeZ() - 1);\n+\n+        final BlockPos anchor = new BlockPos(zeroPos.getX() + structure.getSizeX()/2, zeroPos.getY(), zeroPos.getZ() + structure.getSizeZ()/2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM4NzMwOA==", "bodyText": "how come we're saving now the schematic's middle position as spawnpoint instead of the spawnpoint?", "url": "https://github.com/ldtteam/minecolonies/pull/5153#discussion_r435387308", "createdAt": "2020-06-04T16:23:38Z", "author": {"login": "someaddons"}, "path": "src/main/java/com/minecolonies/coremod/colony/managers/EventStructureManager.java", "diffHunk": "@@ -87,28 +94,55 @@ public boolean spawnTemporaryStructure(\n \n         final World world = colony.getWorld();\n \n-        final String backupPath = Structures.SCHEMATICS_PREFIX + STRUCTURE_BACKUP_FOLDER + colony.getID() + colony.getDimension() + targetSpawnPoint.down(3);\n-        final BlockPos zeroPos = targetSpawnPoint.subtract(structure.getPrimaryBlockOffset());\n+        int y = 3;\n+\n+        final BlockInfo info = structure.getBlockInfoAsMap().getOrDefault(structure.getPrimaryBlockOffset(), null);\n+        if (info.getTileEntityData() != null)\n+        {\n+            final CompoundNBT teData = structure.getTileEntityData(targetSpawnPoint, structure.getPrimaryBlockOffset());\n+            if (teData != null && teData.contains(TAG_BLUEPRINTDATA))\n+            {\n+                final TileEntity entity = TileEntity.create(info.getTileEntityData());\n+                if (entity instanceof IBlueprintDataProvider)\n+                {\n+                    for (final Map.Entry<BlockPos, List<String>> entry : ((IBlueprintDataProvider) entity).getPositionedTags().entrySet())\n+                    {\n+                        if (entry.getValue().contains(\"groundlevel\"))\n+                        {\n+                            y = entry.getKey().getY();\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n+        final BlockPos spawnPos = targetSpawnPoint.add(0, -y ,0);\n+\n+        final BlockPos zeroPos = targetSpawnPoint.subtract(structure.getPrimaryBlockOffset()).add(0, -y, 0);\n+        final BlockPos cornerPos = new BlockPos(zeroPos.getX() + structure.getSizeX() - 1, zeroPos.getY() + structure.getSizeY(), zeroPos.getZ() + structure.getSizeZ() - 1);\n+\n+        final BlockPos anchor = new BlockPos(zeroPos.getX() + structure.getSizeX()/2, zeroPos.getY(), zeroPos.getZ() + structure.getSizeZ()/2);\n+\n+        final String backupPath = Structures.SCHEMATICS_PREFIX + STRUCTURE_BACKUP_FOLDER + colony.getID() + colony.getDimension() + anchor;\n \n         if (!ItemScanTool.saveStructureOnServer(world,\n           zeroPos,\n-          new BlockPos(zeroPos.getX() + structure.getSizeX() - 1, zeroPos.getY() + structure.getSizeY(), zeroPos.getZ() + structure.getSizeZ() - 1),\n+          cornerPos,\n           backupPath,\n           false))\n         {\n             // No structure spawn if we didnt successfully save the surroundings before\n             Log.getLogger().info(\"Failed to save schematics for event\");\n             return false;\n         }\n+        backupSchematics.put(anchor, eventID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "450a959a0093b5c372ef72f7ad73579b16a1c6d6"}, "originalPosition": 82}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9873df1d775d0958967bbd5c9177ce7b3d30c923", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/9873df1d775d0958967bbd5c9177ce7b3d30c923", "committedDate": "2020-06-04T18:43:57Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c88c28aeeeba0f8d21e9417b409ee52cd5ea54c", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/4c88c28aeeeba0f8d21e9417b409ee52cd5ea54c", "committedDate": "2020-06-04T19:06:15Z", "message": "adjust some things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59617e96b03e84ff13bd671b2f261f40aaf6f61c", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/59617e96b03e84ff13bd671b2f261f40aaf6f61c", "committedDate": "2020-06-04T19:07:14Z", "message": "adjust spawners"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8c7a6f881deea2c9d50d3530bf83ba027799fd5", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/b8c7a6f881deea2c9d50d3530bf83ba027799fd5", "committedDate": "2020-06-05T14:16:33Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94ee5d0912cf52fc5db772610c498852bddef264", "author": {"user": {"login": "Raycoms", "name": null}}, "url": "https://github.com/ldtteam/minecolonies/commit/94ee5d0912cf52fc5db772610c498852bddef264", "committedDate": "2020-06-05T14:17:05Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NzI1MjU2", "url": "https://github.com/ldtteam/minecolonies/pull/5153#pullrequestreview-425725256", "createdAt": "2020-06-06T08:45:04Z", "commit": {"oid": "94ee5d0912cf52fc5db772610c498852bddef264"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2151, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}