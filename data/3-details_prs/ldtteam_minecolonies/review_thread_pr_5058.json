{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMDQ5OTQ1", "number": 5058, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxOTo0MVrOD_khSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0MDo1M1rOEDOE3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3OTg1MjI0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxOTo0MVrOGaTlrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxOTo0MVrOGaTlrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzEwMQ==", "bodyText": "Wrong naming variables.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r430237101", "createdAt": "2020-05-26T08:19:41Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,6 +279,12 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n+\n+        ResourceLocation builder_products = new ResourceLocation(\"minecolonies\", this.getJobName().toLowerCase().concat(\"_product\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9fad151e6c95042b80d2c39fae3cbdb81c236a"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3OTg1NzM3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoyMTowOFrOGaTo8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoyMTowOFrOGaTo8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzkzOQ==", "bodyText": "This logic can be abstracted into a protected method in the abstract building: canRecipeBeAddedBasedOnTags(final IToken token) which can then be reused through out the buildings even when the recipe addition logic is changed.\nPlease rework this as such, since this is a lot of copy pasting.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r430237939", "createdAt": "2020-05-26T08:21:08Z", "author": {"login": "OrionDevelopment"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,6 +279,12 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n+\n+        ResourceLocation builder_products = new ResourceLocation(\"minecolonies\", this.getJobName().toLowerCase().concat(\"_product\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9fad151e6c95042b80d2c39fae3cbdb81c236a"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMzE2OTg4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNToyMjo1OVrOGd22wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNzoxOToxMVrOGd76Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ==", "bodyText": "This seems like a duplicate. And why not just make it return true/false ?", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433960641", "createdAt": "2020-06-02T15:22:59Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2NTA1Mw==", "bodyText": "Because we need three cases:\n\nTrue means the recipe is allowed.\nFalse means the recipe is explicitly denied.\nNull means false unless a following rule allows it.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433965053", "createdAt": "2020-06-02T15:29:03Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk4MjczMw==", "bodyText": "But do we need it in the crafter + in the worker override?\n(Also, we never return null in the method, that's why I asked why we don't return a boolean)", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433982733", "createdAt": "2020-06-02T15:50:17Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAxMTA3Ng==", "bodyText": "Actually we probably don't need it in both places; I am testing that now. The actual canRecipeBeAdded method always returns true or false but the canRecipeBeAddedBasedOnTags needs to be able to say Yes, No, or \"I don't care\" before letting the builder-specific logic.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r434011076", "createdAt": "2020-06-02T16:26:03Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAxNTIxMQ==", "bodyText": "I mean the canRecipeBeAddedBasedOnTags also atm always is true/false and never null", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r434015211", "createdAt": "2020-06-02T16:32:45Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAxNTQ2OQ==", "bodyText": "or did you want to return nullable(null) instead of nullable(false) ?", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r434015469", "createdAt": "2020-06-02T16:33:08Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAyNTE5Nw==", "bodyText": "I return Optional.ofNullable(false) which is like Null but won't generate null pointer exceptions. You have to set it to something.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r434025197", "createdAt": "2020-06-02T16:48:35Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA0MzM5OQ==", "bodyText": "public static <T> Optional<T> ofNullable(T var0) {\n        return var0 == null ? empty() : of(var0);\n    }\n\nOptional.ofNullable(false) is the same as Optional.of(false), you have to give it null", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r434043399", "createdAt": "2020-06-02T17:19:11Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/AbstractBuildingCrafter.java", "diffHunk": "@@ -173,4 +176,55 @@ public static boolean canBuildingCanLearnMoreRecipes(final int buildingLevel, fi\n     {\n         return (Math.pow(2, buildingLevel) * EXTRA_RECIPE_MULTIPLIER) >= (learnedRecipes + 1);\n     }\n+\n+    /**\n+     * @param token\n+     * @return whether the recipe can bee added based on tokens.\n+     */\n+    protected Optional<Boolean> canRecipeBeAddedBasedOnTags(final IToken token)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MDY0MQ=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMzE3MjE1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNToyMzozMFrOGd24TQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNTo0OTozMVrOGd4KCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw==", "bodyText": "the format is messed up in all these classes though.", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433961037", "createdAt": "2020-06-02T15:23:30Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2NTQ1MQ==", "bodyText": "What do you mean?", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433965451", "createdAt": "2020-06-02T15:29:36Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2NjY1Mg==", "bodyText": "lala {\n}\nand not\nlala\n{\n}", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433966652", "createdAt": "2020-06-02T15:31:17Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk3ODc2Nw==", "bodyText": "Oh, is that \"messed\" up? :)", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433978767", "createdAt": "2020-06-02T15:46:18Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk4MTU4Mw==", "bodyText": "Compared to the default formatting yeah =D", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433981583", "createdAt": "2020-06-02T15:49:08Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk4MTk2Mg==", "bodyText": "Looks like this was the only one", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r433981962", "createdAt": "2020-06-02T15:49:31Z", "author": {"login": "PowerSchill"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBaker.java", "diffHunk": "@@ -276,35 +275,36 @@ public void onColonyTick(@NotNull final IColony colony)\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if (!super.canRecipeBeAdded(token) || !AbstractBuildingCrafter.canBuildingCanLearnMoreRecipes(getBuildingLevel(), super.getRecipes().size()))\n-        {\n-            return false;\n-        }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if (storage == null)\n-        {\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token)) {\n             return false;\n         }\n \n-        for (final IRecipeStorage recipe : BakerRecipes.getRecipes())\n-        {\n-            if (recipe.getPrimaryOutput().isItemEqual(storage.getPrimaryOutput()))\n-            {\n-                return false;\n-            }\n-        }\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk2MTAzNw=="}, "originalCommit": {"oid": "51e7389fe6ab8b82dfc92e2bae807ed355dfb956"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODExODA3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBlacksmith.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0MDo1M1rOGgIEVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0MDo1M1rOGgIEVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMzOTc5OQ==", "bodyText": "commented out?", "url": "https://github.com/ldtteam/minecolonies/pull/5058#discussion_r436339799", "createdAt": "2020-06-07T08:40:53Z", "author": {"login": "Raycoms"}, "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingBlacksmith.java", "diffHunk": "@@ -92,47 +91,37 @@ public Skill getSecondarySkill()\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if(!super.canRecipeBeAdded(token))\n+\n+        Optional<Boolean> isRecipeAllowed;\n+\n+        if (!super.canRecipeBeAdded(token))\n         {\n             return false;\n         }\n \n-        final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n-        if(storage == null)\n+        isRecipeAllowed = super.canRecipeBeAddedBasedOnTags(token);\n+        if (isRecipeAllowed.isPresent())\n         {\n-            return false;\n+            return isRecipeAllowed.get();\n         }\n-\n-        final int size = storage.getCleanedInput().size();\n-        int ingots = 0;\n-        int nuggets = 0;\n-        for(final ItemStorage itemStorage : storage.getCleanedInput())\n+        else\n         {\n-            final ItemStack stack = itemStorage.getItemStack();\n-            if (!ItemStackUtils.isEmpty(stack))\n-            {\n-                if (stack.getItem().isIn(Tags.Items.INGOTS))\n-                {\n-                    ingots++;\n-                    break;\n-                }\n-                else if (stack.getItem().isIn(Tags.Items.NUGGETS))\n-                {\n-                    nuggets++;\n-                    break;\n-                }\n-            }\n+            // Additional recipe rules\n+\n+            final IRecipeStorage storage = IColonyManager.getInstance().getRecipeManager().getRecipes().get(token);\n+\n+            final ItemStack output = storage.getPrimaryOutput();\n+            return output.getItem() instanceof ToolItem ||\n+                     output.getItem() instanceof SwordItem ||\n+                     output.getItem() instanceof ArmorItem ||\n+                     output.getItem() instanceof HoeItem ||\n+                     output.getItem() instanceof ShieldItem ||\n+                     Compatibility.isTinkersWeapon(output);\n+\n+            // End Additional recipe rules\n         }\n \n-        final ItemStack output = storage.getPrimaryOutput();\n-        return output.getItem() instanceof ToolItem ||\n-                output.getItem() instanceof SwordItem ||\n-                output.getItem() instanceof ArmorItem ||\n-                output.getItem() instanceof HoeItem ||\n-                output.getItem() instanceof ShieldItem ||\n-                Compatibility.isTinkersWeapon(output) ||\n-                ingots == size ||\n-                nuggets == size;\n+        //return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bf3c36e99fddaf7082cb89d21230013c4211d00"}, "originalPosition": 88}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3070, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}