{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1MDU0OTcx", "number": 461, "title": "[E2E Integration] Fix Subnet Deletion & Router Unbinding Issue", "bodyText": "Fix two issues in e2e integration. The details of issues are described as follows:\nDescriptions\nIssue 1 - Subnet deletion issue: If the subnet deletion operation fails, the corresponding subnet_id is still deleted in vpc.\nIssue 2 - Subnet-router unbinding issue: In the removeAnInterfaceToNeutronRouter API, after the operation is successful, the router in database does not have the corresponding port_id for removal.\nSolutions\nIssue 1 solution: Modified the try catch of the subnet deletion API in SubnetController, now it can catch the custom Exception correctly.\nIssue 2 solution: The root of the problem is that the port_id passed in may be null when calling the API. So add an operation:\n        if (portId == null) {\n              portId = subnet.getGatewayPortId();\n        }", "createdAt": "2020-11-03T23:58:36Z", "url": "https://github.com/futurewei-cloud/alcor/pull/461", "merged": true, "mergeCommit": {"oid": "634b5abf6db1a2bdf3810c3802537d755231e94a"}, "closed": true, "closedAt": "2020-11-05T06:49:10Z", "author": {"login": "kevin-zhonghao"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQUKStAH2gAyNTE1MDU0OTcxOjI0YjliNzZhZTM0OWYyNzdhYzU1ZjFjYzExZTgxNjM2ZDE1NjliNmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZcpxzgFqTUyMzk2NDQ2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24b9b76ae349f277ac55f1cc11e81636d1569b6d", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/24b9b76ae349f277ac55f1cc11e81636d1569b6d", "committedDate": "2020-10-07T21:49:22Z", "message": "commit message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ec421662ef56559a388e6c7308aa47cfd07a6b", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/08ec421662ef56559a388e6c7308aa47cfd07a6b", "committedDate": "2020-10-07T22:00:25Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2507b8fc44a4ca94da310b73c11453cec9f2504b", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/2507b8fc44a4ca94da310b73c11453cec9f2504b", "committedDate": "2020-10-15T17:12:49Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cab6bfa9573926c29b9f8dbbeab732a9de1da7e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/8cab6bfa9573926c29b9f8dbbeab732a9de1da7e", "committedDate": "2020-10-15T23:33:06Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9d2a5822429286e2b01ce0842f16cb70dc5168f", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/d9d2a5822429286e2b01ce0842f16cb70dc5168f", "committedDate": "2020-10-16T16:57:50Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daba98ee8949b91b2b77f74c6fbb30529355ee51", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/daba98ee8949b91b2b77f74c6fbb30529355ee51", "committedDate": "2020-10-20T00:03:13Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b813735c5032b70928a2304007875824f5ccedca", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/b813735c5032b70928a2304007875824f5ccedca", "committedDate": "2020-10-22T17:43:05Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd9a9847b0f42c5a7fd089ea09fa6f24233d008e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/fd9a9847b0f42c5a7fd089ea09fa6f24233d008e", "committedDate": "2020-10-28T19:40:54Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e44875aa2fa685b2252647f413c704dce7a21611", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/e44875aa2fa685b2252647f413c704dce7a21611", "committedDate": "2020-10-29T18:42:59Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98dcf0dbb1c950ee71a0d663a7042cbce30d24ed", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/98dcf0dbb1c950ee71a0d663a7042cbce30d24ed", "committedDate": "2020-10-30T22:44:46Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9c3a47d74ba5fffbe13746ee4e33af0fbb394fe", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/a9c3a47d74ba5fffbe13746ee4e33af0fbb394fe", "committedDate": "2020-11-03T23:40:18Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3669c9e13c2e39cc177ba4c9996add77aaaf7466", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/3669c9e13c2e39cc177ba4c9996add77aaaf7466", "committedDate": "2020-11-03T23:46:36Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMzc3ODQ1", "url": "https://github.com/futurewei-cloud/alcor/pull/461#pullrequestreview-523377845", "createdAt": "2020-11-04T13:51:39Z", "commit": {"oid": "3669c9e13c2e39cc177ba4c9996add77aaaf7466"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzo1MTozOVrOHtY8YA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzo1MTozOVrOHtY8YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM1NjY0MA==", "bodyText": "We will need a better handling of exceptions.\n\nEvaluate whether or not we will need to log information for the caught exception.\nIf logging is an option, we will like to include useful information in the message (in this case, subnet id etc.)\nIf not, we could combine exceptions in one line, for example,\n\ncatch(ParameterNullOrEmptyException | HavePortInSubnet e)\n{\n...\n}", "url": "https://github.com/futurewei-cloud/alcor/pull/461#discussion_r517356640", "createdAt": "2020-11-04T13:51:39Z", "author": {"login": "xieus"}, "path": "services/subnet_manager/src/main/java/com/futurewei/alcor/subnet/controller/SubnetController.java", "diffHunk": "@@ -477,6 +477,10 @@ public ResponseId deleteSubnetState(@PathVariable String projectId, @PathVariabl\n         } catch (ParameterNullOrEmptyException e) {\n             logger.error(e.getMessage());\n             throw new Exception(e);\n+        } catch (HavePortInSubnet e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3669c9e13c2e39cc177ba4c9996add77aaaf7466"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28af26b782df496b123768cde56bff15159e366d", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/28af26b782df496b123768cde56bff15159e366d", "committedDate": "2020-11-04T19:10:03Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzOTY0NDY2", "url": "https://github.com/futurewei-cloud/alcor/pull/461#pullrequestreview-523964466", "createdAt": "2020-11-05T06:48:19Z", "commit": {"oid": "28af26b782df496b123768cde56bff15159e366d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2013, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}