{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5ODAzMzk1", "number": 79, "title": "Preliminary support of node management and switch assignment", "bodyText": "This PR contains the following changes:\n\nPreliminary support of node management\nTransit switch random assignment\nPort API standardization", "createdAt": "2020-01-07T03:11:01Z", "url": "https://github.com/futurewei-cloud/alcor/pull/79", "merged": true, "mergeCommit": {"oid": "9fbb970097feb2e8c9e2df154da9b02ecdc6e80b"}, "closed": true, "closedAt": "2020-01-07T18:24:39Z", "author": {"login": "xieus"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb1lHPtgH2gAyMzU5ODAzMzk1OmEzMTI5ZWE4NWU1Y2EyMWQ3Njg2OTA0ZjI1ZDM5YzdlOGQ4ZjBmOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4E9QagH2gAyMzU5ODAzMzk1OmUyZjE4NmYwZTQ2Y2JhYWU5NDYwZWNkNDJlNzM4ZjliODA3NjcwODU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a3129ea85e5ca21d7686904f25d39c7e8d8f0f94", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/a3129ea85e5ca21d7686904f25d39c7e8d8f0f94", "committedDate": "2019-12-31T00:07:19Z", "message": "Update port get/post APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c098871a9e14e99fe3c903537eb797bb9cd1272", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/2c098871a9e14e99fe3c903537eb797bb9cd1272", "committedDate": "2019-12-31T20:26:55Z", "message": "Update post/put port APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ec144b6413a91740d1868d336f8f5a827dcd159", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/5ec144b6413a91740d1868d336f8f5a827dcd159", "committedDate": "2019-12-31T22:48:54Z", "message": "Add Response id in delete API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be93767c0cca7f1e9af3d897ac2b35ae50956469", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/be93767c0cca7f1e9af3d897ac2b35ae50956469", "committedDate": "2019-12-31T23:07:24Z", "message": "Update get subnet api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff72f30252f1b309acbe572fd87b2f144b58e176", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/ff72f30252f1b309acbe572fd87b2f144b58e176", "committedDate": "2020-01-06T19:10:34Z", "message": "Add goal state programmer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bde607a1da74161447efaec04b00c6f0a70148c", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/8bde607a1da74161447efaec04b00c6f0a70148c", "committedDate": "2020-01-06T19:13:18Z", "message": "Merge branch 'master' into api/vpc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ca0603c7300b575d476ae63c7eb428569f1afe8", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/3ca0603c7300b575d476ae63c7eb428569f1afe8", "committedDate": "2020-01-07T02:57:10Z", "message": "Support random switch assignments, standardize port creation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c847cae1247f671f4dfd9c14f90b6ae5636d5466", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/c847cae1247f671f4dfd9c14f90b6ae5636d5466", "committedDate": "2020-01-07T03:05:03Z", "message": "Update copyright statements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819", "committedDate": "2020-01-07T03:06:57Z", "message": "Update copyright statements cont"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5MDUzNDIz", "url": "https://github.com/futurewei-cloud/alcor/pull/79#pullrequestreview-339053423", "createdAt": "2020-01-07T06:39:13Z", "commit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwNjozOToxM1rOFaw8kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwNjo1MTo1MlrOFaxGiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYwOTIzMw==", "bodyText": "I wonder if it is better to do:\nimport com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.*;\nInstead of the below since all the three lines are from alcor:\nimport com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.DataCenterConfigLoader;\nimport com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.DataCenterConfig;\nimport com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.NodeManager;", "url": "https://github.com/futurewei-cloud/alcor/pull/79#discussion_r363609233", "createdAt": "2020-01-07T06:39:13Z", "author": {"login": "er1cthe0ne"}, "path": "src/com/futurewei/alcor/controller/app/AlcorControllerApp.java", "diffHunk": "@@ -23,7 +23,9 @@\n import com.futurewei.alcor.controller.app.onebox.OneBoxUtil;\n import com.futurewei.alcor.controller.cache.config.*;\n import com.futurewei.alcor.controller.model.HostInfo;\n-import com.futurewei.alcor.controller.resourcemgr.physical.DataCenterConfigLoader;\n+import com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.DataCenterConfigLoader;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYwOTU3Ng==", "bodyText": "would it be better to set IS_K8S and IS_Onebox to false as default and change it to true when needed?", "url": "https://github.com/futurewei-cloud/alcor/pull/79#discussion_r363609576", "createdAt": "2020-01-07T06:40:54Z", "author": {"login": "er1cthe0ne"}, "path": "src/com/futurewei/alcor/controller/app/onebox/OneBoxConfig.java", "diffHunk": "@@ -29,6 +29,7 @@\n \n public class OneBoxConfig {\n \n+    public static boolean IS_K8S = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYxMTMyMA==", "bodyText": "nextInt expect a positive number, correct me if I am wrong, what if:\nmax = -100\nmin = -1000\nmax - min = -1100", "url": "https://github.com/futurewei-cloud/alcor/pull/79#discussion_r363611320", "createdAt": "2020-01-07T06:49:27Z", "author": {"login": "er1cthe0ne"}, "path": "src/com/futurewei/alcor/controller/utilities/Common.java", "diffHunk": "@@ -26,4 +27,14 @@\n \n         return bytes;\n     }\n+\n+    public static int getRandomNumberInRange(int min, int max) {\n+\n+        if (min >= max) {\n+            throw new IllegalArgumentException(\"Max must be greater than min\");\n+        }\n+\n+        Random r = new Random();\n+        return r.nextInt((max - min) + 1) + min;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYxMTc4Nw==", "bodyText": "is this function for OneBox only? If yes, it will be better to name this function accordingly.", "url": "https://github.com/futurewei-cloud/alcor/pull/79#discussion_r363611787", "createdAt": "2020-01-07T06:51:52Z", "author": {"login": "er1cthe0ne"}, "path": "src/com/futurewei/alcor/controller/web/util/ControllerUtil.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+Copyright 2019 The Alcor Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+        you may not use this file except in compliance with the License.\n+        You may obtain a copy of the License at\n+\n+        http://www.apache.org/licenses/LICENSE-2.0\n+\n+        Unless required by applicable law or agreed to in writing, software\n+        distributed under the License is distributed on an \"AS IS\" BASIS,\n+        WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+        See the License for the specific language governing permissions and\n+        limitations under the License.\n+*/\n+package com.futurewei.alcor.controller.web.util;\n+\n+import com.futurewei.alcor.controller.app.onebox.OneBoxConfig;\n+import com.futurewei.alcor.controller.model.HostInfo;\n+import com.futurewei.alcor.controller.model.PortState;\n+import com.futurewei.alcor.controller.model.SubnetState;\n+import com.futurewei.alcor.controller.resourcemgr.physical.goalstatemgmt.GoalStateWorker;\n+import com.futurewei.alcor.controller.resourcemgr.physical.goalstatemgmt.PortProgramInfo;\n+import com.futurewei.alcor.controller.resourcemgr.physical.nodemgmt.DataCenterConfig;\n+\n+public class ControllerUtil {\n+\n+    public static PortState CreatePort(PortState portState) {\n+\n+        HostInfo epHost = DataCenterConfig.nodeManager.getHostInfoById(portState.getBindingHostId());\n+        PortState customerPortState = ControllerUtil.AssignVipMacToPort(portState, OneBoxConfig.epCounter);\n+        SubnetState customerSubnetState = ControllerConfig.customerSubnetState;\n+        HostInfo[] transitSwitchHostsForSubnet = ControllerConfig.transitSwitchHosts;\n+\n+        System.out.println(\"EP host counter :\" + OneBoxConfig.epHostCounter + \"| ep counter: \" + OneBoxConfig.epCounter);\n+        OneBoxConfig.epCounter++;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d1c4e1bb5dfc294d3009065ca9ffe9e600d9819"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2f186f0e46cbaae9460ecd42e738f9b80767085", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/e2f186f0e46cbaae9460ecd42e738f9b80767085", "committedDate": "2020-01-07T18:21:13Z", "message": "Add ephost count to controller config"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2335, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}