{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0ODk2OTk3", "number": 511, "title": "[Hotfix] Fix Issue #506 and Issue #505", "bodyText": "#505\n#506", "createdAt": "2020-12-09T04:57:08Z", "url": "https://github.com/futurewei-cloud/alcor/pull/511", "merged": true, "mergeCommit": {"oid": "00ac3f095a8d2e4430f5254bafdee0159149b98d"}, "closed": true, "closedAt": "2021-01-12T06:43:31Z", "author": {"login": "kevin-zhonghao"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQUKStAH2gAyNTM0ODk2OTk3OjI0YjliNzZhZTM0OWYyNzdhYzU1ZjFjYzExZTgxNjM2ZDE1NjliNmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvVKaFgH2gAyNTM0ODk2OTk3OmJmNGIxMWQ4NmU0OWJlNDA5OWJiY2RiNjAwZGRmODA4YTNlNGJmMGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24b9b76ae349f277ac55f1cc11e81636d1569b6d", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/24b9b76ae349f277ac55f1cc11e81636d1569b6d", "committedDate": "2020-10-07T21:49:22Z", "message": "commit message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ec421662ef56559a388e6c7308aa47cfd07a6b", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/08ec421662ef56559a388e6c7308aa47cfd07a6b", "committedDate": "2020-10-07T22:00:25Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2507b8fc44a4ca94da310b73c11453cec9f2504b", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/2507b8fc44a4ca94da310b73c11453cec9f2504b", "committedDate": "2020-10-15T17:12:49Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cab6bfa9573926c29b9f8dbbeab732a9de1da7e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/8cab6bfa9573926c29b9f8dbbeab732a9de1da7e", "committedDate": "2020-10-15T23:33:06Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9d2a5822429286e2b01ce0842f16cb70dc5168f", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/d9d2a5822429286e2b01ce0842f16cb70dc5168f", "committedDate": "2020-10-16T16:57:50Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daba98ee8949b91b2b77f74c6fbb30529355ee51", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/daba98ee8949b91b2b77f74c6fbb30529355ee51", "committedDate": "2020-10-20T00:03:13Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b813735c5032b70928a2304007875824f5ccedca", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/b813735c5032b70928a2304007875824f5ccedca", "committedDate": "2020-10-22T17:43:05Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd9a9847b0f42c5a7fd089ea09fa6f24233d008e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/fd9a9847b0f42c5a7fd089ea09fa6f24233d008e", "committedDate": "2020-10-28T19:40:54Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e44875aa2fa685b2252647f413c704dce7a21611", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/e44875aa2fa685b2252647f413c704dce7a21611", "committedDate": "2020-10-29T18:42:59Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98dcf0dbb1c950ee71a0d663a7042cbce30d24ed", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/98dcf0dbb1c950ee71a0d663a7042cbce30d24ed", "committedDate": "2020-10-30T22:44:46Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9c3a47d74ba5fffbe13746ee4e33af0fbb394fe", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/a9c3a47d74ba5fffbe13746ee4e33af0fbb394fe", "committedDate": "2020-11-03T23:40:18Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f058bd1edef55af8ab0e25cb7b043fa6c04c272f", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/f058bd1edef55af8ab0e25cb7b043fa6c04c272f", "committedDate": "2020-11-05T07:42:35Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08d4a6f7da0d94caef77156cbb27fa05965eff9a", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/08d4a6f7da0d94caef77156cbb27fa05965eff9a", "committedDate": "2020-11-05T19:07:01Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef0b4fe4b03ddcc00904f1d603d020648846c34f", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/ef0b4fe4b03ddcc00904f1d603d020648846c34f", "committedDate": "2020-11-18T22:54:01Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf29fc71c3dba26a3a166b859fd10be380f03400", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/bf29fc71c3dba26a3a166b859fd10be380f03400", "committedDate": "2020-12-02T21:06:36Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b23608afa9dfcd50c2c172672f9a104ccb0e7f21", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/b23608afa9dfcd50c2c172672f9a104ccb0e7f21", "committedDate": "2020-12-03T18:09:47Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2e742c1d2b83f4679c833b90c4f065fda6b61d4", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/d2e742c1d2b83f4679c833b90c4f065fda6b61d4", "committedDate": "2020-12-04T06:54:24Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b1f333fde18b70f971d51d4181b20f401ee038e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/7b1f333fde18b70f971d51d4181b20f401ee038e", "committedDate": "2020-12-08T19:25:36Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0599937a476aa1b217733736bd29e7ee6a353df1", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/0599937a476aa1b217733736bd29e7ee6a353df1", "committedDate": "2020-12-09T04:53:20Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0OTc0MzQ0", "url": "https://github.com/futurewei-cloud/alcor/pull/511#pullrequestreview-554974344", "createdAt": "2020-12-17T20:46:13Z", "commit": {"oid": "0599937a476aa1b217733736bd29e7ee6a353df1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMDo0NjoxM1rOIIIIPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMDo0NjoxM1rOIIIIPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTM5MjcwMQ==", "bodyText": "@kevin-zhonghao Please check PM's new API for port count in a subnet, it should be {\"/project/{project_id}/subnet-port-count/{subnet_id}. This api will only return non-gateway port count. If it's not zero, the subnet cannot be deleted. If it returns zero, we need to ask PM to delete the gateway port first before delete the subnet.", "url": "https://github.com/futurewei-cloud/alcor/pull/511#discussion_r545392701", "createdAt": "2020-12-17T20:46:13Z", "author": {"login": "cj-chung"}, "path": "services/subnet_manager/src/main/java/com/futurewei/alcor/subnet/controller/SubnetController.java", "diffHunk": "@@ -523,8 +523,10 @@ public ResponseId deleteSubnetState(@PathVariable String projectId, @PathVariabl\n             } else {\n                 rangeId = ipV6RangeId;\n             }\n-//            Boolean checkIfAnyPortInSubnet = this.subnetService.checkIfAnyPortInSubnet(rangeId);\n-//            if (checkIfAnyPortInSubnet) {\n+\n+            // TODO: check if there is any gateway / non-gateway port for the subnet, waiting for PM new API\n+//            Boolean checkIfAnyNoneGatewayPortInSubnet = this.subnetService.checkIfAnyPortInSubnet(rangeId);\n+//            if (checkIfAnyNoneGatewayPortInSubnet) {\n //                throw new HavePortInSubnet();\n //            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0599937a476aa1b217733736bd29e7ee6a353df1"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0OTgzMDc0", "url": "https://github.com/futurewei-cloud/alcor/pull/511#pullrequestreview-554983074", "createdAt": "2020-12-17T20:59:17Z", "commit": {"oid": "0599937a476aa1b217733736bd29e7ee6a353df1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMDo1OToxN1rOIIIkGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMDo1OToxN1rOIIIkGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTM5OTgzNA==", "bodyText": "@kevin-zhonghao please prepare a RouterUpdateInfo object here for request body. @chenpiaoping's code for this API requires RouterUpdateInfo object.", "url": "https://github.com/futurewei-cloud/alcor/pull/511#discussion_r545399834", "createdAt": "2020-12-17T20:59:17Z", "author": {"login": "cj-chung"}, "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/service/Impl/RouterToPMServiceImpl.java", "diffHunk": "@@ -81,4 +81,10 @@ public void updatePort(String projectid, String portId, PortEntity portEntity) {\n         HttpEntity<PortWebJson> request = new HttpEntity<>(new PortWebJson(portEntity));\n         restTemplate.put(portManagerServiceUrl, request, PortWebJson.class);\n     }\n+\n+    @Override\n+    public void updateL3Neighbors(String projectid, List<String> gatewayPorts) {\n+        String portManagerServiceUrl = portUrl + \"/project/\" + projectid + \"/update-l3-neighbors\";\n+        //restTemplate.put(portManagerServiceUrl, request, PortWebJson.class);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0599937a476aa1b217733736bd29e7ee6a353df1"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "487948d56ef157677b6cee9b5818fb98fa5fc640", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/487948d56ef157677b6cee9b5818fb98fa5fc640", "committedDate": "2020-12-17T23:36:00Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6275907484bea5acb75edf40a3b711fdae9073", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/1e6275907484bea5acb75edf40a3b711fdae9073", "committedDate": "2020-12-17T23:36:41Z", "message": "Merge branch 'new_master' into fix/issue_506_505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "602c7f9381f18da19079c25517606647ce19e382", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/602c7f9381f18da19079c25517606647ce19e382", "committedDate": "2020-12-18T17:43:16Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce19ed1296214ee9b4e9e93aea768bfb9bf05db4", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/ce19ed1296214ee9b4e9e93aea768bfb9bf05db4", "committedDate": "2020-12-18T21:43:21Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4358c990732dff3f9ef49235b583ca5f2d3f0417", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/4358c990732dff3f9ef49235b583ca5f2d3f0417", "committedDate": "2020-12-19T00:02:58Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb907eec414e25053f35e756a757751307ad854c", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/fb907eec414e25053f35e756a757751307ad854c", "committedDate": "2020-12-19T00:03:38Z", "message": "Merge branch 'new_master' into fix/issue_506_505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b61fcc12f3bf26a163ee4eeca55a2d90de7d984e", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/b61fcc12f3bf26a163ee4eeca55a2d90de7d984e", "committedDate": "2020-12-22T18:29:41Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e851cce68da26d4e2787e9a8c8b92fef044ef8ba", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/e851cce68da26d4e2787e9a8c8b92fef044ef8ba", "committedDate": "2020-12-22T18:30:43Z", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into new_master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc24c1f01006147e57dd4442efd6977cf7e5c780", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/fc24c1f01006147e57dd4442efd6977cf7e5c780", "committedDate": "2020-12-22T18:31:13Z", "message": "Merge branch 'new_master' into fix/issue_506_505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8af5732bd44945885f1972ee1d057cf3a8fd4419", "author": {"user": {"login": "kevin-zhonghao", "name": "Zhonghao(Kevin) Lyu"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/8af5732bd44945885f1972ee1d057cf3a8fd4419", "committedDate": "2020-12-23T00:14:19Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NTkwNjAy", "url": "https://github.com/futurewei-cloud/alcor/pull/511#pullrequestreview-565590602", "createdAt": "2021-01-11T17:39:42Z", "commit": {"oid": "8af5732bd44945885f1972ee1d057cf3a8fd4419"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf4b11d86e49be4099bbcdb600ddf808a3e4bf0f", "author": {"user": {"login": "xieus", "name": "Liguang Xie"}}, "url": "https://github.com/futurewei-cloud/alcor/commit/bf4b11d86e49be4099bbcdb600ddf808a3e4bf0f", "committedDate": "2021-01-12T06:31:03Z", "message": "Merge branch 'master' into fix/issue_506_505"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2050, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}