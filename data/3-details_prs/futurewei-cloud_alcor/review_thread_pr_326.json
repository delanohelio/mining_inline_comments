{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3OTM2NDMw", "number": 326, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMjo1NTo0MlrOETB8hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzozMjo0M1rOETCcng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzkwMjc2OnYy", "diffSide": "RIGHT", "path": "services/node_manager/src/main/java/com/futurewei/alcor/nodemanager/controller/NodeController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMjo1NTo0MlrOG4ijeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMjo1NTo0MlrOG4ijeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkzOTU3OA==", "bodyText": "Consider to add \"local_ip\" as a filtering parameter.", "url": "https://github.com/futurewei-cloud/alcor/pull/326#discussion_r461939578", "createdAt": "2020-07-28T22:55:42Z", "author": {"login": "xieus"}, "path": "services/node_manager/src/main/java/com/futurewei/alcor/nodemanager/controller/NodeController.java", "diffHunk": "@@ -72,13 +80,28 @@ public NodeInfoJson getNodeInfoById(@PathVariable String nodeid) throws Exceptio\n         return new NodeInfoJson(hostInfo);\n     }\n \n+    @FieldFilter(type = NodeInfo.class)\n     @RequestMapping(\n             method = GET,\n             value = {\"/nodes\", \"/v4/nodes\"})\n-    public List<NodeInfo> getAllNodes() throws ParameterNullOrEmptyException, Exception {\n+    public List<NodeInfo> getAllNodes(@ApiParam(value = \"node_name\") @RequestParam(required = false) String name,\n+                                      @ApiParam(value = \"node_id\") @RequestParam(required = false) String id,\n+                                      @ApiParam(value = \"mac_address\") @RequestParam(required = false) String macAddress) throws ParameterNullOrEmptyException, Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2194a4fd16fb106df9244c4e34eda538779fa5ac"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzkxNDI1OnYy", "diffSide": "RIGHT", "path": "services/node_manager/src/main/java/com/futurewei/alcor/nodemanager/controller/NodeController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzowMDo1MlrOG4iqhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzowMDo1MlrOG4iqhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk0MTM4Mg==", "bodyText": "recommend to use \"mac_address\" as this is the usual URL parameter format.", "url": "https://github.com/futurewei-cloud/alcor/pull/326#discussion_r461941382", "createdAt": "2020-07-28T23:00:52Z", "author": {"login": "xieus"}, "path": "services/node_manager/src/main/java/com/futurewei/alcor/nodemanager/controller/NodeController.java", "diffHunk": "@@ -72,13 +80,28 @@ public NodeInfoJson getNodeInfoById(@PathVariable String nodeid) throws Exceptio\n         return new NodeInfoJson(hostInfo);\n     }\n \n+    @FieldFilter(type = NodeInfo.class)\n     @RequestMapping(\n             method = GET,\n             value = {\"/nodes\", \"/v4/nodes\"})\n-    public List<NodeInfo> getAllNodes() throws ParameterNullOrEmptyException, Exception {\n+    public List<NodeInfo> getAllNodes(@ApiParam(value = \"node_name\") @RequestParam(required = false) String name,\n+                                      @ApiParam(value = \"node_id\") @RequestParam(required = false) String id,\n+                                      @ApiParam(value = \"mac_address\") @RequestParam(required = false) String macAddress) throws ParameterNullOrEmptyException, Exception {\n         List<NodeInfo> nodes = null;\n         try {\n-            nodes = service.getAllNodes();\n+            Map<String, Object[]> queryParams =\n+                    ControllerUtil.transformUrlPathParams(request.getParameterMap(), NodeInfo.class);\n+            if (name != null) {\n+                queryParams.put(\"name\", new String[]{name});\n+            }\n+            if (id != null) {\n+                queryParams.put(\"id\", new String[]{id});\n+            }\n+            if (macAddress != null) {\n+                queryParams.put(\"macAddress\", new String[]{macAddress});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2194a4fd16fb106df9244c4e34eda538779fa5ac"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4Mzk4MjI3OnYy", "diffSide": "RIGHT", "path": "web/src/main/java/com/futurewei/alcor/web/restclient/NodeManagerRestClient.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzozMToyOFrOG4jSdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzozMToyOFrOG4jSdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk1MTYwNg==", "bodyText": "@chenpiaoping Would like to keep you updated that this is the new contract between port manager and node manager.", "url": "https://github.com/futurewei-cloud/alcor/pull/326#discussion_r461951606", "createdAt": "2020-07-28T23:31:28Z", "author": {"login": "xieus"}, "path": "web/src/main/java/com/futurewei/alcor/web/restclient/NodeManagerRestClient.java", "diffHunk": "@@ -30,4 +37,13 @@ public NodeInfoJson getNodeInfo(String nodeId) throws Exception {\n         String url = nodeManagerUrl + \"/\" + nodeId;\n         return getRequest(url, NodeInfoJson.class);\n     }\n+\n+    @DurationStatistics\n+    public List<NodeInfo> getNodeInfoByNodeName(String nodeName) throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4acff4d9f8f20e4ff1d1eb5d4e7c601ed414d990"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4Mzk4NDk0OnYy", "diffSide": "RIGHT", "path": "services/port_manager/src/main/java/com/futurewei/alcor/portmanager/proxy/NodeManagerProxy.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzozMjo0M1rOG4jUJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMzozMjo0M1rOG4jUJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk1MjAzOA==", "bodyText": "Comment needs update.", "url": "https://github.com/futurewei-cloud/alcor/pull/326#discussion_r461952038", "createdAt": "2020-07-28T23:32:43Z", "author": {"login": "xieus"}, "path": "services/port_manager/src/main/java/com/futurewei/alcor/portmanager/proxy/NodeManagerProxy.java", "diffHunk": "@@ -48,4 +52,31 @@ public PortBindingHost getNodeInfo(Object args) throws Exception {\n \n         return new PortBindingHost(portEntity.getId(), nodeInfoJson.getNodeInfo());\n     }\n+\n+    /**\n+     * Verify and get host info from Node manager by node name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4acff4d9f8f20e4ff1d1eb5d4e7c601ed414d990"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4618, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}