{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3OTg5Njcz", "number": 396, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOToyMDoxNlrOEqcw_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMzozODo0OFrOEqjesA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTQ2OTQwOnYy", "diffSide": "RIGHT", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOToyMDoxNlrOHcqepA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOToyMDoxNlrOHcqepA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgxODE0OA==", "bodyText": "We only have one GW MAC address.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499818148", "createdAt": "2020-10-05T19:20:16Z", "author": {"login": "xieus"}, "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"network_id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"id\":\"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n+         \"name\":\"test_subnet2\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.2.0/24\",\n+         \"gateway_ip\":\"192.168.2.1\",\n+         \"availability_zone\":\"uswest-1\",\n+         \"dhcp_enable\":false,\n+         \"primary_dns\":null,\n+         \"secondary_dns\":null,\n+         \"dns_list\":null,\n+         \"tunnel_id\":\"88889\",\n+         \"portIdsPerHost\":[\n+            {\n+               \"hostIp\":\"10.213.43.187\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d3,f37810eb-7f83-45fa-a4d4-1b31e75399d0\"\n+            },\n+            {\n+               \"hostIp\":\"10.213.43.188\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d6,f37810eb-7f83-45fa-a4d4-1b31e75399d7\"\n+            }\n+         ],\n+         \"dhcpIds\":\"aaa,bbb\",\n+         \"gatewayMacs\":\"g1,g2\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 191}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTUxNjU1OnYy", "diffSide": "RIGHT", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNDozOVrOHcq7qQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNDozOVrOHcq7qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNTU3Nw==", "bodyText": "This subnet_internal is aligned with our InternalSubnetEntity, at least the following fields:\n\nportIdsPerHost\ngatewayMacs\ndhcpIds\n\n\n  \n    \n      alcor/web/src/main/java/com/futurewei/alcor/web/entity/dataplane/InternalSubnetEntity.java\n    \n    \n         Line 20\n      in\n      83f950b\n    \n    \n    \n    \n\n        \n          \n           public class InternalSubnetEntity extends SubnetEntity {", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499825577", "createdAt": "2020-10-05T19:34:39Z", "author": {"login": "xieus"}, "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 165}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTUxOTc0OnYy", "diffSide": "RIGHT", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNToyOVrOHcq9lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNToyOVrOHcq9lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjA3MQ==", "bodyText": "Please update routers_internal with the latest contract in NetworkConfiguration.java.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499826071", "createdAt": "2020-10-05T19:35:29Z", "author": {"login": "xieus"}, "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"network_id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"id\":\"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n+         \"name\":\"test_subnet2\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.2.0/24\",\n+         \"gateway_ip\":\"192.168.2.1\",\n+         \"availability_zone\":\"uswest-1\",\n+         \"dhcp_enable\":false,\n+         \"primary_dns\":null,\n+         \"secondary_dns\":null,\n+         \"dns_list\":null,\n+         \"tunnel_id\":\"88889\",\n+         \"portIdsPerHost\":[\n+            {\n+               \"hostIp\":\"10.213.43.187\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d3,f37810eb-7f83-45fa-a4d4-1b31e75399d0\"\n+            },\n+            {\n+               \"hostIp\":\"10.213.43.188\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d6,f37810eb-7f83-45fa-a4d4-1b31e75399d7\"\n+            }\n+         ],\n+         \"dhcpIds\":\"aaa,bbb\",\n+         \"gatewayMacs\":\"g1,g2\"\n+      }\n+   ],\n+   \"routers_internal\":[", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 194}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTUyMzYxOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNjo0NlrOHcrAAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMzo0MzoyMlrOHc06jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA==", "bodyText": "Suggest to rename the variable name to routerInfo.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499826688", "createdAt": "2020-10-05T19:36:46Z", "author": {"login": "xieus"}, "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0MzU1MA==", "bodyText": "fixed in a90538a", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499943550", "createdAt": "2020-10-06T00:32:54Z", "author": {"login": "haboy52581"}, "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA=="}, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4OTEzMg==", "bodyText": "@haboy52581 the variable name itself remains unchanged.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499989132", "createdAt": "2020-10-06T03:43:22Z", "author": {"login": "xieus"}, "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA=="}, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTUyNjY3OnYy", "diffSide": "RIGHT", "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTozNzozOVrOHcrBvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMDozMjo1MFrOHcyIbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzEzNA==", "bodyText": "Need to add setter and getter for the new field, and update ToString method.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499827134", "createdAt": "2020-10-05T19:37:39Z", "author": {"login": "xieus"}, "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;\n+\n   public void addPortEntity(InternalPortEntity portEntity) {\n     if (this.portEntities == null) {\n       this.portEntities = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0MzUzMw==", "bodyText": "fixed in a90538a", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499943533", "createdAt": "2020-10-06T00:32:50Z", "author": {"login": "haboy52581"}, "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;\n+\n   public void addPortEntity(InternalPortEntity portEntity) {\n     if (this.portEntities == null) {\n       this.portEntities = new ArrayList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzEzNA=="}, "originalCommit": {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMDU2OTQ0OnYy", "diffSide": "RIGHT", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMzozODo0OFrOHc02hQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMzozODo0OFrOHc02hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4ODEwMQ==", "bodyText": "Replace \"tab\" with space throughout the document.", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499988101", "createdAt": "2020-10-06T03:38:48Z", "author": {"login": "xieus"}, "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -552,7 +576,7 @@ Body:\n \t\t\"fixed_ips\": [{\n \t\t\t\"ip_address\": \"192.168.2.5\",\n \t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b30b6a6cadbce7f86cc0130125f7b1d53f91852"}, "originalPosition": 109}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4418, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}