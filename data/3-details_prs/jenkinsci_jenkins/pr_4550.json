{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MTIxNTAx", "number": 4550, "title": "[JENKINS-50669] RingBufferLogHandler improvement", "bodyText": "See JENKINS-50669.\n\nProposed changelog entries\n\nEntry 1: Improved way to get the DefaultRingBufferSize\nOld PR #4448.\nI created this because I had some conflicts with git and I had to redo my PRs.\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n JIRA issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a JIRA issue should exist and be labeled as lts-candidate", "createdAt": "2020-03-07T08:41:39Z", "url": "https://github.com/jenkinsci/jenkins/pull/4550", "merged": true, "mergeCommit": {"oid": "ded319294049f773455d752526e7984dee00b026"}, "closed": true, "closedAt": "2020-09-25T20:33:46Z", "author": {"login": "neaguandrei101"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLQfriAH2gAyMzg1MTIxNTAxOjc3ZmE1MWE0YThmYTRhM2Y0ZTJjNzNmY2FkNTU1NGQ5NzUxYmU2NWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMc5O_gFqTQ5Njg4MTA3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "77fa51a4a8fa4a3f4e2c73fcad5554d9751be65e", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/77fa51a4a8fa4a3f4e2c73fcad5554d9751be65e", "committedDate": "2020-03-07T08:32:20Z", "message": "[JENKINS-50669] RingBufferLogHandler improvement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MjM2NzUw", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-416236750", "createdAt": "2020-05-21T15:13:39Z", "commit": {"oid": "77fa51a4a8fa4a3f4e2c73fcad5554d9751be65e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e74880d3f5e37942d05e4ca66734995480656ee4", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/e74880d3f5e37942d05e4ca66734995480656ee4", "committedDate": "2020-09-05T21:19:39Z", "message": "Merge branch 'master' into RingBuffer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMzMwMjE2", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-483330216", "createdAt": "2020-09-07T07:53:05Z", "commit": {"oid": "e74880d3f5e37942d05e4ca66734995480656ee4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwNzo1MzowNlrOHN0T9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwNzo1MzoxNFrOHN0Uhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI1MDYxMg==", "bodyText": "Lacks either @Restricted or @since.", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r484250612", "createdAt": "2020-09-07T07:53:06Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/WebAppMain.java", "diffHunk": "@@ -112,13 +109,25 @@\n     @Restricted(NoExternalUse.class)\n     public static final String FORCE_SESSION_TRACKING_BY_COOKIE_PROP = WebAppMain.class.getName() + \".forceSessionTrackingByCookie\";\n \n-    private final RingBufferLogHandler handler = new RingBufferLogHandler(DEFAULT_RING_BUFFER_SIZE) {\n+    private final RingBufferLogHandler handler = new RingBufferLogHandler(WebAppMain.getDefaultRingBufferSize()) {\n+      \n         @Override public synchronized void publish(LogRecord record) {\n             if (record.getLevel().intValue() >= Level.INFO.intValue()) {\n                 super.publish(record);\n             }\n         }\n     };\n+\n+    /**This getter returns the int DEFAULT_RING_BUFFER_SIZE from the class RingBufferLogHandler from a static context.\n+     * Exposes access from RingBufferLogHandler.DEFAULT_RING_BUFFER_SIZE to WebAppMain.\n+     * Written for the requirements of JENKINS-50669\n+     * @return int This returns DEFAULT_RING_BUFFER_SIZE\n+     * @see <a href=\"https://issues.jenkins-ci.org/browse/JENKINS-50669\">JENKINS-50669</a>\n+     */\n+    public static int getDefaultRingBufferSize() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e74880d3f5e37942d05e4ca66734995480656ee4"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI1MDc1OQ==", "bodyText": "Lacks either @Restricted or @since.", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r484250759", "createdAt": "2020-09-07T07:53:14Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/util/RingBufferLogHandler.java", "diffHunk": "@@ -54,6 +54,10 @@ public RingBufferLogHandler(int ringSize) {\n         records = new LogRecord[ringSize];\n     }\n \n+    public static int getDefaultRingBufferSize() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e74880d3f5e37942d05e4ca66734995480656ee4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30a99ac9e224dc9c9b0fec5c8e37f8d6534e48b7", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/30a99ac9e224dc9c9b0fec5c8e37f8d6534e48b7", "committedDate": "2020-09-08T15:25:26Z", "message": "Javadoc fix and @Restricted added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/23e86a04db064ff4d5148fa7243e27b2717e685e", "committedDate": "2020-09-08T15:25:46Z", "message": "Merge remote-tracking branch 'origin/RingBuffer' into RingBuffer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1OTQ3MzMz", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-485947333", "createdAt": "2020-09-10T13:41:18Z", "commit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0MToxOVrOHP0R2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0MToxOVrOHP0R2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM0NzIyNg==", "bodyText": "I guess\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since 2.255\n          \n          \n            \n                 * @since TODO", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r486347226", "createdAt": "2020-09-10T13:41:19Z", "author": {"login": "MRamonLeon"}, "path": "core/src/main/java/hudson/util/RingBufferLogHandler.java", "diffHunk": "@@ -54,6 +57,16 @@ public RingBufferLogHandler(int ringSize) {\n         records = new LogRecord[ringSize];\n     }\n \n+    /**\n+     * @return int DEFAULT_RING_BUFFER_SIZE\n+     * @see <a href=\"https://issues.jenkins-ci.org/browse/JENKINS-50669\">JENKINS-50669</a>\n+     * @since 2.255", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1OTQ4MTU1", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-485948155", "createdAt": "2020-09-10T13:42:07Z", "commit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0MjowN1rOHP0Vag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0MjowN1rOHP0Vag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM0ODEzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since 2.255\n          \n          \n            \n                 * @since TODO", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r486348138", "createdAt": "2020-09-10T13:42:07Z", "author": {"login": "rsandell"}, "path": "core/src/main/java/hudson/WebAppMain.java", "diffHunk": "@@ -112,13 +109,27 @@\n     @Restricted(NoExternalUse.class)\n     public static final String FORCE_SESSION_TRACKING_BY_COOKIE_PROP = WebAppMain.class.getName() + \".forceSessionTrackingByCookie\";\n \n-    private final RingBufferLogHandler handler = new RingBufferLogHandler(DEFAULT_RING_BUFFER_SIZE) {\n+    private final RingBufferLogHandler handler = new RingBufferLogHandler(WebAppMain.getDefaultRingBufferSize()) {\n+      \n         @Override public synchronized void publish(LogRecord record) {\n             if (record.getLevel().intValue() >= Level.INFO.intValue()) {\n                 super.publish(record);\n             }\n         }\n     };\n+\n+    /**This getter returns the int DEFAULT_RING_BUFFER_SIZE from the class RingBufferLogHandler from a static context.\n+     * Exposes access from RingBufferLogHandler.DEFAULT_RING_BUFFER_SIZE to WebAppMain.\n+     * Written for the requirements of JENKINS-50669\n+     * @return int This returns DEFAULT_RING_BUFFER_SIZE\n+     * @see <a href=\"https://issues.jenkins-ci.org/browse/JENKINS-50669\">JENKINS-50669</a>\n+     * @since 2.255", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1OTQ4Nzcw", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-485948770", "createdAt": "2020-09-10T13:42:46Z", "commit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0Mjo0NlrOHP0YHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0Mjo0NlrOHP0YHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM0ODgzMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since 2.255\n          \n          \n            \n                 * @since TODO", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r486348831", "createdAt": "2020-09-10T13:42:46Z", "author": {"login": "rsandell"}, "path": "core/src/main/java/hudson/util/RingBufferLogHandler.java", "diffHunk": "@@ -54,6 +57,16 @@ public RingBufferLogHandler(int ringSize) {\n         records = new LogRecord[ringSize];\n     }\n \n+    /**\n+     * @return int DEFAULT_RING_BUFFER_SIZE\n+     * @see <a href=\"https://issues.jenkins-ci.org/browse/JENKINS-50669\">JENKINS-50669</a>\n+     * @since 2.255", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1OTQ5ODUw", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-485949850", "createdAt": "2020-09-10T13:43:50Z", "commit": {"oid": "23e86a04db064ff4d5148fa7243e27b2717e685e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0Mzo1MFrOHP0cdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxMzo0Mzo1MFrOHP0cdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM0OTk0MA==", "bodyText": "Reading the ticket I don't think this should be restricted. The original intent was for plugins to be able to read the value. If it is restricted then that is not possible.", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r486349940", "createdAt": "2020-09-10T13:43:50Z", "author": {"login": "rsandell"}, "path": "core/src/main/java/hudson/util/RingBufferLogHandler.java", "diffHunk": "@@ -54,6 +54,10 @@ public RingBufferLogHandler(int ringSize) {\n         records = new LogRecord[ringSize];\n     }\n \n+    public static int getDefaultRingBufferSize() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI1MDc1OQ=="}, "originalCommit": {"oid": "e74880d3f5e37942d05e4ca66734995480656ee4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17e6f993f2e8353e7dc25469c9f08efc36e43176", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/17e6f993f2e8353e7dc25469c9f08efc36e43176", "committedDate": "2020-09-10T16:03:51Z", "message": "[JENKINS-50669] @since TODO javadoc fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d15717204d700f43ee71c4201671f02deb9b5b89", "author": {"user": {"login": "neaguandrei101", "name": "Andrei Neagu"}}, "url": "https://github.com/jenkinsci/jenkins/commit/d15717204d700f43ee71c4201671f02deb9b5b89", "committedDate": "2020-09-10T16:07:36Z", "message": "[JENKINS-50669] Removed Restricted"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NjE3MTU5", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-495617159", "createdAt": "2020-09-24T14:12:31Z", "commit": {"oid": "d15717204d700f43ee71c4201671f02deb9b5b89"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2ODgxMDc4", "url": "https://github.com/jenkinsci/jenkins/pull/4550#pullrequestreview-496881078", "createdAt": "2020-09-25T21:44:11Z", "commit": {"oid": "d15717204d700f43ee71c4201671f02deb9b5b89"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQyMTo0NDoxMVrOHYUBEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQyMTo0NDoxMVrOHYUBEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTI1NTgyNQ==", "bodyText": "Unused imports", "url": "https://github.com/jenkinsci/jenkins/pull/4550#discussion_r495255825", "createdAt": "2020-09-25T21:44:11Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/util/RingBufferLogHandler.java", "diffHunk": "@@ -23,6 +23,9 @@\n  */\n package hudson.util;\n \n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.NoExternalUse;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d15717204d700f43ee71c4201671f02deb9b5b89"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1249, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}