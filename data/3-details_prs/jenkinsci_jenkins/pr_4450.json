{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MzU5NzM5", "number": 4450, "title": "[JENKINS-51856] Add new Jenkins initialization milestones: SYSTEM_CONFIG_LOADED, SYSTEM_CONFIG_ADAPTED, JOB_CONFIG_ADAPTED", "bodyText": "See JENKINS-51856 and CasC#280. Apart from that, it might have more sense to add several milestones instead of only one. My proposal:\n\nSYSTEM_CONFIG_LOADED: When the system files are loaded\nSYSTEM_CONFIG_ADAPTED: In case of any plugin might need to modify/update the configuration (tools installer, JCasC ...)\nJOB_CONFIG_ADAPTED: Similar to SYSTEM_CONFIG_ADAPTED. Once the jobs are loaded from the xml files, if any of them have to update old configurations (or similar). It might make sense for the init scripts.\n\nThis PR does not include tests since any test launching an instance would fail if something goes wrong in the initialization. I'm not even sure that the milestone can be tested.\nManually tested.\n\nProposed changelog entries\n\nJENKINS-51856: Extends the current milestones so plugins can update jobs and configuration during Jenkins initialization.\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n JIRA issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a JIRA issue should exist and be labeled as lts-candidate", "createdAt": "2020-01-23T13:24:03Z", "url": "https://github.com/jenkinsci/jenkins/pull/4450", "merged": true, "mergeCommit": {"oid": "efe2b876a95add37bbc5b10ca8c048125ef4f190"}, "closed": true, "closedAt": "2020-02-06T12:39:47Z", "author": {"login": "fcojfernandez"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9IqySgH2gAyMzY2MzU5NzM5OmFkZmEwYTlhN2ZkNGZhODAwY2VlOTVmNmIwOGVlM2M4NDdiZTc4MDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBZdftgFqTM1Mzg5NzY0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/adfa0a9a7fd4fa800cee95f6b08ee3c847be7804", "committedDate": "2020-01-23T11:30:17Z", "message": "[JENKINS-51856] Add new milestones"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MzA3MTg5", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347307189", "createdAt": "2020-01-23T13:48:43Z", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzo0ODo0M1rOFg-swg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzo0ODo0M1rOFg-swg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDEyNjAxOA==", "bodyText": "\"... all the system configuration ...\", to make sure this does not involve jobs", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370126018", "createdAt": "2020-01-23T13:48:43Z", "author": {"login": "olivergondza"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the configurations are loaded from file system", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MzA4MTk5", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347308199", "createdAt": "2020-01-23T13:50:08Z", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzo1MDowOFrOFg-v6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzo1MDowOFrOFg-v6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDEyNjgyNQ==", "bodyText": "OT but since we are touching this, do we want to make sure / document groovy init hooks are called here?", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370126825", "createdAt": "2020-01-23T13:50:08Z", "author": {"login": "olivergondza"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the configurations are loaded from file system\n+     */\n+    SYSTEM_CONFIG_LOADED(\"System config loaded\"),\n+\n+    /**\n+     * By this milestone, the system configuration is adapted just in case any plugin (CasC might be an example) needs\n+     * to update configuration files\n+     */\n+    SYSTEM_CONFIG_ADAPTED(\"System config adapted\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MzM1MDEw", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347335010", "createdAt": "2020-01-23T14:25:38Z", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNDoyNTozOFrOFg_-1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNDoyNTozOFrOFg_-1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0NzAyOA==", "bodyText": "The wording here is a little confusing just in case any plugin is updated doesn't really state an example that would make it obvious to the reader", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370147028", "createdAt": "2020-01-23T14:25:38Z", "author": {"login": "res0nance"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the configurations are loaded from file system\n+     */\n+    SYSTEM_CONFIG_LOADED(\"System config loaded\"),\n+\n+    /**\n+     * By this milestone, the system configuration is adapted just in case any plugin (CasC might be an example) needs\n+     * to update configuration files\n+     */\n+    SYSTEM_CONFIG_ADAPTED(\"System config adapted\"),\n \n     /**\n      * By this milestone, all jobs and their build records are loaded from disk.\n      */\n     JOB_LOADED(\"Loaded all jobs\"),\n \n+    /**\n+     * By this milestone, any job configuration is adapted or updated just in case any plugin is updated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDIwNDcw", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347420470", "createdAt": "2020-01-23T16:09:07Z", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNjowOTowN1rOFhD6MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNjowOTowN1rOFhD6MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDIxMTM3Ng==", "bodyText": "Maybe I'm missing something, where is it added to the lifecycle?", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370211376", "createdAt": "2020-01-23T16:09:07Z", "author": {"login": "MRamonLeon"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -43,7 +43,10 @@\n  *  <li>PLUGINS_PREPARED\n  *  <li>PLUGINS_STARTED\n  *  <li>EXTENSIONS_AUGMENTED\n+ *  <li>SYSTEM_CONFIG_LOADED</li>\n+ *  <li>SYSTEM_CONFIG_ADAPTED</li>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3ODAxMDQ3", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347801047", "createdAt": "2020-01-24T08:22:05Z", "commit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoyMjowNVrOFhWdbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoyNTo1N1rOFhWiIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUxNTMwOQ==", "bodyText": "If I understand correctly the magic inside Jenkins, it's added in the same way as EXTENSION_AUGMENTED, which is never attained directly:\n\n  \n    \n      jenkins/core/src/main/java/jenkins/model/Jenkins.java\n    \n    \n        Lines 965 to 970\n      in\n      30dbf72\n    \n    \n    \n    \n\n        \n          \n           // initialization consists of ... \n        \n\n        \n          \n           executeReactor( is, \n        \n\n        \n          \n                   pluginManager.initTasks(is),    // loading and preparing plugins \n        \n\n        \n          \n                   loadTasks(),                    // load jobs \n        \n\n        \n          \n                   InitMilestone.ordering()        // forced ordering among key milestones \n        \n\n        \n          \n           ); \n        \n    \n  \n\n\n(thanks @jtnord for the hit)", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370515309", "createdAt": "2020-01-24T08:22:05Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -43,7 +43,10 @@\n  *  <li>PLUGINS_PREPARED\n  *  <li>PLUGINS_STARTED\n  *  <li>EXTENSIONS_AUGMENTED\n+ *  <li>SYSTEM_CONFIG_LOADED</li>\n+ *  <li>SYSTEM_CONFIG_ADAPTED</li>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDIxMTM3Ng=="}, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUxNTUxOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * By this milestone, all the configurations are loaded from file system\n          \n          \n            \n                 * By this milestone, all the system configurations are loaded from file system", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370515518", "createdAt": "2020-01-24T08:22:45Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the configurations are loaded from file system", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDEyNjAxOA=="}, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUxNjUxMw==", "bodyText": "@res0nance what about this?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * By this milestone, any job configuration is adapted or updated just in case any plugin is updated\n          \n          \n            \n                 * By this milestone, any job configuration is adapted or updated just in case any plugin needs update former/old configurations or init scripts", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r370516513", "createdAt": "2020-01-24T08:25:57Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the configurations are loaded from file system\n+     */\n+    SYSTEM_CONFIG_LOADED(\"System config loaded\"),\n+\n+    /**\n+     * By this milestone, the system configuration is adapted just in case any plugin (CasC might be an example) needs\n+     * to update configuration files\n+     */\n+    SYSTEM_CONFIG_ADAPTED(\"System config adapted\"),\n \n     /**\n      * By this milestone, all jobs and their build records are loaded from disk.\n      */\n     JOB_LOADED(\"Loaded all jobs\"),\n \n+    /**\n+     * By this milestone, any job configuration is adapted or updated just in case any plugin is updated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0NzAyOA=="}, "originalCommit": {"oid": "adfa0a9a7fd4fa800cee95f6b08ee3c847be7804"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c22de096fbc377113130ea932a9e9fccd83ee335", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/c22de096fbc377113130ea932a9e9fccd83ee335", "committedDate": "2020-01-24T10:45:35Z", "message": "Apply suggestions from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f79828ffaafcadc0e0abd206ee98b15e555af3ef", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f79828ffaafcadc0e0abd206ee98b15e555af3ef", "committedDate": "2020-01-24T10:48:13Z", "message": "Merge branch 'master' into JENKINS-51856"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3OTc4NDYz", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-347978463", "createdAt": "2020-01-24T14:13:58Z", "commit": {"oid": "f79828ffaafcadc0e0abd206ee98b15e555af3ef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f3ed71bfcc855341138de08fa6369a8e474e9fb", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/3f3ed71bfcc855341138de08fa6369a8e474e9fb", "committedDate": "2020-01-27T11:07:46Z", "message": "[JENKINS-51856] Improve description of JOB_CONFIG_ADAPTED"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d4d313890a3f1ea4c989719e44fbf0bf17d22f5", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/1d4d313890a3f1ea4c989719e44fbf0bf17d22f5", "committedDate": "2020-01-27T11:08:40Z", "message": "[JENKINS-51856] Add test for milestones"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NTg1NDIx", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-348585421", "createdAt": "2020-01-27T11:10:36Z", "commit": {"oid": "1d4d313890a3f1ea4c989719e44fbf0bf17d22f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/b406701cd2df0bc19b8dfbb349116c1418621b8e", "committedDate": "2020-01-27T13:21:20Z", "message": "[JENKINS-51856] Fix test error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NzI1MjY2", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-348725266", "createdAt": "2020-01-27T14:58:14Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNzc0MzAw", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-350774300", "createdAt": "2020-01-30T12:05:51Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwOTE3Njk3", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-350917697", "createdAt": "2020-01-30T15:34:49Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDA4MjIz", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-351408223", "createdAt": "2020-01-31T10:16:31Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTI0NzAw", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-351924700", "createdAt": "2020-02-02T07:53:14Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQwNzo1MzoxNFrOFkgkKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQwNzo1NTo1NlrOFkgkpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgyNjYwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 */\n          \n          \n            \n                 * @since TODO\n          \n          \n            \n                 */\n          \n      \n    \n    \n  \n\nHere and below", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r373826603", "createdAt": "2020-02-02T07:53:14Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the system configurations are loaded from file system\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgyNjcyNg==", "bodyText": "It is a risk, because Groovy hooks may be used to adapt Job confis as well. So one must NOT rely on all jobs are adapted at this point, unless we redesign how Groovy hooks operate and introduce new calls there\nI suggest adding disclaimers to Javadoc and documenting this case.\nReverting this change could be also an option to discuss", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r373826726", "createdAt": "2020-02-02T07:55:56Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/hudson/init/impl/GroovyInitScript.java", "diffHunk": "@@ -36,7 +36,7 @@\n  * @author Kohsuke Kawaguchi\n  */\n public class GroovyInitScript {\n-    @Initializer(after=JOB_LOADED)\n+    @Initializer(after=JOB_CONFIG_ADAPTED)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMDkzOTE4", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-352093918", "createdAt": "2020-02-03T08:50:18Z", "commit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwODo1MDoxOVrOFkp5aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwODo1MzoxNVrOFkp-IQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk3OTQ5Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 */\n          \n          \n            \n                 * @since TODO\n          \n          \n            \n                 */", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r373979496", "createdAt": "2020-02-03T08:50:19Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the system configurations are loaded from file system\n+     */\n+    SYSTEM_CONFIG_LOADED(\"System config loaded\"),\n+\n+    /**\n+     * By this milestone, the system configuration is adapted just in case any plugin (CasC might be an example) needs\n+     * to update configuration files\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk3OTU2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 */\n          \n          \n            \n                 * @since TODO\n          \n          \n            \n                 */", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r373979569", "createdAt": "2020-02-03T08:50:31Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/InitMilestone.java", "diffHunk": "@@ -82,13 +85,29 @@\n      * By this milestone, all programmatically constructed extension point implementations\n      * should be added.\n      */\n-    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"), // TODO nothing attains() this so when does it actually happen?\n+    EXTENSIONS_AUGMENTED(\"Augmented all extensions\"),\n+\n+    /**\n+     * By this milestone, all the system configurations are loaded from file system\n+     */\n+    SYSTEM_CONFIG_LOADED(\"System config loaded\"),\n+\n+    /**\n+     * By this milestone, the system configuration is adapted just in case any plugin (CasC might be an example) needs\n+     * to update configuration files\n+     */\n+    SYSTEM_CONFIG_ADAPTED(\"System config adapted\"),\n \n     /**\n      * By this milestone, all jobs and their build records are loaded from disk.\n      */\n     JOB_LOADED(\"Loaded all jobs\"),\n \n+    /**\n+     * By this milestone, any job configuration is adapted or updated just in case any plugin needs to update former/old configurations or init scripts\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk4MDcwNQ==", "bodyText": "Reverting this change could be also an option to discuss\n\n@oleg-nenashev do you mean reverting this concrete change or not adding this JOB_CONFIG_ADAPTED milestone?", "url": "https://github.com/jenkinsci/jenkins/pull/4450#discussion_r373980705", "createdAt": "2020-02-03T08:53:15Z", "author": {"login": "fcojfernandez"}, "path": "core/src/main/java/hudson/init/impl/GroovyInitScript.java", "diffHunk": "@@ -36,7 +36,7 @@\n  * @author Kohsuke Kawaguchi\n  */\n public class GroovyInitScript {\n-    @Initializer(after=JOB_LOADED)\n+    @Initializer(after=JOB_CONFIG_ADAPTED)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgyNjcyNg=="}, "originalCommit": {"oid": "b406701cd2df0bc19b8dfbb349116c1418621b8e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b8462e148f63294bbedbcdaf124567d21ec1d08", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/0b8462e148f63294bbedbcdaf124567d21ec1d08", "committedDate": "2020-02-03T08:58:42Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: Oleg Nenashev <o.v.nenashev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab12f71a48901ab3b78521382057a03e166fe668", "author": {"user": {"login": "fcojfernandez", "name": "Francisco Javier Fernandez"}}, "url": "https://github.com/jenkinsci/jenkins/commit/ab12f71a48901ab3b78521382057a03e166fe668", "committedDate": "2020-02-05T11:36:01Z", "message": "Update core/src/main/java/hudson/init/impl/GroovyInitScript.java\n\nCo-Authored-By: Tim Jacomb <t.jacomb@kainos.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNjUzMTIz", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-353653123", "createdAt": "2020-02-05T11:43:11Z", "commit": {"oid": "ab12f71a48901ab3b78521382057a03e166fe668"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzODk3NjQ1", "url": "https://github.com/jenkinsci/jenkins/pull/4450#pullrequestreview-353897645", "createdAt": "2020-02-05T17:19:52Z", "commit": {"oid": "ab12f71a48901ab3b78521382057a03e166fe668"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1440, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}