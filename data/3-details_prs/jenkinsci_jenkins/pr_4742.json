{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyODkwNTQy", "number": 4742, "title": "[JENKINS-62332] Show when a plugin version newer than offered exists", "bodyText": "See JENKINS-62332 and jenkins-infra/update-center2#382\nThis adds notices to entries on the 'Updates' and 'Available' tabs of the plugin manager when a newer version exists than is being offered for installation.\nIf the instance has the latest offered plugin release installed, new virtual (uninstallable) entries are created on the 'Updates' tab to inform users that something newer exists. On one hand I like that this shows unavailable content right where it would appear, OTOH it could be weird or confusing, especially if admins don't read. Feedback welcome.\n\nScreenshots\nBefore\n\nAfter\n\n\nTesting notes\nReplace the update site URL in Plugin Manager \u00bb Advanced with https://updates.jenkins.io/2.204/update-center.json\nProposed changelog entries\n\nShow in plugin manager when newer releases of plugins exist but aren't being offered due to unsatisfied requirements.\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-05-25T20:40:40Z", "url": "https://github.com/jenkinsci/jenkins/pull/4742", "merged": true, "mergeCommit": {"oid": "2776f4dc77d12650e310dc10c005f95937ac3469"}, "closed": true, "closedAt": "2020-06-07T08:51:17Z", "author": {"login": "daniel-beck"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABck2PwDAH2gAyNDIyODkwNTQyOmMxZjRmOGRjYzgxYjYwNWYxNjc3NmVlYzNkNjc3ZTJlMGIxMzQ3YzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoNtdEAFqTQyNTA2NTU0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "committedDate": "2020-05-25T20:39:26Z", "message": "[JENKINS-62332] Show when a plugin version newer than offered exists"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTMxODEw", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-417931810", "createdAt": "2020-05-26T02:18:58Z", "commit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjoxODo1OFrOGaMs1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjoxOTozNlrOGaMtXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyNDI0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.\n          \n          \n            \n              This is typically the case when plugin's requirements are not satisfied. e.g. a more recent version of Jenkins", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430124247", "createdAt": "2020-05-26T02:18:58Z", "author": {"login": "res0nance"}, "path": "core/src/main/resources/hudson/PluginManager/table.properties", "diffHunk": "@@ -51,6 +51,13 @@ ago={0} ago\n adoptThisPlugin=\\\n   <strong>This plugin is up for adoption!</strong> We are looking for new maintainers. \\\n   Visit our <a href=\"https://jenkins.io/doc/developer/plugin-governance/adopt-a-plugin/\" target=\"_blank\">Adopt a Plugin</a> initiative for more information.\n+newerVersionExists=\\\n+  A newer version than being offered for installation exists (version {0}). \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyNDM4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied. \\\n          \n          \n            \n              This is typically the case when plugin's requirements are not satisfied. e.g. a more recent version of Jenkins. \\", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430124382", "createdAt": "2020-05-26T02:19:36Z", "author": {"login": "res0nance"}, "path": "core/src/main/resources/hudson/PluginManager/table.properties", "diffHunk": "@@ -51,6 +51,13 @@ ago={0} ago\n adoptThisPlugin=\\\n   <strong>This plugin is up for adoption!</strong> We are looking for new maintainers. \\\n   Visit our <a href=\"https://jenkins.io/doc/developer/plugin-governance/adopt-a-plugin/\" target=\"_blank\">Adopt a Plugin</a> initiative for more information.\n+newerVersionExists=\\\n+  A newer version than being offered for installation exists (version {0}). \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.\n+newerVersionEntry=\\\n+  This version of the plugin exists but it is not being offered as an update. \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied. \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTk1ODYz", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-417995863", "createdAt": "2020-05-26T06:14:49Z", "commit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDk3MTQ0", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-418097144", "createdAt": "2020-05-26T08:52:46Z", "commit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODo1Mjo0NlrOGaUytQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODo1Mjo0NlrOGaUytQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1NjgyMQ==", "bodyText": "Isn't this taken care of in the plugin.latest calculation?", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430256821", "createdAt": "2020-05-26T08:52:46Z", "author": {"login": "varyvol"}, "path": "core/src/main/java/hudson/PluginManager.java", "diffHunk": "@@ -2266,6 +2266,14 @@ public boolean hasAdoptThisPluginLabel(UpdateSite.Plugin plugin) {\n         return Arrays.asList(categories).contains(\"adopt-this-plugin\");\n     }\n \n+    @Restricted(DoNotUse.class) // Used from table.jelly\n+    public boolean hasLatestVersionNewerThanOffered(UpdateSite.Plugin plugin) {\n+        if (plugin.latest == null) {\n+            return false;\n+        }\n+        return !plugin.latest.equalsIgnoreCase(plugin.version); // we can assume that any defined 'latest' will be newer than the actual offered version", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8", "committedDate": "2020-05-29T06:54:50Z", "message": "Add more obvious label/tag to entries that cannot be installed\n\nAlso link to plugin documentation from the detail message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwODI3NzAz", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-420827703", "createdAt": "2020-05-29T10:17:11Z", "commit": {"oid": "fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwOTI1NTUy", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-420925552", "createdAt": "2020-05-29T12:57:14Z", "commit": {"oid": "fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMDE2MDU4", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-421016058", "createdAt": "2020-05-29T14:38:03Z", "commit": {"oid": "fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/65bd0f8e6443a437f1bddbc460e8af4ee29588ff", "committedDate": "2020-05-29T15:34:33Z", "message": "Also show the list if there are any unavailable updates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODQ2MzE0", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-424846314", "createdAt": "2020-06-04T21:24:22Z", "commit": {"oid": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMToyNDoyMlrOGfYkPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMToyNDoyMlrOGfYkPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU2MTUzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            }\n          \n          \n            \n            }", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r435561532", "createdAt": "2020-06-04T21:24:22Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -76,3 +76,23 @@ time {\n .hidden {\n     display: none;\n }\n+\n+#plugins tr.unavailable {\n+  background-color: #f4f4f4;\n+}\n+tr.unavailable span.unavailable-label {\n+    display: inline-block;\n+    border: 1px solid #666;\n+    background-color: #fcc;\n+    color: #333;\n+    border-radius: 4px;\n+    font-size: 0.75rem;\n+    font-weight: 500;\n+    padding: 0 0.5rem;\n+    margin: 0.25rem 0.5rem;\n+    text-decoration: none;\n+    text-align: center;\n+    white-space: nowrap;\n+    vertical-align: baseline;\n+    text-transform: uppercase;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MDY1NTQy", "url": "https://github.com/jenkinsci/jenkins/pull/4742#pullrequestreview-425065542", "createdAt": "2020-06-05T07:41:28Z", "commit": {"oid": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2265, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}