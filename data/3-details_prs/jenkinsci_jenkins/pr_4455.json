{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MTU3ODcw", "number": 4455, "title": "[JENKINS-60866] Un-inline JavaScript / CSS from HudsonPrivateSecurity\u2026", "bodyText": "Un-inline the JavaScript and CSS from the jelly views of the security realm except signup.jelly.\n\n\"changes\" have a comment in the PR to explain reasons.\ncleanup / standardize the jelly namespaces\nadd / improve the documentation of the taglib inside the embedded security realm, that should clarify where the different variables are coming from\n\nTesting notes:\n\ndocker run --rm -it -p 8080:8080 -e ID=4455 jenkins/core-pr-tester\nfor firstUser.jelly, you need to setup an instance with the embedded security realm, disallow the signup and ensure you do not have any user\nfor addUser.jelly, you need to setup the embedded security realm and go to <jenkins-url>/securityRealm/addUser\n\u26a0\ufe0f No way found to test the signupWithFederatedIdentity.jelly\n\n\nSee JENKINS-60866.\n\nProposed changelog entries\n\n(internal) Remove inline resources from HudsonPrivateSecurityRealm views\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n JIRA issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n[n/a] Appropriate autotests or explanation to why this change has no tests\n[n/a] For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a JIRA issue should exist and be labeled as lts-candidate", "createdAt": "2020-01-25T21:44:37Z", "url": "https://github.com/jenkinsci/jenkins/pull/4455", "merged": true, "mergeCommit": {"oid": "a405be946fd943415affdad7ec7f067dcf98f856"}, "closed": true, "closedAt": "2020-02-15T11:49:52Z", "author": {"login": "Wadeck"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb96m8AAH2gAyMzY3MTU3ODcwOjM2Mzg1N2Q0MzZkZDBmNDFhZTU5N2ZkYmJjMDJjNTk3NzM5MzQ0YWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcB7lsxgFqTM1NTAxMjYyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa", "author": {"user": {"login": "Wadeck", "name": "Wadeck Follonier"}}, "url": "https://github.com/jenkinsci/jenkins/commit/363857d436dd0f41ae597fdbbc02c597739344aa", "committedDate": "2020-01-25T21:41:20Z", "message": "[JENKINS-60866] Un-inline JavaScript / CSS from HudsonPrivateSecurityRealm"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ3MDY3", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-348347067", "createdAt": "2020-01-25T21:45:46Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NTo0NlrOFhxe9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NTo0NlrOFhxe9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODA3MQ==", "bodyText": "To improve consistency with the user list view", "url": "https://github.com/jenkinsci/jenkins/pull/4455#discussion_r370958071", "createdAt": "2020-01-25T21:45:46Z", "author": {"login": "Wadeck"}, "path": "core/src/main/resources/hudson/model/View/AsynchPeople/index.jelly", "diffHunk": "@@ -100,7 +100,7 @@ THE SOFTWARE.\n       <l:progressiveRendering handler=\"${it}\" callback=\"display\"/>\n       <table class=\"sortable pane bigtable\" id=\"people\">\n         <tr>\n-          <th />\n+          <th class=\"minimum-width\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ3MDkw", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-348347090", "createdAt": "2020-01-25T21:46:23Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NjoyM1rOFhxfIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NjoyM1rOFhxfIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODExNQ==", "bodyText": "https://caniuse.com/#feat=autofocus instead of having a custom javascript doing the same as the browser", "url": "https://github.com/jenkinsci/jenkins/pull/4455#discussion_r370958115", "createdAt": "2020-01-25T21:46:23Z", "author": {"login": "Wadeck"}, "path": "core/src/main/resources/hudson/security/HudsonPrivateSecurityRealm/_entryForm.jelly", "diffHunk": "@@ -24,23 +24,41 @@ THE SOFTWARE.\n \n <!-- tag file used by both signup.jelly and addUser.jelly -->\n <?jelly escape-by-default='true'?>\n-<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\">\n+<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\">\n+  <st:documentation>\n+    <st:attribute name=\"it\" use=\"required\" type=\"hudson.security.HudsonPrivateSecurityRealm\">\n+      Context where the page is loaded.\n+    </st:attribute>\n+    <st:attribute name=\"title\" use=\"required\">\n+      Title of the HTML page. Rendered in the page content inside a &lt;h1>.\n+    </st:attribute>\n+    <st:attribute name=\"action\" use=\"required\">\n+      The method to call from within the HudsonPrivateSecurityRealm.\n+    </st:attribute>\n+    <st:attribute name=\"captcha\" use=\"optional\">\n+      Determines if the tag will include the captcha.\n+    </st:attribute>\n+    <st:attribute name=\"data\" use=\"optional\" type=\"hudson.security.HudsonPrivateSecurityRealm.SignupInfo\">\n+      The wrapper for the data provided by the user and the error message(s) if any. Is null on first form display.\n+    </st:attribute>\n+  </st:documentation>\n+\n   <h1>${title}</h1>\n-  <div style=\"margin: 2em;\">\n+  <div class=\"form-content\">\n     <j:if test=\"${data.errorMessage!=null}\">\n-      <div class=\"error\" style=\"margin-bottom:1em\">\n+      <div class=\"error\">\n         ${data.errorMessage}\n       </div>\n     </j:if>\n     <j:forEach var=\"error\" items=\"${data.errors}\">\n-      <div class=\"error\" style=\"margin-bottom:1em\">\n+      <div class=\"error\">\n         ${error.value}\n       </div>\n     </j:forEach>\n       <table>\n         <tr>\n           <td>${%Username}:</td>\n-          <td><input type=\"text\" name=\"username\" id=\"username\" value=\"${data.username}\" /></td>\n+          <td><input type=\"text\" name=\"username\" id=\"username\" value=\"${data.username}\" autofocus=\"autofocus\" /></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ3MTM1", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-348347135", "createdAt": "2020-01-25T21:47:06Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NzowNlrOFhxfWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0NzowNlrOFhxfWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODE2OA==", "bodyText": "text-size is not a CSS instruction", "url": "https://github.com/jenkinsci/jenkins/pull/4455#discussion_r370958168", "createdAt": "2020-01-25T21:47:06Z", "author": {"login": "Wadeck"}, "path": "core/src/main/resources/hudson/security/HudsonPrivateSecurityRealm/_entryFormPage.jelly", "diffHunk": "@@ -22,28 +22,36 @@ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n -->\n \n-<!-- tag file used by both signup.jelly and addUser.jelly -->\n+<!-- tag file used by signupWithFederatedIdentity.jelly, addUser.jelly and firstUser.jelly -->\n <?jelly escape-by-default='true'?>\n-<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\">\n+<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:l=\"/lib/layout\" xmlns:f=\"/lib/form\" xmlns:local=\"/hudson/security/HudsonPrivateSecurityRealm\">\n+  <st:documentation>\n+    <st:attribute name=\"host\" use=\"required\" type=\"hudson.security.HudsonPrivateSecurityRealm\">\n+      Corresponds to the \"it\" of Jelly, meaning the context where the page is loaded.\n+    </st:attribute>\n+    <st:attribute name=\"title\" use=\"required\">\n+      Title of the HTML page. \n+      Rendered into &lt;title> tag, in the page content inside a &lt;h1> and as the label of the submit button.\n+    </st:attribute>\n+    <st:attribute name=\"action\" use=\"required\">\n+      The method to call from within the HudsonPrivateSecurityRealm.\n+    </st:attribute>\n+    <st:attribute name=\"captcha\" use=\"optional\" type=\"boolean\">\n+      Determines if the tag will include the captcha.\n+    </st:attribute>\n+    <st:attribute name=\"data\" use=\"optional\" type=\"hudson.security.HudsonPrivateSecurityRealm.SignupInfo\">\n+      The wrapper for the data provided by the user and the error message(s) if any. Is null on first form display.\n+    </st:attribute>\n+  </st:documentation>\n   <l:layout norefresh=\"true\" title=\"${title}\">\n-    <l:header>\n-      <style>\n-        <!-- match width with captcha image -->\n-        INPUT {\n-          width:200px;\n-        }\n-      </style>\n-    </l:header>\n+    <st:adjunct includes=\"hudson.security.HudsonPrivateSecurityRealm._entryFormPage.resources\" />\n     <l:hasPermission permission=\"${app.READ}\" it=\"${host}\">\n       <st:include page=\"sidepanel.jelly\" it=\"${host}\" />\n     </l:hasPermission>\n     <l:main-panel>\n-      <form action=\"${rootURL}/securityRealm/${action}\" method=\"post\" style=\"text-size:smaller\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ3MTc0", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-348347174", "createdAt": "2020-01-25T21:47:59Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0ODowMFrOFhxfew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo0ODowMFrOFhxfew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODIwMw==", "bodyText": "Tested with Firefox, Chrome, Opera, IE 11, the table is expanded to the minimum width required by the content.", "url": "https://github.com/jenkinsci/jenkins/pull/4455#discussion_r370958203", "createdAt": "2020-01-25T21:48:00Z", "author": {"login": "Wadeck"}, "path": "war/src/main/webapp/css/style.css", "diffHunk": "@@ -522,6 +522,10 @@ table.bigtable.pane > tbody > tr > td:last-child {\n   white-space: nowrap;\n }\n \n+.bigtable th.minimum-width {\n+  width: 1px;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4OTA3MjUz", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-348907253", "createdAt": "2020-01-27T19:12:41Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNzAyMzUx", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-350702351", "createdAt": "2020-01-30T10:01:35Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTI0Mjc1", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-351924275", "createdAt": "2020-02-02T07:45:31Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MzIwNzQ3", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-354320747", "createdAt": "2020-02-06T09:53:29Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MzIwODY3", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-354320867", "createdAt": "2020-02-06T09:53:38Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MzIxMzc3", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-354321377", "createdAt": "2020-02-06T09:54:20Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MDEyNjIz", "url": "https://github.com/jenkinsci/jenkins/pull/4455#pullrequestreview-355012623", "createdAt": "2020-02-07T09:03:38Z", "commit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwOTowMzozOFrOFm2V0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwOTowMzozOFrOFm2V0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI4MDUyOQ==", "bodyText": "Makes sense, but probably a separate PR or a changelog entry? Is it a real issue with rendering you hit? Or just housekeeping?", "url": "https://github.com/jenkinsci/jenkins/pull/4455#discussion_r376280529", "createdAt": "2020-02-07T09:03:38Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/resources/hudson/model/View/AsynchPeople/index.jelly", "diffHunk": "@@ -100,7 +100,7 @@ THE SOFTWARE.\n       <l:progressiveRendering handler=\"${it}\" callback=\"display\"/>\n       <table class=\"sortable pane bigtable\" id=\"people\">\n         <tr>\n-          <th />\n+          <th class=\"minimum-width\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODA3MQ=="}, "originalCommit": {"oid": "363857d436dd0f41ae597fdbbc02c597739344aa"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1459, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}