{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MjI5MjYz", "number": 4933, "title": "Fix deprecation warnings + Update ArtifactArchiver to no longer consult with environment variables injected by EnvironmentContributingActions during the build", "bodyText": "Fixed a couple of deprecation warnings without changing behavior.\nProposed changelog entries\n\nUpdate ArtifactArchiver to no longer consult with environment variables injected by EnvironmentContributingActions added during the build, including ArtifactManager ones\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-09-13T19:35:39Z", "url": "https://github.com/jenkinsci/jenkins/pull/4933", "merged": true, "mergeCommit": {"oid": "93428a432d6e8aa7c3201e69763f8a632caa3461"}, "closed": true, "closedAt": "2020-10-14T15:05:43Z", "author": {"login": "StefanSpieker"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIj17wgH2gAyNDg2MjI5MjYzOmNhZTVhNTUzNDlmNTVmN2JjZWYzMDQ1NGY3OGMxZmE1Y2U3YWVjNmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRxtG9AFqTUwNjUwODM5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/cae5a55349f55f7bcef30454f78c1fa5ce7aec6d", "committedDate": "2020-09-13T19:34:13Z", "message": "fixed deprecation warnings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MzM5NzY3", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-487339767", "createdAt": "2020-09-13T21:05:06Z", "commit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMTowNTowNlrOHQ_W3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMTowNTowNlrOHQ_W3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU3NzMxMA==", "bodyText": "Pretty sure this is wrong given what it does.", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r487577310", "createdAt": "2020-09-13T21:05:06Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/node_monitors/AbstractNodeMonitorDescriptor.java", "diffHunk": "@@ -227,7 +227,7 @@ protected boolean markOnline(Computer c) {\n      *      or the computer already marked offline.)\n      */\n     protected boolean markOffline(Computer c, OfflineCause oc) {\n-        if(isIgnored() || c.isTemporarilyOffline()) return false; // noop\n+        if(isIgnored() || c.isOffline()) return false; // noop", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MzM5OTM0", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-487339934", "createdAt": "2020-09-13T21:07:36Z", "commit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMTowNzozNlrOHQ_X1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMTowNzozNlrOHQ_X1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU3NzU1Ng==", "bodyText": "Makes no sense in context.", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r487577556", "createdAt": "2020-09-13T21:07:36Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/tasks/BuildStep.java", "diffHunk": "@@ -95,7 +95,7 @@\n      * Runs the step over the given build and reports the progress to the listener.\n      *\n      * <p>\n-     * A plugin can contribute the action object to {@link Build#getActions()}\n+     * A plugin can contribute the action object to {@link Build#getAllActions()}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MzQwMDAw", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-487340000", "createdAt": "2020-09-13T21:08:31Z", "commit": {"oid": "cae5a55349f55f7bcef30454f78c1fa5ce7aec6d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ce2b77656f943f72459fe2adb49f1426ce8897b", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/8ce2b77656f943f72459fe2adb49f1426ce8897b", "committedDate": "2020-09-24T15:26:06Z", "message": "reverted changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db6d72e8735861e33c45e2034339c0216fc7d32c", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/db6d72e8735861e33c45e2034339c0216fc7d32c", "committedDate": "2020-09-24T15:27:10Z", "message": "fixed typeo in javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1Njk0MTg5", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-495694189", "createdAt": "2020-09-24T15:27:58Z", "commit": {"oid": "db6d72e8735861e33c45e2034339c0216fc7d32c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTc4NTk2", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-496178596", "createdAt": "2020-09-25T07:36:25Z", "commit": {"oid": "db6d72e8735861e33c45e2034339c0216fc7d32c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNzozNjoyNVrOHX4ZoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNzozNjoyNVrOHX4ZoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDgwMzM2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                f.perform(build, ws, build.getEnvironment(listener), launcher, listener);\n          \n          \n            \n                                f.perform(build, ws, environment, launcher, listener);\n          \n      \n    \n    \n  \n\n(Unsure but seems more straightforward.)", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r494803361", "createdAt": "2020-09-25T07:36:25Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/tasks/ArtifactArchiver.java", "diffHunk": "@@ -260,7 +260,7 @@ public void perform(Run<?,?> build, FilePath ws, EnvVars environment, Launcher l\n                     f.setExcludes(excludes);\n                     f.setDefaultExcludes(defaultExcludes);\n                     f.setCaseSensitive(caseSensitive);\n-                    f.perform(build, ws, launcher, listener);\n+                    f.perform(build, ws, build.getEnvironment(listener), launcher, listener);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db6d72e8735861e33c45e2034339c0216fc7d32c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/06955fdc6cb5950a3d5bda6111a5a392c9c740bc", "committedDate": "2020-09-25T12:09:59Z", "message": "Update core/src/main/java/hudson/tasks/ArtifactArchiver.java\n\nCo-authored-by: Daniel Beck <1831569+daniel-beck@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MzYzMjk5", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-496363299", "createdAt": "2020-09-25T12:13:07Z", "commit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU4NTEx", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-497058511", "createdAt": "2020-09-27T07:21:55Z", "commit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MzQzNTU2", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-499343556", "createdAt": "2020-09-30T11:45:38Z", "commit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMTo0NTozOVrOHaZobg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMTo0NTozOVrOHaZobg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NDk3NA==", "bodyText": "This might slightly change the behavior. Missing argument will force environment variable recalculation in https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/tasks/SimpleBuildStep.java#L91 . Instead of that, current code will use the environment passed in the beginning of the step. In the edge case build.pickArtifactManager().archive might perform some environment-contributing actions, which will no longer be considered after the change.", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r497444974", "createdAt": "2020-09-30T11:45:39Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/hudson/tasks/ArtifactArchiver.java", "diffHunk": "@@ -260,7 +260,7 @@ public void perform(Run<?,?> build, FilePath ws, EnvVars environment, Launcher l\n                     f.setExcludes(excludes);\n                     f.setDefaultExcludes(defaultExcludes);\n                     f.setCaseSensitive(caseSensitive);\n-                    f.perform(build, ws, launcher, listener);\n+                    f.perform(build, ws, environment, launcher, listener);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5Nzc0MzIy", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-499774322", "createdAt": "2020-09-30T20:10:56Z", "commit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMDoxMDo1NlrOHatkXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMDoxMjozMFrOHatndA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc3MTYxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        User user = User.get(startedBy, false, Collections.emptyMap());\n          \n          \n            \n                        User user = User.getById(startedBy, false);", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r497771613", "createdAt": "2020-09-30T20:10:56Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/cli/BuildCommand.java", "diffHunk": "@@ -252,7 +253,7 @@ public CLICause(String startedBy){\n \n         @Override\n         public String getShortDescription() {\n-            User user = User.get(startedBy, false);\n+            User user = User.get(startedBy, false, Collections.emptyMap());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc3MjQwNA==", "bodyText": "No, do not do that! The currently proposed patch is correct.", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r497772404", "createdAt": "2020-09-30T20:12:30Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/tasks/ArtifactArchiver.java", "diffHunk": "@@ -260,7 +260,7 @@ public void perform(Run<?,?> build, FilePath ws, EnvVars environment, Launcher l\n                     f.setExcludes(excludes);\n                     f.setDefaultExcludes(defaultExcludes);\n                     f.setCaseSensitive(caseSensitive);\n-                    f.perform(build, ws, launcher, listener);\n+                    f.perform(build, ws, environment, launcher, listener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NDk3NA=="}, "originalCommit": {"oid": "06955fdc6cb5950a3d5bda6111a5a392c9c740bc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b8cd6ae3f3ce7edfe0a909fb8e9a0ccae471668", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/0b8cd6ae3f3ce7edfe0a909fb8e9a0ccae471668", "committedDate": "2020-10-02T06:23:51Z", "message": "Update core/src/main/java/hudson/cli/BuildCommand.java\n\nCo-authored-by: Jesse Glick <jglick@cloudbees.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMTIwODM2", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-501120836", "createdAt": "2020-10-02T13:11:08Z", "commit": {"oid": "0b8cd6ae3f3ce7edfe0a909fb8e9a0ccae471668"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzoxMTowOVrOHbtBWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzoxMTowOVrOHbtBWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgxMTIyNA==", "bodyText": "Fix imports?", "url": "https://github.com/jenkinsci/jenkins/pull/4933#discussion_r498811224", "createdAt": "2020-10-02T13:11:09Z", "author": {"login": "jglick"}, "path": "core/src/main/java/jenkins/util/JSONSignatureValidator.java", "diffHunk": "@@ -184,7 +184,7 @@ private FormValidation checkSpecificSignature(JSONObject json, JSONObject signat\n         //\n         // Jenkins should ignore \"digest\"/\"signature\" pair. Accepting it creates a vulnerability that allows\n         // the attacker to inject a fragment at the end of the json.\n-        json.writeCanonical(new OutputStreamWriter(new TeeOutputStream(dos,sos), Charsets.UTF_8)).close();\n+        json.writeCanonical(new OutputStreamWriter(new TeeOutputStream(dos,sos), StandardCharsets.UTF_8)).close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b8cd6ae3f3ce7edfe0a909fb8e9a0ccae471668"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0cd0cac52f882c1c4bc56ba0c123fec47bbb81a", "author": {"user": {"login": "StefanSpieker", "name": "Stefan Spieker"}}, "url": "https://github.com/jenkinsci/jenkins/commit/a0cd0cac52f882c1c4bc56ba0c123fec47bbb81a", "committedDate": "2020-10-12T07:50:40Z", "message": "fixed imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTA4Mzkx", "url": "https://github.com/jenkinsci/jenkins/pull/4933#pullrequestreview-506508391", "createdAt": "2020-10-12T10:48:34Z", "commit": {"oid": "a0cd0cac52f882c1c4bc56ba0c123fec47bbb81a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1952, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}