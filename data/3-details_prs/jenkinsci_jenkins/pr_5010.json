{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MTI2MTYz", "number": 5010, "title": "[JENKINS-35452] A step towards removing more 'slave' terminology.", "bodyText": "Overload the mechanisms for obtaining the jenkins-agent.jnlp (formerly slave-agent.jnlp) file for launching inbound TCP agents.\nServe the file at either of the two locations.\nChange the UI (etc.) documentation to reference the correct term / file.\nThis doesn't allow us to remove the old, incorrect term, but allows us a path forward. Existing agents and configurations continue to work. New ones are suggested to use the new terms and locations. This obsoletes the old. At some point we can remove the old and anyone who hasn't yet done the replacement on their configuration will have to do it. Anyone interested can do it immediately as it doesn't require any agent (Remoting) changes.\nSee JENKINS-35452.\nProposed changelog entries\n\nEntry 1: [JENKINS-35452], Change the standard URL for obtaining the Inbound Agent configuration file from \"[...]/slave-agent.jnlp\" to \"[...]/jenkins-agent.jnlp\". The old name is obsoleted and will be removed at a future time.\n...\n\nProposed upgrade guidelines\n[May want to insert a recommendation on changing the file name for existing agents.]\nSubmitter checklist\n\n (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n[n/a] For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-10-16T22:12:39Z", "url": "https://github.com/jenkinsci/jenkins/pull/5010", "merged": true, "mergeCommit": {"oid": "7b952de6c606bb5bafc1d7d4cbf09b84fb016b54"}, "closed": true, "closedAt": "2020-10-26T12:48:54Z", "author": {"login": "jeffret-b"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTNiiOgH2gAyNTA1MTI2MTYzOjI3YTcxZjk4MWJiNmU4MmQ1NTI0NTQ3YTUxY2YyNTVjZjI1ZGZmYWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWT7Z1gFqTUxNjc0NzI0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "27a71f981bb6e82d5524547a51cf255cf25dffae", "author": {"user": {"login": "jeffret-b", "name": "Jeff Thompson"}}, "url": "https://github.com/jenkinsci/jenkins/commit/27a71f981bb6e82d5524547a51cf255cf25dffae", "committedDate": "2020-10-16T21:48:17Z", "message": "A step towards removing more 'slave' terminology.\n\nOverload the mechanisms for obtaining the jenkins-agent.jnlp (formerly slave-agent.jnlp) file for launching inbound TCP agents.\nServe the file at either of the two locations.\nChange the UI (etc.) documentation to reference the correct term / file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd06a653973bda3df1a2eeee5690af63523d72dd", "author": {"user": {"login": "jeffret-b", "name": "Jeff Thompson"}}, "url": "https://github.com/jenkinsci/jenkins/commit/fd06a653973bda3df1a2eeee5690af63523d72dd", "committedDate": "2020-10-16T22:11:24Z", "message": "Convert test to correct terminology."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwODQwODk0", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-510840894", "createdAt": "2020-10-16T23:05:44Z", "commit": {"oid": "fd06a653973bda3df1a2eeee5690af63523d72dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQyMzowNTo0NVrOHjR-dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQyMzowNTo0NVrOHjR-dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc1NjcyNg==", "bodyText": "https://github.com/search?q=org%3Ajenkinsci+%22slave-agent.jnlp%22&type=code looks like we could get away with just renaming the existing file instead of duplicating it.\nIf we need to keep the old file for some reason, would just have that st:include the new one if possible to cut down duplication.", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r506756726", "createdAt": "2020-10-16T23:05:45Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -1874,7 +1874,7 @@ public static String toEmailSafeString(String projectName) {\n     /**\n      * Obtains the host name of the Hudson server that clients can use to talk back to.\n      * <p>\n-     * This is primarily used in {@code slave-agent.jnlp.jelly} to specify the destination\n+     * This is primarily used in {@code jenkins-agent.jnlp.jelly} to specify the destination", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd06a653973bda3df1a2eeee5690af63523d72dd"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70797bf48d67845fb388c0e045a67a63ed69d26e", "author": {"user": {"login": "jeffret-b", "name": "Jeff Thompson"}}, "url": "https://github.com/jenkinsci/jenkins/commit/70797bf48d67845fb388c0e045a67a63ed69d26e", "committedDate": "2020-10-16T23:17:13Z", "message": "Remove old file."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExODgwMjk0", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-511880294", "createdAt": "2020-10-19T15:20:19Z", "commit": {"oid": "70797bf48d67845fb388c0e045a67a63ed69d26e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMDA4MTY3", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-512008167", "createdAt": "2020-10-19T17:43:58Z", "commit": {"oid": "70797bf48d67845fb388c0e045a67a63ed69d26e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a", "author": {"user": {"login": "jeffret-b", "name": "Jeff Thompson"}}, "url": "https://github.com/jenkinsci/jenkins/commit/e0990b4b6c03210b344318015787d8cde645cb6a", "committedDate": "2020-10-19T20:47:36Z", "message": "Add tests for downloading JNLP file at new and obsoleted names."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNDI3NDI5", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-513427429", "createdAt": "2020-10-21T08:26:44Z", "commit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNTUwNjI4", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-513550628", "createdAt": "2020-10-21T10:55:46Z", "commit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2NzQ3MjQ2", "url": "https://github.com/jenkinsci/jenkins/pull/5010#pullrequestreview-516747246", "createdAt": "2020-10-26T12:56:32Z", "commit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMjo1NjozMlrOHoOOig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMjo1NjozN1rOHoOOwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkzODE4Ng==", "bodyText": "Unnecessary code duplication as @WebMethod takes a list of names.\nIf this is the future preferable API for this (even if unseen), should mark the old one @deprecated.\nAlso missing @since or @Restricted.", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r511938186", "createdAt": "2020-10-26T12:56:32Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/slaves/SlaveComputer.java", "diffHunk": "@@ -814,13 +814,23 @@ public void tryReconnect() {\n \n     @WebMethod(name=\"slave-agent.jnlp\")\n     public HttpResponse doSlaveAgentJnlp(StaplerRequest req, StaplerResponse res) {\n-        return new EncryptedSlaveAgentJnlpFile(this, \"slave-agent.jnlp.jelly\", getName(), CONNECT);\n+        return doJenkinsAgentJnlp(req, res);\n+    }\n+\n+    @WebMethod(name=\"jenkins-agent.jnlp\")\n+    public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTkzODI0Mg==", "bodyText": "As above.", "url": "https://github.com/jenkinsci/jenkins/pull/5010#discussion_r511938242", "createdAt": "2020-10-26T12:56:37Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/slaves/SlaveComputer.java", "diffHunk": "@@ -814,13 +814,23 @@ public void tryReconnect() {\n \n     @WebMethod(name=\"slave-agent.jnlp\")\n     public HttpResponse doSlaveAgentJnlp(StaplerRequest req, StaplerResponse res) {\n-        return new EncryptedSlaveAgentJnlpFile(this, \"slave-agent.jnlp.jelly\", getName(), CONNECT);\n+        return doJenkinsAgentJnlp(req, res);\n+    }\n+\n+    @WebMethod(name=\"jenkins-agent.jnlp\")\n+    public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {\n+        return new EncryptedSlaveAgentJnlpFile(this, \"jenkins-agent.jnlp.jelly\", getName(), CONNECT);\n     }\n \n     class LowPermissionResponse {\n+        @WebMethod(name=\"jenkins-agent.jnlp\")\n+        public HttpResponse doJenkinsAgentJnlp(StaplerRequest req, StaplerResponse res) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0990b4b6c03210b344318015787d8cde645cb6a"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2069, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}