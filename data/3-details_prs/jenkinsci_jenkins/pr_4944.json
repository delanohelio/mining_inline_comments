{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNDk1ODQy", "number": 4944, "title": "[JEP-228] Unforking XStream", "bodyText": "JEP-228\nProposed changelog entries\n\nJenkins now uses an updated version of the XStream serialization library without custom patches.\n\nProposed upgrade guidelines\nhttps://www.jenkins.io/blog/2020/11/10/spring-xstream/\nSee the compatibility table.\nDesired reviewers\n@jenkinsci/core\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-09-21T18:58:11Z", "url": "https://github.com/jenkinsci/jenkins/pull/4944", "merged": true, "mergeCommit": {"oid": "77f24bfb9adc2f154d8121694d456a0cc455a516"}, "closed": true, "closedAt": "2020-11-06T21:03:24Z", "author": {"login": "jglick"}, "timelineItems": {"totalCount": 42, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLIGmTgH2gAyNDkwNDk1ODQyOmQyN2E1MDEwYWExYWNlZWNmMmY1ZmRhNmY3OTVmZjU3M2Y0NGM0ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdz3Tf9gFqTU3NjExOTY5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d27a5010aa1aceecf2f5fda6f795ff573f44c482", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/d27a5010aa1aceecf2f5fda6f795ff573f44c482", "committedDate": "2020-09-21T18:56:51Z", "message": "Unforking XStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5edc8ffd690e95335f6a750a3f76493d78d1020", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f5edc8ffd690e95335f6a750a3f76493d78d1020", "committedDate": "2020-09-21T19:35:10Z", "message": "Some overrides missing from MapperDelegate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyOTMwNDQx", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-492930441", "createdAt": "2020-09-21T19:50:23Z", "commit": {"oid": "f5edc8ffd690e95335f6a750a3f76493d78d1020"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxOTo1MDoyM1rOHVgDmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxOTo1MDoyM1rOHVgDmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjMwNzM1NQ==", "bodyText": "This is a problem. DescribableList is not Serializable so removing transient will prevent this class from being serialized over Remoting. Yet keeping transient will prevent tool installations from saving their properties in XML. I have not found any way to get the effect of XStreamSerializable without patching PureJavaReflectionProvider.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r492307355", "createdAt": "2020-09-21T19:50:23Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/tools/ToolInstallation.java", "diffHunk": "@@ -82,8 +81,7 @@\n     /**\n      * {@link ToolProperty}s that are associated with this tool.\n      */\n-    @XStreamSerializable\n-    private transient /*almost final*/ DescribableList<ToolProperty<?>,ToolPropertyDescriptor> properties\n+    private /*almost final*/ DescribableList<ToolProperty<?>,ToolPropertyDescriptor> properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5edc8ffd690e95335f6a750a3f76493d78d1020"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e5aeec4ccc67207c0912ffe471fe5cf2815cf04", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/0e5aeec4ccc67207c0912ffe471fe5cf2815cf04", "committedDate": "2020-09-23T20:25:54Z", "message": "[XSTR-762] writeReplace & readResolve must be accessible to be used from subclasses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7609dbe728bcb293b80eb9862b95d5023c6f95e", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/e7609dbe728bcb293b80eb9862b95d5023c6f95e", "committedDate": "2020-09-23T20:52:48Z", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69eaa764709006c05099ae9f2fb7573f53572c88", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/69eaa764709006c05099ae9f2fb7573f53572c88", "committedDate": "2020-09-23T21:01:10Z", "message": "DomElement.click overloads changed incompatibly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4af60991e3cc2be81974e4ccd44a137812617fbb", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/4af60991e3cc2be81974e4ccd44a137812617fbb", "committedDate": "2020-09-23T21:23:15Z", "message": "Giving up on ToolInstallation being Serializable.\nFixing MavenInstallation accordingly.\nAntInstallation was already fixed: https://github.com/jenkinsci/ant-plugin/commit/c957dca4cd7789e3918e90ae020687aeaeea998e"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08771f796e77016927955aa7c6ab31081467a1d1", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/08771f796e77016927955aa7c6ab31081467a1d1", "committedDate": "2020-09-24T18:52:43Z", "message": "Relaxing message assertion in RobustReflectionConverter.randomExceptionsReported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "232a012f4dcbe3f6f0df81678e3fad3a3eb8800e", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/232a012f4dcbe3f6f0df81678e3fad3a3eb8800e", "committedDate": "2020-09-24T18:59:41Z", "message": "Picking up https://github.com/jenkinsci/matrix-auth-plugin/pull/89 caught via JobTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "861ca26e8ce02960c9589102d113d195d1bd70ce", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/861ca26e8ce02960c9589102d113d195d1bd70ce", "committedDate": "2020-09-24T19:46:29Z", "message": "https://github.com/jenkinsci/jenkins-test-harness/pull/243 released"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b89f6d1b32101225eb41ca96747d2dbeba753fe6", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/b89f6d1b32101225eb41ca96747d2dbeba753fe6", "committedDate": "2020-09-24T19:48:03Z", "message": "Another case forgotten in 0e5aeec4ccc67207c0912ffe471fe5cf2815cf04"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cec1e17943f6732e8187005af540267aeed733f", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/1cec1e17943f6732e8187005af540267aeed733f", "committedDate": "2020-09-25T17:48:12Z", "message": "XStream has SecurityMapper, but we have our own system already, so suppress warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ba7df4cf3a2ddbe63323248a4162c394cf2a57b", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/0ba7df4cf3a2ddbe63323248a4162c394cf2a57b", "committedDate": "2020-09-25T20:11:05Z", "message": "GetMavenVersion was also serializing its outer class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdc14144da8027d265676c94d34abda767f4d7cb", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/cdc14144da8027d265676c94d34abda767f4d7cb", "committedDate": "2020-09-25T21:24:24Z", "message": "Trying to make ToolInstallation serializable compatible"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3ODE5NjUy", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-497819652", "createdAt": "2020-09-28T19:09:59Z", "commit": {"oid": "cdc14144da8027d265676c94d34abda767f4d7cb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxOToxMDowMFrOHZL_rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxOToxMDowMFrOHZL_rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE3Mjk3Mw==", "bodyText": "Nice!", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r496172973", "createdAt": "2020-09-28T19:10:00Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/java/hudson/tools/ToolInstallation.java", "diffHunk": "@@ -210,13 +221,32 @@ protected String translateFor(Node node, TaskListener log) throws IOException, I\n      * Invoked by XStream when this object is read into memory.\n      */\n     protected Object readResolve() {\n-        if(properties==null)\n-            properties = new DescribableList<>(Saveable.NOOP);\n-        for (ToolProperty<?> p : properties)\n-            _setTool(p, this);\n+        if (properties != null) {\n+            for (ToolProperty<?> p : properties) {\n+                _setTool(p, this);\n+            }\n+        }\n         return this;\n     }\n \n+    protected Object writeReplace() throws Exception {\n+        if (Channel.current() == null) { // XStream", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdc14144da8027d265676c94d34abda767f4d7cb"}, "originalPosition": 77}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80ab2fede7e8a5d46bd1d1c0cd773afec61aa9ca", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/80ab2fede7e8a5d46bd1d1c0cd773afec61aa9ca", "committedDate": "2020-09-28T20:14:31Z", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b45ffbceb4f5cfa1dd91e1ff7ba7f57e8639b4da", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/b45ffbceb4f5cfa1dd91e1ff7ba7f57e8639b4da", "committedDate": "2020-09-28T20:35:20Z", "message": "Avoid throwing IOException from PersistedList.inModified for common cases covered by https://github.com/jenkinsci/jenkins-test-harness/pull/243"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef894943cca5ad3dd1229edefe053b44ffc4704c", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/ef894943cca5ad3dd1229edefe053b44ffc4704c", "committedDate": "2020-09-28T20:44:19Z", "message": "Found a way to avoid looking up XStream.converterRegistry by reflection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82dd8f819717e749070b2be80e7a92d8e00c1bb5", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/82dd8f819717e749070b2be80e7a92d8e00c1bb5", "committedDate": "2020-09-28T23:26:51Z", "message": "XStream2Test.crashXstream now throwing ConversionException, not ForbiddenClassException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2046d3658f92cb8994ab4c3696eb4021b4a8ece9", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/2046d3658f92cb8994ab4c3696eb4021b4a8ece9", "committedDate": "2020-09-29T02:02:56Z", "message": "Noting which version of the parent POM has https://github.com/jenkinsci/jenkins-test-harness/pull/243"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfe4d2a2b2b0c535d75f08eea296e9f36721866b", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/bfe4d2a2b2b0c535d75f08eea296e9f36721866b", "committedDate": "2020-09-29T13:08:01Z", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09d7dac3df77ba9409fc2f1b843aa06d511818db", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/09d7dac3df77ba9409fc2f1b843aa06d511818db", "committedDate": "2020-09-29T18:02:20Z", "message": "Refreshed Javadoc for XStream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82037c3f9dd2fa984c0d134c3c342d491a76ba19", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/82037c3f9dd2fa984c0d134c3c342d491a76ba19", "committedDate": "2020-09-29T18:16:51Z", "message": "The simplest solution to JENKINS-19561 seems to be to stop using autodetectAnnotations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b2b5f06a18a1cc0fabcf2a8802219614ba94302", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/5b2b5f06a18a1cc0fabcf2a8802219614ba94302", "committedDate": "2020-09-29T20:46:30Z", "message": "Fixing some deprecations in Robust*Converter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f7c40f93fcd1025a21405f2ef9edc6e20a9a816", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/5f7c40f93fcd1025a21405f2ef9edc6e20a9a816", "committedDate": "2020-09-30T21:12:56Z", "message": "Display OldDataMonitor errors from RobustReflectionConverter during functional tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53f997814e1c6840ce02c51381bd92de2b36f483", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/53f997814e1c6840ce02c51381bd92de2b36f483", "committedDate": "2020-10-01T18:50:53Z", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97146a76bba5a2945756274aa25afb55c0519ad0", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/97146a76bba5a2945756274aa25afb55c0519ad0", "committedDate": "2020-10-08T16:46:22Z", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1fc2f6d5c901c8c58102d63a136c839101b06c9", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f1fc2f6d5c901c8c58102d63a136c839101b06c9", "committedDate": "2020-10-08T18:36:47Z", "message": "Stray digit in test name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b0270106a946a32cca56d26b30f46fd69d24808", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/7b0270106a946a32cca56d26b30f46fd69d24808", "committedDate": "2020-10-08T19:07:53Z", "message": "Added XStream2AnnotationTest to clearly document incompatibility"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyNzIyODE2", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-512722816", "createdAt": "2020-10-20T13:40:07Z", "commit": {"oid": "7b0270106a946a32cca56d26b30f46fd69d24808"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMzo0MDowN1rOHk9Hjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxMzo0MDowN1rOHk9Hjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUxMjE0Mg==", "bodyText": "May need to be adjusted for XStream 1.5.x: x-stream/xstream#207", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r508512142", "createdAt": "2020-10-20T13:40:07Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/util/XStream2.java", "diffHunk": "@@ -257,8 +258,9 @@ private void init() {\n         registerConverter(new AssociatedConverterImpl(this), -10);\n \n         registerConverter(new BlacklistedTypesConverter(), PRIORITY_VERY_HIGH); // SECURITY-247 defense\n+        addPermission(AnyTypePermission.ANY); // covered by JEP-200, avoid securityWarningGiven", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b0270106a946a32cca56d26b30f46fd69d24808"}, "originalPosition": 66}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265", "committedDate": "2020-10-21T15:07:14Z", "message": "Merge branch 'master' of https://github.com/jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTM1MTg3", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-515135187", "createdAt": "2020-10-22T21:32:01Z", "commit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMTozMjowMlrOHm0oTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMTozOToxNVrOHm01rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MDIyMg==", "bodyText": "If merged, we should also archive both https://github.com/jenkinsci/xstream and https://github.com/jenkinsci/xstream-fork.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510470222", "createdAt": "2020-10-22T21:32:02Z", "author": {"login": "jglick"}, "path": "bom/pom.xml", "diffHunk": "@@ -326,9 +326,9 @@ THE SOFTWARE.\n \n       <!--XStream-->\n       <dependency>\n-        <groupId>org.jvnet.hudson</groupId>\n+        <groupId>com.thoughtworks.xstream</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MDQzOQ==", "bodyText": "Very handy for diagnosing test failures related to XStream!", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510470439", "createdAt": "2020-10-22T21:32:28Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/diagnosis/OldDataMonitor.java", "diffHunk": "@@ -207,6 +208,9 @@ public static void report(Saveable obj, Collection<Throwable> errors) {\n             if (e instanceof ReportException) {\n                 report(obj, ((ReportException)e).version);\n             } else {\n+                if (Main.isUnitTest) {\n+                    LOGGER.log(Level.INFO, \"Trouble loading \" + obj, e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MTMzMQ==", "bodyText": "Useful for PCT, until we can get most plugins moved onto new POMs.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510471331", "createdAt": "2020-10-22T21:34:13Z", "author": {"login": "jglick"}, "path": "core/src/main/java/hudson/util/PersistedList.java", "diffHunk": "@@ -170,7 +178,30 @@ public void clear() {\n      * Called when a list is mutated.\n      */\n     protected void onModified() throws IOException {\n-        owner.save();\n+        try {\n+            owner.save();\n+        } catch (IOException x) {\n+            Optional<T> ignored = stream().filter(PersistedList::ignoreSerializationErrors).findAny();\n+            if (ignored.isPresent()) {\n+                LOGGER.log(Level.WARNING, \"Ignoring serialization errors in \" + ignored.get() + \"; update your parent POM to 4.8 or newer\", x);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MjQ2MQ==", "bodyText": "Just demonstrating what would happen with plugins that used annotations without a processAnnotations call.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510472461", "createdAt": "2020-10-22T21:36:30Z", "author": {"login": "jglick"}, "path": "core/src/test/java/hudson/util/XStream2Test.java", "diffHunk": "@@ -530,9 +533,42 @@ public void setListDefaultNull(List<String> listDefaultNull) {\n     public void crashXstream() throws Exception {\n         try {\n             new XStream2().fromXML(\"<void/>\");\n-            fail(\"expected to throw ForbiddenClassException, but why are we still alive?\");\n-        } catch (ForbiddenClassException ex) {\n+            fail(\"expected to throw ConversionException, but why are we still alive?\");\n+        } catch (XStreamException ex) {\n             // pass\n         }\n     }\n+\n+    @Test\n+    public void annotations() throws Exception {\n+        assertEquals(\"not registered, so sorry\", \"<hudson.util.XStream2Test_-C1/>\", Jenkins.XSTREAM2.toXML(new C1()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MjY1MA==", "bodyText": "@daniel-beck please release me!", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510472650", "createdAt": "2020-10-22T21:36:52Z", "author": {"login": "jglick"}, "path": "pom.xml", "diffHunk": "@@ -90,7 +90,7 @@ THE SOFTWARE.\n     <project.patchManagement.url>https://api.github.com</project.patchManagement.url>\n     <patch.tracker.serverId>jenkins-jira</patch.tracker.serverId>\n \n-    <matrix-auth.version>2.6.2</matrix-auth.version>\n+    <matrix-auth.version>2.6.4-rc330.062fa8d38aa3</matrix-auth.version> <!-- TODO https://github.com/jenkinsci/matrix-auth-plugin/pull/89 -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MzM0NQ==", "bodyText": "Needed for JTH upgrade, unrelated to XStream.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510473345", "createdAt": "2020-10-22T21:38:33Z", "author": {"login": "jglick"}, "path": "test/src/test/java/hudson/model/ProjectTest.java", "diffHunk": "@@ -256,7 +256,7 @@ public void testGetScmCheckoutRetryCount() throws Exception{\n         HtmlForm form = j.createWebClient().goTo(p.getUrl() + \"/configure\").getFormByName(\"config\");\n         ((HtmlElement)form.getByXPath(\"//div[@class='advancedLink']//button\").get(0)).click();\n         // required due to the new default behavior of click\n-        form.getInputByName(\"hasCustomScmCheckoutRetryCount\").click(new Event(), true);\n+        form.getInputByName(\"hasCustomScmCheckoutRetryCount\").click(new Event(), false, false, false, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ3MzY0Nw==", "bodyText": "More realistic demonstration of compatibility impact for plugins of turning off autodetection.", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r510473647", "createdAt": "2020-10-22T21:39:15Z", "author": {"login": "jglick"}, "path": "test/src/test/java/hudson/util/XStream2AnnotationTest.java", "diffHunk": "@@ -0,0 +1,122 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package hudson.util;\n+\n+import com.thoughtworks.xstream.annotations.XStreamAlias;\n+import hudson.ExtensionList;\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import jenkins.model.GlobalConfiguration;\n+import org.apache.commons.io.FileUtils;\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.is;\n+import org.junit.Test;\n+import org.junit.Rule;\n+import org.jvnet.hudson.test.JenkinsSessionRule;\n+import org.jvnet.hudson.test.TestExtension;\n+\n+public class XStream2AnnotationTest {\n+\n+    @Rule\n+    public JenkinsSessionRule rr = new JenkinsSessionRule();\n+\n+    @Test\n+    public void xStreamAlias() throws Throwable {\n+        rr.then(r -> {\n+            AnnotatedProcessed annotatedProcessed = AnnotatedProcessed.get();\n+            annotatedProcessed.x = 1;\n+            annotatedProcessed.save();\n+            assertThat(annotatedProcessed.xml(), is(\"<myconf-annotated-processed><x>1</x></myconf-annotated-processed>\"));\n+            AnnotatedUnprocessed annotatedUnprocessed = AnnotatedUnprocessed.get();\n+            annotatedUnprocessed.x = 2;\n+            annotatedUnprocessed.save();\n+            assertThat(annotatedUnprocessed.xml(), is(\"<hudson.util.XStream2AnnotationTest_-AnnotatedUnprocessed><x>2</x></hudson.util.XStream2AnnotationTest_-AnnotatedUnprocessed>\"));\n+            Programmatic programmatic = Programmatic.get();\n+            programmatic.x = 3;\n+            programmatic.save();\n+            assertThat(programmatic.xml(), is(\"<myconf-programmatic><x>3</x></myconf-programmatic>\"));\n+        });\n+        rr.then(r -> {\n+            assertThat(AnnotatedProcessed.get().x, is(1));\n+            assertThat(AnnotatedUnprocessed.get().x, is(2));\n+            assertThat(Programmatic.get().x, is(3));\n+            // Typical content saved by Jenkins session when annotation autodetection was still enabled:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "originalPosition": 65}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTQ0MDkw", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-515144090", "createdAt": "2020-10-22T21:47:33Z", "commit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NDI3NjA4", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-515427608", "createdAt": "2020-10-23T07:56:05Z", "commit": {"oid": "e2a10f190f6ce6f9ece9a2c80dc0f8c94977d265"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af44d41866631e25ccaebb69e8afc9b1cb47c679", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/af44d41866631e25ccaebb69e8afc9b1cb47c679", "committedDate": "2020-10-26T12:41:20Z", "message": "Merge branch 'master' of https://github.com/jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MTIwNzQ5", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-517120749", "createdAt": "2020-10-26T19:47:00Z", "commit": {"oid": "af44d41866631e25ccaebb69e8afc9b1cb47c679"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwOTU3ODcz", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-520957873", "createdAt": "2020-10-30T19:07:03Z", "commit": {"oid": "af44d41866631e25ccaebb69e8afc9b1cb47c679"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTIxMDI4", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-522921028", "createdAt": "2020-11-03T22:29:27Z", "commit": {"oid": "af44d41866631e25ccaebb69e8afc9b1cb47c679"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMjoyOToyOFrOHtCwTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMjoyOToyOFrOHtCwTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5MzEwMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <matrix-auth.version>2.6.4-rc330.062fa8d38aa3</matrix-auth.version> <!-- TODO https://github.com/jenkinsci/matrix-auth-plugin/pull/89 -->\n          \n          \n            \n                <matrix-auth.version>2.6.4</matrix-auth.version>", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r516993101", "createdAt": "2020-11-03T22:29:28Z", "author": {"login": "basil"}, "path": "pom.xml", "diffHunk": "@@ -90,7 +90,7 @@ THE SOFTWARE.\n     <project.patchManagement.url>https://api.github.com</project.patchManagement.url>\n     <patch.tracker.serverId>jenkins-jira</patch.tracker.serverId>\n \n-    <matrix-auth.version>2.6.2</matrix-auth.version>\n+    <matrix-auth.version>2.6.4-rc330.062fa8d38aa3</matrix-auth.version> <!-- TODO https://github.com/jenkinsci/matrix-auth-plugin/pull/89 -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af44d41866631e25ccaebb69e8afc9b1cb47c679"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e0fa6f5eb52431b9541315429e5b7a345ad84c", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/91e0fa6f5eb52431b9541315429e5b7a345ad84c", "committedDate": "2020-11-03T23:07:53Z", "message": "Picking up release of https://github.com/jenkinsci/matrix-auth-plugin/pull/89\n\nCo-authored-by: Basil Crow <me@basilcrow.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e748d9607170eb8bac7721c7a361256206a15ba", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/7e748d9607170eb8bac7721c7a361256206a15ba", "committedDate": "2020-11-03T23:08:17Z", "message": "Merge branch 'master' of https://github.com/jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44a9b59b645b7c051ea35e80db530fa31ffb1638", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/44a9b59b645b7c051ea35e80db530fa31ffb1638", "committedDate": "2020-11-06T18:35:15Z", "message": "Merge branch 'master' of https://github.com/jenkinsci/jenkins into xstream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc2MTE5Njkw", "url": "https://github.com/jenkinsci/jenkins/pull/4944#pullrequestreview-576119690", "createdAt": "2021-01-26T08:33:26Z", "commit": {"oid": "44a9b59b645b7c051ea35e80db530fa31ffb1638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yNlQwODozMzoyNlrOIaL9Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yNlQwODozMzoyNlrOIaL9Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDMyOTczMA==", "bodyText": "Does this imply that all plugins must make the same change?", "url": "https://github.com/jenkinsci/jenkins/pull/4944#discussion_r564329730", "createdAt": "2021-01-26T08:33:26Z", "author": {"login": "rsandell"}, "path": "core/src/main/java/hudson/model/ListView.java", "diffHunk": "@@ -132,7 +132,7 @@ public void setJobFilters(List<ViewJobFilter> jobFilters) throws IOException {\n         this.jobFilters.replaceBy(jobFilters);\n     }\n \n-    private Object readResolve() {\n+    protected Object readResolve() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44a9b59b645b7c051ea35e80db530fa31ffb1638"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1970, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}