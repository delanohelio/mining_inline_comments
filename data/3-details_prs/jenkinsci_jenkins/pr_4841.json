{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NTA1NTEz", "number": 4841, "title": "[JENKINS-61806] Form validation for TimeZoneProperty.timeZoneName", "bodyText": "#4748 (comment) seemed to have a positive reception.\n\nProposed changelog entries\n\nWhen configuring your User Defined Time Zone, you will now see hints about the current time on the server\u2019s zone and, if not selecting Default, in the selected zone.\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-07-10T15:31:37Z", "url": "https://github.com/jenkinsci/jenkins/pull/4841", "merged": true, "mergeCommit": {"oid": "ef325a615e43d7f6526530960cd562e67571d1a8"}, "closed": true, "closedAt": "2020-07-14T07:00:56Z", "author": {"login": "jglick"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczlXYpgH2gAyNDQ3NTA1NTEzOjZkNjEyOWQ2OTg0ZWE4ZjZmOTBhNWVjZjAzN2Y3YTc5MTAyMTM2NjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0SNr3gFqTQ0NjkwNDY5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/jenkins/commit/6d6129d6984ea8f6f90a5ecf037f7a7910213665", "committedDate": "2020-07-10T15:28:15Z", "message": "[JENKINS-61806] Form validation for TimeZoneProperty.timeZoneName"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDk3NjUz", "url": "https://github.com/jenkinsci/jenkins/pull/4841#pullrequestreview-446497653", "createdAt": "2020-07-10T15:31:57Z", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNTozMTo1OFrOGv74Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNTozMTo1OFrOGv74Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjkxNzM0Ng==", "bodyText": "Was not displayed anywhere that I could see, so moving to inline help.", "url": "https://github.com/jenkinsci/jenkins/pull/4841#discussion_r452917346", "createdAt": "2020-07-10T15:31:58Z", "author": {"login": "jglick"}, "path": "core/src/main/resources/hudson/model/TimeZoneProperty/config.properties", "diffHunk": "@@ -18,4 +18,3 @@\n # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n # THE SOFTWARE.\n title=Time Zone\n-description=Specify user defined time zone for displaying time rather than system default.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2Nzk1NjYz", "url": "https://github.com/jenkinsci/jenkins/pull/4841#pullrequestreview-446795663", "createdAt": "2020-07-11T11:00:37Z", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxMTowMDozN1rOGwMI4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxMTowMDozN1rOGwMI4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE4MzcxMg==", "bodyText": "what's di referring to here? 'proposed_di'", "url": "https://github.com/jenkinsci/jenkins/pull/4841#discussion_r453183712", "createdAt": "2020-07-11T11:00:37Z", "author": {"login": "timja"}, "path": "core/src/main/resources/hudson/model/Messages.properties", "diffHunk": "@@ -403,6 +403,8 @@ User.IllegalFullname=\"{0}\" is prohibited as a full name for security reasons.\n \n TimeZoneProperty.DisplayName=User Defined Time Zone \n TimeZoneProperty.DisplayDefaultTimeZone=Default\n+TimeZoneProperty.current_time_in_=Current time in {0}: {1}\n+TimeZoneProperty.current_time_on_server_in_in_proposed_di=Current time on server in {0}: {1}; in proposed display zone: {2}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2Nzk1OTMz", "url": "https://github.com/jenkinsci/jenkins/pull/4841#pullrequestreview-446795933", "createdAt": "2020-07-11T11:07:52Z", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODA4MjE2", "url": "https://github.com/jenkinsci/jenkins/pull/4841#pullrequestreview-446808216", "createdAt": "2020-07-11T15:02:52Z", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxNTowMjo1MlrOGwNVWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxNTowMjo1MlrOGwNVWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIwMzI4OA==", "bodyText": "It says in here twice, as well as in the code", "url": "https://github.com/jenkinsci/jenkins/pull/4841#discussion_r453203288", "createdAt": "2020-07-11T15:02:52Z", "author": {"login": "res0nance"}, "path": "core/src/main/resources/hudson/model/Messages.properties", "diffHunk": "@@ -403,6 +403,8 @@ User.IllegalFullname=\"{0}\" is prohibited as a full name for security reasons.\n \n TimeZoneProperty.DisplayName=User Defined Time Zone \n TimeZoneProperty.DisplayDefaultTimeZone=Default\n+TimeZoneProperty.current_time_in_=Current time in {0}: {1}\n+TimeZoneProperty.current_time_on_server_in_in_proposed_di=Current time on server in {0}: {1}; in proposed display zone: {2}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE4MzcxMg=="}, "originalCommit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2OTA0Njk5", "url": "https://github.com/jenkinsci/jenkins/pull/4841#pullrequestreview-446904699", "createdAt": "2020-07-12T19:42:36Z", "commit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQxOTo0MjozNlrOGwWn3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQxOTo0Mjo1MFrOGwWn7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM1NTQ4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            TimeZoneProperty.current_time_on_server_in_in_proposed_di=Current time on server in {0}: {1}; in proposed display zone: {2}\n          \n          \n            \n            TimeZoneProperty.current_time_on_server_in_proposed_di=Current time on server in {0}: {1}; in proposed display zone: {2}", "url": "https://github.com/jenkinsci/jenkins/pull/4841#discussion_r453355484", "createdAt": "2020-07-12T19:42:36Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/resources/hudson/model/Messages.properties", "diffHunk": "@@ -403,6 +403,8 @@ User.IllegalFullname=\"{0}\" is prohibited as a full name for security reasons.\n \n TimeZoneProperty.DisplayName=User Defined Time Zone \n TimeZoneProperty.DisplayDefaultTimeZone=Default\n+TimeZoneProperty.current_time_in_=Current time in {0}: {1}\n+TimeZoneProperty.current_time_on_server_in_in_proposed_di=Current time on server in {0}: {1}; in proposed display zone: {2}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM1NTUwMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            return FormValidation.ok(Messages.TimeZoneProperty_current_time_on_server_in_in_proposed_di(TimeZone.getDefault().getDisplayName(), DateFormat.getDateTimeInstance().format(now), localTime.format(now)));\n          \n          \n            \n                            return FormValidation.ok(Messages.TimeZoneProperty_current_time_on_server_in_proposed_di(TimeZone.getDefault().getDisplayName(), DateFormat.getDateTimeInstance().format(now), localTime.format(now)));", "url": "https://github.com/jenkinsci/jenkins/pull/4841#discussion_r453355502", "createdAt": "2020-07-12T19:42:50Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/hudson/model/TimeZoneProperty.java", "diffHunk": "@@ -85,6 +90,18 @@ public ListBoxModel doFillTimeZoneNameItems() {\n             }\n             return items;\n         }\n+\n+        public FormValidation doCheckTimeZoneName(@QueryParameter String timeZoneName) {\n+            Date now = new Date();\n+            if (Util.fixEmpty(timeZoneName) == null) {\n+                return FormValidation.ok(Messages.TimeZoneProperty_current_time_in_(TimeZone.getDefault().getDisplayName(), DateFormat.getDateTimeInstance().format(now)));\n+            } else {\n+                DateFormat localTime = DateFormat.getDateTimeInstance();\n+                localTime.setTimeZone(TimeZone.getTimeZone(timeZoneName));\n+                return FormValidation.ok(Messages.TimeZoneProperty_current_time_on_server_in_in_proposed_di(TimeZone.getDefault().getDisplayName(), DateFormat.getDateTimeInstance().format(now), localTime.format(now)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d6129d6984ea8f6f90a5ecf037f7a7910213665"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2124, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}