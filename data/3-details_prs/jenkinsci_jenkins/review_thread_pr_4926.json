{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NjY2Njc4", "number": 4926, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTo0MjozMlrOEisz1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTo0MjozMlrOEisz1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODIxMjA3OnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/hudson/model/AllView/noJob.groovy", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTo0MjozMlrOHQuqPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwOToyNDozOVrOHQz6wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwMzc0Mw==", "bodyText": "Hmm this doesn't seem right,\n\nit's just linking to new computer, not the cloud configuration screen.\nit's showing up when I don't have a cloud plugin installed\n\nAlthough 2 probably isn't too bad as there's docs on the configure Clouds page saying what to do:\n\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                a(href: \"computer/new\", class: \"content-block__link\") {\n          \n          \n            \n                                                a(href: \"configureClouds\", class: \"content-block__link\") {", "url": "https://github.com/jenkinsci/jenkins/pull/4926#discussion_r487303743", "createdAt": "2020-09-11T21:42:32Z", "author": {"login": "timja"}, "path": "core/src/main/resources/hudson/model/AllView/noJob.groovy", "diffHunk": "@@ -4,40 +4,142 @@ import hudson.model.Computer\n import hudson.model.Item\n import jenkins.model.Jenkins\n \n+def l = namespace(lib.LayoutTagLib)\n+\n+def isTopLevelAllView = my.owner == Jenkins.get();\n+def canSetUpDistributedBuilds = Jenkins.get().hasPermission(Computer.CREATE) &&\n+        Jenkins.get().clouds.isEmpty() &&\n+        Jenkins.get().getNodes().isEmpty();\n+def hasAdministerJenkinsPermission = Jenkins.get().hasPermission(Jenkins.ADMINISTER);\n+def hasItemCreatePermission = my.owner.hasPermission(Item.CREATE);\n+\n div {\n-    h1(_(\"Welcome to Jenkins!\"))\n-\n-    if (my.owner == Jenkins.get()) {\n-        // we're a top-level 'All' view\n-        if (Jenkins.get().hasPermission(Computer.CREATE) && Jenkins.get().clouds.isEmpty() && Jenkins.get().getNodes().isEmpty()) {\n-            div(class: 'call-to-action') {\n-                if (Jenkins.get().hasPermission(Jenkins.ADMINISTER)) {\n-                    raw(_(\"distributedBuildsWithCloud\"))\n-                } else {\n-                    raw(_(\"distributedBuilds\"))\n+\n+    div(class: \"empty-state-block\") {\n+        if (isTopLevelAllView) {\n+            if (canSetUpDistributedBuilds || hasItemCreatePermission) {\n+                h1(_(\"Welcome to Jenkins!\"))\n+\n+                p(_(\"noJobDescription\"))\n+\n+                if (canSetUpDistributedBuilds) {\n+                    section(class: \"empty-state-section\") {\n+                        h2(_(\"setUpDistributedBuilds\"), class: \"h4\")\n+                        ul(class: \"empty-state-section-list\") {\n+                            li(class: \"content-block\") {\n+                                a(href: \"computer/new\", class: \"content-block__link\") {\n+                                    span(_(\"setUpAgent\"))\n+                                    span(class: \"trailing-icon\") {\n+                                        l.svgIcon(\n+                                                class: \"icon-sm\",\n+                                                href: \"${resURL}/images/material-icons/svg-sprite-navigation-symbol.svg#ic_arrow_forward_24px\")\n+                                    }\n+                                }\n+                            }\n+\n+                            if (hasAdministerJenkinsPermission) {\n+                                li(class: \"content-block\") {\n+                                    a(href: \"computer/new\", class: \"content-block__link\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM4OTg4OA==", "bodyText": "Maybe I messed something up", "url": "https://github.com/jenkinsci/jenkins/pull/4926#discussion_r487389888", "createdAt": "2020-09-12T09:24:39Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/hudson/model/AllView/noJob.groovy", "diffHunk": "@@ -4,40 +4,142 @@ import hudson.model.Computer\n import hudson.model.Item\n import jenkins.model.Jenkins\n \n+def l = namespace(lib.LayoutTagLib)\n+\n+def isTopLevelAllView = my.owner == Jenkins.get();\n+def canSetUpDistributedBuilds = Jenkins.get().hasPermission(Computer.CREATE) &&\n+        Jenkins.get().clouds.isEmpty() &&\n+        Jenkins.get().getNodes().isEmpty();\n+def hasAdministerJenkinsPermission = Jenkins.get().hasPermission(Jenkins.ADMINISTER);\n+def hasItemCreatePermission = my.owner.hasPermission(Item.CREATE);\n+\n div {\n-    h1(_(\"Welcome to Jenkins!\"))\n-\n-    if (my.owner == Jenkins.get()) {\n-        // we're a top-level 'All' view\n-        if (Jenkins.get().hasPermission(Computer.CREATE) && Jenkins.get().clouds.isEmpty() && Jenkins.get().getNodes().isEmpty()) {\n-            div(class: 'call-to-action') {\n-                if (Jenkins.get().hasPermission(Jenkins.ADMINISTER)) {\n-                    raw(_(\"distributedBuildsWithCloud\"))\n-                } else {\n-                    raw(_(\"distributedBuilds\"))\n+\n+    div(class: \"empty-state-block\") {\n+        if (isTopLevelAllView) {\n+            if (canSetUpDistributedBuilds || hasItemCreatePermission) {\n+                h1(_(\"Welcome to Jenkins!\"))\n+\n+                p(_(\"noJobDescription\"))\n+\n+                if (canSetUpDistributedBuilds) {\n+                    section(class: \"empty-state-section\") {\n+                        h2(_(\"setUpDistributedBuilds\"), class: \"h4\")\n+                        ul(class: \"empty-state-section-list\") {\n+                            li(class: \"content-block\") {\n+                                a(href: \"computer/new\", class: \"content-block__link\") {\n+                                    span(_(\"setUpAgent\"))\n+                                    span(class: \"trailing-icon\") {\n+                                        l.svgIcon(\n+                                                class: \"icon-sm\",\n+                                                href: \"${resURL}/images/material-icons/svg-sprite-navigation-symbol.svg#ic_arrow_forward_24px\")\n+                                    }\n+                                }\n+                            }\n+\n+                            if (hasAdministerJenkinsPermission) {\n+                                li(class: \"content-block\") {\n+                                    a(href: \"computer/new\", class: \"content-block__link\") {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwMzc0Mw=="}, "originalCommit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 170, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}