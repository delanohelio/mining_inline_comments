{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4NDc3MjYy", "number": 4580, "title": "Pre-filter the 'Available' plugin manager tab, allow multiple terms", "bodyText": "There are three similar looking tabs in the plugin manager:\n\nUpdates shows updates for installed plugins.\nAvailable shows available plugins (plugins not currently installed).\nInstalled shows currently installed plugins.\n\nThe first and third have a fairly limited number of list entries (typically at most dozens and very low hundreds, respectively), all of which are relevant to administrators in different ways (updates and installed), while the second has a very large number of list entries (almost more than 1000) with a very low average/median relevance to users.\nThis PR implements a change that hides all elements on the \"Available\" tab by default, and users are reminded to use the \"Search\" field to make plugins appear. Search expressions need to be two characters minimum (to support searching for \"JS\" \u2013 sorry R!).\nImplementation is fairly hacky, since we're doing all the searching/filtering client-side, we just now hide all rows in the form by default (they're still loaded, but at least not rendered!). Didn't want to bother with a full rewrite here, I lack the mad design skillz to pull off an actually good plugin manager anyway!\nScreenshots\nUpdates tab - unfiltered (largely unchanged)\n\nUpdates tab - slightly filtered, still supports 1 char filters (largely unchanged)\n\nAvailable tab - unfiltered and empty except for a reminder to use the search field\n\nAvailable tab - unfiltered with 1 character in search field\n\nAvailable tab - filtered with 2 characters in search field\n\nAvailable tab - we now support multiple individual search terms\n\nSearch vs. Filter\nI left the \"Filter\" term on the UI for Updates and Installed, because there's a list that we filter.\n\"Search\" is the new term for \"Available\" only, since we're starting out with nothing.\nProposed changelog entries\n\nMinor RFE: Don't show all available plugins by default; use search field to find plugins\nMinor RFE: Allow use of multiple space-separated filter terms in plugin manager\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n JIRA issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n[n/a] For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a JIRA issue should exist and be labeled as lts-candidate", "createdAt": "2020-03-14T23:16:06Z", "url": "https://github.com/jenkinsci/jenkins/pull/4580", "merged": true, "mergeCommit": {"oid": "e97fe13fbdfd0f1a311862adafb36c10e621e536"}, "closed": true, "closedAt": "2020-04-11T10:43:42Z", "author": {"login": "daniel-beck"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNtFozgH2gAyMzg4NDc3MjYyOmI5ZTRkNGMwYTgwZWRlNjY3ZjM4N2Q0M2RjNzFlNGQ4YjAwNGUwYTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWM8vGgH2gAyMzg4NDc3MjYyOmRkMGM4ZDA4ZGRiYjA2YmQ2MTA4NWM4ZDU0NDhjMzhlOTRmMjhlMTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "committedDate": "2020-03-14T22:58:59Z", "message": "Pre-filter the 'Available' plugin manager tab, allow multiple terms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzYwMTA5", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-374760109", "createdAt": "2020-03-14T23:17:07Z", "commit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQyMzoxNzowN1rOF2cDHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQyMzoxNzowN1rOF2cDHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYyNjk3NA==", "bodyText": "encountered and TR.plugin-category have been obsolete since #4534.", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392626974", "createdAt": "2020-03-14T23:17:07Z", "author": {"login": "daniel-beck"}, "path": "core/src/main/resources/hudson/PluginManager/_table.js", "diffHunk": "@@ -9,30 +9,42 @@ function checkPluginsWithoutWarnings() {\n }\n \n Behaviour.specify(\"#filter-box\", '_table', 0, function(e) {\n-      function applyFilter() {\n-          var filter = e.value.toLowerCase();\n-          [\"TR.plugin\",\"TR.plugin-category\"].each(function(clz) {\n-            var encountered = {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0Nzg3NTQ4", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-374787548", "createdAt": "2020-03-15T10:34:34Z", "commit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxMDozNDozNFrOF2eHAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxMDozNDozNFrOF2eHAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ==", "bodyText": "The search input doesn't seem to fit with the rest of the page to me, did its size need to be increased?", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392660739", "createdAt": "2020-03-15T10:34:34Z", "author": {"login": "timja"}, "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -10,7 +11,8 @@ time {\n \n #filter-container {\n     margin: 1em;\n-    text-align: right;\n+    text-align: center;\n+    font-size: 2em;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42cfea9cd56c6da00ae528b53953d49120f04b25", "author": {"user": {"login": "timja", "name": "Tim Jacomb"}}, "url": "https://github.com/jenkinsci/jenkins/commit/42cfea9cd56c6da00ae528b53953d49120f04b25", "committedDate": "2020-03-15T11:56:39Z", "message": "Re-work search / filter input"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1ODQ4MjQz", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-375848243", "createdAt": "2020-03-17T09:05:19Z", "commit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTowNToxOVrOF3TQDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToxMToyM1rOF3TdFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMTQwNw==", "bodyText": "I'd just go with Tim's design, it's more consistent with the header one. We could also extract it into a searchbox widget in the future.", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393531407", "createdAt": "2020-03-17T09:05:19Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -10,7 +11,8 @@ time {\n \n #filter-container {\n     margin: 1em;\n-    text-align: right;\n+    text-align: center;\n+    font-size: 2em;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ=="}, "originalCommit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMjUyNw==", "bodyText": "I think this is a case for using the font-size in rems. ems should only be used when the element size depends on where they are (such as hyperlinks or inline monospaced elements)\nRecommended font sizes are located on the font.less file", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393532527", "createdAt": "2020-03-17T09:07:07Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -2,6 +2,7 @@\n     background: white url('search.gif') no-repeat 2px center;\n     padding-left: 20px;\n     width: 15em;\n+    font-size: 1em;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNDc0Mg==", "bodyText": "getElementsBySelector is a prototype.js function, and should be avoided. The alternatives are using querySelectorAll (https://caniuse.com/#search=querySelectorAll). If the browser support is not good enough (especially due to Baidu-browser support, then I suggest using getElementsByClassName('plugin') and filter out the elements that are not <tr> within the function.", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393534742", "createdAt": "2020-03-17T09:11:23Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/hudson/PluginManager/_table.js", "diffHunk": "@@ -9,30 +9,42 @@ function checkPluginsWithoutWarnings() {\n }\n \n Behaviour.specify(\"#filter-box\", '_table', 0, function(e) {\n-      function applyFilter() {\n-          var filter = e.value.toLowerCase();\n-          [\"TR.plugin\",\"TR.plugin-category\"].each(function(clz) {\n-            var encountered = {};\n-            var items = document.getElementsBySelector(clz);\n-            for (var i=0; i<items.length; i++) {\n-                var visible = (filter==\"\" || items[i].innerHTML.toLowerCase().indexOf(filter)>=0);\n-                var name = items[i].cells && items[i].cells.length > 1\n-                        ? items[i].cells[1].getAttribute('data-id')\n-                        : items[i].getAttribute(\"name\");\n-                if (visible && name != null) {\n-                    if (encountered[name]) {\n-                        visible = false;\n-                    }\n-                    encountered[name] = true;\n+    function applyFilter() {\n+        var filter = e.value.toLowerCase().trim();\n+        var filterParts = filter.split(/ +/).filter (word => word.length > 0);\n+        var items = document.getElementsBySelector(\"TR.plugin\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NjAyNjEx", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-377602611", "createdAt": "2020-03-19T10:42:13Z", "commit": {"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03d2937d0cfa874a2afcab1431c26489fa178766", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/03d2937d0cfa874a2afcab1431c26489fa178766", "committedDate": "2020-03-28T01:55:02Z", "message": "Focus the filter/search field once the page is loaded."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "142a78653f711aa42446c1f534da2ee9f268935e", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/142a78653f711aa42446c1f534da2ee9f268935e", "committedDate": "2020-04-01T00:10:42Z", "message": "Look at innerHTML as before, rather than textContent\n\nWill cause lots of 'false positives' for some search terms, but\ncan always be cleaned up later through more fine-grained control\nwhat can be searched (e.g. textContent + artifactId)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzA1MzYw", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-385305360", "createdAt": "2020-04-01T06:49:00Z", "commit": {"oid": "142a78653f711aa42446c1f534da2ee9f268935e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzYyMTg5", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-385362189", "createdAt": "2020-04-01T08:21:01Z", "commit": {"oid": "142a78653f711aa42446c1f534da2ee9f268935e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4ODY0MTMy", "url": "https://github.com/jenkinsci/jenkins/pull/4580#pullrequestreview-388864132", "createdAt": "2020-04-07T07:46:47Z", "commit": {"oid": "142a78653f711aa42446c1f534da2ee9f268935e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a73f86c1afb563717f5d4bdb12061f5ff8acbf2b", "author": {"user": {"login": "oleg-nenashev", "name": "Oleg Nenashev"}}, "url": "https://github.com/jenkinsci/jenkins/commit/a73f86c1afb563717f5d4bdb12061f5ff8acbf2b", "committedDate": "2020-04-10T07:43:50Z", "message": "Merge branch 'master' into prefiltered-available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "104e7451ed60e400825257950312eddc5074b07a", "author": {"user": {"login": "oleg-nenashev", "name": "Oleg Nenashev"}}, "url": "https://github.com/jenkinsci/jenkins/commit/104e7451ed60e400825257950312eddc5074b07a", "committedDate": "2020-04-10T08:00:36Z", "message": "Update table.jelly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd0c8d08ddbb06bd61085c8d5448c38e94f28e12", "author": {"user": {"login": "timja", "name": "Tim Jacomb"}}, "url": "https://github.com/jenkinsci/jenkins/commit/dd0c8d08ddbb06bd61085c8d5448c38e94f28e12", "committedDate": "2020-04-10T08:37:37Z", "message": "Fix quoting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1316, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}