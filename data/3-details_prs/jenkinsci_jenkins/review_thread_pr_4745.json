{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzMjA1OTQ2", "number": 4745, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzozNTo1NVrOD_rSpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNDowNDoyNVrOD_sE2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MDk2MTY2OnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/lib/form/textarea/textarea.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzozNTo1NVrOGaej1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzozNTo1NVrOGaej1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQxNjg1NQ==", "bodyText": "This seems like a really brittle way to get the node to me. Isn't there any other way, maybe using a class or an ID?", "url": "https://github.com/jenkinsci/jenkins/pull/4745#discussion_r430416855", "createdAt": "2020-05-26T13:35:55Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/lib/form/textarea/textarea.js", "diffHunk": "@@ -48,7 +48,14 @@ Behaviour.specify(\"DIV.textarea-preview-container\", 'textarea', 100, function (e\n         showPreview.onclick = function() {\n             // Several TEXTAREAs may exist if CodeMirror is enabled. The first one has reference to the CodeMirror object.\n             var textarea = e.parentNode.getElementsByTagName(\"TEXTAREA\")[0];\n-            var text = textarea.codemirrorObject ? textarea.codemirrorObject.getValue() : textarea.value;\n+            var text = \"\";\n+            //Textarea object will be null if the text area is disabled.\n+            if (textarea == null) {\n+                textarea = e.parentNode.getElementsByTagName(\"pre\")[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7595df0a21e124cc3eaf2880efd7915f5a82265f"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MTA5MDE4OnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/lib/form/textarea/textarea.js", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNDowNDoyNVrOGaf1Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNDoxMzozMVrOGagQLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQzNzY0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            textarea = e.parentNode.getElementsByTagName(\"pre\")[0];\n          \n          \n            \n                            textarea = e.parentNode.getElementsByClassName(\"jenkins-readonly\")[0];\n          \n      \n    \n    \n  \n\nI can do this. Because of l:possibleReadOnlyField I don't have too much to go on", "url": "https://github.com/jenkinsci/jenkins/pull/4745#discussion_r430437647", "createdAt": "2020-05-26T14:04:25Z", "author": {"login": "res0nance"}, "path": "core/src/main/resources/lib/form/textarea/textarea.js", "diffHunk": "@@ -48,7 +48,14 @@ Behaviour.specify(\"DIV.textarea-preview-container\", 'textarea', 100, function (e\n         showPreview.onclick = function() {\n             // Several TEXTAREAs may exist if CodeMirror is enabled. The first one has reference to the CodeMirror object.\n             var textarea = e.parentNode.getElementsByTagName(\"TEXTAREA\")[0];\n-            var text = textarea.codemirrorObject ? textarea.codemirrorObject.getValue() : textarea.value;\n+            var text = \"\";\n+            //Textarea object will be null if the text area is disabled.\n+            if (textarea == null) {\n+                textarea = e.parentNode.getElementsByTagName(\"pre\")[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7595df0a21e124cc3eaf2880efd7915f5a82265f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ0MTAxOA==", "bodyText": "This is much better IMO and more robust. I suggest adding a check to verify that textarea is not undefined", "url": "https://github.com/jenkinsci/jenkins/pull/4745#discussion_r430441018", "createdAt": "2020-05-26T14:08:51Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/resources/lib/form/textarea/textarea.js", "diffHunk": "@@ -48,7 +48,14 @@ Behaviour.specify(\"DIV.textarea-preview-container\", 'textarea', 100, function (e\n         showPreview.onclick = function() {\n             // Several TEXTAREAs may exist if CodeMirror is enabled. The first one has reference to the CodeMirror object.\n             var textarea = e.parentNode.getElementsByTagName(\"TEXTAREA\")[0];\n-            var text = textarea.codemirrorObject ? textarea.codemirrorObject.getValue() : textarea.value;\n+            var text = \"\";\n+            //Textarea object will be null if the text area is disabled.\n+            if (textarea == null) {\n+                textarea = e.parentNode.getElementsByTagName(\"pre\")[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQzNzY0Nw=="}, "originalCommit": {"oid": "7595df0a21e124cc3eaf2880efd7915f5a82265f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ0NDU5MQ==", "bodyText": "Addressed in 4467b36", "url": "https://github.com/jenkinsci/jenkins/pull/4745#discussion_r430444591", "createdAt": "2020-05-26T14:13:31Z", "author": {"login": "res0nance"}, "path": "core/src/main/resources/lib/form/textarea/textarea.js", "diffHunk": "@@ -48,7 +48,14 @@ Behaviour.specify(\"DIV.textarea-preview-container\", 'textarea', 100, function (e\n         showPreview.onclick = function() {\n             // Several TEXTAREAs may exist if CodeMirror is enabled. The first one has reference to the CodeMirror object.\n             var textarea = e.parentNode.getElementsByTagName(\"TEXTAREA\")[0];\n-            var text = textarea.codemirrorObject ? textarea.codemirrorObject.getValue() : textarea.value;\n+            var text = \"\";\n+            //Textarea object will be null if the text area is disabled.\n+            if (textarea == null) {\n+                textarea = e.parentNode.getElementsByTagName(\"pre\")[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQzNzY0Nw=="}, "originalCommit": {"oid": "7595df0a21e124cc3eaf2880efd7915f5a82265f"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 394, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}