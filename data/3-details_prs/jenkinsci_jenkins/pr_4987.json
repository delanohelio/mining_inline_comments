{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTYyNDk5", "number": 4987, "title": "Reduce the prototype.js usage", "bodyText": "Only cover the Element.xxxClassName in hudson-behavior. The related methods can be easily replaced by vanilla JavaScript.\nFor compatibility: https://caniuse.com/classlist (add, remove and contains with single argument is supported by all supported browsers)\nManually tested the build history with more than 25 items to have the \"pagination\" working.\n\nSee JENKINS-XXXXX. No ticket, too small adjustment + no need backport.\n\nProposed changelog entries\n\n(internal) Replace the Element.xxxClassName methods by vanilla JavaScript.\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n[n/a] (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n[n/a] Appropriate autotests or explanation to why this change has no tests\n[n/a] For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\ncc @jvz (for his interest in Vanilla)\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-10-11T16:09:41Z", "url": "https://github.com/jenkinsci/jenkins/pull/4987", "merged": true, "mergeCommit": {"oid": "5369f783052970a7e249bb1f79e41f4c4911b874"}, "closed": true, "closedAt": "2020-10-17T07:46:50Z", "author": {"login": "Wadeck"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRhlxGAH2gAyNTAxMTYyNDk5OjFhMjBlNWNkYWI0YTk4NzkwYTRkNjQyZDk2YTg2ZjFmMDFkZjgxNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSyGpRgFqTUwOTQwMDc4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a", "author": {"user": {"login": "Wadeck", "name": "Wadeck Follonier"}}, "url": "https://github.com/jenkinsci/jenkins/commit/1a20e5cdab4a98790a4d642d96a86f1f01df815a", "committedDate": "2020-10-11T16:02:04Z", "message": "Reduce the prototype.js usage\n\nOnly cover the Element.xxxClassName in hudson-behavior. The related methods can be easily replaced by vanilla JavaScript.\nFor compatibility: https://caniuse.com/classlist (add, remove and contains with single argument is supported by all supported browsers)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2Mzk3OTEz", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-506397913", "createdAt": "2020-10-12T08:24:13Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NDU0OTY3", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-506454967", "createdAt": "2020-10-12T09:35:00Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NjkzMjUz", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-506693253", "createdAt": "2020-10-12T14:55:39Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2Nzg1NDI0", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-506785424", "createdAt": "2020-10-12T17:04:26Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowNDoyNlrOHgGoSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowNToyNlrOHgGqTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNTA5OA==", "bodyText": "Is it certain that rows[0] is not undefined?", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r503425098", "createdAt": "2020-10-12T17:04:26Z", "author": {"login": "zbynek"}, "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -2222,7 +2220,7 @@ function updateBuildHistory(ajaxUrl,nBuild) {\n \n                     // delete all rows\n                     var searchRow;\n-                    if (Element.hasClassName(rows[0], \"build-search-row\")) {\n+                    if (rows[0].classList.contains('build-search-row')) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "originalPosition": 234}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNTYxMg==", "bodyText": "Is it certain that el1 and el2 are not undefined?", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r503425612", "createdAt": "2020-10-12T17:05:26Z", "author": {"login": "zbynek"}, "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -1781,30 +1787,30 @@ function updateBuildHistory(ajaxUrl,nBuild) {\n             return;\n         }\n \n-        if (Element.hasClassName(row, \"overflow-checked\")) {\n+        if (row.classList.contains('overflow-checked')) {\n             // already done.\n             return;\n         }\n \n         function markSingleline() {\n-            Element.addClassName(row, \"single-line\");\n-            Element.removeClassName(row, \"multi-line\");\n+            row.classList.add('single-line');\n+            row.classList.remove('multi-line');\n         }\n         function markMultiline() {\n-            Element.removeClassName(row, \"single-line\");\n-            Element.addClassName(row, \"multi-line\");\n+            row.classList.remove('single-line');\n+            row.classList.add('multi-line');\n         }\n         function indentMultiline(element) {\n-            Element.addClassName(element, \"indent-multiline\");\n+            element.classList.add('indent-multiline');\n         }\n \n         function blockWrap(el1, el2) {\n             var div = document.createElement('div');\n \n-            Element.addClassName(div, \"block\");\n-            Element.addClassName(div, \"wrap\");\n-            Element.addClassName(el1, \"wrapped\");\n-            Element.addClassName(el2, \"wrapped\");\n+            div.classList.add('block');\n+            div.classList.add('wrap');\n+            el1.classList.add('wrapped');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDgxMjAz", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-508481203", "createdAt": "2020-10-14T15:39:29Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTozOToyOVrOHhZUPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTozOToyOVrOHhZUPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc3OTgzOQ==", "bodyText": "Could this be replaced by something like clsName.split(' ').forEach(function (className) { if (className) be.classList.add(className) }) ?", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r504779839", "createdAt": "2020-10-14T15:39:29Z", "author": {"login": "fqueiruga"}, "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -616,7 +616,13 @@ function makeButton(e,onclick) {\n     if(h!=null)\n         btn.addListener(\"click\",h);\n     var be = btn.get(\"element\");\n-    Element.addClassName(be,clsName);\n+    var classesSeparatedByWhitespace = clsName.split(' ');\n+    for (var i = 0; i < classesSeparatedByWhitespace.length; i++) {\n+        var singleClass = classesSeparatedByWhitespace[i];\n+        if (singleClass) {\n+            be.classList.add(singleClass);\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDAwMzM4", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-509400338", "createdAt": "2020-10-15T13:50:00Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDAwNzg1", "url": "https://github.com/jenkinsci/jenkins/pull/4987#pullrequestreview-509400785", "createdAt": "2020-10-15T13:50:23Z", "commit": {"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2033, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}