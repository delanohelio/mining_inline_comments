{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMjkxNTMw", "number": 4826, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwODozNjo1NFrOEKzRWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODoyNDo1NFrOELAtEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NzYxMjQxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/hudson/model/ChoiceParameterDefinition.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwODozNjo1NFrOGsDDyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwODozNjo1NFrOGsDDyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg0MDY1MQ==", "bodyText": "You can extract this piece of code keeping the checkValue method but using the new isValid method. This way you avoid repeating code below in the createValue(String) method.", "url": "https://github.com/jenkinsci/jenkins/pull/4826#discussion_r448840651", "createdAt": "2020-07-02T08:36:54Z", "author": {"login": "MRamonLeon"}, "path": "core/src/main/java/hudson/model/ChoiceParameterDefinition.java", "diffHunk": "@@ -141,21 +141,27 @@ public StringParameterValue getDefaultParameterValue() {\n         return new StringParameterValue(getName(), defaultValue, getDescription());\n     }\n \n-    private StringParameterValue checkValue(StringParameterValue value) {\n-        if (!choices.contains(value.value))\n-            throw new IllegalArgumentException(\"Illegal choice for parameter \" + getName() + \": \" + value.value);\n-        return value;\n+    @Override\n+    public boolean isValid(ParameterValue value) {\n+        return choices.contains(((StringParameterValue) value).getValue());\n     }\n \n     @Override\n     public ParameterValue createValue(StaplerRequest req, JSONObject jo) {\n         StringParameterValue value = req.bindJSON(StringParameterValue.class, jo);\n         value.setDescription(getDescription());\n-        return checkValue(value);\n+        if (!isValid(value)) {\n+            throw new IllegalArgumentException(\"Illegal choice for parameter \" + getName() + \": \" + value.getValue());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "486ed6b53ccb6374bb5b49a984e410c77fcd2780"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTgxMzI4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/hudson/model/ParameterDefinition.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODoyNDo1NFrOGsYwdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODoyNDo1NFrOGsYwdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE5NjE0OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 *\n          \n          \n            \n                 * @since TODO", "url": "https://github.com/jenkinsci/jenkins/pull/4826#discussion_r449196148", "createdAt": "2020-07-02T18:24:54Z", "author": {"login": "stellargo"}, "path": "core/src/main/java/hudson/model/ParameterDefinition.java", "diffHunk": "@@ -225,6 +225,17 @@ public ParameterValue getDefaultParameterValue() {\n         return null;\n     }\n \n+    /**\n+     * Checks whether a given value is valid for this definition.\n+     *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6931538feb79362a9005b143d185d882aea2ecb8"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 266, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}