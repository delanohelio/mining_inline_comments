{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MDY4ODE3", "number": 5063, "title": "Load admin monitors popup content via ajax", "bodyText": "See JENKINS-XXXXX.\nThis PR aims to make loading the list of administrative monitors asynchronous and to not affect page load. This also has the benefit of fixing keyboard navigation through the page header.\nNo notable changes to show in screenshots, except the empty state\n\nScreenshot of empty state\nThis should almost never be shown (for example, user gets permissions to read monitors removed and tries to load them before reloading the page).\n\n\n\nProposed changelog entries\n\nLoad the administrative monitors popup on demand to reduce page load time.\nFixes a bug where the page header would not be navigable using keyboard when there were active administrative monitors.\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@timja\n@daniel-beck\n@Wadeck\n@oleg-nenashev\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-11-19T16:16:22Z", "url": "https://github.com/jenkinsci/jenkins/pull/5063", "merged": true, "mergeCommit": {"oid": "44c59a6f5ce805d690c75253ebf34c3983b090c4"}, "closed": true, "closedAt": "2020-11-26T08:38:43Z", "author": {"login": "fqueiruga"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeDSvggH2gAyNTI0MDY4ODE3OjRhMTk4MjJiZjAwYzM4MjZmYWU4YzQ5NjI4M2M1M2ZkNDY3Y2M3ZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgOz2ZgFqTUzOTA5NDYzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4a19822bf00c3826fae8c496283c53fd467cc7ed", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/4a19822bf00c3826fae8c496283c53fd467cc7ed", "committedDate": "2020-11-19T14:05:09Z", "message": "Admin monitors popup is now loaded through an API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e8a4e914ec5a7caf91ab4bca22cf5603e54a923", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/1e8a4e914ec5a7caf91ab4bca22cf5603e54a923", "committedDate": "2020-11-19T16:09:56Z", "message": "Fixes form submission inside the popup\n\n- Wraps it in an l:ajax template so that proper variables are set\n- Applies the csrf crumbs to the forms after the popup is constructed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f98ad85bc852d81c8d58de602cb9bf4ad8e1342d", "committedDate": "2020-11-19T16:10:41Z", "message": "Handle authorization and empty state"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NjkyOTk5", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-534692999", "createdAt": "2020-11-19T17:39:09Z", "commit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNzozOToxMFrOH2qILA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxOTo1ODowOFrOH2vVaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA3NTM3Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final ArrayList<AdministrativeMonitor> monitorsList = new ArrayList<AdministrativeMonitor>();\n          \n          \n            \n                private final List<AdministrativeMonitor> monitorsList = new ArrayList<AdministrativeMonitor>();", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527075372", "createdAt": "2020-11-19T17:39:10Z", "author": {"login": "timja"}, "path": "core/src/main/java/jenkins/management/AdministrativeMonitorsApiData.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package jenkins.management;\n+\n+import hudson.model.AdministrativeMonitor;\n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.NoExternalUse;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Restricted(NoExternalUse.class)\n+public class AdministrativeMonitorsApiData {\n+    private final ArrayList<AdministrativeMonitor> monitorsList = new ArrayList<AdministrativeMonitor>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA3NTQ1NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public ArrayList<AdministrativeMonitor> getMonitorsList() {\n          \n          \n            \n                public List<AdministrativeMonitor> getMonitorsList() {", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527075454", "createdAt": "2020-11-19T17:39:17Z", "author": {"login": "timja"}, "path": "core/src/main/java/jenkins/management/AdministrativeMonitorsApiData.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package jenkins.management;\n+\n+import hudson.model.AdministrativeMonitor;\n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.NoExternalUse;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Restricted(NoExternalUse.class)\n+public class AdministrativeMonitorsApiData {\n+    private final ArrayList<AdministrativeMonitor> monitorsList = new ArrayList<AdministrativeMonitor>();\n+\n+    AdministrativeMonitorsApiData(List<AdministrativeMonitor> monitors) {\n+        monitorsList.addAll(monitors);\n+    }\n+\n+    public ArrayList<AdministrativeMonitor> getMonitorsList() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA3NTYzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return  this.monitorsList.size() > 0;\n          \n          \n            \n                    return !this.monitorsList.isEmpty();", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527075639", "createdAt": "2020-11-19T17:39:32Z", "author": {"login": "timja"}, "path": "core/src/main/java/jenkins/management/AdministrativeMonitorsApiData.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package jenkins.management;\n+\n+import hudson.model.AdministrativeMonitor;\n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.NoExternalUse;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Restricted(NoExternalUse.class)\n+public class AdministrativeMonitorsApiData {\n+    private final ArrayList<AdministrativeMonitor> monitorsList = new ArrayList<AdministrativeMonitor>();\n+\n+    AdministrativeMonitorsApiData(List<AdministrativeMonitor> monitors) {\n+        monitorsList.addAll(monitors);\n+    }\n+\n+    public ArrayList<AdministrativeMonitor> getMonitorsList() {\n+        return this.monitorsList;\n+    }\n+\n+    public boolean hasActiveMonitors() {\n+        return  this.monitorsList.size() > 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE1MzYwNA==", "bodyText": "looks like the indent change should be reverted here?", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527153604", "createdAt": "2020-11-19T19:46:03Z", "author": {"login": "timja"}, "path": "core/src/main/resources/jenkins/management/AdministrativeMonitorsDecorator/footer.jelly", "diffHunk": "@@ -23,73 +23,65 @@ THE SOFTWARE.\n -->\n <?jelly escape-by-default='true'?>\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:l=\"/lib/layout\">\n-    <j:set var=\"activeMonitors\" value=\"${it.getMonitorsToDisplay()}\" />\n-    \n+    <j:set var=\"activeMonitors\" value=\"${it.getMonitorsToDisplay()}\"/>\n+\n     <j:if test=\"${activeMonitors != null and activeMonitors.size() > 0}\">\n         <st:adjunct includes=\"jenkins.management.AdministrativeMonitorsDecorator.resources\"/>\n \n-        <j:set var=\"activeNonSecurityAM\" value=\"${it.filterNonSecurityAdministrativeMonitors(activeMonitors)}\" />\n-        <j:set var=\"activeNonSecurityAMCount\" value=\"${activeNonSecurityAM.size()}\" />\n-        <j:set var=\"activeSecurityAM\" value=\"${it.filterSecurityAdministrativeMonitors(activeMonitors)}\" />\n-        <j:set var=\"activeSecurityAMCount\" value=\"${activeSecurityAM.size()}\" />\n+        <j:set var=\"activeNonSecurityAMCount\" value=\"${it.nonSecurityAdministrativeMonitorsCount}\"/>\n+        <j:set var=\"activeSecurityAMCount\" value=\"${it.securityAdministrativeMonitorsCount  }\"/>\n \n         <div id=\"visible-am-container\" class=\"am-container\">\n             <j:if test=\"${activeNonSecurityAMCount > 0}\">\n-                <a id=\"visible-am-button\" class=\"am-button\" href=\"#\" onclick=\"toggleVisibleAmList(event)\" title=\"${%tooltip(activeNonSecurityAMCount)}\">\n-                    <l:svgIcon href=\"${resURL}/images/material-icons/svg-sprite-social-symbol.svg#ic_notifications_24px\" />\n-                    <div class=\"am-monitor__indicator-mobile\" />\n+                <a id=\"visible-am-button\"\n+                   class=\"am-button\"\n+                   href=\"#\"\n+                   data-href=\"${rootURL}/administrativeMonitors/nonSecurityPopupContent\"\n+                   title=\"${%tooltip(activeNonSecurityAMCount)}\">\n+                    <l:svgIcon\n+                            href=\"${resURL}/images/material-icons/svg-sprite-social-symbol.svg#ic_notifications_24px\"/>\n+                    <div class=\"am-monitor__indicator-mobile\"/>\n                     <span class=\"am-monitor__count\">\n                         ${activeNonSecurityAMCount}\n                     </span>\n                 </a>\n                 <div id=\"visible-am-list\" class=\"am-list\">\n-                    <j:forEach var=\"am\" items=\"${activeNonSecurityAM}\">\n-                        <div class=\"am-message\">\n-                            <st:include page=\"message.jelly\" it=\"${am}\" />\n-                        </div>\n-                    </j:forEach>\n-                    <p style=\"text-align: center; margin: 10px 0 0 0;\">\n-                        <a href=\"${rootURL}/manage\" onclick=\"document.location.href='${rootURL}/manage';\">${%Manage Jenkins}</a>\n-                    </p>\n                 </div>\n             </j:if>\n         </div>\n         <div id=\"visible-sec-am-container\" class=\"am-container\">\n             <j:if test=\"${activeSecurityAMCount > 0}\">\n-                <a id=\"visible-sec-am-button\" class=\"am-button security-am\" href=\"#\" onclick=\"toggleVisibleSecAmList(event)\" title=\"${%tooltipSec(activeSecurityAMCount)}\">\n-                    <l:svgIcon href=\"${resURL}/images/material-icons/svg-sprite-action-symbol.svg#ic_warning_shield_24px\" />\n-                    <div class=\"am-monitor__indicator-mobile\" />\n+                <a id=\"visible-sec-am-button\"\n+                   class=\"am-button security-am\"\n+                   href=\"#\"\n+                   data-href=\"${rootURL}/administrativeMonitors/securityPopupContent\"\n+                   title=\"${%tooltipSec(activeSecurityAMCount)}\">\n+                    <l:svgIcon\n+                            href=\"${resURL}/images/material-icons/svg-sprite-action-symbol.svg#ic_warning_shield_24px\"/>\n+                    <div class=\"am-monitor__indicator-mobile\"/>\n                     <span class=\"am-monitor__count\">\n                         ${activeSecurityAMCount}\n                     </span>\n                 </a>\n                 <div id=\"visible-sec-am-list\" class=\"am-list\">\n-                    <j:forEach var=\"am\" items=\"${activeSecurityAM}\">\n-                        <div class=\"am-message\">\n-                            <st:include page=\"message.jelly\" it=\"${am}\" />\n-                        </div>\n-                    </j:forEach>\n-                    <p style=\"text-align: center; margin: 10px 0 0 0;\">\n-                        <a href=\"${rootURL}/manage\" onclick=\"document.location.href='${rootURL}/manage';\">${%Manage Jenkins}</a>\n-                    </p>\n                 </div>\n             </j:if>\n         </div>\n         <script type=\"text/javascript\">\n             (function() {\n-                var amContainer = document.getElementById(\"visible-am-container\");\n-                var amInsertion = document.getElementById(\"visible-am-insertion\");\n+            var amContainer = document.getElementById(\"visible-am-container\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE2MDY4MA==", "bodyText": "would be good to extract this to a variable so that people who don't know keycodes know what this is", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527160680", "createdAt": "2020-11-19T19:58:08Z", "author": {"login": "timja"}, "path": "core/src/main/resources/jenkins/management/AdministrativeMonitorsDecorator/resources.js", "diffHunk": "@@ -1,78 +1,90 @@\n-function amCloser(e) {\n-    var list = document.getElementById('visible-am-list');\n-    var el = e.target;\n-    while (el) {\n-        if (el === list) {\n-            return; // clicked in the list\n+(function () {\n+    function initializeAmMonitor(amMonitorRoot, options) {\n+        var button = amMonitorRoot.querySelector('.am-button');\n+        var url = button.getAttribute('data-href');\n+        var amList = amMonitorRoot.querySelector('.am-list');\n+\n+        function onClose(e) {\n+            var list = amList;\n+            var el = e.target;\n+            while (el) {\n+                if (el === list) {\n+                    return; // clicked in the list\n+                }\n+                el = el.parentElement;\n+            }\n+            close();\n         }\n-        el = el.parentElement;\n-    }\n-    hideVisibleAmList();\n-}\n-function secAmCloser(e) {\n-    var list = document.getElementById('visible-sec-am-list');\n-    var el = e.target;\n-    while (el) {\n-        if (el === list) {\n-            return; // clicked in the list\n+        function onEscClose(e) {\n+            if (e.keyCode === 27) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0ODA0OTgy", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-534804982", "createdAt": "2020-11-19T20:02:26Z", "commit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDowMjoyNlrOH2vetA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDowMjoyNlrOH2vetA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE2MzA2MA==", "bodyText": "what about this? not the best wording imo but no point spending much time on it as users shouldn't see it\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            no_active_monitors=There are currently no active monitors\n          \n          \n            \n            no_active_monitors=There are currently no warnings", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527163060", "createdAt": "2020-11-19T20:02:26Z", "author": {"login": "timja"}, "path": "core/src/main/resources/jenkins/management/AdministrativeMonitorsApiData/monitorsList.properties", "diffHunk": "@@ -0,0 +1 @@\n+no_active_monitors=There are currently no active monitors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98ad85bc852d81c8d58de602cb9bf4ad8e1342d"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9db13b564ed6b8afc96695be6e9069c81ab4c4b", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/e9db13b564ed6b8afc96695be6e9069c81ab4c4b", "committedDate": "2020-11-20T09:11:18Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Tim Jacomb <timjacomb1+github@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c14133fb07a6fc9a46946f4dc2e2c898ebc04a7", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/2c14133fb07a6fc9a46946f4dc2e2c898ebc04a7", "committedDate": "2020-11-20T09:11:47Z", "message": "Fix JS error where there were monitors of only one kind"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "250cbb7f4028b06597d4df0bd9b6b753c4373aaf", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/250cbb7f4028b06597d4df0bd9b6b753c4373aaf", "committedDate": "2020-11-20T09:11:47Z", "message": "Revert changes to indentation of inline JS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de58052ca0ae56ad2c472e67c9b0308441804dda", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/de58052ca0ae56ad2c472e67c9b0308441804dda", "committedDate": "2020-11-20T09:14:04Z", "message": "Clarify ESC keyCode with a comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MjUzODgx", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-535253881", "createdAt": "2020-11-20T09:19:50Z", "commit": {"oid": "de58052ca0ae56ad2c472e67c9b0308441804dda"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxOTo1MFrOH3HdAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxOTo1MFrOH3HdAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1NTg0Mw==", "bodyText": "I meant something like this, what do you think?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (e.keyCode === 27) { // If the key press is ESCAPE...\n          \n          \n            \n                        var escapeKeyCode = 27;\n          \n          \n            \n                        if (e.keyCode === escapeKeyCode) {", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r527555843", "createdAt": "2020-11-20T09:19:50Z", "author": {"login": "timja"}, "path": "core/src/main/resources/jenkins/management/AdministrativeMonitorsDecorator/resources.js", "diffHunk": "@@ -1,78 +1,94 @@\n-function amCloser(e) {\n-    var list = document.getElementById('visible-am-list');\n-    var el = e.target;\n-    while (el) {\n-        if (el === list) {\n-            return; // clicked in the list\n+(function () {\n+    function initializeAmMonitor(amMonitorRoot, options) {\n+        var button = amMonitorRoot.querySelector('.am-button');\n+        var amList = amMonitorRoot.querySelector('.am-list');\n+        if (button === null || amList === null) return null;\n+\n+        var url = button.getAttribute('data-href');\n+\n+        function onClose(e) {\n+            var list = amList;\n+            var el = e.target;\n+            while (el) {\n+                if (el === list) {\n+                    return; // clicked in the list\n+                }\n+                el = el.parentElement;\n+            }\n+            close();\n         }\n-        el = el.parentElement;\n-    }\n-    hideVisibleAmList();\n-}\n-function secAmCloser(e) {\n-    var list = document.getElementById('visible-sec-am-list');\n-    var el = e.target;\n-    while (el) {\n-        if (el === list) {\n-            return; // clicked in the list\n+        function onEscClose(e) {\n+            if (e.keyCode === 27) { // If the key press is ESCAPE...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de58052ca0ae56ad2c472e67c9b0308441804dda"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230", "committedDate": "2020-11-20T09:34:16Z", "message": "Update core/src/main/resources/jenkins/management/AdministrativeMonitorsDecorator/resources.js\n\nCo-authored-by: Tim Jacomb <timjacomb1+github@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MjgxNjM4", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-535281638", "createdAt": "2020-11-20T09:55:54Z", "commit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MzcxNDUw", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-535371450", "createdAt": "2020-11-20T12:04:40Z", "commit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDQwODc2", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-536040876", "createdAt": "2020-11-22T08:49:38Z", "commit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQwODo0OTozOVrOH31E6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQwODo0OTozOVrOH31E6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMwMzMzOA==", "bodyText": "Should these calls have explicit permission checks?", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r528303338", "createdAt": "2020-11-22T08:49:39Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/jenkins/management/AdministrativeMonitorsApi.java", "diffHunk": "@@ -0,0 +1,62 @@\n+package jenkins.management;\n+\n+import hudson.Extension;\n+import hudson.model.AdministrativeMonitor;\n+import hudson.model.PageDecorator;\n+import hudson.model.RootAction;\n+import jenkins.model.Jenkins;\n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.NoExternalUse;\n+import org.kohsuke.stapler.StaplerRequest;\n+import org.kohsuke.stapler.StaplerResponse;\n+import org.kohsuke.stapler.verb.GET;\n+\n+import javax.servlet.ServletException;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.IOException;\n+import java.util.Collection;\n+import java.util.Collections;\n+\n+@Extension\n+@Restricted(NoExternalUse.class)\n+public class AdministrativeMonitorsApi implements RootAction {\n+    @GET", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2OTA4Njc4", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-536908678", "createdAt": "2020-11-23T22:53:39Z", "commit": {"oid": "8c8f403a87bd58d4a8cd7683ec5e50b4a0f2c230"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793", "author": {"user": {"login": "Wadeck", "name": "Wadeck Follonier"}}, "url": "https://github.com/jenkinsci/jenkins/commit/40a28adf55ad9dff91be9ded5b99d323bac1a793", "committedDate": "2020-11-24T09:18:50Z", "message": "Multiple small adjustments\n\n- Remove unused imports\n- Remove non-necessary call for the response that are set in the getView\n- Keep the previous improvement about limiting the number of call to getMonitorList()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3Mjg5NTE3", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-537289517", "createdAt": "2020-11-24T09:21:26Z", "commit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3MjkyMjg0", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-537292284", "createdAt": "2020-11-24T09:24:31Z", "commit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQwOToyNDozMVrOH40TTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQwOToyNDozMVrOH40TTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTMzOTIxMg==", "bodyText": "why aren't this needed?", "url": "https://github.com/jenkinsci/jenkins/pull/5063#discussion_r529339212", "createdAt": "2020-11-24T09:24:31Z", "author": {"login": "fqueiruga"}, "path": "core/src/main/java/jenkins/management/AdministrativeMonitorsApi.java", "diffHunk": "@@ -12,28 +11,19 @@\n import org.kohsuke.stapler.verb.GET;\n \n import javax.servlet.ServletException;\n-import javax.servlet.http.HttpServletResponse;\n import java.io.IOException;\n-import java.util.Collection;\n-import java.util.Collections;\n \n @Extension\n @Restricted(NoExternalUse.class)\n public class AdministrativeMonitorsApi implements RootAction {\n     @GET\n     public void doNonSecurityPopupContent(StaplerRequest req, StaplerResponse resp) throws IOException, ServletException {\n-        resp.setStatus(HttpServletResponse.SC_OK);\n-        resp.setContentType(\"text/html\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3MzAwNTI4", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-537300528", "createdAt": "2020-11-24T09:33:18Z", "commit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MDk0NjM3", "url": "https://github.com/jenkinsci/jenkins/pull/5063#pullrequestreview-539094637", "createdAt": "2020-11-26T08:38:07Z", "commit": {"oid": "40a28adf55ad9dff91be9ded5b99d323bac1a793"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1834, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}