{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MzcxNzcy", "number": 5138, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMTowMjoxNlrOFITO7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMTowNDoxMFrOFITQ3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MjQ4MDQ2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/jenkins/slaves/DefaultJnlpSlaveReceiver.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMTowMjoxNlrOIKJHiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxNjo0NzowM1rOIN47kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwNjA1Nw==", "bodyText": "One of the confusing bits is that this would previously throw a NullPointerException.", "url": "https://github.com/jenkinsci/jenkins/pull/5138#discussion_r547506057", "createdAt": "2020-12-22T21:02:16Z", "author": {"login": "jeffret-b"}, "path": "core/src/main/java/jenkins/slaves/DefaultJnlpSlaveReceiver.java", "diffHunk": "@@ -124,7 +124,8 @@ public void afterProperties(@NonNull JnlpConnectionState event) {\n         Channel ch = computer.getChannel();\n         if (ch != null) {\n             String cookie = event.getProperty(JnlpConnectionState.COOKIE_KEY);\n-            if (cookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), ch.getProperty(COOKIE_NAME).toString().getBytes(StandardCharsets.UTF_8))) {\n+            String channelCookie = (String)ch.getProperty(JnlpConnectionState.COOKIE_KEY);\n+            if (cookie != null && channelCookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), channelCookie.getBytes(StandardCharsets.UTF_8))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70fe02c76372f4d6c63e25a17b26500a29cde67c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTEzNTQ2Mg==", "bodyText": "If it evet reached this check, yes...", "url": "https://github.com/jenkinsci/jenkins/pull/5138#discussion_r549135462", "createdAt": "2020-12-27T16:49:18Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/jenkins/slaves/DefaultJnlpSlaveReceiver.java", "diffHunk": "@@ -124,7 +124,8 @@ public void afterProperties(@NonNull JnlpConnectionState event) {\n         Channel ch = computer.getChannel();\n         if (ch != null) {\n             String cookie = event.getProperty(JnlpConnectionState.COOKIE_KEY);\n-            if (cookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), ch.getProperty(COOKIE_NAME).toString().getBytes(StandardCharsets.UTF_8))) {\n+            String channelCookie = (String)ch.getProperty(JnlpConnectionState.COOKIE_KEY);\n+            if (cookie != null && channelCookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), channelCookie.getBytes(StandardCharsets.UTF_8))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwNjA1Nw=="}, "originalCommit": {"oid": "70fe02c76372f4d6c63e25a17b26500a29cde67c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQzNTE1Mw==", "bodyText": "It did reach this check, throwing a NullPointerException, before these fixes. That was confusing but wasn't really the problem. With these changes, it doesn't trip over this in normal, valid situations, but it may still reduce confusion in some invalid reconnection situations.", "url": "https://github.com/jenkinsci/jenkins/pull/5138#discussion_r551435153", "createdAt": "2021-01-04T16:47:03Z", "author": {"login": "jeffret-b"}, "path": "core/src/main/java/jenkins/slaves/DefaultJnlpSlaveReceiver.java", "diffHunk": "@@ -124,7 +124,8 @@ public void afterProperties(@NonNull JnlpConnectionState event) {\n         Channel ch = computer.getChannel();\n         if (ch != null) {\n             String cookie = event.getProperty(JnlpConnectionState.COOKIE_KEY);\n-            if (cookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), ch.getProperty(COOKIE_NAME).toString().getBytes(StandardCharsets.UTF_8))) {\n+            String channelCookie = (String)ch.getProperty(JnlpConnectionState.COOKIE_KEY);\n+            if (cookie != null && channelCookie != null && MessageDigest.isEqual(cookie.getBytes(StandardCharsets.UTF_8), channelCookie.getBytes(StandardCharsets.UTF_8))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwNjA1Nw=="}, "originalCommit": {"oid": "70fe02c76372f4d6c63e25a17b26500a29cde67c"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0MjQ4NTQwOnYy", "diffSide": "RIGHT", "path": "pom.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMTowNDoxMFrOIKJKQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMTowNDoxMFrOIKJKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUwNjc1NQ==", "bodyText": "This doesn't yet exist publicly. Looks like there are currently infra issues preventing it from being generated publicly.", "url": "https://github.com/jenkinsci/jenkins/pull/5138#discussion_r547506755", "createdAt": "2020-12-22T21:04:10Z", "author": {"login": "jeffret-b"}, "path": "pom.xml", "diffHunk": "@@ -99,7 +99,7 @@ THE SOFTWARE.\n     <changelog.url>https://jenkins.io/changelog</changelog.url>\n \n     <!-- Bundled Remoting version -->\n-    <remoting.version>4.6</remoting.version>\n+    <remoting.version>4.7-rc2860.f4a9a135655d</remoting.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70fe02c76372f4d6c63e25a17b26500a29cde67c"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 47, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}