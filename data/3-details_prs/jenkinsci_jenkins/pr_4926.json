{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NjY2Njc4", "number": 4926, "title": "[JENKINS-63592] Revamp empty states", "bodyText": "See JENKINS-63592.\nThis PR aims to revamp the empty state screens by making them more modern-looking and attractive. They style the empty state items as content blocks in order to provide a stepping stone to make them extensible through an extension point.\nScreenshots\n\nAnonymous user\nOld\n\nNew\n\n\n\nNothing created - admin user\nOld\n\nNew\n\n\n\nNothing created - user with create agent permissions\nOld\n\nNew\n\n\n\nNothing created - user with only job create permissions\nOld\n\nNew\n\n\n\nEmpty folder\nOld\n\nNew\n\n\nDesign brief\nUploaded to the JIRA ticket\nBreaking changes\nThis PR makes the previous translations obsolete. All the strings except the welcome message have been removed\nProposed changelog entries\n\nRevamp the empty state screens. Their translation strings are now obsolete.\n\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n (If applicable) Jira issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@daniel-beck\n@timja\n@oleg-nenashev\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a Jira issue must exist, be a Bug or Improvement, and be labeled as lts-candidate to be considered (see query).", "createdAt": "2020-09-04T13:04:25Z", "url": "https://github.com/jenkinsci/jenkins/pull/4926", "merged": true, "mergeCommit": {"oid": "2988d722b9049de0dc33678c868aad7c631e89e0"}, "closed": true, "closedAt": "2020-09-16T18:47:28Z", "author": {"login": "fqueiruga"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEo9ZmAH2gAyNDc5NjY2Njc4OmRmNWFmOGQyOGQ1ZmE1MmVlZjRjOWIxMjY1YWJlNDczMGRhMzVhNzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJHZmVgFqTQ4ODY1NDkxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df5af8d28d5fa52eef4c9b1265abe4730da35a76", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/df5af8d28d5fa52eef4c9b1265abe4730da35a76", "committedDate": "2020-09-01T15:16:12Z", "message": "wip - extract conditional vars"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1560e1eb68c1cf1c031631020a88352467a937c6", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/1560e1eb68c1cf1c031631020a88352467a937c6", "committedDate": "2020-09-04T10:02:12Z", "message": "Rework the empty state screends\n\n- Create content block components for the sectioning and hyperlinks\n- Reorganize the conditional logic to use the new sectioning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f86ca6b279565643c114c5a6ba7fe325ff8f3a68", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f86ca6b279565643c114c5a6ba7fe325ff8f3a68", "committedDate": "2020-09-04T10:02:18Z", "message": "Set up i18n and clear outdated strings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f34b7950a8d83167fa25ade7509ee54c4a0822b5", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/f34b7950a8d83167fa25ade7509ee54c4a0822b5", "committedDate": "2020-09-07T09:05:24Z", "message": "Fix broken build for empty state styles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d00812704001aa0f995f454b3932829da63d07bd", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/d00812704001aa0f995f454b3932829da63d07bd", "committedDate": "2020-09-07T09:05:55Z", "message": "Undo unintended change to global hyperlinks\n\n- I added a CSS class for generic dark links that should be left for a different PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f9db67f5f67eee1d3079d8b0e88b7dd0a2cae1d", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/7f9db67f5f67eee1d3079d8b0e88b7dd0a2cae1d", "committedDate": "2020-09-07T09:06:35Z", "message": "UI touches for the empty state styles\n\n- No longer show welcome message for empty folders\n- Update link focus outline color to palette"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/92513c7f6564471ca594ec8d230af26b2ed36c6c", "committedDate": "2020-09-07T09:40:07Z", "message": "Try to fix encoding issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2NTg1NDc4", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-486585478", "createdAt": "2020-09-11T08:29:34Z", "commit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MTQwNDc2", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-487140476", "createdAt": "2020-09-11T21:42:32Z", "commit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTo0MjozMlrOHQuqPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTo0MjozMlrOHQuqPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwMzc0Mw==", "bodyText": "Hmm this doesn't seem right,\n\nit's just linking to new computer, not the cloud configuration screen.\nit's showing up when I don't have a cloud plugin installed\n\nAlthough 2 probably isn't too bad as there's docs on the configure Clouds page saying what to do:\n\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                a(href: \"computer/new\", class: \"content-block__link\") {\n          \n          \n            \n                                                a(href: \"configureClouds\", class: \"content-block__link\") {", "url": "https://github.com/jenkinsci/jenkins/pull/4926#discussion_r487303743", "createdAt": "2020-09-11T21:42:32Z", "author": {"login": "timja"}, "path": "core/src/main/resources/hudson/model/AllView/noJob.groovy", "diffHunk": "@@ -4,40 +4,142 @@ import hudson.model.Computer\n import hudson.model.Item\n import jenkins.model.Jenkins\n \n+def l = namespace(lib.LayoutTagLib)\n+\n+def isTopLevelAllView = my.owner == Jenkins.get();\n+def canSetUpDistributedBuilds = Jenkins.get().hasPermission(Computer.CREATE) &&\n+        Jenkins.get().clouds.isEmpty() &&\n+        Jenkins.get().getNodes().isEmpty();\n+def hasAdministerJenkinsPermission = Jenkins.get().hasPermission(Jenkins.ADMINISTER);\n+def hasItemCreatePermission = my.owner.hasPermission(Item.CREATE);\n+\n div {\n-    h1(_(\"Welcome to Jenkins!\"))\n-\n-    if (my.owner == Jenkins.get()) {\n-        // we're a top-level 'All' view\n-        if (Jenkins.get().hasPermission(Computer.CREATE) && Jenkins.get().clouds.isEmpty() && Jenkins.get().getNodes().isEmpty()) {\n-            div(class: 'call-to-action') {\n-                if (Jenkins.get().hasPermission(Jenkins.ADMINISTER)) {\n-                    raw(_(\"distributedBuildsWithCloud\"))\n-                } else {\n-                    raw(_(\"distributedBuilds\"))\n+\n+    div(class: \"empty-state-block\") {\n+        if (isTopLevelAllView) {\n+            if (canSetUpDistributedBuilds || hasItemCreatePermission) {\n+                h1(_(\"Welcome to Jenkins!\"))\n+\n+                p(_(\"noJobDescription\"))\n+\n+                if (canSetUpDistributedBuilds) {\n+                    section(class: \"empty-state-section\") {\n+                        h2(_(\"setUpDistributedBuilds\"), class: \"h4\")\n+                        ul(class: \"empty-state-section-list\") {\n+                            li(class: \"content-block\") {\n+                                a(href: \"computer/new\", class: \"content-block__link\") {\n+                                    span(_(\"setUpAgent\"))\n+                                    span(class: \"trailing-icon\") {\n+                                        l.svgIcon(\n+                                                class: \"icon-sm\",\n+                                                href: \"${resURL}/images/material-icons/svg-sprite-navigation-symbol.svg#ic_arrow_forward_24px\")\n+                                    }\n+                                }\n+                            }\n+\n+                            if (hasAdministerJenkinsPermission) {\n+                                li(class: \"content-block\") {\n+                                    a(href: \"computer/new\", class: \"content-block__link\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b46d5fb1b8fadc5de925945cbf2dbc1d030d2965", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/b46d5fb1b8fadc5de925945cbf2dbc1d030d2965", "committedDate": "2020-09-12T09:24:41Z", "message": "Update core/src/main/resources/hudson/model/AllView/noJob.groovy\n\nCo-authored-by: Tim Jacomb <timjacomb1+github@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjE4MTgw", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-487218180", "createdAt": "2020-09-12T09:32:27Z", "commit": {"oid": "b46d5fb1b8fadc5de925945cbf2dbc1d030d2965"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12cb16bbd5f1eea056f6ed6afea12a758a9acb15", "author": {"user": {"login": "fqueiruga", "name": "F\u00e9lix Queiruga"}}, "url": "https://github.com/jenkinsci/jenkins/commit/12cb16bbd5f1eea056f6ed6afea12a758a9acb15", "committedDate": "2020-09-12T09:42:46Z", "message": "Move create job to top and change section title"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NjA4NTkw", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-487608590", "createdAt": "2020-09-14T10:10:01Z", "commit": {"oid": "12cb16bbd5f1eea056f6ed6afea12a758a9acb15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NTk3ODA4", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-488597808", "createdAt": "2020-09-15T11:46:00Z", "commit": {"oid": "12cb16bbd5f1eea056f6ed6afea12a758a9acb15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NjU0OTE2", "url": "https://github.com/jenkinsci/jenkins/pull/4926#pullrequestreview-488654916", "createdAt": "2020-09-15T12:59:51Z", "commit": {"oid": "12cb16bbd5f1eea056f6ed6afea12a758a9acb15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1934, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}