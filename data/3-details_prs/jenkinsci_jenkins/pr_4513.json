{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NDgwNDEx", "number": 4513, "title": "[JENKINS-61166] Show on 'updates' tab when a warning would be fixed", "bodyText": "See JENKINS-61166.\n\n\n\nThis does not apply to warnings that are currently hidden by configuration, to not introduce confusion: If you've hidden it, you don't want to see it anywhere.\nThis gets shown even when the admin monitor is entirely disabled. While it would make sense in that case to show more details about which warnings get addressed, I would not optimize for that configuration. I doubt users care that much to see the full list of warnings here.\nProposed changelog entries\n\nIndicate when security issues would be addressed by an update in plugin manager.\n\nProposed upgrade guidelines\nN/A\nSubmitter checklist\n\n JIRA issue is well described\n Changelog entries and upgrade guidelines are appropriate for the audience affected by the change (users or developer, depending on the change). Examples\n\nFill-in the Proposed changelog entries section only if there are breaking changes or other changes which may require extra steps from users during the upgrade\n\n\n Appropriate autotests or explanation to why this change has no tests\n[n/a] For dependency updates: links to external changelogs and, if possible, full diffs\n\n\nDesired reviewers\n@mention\n\nMaintainer checklist\nBefore the changes are marked as ready-for-merge:\n\n There are at least 2 approvals for the pull request and no outstanding requests for change\n Conversations in the pull request are over OR it is explicit that a reviewer does not block the change\n Changelog entries in the PR title and/or Proposed changelog entries are correct\n Proper changelog labels are set so that the changelog can be generated automatically\n If the change needs additional upgrade steps from users, upgrade-guide-needed label is set and there is a Proposed upgrade guidelines section in the PR title. (example)\n If it would make sense to backport the change to LTS, a JIRA issue should exist and be labeled as lts-candidate", "createdAt": "2020-02-21T21:28:54Z", "url": "https://github.com/jenkinsci/jenkins/pull/4513", "merged": true, "mergeCommit": {"oid": "12cd1593679eefcc73680abfd3a289fee805f5e9"}, "closed": true, "closedAt": "2020-03-04T18:41:26Z", "author": {"login": "daniel-beck"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGmnyqgBqjMwNjE5ODMyNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJ61wwgH2gAyMzc4NDgwNDExOjU2Y2Y0OTYwNTkwYzI4ZjYwNGVjNWJiNWU4ZDNhNzAxNDg3NGJkMGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec2456e361d7daf4d310ce9489396586013612bb", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/ec2456e361d7daf4d310ce9489396586013612bb", "committedDate": "2020-02-21T21:25:47Z", "message": "[JENKINS-61161] Show 'updates' tab when a warning would be fixed"}, "afterCommit": {"oid": "a937a72838715a4dfda72dca25e6ca590fb12672", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/a937a72838715a4dfda72dca25e6ca590fb12672", "committedDate": "2020-02-21T21:29:15Z", "message": "[JENKINS-61161] Show on 'updates' tab when a warning would be fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/9ec7a736ef1675442305c0fe19258dffcd450108", "committedDate": "2020-02-21T21:29:56Z", "message": "[JENKINS-61166] Show on 'updates' tab when a warning would be fixed"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a937a72838715a4dfda72dca25e6ca590fb12672", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/a937a72838715a4dfda72dca25e6ca590fb12672", "committedDate": "2020-02-21T21:29:15Z", "message": "[JENKINS-61161] Show on 'updates' tab when a warning would be fixed"}, "afterCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/9ec7a736ef1675442305c0fe19258dffcd450108", "committedDate": "2020-02-21T21:29:56Z", "message": "[JENKINS-61166] Show on 'updates' tab when a warning would be fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyOTk4MjAx", "url": "https://github.com/jenkinsci/jenkins/pull/4513#pullrequestreview-362998201", "createdAt": "2020-02-22T01:29:13Z", "commit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMToyOToxM1rOFtIs-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMToyOTo1NVrOFtItQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg3MjgyNg==", "bodyText": "NIT: Maybe this variable should be named addressesActiveVuln or something to that effect and have its values reversed in this function so that it matches the javadoc", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r382872826", "createdAt": "2020-02-22T01:29:13Z", "author": {"login": "res0nance"}, "path": "core/src/main/java/hudson/model/UpdateSite.java", "diffHunk": "@@ -1276,6 +1277,32 @@ public boolean isNeededDependenciesCompatibleWithInstalledVersion(PluginManager.\n             return getDependenciesIncompatibleWithInstalledVersion(cache).isEmpty();\n         }\n \n+        /**\n+         * Returns true if and only if this update addressed a currently active security vulnerability.\n+         *\n+         * @return true if and only if this update addressed a currently active security vulnerability.\n+         */\n+        @Restricted(NoExternalUse.class) // Jelly\n+        public boolean fixesSecurityVulnerabilities() {\n+            final PluginWrapper installed = getInstalled();\n+            if (installed == null) {\n+                return false;\n+            }\n+            boolean allWarningsStillApply = true;\n+            for (Warning warning : ExtensionList.lookupSingleton(UpdateSiteWarningsMonitor.class).getActivePluginWarningsByPlugin().getOrDefault(installed, Collections.emptyList())) {\n+                boolean thisWarningApplies = false;\n+                for (WarningVersionRange range : warning.versionRanges) {\n+                    if (range.includes(new VersionNumber(version))) {\n+                        thisWarningApplies = true;\n+                    }\n+                }\n+                if (!thisWarningApplies) {\n+                    allWarningsStillApply = false;\n+                }\n+            }\n+            return !allWarningsStillApply;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg3Mjg5Nw==", "bodyText": "NIT: Maybe this VersionNumber object should be constructed outside the loop. Although java might just optimize this away", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r382872897", "createdAt": "2020-02-22T01:29:55Z", "author": {"login": "res0nance"}, "path": "core/src/main/java/hudson/model/UpdateSite.java", "diffHunk": "@@ -1276,6 +1277,32 @@ public boolean isNeededDependenciesCompatibleWithInstalledVersion(PluginManager.\n             return getDependenciesIncompatibleWithInstalledVersion(cache).isEmpty();\n         }\n \n+        /**\n+         * Returns true if and only if this update addressed a currently active security vulnerability.\n+         *\n+         * @return true if and only if this update addressed a currently active security vulnerability.\n+         */\n+        @Restricted(NoExternalUse.class) // Jelly\n+        public boolean fixesSecurityVulnerabilities() {\n+            final PluginWrapper installed = getInstalled();\n+            if (installed == null) {\n+                return false;\n+            }\n+            boolean allWarningsStillApply = true;\n+            for (Warning warning : ExtensionList.lookupSingleton(UpdateSiteWarningsMonitor.class).getActivePluginWarningsByPlugin().getOrDefault(installed, Collections.emptyList())) {\n+                boolean thisWarningApplies = false;\n+                for (WarningVersionRange range : warning.versionRanges) {\n+                    if (range.includes(new VersionNumber(version))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNjg1NTE4", "url": "https://github.com/jenkinsci/jenkins/pull/4513#pullrequestreview-363685518", "createdAt": "2020-02-24T20:40:54Z", "commit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMDo0MDo1NFrOFtvGww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMDo0MDo1NFrOFtvGww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUwMjAxOQ==", "bodyText": "nit: maybe this would be better\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    <div class=\"alert alert-warning\">${%Applying this update will address security vulnerabilities currently affecting Jenkins.}</div>\n          \n          \n            \n                                    <div class=\"alert alert-warning\">${%Applying this update will address current security vulnerabilities.}</div>", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r383502019", "createdAt": "2020-02-24T20:40:54Z", "author": {"login": "jeffret-b"}, "path": "core/src/main/resources/hudson/PluginManager/table.jelly", "diffHunk": "@@ -119,6 +119,9 @@ THE SOFTWARE.\n                       <j:if test=\"${p.isForNewerJava()}\">\n                         <div class=\"alert alert-danger\">${%javaWarning(p.minimumJavaVersion)}</div>\n                       </j:if>\n+                      <j:if test=\"${p.fixesSecurityVulnerabilities()}\">\n+                        <div class=\"alert alert-warning\">${%Applying this update will address security vulnerabilities currently affecting Jenkins.}</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTg0MjI4", "url": "https://github.com/jenkinsci/jenkins/pull/4513#pullrequestreview-364184228", "createdAt": "2020-02-25T14:31:01Z", "commit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDozMTowMVrOFuIPGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDozNDo1MFrOFuIXnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzkxMzc1Mw==", "bodyText": "NIT: due to the length / complexity of the line, it could be useful to put it into a variable. This could also help a bit the debugging.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for (Warning warning : ExtensionList.lookupSingleton(UpdateSiteWarningsMonitor.class).getActivePluginWarningsByPlugin().getOrDefault(installed, Collections.emptyList())) {\n          \n          \n            \n                        List<Warning> activePluginWarnings = ExtensionList.lookupSingleton(UpdateSiteWarningsMonitor.class).getActivePluginWarningsByPlugin().getOrDefault(installed, Collections.emptyList())\n          \n          \n            \n                        for (Warning warning : activePluginWarnings) {", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r383913753", "createdAt": "2020-02-25T14:31:01Z", "author": {"login": "Wadeck"}, "path": "core/src/main/java/hudson/model/UpdateSite.java", "diffHunk": "@@ -1276,6 +1277,32 @@ public boolean isNeededDependenciesCompatibleWithInstalledVersion(PluginManager.\n             return getDependenciesIncompatibleWithInstalledVersion(cache).isEmpty();\n         }\n \n+        /**\n+         * Returns true if and only if this update addressed a currently active security vulnerability.\n+         *\n+         * @return true if and only if this update addressed a currently active security vulnerability.\n+         */\n+        @Restricted(NoExternalUse.class) // Jelly\n+        public boolean fixesSecurityVulnerabilities() {\n+            final PluginWrapper installed = getInstalled();\n+            if (installed == null) {\n+                return false;\n+            }\n+            boolean allWarningsStillApply = true;\n+            for (Warning warning : ExtensionList.lookupSingleton(UpdateSiteWarningsMonitor.class).getActivePluginWarningsByPlugin().getOrDefault(installed, Collections.emptyList())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzkxNTkzMg==", "bodyText": "NIT: Not used to such naming convention. I generally expect method starting with an action verb to do something. In this case if I call this method I expect it to fix the vulnerabilities.\n\ud83d\udca1 containsSecurityVulnerabilitiesFixes ?", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r383915932", "createdAt": "2020-02-25T14:34:50Z", "author": {"login": "Wadeck"}, "path": "core/src/main/java/hudson/model/UpdateSite.java", "diffHunk": "@@ -1276,6 +1277,32 @@ public boolean isNeededDependenciesCompatibleWithInstalledVersion(PluginManager.\n             return getDependenciesIncompatibleWithInstalledVersion(cache).isEmpty();\n         }\n \n+        /**\n+         * Returns true if and only if this update addressed a currently active security vulnerability.\n+         *\n+         * @return true if and only if this update addressed a currently active security vulnerability.\n+         */\n+        @Restricted(NoExternalUse.class) // Jelly\n+        public boolean fixesSecurityVulnerabilities() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODM3Nzk3", "url": "https://github.com/jenkinsci/jenkins/pull/4513#pullrequestreview-364837797", "createdAt": "2020-02-26T11:54:13Z", "commit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1NDoxM1rOFuotuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1NTo0MlrOFuowSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTg4MQ==", "bodyText": "Not a problem while restricted", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r384445881", "createdAt": "2020-02-26T11:54:13Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/java/hudson/model/UpdateSite.java", "diffHunk": "@@ -1276,6 +1277,32 @@ public boolean isNeededDependenciesCompatibleWithInstalledVersion(PluginManager.\n             return getDependenciesIncompatibleWithInstalledVersion(cache).isEmpty();\n         }\n \n+        /**\n+         * Returns true if and only if this update addressed a currently active security vulnerability.\n+         *\n+         * @return true if and only if this update addressed a currently active security vulnerability.\n+         */\n+        @Restricted(NoExternalUse.class) // Jelly\n+        public boolean fixesSecurityVulnerabilities() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzkxNTkzMg=="}, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NjUzOQ==", "bodyText": "Agreed. \"affecting\" may imply that we know that the instance is affected, but in fact we don't. Some vulns may be a problem only in particular configurations", "url": "https://github.com/jenkinsci/jenkins/pull/4513#discussion_r384446539", "createdAt": "2020-02-26T11:55:42Z", "author": {"login": "oleg-nenashev"}, "path": "core/src/main/resources/hudson/PluginManager/table.jelly", "diffHunk": "@@ -119,6 +119,9 @@ THE SOFTWARE.\n                       <j:if test=\"${p.isForNewerJava()}\">\n                         <div class=\"alert alert-danger\">${%javaWarning(p.minimumJavaVersion)}</div>\n                       </j:if>\n+                      <j:if test=\"${p.fixesSecurityVulnerabilities()}\">\n+                        <div class=\"alert alert-warning\">${%Applying this update will address security vulnerabilities currently affecting Jenkins.}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUwMjAxOQ=="}, "originalCommit": {"oid": "9ec7a736ef1675442305c0fe19258dffcd450108"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56cf4960590c28f604ec5bb5e8d3a7014874bd0b", "author": {"user": {"login": "daniel-beck", "name": "Daniel Beck"}}, "url": "https://github.com/jenkinsci/jenkins/commit/56cf4960590c28f604ec5bb5e8d3a7014874bd0b", "committedDate": "2020-03-03T04:44:37Z", "message": "Fix message wording"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1597, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}