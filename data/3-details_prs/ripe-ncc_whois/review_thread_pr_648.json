{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNjQ4OTk3", "number": 648, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1MjozN1rOEU_D5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMzowNDowM1rOEU_Vaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDQwMTY3OnYy", "diffSide": "RIGHT", "path": "whois-api/src/main/java/net/ripe/db/whois/api/rdap/WhoisRdapServletDeployer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1MjozN1rOG7e-9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1MjozN1rOG7e-9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAyNjgwNw==", "bodyText": "Remove setting ALLOWED_ORIGINS_PARAM if \"*\" already the default", "url": "https://github.com/RIPE-NCC/whois/pull/648#discussion_r465026807", "createdAt": "2020-08-04T12:52:37Z", "author": {"login": "eshryane"}, "path": "whois-api/src/main/java/net/ripe/db/whois/api/rdap/WhoisRdapServletDeployer.java", "diffHunk": "@@ -33,7 +35,10 @@ public void deploy(final WebAppContext context) {\n         rdapJsonProvider.configure(SerializationFeature.INDENT_OUTPUT, true);\n \n         // allow cross-origin requests from ANY origin (by default)\n-        context.addFilter(org.eclipse.jetty.servlets.CrossOriginFilter.class, \"/rdap/*\", EnumSet.allOf(DispatcherType.class));\n+        final FilterHolder crossOriginFilterHolder = context.addFilter(org.eclipse.jetty.servlets.CrossOriginFilter.class, \"/rdap/*\", EnumSet.allOf(DispatcherType.class));\n+        crossOriginFilterHolder.setInitParameter(CrossOriginFilter.ALLOW_CREDENTIALS_PARAM, \"false\");\n+        crossOriginFilterHolder.setInitParameter(CrossOriginFilter.ALLOWED_METHODS_PARAM, \"GET, OPTIONS\");\n+        crossOriginFilterHolder.setInitParameter(CrossOriginFilter.ALLOWED_ORIGINS_PARAM, \"*\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e154f55e7e9673fd9daca62fe9054ba3b6b57b"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDQwNzUxOnYy", "diffSide": "RIGHT", "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1NDowN1rOG7fCjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1NDowN1rOG7fCjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAyNzcyNw==", "bodyText": "Can you use the same pattern as the other tests, i.e.\nassertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS), is(nullValue());", "url": "https://github.com/RIPE-NCC/whois/pull/648#discussion_r465027727", "createdAt": "2020-08-04T12:54:07Z", "author": {"login": "eshryane"}, "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "diffHunk": "@@ -1778,7 +1779,7 @@ public void cross_origin_preflight_request_from_apps_db_ripe_net_is_allowed() {\n                 .options();\n \n         assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN), is(\"https://apps.db.ripe.net\"));\n-        assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS), is(\"true\"));\n+        assertNull(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e154f55e7e9673fd9daca62fe9054ba3b6b57b"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDQxMDEzOnYy", "diffSide": "RIGHT", "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1NDo0MVrOG7fEEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMjo1NDo0MVrOG7fEEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAyODExNA==", "bodyText": "Use assertThat.. nullValue() rather than assertNull", "url": "https://github.com/RIPE-NCC/whois/pull/648#discussion_r465028114", "createdAt": "2020-08-04T12:54:41Z", "author": {"login": "eshryane"}, "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "diffHunk": "@@ -1790,7 +1791,7 @@ public void cross_origin_preflight_request_from_outside_ripe_net_is_allowed() {\n                 .options();\n \n         assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN), is(\"http://www.foo.net\"));\n-        assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS), is(\"true\"));\n+        assertNull(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e154f55e7e9673fd9daca62fe9054ba3b6b57b"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDQ0NjUxOnYy", "diffSide": "RIGHT", "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMzowNDowM1rOG7fatg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMzowNDowM1rOG7fatg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAzMzkxMA==", "bodyText": "N.B. I changed this test method as POST is not allowed", "url": "https://github.com/RIPE-NCC/whois/pull/648#discussion_r465033910", "createdAt": "2020-08-04T13:04:03Z", "author": {"login": "eshryane"}, "path": "whois-api/src/test/java/net/ripe/db/whois/api/rdap/WhoisRdapServiceTestIntegration.java", "diffHunk": "@@ -1790,20 +1792,49 @@ public void cross_origin_preflight_request_from_outside_ripe_net_is_allowed() {\n                 .options();\n \n         assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN), is(\"http://www.foo.net\"));\n-        assertThat(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS), is(\"true\"));\n+        assertNull(response.getHeaderString(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS));\n     }\n \n     @Test\n-    public void cross_origin_preflight_post_request_from_outside_ripe_net_is_allowed() {\n+    public void cross_origin_preflight_post_request_from_outside_ripe_net_is_not_allowed() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f06efd931bb98d2be88965e3430a576e369caf3a"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4654, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}