{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MzQwMTE3", "number": 635, "title": "Optimised finding first managed resource.", "bodyText": "", "createdAt": "2020-05-28T08:45:09Z", "url": "https://github.com/RIPE-NCC/whois/pull/635", "merged": true, "mergeCommit": {"oid": "d9bf2746fd9715ddc678c117dd16882353737905"}, "closed": true, "closedAt": "2020-06-08T11:08:09Z", "author": {"login": "sbusk"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclplq4AH2gAyNDI0MzQwMTE3OjIxNDJiYzJmMjRmZWJiYWZlNmY4NjVmYTI5M2Q4MDMzYmVhODdiMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpNI9qAH2gAyNDI0MzQwMTE3OjE1ZjI1MjE1ZDE1MjVhMjIzYmQwY2RmNDA4Nzg5MWQxYWI0Yzk3Y2I=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2142bc2f24febbafe6f865fa293d8033bea87b12", "author": {"user": {"login": "sbusk", "name": null}}, "url": "https://github.com/RIPE-NCC/whois/commit/2142bc2f24febbafe6f865fa293d8033bea87b12", "committedDate": "2020-05-28T08:28:32Z", "message": "Optimised finding first managed resource."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNzE5MDcw", "url": "https://github.com/RIPE-NCC/whois/pull/635#pullrequestreview-420719070", "createdAt": "2020-05-29T07:37:10Z", "commit": {"oid": "2142bc2f24febbafe6f865fa293d8033bea87b12"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzozNzoxMFrOGcR-Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzozODo0M1rOGcSA4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjMwNzcxNA==", "bodyText": "Uppercase SQL keywords for readibility (and consistency)", "url": "https://github.com/RIPE-NCC/whois/pull/635#discussion_r432307714", "createdAt": "2020-05-29T07:37:10Z", "author": {"login": "eshryane"}, "path": "whois-commons/src/main/java/net/ripe/db/whois/common/dao/jdbc/JdbcManagedAttributeDao.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package net.ripe.db.whois.common.dao.jdbc;\n+\n+import net.ripe.db.whois.common.aspects.RetryFor;\n+import net.ripe.db.whois.common.dao.jdbc.domain.ObjectTypeIds;\n+import net.ripe.db.whois.common.domain.CIString;\n+import net.ripe.db.whois.common.domain.Maintainers;\n+import net.ripe.db.whois.common.rpsl.AttributeType;\n+import net.ripe.db.whois.common.rpsl.ObjectType;\n+import net.ripe.db.whois.common.rpsl.RpslObject;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.beans.factory.annotation.Qualifier;\n+import org.springframework.dao.RecoverableDataAccessException;\n+import org.springframework.jdbc.core.JdbcTemplate;\n+import org.springframework.stereotype.Repository;\n+\n+import javax.sql.DataSource;\n+\n+import static net.ripe.db.whois.common.dao.jdbc.JdbcStreamingHelper.executeStreaming;\n+\n+@Repository\n+@RetryFor(RecoverableDataAccessException.class)\n+public class JdbcManagedAttributeDao {\n+\n+    private final JdbcTemplate jdbcTemplate;\n+    private final Maintainers maintainers;\n+\n+    @Autowired\n+    public JdbcManagedAttributeDao(@Qualifier(\"whoisSlaveDataSource\") final DataSource dataSource,\n+                                   final Maintainers maintainers) {\n+        this.jdbcTemplate = new JdbcTemplate(dataSource);\n+        this.maintainers = maintainers;\n+    }\n+\n+    public boolean hasManagedResource(final CIString orgId) {\n+        final int orgObjectId = jdbcTemplate.queryForObject(\n+            \"select object_id from organisation where organisation = ?\",\n+                new Object[] { orgId },\n+                Integer.class\n+        );\n+\n+        return executeStreaming(\n+                jdbcTemplate,\n+                \"select l.object \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2142bc2f24febbafe6f865fa293d8033bea87b12"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjMwODQ1MQ==", "bodyText": "Inconsistent imports (some fields are imported, some are not)", "url": "https://github.com/RIPE-NCC/whois/pull/635#discussion_r432308451", "createdAt": "2020-05-29T07:38:43Z", "author": {"login": "eshryane"}, "path": "whois-api/src/main/java/net/ripe/db/whois/api/rest/search/ManagedAttributeSearch.java", "diffHunk": "@@ -17,24 +16,25 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.dao.DataAccessException;\n import org.springframework.stereotype.Component;\n \n import javax.annotation.Nullable;\n-import java.util.Optional;\n-import java.util.stream.Stream;\n+\n+import static net.ripe.db.whois.common.rpsl.AttributeType.ORG;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2142bc2f24febbafe6f865fa293d8033bea87b12"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15f25215d1525a223bd0cdf4087891d1ab4c97cb", "author": {"user": {"login": "sbusk", "name": null}}, "url": "https://github.com/RIPE-NCC/whois/commit/15f25215d1525a223bd0cdf4087891d1ab4c97cb", "committedDate": "2020-06-08T09:35:32Z", "message": "Tidy up code so it is in line with existing conventions."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 761, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}