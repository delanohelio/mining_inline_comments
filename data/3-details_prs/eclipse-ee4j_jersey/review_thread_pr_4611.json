{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzMjEzNDQ3", "number": 4611, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxMTo1NVrOEwPVXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTowMToxMFrOEw5ypw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MDE4MzMyOnYy", "diffSide": "RIGHT", "path": "tests/e2e-core-common/src/test/java/org/glassfish/jersey/tests/e2e/common/TestExternalProperties.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxMTo1NVrOHlrEoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxMTo1NVrOHlrEoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2NTA1Nw==", "bodyText": "new Server(PROXY_PORT)", "url": "https://github.com/eclipse-ee4j/jersey/pull/4611#discussion_r509265057", "createdAt": "2020-10-21T13:11:55Z", "author": {"login": "jansupol"}, "path": "tests/e2e-core-common/src/test/java/org/glassfish/jersey/tests/e2e/common/TestExternalProperties.java", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Oracle and/or its affiliates. All rights reserved.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License v. 2.0, which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ *\n+ * This Source Code may also be made available under the following Secondary\n+ * Licenses when the conditions for such availability set forth in the\n+ * Eclipse Public License v. 2.0 are satisfied: GNU General Public License,\n+ * version 2 with the GNU Classpath Exception, which is available at\n+ * https://www.gnu.org/software/classpath/license.html.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n+ */\n+\n+package org.glassfish.jersey.tests.e2e.common;\n+\n+import org.eclipse.jetty.server.Request;\n+import org.eclipse.jetty.server.Server;\n+import org.eclipse.jetty.server.handler.AbstractHandler;\n+import org.glassfish.jersey.ExternalProperties;\n+import org.glassfish.jersey.server.ResourceConfig;\n+import org.glassfish.jersey.test.JerseyTest;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.core.Application;\n+import javax.ws.rs.core.Response;\n+\n+public class TestExternalProperties extends JerseyTest {\n+\n+    private static final String PROXY_HOST = \"localhost\";\n+    private static final String PROXY_PORT = \"9997\";\n+    private static boolean proxyHit = false;\n+\n+    @Path(\"resource\")\n+    public static class ProxyTestResource {\n+\n+        @GET\n+        public String getOK() {\n+            return \"OK\";\n+        }\n+\n+    }\n+\n+    @Override\n+    protected Application configure() {\n+        return new ResourceConfig(ProxyTestResource.class);\n+    }\n+\n+    @Test\n+    public void testProxy() {\n+        startFakeProxy();\n+\n+        System.setProperty(ExternalProperties.HTTP_PROXY_HOST, PROXY_HOST);\n+        System.setProperty(ExternalProperties.HTTP_PROXY_PORT, PROXY_PORT);\n+        System.setProperty(ExternalProperties.HTTP_NON_PROXY_HOSTS, \"\");\n+\n+        Response response = target(\"resource\").request().get();\n+\n+        Assert.assertEquals(407, response.getStatus());\n+    }\n+\n+    @Test\n+    public void testNonProxy() {\n+        startFakeProxy();\n+\n+        System.setProperty(ExternalProperties.HTTP_PROXY_HOST, PROXY_HOST);\n+        System.setProperty(ExternalProperties.HTTP_PROXY_PORT, PROXY_PORT);\n+        System.setProperty(ExternalProperties.HTTP_NON_PROXY_HOSTS, \"localhost\");\n+\n+        Response response = target(\"resource\").request().get();\n+\n+        Assert.assertEquals(200, response.getStatus());\n+        Assert.assertEquals(\"OK\", response.readEntity(String.class));\n+        Assert.assertFalse(proxyHit);\n+    }\n+\n+    private void startFakeProxy() {\n+        Server server = new Server(9997);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d8030e5f2ee8a8a5a0eec37f7e0b6c96dc7653b"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MDIwOTA5OnYy", "diffSide": "RIGHT", "path": "tests/e2e-core-common/pom.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxNzowNVrOHlrUiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxNzowNVrOHlrUiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2OTEyOQ==", "bodyText": "Please create new proxy submodule in tests\\integration\\externalproperties\nand put the test there. Hopefully, more external properties would appear there", "url": "https://github.com/eclipse-ee4j/jersey/pull/4611#discussion_r509269129", "createdAt": "2020-10-21T13:17:05Z", "author": {"login": "jansupol"}, "path": "tests/e2e-core-common/pom.xml", "diffHunk": "@@ -43,6 +43,11 @@\n             <artifactId>junit</artifactId>\n             <scope>test</scope>\n         </dependency>\n+        <dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d8030e5f2ee8a8a5a0eec37f7e0b6c96dc7653b"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NzEzOTU5OnYy", "diffSide": "RIGHT", "path": "tests/integration/externalproperties/src/test/java/org/glassfish/jersey/tests/externalproperties/HttpProxyTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTowMToxMFrOHmvuew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMjozNjo0MVrOHnL_VA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM4OTg4Mw==", "bodyText": "why not to put those 2 properties to @Before method as well?\nSystem.setProperty(ExternalProperties.HTTP_PROXY_HOST, PROXY_HOST);\nSystem.setProperty(ExternalProperties.HTTP_PROXY_PORT, PROXY_PORT);", "url": "https://github.com/eclipse-ee4j/jersey/pull/4611#discussion_r510389883", "createdAt": "2020-10-22T19:01:10Z", "author": {"login": "senivam"}, "path": "tests/integration/externalproperties/src/test/java/org/glassfish/jersey/tests/externalproperties/HttpProxyTest.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2020 Oracle and/or its affiliates. All rights reserved.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License v. 2.0, which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ *\n+ * This Source Code may also be made available under the following Secondary\n+ * Licenses when the conditions for such availability set forth in the\n+ * Eclipse Public License v. 2.0 are satisfied: GNU General Public License,\n+ * version 2 with the GNU Classpath Exception, which is available at\n+ * https://www.gnu.org/software/classpath/license.html.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n+ */\n+\n+package org.glassfish.jersey.tests.externalproperties;\n+\n+import org.eclipse.jetty.server.Request;\n+import org.eclipse.jetty.server.Server;\n+import org.eclipse.jetty.server.handler.AbstractHandler;\n+import org.glassfish.jersey.ExternalProperties;\n+import org.glassfish.jersey.server.ResourceConfig;\n+import org.glassfish.jersey.test.JerseyTest;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.core.Application;\n+import javax.ws.rs.core.Response;\n+\n+public class HttpProxyTest extends JerseyTest {\n+\n+    private static final String PROXY_HOST = \"localhost\";\n+    private static final String PROXY_PORT = \"9997\";\n+    private static boolean proxyHit = false;\n+\n+    @Path(\"resource\")\n+    public static class ProxyTestResource {\n+\n+        @GET\n+        public String getOK() {\n+            return \"OK\";\n+        }\n+\n+    }\n+\n+    @Override\n+    protected Application configure() {\n+        return new ResourceConfig(ProxyTestResource.class);\n+    }\n+\n+    @Before\n+    public void startFakeProxy() {\n+        Server server = new Server(Integer.parseInt(PROXY_PORT));\n+        server.setHandler(new ProxyHandler(false));\n+        try {\n+            server.start();\n+        } catch (Exception e) {\n+\n+        }\n+    }\n+\n+    @Test\n+    public void testProxy() {\n+        System.setProperty(ExternalProperties.HTTP_PROXY_HOST, PROXY_HOST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b30f63eb315efc399174fc501fd03acc6d2eb1f"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg1Mjk0OA==", "bodyText": "I think it makes sense !", "url": "https://github.com/eclipse-ee4j/jersey/pull/4611#discussion_r510852948", "createdAt": "2020-10-23T12:36:41Z", "author": {"login": "tvallin"}, "path": "tests/integration/externalproperties/src/test/java/org/glassfish/jersey/tests/externalproperties/HttpProxyTest.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2020 Oracle and/or its affiliates. All rights reserved.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License v. 2.0, which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ *\n+ * This Source Code may also be made available under the following Secondary\n+ * Licenses when the conditions for such availability set forth in the\n+ * Eclipse Public License v. 2.0 are satisfied: GNU General Public License,\n+ * version 2 with the GNU Classpath Exception, which is available at\n+ * https://www.gnu.org/software/classpath/license.html.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n+ */\n+\n+package org.glassfish.jersey.tests.externalproperties;\n+\n+import org.eclipse.jetty.server.Request;\n+import org.eclipse.jetty.server.Server;\n+import org.eclipse.jetty.server.handler.AbstractHandler;\n+import org.glassfish.jersey.ExternalProperties;\n+import org.glassfish.jersey.server.ResourceConfig;\n+import org.glassfish.jersey.test.JerseyTest;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.core.Application;\n+import javax.ws.rs.core.Response;\n+\n+public class HttpProxyTest extends JerseyTest {\n+\n+    private static final String PROXY_HOST = \"localhost\";\n+    private static final String PROXY_PORT = \"9997\";\n+    private static boolean proxyHit = false;\n+\n+    @Path(\"resource\")\n+    public static class ProxyTestResource {\n+\n+        @GET\n+        public String getOK() {\n+            return \"OK\";\n+        }\n+\n+    }\n+\n+    @Override\n+    protected Application configure() {\n+        return new ResourceConfig(ProxyTestResource.class);\n+    }\n+\n+    @Before\n+    public void startFakeProxy() {\n+        Server server = new Server(Integer.parseInt(PROXY_PORT));\n+        server.setHandler(new ProxyHandler(false));\n+        try {\n+            server.start();\n+        } catch (Exception e) {\n+\n+        }\n+    }\n+\n+    @Test\n+    public void testProxy() {\n+        System.setProperty(ExternalProperties.HTTP_PROXY_HOST, PROXY_HOST);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM4OTg4Mw=="}, "originalCommit": {"oid": "1b30f63eb315efc399174fc501fd03acc6d2eb1f"}, "originalPosition": 70}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1296, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}