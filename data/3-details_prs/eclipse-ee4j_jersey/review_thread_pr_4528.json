{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTc3ODMz", "number": 4528, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowMTozNVrOEQo0qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDoyNzo0OVrOEReZrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODgxNTEyOnYy", "diffSide": "RIGHT", "path": "connectors/jdk-connector/src/main/java/org/glassfish/jersey/jdk/connector/internal/SslFilter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowMTozNVrOG05dXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxMDozMjoxNVrOG1cljg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyMDU0Mg==", "bodyText": "I would advice to move direct text into localization.properties and use LocalizableMessageFactory instead.", "url": "https://github.com/eclipse-ee4j/jersey/pull/4528#discussion_r458120542", "createdAt": "2020-07-21T14:01:35Z", "author": {"login": "senivam"}, "path": "connectors/jdk-connector/src/main/java/org/glassfish/jersey/jdk/connector/internal/SslFilter.java", "diffHunk": "@@ -416,12 +419,8 @@ private boolean doHandshakeStep(ByteBuffer networkData) {\n                         }\n \n                         case FINISHED: {\n-                            /* According to SSLEngine javadoc FINISHED status can be returned only in SSLEngineResult,\n-                            but just to make sure we don't end up in an infinite loop when presented with an SSLEngine\n-                            implementation that does not respect this:*/\n-                            stepFinished = true;\n-                            handshakeFinished = true;\n-                            break;\n+                            throw new IllegalStateException(\"Trying to handshake, but SSL engine not in HANDSHAKING state.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd38a37d5ae4ec06be8beb625c2576fb1466d34"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY3NDUxNg==", "bodyText": "@senivam although that is unreachable (in theory), I decided to keep it as it was. It will not throw exception.\nI added the localization property for the case of NOT_HANDSHAKING, because it was throwing the same exception.\nI also modified the test to force to test all supported SSL protocols. For the case of JDK11 the TLSv13 is included.", "url": "https://github.com/eclipse-ee4j/jersey/pull/4528#discussion_r458674516", "createdAt": "2020-07-22T09:52:22Z", "author": {"login": "jbescos"}, "path": "connectors/jdk-connector/src/main/java/org/glassfish/jersey/jdk/connector/internal/SslFilter.java", "diffHunk": "@@ -416,12 +419,8 @@ private boolean doHandshakeStep(ByteBuffer networkData) {\n                         }\n \n                         case FINISHED: {\n-                            /* According to SSLEngine javadoc FINISHED status can be returned only in SSLEngineResult,\n-                            but just to make sure we don't end up in an infinite loop when presented with an SSLEngine\n-                            implementation that does not respect this:*/\n-                            stepFinished = true;\n-                            handshakeFinished = true;\n-                            break;\n+                            throw new IllegalStateException(\"Trying to handshake, but SSL engine not in HANDSHAKING state.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyMDU0Mg=="}, "originalCommit": {"oid": "8cd38a37d5ae4ec06be8beb625c2576fb1466d34"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY5NjA3OA==", "bodyText": "I just verified with Wireshark that we need to execute the tests in different JVMs. So I had to set <reuseForks>false</reuseForks> and move each protocol to a different test class. It seems when you use @Parametrized tests are executed in the same JVM.", "url": "https://github.com/eclipse-ee4j/jersey/pull/4528#discussion_r458696078", "createdAt": "2020-07-22T10:32:15Z", "author": {"login": "jbescos"}, "path": "connectors/jdk-connector/src/main/java/org/glassfish/jersey/jdk/connector/internal/SslFilter.java", "diffHunk": "@@ -416,12 +419,8 @@ private boolean doHandshakeStep(ByteBuffer networkData) {\n                         }\n \n                         case FINISHED: {\n-                            /* According to SSLEngine javadoc FINISHED status can be returned only in SSLEngineResult,\n-                            but just to make sure we don't end up in an infinite loop when presented with an SSLEngine\n-                            implementation that does not respect this:*/\n-                            stepFinished = true;\n-                            handshakeFinished = true;\n-                            break;\n+                            throw new IllegalStateException(\"Trying to handshake, but SSL engine not in HANDSHAKING state.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyMDU0Mg=="}, "originalCommit": {"oid": "8cd38a37d5ae4ec06be8beb625c2576fb1466d34"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NzU5MzQwOnYy", "diffSide": "RIGHT", "path": "connectors/jdk-connector/src/main/resources/org/glassfish/jersey/jdk/connector/internal/localization.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDoyNzo0OVrOG2NJSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDoyNzo0OVrOG2NJSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ5MTY1OA==", "bodyText": "please consider updating of copyright year in this file.", "url": "https://github.com/eclipse-ee4j/jersey/pull/4528#discussion_r459491658", "createdAt": "2020-07-23T14:27:49Z", "author": {"login": "senivam"}, "path": "connectors/jdk-connector/src/main/resources/org/glassfish/jersey/jdk/connector/internal/localization.properties", "diffHunk": "@@ -71,3 +71,4 @@ thread.pool.core.size.too.small=\"Core thread pool size cannot be smaller than 0.\n http.connection.establishing.illegal.state=\"Cannot try to establish connection if the connection is in other than CREATED state\\\n   . Current state: {0}.\n http.connection.not.idle=\"Http request cannot be sent over a connection that is in other state than IDLE. Current state: {0}\" \n+http.connection.invalid.handshake.status=\"Trying to handshake, but SSL engine not in HANDSHAKING state. SSL filter state: {0}\" ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca67208c3a83644fce40fe84f07b69603a8acb09"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1346, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}