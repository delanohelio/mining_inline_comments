{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNTQ0MzY4", "number": 1205, "title": "Elide 5.x elide-async integration in elide-standalone", "bodyText": "Co-authored-by: Abhino\nDepends on: #1203\nDescription\n\nIntegrating with elide-async.\nChanges to the methods in Util class to combine the Async models with package models.\nBinds AsyncExecutor Service when Async is enabled.\nAdds the Async models to Swagger if Async and Swagger are enabled. The Async models are available on /swagger/doc/async path\nAdditional methods added to ElideStandaloneSettings.java for configuring the Async Feature like enable/disable, number of threads for executing the async queries in parallel, the maximum run time for individual threads before they are automatically killed, number of instances hosting the elide service in parallel (to avoid all hosts trying to update status of orphan queries in parallel).\n\nMotivation and Context\nTo allow submission of queries that will be executed asynchronously.\nHow Has This Been Tested?\n\nUsed elide-standalone-example with the updated version of the elide-standalone artifact and verify query submissions and executions.\n\nScreenshots (if appropriate):\nNA\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-02-26T22:41:56Z", "url": "https://github.com/yahoo/elide/pull/1205", "merged": true, "mergeCommit": {"oid": "70038d5a065c54556906c736ca9125784be81e76"}, "closed": true, "closedAt": "2020-03-26T19:24:05Z", "author": {"login": "moizarafat"}, "timelineItems": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIOYfjAH2gAyMzgwNTQ0MzY4OjRmZGEyZTljMjI0ZWNlMmQ5OTEyYWY3NzA2YTVkMDIxNTAyN2MyNTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRhM4gAFqTM4MjM0MTgzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4fda2e9c224ece2d9912af7706a5d0215027c250", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/4fda2e9c224ece2d9912af7706a5d0215027c250", "committedDate": "2020-02-26T22:22:54Z", "message": "Integrating elide-async.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3468a01d366b891e8b568894ae697ecb9f669225", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/3468a01d366b891e8b568894ae697ecb9f669225", "committedDate": "2020-02-27T15:51:46Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/5a15ded7ff2f761b8d916065d9b689edfa5fc88a", "committedDate": "2020-02-27T15:52:13Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODYwNTM0", "url": "https://github.com/yahoo/elide/pull/1205#pullrequestreview-365860534", "createdAt": "2020-02-27T17:34:44Z", "commit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzozNDo0NVrOFvanJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzozNDo0NVrOFvanJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2MzM5OQ==", "bodyText": "I don't think we need this.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385263399", "createdAt": "2020-02-27T17:34:45Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -179,6 +195,42 @@ default boolean enableJSONAPI() {\n     default boolean enableGraphQL() {\n         return true;\n     }\n+    \n+    /**\n+     * Enable the support for Async querying feature. If false, the async feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsync() {\n+        return false;\n+    }\n+\n+    /**\n+     * Thread Size for Async queries to run in parallel.\n+     *\n+     * @return Default: 5\n+     */\n+    default Integer getAsyncThreadSize() {\n+        return 5;\n+    }\n+\n+    /**\n+     * Maximum Query Run time for Async Queries to mark as TIMEDOUT.\n+     *\n+     * @return Default: 60\n+     */\n+    default Integer getMaxRunTime() {\n+        return 60;\n+    }\n+\n+    /**\n+     * Number of hosts running Elide Service.\n+     *\n+     * @return Default: 1\n+     */\n+    default Integer getNumberOfHosts() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODYwOTE5", "url": "https://github.com/yahoo/elide/pull/1205#pullrequestreview-365860919", "createdAt": "2020-02-27T17:35:22Z", "commit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzozNToyMlrOFvaoUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzo0MzowN1rOFva4fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2MzY5OA==", "bodyText": "See comments I Had on Spring in general.  Settings that involve time should have units in their name.  We need two time settings (timeout and delete).", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385263698", "createdAt": "2020-02-27T17:35:22Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -179,6 +195,42 @@ default boolean enableJSONAPI() {\n     default boolean enableGraphQL() {\n         return true;\n     }\n+    \n+    /**\n+     * Enable the support for Async querying feature. If false, the async feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsync() {\n+        return false;\n+    }\n+\n+    /**\n+     * Thread Size for Async queries to run in parallel.\n+     *\n+     * @return Default: 5\n+     */\n+    default Integer getAsyncThreadSize() {\n+        return 5;\n+    }\n+\n+    /**\n+     * Maximum Query Run time for Async Queries to mark as TIMEDOUT.\n+     *\n+     * @return Default: 60\n+     */\n+    default Integer getMaxRunTime() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2MzkyNg==", "bodyText": "We don't need a setting for this.  The package name is fixed (by us).", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385263926", "createdAt": "2020-02-27T17:35:49Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -131,6 +132,21 @@ default int getPort() {\n     default String getModelPackageName() {\n         return \"com.yourcompany.elide.models\";\n     }\n+    \n+    /**\n+     * Package name containing the Async models to support the Async query feature. This package will be \n+     * recursively scanned for @Entity's and registered with Elide.\n+     *\n+     * NOTE: This will scan for all entities in that package and bind this data to a set named \"elideAllModels\".\n+     *       If providing a custom ElideSettings object, you can inject this data into your class by using:\n+     *\n+     *       <strong>@Inject @Named(\"elideAllModels\") Set&lt;Class&gt; entities;</strong>\n+     *\n+     * @return\n+     */\n+    default String getAsyncModelPackageName() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2NTMxMQ==", "bodyText": "Instead of passing the package name for async here (which Elide already knows), you could just pass a flag about whether or not to include async models.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385265311", "createdAt": "2020-02-27T17:38:24Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/Util.java", "diffHunk": "@@ -23,7 +23,8 @@\n  */\n public class Util {\n \n-    public static EntityManagerFactory getEntityManagerFactory(String modelPackageName, Properties options) {\n+    public static EntityManagerFactory getEntityManagerFactory(String modelPackageName, String asyncModelPackageName, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2NjMzOQ==", "bodyText": "asyncModelPackageName can just be AsyncQuery.class.getPackage().getName()", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385266339", "createdAt": "2020-02-27T17:40:20Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/Util.java", "diffHunk": "@@ -52,13 +53,31 @@ public static EntityManagerFactory getEntityManagerFactory(String modelPackageNa\n         }\n \n         PersistenceUnitInfo persistenceUnitInfo = new PersistenceUnitInfoImpl(\"elide-stand-alone\",\n-                getAllEntities(modelPackageName), options);\n+                combineModelEntities(modelPackageName, asyncModelPackageName), options);\n \n         return new EntityManagerFactoryBuilderImpl(\n                 new PersistenceUnitInfoDescriptor(persistenceUnitInfo), new HashMap<>())\n                 .build();\n     }\n \n+    /**\n+     * Combine the model entities with Async model.\n+     *\n+     * @param modelPackageName Package name\n+     * @param asyncModelPackageName Async model package Name\n+     * @return All entities combined from both package.\n+     */\n+    public static List<String> combineModelEntities(String modelPackageName, String asyncModelPackageName) {\n+\n+        List<String> modelEntities = getAllEntities(modelPackageName);\n+\n+        if (asyncModelPackageName != null) {\n+            modelEntities.addAll(getAllEntities(asyncModelPackageName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2NzY5NQ==", "bodyText": "See my earlier comment here.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385267695", "createdAt": "2020-02-27T17:42:51Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideResourceConfig.java", "diffHunk": "@@ -58,7 +63,8 @@ public ElideResourceConfig(ServiceLocator injector, @Context ServletContext serv\n         register(new AbstractBinder() {\n             @Override\n             protected void configure() {\n-                bind(Util.getAllEntities(settings.getModelPackageName())).to(Set.class).named(\"elideAllModels\");\n+                bind(Util.combineModelEntities(settings.getModelPackageName(), settings.getAsyncModelPackageName())).to(Set.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI2NzgzOA==", "bodyText": "See my earlier comment here.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r385267838", "createdAt": "2020-02-27T17:43:07Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -64,7 +65,7 @@\n      */\n     default ElideSettings getElideSettings(ServiceLocator injector) {\n         EntityManagerFactory entityManagerFactory = Util.getEntityManagerFactory(getModelPackageName(),\n-                getDatabaseProperties());\n+                getAsyncModelPackageName(), getDatabaseProperties());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a15ded7ff2f761b8d916065d9b689edfa5fc88a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b03e6fd7908a910dd2ffadc0c3be3988ad2065", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/75b03e6fd7908a910dd2ffadc0c3be3988ad2065", "committedDate": "2020-02-27T20:48:57Z", "message": "Integrating elide-async.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a9954ea2d89c51887844187ef3291ba3d81f7ca", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/2a9954ea2d89c51887844187ef3291ba3d81f7ca", "committedDate": "2020-02-27T20:48:57Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d57c68deb6e294992f5c9e0e631e36ab2c2121ef", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/d57c68deb6e294992f5c9e0e631e36ab2c2121ef", "committedDate": "2020-02-27T20:48:57Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a117d0bea40cc84232fb4524a28b40271e77680", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/8a117d0bea40cc84232fb4524a28b40271e77680", "committedDate": "2020-02-27T20:57:23Z", "message": "Resolving review comments.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48fa5f268d8d5c6e075f04418deff0951d972361", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/48fa5f268d8d5c6e075f04418deff0951d972361", "committedDate": "2020-02-27T21:01:08Z", "message": "Resolving review comments.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a65e7bd4f1620e55be7a2df95a99e8aa9d3e8810", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/a65e7bd4f1620e55be7a2df95a99e8aa9d3e8810", "committedDate": "2020-02-27T21:05:24Z", "message": "Resolving review comments.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19a247fa3d8ca46f6e9b850c3eca0a54f1ebed6a", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/19a247fa3d8ca46f6e9b850c3eca0a54f1ebed6a", "committedDate": "2020-03-01T22:00:23Z", "message": "Removing unwanted params.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f6e8b5989ca6304bb2142a3ad7a7dc6cfeb3a5e", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/4f6e8b5989ca6304bb2142a3ad7a7dc6cfeb3a5e", "committedDate": "2020-03-02T19:06:51Z", "message": "Binding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>\n\nBinding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "556220b4b07a2dd6460a92142a892140d2b8cdff", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/556220b4b07a2dd6460a92142a892140d2b8cdff", "committedDate": "2020-03-02T16:36:37Z", "message": "Binding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}, "afterCommit": {"oid": "4f6e8b5989ca6304bb2142a3ad7a7dc6cfeb3a5e", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/4f6e8b5989ca6304bb2142a3ad7a7dc6cfeb3a5e", "committedDate": "2020-03-02T19:06:51Z", "message": "Binding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>\n\nBinding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23b22fb689d48eca5fc5dfcc088a0024d94c9d4e", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/23b22fb689d48eca5fc5dfcc088a0024d94c9d4e", "committedDate": "2020-03-03T01:30:43Z", "message": "Adding query result retention.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "379f545d61fbca5842e756dca2cd08c22ffce0dd", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/379f545d61fbca5842e756dca2cd08c22ffce0dd", "committedDate": "2020-03-05T23:09:41Z", "message": "Integrating elide-async.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8c8f618c7de30db9f2c6abe011f2d5ae668e8d0", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/c8c8f618c7de30db9f2c6abe011f2d5ae668e8d0", "committedDate": "2020-03-05T23:09:41Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e10b88a36b9714a556cf97ed69fb1cfeba18d078", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/e10b88a36b9714a556cf97ed69fb1cfeba18d078", "committedDate": "2020-03-05T23:09:41Z", "message": "Default enableAsync to False.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b10af1fc3b4635d0d02aeb7a3b581ca0bdac06a1", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/b10af1fc3b4635d0d02aeb7a3b581ca0bdac06a1", "committedDate": "2020-03-05T23:10:59Z", "message": "Integrating elide-async.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e05e4575749d34d4ce8ff13e3d9418d4947ac0a6", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/e05e4575749d34d4ce8ff13e3d9418d4947ac0a6", "committedDate": "2020-03-05T23:10:59Z", "message": "Resolving review comments.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f6021bbfc1ca64929fb82bd31cc17468f8902e5", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/0f6021bbfc1ca64929fb82bd31cc17468f8902e5", "committedDate": "2020-03-05T23:10:59Z", "message": "Resolving review comments.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d52b47ad1191fe492874e5ca3dd9c6a0bb96f90", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/2d52b47ad1191fe492874e5ca3dd9c6a0bb96f90", "committedDate": "2020-03-05T23:10:59Z", "message": "Removing unwanted params.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ca38c190efeaaec946099bf60cb3b9396dd3348", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/9ca38c190efeaaec946099bf60cb3b9396dd3348", "committedDate": "2020-03-05T23:10:59Z", "message": "Binding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>\n\nBinding Cleaner service.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d0928e0e114ada10b339134740d43e9afa9f54", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/b6d0928e0e114ada10b339134740d43e9afa9f54", "committedDate": "2020-03-05T23:11:00Z", "message": "Adding query result retention.\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7167d750655d2231788b2a9a1944a273b99bc5aa", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/7167d750655d2231788b2a9a1944a273b99bc5aa", "committedDate": "2020-03-05T23:36:35Z", "message": "Rebase Conflicts\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e1b1824dcb350c6503e252b06fd9ac399b8656e", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/2e1b1824dcb350c6503e252b06fd9ac399b8656e", "committedDate": "2020-03-11T09:55:38Z", "message": "Making AsyncQueryDAO configurable\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/2678b3fb6d869e159b4d038fa825457e15e3ebd3", "committedDate": "2020-03-11T10:02:07Z", "message": "Making AsyncQueryDAO configurable\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMDQ5Mzg1", "url": "https://github.com/yahoo/elide/pull/1205#pullrequestreview-373049385", "createdAt": "2020-03-11T19:11:10Z", "commit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxOToxMToxMVrOF1FDgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxOToxNDo0MFrOF1FKQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwMTY2NA==", "bodyText": "This should be qualified with Async", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r391201664", "createdAt": "2020-03-11T19:11:11Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -167,6 +169,60 @@ default boolean enableJSONAPI() {\n     default boolean enableGraphQL() {\n         return true;\n     }\n+    \n+    /**\n+     * Enable the support for Async querying feature. If false, the async feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsync() {\n+        return false;\n+    }\n+\n+    /**\n+     * Enable the support for cleaning up Async query history. If false, the async cleanup feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsyncCleanup() {\n+        return false;\n+    }\n+\n+    /**\n+     * Thread Size for Async queries to run in parallel.\n+     *\n+     * @return Default: 5\n+     */\n+    default Integer getAsyncThreadSize() {\n+        return 5;\n+    }\n+\n+    /**\n+     * Maximum Query Run time for Async Queries to mark as TIMEDOUT.\n+     *\n+     * @return Default: 60\n+     */\n+    default Integer getMaxRunTimeMinutes() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwMTcyOQ==", "bodyText": "Same comment.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r391201729", "createdAt": "2020-03-11T19:11:20Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -167,6 +169,60 @@ default boolean enableJSONAPI() {\n     default boolean enableGraphQL() {\n         return true;\n     }\n+    \n+    /**\n+     * Enable the support for Async querying feature. If false, the async feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsync() {\n+        return false;\n+    }\n+\n+    /**\n+     * Enable the support for cleaning up Async query history. If false, the async cleanup feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsyncCleanup() {\n+        return false;\n+    }\n+\n+    /**\n+     * Thread Size for Async queries to run in parallel.\n+     *\n+     * @return Default: 5\n+     */\n+    default Integer getAsyncThreadSize() {\n+        return 5;\n+    }\n+\n+    /**\n+     * Maximum Query Run time for Async Queries to mark as TIMEDOUT.\n+     *\n+     * @return Default: 60\n+     */\n+    default Integer getMaxRunTimeMinutes() {\n+        return 60;\n+    }\n+\n+    /**\n+     * Number of days history to retain for async query executions and results.\n+     *\n+     * @return Default: 7\n+     */\n+    default Integer getQueryCleanupDays() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwMjE4OA==", "bodyText": "Instead of resolving this as a setting - this can be injected into the async code (either via lifecycle hook or bean).", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r391202188", "createdAt": "2020-03-11T19:12:18Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -167,6 +169,60 @@ default boolean enableJSONAPI() {\n     default boolean enableGraphQL() {\n         return true;\n     }\n+    \n+    /**\n+     * Enable the support for Async querying feature. If false, the async feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsync() {\n+        return false;\n+    }\n+\n+    /**\n+     * Enable the support for cleaning up Async query history. If false, the async cleanup feature will be disabled.\n+     *\n+     * @return Default: False\n+     */\n+    default boolean enableAsyncCleanup() {\n+        return false;\n+    }\n+\n+    /**\n+     * Thread Size for Async queries to run in parallel.\n+     *\n+     * @return Default: 5\n+     */\n+    default Integer getAsyncThreadSize() {\n+        return 5;\n+    }\n+\n+    /**\n+     * Maximum Query Run time for Async Queries to mark as TIMEDOUT.\n+     *\n+     * @return Default: 60\n+     */\n+    default Integer getMaxRunTimeMinutes() {\n+        return 60;\n+    }\n+\n+    /**\n+     * Number of days history to retain for async query executions and results.\n+     *\n+     * @return Default: 7\n+     */\n+    default Integer getQueryCleanupDays() {\n+        return 7;\n+    }\n+\n+    /**\n+     * Implementation of AsyncQueryDAO to use.\n+     *\n+     * @return AsyncQueryDAO type object.\n+     */\n+    default AsyncQueryDAO getAsyncQueryDAO() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwMjcyMw==", "bodyText": "Most of the other APIs have a config setting for the base path.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r391202723", "createdAt": "2020-03-11T19:13:22Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideResourceConfig.java", "diffHunk": "@@ -85,6 +112,21 @@ protected void configure() {\n             protected void configure() {\n                 Map<String, Swagger> swaggerDocs = settings.enableSwagger();\n                 if (!swaggerDocs.isEmpty()) {\n+                    // Include the async models in swagger docs\n+                    if(settings.enableAsync()) {\n+                        EntityDictionary dictionary = new EntityDictionary(new HashMap());\n+                        dictionary.bindEntity(AsyncQuery.class);\n+                        dictionary.bindEntity(AsyncQueryResult.class);\n+                         \n+                        Info info = new Info().title(\"Async Service\").version(\"1.0\");\n+\n+                        SwaggerBuilder builder = new SwaggerBuilder(dictionary, info);\n+\n+                        Swagger swagger = builder.build().basePath(\"/api/v1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwMzM5Mw==", "bodyText": "Just create the DAO here.  We don't need a setting.  Users can override this function if they want something different.", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r391203393", "createdAt": "2020-03-11T19:14:40Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideResourceConfig.java", "diffHunk": "@@ -76,6 +84,25 @@ protected void configure() {\n                 bind(elideSettings).to(ElideSettings.class);\n                 bind(elideSettings.getDictionary()).to(EntityDictionary.class);\n                 bind(elideSettings.getDataStore()).to(DataStore.class).named(\"elideDataStore\");\n+\n+                // Binding async service\n+                if(settings.enableAsync()) {\n+                    AsyncQueryDAO asyncQueryDao = settings.getAsyncQueryDAO();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2678b3fb6d869e159b4d038fa825457e15e3ebd3"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3826d246d1889353407b70ee8f4014ae17feced", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/c3826d246d1889353407b70ee8f4014ae17feced", "committedDate": "2020-03-12T16:58:40Z", "message": "Review comments\n\nCo-authored-by: Abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6e047db50214412a2199bfa5f43e486782a3874", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/a6e047db50214412a2199bfa5f43e486782a3874", "committedDate": "2020-03-13T14:37:29Z", "message": "Review comments\n\nCo-authored-by: abhino <abhino@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a34233254173fc009f4c3e7661a4e313e7277ef", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/9a34233254173fc009f4c3e7661a4e313e7277ef", "committedDate": "2020-03-15T22:14:34Z", "message": "Changing call to DefaultAsyncQueryDAO"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzA4Nzc1", "url": "https://github.com/yahoo/elide/pull/1205#pullrequestreview-380708775", "createdAt": "2020-03-24T21:26:05Z", "commit": {"oid": "9a34233254173fc009f4c3e7661a4e313e7277ef"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMToyNjowNlrOF7DtAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMToyNjowNlrOF7DtAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQ3MDk3Ng==", "bodyText": "Instead of making this the async swagger path - how about a config setting for swagger in general (including non-asyc models)?", "url": "https://github.com/yahoo/elide/pull/1205#discussion_r397470976", "createdAt": "2020-03-24T21:26:06Z", "author": {"login": "aklish"}, "path": "elide-standalone/src/main/java/com/yahoo/elide/standalone/config/ElideStandaloneSettings.java", "diffHunk": "@@ -211,17 +211,26 @@ default Integer getMaxRunTimeMinutes() {\n      *\n      * @return Default: 7\n      */\n-    default Integer getQueryCleanupDays() {\n+    default Integer getAsyncQueryCleanupDays() {\n         return 7;\n     }\n \n+    /**\n+     *  Root path specification for the Async Models Swagger endpoint.\n+     *\n+     * @return Default: /api/v1\n+     */\n+    default String getAsyncSwaggerPath() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a34233254173fc009f4c3e7661a4e313e7277ef"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cda3ad7c9081650fd5d64fb85fd15df5a84f703", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/5cda3ad7c9081650fd5d64fb85fd15df5a84f703", "committedDate": "2020-03-25T22:20:37Z", "message": "Review comments\n\nCo-authored-by: Abhino <Abhino@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMzQxODMw", "url": "https://github.com/yahoo/elide/pull/1205#pullrequestreview-382341830", "createdAt": "2020-03-26T19:23:44Z", "commit": {"oid": "5cda3ad7c9081650fd5d64fb85fd15df5a84f703"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 648, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}