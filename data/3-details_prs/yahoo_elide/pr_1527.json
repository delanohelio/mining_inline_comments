{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0MTg2MTA0", "number": 1527, "title": "Data export - Refactoring and Prep for using ResultStorageEngine", "bodyText": "Co-authored-by: chandrakaran\nResolves  #1272\nDescription\nRefactoring of existing classes and prep work for using ResultStorageEngine\nMotivation and Context\nRefer #1272\nHow Has This Been Tested?\nExisting Test cases pass and new test cases.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-09-10T18:24:19Z", "url": "https://github.com/yahoo/elide/pull/1527", "merged": true, "mergeCommit": {"oid": "145898e5c0605e41c103c409c1fba9966c966160"}, "closed": true, "closedAt": "2020-09-10T21:34:09Z", "author": {"login": "moizarafat"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHk-IUgH2gAyNDg0MTg2MTA0OjUyNGFlMWYwYWMzZjI5YjE5ZmFmMjM2OWJlMTZhY2U4ZWE5ZjFkNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHl5ZSgH2gAyNDg0MTg2MTA0OjRmMTU0Zjg5MzJjN2Y2OGY2MjRlYWQ0OWM0YTAzNWNhNTJhMWZiMzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "524ae1f0ac3f29b19faf2369be16ace8ea9f1d72", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/524ae1f0ac3f29b19faf2369be16ace8ea9f1d72", "committedDate": "2020-09-10T18:19:09Z", "message": "Refactor and Prep for result storage engine.\n\nCo-authored-by: chandrakaran <chandrakaranreddy.patlolla1@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MjAyODg4", "url": "https://github.com/yahoo/elide/pull/1527#pullrequestreview-486202888", "createdAt": "2020-09-10T18:25:17Z", "commit": {"oid": "524ae1f0ac3f29b19faf2369be16ace8ea9f1d72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxODoyNToxN1rOHQAjjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxODoyNToxN1rOHQAjjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU0ODM2Ng==", "bodyText": "Since AsyncProperties does not have use for path property, removed extends ControllerProperties.", "url": "https://github.com/yahoo/elide/pull/1527#discussion_r486548366", "createdAt": "2020-09-10T18:25:17Z", "author": {"login": "moizarafat"}, "path": "elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/AsyncProperties.java", "diffHunk": "@@ -11,7 +11,7 @@\n  * Extra properties for setting up async query support.\n  */\n @Data\n-public class AsyncProperties extends ControllerProperties {\n+public class AsyncProperties {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "524ae1f0ac3f29b19faf2369be16ace8ea9f1d72"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MjIwMTQx", "url": "https://github.com/yahoo/elide/pull/1527#pullrequestreview-486220141", "createdAt": "2020-09-10T18:50:21Z", "commit": {"oid": "524ae1f0ac3f29b19faf2369be16ace8ea9f1d72"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxODo1MDoyMVrOHQBf0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxODo1MDoyMVrOHQBf0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU2Mzc5NA==", "bodyText": "Since this is a member function, you don't need to pass resultStorageEngine as an argument.  You can get it from the executor service.", "url": "https://github.com/yahoo/elide/pull/1527#discussion_r486563794", "createdAt": "2020-09-10T18:50:21Z", "author": {"login": "aklish"}, "path": "elide-async/src/main/java/com/yahoo/elide/async/hooks/ExecuteQueryHook.java", "diffHunk": "@@ -29,8 +33,32 @@ public ExecuteQueryHook (AsyncExecutorService asyncExecutorService) {\n     @Override\n     public void execute(LifeCycleHookBinding.Operation operation, AsyncQuery query,\n                         RequestScope requestScope, Optional<ChangeSpec> changes) {\n+        validateOptions(query, asyncExecutorService.getResultStorageEngine());\n         if (query.getStatus() == QueryStatus.QUEUED && query.getResult() == null) {\n             asyncExecutorService.executeQuery(query, requestScope.getUser(), requestScope.getApiVersion());\n         }\n     }\n+\n+    /**\n+     * Validate the options provided in AsyncQuery.\n+     * @param query AsyncQuery\n+     * @param resultStorageEngine ResultStorageEngine Implementation.\n+     */\n+    public void validateOptions(AsyncQuery query, ResultStorageEngine resultStorageEngine) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "524ae1f0ac3f29b19faf2369be16ace8ea9f1d72"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57280792d9d1c6ee728efb692b45c79d39389798", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/57280792d9d1c6ee728efb692b45c79d39389798", "committedDate": "2020-09-10T19:14:50Z", "message": "Review comments.\n\nCo-authored-by: chandrakaran <chandrakaranreddy.patlolla1@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MjQyNDg1", "url": "https://github.com/yahoo/elide/pull/1527#pullrequestreview-486242485", "createdAt": "2020-09-10T19:22:22Z", "commit": {"oid": "57280792d9d1c6ee728efb692b45c79d39389798"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f154f8932c7f68f624ead49c4a035ca52a1fb39", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/4f154f8932c7f68f624ead49c4a035ca52a1fb39", "committedDate": "2020-09-10T19:23:53Z", "message": "Review comments.\n\nCo-authored-by: chandrakaran <chandrakaranreddy.patlolla1@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 821, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}