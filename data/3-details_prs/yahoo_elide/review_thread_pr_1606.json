{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3NjY2MjM1", "number": 1606, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowMDo0NFrOEwU16g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxODowODozNlrOEwZXeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MTA4NTg2OnYy", "diffSide": "RIGHT", "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowMDo0NFrOHlz9rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjoyODowNFrOHl1IJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDczMw==", "bodyText": "There is a NO_VERSION constant you can use here. you can use here.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509410733", "createdAt": "2020-10-21T16:00:44Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQyOTc5Nw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509429797", "createdAt": "2020-10-21T16:28:04Z", "author": {"login": "rishi-aga"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDczMw=="}, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MTA4NjQ1OnYy", "diffSide": "RIGHT", "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowMDo1MlrOHlz-Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjoyODoxM1rOHl1Ikg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDgzMA==", "bodyText": "same comment.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509410830", "createdAt": "2020-10-21T16:00:52Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,\n+                        capitalizeFirstLetter(modelName));\n+    }\n+\n+    /**\n+     * Get Class Import for provided modelName from static models if available.\n+     * @param modelName model name.\n+     * @return import statement.\n+     */\n+    public String getJoinClassImport(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassImport(modelName, EMPTY_STRING, EMPTY_STRING);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQyOTkwNg==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509429906", "createdAt": "2020-10-21T16:28:13Z", "author": {"login": "rishi-aga"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,\n+                        capitalizeFirstLetter(modelName));\n+    }\n+\n+    /**\n+     * Get Class Import for provided modelName from static models if available.\n+     * @param modelName model name.\n+     * @return import statement.\n+     */\n+    public String getJoinClassImport(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassImport(modelName, EMPTY_STRING, EMPTY_STRING);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDgzMA=="}, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MTA5MzQ3OnYy", "diffSide": "RIGHT", "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/compile/ElideDynamicEntityCompiler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowMjozMVrOHl0CjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNzozODo1NlrOHl4rFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMTk4MQ==", "bodyText": "We should use these lookups to validate the joins as well (so we don't get a cryptic error here if they put down a class that doesn't exist).", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509411981", "createdAt": "2020-10-21T16:02:31Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/compile/ElideDynamicEntityCompiler.java", "diffHunk": "@@ -201,4 +238,38 @@ public ClassLoader getClassLoader() {\n                .map(Class::getName)\n                .collect(Collectors.toList());\n     }\n+\n+    /**\n+     * Prepare Import statement.\n+     * @param pkgName package name.\n+     * @param className class name.\n+     * @return complete import statement.\n+     */\n+    private static String prepareImport(String pkgName, String className) {\n+        return IMPORT + pkgName + DOT + className + SEMI_COLON;\n+    }\n+\n+    /**\n+     * Get Class Name for provided (modelName, modelVersion).\n+     * @param modelName model name.\n+     * @param modelVersion model version.\n+     * @param defaultValue default value.\n+     * @return class name for provided (modelName, modelVersion) if available else default value.\n+     */\n+    public static String getStaticModelClassName(String modelName, String modelVersion, String defaultValue) {\n+        ModelMapValue value = STATIC_MODEL_DETAILS.get(new ModelMapKey(modelName, modelVersion));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQ4Nzg5Mw==", "bodyText": "Added validation on Join's to value", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509487893", "createdAt": "2020-10-21T17:38:56Z", "author": {"login": "rishi-aga"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/compile/ElideDynamicEntityCompiler.java", "diffHunk": "@@ -201,4 +238,38 @@ public ClassLoader getClassLoader() {\n                .map(Class::getName)\n                .collect(Collectors.toList());\n     }\n+\n+    /**\n+     * Prepare Import statement.\n+     * @param pkgName package name.\n+     * @param className class name.\n+     * @return complete import statement.\n+     */\n+    private static String prepareImport(String pkgName, String className) {\n+        return IMPORT + pkgName + DOT + className + SEMI_COLON;\n+    }\n+\n+    /**\n+     * Get Class Name for provided (modelName, modelVersion).\n+     * @param modelName model name.\n+     * @param modelVersion model version.\n+     * @param defaultValue default value.\n+     * @return class name for provided (modelName, modelVersion) if available else default value.\n+     */\n+    public static String getStaticModelClassName(String modelName, String modelVersion, String defaultValue) {\n+        ModelMapValue value = STATIC_MODEL_DETAILS.get(new ModelMapKey(modelName, modelVersion));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMTk4MQ=="}, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MTEwMjM0OnYy", "diffSide": "RIGHT", "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowNDozN1rOHl0IRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjoyNzo1M1rOHl1Hpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMzQ0Nw==", "bodyText": "What test is validating this change?", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509413447", "createdAt": "2020-10-21T16:04:37Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson", "diffHunk": "@@ -174,7 +174,7 @@\n       [\n         {\n           name: region\n-          to: RegionDetails\n+          to: regionDetails", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQyOTY3MQ==", "bodyText": "https://github.com/yahoo/elide/blob/hjson_join_validation/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/integration/AggregationDataStoreIntegrationTest.java#L916\nhttps://github.com/yahoo/elide/blob/hjson_join_validation/elide-datastore/elide-datastore-aggregation/src/test/java/com/yahoo/elide/datastores/aggregation/integration/AggregationDataStoreIntegrationTest.java#L989\ncustomerRegionRegion field is pulled from static model now. (https://github.com/yahoo/elide/blob/hjson_join_validation/elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson#L57)", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509429671", "createdAt": "2020-10-21T16:27:53Z", "author": {"login": "rishi-aga"}, "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson", "diffHunk": "@@ -174,7 +174,7 @@\n       [\n         {\n           name: region\n-          to: RegionDetails\n+          to: regionDetails", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMzQ0Nw=="}, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MTgyNzEzOnYy", "diffSide": "RIGHT", "path": "elide-contrib/elide-dynamic-config-helpers/src/test/resources/validator/bad_join_model/models/tables/table1.hjson", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxODowODozNlrOHl7o-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxODowODozNlrOHl7o-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTUzNjUwNA==", "bodyText": "For any HJSON file that we expect to fail, let's add comments explaining the line we expect to blow up and why.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509536504", "createdAt": "2020-10-21T18:08:36Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/test/resources/validator/bad_join_model/models/tables/table1.hjson", "diffHunk": "@@ -0,0 +1,25 @@\n+{\n+  tables: [{\n+      name: PlayerStats\n+      sql: PlayerStats\n+      schema: gamedb\n+      cardinality : large\n+      hidden : false\n+      readAccess : A user is admin or is a player in the game", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbdf53d087456c8afaa617461e1aff667921a7d3"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 901, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}