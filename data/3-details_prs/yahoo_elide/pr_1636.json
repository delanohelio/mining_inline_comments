{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NTk2MjU3", "number": 1636, "title": "Entity Models support in MetaDataStore", "bodyText": "Description\nBinding @Entity models to Metadatastore to allow joins to use them. Only @Include annotated models will be supported.\nMotivation and Context\nAllow joins to use Entity annotated models.\nHow Has This Been Tested?\nExisting Test cases pass.\nNew Test cases pass.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-11-04T19:32:45Z", "url": "https://github.com/yahoo/elide/pull/1636", "merged": true, "mergeCommit": {"oid": "b4912b9767e13657ed673860234ef7c35d5e2fd5"}, "closed": true, "closedAt": "2020-11-05T21:55:56Z", "author": {"login": "moizarafat"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZTEksAFqTUyMzY3NzU3Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZpof0gBqjM5NjQ1NjY0MTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNjc3NTcz", "url": "https://github.com/yahoo/elide/pull/1636#pullrequestreview-523677573", "createdAt": "2020-11-04T19:38:32Z", "commit": {"oid": "d0816e7dafa0ecee046b81e78aae1f2249eb5894"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxOTozODozMlrOHtm8fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxOTozODozMlrOHtm8fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU4NjA0NA==", "bodyText": "I think this file is no longer used, so can be deleted.", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517586044", "createdAt": "2020-11-04T19:38:32Z", "author": {"login": "rishi-aga"}, "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/create_tables.sql", "diffHunk": "@@ -27,6 +27,12 @@ CREATE TABLE IF NOT EXISTS players\n       name VARCHAR(255)\n     ) AS SELECT * FROM CSVREAD('classpath:player.csv');\n \n+CREATE TABLE IF NOT EXISTS playerRanking", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0816e7dafa0ecee046b81e78aae1f2249eb5894"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzEwMDA2", "url": "https://github.com/yahoo/elide/pull/1636#pullrequestreview-523710006", "createdAt": "2020-11-04T20:27:25Z", "commit": {"oid": "d0816e7dafa0ecee046b81e78aae1f2249eb5894"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMDoyNzoyNVrOHtogqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMDoyNzoyNVrOHtogqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYxMTY5MQ==", "bodyText": "Class scanning is really time consuming.  We don't want to scan 100% of the classes three times to do this.  In the past, this has caused build times to go through the roof.  We should make maybe a new method in ClassScanner that looks for the classes we need in one pass.", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517611691", "createdAt": "2020-11-04T20:27:25Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-aggregation/src/main/java/com/yahoo/elide/datastores/aggregation/metadata/MetaDataStore.java", "diffHunk": "@@ -80,12 +84,29 @@ public HashMapDataStore apply(String key) {\n     private Map<String, HashMapDataStore> hashMapDataStores = new HashMap<>();\n \n     public MetaDataStore() {\n-        this(ClassScanner.getAnnotatedClasses(METADATA_STORE_ANNOTATIONS));\n+        this(getAllAnnotatedClasses());\n+    }\n+\n+    /**\n+     * get all MetaDataStore supported annotated classes.\n+     * @return Set of Class with specific annotations.\n+     */\n+    private static Set<Class<?>> getAllAnnotatedClasses() {\n+        Set<Class<?>> metadataStoreResult = ClassScanner.getAnnotatedClasses(METADATA_STORE_ANNOTATIONS);\n+\n+        Set<Class<?>> entityResult = ClassScanner.getAnnotatedClasses(METADATA_STORE_ENTITY_ANNOTATION);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0816e7dafa0ecee046b81e78aae1f2249eb5894"}, "originalPosition": 33}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc698a52efc2a38a80143cdff6738a07ade7f7d9", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/dc698a52efc2a38a80143cdff6738a07ade7f7d9", "committedDate": "2020-11-04T21:19:10Z", "message": "Review Comments for avoiding multiple scans"}, "afterCommit": {"oid": "d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "committedDate": "2020-11-04T21:29:04Z", "message": "Review Comments for avoiding multiple scans"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "committedDate": "2020-11-04T21:29:04Z", "message": "Review Comments for avoiding multiple scans"}, "afterCommit": {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/11edd80001b57ca74912e42250dec9abb3e0384f", "committedDate": "2020-11-04T21:32:44Z", "message": "Review Comments for avoiding multiple scans"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzkzMTE2", "url": "https://github.com/yahoo/elide/pull/1636#pullrequestreview-523793116", "createdAt": "2020-11-04T22:49:13Z", "commit": {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMjo0OToxM1rOHtsgeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMjo0OToxM1rOHtsgeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY3NzE3Nw==", "bodyText": "nice", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517677177", "createdAt": "2020-11-04T22:49:13Z", "author": {"login": "aklish"}, "path": "elide-core/src/main/java/com/yahoo/elide/utils/ClassScanner.java", "diffHunk": "@@ -83,4 +96,12 @@\n                     .collect(Collectors.toSet());\n         }\n     }\n+\n+    /**\n+     * Function which will be invoked for deciding to include the class in final results.\n+     */\n+    @FunctionalInterface", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzkzNjk0", "url": "https://github.com/yahoo/elide/pull/1636#pullrequestreview-523793694", "createdAt": "2020-11-04T22:50:27Z", "commit": {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92fdf792125d25ebdc189ee6fa6d1df05f3bdb74", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/92fdf792125d25ebdc189ee6fa6d1df05f3bdb74", "committedDate": "2020-11-05T21:31:14Z", "message": "Entity Models support in MetaDataStore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6517318aac0cc155ceeff07894f6317a1813bb86", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/6517318aac0cc155ceeff07894f6317a1813bb86", "committedDate": "2020-11-05T21:31:14Z", "message": "Review Comments for avoiding multiple scans"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/11edd80001b57ca74912e42250dec9abb3e0384f", "committedDate": "2020-11-04T21:32:44Z", "message": "Review Comments for avoiding multiple scans"}, "afterCommit": {"oid": "6517318aac0cc155ceeff07894f6317a1813bb86", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/6517318aac0cc155ceeff07894f6317a1813bb86", "committedDate": "2020-11-05T21:31:14Z", "message": "Review Comments for avoiding multiple scans"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 755, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}