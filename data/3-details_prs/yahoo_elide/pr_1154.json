{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MDU3MDQ3", "number": 1154, "title": "Refactor share permission", "bodyText": "Resolves #760\nDescription\nReplaces SharePermission with NonTransferable annotation.  This basically inverts the model.  In elide 5.0, you mark classes as NonTransferable rather than Shareable.\nElide will continue to verify ReadPermission for any entity added to a collection.\nMotivation and Context\nImprove security ergonomics.\nHow Has This Been Tested?\nExisting tests.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-01-22T20:51:15Z", "url": "https://github.com/yahoo/elide/pull/1154", "merged": true, "mergeCommit": {"oid": "56d745c513a5857a7d543bef3f052774335e8870"}, "closed": true, "closedAt": "2020-02-07T03:47:02Z", "author": {"login": "aklish"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAvo0GAH2gAyMzY2MDU3MDQ3OmE5MmQ1NTZmMTYzZTYyNWEwMDAwNDg2MjA0ZjQ3NjEzYjg4YTBjYzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBzn-tAFqTM1NDg1MjI4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a92d556f163e625a0000486204f47613b88a0cc1", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/a92d556f163e625a0000486204f47613b88a0cc1", "committedDate": "2020-02-03T16:36:12Z", "message": "Refactored Sorting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ebed4d2f7e981c99d6ba2ed7fbf322ce0425dea", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/8ebed4d2f7e981c99d6ba2ed7fbf322ce0425dea", "committedDate": "2020-02-03T16:45:47Z", "message": "Refactored Pagination"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5b5c3c68016a4ab477c0cdad7ed4d484599ee3", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/6f5b5c3c68016a4ab477c0cdad7ed4d484599ee3", "committedDate": "2020-02-03T16:47:34Z", "message": "Refactored Pagination"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d560ed60bbdeb3798de1622fedd643e327cacff8", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/d560ed60bbdeb3798de1622fedd643e327cacff8", "committedDate": "2020-02-03T16:48:19Z", "message": "Pagination refactor builds and tests pass"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e7c29b4808a7ca27fe43cbf95d0bb002bfcf2d6", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/3e7c29b4808a7ca27fe43cbf95d0bb002bfcf2d6", "committedDate": "2020-02-03T16:48:20Z", "message": "Codacy fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d4041ba4257140e4e6f17e38fc7c6fd537f8345", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/2d4041ba4257140e4e6f17e38fc7c6fd537f8345", "committedDate": "2020-02-03T16:48:20Z", "message": "Refactored SharePermission to NonTransferable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cee0d42c89ce5149f8a22788a718b77381167d1", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/2cee0d42c89ce5149f8a22788a718b77381167d1", "committedDate": "2020-02-03T17:16:01Z", "message": "Fixed build"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a84616aca91967eedaffc69365c4d6c047027735", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/a84616aca91967eedaffc69365c4d6c047027735", "committedDate": "2020-01-22T20:45:32Z", "message": "Refactored SharePermission to NonTransferable"}, "afterCommit": {"oid": "2cee0d42c89ce5149f8a22788a718b77381167d1", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/2cee0d42c89ce5149f8a22788a718b77381167d1", "committedDate": "2020-02-03T17:16:01Z", "message": "Fixed build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62ecd46806153a4c766cc90d1f4d2e41eef2c268", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/62ecd46806153a4c766cc90d1f4d2e41eef2c268", "committedDate": "2020-02-03T18:01:22Z", "message": "Fixed startup bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNDc5NjA1", "url": "https://github.com/yahoo/elide/pull/1154#pullrequestreview-352479605", "createdAt": "2020-02-03T18:49:44Z", "commit": {"oid": "62ecd46806153a4c766cc90d1f4d2e41eef2c268"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxODo0OTo0NFrOFk7-7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxODo0OTo0NFrOFk7-7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI3NTgyMw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/yahoo/elide/pull/1154#discussion_r374275823", "createdAt": "2020-02-03T18:49:44Z", "author": {"login": "wcekan"}, "path": "elide-datastore/elide-datastore-aggregation/src/main/java/com/yahoo/elide/datastores/aggregation/metadata/MetaDataStore.java", "diffHunk": "@@ -33,8 +33,7 @@\n  * MetaDataStore is a in-memory data store that manage data models for an {@link AggregationDataStore}.\n  */\n public class MetaDataStore extends HashMapDataStore {\n-    public static final Package META_DATA_PACKAGE =\n-            Package.getPackage(\"com.yahoo.elide.datastores.aggregation.metadata.models\");\n+    public static final Package META_DATA_PACKAGE = Table.class.getPackage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62ecd46806153a4c766cc90d1f4d2e41eef2c268"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNTAzMDc2", "url": "https://github.com/yahoo/elide/pull/1154#pullrequestreview-352503076", "createdAt": "2020-02-03T19:27:21Z", "commit": {"oid": "62ecd46806153a4c766cc90d1f4d2e41eef2c268"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxOToyNzoyMVrOFk9HPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxOToyNzoyMVrOFk9HPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDI5NDMzNQ==", "bodyText": "== false looks strange.  Can we say\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return (nonTransferable == null || nonTransferable.enabled() == false);\n          \n          \n            \n                    return (nonTransferable == null || ! nonTransferable.enabled());", "url": "https://github.com/yahoo/elide/pull/1154#discussion_r374294335", "createdAt": "2020-02-03T19:27:21Z", "author": {"login": "wcekan"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/EntityDictionary.java", "diffHunk": "@@ -830,9 +830,10 @@ public String getNameFromAlias(Object entity, String alias) {\n      * @param entityClass the entity type to check for the shareable permissions\n      * @return true if entityClass is shareable.  False otherwise.\n      */\n-    public boolean isShareable(Class<?> entityClass) {\n-        return getAnnotation(entityClass, SharePermission.class) != null\n-                && getAnnotation(entityClass, SharePermission.class).sharable();\n+    public boolean isTransferable(Class<?> entityClass) {\n+        NonTransferable nonTransferable = getAnnotation(entityClass, NonTransferable.class);\n+\n+        return (nonTransferable == null || nonTransferable.enabled() == false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62ecd46806153a4c766cc90d1f4d2e41eef2c268"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5", "committedDate": "2020-02-04T15:43:29Z", "message": "Fixed codacy and inspection comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NjEzNzA5", "url": "https://github.com/yahoo/elide/pull/1154#pullrequestreview-354613709", "createdAt": "2020-02-06T16:57:09Z", "commit": {"oid": "b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNjo1NzoxMFrOFmit8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowMDoxNFrOFmi1BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1OTAyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return (nonTransferable == null || ! nonTransferable.enabled());\n          \n          \n            \n                    return (nonTransferable == null || !nonTransferable.enabled());", "url": "https://github.com/yahoo/elide/pull/1154#discussion_r375959027", "createdAt": "2020-02-06T16:57:10Z", "author": {"login": "jkusa"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/EntityDictionary.java", "diffHunk": "@@ -830,9 +830,10 @@ public String getNameFromAlias(Object entity, String alias) {\n      * @param entityClass the entity type to check for the shareable permissions\n      * @return true if entityClass is shareable.  False otherwise.\n      */\n-    public boolean isShareable(Class<?> entityClass) {\n-        return getAnnotation(entityClass, SharePermission.class) != null\n-                && getAnnotation(entityClass, SharePermission.class).sharable();\n+    public boolean isTransferable(Class<?> entityClass) {\n+        NonTransferable nonTransferable = getAnnotation(entityClass, NonTransferable.class);\n+\n+        return (nonTransferable == null || ! nonTransferable.enabled());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk1OTQ1NA==", "bodyText": "Rebase issue?", "url": "https://github.com/yahoo/elide/pull/1154#discussion_r375959454", "createdAt": "2020-02-06T16:57:53Z", "author": {"login": "jkusa"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/pagination/PaginationImpl.java", "diffHunk": "@@ -33,6 +33,10 @@\n      */\n     public enum PaginationKey { offset, number, size, limit, totals }\n \n+    public static final int DEFAULT_OFFSET = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk2MDgzNw==", "bodyText": "If this is @NonTransferable then it isn't packageshareable correct?", "url": "https://github.com/yahoo/elide/pull/1154#discussion_r375960837", "createdAt": "2020-02-06T17:00:14Z", "author": {"login": "jkusa"}, "path": "elide-core/src/test/java/example/packageshareable/package-info.java", "diffHunk": "@@ -3,7 +3,7 @@\n  * Licensed under the Apache License, Version 2.0\n  * See LICENSE file in project root for terms.\n  */\n-@SharePermission\n+@NonTransferable\n package example.packageshareable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b79d6b1e5aeb2ef5650c16d6775091aa7e7d7ca5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1faa737c5c97695945b5b71687092d58870b4c01", "author": {"user": {"login": "aklish", "name": "Aaron Klish"}}, "url": "https://github.com/yahoo/elide/commit/1faa737c5c97695945b5b71687092d58870b4c01", "committedDate": "2020-02-06T23:11:05Z", "message": "Update elide-core/src/main/java/com/yahoo/elide/core/EntityDictionary.java\n\nCo-Authored-By: Jon Kilroy <jkilroy@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8555625eb8c54185914b29cf51bf294c212c6dd", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/b8555625eb8c54185914b29cf51bf294c212c6dd", "committedDate": "2020-02-06T23:20:35Z", "message": "Inspection rework"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0ODUyMjgw", "url": "https://github.com/yahoo/elide/pull/1154#pullrequestreview-354852280", "createdAt": "2020-02-06T23:48:50Z", "commit": {"oid": "b8555625eb8c54185914b29cf51bf294c212c6dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 625, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}