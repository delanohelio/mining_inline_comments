{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwNzMyNDQy", "number": 1444, "title": "Fix for Graphql Fragment Error in Debug Mode ", "bodyText": "Description\nUsing Graphql fragments in debug mode gave error, graphql.language.FragmentSpread cannot be cast to graphql.language.Field. The error was caused by assuming the type is always Field during the getName operation. Put in a cast by checking the class before calling getName.\nMotivation and Context\nResolving Error\nHow Has This Been Tested?\nTested with the app that was failing.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-07-17T03:40:06Z", "url": "https://github.com/yahoo/elide/pull/1444", "merged": true, "mergeCommit": {"oid": "15bb6d6092fd5cbcd0159bcbd8365504d855f6fd"}, "closed": true, "closedAt": "2020-07-17T17:56:11Z", "author": {"login": "moizarafat"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1rXX7gH2gAyNDUwNzMyNDQyOmQwMzM1YTM5YjM2MTU2ZjY4Yjk2NTk5MGY0Y2EyYjdhMWJjYjE2NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc13rNzgFqTQ1MDg1MjU2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d0335a39b36156f68b965990f4ca2b7a1bcb1651", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/d0335a39b36156f68b965990f4ca2b7a1bcb1651", "committedDate": "2020-07-17T03:35:31Z", "message": "Fix for Fragment Error in debug mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNzQyMjcx", "url": "https://github.com/yahoo/elide/pull/1444#pullrequestreview-450742271", "createdAt": "2020-07-17T15:14:23Z", "commit": {"oid": "d0335a39b36156f68b965990f4ca2b7a1bcb1651"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNToxNDoyM1rOGzW8Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNToxNDoyNVrOGzW8Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjUwNjM5NQ==", "bodyText": "What does this look like?  There is no space - I'd like to see an example log line.", "url": "https://github.com/yahoo/elide/pull/1444#discussion_r456506395", "createdAt": "2020-07-17T15:14:23Z", "author": {"login": "aklish"}, "path": "elide-graphql/src/main/java/com/yahoo/elide/graphql/PersistentResourceFetcher.java", "diffHunk": "@@ -121,11 +122,22 @@ private void filterSortPaginateSanityCheck(Environment environment) {\n      * @param environment Environment encapsulating graphQL's request environment\n      */\n     private void logContext(RelationshipOp operation, Environment environment) {\n-        List<Field> children = (environment.field.getSelectionSet() != null)\n+        List<?> children = (environment.field.getSelectionSet() != null)\n                 ? (List) environment.field.getSelectionSet().getChildren()\n                 : new ArrayList<>();\n-        String requestedFields = environment.field.getName() + (children.size() > 0\n-                ? \"(\" + children.stream().map(Field::getName).collect(Collectors.toList()) + \")\" : \"\");\n+\n+        List<String> fieldName = new ArrayList<String>();\n+        if (children.size() > 0) {\n+            children.stream().forEach(i -> { if (i.getClass().equals(Field.class)) {\n+                    fieldName.add(((Field) i).getName());\n+                } else {\n+                    fieldName.add(((FragmentSpread) i).getName());\n+                }\n+            });\n+        }\n+\n+        String requestedFields = environment.field.getName() + fieldName.toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0335a39b36156f68b965990f4ca2b7a1bcb1651"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjUwNjQxMA==", "bodyText": "This might not be safe (there are other types in graphQL besides fields and fragments).  Let's not bother logging the fragment spreads.", "url": "https://github.com/yahoo/elide/pull/1444#discussion_r456506410", "createdAt": "2020-07-17T15:14:25Z", "author": {"login": "aklish"}, "path": "elide-graphql/src/main/java/com/yahoo/elide/graphql/PersistentResourceFetcher.java", "diffHunk": "@@ -121,11 +122,22 @@ private void filterSortPaginateSanityCheck(Environment environment) {\n      * @param environment Environment encapsulating graphQL's request environment\n      */\n     private void logContext(RelationshipOp operation, Environment environment) {\n-        List<Field> children = (environment.field.getSelectionSet() != null)\n+        List<?> children = (environment.field.getSelectionSet() != null)\n                 ? (List) environment.field.getSelectionSet().getChildren()\n                 : new ArrayList<>();\n-        String requestedFields = environment.field.getName() + (children.size() > 0\n-                ? \"(\" + children.stream().map(Field::getName).collect(Collectors.toList()) + \")\" : \"\");\n+\n+        List<String> fieldName = new ArrayList<String>();\n+        if (children.size() > 0) {\n+            children.stream().forEach(i -> { if (i.getClass().equals(Field.class)) {\n+                    fieldName.add(((Field) i).getName());\n+                } else {\n+                    fieldName.add(((FragmentSpread) i).getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0335a39b36156f68b965990f4ca2b7a1bcb1651"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdc942451fa6a84007f0ad1a55b99019b602f31e", "author": {"user": {"login": "moizarafat", "name": "Moiz Arafat"}}, "url": "https://github.com/yahoo/elide/commit/cdc942451fa6a84007f0ad1a55b99019b602f31e", "committedDate": "2020-07-17T16:12:31Z", "message": "Review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwODUyNTYy", "url": "https://github.com/yahoo/elide/pull/1444#pullrequestreview-450852562", "createdAt": "2020-07-17T17:56:03Z", "commit": {"oid": "cdc942451fa6a84007f0ad1a55b99019b602f31e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 893, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}