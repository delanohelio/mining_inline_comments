{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1NDU5MjI5", "number": 1378, "title": "Enable query caching by default", "bodyText": "Description\nFor both spring and standalone setups, enable query caching with a Caffeine implementation by default, with a configurable maximum cache size.\nMotivation and Context\nReduce amount of work needed for users to take advantage of caching. (User will still need to satisfy requirements of query engine used for caching.)\nUnder Spring, metrics will be published since there is a Caffeine metrics binding for micrometer (micrometer is the metrics API used by Spring). However, since standalone uses dropwizard metrics, which only has a binding provided as a (long) example, for now metrics are not published in this context. (I might pursue a PR to make the caffeine-dropwizard binding available, and then open a follow-up PR here to use it.)\nHow Has This Been Tested?\nWill manually test, automated tests pass.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-06-16T20:49:48Z", "url": "https://github.com/yahoo/elide/pull/1378", "merged": true, "mergeCommit": {"oid": "5da1616f92275e7893a57965107d8e077ca87768"}, "closed": true, "closedAt": "2020-06-17T19:08:31Z", "author": {"login": "john-karp"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrka3QgH2gAyNDM1NDU5MjI5OmQ4NGRkODUzNjc3ZDJhZWI1Y2EzOTdlZTc0MmYzMzE1NzY4NzY0Y2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsOXxPgH2gAyNDM1NDU5MjI5OmMyZTc5YTM4MDJlZTk5ZTBhYmZiYzc2ZmIyYThkMmJkZTNhN2UyYzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d84dd853677d2aeb5ca397ee742f3315768764cd", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/d84dd853677d2aeb5ca397ee742f3315768764cd", "committedDate": "2020-06-15T17:50:45Z", "message": "Create new cache package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a05a746eda0f7ec67479bd05cc4f736a1c4dd39", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/1a05a746eda0f7ec67479bd05cc4f736a1c4dd39", "committedDate": "2020-06-15T18:02:55Z", "message": "Add caffeine cache based impl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76557a745e9fa82c0c3307d7ca4c4d04a44bee07", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/76557a745e9fa82c0c3307d7ca4c4d04a44bee07", "committedDate": "2020-06-16T18:14:39Z", "message": "Configure Caffeine cache by default"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "296e43ed440117ae8d4c64e962cf3ba60de19745", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/296e43ed440117ae8d4c64e962cf3ba60de19745", "committedDate": "2020-06-16T20:44:24Z", "message": "Publish cache metrics under Spring/micrometer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7521843d2d492247e30a4198e3be02449a0c65a", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/f7521843d2d492247e30a4198e3be02449a0c65a", "committedDate": "2020-06-16T20:53:55Z", "message": "Lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77106907855b37cdbe28ec7414f5ce058628037b", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/77106907855b37cdbe28ec7414f5ce058628037b", "committedDate": "2020-06-16T22:11:50Z", "message": "Fix javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTEwNDMx", "url": "https://github.com/yahoo/elide/pull/1378#pullrequestreview-432510431", "createdAt": "2020-06-17T15:16:55Z", "commit": {"oid": "77106907855b37cdbe28ec7414f5ce058628037b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNToxNjo1NlrOGlKw1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNToxNjo1NlrOGlKw1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYyNjgzNg==", "bodyText": "What is the size in terms of bytes?  Entries?  How about change the variable name to include units.", "url": "https://github.com/yahoo/elide/pull/1378#discussion_r441626836", "createdAt": "2020-06-17T15:16:56Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-aggregation/src/main/java/com/yahoo/elide/datastores/aggregation/cache/CaffeineCache.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 2020, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+\n+package com.yahoo.elide.datastores.aggregation.cache;\n+\n+import com.yahoo.elide.datastores.aggregation.query.QueryResult;\n+\n+import com.github.benmanes.caffeine.cache.Caffeine;\n+\n+/**\n+ * A basic local-only cache.\n+ */\n+public class CaffeineCache implements Cache {\n+    public static final int DEFAULT_CACHE_SIZE = 1024;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77106907855b37cdbe28ec7414f5ce058628037b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2213cc2e90b7623b8db8b91fbaa25aac9d864d1b", "author": {"user": {"login": "john-karp", "name": "John Karp"}}, "url": "https://github.com/yahoo/elide/commit/2213cc2e90b7623b8db8b91fbaa25aac9d864d1b", "committedDate": "2020-06-17T16:46:09Z", "message": "Rename max cache size for clarity"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTk3MTUy", "url": "https://github.com/yahoo/elide/pull/1378#pullrequestreview-432597152", "createdAt": "2020-06-17T16:59:09Z", "commit": {"oid": "2213cc2e90b7623b8db8b91fbaa25aac9d864d1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNjo1OToxMFrOGlOyEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNjo1OToxMFrOGlOyEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY5MjY5MA==", "bodyText": "should this dependency be optional?", "url": "https://github.com/yahoo/elide/pull/1378#discussion_r441692690", "createdAt": "2020-06-17T16:59:10Z", "author": {"login": "wcekan"}, "path": "elide-datastore/elide-datastore-aggregation/pom.xml", "diffHunk": "@@ -92,6 +92,14 @@\n             <version>${hibernate5.version}</version>\n         </dependency>\n \n+        <!-- Caffeine cache -->\n+        <dependency>\n+            <groupId>com.github.ben-manes.caffeine</groupId>\n+            <artifactId>caffeine</artifactId>\n+            <version>2.8.4</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2213cc2e90b7623b8db8b91fbaa25aac9d864d1b"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNjQ5MDU3", "url": "https://github.com/yahoo/elide/pull/1378#pullrequestreview-432649057", "createdAt": "2020-06-17T18:06:17Z", "commit": {"oid": "2213cc2e90b7623b8db8b91fbaa25aac9d864d1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f26b7b24876bb8da086ffa4416405064ef4ff421", "author": {"user": {"login": "aklish", "name": "Aaron Klish"}}, "url": "https://github.com/yahoo/elide/commit/f26b7b24876bb8da086ffa4416405064ef4ff421", "committedDate": "2020-06-17T18:08:42Z", "message": "Merge branch 'elide-5.x' into caffeine-cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2e79a3802ee99e0abfbc76fb2a8d2bde3a7e2c7", "author": {"user": {"login": "aklish", "name": "Aaron Klish"}}, "url": "https://github.com/yahoo/elide/commit/c2e79a3802ee99e0abfbc76fb2a8d2bde3a7e2c7", "committedDate": "2020-06-17T18:43:23Z", "message": "Update ElideAutoConfiguration.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 864, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}