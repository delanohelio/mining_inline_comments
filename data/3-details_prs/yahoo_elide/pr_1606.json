{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3NjY2MjM1", "number": 1606, "title": "Lookup Join Class from static defined models", "bodyText": "Description\nLookup Join Class from static defined models. If not available then assume its defined dynamically and use existing logic.\nRemove unused imports from table handlebar template.\nHow Has This Been Tested?\nExisting Tests Pass.\nIntegration Test added.\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-10-21T15:55:41Z", "url": "https://github.com/yahoo/elide/pull/1606", "merged": true, "mergeCommit": {"oid": "4d5091688d7e10945477aa93d84ff4e15ab69123"}, "closed": true, "closedAt": "2020-10-27T17:53:41Z", "author": {"login": "rishi-aga"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUvnvcAFqTUxMzg0ODg4OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWsxfdgFqTUxNzk5MDMzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzODQ4ODg5", "url": "https://github.com/yahoo/elide/pull/1606#pullrequestreview-513848889", "createdAt": "2020-10-21T16:00:44Z", "commit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowMDo0NFrOHlz9rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNjowNDozN1rOHl0IRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDczMw==", "bodyText": "There is a NO_VERSION constant you can use here. you can use here.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509410733", "createdAt": "2020-10-21T16:00:44Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMDgzMA==", "bodyText": "same comment.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509410830", "createdAt": "2020-10-21T16:00:52Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHelper.java", "diffHunk": "@@ -193,4 +194,23 @@ public String trimColumnReferences(String str) {\n         }\n         return str;\n     }\n+\n+    /**\n+     * Get Class Name for provided modelName from static models if available else default value.\n+     * @param modelName model name.\n+     * @return class name.\n+     */\n+    public String getJoinClassName(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassName(modelName, EMPTY_STRING,\n+                        capitalizeFirstLetter(modelName));\n+    }\n+\n+    /**\n+     * Get Class Import for provided modelName from static models if available.\n+     * @param modelName model name.\n+     * @return import statement.\n+     */\n+    public String getJoinClassImport(String modelName) {\n+        return ElideDynamicEntityCompiler.getStaticModelClassImport(modelName, EMPTY_STRING, EMPTY_STRING);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMTk4MQ==", "bodyText": "We should use these lookups to validate the joins as well (so we don't get a cryptic error here if they put down a class that doesn't exist).", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509411981", "createdAt": "2020-10-21T16:02:31Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/main/java/com/yahoo/elide/contrib/dynamicconfighelpers/compile/ElideDynamicEntityCompiler.java", "diffHunk": "@@ -201,4 +238,38 @@ public ClassLoader getClassLoader() {\n                .map(Class::getName)\n                .collect(Collectors.toList());\n     }\n+\n+    /**\n+     * Prepare Import statement.\n+     * @param pkgName package name.\n+     * @param className class name.\n+     * @return complete import statement.\n+     */\n+    private static String prepareImport(String pkgName, String className) {\n+        return IMPORT + pkgName + DOT + className + SEMI_COLON;\n+    }\n+\n+    /**\n+     * Get Class Name for provided (modelName, modelVersion).\n+     * @param modelName model name.\n+     * @param modelVersion model version.\n+     * @param defaultValue default value.\n+     * @return class name for provided (modelName, modelVersion) if available else default value.\n+     */\n+    public static String getStaticModelClassName(String modelName, String modelVersion, String defaultValue) {\n+        ModelMapValue value = STATIC_MODEL_DETAILS.get(new ModelMapKey(modelName, modelVersion));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTQxMzQ0Nw==", "bodyText": "What test is validating this change?", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509413447", "createdAt": "2020-10-21T16:04:37Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson", "diffHunk": "@@ -174,7 +174,7 @@\n       [\n         {\n           name: region\n-          to: RegionDetails\n+          to: regionDetails", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8213e8ec336197d4f9754d1e91a8e043eff463ce"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MDQzNDg4", "url": "https://github.com/yahoo/elide/pull/1606#pullrequestreview-514043488", "createdAt": "2020-10-21T18:08:36Z", "commit": {"oid": "dbdf53d087456c8afaa617461e1aff667921a7d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxODowODozNlrOHl7o-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxODowODozNlrOHl7o-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTUzNjUwNA==", "bodyText": "For any HJSON file that we expect to fail, let's add comments explaining the line we expect to blow up and why.", "url": "https://github.com/yahoo/elide/pull/1606#discussion_r509536504", "createdAt": "2020-10-21T18:08:36Z", "author": {"login": "aklish"}, "path": "elide-contrib/elide-dynamic-config-helpers/src/test/resources/validator/bad_join_model/models/tables/table1.hjson", "diffHunk": "@@ -0,0 +1,25 @@\n+{\n+  tables: [{\n+      name: PlayerStats\n+      sql: PlayerStats\n+      schema: gamedb\n+      cardinality : large\n+      hidden : false\n+      readAccess : A user is admin or is a player in the game", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbdf53d087456c8afaa617461e1aff667921a7d3"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTA5NDU4", "url": "https://github.com/yahoo/elide/pull/1606#pullrequestreview-514109458", "createdAt": "2020-10-21T19:27:14Z", "commit": {"oid": "92d7ebde819de8d6f7dfc4e616aa2ac74064845d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b74590db86baf8abfcab46f786c9471927b581b", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/6b74590db86baf8abfcab46f786c9471927b581b", "committedDate": "2020-10-27T17:05:37Z", "message": "Standardize template substitutions for Join Expressions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61ba19397ba8319d8a8ed72e88fdd2af3b1d5318", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/61ba19397ba8319d8a8ed72e88fdd2af3b1d5318", "committedDate": "2020-10-27T17:10:25Z", "message": "Allow physical column references from referred table in parent table."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "671b29b3879e456c50288e6666782a431b6e1d80", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/671b29b3879e456c50288e6666782a431b6e1d80", "committedDate": "2020-10-27T17:10:26Z", "message": "Lookup Join Class from static defined models"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f58017847cbdb57d9f10c543293644a9561321fe", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/f58017847cbdb57d9f10c543293644a9561321fe", "committedDate": "2020-10-27T17:10:26Z", "message": "Review Comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ede13a361884334cb8469a48dd9c7dcdfa09ea5", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/4ede13a361884334cb8469a48dd9c7dcdfa09ea5", "committedDate": "2020-10-27T17:10:26Z", "message": "Clean up"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "92d7ebde819de8d6f7dfc4e616aa2ac74064845d", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/92d7ebde819de8d6f7dfc4e616aa2ac74064845d", "committedDate": "2020-10-21T19:22:22Z", "message": "Clean up"}, "afterCommit": {"oid": "4ede13a361884334cb8469a48dd9c7dcdfa09ea5", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/4ede13a361884334cb8469a48dd9c7dcdfa09ea5", "committedDate": "2020-10-27T17:10:26Z", "message": "Clean up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff02f81d6380fe830e0d0734a04c70ff2db41c34", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/ff02f81d6380fe830e0d0734a04c70ff2db41c34", "committedDate": "2020-10-27T17:16:35Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56c7b388ae47e15b318097e659608dda9c50d71e", "author": {"user": null}, "url": "https://github.com/yahoo/elide/commit/56c7b388ae47e15b318097e659608dda9c50d71e", "committedDate": "2020-10-27T17:24:47Z", "message": "Codacy errors:"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTkwMzM1", "url": "https://github.com/yahoo/elide/pull/1606#pullrequestreview-517990335", "createdAt": "2020-10-27T17:53:27Z", "commit": {"oid": "56c7b388ae47e15b318097e659608dda9c50d71e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 738, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}