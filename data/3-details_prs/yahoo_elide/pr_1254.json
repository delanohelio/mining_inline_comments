{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1ODE2MzQz", "number": 1254, "title": "Fixes #1244: Incorrect pagination with ToMany filtering", "bodyText": "Resolves #1244\nDescription\nWhen creating query, check if pagination and ToMany relationship is present, if so add DISTINCT to query.\nMotivation and Context\nSee the issue\nHow Has This Been Tested?\nUnit tests\nScreenshots (if appropriate):\nLicense\nI confirm that this contribution is made under an Apache 2.0 license and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-03-30T18:16:39Z", "url": "https://github.com/yahoo/elide/pull/1254", "merged": true, "mergeCommit": {"oid": "16f21a04d3be4c3aeefc283586676a7e55cf24e7"}, "closed": true, "closedAt": "2020-04-12T03:43:07Z", "author": {"login": "bukajsytlos"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTHEx8ABqjMxODQ1MzEwMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWw2pggH2gAyMzk1ODE2MzQzOjM1MzRlOTQyZWVlZmIyNjNkNjMwOWQ4YzExM2RiNzA4MWY0NjY4Yjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "571b3fab5d7a9dc19ca2eade7354f1b2af093fef", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/571b3fab5d7a9dc19ca2eade7354f1b2af093fef", "committedDate": "2020-03-30T18:16:19Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}, "afterCommit": {"oid": "6fe38230a5dbe6ede24c73bd68e6625966a1e130", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/6fe38230a5dbe6ede24c73bd68e6625966a1e130", "committedDate": "2020-03-31T18:05:01Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6fe38230a5dbe6ede24c73bd68e6625966a1e130", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/6fe38230a5dbe6ede24c73bd68e6625966a1e130", "committedDate": "2020-03-31T18:05:01Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}, "afterCommit": {"oid": "7a40e9978683f942198c26b06cf141e8ae50c551", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/7a40e9978683f942198c26b06cf141e8ae50c551", "committedDate": "2020-03-31T20:22:52Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODc0NjAz", "url": "https://github.com/yahoo/elide/pull/1254#pullrequestreview-386874603", "createdAt": "2020-04-03T00:59:05Z", "commit": {"oid": "7a40e9978683f942198c26b06cf141e8ae50c551"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDo1OTowNVrOGABmjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTowMDozMVrOGABoAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3OTQzNw==", "bodyText": "There's a more readable way to build these using a parser:\nfilterParser.parseFilterExpression(\"name==drum\", Item.class, false);", "url": "https://github.com/yahoo/elide/pull/1254#discussion_r402679437", "createdAt": "2020-04-03T00:59:05Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-hibernate/src/test/java/com/yahoo/elide/datastores/hibernate/hql/RootCollectionFetchQueryBuilderTest.java", "diffHunk": "@@ -128,6 +129,56 @@ public void testRootFetchWithJoinFilter() {\n         assertEquals(expected, actual);\n     }\n \n+    @Test\n+    public void testDistinctRootFetchWithToManyJoinFilterAndPagination() {\n+        final Pagination pagination = Pagination.fromOffsetAndLimit(10, 0, false);\n+        List<Path.PathElement> chapterTitlePath = Arrays.asList(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a40e9978683f942198c26b06cf141e8ae50c551"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3OTgxMQ==", "bodyText": "Can we test the exception behavior as well?", "url": "https://github.com/yahoo/elide/pull/1254#discussion_r402679811", "createdAt": "2020-04-03T01:00:31Z", "author": {"login": "aklish"}, "path": "elide-datastore/elide-datastore-hibernate/src/test/java/com/yahoo/elide/datastores/hibernate/hql/RootCollectionFetchQueryBuilderTest.java", "diffHunk": "@@ -128,6 +129,56 @@ public void testRootFetchWithJoinFilter() {\n         assertEquals(expected, actual);\n     }\n \n+    @Test\n+    public void testDistinctRootFetchWithToManyJoinFilterAndPagination() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a40e9978683f942198c26b06cf141e8ae50c551"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a40e9978683f942198c26b06cf141e8ae50c551", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/7a40e9978683f942198c26b06cf141e8ae50c551", "committedDate": "2020-03-31T20:22:52Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}, "afterCommit": {"oid": "b985b4f4c45cac664887f6c4fcf6bba7d890a36f", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/b985b4f4c45cac664887f6c4fcf6bba7d890a36f", "committedDate": "2020-04-06T06:59:55Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b985b4f4c45cac664887f6c4fcf6bba7d890a36f", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/b985b4f4c45cac664887f6c4fcf6bba7d890a36f", "committedDate": "2020-04-06T06:59:55Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}, "afterCommit": {"oid": "6eaae3c6c316963280bc24269bf475c0ad6154db", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/6eaae3c6c316963280bc24269bf475c0ad6154db", "committedDate": "2020-04-06T09:12:52Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa9af4192683e828dd2c9b02501788b947966c70", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/fa9af4192683e828dd2c9b02501788b947966c70", "committedDate": "2020-04-06T10:13:07Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6eaae3c6c316963280bc24269bf475c0ad6154db", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/6eaae3c6c316963280bc24269bf475c0ad6154db", "committedDate": "2020-04-06T09:12:52Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}, "afterCommit": {"oid": "fa9af4192683e828dd2c9b02501788b947966c70", "author": {"user": {"login": "bukajsytlos", "name": null}}, "url": "https://github.com/yahoo/elide/commit/fa9af4192683e828dd2c9b02501788b947966c70", "committedDate": "2020-04-06T10:13:07Z", "message": "Fixes #1244: Incorrect pagination with ToMany filtering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODA4Mjcy", "url": "https://github.com/yahoo/elide/pull/1254#pullrequestreview-391808272", "createdAt": "2020-04-11T23:37:18Z", "commit": {"oid": "fa9af4192683e828dd2c9b02501788b947966c70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a441856fd3bdfa0a22840d76a2647b582c653a", "author": {"user": {"login": "aklish", "name": "Aaron Klish"}}, "url": "https://github.com/yahoo/elide/commit/a1a441856fd3bdfa0a22840d76a2647b582c653a", "committedDate": "2020-04-12T02:24:36Z", "message": "Merge branch 'master' into bugfix/elide-1244-wrong-result-count-filter-to-many-pagination"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3534e942eeefb263d6309d8c113db7081f4668b9", "author": {"user": {"login": "aklish", "name": "Aaron Klish"}}, "url": "https://github.com/yahoo/elide/commit/3534e942eeefb263d6309d8c113db7081f4668b9", "committedDate": "2020-04-12T02:27:33Z", "message": "Merge branch 'master' into bugfix/elide-1244-wrong-result-count-filter-to-many-pagination"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 674, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}