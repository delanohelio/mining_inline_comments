{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMjQwODAy", "number": 1445, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozMzoxOFrOEPotnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDozODoxNVrOES-65g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0ODMxMTMzOnYy", "diffSide": "RIGHT", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozMzoxOFrOGzdNmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozMzoxOFrOGzdNmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYwOTE3OA==", "bodyText": "Can we make an interface for this - and use that for ElideSettings?", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456609178", "createdAt": "2020-07-17T18:33:18Z", "author": {"login": "aklish"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+package com.yahoo.elide.core;\n+\n+import com.google.common.collect.ImmutableMap;\n+\n+import java.util.Map;\n+\n+/***\n+ * Default API links populate provide 'self' and 'related' links.\n+ * To add custom links, Override `getResourceLevelLinks` and `getRelationshipLinks`.\n+ * Ad the subclass object in ElideAutoConfiguration.\n+ */\n+public class DefaultJSONApiLinks {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9493fd1840c56b071c010457867519b29781e7f0"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0ODMxMTk4OnYy", "diffSide": "RIGHT", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozMzozMVrOGzdOBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozMzozMVrOGzdOBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYwOTI4Nw==", "bodyText": "Copyright dates are off.", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456609287", "createdAt": "2020-07-17T18:33:31Z", "author": {"login": "aklish"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9493fd1840c56b071c010457867519b29781e7f0"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0ODMyMDUwOnYy", "diffSide": "RIGHT", "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozNjoyNlrOGzdTZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozNjoyNlrOGzdTZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxMDY2Mw==", "bodyText": "We need an option to make an absolute URL with a hostname, port, etc (https://www.example.com).", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456610663", "createdAt": "2020-07-17T18:36:26Z", "author": {"login": "aklish"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/DefaultJSONApiLinks.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2015, Yahoo Inc.\n+ * Licensed under the Apache License, Version 2.0\n+ * See LICENSE file in project root for terms.\n+ */\n+package com.yahoo.elide.core;\n+\n+import com.google.common.collect.ImmutableMap;\n+\n+import java.util.Map;\n+\n+/***\n+ * Default API links populate provide 'self' and 'related' links.\n+ * To add custom links, Override `getResourceLevelLinks` and `getRelationshipLinks`.\n+ * Ad the subclass object in ElideAutoConfiguration.\n+ */\n+public class DefaultJSONApiLinks {\n+    /**\n+     * Links to be used in EntityProjection\n+     * @param resource\n+     * @return\n+     */\n+    public Map<String, String> getResourceLevelLinks(PersistentResource resource) {\n+        return ImmutableMap.of(\"self\", getResourceUrl(resource));\n+    }\n+\n+    /**\n+     * Links to be used in Relationships of EntityProjection\n+     * @param resource\n+     * @return\n+     */\n+    public Map<String, String> getRelationshipLinks(PersistentResource resource, String field) {\n+        String resourceUrl = getResourceUrl(resource);\n+        return ImmutableMap.of(\n+                \"self\", String.join(\"/\", resourceUrl, \"relationships\", field),\n+                \"related\", String.join(\"/\", resourceUrl, field));\n+    }\n+\n+    /**\n+     * Creates the link from resources path\n+     * @param resource\n+     * @return\n+     */\n+    protected String getResourceUrl(PersistentResource resource) {\n+        StringBuilder result = new StringBuilder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9493fd1840c56b071c010457867519b29781e7f0"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0ODMzMDMxOnYy", "diffSide": "RIGHT", "path": "elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/ElideAutoConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozOTo1MVrOGzdZpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODozOTo1MVrOGzdZpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxMjI2Mw==", "bodyText": "This should be disabled by default in Elide 4.  However, turn it on for testing so the tests below work.", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r456612263", "createdAt": "2020-07-17T18:39:51Z", "author": {"login": "aklish"}, "path": "elide-spring/elide-spring-boot-autoconfigure/src/main/java/com/yahoo/elide/spring/config/ElideAutoConfiguration.java", "diffHunk": "@@ -53,6 +54,7 @@ public Elide initializeElide(EntityDictionary dictionary,\n                 .withEntityDictionary(dictionary)\n                 .withDefaultMaxPageSize(settings.getMaxPageSize())\n                 .withDefaultPageSize(settings.getPageSize())\n+                .withJSONApiLinks(new DefaultJSONApiLinks())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9493fd1840c56b071c010457867519b29781e7f0"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzQwNzEwOnYy", "diffSide": "RIGHT", "path": "elide-core/src/main/java/com/yahoo/elide/core/RequestScope.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDozODoxNVrOG4d6iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDozODoxNVrOG4d6iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg2MzU2Mw==", "bodyText": "this.baseUrlEndPoint = outerRequestScope.baseUrlEndpoint", "url": "https://github.com/yahoo/elide/pull/1445#discussion_r461863563", "createdAt": "2020-07-28T20:38:15Z", "author": {"login": "aklish"}, "path": "elide-core/src/main/java/com/yahoo/elide/core/RequestScope.java", "diffHunk": "@@ -193,6 +204,7 @@ public RequestScope(String path,\n      */\n     protected RequestScope(String path, JsonApiDocument jsonApiDocument, RequestScope outerRequestScope) {\n         this.jsonApiDocument = jsonApiDocument;\n+        this.baseUrlEndPoint = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "494853fb707b28583b7fa9588022737202fa8b85"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1009, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}