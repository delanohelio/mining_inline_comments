{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MjgzNDY0", "number": 8502, "title": "ISPN-12053 Remove jetty-client from the REST testsuite", "bodyText": "https://issues.redhat.com/browse/ISPN-12053", "createdAt": "2020-06-24T15:27:41Z", "url": "https://github.com/infinispan/infinispan/pull/8502", "merged": true, "mergeCommit": {"oid": "87bc7df271420a2e6ce8246e337392f9eed207a9"}, "closed": true, "closedAt": "2020-06-30T16:54:46Z", "author": {"login": "gustavonalle"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcucoEDABqjM0NzgzMTg2NDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwWqcTgBqjM0OTgxMDY3MjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "015e0072fedb97d88c6a6322269671ee781d31b8", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/015e0072fedb97d88c6a6322269671ee781d31b8", "committedDate": "2020-06-24T15:26:15Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "900697b95a10c1d3ee3ce3337d6a0f6e277011b7", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/900697b95a10c1d3ee3ce3337d6a0f6e277011b7", "committedDate": "2020-06-24T16:27:26Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "900697b95a10c1d3ee3ce3337d6a0f6e277011b7", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/900697b95a10c1d3ee3ce3337d6a0f6e277011b7", "committedDate": "2020-06-24T16:27:26Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "87eacfbc9bfe0b09154b7c175a54cb51eadc615a", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/87eacfbc9bfe0b09154b7c175a54cb51eadc615a", "committedDate": "2020-06-25T08:35:52Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "87eacfbc9bfe0b09154b7c175a54cb51eadc615a", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/87eacfbc9bfe0b09154b7c175a54cb51eadc615a", "committedDate": "2020-06-25T08:35:52Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/34589b616075cd22c74f4b9487536b7391fbf011", "committedDate": "2020-06-25T08:36:55Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MTI3NDk4", "url": "https://github.com/infinispan/infinispan/pull/8502#pullrequestreview-439127498", "createdAt": "2020-06-29T13:12:09Z", "commit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzoxMjowOVrOGqQP3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzozMjo0OFrOGqRIug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk1OTU4Mw==", "bodyText": "nitpick: javadoc?", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446959583", "createdAt": "2020-06-29T13:12:09Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/RestCacheClient.java", "diffHunk": "@@ -101,6 +119,8 @@\n     */\n    CompletionStage<RestResponse> put(String key, RestEntity value);\n \n+   CompletionStage<RestResponse> put(String key, RestEntity value, String... flags);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk2MDc4OQ==", "bodyText": "is this only for the next release cycle?", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446960789", "createdAt": "2020-06-29T13:13:55Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/impl/okhttp/RestSchemasClientOkHttp.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.infinispan.client.rest.impl.okhttp;\n+\n+import static org.infinispan.client.rest.impl.okhttp.RestClientOkHttp.TEXT_PLAIN;\n+import static org.infinispan.client.rest.impl.okhttp.RestClientOkHttp.sanitize;\n+\n+import java.util.concurrent.CompletionStage;\n+\n+import org.infinispan.client.rest.RestResponse;\n+import org.infinispan.client.rest.RestSchemaClient;\n+\n+import okhttp3.Request;\n+import okhttp3.RequestBody;\n+\n+/**\n+ * @since 12.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3MTYwMg==", "bodyText": "why a String and not a Collection/Array?", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446971602", "createdAt": "2020-06-29T13:29:11Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/RestResponse.java", "diffHunk": "@@ -17,6 +17,11 @@\n \n    Map<String, List<String>> headers();\n \n+   /**\n+    * Returns the value of a header as a String. For multi-valued headers, values are separated by comma.\n+    */\n+   String getHeader(String header);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3MjIzNA==", "bodyText": "well, can be final as well.", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446972234", "createdAt": "2020-06-29T13:30:05Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/impl/okhttp/RestResponseOkHttp.java", "diffHunk": "@@ -10,16 +10,19 @@\n import org.infinispan.commons.dataconversion.MediaType;\n \n import okhttp3.Response;\n+import okhttp3.ResponseBody;\n \n /**\n  * @author Tristan Tarrant &lt;tristan@infinispan.org&gt;\n  * @since 10.0\n  **/\n public class RestResponseOkHttp implements RestResponse {\n    Response response;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3MjY2Ng==", "bodyText": "why caching the body? it seems to be simple field access.", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446972666", "createdAt": "2020-06-29T13:30:44Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/impl/okhttp/RestResponseOkHttp.java", "diffHunk": "@@ -10,16 +10,19 @@\n import org.infinispan.commons.dataconversion.MediaType;\n \n import okhttp3.Response;\n+import okhttp3.ResponseBody;\n \n /**\n  * @author Tristan Tarrant &lt;tristan@infinispan.org&gt;\n  * @since 10.0\n  **/\n public class RestResponseOkHttp implements RestResponse {\n    Response response;\n+   private final ResponseBody body;\n \n    RestResponseOkHttp(Response response) {\n       this.response = response;\n+      this.body = this.response.body();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3NDEzOA==", "bodyText": "nitpick: use TEXT_PLAIN?", "url": "https://github.com/infinispan/infinispan/pull/8502#discussion_r446974138", "createdAt": "2020-06-29T13:32:48Z", "author": {"login": "pruivo"}, "path": "client/rest-client/src/main/java/org/infinispan/client/rest/impl/okhttp/RestSchemasClientOkHttp.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.infinispan.client.rest.impl.okhttp;\n+\n+import static org.infinispan.client.rest.impl.okhttp.RestClientOkHttp.TEXT_PLAIN;\n+import static org.infinispan.client.rest.impl.okhttp.RestClientOkHttp.sanitize;\n+\n+import java.util.concurrent.CompletionStage;\n+\n+import org.infinispan.client.rest.RestResponse;\n+import org.infinispan.client.rest.RestSchemaClient;\n+\n+import okhttp3.Request;\n+import okhttp3.RequestBody;\n+\n+/**\n+ * @since 12.0\n+ */\n+public class RestSchemasClientOkHttp implements RestSchemaClient {\n+\n+   private final RestClientOkHttp client;\n+   private final String baseUrl;\n+\n+   public RestSchemasClientOkHttp(RestClientOkHttp client) {\n+      this.client = client;\n+      this.baseUrl = String.format(\"%s%s/v2/schemas\", client.getBaseURL(), client.getConfiguration().contextPath())\n+            .replaceAll(\"//\", \"/\");\n+   }\n+\n+   @Override\n+   public CompletionStage<RestResponse> names() {\n+      return client.execute(baseUrl);\n+   }\n+\n+   @Override\n+   public CompletionStage<RestResponse> post(String schemaName, String schemaContents) {\n+      Request.Builder builder = new Request.Builder();\n+      RequestBody body = RequestBody.create(TEXT_PLAIN, schemaContents);\n+      builder.url(schemaUrl(schemaName)).post(body);\n+      return client.execute(builder);\n+   }\n+\n+   @Override\n+   public CompletionStage<RestResponse> put(String schemaName, String schemaContents) {\n+      Request.Builder builder = new Request.Builder();\n+      RequestBody body = RequestBody.create(TEXT_PLAIN, schemaContents);\n+      builder.url(schemaUrl(schemaName)).put(body);\n+      return client.execute(builder);\n+   }\n+\n+   @Override\n+   public CompletionStage<RestResponse> delete(String schemaName) {\n+      Request.Builder builder = new Request.Builder();\n+      builder.url(schemaUrl(schemaName)).delete();\n+      return client.execute(builder);\n+   }\n+\n+   @Override\n+   public CompletionStage<RestResponse> get(String schemaName) {\n+      Request.Builder builder = new Request.Builder();\n+      builder.header(\"Accept\", \"text/plain\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011"}, "originalPosition": 59}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34589b616075cd22c74f4b9487536b7391fbf011", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/34589b616075cd22c74f4b9487536b7391fbf011", "committedDate": "2020-06-25T08:36:55Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "874b881bc9e58ede9f93d212b0a01a28fb6a955d", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/874b881bc9e58ede9f93d212b0a01a28fb6a955d", "committedDate": "2020-06-30T13:33:06Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "874b881bc9e58ede9f93d212b0a01a28fb6a955d", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/874b881bc9e58ede9f93d212b0a01a28fb6a955d", "committedDate": "2020-06-30T13:33:06Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "a9080b71eee964ccac9998782d9792e76b87e414", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/a9080b71eee964ccac9998782d9792e76b87e414", "committedDate": "2020-06-30T13:39:13Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMDMwMDcw", "url": "https://github.com/infinispan/infinispan/pull/8502#pullrequestreview-440030070", "createdAt": "2020-06-30T13:45:42Z", "commit": {"oid": "a9080b71eee964ccac9998782d9792e76b87e414"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dabe05aa60146155b7d4d3d5015883fab82b2d8b", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/dabe05aa60146155b7d4d3d5015883fab82b2d8b", "committedDate": "2020-06-30T14:34:02Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9080b71eee964ccac9998782d9792e76b87e414", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/a9080b71eee964ccac9998782d9792e76b87e414", "committedDate": "2020-06-30T13:39:13Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}, "afterCommit": {"oid": "dabe05aa60146155b7d4d3d5015883fab82b2d8b", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/dabe05aa60146155b7d4d3d5015883fab82b2d8b", "committedDate": "2020-06-30T14:34:02Z", "message": "ISPN-12053 Remove jetty-client from the REST testsuite"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 644, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}