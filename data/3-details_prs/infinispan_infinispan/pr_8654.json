{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0NDk4OTg2", "number": 8654, "title": "ISPN-12260 Don't use JMX to compute global server connection stats", "bodyText": "https://issues.redhat.com/browse/ISPN-12260", "createdAt": "2020-08-27T07:08:30Z", "url": "https://github.com/infinispan/infinispan/pull/8654", "merged": true, "mergeCommit": {"oid": "ea2880965b33a577fb841483ffab40298d047a72"}, "closed": true, "closedAt": "2020-09-07T13:29:12Z", "author": {"login": "tristantarrant"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC7G8YABqjM2OTgxMDExMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE46iIgBqjM3MTg4NjA5NzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f925769d3e8fe6dcee98ed2c1ab291d9cb2909e3", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/f925769d3e8fe6dcee98ed2c1ab291d9cb2909e3", "committedDate": "2020-08-27T07:06:11Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}, "afterCommit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/4fb78d718579bef147c60f3d30f2ac46f09d20b4", "committedDate": "2020-08-27T07:16:55Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NDU3Mzg5", "url": "https://github.com/infinispan/infinispan/pull/8654#pullrequestreview-476457389", "createdAt": "2020-08-27T07:32:24Z", "commit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNzozMjoyNFrOHID8Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNzozMjoyNFrOHID8Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIxNTE5NQ==", "bodyText": "I don't think using getQualifiedName() is ok, because the javadoc of ProtocolServerConfigurationBuilder.name() says\n    * Specifies a custom name for this server in order to easily distinguish it from other servers, e.g. via JMX. Defaults to the empty string.\n\nand at least some of our tests have interpreted that as \"set a different name on each node\".", "url": "https://github.com/infinispan/infinispan/pull/8654#discussion_r478215195", "createdAt": "2020-08-27T07:32:24Z", "author": {"login": "danberindei"}, "path": "server/core/src/main/java/org/infinispan/server/core/AbstractProtocolServer.java", "diffHunk": "@@ -100,6 +100,8 @@ public void start(C configuration, EmbeddedCacheManager cacheManager) {\n          throw new IllegalStateException(\"CacheIgnoreManager is a required component\");\n       }\n \n+      bcr.registerComponent(getQualifiedName(), this, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NDYyNDE1", "url": "https://github.com/infinispan/infinispan/pull/8654#pullrequestreview-476462415", "createdAt": "2020-08-27T07:39:26Z", "commit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNzozOToyNlrOHIEK0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNzozOToyNlrOHIEK0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIxODk2MA==", "bodyText": "I don't see how this could be false, at the very least it shouldn't be named isGlobalStatsEnabled unless it uses GlobalConfiguration.statistics().enabled()", "url": "https://github.com/infinispan/infinispan/pull/8654#discussion_r478218960", "createdAt": "2020-08-27T07:39:26Z", "author": {"login": "danberindei"}, "path": "server/core/src/main/java/org/infinispan/server/core/transport/NettyTransportConnectionStats.java", "diffHunk": "@@ -31,7 +27,7 @@\n \n    public NettyTransportConnectionStats(EmbeddedCacheManager cacheManager, ChannelGroup acceptedChannels, String threadNamePrefix) {\n       this.cacheManager = cacheManager;\n-      this.isGlobalStatsEnabled = cacheManager != null && SecurityActions.getCacheManagerConfiguration(cacheManager).jmx().enabled();\n+      this.isGlobalStatsEnabled = cacheManager != null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4fb78d718579bef147c60f3d30f2ac46f09d20b4", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/4fb78d718579bef147c60f3d30f2ac46f09d20b4", "committedDate": "2020-08-27T07:16:55Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}, "afterCommit": {"oid": "57f5f80137a028eea9a54d67b2125cdc7138d540", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/57f5f80137a028eea9a54d67b2125cdc7138d540", "committedDate": "2020-08-28T07:56:31Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57f5f80137a028eea9a54d67b2125cdc7138d540", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/57f5f80137a028eea9a54d67b2125cdc7138d540", "committedDate": "2020-08-28T07:56:31Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}, "afterCommit": {"oid": "f2e5e4bde6fabbdeb96fbe75ac35c62ccb89758a", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/f2e5e4bde6fabbdeb96fbe75ac35c62ccb89758a", "committedDate": "2020-09-01T15:42:36Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f2e5e4bde6fabbdeb96fbe75ac35c62ccb89758a", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/f2e5e4bde6fabbdeb96fbe75ac35c62ccb89758a", "committedDate": "2020-09-01T15:42:36Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}, "afterCommit": {"oid": "56920e1e0a3973dd82e3224db7b98463ffb6a2df", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/56920e1e0a3973dd82e3224db7b98463ffb6a2df", "committedDate": "2020-09-01T15:58:48Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "add80f2a4e0bfe750c8fa213666f5f5c13f32265", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/add80f2a4e0bfe750c8fa213666f5f5c13f32265", "committedDate": "2020-09-02T09:51:26Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56920e1e0a3973dd82e3224db7b98463ffb6a2df", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/56920e1e0a3973dd82e3224db7b98463ffb6a2df", "committedDate": "2020-09-01T15:58:48Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}, "afterCommit": {"oid": "add80f2a4e0bfe750c8fa213666f5f5c13f32265", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/add80f2a4e0bfe750c8fa213666f5f5c13f32265", "committedDate": "2020-09-02T09:51:26Z", "message": "ISPN-12260 Don't use JMX to compute global server connection stats"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 440, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}