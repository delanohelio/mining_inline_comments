{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzg1NDk0", "number": 7995, "title": "ISPN-11425 Missing metadata for persistent counter upon server restart", "bodyText": "https://issues.redhat.com/browse/ISPN-11425\nThe configuration metadata wasn't stored. I had to \"protostreamed\" it", "createdAt": "2020-03-04T18:50:54Z", "url": "https://github.com/infinispan/infinispan/pull/7995", "merged": true, "mergeCommit": {"oid": "c3cf6a9006d925ac08412f3a8530fe42cc2ab999"}, "closed": true, "closedAt": "2020-03-09T12:13:53Z", "author": {"login": "pruivo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKoypjgBqjMxMDA1MzQ0OTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcL7WKFgBqjMxMTAwMTYzMzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc12c323c2d974e97d43f51923ffb361714a2f2d", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/dc12c323c2d974e97d43f51923ffb361714a2f2d", "committedDate": "2020-03-04T18:49:08Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}, "afterCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/2eebd7ea0ff7c4f987fb283f6f39435557693d6e", "committedDate": "2020-03-05T10:16:41Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NDY4NTg2", "url": "https://github.com/infinispan/infinispan/pull/7995#pullrequestreview-369468586", "createdAt": "2020-03-05T10:49:59Z", "commit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMDo0OTo1OVrOFyO1zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMDo1Mzo1NVrOFyO99Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODIxNjI2OQ==", "bodyText": "No need to specify the type or required for any of these fields.\nWe deliberately avoid required as it limits schema evolution and all fields are optional from proto3 onwards.", "url": "https://github.com/infinispan/infinispan/pull/7995#discussion_r388216269", "createdAt": "2020-03-05T10:49:59Z", "author": {"login": "ryanemerson"}, "path": "commons/src/main/java/org/infinispan/counter/api/CounterConfiguration.java", "diffHunk": "@@ -52,26 +44,32 @@ public static Builder builder(CounterType type) {\n       return new Builder(Objects.requireNonNull(type));\n    }\n \n+   @ProtoField(number = 1, type = Type.INT64, required = true, defaultValue = \"0\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODIxNjk1OA==", "bodyText": "11.0 \ud83d\ude42", "url": "https://github.com/infinispan/infinispan/pull/7995#discussion_r388216958", "createdAt": "2020-03-05T10:51:09Z", "author": {"login": "ryanemerson"}, "path": "core/src/main/java/org/infinispan/functional/impl/CounterConfigurationMetaParam.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package org.infinispan.functional.impl;\n+\n+import org.infinispan.counter.api.CounterConfiguration;\n+import org.infinispan.functional.MetaParam;\n+\n+/**\n+ * Stores the {@link CounterConfiguration}.\n+ * <p>\n+ * The metadata is static and doesn't change. It is sent when initializing a counter and it is kept locally in all the\n+ * nodes. This avoids transfer information about the counter in every operation (e.g. boundaries/reset).\n+ *\n+ * @author Pedro Ruivo\n+ * @since 9.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODIxNzQyNA==", "bodyText": "Nitpick: Unnecessary white space lines 17 & 23.", "url": "https://github.com/infinispan/infinispan/pull/7995#discussion_r388217424", "createdAt": "2020-03-05T10:52:00Z", "author": {"login": "ryanemerson"}, "path": "core/src/main/java/org/infinispan/functional/impl/CounterConfigurationMetaParam.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package org.infinispan.functional.impl;\n+\n+import org.infinispan.counter.api.CounterConfiguration;\n+import org.infinispan.functional.MetaParam;\n+\n+/**\n+ * Stores the {@link CounterConfiguration}.\n+ * <p>\n+ * The metadata is static and doesn't change. It is sent when initializing a counter and it is kept locally in all the\n+ * nodes. This avoids transfer information about the counter in every operation (e.g. boundaries/reset).\n+ *\n+ * @author Pedro Ruivo\n+ * @since 9.0\n+ */\n+public class CounterConfigurationMetaParam implements MetaParam.Writable<CounterConfiguration> {\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODIxODM1Nw==", "bodyText": "These classes should be registered with the commons PersistenceContextInitializer otherwise we will have split-packages across modules with the generated marshallers.", "url": "https://github.com/infinispan/infinispan/pull/7995#discussion_r388218357", "createdAt": "2020-03-05T10:53:55Z", "author": {"login": "ryanemerson"}, "path": "core/src/main/java/org/infinispan/marshall/persistence/impl/PersistenceContextInitializer.java", "diffHunk": "@@ -36,7 +39,10 @@\n             NumericVersion.class,\n             RemoteMetadata.class,\n             SimpleClusteredVersion.class,\n-            MarshallableUserObject.class\n+            MarshallableUserObject.class,\n+            CounterConfiguration.class,\n+            CounterType.class,\n+            Storage.class,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NDc2ODg1", "url": "https://github.com/infinispan/infinispan/pull/7995#pullrequestreview-369476885", "createdAt": "2020-03-05T11:02:26Z", "commit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTowMjoyN1rOFyPPVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTowMjoyN1rOFyPPVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODIyMjgwNw==", "bodyText": "I'm not strongly opposed to this, as it does simplify things here, but do we want to be mixing counters with core?", "url": "https://github.com/infinispan/infinispan/pull/7995#discussion_r388222807", "createdAt": "2020-03-05T11:02:27Z", "author": {"login": "ryanemerson"}, "path": "core/src/main/java/org/infinispan/functional/impl/CounterConfigurationMetaParam.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package org.infinispan.functional.impl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2eebd7ea0ff7c4f987fb283f6f39435557693d6e", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/2eebd7ea0ff7c4f987fb283f6f39435557693d6e", "committedDate": "2020-03-05T10:16:41Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}, "afterCommit": {"oid": "6f61f1781f7041315eba8a7f1b03333284ce8641", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/6f61f1781f7041315eba8a7f1b03333284ce8641", "committedDate": "2020-03-05T12:10:42Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20feef495212a97177a45ee2aa199e1288733316", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/20feef495212a97177a45ee2aa199e1288733316", "committedDate": "2020-03-09T10:27:45Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f61f1781f7041315eba8a7f1b03333284ce8641", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/6f61f1781f7041315eba8a7f1b03333284ce8641", "committedDate": "2020-03-05T12:10:42Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}, "afterCommit": {"oid": "20feef495212a97177a45ee2aa199e1288733316", "author": {"user": {"login": "pruivo", "name": "Pedro Ruivo"}}, "url": "https://github.com/infinispan/infinispan/commit/20feef495212a97177a45ee2aa199e1288733316", "committedDate": "2020-03-09T10:27:45Z", "message": "ISPN-11425 Missing metada for persistent counter upon server restart"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1061, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}