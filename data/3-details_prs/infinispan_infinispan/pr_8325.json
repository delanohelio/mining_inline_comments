{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NTc4NTY2", "number": 8325, "title": "ISPN-11839 Create a test to check licenses in distributions", "bodyText": "https://issues.redhat.com/browse/ISPN-11839", "createdAt": "2020-05-15T12:59:37Z", "url": "https://github.com/infinispan/infinispan/pull/8325", "merged": true, "mergeCommit": {"oid": "2b2b81f28970cf45a75c4d6f92001427341d041e"}, "closed": true, "closedAt": "2020-06-01T10:00:11Z", "author": {"login": "diegolovison"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcim3itAFqTQxMzk1NTg5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjyC2iABqjMzNjQ2Mzg2Mjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzOTU1ODkw", "url": "https://github.com/infinispan/infinispan/pull/8325#pullrequestreview-413955890", "createdAt": "2020-05-18T21:36:33Z", "commit": {"oid": "cef5f792556b09d12b57dfe81d496bd771d62432"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTozNjozM1rOGXITTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTozNjozM1rOGXITTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwNjQ0NQ==", "bodyText": "comment ?", "url": "https://github.com/infinispan/infinispan/pull/8325#discussion_r426906445", "createdAt": "2020-05-18T21:36:33Z", "author": {"login": "karesti"}, "path": "server/runtime/src/test/java/org/infinispan/server/license/LicenseTest.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package org.infinispan.server.license;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+public class LicenseTest {\n+\n+   private static final Pattern TR_REGEX = Pattern.compile(\"<tr>(.+?)</tr>\", Pattern.DOTALL);\n+   private static final Pattern TD_VALUE_REGEX = Pattern.compile(\"<td>(.+?)</td>\", Pattern.DOTALL);\n+   private static final String SERVER_OUTPUT_PATH = System.getProperty(\"server.output.dir\");\n+\n+   @Test\n+   public void testLicense() throws IOException {\n+\n+      List<String> libs = new ArrayList<>();\n+      Files.list(getLibDir())\n+            .filter(Files::isRegularFile).collect(Collectors.toList())\n+            .forEach(jar -> libs.add(jar.getFileName().toString()));\n+\n+      String html = new String(Files.readAllBytes(getDependencyHtmlFile()));\n+      Matcher trMatcher = TR_REGEX.matcher(html);\n+      List<String> htmlDependencies = new ArrayList<>();\n+      while (trMatcher.find()) {\n+         String trValue = trMatcher.group(1);\n+         Matcher tdMatcher = TD_VALUE_REGEX.matcher(trValue);\n+         if (tdMatcher.find()) {\n+            //String group = tdMatcher.group(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cef5f792556b09d12b57dfe81d496bd771d62432"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzOTU2Mzcx", "url": "https://github.com/infinispan/infinispan/pull/8325#pullrequestreview-413956371", "createdAt": "2020-05-18T21:37:27Z", "commit": {"oid": "cef5f792556b09d12b57dfe81d496bd771d62432"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2462fce6fe37d30c86d9b8c44472ab8204b7c559", "author": {"user": {"login": "diegolovison", "name": "Diego Lovison"}}, "url": "https://github.com/infinispan/infinispan/commit/2462fce6fe37d30c86d9b8c44472ab8204b7c559", "committedDate": "2020-05-22T13:11:34Z", "message": "ISPN-11839 Create a test to check licenses in distributions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cef5f792556b09d12b57dfe81d496bd771d62432", "author": {"user": {"login": "diegolovison", "name": "Diego Lovison"}}, "url": "https://github.com/infinispan/infinispan/commit/cef5f792556b09d12b57dfe81d496bd771d62432", "committedDate": "2020-05-15T12:59:10Z", "message": "ISPN-11839 Create a test to check licenses in distributions"}, "afterCommit": {"oid": "2462fce6fe37d30c86d9b8c44472ab8204b7c559", "author": {"user": {"login": "diegolovison", "name": "Diego Lovison"}}, "url": "https://github.com/infinispan/infinispan/commit/2462fce6fe37d30c86d9b8c44472ab8204b7c559", "committedDate": "2020-05-22T13:11:34Z", "message": "ISPN-11839 Create a test to check licenses in distributions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 776, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}