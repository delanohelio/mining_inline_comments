{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzNTU2NzY4", "number": 8719, "title": "ISPN-12286 + ISPN-12357 Indexing configurations should not be inherited when explicitly disabled", "bodyText": "https://issues.redhat.com/browse/ISPN-12357\nAlso includes :\nhttps://issues.redhat.com/browse/ISPN-12286 from #8676\nThe commits for ISPN-12286 should be squashed together before merging.", "createdAt": "2020-09-26T10:02:21Z", "url": "https://github.com/infinispan/infinispan/pull/8719", "merged": true, "mergeCommit": {"oid": "977d9301785ce917e98af6558d2ae77f7c27f5cf"}, "closed": true, "closedAt": "2020-10-03T07:43:38Z", "author": {"login": "anistor"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMnsmEABqjM4MTA2MzY5MTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOnlLigBqjM4MzQ0NjM4MzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6aa3f0a39152179ee2503fed628659e6cef6ce89", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/6aa3f0a39152179ee2503fed628659e6cef6ce89", "committedDate": "2020-09-26T09:59:08Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "39207262fe8ea1d9523bf6e33ad4898d4afd2f6d", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/39207262fe8ea1d9523bf6e33ad4898d4afd2f6d", "committedDate": "2020-09-26T10:19:03Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "39207262fe8ea1d9523bf6e33ad4898d4afd2f6d", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/39207262fe8ea1d9523bf6e33ad4898d4afd2f6d", "committedDate": "2020-09-26T10:19:03Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "77b656466431c3cbaf982abde2203ecaae4f26f9", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/77b656466431c3cbaf982abde2203ecaae4f26f9", "committedDate": "2020-09-26T10:54:02Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MzE2MDIy", "url": "https://github.com/infinispan/infinispan/pull/8719#pullrequestreview-497316022", "createdAt": "2020-09-28T08:59:55Z", "commit": {"oid": "b22b4a06272dffa533b15a6d28401c5d68a4dc67"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwODo1OTo1NVrOHY0mLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwODo1OTo1NVrOHY0mLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTc4OTYxNA==", "bodyText": "This addition ensures inheritance works properly when inheriting from an old base config that uses index`` or auto-configattributes rather thanenabled```.  Do you think it's worth adding this explanation in code @gustavonalle ?", "url": "https://github.com/infinispan/infinispan/pull/8719#discussion_r495789614", "createdAt": "2020-09-28T08:59:55Z", "author": {"login": "anistor"}, "path": "core/src/main/java/org/infinispan/configuration/cache/IndexingConfigurationBuilder.java", "diffHunk": "@@ -337,11 +349,18 @@ public IndexingConfiguration create() {\n    @Override\n    public IndexingConfigurationBuilder read(IndexingConfiguration template) {\n       attributes.read(template.attributes());\n+      Index index = attributes.attribute(INDEX).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b22b4a06272dffa533b15a6d28401c5d68a4dc67"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MzIzMjk2", "url": "https://github.com/infinispan/infinispan/pull/8719#pullrequestreview-497323296", "createdAt": "2020-09-28T09:08:51Z", "commit": {"oid": "b22b4a06272dffa533b15a6d28401c5d68a4dc67"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwOTowODo1MlrOHY06yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwOTowODo1MlrOHY06yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTc5NDg5MQ==", "bodyText": "This should be done in the builder itself, in IndexingConfigurationBuilder#create(). The issue of doing here is it covers only XML parsing.", "url": "https://github.com/infinispan/infinispan/pull/8719#discussion_r495794891", "createdAt": "2020-09-28T09:08:52Z", "author": {"login": "gustavonalle"}, "path": "core/src/main/java/org/infinispan/configuration/parsing/Parser.java", "diffHunk": "@@ -2755,6 +2755,11 @@ private void parseIndexing(XMLExtendedStreamReader reader, ConfigurationBuilderH\n          builder.indexing().enable();\n       }\n \n+      if (!builder.indexing().enabled()) {\n+         // discard any eventually inherited indexing config if indexing is not enabled\n+         builder.indexing().reset();\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b22b4a06272dffa533b15a6d28401c5d68a4dc67"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MzkwNjkx", "url": "https://github.com/infinispan/infinispan/pull/8719#pullrequestreview-497390691", "createdAt": "2020-09-28T10:40:41Z", "commit": {"oid": "77b656466431c3cbaf982abde2203ecaae4f26f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMDo0MDo0MVrOHY4EuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMDo0MDo0MVrOHY4EuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg0NjU4NQ==", "bodyText": "searchMapping is null well before this loop, so why not complain earlier about it @gustavonalle ?", "url": "https://github.com/infinispan/infinispan/pull/8719#discussion_r495846585", "createdAt": "2020-09-28T10:40:41Z", "author": {"login": "anistor"}, "path": "remote-query/remote-query-server/src/main/java/org/infinispan/query/remote/impl/LifecycleManager.java", "diffHunk": "@@ -171,6 +174,9 @@ public void cacheStarting(ComponentRegistry cr, Configuration cfg, String cacheN\n                   if (!knownTypes.contains(typeName)) {\n                      throw new CacheConfigurationException(\"The declared indexed type '\" + typeName + \"' is not known. Please register its proto schema file first.\");\n                   }\n+                  if (searchMapping == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77b656466431c3cbaf982abde2203ecaae4f26f9"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77b656466431c3cbaf982abde2203ecaae4f26f9", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/77b656466431c3cbaf982abde2203ecaae4f26f9", "committedDate": "2020-09-26T10:54:02Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "f8b0ed06d6d1b5cc6237675cdc33161ac96d7ec9", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/f8b0ed06d6d1b5cc6237675cdc33161ac96d7ec9", "committedDate": "2020-09-28T10:29:01Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8b0ed06d6d1b5cc6237675cdc33161ac96d7ec9", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/f8b0ed06d6d1b5cc6237675cdc33161ac96d7ec9", "committedDate": "2020-09-28T10:29:01Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "a5d2f42a2f492251c243ab15e5dd6e7e4c39fff5", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/a5d2f42a2f492251c243ab15e5dd6e7e4c39fff5", "committedDate": "2020-09-28T11:20:10Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6e473175a6bd61b4be62413ec5cbf29497ea119", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/b6e473175a6bd61b4be62413ec5cbf29497ea119", "committedDate": "2020-09-28T11:45:17Z", "message": "wip ISPN-12357 new tricks"}, "afterCommit": {"oid": "cca9cd9482d41d54aaf5b0f6ff06d2d81585f45f", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/cca9cd9482d41d54aaf5b0f6ff06d2d81585f45f", "committedDate": "2020-09-28T13:34:04Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cca9cd9482d41d54aaf5b0f6ff06d2d81585f45f", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/cca9cd9482d41d54aaf5b0f6ff06d2d81585f45f", "committedDate": "2020-09-28T13:34:04Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "3005545d6ae1739e6e451f5e5596c0410724f068", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/3005545d6ae1739e6e451f5e5596c0410724f068", "committedDate": "2020-09-28T16:21:58Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3005545d6ae1739e6e451f5e5596c0410724f068", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/3005545d6ae1739e6e451f5e5596c0410724f068", "committedDate": "2020-09-28T16:21:58Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "56deeba9050bf8d7bb4ee13cd67d4e7d13ba9c43", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/56deeba9050bf8d7bb4ee13cd67d4e7d13ba9c43", "committedDate": "2020-09-28T18:03:09Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56deeba9050bf8d7bb4ee13cd67d4e7d13ba9c43", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/56deeba9050bf8d7bb4ee13cd67d4e7d13ba9c43", "committedDate": "2020-09-28T18:03:09Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "7f822484ad560d5c6a69fd1353b50465c6c06697", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/7f822484ad560d5c6a69fd1353b50465c6c06697", "committedDate": "2020-09-28T20:44:52Z", "message": "ISPN-12286 Fix rather than delete some tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NTAzOTA4", "url": "https://github.com/infinispan/infinispan/pull/8719#pullrequestreview-498503908", "createdAt": "2020-09-29T14:02:10Z", "commit": {"oid": "7f822484ad560d5c6a69fd1353b50465c6c06697"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f822484ad560d5c6a69fd1353b50465c6c06697", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/7f822484ad560d5c6a69fd1353b50465c6c06697", "committedDate": "2020-09-28T20:44:52Z", "message": "ISPN-12286 Fix rather than delete some tests"}, "afterCommit": {"oid": "07871261de7273f413c16a475f3a1f413a86bd6d", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/07871261de7273f413c16a475f3a1f413a86bd6d", "committedDate": "2020-09-29T14:31:02Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8affc48471be33c261dd27e6f4ab506afbc3d44b", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/8affc48471be33c261dd27e6f4ab506afbc3d44b", "committedDate": "2020-09-30T07:28:48Z", "message": "WIP add fix"}, "afterCommit": {"oid": "6c78caac73ed94b596d963b20fd2f99330476c54", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/6c78caac73ed94b596d963b20fd2f99330476c54", "committedDate": "2020-10-01T20:04:22Z", "message": "WIP add fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6c78caac73ed94b596d963b20fd2f99330476c54", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/6c78caac73ed94b596d963b20fd2f99330476c54", "committedDate": "2020-10-01T20:04:22Z", "message": "WIP add fix"}, "afterCommit": {"oid": "a603794efab9235fcccd68e7b6bce574ebe5fe85", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/a603794efab9235fcccd68e7b6bce574ebe5fe85", "committedDate": "2020-10-02T10:01:03Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22c19b04a499f541a8b102696ddc5fc3ec86c7ab", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/22c19b04a499f541a8b102696ddc5fc3ec86c7ab", "committedDate": "2020-10-02T11:35:40Z", "message": "ISPN-12357 Indexing configurations should not be inherited when explicitly disabled\n\n* provide IndexingConfigurationBuilder.reset() to be used by Parser to clear all inherited indexing config if indexing is not enabled\n* some minor cleanups in Attribute/AttributeSet"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a603794efab9235fcccd68e7b6bce574ebe5fe85", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/a603794efab9235fcccd68e7b6bce574ebe5fe85", "committedDate": "2020-10-02T10:01:03Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}, "afterCommit": {"oid": "6a68188a66c32b3bc5b7f6c6f72045bd9b3fed65", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/6a68188a66c32b3bc5b7f6c6f72045bd9b3fed65", "committedDate": "2020-10-02T11:35:40Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a68188a66c32b3bc5b7f6c6f72045bd9b3fed65", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/6a68188a66c32b3bc5b7f6c6f72045bd9b3fed65", "committedDate": "2020-10-02T11:35:40Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}, "afterCommit": {"oid": "e4f43e0986daeea9c0fafc99df5f7e05cf66b822", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/e4f43e0986daeea9c0fafc99df5f7e05cf66b822", "committedDate": "2020-10-02T15:17:11Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "977d9301785ce917e98af6558d2ae77f7c27f5cf", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/977d9301785ce917e98af6558d2ae77f7c27f5cf", "committedDate": "2020-10-02T15:18:48Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4f43e0986daeea9c0fafc99df5f7e05cf66b822", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/e4f43e0986daeea9c0fafc99df5f7e05cf66b822", "committedDate": "2020-10-02T15:17:11Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}, "afterCommit": {"oid": "977d9301785ce917e98af6558d2ae77f7c27f5cf", "author": {"user": {"login": "gustavonalle", "name": "Gustavo"}}, "url": "https://github.com/infinispan/infinispan/commit/977d9301785ce917e98af6558d2ae77f7c27f5cf", "committedDate": "2020-10-02T15:18:48Z", "message": "ISPN-12286 Indexed entity declaration not enforced"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 336, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}