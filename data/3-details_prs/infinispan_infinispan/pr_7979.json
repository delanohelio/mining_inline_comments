{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNTkwODU0", "number": 7979, "title": "ISPN-11393 statistics, metrics, jmx", "bodyText": "https://issues.redhat.com/browse/ISPN-11393\nNeeds backport to 10.1.x", "createdAt": "2020-03-02T20:26:56Z", "url": "https://github.com/infinispan/infinispan/pull/7979", "merged": true, "mergeCommit": {"oid": "88da801c3cab457656e97fc6bc17d348fb549470"}, "closed": true, "closedAt": "2020-03-12T10:57:42Z", "author": {"login": "oraNod"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKBNK-gBqjMwOTE4OTAxNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMsX3kABqjMxMjAyNDAyNTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a95eb508561f4858661cca9e262efb5170fda768", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/a95eb508561f4858661cca9e262efb5170fda768", "committedDate": "2020-03-02T20:25:06Z", "message": "ISPN-11402 statistics, metrics, jmx"}, "afterCommit": {"oid": "51738ca1626f03f7672c88c90ef04ca1a1c2278d", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/51738ca1626f03f7672c88c90ef04ca1a1c2278d", "committedDate": "2020-03-03T12:09:08Z", "message": "ISPN-11393 statistics, metrics, jmx"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51738ca1626f03f7672c88c90ef04ca1a1c2278d", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/51738ca1626f03f7672c88c90ef04ca1a1c2278d", "committedDate": "2020-03-03T12:09:08Z", "message": "ISPN-11393 statistics, metrics, jmx"}, "afterCommit": {"oid": "e53c2359a280d9d3c5047e134743154e0f28e912", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/e53c2359a280d9d3c5047e134743154e0f28e912", "committedDate": "2020-03-03T19:26:35Z", "message": "ISPN-11393 statistics, metrics, jmx"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e53c2359a280d9d3c5047e134743154e0f28e912", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/e53c2359a280d9d3c5047e134743154e0f28e912", "committedDate": "2020-03-03T19:26:35Z", "message": "ISPN-11393 statistics, metrics, jmx"}, "afterCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/386b225c0ba2fc2139b1cc51e912e96ed668d30c", "committedDate": "2020-03-10T09:46:53Z", "message": "ISPN-11393 statistics, metrics, jmx"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzQ1Mzc1", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372745375", "createdAt": "2020-03-11T13:16:06Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzoxNjowNlrOF02W_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzoxNjowNlrOF02W_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk2MDg5NQ==", "bodyText": ".metrics().gauges(true).histograms(true)", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390960895", "createdAt": "2020-03-11T13:16:06Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/code_examples/ConfigStats.java", "diffHunk": "@@ -0,0 +1,5 @@\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable()\n+  .metrics().gauges().histograms()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzQ3NDUw", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372747450", "createdAt": "2020-03-11T13:18:31Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzoxODozMVrOF02dVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzoxODozMVrOF02dVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk2MjUxOA==", "bodyText": "exports to a metrics endpoint  -->  exports to a MicroProfile Metrics endpoint", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390962518", "createdAt": "2020-03-11T13:18:31Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/stories/assembly_server_statistics.adoc", "diffHunk": "@@ -0,0 +1,17 @@\n+[id='statistics']\n+:context: server\n+= Configuring Statistics, Metrics, and JMX\n+Enable statistics that {brandname} exports to a metrics endpoint or via JMX", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzYyNTQ0", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372762544", "createdAt": "2020-03-11T13:36:45Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzozNjo0NVrOF03K0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzozNjo0NVrOF03K0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDE2MQ==", "bodyText": "jmxDomain is not deprecated in HR client. This line can be kept, but maybe I would use something different than \"org.infinispan\", which is the default anyway, so it's not useful.", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390974161", "createdAt": "2020-03-11T13:36:45Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/code_examples/HotRodClientInstance.java", "diffHunk": "@@ -3,7 +3,6 @@\n cb.marshaller(new org.infinispan.commons.marshall.ProtoStreamMarshaller())\n   .statistics()\n       .enable()\n-      .jmxDomain(\"org.infinispan\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzYzOTAy", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372763902", "createdAt": "2020-03-11T13:38:24Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzozODoyNFrOF03Owg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzozODoyNFrOF03Owg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NTE3MA==", "bodyText": "monitoring and management", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390975170", "createdAt": "2020-03-11T13:38:24Z", "author": {"login": "anistor"}, "path": "core/src/main/resources/schema/infinispan-config-11.0.xsd", "diffHunk": "@@ -270,12 +270,16 @@\n       </xs:element>\n       <xs:element name=\"metrics\" type=\"tns:metrics\" minOccurs=\"0\">\n         <xs:annotation>\n-          <xs:documentation>Defines microprofile metrics configuration.</xs:documentation>\n+          <xs:documentation>\n+            Configures MicroProfile metrics.\n+          </xs:documentation>\n         </xs:annotation>\n       </xs:element>\n       <xs:element name=\"jmx\" type=\"tns:jmx\" minOccurs=\"0\">\n         <xs:annotation>\n-          <xs:documentation>Defines JMX management details.</xs:documentation>\n+          <xs:documentation>\n+            Enables and configures JMX monitoring.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzY2MTA2", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372766106", "createdAt": "2020-03-11T13:40:59Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo0MDo1OVrOF03VYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo0MDo1OVrOF03VYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3Njg2NA==", "bodyText": "exports statistics about ... --> computes and collects statistics about ...", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390976864", "createdAt": "2020-03-11T13:40:59Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_metrics.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+[id='configure_metrics']\n+= Enabling {brandname} Metrics\n+{brandname} is compatible with the Eclipse MicroProfile Metrics API and can\n+generate gauge and histogram metrics.\n+\n+* {brandname} metrics are provided at the `/base` and `/vendor` scopes and are\n+not configurable.\n+* Gauges provide values such as the average number of nanoseconds for write\n+operations or JVM uptime. Gauges are enabled by default. If you enable\n+statistics, {brandname} automatically generates gauges.\n+* Histograms provide details about operation execution times such as read,\n+write, and remove times. {brandname} does not enable histograms by default\n+because they require additional computation.\n+\n+.Procedure\n+\n+* Configure metrics declaratively or programmatically.\n+\n+.Declaratively\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<cache-container statistics=\"true\"> <1>\n+  <metrics gauges=\"true\" histograms=\"true\" /> <2>\n+</cache-container>\n+----\n+\n+.Programmatically\n+\n+[source,java]\n+----\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable() <1>\n+  .metrics().gauges().histograms() <2>\n+  .build();\n+----\n+\n+<1> exports statistics about the Cache Manager.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzY2OTU0", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372766954", "createdAt": "2020-03-11T13:41:57Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo0MTo1N1rOF03X_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo0MTo1N1rOF03X_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NzUzNQ==", "bodyText": "generates gauge and histogram metrics  --> exports the collected statistics as gauge and histogram metrics", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r390977535", "createdAt": "2020-03-11T13:41:57Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_metrics.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+[id='configure_metrics']\n+= Enabling {brandname} Metrics\n+{brandname} is compatible with the Eclipse MicroProfile Metrics API and can\n+generate gauge and histogram metrics.\n+\n+* {brandname} metrics are provided at the `/base` and `/vendor` scopes and are\n+not configurable.\n+* Gauges provide values such as the average number of nanoseconds for write\n+operations or JVM uptime. Gauges are enabled by default. If you enable\n+statistics, {brandname} automatically generates gauges.\n+* Histograms provide details about operation execution times such as read,\n+write, and remove times. {brandname} does not enable histograms by default\n+because they require additional computation.\n+\n+.Procedure\n+\n+* Configure metrics declaratively or programmatically.\n+\n+.Declaratively\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<cache-container statistics=\"true\"> <1>\n+  <metrics gauges=\"true\" histograms=\"true\" /> <2>\n+</cache-container>\n+----\n+\n+.Programmatically\n+\n+[source,java]\n+----\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable() <1>\n+  .metrics().gauges().histograms() <2>\n+  .build();\n+----\n+\n+<1> exports statistics about the Cache Manager.\n+<2> generates gauge and histogram metrics.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODE5NjM3", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372819637", "createdAt": "2020-03-11T14:38:10Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDozODoxMFrOF053Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDozODoxMFrOF053Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAxODI1MA==", "bodyText": ".metrics().gauges(true).histograms(true)", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391018250", "createdAt": "2020-03-11T14:38:10Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_metrics.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+[id='configure_metrics']\n+= Enabling {brandname} Metrics\n+{brandname} is compatible with the Eclipse MicroProfile Metrics API and can\n+generate gauge and histogram metrics.\n+\n+* {brandname} metrics are provided at the `/base` and `/vendor` scopes and are\n+not configurable.\n+* Gauges provide values such as the average number of nanoseconds for write\n+operations or JVM uptime. Gauges are enabled by default. If you enable\n+statistics, {brandname} automatically generates gauges.\n+* Histograms provide details about operation execution times such as read,\n+write, and remove times. {brandname} does not enable histograms by default\n+because they require additional computation.\n+\n+.Procedure\n+\n+* Configure metrics declaratively or programmatically.\n+\n+.Declaratively\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<cache-container statistics=\"true\"> <1>\n+  <metrics gauges=\"true\" histograms=\"true\" /> <2>\n+</cache-container>\n+----\n+\n+.Programmatically\n+\n+[source,java]\n+----\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable() <1>\n+  .metrics().gauges().histograms() <2>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODMyMzQy", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372832342", "createdAt": "2020-03-11T14:51:08Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1MTowOFrOF06dmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1MTowOFrOF06dmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAyODEyMw==", "bodyText": "again, 'collects' instead of 'exports', here and on next line", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391028123", "createdAt": "2020-03-11T14:51:08Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_statistics.adoc", "diffHunk": "@@ -0,0 +1,48 @@\n+[id='enable_statistics']\n+= Enabling {brandname} Statistics\n+{brandname} lets you enable statistics for Cache Managers and specific cache\n+instances.\n+\n+[NOTE]\n+====\n+{brandname} servers provide default `infinispan.xml` configuration files that\n+enable statistics for Cache Managers. If you use the default {brandname} server\n+configuration, you only need to enable statistics when you configure caches.\n+====\n+\n+.Procedure\n+\n+* Enable statistics declaratively or programmatically.\n+\n+.Declaratively\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<cache-container statistics=\"true\"> <1>\n+  <local-cache name=\"mycache\" statistics=\"true\"/> <2>\n+</cache-container>\n+----\n+\n+.Programmatically\n+\n+[source,java]\n+----\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable() <1>\n+  .build();\n+\n+ ...\n+\n+Configuration config = new ConfigurationBuilder()\n+\u00a0 .statistics().enable() <2>\n+  .build();\n+----\n+\n+<1> exports statistics about the Cache Manager.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODMzMTMy", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372833132", "createdAt": "2020-03-11T14:51:57Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1MTo1N1rOF06f_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1MTo1N1rOF06f_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAyODczMw==", "bodyText": "collects statistics", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391028733", "createdAt": "2020-03-11T14:51:57Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_statistics.adoc", "diffHunk": "@@ -0,0 +1,48 @@\n+[id='enable_statistics']\n+= Enabling {brandname} Statistics\n+{brandname} lets you enable statistics for Cache Managers and specific cache\n+instances.\n+\n+[NOTE]\n+====\n+{brandname} servers provide default `infinispan.xml` configuration files that\n+enable statistics for Cache Managers. If you use the default {brandname} server\n+configuration, you only need to enable statistics when you configure caches.\n+====\n+\n+.Procedure\n+\n+* Enable statistics declaratively or programmatically.\n+\n+.Declaratively\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<cache-container statistics=\"true\"> <1>\n+  <local-cache name=\"mycache\" statistics=\"true\"/> <2>\n+</cache-container>\n+----\n+\n+.Programmatically\n+\n+[source,java]\n+----\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .statistics().enable() <1>\n+  .build();\n+\n+ ...\n+\n+Configuration config = new ConfigurationBuilder()\n+\u00a0 .statistics().enable() <2>\n+  .build();\n+----\n+\n+<1> exports statistics about the Cache Manager.\n+<2> exports statistics about the named cache.\n+\n+[NOTE]\n+====\n+Enabling statistics for Cache Managers does not globally enable statistics for\n+caches. This configuration only exports statistics for the Cache Manager.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODM1NzMz", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372835733", "createdAt": "2020-03-11T14:54:34Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1NDozNFrOF06n4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1NDozNFrOF06n4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMDc1Mw==", "bodyText": "0 or in some cases -1", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391030753", "createdAt": "2020-03-11T14:54:34Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_collecting_metrics.adoc", "diffHunk": "@@ -1,45 +1,37 @@\n-[id='metric_endpoint']\n+[id='collect_metrics']\n = Collecting {brandname} Metrics\n-{brandname} servers provide monitoring data through an HTTP `metrics` endpoint\n-that exposes OS, JVM, and application-level statistics.\n+Collect {brandname} metrics with monitoring tools such as Prometheus.\n+\n+.Prerequisites\n+\n+* Enable statistics. If you do not enable statistics, {brandname} provides `0` values for all metrics.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODM4ODgz", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372838883", "createdAt": "2020-03-11T14:57:45Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1Nzo0NVrOF06xLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1Nzo0NVrOF06xLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMzEzMg==", "bodyText": "{brandname} metrics are provided at the 'vendor' scope. Also, JVM-related metrics are provided in the 'base' scope in server mode, but not in embedded mode.", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391033132", "createdAt": "2020-03-11T14:57:45Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_enabling_metrics.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+[id='configure_metrics']\n+= Enabling {brandname} Metrics\n+{brandname} is compatible with the Eclipse MicroProfile Metrics API and can\n+generate gauge and histogram metrics.\n+\n+* {brandname} metrics are provided at the `/base` and `/vendor` scopes and are", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyOTE1ODk5", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372915899", "createdAt": "2020-03-11T16:18:31Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoxODozMVrOF0-dKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoxODozMVrOF0-dKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA5MzU0NA==", "bodyText": "I would rephrase Exports gauge metrics. Gauges are enabled by default. Statistics must also be enabled or else no metrics will actually be exported.", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391093544", "createdAt": "2020-03-11T16:18:31Z", "author": {"login": "anistor"}, "path": "core/src/main/resources/schema/infinispan-config-11.0.xsd", "diffHunk": "@@ -641,21 +645,21 @@\n     <xs:attribute name=\"gauges\" type=\"xs:boolean\" default=\"${GlobalMetrics.gauges}\">\n       <xs:annotation>\n         <xs:documentation>\n-          Enables exporting of gauge metrics. These are exported by default if statistics are enabled.\n+          Exports gauge metrics. If you enable statistics, gauges are exported by default.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyOTIxMzk0", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372921394", "createdAt": "2020-03-11T16:24:51Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoyNDo1MVrOF0-uVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoyNDo1MVrOF0-uVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA5Nzk0MA==", "bodyText": "I would rephrase Exports histogram metrics. Histograms are not enabled by default because they require additional computation. Statistics must also be enabled or else no metrics will actually be exported.", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391097940", "createdAt": "2020-03-11T16:24:51Z", "author": {"login": "anistor"}, "path": "core/src/main/resources/schema/infinispan-config-11.0.xsd", "diffHunk": "@@ -641,21 +645,21 @@\n     <xs:attribute name=\"gauges\" type=\"xs:boolean\" default=\"${GlobalMetrics.gauges}\">\n       <xs:annotation>\n         <xs:documentation>\n-          Enables exporting of gauge metrics. These are exported by default if statistics are enabled.\n+          Exports gauge metrics. If you enable statistics, gauges are exported by default.\n         </xs:documentation>\n       </xs:annotation>\n     </xs:attribute>\n     <xs:attribute name=\"histograms\" type=\"xs:boolean\" default=\"${GlobalMetrics.histograms}\">\n       <xs:annotation>\n         <xs:documentation>\n-          Enables exporting of histograms. These are costly to compute so are not enabled by default.\n+          Exports histograms. Disabled by default because histograms require additional computation.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyOTIzMjUz", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372923253", "createdAt": "2020-03-11T16:26:59Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoyNjo1OVrOF0-0Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNjoyNjo1OVrOF0-0Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA5OTQzOQ==", "bodyText": "If JMX statistics are enabled then all 'published' JMX objects appear under this domain. Optional, if not specified it defaults to \"org.infinispan\".", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391099439", "createdAt": "2020-03-11T16:26:59Z", "author": {"login": "anistor"}, "path": "core/src/main/resources/schema/infinispan-config-11.0.xsd", "diffHunk": "@@ -672,28 +676,30 @@\n     <xs:sequence>\n       <xs:element name=\"property\" type=\"tns:property\" minOccurs=\"0\" maxOccurs=\"unbounded\">\n         <xs:annotation>\n-          <xs:documentation>A jmx property with name and value to be passed to the MBean Server lookup instance.</xs:documentation>\n+          <xs:documentation>\n+            Specifies a JMX property with a name and value that is passed to the MBean Server lookup instance.\n+          </xs:documentation>\n         </xs:annotation>\n       </xs:element>\n     </xs:sequence>\n     <xs:attribute name=\"domain\" type=\"xs:string\" default=\"${GlobalJmx.domain}\">\n       <xs:annotation>\n         <xs:documentation>\n-          If JMX statistics are enabled then all 'published' JMX objects will appear under this name. This is optional, if not specified an object name will be created for you by default.\n+          If JMX statistics are enabled then all 'published' JMX objects  appear under this name. Optional, if not specified a default object name is created.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "originalPosition": 59}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/386b225c0ba2fc2139b1cc51e912e96ed668d30c", "committedDate": "2020-03-10T09:46:53Z", "message": "ISPN-11393 statistics, metrics, jmx"}, "afterCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/aa07e363f1a382b759d1b25aa112a68815eb8af4", "committedDate": "2020-03-11T16:41:28Z", "message": "ISPN-11393 statistics, metrics, jmx"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyOTM3NjI2", "url": "https://github.com/infinispan/infinispan/pull/7979#pullrequestreview-372937626", "createdAt": "2020-03-11T16:43:43Z", "commit": {"oid": "386b225c0ba2fc2139b1cc51e912e96ed668d30c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNzoxMzowNlrOF1AtKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxODoxMDoyOFrOF1C-hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTEzMDQwOA==", "bodyText": "Get metrics in Prometheus (OpenMetrics) format:", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391130408", "createdAt": "2020-03-11T17:13:06Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_collecting_metrics.adoc", "diffHunk": "@@ -1,45 +1,38 @@\n-[id='metric_endpoint']\n+[id='collect_metrics']\n = Collecting {brandname} Metrics\n-{brandname} servers provide monitoring data through an HTTP `metrics` endpoint\n-that exposes OS, JVM, and application-level statistics.\n+Collect {brandname} metrics with monitoring tools such as Prometheus.\n+\n+.Prerequisites\n+\n+* Enable statistics. If you do not enable statistics, {brandname} provides `0`\n+and `-1` values for metrics.\n+* Optionally enable histograms. By default {brandname} generates gauges but not histograms.\n \n .Procedure\n \n-. Start at least one {brandname} server.\n-. Test the metrics endpoint with any HTTP client, as in the following examples:\n-+\n-To get metrics in Prometheus or OpenMetrics format:\n+* Get metrics in Prometheus or OpenMetrics format:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2MzY1Nw==", "bodyText": "replace jmx().enable() with jmxEnable()", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391163657", "createdAt": "2020-03-11T18:03:18Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_configuring_hotrod_jmx.adoc", "diffHunk": "@@ -13,8 +10,19 @@ Rod client statistics.\n \n [source,java]\n ----\n-include::code_examples/HotRodJmx.java[]\n+ConfigurationBuilder clientBuilder = new ConfigurationBuilder();\n+clientBuilder\n+   .statistics()\n+    .enable() <1>\n+   .jmx()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2NTYxMg==", "bodyText": "An import org.infinispan.client.hotrod.configuration.ConfigurationBuilder; should make it clear we're not referring to the ConfigurationBuilder from core", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391165612", "createdAt": "2020-03-11T18:06:45Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_configuring_hotrod_jmx.adoc", "diffHunk": "@@ -13,8 +10,19 @@ Rod client statistics.\n \n [source,java]\n ----\n-include::code_examples/HotRodJmx.java[]\n+ConfigurationBuilder clientBuilder = new ConfigurationBuilder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2NzYyMg==", "bodyText": "Lines 30 should be before 29 or it won't compile.", "url": "https://github.com/infinispan/infinispan/pull/7979#discussion_r391167622", "createdAt": "2020-03-11T18:10:28Z", "author": {"login": "anistor"}, "path": "documentation/src/main/asciidoc/topics/proc_naming_cache_managers.adoc", "diffHunk": "@@ -14,15 +14,21 @@ name, which results in a JMX MBean named `org.infinispan:type=CacheManager,name=\n \n [source,xml,options=\"nowrap\",subs=attributes+]\n ----\n-include::config_examples/jmx_statistics_cache_manager.xml[]\n+<cache-container name=\"Hibernate2LC\">\n+  <jmx enabled=\"true\" />\n+  ...\n+</cache-container>\n ----\n \n \n .Programmatically\n \n [source,java]\n ----\n-include::code_examples/JmxStatisticsCacheManager.java[]\n+GlobalConfiguration globalConfig = new GlobalConfigurationBuilder()\n+  .jmx().enable()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13938c4c19c5c3e7cdb29b7b876f918d6291b56e", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/13938c4c19c5c3e7cdb29b7b876f918d6291b56e", "committedDate": "2020-03-11T19:34:48Z", "message": "ISPN-11393 statistics, metrics, jmx"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa07e363f1a382b759d1b25aa112a68815eb8af4", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/aa07e363f1a382b759d1b25aa112a68815eb8af4", "committedDate": "2020-03-11T16:41:28Z", "message": "ISPN-11393 statistics, metrics, jmx"}, "afterCommit": {"oid": "13938c4c19c5c3e7cdb29b7b876f918d6291b56e", "author": {"user": {"login": "oraNod", "name": "Don Naro"}}, "url": "https://github.com/infinispan/infinispan/commit/13938c4c19c5c3e7cdb29b7b876f918d6291b56e", "committedDate": "2020-03-11T19:34:48Z", "message": "ISPN-11393 statistics, metrics, jmx"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1049, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}