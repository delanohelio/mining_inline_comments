{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwNDIzNzcz", "number": 8849, "title": "ISPN-12496 Support port offset for JGroups ports in the server", "bodyText": "https://issues.redhat.com/browse/ISPN-12496", "createdAt": "2020-11-13T08:08:37Z", "url": "https://github.com/infinispan/infinispan/pull/8849", "merged": true, "mergeCommit": {"oid": "6db9903d30d33fe8f3a74401bdd469679981285b"}, "closed": true, "closedAt": "2020-11-19T14:46:32Z", "author": {"login": "tristantarrant"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddW-nygFqTUzMjIyMTM4NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddfyuVABqjQwMDc0NDQ3MjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMjIxMzg0", "url": "https://github.com/infinispan/infinispan/pull/8849#pullrequestreview-532221384", "createdAt": "2020-11-17T10:27:21Z", "commit": {"oid": "ea81e058fbe7c95b2f904870b49bc5bc8e821e0e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMDoyNzoyMVrOH0uO4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMDoyNzoyMVrOH0uO4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA0NTQ3NA==", "bodyText": "this is going to change the UDP & MPING ports.\nNodes aren't able to see each other anymore without manually setting this property.\nRunning these commands in 2 different terminals no longer form a cluster\n$ ./bin/server.sh \n$ ./bin/server.sh -s server2 -o 100", "url": "https://github.com/infinispan/infinispan/pull/8849#discussion_r525045474", "createdAt": "2020-11-17T10:27:21Z", "author": {"login": "pruivo"}, "path": "server/runtime/src/main/java/org/infinispan/server/Bootstrap.java", "diffHunk": "@@ -100,6 +100,13 @@ protected void handleArgumentCommand(String command, String parameter, Iterator<\n             // Fall through\n          case \"--port-offset\":\n             properties.setProperty(Server.INFINISPAN_PORT_OFFSET, parameter);\n+            int offset = Integer.parseInt(parameter);\n+            if (!properties.containsKey(Server.JGROUPS_BIND_PORT)) {\n+               properties.setProperty(Server.JGROUPS_BIND_PORT, Integer.toString(Server.DEFAULT_JGROUPS_BIND_PORT + offset));\n+            }\n+            if (!properties.containsKey(Server.JGROUPS_MCAST_PORT)) {\n+               properties.setProperty(Server.JGROUPS_MCAST_PORT, Integer.toString(Server.DEFAULT_JGROUPS_MCAST_PORT + offset));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea81e058fbe7c95b2f904870b49bc5bc8e821e0e"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMjIyODY1", "url": "https://github.com/infinispan/infinispan/pull/8849#pullrequestreview-532222865", "createdAt": "2020-11-17T10:29:01Z", "commit": {"oid": "ea81e058fbe7c95b2f904870b49bc5bc8e821e0e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMDoyOTowMlrOH0uTLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMDoyOTowMlrOH0uTLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA0NjU3Mg==", "bodyText": "JGroups increments the bind_port if it isn't available. Is this a user request? what's the use case?", "url": "https://github.com/infinispan/infinispan/pull/8849#discussion_r525046572", "createdAt": "2020-11-17T10:29:02Z", "author": {"login": "pruivo"}, "path": "server/runtime/src/main/java/org/infinispan/server/Bootstrap.java", "diffHunk": "@@ -100,6 +100,13 @@ protected void handleArgumentCommand(String command, String parameter, Iterator<\n             // Fall through\n          case \"--port-offset\":\n             properties.setProperty(Server.INFINISPAN_PORT_OFFSET, parameter);\n+            int offset = Integer.parseInt(parameter);\n+            if (!properties.containsKey(Server.JGROUPS_BIND_PORT)) {\n+               properties.setProperty(Server.JGROUPS_BIND_PORT, Integer.toString(Server.DEFAULT_JGROUPS_BIND_PORT + offset));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea81e058fbe7c95b2f904870b49bc5bc8e821e0e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53c0368708987e947615eab0c5079a7ee3444877", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/53c0368708987e947615eab0c5079a7ee3444877", "committedDate": "2020-11-17T20:43:14Z", "message": "ISPN-12496 Support port offset for JGroups ports in the server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea81e058fbe7c95b2f904870b49bc5bc8e821e0e", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/ea81e058fbe7c95b2f904870b49bc5bc8e821e0e", "committedDate": "2020-11-13T08:07:59Z", "message": "ISPN-12496 Support port offset for JGroups ports in the server"}, "afterCommit": {"oid": "53c0368708987e947615eab0c5079a7ee3444877", "author": {"user": {"login": "tristantarrant", "name": "Tristan Tarrant"}}, "url": "https://github.com/infinispan/infinispan/commit/53c0368708987e947615eab0c5079a7ee3444877", "committedDate": "2020-11-17T20:43:14Z", "message": "ISPN-12496 Support port offset for JGroups ports in the server"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 296, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}