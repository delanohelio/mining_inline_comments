{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTgzMzIw", "number": 8615, "title": "ISPN-11005 HotRod decoder small performance improvements", "bodyText": "https://issues.redhat.com/browse/ISPN-11005\n\nAvoid new byte[] instance when reading cache name\nImprove parsing and matching of media types\nSimplify copying of collections\nAvoid new array instance in withFlags(Flag)\nAvoid new lambda instance when stage is completed successfully\nUse HopscotchHashMap for GlobalMarshaller primitive ids\nSimplify ExtendedByteBufJava.readMaybeVInt() logic\nCall withFlags() only once in HotRodHeader.getOptimizedCache()\nDon't include key media type parameters in knownCaches key in\nRestCacheManager.getCache()", "createdAt": "2020-08-10T15:46:19Z", "url": "https://github.com/infinispan/infinispan/pull/8615", "merged": true, "mergeCommit": {"oid": "726304f106b8b8fb8f405abf235f23d45e56f331"}, "closed": true, "closedAt": "2020-09-10T08:06:32Z", "author": {"login": "danberindei"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_uhbBgBqjM2NjA4NzIyOTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHaDvDgBqjM3NDkwNTg3NjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c314d507dcf72edafaa7c3c30b923dedb6b8dba", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/1c314d507dcf72edafaa7c3c30b923dedb6b8dba", "committedDate": "2020-08-10T15:15:40Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Avoid new byte[] instance when reading cache name\n* Improve parsing and matching of media types\n* Simplify copying of collections\n* Avoid new array instance in withFlags(Flag)\n* Avoid new lambda instance when stage is completed successfully\n* Use HopscotchHashMap for GlobalMarshaller primitive ids\n* Simplify ExtendedByteBufJava.readMaybeVInt() logic\n* Call withFlags() only once in HotRodHeader.getOptimizedCache()\n* Don't include key media type parameters in knownCaches key in\n  RestCacheManager.getCache()"}, "afterCommit": {"oid": "8d83f2c4e38b3733f1dd6162bda2f4a3ac2e6cae", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/8d83f2c4e38b3733f1dd6162bda2f4a3ac2e6cae", "committedDate": "2020-08-14T09:33:28Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Avoid new byte[] instance when reading cache name\n* Improve parsing and matching of media types\n* Simplify copying of collections\n* Avoid new array instance in withFlags(Flag)\n* Avoid new lambda instance when stage is completed successfully\n* Use HopscotchHashMap for GlobalMarshaller primitive ids\n* Simplify ExtendedByteBufJava.readMaybeVInt() logic\n* Call withFlags() only once in HotRodHeader.getOptimizedCache()\n* Don't include key media type parameters in knownCaches key in\n  RestCacheManager.getCache()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NjIxNTY1", "url": "https://github.com/infinispan/infinispan/pull/8615#pullrequestreview-468621565", "createdAt": "2020-08-17T16:36:05Z", "commit": {"oid": "8d83f2c4e38b3733f1dd6162bda2f4a3ac2e6cae"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d83f2c4e38b3733f1dd6162bda2f4a3ac2e6cae", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/8d83f2c4e38b3733f1dd6162bda2f4a3ac2e6cae", "committedDate": "2020-08-14T09:33:28Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Avoid new byte[] instance when reading cache name\n* Improve parsing and matching of media types\n* Simplify copying of collections\n* Avoid new array instance in withFlags(Flag)\n* Avoid new lambda instance when stage is completed successfully\n* Use HopscotchHashMap for GlobalMarshaller primitive ids\n* Simplify ExtendedByteBufJava.readMaybeVInt() logic\n* Call withFlags() only once in HotRodHeader.getOptimizedCache()\n* Don't include key media type parameters in knownCaches key in\n  RestCacheManager.getCache()"}, "afterCommit": {"oid": "c981229a91170142374d9db568b8ce53a2a41dad", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/c981229a91170142374d9db568b8ce53a2a41dad", "committedDate": "2020-08-18T00:16:00Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Avoid new byte[] instance when reading cache name\n* Improve parsing and matching of media types\n* Simplify copying of collections\n* Avoid new array instance in withFlags(Flag)\n* Avoid new lambda instance when stage is completed successfully\n* Use HopscotchHashMap for GlobalMarshaller primitive ids\n* Simplify ExtendedByteBufJava.readMaybeVInt() logic\n* Call withFlags() only once in HotRodHeader.getOptimizedCache()\n* Don't include key media type parameters in knownCaches key in\n  RestCacheManager.getCache()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8d57503251885517a87159704d2f3cd14b2ac3e", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/f8d57503251885517a87159704d2f3cd14b2ac3e", "committedDate": "2020-08-18T14:10:04Z", "message": "ISPN-11005 Set server name in Hot Rod client tests"}, "afterCommit": {"oid": "fecb12b44783dae38bd9bf02ceb8982fb6f42283", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/fecb12b44783dae38bd9bf02ceb8982fb6f42283", "committedDate": "2020-09-06T13:30:22Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Allow space and tab between media type subtype and parameters\n* Don't allow spaces between type and subtype,\n  or between parameter name and parameter value"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fecb12b44783dae38bd9bf02ceb8982fb6f42283", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/fecb12b44783dae38bd9bf02ceb8982fb6f42283", "committedDate": "2020-09-06T13:30:22Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Allow space and tab between media type subtype and parameters\n* Don't allow spaces between type and subtype,\n  or between parameter name and parameter value"}, "afterCommit": {"oid": "269c74933c407c2fa0aa1237fe831cf72d89f863", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/269c74933c407c2fa0aa1237fe831cf72d89f863", "committedDate": "2020-09-07T08:46:45Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Allow space and tab between media type subtype and parameters\n* Don't allow spaces between type and subtype,\n  or between parameter name and parameter value\n* Unescape and remove quotes from quoted parameter values"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "269c74933c407c2fa0aa1237fe831cf72d89f863", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/269c74933c407c2fa0aa1237fe831cf72d89f863", "committedDate": "2020-09-07T08:46:45Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Allow space and tab between media type subtype and parameters\n* Don't allow spaces between type and subtype,\n  or between parameter name and parameter value\n* Unescape and remove quotes from quoted parameter values"}, "afterCommit": {"oid": "3985266a1e0803cecd2e38537e43ab03bc95341b", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/3985266a1e0803cecd2e38537e43ab03bc95341b", "committedDate": "2020-09-07T09:09:49Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Do not remove quotes or backlashes from quoted parameter values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNDAyMDA5", "url": "https://github.com/infinispan/infinispan/pull/8615#pullrequestreview-483402009", "createdAt": "2020-09-07T09:28:34Z", "commit": {"oid": "3985266a1e0803cecd2e38537e43ab03bc95341b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwOToyODozNFrOHN38Bw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwOToyODozNFrOHN38Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMxMDAyMw==", "bodyText": "Is this faster than the current code on master?", "url": "https://github.com/infinispan/infinispan/pull/8615#discussion_r484310023", "createdAt": "2020-09-07T09:28:34Z", "author": {"login": "gustavonalle"}, "path": "commons/all/src/main/java/org/infinispan/commons/dataconversion/MediaType.java", "diffHunk": "@@ -33,6 +36,22 @@\n @ProtoTypeId(ProtoStreamTypeIds.MEDIA_TYPE)\n @SerializeWith(value = MediaType.MediaTypeExternalizer.class)\n public final class MediaType {\n+   private static final Pattern TREE_PATTERN;\n+   private static final Pattern PARAMETER_PATTERN;\n+\n+   static {\n+      // Adapted from https://stackoverflow.com/a/48046041/55870\n+      // Extended to support \"*\" as a media type (as used by java.net.HttpURLConnection)\n+      // More details at https://bugs.openjdk.java.net/browse/JDK-8163921\n+      // and https://tools.ietf.org/html/rfc7231#section-3.1.1.1\n+      String ows = \"[ \\t]*\";\n+      String token = \"[0-9A-Za-z!#$%&'*+.^_`|~-]+\";\n+      String quotedString = \"\\\"(?:[^\\\"\\\\\\\\]|\\\\\\\\.)*\\\"\";\n+      String tree = ows + \"((\" + token + \")/\" + token + \"|\\\\*)\" + ows;\n+      String parameter = \";\" + ows + \"(\" + token + \")=(\" + token + \"|\" + quotedString + \")\" + ows;\n+      TREE_PATTERN = Pattern.compile(tree);\n+      PARAMETER_PATTERN = Pattern.compile(parameter);\n+   }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3985266a1e0803cecd2e38537e43ab03bc95341b"}, "originalPosition": 35}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3985266a1e0803cecd2e38537e43ab03bc95341b", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/3985266a1e0803cecd2e38537e43ab03bc95341b", "committedDate": "2020-09-07T09:09:49Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Do not remove quotes or backlashes from quoted parameter values"}, "afterCommit": {"oid": "6bc818f69c58bcaecabba589f9b74a76771f1d49", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/6bc818f69c58bcaecabba589f9b74a76771f1d49", "committedDate": "2020-09-07T10:02:11Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Do not remove quotes or backlashes from quoted parameter values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa24ff8612268582320b9eb07602acb9738f2820", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/fa24ff8612268582320b9eb07602acb9738f2820", "committedDate": "2020-09-09T19:51:56Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Avoid new byte[] instance when reading cache name\n* Simplify matching of media types\n* Simplify copying of collections\n* Avoid new array instance in withFlags(Flag)\n* Avoid new lambda instance when stage is completed successfully\n* Use HopscotchHashMap for GlobalMarshaller primitive ids\n* Simplify ExtendedByteBufJava.readMaybeVInt() logic\n* Call withFlags() only once in HotRodHeader.getOptimizedCache()\n* Don't include key media type parameters in knownCaches key in\n  RestCacheManager.getCache()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "841723fa994f5628ce2e26ce7a2655faccd451cc", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/841723fa994f5628ce2e26ce7a2655faccd451cc", "committedDate": "2020-09-09T19:57:14Z", "message": "ISPN-11005 Set server name in Hot Rod client tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6bc818f69c58bcaecabba589f9b74a76771f1d49", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/6bc818f69c58bcaecabba589f9b74a76771f1d49", "committedDate": "2020-09-07T10:02:11Z", "message": "ISPN-11005 HotRod decoder small performance improvements\n\n* Do not remove quotes or backlashes from quoted parameter values"}, "afterCommit": {"oid": "841723fa994f5628ce2e26ce7a2655faccd451cc", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/841723fa994f5628ce2e26ce7a2655faccd451cc", "committedDate": "2020-09-09T19:57:14Z", "message": "ISPN-11005 Set server name in Hot Rod client tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 411, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}