{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzODY4MTcx", "number": 8921, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwODo1MToyMlrOFCzhIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzozMzozOVrOFC7SkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NDg1NTM4OnYy", "diffSide": "RIGHT", "path": "client/hotrod-client/src/main/java/org/infinispan/client/hotrod/impl/transaction/XaModeTransactionTable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwODo1MToyMlrOICJLVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwODo1MToyMlrOICJLVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTExODQyMA==", "bodyText": "We should remove the method in AbstractTransactionTable", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539118420", "createdAt": "2020-12-09T08:51:22Z", "author": {"login": "danberindei"}, "path": "client/hotrod-client/src/main/java/org/infinispan/client/hotrod/impl/transaction/XaModeTransactionTable.java", "diffHunk": "@@ -68,7 +67,7 @@ Log getLog() {\n \n    @Override\n    boolean isTraceLogEnabled() {\n-      return trace;\n+      return log.isTraceEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NTk1MTExOnYy", "diffSide": "RIGHT", "path": "server/hotrod/src/main/java/org/infinispan/server/hotrod/tx/operation/RollbackTransactionOperation.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1NDo0MFrOICTMaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1NDo0MFrOICTMaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI4MjUzNg==", "bodyText": "We should remove isTraceEnabled() and getLog()", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539282536", "createdAt": "2020-12-09T12:54:40Z", "author": {"login": "danberindei"}, "path": "server/hotrod/src/main/java/org/infinispan/server/hotrod/tx/operation/RollbackTransactionOperation.java", "diffHunk": "@@ -162,7 +161,7 @@ Log log() {\n \n    @Override\n    boolean isTraceEnabled() {\n-      return trace;\n+      return log.isTraceEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NTk3MzkxOnYy", "diffSide": "RIGHT", "path": "hibernate/cache-commons/src/test/java/org/infinispan/test/hibernate/cache/commons/functional/ConcurrentWriteTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1OTozN1rOICTZdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1OTozN1rOICTZdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI4NTg3OQ==", "bodyText": "We should remove the if (trace) checks from tests IMO", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539285879", "createdAt": "2020-12-09T12:59:37Z", "author": {"login": "danberindei"}, "path": "hibernate/cache-commons/src/test/java/org/infinispan/test/hibernate/cache/commons/functional/ConcurrentWriteTest.java", "diffHunk": "@@ -349,36 +348,36 @@ public Void call() throws Exception {\n \t\t\ttry {\n \t\t\t\tfor ( int i = 0; i < ITERATION_COUNT && !TERMINATE_ALL_USERS; i++ ) {\n \t\t\t\t\tcontactExists();\n-\t\t\t\t\tif ( trace ) {\n+\t\t\t\t\tif ( log.isTraceEnabled() ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjAwNTIwOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateConsumerImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowNjo1MlrOICTsDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowNjo1MlrOICTsDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI5MDYzNw==", "bodyText": "I don't think if (log.isDebugEnabled()) is justified, there are just too few invocations.", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539290637", "createdAt": "2020-12-09T13:06:52Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateConsumerImpl.java", "diffHunk": "@@ -54,7 +52,7 @@\n \n    @Override\n    public void startStateTransfer(String sendingSite) {\n-      if (debug) {\n+      if (log.isDebugEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjAxMjU5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateProviderImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowODo0MFrOICTwew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowODo0MFrOICTwew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI5MTc3MQ==", "bodyText": "This is wrong IMO. We shouldn't log individual chunks at DEBUG level because the number of chunks depends on the number of entries (and the chunk size).", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539291771", "createdAt": "2020-12-09T13:08:40Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateProviderImpl.java", "diffHunk": "@@ -163,10 +161,10 @@ private void sendFromSharedBuffer(XSiteBackup xSiteBackup, List<XSiteState> shar\n       }\n       XSiteState[] privateBuffer = sharedBuffer.toArray(new XSiteState[0]);\n \n-      if (trace) {\n+      if (log.isTraceEnabled()) {\n          log.debugf(\"Sending chunk to site '%s'. Chunk contains %s\", xSiteBackup.getSiteName(),\n                     Arrays.toString(privateBuffer));\n-      } else if (debug) {\n+      } else if (log.isDebugEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjAxNzQ3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateTransferManagerImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowOTo0NFrOICTzTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzowOTo0NFrOICTzTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI5MjQ5Mw==", "bodyText": "Again, no if needed for debug logs.", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539292493", "createdAt": "2020-12-09T13:09:44Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/xsite/statetransfer/XSiteStateTransferManagerImpl.java", "diffHunk": "@@ -142,7 +140,7 @@ public final void startPushState(String siteName) throws Throwable {\n             CacheRpcCommand command = commandsFactory.buildXSiteStateTransferStartSendCommand(siteName, currentTopologyId());\n             controlStateTransferOnLocalSite(command);\n          } else {\n-            if (debug) {\n+            if (log.isDebugEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjAxOTE2OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/org/infinispan/conflict/impl/BaseMergePolicyTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoxMDoxMVrOICT0Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoxMDoxMVrOICT0Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI5Mjc1NQ==", "bodyText": "Not needed for tests.", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539292755", "createdAt": "2020-12-09T13:10:11Z", "author": {"login": "danberindei"}, "path": "core/src/test/java/org/infinispan/conflict/impl/BaseMergePolicyTest.java", "diffHunk": "@@ -122,20 +121,20 @@ protected void afterConflictResolutionAndMerge() {\n    }\n \n    public void testPartitionMergePolicy() throws Exception {\n-      if (trace) log.tracef(\"beforeSplit()\");\n+      if (log.isTraceEnabled()) log.tracef(\"beforeSplit()\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjAzNzYyOnYy", "diffSide": "LEFT", "path": "core/src/main/java/org/infinispan/xsite/ClusteredCacheBackupReceiver.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoxNDoyOVrOICT_Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoxNDoyOVrOICT_Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI5NTUyNw==", "bodyText": ":))", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539295527", "createdAt": "2020-12-09T13:14:29Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/xsite/ClusteredCacheBackupReceiver.java", "diffHunk": "@@ -95,7 +95,6 @@\n public class ClusteredCacheBackupReceiver implements BackupReceiver {\n \n    private static final Log log = LogFactory.getLog(ClusteredCacheBackupReceiver.class);\n-   private static final boolean trace = log.isDebugEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjA3OTI3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/remoting/inboundhandler/TxPerCacheInboundInvocationHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyMzoyMVrOICUW2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyMzoyMVrOICUW2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwMTU5Mg==", "bodyText": "We should remove isTraceEnabled() and getLog().", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539301592", "createdAt": "2020-12-09T13:23:21Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/remoting/inboundhandler/TxPerCacheInboundInvocationHandler.java", "diffHunk": "@@ -99,7 +98,7 @@ protected Log getLog() {\n \n    @Override\n    protected boolean isTraceEnabled() {\n-      return trace;\n+      return log.isTraceEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjA5NjM3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/persistence/support/NonBlockingStoreAdapter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyNjo1MlrOICUgyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyNjo1MlrOICUgyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwNDEzOA==", "bodyText": "IMO we should always create the AtomicInteger, and we should only check log.isTraceEnabled() in nextTraceId().", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539304138", "createdAt": "2020-12-09T13:26:52Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/persistence/support/NonBlockingStoreAdapter.java", "diffHunk": "@@ -41,8 +41,7 @@\n \n public class NonBlockingStoreAdapter<K, V> implements NonBlockingStore<K, V> {\n    private static final Log log = LogFactory.getLog(MethodHandles.lookup().lookupClass());\n-   private static final boolean trace = log.isTraceEnabled();\n-   private static final AtomicInteger id = trace ? new AtomicInteger() : null;\n+   private final AtomicInteger id = log.isTraceEnabled() ? new AtomicInteger() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjEwMjcxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/infinispan/remoting/inboundhandler/NonTxPerCacheInboundInvocationHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyODoxMFrOICUkpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzoyODoxMFrOICUkpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwNTEyNA==", "bodyText": "We should remove isTraceEnabled() and getLog()", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539305124", "createdAt": "2020-12-09T13:28:10Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/remoting/inboundhandler/NonTxPerCacheInboundInvocationHandler.java", "diffHunk": "@@ -104,7 +103,7 @@ protected Log getLog() {\n \n    @Override\n    protected boolean isTraceEnabled() {\n-      return trace;\n+      return log.isTraceEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjEyODgwOnYy", "diffSide": "LEFT", "path": "core/src/main/java/org/infinispan/interceptors/xsite/BaseBackupInterceptor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzozMzozOVrOICUzzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMzozMzozOVrOICUzzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwOTAwNQ==", "bodyText": "log should be private", "url": "https://github.com/infinispan/infinispan/pull/8921#discussion_r539309005", "createdAt": "2020-12-09T13:33:39Z", "author": {"login": "danberindei"}, "path": "core/src/main/java/org/infinispan/interceptors/xsite/BaseBackupInterceptor.java", "diffHunk": "@@ -40,7 +40,6 @@\n    @Inject protected ClusteringDependentLogic clusteringDependentLogic;\n \n    protected static final Log log = LogFactory.getLog(BaseBackupInterceptor.class);\n-   protected static final boolean trace = log.isTraceEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ae34d35e1367d48a1be65c6311540cac649e8fb"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3711, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}