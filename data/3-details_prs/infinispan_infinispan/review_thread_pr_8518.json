{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxOTUxMDg0", "number": 8518, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjozMTo1N1rOEKEyZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjozMTo1N1rOEKEyZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4OTk5NjU1OnYy", "diffSide": "RIGHT", "path": "server/rest/src/test/java/org/infinispan/rest/Http2Test.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjozMTo1N1rOGq6GQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjo1MjowNlrOGq61uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY0NTI0OQ==", "bodyText": "shouldn't use HTTP2?", "url": "https://github.com/infinispan/infinispan/pull/8518#discussion_r447645249", "createdAt": "2020-06-30T12:31:57Z", "author": {"login": "pruivo"}, "path": "server/rest/src/test/java/org/infinispan/rest/Http2Test.java", "diffHunk": "@@ -68,6 +69,28 @@ public void shouldUseHTTP2WithPriorKnowledge() throws Exception {\n       clearTextUpgrade(true);\n    }\n \n+   @Test\n+   public void shouldReportErrorCorrectly() throws Exception {\n+      restServer = RestServerHelper.defaultRestServer()\n+            .withKeyStore(KEY_STORE_PATH, \"secret\", \"pkcs12\")\n+            .withTrustStore(KEY_STORE_PATH, \"secret\", \"pkcs12\")\n+            .start(TestResourceTracker.getCurrentTestShortName());\n+\n+      RestClientConfigurationBuilder config = new RestClientConfigurationBuilder();\n+\n+      config.addServer().host(restServer.getHost()).port(restServer.getPort())\n+            .protocol(HTTP_20).priorKnowledge(true)\n+            .security().ssl().enable()\n+            .trustStoreFileName(KEY_STORE_PATH).trustStorePassword(\"secret\".toCharArray()).trustStoreType(\"pkcs12\")\n+            .keyStoreFileName(KEY_STORE_PATH).keyStorePassword(\"secret\".toCharArray()).keyStoreType(\"pkcs12\");\n+\n+      client = NettyHttpClient.forConfiguration(config.build());\n+\n+      FullHttpRequest getRequest = new DefaultFullHttpRequest(HTTP_1_1, GET, \"invalid\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9362633c04c40f186f6c66c0d36ec8092faf5956"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY1NzQwMw==", "bodyText": "The DefaultFullHttpRequest doesn't support it, but the client is configured as HTTP/2, so it will pass the request through a HTTP/2 pipeline", "url": "https://github.com/infinispan/infinispan/pull/8518#discussion_r447657403", "createdAt": "2020-06-30T12:52:06Z", "author": {"login": "gustavonalle"}, "path": "server/rest/src/test/java/org/infinispan/rest/Http2Test.java", "diffHunk": "@@ -68,6 +69,28 @@ public void shouldUseHTTP2WithPriorKnowledge() throws Exception {\n       clearTextUpgrade(true);\n    }\n \n+   @Test\n+   public void shouldReportErrorCorrectly() throws Exception {\n+      restServer = RestServerHelper.defaultRestServer()\n+            .withKeyStore(KEY_STORE_PATH, \"secret\", \"pkcs12\")\n+            .withTrustStore(KEY_STORE_PATH, \"secret\", \"pkcs12\")\n+            .start(TestResourceTracker.getCurrentTestShortName());\n+\n+      RestClientConfigurationBuilder config = new RestClientConfigurationBuilder();\n+\n+      config.addServer().host(restServer.getHost()).port(restServer.getPort())\n+            .protocol(HTTP_20).priorKnowledge(true)\n+            .security().ssl().enable()\n+            .trustStoreFileName(KEY_STORE_PATH).trustStorePassword(\"secret\".toCharArray()).trustStoreType(\"pkcs12\")\n+            .keyStoreFileName(KEY_STORE_PATH).keyStorePassword(\"secret\".toCharArray()).keyStoreType(\"pkcs12\");\n+\n+      client = NettyHttpClient.forConfiguration(config.build());\n+\n+      FullHttpRequest getRequest = new DefaultFullHttpRequest(HTTP_1_1, GET, \"invalid\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY0NTI0OQ=="}, "originalCommit": {"oid": "9362633c04c40f186f6c66c0d36ec8092faf5956"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3958, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}