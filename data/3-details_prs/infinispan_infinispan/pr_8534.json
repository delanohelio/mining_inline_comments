{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MjQwOTIx", "number": 8534, "title": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist", "bodyText": "https://issues.redhat.com/browse/ISPN-12098", "createdAt": "2020-07-08T13:23:40Z", "url": "https://github.com/infinispan/infinispan/pull/8534", "merged": true, "mergeCommit": {"oid": "b44dedd910b967479b79ec854a0a60f930eace31"}, "closed": true, "closedAt": "2020-07-10T13:12:34Z", "author": {"login": "gustavolira"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcy6zENABqjM1MjUzNDAwMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczRUmBABqjM1MzA0Mjk4NTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9bccb5dfecfee0951d407abb7b3429b64e826785", "author": {"user": {"login": "gustavolira", "name": "Gustavo Lira e Silva"}}, "url": "https://github.com/infinispan/infinispan/commit/9bccb5dfecfee0951d407abb7b3429b64e826785", "committedDate": "2020-07-08T13:19:51Z", "message": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist"}, "afterCommit": {"oid": "a01b67f576016db6c33ab3023d1859cd727a591e", "author": {"user": {"login": "gustavolira", "name": "Gustavo Lira e Silva"}}, "url": "https://github.com/infinispan/infinispan/commit/a01b67f576016db6c33ab3023d1859cd727a591e", "committedDate": "2020-07-08T13:52:13Z", "message": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1Mzk5Njg2", "url": "https://github.com/infinispan/infinispan/pull/8534#pullrequestreview-445399686", "createdAt": "2020-07-09T08:30:15Z", "commit": {"oid": "a01b67f576016db6c33ab3023d1859cd727a591e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODozMDoxNVrOGvHFNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODozMDoxNVrOGvHFNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA1MjI3Nw==", "bodyText": "If we do String index = rs.getString(\"INDEX_NAME\"); if (index != null ...) we only make a single call to the JDBC driver. From the ResultSet docs:\nFor maximum portability, result set columns within each row should be read in left-to-right order, and each column should be read only once.\n\nhttps://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html", "url": "https://github.com/infinispan/infinispan/pull/8534#discussion_r452052277", "createdAt": "2020-07-09T08:30:15Z", "author": {"login": "ryanemerson"}, "path": "persistence/jdbc/src/main/java/org/infinispan/persistence/jdbc/impl/table/SybaseTableManager.java", "diffHunk": "@@ -65,4 +72,24 @@ protected String initUpsertRowSql() {\n                config.segmentColumnName());\n       }\n    }\n+\n+   @Override\n+   protected boolean indexExists(String indexName, Connection conn) throws PersistenceException {\n+      ResultSet rs = null;\n+      try {\n+         DatabaseMetaData meta = conn.getMetaData();\n+         rs = meta.getIndexInfo(null, tableName.getSchema(), tableName.getName(), false, false);\n+\n+         while (rs.next()) {\n+            if (rs.getString(\"INDEX_NAME\") != null && indexName.equalsIgnoreCase(rs.getString(\"INDEX_NAME\").replaceAll(\"\\\"\", \"\"))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a01b67f576016db6c33ab3023d1859cd727a591e"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c4837ed15afec3302efef83cc755fe3c1883ae9", "author": {"user": {"login": "gustavolira", "name": "Gustavo Lira e Silva"}}, "url": "https://github.com/infinispan/infinispan/commit/8c4837ed15afec3302efef83cc755fe3c1883ae9", "committedDate": "2020-07-09T16:06:15Z", "message": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a01b67f576016db6c33ab3023d1859cd727a591e", "author": {"user": {"login": "gustavolira", "name": "Gustavo Lira e Silva"}}, "url": "https://github.com/infinispan/infinispan/commit/a01b67f576016db6c33ab3023d1859cd727a591e", "committedDate": "2020-07-08T13:52:13Z", "message": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist"}, "afterCommit": {"oid": "8c4837ed15afec3302efef83cc755fe3c1883ae9", "author": {"user": {"login": "gustavolira", "name": "Gustavo Lira e Silva"}}, "url": "https://github.com/infinispan/infinispan/commit/8c4837ed15afec3302efef83cc755fe3c1883ae9", "committedDate": "2020-07-09T16:06:15Z", "message": "ISPN-12098 JDBC String Base Cache Store (sybase160) trying to create an index when already exist"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 510, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}