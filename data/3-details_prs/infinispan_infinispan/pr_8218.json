{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MjEzNzI2", "number": 8218, "title": "ISPN-11678 IndexModificationStrategy removal + ISPN-11712 Indexing auto-enabling based on <indexing> presence", "bodyText": "IndexModificationStrategy is mostly degenerated after all the recent removals and can be removed entirely and its code merged into QueryInterceptor\nhttps://issues.redhat.com/browse/ISPN-11678\n\n\n<indexing enabled=\"true\"> should be replaced simply with <indexing>\nhttps://issues.redhat.com/browse/ISPN-11712\n\n\nhttps://issues.redhat.com/browse/ISPN-11715\n\n\nhttps://issues.redhat.com/browse/ISPN-11716", "createdAt": "2020-04-20T18:00:11Z", "url": "https://github.com/infinispan/infinispan/pull/8218", "merged": true, "mergeCommit": {"oid": "db54929d47f98e32af831d00e78214250a43823e"}, "closed": true, "closedAt": "2020-04-29T13:33:08Z", "author": {"login": "anistor"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZuFTigFqTM5NzAzNjU5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccWxtRAFqTQwMjU3ODMyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MDM2NTkw", "url": "https://github.com/infinispan/infinispan/pull/8218#pullrequestreview-397036590", "createdAt": "2020-04-21T06:55:31Z", "commit": {"oid": "5ee4c6e6eaa3dac7f6d2e30f8082122fb65cdb0f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwNjo1NTozMlrOGI1mPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwNjo1NTozMlrOGI1mPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkxOTkzNQ==", "bodyText": "It still need to read somehow the configured Index, since it is deprecated, not removed. Index.PRIMARY_OWNER should probably throw an exception since it is not a safe option for non-shared indexes,and we removed all shared index managers.  When configured, Index.NONE and Index.ALL should be respected over the automatic detection", "url": "https://github.com/infinispan/infinispan/pull/8218#discussion_r411919935", "createdAt": "2020-04-21T06:55:32Z", "author": {"login": "gustavonalle"}, "path": "query/src/main/java/org/infinispan/query/impl/LifecycleManager.java", "diffHunk": "@@ -134,8 +133,7 @@ private void createQueryInterceptorIfNeeded(ComponentRegistry cr, Configuration\n       }\n \n       ConcurrentMap<GlobalTransaction, Map<Object, Object>> txOldValues = new ConcurrentHashMap<>();\n-      IndexModificationStrategy indexingStrategy = IndexModificationStrategy.configuredStrategy(searchIntegrator, cfg);\n-      QueryInterceptor queryInterceptor = new QueryInterceptor(searchIntegrator, keyTransformationHandler, indexingStrategy, txOldValues, cache);\n+      QueryInterceptor queryInterceptor = new QueryInterceptor(searchIntegrator, keyTransformationHandler, txOldValues, cache);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ee4c6e6eaa3dac7f6d2e30f8082122fb65cdb0f"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5ee4c6e6eaa3dac7f6d2e30f8082122fb65cdb0f", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/5ee4c6e6eaa3dac7f6d2e30f8082122fb65cdb0f", "committedDate": "2020-04-20T17:56:46Z", "message": "ISPN-11678 IndexModificationStrategy has become a degenerated enum after all the recent removals and can be removed entirely"}, "afterCommit": {"oid": "50b4e20e9cdcf0fc78e31f64a875f8b19a9434bd", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/50b4e20e9cdcf0fc78e31f64a875f8b19a9434bd", "committedDate": "2020-04-21T07:14:21Z", "message": "ISPN-11678 IndexModificationStrategy has become a degenerated enum after all the recent removals and can be removed entirely"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50b4e20e9cdcf0fc78e31f64a875f8b19a9434bd", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/50b4e20e9cdcf0fc78e31f64a875f8b19a9434bd", "committedDate": "2020-04-21T07:14:21Z", "message": "ISPN-11678 IndexModificationStrategy has become a degenerated enum after all the recent removals and can be removed entirely"}, "afterCommit": {"oid": "93ecd18a9fa5d41f6bf5531aa9f9ab3143a0dd3d", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/93ecd18a9fa5d41f6bf5531aa9f9ab3143a0dd3d", "committedDate": "2020-04-21T11:46:20Z", "message": "Remove IndexModificationStrategy\n\n* remove unused method ComponentRegistryUtils.getIndexInspector, we should always use @Inject if possible"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93ecd18a9fa5d41f6bf5531aa9f9ab3143a0dd3d", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/93ecd18a9fa5d41f6bf5531aa9f9ab3143a0dd3d", "committedDate": "2020-04-21T11:46:20Z", "message": "Remove IndexModificationStrategy\n\n* remove unused method ComponentRegistryUtils.getIndexInspector, we should always use @Inject if possible"}, "afterCommit": {"oid": "c1b6ec1cbe75f67ef4d0fcaf6d6f9697baac2866", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c1b6ec1cbe75f67ef4d0fcaf6d6f9697baac2866", "committedDate": "2020-04-22T09:56:38Z", "message": "Remove IndexModificationStrategy\n\n* remove unused method ComponentRegistryUtils.getIndexInspector, we should always use @Inject if possible"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1b6ec1cbe75f67ef4d0fcaf6d6f9697baac2866", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c1b6ec1cbe75f67ef4d0fcaf6d6f9697baac2866", "committedDate": "2020-04-22T09:56:38Z", "message": "Remove IndexModificationStrategy\n\n* remove unused method ComponentRegistryUtils.getIndexInspector, we should always use @Inject if possible"}, "afterCommit": {"oid": "e349b3162feb0568dbce3d025782be906e2dd0cd", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/e349b3162feb0568dbce3d025782be906e2dd0cd", "committedDate": "2020-04-22T11:18:14Z", "message": "Remove unused IndexingConfigurationBuilder.index() package-local getter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e349b3162feb0568dbce3d025782be906e2dd0cd", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/e349b3162feb0568dbce3d025782be906e2dd0cd", "committedDate": "2020-04-22T11:18:14Z", "message": "Remove unused IndexingConfigurationBuilder.index() package-local getter"}, "afterCommit": {"oid": "252893a1e516d0641ac201ad743a754c577ee49b", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/252893a1e516d0641ac201ad743a754c577ee49b", "committedDate": "2020-04-22T11:33:11Z", "message": "Remove unused IndexingConfigurationBuilder.index() package-local getter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "252893a1e516d0641ac201ad743a754c577ee49b", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/252893a1e516d0641ac201ad743a754c577ee49b", "committedDate": "2020-04-22T11:33:11Z", "message": "Remove unused IndexingConfigurationBuilder.index() package-local getter"}, "afterCommit": {"oid": "83f15f9b76b0bce881f4d6c70bd0251f1af982e4", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/83f15f9b76b0bce881f4d6c70bd0251f1af982e4", "committedDate": "2020-04-23T10:00:03Z", "message": "Remove need for explicit index enable from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83f15f9b76b0bce881f4d6c70bd0251f1af982e4", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/83f15f9b76b0bce881f4d6c70bd0251f1af982e4", "committedDate": "2020-04-23T10:00:03Z", "message": "Remove need for explicit index enable from xml configs"}, "afterCommit": {"oid": "c1b8fd9bcebdfbc625e2d1852ea52c1cc5f26dd8", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c1b8fd9bcebdfbc625e2d1852ea52c1cc5f26dd8", "committedDate": "2020-04-23T12:27:10Z", "message": "Remove need for explicit index enable from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1b8fd9bcebdfbc625e2d1852ea52c1cc5f26dd8", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c1b8fd9bcebdfbc625e2d1852ea52c1cc5f26dd8", "committedDate": "2020-04-23T12:27:10Z", "message": "Remove need for explicit index enable from xml configs"}, "afterCommit": {"oid": "295330cbb586ae084a263f85e649918f74135993", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/295330cbb586ae084a263f85e649918f74135993", "committedDate": "2020-04-23T16:06:52Z", "message": "Remove need for explicit index enable from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "295330cbb586ae084a263f85e649918f74135993", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/295330cbb586ae084a263f85e649918f74135993", "committedDate": "2020-04-23T16:06:52Z", "message": "Remove need for explicit index enable from xml configs"}, "afterCommit": {"oid": "6ee3c64617b06c7f3cdc90f434b1b0ec4dba8ce1", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/6ee3c64617b06c7f3cdc90f434b1b0ec4dba8ce1", "committedDate": "2020-04-25T07:27:30Z", "message": "Remove need for explicit index enable from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ee3c64617b06c7f3cdc90f434b1b0ec4dba8ce1", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/6ee3c64617b06c7f3cdc90f434b1b0ec4dba8ce1", "committedDate": "2020-04-25T07:27:30Z", "message": "Remove need for explicit index enable from xml configs"}, "afterCommit": {"oid": "566824ccabf36a8e0725982603731cc95ec1992c", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/566824ccabf36a8e0725982603731cc95ec1992c", "committedDate": "2020-04-27T07:01:22Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjc2MjAz", "url": "https://github.com/infinispan/infinispan/pull/8218#pullrequestreview-400676203", "createdAt": "2020-04-27T07:05:03Z", "commit": {"oid": "6ee3c64617b06c7f3cdc90f434b1b0ec4dba8ce1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzowNTozMVrOGMT5zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzowNTozMVrOGMT5zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU2MjE5MA==", "bodyText": "Can we remove unused parameters from here @gustavonalle ?", "url": "https://github.com/infinispan/infinispan/pull/8218#discussion_r415562190", "createdAt": "2020-04-27T07:05:31Z", "author": {"login": "anistor"}, "path": "query/src/main/java/org/infinispan/query/backend/QueryInterceptor.java", "diffHunk": "@@ -138,19 +135,18 @@ public void prepareForStopping() {\n       stopping.set(true);\n    }\n \n+   //todo [anistor] parameter 'value' is never used", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "566824ccabf36a8e0725982603731cc95ec1992c"}, "originalPosition": 38}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "566824ccabf36a8e0725982603731cc95ec1992c", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/566824ccabf36a8e0725982603731cc95ec1992c", "committedDate": "2020-04-27T07:01:22Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}, "afterCommit": {"oid": "8f609b1fe383bb0ac9deda1a13d5fbde67b0abf4", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/8f609b1fe383bb0ac9deda1a13d5fbde67b0abf4", "committedDate": "2020-04-27T10:27:50Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f609b1fe383bb0ac9deda1a13d5fbde67b0abf4", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/8f609b1fe383bb0ac9deda1a13d5fbde67b0abf4", "committedDate": "2020-04-27T10:27:50Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}, "afterCommit": {"oid": "c263a719ed18addcc29720b7fd7a8abed92747c7", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c263a719ed18addcc29720b7fd7a8abed92747c7", "committedDate": "2020-04-28T14:35:49Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c263a719ed18addcc29720b7fd7a8abed92747c7", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/c263a719ed18addcc29720b7fd7a8abed92747c7", "committedDate": "2020-04-28T14:35:49Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}, "afterCommit": {"oid": "262a2ea33f6845ade32063e2780ea1727b1ec492", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/262a2ea33f6845ade32063e2780ea1727b1ec492", "committedDate": "2020-04-28T20:43:46Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "262a2ea33f6845ade32063e2780ea1727b1ec492", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/262a2ea33f6845ade32063e2780ea1727b1ec492", "committedDate": "2020-04-28T20:43:46Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}, "afterCommit": {"oid": "02c2ef108bded1655f183f82b12c4643e5d8f1fc", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/02c2ef108bded1655f183f82b12c4643e5d8f1fc", "committedDate": "2020-04-29T06:57:51Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "458e14551688c37a127b14e3c46f2def7e2b7787", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/458e14551688c37a127b14e3c46f2def7e2b7787", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11678 IndexModificationStrategy has become a degenerated enum after all the recent removals and can be removed entirely\n\n* there are only two strategies left: ALL, MANUAL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d299539f54e351e5a57784caddf8a9ba794c77c", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/3d299539f54e351e5a57784caddf8a9ba794c77c", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11678 Remove IndexModificationStrategy\n\n* the behaviour of MANUAL/ALL can be moved to QueryInteceptor\n* also remove unused method ComponentRegistryUtils.getIndexInspector (we should always use @Inject if possible)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adc9ce1ed8e6a76757640a9ba72e963ca8e8f43a", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/adc9ce1ed8e6a76757640a9ba72e963ca8e8f43a", "committedDate": "2020-04-29T11:20:51Z", "message": "Validation for local indexing no longer needed in AbstractStoreConfigurationBuilder\n\n* this configuration case is not longer possible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1080964b0e479c00f034dac20e5401cc1db1e96", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/b1080964b0e479c00f034dac20e5401cc1db1e96", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11715 Indexing autoConfig should not override the manual activation/deactivation of indexing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb216afdc09d1d4e7819b09c024b5a042edeeb74", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/cb216afdc09d1d4e7819b09c024b5a042edeeb74", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11716 Setting the legacy index mode should not override the manual activation/deactivation of indexing\n\n* these two must be mutually exclusive and an exception should be thrown\n* remove unused IndexingConfigurationBuilder.index() package-local getter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2037c4788fcb792d55782c64ca3bca339518256", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/e2037c4788fcb792d55782c64ca3bca339518256", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11712 Indexing should be enabled by default if the <indexing> element is present and the \"enabled\" attribute is missing\n\n* this cannot be fixed trivially by changing the xsd default"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f1c2c403a487e0ef215df1c4c953e38416fa1e5", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/4f1c2c403a487e0ef215df1c4c953e38416fa1e5", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02c2ef108bded1655f183f82b12c4643e5d8f1fc", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/02c2ef108bded1655f183f82b12c4643e5d8f1fc", "committedDate": "2020-04-29T06:57:51Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}, "afterCommit": {"oid": "4f1c2c403a487e0ef215df1c4c953e38416fa1e5", "author": {"user": {"login": "anistor", "name": "Adrian Nistor"}}, "url": "https://github.com/infinispan/infinispan/commit/4f1c2c403a487e0ef215df1c4c953e38416fa1e5", "committedDate": "2020-04-29T11:20:51Z", "message": "ISPN-11712 Remove explicit indexing enabled=\"true\" from xml configs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNTc4MzIx", "url": "https://github.com/infinispan/infinispan/pull/8218#pullrequestreview-402578321", "createdAt": "2020-04-29T11:28:10Z", "commit": {"oid": "4f1c2c403a487e0ef215df1c4c953e38416fa1e5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 882, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}