{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4NDkxOTM1", "number": 8173, "title": "ISPN-11599 Out of the box testing with Infinispan Server and JUnit 5 ", "bodyText": "Create an out of the box testing utility for JUnit 5\nhttps://issues.redhat.com/browse/ISPN-11599\n\n\nThe JUnit 5 commit is rebased from another PR\nhttps://issues.redhat.com/browse/ISPN-11444\n\n\nProvide an API to allow the user to create a standalone embedded server without forcing them to provide a xml file\nhttps://issues.redhat.com/browse/ISPN-11505\n\n\nJUnit5 Infinispan Server Extension\nhttps://issues.redhat.com/browse/ISPN-11600", "createdAt": "2020-04-04T08:50:40Z", "url": "https://github.com/infinispan/infinispan/pull/8173", "merged": true, "mergeCommit": {"oid": "cbd50e3c2fdf7b50f097689d20add5ef3eded73d"}, "closed": true, "closedAt": "2020-05-09T13:37:45Z", "author": {"login": "karesti"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVBR6rABqjMyMDYxOTM5MzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfUa_ZgFqTQwODM1Nzk3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46ecb7881279b0dbcd12da1630aee158993181b6", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/46ecb7881279b0dbcd12da1630aee158993181b6", "committedDate": "2020-04-04T08:49:43Z", "message": "ISPN-11444 Upgrade JUnit version 5"}, "afterCommit": {"oid": "df038a426e55c50298124c8325922d4e4e1d443c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/df038a426e55c50298124c8325922d4e4e1d443c", "committedDate": "2020-04-06T16:27:44Z", "message": "ISPN-11505 add config for standalone embedded server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df038a426e55c50298124c8325922d4e4e1d443c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/df038a426e55c50298124c8325922d4e4e1d443c", "committedDate": "2020-04-06T16:27:44Z", "message": "ISPN-11505 add config for standalone embedded server"}, "afterCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/4b28e4018d01b485e9a562018d17eee8cea5bd73", "committedDate": "2020-04-06T20:24:35Z", "message": "ISPN-11505 add config for standalone embedded server"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MjE0ODIy", "url": "https://github.com/infinispan/infinispan/pull/8173#pullrequestreview-388214822", "createdAt": "2020-04-06T12:48:54Z", "commit": {"oid": "46ecb7881279b0dbcd12da1630aee158993181b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMjo0ODo1NVrOGBWFww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOToyNzo0MVrOGB671g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2MzY4Mw==", "bodyText": "java.* and javax.* first, please", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404063683", "createdAt": "2020-04-06T12:48:55Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractInfinispanServerDriver.java", "diffHunk": "@@ -1,10 +1,25 @@\n package org.infinispan.server.test.core;\n \n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46ecb7881279b0dbcd12da1630aee158993181b6"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NTU5NA==", "bodyText": "The sentence feels unfinished", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404065594", "createdAt": "2020-04-06T12:52:10Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/EmbeddedInfinispanServerDriver.java", "diffHunk": "@@ -61,9 +61,11 @@ protected void start(String name, File rootDir, String configurationFile) {\n          serverFutures.add(server.run());\n          servers.add(server);\n       }\n-      // Ensure that the cluster has formed\n+      // Ensure that the cluster has formed if more than one", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46ecb7881279b0dbcd12da1630aee158993181b6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY2MTE1NA==", "bodyText": "Please copy it to target/generated-sources/, so you don't have to add it to .gitignore\n@tristantarrant isn't there a way to use the default server configuration from server/runtime without copying it?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404661154", "createdAt": "2020-04-07T09:17:51Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/pom.xml", "diffHunk": "@@ -68,5 +68,33 @@\n          <artifactId>spymemcached</artifactId>\n       </dependency>\n    </dependencies>\n+   <build>\n+      <plugins>\n+         <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-resources-plugin</artifactId>\n+            <executions>\n+               <execution>\n+                  <id>copy-server-config</id>\n+                  <phase>validate</phase>\n+                  <goals>\n+                     <goal>copy-resources</goal>\n+                  </goals>\n+                  <configuration>\n+                     <outputDirectory>${project.basedir}/src/main/resources</outputDirectory>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY2NDIxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               private static final List<String> DEFAULT_INFINISPAN_CONFIG_FILES = Arrays.asList(\n          \n          \n            \n               private static final List<String> DEFAULT_INFINISPAN_CONFIG_FILES = \n          \n          \n            \n                     Arrays.asList(DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME);", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404664210", "createdAt": "2020-04-07T09:22:47Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractInfinispanServerDriver.java", "diffHunk": "@@ -16,29 +31,21 @@\n import java.security.cert.CertificateException;\n import java.security.cert.X509Certificate;\n import java.util.Arrays;\n+import java.util.List;\n import java.util.concurrent.atomic.AtomicLong;\n import java.util.function.BiConsumer;\n import java.util.function.Consumer;\n \n-import javax.security.auth.x500.X500Principal;\n-\n-import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n-import org.infinispan.commons.test.CommonsTestingUtil;\n-import org.infinispan.commons.test.Exceptions;\n-import org.infinispan.commons.util.Util;\n-import org.infinispan.lifecycle.ComponentStatus;\n-import org.infinispan.security.AuthorizationPermission;\n-import org.infinispan.server.Server;\n-import org.infinispan.server.security.UserTool;\n-import org.wildfly.security.x500.cert.BasicConstraintsExtension;\n-import org.wildfly.security.x500.cert.SelfSignedX509CertificateAndSigningKey;\n-import org.wildfly.security.x500.cert.X509CertificateBuilder;\n-\n /**\n  * @author Tristan Tarrant &lt;tristan@infinispan.org&gt;\n  * @since 10.0\n  **/\n public abstract class AbstractInfinispanServerDriver implements InfinispanServerDriver {\n+   public static final String DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME = \"infinispan.xml\";\n+\n+   private static final List<String> DEFAULT_INFINISPAN_CONFIG_FILES = Arrays.asList(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY2NTU5Ng==", "bodyText": "Is this change really necessary?\n\"infinispan.xml\" is not an absolute path, so it would use the else branch, which looks exactly the same.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404665596", "createdAt": "2020-04-07T09:24:56Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractInfinispanServerDriver.java", "diffHunk": "@@ -84,22 +91,32 @@ public void prepare(String name) {\n          throw new RuntimeException(\"Failed to create server configuration directory \" + confDir);\n       }\n       URL configurationFileURL;\n-      if (new File(configuration.configurationFile()).isAbsolute()) {\n+      if (DEFAULT_INFINISPAN_CONFIG_FILES.contains(configuration.configurationFile())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY2NzM1MA==", "bodyText": "Here you're only copying the configuration file. What happens with the other files the server needs, like log4j2.xml?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404667350", "createdAt": "2020-04-07T09:27:41Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractInfinispanServerDriver.java", "diffHunk": "@@ -84,22 +91,32 @@ public void prepare(String name) {\n          throw new RuntimeException(\"Failed to create server configuration directory \" + confDir);\n       }\n       URL configurationFileURL;\n-      if (new File(configuration.configurationFile()).isAbsolute()) {\n+      if (DEFAULT_INFINISPAN_CONFIG_FILES.contains(configuration.configurationFile())) {\n+         configurationFileURL = getClass().getClassLoader().getResource(configuration.configurationFile());\n+      } else if (new File(configuration.configurationFile()).isAbsolute()) {\n          configurationFileURL = Exceptions.unchecked(() -> new File(configuration.configurationFile()).toURI().toURL());\n       } else {\n          configurationFileURL = getClass().getClassLoader().getResource(configuration.configurationFile());\n       }\n       if (configurationFileURL == null) {\n          throw new RuntimeException(\"Cannot find test configuration file: \" + configuration.configurationFile());\n       }\n-      Path configurationFilePath;\n+\n       try {\n-         configurationFilePath = Paths.get(configurationFileURL.toURI());\n-         // Recursively copy the contents of the directory containing the configuration file to the test target\n-         Util.recursiveDirectoryCopy(configurationFilePath.getParent(), confDir.toPath());\n+         if (DEFAULT_INFINISPAN_CONFIG_FILES.contains(configuration.configurationFile())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 83}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4OTQ3MzIy", "url": "https://github.com/infinispan/infinispan/pull/8173#pullrequestreview-388947322", "createdAt": "2020-04-07T09:34:57Z", "commit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOTozNDo1N1rOGB7N8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOTozNDo1N1rOGB7N8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY3MTk4NQ==", "bodyText": "I don't think adding the dependencies here is enough, you also have to add them to the surefire plugin instead of the surefire-junit47 dependency:\nhttps://junit.org/junit5/docs/current/user-guide/#running-tests-build-maven", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404671985", "createdAt": "2020-04-07T09:34:57Z", "author": {"login": "danberindei"}, "path": "commons-test/pom.xml", "diffHunk": "@@ -25,8 +25,13 @@\n          <scope>provided</scope>\n       </dependency>\n       <dependency>\n-         <groupId>junit</groupId>\n-         <artifactId>junit</artifactId>\n+         <groupId>org.junit.jupiter</groupId>\n+         <artifactId>junit-jupiter-engine</artifactId>\n+         <scope>provided</scope>\n+      </dependency>\n+      <dependency>\n+         <groupId>org.junit.vintage</groupId>\n+         <artifactId>junit-vintage-engine</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4OTQ4NTk0", "url": "https://github.com/infinispan/infinispan/pull/8173#pullrequestreview-388948594", "createdAt": "2020-04-07T09:36:36Z", "commit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOTozNjozNlrOGB7R2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOTozNjozNlrOGB7R2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY3Mjk4NA==", "bodyText": "IMO we should add a constructor without any parameters that uses the default server configuration.\nOtherwise users that write their own custom server configuration and name it infinispan.xml could accidentally run some code that is meant to run without a custom server configuration.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r404672984", "createdAt": "2020-04-07T09:36:36Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit4/src/main/java/org/infinispan/server/test/junit4/InfinispanServerRuleBuilder.java", "diffHunk": "@@ -24,6 +25,18 @@\n    private boolean jmx;\n    private boolean parallelStartup = true;\n \n+   /**\n+    * Use this method to instantiate a single clustered embedded server\n+    *\n+    * @return InfinispanServerRule\n+    */\n+   public static InfinispanServerRule standalone() {\n+      return new InfinispanServerRuleBuilder(DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b28e4018d01b485e9a562018d17eee8cea5bd73", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/4b28e4018d01b485e9a562018d17eee8cea5bd73", "committedDate": "2020-04-06T20:24:35Z", "message": "ISPN-11505 add config for standalone embedded server"}, "afterCommit": {"oid": "5d10f5af6c2457e49e82c98e70e5ff26534b1bd4", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/5d10f5af6c2457e49e82c98e70e5ff26534b1bd4", "committedDate": "2020-04-10T09:29:40Z", "message": "ISPN-11505 add config for standalone embedded server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d10f5af6c2457e49e82c98e70e5ff26534b1bd4", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/5d10f5af6c2457e49e82c98e70e5ff26534b1bd4", "committedDate": "2020-04-10T09:29:40Z", "message": "ISPN-11505 add config for standalone embedded server"}, "afterCommit": {"oid": "bfdb5ceba1771990dfbba1bc855b200211c9a2e0", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/bfdb5ceba1771990dfbba1bc855b200211c9a2e0", "committedDate": "2020-04-10T09:57:02Z", "message": "ISPN-11505 add config for standalone embedded server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac70beaf83a8b8f6827d4c71bf447f51916e004b", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/ac70beaf83a8b8f6827d4c71bf447f51916e004b", "committedDate": "2020-04-17T07:49:41Z", "message": "no funcionaaaaa me cago en todo"}, "afterCommit": {"oid": "c8f01358e3bc7cb625d25e5a231307ea2fa060cc", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/c8f01358e3bc7cb625d25e5a231307ea2fa060cc", "committedDate": "2020-04-17T12:29:59Z", "message": "ISPN-11600 JUnit5 Extension"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8f01358e3bc7cb625d25e5a231307ea2fa060cc", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/c8f01358e3bc7cb625d25e5a231307ea2fa060cc", "committedDate": "2020-04-17T12:29:59Z", "message": "ISPN-11600 JUnit5 Extension"}, "afterCommit": {"oid": "03b9ae9e2ea2c03261997d92f06f0e364cac201a", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/03b9ae9e2ea2c03261997d92f06f0e364cac201a", "committedDate": "2020-04-17T12:33:04Z", "message": "ISPN-11600 JUnit5 Extension"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ee4af14a85ba085091899c57c55834579636f7b", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/8ee4af14a85ba085091899c57c55834579636f7b", "committedDate": "2020-04-21T14:35:58Z", "message": "fix memcache client compilation mistake"}, "afterCommit": {"oid": "761da10f485e6217e4ece68aa2a34e20b01dece8", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/761da10f485e6217e4ece68aa2a34e20b01dece8", "committedDate": "2020-04-24T14:11:44Z", "message": "ISPN-11600 Run JUnit 5 server driver tests with JUnit 5\n\n* Copy the maven-surefire-plugin from one of the JUnit modules\n* Replace provider surefire-junit47 with surefire-junit-platform\n* Add junit-jupiter-engine dependency\n* Set scope of JUnit dependencies in parent POM to test\n* Remove TestNG dependency\n* Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f7076d873bc28b30ea50918f8f75b50d8a6ce521", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/f7076d873bc28b30ea50918f8f75b50d8a6ce521", "committedDate": "2020-04-24T16:48:29Z", "message": "ISPN-11600 Fixes compilation issues in the extension and rule"}, "afterCommit": {"oid": "426498d5113bd72f31d8d6aa14eb6d5f8ad829d9", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/426498d5113bd72f31d8d6aa14eb6d5f8ad829d9", "committedDate": "2020-04-24T16:54:28Z", "message": "ISPN-11600 Fixes compilation issues in the extension and rule"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37", "committedDate": "2020-04-27T14:49:20Z", "message": "ISPN-11444 Remove junit-vintage dep"}, "afterCommit": {"oid": "02fc9c5f8e41154cf94458b501deeda3c53be005", "author": {"user": {"login": "danberindei", "name": "Dan Berindei"}}, "url": "https://github.com/infinispan/infinispan/commit/02fc9c5f8e41154cf94458b501deeda3c53be005", "committedDate": "2020-04-29T13:55:22Z", "message": "ISPN-11600 Run JUnit 5 server driver tests with JUnit 5\n\n* Copy the maven-surefire-plugin from one of the JUnit modules\n* Replace provider surefire-junit47 with surefire-junit-platform\n* Add junit-jupiter-engine dependency\n* Set scope of JUnit dependencies in parent POM to test\n* Remove TestNG dependency\n* Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d067db3a697cd04e2c01b9de5cbb5d55255d87b", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/8d067db3a697cd04e2c01b9de5cbb5d55255d87b", "committedDate": "2020-04-29T15:15:32Z", "message": "ISPN-11505 Add Junit 4 test\n* Containe mode\n* Standalone server"}, "afterCommit": {"oid": "b8a26923718d3aae7846c38ffd44a952aec3afff", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/b8a26923718d3aae7846c38ffd44a952aec3afff", "committedDate": "2020-04-29T23:55:11Z", "message": "ISPN-11505 Add Junit 4 test\n* Containe mode\n* Standalone server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8a26923718d3aae7846c38ffd44a952aec3afff", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/b8a26923718d3aae7846c38ffd44a952aec3afff", "committedDate": "2020-04-29T23:55:11Z", "message": "ISPN-11505 Add Junit 4 test\n* Containe mode\n* Standalone server"}, "afterCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/b329187d37693768ccbf3ecf95915cff78837d7c", "committedDate": "2020-05-01T12:41:15Z", "message": "ISPN-11505 Add Junit 4 test\n* Containe mode\n* Standalone server\n* Rm de copy resource for embedded default"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzg4NjQx", "url": "https://github.com/infinispan/infinispan/pull/8173#pullrequestreview-401788641", "createdAt": "2020-04-28T12:34:46Z", "commit": {"oid": "8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMjozNDo0NlrOGNRwSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNDoyMjo1OFrOGPLC8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU3NTU2MA==", "bodyText": "Should JUnit4 really be a compile dependency of the core?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r416575560", "createdAt": "2020-04-28T12:34:46Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/pom.xml", "diffHunk": "@@ -67,6 +97,11 @@\n          <groupId>net.spy</groupId>\n          <artifactId>spymemcached</artifactId>\n       </dependency>\n+      <dependency>\n+         <groupId>junit</groupId>\n+         <artifactId>junit</artifactId>\n+         <scope>compile</scope>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU3NTkzMA==", "bodyText": "Do we need these for the container driver, or were they needed only for the embedded driver?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r416575930", "createdAt": "2020-04-28T12:35:23Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/pom.xml", "diffHunk": "@@ -18,6 +18,36 @@\n       <module.skipMavenRemoteResource>true</module.skipMavenRemoteResource>\n    </properties>\n \n+   <build>\n+      <plugins>\n+         <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-resources-plugin</artifactId>\n+            <executions>\n+               <execution>\n+                  <id>copy-server-config</id>\n+                  <phase>validate</phase>\n+                  <goals>\n+                     <goal>copy-resources</goal>\n+                  </goals>\n+                  <configuration>\n+                     <outputDirectory>${project.basedir}/target/classes</outputDirectory>\n+                     <resources>\n+                        <resource>\n+                           <directory>${project.parent.basedir}/runtime/src/main/server/server/conf</directory>\n+                           <includes>\n+                              <include>infinispan.xml</include>\n+                              <include>log4j2.xml</include>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU3ODA1Mw==", "bodyText": "Missing description, author, wrong version", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r416578053", "createdAt": "2020-04-28T12:38:34Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/Base.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package org.infinispan.server.test.core;\n+\n+import org.infinispan.commons.api.CacheContainerAdmin;\n+import org.infinispan.commons.configuration.BasicConfiguration;\n+import org.infinispan.commons.configuration.Self;\n+import org.infinispan.commons.configuration.XMLStringConfiguration;\n+import org.infinispan.configuration.cache.CacheMode;\n+\n+import java.util.EnumSet;\n+\n+/**\n+ * @since 10", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c14541ac1dd7eaf0c12ffb30e3b4748e5100a37"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyMDEzMw==", "bodyText": "Since most modules keep using JUnit4, I suggest naming the property version.junit5 to avoid confusion", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418520133", "createdAt": "2020-05-01T12:23:53Z", "author": {"login": "danberindei"}, "path": "build-configuration/pom.xml", "diffHunk": "@@ -172,7 +172,8 @@\n       <version.jetty>9.4.5.v20170502</version.jetty>\n       <version.jgroups>4.2.1.Final</version.jgroups>\n       <version.jsr107>1.1.0</version.jsr107>\n-      <version.junit>4.13</version.junit>\n+      <version.junit4>4.13</version.junit4>\n+      <version.junit>5.6.2</version.junit>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8a26923718d3aae7846c38ffd44a952aec3afff"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyNjk3NA==", "bodyText": "Name seems too short to me, what is it a base for?\nSame with the subclasses, HotRod and Rest.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418526974", "createdAt": "2020-05-01T12:47:46Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/Base.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package org.infinispan.server.test.core;\n+\n+import org.infinispan.commons.api.CacheContainerAdmin;\n+import org.infinispan.commons.configuration.BasicConfiguration;\n+import org.infinispan.commons.configuration.Self;\n+import org.infinispan.commons.configuration.XMLStringConfiguration;\n+import org.infinispan.configuration.cache.CacheMode;\n+\n+import java.util.EnumSet;\n+\n+/**\n+ * @since 10\n+ * @param <S>\n+ */\n+public abstract class Base<S extends Base<S>> implements Self<S> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUyNzQxMg==", "bodyText": "IMO getContainer(int i) matches createContainer(int i) better.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418527412", "createdAt": "2020-05-01T12:49:23Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/ContainerInfinispanServerDriver.java", "diffHunk": "@@ -218,6 +218,13 @@ protected void start(String name, File rootDir, String configurationFile) {\n       }\n    }\n \n+   public InfinispanGenericContainer getSingleContainer(int i) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0NTk5OQ==", "bodyText": "Is this still necessary?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418545999", "createdAt": "2020-05-01T13:42:55Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractInfinispanServerDriver.java", "diffHunk": "@@ -39,6 +39,8 @@\n  * @since 10.0\n  **/\n public abstract class AbstractInfinispanServerDriver implements InfinispanServerDriver {\n+   public static final String DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME = \"infinispan.xml\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0NjMxMw==", "bodyText": "Will defaultFile ever be true?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418546313", "createdAt": "2020-05-01T13:43:37Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/InfinispanServerTestConfiguration.java", "diffHunk": "@@ -18,10 +18,11 @@\n    private final JavaArchive[] archives;\n    private final boolean jmx;\n    private final boolean parallelStartup;\n+   private boolean defaultFile;\n \n    public InfinispanServerTestConfiguration(String configurationFile, int numServers, ServerRunMode runMode,\n                                             Properties properties, String[] mavenArtifacts, JavaArchive[] archives,\n-                                            boolean jmx, boolean parallelStartup) {\n+                                            boolean jmx, boolean parallelStartup, boolean defaultFile) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0NzAwNg==", "bodyText": "Missing javadoc", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418547006", "createdAt": "2020-05-01T13:45:21Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/TestClient.java", "diffHunk": "@@ -0,0 +1,108 @@\n+package org.infinispan.server.test.core;\n+\n+import net.spy.memcached.MemcachedClient;\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.RemoteCounterManagerFactory;\n+import org.infinispan.client.rest.RestClient;\n+import org.infinispan.client.rest.configuration.RestClientConfigurationBuilder;\n+import org.infinispan.commons.test.CommonsTestingUtil;\n+import org.infinispan.commons.util.Util;\n+import org.infinispan.counter.api.CounterManager;\n+import org.infinispan.scripting.ScriptingManager;\n+\n+import java.io.Closeable;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class TestClient {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0NzM0OQ==", "bodyText": "Shouldn't this be a method in HotRod?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418547349", "createdAt": "2020-05-01T13:46:11Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/TestClient.java", "diffHunk": "@@ -0,0 +1,108 @@\n+package org.infinispan.server.test.core;\n+\n+import net.spy.memcached.MemcachedClient;\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.RemoteCounterManagerFactory;\n+import org.infinispan.client.rest.RestClient;\n+import org.infinispan.client.rest.configuration.RestClientConfigurationBuilder;\n+import org.infinispan.commons.test.CommonsTestingUtil;\n+import org.infinispan.commons.util.Util;\n+import org.infinispan.counter.api.CounterManager;\n+import org.infinispan.scripting.ScriptingManager;\n+\n+import java.io.Closeable;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class TestClient {\n+   protected InfinispanServerTestConfiguration configuration;\n+   protected TestServer testServer;\n+   protected List<Closeable> resources;\n+   private String methodName;\n+\n+   public TestClient(TestServer testServer) {\n+      this.testServer = testServer;\n+   }\n+\n+   public <T extends Closeable> T registerResource(T resource) {\n+      resources.add(resource);\n+      return resource;\n+   }\n+\n+   public InfinispanServerDriver getServerDriver() {\n+      if (!testServer.isDriverInitialized()) {\n+         throw new IllegalStateException(\"Operation not supported before test starts\");\n+      }\n+      return testServer.getDriver();\n+   }\n+\n+   public HotRod hotrod() {\n+      return new HotRod(testServer, this);\n+   }\n+\n+   public Rest rest() {\n+      return new Rest(testServer, this);\n+   }\n+\n+   public CounterManager getCounterManager() {\n+      RemoteCacheManager remoteCacheManager = registerResource(testServer.newHotRodClient());\n+      return RemoteCounterManagerFactory.asCounterManager(remoteCacheManager);\n+   }\n+\n+\n+   public void setMethodName(String methodName) {\n+      this.methodName = methodName;\n+   }\n+\n+   public void clearResources() {\n+      if (resources != null) {\n+         resources.forEach(Util::close);\n+         resources.clear();\n+      }\n+   }\n+\n+   public void initResources() {\n+      resources = new ArrayList<>();\n+   }\n+\n+   public String addScript(RemoteCacheManager remoteCacheManager, String script) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0ODE3MA==", "bodyText": "Not sure we should expose this one.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418548170", "createdAt": "2020-05-01T13:48:13Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/TestClient.java", "diffHunk": "@@ -0,0 +1,108 @@\n+package org.infinispan.server.test.core;\n+\n+import net.spy.memcached.MemcachedClient;\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.RemoteCounterManagerFactory;\n+import org.infinispan.client.rest.RestClient;\n+import org.infinispan.client.rest.configuration.RestClientConfigurationBuilder;\n+import org.infinispan.commons.test.CommonsTestingUtil;\n+import org.infinispan.commons.util.Util;\n+import org.infinispan.counter.api.CounterManager;\n+import org.infinispan.scripting.ScriptingManager;\n+\n+import java.io.Closeable;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class TestClient {\n+   protected InfinispanServerTestConfiguration configuration;\n+   protected TestServer testServer;\n+   protected List<Closeable> resources;\n+   private String methodName;\n+\n+   public TestClient(TestServer testServer) {\n+      this.testServer = testServer;\n+   }\n+\n+   public <T extends Closeable> T registerResource(T resource) {\n+      resources.add(resource);\n+      return resource;\n+   }\n+\n+   public InfinispanServerDriver getServerDriver() {\n+      if (!testServer.isDriverInitialized()) {\n+         throw new IllegalStateException(\"Operation not supported before test starts\");\n+      }\n+      return testServer.getDriver();\n+   }\n+\n+   public HotRod hotrod() {\n+      return new HotRod(testServer, this);\n+   }\n+\n+   public Rest rest() {\n+      return new Rest(testServer, this);\n+   }\n+\n+   public CounterManager getCounterManager() {\n+      RemoteCacheManager remoteCacheManager = registerResource(testServer.newHotRodClient());\n+      return RemoteCounterManagerFactory.asCounterManager(remoteCacheManager);\n+   }\n+\n+\n+   public void setMethodName(String methodName) {\n+      this.methodName = methodName;\n+   }\n+\n+   public void clearResources() {\n+      if (resources != null) {\n+         resources.forEach(Util::close);\n+         resources.clear();\n+      }\n+   }\n+\n+   public void initResources() {\n+      resources = new ArrayList<>();\n+   }\n+\n+   public String addScript(RemoteCacheManager remoteCacheManager, String script) {\n+      RemoteCache<String, String> scriptCache = remoteCacheManager.getCache(ScriptingManager.SCRIPT_CACHE);\n+      try (InputStream in = this.getClass().getClassLoader().getResourceAsStream(script)) {\n+         scriptCache.put(getMethodName(), CommonsTestingUtil.loadFileAsString(in));\n+      } catch (Exception e) {\n+         throw new RuntimeException(e);\n+      }\n+      return getMethodName();\n+   }\n+\n+   public String getMethodName() {\n+      return getMethodName(null);\n+   }\n+\n+   public RestClient newRestClient(RestClientConfigurationBuilder restClientConfigurationBuilder) {\n+      RestClient restClient = testServer.newRestClient(restClientConfigurationBuilder);\n+      registerResource(restClient);\n+      return restClient;\n+   }\n+\n+   public String getMethodName(String qualifier) {\n+      String cacheName = \"C\" + methodName + (qualifier != null ? qualifier : \"\");\n+      try {\n+         MessageDigest sha1 = MessageDigest.getInstance(\"SHA-1\");\n+         byte[] digest = sha1.digest(cacheName.getBytes(StandardCharsets.UTF_8));\n+         return Util.toHexString(digest);\n+      } catch (NoSuchAlgorithmException e) {\n+         // Won't happen\n+         return null;\n+      }\n+   }\n+\n+   public MemcachedClient getMemcachedClient() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0ODI2MA==", "bodyText": "Missing javadoc", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418548260", "createdAt": "2020-05-01T13:48:24Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/TestServer.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package org.infinispan.server.test.core;\n+\n+import net.spy.memcached.MemcachedClient;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.client.rest.RestClient;\n+import org.infinispan.client.rest.configuration.RestClientConfigurationBuilder;\n+import org.infinispan.commons.test.Exceptions;\n+import org.testcontainers.DockerClientFactory;\n+\n+import java.io.Closeable;\n+import java.io.File;\n+import java.net.InetSocketAddress;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.function.Consumer;\n+\n+public class TestServer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1MDY0Mw==", "bodyText": "Seems odd that newRestClient is in TestClient, but newHotRodClient() is only in TestServer.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418550643", "createdAt": "2020-05-01T13:54:11Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/TestClient.java", "diffHunk": "@@ -0,0 +1,108 @@\n+package org.infinispan.server.test.core;\n+\n+import net.spy.memcached.MemcachedClient;\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.RemoteCounterManagerFactory;\n+import org.infinispan.client.rest.RestClient;\n+import org.infinispan.client.rest.configuration.RestClientConfigurationBuilder;\n+import org.infinispan.commons.test.CommonsTestingUtil;\n+import org.infinispan.commons.util.Util;\n+import org.infinispan.counter.api.CounterManager;\n+import org.infinispan.scripting.ScriptingManager;\n+\n+import java.io.Closeable;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class TestClient {\n+   protected InfinispanServerTestConfiguration configuration;\n+   protected TestServer testServer;\n+   protected List<Closeable> resources;\n+   private String methodName;\n+\n+   public TestClient(TestServer testServer) {\n+      this.testServer = testServer;\n+   }\n+\n+   public <T extends Closeable> T registerResource(T resource) {\n+      resources.add(resource);\n+      return resource;\n+   }\n+\n+   public InfinispanServerDriver getServerDriver() {\n+      if (!testServer.isDriverInitialized()) {\n+         throw new IllegalStateException(\"Operation not supported before test starts\");\n+      }\n+      return testServer.getDriver();\n+   }\n+\n+   public HotRod hotrod() {\n+      return new HotRod(testServer, this);\n+   }\n+\n+   public Rest rest() {\n+      return new Rest(testServer, this);\n+   }\n+\n+   public CounterManager getCounterManager() {\n+      RemoteCacheManager remoteCacheManager = registerResource(testServer.newHotRodClient());\n+      return RemoteCounterManagerFactory.asCounterManager(remoteCacheManager);\n+   }\n+\n+\n+   public void setMethodName(String methodName) {\n+      this.methodName = methodName;\n+   }\n+\n+   public void clearResources() {\n+      if (resources != null) {\n+         resources.forEach(Util::close);\n+         resources.clear();\n+      }\n+   }\n+\n+   public void initResources() {\n+      resources = new ArrayList<>();\n+   }\n+\n+   public String addScript(RemoteCacheManager remoteCacheManager, String script) {\n+      RemoteCache<String, String> scriptCache = remoteCacheManager.getCache(ScriptingManager.SCRIPT_CACHE);\n+      try (InputStream in = this.getClass().getClassLoader().getResourceAsStream(script)) {\n+         scriptCache.put(getMethodName(), CommonsTestingUtil.loadFileAsString(in));\n+      } catch (Exception e) {\n+         throw new RuntimeException(e);\n+      }\n+      return getMethodName();\n+   }\n+\n+   public String getMethodName() {\n+      return getMethodName(null);\n+   }\n+\n+   public RestClient newRestClient(RestClientConfigurationBuilder restClientConfigurationBuilder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1MjM3NA==", "bodyText": "To me the name get() suggests that the method returns the same RemoteCache instance, so it's surprising that it creates a new RemoteCacheManager instance every time.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418552374", "createdAt": "2020-05-01T13:58:11Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/HotRod.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.infinispan.server.test.core;\n+\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.configuration.cache.CacheMode;\n+\n+/**\n+ * @since 10\n+ */\n+public class HotRod extends Base<HotRod> {\n+   private final TestServer testServer;\n+   private final TestClient testClient;\n+   ConfigurationBuilder clientConfiguration = new ConfigurationBuilder();\n+\n+   public HotRod(TestServer testServer, TestClient testClient) {\n+      this.testServer = testServer;\n+      this.testClient = testClient;\n+   }\n+\n+   public HotRod withClientConfiguration(ConfigurationBuilder clientConfiguration) {\n+      this.clientConfiguration = clientConfiguration;\n+      return this;\n+   }\n+\n+   public <K, V> RemoteCache<K, V> get() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1MzIyOA==", "bodyText": "create also seems ambiguous to me, it doesn't say it's creating the cache on the server, so it could be interpreted as \"create the RemoteCache instance so that get() can use it\".", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418553228", "createdAt": "2020-05-01T14:00:13Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/HotRod.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.infinispan.server.test.core;\n+\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.configuration.cache.CacheMode;\n+\n+/**\n+ * @since 10\n+ */\n+public class HotRod extends Base<HotRod> {\n+   private final TestServer testServer;\n+   private final TestClient testClient;\n+   ConfigurationBuilder clientConfiguration = new ConfigurationBuilder();\n+\n+   public HotRod(TestServer testServer, TestClient testClient) {\n+      this.testServer = testServer;\n+      this.testClient = testClient;\n+   }\n+\n+   public HotRod withClientConfiguration(ConfigurationBuilder clientConfiguration) {\n+      this.clientConfiguration = clientConfiguration;\n+      return this;\n+   }\n+\n+   public <K, V> RemoteCache<K, V> get() {\n+      RemoteCacheManager remoteCacheManager = testClient.registerResource(testServer.newHotRodClient(clientConfiguration));\n+      String name = testClient.getMethodName(qualifier);\n+      return remoteCacheManager.getCache(name);\n+   }\n+\n+   public <K, V> RemoteCache<K, V> create() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1NDI4Mw==", "bodyText": "Do we really need TestNG here? Maybe add a source comment to explain why", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418554283", "createdAt": "2020-05-01T14:02:52Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit4/pom.xml", "diffHunk": "@@ -49,6 +48,16 @@\n          <artifactId>shrinkwrap-resolver-impl-maven-archive</artifactId>\n          <scope>compile</scope>\n       </dependency>\n+      <dependency>\n+         <groupId>junit</groupId>\n+         <artifactId>junit</artifactId>\n+         <scope>compile</scope>\n+      </dependency>\n+      <dependency>\n+         <groupId>org.testng</groupId>\n+         <artifactId>testng</artifactId>\n+         <scope>test</scope>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1NjIzNQ==", "bodyText": "I suggest AbstractTestServerBuilder, because it creates a TestServer instance. Although TestServer isn't just one server either, it's a cluster, so maybe AbstractTestClusterBuilder?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418556235", "createdAt": "2020-05-01T14:07:38Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/AbstractServerConfigBuilder.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package org.infinispan.server.test.core;\n+\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+\n+import java.util.Properties;\n+\n+/**\n+ * Common code for JUnit 4 and Junit 5 Extension\n+ *\n+ * @param <T> type of builder\n+ * @author Katia Aresti\n+ * @since 11\n+ */\n+public abstract class AbstractServerConfigBuilder<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1NzM4NQ==", "bodyText": "Wrong indent, and the previous line should be wrapped", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418557385", "createdAt": "2020-05-01T14:10:22Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit4/src/test/java/InfinispanRuleBasicTest.java", "diffHunk": "@@ -0,0 +1,30 @@\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.configuration.ClientIntelligence;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.configuration.cache.CacheMode;\n+import org.infinispan.server.test.junit4.InfinispanServerRule;\n+import org.infinispan.server.test.junit4.InfinispanServerRuleBuilder;\n+import org.infinispan.server.test.junit4.InfinispanServerTestMethodRule;\n+import org.junit.ClassRule;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+public class InfinispanRuleBasicTest {\n+   @ClassRule\n+   public static final InfinispanServerRule SERVER = InfinispanServerRuleBuilder.server();\n+\n+   @Rule\n+   public InfinispanServerTestMethodRule SERVER_TEST = new InfinispanServerTestMethodRule(SERVER);\n+\n+   @Test\n+   public void testSingleServer() {\n+      ConfigurationBuilder builder = new ConfigurationBuilder();\n+      builder.clientIntelligence(ClientIntelligence.BASIC);\n+      RemoteCache<String, String> cache = SERVER_TEST.hotrod().withClientConfiguration(builder).withCacheMode(CacheMode.DIST_SYNC).create();\n+            cache.put(\"k1\", \"v1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU1ODEzOQ==", "bodyText": "Missing javadoc", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418558139", "createdAt": "2020-05-01T14:12:07Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit5/src/main/java/org/infinispan/server/test/junit5/InfinispanServerExtension.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.infinispan.server.test.junit5;\n+\n+import org.infinispan.server.test.core.InfinispanServerTestConfiguration;\n+import org.infinispan.server.test.core.TestClient;\n+import org.infinispan.server.test.core.TestServer;\n+import org.junit.jupiter.api.extension.AfterAllCallback;\n+import org.junit.jupiter.api.extension.AfterTestExecutionCallback;\n+import org.junit.jupiter.api.extension.BeforeAllCallback;\n+import org.junit.jupiter.api.extension.BeforeTestExecutionCallback;\n+import org.junit.jupiter.api.extension.ExtensionContext;\n+\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.function.Consumer;\n+\n+public class InfinispanServerExtension implements", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2MTk5MA==", "bodyText": "Is the container parameter still needed?\nWe also need a test to make sure it works, there is no usage ATM.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418561990", "createdAt": "2020-05-01T14:21:02Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit5/src/main/java/org/infinispan/server/test/junit5/InfispanServerExtensionBuilder.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package org.infinispan.server.test.junit5;\n+\n+import org.infinispan.server.test.core.AbstractServerConfigBuilder;\n+import org.infinispan.server.test.core.ServerRunMode;\n+\n+import static org.infinispan.server.test.core.AbstractInfinispanServerDriver.DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME;\n+\n+/**\n+ * Infinispan Server Extension Builder\n+ *\n+ * @author Katia Aresti\n+ * @since 11\n+ */\n+public class InfispanServerExtensionBuilder extends AbstractServerConfigBuilder<InfispanServerExtensionBuilder> {\n+   /**\n+    * Use this method to instantiate a single clustered embedded server\n+    *\n+    * @return InfinispanServerExtension\n+    */\n+   public static InfinispanServerExtension server() {\n+      return server(true);\n+   }\n+\n+   public static InfinispanServerExtension server(boolean container) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2MjcwMw==", "bodyText": "Shouldn't we have more info about how to use the extension, or at least a @see InfinispanServerExtension?", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418562703", "createdAt": "2020-05-01T14:22:41Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit5/src/main/java/org/infinispan/server/test/junit5/InfispanServerExtensionBuilder.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package org.infinispan.server.test.junit5;\n+\n+import org.infinispan.server.test.core.AbstractServerConfigBuilder;\n+import org.infinispan.server.test.core.ServerRunMode;\n+\n+import static org.infinispan.server.test.core.AbstractInfinispanServerDriver.DEFAULT_CLUSTERED_INFINISPAN_CONFIG_FILE_NAME;\n+\n+/**\n+ * Infinispan Server Extension Builder", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2MjgwMQ==", "bodyText": "Wrong indent", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r418562801", "createdAt": "2020-05-01T14:22:58Z", "author": {"login": "danberindei"}, "path": "server/testdriver/junit5/src/test/java/org/infinispan/server/test/junit5/InfinispanServerExtensionTest.java", "diffHunk": "@@ -0,0 +1,32 @@\n+package org.infinispan.server.test.junit5;\n+\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.configuration.ClientIntelligence;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.configuration.cache.CacheMode;\n+import org.infinispan.server.test.core.ServerRunMode;\n+import org.infinispan.server.test.core.TestClient;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+public class InfinispanServerExtensionTest {\n+\n+   @RegisterExtension\n+   static InfinispanServerExtension SERVER = InfispanServerExtensionBuilder.config(\"infinispan.xml\")\n+         .numServers(1)\n+         .runMode(ServerRunMode.EMBEDDED)\n+         .build();\n+\n+   @Test\n+   public void testSingleServer() {\n+      ConfigurationBuilder builder = new ConfigurationBuilder();\n+      builder.clientIntelligence(ClientIntelligence.BASIC);\n+      TestClient client = SERVER.client();\n+      RemoteCache<String, String> cache = client.hotrod().withClientConfiguration(builder).withCacheMode(CacheMode.DIST_SYNC).create();\n+            cache.put(\"k1\", \"v1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b329187d37693768ccbf3ecf95915cff78837d7c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/b329187d37693768ccbf3ecf95915cff78837d7c", "committedDate": "2020-05-01T12:41:15Z", "message": "ISPN-11505 Add Junit 4 test\n* Containe mode\n* Standalone server\n* Rm de copy resource for embedded default"}, "afterCommit": {"oid": "2ba278de5f04af2865d7828f6af06dfc6e659f2c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/2ba278de5f04af2865d7828f6af06dfc6e659f2c", "committedDate": "2020-05-02T13:09:30Z", "message": "ISPN-11505 Docs and API encapsulation\n* TestClientDriver interface\n* Javadocs\n* Memcache client only exposed in JUnit 4 rule\n* junit and junit5 maven properties renamed\n* Clean some unused methods\n* Add a standalone container test in junit5 module"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ba278de5f04af2865d7828f6af06dfc6e659f2c", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/2ba278de5f04af2865d7828f6af06dfc6e659f2c", "committedDate": "2020-05-02T13:09:30Z", "message": "ISPN-11505 Docs and API encapsulation\n* TestClientDriver interface\n* Javadocs\n* Memcache client only exposed in JUnit 4 rule\n* junit and junit5 maven properties renamed\n* Clean some unused methods\n* Add a standalone container test in junit5 module"}, "afterCommit": {"oid": "6af8060f53d96c059fafe312da8e83f5e257b8f5", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/6af8060f53d96c059fafe312da8e83f5e257b8f5", "committedDate": "2020-05-02T22:30:16Z", "message": "ISPN-11505 Docs and API encapsulation\n* TestClientDriver interface\n* Javadocs\n* Memcache client only exposed in JUnit 4 rule\n* junit and junit5 maven properties renamed\n* Clean some unused methods\n* Add a standalone container test in junit5 module"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6af8060f53d96c059fafe312da8e83f5e257b8f5", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/6af8060f53d96c059fafe312da8e83f5e257b8f5", "committedDate": "2020-05-02T22:30:16Z", "message": "ISPN-11505 Docs and API encapsulation\n* TestClientDriver interface\n* Javadocs\n* Memcache client only exposed in JUnit 4 rule\n* junit and junit5 maven properties renamed\n* Clean some unused methods\n* Add a standalone container test in junit5 module"}, "afterCommit": {"oid": "c3c6c38385e47df65d8ed99648c393dd7553ce4a", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/c3c6c38385e47df65d8ed99648c393dd7553ce4a", "committedDate": "2020-05-06T13:54:19Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3c6c38385e47df65d8ed99648c393dd7553ce4a", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/c3c6c38385e47df65d8ed99648c393dd7553ce4a", "committedDate": "2020-05-06T13:54:19Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}, "afterCommit": {"oid": "970304e214eabca5dfc3890fd7999d7bde44f9f4", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/970304e214eabca5dfc3890fd7999d7bde44f9f4", "committedDate": "2020-05-06T14:08:20Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "970304e214eabca5dfc3890fd7999d7bde44f9f4", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/970304e214eabca5dfc3890fd7999d7bde44f9f4", "committedDate": "2020-05-06T14:08:20Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}, "afterCommit": {"oid": "eb10384a9a78dcc6e671f99ce550da901dac081b", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/eb10384a9a78dcc6e671f99ce550da901dac081b", "committedDate": "2020-05-07T09:30:19Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eb10384a9a78dcc6e671f99ce550da901dac081b", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/eb10384a9a78dcc6e671f99ce550da901dac081b", "committedDate": "2020-05-07T09:30:19Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}, "afterCommit": {"oid": "147ce8843a23d612db9d1594ec3dab819e84f14f", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/147ce8843a23d612db9d1594ec3dab819e84f14f", "committedDate": "2020-05-07T12:56:18Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ae23f88540d921e88a91b3b4af3226fbf7ebd8d", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/8ae23f88540d921e88a91b3b4af3226fbf7ebd8d", "committedDate": "2020-05-08T14:18:33Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9097478b430bd480ce466f461dbecb95208b64e", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/b9097478b430bd480ce466f461dbecb95208b64e", "committedDate": "2020-05-08T09:00:49Z", "message": "attempt fix"}, "afterCommit": {"oid": "8ae23f88540d921e88a91b3b4af3226fbf7ebd8d", "author": {"user": {"login": "karesti", "name": "Katia Aresti"}}, "url": "https://github.com/infinispan/infinispan/commit/8ae23f88540d921e88a91b3b4af3226fbf7ebd8d", "committedDate": "2020-05-08T14:18:33Z", "message": "ISPN-11599 JUnit 5 Server Extension\n\n* ISPN-11505 Standalone server() method in Rule and Extension\n* ISPN-11600 JUnit 5 extension\n* ISPN-11444 JUnit 5 Upgrade. JUnit 5 server driver tests with JUnit 5\n    * Copy the maven-surefire-plugin from one of the JUnit modules\n    * Replace provider surefire-junit47 with surefire-junit-platform\n    * Add junit-jupiter-engine dependency\n    * Set scope of JUnit dependencies in parent POM to test\n    * Remove TestNG dependency\n    * Remove Infinispan core compile dependency in server parent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MzU3OTcz", "url": "https://github.com/infinispan/infinispan/pull/8173#pullrequestreview-408357973", "createdAt": "2020-05-08T16:25:19Z", "commit": {"oid": "8ae23f88540d921e88a91b3b4af3226fbf7ebd8d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNjoyNToxOVrOGSradg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNjoyNToxOVrOGSradg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIzODgzOA==", "bodyText": "AFAICT AbstractInfinispanServerDriver.createUserFile runs with a non-default configuration just as well as with the default configuration, so this check isn't necessary.\nIn general I would prefer a method like isContainerRunWithDefaultServerConfig() to return true only if running with the default configuration that ships in the server image, not a configuration file that ships in the testdriver jar.", "url": "https://github.com/infinispan/infinispan/pull/8173#discussion_r422238838", "createdAt": "2020-05-08T16:25:19Z", "author": {"login": "danberindei"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/api/HotRodTestClientDriver.java", "diffHunk": "@@ -0,0 +1,82 @@\n+package org.infinispan.server.test.api;\n+\n+import org.infinispan.client.hotrod.RemoteCache;\n+import org.infinispan.client.hotrod.RemoteCacheManager;\n+import org.infinispan.client.hotrod.configuration.ClientIntelligence;\n+import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;\n+import org.infinispan.configuration.cache.CacheMode;\n+import org.infinispan.server.test.core.TestClient;\n+import org.infinispan.server.test.core.TestServer;\n+\n+/**\n+ *  REST operations for the testing framework\n+ *\n+ * @author Tristan Tarrant\n+ * @since 10\n+ */\n+public class HotRodTestClientDriver extends BaseTestClientDriver<HotRodTestClientDriver> {\n+   private final TestServer testServer;\n+   private final TestClient testClient;\n+   ConfigurationBuilder clientConfiguration;\n+\n+   public HotRodTestClientDriver(TestServer testServer, TestClient testClient) {\n+      this.testServer = testServer;\n+      this.testClient = testClient;\n+\n+      ConfigurationBuilder builder = new ConfigurationBuilder();\n+      if(testServer.isContainerRunWithDefaultServerConfig()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ae23f88540d921e88a91b3b4af3226fbf7ebd8d"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 824, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}