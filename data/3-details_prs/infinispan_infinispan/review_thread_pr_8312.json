{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODc3Mzg3", "number": 8312, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyMDo1M1rOD82VJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyNToyNlrOD82bAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MTMxMzAxOnYy", "diffSide": "RIGHT", "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/ContainerInfinispanServerDriver.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyMDo1M1rOGWChog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyMDo1M1rOGWChog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc2MzIzNA==", "bodyText": "We can replace this method with a call to org.infinispan.commons.Util#recursiveFileRemove", "url": "https://github.com/infinispan/infinispan/pull/8312#discussion_r425763234", "createdAt": "2020-05-15T12:20:53Z", "author": {"login": "ryanemerson"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/ContainerInfinispanServerDriver.java", "diffHunk": "@@ -230,6 +230,32 @@ private void configureSite(List<String> args) {\n       args.add(\"-Djgroups.cluster.mcast_port=\" + configuration.siteDiscoveryPort());\n    }\n \n+   /*\n+    * Once you built the server, you can try to start it and it will create files under the data directory.\n+    * Later, you decided to run some tests and it will take ages to find out that the tests are broken because there\n+    * are files under the data directory.\n+    */\n+   private Path validateServerOutput(Path serverOutputPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e2569148ebe21f53fd744109de7bea0488bfca1"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MTMyODAwOnYy", "diffSide": "RIGHT", "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/ContainerInfinispanServerDriver.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyNToyNlrOGWCqsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjoyNToyNlrOGWCqsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc2NTU1Mw==", "bodyText": "We should cleanup the directories before the call to image and we should add a comment explaining why the delete is necessary:\n// Removing the `server/data` and `server/log` directories from the local server directory to prevent issues with the tests\nUtil.recursiveFileRemove(serverOutputPath.resolve(\"server\").resolve(\"data\").toString());\nUtil.recursiveFileRemove(serverOutputPath.resolve(\"server\").resolve(\"log\").toString());", "url": "https://github.com/infinispan/infinispan/pull/8312#discussion_r425765553", "createdAt": "2020-05-15T12:25:26Z", "author": {"login": "ryanemerson"}, "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/ContainerInfinispanServerDriver.java", "diffHunk": "@@ -139,7 +139,7 @@ protected void start(String name, File rootDir, String configurationFile) {\n             image\n                   .withFileFromPath(\"target\", serverOutputPath.getParent())\n                   .withFileFromPath(\"src\", serverOutputPath.getParent().getParent().resolve(\"src\"))\n-                  .withFileFromPath(\"build\", serverOutputPath);\n+                  .withFileFromPath(\"build\", validateServerOutput(serverOutputPath));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e2569148ebe21f53fd744109de7bea0488bfca1"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4199, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}