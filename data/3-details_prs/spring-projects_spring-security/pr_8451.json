{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMDU4MDAy", "number": 8451, "title": "SecurityMockMvcConfigurer$DelegateFilter is not null-safe", "bodyText": "This commit adds null-checks in relevant methods, so instead of NPE an IllegalStateException will be thrown with additional details.\nFixes gh-7745", "createdAt": "2020-05-01T09:16:36Z", "url": "https://github.com/spring-projects/spring-security/pull/8451", "merged": true, "mergeCommit": {"oid": "1f1ddeb02512813d908fec0d9057fb18feeb388d"}, "closed": true, "closedAt": "2020-05-05T14:56:38Z", "author": {"login": "dadikovi"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdHOvFgFqTQwNDM2Njc5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdRX59gBqjMyOTUwOTA3MzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MzY2Nzk5", "url": "https://github.com/spring-projects/spring-security/pull/8451#pullrequestreview-404366799", "createdAt": "2020-05-01T19:54:31Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxOTo1NDozMVrOGPUCGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxOTo1NDo1MVrOGPUClQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxMDA0Mw==", "bodyText": "Rather than do this could we update getDelegate to do a null check. Also keeping in mind that there is a race condition working on the member variable. So it would be something like:\nFilter result = this.delegate;\nif (result == null) {\n   // throw\n}\nreturn result;", "url": "https://github.com/spring-projects/spring-security/pull/8451#discussion_r418710043", "createdAt": "2020-05-01T19:54:31Z", "author": {"login": "rwinch"}, "path": "test/src/main/java/org/springframework/security/test/web/servlet/setup/SecurityMockMvcConfigurer.java", "diffHunk": "@@ -123,33 +123,47 @@ Filter getDelegate() {\n \n \t\t@Override\n \t\tpublic void init(FilterConfig filterConfig) throws ServletException {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.init(filterConfig);\n \t\t}\n \n \t\t@Override\n \t\tpublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n \t\t\t\tthrows IOException, ServletException {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.doFilter(request, response, chain);\n \t\t}\n \n \t\t@Override\n \t\tpublic void destroy() {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.destroy();\n \t\t}\n \n \t\t@Override\n \t\tpublic int hashCode() {\n+\t\t\tthis.requireDelegate();\n \t\t\treturn this.delegate.hashCode();\n \t\t}\n \n \t\t@Override\n \t\tpublic boolean equals(Object obj) {\n+\t\t\tthis.requireDelegate();\n \t\t\treturn this.delegate.equals(obj);\n \t\t}\n \n \t\t@Override\n \t\tpublic String toString() {\n+\t\t\tthis.requireDelegate();\n \t\t\treturn this.delegate.toString();\n \t\t}\n+\n+\t\tprivate void requireDelegate() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcxMDE2NQ==", "bodyText": "We don't use this. on methods...only members.", "url": "https://github.com/spring-projects/spring-security/pull/8451#discussion_r418710165", "createdAt": "2020-05-01T19:54:51Z", "author": {"login": "rwinch"}, "path": "test/src/main/java/org/springframework/security/test/web/servlet/setup/SecurityMockMvcConfigurer.java", "diffHunk": "@@ -123,33 +123,47 @@ Filter getDelegate() {\n \n \t\t@Override\n \t\tpublic void init(FilterConfig filterConfig) throws ServletException {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.init(filterConfig);\n \t\t}\n \n \t\t@Override\n \t\tpublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n \t\t\t\tthrows IOException, ServletException {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.doFilter(request, response, chain);\n \t\t}\n \n \t\t@Override\n \t\tpublic void destroy() {\n+\t\t\tthis.requireDelegate();\n \t\t\tthis.delegate.destroy();\n \t\t}\n \n \t\t@Override\n \t\tpublic int hashCode() {\n+\t\t\tthis.requireDelegate();\n \t\t\treturn this.delegate.hashCode();\n \t\t}\n \n \t\t@Override\n \t\tpublic boolean equals(Object obj) {\n+\t\t\tthis.requireDelegate();\n \t\t\treturn this.delegate.equals(obj);\n \t\t}\n \n \t\t@Override\n \t\tpublic String toString() {\n+\t\t\tthis.requireDelegate();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d87330a5321404d22327232cc6f4440a53ee1247", "author": {"user": {"login": "dadikovi", "name": "D\u00e1vid Kov\u00e1cs"}}, "url": "https://github.com/spring-projects/spring-security/commit/d87330a5321404d22327232cc6f4440a53ee1247", "committedDate": "2020-05-02T07:43:14Z", "message": "SecurityMockMvcConfigurer$DelegateFilter is not null-safe\n\nThis commit adds null-check to getter method, so instead of NPE an IllegalStateException will be thrown with additional details.\n\nFixes gh-7745"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "d87330a5321404d22327232cc6f4440a53ee1247", "author": {"user": {"login": "dadikovi", "name": "D\u00e1vid Kov\u00e1cs"}}, "url": "https://github.com/spring-projects/spring-security/commit/d87330a5321404d22327232cc6f4440a53ee1247", "committedDate": "2020-05-02T07:43:14Z", "message": "SecurityMockMvcConfigurer$DelegateFilter is not null-safe\n\nThis commit adds null-check to getter method, so instead of NPE an IllegalStateException will be thrown with additional details.\n\nFixes gh-7745"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4951, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}