{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0ODIxMTM2", "number": 2290, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozNToxMFrOD70OQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDowMzowMFrOD90BOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDQ4MTk0OnYy", "diffSide": "RIGHT", "path": "spring-cloud-gcp-dependencies/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozNToxMFrOGUX8nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozNToxMFrOGUX8nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxNzA1Mg==", "bodyText": "Does it make sense to move the version updates to a separate PR?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r424017052", "createdAt": "2020-05-12T20:35:10Z", "author": {"login": "elefeint"}, "path": "spring-cloud-gcp-dependencies/pom.xml", "diffHunk": "@@ -16,8 +16,8 @@\n \t<packaging>pom</packaging>\n \n \t<properties>\n-\t\t<gcp-libraries-bom.version>4.4.1</gcp-libraries-bom.version>\n-\t\t<cloud-sql-socket-factory.version>1.0.15</cloud-sql-socket-factory.version>\n+\t\t<gcp-libraries-bom.version>5.3.0</gcp-libraries-bom.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8df1343d2b6c7911a3eb6111f49bcf922623e6d"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTE5MDIzOnYy", "diffSide": "RIGHT", "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1NzoyN1rOGXMNKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzo1NToxMlrOGX2nFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDQwOA==", "bodyText": "right here will change with 0.17 we should use the correct brave.propagation package and add a comment that the underlying B3Propagation.Factory needs to be configured differently for sleuth 3.0\nThis can be a TODO I suppose as 3.0 isn't final anyway", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r426970408", "createdAt": "2020-05-19T00:57:27Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +218,8 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.FACTORY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMzQ3Mg==", "bodyText": "Do you mean that the B3Propagation.Factory would be configured differently in zipkin-gcp, because we're not configuring it here?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427313472", "createdAt": "2020-05-19T13:44:38Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +218,8 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.FACTORY);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDQwOA=="}, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2NTE3NQ==", "bodyText": "I mean what we are overriding will be different configuration 2.2.x vs 3.0.x. Until we some annotation or otherwise to indicate the \"real trace format\" factory vs the wrapped one, this project will have to build differently for 2.2.x vs 3.0 or have some logic etc. @spencergibb mentioned maybe we can change 3.0 to use the @Primary annotation. Will think about it. Anyway, this is fine for 2.2.x", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427665175", "createdAt": "2020-05-19T23:55:12Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +218,8 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.FACTORY);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDQwOA=="}, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTE5MjE5OnYy", "diffSide": "RIGHT", "path": "spring-cloud-gcp-samples/spring-cloud-gcp-trace-sample/src/test/java/brave/internal/HexCodec.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1ODozN1rOGXMOWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo0MzoxNFrOGXhFZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDcxMg==", "bodyText": "as this is src/test ... maybe just use Long.whatever? HexCodec is mostly for performance", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r426970712", "createdAt": "2020-05-19T00:58:37Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-trace-sample/src/test/java/brave/internal/HexCodec.java", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright 2013-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package brave.internal;\n+\n+// code originally imported from zipkin.Util\n+public final class HexCodec {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMjQ4Ng==", "bodyText": "I will remove this class altogether, since you've added it in 0.17.0.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427312486", "createdAt": "2020-05-19T13:43:14Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-trace-sample/src/test/java/brave/internal/HexCodec.java", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright 2013-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package brave.internal;\n+\n+// code originally imported from zipkin.Util\n+public final class HexCodec {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDcxMg=="}, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTQyMDA5OnYy", "diffSide": "RIGHT", "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDowMzowMFrOGXh7sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMDo1MzoyMFrOGX3n2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyNjM4NA==", "bodyText": "@adriancole I'm not sure if I have to pass in this B3Propagation, or it will be auto-configured like before.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427326384", "createdAt": "2020-05-19T14:03:00Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +219,9 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.newFactory(\n+\t\t\t\tB3Propagation.newFactoryBuilder().injectFormat(B3Propagation.Format.MULTI).build()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY2NTU5Nw==", "bodyText": "we don't have a way to pass this yet. so this is good enough for 2.2.x", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427665597", "createdAt": "2020-05-19T23:56:31Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +219,9 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.newFactory(\n+\t\t\t\tB3Propagation.newFactoryBuilder().injectFormat(B3Propagation.Format.MULTI).build()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyNjM4NA=="}, "originalCommit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY4MTc1Mw==", "bodyText": "Thanks!", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427681753", "createdAt": "2020-05-20T00:53:20Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +219,9 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.newFactory(\n+\t\t\t\tB3Propagation.newFactoryBuilder().injectFormat(B3Propagation.Format.MULTI).build()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyNjM4NA=="}, "originalCommit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2328, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}