{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MzM1MzU0", "number": 2523, "title": "Firestore extractDatabasePath update", "bodyText": "Updating extractDatabasePath to avoid org.apache.commons.lang3 dependency", "createdAt": "2020-09-15T14:24:30Z", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523", "merged": true, "mergeCommit": {"oid": "cc2a98f00bf71ad210720ca48b15f0f14e3c72e3"}, "closed": true, "closedAt": "2020-09-15T20:33:00Z", "author": {"login": "dmitry-s"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJIaxPAH2gAyNDg3MzM1MzU0OmUxMjYzNmU4ZDA5NDAyYzBjZDA3NzY0MjE4ZTNkYzNkNTI4NWM0ZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJMpK5gFqTQ4ODk4NDI5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e12636e8d09402c0cd07764218e3dc3d5285c4d0", "author": {"user": {"login": "dmitry-s", "name": null}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/e12636e8d09402c0cd07764218e3dc3d5285c4d0", "committedDate": "2020-09-15T14:11:02Z", "message": "fix firestore dependency issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2", "author": {"user": {"login": "dmitry-s", "name": null}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/f31436cec4f667573ab351ab352c90a2ebbb9fa2", "committedDate": "2020-09-15T14:21:28Z", "message": "update gcp-libraries-bom version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4Nzk2OTc3", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#pullrequestreview-488796977", "createdAt": "2020-09-15T15:19:19Z", "commit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNToxOToxOVrOHSHICw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNToxOToxOVrOHSHICw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc1MzE2Mw==", "bodyText": "What happened to StringUtils? Why can't we use it anymore?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#discussion_r488753163", "createdAt": "2020-09-15T15:19:19Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-data-firestore/src/main/java/org/springframework/cloud/gcp/data/firestore/util/Util.java", "diffHunk": "@@ -27,7 +25,20 @@ private Util() {\n \t}\n \n \tpublic static String extractDatabasePath(String parent) {\n-\t\treturn parent.substring(0, StringUtils.ordinalIndexOf(parent, \"/\", 4));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODQ2NTgy", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#pullrequestreview-488846582", "createdAt": "2020-09-15T16:12:37Z", "commit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoxMjozN1rOHSJdRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoxMjozN1rOHSJdRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5MTM2NQ==", "bodyText": "Since you're appending each character at a time anyway in a StringBuilder, might as well just do String.split(\"/\") and then do return arr[0] + \"/\" + arr[1] + ... + arr[3]; would be more readable (only 2-3 lines total).", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#discussion_r488791365", "createdAt": "2020-09-15T16:12:37Z", "author": {"login": "dzou"}, "path": "spring-cloud-gcp-data-firestore/src/main/java/org/springframework/cloud/gcp/data/firestore/util/Util.java", "diffHunk": "@@ -27,7 +25,20 @@ private Util() {\n \t}\n \n \tpublic static String extractDatabasePath(String parent) {\n-\t\treturn parent.substring(0, StringUtils.ordinalIndexOf(parent, \"/\", 4));\n+\t\t//the parent looks like this: projects/{project_id}/databases/{database_id}/...\n+\t\t//and the database path is the first 4 segments, separated by /\n+\t\tStringBuilder sb = new StringBuilder();\n+\t\tint count = 0;\n+\t\tfor (int i = 0; i < parent.length(); i++) {\n+\t\t\tchar c = parent.charAt(i);\n+\t\t\tif (c == '/') {\n+\t\t\t\tcount++;\n+\t\t\t}\n+\t\t\tif (count == 4) {\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tsb.append(c);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTMxODYy", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#pullrequestreview-488931862", "createdAt": "2020-09-15T17:58:39Z", "commit": {"oid": "f31436cec4f667573ab351ab352c90a2ebbb9fa2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65e17bd802a881d90a87a9b6cad4296d40124f12", "author": {"user": {"login": "dmitry-s", "name": null}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/65e17bd802a881d90a87a9b6cad4296d40124f12", "committedDate": "2020-09-15T18:27:19Z", "message": "roll back bom"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTg0Mjk2", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2523#pullrequestreview-488984296", "createdAt": "2020-09-15T19:06:23Z", "commit": {"oid": "65e17bd802a881d90a87a9b6cad4296d40124f12"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 417, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}