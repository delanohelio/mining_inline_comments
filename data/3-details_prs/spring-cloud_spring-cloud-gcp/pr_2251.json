{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5Mzk3MTgw", "number": 2251, "title": "Interpret missing maxMessages as MAX_INT in Pub/Sub PullRequests", "bodyText": "If the maxMessages parameter is provided as null in the PubSubTemplate, interpret this as Integer.MAX_INTEGER which means there should be no limit on the number of messages pulled.\nFixes #2248.", "createdAt": "2020-03-16T17:39:05Z", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251", "merged": true, "mergeCommit": {"oid": "07016c46812b6f3a05a017d22676d15d477657bd"}, "closed": true, "closedAt": "2020-03-16T18:15:31Z", "author": {"login": "dzou"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcORhRagH2gAyMzg5Mzk3MTgwOmE5YmZkOTdkYzhkZmJiZTBhMzcwZDk4NWZkYTk0OTczOGM4NjQxZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOSFEbgFqTM3NTQ2NDg2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a9bfd97dc8dfbbe0a370d985fda949738c8641fd", "author": {"user": {"login": "dzou", "name": "Daniel Zou"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/a9bfd97dc8dfbbe0a370d985fda949738c8641fd", "committedDate": "2020-03-16T17:25:45Z", "message": "Interpret null maxMessages as MAX_INTEGER."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2be916dae153a39e2c4d896ede0f38bffa80d616", "author": {"user": {"login": "dzou", "name": "Daniel Zou"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/2be916dae153a39e2c4d896ede0f38bffa80d616", "committedDate": "2020-03-16T17:29:18Z", "message": "Fix formatting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDQ3ODg3", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251#pullrequestreview-375447887", "createdAt": "2020-03-16T17:46:42Z", "commit": {"oid": "2be916dae153a39e2c4d896ede0f38bffa80d616"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDUxODU5", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251#pullrequestreview-375451859", "createdAt": "2020-03-16T17:52:08Z", "commit": {"oid": "2be916dae153a39e2c4d896ede0f38bffa80d616"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo1MjowOFrOF2_fKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo1Mzo1MVrOF2_i2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIwNzU5Mw==", "bodyText": "This is a nit, but can this be a different test? Null and negative numbers are distinct scenarios.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251#discussion_r393207593", "createdAt": "2020-03-16T17:52:08Z", "author": {"login": "elefeint"}, "path": "spring-cloud-gcp-pubsub/src/test/java/org/springframework/cloud/gcp/pubsub/support/DefaultSubscriberFactoryTests.java", "diffHunk": "@@ -70,4 +71,19 @@ public void testNewDefaultSubscriberFactory_nullProject() {\n \t\tnew DefaultSubscriberFactory(() -> null);\n \t}\n \n+\t@Test\n+\tpublic void testCreatePullRequest_nonZeroMaxMessages() {\n+\t\tDefaultSubscriberFactory factory = new DefaultSubscriberFactory(() -> \"project\");\n+\t\tfactory.setCredentialsProvider(this.credentialsProvider);\n+\n+\t\t// If a maxMessages is null (it was omitted), then set max to MAX_INT\n+\t\tPullRequest request = factory.createPullRequest(\"test\", null, true);\n+\t\tassertThat(request.getMaxMessages()).isEqualTo(Integer.MAX_VALUE);\n+\n+\t\t// If maxMessages < 0, should throw an error.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2be916dae153a39e2c4d896ede0f38bffa80d616"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIwODUzNg==", "bodyText": "Would it make sense to replace \"there is no limit\" with \"up to Integer.MAX_VALUE messages will be requested\"? I know that you documented it in refdoc, but for people who read javadoc it would be better to be explicit.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251#discussion_r393208536", "createdAt": "2020-03-16T17:53:51Z", "author": {"login": "elefeint"}, "path": "spring-cloud-gcp-pubsub/src/main/java/org/springframework/cloud/gcp/pubsub/core/subscriber/PubSubSubscriberOperations.java", "diffHunk": "@@ -86,7 +86,8 @@\n \t * Pull and auto-acknowledge a number of messages from a Google Cloud Pub/Sub subscription.\n \t * @param subscription canonical subscription name, e.g., \"subscriptionName\", or the fully-qualified\n \t * subscription name in the {@code projects/<project_name>/subscriptions/<subscription_name>} format\n-\t * @param maxMessages the maximum number of pulled messages\n+\t * @param maxMessages the maximum number of pulled messages. If this value is null then there is no limit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2be916dae153a39e2c4d896ede0f38bffa80d616"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7de728ed97b9423bc7bb1e1605f00832ac15f36", "author": {"user": {"login": "dzou", "name": "Daniel Zou"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/e7de728ed97b9423bc7bb1e1605f00832ac15f36", "committedDate": "2020-03-16T18:03:08Z", "message": "PR Comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDY0ODYw", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2251#pullrequestreview-375464860", "createdAt": "2020-03-16T18:04:51Z", "commit": {"oid": "e7de728ed97b9423bc7bb1e1605f00832ac15f36"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 572, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}