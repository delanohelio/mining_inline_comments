{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4MTg3ODgy", "number": 2146, "title": "Enable usage of projections within Slice repository queries", "bodyText": "This fixes the typing issue with projections so you can now use projection objects within your repositories queries that use Slice. i.e.\nSlice<TestEntityProjection> findByName(String name, Pageable pageable)\n\nFixes #2133.\nI think there is a bigger enhancement to make here -- I found that right now there is no performance benefit from using projections since when we issue the query to datastore, we don't restrict the query to only contain the necessary fields of the projection (we still just get everything). Filed #2145 to track.\ncc/ @Flexy-recruitment-backend", "createdAt": "2020-01-28T19:29:42Z", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146", "merged": true, "mergeCommit": {"oid": "5ccadabe566e3e436a63f6835246ad168ac6d062"}, "closed": true, "closedAt": "2020-01-29T16:03:25Z", "author": {"login": "dzou"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-2UEvAH2gAyMzY4MTg3ODgyOmVmOTdmYzIxYTBlYTY3YmZkZDJkYTg2ZjJhMzY4ZjNmODE4ZTM1NmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_HSURAFqTM1MDE3MzMyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ef97fc21a0ea67bfdd2da86f2a368f3f818e356a", "author": {"user": {"login": "dzou", "name": "Daniel Zou"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/ef97fc21a0ea67bfdd2da86f2a368f3f818e356a", "committedDate": "2020-01-28T19:15:02Z", "message": "Surface-level fix for projections queries."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5Njc0NDIx", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146#pullrequestreview-349674421", "createdAt": "2020-01-28T20:20:17Z", "commit": {"oid": "ef97fc21a0ea67bfdd2da86f2a368f3f818e356a"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMDoyMDoxN1rOFizM-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMDoyMDoxN1rOFizM-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjAzNDgwOA==", "bodyText": "remove @Param annotation", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146#discussion_r372034808", "createdAt": "2020-01-28T20:20:17Z", "author": {"login": "dmitry-s"}, "path": "spring-cloud-gcp-data-datastore/src/test/java/org/springframework/cloud/gcp/data/datastore/it/TestEntityRepository.java", "diffHunk": "@@ -107,6 +107,8 @@\n \t@Query(\"select * from  test_entities_ci where size = @size\")\n \tTestEntityProjection getBySize(@Param(\"size\") long size);\n \n+\tSlice<TestEntityProjection> findBySize(@Param(\"size\") long size, Pageable pageable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef97fc21a0ea67bfdd2da86f2a368f3f818e356a"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NzA5MjQ3", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146#pullrequestreview-349709247", "createdAt": "2020-01-28T21:16:52Z", "commit": {"oid": "ef97fc21a0ea67bfdd2da86f2a368f3f818e356a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMToxNjo1MlrOFi04Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMToxNjo1MlrOFi04Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA2MjIzNQ==", "bodyText": "Add assert on the property values.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146#discussion_r372062235", "createdAt": "2020-01-28T21:16:52Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-data-datastore/src/test/java/org/springframework/cloud/gcp/data/datastore/it/DatastoreIntegrationTests.java", "diffHunk": "@@ -793,6 +793,23 @@ public void sameClassDescendantsTest() {\n \t\tassertThat(readCompany.leaders).hasSize(1);\n \t\tassertThat(readCompany.leaders.get(0).id).isEqualTo(entity1.id);\n \t}\n+\n+\t@Test\n+\tpublic void testSlicedEntityProjections() {\n+\t\ttestEntityRepository.saveAll(this.allTestEntities);\n+\t\ttestEntityRepository.save(new TestEntity(123L, \"red\", 1L, Shape.CIRCLE, null));\n+\t\ttestEntityRepository.save(new TestEntity(456L, \"blue\", 2L, Shape.CIRCLE, null));\n+\n+\t\tSlice<TestEntityProjection> testEntityProjectionSlice =\n+\t\t\t\ttestEntityRepository.findBySize(1L, PageRequest.of(0, 1));\n+\n+\t\tList<TestEntityProjection> testEntityProjections =\n+\t\t\t\ttestEntityProjectionSlice.get().collect(Collectors.toList());\n+\n+\t\tassertThat(testEntityProjections).hasSize(1);\n+\t\tassertThat(testEntityProjections.get(0)).isInstanceOf(TestEntityProjection.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef97fc21a0ea67bfdd2da86f2a368f3f818e356a"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3cdc15eb418f9ebf43115109dd21827289c7815", "author": {"user": {"login": "dzou", "name": "Daniel Zou"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/f3cdc15eb418f9ebf43115109dd21827289c7815", "committedDate": "2020-01-28T22:29:11Z", "message": "PR Comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMTczMzIz", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2146#pullrequestreview-350173323", "createdAt": "2020-01-29T15:01:30Z", "commit": {"oid": "f3cdc15eb418f9ebf43115109dd21827289c7815"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 510, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}