{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NTA2NTE2", "number": 2395, "title": "Updates GAE samples and juggles some plugin bits", "bodyText": "Fixes #1682\nTwo commits here:\n\n\nBased on my preliminary research and a long discussion with the team yesterday around Maven plugins, I pulled the spring-boot-maven-plugin into the spring-cloud-gcp-samples parent POM. It looked like all modules under spring-cloud-gcp-samples were Spring Boot applications.\n\nI also pulled up the appengine-maven-plugin into the parent POM's pluginManagement now that I understand what that element does. In this case, I'm setting the version in one spot. It also appears this plugin is also used in the top-level spring-cloud-gcp POM, where I also updated it to the latest version. Based on my understanding now of plugin vs pluginManagement, I wonder why this plugin is needed here?\nI removed a few maven-deploy-plugins too - it's my understanding that this is only needed if these are to be published, which I don't think our samples need to be. To add to that, the configurations all had skip=true, which means they weren't doing anything anyway (maybe this was done to explicitly disable publishing?). I checked up the POM hierarchy and it doesn't appear that any parent POM applies this plugin (please doublecheck me on this though).\n\n\n\nThe second commit updates the 3 GAE Flex runnable samples to use GAE Standard with Java 11.  This was actually the driving force behind the first commit, as the JAR needs to be executable for GAE Standard, and the spring-boot-maven-plugin is what makes that happen (through a hook into the package goal).", "createdAt": "2020-05-28T14:01:05Z", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395", "merged": true, "mergeCommit": {"oid": "4b1f2c8ad146390a08ba96373806f775aa587f20"}, "closed": true, "closedAt": "2020-06-03T14:18:12Z", "author": {"login": "ttomsu"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclwVxLABqjMzODM1ODkwNTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnprYMgH2gAyNDI0NTA2NTE2OjhhZDZmY2M1ODJmZmU1M2U2MjAyY2IxYThlMTFjM2Q3M2NlOTBmMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b4377772b05215d9f0760af3a6b519985ec06498", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/b4377772b05215d9f0760af3a6b519985ec06498", "committedDate": "2020-05-28T13:58:26Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}, "afterCommit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/5b637f8ff48a3abecf33a84e6b404c528d92da86", "committedDate": "2020-05-28T16:18:11Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzA1MzQx", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#pullrequestreview-420305341", "createdAt": "2020-05-28T16:49:02Z", "commit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzkwMTIz", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#pullrequestreview-420390123", "createdAt": "2020-05-28T18:42:46Z", "commit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo0Mjo0NlrOGcB7Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo0Mjo0NlrOGcB7Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA0NDg1OA==", "bodyText": "What was the reason for adding this? Was there a build issue or something?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432044858", "createdAt": "2020-05-28T18:42:46Z", "author": {"login": "dzou"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-pubsub-stream-binder-functional-sample/spring-cloud-gcp-pubsub-stream-binder-functional-sample-test/pom.xml", "diffHunk": "@@ -48,5 +48,16 @@\n \n   </dependencies>\n \n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.springframework.boot</groupId>\n+        <artifactId>spring-boot-maven-plugin</artifactId>\n+        <configuration>\n+          <skip>true</skip>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzkwMzM2", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#pullrequestreview-420390336", "createdAt": "2020-05-28T18:43:02Z", "commit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b637f8ff48a3abecf33a84e6b404c528d92da86", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/5b637f8ff48a3abecf33a84e6b404c528d92da86", "committedDate": "2020-05-28T16:18:11Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}, "afterCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/7c79832f8b985621c746aab5ace1256d3df3d530", "committedDate": "2020-05-28T20:26:08Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDc0NjE2", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#pullrequestreview-420474616", "createdAt": "2020-05-28T20:40:05Z", "commit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNjQwMDQw", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#pullrequestreview-420640040", "createdAt": "2020-05-29T04:10:23Z", "commit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "state": "DISMISSED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNDoxMDoyM1rOGcOKuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNDoyMDowNFrOGcOS4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0NTQzMg==", "bodyText": "I believe this was necessary to skip publishing the module when the Spring Team runs mvn deploy. The default of the plugin is to not skip.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432245432", "createdAt": "2020-05-29T04:10:23Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/pom.xml", "diffHunk": "@@ -116,12 +117,20 @@\n \t</profiles>\n \n \t<build>\n+\t\t<pluginManagement>\n+\t\t\t<plugins>\n+\t\t\t\t<plugin>\n+\t\t\t\t\t<groupId>com.google.cloud.tools</groupId>\n+\t\t\t\t\t<artifactId>appengine-maven-plugin</artifactId>\n+\t\t\t\t\t<version>${app-engine-maven-plugin.version}</version>\n+\t\t\t\t</plugin>\n+\t\t\t</plugins>\n+\t\t</pluginManagement>\n \t\t<plugins>\n \t\t\t<plugin>\n-\t\t\t\t<artifactId>maven-deploy-plugin</artifactId>\n-\t\t\t\t<configuration>\n-\t\t\t\t\t<skip>true</skip>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0NTYxNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Deploy to Google AppEngine:\n          \n          \n            \n            Deploy to App Engine:", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432245614", "createdAt": "2020-05-29T04:11:16Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-logging-sample/README.adoc", "diffHunk": "@@ -25,9 +25,17 @@ $ curl --header \"x-cloud-trace-context: [Some-Trace-ID]\" localhost:8080/log\n To see the logged lines, navigate to the https://console.cloud.google.com/logs/viewer[Logging section of the Cloud Console].\n Select the `Global` resource and look under the `spring.log` channel to see the logged text.\n \n+=== Running on Google Cloud Platform\n+\n+Deploy to Google AppEngine:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0NjQzNg==", "bodyText": "What's the purpose of clean here?\nAlso, why do we have to specify project and version? I thought those were optional.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432246436", "createdAt": "2020-05-29T04:15:02Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-logging-sample/README.adoc", "diffHunk": "@@ -25,9 +25,17 @@ $ curl --header \"x-cloud-trace-context: [Some-Trace-ID]\" localhost:8080/log\n To see the logged lines, navigate to the https://console.cloud.google.com/logs/viewer[Logging section of the Cloud Console].\n Select the `Global` resource and look under the `spring.log` channel to see the logged text.\n \n+=== Running on Google Cloud Platform\n+\n+Deploy to Google AppEngine:\n+\n+----\n+$ mvn clean package appengine:deploy -Dapp.deploy.projectId=$PROJECT_ID -Dapp.deploy.version=$VERSION", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0NjY5OQ==", "bodyText": "Do we know for sure that the skip deploy configuration is inherited from the parent?\nWe really don't want to accidentally deploy samples to maven central.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432246699", "createdAt": "2020-05-29T04:16:13Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-logging-sample/pom.xml", "diffHunk": "@@ -69,13 +69,6 @@\n             <plugin>\n                 <groupId>com.google.cloud.tools</groupId>\n                 <artifactId>appengine-maven-plugin</artifactId>\n-                <version>1.3.2</version>\n-            </plugin>\n-            <plugin>\n-                <artifactId>maven-deploy-plugin</artifactId>\n-                <configuration>\n-                    <skip>true</skip>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0Njk3MQ==", "bodyText": "Is this based on experimentation or some guidance somewhere?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432246971", "createdAt": "2020-05-29T04:17:21Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-logging-sample/src/main/appengine/app.yaml", "diffHunk": "@@ -1,9 +1,5 @@\n-runtime: java\n-env: flex\n+runtime: java11\n+instance_class: F1\n \n-handlers:\n-- url: /.*\n-  script: this field is required, but ignored\n-\n-manual_scaling:\n-  instances: 1\n+env_variables:\n+  JAVA_TOOL_OPTIONS: \"-XX:MaxRAM=256m -XX:ActiveProcessorCount=2 -Xmx32m\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI0NzUyMg==", "bodyText": "What's the effect of this skip configuration on Spring Boot Maven plugin?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2395#discussion_r432247522", "createdAt": "2020-05-29T04:20:04Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-pubsub-stream-binder-functional-sample/pom.xml", "diffHunk": "@@ -32,4 +32,16 @@\n     </dependencies>\n   </dependencyManagement>\n \n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.springframework.boot</groupId>\n+        <artifactId>spring-boot-maven-plugin</artifactId>\n+        <configuration>\n+          <skip>true</skip>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33560dc0576b681a4bbb3c7d184371286affe272", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/33560dc0576b681a4bbb3c7d184371286affe272", "committedDate": "2020-06-03T13:36:34Z", "message": "plugins: Pulls spring-boot plugin into samples parent pom, updates GAE plugin version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b2fcd5eea2e05c9a3255917f9fb22c38f690738", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/6b2fcd5eea2e05c9a3255917f9fb22c38f690738", "committedDate": "2020-06-03T13:36:48Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c79832f8b985621c746aab5ace1256d3df3d530", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/7c79832f8b985621c746aab5ace1256d3df3d530", "committedDate": "2020-05-28T20:26:08Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}, "afterCommit": {"oid": "6b2fcd5eea2e05c9a3255917f9fb22c38f690738", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/6b2fcd5eea2e05c9a3255917f9fb22c38f690738", "committedDate": "2020-06-03T13:36:48Z", "message": "samples: Updates GAE Flex samples to GAE Standard w Java 11"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ad6fcc582ffe53e6202cb1a8e11c3d73ce90f1c", "author": {"user": null}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/8ad6fcc582ffe53e6202cb1a8e11c3d73ce90f1c", "committedDate": "2020-06-03T13:42:37Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Mike Eltsufin <meltsufin@google.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 466, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}