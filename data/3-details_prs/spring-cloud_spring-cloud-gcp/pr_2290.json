{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0ODIxMTM2", "number": 2290, "title": "Support Extra Propagation Fields with Trace", "bodyText": "Providing a Trace Propagation Factory Builder instead of just the Factory,\nwhich allows us to rely on the TraceAutoConfiguration.sleuthPropagation()\nrather than completely skipping it.\nFixes: #2268.", "createdAt": "2020-03-27T15:30:47Z", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290", "merged": true, "mergeCommit": {"oid": "514fcff7070cfb1c6d24fa1d659bab12f013577f"}, "closed": true, "closedAt": "2020-05-19T16:21:21Z", "author": {"login": "meltsufin"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRyZBrgH2gAyMzk0ODIxMTM2OjZmNTU1ZGY0MTJlOWE2ODk1Yzk5MDkyNmUyOWYwZmQxODRlNDQ4NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABci2sqjAFqTQxNDU5ODY2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6f555df412e9a6895c990926e29f0fd184e44854", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/6f555df412e9a6895c990926e29f0fd184e44854", "committedDate": "2020-03-27T15:25:23Z", "message": "Support Extra Propagation Fields with Trace\n\nProviding a Trace Propagation Factory Builder instead of just the Factory,\nwhile allows us to rely on the `TraceAutoConfiguration.sleuthPropagation()`\nrather than completely skipping it.\n\nFixes: #2268."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11ae661d1be236db89c8170e8b7f3ab1f0582506", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/11ae661d1be236db89c8170e8b7f3ab1f0582506", "committedDate": "2020-05-12T20:21:31Z", "message": "Update dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8df1343d2b6c7911a3eb6111f49bcf922623e6d", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/b8df1343d2b6c7911a3eb6111f49bcf922623e6d", "committedDate": "2020-05-12T20:24:41Z", "message": "Merge branch 'master' into trace-extra-fields"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNDAxMzUx", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#pullrequestreview-410401351", "createdAt": "2020-05-12T20:35:10Z", "commit": {"oid": "b8df1343d2b6c7911a3eb6111f49bcf922623e6d"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozNToxMFrOGUX8nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozNToxMFrOGUX8nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxNzA1Mg==", "bodyText": "Does it make sense to move the version updates to a separate PR?", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r424017052", "createdAt": "2020-05-12T20:35:10Z", "author": {"login": "elefeint"}, "path": "spring-cloud-gcp-dependencies/pom.xml", "diffHunk": "@@ -16,8 +16,8 @@\n \t<packaging>pom</packaging>\n \n \t<properties>\n-\t\t<gcp-libraries-bom.version>4.4.1</gcp-libraries-bom.version>\n-\t\t<cloud-sql-socket-factory.version>1.0.15</cloud-sql-socket-factory.version>\n+\t\t<gcp-libraries-bom.version>5.3.0</gcp-libraries-bom.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8df1343d2b6c7911a3eb6111f49bcf922623e6d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43908d85e8edf01ca36dce415e0fbdf4c93b7b11", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/43908d85e8edf01ca36dce415e0fbdf4c93b7b11", "committedDate": "2020-05-12T21:01:38Z", "message": "undo unrelated version updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81302d56765f4a85f8477ee5b8a561e3f8d20305", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/81302d56765f4a85f8477ee5b8a561e3f8d20305", "committedDate": "2020-05-18T22:11:58Z", "message": "Remove sampler auto-config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90e2f9f800d918f16326a3c2ee27e22ade116b94", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/90e2f9f800d918f16326a3c2ee27e22ade116b94", "committedDate": "2020-05-18T22:12:28Z", "message": "temporarily add HexCodec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/1fd018d20a145ed6b42ed876836a8b1f1e3c78a9", "committedDate": "2020-05-18T22:24:46Z", "message": "switch to BaggagePropagation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MDMxMTg2", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#pullrequestreview-414031186", "createdAt": "2020-05-19T00:57:27Z", "commit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1NzoyN1rOGXMNKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1NzoyN1rOGXMNKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDQwOA==", "bodyText": "right here will change with 0.17 we should use the correct brave.propagation package and add a comment that the underlying B3Propagation.Factory needs to be configured differently for sleuth 3.0\nThis can be a TODO I suppose as 3.0 isn't final anyway", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r426970408", "createdAt": "2020-05-19T00:57:27Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +218,8 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.FACTORY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MDMxNTYx", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#pullrequestreview-414031561", "createdAt": "2020-05-19T00:58:37Z", "commit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1ODozN1rOGXMOWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo1ODozN1rOGXMOWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk3MDcxMg==", "bodyText": "as this is src/test ... maybe just use Long.whatever? HexCodec is mostly for performance", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r426970712", "createdAt": "2020-05-19T00:58:37Z", "author": {"login": "codefromthecrypt"}, "path": "spring-cloud-gcp-samples/spring-cloud-gcp-trace-sample/src/test/java/brave/internal/HexCodec.java", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright 2013-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package brave.internal;\n+\n+// code originally imported from zipkin.Util\n+public final class HexCodec {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd018d20a145ed6b42ed876836a8b1f1e3c78a9"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6", "author": {"user": {"login": "meltsufin", "name": "Mike Eltsufin"}}, "url": "https://github.com/spring-cloud/spring-cloud-gcp/commit/5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6", "committedDate": "2020-05-19T14:00:30Z", "message": "upgrade to zipkin-gcp 0.17.0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDc2NzEy", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#pullrequestreview-414476712", "createdAt": "2020-05-19T14:03:00Z", "commit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDowMzowMFrOGXh7sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDowMzowMFrOGXh7sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyNjM4NA==", "bodyText": "@adriancole I'm not sure if I have to pass in this B3Propagation, or it will be auto-configured like before.", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#discussion_r427326384", "createdAt": "2020-05-19T14:03:00Z", "author": {"login": "meltsufin"}, "path": "spring-cloud-gcp-autoconfigure/src/main/java/org/springframework/cloud/gcp/autoconfigure/trace/StackdriverTraceAutoConfiguration.java", "diffHunk": "@@ -221,8 +219,9 @@ public Sender stackdriverSender(GcpTraceProperties traceProperties,\n \n \t@Bean\n \t@ConditionalOnMissingBean\n-\tpublic Propagation.Factory stackdriverPropagation() {\n-\t\treturn StackdriverTracePropagation.FACTORY;\n+\tpublic BaggagePropagation.FactoryBuilder baggagePropagationFactoryBuilder() {\n+\t\treturn BaggagePropagation.newFactoryBuilder(StackdriverTracePropagation.newFactory(\n+\t\t\t\tB3Propagation.newFactoryBuilder().injectFormat(B3Propagation.Format.MULTI).build()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NTk4NjY0", "url": "https://github.com/spring-cloud/spring-cloud-gcp/pull/2290#pullrequestreview-414598664", "createdAt": "2020-05-19T16:03:10Z", "commit": {"oid": "5ad71b86d9467e4b172053cbe9c6a3a9dd392ea6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 588, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}