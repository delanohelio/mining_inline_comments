{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3Njk0MTQ5", "number": 7685, "title": "Disable \"Show top value\" and \"Statistics\" field actions when field analysis is disabled", "bodyText": "Note: This PR requires a backport for 3.2\nAs described in #7508 field actions like \"Show top values / aggregate\" are enabled, even when the field is part of the list \"UI analysis disabled for fields\", which can be configured in System/Configurations.\nWith these changes we are simply checking if a field is part of the \"analysis disabled fields\" list, when determining if a field action should be enabled.\nPlease note, beside the mentioned \"Show top values / aggregate\" field action I've also added the check for the \"Statistics\" field action.\nWe need to merge the related enterprise PR first to avoid the failing test.\nFixes: #7508\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-03-13T10:10:25Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7685", "merged": true, "mergeCommit": {"oid": "c20fce564e7761913f171c325f9b0c43029b6670"}, "closed": true, "closedAt": "2020-03-17T11:20:59Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNNACJAH2gAyMzg3Njk0MTQ5OjI1MDc4YjY0ZDI1OGYzYjRmMWIwMDQ1ZjJiMGMyYzVmMzNiNDEyYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOg5bvgFqTM3NTk0MzgwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "25078b64d258f3b4f1b0045f2b0c2c5f33b412a4", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/25078b64d258f3b4f1b0045f2b0c2c5f33b412a4", "committedDate": "2020-03-13T09:35:54Z", "message": "Disable field actions if field analysis is disabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6dcc13913eb7bd14146c65382f6f5b7abf08f01", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/c6dcc13913eb7bd14146c65382f6f5b7abf08f01", "committedDate": "2020-03-13T09:47:24Z", "message": "Use SearchConfigStore instead of ConfigStore to get analysisDisabledFields on extended search page\n\n* Besides beeing best practice this avoids an unnecessary backend request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe1a49a939d266807370820797adb646cf1cd820", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/fe1a49a939d266807370820797adb646cf1cd820", "committedDate": "2020-03-13T09:54:51Z", "message": "Fix ExtendedSearchPage test by mocking SearchConfigStore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb5589bd3356c8f4b32a96704391e21a65808f60", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/fb5589bd3356c8f4b32a96704391e21a65808f60", "committedDate": "2020-03-13T10:11:54Z", "message": "Remove not needed boolean casting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTg1MTYw", "url": "https://github.com/Graylog2/graylog2-server/pull/7685#pullrequestreview-374185160", "createdAt": "2020-03-13T10:16:26Z", "commit": {"oid": "fb5589bd3356c8f4b32a96704391e21a65808f60"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMDoxNjoyNlrOF1-SLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMDoxNjoyNlrOF1-SLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEzOTMxMA==", "bodyText": "This function is very simple, but I would still prefer an own function to do the \"analysis disabled\" check. I would like to avoid, adding helper functions to the bindings file. Were would you add this function? Maybe as a static method of views/logic/fieldtypes/FieldType.js?", "url": "https://github.com/Graylog2/graylog2-server/pull/7685#discussion_r392139310", "createdAt": "2020-03-13T10:16:26Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/bindings.jsx", "diffHunk": "@@ -109,6 +109,8 @@ ViewSharing.registerSubtype(SpecificUsers.Type, SpecificUsers);\n Parameter.registerSubtype(ValueParameter.type, ValueParameter);\n Parameter.registerSubtype(LookupTableParameter.type, LookupTableParameter);\n \n+const isAnalysisDisabled = (field: string, analysisDisabledFields: string[] = []) => analysisDisabledFields.includes(field);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb5589bd3356c8f4b32a96704391e21a65808f60"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Mjg2MDY0", "url": "https://github.com/Graylog2/graylog2-server/pull/7685#pullrequestreview-375286064", "createdAt": "2020-03-16T14:45:23Z", "commit": {"oid": "fb5589bd3356c8f4b32a96704391e21a65808f60"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3fa79a8aa6953d15c522221b172e05ccc024e3c", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/a3fa79a8aa6953d15c522221b172e05ccc024e3c", "committedDate": "2020-03-16T15:30:19Z", "message": "Wrap full extended search page in ViewAdditionalContextProvider instead of only SearchResult"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1OTQzODAx", "url": "https://github.com/Graylog2/graylog2-server/pull/7685#pullrequestreview-375943801", "createdAt": "2020-03-17T11:20:43Z", "commit": {"oid": "a3fa79a8aa6953d15c522221b172e05ccc024e3c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2581, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}