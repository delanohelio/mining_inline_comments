{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNTA0Mzg0", "number": 8856, "title": "Show confirmation dialog on role delete with info about assigned users", "bodyText": "With this PR we are informing the user how many users are assigned to a role, in the role delete confirmation dialog.\nFixes: #8754\n/jenkins-pr-deps Graylog2/graylog-plugin-enterprise#1569", "createdAt": "2020-08-24T13:07:53Z", "url": "https://github.com/Graylog2/graylog2-server/pull/8856", "merged": true, "mergeCommit": {"oid": "db93ac12ff11fb735713c17be5d94a5793da262b"}, "closed": true, "closedAt": "2020-08-25T12:58:24Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCCLSCgH2gAyNDcyNTA0Mzg0OjU5YWNlYTFkODU4NzY4YmQ4ZDhhYTQyMzFiZTk4Y2I3ZjJhNGM4MTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCWyczAFqTQ3NDMxNjYyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "59acea1d858768bd8d8aa4231be98cb7f2a4c818", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/59acea1d858768bd8d8aa4231be98cb7f2a4c818", "committedDate": "2020-08-24T12:57:13Z", "message": "Check if role is assigned to users on role delete"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTg2MjQx", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#pullrequestreview-473586241", "createdAt": "2020-08-24T14:58:42Z", "commit": {"oid": "59acea1d858768bd8d8aa4231be98cb7f2a4c818"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo1ODo0MlrOHFpC1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo1ODo0MlrOHFpC1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY3NzM5Nw==", "bodyText": "Instead of asking for all users just to check if there is more then one, perhaps we should ask for one user? Because we will get a 'total' attribute in the pagination which tells us how many there are.", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#discussion_r475677397", "createdAt": "2020-08-24T14:58:42Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/components/roles/RolesOverview/ActionsCell.jsx", "diffHunk": "@@ -21,29 +21,29 @@ const ActtionsWrapper = styled.div`\n   justify-content: flex-end;\n `;\n \n-const ActionsCell = ({ roleId, roleName, readOnly }: Props) => {\n-  const _deleteRole = () => {\n+const _deleteRole = (roleId: $PropertyType<Role, 'id'>, roleName: $PropertyType<Role, 'name'>, setDeleting: boolean => void) => {\n+  let confirmMessage = `Do you really want to delete role \"${roleName}?\"`;\n+  const getUnlimited = [1, 0, ''];\n+  setDeleting(true);\n+\n+  AuthzRolesActions.loadUsersForRole(roleId, ...getUnlimited).then((paginatedUsers) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59acea1d858768bd8d8aa4231be98cb7f2a4c818"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61f985d71a85e0b665860ca97888d90432416259", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/61f985d71a85e0b665860ca97888d90432416259", "committedDate": "2020-08-24T16:03:07Z", "message": "Improve role delete confirmation message and improve data fetching"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "792f68bd86a455e6db3f513cf1083eb9413ce81f", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/792f68bd86a455e6db3f513cf1083eb9413ce81f", "committedDate": "2020-08-25T11:49:37Z", "message": "Rename attribute"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0MzE2NjI5", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#pullrequestreview-474316629", "createdAt": "2020-08-25T09:47:10Z", "commit": {"oid": "61f985d71a85e0b665860ca97888d90432416259"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0NzoxMFrOHGQaBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0NzoxMFrOHGQaBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMyMjMwOA==", "bodyText": "paginationForFirstRole", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#discussion_r476322308", "createdAt": "2020-08-25T09:47:10Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/components/roles/RolesOverview/ActionsCell.jsx", "diffHunk": "@@ -21,29 +21,29 @@ const ActtionsWrapper = styled.div`\n   justify-content: flex-end;\n `;\n \n-const ActionsCell = ({ roleId, roleName, readOnly }: Props) => {\n-  const _deleteRole = () => {\n+const _deleteRole = (roleId: $PropertyType<Role, 'id'>, roleName: $PropertyType<Role, 'name'>, setDeleting: boolean => void) => {\n+  let confirmMessage = `Do you really want to delete role \"${roleName}?\"`;\n+  const pagination = [1, 1, ''];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61f985d71a85e0b665860ca97888d90432416259"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2860, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}