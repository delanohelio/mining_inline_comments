{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MTEzMDk2", "number": 8718, "title": "Graylog Noir", "bodyText": "Description\n\nGraylog Noir\n/jenkins-pr-deps Graylog2/graylog-plugin-enterprise#1721\nMotivation and Context\n\n\nTheme All The Things!\nScreenshots (if appropriate):\n\n\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-08-06T15:50:45Z", "url": "https://github.com/Graylog2/graylog2-server/pull/8718", "merged": true, "mergeCommit": {"oid": "cf25cc591bd83dbbb89f071e82b6321e5ce27a49"}, "closed": true, "closedAt": "2020-08-13T13:54:39Z", "author": {"login": "kyleknighted"}, "timelineItems": {"totalCount": 32, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9jEvVgBqjM2MzkwMjg1NTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-gZtlAFqTQ2Njc4MzkyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c0522c82c0b60f9dc0eae86ffe6b0651b33b023", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1c0522c82c0b60f9dc0eae86ffe6b0651b33b023", "committedDate": "2020-08-06T22:40:26Z", "message": "Scratchpad styles adjustment"}, "afterCommit": {"oid": "07faa5bb64839d43c65ead725e9e04248a4e4952", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/07faa5bb64839d43c65ead725e9e04248a4e4952", "committedDate": "2020-08-10T14:22:02Z", "message": "Rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e4232af07297492d6bf74d074b525355345ca58", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/4e4232af07297492d6bf74d074b525355345ca58", "committedDate": "2020-08-12T10:52:26Z", "message": "Implementing Dark Mode Toggle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1351cf4a19230d01c48567d4ec72a50eb2efb124", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1351cf4a19230d01c48567d4ec72a50eb2efb124", "committedDate": "2020-08-12T10:52:26Z", "message": "Keep preferences after set"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "576c5211371dc91ee506ec1102cf42133c6ef0fd", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/576c5211371dc91ee506ec1102cf42133c6ef0fd", "committedDate": "2020-08-12T10:52:26Z", "message": "Toggle Icon Color"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5bd6baeda8371fdefa800a4ee5388cf15e73380", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/a5bd6baeda8371fdefa800a4ee5388cf15e73380", "committedDate": "2020-08-12T10:52:26Z", "message": "no themeModes in theme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc033b1ba4fe44b6dafd72b2b16610690ebb203b", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/dc033b1ba4fe44b6dafd72b2b16610690ebb203b", "committedDate": "2020-08-12T10:52:26Z", "message": "Updated Colors documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a546bc9eaaaa174472f64068e56012b540a68fd", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/7a546bc9eaaaa174472f64068e56012b540a68fd", "committedDate": "2020-08-12T10:52:26Z", "message": "Updated variant color ratios"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "807ebf149c734cdd3f59d5e67ee0584423b9ed5b", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/807ebf149c734cdd3f59d5e67ee0584423b9ed5b", "committedDate": "2020-08-12T10:52:26Z", "message": "Flow typing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f17b7a374b89c00b18f0b57e6b4a46066b2b481", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1f17b7a374b89c00b18f0b57e6b4a46066b2b481", "committedDate": "2020-08-12T10:52:26Z", "message": "Rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a54de0c6ddf559a06983aaebb8f976879ad1129f", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/a54de0c6ddf559a06983aaebb8f976879ad1129f", "committedDate": "2020-08-12T10:52:26Z", "message": "Stop flash of teint while using noir"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13ee8b13479212e8f7fcf1cd4e51d5cc197bafff", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/13ee8b13479212e8f7fcf1cd4e51d5cc197bafff", "committedDate": "2020-08-12T10:52:26Z", "message": "Scratchpad styles adjustment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7967e6e0d61937ee0404306e119272808f1478e4", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/7967e6e0d61937ee0404306e119272808f1478e4", "committedDate": "2020-08-12T10:52:26Z", "message": "Implementing Dark Mode Toggle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95672a0675c19bf20cf9f1fa5a2f76036c85ce10", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/95672a0675c19bf20cf9f1fa5a2f76036c85ce10", "committedDate": "2020-08-12T10:52:26Z", "message": "Updated variant color ratios"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54bda04be486491cacc5aa9d64902077e512a3a0", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/54bda04be486491cacc5aa9d64902077e512a3a0", "committedDate": "2020-08-12T10:52:26Z", "message": "Rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5529c7f230087b175c73f2f9b00adedc3256561e", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/5529c7f230087b175c73f2f9b00adedc3256561e", "committedDate": "2020-08-12T10:52:26Z", "message": "Auto-update theme mode from browser/os options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b160a1cec08792b72ff57e44c6a5d0928fa75631", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/b160a1cec08792b72ff57e44c6a5d0928fa75631", "committedDate": "2020-08-12T10:52:26Z", "message": "Adding doc link to useMatchMedia hook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8b683e034f64d099ed56eb76d50103724caca19", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/f8b683e034f64d099ed56eb76d50103724caca19", "committedDate": "2020-08-12T10:52:26Z", "message": "Admin can toggle themes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "936dbc5f5491a268b6f87f3a613cf8323854d3a5", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/936dbc5f5491a268b6f87f3a613cf8323854d3a5", "committedDate": "2020-08-12T10:52:26Z", "message": "LoginBox styles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ee443ebb949ab57005f138c0dc44d838598605c", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/4ee443ebb949ab57005f138c0dc44d838598605c", "committedDate": "2020-08-12T10:52:26Z", "message": "Theme toggle colors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecf6edb9bcde0d6ca8ee290a0b59f9232d17dce6", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/ecf6edb9bcde0d6ca8ee290a0b59f9232d17dce6", "committedDate": "2020-08-12T10:52:26Z", "message": "deprecated Icon name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2207a8dd499aba41e1f590622ca9f2cd3aa014a", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/e2207a8dd499aba41e1f590622ca9f2cd3aa014a", "committedDate": "2020-08-12T10:52:26Z", "message": "Theme styles for Well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0598c19623ccf096157b1c9213d3d17645c113f", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/b0598c19623ccf096157b1c9213d3d17645c113f", "committedDate": "2020-08-12T10:52:26Z", "message": "usePrefersColorScheme hook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1368a9afd8283c9a8e15db1db04f6c05ed8d54ee", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1368a9afd8283c9a8e15db1db04f6c05ed8d54ee", "committedDate": "2020-08-12T10:52:26Z", "message": "Updating WrappingContainer to stub out ThemeProvider directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c557b08bda4a02babd6409cc684c45497d5e55df", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/c557b08bda4a02babd6409cc684c45497d5e55df", "committedDate": "2020-08-11T20:19:40Z", "message": "Updating WrappingContainer to stub out ThemeProvider directly"}, "afterCommit": {"oid": "1368a9afd8283c9a8e15db1db04f6c05ed8d54ee", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1368a9afd8283c9a8e15db1db04f6c05ed8d54ee", "committedDate": "2020-08-12T10:52:26Z", "message": "Updating WrappingContainer to stub out ThemeProvider directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de8b100a248dac8b4e1c010674e257851dd6300a", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/de8b100a248dac8b4e1c010674e257851dd6300a", "committedDate": "2020-08-12T10:54:11Z", "message": "snapshots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6e25abd9228cfc687139bce970cb548a9b77df", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/4c6e25abd9228cfc687139bce970cb548a9b77df", "committedDate": "2020-08-12T11:05:40Z", "message": "one test issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f513df9be406826311d97012409dd5cc40c5edd", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/5f513df9be406826311d97012409dd5cc40c5edd", "committedDate": "2020-08-12T14:39:33Z", "message": "Fix tests for NavigationLink, ShowMessagePage, AggregationControls and GenericPlot"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/01d8b52f2f75e06541b0971d8a22b62cc3d3dabe", "committedDate": "2020-08-12T15:03:57Z", "message": "Moving Popover mock to __mocks__"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjIxODYy", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#pullrequestreview-466621862", "createdAt": "2020-08-13T10:05:40Z", "commit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMDowNTo0MFrOHAE5ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMToyMDo1OFrOHAHL1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0MjM2Mg==", "bodyText": "ThemeModeToggle does not take a username as props. Or am I wrong?", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#discussion_r469842362", "createdAt": "2020-08-13T10:05:40Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/components/navigation/UserMenu.jsx", "diffHunk": "@@ -29,6 +31,10 @@ class UserMenu extends React.Component {\n                    noCaret>\n         <MenuItem header>{fullName}</MenuItem>\n         <MenuItem divider />\n+        <MenuItem header>\n+          <ThemeModeToggle username={loginName} />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0MzU3Mw==", "bodyText": "useBrowserColorScheme ???", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#discussion_r469843573", "createdAt": "2020-08-13T10:07:57Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/hooks/usePrefersColorScheme.js", "diffHunk": "@@ -0,0 +1,50 @@\n+import { useState, useEffect } from 'react';\n+\n+import { THEME_MODE_DARK, THEME_MODE_LIGHT } from 'theme/constants';\n+\n+// * https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\n+// * https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList\n+// * https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Testing_media_queries\n+// * https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme\n+\n+const usePrefersColorScheme = () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3OTc2Ng==", "bodyText": "I guess it is a matter of taste, but I would rather have a deconstructed import of useState and co.", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#discussion_r469879766", "createdAt": "2020-08-13T11:20:58Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/theme/GraylogThemeProvider.jsx", "diffHunk": "@@ -1,30 +1,112 @@\n-import React from 'react';\n+// @flow strict\n+import * as React from 'react';\n import PropTypes from 'prop-types';\n import { ThemeProvider } from 'styled-components';\n \n+import { useStore } from 'stores/connect';\n+import Store from 'logic/local-storage/Store';\n import { breakpoints, colors, fonts, utils } from 'theme';\n+import type { ThemeInterface } from 'theme';\n+import usePrefersColorScheme from 'hooks/usePrefersColorScheme';\n import buttonStyles from 'components/graylog/styles/buttonStyles';\n import aceEditorStyles from 'components/graylog/styles/aceEditorStyles';\n+import StoreProvider from 'injection/StoreProvider';\n+import CombinedProvider from 'injection/CombinedProvider';\n \n-/* NOTE: mode will eventually need to come from User Preferences */\n-const THEME_MODE = 'teinte';\n-\n-const GraylogThemeProvider = ({ children }) => {\n-  return (\n-    <ThemeProvider theme={{\n-      mode: THEME_MODE,\n-      breakpoints,\n-      colors,\n-      fonts,\n-      components: {\n-        button: buttonStyles({ colors, utils }),\n-        aceEditor: aceEditorStyles({ colors }),\n-      },\n-      utils,\n-    }}>\n+import { PREFERENCES_THEME_MODE, DEFAULT_THEME_MODE, THEME_MODE_DARK, THEME_MODE_LIGHT } from './constants';\n+\n+type Props = {\n+  children: React.Node,\n+};\n+\n+const { CurrentUserStore } = CombinedProvider.get('CurrentUser');\n+const PreferencesStore = StoreProvider.getStore('Preferences');\n+\n+const GraylogThemeProvider = ({ children }: Props) => {\n+  const colorScheme = usePrefersColorScheme();\n+  const [theme, setTheme] = React.useState();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2421f5b735804d1953dd28ac32528d652cca1703", "author": {"user": {"login": "kyleknighted", "name": "Kyle Knight"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/2421f5b735804d1953dd28ac32528d652cca1703", "committedDate": "2020-08-13T12:50:18Z", "message": "Fixing annotations from @kmerz"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NzQwMDM0", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#pullrequestreview-466740034", "createdAt": "2020-08-13T13:04:31Z", "commit": {"oid": "2421f5b735804d1953dd28ac32528d652cca1703"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NzgzOTI5", "url": "https://github.com/Graylog2/graylog2-server/pull/8718#pullrequestreview-466783929", "createdAt": "2020-08-13T13:54:27Z", "commit": {"oid": "01d8b52f2f75e06541b0971d8a22b62cc3d3dabe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2941, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}