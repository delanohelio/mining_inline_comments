{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyMTI1ODM4", "number": 7159, "title": "Implement overlay for select menu", "bodyText": "The current dropdown menu of the Select component sometimes gets cut off and some options are no longer selectable. Here is an example of the aggregation builder:\n\nThis PR implements the Overlay from react-overlay to display the menu independently from its parent containers.\n\nThe new menu wrapper also defines a minimum width of 200px, until now a dropdown could be very small, depending on the parent container.\nBy default the menu has still the width of the related select input.\nWith these changes we are also breaking long option names.\nBefore (master):\n\nThe user has to scroll horizontally to read the full name, the style is broken, even the list items have a width of 100%.\nAfter:\n\nIn my opinion the second solution it easier to read. Even when long option names, separated by underscores are not getting perfectly wrapped. What do you think?\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-01-13T13:45:42Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7159", "merged": true, "mergeCommit": {"oid": "b144aaf6dcff865744473a5d0a777f949a59b457"}, "closed": true, "closedAt": "2020-01-20T09:51:24Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb58onogFqTM0MTg1MzIxMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8Jc6vgFqTM0NTE4NzkxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxODUzMjEy", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#pullrequestreview-341853212", "createdAt": "2020-01-13T13:47:17Z", "commit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo0NzoxN1rOFc3Xgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo0NzoxN1rOFc3Xgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxMTU4Ng==", "bodyText": "Would it make sense to implement useMemo for this function call as well?", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#discussion_r365811586", "createdAt": "2020-01-13T13:47:17Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/Select.jsx", "diffHunk": "@@ -62,9 +99,10 @@ const Select = ({ components, styles, ...rest }: Props) => {\n     multiValueLabel,\n     multiValueRemove,\n     valueContainer,\n+    menu: menu(selectRef),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxODU0OTkw", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#pullrequestreview-341854990", "createdAt": "2020-01-13T13:50:01Z", "commit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo1MDowMlrOFc3c7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo1MDowMlrOFc3c7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxMjk3Mw==", "bodyText": "Should I make this min width optional?\nRight now I could not find a use case where the min width of 200px is not suitable.", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#discussion_r365812973", "createdAt": "2020-01-13T13:50:02Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/Select.jsx", "diffHunk": "@@ -11,6 +14,20 @@ const MultiValueRemove = (props) => {\n   );\n };\n \n+const OverlayInner = ({ children, style }: {children: Node, style?: Object}) => React.Children.map(children,\n+  child => React.cloneElement(child, { style: Object.assign({}, style, child.props.style) }));\n+\n+const menu = (selectRef) => {\n+  const defaultMinWidth = 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxODU2NDQw", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#pullrequestreview-341856440", "createdAt": "2020-01-13T13:52:18Z", "commit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo1MjoxOFrOFc3hCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMzo1MjoxOFrOFc3hCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxNDAyNQ==", "bodyText": "With this implementation we are defining the width without a unit. The px info gets added automatically. Do you prefer adding px manually with a template string, to be more explicit?", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#discussion_r365814025", "createdAt": "2020-01-13T13:52:18Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/Select.jsx", "diffHunk": "@@ -11,6 +14,20 @@ const MultiValueRemove = (props) => {\n   );\n };\n \n+const OverlayInner = ({ children, style }: {children: Node, style?: Object}) => React.Children.map(children,\n+  child => React.cloneElement(child, { style: Object.assign({}, style, child.props.style) }));\n+\n+const menu = (selectRef) => {\n+  const defaultMinWidth = 200;\n+  const containerWidth = get(selectRef, 'current.select.controlRef.offsetWidth');\n+  const width = containerWidth > defaultMinWidth ? containerWidth : defaultMinWidth;\n+  return base => ({\n+    ...base,\n+    position: 'relative',\n+    width,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4ee1dc231ec287ae559bfff6b793389fd4e1d19"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a3307c3860505344201a5d17d4af0f399a4bb7e", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/4a3307c3860505344201a5d17d4af0f399a4bb7e", "committedDate": "2020-01-15T07:56:31Z", "message": "Implement react overlay for select menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a56e7bc1c736b6b298d91bd2f6d1101d44fe96c2", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/a56e7bc1c736b6b298d91bd2f6d1101d44fe96c2", "committedDate": "2020-01-15T07:56:31Z", "message": "Remove not needed Select menu overlay props"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e8d0adbff4470b1d285fa13b8a070a55f43c079", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/4e8d0adbff4470b1d285fa13b8a070a55f43c079", "committedDate": "2020-01-15T07:56:31Z", "message": "Add needed showUpdatePosition for Select menu overview"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f615353b00e8d296a606e7cf471f2d654f9d50c4", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/f615353b00e8d296a606e7cf471f2d654f9d50c4", "committedDate": "2020-01-15T07:56:31Z", "message": "Use unit when defining Select menu width"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6067017b73e8cdff7da23a6b52846b94bc0d04aa", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/6067017b73e8cdff7da23a6b52846b94bc0d04aa", "committedDate": "2020-01-15T07:56:32Z", "message": "Break long option names inside Select menu"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1a9db1ea4886cf18fcc4382cd8fa440e655ba18d", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1a9db1ea4886cf18fcc4382cd8fa440e655ba18d", "committedDate": "2020-01-14T09:28:16Z", "message": "Break long option names inside Select menu"}, "afterCommit": {"oid": "6067017b73e8cdff7da23a6b52846b94bc0d04aa", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/6067017b73e8cdff7da23a6b52846b94bc0d04aa", "committedDate": "2020-01-15T07:56:32Z", "message": "Break long option names inside Select menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "940276555d7fc7eb90ec1c10a2240ba3433e100e", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/940276555d7fc7eb90ec1c10a2240ba3433e100e", "committedDate": "2020-01-16T10:26:08Z", "message": "Implement useMemo for Select menu style creation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTg3OTE5", "url": "https://github.com/Graylog2/graylog2-server/pull/7159#pullrequestreview-345187919", "createdAt": "2020-01-20T09:51:07Z", "commit": {"oid": "940276555d7fc7eb90ec1c10a2240ba3433e100e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2810, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}