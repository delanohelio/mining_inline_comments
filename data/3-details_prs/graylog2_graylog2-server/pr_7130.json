{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMDE3NDE0", "number": 7130, "title": "Enforce system wide TLS protocol settings", "bodyText": "With the introduction of netty 4 in Graylog 3.0, we changed the default\nSslProvider to OpenSSL.\nWhile this gives a better performance, it lacks the ability to disable\nTLS protocols that are considered flawed.\nChanges to the java security properties are only respected by jdk based\nSslProviders (jersey / grizzly in our case).\nIntroduce a system wide default setting for supported TLS protocols,\nwith a sane default to TLSv1.2 (and TLSv1.3 if the jdk supports it).\nThese protocol settings are applied to netty based inputs and\nto the webserver.\nChanges can be made with a new server setting:\n#enabled_tls_protocols = TLSv1.2,TLSv1.3\nFixes #6444\nPS: This can be tested by using\nnmap --script ssl-enum-ciphers -p <inputs-port> 127.0.0.1\nPPS: For a more detailed test, use: https://github.com/drwetter/testssl.sh", "createdAt": "2020-01-09T15:29:05Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7130", "merged": true, "mergeCommit": {"oid": "2915eb09aafbf4cf3861f5459ba73ef297e24eaf"}, "closed": true, "closedAt": "2020-01-13T15:24:24Z", "author": {"login": "mpfz0r"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4rpqpgH2gAyMzYxMDE3NDE0OjhhNGExOWZlZTMxZTY0ZWFjNGFlMDg2ZTliZGE0YjIwNGUwYjE0NWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5-BPggFqTM0MTkyMjA3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8a4a19fee31e64eac4ae086e9bda4b204e0b145d", "author": {"user": {"login": "mpfz0r", "name": "Marco Pfatschbacher"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/8a4a19fee31e64eac4ae086e9bda4b204e0b145d", "committedDate": "2020-01-09T15:26:07Z", "message": "Enforce system wide TLS protocol settings\n\nWith the introduction of netty 4 in Graylog 3.0, we changed the default\nSslProvider to OpenSSL.\nWhile this gives a better performance, it lacks the ability to disable\nTLS protocols that are considered flawed.\nChanges to the java security properties are only respected by jdk based\nSslProviders (jersey / grizzly in our case).\n\nIntroduce a system wide default setting for supported TLS protocols,\nwith a sane default to TLSv1.2 (and TLSv1.3 if the jdk supports it).\nThese protocol settings are applied to netty based inputs and\nto the webserver.\n\nChanges can be made with a new server setting:\n`#enabled_tls_protocols = TLSv1.2,TLSv1.3`\n\nFixes #6444"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNjE4MDk0", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#pullrequestreview-340618094", "createdAt": "2020-01-09T15:47:16Z", "commit": {"oid": "8a4a19fee31e64eac4ae086e9bda4b204e0b145d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNTo0NzoxNlrOFb6cdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNTo0NzoxNlrOFb6cdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgxMzQyOA==", "bodyText": "We should add an entry to misc/graylog.conf including a comment that describes the available options.", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#discussion_r364813428", "createdAt": "2020-01-09T15:47:16Z", "author": {"login": "bernd"}, "path": "graylog2-server/src/main/java/org/graylog2/Configuration.java", "diffHunk": "@@ -158,6 +159,11 @@\n     @Parameter(value = \"deactivated_builtin_authentication_providers\", converter = StringSetConverter.class)\n     private Set<String> deactivatedBuiltinAuthenticationProviders = Collections.emptySet();\n \n+    // Defaults to TLS protocols that are currently considered secure\n+    @Parameter(value = \"enabled_tls_protocols\", converter = StringSetConverter.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4a19fee31e64eac4ae086e9bda4b204e0b145d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNjY0MTQ2", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#pullrequestreview-340664146", "createdAt": "2020-01-09T16:46:34Z", "commit": {"oid": "8a4a19fee31e64eac4ae086e9bda4b204e0b145d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjo0NjozNFrOFb8hyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjo0NjozNFrOFb8hyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg0NzU2MQ==", "bodyText": "I noticed that the default we use in 3.1 and earlier is TLSv1.0, TLSv1.1 and TLSv1.2. Changing this to TLSv1.2 and TLSv1.3 only would be a breaking change and might result in broken user and customer setups. So I think we need to enable all previous defaults to avoid any issues.\nWe should probably document that people should switch to more secure ones. With the next major release (v4) we can change the default.", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#discussion_r364847561", "createdAt": "2020-01-09T16:46:34Z", "author": {"login": "bernd"}, "path": "graylog2-server/src/main/java/org/graylog2/Configuration.java", "diffHunk": "@@ -158,6 +159,11 @@\n     @Parameter(value = \"deactivated_builtin_authentication_providers\", converter = StringSetConverter.class)\n     private Set<String> deactivatedBuiltinAuthenticationProviders = Collections.emptySet();\n \n+    // Defaults to TLS protocols that are currently considered secure\n+    @Parameter(value = \"enabled_tls_protocols\", converter = StringSetConverter.class)\n+    private Set<String> enabledTlsProtocols = ImmutableSet.of(\"TLSv1.2\", \"TLSv1.3\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4a19fee31e64eac4ae086e9bda4b204e0b145d"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "446186978e04848f8e8e61f48d5e87bdb0d80883", "author": {"user": {"login": "mpfz0r", "name": "Marco Pfatschbacher"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/446186978e04848f8e8e61f48d5e87bdb0d80883", "committedDate": "2020-01-10T13:17:47Z", "message": "Add enabled_tls_protocols setting to example graylog.conf"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxOTAyNzg3", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#pullrequestreview-341902787", "createdAt": "2020-01-13T14:57:25Z", "commit": {"oid": "446186978e04848f8e8e61f48d5e87bdb0d80883"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxOTIyMDcw", "url": "https://github.com/Graylog2/graylog2-server/pull/7130#pullrequestreview-341922070", "createdAt": "2020-01-13T15:24:05Z", "commit": {"oid": "446186978e04848f8e8e61f48d5e87bdb0d80883"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2795, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}