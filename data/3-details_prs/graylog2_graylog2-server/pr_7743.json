{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMDg2NjQ4", "number": 7743, "title": "Improve widget legend positioning", "bodyText": "There are a few cases where a chart legend is overlapping the x-axis labels.\nYou can sometimes see this behaviour on the main search page:\n\nI had an extensive look at the available plotly layout settings and could not find a perfectly dynamic solution. In the end I've added a small manual calculation, to create more dynamic layout and reduce the problematic cases to a minimum. This will e.g. fix the problem, visible in the above screenshot.\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-03-24T16:03:46Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7743", "merged": true, "mergeCommit": {"oid": "7b45d838379867fc7c726ef399296d7c7438ddfb"}, "closed": true, "closedAt": "2020-03-27T14:20:35Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQ1LMeAFqTM4MDQ2MjQ0Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRxdl-AFqTM4MjkwMDU0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNDYyNDQz", "url": "https://github.com/Graylog2/graylog2-server/pull/7743#pullrequestreview-380462443", "createdAt": "2020-03-24T16:06:03Z", "commit": {"oid": "06f7bb037faae2b293808f5f106e36e494b6ed37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNjowNjowM1rOF63m8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNjowNjowM1rOF63m8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI3MjgxNw==", "bodyText": "As far as I could see it the automargin attribute is currently only helpful when using the Heatmap. I still prefer adding them to the default layout, because they could be helpful for all charts in theory,", "url": "https://github.com/Graylog2/graylog2-server/pull/7743#discussion_r397272817", "createdAt": "2020-03-24T16:06:03Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/visualizations/GenericPlot.jsx", "diffHunk": "@@ -124,24 +124,28 @@ class GenericPlot extends React.Component<Props, State> {\n       autosize: true,\n       showlegend: true,\n       margin: {\n-        autoexpand: true,\n         t: 10,\n         l: 40,\n         r: 10,\n-        b: 40,\n+        b: 0,\n         pad: 0,\n       },\n       legend: {\n         orientation: 'h',\n-        y: -0.14,\n       },\n       hoverlabel: {\n         namelength: -1,\n       },\n+      yaxis: {\n+        automargin: true,\n+      },\n+      xaxis: {\n+        automargin: true,\n+      },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06f7bb037faae2b293808f5f106e36e494b6ed37"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNDk0MzY2", "url": "https://github.com/Graylog2/graylog2-server/pull/7743#pullrequestreview-380494366", "createdAt": "2020-03-24T16:38:32Z", "commit": {"oid": "06f7bb037faae2b293808f5f106e36e494b6ed37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNjozODozMlrOF65KJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNjozODozMlrOF65KJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5ODIxNA==", "bodyText": "I removed the margin, to provide more space for the chart. The widget padding already displays enough white space.", "url": "https://github.com/Graylog2/graylog2-server/pull/7743#discussion_r397298214", "createdAt": "2020-03-24T16:38:32Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/visualizations/GenericPlot.jsx", "diffHunk": "@@ -124,24 +124,28 @@ class GenericPlot extends React.Component<Props, State> {\n       autosize: true,\n       showlegend: true,\n       margin: {\n-        autoexpand: true,\n         t: 10,\n         l: 40,\n         r: 10,\n-        b: 40,\n+        b: 0,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06f7bb037faae2b293808f5f106e36e494b6ed37"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4dc8060de363c12d31d6ebba4ae62494d42ece4", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/c4dc8060de363c12d31d6ebba4ae62494d42ece4", "committedDate": "2020-03-26T09:44:01Z", "message": "Define more dynamic plot layout settings\n- remove autoexpand because it is true by default\n- remove bottom margin, because a widget already has bottom padding\n- remove legend y position\n- set automargin true for y and xaxis\n- display plot with full height"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9c5237d7f76d5bb17719b1bbaf1594dce30a465", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/d9c5237d7f76d5bb17719b1bbaf1594dce30a465", "committedDate": "2020-03-26T09:44:01Z", "message": "Define XYPlot y legend position based on container height"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce78d359970a9a8cdabcd4bc8c143f30ec06efec", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/ce78d359970a9a8cdabcd4bc8c143f30ec06efec", "committedDate": "2020-03-26T09:44:01Z", "message": "Remove automargin from heatmap axis, because it is part of the generic plot and add custom bottom margin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aea0144d1e49718f89b8cd1920bd3a6a86425d2", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/7aea0144d1e49718f89b8cd1920bd3a6a86425d2", "committedDate": "2020-03-26T09:44:01Z", "message": "Update tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "caad38094a284c641ab7ad78c27a89325085455b", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/caad38094a284c641ab7ad78c27a89325085455b", "committedDate": "2020-03-26T09:44:01Z", "message": "Add tests for XYPlot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "06f7bb037faae2b293808f5f106e36e494b6ed37", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/06f7bb037faae2b293808f5f106e36e494b6ed37", "committedDate": "2020-03-24T15:50:40Z", "message": "Add tests for XYPlot"}, "afterCommit": {"oid": "caad38094a284c641ab7ad78c27a89325085455b", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/caad38094a284c641ab7ad78c27a89325085455b", "committedDate": "2020-03-26T09:44:01Z", "message": "Add tests for XYPlot"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTAwNTQ1", "url": "https://github.com/Graylog2/graylog2-server/pull/7743#pullrequestreview-382900545", "createdAt": "2020-03-27T14:20:28Z", "commit": {"oid": "caad38094a284c641ab7ad78c27a89325085455b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2473, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}