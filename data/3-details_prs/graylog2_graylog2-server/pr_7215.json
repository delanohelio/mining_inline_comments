{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MDUzMjY0", "number": 7215, "title": "Improve form validation for dashboard full screen config modal", "bodyText": "This PR fixes the behaviour described in #7211 (allowing negative numbers for refresh and cycle interval) regarding the full screen dashboard config modal, mainly by adding a HTML form element.\nI had to adjust the form submit inside the related tests, because submitting the form by triggering a click on the save button results in the following error:\nNot implemented: HTMLFormElement.prototype.submit.\nFixes #7211\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-01-17T09:42:30Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7215", "merged": true, "mergeCommit": {"oid": "4aedec9101081cd4ff1ef2c8544dec7a370e83e4"}, "closed": true, "closedAt": "2020-01-22T10:20:21Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8Jk4ggFqTM0NTE5MzIzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8zEGGgFqTM0NjQ3ODEyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTkzMjM2", "url": "https://github.com/Graylog2/graylog2-server/pull/7215#pullrequestreview-345193236", "createdAt": "2020-01-20T09:59:00Z", "commit": {"oid": "60f939ea960d60d3864e23397a9f57f3a33c6457"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwOTo1OTowMFrOFfY60g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwOTo1OTowMFrOFfY60g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ1ODQ1MA==", "bodyText": "When the value falsy is you set the refreshInterval to that? Why not to 0 or a other default value?", "url": "https://github.com/Graylog2/graylog2-server/pull/7215#discussion_r368458450", "createdAt": "2020-01-20T09:59:00Z", "author": {"login": "kmerz"}, "path": "graylog2-web-interface/src/views/components/dashboard/BigDisplayModeConfiguration.jsx", "diffHunk": "@@ -47,50 +47,56 @@ const ConfigurationModal = ({ onSave, onCancel, view }: ConfigurationModalProps)\n \n   return (\n     <Modal show bsSize=\"large\" onHide={onCancel}>\n-      <Modal.Header closeButton>\n-        <Modal.Title>Configuring Full Screen</Modal.Title>\n-      </Modal.Header>\n-      <Modal.Body>\n-        <Input id=\"refresh-interval\"\n-               type=\"number\"\n-               name=\"refresh-interval\"\n-               label=\"Refresh Interval\"\n-               help=\"After how many seconds should the dashboard refresh?\"\n-               onChange={({ target: { value } }) => setRefreshInterval(Number.parseInt(value, 10))}\n-               required\n-               value={refreshInterval} />\n-\n-        <FormGroup>\n-          <ControlLabel>Tabs</ControlLabel>\n-          <ul>\n-            {availableTabs.map(([idx, title]) => (\n-              <li key={`${idx}-${title}`}>\n-                <Checkbox inline\n-                          checked={queryTabs.includes(idx)}\n-                          onChange={event => (event.target.checked ? addQueryTab(idx) : removeQueryTab(idx))}>\n-                  {title}\n-                </Checkbox>\n-              </li>\n-            ))}\n-          </ul>\n-          <HelpBlock>\n+      <form onSubmit={_onSave} data-testid=\"display-mode-config-form\">\n+        <Modal.Header closeButton>\n+          <Modal.Title>Configuring Full Screen</Modal.Title>\n+        </Modal.Header>\n+        <Modal.Body>\n+          <Input id=\"refresh-interval\"\n+                 type=\"number\"\n+                 min=\"1\"\n+                 name=\"refresh-interval\"\n+                 label=\"Refresh Interval\"\n+                 help=\"After how many seconds should the dashboard refresh?\"\n+                 onChange={({ target: { value } }) => setRefreshInterval(value ? Number.parseInt(value, 10) : value)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60f939ea960d60d3864e23397a9f57f3a33c6457"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a780bb9c28d06311e170908ea8555724d33d6441", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/a780bb9c28d06311e170908ea8555724d33d6441", "committedDate": "2020-01-20T11:02:52Z", "message": "Improve form validation for dashboard full screen config modal\n\n* Enable HTML form validation by wrapping inputs in HTML form\n* Only allow refresh and cycle interval greater than one\n* Convert cycle interval to a number before updating the component state\n* Prevent NaN error for empty number inputs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "794ea8b717c73fe2e7daf77e45acb54258ecde3c", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/794ea8b717c73fe2e7daf77e45acb54258ecde3c", "committedDate": "2020-01-20T11:02:52Z", "message": "Fixing form submit for BigDisplayModeConfiguration tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60f939ea960d60d3864e23397a9f57f3a33c6457", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/60f939ea960d60d3864e23397a9f57f3a33c6457", "committedDate": "2020-01-17T09:37:14Z", "message": "Fixing form submit for BigDisplayModeConfiguration tests"}, "afterCommit": {"oid": "794ea8b717c73fe2e7daf77e45acb54258ecde3c", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/794ea8b717c73fe2e7daf77e45acb54258ecde3c", "committedDate": "2020-01-20T11:02:52Z", "message": "Fixing form submit for BigDisplayModeConfiguration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18bff3e512d553225ee2240642dbf7b84cdc8d06", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/18bff3e512d553225ee2240642dbf7b84cdc8d06", "committedDate": "2020-01-20T11:44:15Z", "message": "Add tests for dashboard display mode refresh and cycle interval values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NDc4MTI5", "url": "https://github.com/Graylog2/graylog2-server/pull/7215#pullrequestreview-346478129", "createdAt": "2020-01-22T10:20:01Z", "commit": {"oid": "18bff3e512d553225ee2240642dbf7b84cdc8d06"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2697, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}