{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MDQ4NjY1", "number": 8125, "title": "Render event annotations with timezone setting of the user", "bodyText": "Motivation\nPrior to this change, the events were not annotated in the histogram\nif the user had a different timezone than UTC. Because the anotations\nwould be set with UTC and not the user set timezone.\nDescription\nThis change will convert the chartdata timestamps to the users setting.\nHow Has This Been Tested?\n\nChanged timezone of the user to CET\nCaused some alerts and saw them rendered correctly with adjusted timezone.\n\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-05-14T14:50:54Z", "url": "https://github.com/Graylog2/graylog2-server/pull/8125", "merged": true, "mergeCommit": {"oid": "ba9e876044c436747515c0c848a8d5933452a8aa"}, "closed": true, "closedAt": "2020-05-15T08:22:56Z", "author": {"login": "kmerz"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchOlYWgH2gAyNDE4MDQ4NjY1OjQ1NmZiYmZkYzMxOTY2NGFlMmEzYjZjMTk1ODVmMGQ3NGQxMjA0OGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchdHljgFqTQxMjQxNjY5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "456fbbfdc319664ae2a3b6c19585f0d74d12048c", "author": {"user": {"login": "kmerz", "name": "Konrad Merz"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/456fbbfdc319664ae2a3b6c19585f0d74d12048c", "committedDate": "2020-05-14T14:45:05Z", "message": "Render event annotations with timezone setting of the user\n\nPrior to this change, the events were not annotated in the histogram\nif the user had a different timezone than UTC. Because the anotations\nwould be set with UTC and not the user set timezone.\n\nThis change will convert the chartdata timestamps to the users setting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNDA2NjQ2", "url": "https://github.com/Graylog2/graylog2-server/pull/8125#pullrequestreview-412406646", "createdAt": "2020-05-15T07:24:53Z", "commit": {"oid": "456fbbfdc319664ae2a3b6c19585f0d74d12048c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNzoyNDo1M1rOGV5d1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNzoyNDo1M1rOGV5d1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTYxNDgwNA==", "bodyText": "You can use tz ?? 'UTC' here.\nJust to let you know, I started replacing 'UTC' in another PR (#7836) with AppConfig.rootTimeZone();. I thought about replacing it here as well, but we did not merged the mentioned PR and use UTC in comparable cases.", "url": "https://github.com/Graylog2/graylog2-server/pull/8125#discussion_r425614804", "createdAt": "2020-05-15T07:24:53Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/logic/searchtypes/events/EventHandler.js", "diffHunk": "@@ -31,17 +35,25 @@ export type Shapes = Array<Shape>;\n const eventsDisplayName = 'Alerts';\n const defaultColor = '#d3d3d3';\n \n+const formatTimestamp = (timestamp, tz = 'UTC'): string => {\n+  // the `true` parameter prevents returning the iso string in UTC (http://momentjs.com/docs/#/displaying/as-iso-string/)\n+  return moment(timestamp).tz(tz || 'UTC').toISOString(true);\n+};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456fbbfdc319664ae2a3b6c19585f0d74d12048c"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd5ca60fec6b595bfeec2096b7d4a58c0aedaa1a", "author": {"user": {"login": "kmerz", "name": "Konrad Merz"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/dd5ca60fec6b595bfeec2096b7d4a58c0aedaa1a", "committedDate": "2020-05-15T07:32:54Z", "message": "Use Nullish coalescing operator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNDE2Njkw", "url": "https://github.com/Graylog2/graylog2-server/pull/8125#pullrequestreview-412416690", "createdAt": "2020-05-15T07:41:07Z", "commit": {"oid": "dd5ca60fec6b595bfeec2096b7d4a58c0aedaa1a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3223, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}