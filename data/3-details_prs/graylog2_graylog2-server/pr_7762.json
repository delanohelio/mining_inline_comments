{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MTIzMzc5", "number": 7762, "title": "Use spread object creation to copy configurations before update", "bodyText": "create setConfigurationState and use cloneDeep to update\nUpdate methods to use setConfigurationState before propagateChanges\n\n\nDescription\n\nBefore this change saving a configuration update on configuration page wasn't updating the overview on the same page because the different configuration were held in the same object inside the configurationStore. Resulting in the the connect function did not see change when a key of that object were updated.\nWith these change we make sure to create a new object cloned from the current configuration and and set it back as configuration object after updating.\nfixes #7760\nMotivation and Context\n\n\nHow Has This Been Tested?\n\n\n\nScreenshots (if appropriate):\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-03-26T11:53:36Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7762", "merged": true, "mergeCommit": {"oid": "8e6eb4c7360e128ed22a634ead4336515d9abf1d"}, "closed": true, "closedAt": "2020-03-27T13:29:59Z", "author": {"login": "ousmaneo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRao8hgH2gAyMzk0MTIzMzc5OmI0MDBlZjUwY2MyYjAyNDE3YmQzNDIyNzg0ZWY3YTRiMWIyYjc1NGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRwvTFAFqTM4Mjg1NjMyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b400ef50cc2b02417bd3422784ef7a4b1b2b754f", "author": {"user": {"login": "ousmaneo", "name": "Ousmane SAMBA"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/b400ef50cc2b02417bd3422784ef7a4b1b2b754f", "committedDate": "2020-03-26T11:45:03Z", "message": "Use cloneDeep to copy configurations befor update\n\n- create setConfigurationState and use cloneDeep to update\n- Update methods to use setConfigurationState before propagateChanges"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxOTY4NTk1", "url": "https://github.com/Graylog2/graylog2-server/pull/7762#pullrequestreview-381968595", "createdAt": "2020-03-26T12:41:34Z", "commit": {"oid": "b400ef50cc2b02417bd3422784ef7a4b1b2b754f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxMjo0MTozNFrOF8E-cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxMjo0MTozNFrOF8E-cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODU0MDQwMw==", "bodyText": "I think we do not deep copying here. What we could do is creating a new object for configuration instead of mutating the existing one:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  this.setConfigurationState(configType, response);\n          \n          \n            \n                  this.configuration = { ...this.configuration, [configType]: response };", "url": "https://github.com/Graylog2/graylog2-server/pull/7762#discussion_r398540403", "createdAt": "2020-03-26T12:41:34Z", "author": {"login": "dennisoelkers"}, "path": "graylog2-web-interface/src/stores/configurations/ConfigurationsStore.js", "diffHunk": "@@ -49,7 +56,7 @@ const ConfigurationsStore = Reflux.createStore({\n   list(configType) {\n     const promise = fetch('GET', this._url(`/${configType}`));\n     promise.then((response) => {\n-      this.configuration[configType] = response;\n+      this.setConfigurationState(configType, response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b400ef50cc2b02417bd3422784ef7a4b1b2b754f"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d9f50ad0c9ba541018072926b4910fa29b25601", "author": {"user": {"login": "ousmaneo", "name": "Ousmane SAMBA"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/1d9f50ad0c9ba541018072926b4910fa29b25601", "committedDate": "2020-03-26T14:23:08Z", "message": "Use spread object creation instead of cloneDeep"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ed0ed429865a46061bdbb6216d50f73b6484387", "author": {"user": {"login": "ousmaneo", "name": "Ousmane SAMBA"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/0ed0ed429865a46061bdbb6216d50f73b6484387", "committedDate": "2020-03-26T14:28:19Z", "message": "Remove unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyODU2MzI0", "url": "https://github.com/Graylog2/graylog2-server/pull/7762#pullrequestreview-382856324", "createdAt": "2020-03-27T13:29:54Z", "commit": {"oid": "0ed0ed429865a46061bdbb6216d50f73b6484387"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2477, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}