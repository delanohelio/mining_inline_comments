{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxMTE3NDc1", "number": 8926, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzowMVrOEg1l0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0ODoxNVrOEg2FtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyODY3OTIxOnYy", "diffSide": "RIGHT", "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzowMVrOHN1r3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzowMVrOHN1r3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI3MzExNg==", "bodyText": "I think we don't need to log this to info. If we do this in every place we use the flag, we will have a lot of messages at some point. \ud83d\ude09", "url": "https://github.com/Graylog2/graylog2-server/pull/8926#discussion_r484273116", "createdAt": "2020-09-07T08:27:01Z", "author": {"login": "bernd"}, "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "diffHunk": "@@ -35,18 +36,25 @@\n     private NotificationService notificationService;\n     private final InputRegistry inputRegistry;\n     private final NodeId nodeId;\n+    private boolean isCloud;\n \n     @Inject\n     public ClusterHealthCheckThread(NotificationService notificationService,\n                                     InputRegistry inputRegistry,\n-                                    NodeId nodeId) {\n+                                    NodeId nodeId,\n+                                    @Named(\"is_cloud\") boolean isCloud) {\n         this.notificationService = notificationService;\n         this.inputRegistry = inputRegistry;\n         this.nodeId = nodeId;\n+        this.isCloud = isCloud;\n     }\n \n     @Override\n     public void doRun() {\n+        if (isCloud) {\n+            LOG.info(\"Skipping run of ClusterHealthCheckThread, since contained checks are not applicable for Cloud.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3beb73c633745e68e9afd0e1705afa6b1dbd2"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyODY4MDAzOnYy", "diffSide": "RIGHT", "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODoyNzoxNFrOHN1sWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0Mzo0NVrOHN2Sjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI3MzI0MA==", "bodyText": "Why did you reduce this to 1?", "url": "https://github.com/Graylog2/graylog2-server/pull/8926#discussion_r484273240", "createdAt": "2020-09-07T08:27:14Z", "author": {"login": "bernd"}, "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "diffHunk": "@@ -103,7 +111,7 @@ public boolean startOnThisNode() {\n     public int getInitialDelaySeconds() {\n         // Wait some time until all inputs have been started otherwise this will trigger a notification on every\n         // startup of the server.\n-        return 120;\n+        return 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3beb73c633745e68e9afd0e1705afa6b1dbd2"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI4MzAyMg==", "bodyText": "Ack, accidental commit. Thanks for seeing this.", "url": "https://github.com/Graylog2/graylog2-server/pull/8926#discussion_r484283022", "createdAt": "2020-09-07T08:43:45Z", "author": {"login": "danotorrey"}, "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "diffHunk": "@@ -103,7 +111,7 @@ public boolean startOnThisNode() {\n     public int getInitialDelaySeconds() {\n         // Wait some time until all inputs have been started otherwise this will trigger a notification on every\n         // startup of the server.\n-        return 120;\n+        return 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI3MzI0MA=="}, "originalCommit": {"oid": "87e3beb73c633745e68e9afd0e1705afa6b1dbd2"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyODc2MDg0OnYy", "diffSide": "RIGHT", "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0ODoxNVrOHN2c0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwOToyNDozMlrOHN3yrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI4NTY1MA==", "bodyText": "I meant moving the log statement to debug. Now there is no explanation why we do this. \ud83d\ude09", "url": "https://github.com/Graylog2/graylog2-server/pull/8926#discussion_r484285650", "createdAt": "2020-09-07T08:48:15Z", "author": {"login": "bernd"}, "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "diffHunk": "@@ -35,18 +36,24 @@\n     private NotificationService notificationService;\n     private final InputRegistry inputRegistry;\n     private final NodeId nodeId;\n+    private boolean isCloud;\n \n     @Inject\n     public ClusterHealthCheckThread(NotificationService notificationService,\n                                     InputRegistry inputRegistry,\n-                                    NodeId nodeId) {\n+                                    NodeId nodeId,\n+                                    @Named(\"is_cloud\") boolean isCloud) {\n         this.notificationService = notificationService;\n         this.inputRegistry = inputRegistry;\n         this.nodeId = nodeId;\n+        this.isCloud = isCloud;\n     }\n \n     @Override\n     public void doRun() {\n+        if (isCloud) {\n+            return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "640ce1146870eb90b6c6c1e8ed5413dcedeea1a2"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMwNzYzMQ==", "bodyText": "Thanks. This was the original intention, but somehow I left it at info. Makes sense, I see that now.", "url": "https://github.com/Graylog2/graylog2-server/pull/8926#discussion_r484307631", "createdAt": "2020-09-07T09:24:32Z", "author": {"login": "danotorrey"}, "path": "graylog2-server/src/main/java/org/graylog2/periodical/ClusterHealthCheckThread.java", "diffHunk": "@@ -35,18 +36,24 @@\n     private NotificationService notificationService;\n     private final InputRegistry inputRegistry;\n     private final NodeId nodeId;\n+    private boolean isCloud;\n \n     @Inject\n     public ClusterHealthCheckThread(NotificationService notificationService,\n                                     InputRegistry inputRegistry,\n-                                    NodeId nodeId) {\n+                                    NodeId nodeId,\n+                                    @Named(\"is_cloud\") boolean isCloud) {\n         this.notificationService = notificationService;\n         this.inputRegistry = inputRegistry;\n         this.nodeId = nodeId;\n+        this.isCloud = isCloud;\n     }\n \n     @Override\n     public void doRun() {\n+        if (isCloud) {\n+            return;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI4NTY1MA=="}, "originalCommit": {"oid": "640ce1146870eb90b6c6c1e8ed5413dcedeea1a2"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4063, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}