{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5NTAzNDY5", "number": 7336, "title": "Handling `null` attributes when migrating quickvalues widgets.", "bodyText": "Description\n\nMotivation and Context\n\n\nUnder some circumstances, the show_data_table & show_pie_chart\nattributes of legacy quick values widgets can be null, leading to NPEs\nwhen migrating or installing legacy dashboards.\nThis PR is now handling the absence of these attributes. If they are\nmissing, they are handled the following way:\n\nshow_data_table is true if show_pie_chart is missing or\nfalse and false otherwise, ensuring that at least one of both is created\nshow_pie_charts is false if missing\n\nThis logic is identical to the rendering logic of the legacy dashboard\ncode.\nFixes #7334.\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-01-31T10:05:19Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7336", "merged": true, "mergeCommit": {"oid": "07b0a3ace56bd01c00cbd443f847dbde6bc7213f"}, "closed": true, "closedAt": "2020-01-31T11:52:29Z", "author": {"login": "dennisoelkers"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_saJ-gH2gAyMzY5NTAzNDY5OjM2OTlmOTEyNzhjYjYyNDI3NmM5MzUxNzkxOTE2NzIxZjJhNTc1OWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_tx1TgFqTM1MTQ1NjQ5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3699f91278cb624276c9351791916721f2a5759d", "author": {"user": {"login": "dennisoelkers", "name": "Dennis Oelkers"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/3699f91278cb624276c9351791916721f2a5759d", "committedDate": "2020-01-31T10:16:33Z", "message": "Handle `null` values for `show_data_table`/`show_pie_chart` when migrating quick values."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68624d43df127a4793c0f0ddc991bb0769c0e011", "author": {"user": {"login": "dennisoelkers", "name": "Dennis Oelkers"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/68624d43df127a4793c0f0ddc991bb0769c0e011", "committedDate": "2020-01-31T10:16:34Z", "message": "Handling missing values for `show_data_table`/`show_pie_chart` when installing legacy dashboard."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "732382bd22027d7b2b7d8612b74221ea67640272", "author": {"user": {"login": "dennisoelkers", "name": "Dennis Oelkers"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/732382bd22027d7b2b7d8612b74221ea67640272", "committedDate": "2020-01-31T10:02:15Z", "message": "Handling missing values for `show_data_table`/`show_pie_chart` when installing legacy dashboard."}, "afterCommit": {"oid": "68624d43df127a4793c0f0ddc991bb0769c0e011", "author": {"user": {"login": "dennisoelkers", "name": "Dennis Oelkers"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/68624d43df127a4793c0f0ddc991bb0769c0e011", "committedDate": "2020-01-31T10:16:34Z", "message": "Handling missing values for `show_data_table`/`show_pie_chart` when installing legacy dashboard."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDEyNTg5", "url": "https://github.com/Graylog2/graylog2-server/pull/7336#pullrequestreview-351412589", "createdAt": "2020-01-31T10:24:22Z", "commit": {"oid": "68624d43df127a4793c0f0ddc991bb0769c0e011"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDI3MzEz", "url": "https://github.com/Graylog2/graylog2-server/pull/7336#pullrequestreview-351427313", "createdAt": "2020-01-31T10:51:40Z", "commit": {"oid": "68624d43df127a4793c0f0ddc991bb0769c0e011"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMDo1MTo0MFrOFkH0ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMDo1MTo0MFrOFkH0ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQyMTE1Ng==", "bodyText": "I think a few simple unit tests would be in order here to test all possible combinations.", "url": "https://github.com/Graylog2/graylog2-server/pull/7336#discussion_r373421156", "createdAt": "2020-01-31T10:51:40Z", "author": {"login": "alex-konn"}, "path": "graylog2-server/src/main/java/org/graylog/plugins/views/migrations/V20191125144500_MigrateDashboardsToViewsSupport/dashboardwidgets/QuickValuesConfig.java", "diffHunk": "@@ -186,8 +188,10 @@ static QuickValuesConfig create(\n                 query,\n                 Optional.ofNullable(streamId),\n                 field,\n-                showDataTable,\n-                showPieChart,\n+                (showDataTable == null || !showDataTable) && (showPieChart == null || !showPieChart)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68624d43df127a4793c0f0ddc991bb0769c0e011"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54657bb21af95fa42b2d92d63e872cdef0fbcf26", "author": {"user": {"login": "dennisoelkers", "name": "Dennis Oelkers"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/54657bb21af95fa42b2d92d63e872cdef0fbcf26", "committedDate": "2020-01-31T11:29:23Z", "message": "Adding more test cases."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDU2NDky", "url": "https://github.com/Graylog2/graylog2-server/pull/7336#pullrequestreview-351456492", "createdAt": "2020-01-31T11:52:19Z", "commit": {"oid": "54657bb21af95fa42b2d92d63e872cdef0fbcf26"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2746, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}