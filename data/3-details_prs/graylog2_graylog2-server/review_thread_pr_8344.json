{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NTMxODI5", "number": 8344, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo0OTo1OFrOEGQdXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo1NToyOVrOEGQm8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTk2NTc1OnYy", "diffSide": "RIGHT", "path": "graylog2-web-interface/src/views/components/sidebar/fields/FieldsOverview.jsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo0OTo1OFrOGk8F7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo0OTo1OFrOGk8F7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM4NjQ3OQ==", "bodyText": "Using a reducer here overcomplicates things, as the field category and the filter are not related. They could be handled by using two separate, independent states.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441386479", "createdAt": "2020-06-17T08:49:58Z", "author": {"login": "dennisoelkers"}, "path": "graylog2-web-interface/src/views/components/sidebar/fields/FieldsOverview.jsx", "diffHunk": "@@ -0,0 +1,125 @@\n+// @flow strict\n+import * as React from 'react';\n+import { useReducer } from 'react';\n+import PropTypes from 'prop-types';\n+import { List as ImmutableList } from 'immutable';\n+import styled, { type StyledComponent } from 'styled-components';\n+\n+import type { ViewMetaData as ViewMetadata } from 'views/stores/ViewMetadataStore';\n+import FieldTypeMapping from 'views/logic/fieldtypes/FieldTypeMapping';\n+import { type ThemeInterface } from 'theme';\n+\n+import { Button } from 'components/graylog';\n+import List from './List';\n+import ChangeMode from './ChangeMode';\n+\n+type Props = {\n+  viewMetadata: ViewMetadata,\n+  listHeight: number,\n+  fields: ImmutableList<FieldTypeMapping>,\n+  allFields: ImmutableList<FieldTypeMapping>,\n+};\n+\n+const Container: StyledComponent<{}, ThemeInterface, HTMLDivElement> = styled.div`\n+  white-space: break-spaces;\n+`;\n+\n+const FilterForm = styled.form`\n+  display: flex;\n+`;\n+\n+const FilterInputWrapper = styled.div`\n+  flex-grow: 1;\n+  margin-right: 5px;\n+`;\n+\n+const FilterInput = styled.input`\n+  width: 100%;\n+`;\n+\n+const FieldListModes = styled.div`\n+  margin-top: 5px;\n+  margin-bottom: 0;\n+`;\n+\n+const reducer = (state, action: {type: string, payload?: { mode?: string, filter?: string }}): { filter: ?string, currentMode: string } => {\n+  const { payload = {} } = action;\n+  const { mode, filter } = payload;\n+  switch (action.type) {\n+    case 'search':\n+      return { ...state, filter: filter };\n+    case 'searchReset':\n+      return { ...state, filter: undefined };\n+    case 'changeMode':\n+      return mode ? { ...state, currentMode: mode } : state;\n+    default:\n+      return state;\n+  }\n+};\n+\n+const FieldsOverview = ({ allFields, fields, viewMetadata, listHeight }: Props) => {\n+  const [{ filter, currentMode }, dispatch] = useReducer(reducer, { filter: undefined, currentMode: 'current' });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTk3OTAzOnYy", "diffSide": "RIGHT", "path": "graylog2-web-interface/src/views/components/sidebar/fields/ChangeMode.jsx", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo1MzowMVrOGk8OMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMjo0MzoyMVrOGltiuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM4ODU5NA==", "bodyText": "ChangeMode is not an ideal name, it is not really giving away what it is doing. Maybe something like FieldGroup?\nI think we can also align props naming with React standards. Instead of changeMode using onSelect or onClick would give away what it's doing, instead of currentMode, we can use a boolean selected prop, allowing the user of the component to determine if it should be shown as selected or not.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441388594", "createdAt": "2020-06-17T08:53:01Z", "author": {"login": "dennisoelkers"}, "path": "graylog2-web-interface/src/views/components/sidebar/fields/ChangeMode.jsx", "diffHunk": "@@ -0,0 +1,26 @@\n+// @flow strict\n+import * as React from 'react';\n+\n+type Props = {\n+  changeMode: (newMode: string) => void,\n+  currentMode: string,\n+  mode: string,\n+  text: string,\n+  title: string,\n+};\n+\n+const ChangeMode = ({ changeMode, currentMode, mode, text, title }: Props) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU5Njc2NA==", "bodyText": "Alright, I only see one disadvantage with the select prop, we need to define the group (previously mode) twice for each FieldGroup. For the group and the select prop.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441596764", "createdAt": "2020-06-17T14:38:47Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/fields/ChangeMode.jsx", "diffHunk": "@@ -0,0 +1,26 @@\n+// @flow strict\n+import * as React from 'react';\n+\n+type Props = {\n+  changeMode: (newMode: string) => void,\n+  currentMode: string,\n+  mode: string,\n+  text: string,\n+  title: string,\n+};\n+\n+const ChangeMode = ({ changeMode, currentMode, mode, text, title }: Props) => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM4ODU5NA=="}, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE5NjY2NQ==", "bodyText": "Agreed, it's not ideal.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r442196665", "createdAt": "2020-06-18T12:43:21Z", "author": {"login": "dennisoelkers"}, "path": "graylog2-web-interface/src/views/components/sidebar/fields/ChangeMode.jsx", "diffHunk": "@@ -0,0 +1,26 @@\n+// @flow strict\n+import * as React from 'react';\n+\n+type Props = {\n+  changeMode: (newMode: string) => void,\n+  currentMode: string,\n+  mode: string,\n+  text: string,\n+  title: string,\n+};\n+\n+const ChangeMode = ({ changeMode, currentMode, mode, text, title }: Props) => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM4ODU5NA=="}, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTk5MDI1OnYy", "diffSide": "LEFT", "path": "graylog2-web-interface/src/views/components/sidebar/FieldList.jsx", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODo1NToyOVrOGk8U-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNToxNzo0N1rOGlKzKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MDMzMQ==", "bodyText": "It might make sense to move a file instead of deleting it (especially in this case, where we are still keeping lots from the component, just under a new name), so we retain its history.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441390331", "createdAt": "2020-06-17T08:55:29Z", "author": {"login": "dennisoelkers"}, "path": "graylog2-web-interface/src/views/components/sidebar/FieldList.jsx", "diffHunk": "@@ -1,184 +0,0 @@\n-import React from 'react';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU5MzQwMw==", "bodyText": "That is a good point I did not thought about. I named the component FieldsOverview because I wanted to avoid confusion with the List component in the same directory.", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441593403", "createdAt": "2020-06-17T14:34:19Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/FieldList.jsx", "diffHunk": "@@ -1,184 +0,0 @@\n-import React from 'react';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MDMzMQ=="}, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYyMDA1OA==", "bodyText": "It looks like I have to create a new PR to tell git I moved the file and changed the name. At least this seems to be the easiest way", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441620058", "createdAt": "2020-06-17T15:08:21Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/FieldList.jsx", "diffHunk": "@@ -1,184 +0,0 @@\n-import React from 'react';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MDMzMQ=="}, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYyNzQzMg==", "bodyText": "I created a new branch and used git mv to move the and rename the file. This seems to work when looking at the commit: a74d2e4\nBut not when looking at the PR..\nhttps://github.com/Graylog2/graylog2-server/compare/refactor-field-list-v2?expand=1", "url": "https://github.com/Graylog2/graylog2-server/pull/8344#discussion_r441627432", "createdAt": "2020-06-17T15:17:47Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/FieldList.jsx", "diffHunk": "@@ -1,184 +0,0 @@\n-import React from 'react';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM5MDMzMQ=="}, "originalCommit": {"oid": "c9d9872227da064f68c0bc33feabb34fd3446091"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4186, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}