{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MjMyNTU5", "number": 7252, "title": "Update current view title, summary and description on view edit", "bodyText": "As described in #7244 editing a dashboards title, description and summary updated the database entry, but not the frontend view state. This PR implements a new ViewAction named updated. It gets called in OnSaveViewAction, before calling the api to update the database entry. It also removes some not needed ViewActions\nI had a look at other cases where we are using ViewManagementActions.update, to check if implementing the new ViewActions.update method would make sense, but could not find one.\nFixes #7244\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-01-23T08:02:51Z", "url": "https://github.com/Graylog2/graylog2-server/pull/7252", "merged": true, "mergeCommit": {"oid": "df583e62902b2d68defa3b9709acd122a941c4c2"}, "closed": true, "closedAt": "2020-01-23T15:37:34Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9HPQ3gBqjI5NzMwNzg1NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9MNEtgFqTM0NzM5NDMzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e236f889c60b8194a087f7d2bc741c18ffd0c458", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/e236f889c60b8194a087f7d2bc741c18ffd0c458", "committedDate": "2020-01-23T08:01:35Z", "message": "Update current view title, summary and description on view edit"}, "afterCommit": {"oid": "eda2e2c10d0a1c404fb6d0890f92c55be2ed78af", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/eda2e2c10d0a1c404fb6d0890f92c55be2ed78af", "committedDate": "2020-01-23T09:49:10Z", "message": "Update current view title, summary and description on view edit\n\n- implement new ViewActions update method\n- remove not needed title, description and summary ViewActions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "920eb9d55c394cb0ffc491e76ecb9b6f8c7ddd00", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/920eb9d55c394cb0ffc491e76ecb9b6f8c7ddd00", "committedDate": "2020-01-23T09:52:48Z", "message": "Update current view title, summary and description on view edit\n\n- implement new ViewActions update method\n- remove not needed title, description and summary ViewActions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6927ab16175416638a5ea1475a031cfdd037c5ae", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/6927ab16175416638a5ea1475a031cfdd037c5ae", "committedDate": "2020-01-23T10:09:36Z", "message": "Fix OnSaveView test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eda2e2c10d0a1c404fb6d0890f92c55be2ed78af", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/eda2e2c10d0a1c404fb6d0890f92c55be2ed78af", "committedDate": "2020-01-23T09:49:10Z", "message": "Update current view title, summary and description on view edit\n\n- implement new ViewActions update method\n- remove not needed title, description and summary ViewActions"}, "afterCommit": {"oid": "6927ab16175416638a5ea1475a031cfdd037c5ae", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/6927ab16175416638a5ea1475a031cfdd037c5ae", "committedDate": "2020-01-23T10:09:36Z", "message": "Fix OnSaveView test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78e577385396d37297e96763cfc8ad3f6aa8de10", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/78e577385396d37297e96763cfc8ad3f6aa8de10", "committedDate": "2020-01-23T10:16:34Z", "message": "Remove empty line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MTg5MDI1", "url": "https://github.com/Graylog2/graylog2-server/pull/7252#pullrequestreview-347189025", "createdAt": "2020-01-23T10:20:31Z", "commit": {"oid": "78e577385396d37297e96763cfc8ad3f6aa8de10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMDoyMDozMVrOFg5KQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMDoyMDozMVrOFg5KQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAzNTI2NQ==", "bodyText": "Do you prefer using the view title, returned from the database, or the initial view title we passed to the onSaveViewAction?", "url": "https://github.com/Graylog2/graylog2-server/pull/7252#discussion_r370035265", "createdAt": "2020-01-23T10:20:31Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/logic/views/OnSaveViewAction.js", "diffHunk": "@@ -1,8 +1,11 @@\n import UserNotification from 'util/UserNotification';\n import { ViewManagementActions } from 'views/stores/ViewManagementStore';\n+import { ViewActions } from 'views/stores/ViewStore';\n \n-export default (view) => {\n-  return ViewManagementActions.update(view)\n-    .then(() => UserNotification.success(`Saving view \"${view.title}\" was successful!`, 'Success!'))\n-    .catch(error => UserNotification.error(`Saving view failed: ${error}`, 'Error!'));\n+export default (newView) => {\n+  return ViewActions.update(newView).then(({ view }) => {\n+    return ViewManagementActions.update(view);\n+  }).then(({ title }) => {\n+    return UserNotification.success(`Saving view \"${title}\" was successful!`, 'Success!');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e577385396d37297e96763cfc8ad3f6aa8de10"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "863d3e64872f1ddb349432f0103089cc04f243a1", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/863d3e64872f1ddb349432f0103089cc04f243a1", "committedDate": "2020-01-23T10:21:05Z", "message": "Remove empty line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MTkwOTQz", "url": "https://github.com/Graylog2/graylog2-server/pull/7252#pullrequestreview-347190943", "createdAt": "2020-01-23T10:23:33Z", "commit": {"oid": "78e577385396d37297e96763cfc8ad3f6aa8de10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMDoyMzozM1rOFg5Psw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMDoyMzozM1rOFg5Psw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAzNjY1OQ==", "bodyText": "I am not sure if this action should return the ViewStoreState or just the View. ViewManagementActions.update returns only the view, but I decided to return the ViewStoreState, to unify the type of the return value with `ViewActions.create``", "url": "https://github.com/Graylog2/graylog2-server/pull/7252#discussion_r370036659", "createdAt": "2020-01-23T10:23:33Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/stores/ViewStore.js", "diffHunk": "@@ -27,30 +27,26 @@ export type ViewStoreState = {\n \n type ViewActionsType = RefluxActions<{\n   create: (ViewType, ?string) => Promise<ViewStoreState>,\n-  description: (string) => Promise<ViewStoreState>,\n   load: (View, ?boolean) => Promise<ViewStoreState>,\n   properties: (Properties) => Promise<void>,\n   search: (Search) => Promise<View>,\n   selectQuery: (string) => Promise<string>,\n   state: (ViewState) => Promise<View>,\n-  summary: (string) => Promise<void>,\n-  title: (string) => Promise<void>,\n+  update: (View) => Promise<ViewStoreState>,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e577385396d37297e96763cfc8ad3f6aa8de10"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Mzk0MzM4", "url": "https://github.com/Graylog2/graylog2-server/pull/7252#pullrequestreview-347394338", "createdAt": "2020-01-23T15:37:27Z", "commit": {"oid": "863d3e64872f1ddb349432f0103089cc04f243a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2715, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}