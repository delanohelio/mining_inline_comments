{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExNjcxODU1", "number": 8018, "title": "Fix sidebar highlighting rules layout for field values with a long name", "bodyText": "As described in #7738 the highlighting rules styling breaks if the related field value has a long name.\nThis PR fixes the problem by using a grid for each highlighting rule.\n\nThe PR also implements styled components instead of css modules, adjusts the related test.\nFixes #7738\nDescription\n\nMotivation and Context\n\n\nHow Has This Been Tested?\nThe changes have been tested with the latest browsers and IE11.\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Refactoring (non-breaking change)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have read the CONTRIBUTING document.\n I have added tests to cover my changes.", "createdAt": "2020-04-30T16:01:17Z", "url": "https://github.com/Graylog2/graylog2-server/pull/8018", "merged": true, "mergeCommit": {"oid": "cc6e825928e7761fb091822835efdf1a77ba4d37"}, "closed": true, "closedAt": "2020-05-04T11:11:11Z", "author": {"login": "linuspahl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccvA5ogH2gAyNDExNjcxODU1Ojg2MDBkNGVlZDcwODAyMzMzYjFmMjk1ZmFiODE5NzRjMGQ4MzA1ZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcd9h2UAFqTQwNDg5MzE0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8600d4eed70802333b1f295fab81974c0d8305d6", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/8600d4eed70802333b1f295fab81974c0d8305d6", "committedDate": "2020-04-30T15:42:29Z", "message": "Implement grid for highlighting rule list item"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6736097c291cc72baac5c6481d4200d234ef06b9", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/6736097c291cc72baac5c6481d4200d234ef06b9", "committedDate": "2020-04-30T15:44:50Z", "message": "Implement styled components for sidebar highlighting rules\n* Fix styling for fields with long name\n* Rename ColorBox to ColorPreview\n* Adjust HighlightingRules test and remove screenshots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282", "committedDate": "2020-04-30T15:47:00Z", "message": "Fix linter warning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNjYzNDYw", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#pullrequestreview-403663460", "createdAt": "2020-04-30T16:03:12Z", "commit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjowMzoxM1rOGOwDOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjowMzoxM1rOGOwDOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyMDUwNQ==", "bodyText": "The above nth-child styling is only required to support IE11. I used :nth-child instead of defining the styling for each child because it allows a more flexible usage of the component.", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#discussion_r418120505", "createdAt": "2020-04-30T16:03:13Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/highlighting/HighlightingRule.jsx", "diffHunk": "@@ -1,14 +1,52 @@\n // @flow strict\n import * as React from 'react';\n import PropTypes from 'prop-types';\n-\n-import { ColorPickerPopover, Icon } from 'components/common';\n+import styled, { type StyledComponent } from 'styled-components';\n+import { type ThemeInterface } from 'theme';\n \n import { DEFAULT_CUSTOM_HIGHLIGHT_RANGE } from 'views/Constants';\n import Rule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n import { HighlightingRulesActions } from 'views/stores/HighlightingRulesStore';\n \n-import styles from './HighlightingRules.css';\n+import { ColorPickerPopover, Icon } from 'components/common';\n+import ColorPreview from './ColorPreview';\n+\n+export const HighlightingRuleGrid: StyledComponent<{}, void, HTMLDivElement> = styled.div`\n+  display: grid;\n+  display: -ms-grid;\n+  margin-top: 5px;\n+  grid-template-columns: max-content 1fr max-content;\n+  -ms-grid-columns: max-content 1fr max-content;\n+\n+  > *:nth-child(1) {\n+    grid-column: 1;\n+    -ms-grid-column: 1;\n+  }\n+\n+  > *:nth-child(2) {\n+    grid-column: 2;\n+    -ms-grid-column: 2;\n+  }\n+\n+  > *:nth-child(3) {\n+    grid-column: 3;\n+    -ms-grid-column: 3;\n+  }\n+`;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNjY0Nzc5", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#pullrequestreview-403664779", "createdAt": "2020-04-30T16:04:48Z", "commit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjowNDo0OFrOGOwHPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjowNDo0OFrOGOwHPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyMTUzMw==", "bodyText": "I had to use a <div> instead of a <span> here, otherwise the grid will not be displayed correctly with IE11.", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#discussion_r418121533", "createdAt": "2020-04-30T16:04:48Z", "author": {"login": "linuspahl"}, "path": "graylog2-web-interface/src/views/components/sidebar/highlighting/HighlightingRule.jsx", "diffHunk": "@@ -30,19 +68,20 @@ const onDelete = (e, rule) => {\n const HighlightingRule = ({ rule }: Props) => {\n   const { field, value, color } = rule;\n   return (\n-    <div className={styles.highlightingRuleBlock}>\n+    <HighlightingRuleGrid>\n       <ColorPickerPopover id=\"formatting-rule-color\"\n                           placement=\"right\"\n                           color={color}\n                           colors={DEFAULT_CUSTOM_HIGHLIGHT_RANGE.map((c) => [c])}\n-                          triggerNode={<div className={styles.colorElement} style={{ backgroundColor: color }} />}\n+                          triggerNode={<ColorPreview color={color} />}\n                           onChange={(newColor, _, hidePopover) => updateColor(rule, newColor, hidePopover)} />\n-      {' '}\n-      for <strong>{field}</strong> = <i>&quot;{value}&quot;</i>.\n-      <span role=\"presentation\" title=\"Remove this Highlighting Rule\" onClick={(e) => onDelete(e, rule)}>\n+      <div>\n+        for <strong>{field}</strong> = <i>&quot;{value}&quot;</i>.\n+      </div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTEyMDgw", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#pullrequestreview-404512080", "createdAt": "2020-05-02T08:51:00Z", "commit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTEyMzM0", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#pullrequestreview-404512334", "createdAt": "2020-05-02T08:55:31Z", "commit": {"oid": "14bb45a0a167dbaa5bc18a278e6f9bb6dceb9282"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "618b6cce55a9785df79a896c5848258e0036fbff", "author": {"user": {"login": "linuspahl", "name": "Linus Pahl"}}, "url": "https://github.com/Graylog2/graylog2-server/commit/618b6cce55a9785df79a896c5848258e0036fbff", "committedDate": "2020-05-04T08:00:40Z", "message": "Break highlighting rule description when reaching the end of a line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODkzMTQ5", "url": "https://github.com/Graylog2/graylog2-server/pull/8018#pullrequestreview-404893149", "createdAt": "2020-05-04T11:11:04Z", "commit": {"oid": "618b6cce55a9785df79a896c5848258e0036fbff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2466, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}