{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NTY5MDQz", "number": 11574, "title": "player-indicators: don't decorate non-player custom menu options", "bodyText": "Fixes #11448 which appeared because of 087b2ac. The issue is that custom menu entries of type RUNELITE are decorated even if they aren't related to a player.\nTo fix the issue, the MenuAction.RUNELITE menu type is split into RUNELITE and RUNELITE_PLAYER. With RUNELITE_PLAYER being assigned to player options only, the Player Indicators plugin should no longer try to decorate general menu entries such as Edit-tags, and also not the right-click Lookup in chat or other menu entries that aren't player options.\nWhy this issue wasn't observed before 087b2ac:\nThe plugin was changed in that commit to use the ClientTick event instead of MenuEntryAdded for going through the menu entries. Custom menu entries don't post a corresponding MenuEntryAdded event when they are added to the menu, so the plugin would not decorate them.", "createdAt": "2020-05-13T19:34:58Z", "url": "https://github.com/runelite/runelite/pull/11574", "merged": true, "mergeCommit": {"oid": "6518a6a51d5bde68680d25f4f6b1ebf01f982ca3"}, "closed": true, "closedAt": "2020-05-27T22:42:47Z", "author": {"login": "alexanderhenne"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchIDkHgFqTQxMTUxODY2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclg57fgBqjMzODAzMDE2MzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNTE4NjYx", "url": "https://github.com/runelite/runelite/pull/11574#pullrequestreview-411518661", "createdAt": "2020-05-14T07:06:36Z", "commit": {"oid": "45b27967f80dfd194b16472a43a57388329cbb33"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzowNjozNlrOGVOvAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzowNjozNlrOGVOvAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkxNDY4OA==", "bodyText": "Adam commented in discord and I agree somewhat that it's odd that this comment isn't updated to reflect the code that this method actually runs. This should mention that player and managed widget menus are handled here.", "url": "https://github.com/runelite/runelite/pull/11574#discussion_r424914688", "createdAt": "2020-05-14T07:06:36Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/menus/MenuManager.java", "diffHunk": "@@ -247,7 +247,8 @@ private void removeNpcOption(NPCComposition composition, String npcOption)\n \t@Subscribe\n \tpublic void onMenuOptionClicked(MenuOptionClicked event)\n \t{\n-\t\tif (event.getMenuAction() != MenuAction.RUNELITE)\n+\t\tif (event.getMenuAction() != MenuAction.RUNELITE\n+\t\t\t&& event.getMenuAction() != MenuAction.RUNELITE_PLAYER)\n \t\t{\n \t\t\treturn; // not a player menu", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45b27967f80dfd194b16472a43a57388329cbb33"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45b27967f80dfd194b16472a43a57388329cbb33", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/45b27967f80dfd194b16472a43a57388329cbb33", "committedDate": "2020-05-13T18:18:52Z", "message": "player-indicators: don't decorate non-player custom menu options\n\nSplits the RUNELITE menu action into two actions:\n\nRUNELITE -  general menu items.\n\nRUNELITE_PLAYER - menu items which target a player and have its identifier set to a player index.\n\nThen the player indicators plugin is changed to only decorate RUNELITE_PLAYER menu items."}, "afterCommit": {"oid": "4eb7f12e68a88104656c5a51246187292892c5e5", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/4eb7f12e68a88104656c5a51246187292892c5e5", "committedDate": "2020-05-27T22:11:07Z", "message": "player-indicators: don't decorate non-player custom menu options\n\nSplits the RUNELITE menu action into two actions:\n\nRUNELITE -  general menu items.\n\nRUNELITE_PLAYER - menu items which target a player and have its identifier set to a player index.\n\nThen the player indicators plugin is changed to only decorate RUNELITE_PLAYER menu items."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0dd7bb0a91890603a74d798eb006a2cc8026288", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/a0dd7bb0a91890603a74d798eb006a2cc8026288", "committedDate": "2020-05-27T22:20:56Z", "message": "player-indicators: don't decorate non-player custom menu options\n\nSplits the RUNELITE menu action into two actions:\n\nRUNELITE -  general menu items.\n\nRUNELITE_PLAYER - menu items which target a player and have its identifier set to a player index.\n\nThen the player indicators plugin is changed to only decorate RUNELITE_PLAYER menu items."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4eb7f12e68a88104656c5a51246187292892c5e5", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/4eb7f12e68a88104656c5a51246187292892c5e5", "committedDate": "2020-05-27T22:11:07Z", "message": "player-indicators: don't decorate non-player custom menu options\n\nSplits the RUNELITE menu action into two actions:\n\nRUNELITE -  general menu items.\n\nRUNELITE_PLAYER - menu items which target a player and have its identifier set to a player index.\n\nThen the player indicators plugin is changed to only decorate RUNELITE_PLAYER menu items."}, "afterCommit": {"oid": "a0dd7bb0a91890603a74d798eb006a2cc8026288", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/a0dd7bb0a91890603a74d798eb006a2cc8026288", "committedDate": "2020-05-27T22:20:56Z", "message": "player-indicators: don't decorate non-player custom menu options\n\nSplits the RUNELITE menu action into two actions:\n\nRUNELITE -  general menu items.\n\nRUNELITE_PLAYER - menu items which target a player and have its identifier set to a player index.\n\nThen the player indicators plugin is changed to only decorate RUNELITE_PLAYER menu items."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3745, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}