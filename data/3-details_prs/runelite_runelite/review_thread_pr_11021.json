{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4OTc2OTE2", "number": 11021, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNjo1OToxNFrODoNTsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMjoxNTozM1rODo8qHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDg3NjY3OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNjo1OToxNFrOF2njqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNjo1OToxNFrOF2njqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgxNTUyOQ==", "bodyText": "Maybe do this only if the cursor is set to equipped cursor? Otherwise you are constantly reloading for example CUSTOM_IMAGE_FILE cursor etc.", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r392815529", "createdAt": "2020-03-16T06:59:14Z", "author": {"login": "deathbeam"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -81,6 +94,12 @@ public void onConfigChanged(ConfigChanged event)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onItemContainerChanged(ItemContainerChanged event)\n+\t{\n+\t\tupdateCursor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDg3ODkyOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNjo1OTo0OVrOF2nlBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODo1Njo1MFrOF3B0mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgxNTg3OA==", "bodyText": "Shouldn't this be on client thread?", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r392815878", "createdAt": "2020-03-16T06:59:49Z", "author": {"login": "deathbeam"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -110,8 +129,36 @@ private void updateCursor()\n \t\t\t}\n \t\t\treturn;\n \t\t}\n+\t\telse if (selectedCursor == CustomCursor.EQUIPPED_WEAPON)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA4MjA2Mg==", "bodyText": "Can I get a pointer about what I need to do to fix this? Sorry to bug, I'm new to this project so I must be missing something.", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r393082062", "createdAt": "2020-03-16T14:49:49Z", "author": {"login": "DiscretePython"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -110,8 +129,36 @@ private void updateCursor()\n \t\t\t}\n \t\t\treturn;\n \t\t}\n+\t\telse if (selectedCursor == CustomCursor.EQUIPPED_WEAPON)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgxNTg3OA=="}, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI0NTg1MQ==", "bodyText": "The client itself runs on a specific thread, and you can queue operations which invoke client functions using our ClientThread class. Search the codebase for uses to see how it is used.", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r393245851", "createdAt": "2020-03-16T18:56:50Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -110,8 +129,36 @@ private void updateCursor()\n \t\t\t}\n \t\t\treturn;\n \t\t}\n+\t\telse if (selectedCursor == CustomCursor.EQUIPPED_WEAPON)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgxNTg3OA=="}, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDkxMzI1OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzowOTowN1rOF2n64A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzowOTowN1rOF2n64A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyMTQ3Mg==", "bodyText": "Custom Image should be the last option imo\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tCUSTOM_IMAGE(\"Custom Image\"),\n          \n          \n            \n            \tEQUIPPED_WEAPON(\"Equipped Weapon\");\n          \n          \n            \n            \tEQUIPPED_WEAPON(\"Equipped Weapon\"),\n          \n          \n            \n            \tCUSTOM_IMAGE(\"Custom Image\");", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r392821472", "createdAt": "2020-03-16T07:09:07Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursor.java", "diffHunk": "@@ -38,7 +38,8 @@\n \tDRAGON_DAGGER_POISON(\"Dragon Dagger (p)\", \"cursor-dragon-dagger-p.png\"),\n \tTROUT(\"Trout\", \"cursor-trout.png\"),\n \tDRAGON_SCIMITAR(\"Dragon Scimitar\", \"cursor-dragon-scimitar.png\"),\n-\tCUSTOM_IMAGE(\"Custom Image\");\n+\tCUSTOM_IMAGE(\"Custom Image\"),\n+\tEQUIPPED_WEAPON(\"Equipped Weapon\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDkxNjk5OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzoxMTowNlrOF2n9MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzoxMTowNlrOF2n9MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgyMjA2NA==", "bodyText": "What weapons have different sprites for high quantities? All the ones listed on the wiki have identical sprites regardless of quantity.", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r392822064", "createdAt": "2020-03-16T07:11:06Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -110,8 +129,36 @@ private void updateCursor()\n \t\t\t}\n \t\t\treturn;\n \t\t}\n+\t\telse if (selectedCursor == CustomCursor.EQUIPPED_WEAPON)\n+\t\t{\n+\t\t\tfinal ItemContainer itemContainer = client.getItemContainer(InventoryID.EQUIPMENT);\n+\n+\t\t\tif (itemContainer == null)\n+\t\t\t{\n+\t\t\t\tclientUI.resetCursor();\n+\t\t\t\treturn;\n+\t\t\t}\n+\n+\t\t\tfinal Item weapon = itemContainer.getItems()[EquipmentInventorySlot.WEAPON.getSlotIdx()];\n+\t\t\tfinal BufferedImage image = getImage(weapon);\n+\n+\t\t\tif (weapon.getQuantity() > 0)\n+\t\t\t{\n+\t\t\t\tclientUI.setCursor(image, selectedCursor.getName());\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tclientUI.resetCursor();\n+\t\t\t}\n+\t\t\treturn;\n+\t\t}\n \n \t\tassert selectedCursor.getCursorImage() != null;\n \t\tclientUI.setCursor(selectedCursor.getCursorImage(), selectedCursor.getName());\n \t}\n+\n+\tprivate BufferedImage getImage(Item item)\n+\t{\n+\t\treturn itemManager.getImage(item.getId(), item.getQuantity(), item.getQuantity() > 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c5ce94ec4befa59ec89123d8f0cda5d10919065"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzU2Nzc0OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODo1ODo1NlrOF3B7Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODo1ODo1NlrOF3B7Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI0NzU1NA==", "bodyText": "A player's equipment is not the only item container that exists. (see InventoryID for a list of identified ones) This should check that the changed container was the player's equipment as well.", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r393247554", "createdAt": "2020-03-16T18:58:56Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -81,6 +94,15 @@ public void onConfigChanged(ConfigChanged event)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onItemContainerChanged(ItemContainerChanged event)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6522e94ad4bbe089e8dd39c33eec9c09f0efdf56"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MjYzNDU0OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMjoxNTozM1rOF30Isg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMjoxNTozM1rOF30Isg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA3MDE5NA==", "bodyText": "I think this actually needs bounds check", "url": "https://github.com/runelite/runelite/pull/11021#discussion_r394070194", "createdAt": "2020-03-18T02:15:33Z", "author": {"login": "deathbeam"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/customcursor/CustomCursorPlugin.java", "diffHunk": "@@ -108,10 +134,36 @@ private void updateCursor()\n \t\t\t{\n \t\t\t\tclientUI.resetCursor();\n \t\t\t}\n-\t\t\treturn;\n \t\t}\n+\t\telse if (selectedCursor == CustomCursor.EQUIPPED_WEAPON)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tfinal ItemContainer itemContainer = client.getItemContainer(InventoryID.EQUIPMENT);\n \n-\t\tassert selectedCursor.getCursorImage() != null;\n-\t\tclientUI.setCursor(selectedCursor.getCursorImage(), selectedCursor.getName());\n+\t\t\t\tif (itemContainer == null)\n+\t\t\t\t{\n+\t\t\t\t\tclientUI.resetCursor();\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\n+\t\t\t\tfinal Item weapon = itemContainer.getItems()[EquipmentInventorySlot.WEAPON.getSlotIdx()];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "274f8d8df65bd724d625c01830856b6e16cbb548"}, "originalPosition": 77}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3718, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}