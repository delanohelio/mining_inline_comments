{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2Njg3NjA0", "number": 10827, "title": "Improve GPU Plugin performance", "bodyText": "First pass at optimization for issue #10819\n(Will improve pull request over time, submitting early for testing.)", "createdAt": "2020-02-18T15:38:21Z", "url": "https://github.com/runelite/runelite/pull/10827", "merged": true, "mergeCommit": {"oid": "5fc4e1bd6924077b96c648775760d7eb4bf32462"}, "closed": true, "closedAt": "2020-02-19T22:05:50Z", "author": {"login": "tylercamp"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFkGuhAFqTM2MDQ2MDcyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcF6mNeABqjMwNTI4MDczMjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDYwNzI1", "url": "https://github.com/runelite/runelite/pull/10827#pullrequestreview-360460725", "createdAt": "2020-02-18T15:59:37Z", "commit": {"oid": "81c88e01ce78fa4668f35ab1b10189e809cef0d5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNTo1OTozN1rOFrILqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNTo1OTozN1rOFrILqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc2NzE0NQ==", "bodyText": "The scene buffers are not updated per frame nor even drawn from directly, instead they are (readonly) accessed via ssbo in the compute shaders.", "url": "https://github.com/runelite/runelite/pull/10827#discussion_r380767145", "createdAt": "2020-02-18T15:59:37Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/gpu/GpuPlugin.java", "diffHunk": "@@ -1195,26 +1241,17 @@ private void uploadScene()\n \t\tIntBuffer vertexBuffer = this.vertexBuffer.getBuffer();\n \t\tFloatBuffer uvBuffer = this.uvBuffer.getBuffer();\n \n-\t\tif (bufferId != -1)\n-\t\t{\n-\t\t\tGLUtil.glDeleteBuffer(gl, bufferId);\n-\t\t\tbufferId = -1;\n-\t\t}\n-\n-\t\tif (uvBufferId != -1)\n-\t\t{\n-\t\t\tGLUtil.glDeleteBuffer(gl, uvBufferId);\n-\t\t\tuvBufferId = -1;\n-\t\t}\n+\t\tif (bufferId == -1)\n+\t\t\tbufferId = glGenBuffers(gl);\n \n-\t\tbufferId = glGenBuffers(gl);\n-\t\tuvBufferId = glGenBuffers(gl);\n+\t\tif (uvBufferId == -1)\n+\t\t\tuvBufferId = glGenBuffers(gl);\n \n \t\tgl.glBindBuffer(gl.GL_ARRAY_BUFFER, bufferId);\n-\t\tgl.glBufferData(gl.GL_ARRAY_BUFFER, vertexBuffer.limit() * Integer.BYTES, vertexBuffer, gl.GL_STATIC_COPY);\n+\t\tgl.glBufferData(gl.GL_ARRAY_BUFFER, vertexBuffer.limit() * Integer.BYTES, vertexBuffer, gl.GL_DYNAMIC_DRAW);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81c88e01ce78fa4668f35ab1b10189e809cef0d5"}, "originalPosition": 316}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "891c98ba3860f24b081ef6e87b9547c16b564e17", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/891c98ba3860f24b081ef6e87b9547c16b564e17", "committedDate": "2020-02-18T22:42:20Z", "message": "cleanup"}, "afterCommit": {"oid": "8cfaeb2a073f3d963962065a5b27ebc7081ce55e", "author": {"user": {"login": "tylercamp", "name": "Tyler Camp"}}, "url": "https://github.com/runelite/runelite/commit/8cfaeb2a073f3d963962065a5b27ebc7081ce55e", "committedDate": "2020-02-19T14:43:42Z", "message": "gpu: create tmp data buffers during init and reuse across frames\n\nCreating and destroying buffers each frame is unnecessary and inefficient as it doesn't give the driver the chance to observe the buffer's usage and optimize its access.\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8f04c7159c08df9abfc78f52be9042808064dd5", "author": {"user": {"login": "tylercamp", "name": "Tyler Camp"}}, "url": "https://github.com/runelite/runelite/commit/e8f04c7159c08df9abfc78f52be9042808064dd5", "committedDate": "2020-02-19T18:11:38Z", "message": "gpu: create tmp data buffers during init and reuse across frames\n\nCreating and destroying buffers each frame is unnecessary and inefficient as it doesn't give the driver the chance to observe the buffer's usage and optimize its access.\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cfaeb2a073f3d963962065a5b27ebc7081ce55e", "author": {"user": {"login": "tylercamp", "name": "Tyler Camp"}}, "url": "https://github.com/runelite/runelite/commit/8cfaeb2a073f3d963962065a5b27ebc7081ce55e", "committedDate": "2020-02-19T14:43:42Z", "message": "gpu: create tmp data buffers during init and reuse across frames\n\nCreating and destroying buffers each frame is unnecessary and inefficient as it doesn't give the driver the chance to observe the buffer's usage and optimize its access.\n\nCo-authored-by: Adam <Adam@sigterm.info>"}, "afterCommit": {"oid": "e8f04c7159c08df9abfc78f52be9042808064dd5", "author": {"user": {"login": "tylercamp", "name": "Tyler Camp"}}, "url": "https://github.com/runelite/runelite/commit/e8f04c7159c08df9abfc78f52be9042808064dd5", "committedDate": "2020-02-19T18:11:38Z", "message": "gpu: create tmp data buffers during init and reuse across frames\n\nCreating and destroying buffers each frame is unnecessary and inefficient as it doesn't give the driver the chance to observe the buffer's usage and optimize its access.\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4236, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}