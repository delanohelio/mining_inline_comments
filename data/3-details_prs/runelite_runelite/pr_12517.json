{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5OTE4MjEy", "number": 12517, "title": "Fix Nightmare Zone Overload timer and notification", "bodyText": "Close #12493\nThe timers plugin was not checking to see if the player was still inside NMZ, causing the timer to stay when the player left or hopped worlds. Now checks to see if the player is inside the NMZ region.\nFor the nightmarezone plugin, overloadNotificationSend = true when the player drinks an Overload potion. When the player leaves NMZ before the Overload expires and re-enters, overloadNotificationSend is still true. This results in the notification still being sent based on when the potion was drunk in the previous NMZ instance. Now sets overloadNotificationSend to false upon leaving.", "createdAt": "2020-09-20T15:31:32Z", "url": "https://github.com/runelite/runelite/pull/12517", "merged": true, "mergeCommit": {"oid": "bc40837c53f93fbb1da082ec0ff7c0b8024879b4"}, "closed": true, "closedAt": "2020-10-25T01:57:43Z", "author": {"login": "spatiag"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdK7iTsgFqTQ5MjI3MDk3MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdV1sxbgBqjM5MTczNjg0Mjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMjcwOTcx", "url": "https://github.com/runelite/runelite/pull/12517#pullrequestreview-492270971", "createdAt": "2020-09-21T04:14:04Z", "commit": {"oid": "c03155ebaf77d82955cee5afa04984db6e9d3c55"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNDoxNDowNFrOHVAQhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNDoxODowOFrOHVAS3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc4NjM3Mw==", "bodyText": "This should use the same logic as is used in the nightmare zone plugin. I don't think it's an important distinction in this particular case, but this would give false positive results when in KBD's lair", "url": "https://github.com/runelite/runelite/pull/12517#discussion_r491786373", "createdAt": "2020-09-21T04:14:04Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timers/TimersPlugin.java", "diffHunk": "@@ -708,6 +712,11 @@ private boolean isInInferno()\n \t\treturn client.getMapRegions() != null && ArrayUtils.contains(client.getMapRegions(), INFERNO_REGION_ID);\n \t}\n \n+\tprivate boolean isInNightmareZone()\n+\t{\n+\t\treturn client.getMapRegions() != null && ArrayUtils.contains(client.getMapRegions(), NMZ_MAP_REGION_ID);\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03155ebaf77d82955cee5afa04984db6e9d3c55"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc4NjcyNw==", "bodyText": "What purpose does this serve? We can safely call removeGameTimer(OVERLOAD) even if the timer hasn't been added.", "url": "https://github.com/runelite/runelite/pull/12517#discussion_r491786727", "createdAt": "2020-09-21T04:16:19Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timers/TimersPlugin.java", "diffHunk": "@@ -143,6 +144,7 @@\n \tprivate int lastAnimation;\n \tprivate boolean loggedInRace;\n \tprivate boolean widgetHiddenChangedOnPvpWorld;\n+\tprivate boolean overloadNMZ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03155ebaf77d82955cee5afa04984db6e9d3c55"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc4Njk3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tif (overloadNotificationSend)\n          \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t\toverloadNotificationSend = false;\n          \n          \n            \n            \t\t\t}\n          \n          \n            \n            \t\t\toverloadNotificationSend = false;", "url": "https://github.com/runelite/runelite/pull/12517#discussion_r491786975", "createdAt": "2020-09-21T04:18:08Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/nightmarezone/NightmareZonePlugin.java", "diffHunk": "@@ -135,6 +135,11 @@ public void onGameTick(GameTick event)\n \t\t\t\tresetPointsPerHour();\n \t\t\t}\n \n+\t\t\tif (overloadNotificationSend)\n+\t\t\t{\n+\t\t\t\toverloadNotificationSend = false;\n+\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1258d35688c525fbbc1474683a61eb4271990b2d"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwOTk4NDUz", "url": "https://github.com/runelite/runelite/pull/12517#pullrequestreview-510998453", "createdAt": "2020-10-17T16:39:36Z", "commit": {"oid": "f9feabc098f6be30f1cedd0a818dbdf09dabcc35"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNjozOTozN1rOHjeazg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QxNjozOTozN1rOHjeazg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk2MDU5MA==", "bodyText": "The timer removal only has to be in LOADING I think.", "url": "https://github.com/runelite/runelite/pull/12517#discussion_r506960590", "createdAt": "2020-10-17T16:39:37Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timers/TimersPlugin.java", "diffHunk": "@@ -800,6 +823,7 @@ public void onGameStateChanged(GameStateChanged gameStateChanged)\n \n \t\t\t\tremoveTzhaarTimer(); // will be readded by the wave message\n \t\t\t\tremoveGameTimer(TELEBLOCK);\n+\t\t\t\tremoveNMZOverloadTimer();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9feabc098f6be30f1cedd0a818dbdf09dabcc35"}, "originalPosition": 80}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f9feabc098f6be30f1cedd0a818dbdf09dabcc35", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/f9feabc098f6be30f1cedd0a818dbdf09dabcc35", "committedDate": "2020-09-21T09:24:03Z", "message": "Fix previous NMZ check commit\n\nAccidentally changed the logic for isInFightCaves() instead of\nisInNightmareZone()."}, "afterCommit": {"oid": "ff8b5191c3e502cc7a2cbfa116c6a2ca0e70d023", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/ff8b5191c3e502cc7a2cbfa116c6a2ca0e70d023", "committedDate": "2020-10-25T00:49:13Z", "message": "nightmarezone: Fix false Overload notification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e71c88b4d47d7fb2dcc8a862e0b31830887877a", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/0e71c88b4d47d7fb2dcc8a862e0b31830887877a", "committedDate": "2020-10-25T00:54:07Z", "message": "timers: Fix NMZ Overload timer not disappearing\n\nUnlike with the CoX Overloads, the plugin did not check if the player\nwas still in the area for the Nightmare Zone Overloads, causing the\ntimer to not disappear after leaving. The plugin now removes the timer\nif the player has left NMZ and has drunk an Overload potion."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e2946024b4fdd831a3e70ed98f583941eeaefae", "author": {"user": {"login": "Nightfirecat", "name": "Jordan"}}, "url": "https://github.com/runelite/runelite/commit/5e2946024b4fdd831a3e70ed98f583941eeaefae", "committedDate": "2020-10-25T00:54:08Z", "message": "nightmarezone: Set absorption notification var on startup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff8b5191c3e502cc7a2cbfa116c6a2ca0e70d023", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/ff8b5191c3e502cc7a2cbfa116c6a2ca0e70d023", "committedDate": "2020-10-25T00:49:13Z", "message": "nightmarezone: Fix false Overload notification"}, "afterCommit": {"oid": "956eb35c26af23956fc0d0eeff4ff003dd6e79ae", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/956eb35c26af23956fc0d0eeff4ff003dd6e79ae", "committedDate": "2020-10-25T00:54:08Z", "message": "nightmarezone: Fix false Overload notification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c9ceb9d175ad1e0db8567517904835eaa9c8658", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/5c9ceb9d175ad1e0db8567517904835eaa9c8658", "committedDate": "2020-10-25T01:42:53Z", "message": "nightmarezone: Clear pending overload notifications outside NMZ"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "956eb35c26af23956fc0d0eeff4ff003dd6e79ae", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/956eb35c26af23956fc0d0eeff4ff003dd6e79ae", "committedDate": "2020-10-25T00:54:08Z", "message": "nightmarezone: Fix false Overload notification"}, "afterCommit": {"oid": "5c9ceb9d175ad1e0db8567517904835eaa9c8658", "author": {"user": {"login": "spatiag", "name": null}}, "url": "https://github.com/runelite/runelite/commit/5c9ceb9d175ad1e0db8567517904835eaa9c8658", "committedDate": "2020-10-25T01:42:53Z", "message": "nightmarezone: Clear pending overload notifications outside NMZ"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3160, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}