{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NjU2NDc5", "number": 10996, "title": "timetracking: add timer warning colors and ability to sort timers.", "bodyText": "Originally made by @jakewilson\nRebased, added proposed changes and tested.\nFrom my testing I fixed a couple of bugs, for example, timer going to 0 and then starting it over would show in warning color even if it was above the warning threshold.\nAlso when the timer is stopped in a warning state it shows the same color rather than a darker color.\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\nSupersedes #7361", "createdAt": "2020-03-11T12:19:28Z", "url": "https://github.com/runelite/runelite/pull/10996", "merged": true, "mergeCommit": {"oid": "df18bdb542a93b09a2f0ffde28703d3ee671b8ff"}, "closed": true, "closedAt": "2020-03-18T22:22:17Z", "author": {"login": "melkypie"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMmWYqgBqjMxMTg1OTkxMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcO84bxABqjMxNDI5NTQ3Nzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9b166b6fdec80188e337a53da59b3e71a00f858", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/c9b166b6fdec80188e337a53da59b3e71a00f858", "committedDate": "2020-03-11T12:16:48Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/8feaac5c5cd44d8a2470d98e188b0232c4da128f", "committedDate": "2020-03-11T12:33:41Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNDAwNjI5", "url": "https://github.com/runelite/runelite/pull/10996#pullrequestreview-373400629", "createdAt": "2020-03-12T09:38:49Z", "commit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwOTozODo1MFrOF1XOyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMDozMDozOVrOF1ZAwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ5OTQ2NQ==", "bodyText": "Use Units", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r391499465", "createdAt": "2020-03-12T09:38:50Z", "author": {"login": "dekvall"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/TimeTrackingConfig.java", "diffHunk": "@@ -83,6 +83,28 @@ default int defaultTimerMinutes()\n \t\treturn 5;\n \t}\n \n+\t@ConfigItem(\n+\t\tkeyName = \"sortOrder\",\n+\t\tname = \"Sort Order\",\n+\t\tdescription = \"The order in which to sort the timers\",\n+\t\tposition = 5\n+\t)\n+\tdefault SortOrder sortOrder()\n+\t{\n+\t\treturn SortOrder.NONE;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"timerWarningSeconds\",\n+\t\tname = \"Timer Warning (Seconds)\",\n+\t\tdescription = \"The time at which to change the timer color to the warning color\",\n+\t\tposition = 6\n+\t)\n+\tdefault int timerWarningSeconds()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTUwNDc0NQ==", "bodyText": "I think that this is a bit hard to read, can you un-nest this ternary?", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r391504745", "createdAt": "2020-03-12T09:47:54Z", "author": {"login": "dekvall"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/clocks/TimerPanel.java", "diffHunk": "@@ -42,4 +46,25 @@\n \t\tdeleteButton.addActionListener(e -> clockManager.removeTimer(timer));\n \t\trightActions.add(deleteButton);\n \t}\n+\n+\t@Override\n+\tvoid updateDisplayInput()\n+\t{\n+\t\tsuper.updateDisplayInput();\n+\n+\t\tTimer timer = (Timer) getClock();\n+\t\tif (timer.isWarning())\n+\t\t{\n+\t\t\tdisplayInput.getTextField().setForeground(getColor());\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tprotected Color getColor()\n+\t{\n+\t\tColor color = super.getColor();\n+\t\tTimer timer = (Timer) getClock();\n+\n+\t\treturn timer.isWarning() ? (timer.isActive() ? WARNING_COLOR : WARNING_COLOR.darker()) : super.getColor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTUyODY0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn (remaining > 0) && warning;\n          \n          \n            \n            \t\treturn warning && remaining > 0;", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r391528640", "createdAt": "2020-03-12T10:30:39Z", "author": {"login": "dekvall"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/clocks/Timer.java", "diffHunk": "@@ -96,4 +103,9 @@ void reset()\n \t\tremaining = duration;\n \t\tlastUpdate = Instant.now().getEpochSecond();\n \t}\n+\n+\tboolean isWarning()\n+\t{\n+\t\treturn (remaining > 0) && warning;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8feaac5c5cd44d8a2470d98e188b0232c4da128f", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/8feaac5c5cd44d8a2470d98e188b0232c4da128f", "committedDate": "2020-03-11T12:33:41Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "4c860a872b644f4dd2cb548cac28c64e9f6c58a5", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/4c860a872b644f4dd2cb548cac28c64e9f6c58a5", "committedDate": "2020-03-13T20:50:17Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjcxODQ2", "url": "https://github.com/runelite/runelite/pull/10996#pullrequestreview-374671846", "createdAt": "2020-03-13T23:49:29Z", "commit": {"oid": "4c860a872b644f4dd2cb548cac28c64e9f6c58a5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMzo0OTozMFrOF2WLeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMzo0OTozMFrOF2WLeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUzMDgwOA==", "bodyText": "Now that it's using Units the name Timer Warning (Seconds) feels redundant, consider renaming the option and corresponding fields to something like Timer Warning Threshold or similar", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r392530808", "createdAt": "2020-03-13T23:49:30Z", "author": {"login": "dekvall"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/TimeTrackingConfig.java", "diffHunk": "@@ -83,6 +83,29 @@ default int defaultTimerMinutes()\n \t\treturn 5;\n \t}\n \n+\t@ConfigItem(\n+\t\tkeyName = \"sortOrder\",\n+\t\tname = \"Sort Order\",\n+\t\tdescription = \"The order in which to sort the timers\",\n+\t\tposition = 5\n+\t)\n+\tdefault SortOrder sortOrder()\n+\t{\n+\t\treturn SortOrder.NONE;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"timerWarningSeconds\",\n+\t\tname = \"Timer Warning (Seconds)\",\n+\t\tdescription = \"The time at which to change the timer color to the warning color\",\n+\t\tposition = 6\n+\t)\n+\t@Units(Units.SECONDS)\n+\tdefault int timerWarningSeconds()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c860a872b644f4dd2cb548cac28c64e9f6c58a5"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c860a872b644f4dd2cb548cac28c64e9f6c58a5", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/4c860a872b644f4dd2cb548cac28c64e9f6c58a5", "committedDate": "2020-03-13T20:50:17Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "92351a4f7d95c8becbbf3d58433cd30d333ba110", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/92351a4f7d95c8becbbf3d58433cd30d333ba110", "committedDate": "2020-03-14T14:34:54Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "92351a4f7d95c8becbbf3d58433cd30d333ba110", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/92351a4f7d95c8becbbf3d58433cd30d333ba110", "committedDate": "2020-03-14T14:34:54Z", "message": "timetracking: add timer warning colors and ability to sort timers.\n\nLets the user sort by ascending or descending time.\nLets the user choose a time for showing a timer warning in orange.\nCloses #7240\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "680a76cb4c8ba36638ac099d59b217065b9af763", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/680a76cb4c8ba36638ac099d59b217065b9af763", "committedDate": "2020-03-18T11:56:35Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2OTcxMDMy", "url": "https://github.com/runelite/runelite/pull/10996#pullrequestreview-376971032", "createdAt": "2020-03-18T15:22:42Z", "commit": {"oid": "1c9caad107d07c15dc4791a687b0853599b78031"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNToyMjo0MlrOF4KGmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNToyNDoxOVrOF4KLhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQzMDEwNg==", "bodyText": "I think this can just be removed?", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r394430106", "createdAt": "2020-03-18T15:22:42Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/clocks/ClockManager.java", "diffHunk": "@@ -131,6 +134,36 @@ public boolean checkCompletion()\n \t\treturn changed;\n \t}\n \n+\t/**\n+\t * Checks to ensure the timers are in the correct order.\n+\t * If they are not, sort them and rebuild the clock panel\n+\t *\n+\t * @return whether the timer order was changed or not\n+\t */\n+\tpublic boolean checkTimerOrder()\n+\t{\n+\t\tSortOrder sortOrder = config.sortOrder();\n+\t\tif (sortOrder != SortOrder.NONE)\n+\t\t{\n+\t\t\tComparator<Timer> comparator = Comparator.comparingLong(Timer::getDisplayTime);\n+\t\t\tif (sortOrder == SortOrder.DESC)\n+\t\t\t{\n+\t\t\t\tcomparator = comparator.reversed();\n+\t\t\t}\n+\n+\t\t\tif (!Comparators.isInOrder(timers, comparator))\n+\t\t\t{\n+\t\t\t\ttimers.sort(comparator);\n+\t\t\t\tsaveTimers();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c9caad107d07c15dc4791a687b0853599b78031"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQzMTM2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn warning && (remaining > 0) ;\n          \n          \n            \n            \t\treturn warning && (remaining > 0);", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r394431366", "createdAt": "2020-03-18T15:24:19Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/clocks/Timer.java", "diffHunk": "@@ -96,4 +103,9 @@ void reset()\n \t\tremaining = duration;\n \t\tlastUpdate = Instant.now().getEpochSecond();\n \t}\n+\n+\tboolean isWarning()\n+\t{\n+\t\treturn warning && (remaining > 0) ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "680a76cb4c8ba36638ac099d59b217065b9af763"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "680a76cb4c8ba36638ac099d59b217065b9af763", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/680a76cb4c8ba36638ac099d59b217065b9af763", "committedDate": "2020-03-18T11:56:35Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "25ac3dc939cdd3d1b3161262dab22ba43e6fa339", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/25ac3dc939cdd3d1b3161262dab22ba43e6fa339", "committedDate": "2020-03-18T17:10:07Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTg1ODM2", "url": "https://github.com/runelite/runelite/pull/10996#pullrequestreview-377185836", "createdAt": "2020-03-18T19:50:17Z", "commit": {"oid": "25ac3dc939cdd3d1b3161262dab22ba43e6fa339"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOTo1MDoxN1rOF4UfbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOTo1MDoxN1rOF4UfbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYwMDMwMA==", "bodyText": "I think this is unused?", "url": "https://github.com/runelite/runelite/pull/10996#discussion_r394600300", "createdAt": "2020-03-18T19:50:17Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/timetracking/SortOrder.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright (c) 2020, Jake Wilson <https://github.com/jakewilson>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this\n+ *    list of conditions and the following disclaimer.\n+ * 2. Redistributions in binary form must reproduce the above copyright notice,\n+ *    this list of conditions and the following disclaimer in the documentation\n+ *    and/or other materials provided with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package net.runelite.client.plugins.timetracking;\n+\n+public enum SortOrder\n+{\n+\tNONE(\"NONE\"),\n+\tASC(\"ASC\"),\n+\tDESC(\"DESC\");\n+\n+\tprivate final String name;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25ac3dc939cdd3d1b3161262dab22ba43e6fa339"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b978910296e25f6e65b292819408bbb5d219db31", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/b978910296e25f6e65b292819408bbb5d219db31", "committedDate": "2020-03-18T19:56:26Z", "message": "timetracking: add ability to sort timers\n\nLets the user sort by ascending or descending time.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca51a2fe4d7552e06076ab2a0f5c73a553098cfd", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/ca51a2fe4d7552e06076ab2a0f5c73a553098cfd", "committedDate": "2020-03-18T19:56:26Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25ac3dc939cdd3d1b3161262dab22ba43e6fa339", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/25ac3dc939cdd3d1b3161262dab22ba43e6fa339", "committedDate": "2020-03-18T17:10:07Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}, "afterCommit": {"oid": "ca51a2fe4d7552e06076ab2a0f5c73a553098cfd", "author": {"user": {"login": "melkypie", "name": "Melky"}}, "url": "https://github.com/runelite/runelite/commit/ca51a2fe4d7552e06076ab2a0f5c73a553098cfd", "committedDate": "2020-03-18T19:56:26Z", "message": "timetracking: add timer warning colors\n\nLets the user choose a time for showing when the timer should turn orange.\n\nCo-authored-by: jakewilson <jakewilsonfl@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4050, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}