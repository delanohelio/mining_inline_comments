{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5Mjc1MjE1", "number": 10875, "title": "player-indicators: highlight the 'Walk here' menu entry too", "bodyText": "Fixes #8633", "createdAt": "2020-02-24T23:01:43Z", "url": "https://github.com/runelite/runelite/pull/10875", "merged": true, "mergeCommit": {"oid": "087b2ac9695778464962f6d28b02db7c2e3ae9cd"}, "closed": true, "closedAt": "2020-04-02T18:45:25Z", "author": {"login": "alexanderhenne"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHsO2sAFqTM2Mzg5ODM3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTv11bgBqjMxOTMyNTY4MzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzODk4Mzc2", "url": "https://github.com/runelite/runelite/pull/10875#pullrequestreview-363898376", "createdAt": "2020-02-25T06:35:36Z", "commit": {"oid": "aa815402ac99ea4053117dac975c7bd2097b115d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa815402ac99ea4053117dac975c7bd2097b115d", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/aa815402ac99ea4053117dac975c7bd2097b115d", "committedDate": "2020-02-24T22:55:59Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}, "afterCommit": {"oid": "28f65a6e4e53072987322c65642946beeb390ac1", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/28f65a6e4e53072987322c65642946beeb390ac1", "committedDate": "2020-03-01T20:57:36Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28f65a6e4e53072987322c65642946beeb390ac1", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/28f65a6e4e53072987322c65642946beeb390ac1", "committedDate": "2020-03-01T20:57:36Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}, "afterCommit": {"oid": "df9bb714654b95343a9e620d8884946762ff9511", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/df9bb714654b95343a9e620d8884946762ff9511", "committedDate": "2020-03-18T22:55:36Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df9bb714654b95343a9e620d8884946762ff9511", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/df9bb714654b95343a9e620d8884946762ff9511", "committedDate": "2020-03-18T22:55:36Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}, "afterCommit": {"oid": "2df2a8f43353378fa32d20963c5de9a544f8a8b3", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/2df2a8f43353378fa32d20963c5de9a544f8a8b3", "committedDate": "2020-03-18T23:14:31Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2df2a8f43353378fa32d20963c5de9a544f8a8b3", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/2df2a8f43353378fa32d20963c5de9a544f8a8b3", "committedDate": "2020-03-18T23:14:31Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}, "afterCommit": {"oid": "9fc3247acff524530fe6c90424dd99e960f3a83e", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/9fc3247acff524530fe6c90424dd99e960f3a83e", "committedDate": "2020-03-18T23:31:39Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MzM1MDY4", "url": "https://github.com/runelite/runelite/pull/10875#pullrequestreview-377335068", "createdAt": "2020-03-19T00:24:12Z", "commit": {"oid": "9fc3247acff524530fe6c90424dd99e960f3a83e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MDg2NzU1", "url": "https://github.com/runelite/runelite/pull/10875#pullrequestreview-385086755", "createdAt": "2020-03-31T20:39:21Z", "commit": {"oid": "ea7e205ab9e3e0012be07061842b80747d02e7c6"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOToyMVrOF-nWKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOTo0MlrOF-nW4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIwMDY4Mg==", "bodyText": "Since this is relatively expensive it would be better to only call setMenuEntries if you know it has changed.", "url": "https://github.com/runelite/runelite/pull/10875#discussion_r401200682", "createdAt": "2020-03-31T20:39:21Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "diffHunk": "@@ -94,58 +94,60 @@ protected void shutDown() throws Exception\n \t}\n \n \t@Subscribe\n-\tpublic void onMenuEntryAdded(MenuEntryAdded menuEntryAdded)\n+\tpublic void onClientTick(ClientTick clientTick)\n \t{\n-\t\tint type = menuEntryAdded.getType();\n+\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n \n-\t\tif (type >= 2000)\n+\t\tfor (MenuEntry entry : menuEntries)\n \t\t{\n-\t\t\ttype -= 2000;\n-\t\t}\n-\n-\t\tint identifier = menuEntryAdded.getIdentifier();\n-\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n-\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n-\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n-\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n-\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n-\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n-\t\t\t|| type == RUNELITE.getId())\n-\t\t{\n-\t\t\tPlayer[] players = client.getCachedPlayers();\n-\t\t\tPlayer player = null;\n+\t\t\tint type = entry.getType();\n \n-\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\tif (type >= 2000)\n \t\t\t{\n-\t\t\t\tplayer = players[identifier];\n+\t\t\t\ttype -= 2000;\n \t\t\t}\n \n-\t\t\tif (player == null)\n+\t\t\tint identifier = entry.getIdentifier();\n+\t\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n+\t\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n+\t\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n+\t\t\t\t|| type == RUNELITE.getId())\n \t\t\t{\n-\t\t\t\treturn;\n-\t\t\t}\n+\t\t\t\tPlayer[] players = client.getCachedPlayers();\n+\t\t\t\tPlayer player = null;\n \n-\t\t\tDecorations decorations = getDecorations(player);\n+\t\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\t\t{\n+\t\t\t\t\tplayer = players[identifier];\n+\t\t\t\t}\n \n-\t\t\tif (decorations == null)\n-\t\t\t{\n-\t\t\t\treturn;\n-\t\t\t}\n+\t\t\t\tif (player == null)\n+\t\t\t\t{\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n \n-\t\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n-\t\t\tMenuEntry entry = menuEntries[menuEntries.length - 1];\n+\t\t\t\tDecorations decorations = getDecorations(player);\n \n-\t\t\tString oldTarget = entry.getTarget();\n-\t\t\tString newTarget = decorateTarget(oldTarget, decorations);\n+\t\t\t\tif (decorations == null)\n+\t\t\t\t{\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n \n-\t\t\tentry.setTarget(newTarget);\n+\t\t\t\tString oldTarget = entry.getTarget();\n+\t\t\t\tString newTarget = decorateTarget(oldTarget, decorations);\n \n-\t\t\tclient.setMenuEntries(menuEntries);\n+\t\t\t\tentry.setTarget(newTarget);\n+\t\t\t}\n \t\t}\n+\n+\t\tclient.setMenuEntries(menuEntries);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7e205ab9e3e0012be07061842b80747d02e7c6"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIwMDg2Ng==", "bodyText": "this is the constant MENU_ACTION_DEPRIORITIZE_OFFSET", "url": "https://github.com/runelite/runelite/pull/10875#discussion_r401200866", "createdAt": "2020-03-31T20:39:42Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "diffHunk": "@@ -94,58 +94,60 @@ protected void shutDown() throws Exception\n \t}\n \n \t@Subscribe\n-\tpublic void onMenuEntryAdded(MenuEntryAdded menuEntryAdded)\n+\tpublic void onClientTick(ClientTick clientTick)\n \t{\n-\t\tint type = menuEntryAdded.getType();\n+\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n \n-\t\tif (type >= 2000)\n+\t\tfor (MenuEntry entry : menuEntries)\n \t\t{\n-\t\t\ttype -= 2000;\n-\t\t}\n-\n-\t\tint identifier = menuEntryAdded.getIdentifier();\n-\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n-\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n-\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n-\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n-\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n-\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n-\t\t\t|| type == RUNELITE.getId())\n-\t\t{\n-\t\t\tPlayer[] players = client.getCachedPlayers();\n-\t\t\tPlayer player = null;\n+\t\t\tint type = entry.getType();\n \n-\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\tif (type >= 2000)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7e205ab9e3e0012be07061842b80747d02e7c6"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b85675f6240acee68877a0629fac9329a9937e95", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/b85675f6240acee68877a0629fac9329a9937e95", "committedDate": "2020-04-02T17:34:01Z", "message": "api: remove Follow and Trade menu actions\n\nThey are just the third and fourth player options but deprioritized by having 2000 added to them."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7171ee3867c25478b50ce3cda5bcf9d4f090ce9", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/e7171ee3867c25478b50ce3cda5bcf9d4f090ce9", "committedDate": "2020-04-02T17:34:01Z", "message": "player-indicators: break out decorating code into own methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f2753e0577142400abbfae6265970dd6ed39de", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/d4f2753e0577142400abbfae6265970dd6ed39de", "committedDate": "2020-04-02T17:34:36Z", "message": "player-indicators: move menu logic to ClientTick"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdb554e9a1bf42cdb18fc1fdb3edb13f7cb2b678", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/bdb554e9a1bf42cdb18fc1fdb3edb13f7cb2b678", "committedDate": "2020-04-02T17:34:37Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fc3247acff524530fe6c90424dd99e960f3a83e", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/9fc3247acff524530fe6c90424dd99e960f3a83e", "committedDate": "2020-03-18T23:31:39Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}, "afterCommit": {"oid": "bdb554e9a1bf42cdb18fc1fdb3edb13f7cb2b678", "author": {"user": {"login": "alexanderhenne", "name": "Alexander Henne"}}, "url": "https://github.com/runelite/runelite/commit/bdb554e9a1bf42cdb18fc1fdb3edb13f7cb2b678", "committedDate": "2020-04-02T17:34:37Z", "message": "player-indicators: highlight the 'Walk here' menu entry too"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4276, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}