{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MzY2NDYx", "number": 10985, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoxMzo1M1rODnkt7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjoxNzo0NVrODq_ePg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyODIyNjM3OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoxMzo1M1rOF1p4tA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoxMzo1M1rOF1p4tA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwNTEwOA==", "bodyText": "Since this is specific to the herbiboar, this should be named as such.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n          \n          \n            \n            \tprivate boolean processHerbiboarHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r391805108", "createdAt": "2020-03-12T18:13:53Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyODIzMzAyOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoxNTo1N1rOF1p8_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoxNTo1N1rOF1p8_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwNjIwNw==", "bodyText": "This would be cleaner as a guard clause.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)\n          \n          \n            \n            \t\t\tif (messageNode.getTimestamp() != timestamp || messageNode.getType() != ChatMessageType.SPAM)\n          \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t\tcontinue;\n          \n          \n            \n            \t\t\t}", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r391806207", "createdAt": "2020-03-12T18:15:57Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\t\tfor (Object messageObject : client.getMessages())\n+\t\t{\n+\t\t\tMessageNode messageNode = (MessageNode) messageObject;\n+\t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyODI0OTA3OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoyMDo0NVrOF1qHSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQwOTozMTozMFrOF2d2DQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwODg0Mg==", "bodyText": "As I understand from the code below, there are two possible chat messages which can appear:\n\nYou put the Grimy Guam leaf herb into your herb sack.\nYour herb sack is too full to hold the Grimy Guam leaf herb.\n\nWouldn't a pattern matching .+(Grimy .+) herb.+ match the herb name fully without any of the extra logic below? Also, the pattern matching/replacing should be replaced with a compiled Pattern object and a matcher on the messageNode string.", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r391808842", "createdAt": "2020-03-12T18:20:45Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\t\tfor (Object messageObject : client.getMessages())\n+\t\t{\n+\t\t\tMessageNode messageNode = (MessageNode) messageObject;\n+\t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)\n+\t\t\t{\n+\t\t\t\tString herbName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYzMTI4Mg==", "bodyText": "There is also another message when you manually add a herb to your sack which is:\n\nYou add the Grimy Guam leaf to your sack.\n\nBut I don't think its possible to manually add herbs in the same timestamp as harvesting Herbiboar.", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r392631282", "createdAt": "2020-03-15T00:48:07Z", "author": {"login": "deon9718"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\t\tfor (Object messageObject : client.getMessages())\n+\t\t{\n+\t\t\tMessageNode messageNode = (MessageNode) messageObject;\n+\t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)\n+\t\t\t{\n+\t\t\t\tString herbName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwODg0Mg=="}, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY1NjM5Nw==", "bodyText": "Pattern ended up being .+(Grimy .+?) herb.+", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r392656397", "createdAt": "2020-03-15T09:31:30Z", "author": {"login": "deon9718"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\t\tfor (Object messageObject : client.getMessages())\n+\t\t{\n+\t\t\tMessageNode messageNode = (MessageNode) messageObject;\n+\t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)\n+\t\t\t{\n+\t\t\t\tString herbName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgwODg0Mg=="}, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyODI1OTQ5OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoyMzo1NlrOF1qODQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxODoyMzo1NlrOF1qODQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTgxMDU3Mw==", "bodyText": "Since the if branch returns from this method, the rest of this code does not need to be in an else block. That is, this should be replaced by the following:\nif (herbs.isEmpty())\n{\n\treturn false;\n}\n\naddLoot(event, -1, lootRecordType, herbs);\nreturn true;", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r391810573", "createdAt": "2020-03-12T18:23:56Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +680,40 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbSackLoot(int timestamp, String event, LootRecordType lootRecordType)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\t\tfor (Object messageObject : client.getMessages())\n+\t\t{\n+\t\t\tMessageNode messageNode = (MessageNode) messageObject;\n+\t\t\tif (messageNode.getTimestamp() == timestamp && messageNode.getType() == ChatMessageType.SPAM)\n+\t\t\t{\n+\t\t\t\tString herbName;\n+\t\t\t\tif (messageNode.getValue().startsWith(\"You put the Grimy\"))\n+\t\t\t\t{\n+\t\t\t\t\therbName = messageNode.getValue().replace(\"You put the \", \"\").replace(\" herb into your herb sack.\", \"\");\n+\t\t\t\t\therbs.add(new ItemStack(itemManager.search(herbName).get(0).getId(), 1, client.getLocalPlayer().getLocalLocation()));\n+\t\t\t\t}\n+\t\t\t\t// Edge case for full herb sack for some of the looted herbs\n+\t\t\t\telse if (messageNode.getValue().startsWith(\"Your herb sack is too full to hold the Grimy\"))\n+\t\t\t\t{\n+\t\t\t\t\therbName = messageNode.getValue().replace(\"Your herb sack is too full to hold the \", \"\").replace(\" herb.\", \"\");\n+\t\t\t\t\therbs.add(new ItemStack(itemManager.search(herbName).get(0).getId(), 1, client.getLocalPlayer().getLocalLocation()));\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\n+\t\tif (herbs.isEmpty())\n+\t\t{\n+\t\t\treturn false;\n+\t\t}\n+\t\telse", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d275e65324b9720f273509b07b04cf27d76ec97d"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MzIyODM0OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowOToxM1rOF68_WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowOToxM1rOF68_WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDk4NA==", "bodyText": "I've made IterableHashTable generic now to make this less terrifying", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r397360984", "createdAt": "2020-03-24T18:09:13Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/loottracker/LootTrackerPlugin.java", "diffHunk": "@@ -677,6 +684,36 @@ private void processInventoryLoot(String event, LootRecordType lootRecordType, I\n \t\t}\n \t}\n \n+\tprivate boolean processHerbiboarHerbSackLoot(int timestamp)\n+\t{\n+\t\tList<ItemStack> herbs = new ArrayList<>();\n+\n+\t\tfor (Object messageObject : client.getMessages())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a703de462412237c4bcff55bf91169e99444a679"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NDA2NjczOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/test/java/net/runelite/client/plugins/loottracker/LootTrackerPluginTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjoxNzozNVrOF7FMxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjoxNzozNVrOF7FMxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQ5NTQ5NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tIterableHashTable messageTable = mock(IterableHashTable.class);\n          \n          \n            \n            \t\t\tIterator<Object> mockIterator = mock(Iterator.class);\n          \n          \n            \n            \t\t\tIterableHashTable<MessageNode> messageTable = mock(IterableHashTable.class);\n          \n          \n            \n            \t\t\tIterator<MessageNode> mockIterator = mock(Iterator.class);", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r397495494", "createdAt": "2020-03-24T22:17:35Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/loottracker/LootTrackerPluginTest.java", "diffHunk": "@@ -106,4 +158,90 @@ public void testFirstClue()\n \t\tassertEquals(\"Clue Scroll (Master)\", lootTrackerPlugin.eventType);\n \t\tassertEquals(LootRecordType.EVENT, lootTrackerPlugin.lootRecordType);\n \t}\n+\n+\t@Test\n+\tpublic void testHerbiboarHerbSack()\n+\t{\n+\t\tfor (Map.Entry<Integer, String> herb : HERB_IDS_TO_NAMES.entrySet())\n+\t\t{\n+\t\t\tfinal int id = herb.getKey();\n+\t\t\tfinal String name = herb.getValue();\n+\t\t\tfinal String herbMessage = String.format(\"You put the %s herb into your herb sack.\", name);\n+\t\t\tfinal String herbFullMessage = String.format(\"Your herb sack is too full to hold the %s herb.\", name);\n+\n+\t\t\tfinal ItemPrice herbPrice = new ItemPrice();\n+\t\t\therbPrice.setId(id);\n+\t\t\therbPrice.setName(name);\n+\t\t\twhen(itemManager.search(name)).thenReturn(Collections.singletonList(herbPrice));\n+\n+\t\t\tMessageNode node = mock(MessageNode.class);\n+\t\t\twhen(node.getTimestamp()).thenReturn(0);\n+\t\t\twhen(node.getType()).thenReturn(ChatMessageType.SPAM);\n+\t\t\twhen(node.getValue()).thenReturn(herbMessage);\n+\n+\t\t\tMessageNode nodeFull = mock(MessageNode.class);\n+\t\t\twhen(nodeFull.getTimestamp()).thenReturn(0);\n+\t\t\twhen(nodeFull.getType()).thenReturn(ChatMessageType.SPAM);\n+\t\t\twhen(nodeFull.getValue()).thenReturn(herbFullMessage);\n+\n+\t\t\tIterableHashTable messageTable = mock(IterableHashTable.class);\n+\t\t\tIterator<Object> mockIterator = mock(Iterator.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c377522ef97d53076ed301c64ec3ee5cd4a68b0c"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NDA2NzE4OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/test/java/net/runelite/client/plugins/loottracker/LootTrackerPluginTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjoxNzo0NVrOF7FNCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjoxNzo0NVrOF7FNCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQ5NTU2MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tIterableHashTable messageTable = mock(IterableHashTable.class);\n          \n          \n            \n            \t\tIterator<Object> mockIterator = mock(Iterator.class);\n          \n          \n            \n            \t\tIterableHashTable<MessageNode> messageTable = mock(IterableHashTable.class);\n          \n          \n            \n            \t\tIterator<MessageNode> mockIterator = mock(Iterator.class);", "url": "https://github.com/runelite/runelite/pull/10985#discussion_r397495561", "createdAt": "2020-03-24T22:17:45Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/loottracker/LootTrackerPluginTest.java", "diffHunk": "@@ -106,4 +158,90 @@ public void testFirstClue()\n \t\tassertEquals(\"Clue Scroll (Master)\", lootTrackerPlugin.eventType);\n \t\tassertEquals(LootRecordType.EVENT, lootTrackerPlugin.lootRecordType);\n \t}\n+\n+\t@Test\n+\tpublic void testHerbiboarHerbSack()\n+\t{\n+\t\tfor (Map.Entry<Integer, String> herb : HERB_IDS_TO_NAMES.entrySet())\n+\t\t{\n+\t\t\tfinal int id = herb.getKey();\n+\t\t\tfinal String name = herb.getValue();\n+\t\t\tfinal String herbMessage = String.format(\"You put the %s herb into your herb sack.\", name);\n+\t\t\tfinal String herbFullMessage = String.format(\"Your herb sack is too full to hold the %s herb.\", name);\n+\n+\t\t\tfinal ItemPrice herbPrice = new ItemPrice();\n+\t\t\therbPrice.setId(id);\n+\t\t\therbPrice.setName(name);\n+\t\t\twhen(itemManager.search(name)).thenReturn(Collections.singletonList(herbPrice));\n+\n+\t\t\tMessageNode node = mock(MessageNode.class);\n+\t\t\twhen(node.getTimestamp()).thenReturn(0);\n+\t\t\twhen(node.getType()).thenReturn(ChatMessageType.SPAM);\n+\t\t\twhen(node.getValue()).thenReturn(herbMessage);\n+\n+\t\t\tMessageNode nodeFull = mock(MessageNode.class);\n+\t\t\twhen(nodeFull.getTimestamp()).thenReturn(0);\n+\t\t\twhen(nodeFull.getType()).thenReturn(ChatMessageType.SPAM);\n+\t\t\twhen(nodeFull.getValue()).thenReturn(herbFullMessage);\n+\n+\t\t\tIterableHashTable messageTable = mock(IterableHashTable.class);\n+\t\t\tIterator<Object> mockIterator = mock(Iterator.class);\n+\t\t\twhen(mockIterator.hasNext()).thenReturn(true, true, false);\n+\t\t\twhen(mockIterator.next()).thenReturn(node).thenReturn(nodeFull);\n+\t\t\twhen(messageTable.iterator()).thenReturn(mockIterator);\n+\t\t\twhen(client.getMessages()).thenReturn(messageTable);\n+\n+\t\t\tLootTrackerPlugin lootTrackerPluginSpy = spy(this.lootTrackerPlugin);\n+\t\t\tArgumentCaptor<Collection<ItemStack>> collectionCaptor = ArgumentCaptor.forClass(Collection.class);\n+\t\t\tdoNothing().when(lootTrackerPluginSpy).addLoot(any(), anyInt(), any(), collectionCaptor.capture());\n+\n+\t\t\tChatMessage chatMessage = new ChatMessage(null, ChatMessageType.GAMEMESSAGE, \"\", LootTrackerPlugin.HERBIBOAR_LOOTED_MESSAGE, \"\", 0);\n+\t\t\tlootTrackerPluginSpy.onChatMessage(chatMessage);\n+\n+\t\t\tverify(lootTrackerPluginSpy, times(1)).addLoot(eq(\"Herbiboar\"), eq(-1), eq(LootRecordType.EVENT), collectionCaptor.capture());\n+\n+\t\t\tfor (ItemStack item : collectionCaptor.getValue())\n+\t\t\t{\n+\t\t\t\tassertEquals(id, item.getId());\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\t@Test\n+\tpublic void testHerbiboarPotionBug()\n+\t{\n+\t\tItemPrice herbPrice = new ItemPrice();\n+\t\therbPrice.setId(ItemID.GRIMY_GUAM_LEAF);\n+\t\therbPrice.setName(\"Grimy guam leaf\");\n+\t\twhen(itemManager.search(\"Grimy guam leaf\")).thenReturn(Collections.singletonList(herbPrice));\n+\n+\t\tMessageNode node = mock(MessageNode.class);\n+\t\twhen(node.getTimestamp()).thenReturn(0);\n+\t\twhen(node.getType()).thenReturn(ChatMessageType.SPAM);\n+\t\twhen(node.getValue()).thenReturn(\"You put the Grimy guam leaf herb into your herb sack.\");\n+\n+\t\tIterableHashTable messageTable = mock(IterableHashTable.class);\n+\t\tIterator<Object> mockIterator = mock(Iterator.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c377522ef97d53076ed301c64ec3ee5cd4a68b0c"}, "originalPosition": 159}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3706, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}