{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxNTg0MTQw", "number": 10908, "title": "Check player animation to update fishing status", "bodyText": "closes #10900\nIn render method, provide additional check to see if WidgetInfo.LEVEL_UP widget is loaded.\n\nThis solution works in all cases whereupon leveling up Fishing does NOT unlock new fish.\nIn the cases where you do unlock fish, there is a second dialogue describing which new fish you can catch. If you click through the level up dialogue, the fishing status will resolve to \"Fishing\" as if the second dialogue wasn't there. For other skills (Cooking, Mining) when you unlock something upon leveling up, a widget with groupId DIALOG_SPRITE_GROUP_ID, 193, is loaded, which would enable checking against presence of WidgetInfo.DIALOG_SPRITE to determine if player was in 'unlock new stuff' dialogue. However, when unlocking Fishing, the loaded groupId is 11, which is not assigned to anything in WidgetID.java, and a WidgetInfo.DIALOG_SPRITE widget is never present while leveling up Fishing.\nIf this solution isn't satisfactory, I can provide an additional check against the player's animationId versus an immutable set of all fishing animations, which would work, but it's just a little heavy-handed.\nBrandt", "createdAt": "2020-02-28T20:36:33Z", "url": "https://github.com/runelite/runelite/pull/10908", "merged": true, "mergeCommit": {"oid": "ca11d1926a6f00820640bc73564a555c56fc44df"}, "closed": true, "closedAt": "2020-03-31T19:58:37Z", "author": {"login": "BrandtHill"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI3YuuAFqTM2NjcxMzY3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNbbBbgFqTM3NDY5MDM3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzEzNjc4", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-366713678", "createdAt": "2020-02-28T22:06:06Z", "commit": {"oid": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMjowNjowNlrOFwEKuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMjowOToxMlrOFwEOtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NDI0OQ==", "bodyText": "This isn't a fishing animation", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385944249", "createdAt": "2020-02-28T22:06:06Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +57,23 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)\n+\t\t\t.add(AnimationID.FISHING_BIG_NET)\n+\t\t\t.add(AnimationID.FISHING_CAGE)\n+\t\t\t.add(AnimationID.FISHING_CRUSHING_INFERNAL_EELS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NDU1NA==", "bodyText": "This isn't a fishing animation", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385944554", "createdAt": "2020-02-28T22:07:07Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +57,23 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)\n+\t\t\t.add(AnimationID.FISHING_BIG_NET)\n+\t\t\t.add(AnimationID.FISHING_CAGE)\n+\t\t\t.add(AnimationID.FISHING_CRUSHING_INFERNAL_EELS)\n+\t\t\t.add(AnimationID.FISHING_CRYSTAL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_CUTTING_SACRED_EELS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NTI3MQ==", "bodyText": "I don't see a need to specifically check this case if we're adding an animation check.", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385945271", "createdAt": "2020-02-28T22:09:12Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -78,7 +98,9 @@ public Dimension render(Graphics2D graphics)\n \t\tpanelComponent.getChildren().clear();\n \t\tif (client.getLocalPlayer().getInteracting() != null\n \t\t\t&& client.getLocalPlayer().getInteracting().getName().contains(FISHING_SPOT)\n-\t\t\t&& client.getLocalPlayer().getInteracting().getGraphic() != GraphicID.FLYING_FISH)\n+\t\t\t&& client.getLocalPlayer().getInteracting().getGraphic() != GraphicID.FLYING_FISH\n+\t\t\t&& client.getWidget(WidgetInfo.LEVEL_UP) == null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzAxNTc1", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-367701575", "createdAt": "2020-03-03T04:52:32Z", "commit": {"oid": "0596cf9179ce5df4d1a3d1d1d46c3de7c5a3b297"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNzA3MDY3", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-370707067", "createdAt": "2020-03-07T01:10:09Z", "commit": {"oid": "0596cf9179ce5df4d1a3d1d1d46c3de7c5a3b297"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QwMToxMDowOVrOFzLjnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QwMToxMDowOVrOFzLjnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIxMTAzNg==", "bodyText": "This animation is uninterrupted, however a different animation plays when a player has caught a fish bare-handed, and that animation is missing here. (There are different animations for each type of fish caught)", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r389211036", "createdAt": "2020-03-07T01:10:09Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,21 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0596cf9179ce5df4d1a3d1d1d46c3de7c5a3b297"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwODExMzY4", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-370811368", "createdAt": "2020-03-08T07:57:26Z", "commit": {"oid": "d8ac428c591b81c7829df39297e92334e6c07780"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwNzo1NzoyN1rOFzTvYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwNzo1NzoyN1rOFzTvYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM0NTEyMg==", "bodyText": "These Barehanded caught animations (and maybe windup ones too) are specific to Tuna, so names are subject to change once we figure out what Shark/Swordfish ones are", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r389345122", "createdAt": "2020-03-08T07:57:27Z", "author": {"login": "BrandtHill"}, "path": "runelite-api/src/main/java/net/runelite/api/AnimationID.java", "diffHunk": "@@ -103,6 +103,10 @@\n \tpublic static final int FISHING_CRUSHING_INFERNAL_EELS = 7553;\n \tpublic static final int FISHING_CUTTING_SACRED_EELS = 7151;\n \tpublic static final int FISHING_BAREHAND = 6709;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_1 = 6703;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_2 = 6704;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8ac428c591b81c7829df39297e92334e6c07780"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjk0NzI4", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-373294728", "createdAt": "2020-03-12T05:57:33Z", "commit": {"oid": "d8ac428c591b81c7829df39297e92334e6c07780"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTo1NzozM1rOF1SEqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTo1NzozM1rOF1SEqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxNDk1Mg==", "bodyText": "These are not named correctly. Since these apply only to tuna, they should be named appropriately to reflect that.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_TUNA_1 = 6710;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_TUNA_2 = 6711;", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r391414952", "createdAt": "2020-03-12T05:57:33Z", "author": {"login": "Nightfirecat"}, "path": "runelite-api/src/main/java/net/runelite/api/AnimationID.java", "diffHunk": "@@ -103,6 +103,10 @@\n \tpublic static final int FISHING_CRUSHING_INFERNAL_EELS = 7553;\n \tpublic static final int FISHING_CUTTING_SACRED_EELS = 7151;\n \tpublic static final int FISHING_BAREHAND = 6709;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_1 = 6703;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_2 = 6704;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8ac428c591b81c7829df39297e92334e6c07780"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzEwMzM0", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-373310334", "createdAt": "2020-03-12T06:46:25Z", "commit": {"oid": "2c176dc54fe4987d02ffc1893467eea1e8487a96"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDI2NDE4", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-374426418", "createdAt": "2020-03-13T16:08:35Z", "commit": {"oid": "2c176dc54fe4987d02ffc1893467eea1e8487a96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNjowODozNVrOF2Jlrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNjowODozNVrOF2Jlrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNDUyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n          \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<>()", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392324526", "createdAt": "2020-03-13T16:08:35Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,29 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c176dc54fe4987d02ffc1893467eea1e8487a96"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjU4NjI1", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-374658625", "createdAt": "2020-03-13T22:52:03Z", "commit": {"oid": "d731ae6a823745ce7617fe863176aa82334193b2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMjo1MjowNFrOF2Vd2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMjo1MjowNFrOF2Vd2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxOTEyOQ==", "bodyText": "This field can be made static, be defined as a Set (or even a Collection since we're not calling any set-specific methods of it), and renamed to match the constant naming schema:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = ImmutableSet.of(\n          \n          \n            \n            \tprivate static final Set<Integer> FISHING_ANIMATIONS = ImmutableSet.of(", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392519129", "createdAt": "2020-03-13T22:52:04Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,28 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = ImmutableSet.of(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d731ae6a823745ce7617fe863176aa82334193b2"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d731ae6a823745ce7617fe863176aa82334193b2", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/d731ae6a823745ce7617fe863176aa82334193b2", "committedDate": "2020-03-13T17:13:20Z", "message": "Use ImmutableSet::of instead of builder for type inference and beauty"}, "afterCommit": {"oid": "266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "committedDate": "2020-03-14T02:15:40Z", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb098792053145a2e44410b2c60475799d493890", "author": {"user": {"login": "BrandtHill", "name": null}}, "url": "https://github.com/runelite/runelite/commit/eb098792053145a2e44410b2c60475799d493890", "committedDate": "2020-03-14T02:21:18Z", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "committedDate": "2020-03-14T02:15:40Z", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900"}, "afterCommit": {"oid": "eb098792053145a2e44410b2c60475799d493890", "author": {"user": {"login": "BrandtHill", "name": null}}, "url": "https://github.com/runelite/runelite/commit/eb098792053145a2e44410b2c60475799d493890", "committedDate": "2020-03-14T02:21:18Z", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjkwMzc4", "url": "https://github.com/runelite/runelite/pull/10908#pullrequestreview-374690378", "createdAt": "2020-03-14T02:24:03Z", "commit": {"oid": "eb098792053145a2e44410b2c60475799d493890"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4307, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}