{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NDI1NTAx", "number": 12434, "title": "Feature: Pet list chat command", "bodyText": "Close #12385\nDemo\nhttps://gyazo.com/21156d618a83813a7583377010efca33\n\n\ninvoke !pets without any pets, followed by\n\n\ninvoking !pets after checking the All Pets tab in the Collection Log", "createdAt": "2020-09-02T00:19:08Z", "url": "https://github.com/runelite/runelite/pull/12434", "merged": true, "mergeCommit": {"oid": "21a7bf49064a2d6abdd4a1fe74dea0f5b4e1336c"}, "closed": true, "closedAt": "2021-07-17T14:15:11Z", "author": {"login": "IllyaMyshakov"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFs-RlAFqTQ4Mjk5NTM0Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABerGbVSgBqjUwMzMxNTQ4Mzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTk1MzQ2", "url": "https://github.com/runelite/runelite/pull/12434#pullrequestreview-482995346", "createdAt": "2020-09-04T22:30:42Z", "commit": {"oid": "af350b0ee410a296179b4da792b7ea374506b11d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "559c915bd2fb26334941ea075fbe5114d40faf9a", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/559c915bd2fb26334941ea075fbe5114d40faf9a", "committedDate": "2021-01-03T03:26:51Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "5ff1936cb18d9972ace58186bcead8b7020acf90", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/5ff1936cb18d9972ace58186bcead8b7020acf90", "committedDate": "2021-01-03T04:00:18Z", "message": "Initial commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2MDAwMTk1", "url": "https://github.com/runelite/runelite/pull/12434#pullrequestreview-566000195", "createdAt": "2021-01-12T07:34:51Z", "commit": {"oid": "5ff1936cb18d9972ace58186bcead8b7020acf90"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4a7699970fab6e2f6f4e684d2a7ce54a1f795ea", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/f4a7699970fab6e2f6f4e684d2a7ce54a1f795ea", "committedDate": "2021-01-13T01:36:09Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "d08eb3e659f86e3c256613a5a3953502c6253136", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/d08eb3e659f86e3c256613a5a3953502c6253136", "committedDate": "2021-01-13T01:48:30Z", "message": "Implement !pets chat command"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d56fdb041d1d21b2fe3df858a3ac0ac789bc1071", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/d56fdb041d1d21b2fe3df858a3ac0ac789bc1071", "committedDate": "2021-01-16T02:35:00Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "261ca652f65677020a7fb56796ca44cfbeb5a03d", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/261ca652f65677020a7fb56796ca44cfbeb5a03d", "committedDate": "2021-01-16T02:30:07Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "261ca652f65677020a7fb56796ca44cfbeb5a03d", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/261ca652f65677020a7fb56796ca44cfbeb5a03d", "committedDate": "2021-01-16T02:30:07Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "d71e5bed0a775e91e9d5fa3e62f7309d3ece1afb", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/d71e5bed0a775e91e9d5fa3e62f7309d3ece1afb", "committedDate": "2021-01-16T02:57:47Z", "message": "Implement !pets chat command"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4186b369b5a986d8c37e1f45fadef345985c2560", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/4186b369b5a986d8c37e1f45fadef345985c2560", "committedDate": "2021-01-16T03:34:26Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "2c719eef812b0844d2cb5c531f4705ccf6cc6c76", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/2c719eef812b0844d2cb5c531f4705ccf6cc6c76", "committedDate": "2021-05-04T15:19:57Z", "message": "!pets - Resurrect PR"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "223121ece4145c486c3abbdd50a77f49b222b152", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/223121ece4145c486c3abbdd50a77f49b222b152", "committedDate": "2021-05-07T00:45:04Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "ca75c67cca1d0bbf3605e7b7d5f24a6212b7e77e", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/ca75c67cca1d0bbf3605e7b7d5f24a6212b7e77e", "committedDate": "2021-05-07T01:21:34Z", "message": "!pets - Remove unnecessary stubbings"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7612c01ccc2d34f06b04c3bb10640dc19f843f99", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/7612c01ccc2d34f06b04c3bb10640dc19f843f99", "committedDate": "2021-05-07T01:26:41Z", "message": "!pets - small nit"}, "afterCommit": {"oid": "0f2318283166d53b3c5d6a87260f02f8f9ecbb4d", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/0f2318283166d53b3c5d6a87260f02f8f9ecbb4d", "committedDate": "2021-05-07T01:42:53Z", "message": "!pets - Add CI tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f2318283166d53b3c5d6a87260f02f8f9ecbb4d", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/0f2318283166d53b3c5d6a87260f02f8f9ecbb4d", "committedDate": "2021-05-07T01:42:53Z", "message": "!pets - Add CI tests"}, "afterCommit": {"oid": "9f0662e933b5a76928911139a0c97a0ae75b88ae", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/9f0662e933b5a76928911139a0c97a0ae75b88ae", "committedDate": "2021-05-07T02:28:45Z", "message": "!pets - Add CI tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f0662e933b5a76928911139a0c97a0ae75b88ae", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/9f0662e933b5a76928911139a0c97a0ae75b88ae", "committedDate": "2021-05-07T02:28:45Z", "message": "!pets - Add CI tests"}, "afterCommit": {"oid": "c3edcfc988f977562b7890d378eeab242582228c", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/c3edcfc988f977562b7890d378eeab242582228c", "committedDate": "2021-05-07T02:36:21Z", "message": "!pets - Add CI tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3edcfc988f977562b7890d378eeab242582228c", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/c3edcfc988f977562b7890d378eeab242582228c", "committedDate": "2021-05-07T02:36:21Z", "message": "!pets - Add CI tests"}, "afterCommit": {"oid": "30d4283405a31b11b1352f37a0dba4e3ab7d0845", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/30d4283405a31b11b1352f37a0dba4e3ab7d0845", "committedDate": "2021-05-07T11:24:57Z", "message": "!pets - Add CI tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30d4283405a31b11b1352f37a0dba4e3ab7d0845", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/30d4283405a31b11b1352f37a0dba4e3ab7d0845", "committedDate": "2021-05-07T11:24:57Z", "message": "!pets - Add CI tests"}, "afterCommit": {"oid": "0502014ea124fc8c95d3e4701a8b4a881032b38b", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/0502014ea124fc8c95d3e4701a8b4a881032b38b", "committedDate": "2021-05-07T14:31:06Z", "message": "!pets - Add CI tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d56c58274a749c52c9e8f6b1df315dc8df27e43", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/6d56c58274a749c52c9e8f6b1df315dc8df27e43", "committedDate": "2021-05-07T14:48:18Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/faecfaac743be4027018dcdc3abf3ca87dac31ed", "committedDate": "2021-05-07T14:56:30Z", "message": "!pets - Add CI tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjU0OTUxNjQz", "url": "https://github.com/runelite/runelite/pull/12434#pullrequestreview-654951643", "createdAt": "2021-05-08T03:10:23Z", "commit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0wOFQwMzoxMDoyM1rOJXkLvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0wOFQwMzoyMToyOVrOJXkQWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY4OTg1Mg==", "bodyText": "This would probably be better represented just by having a Pet enum with a (name, item) constructor. Then you can just use Pet.values() to get a Pet[]", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628689852", "createdAt": "2021-05-08T03:10:23Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/resources/net/runelite/client/plugins/chatcommands/pets.json", "diffHunk": "@@ -0,0 +1,194 @@\n+[\n+  {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY4OTg2Mw==", "bodyText": "missing break;", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628689863", "createdAt": "2021-05-08T03:10:33Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -562,6 +701,9 @@ public void onGameStateChanged(GameStateChanged event)\n \t\t\tcase LOADING:\n \t\t\tcase HOPPING:\n \t\t\t\tpohOwner = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 239}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDA0MA==", "bodyText": "It's possible to look at someone else's collection log in their poh, so this should check that similar to how the boss log checks it.", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690040", "createdAt": "2021-05-08T03:11:59Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -469,6 +585,26 @@ public void onGameTick(GameTick event)\n \t\t\t}\n \t\t}\n \n+\t\tif (collectionLogLoaded)\n+\t\t{\n+\t\t\tWidget collectionLogEntryHeader = client.getWidget(WidgetInfo.COLLECTION_LOG_ENTRY_HEADER);\n+\t\t\tif (collectionLogEntryHeader != null && collectionLogEntryHeader.getChildren() != null)\n+\t\t\t{\n+\t\t\t\tWidget entryTitle = collectionLogEntryHeader.getChild(COL_LOG_ENTRY_HEADER_TITLE_INDEX);\n+\t\t\t\t// Make sure that the player is looking in the All Pets tab of the collection log\n+\t\t\t\tif (entryTitle.getText().equals(\"All Pets\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 210}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDE5Mg==", "bodyText": "Typically we inject Gson into the plugin, since is provided by the injector.", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690192", "createdAt": "2021-05-08T03:13:12Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -262,6 +285,99 @@ private double getPb(String boss)\n \t\treturn personalBest == null ? 0 : personalBest;\n \t}\n \n+\tprivate void loadPetIcons()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (modIconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tfinal Pet[] pets = getPets();\n+\t\tfinal IndexedSprite[] newModIcons = Arrays.copyOf(modIcons, modIcons.length + pets.length);\n+\t\tmodIconIdx = modIcons.length;\n+\n+\t\tfor (int i = 0; i < pets.length; i++)\n+\t\t{\n+\t\t\tfinal Pet pet = pets[i];\n+\n+\t\t\ttry\n+\t\t\t{\n+\t\t\t\tfinal BufferedImage image = ImageUtil.resizeImage(itemManager.getImage(pet.getIcon()), 18, 16);\n+\t\t\t\tfinal IndexedSprite sprite = ImageUtil.getImageIndexedSprite(image, client);\n+\t\t\t\tnewModIcons[modIconIdx + i] = sprite;\n+\t\t\t}\n+\t\t\tcatch (Exception ex)\n+\t\t\t{\n+\t\t\t\tlog.warn(\"Failed to load the sprite for \" + pet.getName(), ex);\n+\t\t\t}\n+\t\t}\n+\n+\t\tlog.debug(\"Adding pet icons\");\n+\t\tclient.setModIcons(newModIcons);\n+\t}\n+\n+\t/**\n+\t * Sets the list of owned pets in local storage for the local player.\n+\t *\n+\t * @param totalPetList The widget containing the list of owned pets for the local player\n+\t */\n+\tprivate void setPetList(Widget[] totalPetList)\n+\t{\n+\t\tif (totalPetList == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tList<Pet> petList = new ArrayList<>();\n+\t\tfor (Widget child : totalPetList)\n+\t\t{\n+\t\t\tif (child.getOpacity() == 0)\n+\t\t\t{\n+\t\t\t\tPet pet = new Pet(\n+\t\t\t\t\tchild.getName().replace(\"<col=ff9040>\", \"\").replace(\"</col>\", \"\"),\n+\t\t\t\t\tchild.getItemId());\n+\t\t\t\tpetList.add(pet);\n+\t\t\t}\n+\t\t}\n+\n+\t\tconfigManager.setRSProfileConfiguration(\"pets\", client.getUsername().toLowerCase(),\n+\t\t\tRuneLiteAPI.GSON.toJson(petList.toArray(new Pet[0])));\n+\t}\n+\n+\t/**\n+\t * Looks up the list of owned pets in local storage for the local player\n+\t */\n+\tprivate Pet[] getPetList()\n+\t{\n+\t\tString petListJson = configManager.getRSProfileConfiguration(\"pets\",\n+\t\t\tclient.getUsername().toLowerCase(), String.class);\n+\n+\t\tPet[] petList = RuneLiteAPI.GSON.fromJson(petListJson, Pet[].class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 170}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDM2Mg==", "bodyText": "RSProfileConfiguration is already per RS-profile, so it is not necessary to set the key to the client username. I would probably just use chatcommands as the group and pets as the key.", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690362", "createdAt": "2021-05-08T03:14:35Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -262,6 +285,99 @@ private double getPb(String boss)\n \t\treturn personalBest == null ? 0 : personalBest;\n \t}\n \n+\tprivate void loadPetIcons()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (modIconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tfinal Pet[] pets = getPets();\n+\t\tfinal IndexedSprite[] newModIcons = Arrays.copyOf(modIcons, modIcons.length + pets.length);\n+\t\tmodIconIdx = modIcons.length;\n+\n+\t\tfor (int i = 0; i < pets.length; i++)\n+\t\t{\n+\t\t\tfinal Pet pet = pets[i];\n+\n+\t\t\ttry\n+\t\t\t{\n+\t\t\t\tfinal BufferedImage image = ImageUtil.resizeImage(itemManager.getImage(pet.getIcon()), 18, 16);\n+\t\t\t\tfinal IndexedSprite sprite = ImageUtil.getImageIndexedSprite(image, client);\n+\t\t\t\tnewModIcons[modIconIdx + i] = sprite;\n+\t\t\t}\n+\t\t\tcatch (Exception ex)\n+\t\t\t{\n+\t\t\t\tlog.warn(\"Failed to load the sprite for \" + pet.getName(), ex);\n+\t\t\t}\n+\t\t}\n+\n+\t\tlog.debug(\"Adding pet icons\");\n+\t\tclient.setModIcons(newModIcons);\n+\t}\n+\n+\t/**\n+\t * Sets the list of owned pets in local storage for the local player.\n+\t *\n+\t * @param totalPetList The widget containing the list of owned pets for the local player\n+\t */\n+\tprivate void setPetList(Widget[] totalPetList)\n+\t{\n+\t\tif (totalPetList == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tList<Pet> petList = new ArrayList<>();\n+\t\tfor (Widget child : totalPetList)\n+\t\t{\n+\t\t\tif (child.getOpacity() == 0)\n+\t\t\t{\n+\t\t\t\tPet pet = new Pet(\n+\t\t\t\t\tchild.getName().replace(\"<col=ff9040>\", \"\").replace(\"</col>\", \"\"),\n+\t\t\t\t\tchild.getItemId());\n+\t\t\t\tpetList.add(pet);\n+\t\t\t}\n+\t\t}\n+\n+\t\tconfigManager.setRSProfileConfiguration(\"pets\", client.getUsername().toLowerCase(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 158}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDQwOQ==", "bodyText": "see Text.removeTags", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690409", "createdAt": "2021-05-08T03:14:57Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -262,6 +285,99 @@ private double getPb(String boss)\n \t\treturn personalBest == null ? 0 : personalBest;\n \t}\n \n+\tprivate void loadPetIcons()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (modIconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tfinal Pet[] pets = getPets();\n+\t\tfinal IndexedSprite[] newModIcons = Arrays.copyOf(modIcons, modIcons.length + pets.length);\n+\t\tmodIconIdx = modIcons.length;\n+\n+\t\tfor (int i = 0; i < pets.length; i++)\n+\t\t{\n+\t\t\tfinal Pet pet = pets[i];\n+\n+\t\t\ttry\n+\t\t\t{\n+\t\t\t\tfinal BufferedImage image = ImageUtil.resizeImage(itemManager.getImage(pet.getIcon()), 18, 16);\n+\t\t\t\tfinal IndexedSprite sprite = ImageUtil.getImageIndexedSprite(image, client);\n+\t\t\t\tnewModIcons[modIconIdx + i] = sprite;\n+\t\t\t}\n+\t\t\tcatch (Exception ex)\n+\t\t\t{\n+\t\t\t\tlog.warn(\"Failed to load the sprite for \" + pet.getName(), ex);\n+\t\t\t}\n+\t\t}\n+\n+\t\tlog.debug(\"Adding pet icons\");\n+\t\tclient.setModIcons(newModIcons);\n+\t}\n+\n+\t/**\n+\t * Sets the list of owned pets in local storage for the local player.\n+\t *\n+\t * @param totalPetList The widget containing the list of owned pets for the local player\n+\t */\n+\tprivate void setPetList(Widget[] totalPetList)\n+\t{\n+\t\tif (totalPetList == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tList<Pet> petList = new ArrayList<>();\n+\t\tfor (Widget child : totalPetList)\n+\t\t{\n+\t\t\tif (child.getOpacity() == 0)\n+\t\t\t{\n+\t\t\t\tPet pet = new Pet(\n+\t\t\t\t\tchild.getName().replace(\"<col=ff9040>\", \"\").replace(\"</col>\", \"\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDU2OA==", "bodyText": "What is this for? Does anything here throw?", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690568", "createdAt": "2021-05-08T03:16:02Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -262,6 +285,99 @@ private double getPb(String boss)\n \t\treturn personalBest == null ? 0 : personalBest;\n \t}\n \n+\tprivate void loadPetIcons()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (modIconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tfinal Pet[] pets = getPets();\n+\t\tfinal IndexedSprite[] newModIcons = Arrays.copyOf(modIcons, modIcons.length + pets.length);\n+\t\tmodIconIdx = modIcons.length;\n+\n+\t\tfor (int i = 0; i < pets.length; i++)\n+\t\t{\n+\t\t\tfinal Pet pet = pets[i];\n+\n+\t\t\ttry\n+\t\t\t{\n+\t\t\t\tfinal BufferedImage image = ImageUtil.resizeImage(itemManager.getImage(pet.getIcon()), 18, 16);\n+\t\t\t\tfinal IndexedSprite sprite = ImageUtil.getImageIndexedSprite(image, client);\n+\t\t\t\tnewModIcons[modIconIdx + i] = sprite;\n+\t\t\t}\n+\t\t\tcatch (Exception ex)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 124}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDY0MQ==", "bodyText": "See @Data", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628690641", "createdAt": "2021-05-08T03:16:38Z", "author": {"login": "Adam-"}, "path": "http-api/src/main/java/net/runelite/http/api/chat/Pet.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright (c) 2021, Illya Myshakov <https://github.com/IllyaMyshakov>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this\n+ *    list of conditions and the following disclaimer.\n+ * 2. Redistributions in binary form must reproduce the above copyright notice,\n+ *    this list of conditions and the following disclaimer in the documentation\n+ *    and/or other materials provided with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package net.runelite.http.api.chat;\n+\n+import java.util.Objects;\n+import lombok.Getter;\n+\n+@Getter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MTAzMw==", "bodyText": "Classes are placed in http-api if they are used in both runelite-client and http-service as part of the client <-> service communication, as its classpath is available in both modules. However, you are not using this in http-service, which means this class is in the wrong place.", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628691033", "createdAt": "2021-05-08T03:21:29Z", "author": {"login": "Adam-"}, "path": "http-api/src/main/java/net/runelite/http/api/chat/Pet.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright (c) 2021, Illya Myshakov <https://github.com/IllyaMyshakov>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this\n+ *    list of conditions and the following disclaimer.\n+ * 2. Redistributions in binary form must reproduce the above copyright notice,\n+ *    this list of conditions and the following disclaimer in the documentation\n+ *    and/or other materials provided with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package net.runelite.http.api.chat;\n+\n+import java.util.Objects;\n+import lombok.Getter;\n+\n+@Getter\n+public class Pet", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0d83e0606c7b97397604754b4db68531bacb3269", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/0d83e0606c7b97397604754b4db68531bacb3269", "committedDate": "2021-05-09T01:32:09Z", "message": "!pets - Address nits"}, "afterCommit": {"oid": "95b04cbbec0ef05d6ef9ba683315a01f36b17f6d", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/95b04cbbec0ef05d6ef9ba683315a01f36b17f6d", "committedDate": "2021-05-09T01:38:31Z", "message": "!pets - Address nits"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3433578012a6917d903ef6d5b22b296ec7fa70b4", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/3433578012a6917d903ef6d5b22b296ec7fa70b4", "committedDate": "2021-05-09T01:46:08Z", "message": "!pets - Fix CI"}, "afterCommit": {"oid": "ddc01f20423b4c92d86b72cb2af228a7e9addc29", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/ddc01f20423b4c92d86b72cb2af228a7e9addc29", "committedDate": "2021-05-09T01:55:51Z", "message": "!pets - Add CI tests, and address nits"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjU1MDI0MjUw", "url": "https://github.com/runelite/runelite/pull/12434#pullrequestreview-655024250", "createdAt": "2021-05-08T21:48:53Z", "commit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0wOFQyMTo0ODo1M1rOJXq7ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0wOFQyMTo0ODo1M1rOJXq7ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODgwMDM1Ng==", "bodyText": "As this was pulled directly from how the Emoji plugin works, the try catch was originally for if loading one of the png files failed. Good catch, will remove", "url": "https://github.com/runelite/runelite/pull/12434#discussion_r628800356", "createdAt": "2021-05-08T21:48:53Z", "author": {"login": "IllyaMyshakov"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chatcommands/ChatCommandsPlugin.java", "diffHunk": "@@ -262,6 +285,99 @@ private double getPb(String boss)\n \t\treturn personalBest == null ? 0 : personalBest;\n \t}\n \n+\tprivate void loadPetIcons()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (modIconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tfinal Pet[] pets = getPets();\n+\t\tfinal IndexedSprite[] newModIcons = Arrays.copyOf(modIcons, modIcons.length + pets.length);\n+\t\tmodIconIdx = modIcons.length;\n+\n+\t\tfor (int i = 0; i < pets.length; i++)\n+\t\t{\n+\t\t\tfinal Pet pet = pets[i];\n+\n+\t\t\ttry\n+\t\t\t{\n+\t\t\t\tfinal BufferedImage image = ImageUtil.resizeImage(itemManager.getImage(pet.getIcon()), 18, 16);\n+\t\t\t\tfinal IndexedSprite sprite = ImageUtil.getImageIndexedSprite(image, client);\n+\t\t\t\tnewModIcons[modIconIdx + i] = sprite;\n+\t\t\t}\n+\t\t\tcatch (Exception ex)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODY5MDU2OA=="}, "originalCommit": {"oid": "faecfaac743be4027018dcdc3abf3ca87dac31ed"}, "originalPosition": 124}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "551f5b198802c8312685114044e622e64657273f", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/551f5b198802c8312685114044e622e64657273f", "committedDate": "2021-05-10T23:41:09Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "9c1433da2cb370541df1ee5ef0cbc3f48ae1e351", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/9c1433da2cb370541df1ee5ef0cbc3f48ae1e351", "committedDate": "2021-05-10T23:40:41Z", "message": "!pets - Add pet list update logic"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "97e9729e988237333761b9975c9f340337c9d265", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/97e9729e988237333761b9975c9f340337c9d265", "committedDate": "2021-05-12T01:10:58Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "8a5c0ef300b56bbd9c582dbe7dc58da600d3b0e9", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/8a5c0ef300b56bbd9c582dbe7dc58da600d3b0e9", "committedDate": "2021-05-12T01:18:25Z", "message": "!pets - Move Pet class back into plugin"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a5c0ef300b56bbd9c582dbe7dc58da600d3b0e9", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/8a5c0ef300b56bbd9c582dbe7dc58da600d3b0e9", "committedDate": "2021-05-12T01:18:25Z", "message": "!pets - Move Pet class back into plugin"}, "afterCommit": {"oid": "9e8831150fda10da0c8bb6ff5d8738ddba44e37c", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/9e8831150fda10da0c8bb6ff5d8738ddba44e37c", "committedDate": "2021-05-12T01:27:53Z", "message": "!pets - Move Pet class back into plugin"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff70626eb124a20757bd2e855f548552cf9aa819", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/ff70626eb124a20757bd2e855f548552cf9aa819", "committedDate": "2021-05-12T01:35:52Z", "message": "Merge branch 'pet-count-cmd' of github.com:IllyaMyshakov/runelite into pet-count-cmd"}, "afterCommit": {"oid": "ca67b01041c3127e0c97f63021d8e348848ed922", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/ca67b01041c3127e0c97f63021d8e348848ed922", "committedDate": "2021-07-16T21:11:42Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca67b01041c3127e0c97f63021d8e348848ed922", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/ca67b01041c3127e0c97f63021d8e348848ed922", "committedDate": "2021-07-16T21:11:42Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}, "afterCommit": {"oid": "407eb8e49509470038b985da1b4410f337a94e72", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/407eb8e49509470038b985da1b4410f337a94e72", "committedDate": "2021-07-16T22:00:10Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39a9f62671024262bc1a9160add3b8b1dccc33fd", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/39a9f62671024262bc1a9160add3b8b1dccc33fd", "committedDate": "2021-07-16T23:16:11Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "407eb8e49509470038b985da1b4410f337a94e72", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/407eb8e49509470038b985da1b4410f337a94e72", "committedDate": "2021-07-16T22:00:10Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}, "afterCommit": {"oid": "39a9f62671024262bc1a9160add3b8b1dccc33fd", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/39a9f62671024262bc1a9160add3b8b1dccc33fd", "committedDate": "2021-07-16T23:16:11Z", "message": "chat commands: add pets command\n\nCo-authored-by: Illya Myshakov <imyshako@uwaterloo.ca>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3363, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}