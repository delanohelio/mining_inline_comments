{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NzA1MzY4", "number": 11580, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMjo1ODowNVrOD9Dnbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxNTo1ODowOFrOEBH2hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzQ4OTc1OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMjo1ODowNVrOGWXwYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMjo1ODowNVrOGWXwYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExMTA3Mg==", "bodyText": "This is only package-private so it can be tested, so it should be marked as such.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tString parseQuestCompletedWidget()\n          \n          \n            \n            \t@VisibleForTesting\n          \n          \n            \n            \tString parseQuestCompletedWidget()", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426111072", "createdAt": "2020-05-16T02:58:05Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,56 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\tString parseQuestCompletedWidget()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzUxMjI4OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/test/java/net/runelite/client/plugins/screenshot/ScreenshotPluginTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MTowOFrOGWX70A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MTowOFrOGWX70A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExNDAwMA==", "bodyText": "All of this code is basically only testing parseQuestCompletedWidget() != null in the context of the calling code, so it can be removed.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \t\tWidgetLoaded event = new WidgetLoaded();\n          \n          \n            \n            \t\tevent.setGroupId(QUEST_COMPLETED_GROUP_ID);\n          \n          \n            \n            \t\tscreenshotPlugin.onWidgetLoaded(event);\n          \n          \n            \n            \n          \n          \n            \n            \t\tGameTick tick = new GameTick();\n          \n          \n            \n            \t\tscreenshotPlugin.onGameTick(tick);\n          \n          \n            \n            \n          \n          \n            \n            \t\tverify(drawManager).requestNextFrameListener(any(Consumer.class));", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426114000", "createdAt": "2020-05-16T03:41:08Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/screenshot/ScreenshotPluginTest.java", "diffHunk": "@@ -245,4 +248,144 @@ public void testHunterLevel2()\n \n \t\tverify(drawManager).requestNextFrameListener(any(Consumer.class));\n \t}\n+\n+\t@Test\n+\tpublic void testTheCorsairCurseQuestComplete()\n+\t{\n+\t\tWidget questChild = mock(Widget.class);\n+\t\twhen(client.getWidget(eq(QUEST_COMPLETED_NAME_TEXT))).thenReturn(questChild);\n+\n+\t\twhen(questChild.getText()).thenReturn(\"You have completed The Corsair Curse!\");\n+\n+\t\tassertEquals(\"Quest(The Corsair Curse)\", screenshotPlugin.parseQuestCompletedWidget());\n+\n+\t\tWidgetLoaded event = new WidgetLoaded();\n+\t\tevent.setGroupId(QUEST_COMPLETED_GROUP_ID);\n+\t\tscreenshotPlugin.onWidgetLoaded(event);\n+\n+\t\tGameTick tick = new GameTick();\n+\t\tscreenshotPlugin.onGameTick(tick);\n+\n+\t\tverify(drawManager).requestNextFrameListener(any(Consumer.class));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzUxMjUzOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MTo0MlrOGWX78A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MTo0MlrOGWX78A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExNDAzMg==", "bodyText": "Write a test for this code path.", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426114032", "createdAt": "2020-05-16T03:41:42Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,56 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\tString parseQuestCompletedWidget()\n+\t{\n+\t\tWidget questChild = client.getWidget(WidgetInfo.QUEST_COMPLETED_NAME_TEXT);\n+\t\tif (questChild == null)\n+\t\t{\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\tString text = questChild.getText();\n+\t\t// \"You have completed The Corsair Curse!\"\n+\t\tMatcher quest_match_1 = QUEST_PATTERN_1.matcher(text);\n+\t\t// \"'One Small Favour' completed!\"\n+\t\tMatcher quest_match_2 = QUEST_PATTERN_2.matcher(text);\n+\t\tMatcher quest_match_final = quest_match_1.matches() ? quest_match_1 : quest_match_2;\n+\t\tif (!quest_match_final.matches())\n+\t\t{\n+\t\t\treturn \"Quest(quest not found)\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzUxMzAxOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MjoyNVrOGWX8Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MjoyNVrOGWX8Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExNDA5MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tquest = quest + \" partial completion\";\n          \n          \n            \n            \t\t\tquest += \" partial completion\";", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426114091", "createdAt": "2020-05-16T03:42:25Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,56 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\tString parseQuestCompletedWidget()\n+\t{\n+\t\tWidget questChild = client.getWidget(WidgetInfo.QUEST_COMPLETED_NAME_TEXT);\n+\t\tif (questChild == null)\n+\t\t{\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\tString text = questChild.getText();\n+\t\t// \"You have completed The Corsair Curse!\"\n+\t\tMatcher quest_match_1 = QUEST_PATTERN_1.matcher(text);\n+\t\t// \"'One Small Favour' completed!\"\n+\t\tMatcher quest_match_2 = QUEST_PATTERN_2.matcher(text);\n+\t\tMatcher quest_match_final = quest_match_1.matches() ? quest_match_1 : quest_match_2;\n+\t\tif (!quest_match_final.matches())\n+\t\t{\n+\t\t\treturn \"Quest(quest not found)\";\n+\t\t}\n+\n+\t\tString quest = quest_match_final.group(\"quest\");\n+\t\tString verb = quest_match_final.group(\"verb\") != null ? quest_match_final.group(\"verb\") : \"\";\n+\n+\t\tif (verb.contains(\"kind of\"))\n+\t\t{\n+\t\t\tquest = quest + \" partial completion\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzUxMzEzOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MjozM1rOGWX8OA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0MjozM1rOGWX8OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExNDEwNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tquest = quest + \" II\";\n          \n          \n            \n            \t\t\tquest += \" II\";", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426114104", "createdAt": "2020-05-16T03:42:33Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,56 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\tString parseQuestCompletedWidget()\n+\t{\n+\t\tWidget questChild = client.getWidget(WidgetInfo.QUEST_COMPLETED_NAME_TEXT);\n+\t\tif (questChild == null)\n+\t\t{\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\tString text = questChild.getText();\n+\t\t// \"You have completed The Corsair Curse!\"\n+\t\tMatcher quest_match_1 = QUEST_PATTERN_1.matcher(text);\n+\t\t// \"'One Small Favour' completed!\"\n+\t\tMatcher quest_match_2 = QUEST_PATTERN_2.matcher(text);\n+\t\tMatcher quest_match_final = quest_match_1.matches() ? quest_match_1 : quest_match_2;\n+\t\tif (!quest_match_final.matches())\n+\t\t{\n+\t\t\treturn \"Quest(quest not found)\";\n+\t\t}\n+\n+\t\tString quest = quest_match_final.group(\"quest\");\n+\t\tString verb = quest_match_final.group(\"verb\") != null ? quest_match_final.group(\"verb\") : \"\";\n+\n+\t\tif (verb.contains(\"kind of\"))\n+\t\t{\n+\t\t\tquest = quest + \" partial completion\";\n+\t\t}\n+\t\telse if (verb.contains(\"completely\"))\n+\t\t{\n+\t\t\tquest = quest + \" II\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzUxMzM2OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0Mjo0NVrOGWX8UQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMzo0Mjo0NVrOGWX8UQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExNDEyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tquest = quest + \" Quest\";\n          \n          \n            \n            \t\t\tquest += \" Quest\";", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r426114129", "createdAt": "2020-05-16T03:42:45Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,56 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\tString parseQuestCompletedWidget()\n+\t{\n+\t\tWidget questChild = client.getWidget(WidgetInfo.QUEST_COMPLETED_NAME_TEXT);\n+\t\tif (questChild == null)\n+\t\t{\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\tString text = questChild.getText();\n+\t\t// \"You have completed The Corsair Curse!\"\n+\t\tMatcher quest_match_1 = QUEST_PATTERN_1.matcher(text);\n+\t\t// \"'One Small Favour' completed!\"\n+\t\tMatcher quest_match_2 = QUEST_PATTERN_2.matcher(text);\n+\t\tMatcher quest_match_final = quest_match_1.matches() ? quest_match_1 : quest_match_2;\n+\t\tif (!quest_match_final.matches())\n+\t\t{\n+\t\t\treturn \"Quest(quest not found)\";\n+\t\t}\n+\n+\t\tString quest = quest_match_final.group(\"quest\");\n+\t\tString verb = quest_match_final.group(\"verb\") != null ? quest_match_final.group(\"verb\") : \"\";\n+\n+\t\tif (verb.contains(\"kind of\"))\n+\t\t{\n+\t\t\tquest = quest + \" partial completion\";\n+\t\t}\n+\t\telse if (verb.contains(\"completely\"))\n+\t\t{\n+\t\t\tquest = quest + \" II\";\n+\t\t}\n+\n+\t\tif (RFD_TAGS.stream().anyMatch((quest + verb)::contains))\n+\t\t{\n+\t\t\tquest = \"Recipe for Disaster - \" + quest;\n+\t\t}\n+\n+\t\tif (WORD_QUEST_IN_NAME_TAGS.stream().anyMatch(quest::contains))\n+\t\t{\n+\t\t\tquest = quest + \" Quest\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2717cfbf69f89d1aaef98bb9a514f17805ee2b8d"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjEyNjc2OnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxNTo1ODowOFrOGc0CuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxNTo1ODowOFrOGc0CuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg2NTk3Nw==", "bodyText": "This should probably just String parseQuestCompletedText(String text) which would make it easier to test due to not having the dep on the widget", "url": "https://github.com/runelite/runelite/pull/11580#discussion_r432865977", "createdAt": "2020-05-30T15:58:08Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -574,6 +576,57 @@ String parseLevelUpWidget(WidgetInfo levelUpLevel)\n \t\treturn skillName + \"(\" + skillLevel + \")\";\n \t}\n \n+\t/**\n+\t * Parses a WidgetInfo pointing to the second widget of the quest-completed dialog\n+\t * into a shortened string for filename usage.\n+\t *\n+\t * @return Shortened string in the format \"Quest(The Corsair Curse)\"\n+\t */\n+\t@VisibleForTesting\n+\tString parseQuestCompletedWidget()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0d71803964c4885a1a78fb77a49fd683e8fe4d"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3575, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}