{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5Mjc1MjE1", "number": 10875, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOToyMVrODtR61A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOTo0MlrODtR7Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4ODA2MTAwOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOToyMVrOF-nWKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOToyMVrOF-nWKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIwMDY4Mg==", "bodyText": "Since this is relatively expensive it would be better to only call setMenuEntries if you know it has changed.", "url": "https://github.com/runelite/runelite/pull/10875#discussion_r401200682", "createdAt": "2020-03-31T20:39:21Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "diffHunk": "@@ -94,58 +94,60 @@ protected void shutDown() throws Exception\n \t}\n \n \t@Subscribe\n-\tpublic void onMenuEntryAdded(MenuEntryAdded menuEntryAdded)\n+\tpublic void onClientTick(ClientTick clientTick)\n \t{\n-\t\tint type = menuEntryAdded.getType();\n+\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n \n-\t\tif (type >= 2000)\n+\t\tfor (MenuEntry entry : menuEntries)\n \t\t{\n-\t\t\ttype -= 2000;\n-\t\t}\n-\n-\t\tint identifier = menuEntryAdded.getIdentifier();\n-\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n-\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n-\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n-\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n-\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n-\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n-\t\t\t|| type == RUNELITE.getId())\n-\t\t{\n-\t\t\tPlayer[] players = client.getCachedPlayers();\n-\t\t\tPlayer player = null;\n+\t\t\tint type = entry.getType();\n \n-\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\tif (type >= 2000)\n \t\t\t{\n-\t\t\t\tplayer = players[identifier];\n+\t\t\t\ttype -= 2000;\n \t\t\t}\n \n-\t\t\tif (player == null)\n+\t\t\tint identifier = entry.getIdentifier();\n+\t\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n+\t\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n+\t\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n+\t\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n+\t\t\t\t|| type == RUNELITE.getId())\n \t\t\t{\n-\t\t\t\treturn;\n-\t\t\t}\n+\t\t\t\tPlayer[] players = client.getCachedPlayers();\n+\t\t\t\tPlayer player = null;\n \n-\t\t\tDecorations decorations = getDecorations(player);\n+\t\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\t\t{\n+\t\t\t\t\tplayer = players[identifier];\n+\t\t\t\t}\n \n-\t\t\tif (decorations == null)\n-\t\t\t{\n-\t\t\t\treturn;\n-\t\t\t}\n+\t\t\t\tif (player == null)\n+\t\t\t\t{\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n \n-\t\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n-\t\t\tMenuEntry entry = menuEntries[menuEntries.length - 1];\n+\t\t\t\tDecorations decorations = getDecorations(player);\n \n-\t\t\tString oldTarget = entry.getTarget();\n-\t\t\tString newTarget = decorateTarget(oldTarget, decorations);\n+\t\t\t\tif (decorations == null)\n+\t\t\t\t{\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n \n-\t\t\tentry.setTarget(newTarget);\n+\t\t\t\tString oldTarget = entry.getTarget();\n+\t\t\t\tString newTarget = decorateTarget(oldTarget, decorations);\n \n-\t\t\tclient.setMenuEntries(menuEntries);\n+\t\t\t\tentry.setTarget(newTarget);\n+\t\t\t}\n \t\t}\n+\n+\t\tclient.setMenuEntries(menuEntries);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7e205ab9e3e0012be07061842b80747d02e7c6"}, "originalPosition": 103}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4ODA2MjAyOnYy", "diffSide": "RIGHT", "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOTo0MlrOF-nW4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQyMDozOTo0MlrOF-nW4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTIwMDg2Ng==", "bodyText": "this is the constant MENU_ACTION_DEPRIORITIZE_OFFSET", "url": "https://github.com/runelite/runelite/pull/10875#discussion_r401200866", "createdAt": "2020-03-31T20:39:42Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/playerindicators/PlayerIndicatorsPlugin.java", "diffHunk": "@@ -94,58 +94,60 @@ protected void shutDown() throws Exception\n \t}\n \n \t@Subscribe\n-\tpublic void onMenuEntryAdded(MenuEntryAdded menuEntryAdded)\n+\tpublic void onClientTick(ClientTick clientTick)\n \t{\n-\t\tint type = menuEntryAdded.getType();\n+\t\tMenuEntry[] menuEntries = client.getMenuEntries();\n \n-\t\tif (type >= 2000)\n+\t\tfor (MenuEntry entry : menuEntries)\n \t\t{\n-\t\t\ttype -= 2000;\n-\t\t}\n-\n-\t\tint identifier = menuEntryAdded.getIdentifier();\n-\t\tif (type == SPELL_CAST_ON_PLAYER.getId()\n-\t\t\t|| type == ITEM_USE_ON_PLAYER.getId()\n-\t\t\t|| type == PLAYER_FIRST_OPTION.getId()\n-\t\t\t|| type == PLAYER_SECOND_OPTION.getId()\n-\t\t\t|| type == PLAYER_THIRD_OPTION.getId()\n-\t\t\t|| type == PLAYER_FOURTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_FIFTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SIXTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_SEVENTH_OPTION.getId()\n-\t\t\t|| type == PLAYER_EIGTH_OPTION.getId()\n-\t\t\t|| type == RUNELITE.getId())\n-\t\t{\n-\t\t\tPlayer[] players = client.getCachedPlayers();\n-\t\t\tPlayer player = null;\n+\t\t\tint type = entry.getType();\n \n-\t\t\tif (identifier >= 0 && identifier < players.length)\n+\t\t\tif (type >= 2000)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7e205ab9e3e0012be07061842b80747d02e7c6"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3838, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}