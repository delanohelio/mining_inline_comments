{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2ODkzNTI4", "number": 11336, "title": "Add option to copy chat message contents to clipboard", "bodyText": "Signed-off-by: Tomas Slusny slusnucky@gmail.com", "createdAt": "2020-04-21T20:32:57Z", "url": "https://github.com/runelite/runelite/pull/11336", "merged": true, "mergeCommit": {"oid": "57d93e4ffae18703e78a30a746d7d371a86ef31c"}, "closed": true, "closedAt": "2020-05-03T20:38:31Z", "author": {"login": "deathbeam"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ7KILgBqjMyNTgwODc1Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdguwTgFqTQwNDU3Mzk3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18553709c741e8e438541ab6a2f6bfe057875fb7", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/18553709c741e8e438541ab6a2f6bfe057875fb7", "committedDate": "2020-04-21T20:32:08Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}, "afterCommit": {"oid": "5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e", "committedDate": "2020-04-21T22:09:30Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDY2NzU5", "url": "https://github.com/runelite/runelite/pull/11336#pullrequestreview-400466759", "createdAt": "2020-04-26T06:56:29Z", "commit": {"oid": "5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQwNjo1NjoyOVrOGL_9kA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQwNjo1NjoyOVrOGL_9kA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTIzNTQ3Mg==", "bodyText": "This feels way too much like it should be an API function than an, admittedly documented, magic number-ridden line of code in some plugin.", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r415235472", "createdAt": "2020-04-26T06:56:29Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,43 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getFirstEntry() == null || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal int groupId = TO_GROUP(event.getFirstEntry().getParam1());\n+\t\tfinal int childId = TO_CHILD(event.getFirstEntry().getParam1());\n+\n+\t\tif (groupId != WidgetInfo.CHATBOX.getGroupId())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal Widget widget = client.getWidget(groupId, childId);\n+\t\tfinal Widget parent = widget.getParent();\n+\t\tfinal Widget[] dynamicChildren = parent.getDynamicChildren();\n+\n+\t\t// Convert current message static widget id to dynamic widget id of message node with message contents\n+\t\tfinal int dynamicChildId = (childId - 59) * 2 + 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e"}, "originalPosition": 89}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTMwMTQ4", "url": "https://github.com/runelite/runelite/pull/11336#pullrequestreview-400530148", "createdAt": "2020-04-26T17:45:12Z", "commit": {"oid": "5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/5f5765ebffbfc4273d3deb31b7ba50e8b1145c6e", "committedDate": "2020-04-21T22:09:30Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}, "afterCommit": {"oid": "a87cc19c1f685bc269e4636b3792386c0bb32d14", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/a87cc19c1f685bc269e4636b3792386c0bb32d14", "committedDate": "2020-04-26T17:52:07Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a87cc19c1f685bc269e4636b3792386c0bb32d14", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/a87cc19c1f685bc269e4636b3792386c0bb32d14", "committedDate": "2020-04-26T17:52:07Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}, "afterCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/38faa2d5d6eca07cdb1db917583fcf74dd20277d", "committedDate": "2020-04-26T18:09:45Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNDI4NDUy", "url": "https://github.com/runelite/runelite/pull/11336#pullrequestreview-403428452", "createdAt": "2020-04-30T11:22:31Z", "commit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxMToyMjozMVrOGOk83w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxMTo0MToyNlrOGOlhbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzkzODY1NQ==", "bodyText": "this should check the entry type first", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417938655", "createdAt": "2020-04-30T11:22:31Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,50 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getMenuEntries().length < 2 || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Use second entry as first one can be walk here with transparent chatbox\n+\t\tfinal MenuEntry entry = event.getMenuEntries()[event.getMenuEntries().length - 2];\n+\n+\t\tfinal int groupId = TO_GROUP(entry.getParam1());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzk0NTE0Mg==", "bodyText": "This should be a constant 169.59 in widgetinfo", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417945142", "createdAt": "2020-04-30T11:35:52Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,50 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getMenuEntries().length < 2 || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Use second entry as first one can be walk here with transparent chatbox\n+\t\tfinal MenuEntry entry = event.getMenuEntries()[event.getMenuEntries().length - 2];\n+\n+\t\tfinal int groupId = TO_GROUP(entry.getParam1());\n+\t\tfinal int childId = TO_CHILD(entry.getParam1());\n+\n+\t\tif (groupId != WidgetInfo.CHATBOX.getGroupId())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal Widget widget = client.getWidget(groupId, childId);\n+\t\tfinal Widget parent = widget.getParent();\n+\t\tfinal Widget[] dynamicChildren = parent.getDynamicChildren();\n+\n+\t\t// Get child id of first chat message static child so we can substract this offset to link to dynamic child\n+\t\t// later\n+\t\tfinal int first = TO_CHILD(parent.getStaticChildren()[0].getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzk0NjgwMA==", "bodyText": "this should have a check against a widget info too", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417946800", "createdAt": "2020-04-30T11:39:00Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,50 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getMenuEntries().length < 2 || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Use second entry as first one can be walk here with transparent chatbox\n+\t\tfinal MenuEntry entry = event.getMenuEntries()[event.getMenuEntries().length - 2];\n+\n+\t\tfinal int groupId = TO_GROUP(entry.getParam1());\n+\t\tfinal int childId = TO_CHILD(entry.getParam1());\n+\n+\t\tif (groupId != WidgetInfo.CHATBOX.getGroupId())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal Widget widget = client.getWidget(groupId, childId);\n+\t\tfinal Widget parent = widget.getParent();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzk0NjkwNQ==", "bodyText": "prefer getChildren or getChild", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417946905", "createdAt": "2020-04-30T11:39:12Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,50 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getMenuEntries().length < 2 || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Use second entry as first one can be walk here with transparent chatbox\n+\t\tfinal MenuEntry entry = event.getMenuEntries()[event.getMenuEntries().length - 2];\n+\n+\t\tfinal int groupId = TO_GROUP(entry.getParam1());\n+\t\tfinal int childId = TO_CHILD(entry.getParam1());\n+\n+\t\tif (groupId != WidgetInfo.CHATBOX.getGroupId())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal Widget widget = client.getWidget(groupId, childId);\n+\t\tfinal Widget parent = widget.getParent();\n+\t\tfinal Widget[] dynamicChildren = parent.getDynamicChildren();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzk0ODAxNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\telse if (menuOption.contains(COPY_TO_CLIPBOARD) && !Strings.isNullOrEmpty(currentMessage))\n          \n          \n            \n            \t\telse if (COPY_TO_CLIPBOARD.equals(menuOption) && !Strings.isNullOrEmpty(currentMessage))", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417948015", "createdAt": "2020-04-30T11:41:26Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -185,6 +244,11 @@ public void onMenuOptionClicked(MenuOptionClicked event)\n \t\t\t\tmessageQueue.removeIf(e -> e.getType() == ChatMessageType.PUBLICCHAT || e.getType() == ChatMessageType.MODCHAT);\n \t\t\t}\n \t\t}\n+\t\telse if (menuOption.contains(COPY_TO_CLIPBOARD) && !Strings.isNullOrEmpty(currentMessage))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 119}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNDQxNzUw", "url": "https://github.com/runelite/runelite/pull/11336#pullrequestreview-403441750", "createdAt": "2020-04-30T11:44:07Z", "commit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxMTo0NDowN1rOGOlmiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxMTo0NDowN1rOGOlmiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzk0OTMyMQ==", "bodyText": "also an explanation of what the widget tree looks like for this to work would be nice", "url": "https://github.com/runelite/runelite/pull/11336#discussion_r417949321", "createdAt": "2020-04-30T11:44:07Z", "author": {"login": "abextm"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/chathistory/ChatHistoryPlugin.java", "diffHunk": "@@ -167,6 +182,50 @@ public void onChatMessage(ChatMessage chatMessage)\n \t\t}\n \t}\n \n+\t@Subscribe\n+\tpublic void onMenuOpened(MenuOpened event)\n+\t{\n+\t\tif (event.getMenuEntries().length < 2 || !config.copyToClipboard())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Use second entry as first one can be walk here with transparent chatbox\n+\t\tfinal MenuEntry entry = event.getMenuEntries()[event.getMenuEntries().length - 2];\n+\n+\t\tfinal int groupId = TO_GROUP(entry.getParam1());\n+\t\tfinal int childId = TO_CHILD(entry.getParam1());\n+\n+\t\tif (groupId != WidgetInfo.CHATBOX.getGroupId())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal Widget widget = client.getWidget(groupId, childId);\n+\t\tfinal Widget parent = widget.getParent();\n+\t\tfinal Widget[] dynamicChildren = parent.getDynamicChildren();\n+\n+\t\t// Get child id of first chat message static child so we can substract this offset to link to dynamic child\n+\t\t// later\n+\t\tfinal int first = TO_CHILD(parent.getStaticChildren()[0].getId());\n+\n+\t\t// Convert current message static widget id to dynamic widget id of message node with message contents\n+\t\tfinal int dynamicChildId = (childId - first) * 2 + 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d"}, "originalPosition": 96}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84885f754688368b5b41988760564be526a3e10f", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/84885f754688368b5b41988760564be526a3e10f", "committedDate": "2020-04-30T22:09:57Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38faa2d5d6eca07cdb1db917583fcf74dd20277d", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/38faa2d5d6eca07cdb1db917583fcf74dd20277d", "committedDate": "2020-04-26T18:09:45Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}, "afterCommit": {"oid": "84885f754688368b5b41988760564be526a3e10f", "author": {"user": {"login": "deathbeam", "name": "Tomas Slusny"}}, "url": "https://github.com/runelite/runelite/commit/84885f754688368b5b41988760564be526a3e10f", "committedDate": "2020-04-30T22:09:57Z", "message": "Add option to copy chat message contents to clipboard\n\nSigned-off-by: Tomas Slusny <slusnucky@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTczOTc1", "url": "https://github.com/runelite/runelite/pull/11336#pullrequestreview-404573975", "createdAt": "2020-05-03T01:37:55Z", "commit": {"oid": "84885f754688368b5b41988760564be526a3e10f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3912, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}