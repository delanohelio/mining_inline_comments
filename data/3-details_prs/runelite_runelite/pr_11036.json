{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMjA1MzIz", "number": 11036, "title": "Revert Shift Anti-Drag and Disable in PvP Scenarios", "bodyText": "The changes made reflect the exact same sentiments stated by @dekvall  in PR #10870.\nThe following features have been reverted/added to the anti-drag plugin:\n\nShift Anti-Drag plugin has been reverted back to original Anti Drag\nShift Only anti-drag still remains an option.\nAny form of anti-drag is disabled in PvP scenarios. (Detected by the spec orb enabling/disabling). Including in PvP worlds and wilderness.\nAnti drag is enabled for banking.\n\nWith the addition of removing all forms of anti-drag for PvP scenarios, I believe this sufficiently solves the issue/uproar in the PvP community that caused the plugin to get reverted in the first place.\nExample on a PvP world:", "createdAt": "2020-03-18T04:13:14Z", "url": "https://github.com/runelite/runelite/pull/11036", "merged": true, "mergeCommit": {"oid": "6e06b1c929e73ad390ad051e9deec5dd1294a650"}, "closed": true, "closedAt": "2020-04-07T20:26:43Z", "author": {"login": "usa-usa-usa-usa"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQWN-ngFqTM3OTExODkzMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVBIhHABqjMyMDYxNDgzMzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MTE4OTMz", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-379118933", "createdAt": "2020-03-23T03:53:08Z", "commit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo1MzowOFrOF52Ohg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNDowMTowMVrOF52TvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg==", "bodyText": "This should be referenced from the ConfigGroup in AntiDragConfig", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201606", "createdAt": "2020-03-23T03:53:08Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,44 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTY2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn client.getVarbitValue(8121) == 1;\n          \n          \n            \n            \t\treturn client.getVarbitValue(PVP_SPEC_ORB_DISABLED) == 1;", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201665", "createdAt": "2020-03-23T03:53:23Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +193,9 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tpublic boolean inPvp()\n+\t{\n+\t\treturn client.getVarbitValue(8121) == 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 173}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTkzNw==", "bodyText": "This should keep a stored value for isPvp and check isPvp() against that, and then only run this code if that changes", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201937", "createdAt": "2020-03-23T03:55:05Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t}\n+\t\t});\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t}\n+\t\t});\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\n+\t\tif (!inPvp() && !config.onShiftOnly())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjI3NA==", "bodyText": "This should be 1) check shift 2) check config 3) thread 4) check pvp 5) change drags, as it prevents an unnecessary clientThread.invoke() per key. The config checks and keyevent checks are fine on this thread.\nThe previous behavior also allowed shift click in pvp, which would be nice to not lose, so maybe don't check that?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202274", "createdAt": "2020-03-23T03:56:58Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjk0MA==", "bodyText": "This actually looks like a bug fix? I may take this independently/it should be in a separate commit.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202940", "createdAt": "2020-03-23T04:01:01Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +77,27 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n \t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tsetBankDragDelay(DEFAULT_DELAY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MTIxMTQ5", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-379121149", "createdAt": "2020-03-23T04:03:34Z", "commit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNDowMzozNFrOF52VoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNDowMzozNFrOF52VoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA==", "bodyText": "I can't figure out what this is here for. I don't think it's being used?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396203424", "createdAt": "2020-03-23T04:03:34Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,24 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"dragDelay\",\n+\t\tname = \"\",\n+\t\tdescription = \"\"\n+\t)\n+\tvoid dragDelay(int delay);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwODI4NzMw", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-380828730", "createdAt": "2020-03-25T02:55:02Z", "commit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwMjo1NTowM1rOF7Kchg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwMjo1ODozM1rOF7KgGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ0Ng==", "bodyText": "Why are the plugin description and tags removed?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581446", "createdAt": "2020-03-25T02:55:03Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ5Nw==", "bodyText": "You're not using any log statements... Remove this.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581497", "createdAt": "2020-03-25T02:55:15Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTYzNg==", "bodyText": "Is this being used outside the plugin? Seems like it can remain private.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581636", "createdAt": "2020-03-25T02:55:45Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tstatic final int DEFAULT_DELAY = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTc4MQ==", "bodyText": "Why is the FocusChanged handler removed?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581781", "createdAt": "2020-03-25T02:56:23Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTkxNw==", "bodyText": "These blocks are duplicated numerous times in this plugin now. Move them to helper methods.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581917", "createdAt": "2020-03-25T02:56:51Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onConfigChanged(ConfigChanged event)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MjM2MA==", "bodyText": "This should explain the expected function and values of this varbit, not just be a section header of sorts. (Not all other entries in this file are a good reference; I would expect this to look more like GE_OFFER_CREATION_TYPE on L542 than the sections above)", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397582360", "createdAt": "2020-03-25T02:58:33Z", "author": {"login": "Nightfirecat"}, "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,12 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * PVP", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29d145eaabb09a0bc52892813c1f2a26969993a3"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwODQyNzQ5", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-380842749", "createdAt": "2020-03-25T03:48:30Z", "commit": {"oid": "d6f7447118921f3fae95dc43a434f59f6279eafa"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTcxNzU4", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-382171758", "createdAt": "2020-03-26T16:14:34Z", "commit": {"oid": "52cca8ef2db1d395bdf793b5dc4adf6891d3c9b3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjoxNDozNVrOF8OwcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjoxNDozNVrOF8OwcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwMDY1Ng==", "bodyText": "This can remain static in addition to being private.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final int DEFAULT_DELAY = 5;\n          \n          \n            \n            \tprivate static final int DEFAULT_DELAY = 5;", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398700656", "createdAt": "2020-03-26T16:14:35Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -48,14 +48,15 @@\n \n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false\n+\tenabledByDefault = false,\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate final int DEFAULT_DELAY = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52cca8ef2db1d395bdf793b5dc4adf6891d3c9b3"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTc5MDI3", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-382179027", "createdAt": "2020-03-26T16:21:52Z", "commit": {"oid": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjoyMTo1MlrOF8PHmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjoyMzo1OVrOF8POPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNjU4Nw==", "bodyText": "This javadoc does not match the implementation of inPvp(). I would expect it to read more like the following:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Status of the PvP Spec Orb\n          \n          \n            \n            \t * 0 = Disabled\n          \n          \n            \n            \t * 1 = Enabled\n          \n          \n            \n            \t * Whether the Special Attack orb is disabled due to being in a PvP area\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * 0 = Enabled (player is not in PvP)\n          \n          \n            \n            \t * 1 = Disabled (player in in PvP)\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398706587", "createdAt": "2020-03-26T16:21:52Z", "author": {"login": "Nightfirecat"}, "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,14 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Status of the PvP Spec Orb\n+\t * 0 = Disabled\n+\t * 1 = Enabled", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNzM5Nw==", "bodyText": "This still has not been removed. Why was this comment marked resolved?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398707397", "createdAt": "2020-03-26T16:22:53Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,24 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"dragDelay\",\n+\t\tname = \"\",\n+\t\tdescription = \"\"\n+\t)\n+\tvoid dragDelay(int delay);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}, "originalCommit": {"oid": "e5b319d8178c97c5764def3867fd3d4ca02d0f34"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwODI4Nw==", "bodyText": "lastInPvp would be a much better var name, which would completely remove the need for this added comment.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398708287", "createdAt": "2020-03-26T16:23:59Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tprivate final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastStatus; //true = was in PvP, false = was not in Pvp", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MzMwNjAw", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-384330600", "createdAt": "2020-03-31T00:48:14Z", "commit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwMDo0ODoxNFrOF-BYIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwMTozNDozN1rOF-CLRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3ODU5NQ==", "bodyText": "Don't remove the comment on this line", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400578595", "createdAt": "2020-03-31T00:48:14Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTEwNA==", "bodyText": "This needs some extra description to clarify that the plugin still requires the use of Shift in PVP.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579104", "createdAt": "2020-03-31T00:49:49Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"onShiftOnly\",\n+\t\tname = \"On Shift Only\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTI5OA==", "bodyText": "These imports need to be reordered, they should still be in alphabetical order.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579298", "createdAt": "2020-03-31T00:50:33Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTUxOA==", "bodyText": "This also should be moved back where it was originally to maintain import ordering.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579518", "createdAt": "2020-03-31T00:51:24Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTY3Ng==", "bodyText": "Suggested change", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579676", "createdAt": "2020-03-31T00:52:01Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n \tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastInPvp;\n+\n \t@Provides\n \tAntiDragConfig getConfig(ConfigManager configManager)\n \t{\n \t\treturn configManager.getConfig(AntiDragConfig.class);\n \t}\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDM2Ng==", "bodyText": "This should be indented only one level further\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tsetDragDelay();\n          \n          \n            \n            \t\t\tsetDragDelay();", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580366", "createdAt": "2020-03-31T00:54:23Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDgwMw==", "bodyText": "Use a non-inverted condition:\nif (config.onShiftOnly() || inPvp())\n{\n\tremoveDragDelay();\n}\nelse\n{\n\tsetDragDelay();\n}", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580803", "createdAt": "2020-03-31T00:56:05Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t{\n+\t\t\tremoveDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDk0NQ==", "bodyText": "This doesn't remove the drag delay, it only resets it to default values. resetDragDelay() would be a better name.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580945", "createdAt": "2020-03-31T00:56:37Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +208,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n+\t}\n+\n+\tprivate void setDragDelay()\n+\t{\n+\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\tsetBankDragDelay(config.dragDelay());\n+\t}\n+\n+\tprivate void removeDragDelay()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 200}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU5MTY4NQ==", "bodyText": "Turns out my suggestion wasn't proper javadoc. This should be though.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\n          \n          \n            \n            \t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400591685", "createdAt": "2020-03-31T01:34:37Z", "author": {"login": "Nightfirecat"}, "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,17 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Whether the Special Attack orb is disabled due to being in a PvP area\n+\t *\n+\t * 0 = Enabled (player is not in PvP)\n+\t * 1 = Disabled (player in in PvP)\n+\t *\n+\t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eed4484084639d100ebfac82cc2ddc7c1b749d4"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1OTk2MzU2", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-385996356", "createdAt": "2020-04-01T22:34:58Z", "commit": {"oid": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjozNDo1OFrOF_VESQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjozNToyNVrOF_VE7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTc2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949769", "createdAt": "2020-04-01T22:34:58Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTkzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949933", "createdAt": "2020-04-01T22:35:25Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b"}, "originalPosition": 99}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3ODUxNDM1", "url": "https://github.com/runelite/runelite/pull/11036#pullrequestreview-387851435", "createdAt": "2020-04-05T19:18:43Z", "commit": {"oid": "9b61d8823e1b86d3aef3b271042c1690d7506acb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQxOToxODo0M1rOGBCpcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQxOToyNDowOFrOGBCr5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTEzOA==", "bodyText": "This should probably be on the client thread", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745138", "createdAt": "2020-04-05T19:18:43Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +80,24 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n-\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tresetDragDelay();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61d8823e1b86d3aef3b271042c1690d7506acb"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTcxNg==", "bodyText": "Only the set (and probably the above resetDragDelay()) needs to be on client thread, the rest is fine off.", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745716", "createdAt": "2020-04-05T19:23:56Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n+\t\t{\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (config.onShiftOnly() || inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tresetDragDelay();\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n+\t{\n+\t\tboolean currentStatus = inPvp();\n+\n+\t\tif (currentStatus != lastInPvp)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (!currentStatus && !config.onShiftOnly())\n+\t\t\t{\n+\t\t\t\tsetDragDelay();\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tresetDragDelay();\n+\t\t\t}\n+\n+\t\t\tlastInPvp = currentStatus;\n \t\t}\n+\n \t}\n \n \t@Subscribe\n \tpublic void onFocusChanged(FocusChanged focusChanged)\n \t{\n \t\tif (!focusChanged.isFocused())\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61d8823e1b86d3aef3b271042c1690d7506acb"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTc2Nw==", "bodyText": "This is just lastInPvp ?", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745767", "createdAt": "2020-04-05T19:24:08Z", "author": {"login": "Adam-"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +206,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61d8823e1b86d3aef3b271042c1690d7506acb"}, "originalPosition": 183}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "committedDate": "2020-04-06T16:17:21Z", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ace7d3b7eeba80e3f1cdede92f5e4f492242e1a7", "author": {"user": {"login": "usa-usa-usa-usa", "name": "Johnny"}}, "url": "https://github.com/runelite/runelite/commit/ace7d3b7eeba80e3f1cdede92f5e4f492242e1a7", "committedDate": "2020-04-06T00:52:42Z", "message": "Merge branch 'feature/rever-shift-anti-drag' of https://github.com/jcwhisman/runelite into feature/rever-shift-anti-drag"}, "afterCommit": {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "committedDate": "2020-04-06T16:17:21Z", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4085, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}