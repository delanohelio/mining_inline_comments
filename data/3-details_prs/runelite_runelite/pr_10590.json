{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxNzg3NTA1", "number": 10590, "title": " loot tracker: store aggregated drops", "bodyText": "", "createdAt": "2020-01-12T02:29:20Z", "url": "https://github.com/runelite/runelite/pull/10590", "merged": true, "mergeCommit": {"oid": "2310349a44c9798790408b955556d7a4227802e5"}, "closed": true, "closedAt": "2020-01-19T02:56:57Z", "author": {"login": "Adam-"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb5eWxLABqjI5NDA5NzU3MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7uhqqABqjI5NjA1OTI2MjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0021bed435d474aad6285fc6fed343b52ab3a0dd", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/0021bed435d474aad6285fc6fed343b52ab3a0dd", "committedDate": "2020-01-12T02:20:38Z", "message": "loot controller: publish loot to redis"}, "afterCommit": {"oid": "d839b910a9446eec405aa26071261f535a43c7c7", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/d839b910a9446eec405aa26071261f535a43c7c7", "committedDate": "2020-01-12T02:30:29Z", "message": "loot controller: publish loot to redis"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d839b910a9446eec405aa26071261f535a43c7c7", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/d839b910a9446eec405aa26071261f535a43c7c7", "committedDate": "2020-01-12T02:30:29Z", "message": "loot controller: publish loot to redis"}, "afterCommit": {"oid": "2c50c759446f44093b87917966c24b8b7d7208cd", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/2c50c759446f44093b87917966c24b8b7d7208cd", "committedDate": "2020-01-12T03:09:36Z", "message": "loot controller: publish loot to redis"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c50c759446f44093b87917966c24b8b7d7208cd", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/2c50c759446f44093b87917966c24b8b7d7208cd", "committedDate": "2020-01-12T03:09:36Z", "message": "loot controller: publish loot to redis"}, "afterCommit": {"oid": "6f76bce5cce98f054dae0fef17e55e28eb5b6e3f", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/6f76bce5cce98f054dae0fef17e55e28eb5b6e3f", "committedDate": "2020-01-12T03:14:09Z", "message": "loot controller: publish loot to redis"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMjQ3Njg4", "url": "https://github.com/runelite/runelite/pull/10590#pullrequestreview-342247688", "createdAt": "2020-01-14T01:39:33Z", "commit": {"oid": "6f76bce5cce98f054dae0fef17e55e28eb5b6e3f"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMTozOTozM1rOFdJ-Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMjowNToyN1rOFdKThQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNjM1NA==", "bodyText": "maybe we should call this Kills or LootAggregate?", "url": "https://github.com/runelite/runelite/pull/10590#discussion_r366116354", "createdAt": "2020-01-14T01:39:33Z", "author": {"login": "abextm"}, "path": "http-api/src/main/java/net/runelite/http/api/loottracker/Kill.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright (c) 2020, Adam <Adam@sigterm.info>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this\n+ *    list of conditions and the following disclaimer.\n+ * 2. Redistributions in binary form must reproduce the above copyright notice,\n+ *    this list of conditions and the following disclaimer in the documentation\n+ *    and/or other materials provided with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package net.runelite.http.api.loottracker;\n+\n+import java.time.Instant;\n+import java.util.Collection;\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.NoArgsConstructor;\n+\n+@Data\n+@AllArgsConstructor\n+@NoArgsConstructor\n+public class Kill", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f76bce5cce98f054dae0fef17e55e28eb5b6e3f"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNjczMQ==", "bodyText": "this should probably reflect the type its returning", "url": "https://github.com/runelite/runelite/pull/10590#discussion_r366116731", "createdAt": "2020-01-14T01:41:24Z", "author": {"login": "abextm"}, "path": "http-service/src/main/java/net/runelite/http/service/loottracker/LootTrackerController.java", "diffHunk": "@@ -64,10 +74,15 @@ public void storeLootRecord(HttpServletRequest request, HttpServletResponse resp\n \n \t\tservice.store(records, e.getUser());\n \t\tresponse.setStatus(HttpStatusCodes.STATUS_CODE_OK);\n+\n+\t\ttry (Jedis jedis = redisPool.getResource())\n+\t\t{\n+\t\t\tjedis.publish(\"drops\", GSON.toJson(records));\n+\t\t}\n \t}\n \n \t@GetMapping\n-\tpublic Collection<LootRecord> getLootRecords(HttpServletRequest request, HttpServletResponse response, @RequestParam(value = \"count\", defaultValue = \"1024\") int count, @RequestParam(value = \"start\", defaultValue = \"0\") int start) throws IOException\n+\tpublic Collection<Kill> getLootRecords(HttpServletRequest request, HttpServletResponse response, @RequestParam(value = \"count\", defaultValue = \"1024\") int count, @RequestParam(value = \"start\", defaultValue = \"0\") int start) throws IOException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f76bce5cce98f054dae0fef17e55e28eb5b6e3f"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMTg2MQ==", "bodyText": "this class is dead", "url": "https://github.com/runelite/runelite/pull/10590#discussion_r366121861", "createdAt": "2020-01-14T02:05:27Z", "author": {"login": "abextm"}, "path": "http-service/src/main/java/net/runelite/http/service/loottracker/LootTrackerRecord.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright (c) 2020, Adam <Adam@sigterm.info>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this\n+ *    list of conditions and the following disclaimer.\n+ * 2. Redistributions in binary form must reproduce the above copyright notice,\n+ *    this list of conditions and the following disclaimer in the documentation\n+ *    and/or other materials provided with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package net.runelite.http.service.loottracker;\n+\n+import lombok.Data;\n+import net.runelite.http.api.loottracker.LootRecordType;\n+\n+@Data\n+class LootTrackerRecord", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f76bce5cce98f054dae0fef17e55e28eb5b6e3f"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODYxNDE5", "url": "https://github.com/runelite/runelite/pull/10590#pullrequestreview-344861419", "createdAt": "2020-01-17T21:52:17Z", "commit": {"oid": "63a5b12df9ca1fd7c18b4a68049ac72ee9f26205"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "63a5b12df9ca1fd7c18b4a68049ac72ee9f26205", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/63a5b12df9ca1fd7c18b4a68049ac72ee9f26205", "committedDate": "2020-01-15T22:28:41Z", "message": "rename method"}, "afterCommit": {"oid": "16580ae8541367e44ef087e4eba4be25740b2728", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/16580ae8541367e44ef087e4eba4be25740b2728", "committedDate": "2020-01-19T02:14:41Z", "message": "loot controller: publish loot to redis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "723ecc8499915d0c47630dbad6a4ce3b45159da3", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/723ecc8499915d0c47630dbad6a4ce3b45159da3", "committedDate": "2020-01-19T02:28:40Z", "message": "loot tracker: store aggregated drops\n\nThis modifies both the service and the client plugin to no longer store\nloot per-kill, with the exception of the current sessions kill log. The\namount of loot data returned now from the service defaults to the last\n1024 unique events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "304f4d6b2a88620654025c610b3e5ad1d2545bf6", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/304f4d6b2a88620654025c610b3e5ad1d2545bf6", "committedDate": "2020-01-19T02:28:41Z", "message": "loot controller: publish loot to redis"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16580ae8541367e44ef087e4eba4be25740b2728", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/16580ae8541367e44ef087e4eba4be25740b2728", "committedDate": "2020-01-19T02:14:41Z", "message": "loot controller: publish loot to redis"}, "afterCommit": {"oid": "304f4d6b2a88620654025c610b3e5ad1d2545bf6", "author": {"user": {"login": "Adam-", "name": "Adam"}}, "url": "https://github.com/runelite/runelite/commit/304f4d6b2a88620654025c610b3e5ad1d2545bf6", "committedDate": "2020-01-19T02:28:41Z", "message": "loot controller: publish loot to redis"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4370, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}