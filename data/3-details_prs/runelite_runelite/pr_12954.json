{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzMDAyNzI3", "number": 12954, "title": "XP Globes: add virtual level to config and xp globes", "bodyText": "Resolves #12871\nCurrent configuration:\n\nNew configuration:\n\nCurrent behavior:\n\nAfter change (toggled off, default):\n\nAfter change (toggled on):\n\nAfter change (Hide maxed skills toggled on) (lol)\n\nChanges come with tests.", "createdAt": "2020-12-20T01:33:20Z", "url": "https://github.com/runelite/runelite/pull/12954", "merged": true, "mergeCommit": {"oid": "49138527f8fb6a8da13d5382bf03080bf2d0ad76"}, "closed": true, "closedAt": "2021-01-25T00:30:20Z", "author": {"login": "wrightmalone"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdwQU3GAFqTU2ODc5MDc3Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdzbKlLABqjQyNDMwODUwMDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY4NzkwNzcz", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-568790773", "createdAt": "2021-01-15T03:21:12Z", "commit": {"oid": "54fe7f06f78d9a0a290446bb7332c6fc26931538"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQwMzoyMToxM1rOIT_v8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQwMzoyMzowMlrOIT_xpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzgzODMyMA==", "bodyText": "Invoke this in before() instead of calling it in each test case", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r557838320", "createdAt": "2021-01-15T03:21:13Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,181 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\t@Before\n+\tpublic void before()\n+\t{\n+\t\tGuice.createInjector(BoundFieldModule.of(this)).injectMembers(this);\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsNotShownByDefault()\n+\t{\n+\t\tint totalXp = 15_000_000;\n+\t\trunFirstStatChangeForCaching(totalXp);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsShownWhenConfigured()\n+\t{\n+\t\tint totalXp = 15_000_000;\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\t\trunFirstStatChangeForCaching(totalXp);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.getLevelForXp(totalXp + 1), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxAndShowVirtualLevelConfigured()\n+\t{\n+\t\tint totalXp = 15_000_000;\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\t\trunFirstStatChangeForCaching(totalXp);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxConfigured()\n+\t{\n+\t\tint totalXp = 15_000_000;\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\t\trunFirstStatChangeForCaching(totalXp);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsShownOnXpGainBelowMaxWhenHideMaxConfigured()\n+\t{\n+\t\tint totalXp = 1;\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\t\trunFirstStatChangeForCaching(totalXp);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotalXp + 150,\n+\t\t\tExperience.getLevelForXp(totalXp + 150),\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.getLevelForXp(totalXp + 150), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testStatChangesFromBoostDoNotAffectXpGlobes()\n+\t{\n+\t\tint total_xp = 9_000_000;\n+\t\trunFirstStatChangeForCaching(total_xp);\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\n+\t\tStatChanged boostEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\ttotal_xp,\n+\t\t\tExperience.getLevelForXp(total_xp),\n+\t\t\t5\n+\t\t);\n+\n+\t\t// XP hasn't changed since the first event, so no globe should be added\n+\t\txpGlobesPlugin.onStatChanged(boostEvent);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\tvoid runFirstStatChangeForCaching(int totalXp)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54fe7f06f78d9a0a290446bb7332c6fc26931538"}, "originalPosition": 169}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzgzODc1OQ==", "bodyText": "This can be combined with the check above as follows:\nif (currentLevel >= Experience.MAX_REAL_LEVEL)\n{\n\tif (config.hideMaxed())\n\t{\n\t\treturn;\n\t}\n\telse if (config.showVirtualLevel())\n\t{\n\t\tcurrentLevel = Experience.getLevelForXp(currentXp);\n\t}\n}", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r557838759", "createdAt": "2021-01-15T03:23:02Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/main/java/net/runelite/client/plugins/xpglobes/XpGlobesPlugin.java", "diffHunk": "@@ -111,6 +111,11 @@ public void onStatChanged(StatChanged statChanged)\n \t\t\treturn;\n \t\t}\n \n+\t\tif (config.showVirtualLevel() && currentLevel >= Experience.MAX_REAL_LEVEL)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54fe7f06f78d9a0a290446bb7332c6fc26931538"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcxNzQ2Mjk3", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-571746297", "createdAt": "2021-01-19T23:18:45Z", "commit": {"oid": "18176d68b3d8311c70ecd807da6f537814bb47f1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQyMzoxODo0NVrOIWmKfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQyMzoxODo0NVrOIWmKfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDU2NDg2Mw==", "bodyText": "This value doesn't seem to be changed in any test, and should probably be a static final variable rather than initialized in before():\nprivate static final int virtualLevelTotalXp = Experience.getXpForLevel(Experience.MAX_REAL_LEVEL + 1);", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r560564863", "createdAt": "2021-01-19T23:18:45Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,168 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\tprivate int virtualLevelTotalXp;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18176d68b3d8311c70ecd807da6f537814bb47f1"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcxNzcyNjcw", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-571772670", "createdAt": "2021-01-20T00:19:25Z", "commit": {"oid": "6e3ae192dcb1f903460c5dbda22a3190db507a10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMDoxOToyNlrOIWnmTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMDoxOToyNlrOIWnmTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDU4ODM2NA==", "bodyText": "Whoops I missed this, this should be private.\nAlso, the tests in general can be changed to use this to create and dispatch StatChanged events. e.g.\n@Test\npublic void testVirtualLevelInGlobeIsNotShownByDefault()\n{\n\tstatChanged(Skill.AGILITY, Experience.getXpForLevel(99) + 1);\n\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());`\n}\nThe only thing you'd need then is to add a boostedLevel overload to this method for the testStatChangesFromBoostDoNotAffectXpGlobes() test.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tvoid runFirstStatChangeForCaching(int totalXp, Skill skill)\n          \n          \n            \n            \tprivate void statChanged(Skill skill, int totalXp)", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r560588364", "createdAt": "2021-01-20T00:19:26Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,167 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\tprivate  static final int virtualLevelTotalXp = Experience.getXpForLevel(Experience.MAX_REAL_LEVEL + 1);\n+\n+\t@Before\n+\tpublic void before()\n+\t{\n+\t\tGuice.createInjector(BoundFieldModule.of(this)).injectMembers(this);\n+\n+\t\trunFirstStatChangeForCaching(virtualLevelTotalXp, Skill.AGILITY);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsNotShownByDefault()\n+\t{\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\tvirtualLevelTotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsShownWhenConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\tvirtualLevelTotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.getLevelForXp(virtualLevelTotalXp + 1), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxAndShowVirtualLevelConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\tvirtualLevelTotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\tvirtualLevelTotalXp + 1,\n+\t\t\t99,\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsShownOnXpGainBelowMaxWhenHideMaxConfigured()\n+\t{\n+\t\tint totalXp = 1;\n+\t\trunFirstStatChangeForCaching(totalXp, Skill.FARMING);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\n+\t\tStatChanged secondStatChangedEvent = new StatChanged(\n+\t\t\tSkill.FARMING,\n+\t\t\ttotalXp + 150,\n+\t\t\tExperience.getLevelForXp(totalXp + 150),\n+\t\t\t0\n+\t\t);\n+\n+\t\t// The next xp change adds a globe\n+\t\txpGlobesPlugin.onStatChanged(secondStatChangedEvent);\n+\t\tassertEquals(Experience.getLevelForXp(totalXp + 150), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testStatChangesFromBoostDoNotAffectXpGlobes()\n+\t{\n+\t\tStatChanged boostEvent = new StatChanged(\n+\t\t\tSkill.AGILITY,\n+\t\t\tvirtualLevelTotalXp,\n+\t\t\tExperience.getLevelForXp(virtualLevelTotalXp),\n+\t\t\t5\n+\t\t);\n+\n+\t\t// XP hasn't changed since the first event, so no globe should be added\n+\t\txpGlobesPlugin.onStatChanged(boostEvent);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\tvoid runFirstStatChangeForCaching(int totalXp, Skill skill)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e3ae192dcb1f903460c5dbda22a3190db507a10"}, "originalPosition": 155}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyODA2MjEw", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-572806210", "createdAt": "2021-01-21T00:28:20Z", "commit": {"oid": "9372bfbe9b12cf17d7d04ec848af48489969493a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMDoyODoyMVrOIXa6Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMDozMDo1OVrOIXbD3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTQyOTA2Nw==", "bodyText": "Use assertTrue(plugin.getXpGlobes().isEmpty()) for emptiness checks.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n          \n          \n            \n            \t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r561429067", "createdAt": "2021-01-21T00:28:21Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,135 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\tprivate static final int virtualLevelTotalXp = Experience.getXpForLevel(Experience.MAX_REAL_LEVEL + 1);\n+\n+\t@Before\n+\tpublic void before()\n+\t{\n+\t\tGuice.createInjector(BoundFieldModule.of(this)).injectMembers(this);\n+\n+\t\tstatChanged(virtualLevelTotalXp, Skill.AGILITY);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsNotShownByDefault()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(false);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsShownWhenConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.getLevelForXp(virtualLevelTotalXp + 1), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxAndShowVirtualLevelConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9372bfbe9b12cf17d7d04ec848af48489969493a"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTQzMDMwOQ==", "bodyText": "This is missing the enabled showVirtualLevel config.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n          \n          \n            \n            \t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n          \n          \n            \n            \t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r561430309", "createdAt": "2021-01-21T00:29:42Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,135 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\tprivate static final int virtualLevelTotalXp = Experience.getXpForLevel(Experience.MAX_REAL_LEVEL + 1);\n+\n+\t@Before\n+\tpublic void before()\n+\t{\n+\t\tGuice.createInjector(BoundFieldModule.of(this)).injectMembers(this);\n+\n+\t\tstatChanged(virtualLevelTotalXp, Skill.AGILITY);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsNotShownByDefault()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(false);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsShownWhenConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.getLevelForXp(virtualLevelTotalXp + 1), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxAndShowVirtualLevelConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9372bfbe9b12cf17d7d04ec848af48489969493a"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTQzMTUxNw==", "bodyText": "This test doesn't mock hideMaxed returning true", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r561431517", "createdAt": "2021-01-21T00:30:59Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,135 @@\n+package net.runelite.client.plugins.xpglobes;\n+\n+import com.google.inject.Guice;\n+import com.google.inject.testing.fieldbinder.Bind;\n+import com.google.inject.testing.fieldbinder.BoundFieldModule;\n+import java.util.Collections;\n+import javax.inject.Inject;\n+import net.runelite.api.Experience;\n+import net.runelite.api.Skill;\n+import net.runelite.api.events.StatChanged;\n+import net.runelite.client.plugins.xptracker.XpTrackerService;\n+import net.runelite.client.ui.overlay.OverlayManager;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import static org.mockito.Mockito.when;\n+import org.mockito.junit.MockitoJUnitRunner;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class XpGlobesTest\n+{\n+\t@Inject\n+\tprivate XpGlobesPlugin xpGlobesPlugin;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate OverlayManager overlayManager;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesOverlay xpGlobesOverlay;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpTrackerService xpTrackerService;\n+\n+\t@Mock\n+\t@Bind\n+\tprivate XpGlobesConfig xpGlobesConfig;\n+\n+\tprivate static final int virtualLevelTotalXp = Experience.getXpForLevel(Experience.MAX_REAL_LEVEL + 1);\n+\n+\t@Before\n+\tpublic void before()\n+\t{\n+\t\tGuice.createInjector(BoundFieldModule.of(this)).injectMembers(this);\n+\n+\t\tstatChanged(virtualLevelTotalXp, Skill.AGILITY);\n+\t\tassertTrue(xpGlobesPlugin.getXpGlobes().isEmpty());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsNotShownByDefault()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(false);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.MAX_REAL_LEVEL, xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testVirtualLevelInGlobeIsShownWhenConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.showVirtualLevel()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Experience.getLevelForXp(virtualLevelTotalXp + 1), xpGlobesPlugin.getXpGlobes().get(0).getCurrentLevel());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxAndShowVirtualLevelConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsNotShownWhenHideMaxConfigured()\n+\t{\n+\t\twhen(xpGlobesConfig.hideMaxed()).thenReturn(true);\n+\n+\t\tstatChanged(virtualLevelTotalXp + 1, Skill.AGILITY);\n+\n+\t\tassertEquals(Collections.emptyList(), xpGlobesPlugin.getXpGlobes());\n+\t}\n+\n+\t@Test\n+\tpublic void testGlobeIsShownOnXpGainBelowMaxWhenHideMaxConfigured()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9372bfbe9b12cf17d7d04ec848af48489969493a"}, "originalPosition": 96}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTczOTEzNzE2", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-573913716", "createdAt": "2021-01-22T02:48:26Z", "commit": {"oid": "6b5026984b3a32f6402b86d22abf2455a2caf44a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQwMjo0ODoyNlrOIYTSCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQwMjo0ODoyNlrOIYTSCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjM1MjY1MA==", "bodyText": "Add copyright header (see other files for reference)", "url": "https://github.com/runelite/runelite/pull/12954#discussion_r562352650", "createdAt": "2021-01-22T02:48:26Z", "author": {"login": "Nightfirecat"}, "path": "runelite-client/src/test/java/net/runelite/client/plugins/xpglobes/XpGlobesTest.java", "diffHunk": "@@ -0,0 +1,138 @@\n+package net.runelite.client.plugins.xpglobes;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b5026984b3a32f6402b86d22abf2455a2caf44a"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc0NDEzMjM1", "url": "https://github.com/runelite/runelite/pull/12954#pullrequestreview-574413235", "createdAt": "2021-01-22T16:22:51Z", "commit": {"oid": "f1b301e7ead0805830f3ee61dc7a4b73e8e2be85"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1b301e7ead0805830f3ee61dc7a4b73e8e2be85", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/f1b301e7ead0805830f3ee61dc7a4b73e8e2be85", "committedDate": "2021-01-22T14:14:05Z", "message": "add license statement"}, "afterCommit": {"oid": "5003a92197c8f0aa1525d695f9ebd04f14350616", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/5003a92197c8f0aa1525d695f9ebd04f14350616", "committedDate": "2021-01-24T22:49:22Z", "message": "xp globes: add option to show virtual level in tooltip\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "876a0aaf9c05d5abd54b12f78c21da8f615824de", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/876a0aaf9c05d5abd54b12f78c21da8f615824de", "committedDate": "2021-01-24T23:45:09Z", "message": "xp globes: add option to show virtual level in tooltip\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5003a92197c8f0aa1525d695f9ebd04f14350616", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/5003a92197c8f0aa1525d695f9ebd04f14350616", "committedDate": "2021-01-24T22:49:22Z", "message": "xp globes: add option to show virtual level in tooltip\n\nCo-authored-by: Adam <Adam@sigterm.info>"}, "afterCommit": {"oid": "876a0aaf9c05d5abd54b12f78c21da8f615824de", "author": {"user": null}, "url": "https://github.com/runelite/runelite/commit/876a0aaf9c05d5abd54b12f78c21da8f615824de", "committedDate": "2021-01-24T23:45:09Z", "message": "xp globes: add option to show virtual level in tooltip\n\nCo-authored-by: Adam <Adam@sigterm.info>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3009, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}