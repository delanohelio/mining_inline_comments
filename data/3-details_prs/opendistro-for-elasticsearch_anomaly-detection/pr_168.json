{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MzM4NDcy", "number": 168, "title": "Rollover AD result index less frequently", "bodyText": "Issue #, if available:\nDescription of changes:\nCurrently, we roll over the result index every 30 days or every 300000 docs. Assuming each doc has 1 KB and our result index has five shards, each shard takes about 60 MB, which is too small. Small shards are against ES best practice. This PR increases the rollover threshold to 9000000 docs, which increases the max shard size to roughly 1.8 GB.\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-06-20T00:18:41Z", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168", "merged": true, "mergeCommit": {"oid": "50be92933aa61df51de6805987b91b20bf217f33"}, "closed": true, "closedAt": "2020-06-22T18:06:58Z", "author": {"login": "kaituo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcs8QsIgH2gAyNDM3MzM4NDcyOjE0MjY4OGNlZmM0MjAxODBjY2E0MTM3YTc0NDFmODE3Y2JiZTE0ODY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABct1b2qAFqTQzNTE4NjI0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "142688cefc420180cca4137a7441f817cbbe1486", "author": {"user": {"login": "kaituo", "name": "Kaituo Li"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/142688cefc420180cca4137a7441f817cbbe1486", "committedDate": "2020-06-20T00:11:17Z", "message": "Rollover AD result index less frequently\n\nCurrently, we roll over the result index every 30 days or every 300000 docs. Assuming each doc has 1 KB and our result index has five shards, each shard takes about 60 MB, which is too small. Small shards are against ES best practice. This PR increases the rollover threshold to 9000000 docs, which increases the max shard size to roughly 1.8 GB.\u00a0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MTA3NTMw", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168#pullrequestreview-435107530", "createdAt": "2020-06-22T16:52:41Z", "commit": {"oid": "142688cefc420180cca4137a7441f817cbbe1486"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjo1Mjo0MlrOGnJI4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjo1Mjo0MlrOGnJI4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY5NzM3Ng==", "bodyText": "minor. comments are outdated.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168#discussion_r443697376", "createdAt": "2020-06-22T16:52:42Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/settings/AnomalyDetectorSettings.java", "diffHunk": "@@ -88,7 +88,7 @@ private AnomalyDetectorSettings() {}\n             // Suppose generally per cluster has 200 detectors and all run with 1 minute interval.\n             // We will get 288,000 AD result docs. So set it as 300k to avoid multiple roll overs\n             // per day.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "142688cefc420180cca4137a7441f817cbbe1486"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MTQzMDEw", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168#pullrequestreview-435143010", "createdAt": "2020-06-22T17:42:48Z", "commit": {"oid": "142688cefc420180cca4137a7441f817cbbe1486"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac3bc59701689e8dd1074d3ff130bfb7a94f90d2", "author": {"user": {"login": "kaituo", "name": "Kaituo Li"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/ac3bc59701689e8dd1074d3ff130bfb7a94f90d2", "committedDate": "2020-06-22T17:49:52Z", "message": "Update comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MTg2MjQy", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168#pullrequestreview-435186242", "createdAt": "2020-06-22T18:48:04Z", "commit": {"oid": "ac3bc59701689e8dd1074d3ff130bfb7a94f90d2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxODo0ODowNFrOGnM2aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxODo0ODowNFrOGnM2aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc1ODE4NQ==", "bodyText": "Is this a problem for 200 detectors? From the comment 300k is taking care of  288k limit to avoid multiple roll overs right?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/168#discussion_r443758185", "createdAt": "2020-06-22T18:48:04Z", "author": {"login": "vamshin"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/settings/AnomalyDetectorSettings.java", "diffHunk": "@@ -86,9 +86,9 @@ private AnomalyDetectorSettings() {}\n         .longSetting(\n             \"opendistro.anomaly_detection.ad_result_history_max_docs\",\n             // Suppose generally per cluster has 200 detectors and all run with 1 minute interval.\n-            // We will get 288,000 AD result docs. So set it as 300k to avoid multiple roll overs\n+            // We will get 288,000 AD result docs. So set it as 9000k to avoid multiple roll overs\n             // per day.\n-            300 * 1000L,\n+            9_000_000L,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac3bc59701689e8dd1074d3ff130bfb7a94f90d2"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1479, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}