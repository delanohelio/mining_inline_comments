{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MDMzMDMx", "number": 229, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMDoxNDoyNVrOEjXs5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNToyNTozOVrOEj5H-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTIzOTQzOnYy", "diffSide": "RIGHT", "path": "cli/cmd/cat.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMDoxNDoyNVrOHRr4QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMjozODozNlrOHRuXtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwNjc1Mg==", "bodyText": "return?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r488306752", "createdAt": "2020-09-15T00:14:25Z", "author": {"login": "wnbts"}, "path": "cli/cmd/cat.go", "diffHunk": "@@ -38,25 +40,30 @@ var catCmd = &cobra.Command{\n \t\t\t}\n \t\t\treturn\n \t\t}\n-\t\tidStatus, _ := cmd.Flags().GetBool(\"id\")\n-\t\tcommandHandler, err := getCommandHandler()\n-\t\tif err != nil {\n-\t\t\tfmt.Println(err)\n-\t\t}\n-\t\t// default is name\n-\t\taction := ad.GetAnomalyDetectorsByNamePattern\n-\t\tif idStatus {\n-\t\t\taction = getDetectorsByID\n-\t\t}\n-\t\tresults, err := getDetectors(commandHandler, args, action)\n-\t\tif err != nil {\n-\t\t\tfmt.Println(err)\n-\t\t\treturn\n-\t\t}\n-\t\tprintDetectors(results)\n+\t\tprintDetectors(Println, cmd, args)\n \t},\n }\n \n+//printDetectors print detectors\n+func printDetectors(f func(*entity.DetectorOutput), cmd *cobra.Command, detectors []string) {\n+\tidStatus, _ := cmd.Flags().GetBool(\"id\")\n+\tcommandHandler, err := getCommandHandler()\n+\tif err != nil {\n+\t\tfmt.Println(err)\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10ab1db1fabef1e0e851a0e47f87f76e75b2f780"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0NzU3Mw==", "bodyText": "Ack", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r488347573", "createdAt": "2020-09-15T02:38:36Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/cat.go", "diffHunk": "@@ -38,25 +40,30 @@ var catCmd = &cobra.Command{\n \t\t\t}\n \t\t\treturn\n \t\t}\n-\t\tidStatus, _ := cmd.Flags().GetBool(\"id\")\n-\t\tcommandHandler, err := getCommandHandler()\n-\t\tif err != nil {\n-\t\t\tfmt.Println(err)\n-\t\t}\n-\t\t// default is name\n-\t\taction := ad.GetAnomalyDetectorsByNamePattern\n-\t\tif idStatus {\n-\t\t\taction = getDetectorsByID\n-\t\t}\n-\t\tresults, err := getDetectors(commandHandler, args, action)\n-\t\tif err != nil {\n-\t\t\tfmt.Println(err)\n-\t\t\treturn\n-\t\t}\n-\t\tprintDetectors(results)\n+\t\tprintDetectors(Println, cmd, args)\n \t},\n }\n \n+//printDetectors print detectors\n+func printDetectors(f func(*entity.DetectorOutput), cmd *cobra.Command, detectors []string) {\n+\tidStatus, _ := cmd.Flags().GetBool(\"id\")\n+\tcommandHandler, err := getCommandHandler()\n+\tif err != nil {\n+\t\tfmt.Println(err)\n+\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwNjc1Mg=="}, "originalCommit": {"oid": "10ab1db1fabef1e0e851a0e47f87f76e75b2f780"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDY3NjczOnYy", "diffSide": "RIGHT", "path": "cli/cmd/download.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNTowNToxNFrOHSgQ_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMjozNTo1N1rOHTGgTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2NTA1Mg==", "bodyText": "Add file extension?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489165052", "createdAt": "2020-09-16T05:05:14Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc5MTU2NA==", "bodyText": "Added .json", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489791564", "createdAt": "2020-09-16T22:35:57Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2NTA1Mg=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDY5Njg2OnYy", "diffSide": "RIGHT", "path": "cli/cmd/download.go", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNToxNjoxN1rOHSgc3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNzoxNDo0MVrOHTUihQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw==", "bodyText": "If the filePath exists, will os.Create override the existing file?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489168093", "createdAt": "2020-09-16T05:16:17Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2OTQxMg==", "bodyText": "From this doc, https://golang.org/pkg/os/#Create\n\nIf the file already exists, it is truncated\n\nHow about check file exists or not before create ? If file exists, we should not truncate it directly in case user execute command by mistake.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489169412", "createdAt": "2020-09-16T05:20:53Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc5MTk2MQ==", "bodyText": "I introduced a flag -i similar to  cp in linux commands, which prompt to stdout whether to overwrite the file or not.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489791961", "createdAt": "2020-09-16T22:37:03Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTk3MDU3NA==", "bodyText": "The flag -i is optional? What if user don't add -i?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489970574", "createdAt": "2020-09-17T04:56:39Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTk3MTQxNw==", "bodyText": "It is interactive. By default download will overwrite but if user passes -i, it will prompt for user confirmation. Do you think prompt should be default?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489971417", "createdAt": "2020-09-17T04:59:59Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAyMTUwOQ==", "bodyText": "I think prompt should be default for this case, not good user experience/safe to override user's existing file without any prompt.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r490021509", "createdAt": "2020-09-17T07:14:41Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()\n+\tif err != nil {\n+\t\treturn err\n+\t}\n+\tfilePath := filepath.Join(cwd, d.Name)\n+\tf, err := os.Create(filePath)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE2ODA5Mw=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MDcxNTQ0OnYy", "diffSide": "RIGHT", "path": "cli/cmd/download.go", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNToyNTozOVrOHSgnig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNDo1NTozMlrOHTRakw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MDgyNg==", "bodyText": "Is it possible to output detector into a different directory other than current directory?  Can user specify the absolute file path? For example, user want to download detector and output it into \"/tmp/my_detectors.json\".\nIf user query detector with name pattern and return multiple detectors, we will write detectors into separate files. Seems not very easy for user to share if they have hundreds of such small detector configuration files.  By specifying an absolute file path and output all detectors' configuration into one file will be easier for user to share, bulk recreate etc.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489170826", "createdAt": "2020-09-16T05:25:39Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc5MjM2OA==", "bodyText": "Yes definitely possible. I am planning to include this feature as next PR.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489792368", "createdAt": "2020-09-16T22:38:11Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MDgyNg=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTk0MzkxNg==", "bodyText": "Added allow user to provide output folder as new commit.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489943916", "createdAt": "2020-09-17T03:51:27Z", "author": {"login": "VijayanB"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MDgyNg=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTk3MDMyMw==", "bodyText": "Cool, thanks for the change", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/229#discussion_r489970323", "createdAt": "2020-09-17T04:55:32Z", "author": {"login": "ylwu-amzn"}, "path": "cli/cmd/download.go", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package cmd\n+\n+import (\n+\tentity \"esad/internal/entity/ad\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"path/filepath\"\n+\n+\t\"github.com/spf13/cobra\"\n+)\n+\n+const commandDownload = \"download\"\n+\n+//downloadCmd downloads detectors configuration on current working directory\n+//based on detector id or name patter\n+var downloadCmd = &cobra.Command{\n+\tUse:   commandDownload + \" [flags] [list of detectors]\",\n+\tShort: \"Downloads detectors configurations based on id or name pattern\",\n+\tLong: fmt.Sprintf(\"Description:\\n  \" +\n+\t\t`Downloads detectors configurations based on id or name pattern, use \"\" to make sure the name is not matched with pwd lists'`),\n+\tRun: func(cmd *cobra.Command, args []string) {\n+\t\t//If no args, display usage\n+\t\tif len(args) < 1 {\n+\t\t\tdisplayError(cmd.Usage(), commandDownload)\n+\t\t\treturn\n+\t\t}\n+\t\terr := printDetectors(WriteInFile, cmd, args)\n+\t\tdisplayError(err, commandDownload)\n+\t},\n+}\n+\n+//WriteInFile writes detector's configuration on file\n+//file will be created inside current working directory,\n+//with detector name as file name\n+func WriteInFile(d *entity.DetectorOutput) error {\n+\tcwd, err := os.Getwd()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE3MDgyNg=="}, "originalCommit": {"oid": "9f6437fe80238d4a5c1b35e50f422382d9ee0293"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2934, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}