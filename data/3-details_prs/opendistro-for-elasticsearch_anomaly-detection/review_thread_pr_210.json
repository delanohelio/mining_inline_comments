{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2ODkxODI2", "number": 210, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzoyMzoxM1rOEX1TqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QyMzowNToyN1rOEYRBNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzNDI2MDg4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "isResolved": false, "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzoyMzoxM1rOG_2KDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwMDoyNzozMVrOHB_KjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA==", "bodyText": "this should be hide estimate, which affects minutes left and data points needed.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r469600780", "createdAt": "2020-08-12T23:23:13Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE5NTM4OA==", "bodyText": "you meant the variable name should be hideEstimate?  It only affect minutes left, not data points needed.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470195388", "createdAt": "2020-08-13T19:26:23Z", "author": {"login": "kaituo"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NTI0OA==", "bodyText": "I see the data needed and time needed together. Before model training is done, they should be hidden together by a message such as \"Model training is starting soon\". Once that is done, the detailed information on needed data and time is now shown, such as \"need x data and y time\".\nIt'd be confusing to see \"need x data and no time\". What does the ux look like in this case?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470295248", "createdAt": "2020-08-13T23:03:02Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5ODQxOQ==", "bodyText": "As far as ux goes, we will probably add an intermediate callout saying something like \"attempting to initialize with existing/historical data\", and show that callout until we can retrieve minutesLeft from the backend profile call. Then we show the regular progress bar callout, which includes the \"need x data and y time\" info. See Kibana issue here.\nI guess it's kind of arbitrary on if we hide minutes left and/or data points left, but need some way to indicate on the frontend that the cold start process isn't finished.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470298419", "createdAt": "2020-08-13T23:13:37Z", "author": {"login": "ohltyler"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMwNjQ3Ng==", "bodyText": "The initial temporal call out is informative enough. Before a model is trained, both data and time that the (non-existent) model will need to wait for should be equally unknown.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470306476", "createdAt": "2020-08-13T23:40:58Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMwOTgyNA==", "bodyText": "If we have a separate callout, both of these would be ignored as far as frontend is concerned. Wouldn't we want a different callout in this case? Seems that we wouldn't want to show 0% progress either, when that may immediately go to 100% and disappear if there is sufficient historical data.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470309824", "createdAt": "2020-08-13T23:52:28Z", "author": {"login": "ohltyler"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMjU2OQ==", "bodyText": "The call out for the case before model training may just be \"attempting to initialize with existing/historical data\"/\"Model training is starting soon\", no data/time/progress needed to cause confusion or panic (yet).", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470312569", "createdAt": "2020-08-14T00:02:28Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcwNzU4Ng==", "bodyText": "First, UX does not show needed shingles.  They only look at progress and estimated time.  Second, as an API user, I don't feel it causes confusion when we show needed shingles.  For example, one minute ago, we need 128 shingles.  After 1 minute, we need 0.  It means we find enough training data.  At that particular moment, the needed shingles are accurate.  If cold start is stuck or retrying, the number also gives clarification on the state.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r471707586", "createdAt": "2020-08-17T18:47:49Z", "author": {"login": "kaituo"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4OTc0Nw==", "bodyText": "why not apply a more consistent logic to make code more maintainable and understandable? that is before a model is created, the time and data it needs to wait is either both unknown or both guessed. Or, what's the benefit of having mixed results from different logic for each field?\nthis is a question not a blocker", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r471789747", "createdAt": "2020-08-17T21:39:05Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg0NTUxNw==", "bodyText": "The data it needs to wait is not guessed.  The time is.  Without a checkpoint, it is accurate to say we need 128 shingles.\nThe benefit is provide transparency instead of guessing.\nThanks for not blocking.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r471845517", "createdAt": "2020-08-18T00:27:31Z", "author": {"login": "kaituo"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -391,19 +399,26 @@ private void processInitResponse(\n         String detectorId,\n         Set<ProfileName> profilesToCollect,\n         MultiResponsesDelegateActionListener<DetectorProfile> listener,\n-        long totalUpdates\n+        long totalUpdates,\n+        boolean hideMinutesLeft", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwMDc4MA=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzNzkzNzUyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxODozNToxOVrOHAYkmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxOTo1MjowMlrOHAbQwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2NDYzMw==", "bodyText": "any chance the passed in requiredSamples is null/0?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470164633", "createdAt": "2020-08-13T18:35:19Z", "author": {"login": "ohltyler"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -308,6 +301,17 @@ private void profileStateRelated(\n         }, exception -> { listener.failImmediately(FAIL_TO_FIND_DETECTOR_MSG + detectorId, exception); });\n     }\n \n+    private InitProgressProfile computeInitProgressProfile(long totalUpdates, long intervalMins) {\n+        float percent = (100.0f * totalUpdates) / requiredSamples;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTQ2MA==", "bodyText": "It is possible.  I added code to throw exception.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470205460", "createdAt": "2020-08-13T19:45:27Z", "author": {"login": "kaituo"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -308,6 +301,17 @@ private void profileStateRelated(\n         }, exception -> { listener.failImmediately(FAIL_TO_FIND_DETECTOR_MSG + detectorId, exception); });\n     }\n \n+    private InitProgressProfile computeInitProgressProfile(long totalUpdates, long intervalMins) {\n+        float percent = (100.0f * totalUpdates) / requiredSamples;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2NDYzMw=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwODIwMg==", "bodyText": "I see the call on line 290 is caught, what about on line 411?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470208202", "createdAt": "2020-08-13T19:50:56Z", "author": {"login": "ohltyler"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -308,6 +301,17 @@ private void profileStateRelated(\n         }, exception -> { listener.failImmediately(FAIL_TO_FIND_DETECTOR_MSG + detectorId, exception); });\n     }\n \n+    private InitProgressProfile computeInitProgressProfile(long totalUpdates, long intervalMins) {\n+        float percent = (100.0f * totalUpdates) / requiredSamples;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2NDYzMw=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwODcwNg==", "bodyText": "I see the call on line 290 is caught, what about on line 411?\n\nnevermind, I see that's caught in the outer method. LGTM", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470208706", "createdAt": "2020-08-13T19:52:02Z", "author": {"login": "ohltyler"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -308,6 +301,17 @@ private void profileStateRelated(\n         }, exception -> { listener.failImmediately(FAIL_TO_FIND_DETECTOR_MSG + detectorId, exception); });\n     }\n \n+    private InitProgressProfile computeInitProgressProfile(long totalUpdates, long intervalMins) {\n+        float percent = (100.0f * totalUpdates) / requiredSamples;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2NDYzMw=="}, "originalCommit": {"oid": "78abf95ec2cb95b82469255cac95fc33188bca67"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzODgwMTE5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QyMzowNToyN1rOHAgl6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxODo1NjowMFrOHB3ADA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NjA0MQ==", "bodyText": "testing. the testing of this condition is missing.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r470296041", "createdAt": "2020-08-13T23:05:27Z", "author": {"login": "wnbts"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -76,6 +76,9 @@ public AnomalyDetectorProfileRunner(\n         this.client = client;\n         this.xContentRegistry = xContentRegistry;\n         this.nodeFilter = nodeFilter;\n+        if (requiredSamples <= 0) {\n+            throw new IllegalArgumentException(\"required samples should be a positive number, but was \" + requiredSamples);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db10243041fb930a77840e57416647caacab8e37"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxMTc1Ng==", "bodyText": "added", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/210#discussion_r471711756", "createdAt": "2020-08-17T18:56:00Z", "author": {"login": "kaituo"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorProfileRunner.java", "diffHunk": "@@ -76,6 +76,9 @@ public AnomalyDetectorProfileRunner(\n         this.client = client;\n         this.xContentRegistry = xContentRegistry;\n         this.nodeFilter = nodeFilter;\n+        if (requiredSamples <= 0) {\n+            throw new IllegalArgumentException(\"required samples should be a positive number, but was \" + requiredSamples);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NjA0MQ=="}, "originalCommit": {"oid": "db10243041fb930a77840e57416647caacab8e37"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2918, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}