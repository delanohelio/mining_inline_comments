{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwODc3OTY3", "number": 130, "title": "fix dynamic setting of max detector/feature limit", "bodyText": "Issue #, if available:\nDescription of changes:\n\nfix dynamic setting of max detector/feature limit\n\nPUT _cluster/settings\n{\n    \"transient\" : {\n        \"opendistro.anomaly_detection.max_anomaly_detectors\" : 1\n    }\n}\n\nCreate the second detector and will get error:\n{\n    \"error\": {\n        \"root_cause\": [\n            {\n                \"type\": \"illegal_argument_exception\",\n                \"reason\": \"Can't create anomaly detector more than 1\"\n            }\n        ],\n        \"type\": \"illegal_argument_exception\",\n        \"reason\": \"Can't create anomaly detector more than 1\"\n    },\n    \"status\": 400\n}\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-05-20T16:42:55Z", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/130", "merged": true, "mergeCommit": {"oid": "713c3afda9b50636b9f819ab1821936cbc254bdb"}, "closed": true, "closedAt": "2020-05-20T21:33:46Z", "author": {"login": "ylwu-amzn"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjFbOxAH2gAyNDIwODc3OTY3OjBkYjdiZDY4NjI5NjNhZjIwOGIzZmQ0OWI4YmU3NjEzZjE2M2U4ZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjPBw2AFqTQxNTY4Njg0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0db7bd6862963af208b3fd49b8be7613f163e8f3", "author": {"user": {"login": "ylwu-amzn", "name": "Yaliang"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/0db7bd6862963af208b3fd49b8be7613f163e8f3", "committedDate": "2020-05-20T09:12:42Z", "message": "fix dynamic setting of max detector/feature limit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NTQ3NDQ4", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/130#pullrequestreview-415547448", "createdAt": "2020-05-20T17:12:01Z", "commit": {"oid": "0db7bd6862963af208b3fd49b8be7613f163e8f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNzoxMjowMlrOGYVwyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNzoxMjowMlrOGYVwyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE3NTU2MQ==", "bodyText": "maybe you can it to keep this line consistent with other lines?", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/130#discussion_r428175561", "createdAt": "2020-05-20T17:12:02Z", "author": {"login": "yizheliu-amazon"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/rest/RestIndexAnomalyDetectorAction.java", "diffHunk": "@@ -73,12 +77,16 @@ public RestIndexAnomalyDetectorAction(\n         this.requestTimeout = REQUEST_TIMEOUT.get(settings);\n         this.detectionInterval = DETECTION_INTERVAL.get(settings);\n         this.detectionWindowDelay = DETECTION_WINDOW_DELAY.get(settings);\n+        this.maxAnomalyDetectors = MAX_ANOMALY_DETECTORS.get(settings);\n+        this.maxAnomalyFeatures = MAX_ANOMALY_FEATURES.get(settings);\n         this.clusterService = clusterService;\n         // TODO: will add more cluster setting consumer later\n         // TODO: inject ClusterSettings only if clusterService is only used to get ClusterSettings\n         clusterService.getClusterSettings().addSettingsUpdateConsumer(REQUEST_TIMEOUT, it -> requestTimeout = it);\n         clusterService.getClusterSettings().addSettingsUpdateConsumer(DETECTION_INTERVAL, it -> detectionInterval = it);\n         clusterService.getClusterSettings().addSettingsUpdateConsumer(DETECTION_WINDOW_DELAY, it -> detectionWindowDelay = it);\n+        clusterService.getClusterSettings().addSettingsUpdateConsumer(MAX_ANOMALY_DETECTORS, newVal -> maxAnomalyDetectors = newVal);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0db7bd6862963af208b3fd49b8be7613f163e8f3"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NTQ5NjM3", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/130#pullrequestreview-415549637", "createdAt": "2020-05-20T17:14:51Z", "commit": {"oid": "0db7bd6862963af208b3fd49b8be7613f163e8f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2eec21fcea7c90c8cb93bca0cb8cde4bf0f2f3e", "author": {"user": {"login": "ylwu-amzn", "name": "Yaliang"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/f2eec21fcea7c90c8cb93bca0cb8cde4bf0f2f3e", "committedDate": "2020-05-20T19:32:32Z", "message": "renmae to it to keep consistent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1Njg2ODQw", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/130#pullrequestreview-415686840", "createdAt": "2020-05-20T20:23:56Z", "commit": {"oid": "f2eec21fcea7c90c8cb93bca0cb8cde4bf0f2f3e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1462, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}