{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNTAxMzg5", "number": 296, "title": "Fix edge case where entities found for preview is empty", "bodyText": "Issue #, if available:\nDescription of changes:\nFix edge case where entities found for preview is empty.\nHave verified on test domain that empty result is returned with this fix.\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-10-27T06:17:32Z", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296", "merged": true, "mergeCommit": {"oid": "ff9e3bf07e71f6814cf9a21c37efedb11da89eb1"}, "closed": true, "closedAt": "2020-10-29T00:51:52Z", "author": {"login": "yizheliu-amazon"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWizM4AH2gAyNTEwNTAxMzg5OjNhMDZlYmJmODhjZmM0N2Y2MDVlNzQ1NjNiMzBiNDQwYzMyYmVlZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXHK3lAH2gAyNTEwNTAxMzg5OjNkYzkzNzY0Y2VlZmUyYjczYTM3MjIwZjg4MzFmOGJmNGFkOWFhYjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3a06ebbf88cfc47f605e74563b30b440c32beed0", "author": {"user": {"login": "yizheliu-amazon", "name": "Yizhe Liu"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/3a06ebbf88cfc47f605e74563b30b440c32beed0", "committedDate": "2020-10-27T06:16:16Z", "message": "Fix edge case where entities found for preview is emtpy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MzgzODU2", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296#pullrequestreview-517383856", "createdAt": "2020-10-27T06:37:02Z", "commit": {"oid": "3a06ebbf88cfc47f605e74563b30b440c32beed0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjozNzowMlrOHotNsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjozNzowMlrOHotNsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0NTg3Mg==", "bodyText": "Should we return empty results or some failure like this https://github.com/opendistro-for-elasticsearch/anomaly-detection/blob/master/src/main/java/com/amazon/opendistroforelasticsearch/ad/feature/FeatureManager.java#L525", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296#discussion_r512445872", "createdAt": "2020-10-27T06:37:02Z", "author": {"login": "ylwu-amzn"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorRunner.java", "diffHunk": "@@ -72,6 +72,9 @@ public void executeDetector(AnomalyDetector detector, Instant startTime, Instant\n         if (categoryField != null && !categoryField.isEmpty()) {\n             featureManager.getPreviewEntities(detector, startTime.toEpochMilli(), endTime.toEpochMilli(), ActionListener.wrap(entities -> {\n \n+                if (entities == null || entities.isEmpty()) {\n+                    listener.onResponse(Collections.emptyList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a06ebbf88cfc47f605e74563b30b440c32beed0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTYyMjEx", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296#pullrequestreview-517962211", "createdAt": "2020-10-27T17:21:46Z", "commit": {"oid": "3a06ebbf88cfc47f605e74563b30b440c32beed0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MTkzODY3", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296#pullrequestreview-519193867", "createdAt": "2020-10-29T00:13:38Z", "commit": {"oid": "3a06ebbf88cfc47f605e74563b30b440c32beed0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dc93764ceefe2b73a37220f8831f8bf4ad9aab2", "author": {"user": {"login": "yizheliu-amazon", "name": "Yizhe Liu"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/3dc93764ceefe2b73a37220f8831f8bf4ad9aab2", "committedDate": "2020-10-29T00:38:42Z", "message": "Add TODO to further improve reponse of Preview API and error handling on Front-end"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1410, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}