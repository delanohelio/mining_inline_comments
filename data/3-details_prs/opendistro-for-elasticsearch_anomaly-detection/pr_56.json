{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NjQwMjQ0", "number": 56, "title": "Add threadpool prefix and change threadpool name", "bodyText": "When we run AD and SQL plugin together, ES fails to start with registering a setting twice error. AD's threadpool setting prefix is null. Since SQL plugin uses null as well, we would have a register setting conflict because we cannot register setting [null.size] twice. The fix is to give our threadpool a setting name prefix instead of null\nAlso, this threadpool would be used by other components besides AD job.  Rename it to make it not ad job specific.\nTesting done:\n\nrun all unit and integration tests\nES can start with AD and SQL plugin enabled\n\nIssue #, if available:\nDescription of changes:\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-03-06T05:23:23Z", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/56", "merged": true, "mergeCommit": {"oid": "b4f34864135c7acc4feddb21104f7eecf5d0331e"}, "closed": true, "closedAt": "2020-03-07T02:58:18Z", "author": {"login": "kaituo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcK5K6bAH2gAyMzg0NjQwMjQ0OjlhM2I2NTNjZjllNTk2Y2ZlN2ZmOWI5NzAwMjgyYzVkZmQzNjE1Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLENHsAFqTM3MDUyNTY0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9a3b653cf9e596cfe7ff9b9700282c5dfd361569", "author": {"user": {"login": "kaituo", "name": "Kaituo Li"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/9a3b653cf9e596cfe7ff9b9700282c5dfd361569", "committedDate": "2020-03-06T05:21:50Z", "message": "Add threadpool prefix and change threadpool name\n\nWhen we run AD and SQL plugin together, ES fails to start with registering a setting twice error. AD's threadpool setting prefix is null. Since SQL plugin uses null as well, we would have a register setting conflict because we cannot register setting [null.size] twice. The fix is to give our threadpool a setting name prefix instead of null\n\nAlso, this threadpool would be used by other components besides AD job.  Rename it to make it not ad job specific.\n\nTesting done:\n- run all unit and integration tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMDkzMTAz", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/56#pullrequestreview-370093103", "createdAt": "2020-03-06T05:42:28Z", "commit": {"oid": "9a3b653cf9e596cfe7ff9b9700282c5dfd361569"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwNTo0MjoyOFrOFytuuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwNTo0MjoyOFrOFytuuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODcyMjM2MQ==", "bodyText": "How about we use \"opendistro.ad.\"+ AD_THREAD_POOL_NAME ? So we can know exactly which threadpool it maps to.", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/56#discussion_r388722361", "createdAt": "2020-03-06T05:42:28Z", "author": {"login": "ylwu-amzn"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/AnomalyDetectorPlugin.java", "diffHunk": "@@ -346,10 +346,10 @@ private static Void initGson() {\n             .singletonList(\n                 new FixedExecutorBuilder(\n                     settings,\n-                    AD_JOB_THREAD_POOL_NAME,\n+                    AD_THREAD_POOL_NAME,\n                     Math.max(1, EsExecutors.numberOfProcessors(settings) / 4),\n-                    AD_JOB_THEAD_POOL_QUEUE_SIZE,\n-                    null\n+                    AD_THEAD_POOL_QUEUE_SIZE,\n+                    \"opendistro.ad.ad_thread_pool\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a3b653cf9e596cfe7ff9b9700282c5dfd361569"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22da669226407e72c874a763fcdc5208a508377c", "author": {"user": {"login": "kaituo", "name": "Kaituo Li"}}, "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/22da669226407e72c874a763fcdc5208a508377c", "committedDate": "2020-03-06T06:09:05Z", "message": "Change prefix to include threadpool name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNDk2MjE3", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/56#pullrequestreview-370496217", "createdAt": "2020-03-06T17:24:23Z", "commit": {"oid": "22da669226407e72c874a763fcdc5208a508377c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNTI1NjQ0", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/56#pullrequestreview-370525644", "createdAt": "2020-03-06T18:13:12Z", "commit": {"oid": "22da669226407e72c874a763fcdc5208a508377c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1631, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}