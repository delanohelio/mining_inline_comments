{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMDc4MzQx", "number": 112, "title": "DEV-1101 Integrate pipeline5 with bcl2fastq on GCP", "bodyText": "Adds a toggle that once enabled, will upload fastq input from GCP rather than the SBP S3.\nThe location of the fastq is still taken from the SBP API (run->sample->fastq).\nAlso updated the Bcl2Fastq command thread settings to match production.", "createdAt": "2020-01-09T17:37:50Z", "url": "https://github.com/hartwigmedical/pipeline5/pull/112", "merged": true, "mergeCommit": {"oid": "aefb2c82899233e68a5536c520159e0d42496f02"}, "closed": true, "closedAt": "2020-01-14T19:58:54Z", "author": {"login": "pauldwolfe"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4GqijgH2gAyMzYxMDc4MzQxOjFlMDBkZTE4NDhkOTg5YWU0NDMyNDQ5NDBhMzY1ZTdhNDUyNGU2YmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6FU6LAH2gAyMzYxMDc4MzQxOjYwODU2YTY1YThjZTQ3YWEwYzcwOGNiOWZkNDdhMjVlZjg3N2Y5OGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e00de1848d989ae443244940a365e7a4524e6be", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/1e00de1848d989ae443244940a365e7a4524e6be", "committedDate": "2020-01-07T20:20:35Z", "message": "DEV-1101 Fix bugs found in initial integration\n\nFastq files were not getting picked up when listing the runtime bucket. Fastq filenames should have\nthe flowcell name included as the second token."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c52ca77d09bd51736eea6622ca15bf2481671170", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/c52ca77d09bd51736eea6622ca15bf2481671170", "committedDate": "2020-01-09T17:36:42Z", "message": "DEV-1101 Add integration for fastq located in GCP to the pipeline\n\nAdds a toggle that once enabled, will upload fastq input from GCP rather than the SBP S3.\nThe location of the fastq is still taken from the SBP API (run->sample->fastq).\n\nAlso updated the Bcl2Fastq command thread settings to match production."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16b0b95ac834b3e5620a4c21d8dd35477e185897", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/16b0b95ac834b3e5620a4c21d8dd35477e185897", "committedDate": "2020-01-09T19:21:44Z", "message": "DEV-1101 Build docker for branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd62f1da1075c62f1d2ddba164bc91c48145e624", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/fd62f1da1075c62f1d2ddba164bc91c48145e624", "committedDate": "2020-01-09T19:57:31Z", "message": "DEV-1101 Use correct main in docker container"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "372199a065a6b91c7bb0af297eb5e2b15c05cc0f", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/372199a065a6b91c7bb0af297eb5e2b15c05cc0f", "committedDate": "2020-01-09T22:12:50Z", "message": "DEV-1101 Remove private key path from docker profile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9c8141c3058d915bac4618a4855a4cc66423361", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/e9c8141c3058d915bac4618a4855a4cc66423361", "committedDate": "2020-01-09T22:13:05Z", "message": "DEV-1101 Remove private key path from docker profile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44b72c0569cfe0464f8a7fa9f9ada2979312f3cf", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/44b72c0569cfe0464f8a7fa9f9ada2979312f3cf", "committedDate": "2020-01-10T20:26:09Z", "message": "DEV-1101 Remove private key path from docker profile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a39eaf0ac580e46e683b076d90fcbf2471d76a3", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/8a39eaf0ac580e46e683b076d90fcbf2471d76a3", "committedDate": "2020-01-13T17:39:22Z", "message": "Merge branch 'master' into DEV-1101"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMTU2NTIy", "url": "https://github.com/hartwigmedical/pipeline5/pull/112#pullrequestreview-342156522", "createdAt": "2020-01-13T21:38:17Z", "commit": {"oid": "e9c8141c3058d915bac4618a4855a4cc66423361"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QyMTozODoxN1rOFdFb1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QyMTo0NDoyMVrOFdFl_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA0MjA3MA==", "bodyText": "Response.Status.CREATED or something similar?", "url": "https://github.com/hartwigmedical/pipeline5/pull/112#discussion_r366042070", "createdAt": "2020-01-13T21:38:17Z", "author": {"login": "nedleitch"}, "path": "bcl2fastq/src/main/java/com/hartwig/bcl2fastq/metadata/SbpFastqMetadataApi.java", "diffHunk": "@@ -55,7 +55,7 @@ public SbpSample findOrCreate(String barcode, String submission) {\n                 try {\n                     Response response = samples().request()\n                             .post(Entity.entity(objectMapper.writeValueAsString(sample), MediaType.APPLICATION_JSON_TYPE));\n-                    if (response.getStatus() == 200) {\n+                    if (response.getStatus() == 201) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9c8141c3058d915bac4618a4855a4cc66423361"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA0Mjc2OQ==", "bodyText": "Much better.", "url": "https://github.com/hartwigmedical/pipeline5/pull/112#discussion_r366042769", "createdAt": "2020-01-13T21:39:57Z", "author": {"login": "nedleitch"}, "path": "cluster/src/main/java/com/hartwig/pipeline/execution/vm/VirtualMachinePerformanceProfile.java", "diffHunk": "@@ -1,24 +1,26 @@\n package com.hartwig.pipeline.execution.vm;\n \n-import static java.lang.String.format;\n-\n import com.hartwig.pipeline.execution.MachineType;\n import com.hartwig.pipeline.execution.PerformanceProfile;\n \n import org.immutables.value.Value;\n \n @Value.Immutable\n-public interface VirtualMachinePerformanceProfile extends PerformanceProfile{\n+public interface VirtualMachinePerformanceProfile extends PerformanceProfile {\n+\n+    @Value.Default\n+    default String uri() {\n+        return machineType().uri();\n+    }\n \n-    String uri();\n+    MachineType machineType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9c8141c3058d915bac4618a4855a4cc66423361"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjA0NDY3MA==", "bodyText": "We have had surprises in the past, would it be wise to check the filename conforms to expectations?", "url": "https://github.com/hartwigmedical/pipeline5/pull/112#discussion_r366044670", "createdAt": "2020-01-13T21:44:21Z", "author": {"login": "nedleitch"}, "path": "bcl2fastq/src/main/java/com/hartwig/bcl2fastq/conversion/ResultAggregation.java", "diffHunk": "@@ -95,7 +95,15 @@ static ConvertedFastq fastq(IlluminaSample sample, Map.Entry<String, List<Blob>>\n     }\n \n     private static String outputPath(final IlluminaSample sample, final Stats stats, final Blob blobR1) {\n-        return stats.flowcell() + \"/\" + sample.barcode() + \"/\" + new File(blobR1.getName()).getName();\n+        String[] fileNameSplit = new File(blobR1.getName()).getName().split(\"_\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9c8141c3058d915bac4618a4855a4cc66423361"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03e8246aa22b736dfb0497515f6dea2d6d239cfb", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/03e8246aa22b736dfb0497515f6dea2d6d239cfb", "committedDate": "2020-01-13T22:03:49Z", "message": "DEV-1101 Still link flowcell, samples, fastq on flowcell QC fail"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60856a65a8ce47aa0c708cb9fd47a25ef877f98f", "author": {"user": null}, "url": "https://github.com/hartwigmedical/pipeline5/commit/60856a65a8ce47aa0c708cb9fd47a25ef877f98f", "committedDate": "2020-01-13T23:54:54Z", "message": "DEV-1101 Review comments\n\nUse jax-rs constants for created status."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3770, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}