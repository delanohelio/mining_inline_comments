{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NDk2MTEz", "number": 1136, "title": "Allows correlation fields to not match `BaggageField` names", "bodyText": "This helps port code which formerly added different naming conventions\nfor span IDs.\nEx. If your log property is %X{trace-id}, you can do this:\nbuilder.clear(); // traceId is a default field!\nbuilder.addField(BaggageFields.TRACE_ID, \"trace-id\");", "createdAt": "2020-04-02T10:41:00Z", "url": "https://github.com/openzipkin/brave/pull/1136", "merged": true, "mergeCommit": {"oid": "6cec1bd3b680f83b6ff2c6e91d1cf88a78af7e5d"}, "closed": true, "closedAt": "2020-04-02T11:48:39Z", "author": {"login": "codefromthecrypt"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTp5R9gH2gAyMzk3NDk2MTEzOmI5YmM5ZGRiNjc0YzdmMmE2YmNmNjlmZjVmMGNhMjEwNzhlNmU1M2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTqghrgH2gAyMzk3NDk2MTEzOmVlNTRkM2JiOGFlZTdhYjQ3NmM5MzY3OGI5MGU4ZmI0ODg4MTc3YTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c", "author": {"user": null}, "url": "https://github.com/openzipkin/brave/commit/b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c", "committedDate": "2020-04-02T10:39:19Z", "message": "Allows correlation fields to not match `BaggageField` names\n\nThis helps port code which formerly added different naming conventions\nfor span IDs.\n\nEx. If your log property is %X{trace-id}, you can do this:\n```java\nbuilder.clear(); // traceId is a default field!\nbuilder.addField(BaggageFields.TRACE_ID, \"trace-id\");\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MzA2MjUy", "url": "https://github.com/openzipkin/brave/pull/1136#pullrequestreview-386306252", "createdAt": "2020-04-02T10:41:48Z", "commit": {"oid": "b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDo0MTo0OFrOF_lcyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDo0Mjo1MVrOF_le3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxODE4NA==", "bodyText": "bug", "url": "https://github.com/openzipkin/brave/pull/1136#discussion_r402218184", "createdAt": "2020-04-02T10:41:48Z", "author": {"login": "codefromthecrypt"}, "path": "brave/src/main/java/brave/baggage/BaggagePropagation.java", "diffHunk": "@@ -102,7 +102,7 @@ public static FactoryBuilder newFactoryBuilder(Propagation.Factory delegate) {\n      * @since 5.11\n      */\n     public Map<BaggageField, Set<String>> fieldToKeyNames() {\n-      return Collections.unmodifiableMap(fieldToKeyNames);\n+      return Collections.unmodifiableMap(new LinkedHashMap<>(fieldToKeyNames));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxODIzNg==", "bodyText": "bug", "url": "https://github.com/openzipkin/brave/pull/1136#discussion_r402218236", "createdAt": "2020-04-02T10:41:55Z", "author": {"login": "codefromthecrypt"}, "path": "brave/src/main/java/brave/baggage/BaggagePropagation.java", "diffHunk": "@@ -171,7 +171,12 @@ public FactoryBuilder addRemoteField(BaggageField field, Iterable<String> keyNam\n         allKeyNames.add(lcName);\n         lcKeyNames.add(lcName);\n       }\n-      if (lcKeyNames.isEmpty()) lcKeyNames.add(field.lcName);\n+\n+      if (lcKeyNames.isEmpty()) { // add the default name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxODcxOA==", "bodyText": "we need this because customizers act on builders.. we don't always know if there will be any configuration at all.", "url": "https://github.com/openzipkin/brave/pull/1136#discussion_r402218718", "createdAt": "2020-04-02T10:42:51Z", "author": {"login": "codefromthecrypt"}, "path": "brave/src/main/java/brave/propagation/CurrentTraceContext.java", "diffHunk": "@@ -53,6 +51,7 @@\n      */\n     public Builder addScopeDecorator(ScopeDecorator scopeDecorator) {\n       if (scopeDecorator == null) throw new NullPointerException(\"scopeDecorator == null\");\n+      if (scopeDecorator == ScopeDecorator.NOOP) return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9bc9ddb674c7f2a6bcf69ff5f0ca21078e6e53c"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee54d3bb8aee7ab476c93678b90e8fb4888177a0", "author": {"user": null}, "url": "https://github.com/openzipkin/brave/commit/ee54d3bb8aee7ab476c93678b90e8fb4888177a0", "committedDate": "2020-04-02T11:22:11Z", "message": "drift"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1916, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}