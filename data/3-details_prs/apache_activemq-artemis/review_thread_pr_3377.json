{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NTY3MTE1", "number": 3377, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTowNzozM1rOFDRjaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNToxNTo0OVrOFDRrDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4OTc3NjQwOnYy", "diffSide": "RIGHT", "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTowNzozM1rOIC1wQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozNzoyNlrOIC2WyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg0ODc2OA==", "bodyText": "Nit. Why is the E capitalised. Reencoded is a single word. https://en.m.wiktionary.org/wiki/reencoded", "url": "https://github.com/apache/activemq-artemis/pull/3377#discussion_r539848768", "createdAt": "2020-12-10T05:07:33Z", "author": {"login": "michaelandrepearce"}, "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "diffHunk": "@@ -622,7 +624,15 @@ public long getPersistentSize() throws ActiveMQException {\n \n    @Override\n    public void reencode() {\n+      reEncoded = true;\n+   }\n+\n+   public void setReEncoded(boolean reEncoded) {\n+      this.reEncoded = reEncoded;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffa7f9ff85347105e2737a189b3fc4e50fe7f893"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1ODYzMg==", "bodyText": "right.. fixed it. thanks", "url": "https://github.com/apache/activemq-artemis/pull/3377#discussion_r539858632", "createdAt": "2020-12-10T05:37:26Z", "author": {"login": "clebertsuconic"}, "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "diffHunk": "@@ -622,7 +624,15 @@ public long getPersistentSize() throws ActiveMQException {\n \n    @Override\n    public void reencode() {\n+      reEncoded = true;\n+   }\n+\n+   public void setReEncoded(boolean reEncoded) {\n+      this.reEncoded = reEncoded;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg0ODc2OA=="}, "originalCommit": {"oid": "ffa7f9ff85347105e2737a189b3fc4e50fe7f893"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4OTc5NTk4OnYy", "diffSide": "RIGHT", "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNToxNTo0OVrOIC16ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozNDozM1rOIC2SrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1MTQ1MA==", "bodyText": "Why isnt the reencoding happening immediately like for other messages (amqp standard, core etc) and expected behaviour, e.g. other areas of code and plugins are expecting the message to rencoded by calling this without doing extra work. I can be missing something.", "url": "https://github.com/apache/activemq-artemis/pull/3377#discussion_r539851450", "createdAt": "2020-12-10T05:15:49Z", "author": {"login": "michaelandrepearce"}, "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "diffHunk": "@@ -622,7 +624,15 @@ public long getPersistentSize() throws ActiveMQException {\n \n    @Override\n    public void reencode() {\n+      reEncoded = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffa7f9ff85347105e2737a189b3fc4e50fe7f893"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1NzU4MA==", "bodyText": "It would be fairly difficult to re-encode the message on the large message file.\nFor AMQP Large messages, I'm instead just flagging the message as re-encoded, and I would replace the stream during the delivery.", "url": "https://github.com/apache/activemq-artemis/pull/3377#discussion_r539857580", "createdAt": "2020-12-10T05:34:33Z", "author": {"login": "clebertsuconic"}, "path": "artemis-protocols/artemis-amqp-protocol/src/main/java/org/apache/activemq/artemis/protocol/amqp/broker/AMQPLargeMessage.java", "diffHunk": "@@ -622,7 +624,15 @@ public long getPersistentSize() throws ActiveMQException {\n \n    @Override\n    public void reencode() {\n+      reEncoded = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1MTQ1MA=="}, "originalCommit": {"oid": "ffa7f9ff85347105e2737a189b3fc4e50fe7f893"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3936, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}