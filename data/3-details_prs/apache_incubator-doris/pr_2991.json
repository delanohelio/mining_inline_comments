{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NTk2NTQ5", "number": 2991, "title": "Output null for hll and bitmap column when select *", "bodyText": "For #2976", "createdAt": "2020-02-25T13:53:51Z", "url": "https://github.com/apache/incubator-doris/pull/2991", "merged": true, "mergeCommit": {"oid": "aa540966c6e054fb741de179f4b239d23fccf148"}, "closed": true, "closedAt": "2020-03-13T03:59:31Z", "author": {"login": "kangkaisen"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH919dAFqTM2NDU5NzAxNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNIDuAAFqTM3NDAzNTczMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTk3MDE0", "url": "https://github.com/apache/incubator-doris/pull/2991#pullrequestreview-364597014", "createdAt": "2020-02-26T03:06:38Z", "commit": {"oid": "73527ba22ac536995529c172d69461019f33717f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzowNjozOFrOFuc6tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzowNjozOFrOFuc6tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1MjU5OA==", "bodyText": "I don't think this change is very suitable.\n\nI think the behavior of select * and select a specific column should be consistent.\nThe current modification method may have problems when inserting into select *, or when sub-queries, such as select hll_union (hll_col) from (select *);\n\nI think we can do it in backend. When encountering HLL type or Bitmap type, ResultSink can send null directly.", "url": "https://github.com/apache/incubator-doris/pull/2991#discussion_r384252598", "createdAt": "2020-02-26T03:06:38Z", "author": {"login": "imay"}, "path": "fe/src/main/java/org/apache/doris/analysis/SelectStmt.java", "diffHunk": "@@ -786,15 +785,14 @@ private void expandStar(Analyzer analyzer, TableName tblName) throws AnalysisExc\n      * Expand \"*\" for a particular tuple descriptor by appending\n      * refs for each column to selectListExprs.\n      */\n-    private void expandStar(TableName tblName, TupleDescriptor desc) throws AnalysisException {\n+    private void expandStar(TableName tblName, TupleDescriptor desc) {\n         for (Column col : desc.getTable().getBaseSchema()) {\n-            if (col.getDataType() == PrimitiveType.HLL && !fromInsert) {\n-                throw new AnalysisException(Type.OnlyMetricTypeErrorMsg);\n-            }\n-            if (col.getAggregationType() == AggregateType.BITMAP_UNION && !fromInsert) {\n-                throw new AnalysisException(Type.OnlyMetricTypeErrorMsg);\n+            PrimitiveType type = col.getDataType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73527ba22ac536995529c172d69461019f33717f"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73527ba22ac536995529c172d69461019f33717f", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/73527ba22ac536995529c172d69461019f33717f", "committedDate": "2020-02-25T13:51:35Z", "message": "Output null for hll and bitmap column when select *"}, "afterCommit": {"oid": "8d559b806287fac3339cddfc7dc9756f97afb4d2", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/8d559b806287fac3339cddfc7dc9756f97afb4d2", "committedDate": "2020-03-12T13:50:48Z", "message": "Output null for hll and bitmap column when select *"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNTgxMjE2", "url": "https://github.com/apache/incubator-doris/pull/2991#pullrequestreview-373581216", "createdAt": "2020-03-12T14:01:53Z", "commit": {"oid": "8d559b806287fac3339cddfc7dc9756f97afb4d2"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d559b806287fac3339cddfc7dc9756f97afb4d2", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/8d559b806287fac3339cddfc7dc9756f97afb4d2", "committedDate": "2020-03-12T13:50:48Z", "message": "Output null for hll and bitmap column when select *"}, "afterCommit": {"oid": "882862f267c7928076f554ba8dbf45f8ab4c058d", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/882862f267c7928076f554ba8dbf45f8ab4c058d", "committedDate": "2020-03-12T14:07:02Z", "message": "Output null for hll and bitmap column when select *"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c6aa2228670848af28c5f335041abd2ded4e2dd", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/9c6aa2228670848af28c5f335041abd2ded4e2dd", "committedDate": "2020-03-13T03:46:20Z", "message": "Output null for hll and bitmap column when select *"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "882862f267c7928076f554ba8dbf45f8ab4c058d", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/882862f267c7928076f554ba8dbf45f8ab4c058d", "committedDate": "2020-03-12T14:07:02Z", "message": "Output null for hll and bitmap column when select *"}, "afterCommit": {"oid": "9c6aa2228670848af28c5f335041abd2ded4e2dd", "author": {"user": {"login": "kangkaisen", "name": "kangkaisen "}}, "url": "https://github.com/apache/incubator-doris/commit/9c6aa2228670848af28c5f335041abd2ded4e2dd", "committedDate": "2020-03-13T03:46:20Z", "message": "Output null for hll and bitmap column when select *"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MDM1NzMy", "url": "https://github.com/apache/incubator-doris/pull/2991#pullrequestreview-374035732", "createdAt": "2020-03-13T03:50:24Z", "commit": {"oid": "9c6aa2228670848af28c5f335041abd2ded4e2dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3449, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}