{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTczMjg2", "number": 3098, "title": "[Bug] tablet meta is not updated correctly after compaction", "bodyText": "This CL try to fix a potential bug describe in ISSUE: #3097. But I'm not sure this is the root cause.\nAlso remove lots of verbose log, and fix a memory leak.", "createdAt": "2020-03-13T03:30:06Z", "url": "https://github.com/apache/incubator-doris/pull/3098", "merged": true, "mergeCommit": {"oid": "42931d22cbabdca6183374a7d3b1fae9f4e98d07"}, "closed": true, "closedAt": "2020-03-14T15:39:12Z", "author": {"login": "morningman"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNHnaegH2gAyMzg3NTczMjg2OjZmZmI0ZDIxYzMxMzY4NGRlNmY1ZWVlNmVkM2FiN2JiOThjZjI5ZDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNR4WbAFqTM3NDM4NTEzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ffb4d21c313684de6f5eee6ed3ab7bb98cf29d5", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/6ffb4d21c313684de6f5eee6ed3ab7bb98cf29d5", "committedDate": "2020-03-13T03:19:29Z", "message": "fix bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/5574b05f61545bddec3b6a343db36f9c8e8d4a2d", "committedDate": "2020-03-13T03:37:33Z", "message": "fix bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MDMzNjg0", "url": "https://github.com/apache/incubator-doris/pull/3098#pullrequestreview-374033684", "createdAt": "2020-03-13T03:40:55Z", "commit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0MDo1NVrOF12x0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0Mjo1NVrOF12zFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjMzOQ==", "bodyText": "Why add a check for largest_segment_group->current_num_rows_per_row_block() == 0?\nYou encounter this issue #2750?", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392016339", "createdAt": "2020-03-13T03:40:55Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/rowset/alpha_rowset.cpp", "diffHunk": "@@ -166,7 +166,9 @@ OLAPStatus AlphaRowset::split_range(\n     RowBlockPosition step_pos;\n \n     std::shared_ptr<SegmentGroup> largest_segment_group = _segment_group_with_largest_size();\n-    if (largest_segment_group == nullptr) {\n+    if (largest_segment_group == nullptr || largest_segment_group->current_num_rows_per_row_block() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjY2Mw==", "bodyText": "I think we shouldn't remove these logs.\nThese logs are very important for track transaction issue.", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392016663", "createdAt": "2020-03-13T03:42:55Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/task/engine_publish_version_task.cpp", "diffHunk": "@@ -60,7 +60,7 @@ OLAPStatus EnginePublishVersionTask::finish() {\n             OLAPStatus publish_status = OLAP_SUCCESS;\n             TabletInfo tablet_info = tablet_rs.first;\n             RowsetSharedPtr rowset = tablet_rs.second;\n-            LOG(INFO) << \"begin to publish version on tablet. \"\n+            VLOG(3) << \"begin to publish version on tablet. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "997063c8d931c62add20acc0c989eed24c86cde5", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/997063c8d931c62add20acc0c989eed24c86cde5", "committedDate": "2020-03-13T13:50:48Z", "message": "fix by review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0Mzg1MTMy", "url": "https://github.com/apache/incubator-doris/pull/3098#pullrequestreview-374385132", "createdAt": "2020-03-13T15:17:02Z", "commit": {"oid": "997063c8d931c62add20acc0c989eed24c86cde5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3574, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}