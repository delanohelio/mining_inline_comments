{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMDI2MDI3", "number": 3799, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDoyMzoxNlrOED57xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDoyMzo0NVrOED58ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNTMwMzcyOnYy", "diffSide": "RIGHT", "path": "docs/en/administrator-guide/dynamic-partition.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDoyMzoxNlrOGhMnlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNToxMzowMlrOGhPHCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MjkzMg==", "bodyText": "How about finding timezone here?\nhttps://en.wikipedia.org/wiki/List_of_tz_database_time_zones", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437462932", "createdAt": "2020-06-09T14:23:16Z", "author": {"login": "morningman"}, "path": "docs/en/administrator-guide/dynamic-partition.md", "diffHunk": "@@ -89,6 +89,10 @@ The rules of dynamic partition are prefixed with `dynamic_partition.`:\n \n     When specified as `MONTH`, the suffix format of the dynamically created partition name is `yyyyMM`, for example, `202003`.\n \n+* `dynamic_partition.time_zone`\n+\n+    The time zone of the dynamic partition, if not filled in, defaults to the time zone of the current machine's system, such as `Asia/Shanghai`, if you want to know the supported TimeZone, you can run `TimeZone.getAvailableIDs()` in Java.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUwMzc1Mg==", "bodyText": "done", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437503752", "createdAt": "2020-06-09T15:13:02Z", "author": {"login": "WingsGo"}, "path": "docs/en/administrator-guide/dynamic-partition.md", "diffHunk": "@@ -89,6 +89,10 @@ The rules of dynamic partition are prefixed with `dynamic_partition.`:\n \n     When specified as `MONTH`, the suffix format of the dynamically created partition name is `yyyyMM`, for example, `202003`.\n \n+* `dynamic_partition.time_zone`\n+\n+    The time zone of the dynamic partition, if not filled in, defaults to the time zone of the current machine's system, such as `Asia/Shanghai`, if you want to know the supported TimeZone, you can run `TimeZone.getAvailableIDs()` in Java.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MjkzMg=="}, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNTMwNTYyOnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/catalog/DynamicPartitionProperty.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDoyMzo0MVrOGhMo3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNToyMjoxNVrOGhP2jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MzI2Mg==", "bodyText": "Better move the time related functions to TimeUtils class", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437463262", "createdAt": "2020-06-09T14:23:41Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/catalog/DynamicPartitionProperty.java", "diffHunk": "@@ -46,15 +48,14 @@\n     private int buckets;\n     private StartOfDate startOfWeek;\n     private StartOfDate startOfMonth;\n-    // TODO: support setting timezone.\n     private TimeZone tz = TimeUtils.getDefaultTimeZone();\n \n-\n     public DynamicPartitionProperty(Map<String, String> properties) {\n         if (properties != null && !properties.isEmpty()) {\n             this.exist = true;\n             this.enable = Boolean.parseBoolean(properties.get(ENABLE));\n             this.timeUnit = properties.get(TIME_UNIT);\n+            this.tz = TimeZone.getTimeZone(properties.getOrDefault(TIME_ZONE, ZoneId.systemDefault().toString()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUxNTkxNw==", "bodyText": "done", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437515917", "createdAt": "2020-06-09T15:22:15Z", "author": {"login": "WingsGo"}, "path": "fe/src/main/java/org/apache/doris/catalog/DynamicPartitionProperty.java", "diffHunk": "@@ -46,15 +48,14 @@\n     private int buckets;\n     private StartOfDate startOfWeek;\n     private StartOfDate startOfMonth;\n-    // TODO: support setting timezone.\n     private TimeZone tz = TimeUtils.getDefaultTimeZone();\n \n-\n     public DynamicPartitionProperty(Map<String, String> properties) {\n         if (properties != null && !properties.isEmpty()) {\n             this.exist = true;\n             this.enable = Boolean.parseBoolean(properties.get(ENABLE));\n             this.timeUnit = properties.get(TIME_UNIT);\n+            this.tz = TimeZone.getTimeZone(properties.getOrDefault(TIME_ZONE, ZoneId.systemDefault().toString()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MzI2Mg=="}, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNTMwNTk1OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/common/util/DynamicPartitionUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDoyMzo0NVrOGhMpFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNToxMjo1NVrOGhPGdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MzMxNw==", "bodyText": "Why not using TimeUtils.checkTimeZoneValidAndStandardize()?", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437463317", "createdAt": "2020-06-09T14:23:45Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/common/util/DynamicPartitionUtil.java", "diffHunk": "@@ -148,11 +151,25 @@ private static void checkStartDayOfWeek(String val) throws DdlException {\n         }\n     }\n \n+    private static void checkTimeZone(String val) throws DdlException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUwMzYwNA==", "bodyText": "In fact, i don't konw the function...", "url": "https://github.com/apache/incubator-doris/pull/3799#discussion_r437503604", "createdAt": "2020-06-09T15:12:55Z", "author": {"login": "WingsGo"}, "path": "fe/src/main/java/org/apache/doris/common/util/DynamicPartitionUtil.java", "diffHunk": "@@ -148,11 +151,25 @@ private static void checkStartDayOfWeek(String val) throws DdlException {\n         }\n     }\n \n+    private static void checkTimeZone(String val) throws DdlException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ2MzMxNw=="}, "originalCommit": {"oid": "36349b2948aa7c92f0e6895b7ec2b6b1d5405c2e"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1471, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}