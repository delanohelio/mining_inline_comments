{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NDk0NDc0", "number": 2796, "title": "Improve comparison and printing of Version", "bodyText": "There are two members in Version: first and second.\nThere are many places where we need to print one Version object  and\ncompare two Version objects, but in the current code, these two members\nare accessed directly, which makes the code very tedious.\nThis patch mainly do:\n\nAdds overloaded methods for operator<<() for Version, so\nwe can directly print a Version object;\nAdds the cantains() method to determine whether it is an containment\nrelationship;\nUses operator==() to determine if two Version objects are equal.\n\nBecause there are too many places need to be modified, there are still some\nnaked codes left, which will be modified later.\nThis patch also removes some necessary header file references.\nNo functional changes in this patch.", "createdAt": "2020-01-19T04:28:30Z", "url": "https://github.com/apache/incubator-doris/pull/2796", "merged": true, "mergeCommit": {"oid": "7c4149cf2786fe7965e73304d6adb951ca1f9661"}, "closed": true, "closedAt": "2020-01-19T10:04:29Z", "author": {"login": "lingbin"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7v4w4AH2gAyMzY0NDk0NDc0OjBkYzE5MzU3ZjAwOTMyZTBlY2E4ZjY5MTM4OTMwMzJmNWRlZTlhYjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb71AyCgFqTM0NDk5MDc3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0dc19357f00932e0eca8f6913893032f5dee9ab0", "author": {"user": {"login": "lingbin", "name": "LingBin"}}, "url": "https://github.com/apache/incubator-doris/commit/0dc19357f00932e0eca8f6913893032f5dee9ab0", "committedDate": "2020-01-19T04:04:00Z", "message": "Improve comparison and printing of Version\n\nThere are two members in `Version`:` first` and `second`.\nThere are many places where we need to print one `Version` object  and\ncompare two `Version` objects, but in the current code, these two members\nare accessed directly, which makes the code very tedious.\n\nThis patch mainly do:\n1. Adds overloaded methods for `operator<<()` for `Version`, so\n   we can directly print a Version object;\n2. Adds the `cantains()` method to determine whether it is an containment\n   relationship;\n3. Uses `operator==()` to determine if two `Version` objects are equal.\n\nBecause there are too many places need to be modified, there are still some\nnaked codes left, which will be modified later.\n\nThis patch also removes some necessary header file references.\n\nNo functional changes in this patch."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTgzOTcw", "url": "https://github.com/apache/incubator-doris/pull/2796#pullrequestreview-344983970", "createdAt": "2020-01-19T08:01:56Z", "commit": {"oid": "0dc19357f00932e0eca8f6913893032f5dee9ab0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQwODowMTo1NlrOFfNpjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQwODowODozNlrOFfNqzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI3MzgwNw==", "bodyText": "it is not correspond with the definition of contains() function", "url": "https://github.com/apache/incubator-doris/pull/2796#discussion_r368273807", "createdAt": "2020-01-19T08:01:56Z", "author": {"login": "chaoyli"}, "path": "be/src/olap/tablet.cpp", "diffHunk": "@@ -272,16 +255,11 @@ OLAPStatus Tablet::add_rowset(RowsetSharedPtr rowset, bool need_persist) {\n     // yiguolei: temp code, should remove the rowset contains by this rowset\n     // but it should be removed in multi path version\n     for (auto& it : _rs_version_map) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dc19357f00932e0eca8f6913893032f5dee9ab0"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI3NDEyNg==", "bodyText": "first <= other.first && second >= other.second", "url": "https://github.com/apache/incubator-doris/pull/2796#discussion_r368274126", "createdAt": "2020-01-19T08:08:36Z", "author": {"login": "chaoyli"}, "path": "be/src/olap/olap_common.h", "diffHunk": "@@ -189,20 +186,29 @@ struct Version {\n     int64_t second;\n \n     Version(int64_t first_, int64_t second_) : first(first_), second(second_) {}\n-\n     Version() : first(0), second(0) {}\n \n+    friend std::ostream& operator<<(std::ostream& os, const Version& version);\n+\n     bool operator!=(const Version& rhs) const {\n         return first != rhs.first || second != rhs.second;\n     }\n \n     bool operator==(const Version& rhs) const {\n         return first == rhs.first && second == rhs.second;\n     }\n+\n+    bool contains(const Version& other) const {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dc19357f00932e0eca8f6913893032f5dee9ab0"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "614bfa49d4136d5b827175d9c65b0ad5df948449", "author": {"user": {"login": "lingbin", "name": "LingBin"}}, "url": "https://github.com/apache/incubator-doris/commit/614bfa49d4136d5b827175d9c65b0ad5df948449", "committedDate": "2020-01-19T09:19:29Z", "message": "Fix compare typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTkwNzcw", "url": "https://github.com/apache/incubator-doris/pull/2796#pullrequestreview-344990770", "createdAt": "2020-01-19T10:02:17Z", "commit": {"oid": "614bfa49d4136d5b827175d9c65b0ad5df948449"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3625, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}