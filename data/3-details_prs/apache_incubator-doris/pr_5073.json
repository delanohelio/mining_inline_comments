{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM3NzQ3MzMw", "number": 5073, "title": "[Bug] Fix Memory Leak in Json Load", "bodyText": "Proposed changes\nfix json load memory leak #5069\nTypes of changes\nWhat types of changes does your code introduce to Doris?\nPut an x in the boxes that apply\n\n Bugfix (fix json load memory leak which fixes an issue-5069)\n Code refactor (use unique_ptr instead of native ptr)\n\nChecklist\nPut an x in the boxes that apply. You can also fill these out after creating the PR. If you're unsure about any of them, don't hesitate to ask. We're here to help! This is simply a reminder of what we are going to look for before merging your code.\n\n I have create an issue on (Fix #5069 ), and have described the bug/feature there in detail\n Compiling and unit tests pass locally with my changes\n Any dependent changes have been merged", "createdAt": "2020-12-12T04:17:37Z", "url": "https://github.com/apache/incubator-doris/pull/5073", "merged": true, "mergeCommit": {"oid": "6afa14cda717f7776566bb7504c9852409f7caaa"}, "closed": true, "closedAt": "2020-12-15T14:55:47Z", "author": {"login": "stdpain"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlT5VLgH2gAyNTM3NzQ3MzMwOjkwZTA2ODZkYzkzNjIwMmM1NmY1OTM0ZDQwZDcxYjBkNTkzMDVmNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmbluaAFqTU1MjU0MjQ0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "90e0686dc936202c56f5934d40d71b0d59305f74", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/90e0686dc936202c56f5934d40d71b0d59305f74", "committedDate": "2020-12-12T03:23:15Z", "message": "[Bug] Fix Memory Leak in Json Load"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751bc92ea5a333cf38b748a220a5aa60d1fc88d5", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/751bc92ea5a333cf38b748a220a5aa60d1fc88d5", "committedDate": "2020-12-12T04:27:20Z", "message": "Merge branch 'master' into fix_json_load_leak"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwNjk2NzY3", "url": "https://github.com/apache/incubator-doris/pull/5073#pullrequestreview-550696767", "createdAt": "2020-12-12T06:47:49Z", "commit": {"oid": "751bc92ea5a333cf38b748a220a5aa60d1fc88d5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQwNjo0Nzo0OVrOIEboRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQwNjo0Nzo0OVrOIEboRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTUxNzg5NQ==", "bodyText": "Use pointer if the parameter will be changed.\nUse reference with const\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Status LocalFileReader::read_one_message(std::unique_ptr<uint8_t[]>& buf, size_t* length) {\n          \n          \n            \n            Status LocalFileReader::read_one_message(std::unique_ptr<uint8_t[]>* buf, size_t* length) {", "url": "https://github.com/apache/incubator-doris/pull/5073#discussion_r541517895", "createdAt": "2020-12-12T06:47:49Z", "author": {"login": "imay"}, "path": "be/src/exec/local_file_reader.cpp", "diffHunk": "@@ -53,21 +53,17 @@ bool LocalFileReader::closed() {\n }\n \n // Read all bytes\n-Status LocalFileReader::read_one_message(uint8_t** buf, size_t* length) {\n+Status LocalFileReader::read_one_message(std::unique_ptr<uint8_t[]>& buf, size_t* length) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751bc92ea5a333cf38b748a220a5aa60d1fc88d5"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16831e0c08f0c92a6ab05b58c7de2132da2a9933", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/16831e0c08f0c92a6ab05b58c7de2132da2a9933", "committedDate": "2020-12-12T07:49:38Z", "message": "Update json_scanner.cpp"}, "afterCommit": {"oid": "964a3e184cfb6b2410fd615d7baaf1220f1414a6", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/964a3e184cfb6b2410fd615d7baaf1220f1414a6", "committedDate": "2020-12-12T08:01:59Z", "message": "convert reference to pointer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "964a3e184cfb6b2410fd615d7baaf1220f1414a6", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/964a3e184cfb6b2410fd615d7baaf1220f1414a6", "committedDate": "2020-12-12T08:01:59Z", "message": "convert reference to pointer"}, "afterCommit": {"oid": "7c82af857fe910a6ddd5c0906a7a3892df8f6fa4", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/7c82af857fe910a6ddd5c0906a7a3892df8f6fa4", "committedDate": "2020-12-12T08:21:57Z", "message": "convert reference to pointer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c82af857fe910a6ddd5c0906a7a3892df8f6fa4", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/7c82af857fe910a6ddd5c0906a7a3892df8f6fa4", "committedDate": "2020-12-12T08:21:57Z", "message": "convert reference to pointer"}, "afterCommit": {"oid": "7b0d477b939b512157343e566ddcadf705842868", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/7b0d477b939b512157343e566ddcadf705842868", "committedDate": "2020-12-12T09:39:23Z", "message": "convert reference to pointer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e814034c1442c5b31e9ae7b807add88aca3f1b3", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/6e814034c1442c5b31e9ae7b807add88aca3f1b3", "committedDate": "2020-12-12T09:40:56Z", "message": "convert reference to pointer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7b0d477b939b512157343e566ddcadf705842868", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/7b0d477b939b512157343e566ddcadf705842868", "committedDate": "2020-12-12T09:39:23Z", "message": "convert reference to pointer"}, "afterCommit": {"oid": "6e814034c1442c5b31e9ae7b807add88aca3f1b3", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/6e814034c1442c5b31e9ae7b807add88aca3f1b3", "committedDate": "2020-12-12T09:40:56Z", "message": "convert reference to pointer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwODQ2NzE4", "url": "https://github.com/apache/incubator-doris/pull/5073#pullrequestreview-550846718", "createdAt": "2020-12-12T17:18:39Z", "commit": {"oid": "6e814034c1442c5b31e9ae7b807add88aca3f1b3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMTEwMzk2", "url": "https://github.com/apache/incubator-doris/pull/5073#pullrequestreview-551110396", "createdAt": "2020-12-14T07:48:36Z", "commit": {"oid": "6e814034c1442c5b31e9ae7b807add88aca3f1b3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMTE2ODI1", "url": "https://github.com/apache/incubator-doris/pull/5073#pullrequestreview-551116825", "createdAt": "2020-12-14T07:59:27Z", "commit": {"oid": "6e814034c1442c5b31e9ae7b807add88aca3f1b3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eaa9060ed4b5e22adb9393790cf0e7d20d4fcae", "author": {"user": {"login": "stdpain", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/0eaa9060ed4b5e22adb9393790cf0e7d20d4fcae", "committedDate": "2020-12-15T02:14:49Z", "message": "Merge branch 'master' into fix_json_load_leak"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNTQyNDQ4", "url": "https://github.com/apache/incubator-doris/pull/5073#pullrequestreview-552542448", "createdAt": "2020-12-15T14:55:00Z", "commit": {"oid": "0eaa9060ed4b5e22adb9393790cf0e7d20d4fcae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3965, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}