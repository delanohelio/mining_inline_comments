{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MjAwMzUx", "number": 3766, "title": "[Bug] Clear Txn when load been cancelled", "bodyText": "If you a load task encoutering error, it will be cancelled.\nAt this time, FE will clear the Txn according to the DbName.\nIn FE, DbName should be added by cluter name.\nIf missing cluster name, it will encounter NullPointer.\nAs a result, the Txn will still exists until timeout.", "createdAt": "2020-06-03T13:25:33Z", "url": "https://github.com/apache/incubator-doris/pull/3766", "merged": true, "mergeCommit": {"oid": "9b2cf1c18efcbc69738a5a45f269c6ec7785b34b"}, "closed": true, "closedAt": "2020-06-04T10:18:38Z", "author": {"login": "chaoyli"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn0_f8gFqTQyNDA2Njg0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn6153AFqTQyNDI3NTMxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDY2ODQ3", "url": "https://github.com/apache/incubator-doris/pull/3766#pullrequestreview-424066847", "createdAt": "2020-06-04T02:52:51Z", "commit": {"oid": "270d544f6ab1738a4380c8bea9043045e698daa3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMjo1Mjo1MVrOGe0DAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMjo1Mjo1MVrOGe0DAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk2MzIwMw==", "bodyText": "Use ClusterNamespace.getFullName() for safety", "url": "https://github.com/apache/incubator-doris/pull/3766#discussion_r434963203", "createdAt": "2020-06-04T02:52:51Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/service/FrontendServiceImpl.java", "diffHunk": "@@ -808,7 +808,8 @@ private void loadTxnRollbackImpl(TLoadTxnRollbackRequest request) throws UserExc\n             checkPasswordAndPrivs(cluster, request.getUser(), request.getPasswd(), request.getDb(),\n                     request.getTbl(), request.getUser_ip(), PrivPredicate.LOAD);\n         }\n-        Database db = Catalog.getInstance().getDb(request.getDb());\n+        String dbName = cluster + \":\" + request.getDb();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "270d544f6ab1738a4380c8bea9043045e698daa3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0681fe89246b7e81d2379c71153d7110d9ca5170", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/0681fe89246b7e81d2379c71153d7110d9ca5170", "committedDate": "2020-06-04T03:34:40Z", "message": "[Bug] Clear Txn when load been cancelled\nIf you a load task encoutering error, it will be cancelled.\nAt this time, FE will clear the Txn according to the DbName.\nIn FE, DbName should be added by cluter name.\nIf missing cluster name, it will encounter NullPointer.\nAs a result, the Txn will still exists until timeout."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0Mjc1MzE4", "url": "https://github.com/apache/incubator-doris/pull/3766#pullrequestreview-424275318", "createdAt": "2020-06-04T09:42:30Z", "commit": {"oid": "0681fe89246b7e81d2379c71153d7110d9ca5170"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2449, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}