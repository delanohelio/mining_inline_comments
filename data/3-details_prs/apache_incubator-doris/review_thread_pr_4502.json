{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MDY1NTE3", "number": 4502, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjoxNToyMFrOEfKCVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QxMjo1MDo1MFrOEi3xVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMTA1NzQ5OnYy", "diffSide": "RIGHT", "path": "docs/zh-CN/sql-reference/sql-statements/Data Definition/SHOW RESOURCES.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjoxNToyMFrOHLP6nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjoyOTowMFrOHLQdIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU1NzE1MQ==", "bodyText": "how many resource do we have\uff1f", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r481557151", "createdAt": "2020-09-02T02:15:20Z", "author": {"login": "wutiangan"}, "path": "docs/zh-CN/sql-reference/sql-statements/Data Definition/SHOW RESOURCES.md", "diffHunk": "@@ -32,7 +32,33 @@ under the License.\n     \u8bed\u6cd5\n     \n         SHOW RESOURCES\n+        [\n+            WHERE \n+            [NAME [ = \"your_resource_name\" | LIKE \"name_matcher\"]]\n+            [RESOURCETYPE = [\"SPARK\"]]\n+        ]\n+        [ORDER BY ...]\n+        [LIMIT limit][OFFSET offset];\n+        \n+     \u8bf4\u660e\uff1a\n+        1) \u5982\u679c\u4f7f\u7528 NAME LIKE\uff0c\u5219\u4f1a\u5339\u914dRESOURCES\u7684Name\u5305\u542b name_matcher\u7684Resource\n+        2) \u5982\u679c\u4f7f\u7528 NAME = \uff0c\u5219\u7cbe\u786e\u5339\u914d\u6307\u5b9a\u7684 Name\n+        3) \u5982\u679c\u6307\u5b9a\u4e86RESOURCETYPE\uff0c\u5219\u5339\u914d\u5bf9\u5e94\u7684Resrouce\u7c7b\u578b", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU2NTk4NQ==", "bodyText": "There is no hard limit", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r481565985", "createdAt": "2020-09-02T02:29:00Z", "author": {"login": "HappenLee"}, "path": "docs/zh-CN/sql-reference/sql-statements/Data Definition/SHOW RESOURCES.md", "diffHunk": "@@ -32,7 +32,33 @@ under the License.\n     \u8bed\u6cd5\n     \n         SHOW RESOURCES\n+        [\n+            WHERE \n+            [NAME [ = \"your_resource_name\" | LIKE \"name_matcher\"]]\n+            [RESOURCETYPE = [\"SPARK\"]]\n+        ]\n+        [ORDER BY ...]\n+        [LIMIT limit][OFFSET offset];\n+        \n+     \u8bf4\u660e\uff1a\n+        1) \u5982\u679c\u4f7f\u7528 NAME LIKE\uff0c\u5219\u4f1a\u5339\u914dRESOURCES\u7684Name\u5305\u542b name_matcher\u7684Resource\n+        2) \u5982\u679c\u4f7f\u7528 NAME = \uff0c\u5219\u7cbe\u786e\u5339\u914d\u6307\u5b9a\u7684 Name\n+        3) \u5982\u679c\u6307\u5b9a\u4e86RESOURCETYPE\uff0c\u5219\u5339\u914d\u5bf9\u5e94\u7684Resrouce\u7c7b\u578b", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU1NzE1MQ=="}, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMTE1Nzk3OnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjo0MDo1NlrOHLQ64w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMjowNTo0N1rOHLr-Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3MzYwMw==", "bodyText": "the ResourceType has two definations but has different meanings\uff1a\n1\u3001org.apache.doris.catalog.Resource.ResourceType\n2\u3001org.apache.doris.catalog.ResourceType\nshould be fix", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r481573603", "createdAt": "2020-09-02T02:40:56Z", "author": {"login": "wutiangan"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -17,9 +17,11 @@\n \n package org.apache.doris.catalog;\n \n+import com.google.common.collect.Lists;\n import org.apache.doris.analysis.CreateResourceStmt;\n import org.apache.doris.analysis.DropResourceStmt;\n import org.apache.doris.catalog.Resource.ResourceType;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNjc4Nw==", "bodyText": "org.apache.doris.catalog.ResourceType is deprecated. It will be deleted in the future", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r482016787", "createdAt": "2020-09-02T12:05:47Z", "author": {"login": "HappenLee"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -17,9 +17,11 @@\n \n package org.apache.doris.catalog;\n \n+import com.google.common.collect.Lists;\n import org.apache.doris.analysis.CreateResourceStmt;\n import org.apache.doris.analysis.DropResourceStmt;\n import org.apache.doris.catalog.Resource.ResourceType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3MzYwMw=="}, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMTE2NzUxOnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjo0MzoyOFrOHLRBBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMjowNDoyN1rOHLr7TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NTE3Mw==", "bodyText": "equalsIgnore()", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r481575173", "createdAt": "2020-09-02T02:43:28Z", "author": {"login": "wutiangan"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -109,8 +112,41 @@ public int getResourceNum() {\n         return nameToResource.size();\n     }\n \n-    public List<List<String>> getResourcesInfo() {\n-        return procNode.fetchResult().getRows();\n+    public List<List<Comparable>> getResourcesInfo(String name, boolean accurateMatch, Set<String> typeSets) {\n+        List<List<String>> targetRows = procNode.fetchResult().getRows();\n+        List<List<Comparable>> returnRows = Lists.newArrayList();\n+\n+        for (List<String> row : targetRows) {\n+            if (row == null || row.size() < 2) {\n+                continue;\n+            }\n+\n+            String resourceName = row.get(0);\n+            String resourceType = row.get(1);\n+\n+            if (name != null) {\n+                if (accurateMatch && !resourceName.equals(name)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNjA3Ng==", "bodyText": "There is need need ignore. The Name should be case sensitive", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r482016076", "createdAt": "2020-09-02T12:04:27Z", "author": {"login": "HappenLee"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -109,8 +112,41 @@ public int getResourceNum() {\n         return nameToResource.size();\n     }\n \n-    public List<List<String>> getResourcesInfo() {\n-        return procNode.fetchResult().getRows();\n+    public List<List<Comparable>> getResourcesInfo(String name, boolean accurateMatch, Set<String> typeSets) {\n+        List<List<String>> targetRows = procNode.fetchResult().getRows();\n+        List<List<Comparable>> returnRows = Lists.newArrayList();\n+\n+        for (List<String> row : targetRows) {\n+            if (row == null || row.size() < 2) {\n+                continue;\n+            }\n+\n+            String resourceName = row.get(0);\n+            String resourceType = row.get(1);\n+\n+            if (name != null) {\n+                if (accurateMatch && !resourceName.equals(name)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NTE3Mw=="}, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMTE3NTAxOnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMjo0NToyNFrOHLRGBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMjowMzoxNVrOHLr5Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NjQ1Mw==", "bodyText": "solt --> slot", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r481576453", "createdAt": "2020-09-02T02:45:24Z", "author": {"login": "wutiangan"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -109,8 +112,41 @@ public int getResourceNum() {\n         return nameToResource.size();\n     }\n \n-    public List<List<String>> getResourcesInfo() {\n-        return procNode.fetchResult().getRows();\n+    public List<List<Comparable>> getResourcesInfo(String name, boolean accurateMatch, Set<String> typeSets) {\n+        List<List<String>> targetRows = procNode.fetchResult().getRows();\n+        List<List<Comparable>> returnRows = Lists.newArrayList();\n+\n+        for (List<String> row : targetRows) {\n+            if (row == null || row.size() < 2) {\n+                continue;\n+            }\n+\n+            String resourceName = row.get(0);\n+            String resourceType = row.get(1);\n+\n+            if (name != null) {\n+                if (accurateMatch && !resourceName.equals(name)) {\n+                    continue;\n+                }\n+                if (!accurateMatch && !resourceName.contains(name)) {\n+                    continue;\n+                }\n+            }\n+\n+            if (typeSets != null) {\n+                if (!typeSets.contains(resourceType.toUpperCase())) {\n+                    continue;\n+                }\n+            }\n+\n+            List<Comparable> comparableRow = Lists.newArrayList();\n+            for (Comparable solt : row) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAxNTUxMQ==", "bodyText": "i will change it", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r482015511", "createdAt": "2020-09-02T12:03:15Z", "author": {"login": "HappenLee"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -109,8 +112,41 @@ public int getResourceNum() {\n         return nameToResource.size();\n     }\n \n-    public List<List<String>> getResourcesInfo() {\n-        return procNode.fetchResult().getRows();\n+    public List<List<Comparable>> getResourcesInfo(String name, boolean accurateMatch, Set<String> typeSets) {\n+        List<List<String>> targetRows = procNode.fetchResult().getRows();\n+        List<List<Comparable>> returnRows = Lists.newArrayList();\n+\n+        for (List<String> row : targetRows) {\n+            if (row == null || row.size() < 2) {\n+                continue;\n+            }\n+\n+            String resourceName = row.get(0);\n+            String resourceType = row.get(1);\n+\n+            if (name != null) {\n+                if (accurateMatch && !resourceName.equals(name)) {\n+                    continue;\n+                }\n+                if (!accurateMatch && !resourceName.contains(name)) {\n+                    continue;\n+                }\n+            }\n+\n+            if (typeSets != null) {\n+                if (!typeSets.contains(resourceType.toUpperCase())) {\n+                    continue;\n+                }\n+            }\n+\n+            List<Comparable> comparableRow = Lists.newArrayList();\n+            for (Comparable solt : row) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU3NjQ1Mw=="}, "originalCommit": {"oid": "39dd11b8ebef521a42274087a93dab9a7b45208d"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNjcwOTE1OnYy", "diffSide": "LEFT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQwMTo0ODoyMVrOHNljJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQwODoyMDo1MFrOHNnasw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDAwODc0Mg==", "bodyText": "Better don't use 'key' annd 'value' because they are keywords in doris.\nFor example , show resources where name like \"test\" and resourcetype = \"spark\" order by KEY; will report an error", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r484008742", "createdAt": "2020-09-06T01:48:21Z", "author": {"login": "xy720"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -52,7 +55,7 @@\n     private static final Logger LOG = LogManager.getLogger(ResourceMgr.class);\n \n     public static final ImmutableList<String> RESOURCE_PROC_NODE_TITLE_NAMES = new ImmutableList.Builder<String>()\n-            .add(\"Name\").add(\"ResourceType\").add(\"Key\").add(\"Value\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e2ded6d8f276f437dfc28c79a7475f4508520fd"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDAzOTM0Nw==", "bodyText": "Hi,xy720. I keep the older name of the Resource. The key and value is the keyword in doris. The only way to use it is to add operator ` to prevent the error of doris.\nMaybe we should change the name.", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r484039347", "createdAt": "2020-09-06T08:20:50Z", "author": {"login": "HappenLee"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -52,7 +55,7 @@\n     private static final Logger LOG = LogManager.getLogger(ResourceMgr.class);\n \n     public static final ImmutableList<String> RESOURCE_PROC_NODE_TITLE_NAMES = new ImmutableList.Builder<String>()\n-            .add(\"Name\").add(\"ResourceType\").add(\"Key\").add(\"Value\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDAwODc0Mg=="}, "originalCommit": {"oid": "2e2ded6d8f276f437dfc28c79a7475f4508520fd"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MDAwNzkxOnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QxMjo1MDo1MFrOHQ8OPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QxMjo1MDo1MFrOHQ8OPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUyNTk0OQ==", "bodyText": "Why changing them to uppercase?\nAnd as @xy720 said, better not using KEY, I prefer Item.", "url": "https://github.com/apache/incubator-doris/pull/4502#discussion_r487525949", "createdAt": "2020-09-13T12:50:50Z", "author": {"login": "morningman"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/ResourceMgr.java", "diffHunk": "@@ -52,7 +55,7 @@\n     private static final Logger LOG = LogManager.getLogger(ResourceMgr.class);\n \n     public static final ImmutableList<String> RESOURCE_PROC_NODE_TITLE_NAMES = new ImmutableList.Builder<String>()\n-            .add(\"Name\").add(\"ResourceType\").add(\"Key\").add(\"Value\")\n+            .add(\"NAME\").add(\"RESOURCETYPE\").add(\"KEY\").add(\"VALUE\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e2ded6d8f276f437dfc28c79a7475f4508520fd"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1067, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}