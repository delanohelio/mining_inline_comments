{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MjMyMDA4", "number": 2925, "title": "fix bug: Error of exporting double type data to hdfs (#2924)", "bodyText": "", "createdAt": "2020-02-17T16:44:44Z", "url": "https://github.com/apache/incubator-doris/pull/2925", "merged": true, "mergeCommit": {"oid": "ccc3412f13a05ad945d37fd2ac6645c1e2161a98"}, "closed": true, "closedAt": "2020-02-20T13:06:51Z", "author": {"login": "wutiangan"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFZSsegFqTM2MDA1MTAzNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGK1B2AFqTM2MTg4NDI2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMDUxMDM1", "url": "https://github.com/apache/incubator-doris/pull/2925#pullrequestreview-360051035", "createdAt": "2020-02-18T03:23:39Z", "commit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwMzoyMzozOVrOFq0Gbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwMzoyMzozOVrOFq0Gbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQzODEyNg==", "bodyText": "why?", "url": "https://github.com/apache/incubator-doris/pull/2925#discussion_r380438126", "createdAt": "2020-02-18T03:23:39Z", "author": {"login": "kangpinghuang"}, "path": "be/src/runtime/export_sink.cpp", "diffHunk": "@@ -142,10 +142,10 @@ Status ExportSink::gen_row_buffer(TupleRow* row, std::stringstream* ss) {\n                     (*ss) << reinterpret_cast<PackedInt128*>(item)->value;\n                     break;\n                 case TYPE_FLOAT:\n-                    (*ss) << *static_cast<float*>(item);\n+                    (*ss) << std::to_string(*static_cast<float*>(item));\n                     break;\n                 case TYPE_DOUBLE:\n-                    (*ss) << *static_cast<double*>(item);\n+                    (*ss) << std::to_string(*static_cast<double*>(item));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMDUxNjYx", "url": "https://github.com/apache/incubator-doris/pull/2925#pullrequestreview-360051661", "createdAt": "2020-02-18T03:26:30Z", "commit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwMzoyNjozMFrOFq0IdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwMzoyNjozMFrOFq0IdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQzODY0NQ==", "bodyText": "Could you please add a comment to tell the reader why it was converted to a string first?\nFor example the following comment\uff1a\nTo prevent loss of precision on float and double types, they are converted to strings before output.\nFor example: For a double value 27361919854.929001, the direct output of using std::stringstream is 2.73619e + 10, and after conversion to a string, it outputs 27361919854.929001", "url": "https://github.com/apache/incubator-doris/pull/2925#discussion_r380438645", "createdAt": "2020-02-18T03:26:30Z", "author": {"login": "lingbin"}, "path": "be/src/runtime/export_sink.cpp", "diffHunk": "@@ -142,10 +142,10 @@ Status ExportSink::gen_row_buffer(TupleRow* row, std::stringstream* ss) {\n                     (*ss) << reinterpret_cast<PackedInt128*>(item)->value;\n                     break;\n                 case TYPE_FLOAT:\n-                    (*ss) << *static_cast<float*>(item);\n+                    (*ss) << std::to_string(*static_cast<float*>(item));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMDUyNDk3", "url": "https://github.com/apache/incubator-doris/pull/2925#pullrequestreview-360052497", "createdAt": "2020-02-18T03:30:20Z", "commit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMzI4Nzc5", "url": "https://github.com/apache/incubator-doris/pull/2925#pullrequestreview-360328779", "createdAt": "2020-02-18T13:18:41Z", "commit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxMzoxODo0MVrOFrB-AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxMzoxODo0MVrOFrB-AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDY2NTM0NQ==", "bodyText": "Please use FloatToBuffer(gutil/strings/numbers.h) to print float and double value", "url": "https://github.com/apache/incubator-doris/pull/2925#discussion_r380665345", "createdAt": "2020-02-18T13:18:41Z", "author": {"login": "imay"}, "path": "be/src/runtime/export_sink.cpp", "diffHunk": "@@ -142,10 +142,10 @@ Status ExportSink::gen_row_buffer(TupleRow* row, std::stringstream* ss) {\n                     (*ss) << reinterpret_cast<PackedInt128*>(item)->value;\n                     break;\n                 case TYPE_FLOAT:\n-                    (*ss) << *static_cast<float*>(item);\n+                    (*ss) << std::to_string(*static_cast<float*>(item));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQzODY0NQ=="}, "originalCommit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b16781eeeb4eb31de8f78d21da734c7d74a4c58", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/3b16781eeeb4eb31de8f78d21da734c7d74a4c58", "committedDate": "2020-02-19T15:58:34Z", "message": "fix bug: Error of exporting double type data to hdfs (#2924)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecd50db2d39b178737d7cf51517e218b41426ddc", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/ecd50db2d39b178737d7cf51517e218b41426ddc", "committedDate": "2020-02-19T16:01:29Z", "message": "Merge branch 'master' of https://github.com/apache/incubator-doris into export_double_error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fb5e5acef6c899d5b595406bcc7900435d8e22c", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/2fb5e5acef6c899d5b595406bcc7900435d8e22c", "committedDate": "2020-02-20T02:55:21Z", "message": "fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "42ca89325f6d1f5ebd13e58225e8abcc1bf0f499", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/42ca89325f6d1f5ebd13e58225e8abcc1bf0f499", "committedDate": "2020-02-17T16:39:20Z", "message": "fix bug: Error of exporting double type data to hdfs (#2924)"}, "afterCommit": {"oid": "2fb5e5acef6c899d5b595406bcc7900435d8e22c", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/2fb5e5acef6c899d5b595406bcc7900435d8e22c", "committedDate": "2020-02-20T02:55:21Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxODg0MjY1", "url": "https://github.com/apache/incubator-doris/pull/2925#pullrequestreview-361884265", "createdAt": "2020-02-20T13:06:36Z", "commit": {"oid": "2fb5e5acef6c899d5b595406bcc7900435d8e22c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3796, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}