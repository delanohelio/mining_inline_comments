{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1ODEyNzIx", "number": 3738, "title": "[Bug]fix the crash of checksum task #3735", "bodyText": "the table include key column of double/float type\nwhen run checksum task, will use all of key columns to compare\nschema.column(idx) of double/float type is NULL\n\n#3735", "createdAt": "2020-06-01T07:48:34Z", "url": "https://github.com/apache/incubator-doris/pull/3738", "merged": true, "mergeCommit": {"oid": "ef94c25773c361ed782fba3ef81960230bca0495"}, "closed": true, "closedAt": "2020-06-10T14:59:16Z", "author": {"login": "marising"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm684mAH2gAyNDI1ODEyNzIxOjk0MDJlMTEzNDU1OWY1ZTU5ZTZkODRmYTFlMGY5YWRhYTRlODcxN2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpgZTxgFqTQyNjg4Mjk2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9402e1134559f5e59e6d84fa1e0f9adaa4e8717e", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/9402e1134559f5e59e6d84fa1e0f9adaa4e8717e", "committedDate": "2020-06-01T07:16:12Z", "message": "fix the crash of checksum task\n1. the table include key colum of double/float type\n2. when run checksum task, will use all of key columns to compare\n3. schema.column(idx) of double/float type is NULL"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxOTExMzQ2", "url": "https://github.com/apache/incubator-doris/pull/3738#pullrequestreview-421911346", "createdAt": "2020-06-01T14:54:35Z", "commit": {"oid": "9402e1134559f5e59e6d84fa1e0f9adaa4e8717e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDo1NDozNVrOGdNgWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNDo1NDozNVrOGdNgWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI4MzE2MQ==", "bodyText": "This function is used in many senarios. And changing here to fix the problem is not a good idea.\nWhy not to make column in the schema is not NULL.", "url": "https://github.com/apache/incubator-doris/pull/3738#discussion_r433283161", "createdAt": "2020-06-01T14:54:35Z", "author": {"login": "imay"}, "path": "be/src/olap/row.h", "diffHunk": "@@ -59,6 +59,10 @@ bool equal_row(const std::vector<uint32_t>& ids,\n template<typename LhsRowType, typename RhsRowType>\n int compare_row(const LhsRowType& lhs, const RhsRowType& rhs) {\n     for (uint32_t cid = 0; cid < lhs.schema()->num_key_columns(); ++cid) {\n+        //because the num_column_ids include the column of double/float type", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9402e1134559f5e59e6d84fa1e0f9adaa4e8717e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bb5f4bc9846675073aebd1b73e271b8d1b77988", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/9bb5f4bc9846675073aebd1b73e271b8d1b77988", "committedDate": "2020-06-02T12:55:44Z", "message": "Solve the bug of float/double type column when checksum"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDc4NzAy", "url": "https://github.com/apache/incubator-doris/pull/3738#pullrequestreview-424078702", "createdAt": "2020-06-04T03:34:25Z", "commit": {"oid": "9bb5f4bc9846675073aebd1b73e271b8d1b77988"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMzozNDoyNVrOGe0psA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMzozNDoyNVrOGe0psA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk3MzEwNA==", "bodyText": "Should add comment for this if logical to let others know why.", "url": "https://github.com/apache/incubator-doris/pull/3738#discussion_r434973104", "createdAt": "2020-06-04T03:34:25Z", "author": {"login": "imay"}, "path": "be/src/olap/row.h", "diffHunk": "@@ -186,7 +186,12 @@ void agg_finalize_row(const std::vector<uint32_t>& ids, RowType* row, MemPool* m\n \n template<typename RowType>\n uint32_t hash_row(const RowType& row, uint32_t seed) {\n+    FieldType type;\n     for (uint32_t cid : row.schema()->column_ids()) {\n+        type = row.schema()->column(cid)->type();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bb5f4bc9846675073aebd1b73e271b8d1b77988"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75e85de72ae186d3229303bd2b636dbc1d2bec69", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/75e85de72ae186d3229303bd2b636dbc1d2bec69", "committedDate": "2020-06-04T08:32:05Z", "message": "add comment for ignore float/double when compute hash code"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae0146a692047c1561bbfa253ed444a19953f097", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/ae0146a692047c1561bbfa253ed444a19953f097", "committedDate": "2020-06-04T07:27:36Z", "message": "add comment for ignore float/double when compute hash code"}, "afterCommit": {"oid": "75e85de72ae186d3229303bd2b636dbc1d2bec69", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/75e85de72ae186d3229303bd2b636dbc1d2bec69", "committedDate": "2020-06-04T08:32:05Z", "message": "add comment for ignore float/double when compute hash code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MzU5NDky", "url": "https://github.com/apache/incubator-doris/pull/3738#pullrequestreview-424359492", "createdAt": "2020-06-04T11:44:55Z", "commit": {"oid": "75e85de72ae186d3229303bd2b636dbc1d2bec69"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxMTo0NDo1NVrOGfB-zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxMTo0NDo1NVrOGfB-zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE5MTUwMA==", "bodyText": "one_checksum = 0; this line is meaningless.", "url": "https://github.com/apache/incubator-doris/pull/3738#discussion_r435191500", "createdAt": "2020-06-04T11:44:55Z", "author": {"login": "morningman"}, "path": "be/src/olap/task/engine_checksum_task.cpp", "diffHunk": "@@ -118,8 +113,10 @@ OLAPStatus EngineChecksumTask::_compute_checksum() {\n             OLAP_LOG_WARNING(\"fail to read in reader. [res=%d]\", res);\n             return res;\n         }\n-\n-        row_checksum = hash_row(row, row_checksum);\n+        one_checksum = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75e85de72ae186d3229303bd2b636dbc1d2bec69"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTU3OTYw", "url": "https://github.com/apache/incubator-doris/pull/3738#pullrequestreview-424957960", "createdAt": "2020-06-05T02:33:12Z", "commit": {"oid": "75e85de72ae186d3229303bd2b636dbc1d2bec69"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ebbe4b32198f4f749311b735e13ed2fd978fe4a", "author": {"user": {"login": "marising", "name": "HaiBo Li"}}, "url": "https://github.com/apache/incubator-doris/commit/3ebbe4b32198f4f749311b735e13ed2fd978fe4a", "committedDate": "2020-06-05T05:54:50Z", "message": "Simplified some code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2ODgyOTYy", "url": "https://github.com/apache/incubator-doris/pull/3738#pullrequestreview-426882962", "createdAt": "2020-06-09T08:01:35Z", "commit": {"oid": "3ebbe4b32198f4f749311b735e13ed2fd978fe4a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2386, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}