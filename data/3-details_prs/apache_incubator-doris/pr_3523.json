{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MDczNjk3", "number": 3523, "title": "Refactor some redunant code && Replace some UT by UtFrameUtils", "bodyText": "This CL have no logic changed, just do some code refactor and use new UtFrameWork to replace some old UT.", "createdAt": "2020-05-08T06:37:20Z", "url": "https://github.com/apache/incubator-doris/pull/3523", "merged": true, "mergeCommit": {"oid": "2f3b7b5b8e8a0815d11f02d6fa584c6cf6371279"}, "closed": true, "closedAt": "2020-05-18T02:53:33Z", "author": {"login": "WingsGo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfJ3i4gH2gAyNDE1MDczNjk3OjFiMTRkZDQ0MjYxNDVmMWI2NjI5M2NmYTc4Yjc2YTkwYWI2MTMyNWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABch21-sgFqTQxMzA3NzQ5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1b14dd4426145f1b66293cfa78b76a90ab61325b", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/1b14dd4426145f1b66293cfa78b76a90ab61325b", "committedDate": "2020-05-08T04:07:33Z", "message": "Refactor some redunant code && Replace some UT by UtFrameUtils\n\nThis CL have no logic change, just do some code refacotr and UT Change."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "595f14498d4862195684ed5654af91250350ad66", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/595f14498d4862195684ed5654af91250350ad66", "committedDate": "2020-05-08T04:10:34Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/ad42a1d494098389b96c3b17e478756099124ff0", "committedDate": "2020-05-08T06:16:56Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjU0OTA3", "url": "https://github.com/apache/incubator-doris/pull/3523#pullrequestreview-408654907", "createdAt": "2020-05-09T14:33:27Z", "commit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NzIzMzIw", "url": "https://github.com/apache/incubator-doris/pull/3523#pullrequestreview-408723320", "createdAt": "2020-05-10T08:57:52Z", "commit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwODo1Nzo1MlrOGTCRTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwOTowNzozOFrOGTCVtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxMzMyNA==", "bodyText": "Change the comment to:\n// If this backend is done for a long time and not restart automatically.\n// we consider it as dead and return false.", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r422613324", "createdAt": "2020-05-10T08:57:52Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/alter/AlterJob.java", "diffHunk": "@@ -189,18 +189,14 @@ protected boolean checkBackendState(Replica replica) {\n             return false;\n         } else if (!backend.isAlive()) {\n             long currentTime = System.currentTimeMillis();\n-            if (backend.getLastUpdateMs() > 0\n-                    && currentTime - backend.getLastUpdateMs() > Config.max_backend_down_time_second * 1000) {\n-                // this backend is done for a long time and not restart automatically.\n-                // we consider it as dead\n-                return false;\n-            }\n-            return true;\n-        } else if (backend.isDecommissioned()) {\n-            return false;\n+            // this backend is done for a long time and not restart automatically.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxNDQ1Mg==", "bodyText": "I think the part of generate file mapping can be a separated method not including in this method.\nOr the name of this method can be confused.", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r422614452", "createdAt": "2020-05-10T09:07:38Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/backup/RestoreJob.java", "diffHunk": "@@ -806,7 +739,54 @@ private void checkAndPrepareMeta() {\n         // No log here, PENDING state restore job will redo this method\n         LOG.info(\"finished to prepare meta and send snapshot tasks, num: {}. {}\",\n                  batchTask.getTaskNum(), this);\n-        return;\n+    }\n+\n+    private boolean backupReplicasNotEqual(PartitionInfo localPartInfo, Partition localPartition, Table localTbl,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 223}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c86af45f4f4d619298285ab726995bb36de1c889", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/c86af45f4f4d619298285ab726995bb36de1c889", "committedDate": "2020-05-10T11:16:15Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "805ecc9d4e56202694e93f2db6d202d0bacb5256", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/805ecc9d4e56202694e93f2db6d202d0bacb5256", "committedDate": "2020-05-15T03:23:01Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDc3NDk5", "url": "https://github.com/apache/incubator-doris/pull/3523#pullrequestreview-413077499", "createdAt": "2020-05-16T13:39:25Z", "commit": {"oid": "805ecc9d4e56202694e93f2db6d202d0bacb5256"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3007, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}