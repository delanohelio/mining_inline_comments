{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNzg2NTIw", "number": 2865, "title": "[Doris on ES] Support escape character", "bodyText": "#2864\nadd some comments of last commit by the way", "createdAt": "2020-02-09T03:53:35Z", "url": "https://github.com/apache/incubator-doris/pull/2865", "merged": true, "mergeCommit": {"oid": "fd492e3b6fd729e617536842ba4092911f8afae8"}, "closed": true, "closedAt": "2020-02-13T03:32:48Z", "author": {"login": "blackfox1983"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcCgOA6AH2gAyMzcyNzg2NTIwOjBiYWY4Zjg5MmJlZjJkMDIzZTA4N2U2YzYxOGQ1ZmQwNDQ3ZmRlZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDya4OAFqTM1NzkzNTI1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0baf8f892bef2d023e087e6c618d5fd0447fdeee", "author": {"user": {"login": "blackfox1983", "name": "\u4ee4\u72d0\u5c11\u4fa0"}}, "url": "https://github.com/apache/incubator-doris/commit/0baf8f892bef2d023e087e6c618d5fd0447fdeee", "committedDate": "2020-02-09T03:46:12Z", "message": "support escape character"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32206b615d66a5b1ea1e4a4df4cff4784e4a56c0", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/32206b615d66a5b1ea1e4a4df4cff4784e4a56c0", "committedDate": "2020-02-09T03:46:12Z", "message": "add comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5097d8c1a5b750aac2fba5147f909d2eabc49461", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/5097d8c1a5b750aac2fba5147f909d2eabc49461", "committedDate": "2020-02-09T03:49:10Z", "message": "fix core when es_scanner_node exit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/879af5c3ebc1eb04f0f14b8f27a141afbc3535d7", "committedDate": "2020-02-09T03:49:11Z", "message": "add comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTkwOTY2", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-355590966", "createdAt": "2020-02-09T08:23:07Z", "commit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwODoyMzowN1rOFnT4Bw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwODoyMzowN1rOFnT4Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc2NDQyMw==", "bodyText": "How about abc_123 ?", "url": "https://github.com/apache/incubator-doris/pull/2865#discussion_r376764423", "createdAt": "2020-02-09T08:23:07Z", "author": {"login": "wuyunfeng"}, "path": "be/src/exec/es/es_query_builder.cpp", "diffHunk": "@@ -110,8 +110,17 @@ void WildCardQueryBuilder::to_json(rapidjson::Document* document, rapidjson::Val\n }\n WildCardQueryBuilder::WildCardQueryBuilder(const ExtLikePredicate& like_predicate) : _field(like_predicate.col.name) {\n     _like_value = like_predicate.value.to_string();\n-    std::replace(_like_value.begin(), _like_value.end(), '_', '?');\n-    std::replace(_like_value.begin(), _like_value.end(), '%', '*');\n+    // example of translation :\n+    //      abc\\_123 ===> abc?123", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTkwOTk4", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-355590998", "createdAt": "2020-02-09T08:24:02Z", "commit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwODoyNDowMlrOFnT4Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwODoyNDowMlrOFnT4Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc2NDQ3OA==", "bodyText": "This comment seems not related with this PR?", "url": "https://github.com/apache/incubator-doris/pull/2865#discussion_r376764478", "createdAt": "2020-02-09T08:24:02Z", "author": {"login": "wuyunfeng"}, "path": "be/src/exec/es_http_scan_node.cpp", "diffHunk": "@@ -166,6 +166,11 @@ Status EsHttpScanNode::start_scanners() {\n }\n \n Status EsHttpScanNode::collect_scanners_status() {\n+    // NOTE. if open() was called, but set_range() was NOT called for some reason.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTkxMDE1", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-355591015", "createdAt": "2020-02-09T08:24:27Z", "commit": {"oid": "879af5c3ebc1eb04f0f14b8f27a141afbc3535d7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfbb92135f8af5235e902a4342afbb0e2670861d", "author": {"user": {"login": "blackfox1983", "name": "\u4ee4\u72d0\u5c11\u4fa0"}}, "url": "https://github.com/apache/incubator-doris/commit/cfbb92135f8af5235e902a4342afbb0e2670861d", "committedDate": "2020-02-10T07:20:41Z", "message": "support escape"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjI2ODIx", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-357226821", "createdAt": "2020-02-12T07:08:28Z", "commit": {"oid": "cfbb92135f8af5235e902a4342afbb0e2670861d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzowODoyOVrOFojp9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzowODoyOVrOFojp9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA3MTU0MA==", "bodyText": "Can we remove #include <boost/algorithm/string/replace.hpp> in this file?", "url": "https://github.com/apache/incubator-doris/pull/2865#discussion_r378071540", "createdAt": "2020-02-12T07:08:29Z", "author": {"login": "wuyunfeng"}, "path": "be/src/exec/es/es_query_builder.cpp", "diffHunk": "@@ -110,8 +110,19 @@ void WildCardQueryBuilder::to_json(rapidjson::Document* document, rapidjson::Val\n }\n WildCardQueryBuilder::WildCardQueryBuilder(const ExtLikePredicate& like_predicate) : _field(like_predicate.col.name) {\n     _like_value = like_predicate.value.to_string();\n-    std::replace(_like_value.begin(), _like_value.end(), '_', '?');\n-    std::replace(_like_value.begin(), _like_value.end(), '%', '*');\n+    // example of translation :\n+    //      abc_123  ===> abc?123\n+    //      abc%ykz  ===> abc*123\n+    //      abc\\\\_123 ===> abc\\\\_123\n+    //      abc\\\\%123 ===> abc\\\\%123\n+    // NOTE. user must input sql like 'abc\\\\_123' or 'abc\\\\%ykz'\n+    for (int i = 0; i< _like_value.size(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfbb92135f8af5235e902a4342afbb0e2670861d"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3OTM0MDMy", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-357934032", "createdAt": "2020-02-13T03:27:17Z", "commit": {"oid": "cfbb92135f8af5235e902a4342afbb0e2670861d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3OTM1MjUw", "url": "https://github.com/apache/incubator-doris/pull/2865#pullrequestreview-357935250", "createdAt": "2020-02-13T03:32:28Z", "commit": {"oid": "cfbb92135f8af5235e902a4342afbb0e2670861d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3723, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}