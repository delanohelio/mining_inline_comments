{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3OTI1NjUz", "number": 4964, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxMzo0MTowNVrOE9o-qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1NDozNlrOE97gHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMDY5OTkyOnYy", "diffSide": "LEFT", "path": "be/src/olap/reader.h", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxMzo0MTowNVrOH6b56Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwMjozMToyM1rOH6vLIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTAzNjY0OQ==", "bodyText": "Hi, is it compatible with segment v1?\nIn alpha_rowset_reader.h, filtered_rows() only calculates rows_del_filtered.", "url": "https://github.com/apache/incubator-doris/pull/4964#discussion_r531036649", "createdAt": "2020-11-26T13:41:05Z", "author": {"login": "xy720"}, "path": "be/src/olap/reader.h", "diffHunk": "@@ -128,7 +128,7 @@ class Reader {\n     }\n \n     uint64_t filtered_rows() const {\n-        return _stats.rows_del_filtered;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec5186be8fb6ed789dce4c1a27923efe7da108c3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTM1MjM1Mw==", "bodyText": "Yes, it is compatible. Because rows_conditions_filtered is only used for SegmentV2, so it should always to 0 in Segment V1.", "url": "https://github.com/apache/incubator-doris/pull/4964#discussion_r531352353", "createdAt": "2020-11-27T02:31:23Z", "author": {"login": "morningman"}, "path": "be/src/olap/reader.h", "diffHunk": "@@ -128,7 +128,7 @@ class Reader {\n     }\n \n     uint64_t filtered_rows() const {\n-        return _stats.rows_del_filtered;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTAzNjY0OQ=="}, "originalCommit": {"oid": "ec5186be8fb6ed789dce4c1a27923efe7da108c3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzczNDY5OnYy", "diffSide": "RIGHT", "path": "be/src/olap/compaction.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1NDozNlrOH632iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQwMzoxMDo1OFrOH7MJ-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5NDUzOQ==", "bodyText": "why not call gc_output_rowset in every succeed? It seems a new imported bug ?", "url": "https://github.com/apache/incubator-doris/pull/4964#discussion_r531494539", "createdAt": "2020-11-27T09:54:36Z", "author": {"login": "chaoyli"}, "path": "be/src/olap/compaction.cpp", "diffHunk": "@@ -164,17 +173,11 @@ void Compaction::modify_rowsets() {\n     _tablet->save_meta();\n }\n \n-OLAPStatus Compaction::gc_unused_rowsets() {\n+void Compaction::gc_output_rowset() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec5186be8fb6ed789dce4c1a27923efe7da108c3"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTgyNzE5NA==", "bodyText": "gc_output_rowset() should only be called when compaction succeed.\nIn #4212, we have implemented a new compaction logic, so that the input rowset will be deleted later. And we only need to delete the output rowset when failed.", "url": "https://github.com/apache/incubator-doris/pull/4964#discussion_r531827194", "createdAt": "2020-11-28T03:10:58Z", "author": {"login": "morningman"}, "path": "be/src/olap/compaction.cpp", "diffHunk": "@@ -164,17 +173,11 @@ void Compaction::modify_rowsets() {\n     _tablet->save_meta();\n }\n \n-OLAPStatus Compaction::gc_unused_rowsets() {\n+void Compaction::gc_output_rowset() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5NDUzOQ=="}, "originalCommit": {"oid": "ec5186be8fb6ed789dce4c1a27923efe7da108c3"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 911, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}