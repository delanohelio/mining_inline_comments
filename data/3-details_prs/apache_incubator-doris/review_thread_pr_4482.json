{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NDk4MTU4", "number": 4482, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoxMjoyOVrOEeCjwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoyMToxM1rOEeCmaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5OTM0NjU3OnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/OlapTable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoxMjoyOVrOHJgjHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoxMjoyOVrOHJgjHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTczMjUwOA==", "bodyText": "partitionExprs is null has checked in  if (partitionExprs == null) partitionExprs = groupingExprs;, So I think we could remove this check.", "url": "https://github.com/apache/incubator-doris/pull/4482#discussion_r479732508", "createdAt": "2020-08-30T07:12:29Z", "author": {"login": "kangkaisen"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/OlapTable.java", "diffHunk": "@@ -1577,4 +1580,31 @@ public TStorageFormat getStorageFormat() {\n         }\n         return tableProperty.getStorageFormat();\n     }\n+\n+    public boolean satisfyHashDistribution(List<Expr> hashExprs) {\n+        if (hashExprs == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "123dc155e122404b2a72ea56ee11c391028c0b7f"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5OTM1MDU0OnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/OlapTable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoxNzoyNVrOHJgk9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwODoyNjozMFrOHJg-Yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTczMjk4Mw==", "bodyText": "Rename to couldLocalGorupBy or similar name?", "url": "https://github.com/apache/incubator-doris/pull/4482#discussion_r479732983", "createdAt": "2020-08-30T07:17:25Z", "author": {"login": "kangkaisen"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/OlapTable.java", "diffHunk": "@@ -1577,4 +1580,31 @@ public TStorageFormat getStorageFormat() {\n         }\n         return tableProperty.getStorageFormat();\n     }\n+\n+    public boolean satisfyHashDistribution(List<Expr> hashExprs) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "123dc155e122404b2a72ea56ee11c391028c0b7f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTczOTQ5MQ==", "bodyText": "Rename to meetAggDistributionRequirements and change the param to AggregateInfo.", "url": "https://github.com/apache/incubator-doris/pull/4482#discussion_r479739491", "createdAt": "2020-08-30T08:26:30Z", "author": {"login": "liutang123"}, "path": "fe/fe-core/src/main/java/org/apache/doris/catalog/OlapTable.java", "diffHunk": "@@ -1577,4 +1580,31 @@ public TStorageFormat getStorageFormat() {\n         }\n         return tableProperty.getStorageFormat();\n     }\n+\n+    public boolean satisfyHashDistribution(List<Expr> hashExprs) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTczMjk4Mw=="}, "originalCommit": {"oid": "123dc155e122404b2a72ea56ee11c391028c0b7f"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5OTM1MzM3OnYy", "diffSide": "RIGHT", "path": "fe/fe-core/src/main/java/org/apache/doris/planner/DistributedPlanner.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoyMToxM1rOHJgmPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNzoyMToxM1rOHJgmPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTczMzMxMA==", "bodyText": "I think we move this check to createAggregationFragment 780 line is better?  Because createMergeAggregationFragment  should create a merge aggregate fragment.", "url": "https://github.com/apache/incubator-doris/pull/4482#discussion_r479733310", "createdAt": "2020-08-30T07:21:13Z", "author": {"login": "kangkaisen"}, "path": "fe/fe-core/src/main/java/org/apache/doris/planner/DistributedPlanner.java", "diffHunk": "@@ -863,6 +863,14 @@ private PlanFragment createMergeAggregationFragment(AggregationNode node, PlanFr\n             //     childFragment.addPlanRoot(node);\n             //     return childFragment;\n             // }\n+\n+            PlanNode childPlan = childFragment.getPlanRoot();\n+            if (childPlan instanceof OlapScanNode &&\n+                    ((OlapScanNode)childPlan).getOlapTable().satisfyHashDistribution(partitionExprs)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "123dc155e122404b2a72ea56ee11c391028c0b7f"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1050, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}