{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMzU2MDQ2", "number": 2707, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMjo0MlrODWewrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyNDowOFrODWeyYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODk5MjQ3OnYy", "diffSide": "RIGHT", "path": "be/src/exprs/bitmap_function.cpp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMjo0MlrOFbQ3iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMjo0MlrOFbQ3iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDEzMjIzMw==", "bodyText": "return null when input is null.", "url": "https://github.com/apache/incubator-doris/pull/2707#discussion_r364132233", "createdAt": "2020-01-08T09:22:42Z", "author": {"login": "imay"}, "path": "be/src/exprs/bitmap_function.cpp", "diffHunk": "@@ -387,7 +387,48 @@ BigIntVal BitmapFunctions::bitmap_intersect_finalize(FunctionContext* ctx, const\n     delete src_bitmap;\n     return result;\n }\n+StringVal BitmapFunctions::bitmap_or(FunctionContext* ctx, const StringVal& src, const StringVal& dst){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc8b7ce88410c72be53eb551fdaa0cf3edfa9aa7"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODk5MzEwOnYy", "diffSide": "RIGHT", "path": "be/src/exprs/bitmap_function.cpp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMjo1NlrOFbQ39Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMjo1NlrOFbQ39Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDEzMjM0MQ==", "bodyText": "better to change src and dst to lhs and rhs.", "url": "https://github.com/apache/incubator-doris/pull/2707#discussion_r364132341", "createdAt": "2020-01-08T09:22:56Z", "author": {"login": "imay"}, "path": "be/src/exprs/bitmap_function.cpp", "diffHunk": "@@ -387,7 +387,48 @@ BigIntVal BitmapFunctions::bitmap_intersect_finalize(FunctionContext* ctx, const\n     delete src_bitmap;\n     return result;\n }\n+StringVal BitmapFunctions::bitmap_or(FunctionContext* ctx, const StringVal& src, const StringVal& dst){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc8b7ce88410c72be53eb551fdaa0cf3edfa9aa7"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODk5MzkzOnYy", "diffSide": "RIGHT", "path": "be/src/exprs/bitmap_function.cpp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMzoxNlrOFbQ4fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyMzoxNlrOFbQ4fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDEzMjQ3Ng==", "bodyText": "rename src and dst to lhs and rhs", "url": "https://github.com/apache/incubator-doris/pull/2707#discussion_r364132476", "createdAt": "2020-01-08T09:23:16Z", "author": {"login": "imay"}, "path": "be/src/exprs/bitmap_function.cpp", "diffHunk": "@@ -387,7 +387,48 @@ BigIntVal BitmapFunctions::bitmap_intersect_finalize(FunctionContext* ctx, const\n     delete src_bitmap;\n     return result;\n }\n+StringVal BitmapFunctions::bitmap_or(FunctionContext* ctx, const StringVal& src, const StringVal& dst){\n+    RoaringBitmap bitmap;\n+    if (!src.is_null) {\n+        if (src.len == 0) {\n+            bitmap.merge(*reinterpret_cast<RoaringBitmap*>(src.ptr));\n+        } else {\n+            bitmap.merge(RoaringBitmap((char*)src.ptr));\n+        }\n+    }\n+\n+    if (!dst.is_null) {\n+        if (dst.len == 0) {\n+            bitmap.merge(*reinterpret_cast<RoaringBitmap*>(dst.ptr));\n+        } else {\n+            bitmap.merge(RoaringBitmap((char*)dst.ptr));\n+        }\n+    }\n \n+    StringVal result(ctx,bitmap.size());\n+    bitmap.serialize((char*)result.ptr);\n+    return result;\n+}\n+StringVal BitmapFunctions::bitmap_and(FunctionContext* ctx, const StringVal& src, const StringVal& dst){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc8b7ce88410c72be53eb551fdaa0cf3edfa9aa7"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODk5NjgzOnYy", "diffSide": "RIGHT", "path": "gensrc/script/doris_builtins_functions.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyNDowOFrOFbQ6JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwOToyNDowOFrOFbQ6JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDEzMjkwMA==", "bodyText": "input should be BITMAP.", "url": "https://github.com/apache/incubator-doris/pull/2707#discussion_r364132900", "createdAt": "2020-01-08T09:24:08Z", "author": {"login": "imay"}, "path": "gensrc/script/doris_builtins_functions.py", "diffHunk": "@@ -610,7 +610,10 @@\n         '_ZN5doris15BitmapFunctions12bitmap_countEPN9doris_udf15FunctionContextERKNS1_9StringValE'],\n     [['bitmap_empty'], 'BITMAP', [],\n         '_ZN5doris15BitmapFunctions12bitmap_emptyEPN9doris_udf15FunctionContextE'],\n-\n+    [['bitmap_or'], 'BITMAP', ['VARCHAR','VARCHAR'],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc8b7ce88410c72be53eb551fdaa0cf3edfa9aa7"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2309, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}