{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxOTMwNDgz", "number": 3300, "title": "Use Google/CCTZ to replace boost at timezone function", "bodyText": "For #3263", "createdAt": "2020-04-10T14:27:29Z", "url": "https://github.com/apache/incubator-doris/pull/3300", "merged": true, "mergeCommit": {"oid": "ad6698cd316472b80e6b31ba95946c3ca9c9cfac"}, "closed": true, "closedAt": "2020-04-23T01:26:05Z", "author": {"login": "HangyuanLiu"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUV48HAH2gAyNDAxOTMwNDgzOmZhOTc1Y2JlYWRkZjg4OTFhYjUwZWU5NzRhY2JiNTJhMzdmMDA2YzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaSjUfgFqTM5ODY5Nzc2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fa975cbeaddf8891ab50ee974acbb52a37f006c2", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/fa975cbeaddf8891ab50ee974acbb52a37f006c2", "committedDate": "2020-04-04T13:54:46Z", "message": "fix ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c974314445f474c341879486e8f351b145f0e6b3", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/c974314445f474c341879486e8f351b145f0e6b3", "committedDate": "2020-04-05T13:28:55Z", "message": "fix ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4787c6655901f025f49cd7e4e41ef0486aa15a69", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/4787c6655901f025f49cd7e4e41ef0486aa15a69", "committedDate": "2020-04-05T13:47:26Z", "message": "fix ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "919fa2751ae342c50dca564495227c2ab4d2d42c", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/919fa2751ae342c50dca564495227c2ab4d2d42c", "committedDate": "2020-04-05T13:49:07Z", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz\n\nConflicts:\n\tbe/src/runtime/datetime_value.cpp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a5f98e42f4d7f8844c6c4b548d9aa117900fc36", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/0a5f98e42f4d7f8844c6c4b548d9aa117900fc36", "committedDate": "2020-04-05T13:54:53Z", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz\n\nConflicts:\n\tbe/src/runtime/datetime_value.cpp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20961d274ba62dce621efec48e80d9510a6ef510", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/20961d274ba62dce621efec48e80d9510a6ef510", "committedDate": "2020-04-05T14:50:09Z", "message": "fix ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e7dde30b5f4650e72c443793caa4de0441f6673", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/2e7dde30b5f4650e72c443793caa4de0441f6673", "committedDate": "2020-04-10T07:55:22Z", "message": "Merge branch 'master' of https://github.com/apache/incubator-doris into cctz"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ba25aa1a91a8bdcda0d0d944562afa26db49752", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/5ba25aa1a91a8bdcda0d0d944562afa26db49752", "committedDate": "2020-04-10T14:17:00Z", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c5f3a6f0e63cb1726c31c1984861e5762dff584", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/9c5f3a6f0e63cb1726c31c1984861e5762dff584", "committedDate": "2020-04-10T14:25:10Z", "message": "fix code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/060ff8dafaba3fe17e112f2fcf603157a58d3944", "committedDate": "2020-04-15T09:41:50Z", "message": "fix ut"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36a31850463c568fe518c1ee53c4127d809e8d4b", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/36a31850463c568fe518c1ee53c4127d809e8d4b", "committedDate": "2020-04-15T07:21:41Z", "message": "fix ut"}, "afterCommit": {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/060ff8dafaba3fe17e112f2fcf603157a58d3944", "committedDate": "2020-04-15T09:41:50Z", "message": "fix ut"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1OTk0MTgx", "url": "https://github.com/apache/incubator-doris/pull/3300#pullrequestreview-395994181", "createdAt": "2020-04-19T09:07:13Z", "commit": {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQwOTowNzoxM1rOGH0wKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQwOTowNzoxM1rOGH0wKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg1NzUxMg==", "bodyText": "Missing return value", "url": "https://github.com/apache/incubator-doris/pull/3300#discussion_r410857512", "createdAt": "2020-04-19T09:07:13Z", "author": {"login": "morningman"}, "path": "be/src/runtime/datetime_value.h", "diffHunk": "@@ -494,6 +498,33 @@ class DateTimeValue {\n         return _neg ? -tmp : tmp;\n     }\n \n+    bool find_cctz_time_zone(const std::string& timezone, cctz::time_zone& ctz) const {\n+        re2::StringPiece value;\n+        if (time_zone_offset_format_reg.Match(timezone, 0, timezone.size(), RE2::UNANCHORED, &value, 1)) {\n+            bool postive = value[0] != '-';\n+\n+            //Regular expression guarantees hour and minute mush be int \n+            int hour = std::stoi(value.substr(1, 2).as_string());\n+            int minute = std::stoi(value.substr(4, 2).as_string());\n+\n+            // timezone offsets around the world extended from -12:00 to +14:00\n+            if (!postive && hour > 12) {\n+                return false;\n+            } else if (postive && hour > 14) {\n+                return false;\n+            }\n+            int offset = hour * 60 * 60 + minute * 60;\n+            offset *= postive ? 1 : -1;\n+            ctz = cctz::fixed_time_zone(cctz::seconds(offset));\n+            return true;\n+        } else if (timezone == \"CST\"){\n+            // Supports offset and region timezone type, \"CST\" use here is compatibility purposes.\n+            ctz = cctz::fixed_time_zone(cctz::seconds(8 * 60 * 60));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9520f6f268f43cfec950302717ae596c7a5c7ad4", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/9520f6f268f43cfec950302717ae596c7a5c7ad4", "committedDate": "2020-04-20T12:28:28Z", "message": "fix bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea5a7668b4b7d7b2d665d1a1cfbd14e55b95cb05", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/ea5a7668b4b7d7b2d665d1a1cfbd14e55b95cb05", "committedDate": "2020-04-20T12:45:24Z", "message": "fix ut"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NTYwNDI5", "url": "https://github.com/apache/incubator-doris/pull/3300#pullrequestreview-396560429", "createdAt": "2020-04-20T15:25:10Z", "commit": {"oid": "ea5a7668b4b7d7b2d665d1a1cfbd14e55b95cb05"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f581e58b792b4d4b305ac273039000af69cd1ad1", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/f581e58b792b4d4b305ac273039000af69cd1ad1", "committedDate": "2020-04-21T02:51:00Z", "message": "Update timestamp_functions.cpp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "102baefc5a2fc6585d2116959ad30866c6cf18ff", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/102baefc5a2fc6585d2116959ad30866c6cf18ff", "committedDate": "2020-04-22T03:50:40Z", "message": "fix ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eaf6c13c6c853c77266f19a1b1d6004bf3759050", "author": {"user": {"login": "HangyuanLiu", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/eaf6c13c6c853c77266f19a1b1d6004bf3759050", "committedDate": "2020-04-22T03:52:02Z", "message": "Merge branch 'cctz' of https://github.com/HangyuanLiu/incubator-doris into cctz"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4Njk3NzY4", "url": "https://github.com/apache/incubator-doris/pull/3300#pullrequestreview-398697768", "createdAt": "2020-04-23T01:24:59Z", "commit": {"oid": "eaf6c13c6c853c77266f19a1b1d6004bf3759050"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3225, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}