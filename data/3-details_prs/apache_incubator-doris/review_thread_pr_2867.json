{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyODI4OTE2", "number": 2867, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQxNDowOToxM1rODeRs2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwMToyMDo1NFrODeT-6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMDczODgyOnYy", "diffSide": "RIGHT", "path": "be/src/olap/storage_engine.h", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQxNDowOToxM1rOFnVP3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwMzo1OTozNFrOFnZuBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc4NjkwOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                bool _too_many_disks_are_broken(uint32_t unused_num, uint32_t total_num);\n          \n          \n            \n                bool _check_disks_broken_percentage(uint32_t unused_num, uint32_t total_num);", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376786908", "createdAt": "2020-02-09T14:09:13Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/storage_engine.h", "diffHunk": "@@ -225,7 +224,7 @@ class StorageEngine {\n \n     OLAPStatus _judge_and_update_effective_cluster_id(int32_t cluster_id);\n \n-    OLAPStatus _start_bg_worker();\n+    bool _too_many_disks_are_broken(uint32_t unused_num, uint32_t total_num);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc5NDIwMw==", "bodyText": "Ummm, coincidentally, I did take some time to name it. Not to be pedantic, but I do think the original is better.  :-)\nThe method's return type is bool, return true means: \"yes, it is too many, so we should do something(the process will exit)\".\nso, finally, I choosed from these two:\n\n_are_too_many_disks_broken()\n_too_many_disks_are_broken()\n\nOn the other hand, percentage is a neutral noun(although we do judge by percentage), returning true, can not directly indicate whether it is a high or a low percentage,  or whether we expect it to be high or low. And like some other check_xxx()methods, It may be misinterpreted as: when true is returned, it is a valid situation (so we don't need to do anything).\nbut if we choose _check_disks_broken_percentage_is_too_hign(), it would be too long.", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376794203", "createdAt": "2020-02-09T15:52:39Z", "author": {"login": "lingbin"}, "path": "be/src/olap/storage_engine.h", "diffHunk": "@@ -225,7 +224,7 @@ class StorageEngine {\n \n     OLAPStatus _judge_and_update_effective_cluster_id(int32_t cluster_id);\n \n-    OLAPStatus _start_bg_worker();\n+    bool _too_many_disks_are_broken(uint32_t unused_num, uint32_t total_num);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc4NjkwOA=="}, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg0Mzk4MQ==", "bodyText": "OK", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376843981", "createdAt": "2020-02-10T02:11:58Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/storage_engine.h", "diffHunk": "@@ -225,7 +224,7 @@ class StorageEngine {\n \n     OLAPStatus _judge_and_update_effective_cluster_id(int32_t cluster_id);\n \n-    OLAPStatus _start_bg_worker();\n+    bool _too_many_disks_are_broken(uint32_t unused_num, uint32_t total_num);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc4NjkwOA=="}, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg2MDE2NA==", "bodyText": "_too_many_disks_on_failure()", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376860164", "createdAt": "2020-02-10T03:59:34Z", "author": {"login": "chaoyli"}, "path": "be/src/olap/storage_engine.h", "diffHunk": "@@ -225,7 +224,7 @@ class StorageEngine {\n \n     OLAPStatus _judge_and_update_effective_cluster_id(int32_t cluster_id);\n \n-    OLAPStatus _start_bg_worker();\n+    bool _too_many_disks_are_broken(uint32_t unused_num, uint32_t total_num);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc4NjkwOA=="}, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMTExMjczOnYy", "diffSide": "RIGHT", "path": "be/src/common/config.h", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwMToyMDo1NFrOFnYTUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwMjoyMzo0OFrOFnY1vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgzNjk0NQ==", "bodyText": "How about set the default to 0 to make it strict, so that we won't miss the broken disks", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376836945", "createdAt": "2020-02-10T01:20:54Z", "author": {"login": "morningman"}, "path": "be/src/common/config.h", "diffHunk": "@@ -203,7 +203,8 @@ namespace config {\n     CONF_Int32(disk_stat_monitor_interval, \"5\");\n     CONF_Int32(unused_rowset_monitor_interval, \"30\");\n     CONF_String(storage_root_path, \"${DORIS_HOME}/storage\");\n-    CONF_Int32(min_percentage_of_error_disk, \"50\");\n+    // BE process will exit if the percentage of error disk reach this value.\n+    CONF_Int32(max_percentage_of_error_disk, \"50\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg0NTc1Ng==", "bodyText": "Ok", "url": "https://github.com/apache/incubator-doris/pull/2867#discussion_r376845756", "createdAt": "2020-02-10T02:23:48Z", "author": {"login": "lingbin"}, "path": "be/src/common/config.h", "diffHunk": "@@ -203,7 +203,8 @@ namespace config {\n     CONF_Int32(disk_stat_monitor_interval, \"5\");\n     CONF_Int32(unused_rowset_monitor_interval, \"30\");\n     CONF_String(storage_root_path, \"${DORIS_HOME}/storage\");\n-    CONF_Int32(min_percentage_of_error_disk, \"50\");\n+    // BE process will exit if the percentage of error disk reach this value.\n+    CONF_Int32(max_percentage_of_error_disk, \"50\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgzNjk0NQ=="}, "originalCommit": {"oid": "5fe55e8a49c4636bd8b790ff3320591505bf317b"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2213, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}