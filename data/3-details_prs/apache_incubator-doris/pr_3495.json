{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MTg5MDEz", "number": 3495, "title": "[ASAN] Fix some address problems detected by ASAN", "bodyText": "LSAN detected errors have been fixed by a prior pathch (#3326), but\nthere are still some ASAN detected errors.\nThis patch try to fix these errors to make Doris BE more robustness.\nAnd then we can add CI run in LSAN/ASAN mode to detect memory errors\nas early as possible.", "createdAt": "2020-05-06T16:02:55Z", "url": "https://github.com/apache/incubator-doris/pull/3495", "merged": true, "mergeCommit": {"oid": "b576e54fe6479babdb52d8af639aa15d8e4f48c0"}, "closed": true, "closedAt": "2020-05-11T02:30:46Z", "author": {"login": "acelyc111"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcerCJCAFqTQwNjc3MDM5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfz3cRgFqTQwODcwNDU2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NzcwMzk3", "url": "https://github.com/apache/incubator-doris/pull/3495#pullrequestreview-406770397", "createdAt": "2020-05-06T16:12:03Z", "commit": {"oid": "8d8958227a41912f163bd4baa6df29a0fa784cd2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNjoxMjowM1rOGRanag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNjoxMjowM1rOGRanag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkxNTA1MA==", "bodyText": "Would better change to\nstring dir_name(const string& path) {\n    std::vector<char> path_copy(path.c_str(), path.c_str() + path.size() + 1);\n    return dirname(&path_copy[0]);\n}\n\nstring base_name(const string& path) {\n    std::vector<char> path_copy(path.c_str(), path.c_str() + path.size() + 1);\n    return basename(&path_copy[0]);\n}", "url": "https://github.com/apache/incubator-doris/pull/3495#discussion_r420915050", "createdAt": "2020-05-06T16:12:03Z", "author": {"login": "kangkaisen"}, "path": "be/src/util/path_util.cpp", "diffHunk": "@@ -70,13 +70,19 @@ vector<string> split_path(const string& path) {\n     return segments;\n }\n \n+struct FreeDeleter {\n+    inline void operator()(void* ptr) const {\n+        free(ptr);\n+    }\n+};\n+\n string dir_name(const string& path) {\n-    std::unique_ptr<char[]> path_copy(strdup(path.c_str()));\n+    std::unique_ptr<char[], FreeDeleter> path_copy(strdup(path.c_str()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d8958227a41912f163bd4baa6df29a0fa784cd2"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d8958227a41912f163bd4baa6df29a0fa784cd2", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/8d8958227a41912f163bd4baa6df29a0fa784cd2", "committedDate": "2020-05-06T16:00:33Z", "message": "[ASAN] Fix some address problems detected by ASAN"}, "afterCommit": {"oid": "24b0b8f30a66a84084b541e029475f2ebea44219", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/24b0b8f30a66a84084b541e029475f2ebea44219", "committedDate": "2020-05-08T02:59:54Z", "message": "[ASAN] Fix some address problems detected by ASAN\n\nLSAN detected errors have been fixed by a prior pathch (#3326), but\nthere are still some ASAN detected errors.\nThis patch try to fix these errors to improve Doris BE more robustness.\nAnd then we can add CI run in LSAN/ASAN mode to detect memory errors\nas early as possible."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac885d7b63b9dcdbf063afb37e1c02c2ff1cb864", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/ac885d7b63b9dcdbf063afb37e1c02c2ff1cb864", "committedDate": "2020-05-08T03:09:31Z", "message": "[ASAN] Fix some address problems detected by ASAN\n\nLSAN detected errors have been fixed by a prior pathch (#3326), but\nthere are still some ASAN detected errors.\nThis patch try to fix these errors to make Doris BE more robustness.\nAnd then we can add CI run in LSAN/ASAN mode to detect memory errors\nas early as possible."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24b0b8f30a66a84084b541e029475f2ebea44219", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/24b0b8f30a66a84084b541e029475f2ebea44219", "committedDate": "2020-05-08T02:59:54Z", "message": "[ASAN] Fix some address problems detected by ASAN\n\nLSAN detected errors have been fixed by a prior pathch (#3326), but\nthere are still some ASAN detected errors.\nThis patch try to fix these errors to improve Doris BE more robustness.\nAnd then we can add CI run in LSAN/ASAN mode to detect memory errors\nas early as possible."}, "afterCommit": {"oid": "ac885d7b63b9dcdbf063afb37e1c02c2ff1cb864", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/ac885d7b63b9dcdbf063afb37e1c02c2ff1cb864", "committedDate": "2020-05-08T03:09:31Z", "message": "[ASAN] Fix some address problems detected by ASAN\n\nLSAN detected errors have been fixed by a prior pathch (#3326), but\nthere are still some ASAN detected errors.\nThis patch try to fix these errors to make Doris BE more robustness.\nAnd then we can add CI run in LSAN/ASAN mode to detect memory errors\nas early as possible."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b60fcaa52fa43f9474be7dbb927707f36a09e6f7", "author": {"user": {"login": "acelyc111", "name": "Yingchun Lai"}}, "url": "https://github.com/apache/incubator-doris/commit/b60fcaa52fa43f9474be7dbb927707f36a09e6f7", "committedDate": "2020-05-09T03:30:23Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjUzODMx", "url": "https://github.com/apache/incubator-doris/pull/3495#pullrequestreview-408653831", "createdAt": "2020-05-09T14:18:37Z", "commit": {"oid": "b60fcaa52fa43f9474be7dbb927707f36a09e6f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NzA0NTY4", "url": "https://github.com/apache/incubator-doris/pull/3495#pullrequestreview-408704568", "createdAt": "2020-05-10T05:03:27Z", "commit": {"oid": "b60fcaa52fa43f9474be7dbb927707f36a09e6f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2978, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}