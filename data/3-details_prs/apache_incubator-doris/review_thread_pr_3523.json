{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MDczNjk3", "number": 3523, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwODo1Nzo1MlrOD69Rbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwOTowNzozOFrOD69UzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzMTQ3ODg2OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/alter/AlterJob.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwODo1Nzo1MlrOGTCRTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwODo1Nzo1MlrOGTCRTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxMzMyNA==", "bodyText": "Change the comment to:\n// If this backend is done for a long time and not restart automatically.\n// we consider it as dead and return false.", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r422613324", "createdAt": "2020-05-10T08:57:52Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/alter/AlterJob.java", "diffHunk": "@@ -189,18 +189,14 @@ protected boolean checkBackendState(Replica replica) {\n             return false;\n         } else if (!backend.isAlive()) {\n             long currentTime = System.currentTimeMillis();\n-            if (backend.getLastUpdateMs() > 0\n-                    && currentTime - backend.getLastUpdateMs() > Config.max_backend_down_time_second * 1000) {\n-                // this backend is done for a long time and not restart automatically.\n-                // we consider it as dead\n-                return false;\n-            }\n-            return true;\n-        } else if (backend.isDecommissioned()) {\n-            return false;\n+            // this backend is done for a long time and not restart automatically.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzMTQ4NzQ4OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/backup/RestoreJob.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwOTowNzozOFrOGTCVtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwMzoxMTozOFrOGV1CKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxNDQ1Mg==", "bodyText": "I think the part of generate file mapping can be a separated method not including in this method.\nOr the name of this method can be confused.", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r422614452", "createdAt": "2020-05-10T09:07:38Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/backup/RestoreJob.java", "diffHunk": "@@ -806,7 +739,54 @@ private void checkAndPrepareMeta() {\n         // No log here, PENDING state restore job will redo this method\n         LOG.info(\"finished to prepare meta and send snapshot tasks, num: {}. {}\",\n                  batchTask.getTaskNum(), this);\n-        return;\n+    }\n+\n+    private boolean backupReplicasNotEqual(PartitionInfo localPartInfo, Partition localPartition, Table localTbl,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 223}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYyOTY4NA==", "bodyText": "can we change the method name to genFileMappingWhenBackupReplicasEqual?", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r422629684", "createdAt": "2020-05-10T11:15:50Z", "author": {"login": "WingsGo"}, "path": "fe/src/main/java/org/apache/doris/backup/RestoreJob.java", "diffHunk": "@@ -806,7 +739,54 @@ private void checkAndPrepareMeta() {\n         // No log here, PENDING state restore job will redo this method\n         LOG.info(\"finished to prepare meta and send snapshot tasks, num: {}. {}\",\n                  batchTask.getTaskNum(), this);\n-        return;\n+    }\n+\n+    private boolean backupReplicasNotEqual(PartitionInfo localPartInfo, Partition localPartition, Table localTbl,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxNDQ1Mg=="}, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 223}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU0MjE4NA==", "bodyText": "Sorry for review delay. This name looks good to me.", "url": "https://github.com/apache/incubator-doris/pull/3523#discussion_r425542184", "createdAt": "2020-05-15T03:11:38Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/backup/RestoreJob.java", "diffHunk": "@@ -806,7 +739,54 @@ private void checkAndPrepareMeta() {\n         // No log here, PENDING state restore job will redo this method\n         LOG.info(\"finished to prepare meta and send snapshot tasks, num: {}. {}\",\n                  batchTask.getTaskNum(), this);\n-        return;\n+    }\n+\n+    private boolean backupReplicasNotEqual(PartitionInfo localPartInfo, Partition localPartition, Table localTbl,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYxNDQ1Mg=="}, "originalCommit": {"oid": "ad42a1d494098389b96c3b17e478756099124ff0"}, "originalPosition": 223}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1776, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}