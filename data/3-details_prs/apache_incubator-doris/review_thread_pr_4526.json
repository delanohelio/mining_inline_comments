{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4MzE2MDM5", "number": 4526, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODozNjoxMFrOEf4oXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxMDozMlrOEf5eng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODY5MTQ5OnYy", "diffSide": "RIGHT", "path": "be/src/olap/rowset/segment_group.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODozNjoxMFrOHMcIWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODozNjoxMFrOHMcIWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgwNTg1MA==", "bodyText": "Better to add some comment to explain why break here.", "url": "https://github.com/apache/incubator-doris/pull/4526#discussion_r482805850", "createdAt": "2020-09-03T08:36:10Z", "author": {"login": "morningman"}, "path": "be/src/olap/rowset/segment_group.cpp", "diffHunk": "@@ -258,32 +258,45 @@ OLAPStatus SegmentGroup::add_zone_maps_for_linked_schema_change(\n \n     for (size_t i = 0; i < zonemap_col_num; ++i) {\n         \n-        // in duplicated table update from 0.11 to 0.12, zone map index may be missed\n+        // in duplicated table update from 0.11 to 0.12, zone map index may be missed and may not a new column.\n         if (_schema->keys_type() == DUP_KEYS && \n             schema_mapping[i].ref_column != -1 &&\n             schema_mapping[i].ref_column >= zone_map_fields.size()) {\n-            continue;\n+            break; // _zone_maps follows _schema column index", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea1fc6cf80c26c43344fba8c7d2d74812d761ba3"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODgzMDM4OnYy", "diffSide": "RIGHT", "path": "be/src/olap/rowset/segment_group.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxMDozMlrOHMdeWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxMDozMlrOHMdeWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyNzg2Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // process should not add missed zonemap and we break the loap.\n          \n          \n            \n                        // process should not add missed zonemap and we break the loop.", "url": "https://github.com/apache/incubator-doris/pull/4526#discussion_r482827866", "createdAt": "2020-09-03T09:10:32Z", "author": {"login": "morningman"}, "path": "be/src/olap/rowset/segment_group.cpp", "diffHunk": "@@ -258,34 +258,52 @@ OLAPStatus SegmentGroup::add_zone_maps_for_linked_schema_change(\n \n     for (size_t i = 0; i < zonemap_col_num; ++i) {\n         \n-        // in duplicated table update from 0.11 to 0.12, zone map index may be missed\n+        // in duplicated table update from 0.11 to 0.12, zone map index may be missed and may not a new column.\n         if (_schema->keys_type() == DUP_KEYS && \n             schema_mapping[i].ref_column != -1 &&\n             schema_mapping[i].ref_column >= zone_map_fields.size()) {\n-            continue;\n+            \n+            // the sequence of columns in _zone_maps and _schema must be consistent, so here\n+            // process should not add missed zonemap and we break the loap.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7643afcd4fcbb733dcdcfa4de7c2540410fcb474"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1080, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}