{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NTM5MTcz", "number": 4158, "title": "[RoutineLoad] Support modify routine load job", "bodyText": "Proposed changes\nSupport ALTER ROUTINE LOAD JOB stmt, for example:\nalter routine load db1.label1\nproperties\n(\n\"desired_concurrent_number\"=\"3\",\n\"max_batch_interval\" = \"5\",\n\"max_batch_rows\" = \"300000\",\n\"max_batch_size\" = \"209715200\",\n\"strict_mode\" = \"false\",\n\"timezone\" = \"+08:00\"\n)\n\nDetails can be found in alter-routine-load.md\nTypes of changes\n\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n I have create an issue on fix #4157, and have described the bug/feature there in detail\n Compiling and unit tests pass locally with my changes\n I have added tests that prove my fix is effective or that my feature works\n If this change need a document change, I have updated the document\n Any dependent changes have been merged", "createdAt": "2020-07-23T07:55:09Z", "url": "https://github.com/apache/incubator-doris/pull/4158", "merged": true, "mergeCommit": {"oid": "237c0807a4644ab7382abd2afc69e783bfc3c4b2"}, "closed": true, "closedAt": "2020-08-06T15:11:03Z", "author": {"login": "morningman"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3q-iLAFqTQ1MzkxOTc4NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8Hr1QgFqTQ2MjE3MDYzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzOTE5Nzg1", "url": "https://github.com/apache/incubator-doris/pull/4158#pullrequestreview-453919785", "createdAt": "2020-07-23T08:16:14Z", "commit": {"oid": "d3d465b3b5a9a5d5be729a554429b543e250e8fa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODoxNjoxNFrOG2Ag6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODoxNjoxNFrOG2Ag6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI4NDcxNA==", "bodyText": "\u2018spciefied\u2019 Wrong characters", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r459284714", "createdAt": "2020-07-23T08:16:14Z", "author": {"login": "wutiangan"}, "path": "fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java", "diffHunk": "@@ -602,6 +573,24 @@ public void replayChangeRoutineLoadJob(RoutineLoadOperation operation) {\n                  .add(\"msg\", \"replay change routine load job\")\n                  .build());\n     }\n+    \n+    /**\n+     * Enter of altering a routine load job\n+     */\n+    public void alterRoutineLoadJob(AlterRoutineLoadStmt stmt) throws UserException {\n+        RoutineLoadJob job = checkPrivAndGetJob(stmt.getDbName(), stmt.getLabel());\n+        if (stmt.hasDataSourceProperty()\n+                && !stmt.getDataSourceProperties().getType().equalsIgnoreCase(job.dataSourceType.name())) {\n+            throw new DdlException(\"The spciefied job type is not: \" + stmt.getDataSourceProperties().getType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3d465b3b5a9a5d5be729a554429b543e250e8fa"}, "originalPosition": 150}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzOTI3NjUz", "url": "https://github.com/apache/incubator-doris/pull/4158#pullrequestreview-453927653", "createdAt": "2020-07-23T08:28:12Z", "commit": {"oid": "d3d465b3b5a9a5d5be729a554429b543e250e8fa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODoyODoxMlrOG2A5mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODoyODoxMlrOG2A5mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI5MTAzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                | KW_ALTER KW_ROUTINE KW_LOAD job_label:jobLabel opt_properties:properties\n          \n          \n            \n                | KW_ALTER KW_ROUTINE KW_LOAD job_label:jobLabel opt_properties:jobProperties", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r459291033", "createdAt": "2020-07-23T08:28:12Z", "author": {"login": "wutiangan"}, "path": "fe/fe-core/src/main/cup/sql_parser.cup", "diffHunk": "@@ -722,11 +724,26 @@ alter_stmt ::=\n     {:\n         RESULT = new AlterDatabaseQuotaStmt(dbName, QuotaType.REPLICA, String.valueOf(number));\n     :}\n-\n     | KW_ALTER KW_DATABASE ident:dbName KW_RENAME ident:newDbName\n     {:\n         RESULT = new AlterDatabaseRename(dbName, newDbName);\n     :}\n+    | KW_ALTER KW_ROUTINE KW_LOAD job_label:jobLabel opt_properties:properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3d465b3b5a9a5d5be729a554429b543e250e8fa"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODU1MjEx", "url": "https://github.com/apache/incubator-doris/pull/4158#pullrequestreview-459855211", "createdAt": "2020-08-03T08:50:24Z", "commit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODo1MDoyNFrOG6xT8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwOTowNzowMVrOG6x3yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI3ODUxNA==", "bodyText": "Maybe KW_ALTER KW_ROUTINE KW_LOAD KW_FOR job_label:jobLabel  is better. The other routine load stmt also has KW_FOR.", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r464278514", "createdAt": "2020-08-03T08:50:24Z", "author": {"login": "EmmyMiao87"}, "path": "fe/fe-core/src/main/cup/sql_parser.cup", "diffHunk": "@@ -722,11 +724,26 @@ alter_stmt ::=\n     {:\n         RESULT = new AlterDatabaseQuotaStmt(dbName, QuotaType.REPLICA, String.valueOf(number));\n     :}\n-\n     | KW_ALTER KW_DATABASE ident:dbName KW_RENAME ident:newDbName\n     {:\n         RESULT = new AlterDatabaseRename(dbName, newDbName);\n     :}\n+    | KW_ALTER KW_ROUTINE KW_LOAD job_label:jobLabel opt_properties:jobProperties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NzU2MA==", "bodyText": "The job properties maybe could be modified in here instead of the subclass  KafkaRoutineLoad.", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r464287560", "createdAt": "2020-08-03T09:06:46Z", "author": {"login": "EmmyMiao87"}, "path": "fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadJob.java", "diffHunk": "@@ -1397,4 +1401,36 @@ public void readFields(DataInput in) throws IOException {\n             throw new IOException(\"error happens when parsing create routine load stmt: \" + origStmt, e);\n         }\n     }\n+\n+    abstract public void modifyProperties(AlterRoutineLoadStmt stmt) throws DdlException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NzY5MA==", "bodyText": "Same as above.", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r464287690", "createdAt": "2020-08-03T09:07:01Z", "author": {"login": "EmmyMiao87"}, "path": "fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadJob.java", "diffHunk": "@@ -1397,4 +1401,36 @@ public void readFields(DataInput in) throws IOException {\n             throw new IOException(\"error happens when parsing create routine load stmt: \" + origStmt, e);\n         }\n     }\n+\n+    abstract public void modifyProperties(AlterRoutineLoadStmt stmt) throws DdlException;\n+\n+    abstract public void replayModifyProperties(AlterRoutineLoadJobOperationLog log);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODc2NDUz", "url": "https://github.com/apache/incubator-doris/pull/4158#pullrequestreview-459876453", "createdAt": "2020-08-03T09:21:02Z", "commit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwOToyMTowM1rOG6yU2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwOToyMTowM1rOG6yU2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI5NTEzMA==", "bodyText": "Put it between pause routine load and stop routine load.", "url": "https://github.com/apache/incubator-doris/pull/4158#discussion_r464295130", "createdAt": "2020-08-03T09:21:03Z", "author": {"login": "EmmyMiao87"}, "path": "docs/.vuepress/sidebar/zh-CN.js", "diffHunk": "@@ -409,6 +409,7 @@ module.exports = [\n             title: \"DML\",\n             directoryPath: \"Data Manipulation/\",\n             children: [\n+              \"alter-routine-load\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a38c4283ed244099b0eced399ad9e6d517bae2b1", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/a38c4283ed244099b0eced399ad9e6d517bae2b1", "committedDate": "2020-08-03T10:48:32Z", "message": "first"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6169592726294c054527bcf9a90880919eed47b", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/d6169592726294c054527bcf9a90880919eed47b", "committedDate": "2020-08-03T10:48:32Z", "message": "second"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0c5123918bfbeea5fe46dc4aea5866a1b5be88b", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/a0c5123918bfbeea5fe46dc4aea5866a1b5be88b", "committedDate": "2020-08-03T10:48:32Z", "message": "add doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "252314edd599ea9a39047aa218eadd2266dba6b5", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/252314edd599ea9a39047aa218eadd2266dba6b5", "committedDate": "2020-08-03T10:48:32Z", "message": "second"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ae88682fc871a06065b294be2ffb7afe48641c7", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/5ae88682fc871a06065b294be2ffb7afe48641c7", "committedDate": "2020-08-03T10:48:33Z", "message": "rebase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9f7515a71bf7d8114ce967985235d3cd867a323", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/e9f7515a71bf7d8114ce967985235d3cd867a323", "committedDate": "2020-08-03T10:49:15Z", "message": "rebase modify 2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d28617e640373319e9ce8c15511608bc3649b3a2", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/d28617e640373319e9ce8c15511608bc3649b3a2", "committedDate": "2020-08-03T10:49:15Z", "message": "fix bug1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1007434d84086a0f8620e64365d82fd15febee2d", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/1007434d84086a0f8620e64365d82fd15febee2d", "committedDate": "2020-08-03T10:49:15Z", "message": "final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2aab7ae654e75fb9792f9f573e5fe6e201e42e45", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/2aab7ae654e75fb9792f9f573e5fe6e201e42e45", "committedDate": "2020-08-03T10:49:15Z", "message": "fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b42b7d9507542d864853be6ef04f07e88900e95", "author": {"user": {"login": "morningman-cmy", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/4b42b7d9507542d864853be6ef04f07e88900e95", "committedDate": "2020-08-03T10:49:15Z", "message": "fix by review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a94cb007c5b602795150d58478f07ce48117abb7", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/a94cb007c5b602795150d58478f07ce48117abb7", "committedDate": "2020-07-23T13:04:56Z", "message": "fix typo"}, "afterCommit": {"oid": "4b42b7d9507542d864853be6ef04f07e88900e95", "author": {"user": {"login": "morningman-cmy", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/4b42b7d9507542d864853be6ef04f07e88900e95", "committedDate": "2020-08-03T10:49:15Z", "message": "fix by review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c917d3069f87bdf9acd17acb75b500b87ad02822", "author": {"user": {"login": "morningman", "name": "Mingyu Chen"}}, "url": "https://github.com/apache/incubator-doris/commit/c917d3069f87bdf9acd17acb75b500b87ad02822", "committedDate": "2020-08-03T10:56:35Z", "message": "add json root"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2358f36e1090483ba710626dc7ceae5c469107f", "author": {"user": {"login": "morningman-cmy", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/a2358f36e1090483ba710626dc7ceae5c469107f", "committedDate": "2020-08-05T15:22:01Z", "message": "fix ut"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMTcwNjM4", "url": "https://github.com/apache/incubator-doris/pull/4158#pullrequestreview-462170638", "createdAt": "2020-08-06T03:58:45Z", "commit": {"oid": "a2358f36e1090483ba710626dc7ceae5c469107f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2017, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}