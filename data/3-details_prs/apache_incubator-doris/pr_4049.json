{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1NTE4MDA3", "number": 4049, "title": "[Thread Resource Leak] Fix thread resource leak after checkpoint catalog destroyed", "bodyText": "This PR is mainly to fix thread resource leak, and then add some notice to use newDaemonScheduledThreadPool api in ThreadPoolManager .", "createdAt": "2020-07-07T16:19:30Z", "url": "https://github.com/apache/incubator-doris/pull/4049", "merged": true, "mergeCommit": {"oid": "db50c19aadae1d5e0d53960aea1d673a08f5a988"}, "closed": true, "closedAt": "2020-07-16T14:38:39Z", "author": {"login": "caiconghui"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcymS8ngH2gAyNDQ1NTE4MDA3OjllZTBkZTgyZDg4MmUzYWQzOTg3YzgxNmMyNzI4OWI1ZTk2ZjRiZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1XKe0AFqTQ0OTQ5MTcyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9ee0de82d882e3ad3987c816c27289b5e96f4bee", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/9ee0de82d882e3ad3987c816c27289b5e96f4bee", "committedDate": "2020-07-07T13:59:23Z", "message": "[Thread Resource Leak]Fix thread resource leak after checkpoint catalog destroyed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90028eee951efceabd603e1c7e0b6737cc71506b", "author": {"user": {"login": "caiconghui", "name": "caiconghui"}}, "url": "https://github.com/apache/incubator-doris/commit/90028eee951efceabd603e1c7e0b6737cc71506b", "committedDate": "2020-07-07T16:14:54Z", "message": "refactor MasterTaskExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c5fa0ee14f11ddc31e06c2b70c142122cb05edd", "author": {"user": {"login": "caiconghui", "name": "caiconghui"}}, "url": "https://github.com/apache/incubator-doris/commit/4c5fa0ee14f11ddc31e06c2b70c142122cb05edd", "committedDate": "2020-07-07T16:36:44Z", "message": "fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MzU0NTkz", "url": "https://github.com/apache/incubator-doris/pull/4049#pullrequestreview-444354593", "createdAt": "2020-07-08T01:34:16Z", "commit": {"oid": "4c5fa0ee14f11ddc31e06c2b70c142122cb05edd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMTozNDoxNlrOGuVCqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMTozNDoxNlrOGuVCqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIzMjQyNQ==", "bodyText": "Looks like this class is not used now.\nMaybe we can mark it as @deprecated now, or even remove it?", "url": "https://github.com/apache/incubator-doris/pull/4049#discussion_r451232425", "createdAt": "2020-07-08T01:34:16Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/common/publish/FixedTimePublisher.java", "diffHunk": "@@ -28,7 +28,7 @@\n public class FixedTimePublisher {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c5fa0ee14f11ddc31e06c2b70c142122cb05edd"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cdc6347276c7412d4645e8928c98aa22055a234", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/3cdc6347276c7412d4645e8928c98aa22055a234", "committedDate": "2020-07-08T02:45:27Z", "message": "Remove unused file FixedTimePublisher.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57e2bda4c3b1db78a7732ef98ae943dd545e8153", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/57e2bda4c3b1db78a7732ef98ae943dd545e8153", "committedDate": "2020-07-08T03:07:16Z", "message": "fix comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0fbdc5710b5d2583c5d80a03f74b3cc3b1b698b", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/f0fbdc5710b5d2583c5d80a03f74b3cc3b1b698b", "committedDate": "2020-07-08T05:41:15Z", "message": "Fix that thread pool in checkpoint catalog doesn't need register metric"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NDQyNjgw", "url": "https://github.com/apache/incubator-doris/pull/4049#pullrequestreview-444442680", "createdAt": "2020-07-08T06:21:06Z", "commit": {"oid": "f0fbdc5710b5d2583c5d80a03f74b3cc3b1b698b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoyMTowN1rOGuZrrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoyMTowN1rOGuZrrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwODQ2Mg==", "bodyText": "maybe we should add some comment to this arg, such as: if isCheckpointCatalog is false means we need to do some thread metrics collect.", "url": "https://github.com/apache/incubator-doris/pull/4049#discussion_r451308462", "createdAt": "2020-07-08T06:21:07Z", "author": {"login": "WingsGo"}, "path": "fe/src/main/java/org/apache/doris/catalog/Catalog.java", "diffHunk": "@@ -458,10 +459,10 @@ public DynamicPartitionScheduler getDynamicPartitionScheduler() {\n     }\n \n     private static class SingletonHolder {\n-        private static final Catalog INSTANCE = new Catalog();\n+        private static final Catalog INSTANCE = new Catalog(false);\n     }\n \n-    private Catalog() {\n+    private Catalog(boolean isCheckpointCatalog) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0fbdc5710b5d2583c5d80a03f74b3cc3b1b698b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d19205a1de65cd598e1af4cce7555711aebb246", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/7d19205a1de65cd598e1af4cce7555711aebb246", "committedDate": "2020-07-08T06:56:38Z", "message": "add comment about isCheckpointCatalog parameter in Catalog constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45267aafda32f06f109b1c17294b5540880f8b6b", "author": {"user": null}, "url": "https://github.com/apache/incubator-doris/commit/45267aafda32f06f109b1c17294b5540880f8b6b", "committedDate": "2020-07-15T02:28:05Z", "message": "Add shutdown scheduledThreadPool when close MasterTaskExecutor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a24c7c4c3ec4c79bbb4c632918048cccd06a1f8c", "author": {"user": {"login": "caiconghui", "name": "caiconghui"}}, "url": "https://github.com/apache/incubator-doris/commit/a24c7c4c3ec4c79bbb4c632918048cccd06a1f8c", "committedDate": "2020-07-15T16:25:42Z", "message": "fix unit test failed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDkxNzI5", "url": "https://github.com/apache/incubator-doris/pull/4049#pullrequestreview-449491729", "createdAt": "2020-07-16T04:03:20Z", "commit": {"oid": "a24c7c4c3ec4c79bbb4c632918048cccd06a1f8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2333, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}