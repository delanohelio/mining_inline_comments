{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5OTQxODE2", "number": 3948, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoxOToyMVrOEJHKGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoyMDowOFrOEJHK-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTg5OTEzOnYy", "diffSide": "RIGHT", "path": "gensrc/thrift/FrontendService.thrift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoxOToyMVrOGpewhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoxOToyMVrOGpewhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE0ODc0Mw==", "bodyText": "new fields should be optional, for compatibility.\nAnd it need to be checked isset when use it.", "url": "https://github.com/apache/incubator-doris/pull/3948#discussion_r446148743", "createdAt": "2020-06-26T12:19:21Z", "author": {"login": "morningman"}, "path": "gensrc/thrift/FrontendService.thrift", "diffHunk": "@@ -600,6 +601,7 @@ struct TLoadTxnCommitRequest {\n     9: optional list<Types.TTabletCommitInfo> commitInfos\n     10: optional i64 auth_code\n     11: optional TTxnCommitAttachment txnCommitAttachment\n+    12: required i64 thrift_rpc_timeout_ms", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a59b47c23ad07368d8db02ec32b8f074a3e26629"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTg5OTU3OnYy", "diffSide": "RIGHT", "path": "gensrc/thrift/FrontendService.thrift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoxOTozMFrOGpew0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoxOTozMFrOGpew0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE0ODgxNg==", "bodyText": "optional", "url": "https://github.com/apache/incubator-doris/pull/3948#discussion_r446148816", "createdAt": "2020-06-26T12:19:30Z", "author": {"login": "morningman"}, "path": "gensrc/thrift/FrontendService.thrift", "diffHunk": "@@ -550,6 +550,7 @@ struct TStreamLoadPutRequest {\n     22: optional bool isTempPartition\n     23: optional bool strip_outer_array\n     24: optional string jsonpaths\n+    25: required i64 thrift_rpc_timeout_ms", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a59b47c23ad07368d8db02ec32b8f074a3e26629"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTkwMTM3OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/transaction/GlobalTransactionMgr.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoyMDowOFrOGpex4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoyMDowOFrOGpex4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE0OTA5MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        throw new UserException(\"get database read lock timeout, database=\" + db.getFullName());\n          \n          \n            \n                        throw new UserException(\"get database write lock timeout, database=\" + db.getFullName());", "url": "https://github.com/apache/incubator-doris/pull/3948#discussion_r446149091", "createdAt": "2020-06-26T12:20:08Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/transaction/GlobalTransactionMgr.java", "diffHunk": "@@ -185,7 +186,9 @@ public boolean commitAndPublishTransaction(Database db, long transactionId,\n             List<TabletCommitInfo> tabletCommitInfos, long timeoutMillis,\n             TxnCommitAttachment txnCommitAttachment)\n             throws UserException {\n-        db.writeLock();\n+        if (!db.tryWriteLock(timeoutMillis, TimeUnit.MILLISECONDS)) {\n+            throw new UserException(\"get database read lock timeout, database=\" + db.getFullName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a59b47c23ad07368d8db02ec32b8f074a3e26629"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1318, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}