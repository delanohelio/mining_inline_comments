{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMjc2MzIw", "number": 3136, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTozMjowN1rODpunHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTo0MzozMFrODpusfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MDgxODg1OnYy", "diffSide": "RIGHT", "path": "be/src/olap/task/engine_storage_migration_task.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTozMjowN1rOF5Firw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTozMjowN1rOF5Firw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQwMzk1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                DCHECK(store);\n          \n          \n            \n                DCHECK(store != nullptr);\n          \n      \n    \n    \n  \n\nPrefer \"var != nullptr\" for pointer compare. Only use this when the bool value", "url": "https://github.com/apache/incubator-doris/pull/3136#discussion_r395403951", "createdAt": "2020-03-20T01:32:07Z", "author": {"login": "imay"}, "path": "be/src/olap/task/engine_storage_migration_task.cpp", "diffHunk": "@@ -234,21 +225,13 @@ OLAPStatus EngineStorageMigrationTask::_storage_medium_migrate(\n }\n \n // TODO(ygl): lost some infomation here, such as cumulative layer point\n-OLAPStatus EngineStorageMigrationTask::_generate_new_header(\n+void EngineStorageMigrationTask::_generate_new_header(\n         DataDir* store, const uint64_t new_shard,\n         const TabletSharedPtr& tablet,\n         const std::vector<RowsetSharedPtr>& consistent_rowsets,\n         TabletMetaSharedPtr new_tablet_meta) {\n-    if (store == nullptr) {\n-        LOG(WARNING) << \"fail to generate new header for store is null\";\n-        return OLAP_ERR_HEADER_INIT_FAILED;\n-    }\n-    OLAPStatus res = tablet->generate_tablet_meta_copy(new_tablet_meta);\n-    if (res != OLAP_SUCCESS) {\n-        LOG(WARNING) << \"could not generate new tablet meta. \"\n-                     << \"tablet:\" << tablet->full_name();\n-        return res;\n-    }\n+    DCHECK(store);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55e033199e4928f3159d5017e1ac62d4b51ea457"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MDgzMDc3OnYy", "diffSide": "RIGHT", "path": "be/src/olap/snapshot_manager.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTo0MjowMlrOF5Fp5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTo0MjowMlrOF5Fp5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQwNTc5Nw==", "bodyText": "Seems that it will be better to make argument a rvalue reference.", "url": "https://github.com/apache/incubator-doris/pull/3136#discussion_r395405797", "createdAt": "2020-03-20T01:42:02Z", "author": {"login": "imay"}, "path": "be/src/olap/snapshot_manager.cpp", "diffHunk": "@@ -558,9 +541,9 @@ OLAPStatus SnapshotManager::_convert_beta_rowsets_to_alpha(const TabletMetaShare\n     }\n     if (res == OLAP_SUCCESS && modified) {\n         if (is_incremental) {\n-            res = new_tablet_meta->revise_inc_rs_metas(new_rowset_metas);\n+            new_tablet_meta->revise_inc_rs_metas(new_rowset_metas);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55e033199e4928f3159d5017e1ac62d4b51ea457"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MDgzMjYzOnYy", "diffSide": "RIGHT", "path": "be/src/olap/snapshot_manager.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTo0MzozMFrOF5Fq_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMTo0MzozMFrOF5Fq_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQwNjA3OA==", "bodyText": "same with above", "url": "https://github.com/apache/incubator-doris/pull/3136#discussion_r395406078", "createdAt": "2020-03-20T01:43:30Z", "author": {"login": "imay"}, "path": "be/src/olap/snapshot_manager.cpp", "diffHunk": "@@ -558,9 +541,9 @@ OLAPStatus SnapshotManager::_convert_beta_rowsets_to_alpha(const TabletMetaShare\n     }\n     if (res == OLAP_SUCCESS && modified) {\n         if (is_incremental) {\n-            res = new_tablet_meta->revise_inc_rs_metas(new_rowset_metas);\n+            new_tablet_meta->revise_inc_rs_metas(new_rowset_metas);\n         } else {\n-            res = new_tablet_meta->revise_rs_metas(new_rowset_metas);\n+            new_tablet_meta->revise_rs_metas(new_rowset_metas);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55e033199e4928f3159d5017e1ac62d4b51ea457"}, "originalPosition": 61}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1966, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}