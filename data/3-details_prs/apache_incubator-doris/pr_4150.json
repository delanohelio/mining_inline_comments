{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NDU0Mjg3", "number": 4150, "title": "[BUG] fix 4149, add sessionVariable to choose broadcastjoin first when cardinality cannot be estimated", "bodyText": "fix #4149\nadd sessionVariable \"prefer_broadcast_join\" to choose broadcastjoin first when cardinality cannot be estimated\nthe sessionVariable can set local or global. the default value is true, prefer broadcast join first where the two cost is equal.", "createdAt": "2020-07-23T03:01:10Z", "url": "https://github.com/apache/incubator-doris/pull/4150", "merged": true, "mergeCommit": {"oid": "59676a11170da90b2a9e883ca02f1af6dc2d659b"}, "closed": true, "closedAt": "2020-07-29T04:28:53Z", "author": {"login": "wutiangan"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3mascAH2gAyNDU1NDU0Mjg3OmM3Y2ZlN2M0YWMxYmNmYWU3NDUyOWUwODM5NDExMDE0MjFlZTJkZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5UjhcAFqTQ1NjUzMzkwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c7cfe7c4ac1bcfae74529e083941101421ee2dd6", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/c7cfe7c4ac1bcfae74529e083941101421ee2dd6", "committedDate": "2020-07-23T02:57:28Z", "message": "[BUG] fix 4149, add sessionVariable to choose broadcastjoin first when cardinality cannot be estimated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzODEzMjQ3", "url": "https://github.com/apache/incubator-doris/pull/4150#pullrequestreview-453813247", "createdAt": "2020-07-23T03:14:53Z", "commit": {"oid": "c7cfe7c4ac1bcfae74529e083941101421ee2dd6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzODE1MjM1", "url": "https://github.com/apache/incubator-doris/pull/4150#pullrequestreview-453815235", "createdAt": "2020-07-23T03:23:50Z", "commit": {"oid": "c7cfe7c4ac1bcfae74529e083941101421ee2dd6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoyMzo1MFrOG17EtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoyMzo1MFrOG17EtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NTU3Mw==", "bodyText": "How about name it to \"prefer_join_method\", and value is \"broadcast\" or \"shuffle\"", "url": "https://github.com/apache/incubator-doris/pull/4150#discussion_r459195573", "createdAt": "2020-07-23T03:23:50Z", "author": {"login": "morningman"}, "path": "docs/zh-CN/administrator-guide/variables.md", "diffHunk": "@@ -338,3 +338,6 @@ SET forward_to_master = concat('tr', 'u', 'e');\n \n     \u662f\u5426\u5c06 bitmap \u548c hll \u7c7b\u578b\u7684 count distinct \u67e5\u8be2\u91cd\u5199\u4e3a bitmap_union_count \u548c hll_union_agg \u3002\n \n+* `prefer_broadcast_join`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7cfe7c4ac1bcfae74529e083941101421ee2dd6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdafba2f22ccb53e899942e58fe7d76a4191ae7d", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/bdafba2f22ccb53e899942e58fe7d76a4191ae7d", "committedDate": "2020-07-23T06:17:21Z", "message": "change the sessionVariable's name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b0a80eb2f6f64c5ca0a16cb9d6e724a0c629f43", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/7b0a80eb2f6f64c5ca0a16cb9d6e724a0c629f43", "committedDate": "2020-07-23T06:39:36Z", "message": "add optional values for doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzODY4MzYx", "url": "https://github.com/apache/incubator-doris/pull/4150#pullrequestreview-453868361", "createdAt": "2020-07-23T06:42:43Z", "commit": {"oid": "7b0a80eb2f6f64c5ca0a16cb9d6e724a0c629f43"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzOTMxMTIz", "url": "https://github.com/apache/incubator-doris/pull/4150#pullrequestreview-453931123", "createdAt": "2020-07-23T08:33:09Z", "commit": {"oid": "bdafba2f22ccb53e899942e58fe7d76a4191ae7d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODozMzowOVrOG2BEgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwODozMzowOVrOG2BEgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI5MzgyNg==", "bodyText": "equalsIgnoreCase should more better.", "url": "https://github.com/apache/incubator-doris/pull/4150#discussion_r459293826", "createdAt": "2020-07-23T08:33:09Z", "author": {"login": "kangkaisen"}, "path": "fe/fe-core/src/main/java/org/apache/doris/planner/DistributedPlanner.java", "diffHunk": "@@ -286,7 +286,8 @@ private PlanFragment createScanFragment(PlanNode node) {\n      * Therefore, we add a SessionVariable to help users choose a better join implementation.\n      */\n     private boolean isBroadcastCostSmaller(long broadcastCost, long partitionCost)  {\n-        if (ConnectContext.get().getSessionVariable().isPreferBroadcastJoin()) {\n+        String joinMethod = ConnectContext.get().getSessionVariable().getPreferJoinMethod();\n+        if (joinMethod.equals(\"broadcast\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdafba2f22ccb53e899942e58fe7d76a4191ae7d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b43c5dfb143975751d08a53ae5adf38270f5ab4", "author": {"user": {"login": "wutiangan", "name": null}}, "url": "https://github.com/apache/incubator-doris/commit/8b43c5dfb143975751d08a53ae5adf38270f5ab4", "committedDate": "2020-07-28T09:08:55Z", "message": "change equals to equalsIgnoreCase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NTMzOTA4", "url": "https://github.com/apache/incubator-doris/pull/4150#pullrequestreview-456533908", "createdAt": "2020-07-28T11:16:40Z", "commit": {"oid": "8b43c5dfb143975751d08a53ae5adf38270f5ab4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2004, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}