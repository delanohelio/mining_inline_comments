{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTczMjg2", "number": 3098, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0MDo1NVrODntHCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0Mjo1NVrODntH1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyOTYwMTM2OnYy", "diffSide": "RIGHT", "path": "be/src/olap/rowset/alpha_rowset.cpp", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0MDo1NVrOF12x0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjoyNDoyNVrOF2BvCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjMzOQ==", "bodyText": "Why add a check for largest_segment_group->current_num_rows_per_row_block() == 0?\nYou encounter this issue #2750?", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392016339", "createdAt": "2020-03-13T03:40:55Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/rowset/alpha_rowset.cpp", "diffHunk": "@@ -166,7 +166,9 @@ OLAPStatus AlphaRowset::split_range(\n     RowBlockPosition step_pos;\n \n     std::shared_ptr<SegmentGroup> largest_segment_group = _segment_group_with_largest_size();\n-    if (largest_segment_group == nullptr) {\n+    if (largest_segment_group == nullptr || largest_segment_group->current_num_rows_per_row_block() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEzMjQ3NA==", "bodyText": "Yes, so I and a check here to avoid coredump in our product env, but leave a warning log to observe. This problem still needs to be analyzed.", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392132474", "createdAt": "2020-03-13T10:02:20Z", "author": {"login": "morningman"}, "path": "be/src/olap/rowset/alpha_rowset.cpp", "diffHunk": "@@ -166,7 +166,9 @@ OLAPStatus AlphaRowset::split_range(\n     RowBlockPosition step_pos;\n \n     std::shared_ptr<SegmentGroup> largest_segment_group = _segment_group_with_largest_size();\n-    if (largest_segment_group == nullptr) {\n+    if (largest_segment_group == nullptr || largest_segment_group->current_num_rows_per_row_block() == 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjMzOQ=="}, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE5NTg1MA==", "bodyText": "OK", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392195850", "createdAt": "2020-03-13T12:24:25Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/rowset/alpha_rowset.cpp", "diffHunk": "@@ -166,7 +166,9 @@ OLAPStatus AlphaRowset::split_range(\n     RowBlockPosition step_pos;\n \n     std::shared_ptr<SegmentGroup> largest_segment_group = _segment_group_with_largest_size();\n-    if (largest_segment_group == nullptr) {\n+    if (largest_segment_group == nullptr || largest_segment_group->current_num_rows_per_row_block() == 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjMzOQ=="}, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyOTYwMzQzOnYy", "diffSide": "RIGHT", "path": "be/src/olap/task/engine_publish_version_task.cpp", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzo0Mjo1NVrOF12zFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMzo1MToyM1rOF2EZ6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjY2Mw==", "bodyText": "I think we shouldn't remove these logs.\nThese logs are very important for track transaction issue.", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392016663", "createdAt": "2020-03-13T03:42:55Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/task/engine_publish_version_task.cpp", "diffHunk": "@@ -60,7 +60,7 @@ OLAPStatus EnginePublishVersionTask::finish() {\n             OLAPStatus publish_status = OLAP_SUCCESS;\n             TabletInfo tablet_info = tablet_rs.first;\n             RowsetSharedPtr rowset = tablet_rs.second;\n-            LOG(INFO) << \"begin to publish version on tablet. \"\n+            VLOG(3) << \"begin to publish version on tablet. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEzMzU1Nw==", "bodyText": "There are too many this kind of logs in our env. Why you need a \"begin\" log?", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392133557", "createdAt": "2020-03-13T10:04:35Z", "author": {"login": "morningman"}, "path": "be/src/olap/task/engine_publish_version_task.cpp", "diffHunk": "@@ -60,7 +60,7 @@ OLAPStatus EnginePublishVersionTask::finish() {\n             OLAPStatus publish_status = OLAP_SUCCESS;\n             TabletInfo tablet_info = tablet_rs.first;\n             RowsetSharedPtr rowset = tablet_rs.second;\n-            LOG(INFO) << \"begin to publish version on tablet. \"\n+            VLOG(3) << \"begin to publish version on tablet. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjY2Mw=="}, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE5NzMwNA==", "bodyText": "Would better keep all publish version and transaction log. Our publish version and transaction performance is still poor. We need these logs to track issue.", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392197304", "createdAt": "2020-03-13T12:27:59Z", "author": {"login": "kangkaisen"}, "path": "be/src/olap/task/engine_publish_version_task.cpp", "diffHunk": "@@ -60,7 +60,7 @@ OLAPStatus EnginePublishVersionTask::finish() {\n             OLAPStatus publish_status = OLAP_SUCCESS;\n             TabletInfo tablet_info = tablet_rs.first;\n             RowsetSharedPtr rowset = tablet_rs.second;\n-            LOG(INFO) << \"begin to publish version on tablet. \"\n+            VLOG(3) << \"begin to publish version on tablet. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjY2Mw=="}, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIzOTU5Mw==", "bodyText": "OK, I will leave the begin and finish log", "url": "https://github.com/apache/incubator-doris/pull/3098#discussion_r392239593", "createdAt": "2020-03-13T13:51:23Z", "author": {"login": "morningman"}, "path": "be/src/olap/task/engine_publish_version_task.cpp", "diffHunk": "@@ -60,7 +60,7 @@ OLAPStatus EnginePublishVersionTask::finish() {\n             OLAPStatus publish_status = OLAP_SUCCESS;\n             TabletInfo tablet_info = tablet_rs.first;\n             RowsetSharedPtr rowset = tablet_rs.second;\n-            LOG(INFO) << \"begin to publish version on tablet. \"\n+            VLOG(3) << \"begin to publish version on tablet. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNjY2Mw=="}, "originalCommit": {"oid": "5574b05f61545bddec3b6a343db36f9c8e8d4a2d"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2108, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}