{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MTg0MTU4", "number": 4086, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMTozNlrOEOtBgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMzoyOVrOEOtEkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODUzMTg1OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMTozNlrOGyACSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMTozNlrOGyACSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA4MjU2OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private void SetVisibleVersion(long visibleVersion, long visibleVersionHash){\n          \n          \n            \n                private void setVisibleVersion(long visibleVersion, long visibleVersionHash){", "url": "https://github.com/apache/incubator-doris/pull/4086#discussion_r455082568", "createdAt": "2020-07-15T14:11:36Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "diffHunk": "@@ -181,9 +182,27 @@ public long getVisibleVersion() {\n         return visibleVersion;\n     }\n \n+    public long getVisibleVersionTime() {\n+        return visibleVersionTime;\n+    }\n+\n     public long getVisibleVersionHash() {\n         return visibleVersionHash;\n     }\n+    \n+    // The method updateVisibleVersionAndVersionHash is called when fe restart, the visibleVersionTime is updated\n+    private void SetVisibleVersion(long visibleVersion, long visibleVersionHash){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afb5c3f248365a2f03fd1254e1e85aa2de0cd6f6"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODUzMjk5OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMTo1MlrOGyAC9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMTo1MlrOGyAC9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA4Mjc0MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void SetVisibleVersion(long visibleVersion, long visibleVersionHash, long visibleVersionTime){\n          \n          \n            \n                public void setVisibleVersion(long visibleVersion, long visibleVersionHash, long visibleVersionTime){", "url": "https://github.com/apache/incubator-doris/pull/4086#discussion_r455082740", "createdAt": "2020-07-15T14:11:52Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "diffHunk": "@@ -181,9 +182,27 @@ public long getVisibleVersion() {\n         return visibleVersion;\n     }\n \n+    public long getVisibleVersionTime() {\n+        return visibleVersionTime;\n+    }\n+\n     public long getVisibleVersionHash() {\n         return visibleVersionHash;\n     }\n+    \n+    // The method updateVisibleVersionAndVersionHash is called when fe restart, the visibleVersionTime is updated\n+    private void SetVisibleVersion(long visibleVersion, long visibleVersionHash){\n+        this.visibleVersion = visibleVersion;\n+        this.visibleVersionTime = System.currentTimeMillis();\n+        this.visibleVersionHash = visibleVersionHash;\n+    }\n+\n+    //Just for unit test\n+    public void SetVisibleVersion(long visibleVersion, long visibleVersionHash, long visibleVersionTime){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afb5c3f248365a2f03fd1254e1e85aa2de0cd6f6"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzODUzOTY4OnYy", "diffSide": "RIGHT", "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMzoyOVrOGyAHWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNDoxMzoyOVrOGyAHWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA4Mzg2Ng==", "bodyText": "If you do not persist the visibleVersionTime in edit log, than write it here is meaningless.", "url": "https://github.com/apache/incubator-doris/pull/4086#discussion_r455083866", "createdAt": "2020-07-15T14:13:29Z", "author": {"login": "morningman"}, "path": "fe/src/main/java/org/apache/doris/catalog/Partition.java", "diffHunk": "@@ -344,6 +363,9 @@ public void write(DataOutput out) throws IOException {\n         }\n \n         out.writeLong(visibleVersion);\n+        if (Catalog.getCurrentCatalogJournalVersion() >= FeMetaVersion.VERSION_88) {\n+            out.writeLong(visibleVersionTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afb5c3f248365a2f03fd1254e1e85aa2de0cd6f6"}, "originalPosition": 70}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1414, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}