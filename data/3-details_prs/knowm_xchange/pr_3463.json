{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMDYyMTg1", "number": 3463, "title": "[Binance] Add subAccount Transfert History", "bodyText": "Add two funding record api fetch,\none for the master account ( with a mandatory sub account email ),\none for the subaccount ( nothing mandatory ).", "createdAt": "2020-03-22T20:02:25Z", "url": "https://github.com/knowm/XChange/pull/3463", "merged": true, "mergeCommit": {"oid": "aa6ba21ee48531075efffb8616d8ae08c3753b54"}, "closed": true, "closedAt": "2020-04-05T10:55:30Z", "author": {"login": "trixprod"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQPQMWAH2gAyMzkyMDYyMTg1OmMxZGY2Y2ZlNDI5NmJhNjg3NzY4NWRiNTBmZTk2Nzk3MWViYTY0Yzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTxFryAH2gAyMzkyMDYyMTg1OmUwZjBhNzM5MGVjOWRmNzkzNGFiZTcwMDlkNjllZTIxMjg5ZWY1MWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c1df6cfe4296ba6877685db50fe967971eba64c8", "author": {"user": {"login": "trixprod", "name": "Sylvain"}}, "url": "https://github.com/knowm/XChange/commit/c1df6cfe4296ba6877685db50fe967971eba64c8", "committedDate": "2020-03-22T19:55:08Z", "message": "Add Sub Account transfert history"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f3cb906c55448d83ff1ef842e4c74603b5fb1dd", "author": {"user": {"login": "trixprod", "name": "Sylvain"}}, "url": "https://github.com/knowm/XChange/commit/5f3cb906c55448d83ff1ef842e4c74603b5fb1dd", "committedDate": "2020-03-22T19:55:11Z", "message": "Add Sub Account transfert history"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4", "author": {"user": {"login": "trixprod", "name": "Sylvain"}}, "url": "https://github.com/knowm/XChange/commit/520197da8563256e708dc1e924c4c19d1697a6b4", "committedDate": "2020-03-22T19:57:55Z", "message": "Restore version of xchange"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNzgzNzQ1", "url": "https://github.com/knowm/XChange/pull/3463#pullrequestreview-381783745", "createdAt": "2020-03-26T08:22:45Z", "commit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwODoyMjo0NVrOF77sNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwODo0MTowOVrOF78UGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM4ODI3Nw==", "bodyText": "if your using lombok then these setters / getters are not needed", "url": "https://github.com/knowm/XChange/pull/3463#discussion_r398388277", "createdAt": "2020-03-26T08:22:45Z", "author": {"login": "walec51"}, "path": "xchange-binance/src/main/java/org/knowm/xchange/binance/dto/account/TransfertHistoryResponse.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package org.knowm.xchange.binance.dto.account;\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.math.BigDecimal;\n+import java.util.Arrays;\n+import java.util.List;\n+import lombok.Data;\n+\n+public final class TransfertHistoryResponse\n+    extends WapiResponse<List<TransfertHistoryResponse.TransfertHistory>> {\n+\n+  private final TransfertHistory[] transfertHistories;\n+\n+  public TransfertHistoryResponse(\n+      @JsonProperty(\"transfers\") TransfertHistoryResponse.TransfertHistory[] transfertHistories,\n+      @JsonProperty(\"success\") boolean success,\n+      @JsonProperty(\"msg\") String msg) {\n+    super(success, msg);\n+    this.transfertHistories = transfertHistories;\n+  }\n+\n+  @Override\n+  public List<TransfertHistory> getData() {\n+    return Arrays.asList(transfertHistories);\n+  }\n+\n+  @Override\n+  public String toString() {\n+    return \"transfertHistories [rows=\" + Arrays.toString(transfertHistories) + \"]\";\n+  }\n+\n+  @Data\n+  public static final class TransfertHistory {\n+    private String from;\n+    private String to;\n+    private String asset;\n+    private BigDecimal qty;\n+    private long time;\n+\n+    public String getFrom() {\n+      return from;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM4OTczMQ==", "bodyText": "I don't think this is needed", "url": "https://github.com/knowm/XChange/pull/3463#discussion_r398389731", "createdAt": "2020-03-26T08:25:15Z", "author": {"login": "walec51"}, "path": "xchange-binance/src/main/java/org/knowm/xchange/binance/service/BinanceAccountService.java", "diffHunk": "@@ -287,6 +304,52 @@ public TradeHistoryParams createFundingHistoryParams() {\n                 });\n       }\n \n+      final String finalEmail = email;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5MDI1Mg==", "bodyText": "please use builder", "url": "https://github.com/knowm/XChange/pull/3463#discussion_r398390252", "createdAt": "2020-03-26T08:26:10Z", "author": {"login": "walec51"}, "path": "xchange-binance/src/main/java/org/knowm/xchange/binance/service/BinanceAccountService.java", "diffHunk": "@@ -287,6 +304,52 @@ public TradeHistoryParams createFundingHistoryParams() {\n                 });\n       }\n \n+      final String finalEmail = email;\n+\n+      if (email != null) {\n+        super.getTransfertHistory(email, startTime, endTime, page, limit)\n+            .forEach(\n+                a -> {\n+                  result.add(\n+                      new FundingRecord(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5MDMzOA==", "bodyText": "please use builder", "url": "https://github.com/knowm/XChange/pull/3463#discussion_r398390338", "createdAt": "2020-03-26T08:26:21Z", "author": {"login": "walec51"}, "path": "xchange-binance/src/main/java/org/knowm/xchange/binance/service/BinanceAccountService.java", "diffHunk": "@@ -287,6 +304,52 @@ public TradeHistoryParams createFundingHistoryParams() {\n                 });\n       }\n \n+      final String finalEmail = email;\n+\n+      if (email != null) {\n+        super.getTransfertHistory(email, startTime, endTime, page, limit)\n+            .forEach(\n+                a -> {\n+                  result.add(\n+                      new FundingRecord(\n+                          finalEmail,\n+                          null,\n+                          new Date(a.getTime()),\n+                          Currency.getInstance(a.getAsset()),\n+                          a.getQty(),\n+                          null,\n+                          null,\n+                          Type.SUBACCOUNT_OUTFLOW,\n+                          Status.COMPLETE,\n+                          null,\n+                          null,\n+                          null));\n+                });\n+      }\n+\n+      if (subAccount) {\n+\n+        Integer type = deposits && withdrawals ? null : deposits ? 1 : 0;\n+        super.getSubUserHistory(asset, type, startTime, endTime, limit)\n+            .forEach(\n+                a -> {\n+                  result.add(\n+                      new FundingRecord(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM5ODQ5MQ==", "bodyText": "I think more generic names would be better as this is to Binance-specific\nsome exchanges have a flat structure with many account for a given currency and no master\nI would suggest:\n    /**\n     * Withdrawal from the exchange a blockchain address or a bank account.\n     *\n     * Usually results in a withdrawal fee being subtracted\n     */\n    WITHDRAWAL(false),\n\n    /** Deposit from a blockchain address or a bank account to the exchange */\n    DEPOSIT(true),\n\n    /** Used for transfers between exchanges accounts */\n    INTERNAL_WITHDRAWAL(false);\n\n    /** Used for transfers between exchanges accounts */\n    INTERNAL_DEPOSIT(true),\n\n    /** Used for transfers between exchanges accounts */\n    INTERNAL_WITHDRAWAL(false);", "url": "https://github.com/knowm/XChange/pull/3463#discussion_r398398491", "createdAt": "2020-03-26T08:41:09Z", "author": {"login": "walec51"}, "path": "xchange-core/src/main/java/org/knowm/xchange/dto/account/FundingRecord.java", "diffHunk": "@@ -298,7 +298,13 @@ public String toString() {\n      * outflows defined above or their nature could not have been deduced from the exchanges\n      * response\n      */\n-    OTHER_OUTFLOW(false);\n+    OTHER_OUTFLOW(false),\n+\n+    /** Used for inflows that come from a sub account to the master account */\n+    SUBACCOUNT_INFLOW(true),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "520197da8563256e708dc1e924c4c19d1697a6b4"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c386a1dc6084af842ae06f5a561d0ce629421c0", "author": {"user": {"login": "trixprod", "name": "Sylvain"}}, "url": "https://github.com/knowm/XChange/commit/6c386a1dc6084af842ae06f5a561d0ce629421c0", "committedDate": "2020-04-01T23:05:18Z", "message": "[Binance] PR Review #3463\nAdd Sub Account transfert history"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0f0a7390ec9df7934abe7009d69ee21289ef51f", "author": {"user": {"login": "trixprod", "name": "Sylvain"}}, "url": "https://github.com/knowm/XChange/commit/e0f0a7390ec9df7934abe7009d69ee21289ef51f", "committedDate": "2020-04-02T19:02:12Z", "message": "[Binance] PR Review #3463\nFix typo on Transfer(t)\nAdd Sub Account transfert history"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2526, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}