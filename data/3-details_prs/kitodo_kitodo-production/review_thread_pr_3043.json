{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNDk4NzE1", "number": 3043, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyNToxN1rODWzaBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMjo1OTowMlrODW19Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MjM3NTA5OnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/resources/messages/errors_de.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyNToxN1rOFbxMrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyNToxN1rOFbxMrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2MTkzNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            errorMultipleConfigurations=Im Workflow sind verschiedene Konfigurationen f\ufffdr den erweiterten Strukturbaum vorhanden.\n          \n          \n            \n            errorMultipleConfigurations=Im Workflow sind verschiedene Konfigurationen f\\u00FCr den erweiterten Strukturbaum vorhanden.", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364661935", "createdAt": "2020-01-09T10:25:17Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/resources/messages/errors_de.properties", "diffHunk": "@@ -95,6 +95,7 @@ metadataMediaError=Einer Struktur sind Medien zugewiesen, die nicht deklariert s\n metadataMediaUnassigned=Die Medieneinheit ist keiner Strukur zugewiesen\\:\n errorMigrationDraft=F\\u00FCr die Migration muss der Status auf 'Aktiv' gesetzt werden.\n metadataMissingIdentifier=Fehlender Wert f\\u00FCr das Identifikationsmerkmal.\n+errorMultipleConfigurations=Im Workflow sind verschiedene Konfigurationen f\ufffdr den erweiterten Strukturbaum vorhanden.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1dd65a9aa557f54e26d212203508697c183170ce"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MjM4ODU2OnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyOTo0N1rOFbxUwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyOTo0N1rOFbxUwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2NDAwMg==", "bodyText": "This could be simplified to something like this:\nSet<Boolean> configurations = converter.validateWorkflowTaskList()\n                .stream().map(Task::isSeparateStructure).collect(Collectors.toSet());\nreturn configurations.size() > 1;", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364664002", "createdAt": "2020-01-09T10:29:47Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "diffHunk": "@@ -160,6 +165,26 @@ public String saveAndRedirect() {\n         }\n     }\n \n+    private boolean hasMultipleSructureTreeConfigurations() throws WorkflowException, IOException {\n+        Map<String, String> requestParameterMap = FacesContext.getCurrentInstance().getExternalContext()\n+                .getRequestParameterMap();\n+        String xml = requestParameterMap.get(\"editForm:workflowTabView:xmlDiagram\");\n+        xml = StringUtils.substringBefore(xml, \"kitodo-diagram-separator\");\n+        Converter converter = new Converter(new ByteArrayInputStream(xml.getBytes(StandardCharsets.UTF_8)));\n+        List<Task> tasks = converter.validateWorkflowTaskList();\n+        boolean separate = false;\n+        boolean combined = false;\n+        for (Task task : tasks) {\n+            if (task.isSeparateStructure()) {\n+                separate = true;\n+            } else {\n+                combined = true;\n+            }\n+        }\n+\n+        return separate && combined;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1dd65a9aa557f54e26d212203508697c183170ce"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MjM4OTIxOnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDozMDowMVrOFbxVLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDozMDowMVrOFbxVLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2NDEwOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private boolean hasMultipleSructureTreeConfigurations() throws WorkflowException, IOException {\n          \n          \n            \n                private boolean hasMultipleStructureTreeConfigurations() throws WorkflowException, IOException {", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364664109", "createdAt": "2020-01-09T10:30:01Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "diffHunk": "@@ -160,6 +165,26 @@ public String saveAndRedirect() {\n         }\n     }\n \n+    private boolean hasMultipleSructureTreeConfigurations() throws WorkflowException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1dd65a9aa557f54e26d212203508697c183170ce"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MjM5MDE5OnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDozMDoyMVrOFbxVyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDozMDoyMVrOFbxVyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2NDI2NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (hasMultipleSructureTreeConfigurations()) {\n          \n          \n            \n                        if (hasMultipleStructureTreeConfigurations()) {", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364664264", "createdAt": "2020-01-09T10:30:21Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "diffHunk": "@@ -140,6 +141,10 @@ public String saveAndRedirect() {\n             return this.stayOnCurrentPage;\n         }\n         try {\n+            if (hasMultipleSructureTreeConfigurations()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1dd65a9aa557f54e26d212203508697c183170ce"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1Mjc5MTgxOnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMjo1ODo1MFrOFb1Ayw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMjo1ODo1MFrOFb1Ayw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDcyNDQyNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (hasMultipleSructureTreeConfiguration()) {\n          \n          \n            \n                        if (hasMultipleStructureTreeConfigurations()) {", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364724427", "createdAt": "2020-01-09T12:58:50Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "diffHunk": "@@ -140,6 +143,10 @@ public String saveAndRedirect() {\n             return this.stayOnCurrentPage;\n         }\n         try {\n+            if (hasMultipleSructureTreeConfiguration()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bef12524ae923e9dcb26d69ce768269e1a471bd"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1Mjc5MjM5OnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMjo1OTowMlrOFb1BHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMjo1OTowMlrOFb1BHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDcyNDUxMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private boolean hasMultipleSructureTreeConfiguration() throws WorkflowException, IOException {\n          \n          \n            \n                private boolean hasMultipleStructureTreeConfigurations() throws WorkflowException, IOException {", "url": "https://github.com/kitodo/kitodo-production/pull/3043#discussion_r364724510", "createdAt": "2020-01-09T12:59:02Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/WorkflowForm.java", "diffHunk": "@@ -160,6 +167,17 @@ public String saveAndRedirect() {\n         }\n     }\n \n+    private boolean hasMultipleSructureTreeConfiguration() throws WorkflowException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bef12524ae923e9dcb26d69ce768269e1a471bd"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4100, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}