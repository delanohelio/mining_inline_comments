{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMjQ0Mzg3", "number": 4001, "title": "Add option to import metadata from FTP server", "bodyText": "Load files containing process metadata from FTP servers.\nTo use an FTP server for metadata import you have to add a corresponding catalog configuration to kitodo_opc.xml containing the following FTP specific parameters:\n\n<interfaceType>ftp</interfaceType>\n<searchFields/> empty tag since FTP server directories are just filtered by filename (empty tag required, though)\n<credentials> containing a <username> and a <password> for authentication\n\nA complete OPAC configuration for FTP servers would look something like this (replace placeholders):\n    <catalogue title=\"[Catalog name]\" description=\"[Catalog description]\">\n        <interfaceType>ftp</interfaceType>\n        <returnFormat>xml</returnFormat>\n        <metadataFormat>[Metadata format of files on FTP server]</metadataFormat>\n        <config>\n            <param name=\"host\" value=\"[FTP server host]\" />\n            <param name=\"scheme\" value=\"ftp\" />\n            <param name=\"path\" value=\"[Path on FTP server where files are stored]\" />\n        </config>\n        <searchFields/>\n        <credentials>\n            <username>[Username]</username>\n            <password>[Password]</password>\n        </credentials>\n    </catalogue>", "createdAt": "2020-09-21T12:01:19Z", "url": "https://github.com/kitodo/kitodo-production/pull/4001", "merged": true, "mergeCommit": {"oid": "f1d9722fd83072eb8bbbd9b6f2699bdf27fe3cb8"}, "closed": true, "closedAt": "2020-09-28T09:22:01Z", "author": {"login": "solth"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLCJY2AH2gAyNDkwMjQ0Mzg3OjE4YWFkMjEwNTNmZTc5YTEzODg0NjYzZmVhNGUwOGEwZTFjMzU5NWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLoLwpgH2gAyNDkwMjQ0Mzg3OjEwNzE1NTMwOWI4NWUwMzYxYjkxNTZlOTg0NDY1ZDhhMzI4NTRiNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18aad21053fe79a13884663fea4e08a0e1c3595d", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/18aad21053fe79a13884663fea4e08a0e1c3595d", "committedDate": "2020-09-21T12:00:28Z", "message": "Add option to import metadata from FTP server"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fadf15997f516c470f3a4f1add16ad48a26a04fa", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/fadf15997f516c470f3a4f1add16ad48a26a04fa", "committedDate": "2020-09-21T12:37:38Z", "message": "Fix checkstyle issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14b5b981f607d3a6c255580747b4d463c8448726", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/14b5b981f607d3a6c255580747b4d463c8448726", "committedDate": "2020-09-21T12:40:23Z", "message": "Add FTP server example configuration to 'kitodo_opac.xml'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73e11943cd6f3cb1fcd9e4f10824c6c39d34abd9", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/73e11943cd6f3cb1fcd9e4f10824c6c39d34abd9", "committedDate": "2020-09-21T12:55:30Z", "message": "Close inputStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "354aee2f627cdae7d3d69eccb8e7950924dde9db", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/354aee2f627cdae7d3d69eccb8e7950924dde9db", "committedDate": "2020-09-22T06:42:35Z", "message": "Fix Codacy issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0MzExNzc1", "url": "https://github.com/kitodo/kitodo-production/pull/4001#pullrequestreview-494311775", "createdAt": "2020-09-23T07:07:54Z", "commit": {"oid": "354aee2f627cdae7d3d69eccb8e7950924dde9db"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzowNzo1NFrOHWZULw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzowNzo1NFrOHWZULw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI0NTQ4Nw==", "bodyText": "Please use language files for \"Filename\"", "url": "https://github.com/kitodo/kitodo-production/pull/4001#discussion_r493245487", "createdAt": "2020-09-23T07:07:54Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo/src/main/java/org/kitodo/production/services/data/ImportService.java", "diffHunk": "@@ -206,15 +208,23 @@ private ExternalDataImportInterface initializeImportModule() {\n      */\n     public List<String> getAvailableSearchFields(String opac) {\n         try {\n-            HierarchicalConfiguration searchFields = OPACConfig.getSearchFields(opac);\n-            List<String> fields = new ArrayList<>();\n-            for (HierarchicalConfiguration searchField : searchFields.configurationsAt(\"searchField\")) {\n-                if (\"true\".equals(searchField.getString(\"[@hide]\"))) {\n-                    continue;\n+            // FTP server do not support query parameters but only use the filename for OPAC search!\n+            if (SearchInterfaceType.FTP.equals(OPACConfig.getInterfaceType(opac))) {\n+                return Collections.singletonList(\"Filename\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354aee2f627cdae7d3d69eccb8e7950924dde9db"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "107155309b85e0361b9156e984465d8a32854b70", "author": {"user": {"login": "solth", "name": "Arved Solth"}}, "url": "https://github.com/kitodo/kitodo-production/commit/107155309b85e0361b9156e984465d8a32854b70", "committedDate": "2020-09-23T08:19:27Z", "message": "Use language file"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2851, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}