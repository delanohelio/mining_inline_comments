{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1ODU2NDg5", "number": 3085, "title": "force page refresh after deletion and copy", "bodyText": "", "createdAt": "2020-01-22T13:33:55Z", "url": "https://github.com/kitodo/kitodo-production/pull/3085", "merged": true, "mergeCommit": {"oid": "b6fb7159160c7a6b161cf35d9c829b064fc29b95"}, "closed": true, "closedAt": "2020-01-24T08:58:30Z", "author": {"login": "Kathrin-Huber"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb810ysgH2gAyMzY1ODU2NDg5OmU0YTg0NTJkOTc3YTliZjYzNDkyOGFlN2FhZTdjNDk5ZTY2ZjEwZGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9I4PngFqTM0NzIzNTk1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/e4a8452d977a9bf634928ae7aae7c499e66f10dc", "committedDate": "2020-01-22T13:33:01Z", "message": "force page refresh after deletion and copy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2Njk5Mzkx", "url": "https://github.com/kitodo/kitodo-production/pull/3085#pullrequestreview-346699391", "createdAt": "2020-01-22T15:56:15Z", "commit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxNTo1NjoxNlrOFghY7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxNTo1OTo0N1rOFghh9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NTgwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import javax.faces.context.ExternalContext;\n          \n          \n            \n            \n          \n          \n            \n            import javax.faces.context.ExternalContext;", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369645807", "createdAt": "2020-01-22T15:56:16Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/createprocess/ProcessDetail.java", "diffHunk": "@@ -11,18 +11,24 @@\n \n package org.kitodo.production.forms.createprocess;\n \n+import java.io.IOException;\n import java.io.Serializable;\n import java.lang.reflect.Method;\n import java.util.Collection;\n import java.util.EnumMap;\n+import javax.faces.context.ExternalContext;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NjE0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import org.jboss.weld.context.RequestContext;", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369646145", "createdAt": "2020-01-22T15:56:44Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/createprocess/ProcessDetail.java", "diffHunk": "@@ -11,18 +11,24 @@\n \n package org.kitodo.production.forms.createprocess;\n \n+import java.io.IOException;\n import java.io.Serializable;\n import java.lang.reflect.Method;\n import java.util.Collection;\n import java.util.EnumMap;\n+import javax.faces.context.ExternalContext;\n+import javax.faces.context.FacesContext;\n+import javax.servlet.http.HttpServletRequest;\n \n import org.apache.commons.lang3.tuple.Pair;\n+import org.jboss.weld.context.RequestContext;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NjI2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import org.primefaces.PrimeFaces;", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369646265", "createdAt": "2020-01-22T15:56:55Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/createprocess/ProcessDetail.java", "diffHunk": "@@ -11,18 +11,24 @@\n \n package org.kitodo.production.forms.createprocess;\n \n+import java.io.IOException;\n import java.io.Serializable;\n import java.lang.reflect.Method;\n import java.util.Collection;\n import java.util.EnumMap;\n+import javax.faces.context.ExternalContext;\n+import javax.faces.context.FacesContext;\n+import javax.servlet.http.HttpServletRequest;\n \n import org.apache.commons.lang3.tuple.Pair;\n+import org.jboss.weld.context.RequestContext;\n import org.kitodo.api.MdSec;\n import org.kitodo.api.Metadata;\n import org.kitodo.api.dataeditor.rulesetmanagement.Domain;\n import org.kitodo.api.dataformat.IncludedStructuralElement;\n import org.kitodo.exceptions.InvalidMetadataValueException;\n import org.kitodo.exceptions.NoSuchMetadataFieldException;\n+import org.primefaces.PrimeFaces;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NjgwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();\n          \n          \n            \n                    ExternalContext externalContext = FacesContext.getCurrentInstance().getExternalContext();", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369646808", "createdAt": "2020-01-22T15:57:46Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/createprocess/ProcessDetail.java", "diffHunk": "@@ -63,15 +69,22 @@\n     /**\n      * This method is triggered when the user clicks the copy metadata button.\n      */\n-    public void copy() {\n+    public void copy() throws IOException {\n         container.copy(this);\n+        refreshPage();\n     }\n \n     /**\n      * This method is triggered when the user clicks the delete metadata button.\n      */\n-    public void delete() {\n+    public void delete() throws IOException {\n         container.remove(this);\n+        refreshPage();\n+    }\n+\n+    private void refreshPage() throws IOException {\n+        ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NzA4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ec.redirect(((HttpServletRequest) ec.getRequest()).getRequestURI());\n          \n          \n            \n                    externalContext.redirect(((HttpServletRequest) externalContext.getRequest()).getRequestURI());", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369647087", "createdAt": "2020-01-22T15:58:13Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/production/forms/createprocess/ProcessDetail.java", "diffHunk": "@@ -63,15 +69,22 @@\n     /**\n      * This method is triggered when the user clicks the copy metadata button.\n      */\n-    public void copy() {\n+    public void copy() throws IOException {\n         container.copy(this);\n+        refreshPage();\n     }\n \n     /**\n      * This method is triggered when the user clicks the delete metadata button.\n      */\n-    public void delete() {\n+    public void delete() throws IOException {\n         container.remove(this);\n+        refreshPage();\n+    }\n+\n+    private void refreshPage() throws IOException {\n+        ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();\n+        ec.redirect(((HttpServletRequest) ec.getRequest()).getRequestURI());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0ODExNw==", "bodyText": "Is it correct that this is removed here but still used in metadataTreeTable.xhtml?", "url": "https://github.com/kitodo/kitodo-production/pull/3085#discussion_r369648117", "createdAt": "2020-01-22T15:59:47Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/webapp/WEB-INF/templates/includes/metadataEditor/logicalMetadata.xhtml", "diffHunk": "@@ -27,7 +27,6 @@\n                 <ui:param name=\"root\" value=\"#{DataEditorForm.metadataPanel.logicalMetadataRows}\" />\n                 <ui:param name=\"buttonUpdate\" value=\"metadataAccordion:metadata:metadataTable\" />\n                 <ui:param name=\"readOnly\" value=\"#{readOnly}\" />\n-                <ui:param name=\"buttonUpdate\" value=\"metadataAccordion:metadata:metadataTable\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4a8452d977a9bf634928ae7aae7c499e66f10dc"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f8de335117402b7d7b0fd5052e1524bf61f2294", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/8f8de335117402b7d7b0fd5052e1524bf61f2294", "committedDate": "2020-01-23T09:38:36Z", "message": "add nullcheck"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5ce7d14ae192a951eca298c407d158a76a74b0cf", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/5ce7d14ae192a951eca298c407d158a76a74b0cf", "committedDate": "2020-01-23T09:23:53Z", "message": "add nullcheck"}, "afterCommit": {"oid": "8f8de335117402b7d7b0fd5052e1524bf61f2294", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/8f8de335117402b7d7b0fd5052e1524bf61f2294", "committedDate": "2020-01-23T09:38:36Z", "message": "add nullcheck"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MjM1OTUz", "url": "https://github.com/kitodo/kitodo-production/pull/3085#pullrequestreview-347235953", "createdAt": "2020-01-23T11:44:59Z", "commit": {"oid": "8f8de335117402b7d7b0fd5052e1524bf61f2294"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2722, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}