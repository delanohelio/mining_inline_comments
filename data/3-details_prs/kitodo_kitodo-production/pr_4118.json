{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTg1ODI3", "number": 4118, "title": "enable configuration of delimiter", "bodyText": "fixes #3989\nEnables a configuration in kitodoOpac, if searchquerys should be delimited by a specific character.", "createdAt": "2020-12-03T18:23:34Z", "url": "https://github.com/kitodo/kitodo-production/pull/4118", "merged": true, "mergeCommit": {"oid": "cb815735437042f1f30d2930645ea02de696a012"}, "closed": true, "closedAt": "2021-01-05T08:07:10Z", "author": {"login": "Kathrin-Huber"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiz5EOgFqTU0NDc2NTcwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnVvQJABqjQxMjkxOTcyNTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NzY1NzAx", "url": "https://github.com/kitodo/kitodo-production/pull/4118#pullrequestreview-544765701", "createdAt": "2020-12-04T08:58:09Z", "commit": {"oid": "c8096c28cc0d279bdbc730f9abddbdcab74755e2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b26f10200a5ae3184b0d2b973638cd4c353e8ee", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/5b26f10200a5ae3184b0d2b973638cd4c353e8ee", "committedDate": "2020-12-08T08:30:55Z", "message": "add sampleConfiguration"}, "afterCommit": {"oid": "dcf0c6a6f5ee64c26e1a61a27294f2902fcd7f87", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/dcf0c6a6f5ee64c26e1a61a27294f2902fcd7f87", "committedDate": "2020-12-08T10:06:43Z", "message": "add sampleConfiguration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMjI0NzI4", "url": "https://github.com/kitodo/kitodo-production/pull/4118#pullrequestreview-552224728", "createdAt": "2020-12-15T08:50:42Z", "commit": {"oid": "e69b95b9a211b4eb358a21dd5697964aa6aeb9dc"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwODo1MDo0MlrOIF_lcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwODo1NTo0NVrOIF_y6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzE1NTU2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return configration for catalog's \"queryDelimiter\"\n          \n          \n            \n                 * @return configuration for catalog's \"queryDelimiter\"", "url": "https://github.com/kitodo/kitodo-production/pull/4118#discussion_r543155569", "createdAt": "2020-12-15T08:50:42Z", "author": {"login": "solth"}, "path": "Kitodo-API/src/main/java/org/kitodo/config/OPACConfig.java", "diffHunk": "@@ -113,6 +113,15 @@ public static HierarchicalConfiguration getUrlParameters(String catalogName) {\n                 .map(c -> c.getRoot().getValue().toString()).collect(Collectors.toList());\n     }\n \n+    /**\n+     * Retrieve the \"queryDelimiter\" of the catalog identified by its title.\n+     * @param catalogName String identifying the catalog by its title\n+     * @return configration for catalog's \"queryDelimiter\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69b95b9a211b4eb358a21dd5697964aa6aeb9dc"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzE1ODkzMw==", "bodyText": "Could this method be moved to ImportService and be called inside performSearch there instead? ImportService already imports OPACConfig and I think it would be cleaner if the LazyHitModel itself wouldnt need to manipulate any of the search parameters passed by the user but instead would let the ImportService` handle all that (which is already the case with all other catalog specific settings).", "url": "https://github.com/kitodo/kitodo-production/pull/4118#discussion_r543158933", "createdAt": "2020-12-15T08:55:37Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/model/LazyHitModel.java", "diffHunk": "@@ -54,14 +55,28 @@ public int getRowCount() {\n     public List<Object> load(int first, int resultSize, String sortField, SortOrder sortOrder, Map filters) {\n \n         searchResult = ServiceManager.getImportService().performSearch(\n-                this.selectedField, this.searchTerm, this.selectedCatalog, first, resultSize);\n+                this.selectedField, getSearchTermWithDelimiter(this.searchTerm), this.selectedCatalog, first, resultSize);\n \n         if (Objects.isNull(searchResult) || Objects.isNull(searchResult.getHits())) {\n             return Collections.emptyList();\n         }\n         return searchResult.getHits().stream().map(r -> (Object)r).collect(Collectors.toList());\n     }\n \n+    /**\n+     * Returns the searchTerm with configured Delimiter.\n+     * @param searchTerm the searchterm to add delimiters.\n+     * @return searchTermWithDelimiter\n+     */\n+    public String getSearchTermWithDelimiter(String searchTerm) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69b95b9a211b4eb358a21dd5697964aa6aeb9dc"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzE1OTAxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param searchTerm the searchterm to add delimiters.\n          \n          \n            \n                 * @param searchTerm the search term to add delimiters.", "url": "https://github.com/kitodo/kitodo-production/pull/4118#discussion_r543159017", "createdAt": "2020-12-15T08:55:45Z", "author": {"login": "solth"}, "path": "Kitodo/src/main/java/org/kitodo/production/model/LazyHitModel.java", "diffHunk": "@@ -54,14 +55,28 @@ public int getRowCount() {\n     public List<Object> load(int first, int resultSize, String sortField, SortOrder sortOrder, Map filters) {\n \n         searchResult = ServiceManager.getImportService().performSearch(\n-                this.selectedField, this.searchTerm, this.selectedCatalog, first, resultSize);\n+                this.selectedField, getSearchTermWithDelimiter(this.searchTerm), this.selectedCatalog, first, resultSize);\n \n         if (Objects.isNull(searchResult) || Objects.isNull(searchResult.getHits())) {\n             return Collections.emptyList();\n         }\n         return searchResult.getHits().stream().map(r -> (Object)r).collect(Collectors.toList());\n     }\n \n+    /**\n+     * Returns the searchTerm with configured Delimiter.\n+     * @param searchTerm the searchterm to add delimiters.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69b95b9a211b4eb358a21dd5697964aa6aeb9dc"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e69b95b9a211b4eb358a21dd5697964aa6aeb9dc", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/e69b95b9a211b4eb358a21dd5697964aa6aeb9dc", "committedDate": "2020-12-11T13:07:13Z", "message": "Merge branch 'master' into fix_adisImport"}, "afterCommit": {"oid": "d686f7d225a08ffaae79eb6eaf2374cfd3786566", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/d686f7d225a08ffaae79eb6eaf2374cfd3786566", "committedDate": "2020-12-15T16:52:31Z", "message": "add review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfb41e62247b2ebf3b0eae1592350f016320ce91", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/bfb41e62247b2ebf3b0eae1592350f016320ce91", "committedDate": "2020-12-15T16:53:24Z", "message": "enable configuration of delimiter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3aa92786aaee5fafa7dac887e679df46d88f91a", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/f3aa92786aaee5fafa7dac887e679df46d88f91a", "committedDate": "2020-12-15T16:53:24Z", "message": "add delimiter to recordQuery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "355c092762201d5c73b38ffc2f96a16431f9b66a", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/355c092762201d5c73b38ffc2f96a16431f9b66a", "committedDate": "2020-12-15T16:53:24Z", "message": "add delimiter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f662608b514f3189ae0572f7155fd478fc7b62f6", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/f662608b514f3189ae0572f7155fd478fc7b62f6", "committedDate": "2020-12-15T16:54:19Z", "message": "add sampleConfiguration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fd05443e75465482f17c67052e787dd118e57d7", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/0fd05443e75465482f17c67052e787dd118e57d7", "committedDate": "2020-12-15T16:54:19Z", "message": "add delimiters to parent search"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d686f7d225a08ffaae79eb6eaf2374cfd3786566", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/d686f7d225a08ffaae79eb6eaf2374cfd3786566", "committedDate": "2020-12-15T16:52:31Z", "message": "add review"}, "afterCommit": {"oid": "11ef01441c76afca3cda63fe0cd8ceaab31668b5", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/11ef01441c76afca3cda63fe0cd8ceaab31668b5", "committedDate": "2020-12-15T16:54:20Z", "message": "add review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11ef01441c76afca3cda63fe0cd8ceaab31668b5", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/11ef01441c76afca3cda63fe0cd8ceaab31668b5", "committedDate": "2020-12-15T16:54:20Z", "message": "add review"}, "afterCommit": {"oid": "14bc2cdd4b771ef00c893f3a2e6b79f27d43b0c2", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/14bc2cdd4b771ef00c893f3a2e6b79f27d43b0c2", "committedDate": "2020-12-15T17:06:05Z", "message": "add review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "764fe500488602e1534669e66ad820fe89655f22", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/764fe500488602e1534669e66ad820fe89655f22", "committedDate": "2020-12-15T17:18:25Z", "message": "add review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14bc2cdd4b771ef00c893f3a2e6b79f27d43b0c2", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/14bc2cdd4b771ef00c893f3a2e6b79f27d43b0c2", "committedDate": "2020-12-15T17:06:05Z", "message": "add review"}, "afterCommit": {"oid": "764fe500488602e1534669e66ad820fe89655f22", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/764fe500488602e1534669e66ad820fe89655f22", "committedDate": "2020-12-15T17:18:25Z", "message": "add review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "692367b399b4ee5941eedd0840d9ffb5a52cd877", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/692367b399b4ee5941eedd0840d9ffb5a52cd877", "committedDate": "2020-12-18T10:36:28Z", "message": "move delimiter adding to importService"}, "afterCommit": {"oid": "b0512db69b7c4b1587b86efcbe93368a3ea7a077", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/b0512db69b7c4b1587b86efcbe93368a3ea7a077", "committedDate": "2020-12-18T10:38:23Z", "message": "move delimiter adding to importService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56585ea556e6acfa50529faeb29a843e473f9eef", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/56585ea556e6acfa50529faeb29a843e473f9eef", "committedDate": "2020-12-18T10:39:27Z", "message": "move delimiter adding to importService"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b0512db69b7c4b1587b86efcbe93368a3ea7a077", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/b0512db69b7c4b1587b86efcbe93368a3ea7a077", "committedDate": "2020-12-18T10:38:23Z", "message": "move delimiter adding to importService"}, "afterCommit": {"oid": "56585ea556e6acfa50529faeb29a843e473f9eef", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/56585ea556e6acfa50529faeb29a843e473f9eef", "committedDate": "2020-12-18T10:39:27Z", "message": "move delimiter adding to importService"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2804, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}