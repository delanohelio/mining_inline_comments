{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MjE4NDQ5", "number": 3935, "title": "Fix several folder issues", "bodyText": "Fixes #3187, fixes #3340, fixes #3731, fixes #3775", "createdAt": "2020-08-13T08:01:50Z", "url": "https://github.com/kitodo/kitodo-production/pull/3935", "merged": true, "mergeCommit": {"oid": "d135a4e378c95e8352bf76a7dfbd5f4ae488a025"}, "closed": true, "closedAt": "2020-08-18T08:40:47Z", "author": {"login": "matthias-ronge"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-bUo5AH2gAyNDY3MjE4NDQ5OmQ2ZjFiZTgxYWE3ZTUxYzM2MGU3MjdhYjJlYTg2NjAzMGZkMzQzZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc_x23LgH2gAyNDY3MjE4NDQ5OjVmOWQ2ZjQ0OWFjZDljODIxOWZlODY0ZDcxMmNhYzE4ZGIyMGM1NjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d6f1be81aa7e51c360e727ab2ea866030fd343ef", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/d6f1be81aa7e51c360e727ab2ea866030fd343ef", "committedDate": "2020-08-13T07:59:22Z", "message": "Implement hashCode() and equals() based on the business key\n\nSee https://docs.jboss.org/hibernate/stable/core.old/reference/en/html/persistent-classes-equalshashcode.html"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff0d3e020e19e010924da9e6bc68a024f1ab6a05", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/ff0d3e020e19e010924da9e6bc68a024f1ab6a05", "committedDate": "2020-08-13T07:59:24Z", "message": "Prevent changing the file group once entered"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0762c4d7fcec10a8741325d1f8bedebf60537b8", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/b0762c4d7fcec10a8741325d1f8bedebf60537b8", "committedDate": "2020-08-13T07:59:26Z", "message": "Prevent a new folder entry from being duplicated\n\nFixes #3187, #3731, #3775"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "905a4907a93db1ab83f00a03a7bdc093943a46cd", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/905a4907a93db1ab83f00a03a7bdc093943a46cd", "committedDate": "2020-08-13T07:59:28Z", "message": "Address the folders via their file group\n\nFixes #3340"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NTg0Mjk3", "url": "https://github.com/kitodo/kitodo-production/pull/3935#pullrequestreview-466584297", "createdAt": "2020-08-13T09:13:36Z", "commit": {"oid": "905a4907a93db1ab83f00a03a7bdc093943a46cd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOToxMzozNlrOHADDQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOToxMzozNlrOHADDQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgxMjAzNQ==", "bodyText": "You are throwing an Exception to the frontend, this will lead to the error page. Please handle the \"else\" different. Maybe just don't set the fileGroup for now.", "url": "https://github.com/kitodo/kitodo-production/pull/3935#discussion_r469812035", "createdAt": "2020-08-13T09:13:36Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo-DataManagement/src/main/java/org/kitodo/data/database/beans/Folder.java", "diffHunk": "@@ -388,13 +391,21 @@ public void setDpi(Integer dpi) {\n     }\n \n     /**\n-     * Sets the file group of the folder.\n+     * Sets the file group of the folder. The file group is the business key of\n+     * the folder and may therefore only be set if the object is not yet\n+     * persisted ({@code id} is null) or the object is being created\n+     * ({@code fileGroup} is null).\n      *\n      * @param fileGroup\n      *            file group to set\n      */\n     public void setFileGroup(String fileGroup) {\n-        this.fileGroup = fileGroup;\n+        if (fileGroup.equals(this.fileGroup) || Objects.isNull(this.fileGroup) || Objects.isNull(id)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "905a4907a93db1ab83f00a03a7bdc093943a46cd"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f9d6f449acd9c8219fe864d712cac18db20c565", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/5f9d6f449acd9c8219fe864d712cac18db20c565", "committedDate": "2020-08-17T12:48:35Z", "message": "Remove business key invariance check"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2841, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}