{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0NDg3MTY5", "number": 3912, "title": "respect subdivisionsByDate for withWorkflow", "bodyText": "fixes #3847", "createdAt": "2020-08-07T09:04:21Z", "url": "https://github.com/kitodo/kitodo-production/pull/3912", "merged": true, "mergeCommit": {"oid": "d2ee0a744bd04b3020eae6a4f2128e1dce395ac3"}, "closed": true, "closedAt": "2020-08-17T07:36:22Z", "author": {"login": "Kathrin-Huber"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8go4MgH2gAyNDY0NDg3MTY5OjM5MGIyM2M0OTAyNTA2ZmVlOTFlMjk5MjRjNjRiNDgwMWYwMDNjZDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-LPAaAFqTQ2NTkwMzQwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/390b23c4902506fee91e29924c64b4801f003cd9", "committedDate": "2020-08-07T09:03:09Z", "message": "respect subdivisionsByDate for withWorkflow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1ODA3MTc4", "url": "https://github.com/kitodo/kitodo-production/pull/3912#pullrequestreview-465807178", "createdAt": "2020-08-12T11:01:39Z", "commit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMTowMTozOVrOG_cWDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMTowNDozOVrOG_cbOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3Nzg3MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    List<Division> divisions = universalDivisions.stream().map(universalDivision -> universalDivision.getDivision())\n          \n          \n            \n                    List<Division> divisions = universalDivisions.stream().map(UniversalDivision::getDivision)", "url": "https://github.com/kitodo/kitodo-production/pull/3912#discussion_r469177870", "createdAt": "2020-08-12T11:01:39Z", "author": {"login": "solth"}, "path": "Kitodo-DataEditor/src/main/java/org/kitodo/dataeditor/ruleset/RulesetManagement.java", "diffHunk": "@@ -81,7 +82,10 @@\n \n     @Override\n     public Collection<String> getDivisionsWithNoWorkflow() {\n-        return getDivionsWithNoWorkflow(ruleset.getDivisions());\n+        Collection<UniversalDivision> universalDivisions = ruleset.getUniversalDivisions(true, true);\n+        List<Division> divisions = universalDivisions.stream().map(universalDivision -> universalDivision.getDivision())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3ODcwMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Map<String, String> map = all || !universalDivisions.isEmpty() ? Labeled.listByTranslatedLabel(this,\n          \n          \n            \n                        universalDivisions, UniversalDivision::getId, UniversalDivision::getLabels, priorityList)\n          \n          \n            \n                            : getDivisions(priorityList, true, subdivisionsByDate);\n          \n          \n            \n                    return map;\n          \n          \n            \n                    return all || !universalDivisions.isEmpty() ? Labeled.listByTranslatedLabel(this,\n          \n          \n            \n                        universalDivisions, UniversalDivision::getId, UniversalDivision::getLabels, priorityList)\n          \n          \n            \n                            : getDivisions(priorityList, true, subdivisionsByDate);", "url": "https://github.com/kitodo/kitodo-production/pull/3912#discussion_r469178701", "createdAt": "2020-08-12T11:03:33Z", "author": {"login": "solth"}, "path": "Kitodo-DataEditor/src/main/java/org/kitodo/dataeditor/ruleset/xml/Ruleset.java", "diffHunk": "@@ -154,6 +154,20 @@ public String getDefaultLang() {\n      * @return all outline elements as map from IDs to labels\n      */\n     public Map<String, String> getDivisions(List<LanguageRange> priorityList, boolean all, boolean subdivisionsByDate) {\n+        Collection<UniversalDivision> universalDivisions = getUniversalDivisions(all, subdivisionsByDate);\n+        Map<String, String> map = all || !universalDivisions.isEmpty() ? Labeled.listByTranslatedLabel(this,\n+            universalDivisions, UniversalDivision::getId, UniversalDivision::getLabels, priorityList)\n+                : getDivisions(priorityList, true, subdivisionsByDate);\n+        return map;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3OTAyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * get all universialDivisions as Collection.\n          \n          \n            \n                 * get all universalDivisions as Collection.", "url": "https://github.com/kitodo/kitodo-production/pull/3912#discussion_r469179025", "createdAt": "2020-08-12T11:04:17Z", "author": {"login": "solth"}, "path": "Kitodo-DataEditor/src/main/java/org/kitodo/dataeditor/ruleset/xml/Ruleset.java", "diffHunk": "@@ -154,6 +154,20 @@ public String getDefaultLang() {\n      * @return all outline elements as map from IDs to labels\n      */\n     public Map<String, String> getDivisions(List<LanguageRange> priorityList, boolean all, boolean subdivisionsByDate) {\n+        Collection<UniversalDivision> universalDivisions = getUniversalDivisions(all, subdivisionsByDate);\n+        Map<String, String> map = all || !universalDivisions.isEmpty() ? Labeled.listByTranslatedLabel(this,\n+            universalDivisions, UniversalDivision::getId, UniversalDivision::getLabels, priorityList)\n+                : getDivisions(priorityList, true, subdivisionsByDate);\n+        return map;\n+    }\n+\n+    /**\n+     * get all universialDivisions as Collection.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3OTE5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return a collection of universialDivisions.\n          \n          \n            \n                 * @return a collection of universalDivisions.", "url": "https://github.com/kitodo/kitodo-production/pull/3912#discussion_r469179193", "createdAt": "2020-08-12T11:04:39Z", "author": {"login": "solth"}, "path": "Kitodo-DataEditor/src/main/java/org/kitodo/dataeditor/ruleset/xml/Ruleset.java", "diffHunk": "@@ -154,6 +154,20 @@ public String getDefaultLang() {\n      * @return all outline elements as map from IDs to labels\n      */\n     public Map<String, String> getDivisions(List<LanguageRange> priorityList, boolean all, boolean subdivisionsByDate) {\n+        Collection<UniversalDivision> universalDivisions = getUniversalDivisions(all, subdivisionsByDate);\n+        Map<String, String> map = all || !universalDivisions.isEmpty() ? Labeled.listByTranslatedLabel(this,\n+            universalDivisions, UniversalDivision::getId, UniversalDivision::getLabels, priorityList)\n+                : getDivisions(priorityList, true, subdivisionsByDate);\n+        return map;\n+    }\n+\n+    /**\n+     * get all universialDivisions as Collection.\n+     * @param all if all divisions should be respected.\n+     * @param subdivisionsByDate if subdivisionsByDate should be respected.\n+     * @return a collection of universialDivisions.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "390b23c4902506fee91e29924c64b4801f003cd9"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a6072d4d82e4c084e55e4664d5e70605bbe8619", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/3a6072d4d82e4c084e55e4664d5e70605bbe8619", "committedDate": "2020-08-12T12:57:31Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Arved Solth <solth@effective-webwork.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1OTAzNDAy", "url": "https://github.com/kitodo/kitodo-production/pull/3912#pullrequestreview-465903402", "createdAt": "2020-08-12T13:14:44Z", "commit": {"oid": "3a6072d4d82e4c084e55e4664d5e70605bbe8619"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2824, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}