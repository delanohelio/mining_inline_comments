{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0NTMyODQz", "number": 3914, "title": "Use Kitodo - Command to create process root directory", "bodyText": "Fixes #3196", "createdAt": "2020-08-07T10:42:02Z", "url": "https://github.com/kitodo/kitodo-production/pull/3914", "merged": true, "mergeCommit": {"oid": "7dca4a2207d92219d40bf6ea4a1ba29eca67e814"}, "closed": true, "closedAt": "2020-08-20T19:27:45Z", "author": {"login": "matthias-ronge"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8iB7agH2gAyNDY0NTMyODQzOmNiZTFmYzg1YWI3M2U2OWJjNWMxM2YwY2EzZTUwMDIzYmI1ZjcxZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAxZshgH2gAyNDY0NTMyODQzOjNmYmRmZDE4ZDAxN2QxMmIzMmFjMDM4NDhkNDllM2M0OTY2MmQ0Y2Q=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbe1fc85ab73e69bc5c13f0ca3e50023bb5f71d3", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/cbe1fc85ab73e69bc5c13f0ca3e50023bb5f71d3", "committedDate": "2020-08-07T10:40:25Z", "message": "Use Kitodo - Command to create process root directory\n\nFixes #3196"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bd4bf559e67fdad57892c1dea7aa624347bf4f8", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/5bd4bf559e67fdad57892c1dea7aa624347bf4f8", "committedDate": "2020-08-10T09:13:42Z", "message": "Add & configure script_createDirMeta"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9d43c4693931ce1ccae3e7f3705cb6f26fecd73", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/a9d43c4693931ce1ccae3e7f3705cb6f26fecd73", "committedDate": "2020-08-10T09:25:36Z", "message": "Set / remove execution permission"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6865b82c2014aadc501967b770a6b0138afe1ae2", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/6865b82c2014aadc501967b770a6b0138afe1ae2", "committedDate": "2020-08-10T09:50:05Z", "message": "Add & configure script_createDirMeta in Kitodo - Data Editor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/e91795e15ba32dad26790324ae0198e73071e57d", "committedDate": "2020-08-10T11:21:58Z", "message": "Add Javadoc for Codacy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MjM0Mzkz", "url": "https://github.com/kitodo/kitodo-production/pull/3914#pullrequestreview-468234393", "createdAt": "2020-08-17T07:39:50Z", "commit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNzozOTo1MFrOHBds_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwNzozOTo1MFrOHBds_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI5NzI3Ng==", "bodyText": "I think it's only needed in Kitodo-FileManagement where you also added it, istn't it?", "url": "https://github.com/kitodo/kitodo-production/pull/3914#discussion_r471297276", "createdAt": "2020-08-17T07:39:50Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo-DataEditor/src/test/resources/kitodo_config.properties", "diffHunk": "@@ -13,3 +13,4 @@ MetsEditorDefaultPagination=uncounted\n directory.modules=../Kitodo/modules/\n xsltFilenameMetadataTransformation=MetsModsGoobi_to_MetsKitodo.xsl\n directory.metadata=../../../../src/test/resources/metadata/\n+script_createDirMeta=src/test/resources/scripts/script_createDirMeta.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxMzgyNDU5", "url": "https://github.com/kitodo/kitodo-production/pull/3914#pullrequestreview-471382459", "createdAt": "2020-08-20T08:38:35Z", "commit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwODozODozNVrOHD0hHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwODozOTowMFrOHD0iXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc2ODIyMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String command = scriptCreateDirMeta + ' ' + processRootDirectory.getPath();\n          \n          \n            \n                    if (!processRootDirectory.exists() && !commandService.runCommand(command.hashCode(), command).isSuccessful()) {\n          \n          \n            \n                    String scriptCreateDirMeta = KitodoConfig.getParameter(\"script_createDirMeta\");\n          \n          \n            \n                    String command = scriptCreateDirMeta + ' ' + processRootDirectory.getPath();\n          \n          \n            \n                    if (!processRootDirectory.exists() && !commandService.runCommand(command.hashCode(), command).isSuccessful()) {", "url": "https://github.com/kitodo/kitodo-production/pull/3914#discussion_r473768221", "createdAt": "2020-08-20T08:38:35Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo-FileManagement/src/main/java/org/kitodo/filemanagement/FileManagement.java", "diffHunk": "@@ -365,7 +371,8 @@ public String getFileNameWithExtension(URI uri) {\n     @Override\n     public URI createProcessLocation(String processId) throws IOException {\n         File processRootDirectory = new File(KitodoConfig.getKitodoDataDirectory() + File.separator + processId);\n-        if (!processRootDirectory.exists() && !processRootDirectory.mkdir()) {\n+        String command = scriptCreateDirMeta + ' ' + processRootDirectory.getPath();\n+        if (!processRootDirectory.exists() && !commandService.runCommand(command.hashCode(), command).isSuccessful()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc2ODU0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final String scriptCreateDirMeta = KitodoConfig.getParameter(\"script_createDirMeta\");", "url": "https://github.com/kitodo/kitodo-production/pull/3914#discussion_r473768541", "createdAt": "2020-08-20T08:39:00Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo-FileManagement/src/main/java/org/kitodo/filemanagement/FileManagement.java", "diffHunk": "@@ -45,6 +47,10 @@\n \n     private static final String IMAGES_DIRECTORY_NAME = \"images\";\n \n+    private final CommandInterface commandService = new KitodoServiceLoader<CommandInterface>(CommandInterface.class)\n+            .loadModule();\n+    private final String scriptCreateDirMeta = KitodoConfig.getParameter(\"script_createDirMeta\");\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e91795e15ba32dad26790324ae0198e73071e57d"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9275bb3cf32c50ad70491119b0fe2450a14c0ec", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/a9275bb3cf32c50ad70491119b0fe2450a14c0ec", "committedDate": "2020-08-20T14:46:59Z", "message": "Update Kitodo-FileManagement/src/main/java/org/kitodo/filemanagement/FileManagement.java\n\nCo-authored-by: Kathrin Huber <kathrin.huber@slub-dresden.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ade76ac1879d629533ff0b4f2771a103f048430", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/3ade76ac1879d629533ff0b4f2771a103f048430", "committedDate": "2020-08-20T14:47:06Z", "message": "Update Kitodo-FileManagement/src/main/java/org/kitodo/filemanagement/FileManagement.java\n\nCo-authored-by: Kathrin Huber <kathrin.huber@slub-dresden.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fbdfd18d017d12b32ac03848d49e3c49662d4cd", "author": {"user": null}, "url": "https://github.com/kitodo/kitodo-production/commit/3fbdfd18d017d12b32ac03848d49e3c49662d4cd", "committedDate": "2020-08-20T14:50:39Z", "message": "Revert \"Add & configure script_createDirMeta in Kitodo - Data Editor\"\n\nThis reverts commit 6865b82c2014aadc501967b770a6b0138afe1ae2."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2828, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}