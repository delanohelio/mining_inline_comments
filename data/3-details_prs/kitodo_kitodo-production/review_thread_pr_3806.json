{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MTAwNTAy", "number": 3806, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzozNVrOEMZl_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzo0OFrOEMZmRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNDM3NjkyOnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/services/data/ProcessService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzozNVrOGufDQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzozNVrOGufDQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5NjQxOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public String getLastUserProcessingStart(ProcessDTO processDTO) {\n          \n          \n            \n                public String getLastProcessingStart(ProcessDTO processDTO) {", "url": "https://github.com/kitodo/kitodo-production/pull/3806#discussion_r451396418", "createdAt": "2020-07-08T09:07:35Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo/src/main/java/org/kitodo/production/services/data/ProcessService.java", "diffHunk": "@@ -2505,4 +2510,64 @@ private String createCommentTooltip(List<Comment> comments) {\n                         + \" (\" + Helper.getTranslation(\"fixed\") + \": \" + c.isCorrected() + \")\")\n                 .collect(Collectors.joining(NEW_LINE_ENTITY));\n     }\n+\n+    private TaskDTO getLastProcessedTask(ProcessDTO processDTO) {\n+        List<TaskDTO> tasks = getTasksInWork(processDTO);\n+        if (tasks.isEmpty()) {\n+            tasks = getCompletedTasks(processDTO);\n+        }\n+        tasks = tasks.stream().filter(t -> Objects.nonNull(t.getProcessingUser())).collect(Collectors.toList());\n+        if (tasks.isEmpty()) {\n+            return null;\n+        } else {\n+            tasks.sort(Comparator.comparing(TaskDTO::getProcessingBegin));\n+            return tasks.get(0);\n+        }\n+    }\n+\n+    /**\n+     * Return UserName of user that handled the last task of the given process (either the newest task INWORK or the\n+     * newest DONE task, if no task is INWORK). Return an empty String if no task is INWORK or DONE.\n+     *\n+     * @param processDTO Process\n+     * @return name of processing user\n+     */\n+    public String getUserHandlingLastTask(ProcessDTO processDTO) {\n+        TaskDTO lastTask = getLastProcessedTask(processDTO);\n+        if (Objects.isNull(lastTask)) {\n+            return \"\";\n+        } else {\n+            return lastTask.getProcessingUser().getFullName();\n+        }\n+    }\n+\n+    /**\n+     * Return processing begin of last processed task of given process.\n+     *\n+     * @param processDTO Process\n+     * @return processing begin of last processed task\n+     */\n+    public String getLastUserProcessingStart(ProcessDTO processDTO) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d6fb218ffa53d903089abd29a068b2b5859e5"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNDM3NzY1OnYy", "diffSide": "RIGHT", "path": "Kitodo/src/main/java/org/kitodo/production/services/data/ProcessService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzo0OFrOGufDuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwOTowNzo0OFrOGufDuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM5NjUzNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public String getLastUserProcessingEnd(ProcessDTO processDTO) {\n          \n          \n            \n                public String getLastProcessingEnd(ProcessDTO processDTO) {", "url": "https://github.com/kitodo/kitodo-production/pull/3806#discussion_r451396536", "createdAt": "2020-07-08T09:07:48Z", "author": {"login": "Kathrin-Huber"}, "path": "Kitodo/src/main/java/org/kitodo/production/services/data/ProcessService.java", "diffHunk": "@@ -2505,4 +2510,64 @@ private String createCommentTooltip(List<Comment> comments) {\n                         + \" (\" + Helper.getTranslation(\"fixed\") + \": \" + c.isCorrected() + \")\")\n                 .collect(Collectors.joining(NEW_LINE_ENTITY));\n     }\n+\n+    private TaskDTO getLastProcessedTask(ProcessDTO processDTO) {\n+        List<TaskDTO> tasks = getTasksInWork(processDTO);\n+        if (tasks.isEmpty()) {\n+            tasks = getCompletedTasks(processDTO);\n+        }\n+        tasks = tasks.stream().filter(t -> Objects.nonNull(t.getProcessingUser())).collect(Collectors.toList());\n+        if (tasks.isEmpty()) {\n+            return null;\n+        } else {\n+            tasks.sort(Comparator.comparing(TaskDTO::getProcessingBegin));\n+            return tasks.get(0);\n+        }\n+    }\n+\n+    /**\n+     * Return UserName of user that handled the last task of the given process (either the newest task INWORK or the\n+     * newest DONE task, if no task is INWORK). Return an empty String if no task is INWORK or DONE.\n+     *\n+     * @param processDTO Process\n+     * @return name of processing user\n+     */\n+    public String getUserHandlingLastTask(ProcessDTO processDTO) {\n+        TaskDTO lastTask = getLastProcessedTask(processDTO);\n+        if (Objects.isNull(lastTask)) {\n+            return \"\";\n+        } else {\n+            return lastTask.getProcessingUser().getFullName();\n+        }\n+    }\n+\n+    /**\n+     * Return processing begin of last processed task of given process.\n+     *\n+     * @param processDTO Process\n+     * @return processing begin of last processed task\n+     */\n+    public String getLastUserProcessingStart(ProcessDTO processDTO) {\n+        TaskDTO lastTask = getLastProcessedTask(processDTO);\n+        if (Objects.isNull(lastTask)) {\n+            return \"\";\n+        } else {\n+            return lastTask.getProcessingBegin();\n+        }\n+    }\n+\n+    /**\n+     * Return processing end of last processed task of given process.\n+     *\n+     * @param processDTO Process\n+     * @return processing end of last processed task\n+     */\n+    public String getLastUserProcessingEnd(ProcessDTO processDTO) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d6fb218ffa53d903089abd29a068b2b5859e5"}, "originalPosition": 68}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3946, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}