{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MTU0Nzg3", "number": 3858, "title": "Close parent task with last child", "bodyText": "When the last child is exported, the parent process should be marked as \"done\".\ndepends on #3841", "createdAt": "2020-07-24T08:36:13Z", "url": "https://github.com/kitodo/kitodo-production/pull/3858", "merged": true, "mergeCommit": {"oid": "cb6317ddae99f79f770a3c3d3b526a5404b76917"}, "closed": true, "closedAt": "2020-08-05T11:39:55Z", "author": {"login": "Kathrin-Huber"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4AByyABqjM1ODMwOTkxMzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc75JmGgH2gAyNDU2MTU0Nzg3OjFlNzVlNmQzZWQ3ZGI4NzM0MjQyYjdjNjNlOWZjMmQyOTMzZjVhN2M=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a8386588995e06c880f2c1e5f1c49ffa3e0b5e1f", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/a8386588995e06c880f2c1e5f1c49ffa3e0b5e1f", "committedDate": "2020-07-24T08:06:39Z", "message": "set parent process to closed, when childs are exported"}, "afterCommit": {"oid": "8d49c79a9766a55b0f656f57d1d705fe8f571403", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/8d49c79a9766a55b0f656f57d1d705fe8f571403", "committedDate": "2020-07-24T08:47:29Z", "message": "set parent process to closed, when childs are exported"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a2f8e6733c2152fc49a9330c7917c4c121fa517d", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/a2f8e6733c2152fc49a9330c7917c4c121fa517d", "committedDate": "2020-07-24T10:00:18Z", "message": "fix codacy"}, "afterCommit": {"oid": "5c044023169a21bd019ffd32b026d6cf322dcdbd", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/5c044023169a21bd019ffd32b026d6cf322dcdbd", "committedDate": "2020-07-24T10:02:28Z", "message": "fix codacy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ea435345faf93277cb8f4670fcb7efaaba8e55b", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/3ea435345faf93277cb8f4670fcb7efaaba8e55b", "committedDate": "2020-07-24T11:22:15Z", "message": "set parent process to closed, when childs are exported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/e3f74fca9843df5c40ef5585c466daee28c82a8b", "committedDate": "2020-07-24T11:22:15Z", "message": "fix codacy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c044023169a21bd019ffd32b026d6cf322dcdbd", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/5c044023169a21bd019ffd32b026d6cf322dcdbd", "committedDate": "2020-07-24T10:02:28Z", "message": "fix codacy"}, "afterCommit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/e3f74fca9843df5c40ef5585c466daee28c82a8b", "committedDate": "2020-07-24T11:22:15Z", "message": "fix codacy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MTc0MTg5", "url": "https://github.com/kitodo/kitodo-production/pull/3858#pullrequestreview-458174189", "createdAt": "2020-07-30T08:05:29Z", "commit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwODowNToyOVrOG5YbTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQwOToxNjoyMFrOG5a80A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjgyMjIyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private boolean allChildsExported(Process process) {\n          \n          \n            \n                    if (process.getChildren().isEmpty()) {\n          \n          \n            \n                        boolean allChildsExported = true;\n          \n          \n            \n                        for (Process child : process.getChildren()) {\n          \n          \n            \n                            allChildsExported &= child.isExported();\n          \n          \n            \n                        }\n          \n          \n            \n                        return allChildsExported;\n          \n          \n            \n                private boolean allChildrenExported(Process process) {\n          \n          \n            \n                    if (process.getChildren().isEmpty()) {\n          \n          \n            \n                        boolean allChildrenExported = true;\n          \n          \n            \n                        for (Process child : process.getChildren()) {\n          \n          \n            \n                            allChildrenExported &= child.isExported();\n          \n          \n            \n                        }\n          \n          \n            \n                        return allChildrenExported;\n          \n      \n    \n    \n  \n\nIt should be \"children\" instead of \"childs\".", "url": "https://github.com/kitodo/kitodo-production/pull/3858#discussion_r462822220", "createdAt": "2020-07-30T08:05:29Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/export/ExportDms.java", "diffHunk": "@@ -86,6 +89,17 @@ public void startExport(Process process) throws DataException {\n         }\n     }\n \n+    private boolean allChildsExported(Process process) {\n+        if (process.getChildren().isEmpty()) {\n+            boolean allChildsExported = true;\n+            for (Process child : process.getChildren()) {\n+                allChildsExported &= child.isExported();\n+            }\n+            return allChildsExported;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjgyNDg4Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (allChildsExported(process)) {\n          \n          \n            \n                        if (allChildrenExported(process)) {\n          \n      \n    \n    \n  \n\nIt should be \"children\" instead of \"childs\".", "url": "https://github.com/kitodo/kitodo-production/pull/3858#discussion_r462824886", "createdAt": "2020-07-30T08:10:16Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/export/ExportDms.java", "diffHunk": "@@ -77,6 +77,9 @@ public void startExport(Process process) throws DataException {\n         }\n         boolean exportSucessfull = startExport(process, (URI) null);\n         if (exportSucessfull) {\n+            if (allChildsExported(process)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg1NTcwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import java.util.ArrayList;\n          \n          \n            \n            import java.util.List;\n          \n      \n    \n    \n  \n\nUnused", "url": "https://github.com/kitodo/kitodo-production/pull/3858#discussion_r462855706", "createdAt": "2020-07-30T09:02:22Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/test/java/org/kitodo/production/services/data/ProcessServiceTest.java", "diffHunk": "@@ -12,6 +12,7 @@\n package org.kitodo.production.services.data;\n \n import java.net.URI;\n+import java.util.ArrayList;\n import java.util.List;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg2MzU2OA==", "bodyText": "Javadoc is missing a period and description for thrown exceptions.", "url": "https://github.com/kitodo/kitodo-production/pull/3858#discussion_r462863568", "createdAt": "2020-07-30T09:16:20Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/test/java/org/kitodo/production/forms/copyprocess/CreateProcessFormIT.java", "diffHunk": "@@ -99,4 +101,37 @@ public void shouldCreateNewProcess() throws Exception {\n         processService.remove(processId);\n         fileService.delete(URI.create(processId.toString()));\n     }\n+\n+    /**\n+     * test creation of processes without workflow\n+     * @throws Exception", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3f74fca9843df5c40ef5585c466daee28c82a8b"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cac18fb5149d00f50606dd7c7ef5a9992ba6180", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/7cac18fb5149d00f50606dd7c7ef5a9992ba6180", "committedDate": "2020-08-03T07:22:13Z", "message": "fix format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNTgzMDc2", "url": "https://github.com/kitodo/kitodo-production/pull/3858#pullrequestreview-460583076", "createdAt": "2020-08-04T08:00:12Z", "commit": {"oid": "7cac18fb5149d00f50606dd7c7ef5a9992ba6180"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwODowMDoxMlrOG7Vd8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwODowMDoxMlrOG7Vd8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg3MDg5OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (process.getChildren().isEmpty()) {\n          \n          \n            \n                    if (!process.getChildren().isEmpty()) {\n          \n      \n    \n    \n  \n\nShouldn't this be negated?", "url": "https://github.com/kitodo/kitodo-production/pull/3858#discussion_r464870898", "createdAt": "2020-08-04T08:00:12Z", "author": {"login": "oliver-stoehr"}, "path": "Kitodo/src/main/java/org/kitodo/export/ExportDms.java", "diffHunk": "@@ -86,6 +89,17 @@ public void startExport(Process process) throws DataException {\n         }\n     }\n \n+    private boolean allChildrenExported(Process process) {\n+        if (process.getChildren().isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cac18fb5149d00f50606dd7c7ef5a9992ba6180"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e75e6d3ed7db8734242b7c63e9fc2d2933f5a7c", "author": {"user": {"login": "Kathrin-Huber", "name": "Kathrin Huber"}}, "url": "https://github.com/kitodo/kitodo-production/commit/1e75e6d3ed7db8734242b7c63e9fc2d2933f5a7c", "committedDate": "2020-08-05T11:02:41Z", "message": "Update Kitodo/src/main/java/org/kitodo/export/ExportDms.java\n\nCo-authored-by: Oliver St\u00f6hr <32509444+oliver-stoehr@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2627, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}