{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTc0OTkw", "number": 8729, "title": "Fix for zimo mx 1, mxulf to initialize programmer properly ", "bodyText": "", "createdAt": "2020-06-24T12:27:52Z", "url": "https://github.com/JMRI/JMRI/pull/8729", "merged": true, "mergeCommit": {"oid": "1e17ba7df5f4eb6ee9aa4bce33ba0018696111df"}, "closed": true, "closedAt": "2020-06-26T16:55:17Z", "author": {"login": "AlgerP572"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuQ9nlgH2gAyNDM5MTc0OTkwOmMxNjc0ZjQxODNhNWFhOWUxMjI5NmIzMjNhNDY3OWIxMTYxMTI5NGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcusce-AFqTQzNzM4MTUxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c1674f4183a5aa9e12296b323a4679b11611294d", "author": {"user": {"login": "AlgerP572", "name": "Alger PIke"}}, "url": "https://github.com/JMRI/JMRI/commit/c1674f4183a5aa9e12296b323a4679b11611294d", "committedDate": "2020-06-24T02:52:23Z", "message": "The programmerManager and default programmer is being created before hardware is initialized for the Zimo MXULF and MX-1 drivers. This fix forces the code to recreate the program managers after the COM port is open and the hardware is initialized."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ccee7aef6e09515161dbcf68f0e1d761fe959c3", "author": {"user": {"login": "AlgerP572", "name": "Alger PIke"}}, "url": "https://github.com/JMRI/JMRI/commit/7ccee7aef6e09515161dbcf68f0e1d761fe959c3", "committedDate": "2020-06-24T12:22:01Z", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NjAwMDE0", "url": "https://github.com/JMRI/JMRI/pull/8729#pullrequestreview-436600014", "createdAt": "2020-06-24T12:31:55Z", "commit": {"oid": "c1674f4183a5aa9e12296b323a4679b11611294d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjozMTo1NlrOGoQDUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjozMTo1NlrOGoQDUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1OTIxNg==", "bodyText": "An alternative approach could possibly not create the default programmer at all and defer creation until this point,  This seemed safer as I did not know the consequences for the former approach. Other better alternatives could also exist?\nThis fix restores CV read / write when using decoder pro with the zimo MXULF.  When the default programmer was created the traffic controller had not been initialized yet so the default programmer had a traffic controller with a value of null.  At this point in the code the traffic controller exists so when the programmer is re-create it has a non-null traffic controller which uses the binary protocol.", "url": "https://github.com/JMRI/JMRI/pull/8729#discussion_r444859216", "createdAt": "2020-06-24T12:31:56Z", "author": {"login": "AlgerP572"}, "path": "java/src/jmri/jmrix/zimo/Mx1SystemConnectionMemo.java", "diffHunk": "@@ -141,6 +141,11 @@ public boolean provides(Class<?> type) {\n      * hexfile.HexFileFrame and locormi.LnMessageClient\n      */\n     public void configureManagers() {\n+        \n+        /* Already created during config with default settings. Recreating\n+        * now that the traffic controller exists\n+        */\n+        programmerManager = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1674f4183a5aa9e12296b323a4679b11611294d"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5467470588a8d02cf8f451761bc7671f656cac71", "author": {"user": {"login": "AlgerP572", "name": "Alger PIke"}}, "url": "https://github.com/JMRI/JMRI/commit/5467470588a8d02cf8f451761bc7671f656cac71", "committedDate": "2020-06-25T03:49:23Z", "message": "Address code review comment. Hard coding return true for GlobalProgrammerManager and return false for AddressedProgramManager.  This allows creation of the ProgrammerManager Instance to be defered until collaborating objects have been created."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MTUwODQ3", "url": "https://github.com/JMRI/JMRI/pull/8729#pullrequestreview-437150847", "createdAt": "2020-06-25T03:56:56Z", "commit": {"oid": "5467470588a8d02cf8f451761bc7671f656cac71"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMzo1Njo1N1rOGoqhNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwMzo1Njo1N1rOGoqhNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5Mjg1Mg==", "bodyText": "@pabender The above fix eliminates the need to reset the program manager to null and it creates the program manager with the traffic controller.  I have tested the fix and I am able to read /write my decoders again. \ud83d\udc4d", "url": "https://github.com/JMRI/JMRI/pull/8729#discussion_r445292852", "createdAt": "2020-06-25T03:56:57Z", "author": {"login": "AlgerP572"}, "path": "java/src/jmri/jmrix/zimo/Mx1SystemConnectionMemo.java", "diffHunk": "@@ -141,11 +141,6 @@ public boolean provides(Class<?> type) {\n      * hexfile.HexFileFrame and locormi.LnMessageClient\n      */\n     public void configureManagers() {\n-        \n-        /* Already created during config with default settings. Recreating\n-        * now that the traffic controller exists\n-        */\n-        programmerManager = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5467470588a8d02cf8f451761bc7671f656cac71"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzgxNTEx", "url": "https://github.com/JMRI/JMRI/pull/8729#pullrequestreview-437381511", "createdAt": "2020-06-25T10:53:31Z", "commit": {"oid": "5467470588a8d02cf8f451761bc7671f656cac71"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMDo1MzozMlrOGo1iWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMDo1MzozMlrOGo1iWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3MzM3MA==", "bodyText": "I found the above to lines were the only place that the ProgrammerManger was used before the traffic controller has existed,  Returning true or false directly here allows the creation of the program manager to be deferred and also seems consistent with what was done in this method for the other manager types.", "url": "https://github.com/JMRI/JMRI/pull/8729#discussion_r445473370", "createdAt": "2020-06-25T10:53:32Z", "author": {"login": "AlgerP572"}, "path": "java/src/jmri/jmrix/zimo/Mx1SystemConnectionMemo.java", "diffHunk": "@@ -83,11 +83,11 @@ public boolean provides(Class<?> type) {\n         if (getDisabled()) {\n             return false;\n         }\n-        if (type.equals(jmri.GlobalProgrammerManager.class)) {\n-            return getProgrammerManager().isGlobalProgrammerAvailable();\n+        if (type.equals(jmri.GlobalProgrammerManager.class)) {            \n+            return true;\n         }\n-        if (type.equals(jmri.AddressedProgrammerManager.class)) {\n-            return getProgrammerManager().isAddressedModePossible();\n+        if (type.equals(jmri.AddressedProgrammerManager.class)) {            \n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5467470588a8d02cf8f451761bc7671f656cac71"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4062, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}