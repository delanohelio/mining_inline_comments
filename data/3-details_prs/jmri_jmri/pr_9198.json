{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNjU4MDgx", "number": 9198, "title": "Bug fix & new jynstrument", "bodyText": "bug fix, see jmriusers message 78674589\nadded meaning full error messages for Jynstrument creation failure\nnew Jynstrument allowing to hide toolbar, menubar and switch to \"play mode\" for a throttle window.", "createdAt": "2020-12-03T10:04:52Z", "url": "https://github.com/JMRI/JMRI/pull/9198", "merged": true, "mergeCommit": {"oid": "1c802fbfc14086f164d84ed1e44b0016e8a7d78c"}, "closed": true, "closedAt": "2020-12-05T03:05:01Z", "author": {"login": "Lionel642"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFTT8NAH2gAyNTMxNjU4MDgxOjY2MWJlOTJlNTYzNDdlNjU4ZTYwYTE1Zjg1MjVmMmRiMmJiMTNmNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi6bARgFqTU0NTExNTQ2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "661be92e56347e658e60a15f8525f2db2bb13f65", "author": {"user": {"login": "Lionel642", "name": "Lionel Jeanson"}}, "url": "https://github.com/JMRI/JMRI/commit/661be92e56347e658e60a15f8525f2db2bb13f65", "committedDate": "2020-09-03T16:36:50Z", "message": "New jysntrument for throttle frame to hide (or show) the throttle window toolbar and menubar, will also switch off (on) edit mode, all this will produce a really reduced throttle window."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7a52d39b128c93a6269e31d948e1f22174ab1a3", "author": {"user": {"login": "Lionel642", "name": "Lionel Jeanson"}}, "url": "https://github.com/JMRI/JMRI/commit/d7a52d39b128c93a6269e31d948e1f22174ab1a3", "committedDate": "2020-12-03T08:04:44Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81000b1cde0abfbfeb70efc25fd03014ba15b273", "author": {"user": {"login": "Lionel642", "name": "Lionel Jeanson"}}, "url": "https://github.com/JMRI/JMRI/commit/81000b1cde0abfbfeb70efc25fd03014ba15b273", "committedDate": "2020-12-03T09:51:50Z", "message": "Fixing new issue where path separator is last character of a folder path.\nMeaningfull error messages."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca3854a9ed96c142755277a61aa4f2dc6f50a61c", "author": {"user": {"login": "Lionel642", "name": "Lionel Jeanson"}}, "url": "https://github.com/JMRI/JMRI/commit/ca3854a9ed96c142755277a61aa4f2dc6f50a61c", "committedDate": "2020-12-03T12:24:10Z", "message": "Updated release note"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MDQ2OTI5", "url": "https://github.com/JMRI/JMRI/pull/9198#pullrequestreview-545046929", "createdAt": "2020-12-04T15:15:37Z", "commit": {"oid": "ca3854a9ed96c142755277a61aa4f2dc6f50a61c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNToxNTozN1rOH_VS2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNToxNTozN1rOH_VS2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3MTIyNA==", "bodyText": "Shouln't this be:\nif (! path.toLowerCase().endsWith(\".jyn\")) {\ninstead?", "url": "https://github.com/JMRI/JMRI/pull/9198#discussion_r536171224", "createdAt": "2020-12-04T15:15:37Z", "author": {"login": "danielb987"}, "path": "java/src/jmri/jmrit/jython/JynstrumentFactory.java", "diffHunk": "@@ -66,21 +67,25 @@ public static Jynstrument createInstrument(String path, Object context) {\n     // validate Jynstrument path, return className\n     private static String validate(String path) {\n         if (path == null) {\n+            log.error(\"Path is null\");\n             return null;\n         }\n         if (path.length() - 4 < 0) {\n-            log.error(\"File name too short\");\n+            log.error(\"File name too short (should at least end with .jyn) (got {})\", path);\n             return null;\n         }\n+        if (path.endsWith(File.separator)) {\n+            path = path.substring(0, path.length()-File.separator.length());\n+        }\n         File f = new File(path);\n \n         // Path must be a folder named xyz.jin\n         if (!f.isDirectory()) {\n             log.debug(\"Not a directory, trying parent\");\n             return null;\n         }\n-        if (path.substring(path.length() - 4).compareToIgnoreCase(\".jyn\") != 0) {\n-            log.debug(\"Not an instrument\");\n+        if (! path.toLowerCase().startsWith(\".jyn\", path.length() - 4)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca3854a9ed96c142755277a61aa4f2dc6f50a61c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3bcfb31e33ef1528769d2a2f5da2ea9b16e9d0c", "author": {"user": {"login": "Lionel642", "name": "Lionel Jeanson"}}, "url": "https://github.com/JMRI/JMRI/commit/e3bcfb31e33ef1528769d2a2f5da2ea9b16e9d0c", "committedDate": "2020-12-04T16:30:32Z", "message": "Code simplification."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MTE1NDYx", "url": "https://github.com/JMRI/JMRI/pull/9198#pullrequestreview-545115461", "createdAt": "2020-12-04T16:34:39Z", "commit": {"oid": "e3bcfb31e33ef1528769d2a2f5da2ea9b16e9d0c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3878, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}