{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MjMzMjAx", "number": 9129, "title": "LayoutEditor:misc bug fixes", "bodyText": "While working on other projects I noticed a few bugs that I'm fixing here to get into top-of-tree.", "createdAt": "2020-11-02T18:09:54Z", "url": "https://github.com/JMRI/JMRI/pull/9129", "merged": true, "mergeCommit": {"oid": "a7ae7c0884e2ddda131ad19ee682efada15b7e62"}, "closed": true, "closedAt": "2020-11-17T11:55:01Z", "author": {"login": "geowar1"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYojTjgH2gAyNTE0MjMzMjAxOmU0OTU5ZDEzYzljZDgwY2Q3ZmM0Y2FiNGIxNTkzZjRkZTMzNWI1ODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddYOaPAFqTUzMjI4NzQwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e4959d13c9cd80cd7fc4cab4b1593f4de335b589", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/e4959d13c9cd80cd7fc4cab4b1593f4de335b589", "committedDate": "2020-11-02T18:06:11Z", "message": "Misc bugfixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1ef96866c595349d30419fd91bf58d19ed0d35e", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/b1ef96866c595349d30419fd91bf58d19ed0d35e", "committedDate": "2020-11-02T18:06:24Z", "message": "Update LayoutEditor.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxODg1NDU0", "url": "https://github.com/JMRI/JMRI/pull/9129#pullrequestreview-521885454", "createdAt": "2020-11-02T18:19:35Z", "commit": {"oid": "b1ef96866c595349d30419fd91bf58d19ed0d35e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxODoxOTozNlrOHsQejg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxODoxOTozNlrOHsQejg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE2OTM1OA==", "bodyText": "Could you say a few words about why this is here?  It seems to defeat the purpose of the loop, but perhaps I don't understand what this loop is meant to do.", "url": "https://github.com/JMRI/JMRI/pull/9129#discussion_r516169358", "createdAt": "2020-11-02T18:19:36Z", "author": {"login": "bobjacobsen"}, "path": "java/src/jmri/jmrit/display/layoutEditor/LayoutEditorAction.java", "diffHunk": "@@ -27,6 +27,8 @@ public void actionPerformed(ActionEvent e) {\n         for (int i = 2; i < 100; i++) {\n             if (InstanceManager.getDefault(EditorManager.class).contains(name)) {\n                 name = \"My Layout \" + i;\n+            } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ef96866c595349d30419fd91bf58d19ed0d35e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49afc3d17d5ce1661dd42374be3dab08a5465232", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/49afc3d17d5ce1661dd42374be3dab08a5465232", "committedDate": "2020-11-02T18:21:42Z", "message": "Update MathUtil.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "022cda044f468d318317b851d0af3f2c484cc479", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/022cda044f468d318317b851d0af3f2c484cc479", "committedDate": "2020-11-02T19:20:35Z", "message": "Fix Windows CI test fails\n\nRevert anchor one of two connection Color to yellow."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNTA4NDYw", "url": "https://github.com/JMRI/JMRI/pull/9129#pullrequestreview-522508460", "createdAt": "2020-11-03T13:46:33Z", "commit": {"oid": "022cda044f468d318317b851d0af3f2c484cc479"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMzo0NjozM1rOHsvb-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMzo0NjozM1rOHsvb-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY3NjYwMA==", "bodyText": "The infinite loop that @danielb987 saw in CI goes through here.  Line 1909 of TrackSegment view in getCentreSeg does a setCoordsCenter call, which goes through getBounds, which in line 574 calls getCentreSeg again.  Not sure whether the underlying problem is here or in line 1909 (why is a get call setting something?), but this is the new code.", "url": "https://github.com/JMRI/JMRI/pull/9129#discussion_r516676600", "createdAt": "2020-11-03T13:46:33Z", "author": {"login": "bobjacobsen"}, "path": "java/src/jmri/jmrit/display/layoutEditor/TrackSegmentView.java", "diffHunk": "@@ -564,6 +564,15 @@ public Rectangle2D getBounds() {\n         result = new Rectangle2D.Double(ep1.getX(), ep1.getY(), 0, 0);\n         result.add(ep2);\n \n+        if (isCircle()) {\n+            result.add(getCoordsCenterCircle());\n+        } else if (isBezier()) {\n+            for (int index = 0; index < bezierControlPoints.size(); index++) {\n+                result.add(bezierControlPoints.get(index));\n+            }\n+        }\n+        result.add(getCentreSeg());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022cda044f468d318317b851d0af3f2c484cc479"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b7328c6fa73efb1da95e6cd21d8b3572fa9d7c9", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/9b7328c6fa73efb1da95e6cd21d8b3572fa9d7c9", "committedDate": "2020-11-03T19:42:41Z", "message": "getCentreSeg() ==> getCoordsCenter()\n\ngetCentreSeg used getBounds to calculate where the center seg should be\u2026 So we can't call getCentreSeg here\u2026 but since it also calls setCoordsCenter(\u2026) we can use getCoordsCenter instead. So\u2026 quick fix! ;-)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d883ed50572cace60bb558915633d1afb80e5c34", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/d883ed50572cace60bb558915633d1afb80e5c34", "committedDate": "2020-11-03T19:51:12Z", "message": "Update LayoutEditorComponent.java\n\nDon't centerRectangleOnPoint(r, ls.getCoordsCenter());"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c20b65bd760946feabb7fa84a418e24d744baef", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/1c20b65bd760946feabb7fa84a418e24d744baef", "committedDate": "2020-11-03T23:32:36Z", "message": "getCentreSeg() ==> calcCentreSeg\n\nChanged getCentreSeg() to just return getCoordsCenter()\u2026\nTrackSegmentView.drawEditControls calls calcCentreSeg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c37a865586be500798c1d5c76e44006af03ae1d", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/0c37a865586be500798c1d5c76e44006af03ae1d", "committedDate": "2020-11-04T00:15:09Z", "message": "Fix TrackSegmentView tests because getBounds() now returns correct rectangle."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89d612a804d8323455fa85f0d8535b0cad982a55", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/89d612a804d8323455fa85f0d8535b0cad982a55", "committedDate": "2020-11-05T03:12:02Z", "message": "Update TrackSegmentViewTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "528b80542ca4023b46175d58fecb97c9e5659cfe", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/528b80542ca4023b46175d58fecb97c9e5659cfe", "committedDate": "2020-11-05T03:23:32Z", "message": "Update TrackSegmentViewTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9186f6a4cf52d56701051437cda0df0d91aa60ea", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/9186f6a4cf52d56701051437cda0df0d91aa60ea", "committedDate": "2020-11-05T20:54:40Z", "message": "Fix for getCentreSeg getBounds stack overflow"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dd53701f8c7db2638d00a17b72272b2b7398fd2", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/4dd53701f8c7db2638d00a17b72272b2b7398fd2", "committedDate": "2020-11-13T00:36:11Z", "message": "Fixes for #9145 (NOTE: Webserver LE panel drawing BROKEN in top-of-tree)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6ba9a413e0c5734b483f39422327a5169086169", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/b6ba9a413e0c5734b483f39422327a5169086169", "committedDate": "2020-11-13T04:59:56Z", "message": "Fix LayoutEditorXML for main/side line track widths\n\nUpdate panel.js to use isDefined/isUndefined functions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dca88161dcd1d3081b950bcf364f2c5fb3e20cd", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/4dca88161dcd1d3081b950bcf364f2c5fb3e20cd", "committedDate": "2020-11-13T05:06:10Z", "message": "two typo's fixed in panel.js"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9053dd281905a4bf23e77fb9e9985e6375b59d9", "author": {"user": {"login": "geowar1", "name": "George Warner"}}, "url": "https://github.com/JMRI/JMRI/commit/e9053dd281905a4bf23e77fb9e9985e6375b59d9", "committedDate": "2020-11-13T05:48:11Z", "message": "Update LayoutPanelServlet.java\n\nFixes \"can't draw tracksegment T10: connect2: X0.LEVEL_XING_A undefined errors\"."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMjg3NDAw", "url": "https://github.com/JMRI/JMRI/pull/9129#pullrequestreview-532287400", "createdAt": "2020-11-17T11:54:30Z", "commit": {"oid": "e9053dd281905a4bf23e77fb9e9985e6375b59d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3838, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}