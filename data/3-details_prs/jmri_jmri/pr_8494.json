{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MTg0NDgy", "number": 8494, "title": "SPROG CBUS mode switcher", "bodyText": "Allow SPROG CBUS hardware to be switched between programmer and command station m odes, updating the DP3 GUI to reflect programmer availability.", "createdAt": "2020-05-06T15:54:48Z", "url": "https://github.com/JMRI/JMRI/pull/8494", "merged": true, "mergeCommit": {"oid": "3ff04feb9fa53cb857457a23b36e6c8dee297685"}, "closed": true, "closedAt": "2020-05-13T22:52:54Z", "author": {"login": "crosland"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcequXaAH2gAyNDE0MTg0NDgyOjY1MmZlMjFlYmY2ZTNhMWU1NWI3OTllMTYwMWZjOGI0NzViNGRmY2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg2P4qgH2gAyNDE0MTg0NDgyOjY1OThmMWY4MDE4NDhkNTQ2OTI2Njc3MWIxODU3ODY0ZTAwYmQ5ZTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "652fe21ebf6e3a1e55b799e1601fc8b475b4dfcd", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/652fe21ebf6e3a1e55b799e1601fc8b475b4dfcd", "committedDate": "2020-05-06T15:50:28Z", "message": "CBUS switch between programmer and command station modes\n\nAdded ability to swicth between programmer and command station modes, updating the programmer status in the DP3 gui as appropriate."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e5c8d66e15b873c92e96fb4b8222b660d001b74", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/5e5c8d66e15b873c92e96fb4b8222b660d001b74", "committedDate": "2020-05-06T15:51:22Z", "message": "Merge branch 'master' into WIP--Mode-Switcher"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NzcyOTE0", "url": "https://github.com/JMRI/JMRI/pull/8494#pullrequestreview-406772914", "createdAt": "2020-05-06T16:15:03Z", "commit": {"oid": "5e5c8d66e15b873c92e96fb4b8222b660d001b74"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2749319c0ebc061f24d82f79043bab7194eba5c2", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/2749319c0ebc061f24d82f79043bab7194eba5c2", "committedDate": "2020-05-07T19:20:11Z", "message": "Rework mode changer to remove InstanceManager changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f33d4f0dbe4bc75913d73385fa551755d9385c3", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/7f33d4f0dbe4bc75913d73385fa551755d9385c3", "committedDate": "2020-05-07T20:00:44Z", "message": "Use correct classes and rename tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0940d61b93ba90f12fecb74684d7253c37043f7c", "author": {"user": {"login": "rhwood", "name": "Randall Wood"}}, "url": "https://github.com/JMRI/JMRI/commit/0940d61b93ba90f12fecb74684d7253c37043f7c", "committedDate": "2020-05-09T00:43:23Z", "message": "Fire events when programmer properties change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f2bfffb42aee472e66264df720e405aaa3be991", "author": {"user": {"login": "rhwood", "name": "Randall Wood"}}, "url": "https://github.com/JMRI/JMRI/commit/2f2bfffb42aee472e66264df720e405aaa3be991", "committedDate": "2020-05-09T09:40:51Z", "message": "fix: listen to existing programmer managers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c455d7c7fa80df4dcf3e6d5641d5a9a084b3a4a", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/4c455d7c7fa80df4dcf3e6d5641d5a9a084b3a4a", "committedDate": "2020-05-09T13:07:59Z", "message": "Merge pull request #1 from rhwood/live-programming-modes\n\nfeat: Fire events when programmer properties change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78c31fc7931a4263fc0c0d60aa543f6f54d118e3", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/78c31fc7931a4263fc0c0d60aa543f6f54d118e3", "committedDate": "2020-05-09T13:51:26Z", "message": "Revert \"Use correct classes and rename tests\"\n\nThis reverts commit 7f33d4f0dbe4bc75913d73385fa551755d9385c3."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d01c01816378f6570606e1f4ebcbfc3ed96c2c05", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/d01c01816378f6570606e1f4ebcbfc3ed96c2c05", "committedDate": "2020-05-09T13:52:02Z", "message": "Revert \"Revert \"Use correct classes and rename tests\"\"\n\nThis reverts commit 78c31fc7931a4263fc0c0d60aa543f6f54d118e3."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcfd97baea5b8d3514e87b47de5f4d0a2f2ac30e", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/fcfd97baea5b8d3514e87b47de5f4d0a2f2ac30e", "committedDate": "2020-05-09T13:52:11Z", "message": "Revert \"Revert \"Revert \"Use correct classes and rename tests\"\"\"\n\nThis reverts commit d01c01816378f6570606e1f4ebcbfc3ed96c2c05."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e3b97242f594434dae966084ec158669cb684e2", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/3e3b97242f594434dae966084ec158669cb684e2", "committedDate": "2020-05-09T13:52:23Z", "message": "Revert \"Rework mode changer to remove InstanceManager changes\"\n\nThis reverts commit 2749319c0ebc061f24d82f79043bab7194eba5c2."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a67995aeb636da22c74442389af50bf15e3f4968", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/a67995aeb636da22c74442389af50bf15e3f4968", "committedDate": "2020-05-09T13:53:18Z", "message": "Merge branch 'WIP--Mode-Switcher' of https://github.com/crosland/JMRI into WIP--Mode-Switcher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bba800770071dd62e03a6b7da5228e946bad2e8", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/7bba800770071dd62e03a6b7da5228e946bad2e8", "committedDate": "2020-05-09T17:44:45Z", "message": "Use more descriptive name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2bc3082d4c45e5c08d9b4d1239640ec092fd236", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/a2bc3082d4c45e5c08d9b4d1239640ec092fd236", "committedDate": "2020-05-10T12:26:12Z", "message": "Merge remote-tracking branch 'upstream/master' into WIP--Mode-Switcher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "235ec5bc3537df4216cc2761275e042cf14b98ad", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/235ec5bc3537df4216cc2761275e042cf14b98ad", "committedDate": "2020-05-10T18:40:07Z", "message": "Add preferences support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f18db17630e0541792b63b927cb36c2e8c7b2fa5", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/f18db17630e0541792b63b927cb36c2e8c7b2fa5", "committedDate": "2020-05-10T19:37:31Z", "message": "Register preferences with InstanceManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a9ee37da170686b0f318772763bbbb2d00ad3cb", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/8a9ee37da170686b0f318772763bbbb2d00ad3cb", "committedDate": "2020-05-11T12:00:45Z", "message": "Catch possible null pointer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3597f46e43733e11b2d1e15506aa3af58965bed", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/a3597f46e43733e11b2d1e15506aa3af58965bed", "committedDate": "2020-05-11T12:01:25Z", "message": "Merge branch 'master' into WIP--Mode-Switcher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e0705a824b57f45a8222e261c9ea4f14ed60ba6", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/9e0705a824b57f45a8222e261c9ea4f14ed60ba6", "committedDate": "2020-05-11T15:06:04Z", "message": "Always register CBUS programming hardware\n\nHardware must be registered with the instance manager so that it's known about when we try to re-enable it if saved preferences initially set it to disabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ea74c94ea8ada80c1f1b5417c1068260dca47b9", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/8ea74c94ea8ada80c1f1b5417c1068260dca47b9", "committedDate": "2020-05-11T18:42:09Z", "message": "Add Node Variable writet to set connected hardware mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e47ffe947b32845aa4c16e62070b07db2c4392fb", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/e47ffe947b32845aa4c16e62070b07db2c4392fb", "committedDate": "2020-05-11T19:33:31Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03ef489c40aa78a8d84f5b0c74a1678af6120722", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/03ef489c40aa78a8d84f5b0c74a1678af6120722", "committedDate": "2020-05-12T08:44:57Z", "message": "Add missing supr call in teardown"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6df2dc82daad5e31c8778e5b99b3dbc4d03aabf1", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/6df2dc82daad5e31c8778e5b99b3dbc4d03aabf1", "committedDate": "2020-05-12T09:40:13Z", "message": "Another attempt to get test to pass"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65d20bde832c6917a9c27c373ddbfabd39471c5a", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/65d20bde832c6917a9c27c373ddbfabd39471c5a", "committedDate": "2020-05-12T11:21:47Z", "message": "Remove programmer after test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTgxOTM0", "url": "https://github.com/JMRI/JMRI/pull/8494#pullrequestreview-410581934", "createdAt": "2020-05-13T04:39:41Z", "commit": {"oid": "65d20bde832c6917a9c27c373ddbfabd39471c5a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDozOTo0MVrOGUhLOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo1MDowMVrOGUhUTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODI1MA==", "bodyText": "What kind of errors lead to this comment?  It looks strange having a Pane on the class name, but inheriting from a frame.  We either need to fix the class or change the name.", "url": "https://github.com/JMRI/JMRI/pull/8494#discussion_r424168250", "createdAt": "2020-05-13T04:39:41Z", "author": {"login": "pabender"}, "path": "java/src/jmri/jmrix/can/cbus/swing/modeswitcher/SprogCbusModeSwitcherPane.java", "diffHunk": "@@ -0,0 +1,236 @@\n+package jmri.jmrix.can.cbus.swing.modeswitcher;\n+\n+import java.awt.BorderLayout;\n+import java.awt.event.ActionListener;\n+import javax.swing.BorderFactory;\n+import javax.swing.BoxLayout;\n+import javax.swing.JLabel;\n+import javax.swing.JPanel;\n+import javax.swing.JRadioButton;\n+import jmri.GlobalProgrammerManager;\n+import jmri.InstanceManager;\n+import jmri.jmrix.can.CanListener;\n+import jmri.jmrix.can.CanMessage;\n+import jmri.jmrix.can.CanReply;\n+import jmri.jmrix.can.CanSystemConnectionMemo;\n+import jmri.jmrix.can.TrafficController;\n+import jmri.jmrix.can.cbus.CbusDccProgrammerManager;\n+import jmri.jmrix.can.cbus.CbusPreferences;\n+import jmri.jmrix.can.cbus.CbusSend;\n+import jmri.jmrix.can.cbus.node.CbusNode;\n+import jmri.jmrix.can.cbus.node.CbusNodeTableDataModel;\n+import jmri.util.JmriJFrame;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Mode Switcher to switch modes between programmer and command station.\n+ *\n+ * No matter what I tried, I cannot get the label text to wrap when added to a\n+ * CanNamedPane, so this is implemented as a JmriJFrame.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65d20bde832c6917a9c27c373ddbfabd39471c5a"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2OTc5MA==", "bodyText": "You don\u2019t want to call JUnitUtil.resetWindows before the call to super.tearDown.  super.tearDown disposes of the frame and then calls resetWindows.", "url": "https://github.com/JMRI/JMRI/pull/8494#discussion_r424169790", "createdAt": "2020-05-13T04:46:42Z", "author": {"login": "pabender"}, "path": "java/test/jmri/jmrix/can/cbus/swing/modeswitcher/SprogCbusModeSwitcherPaneTest.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package jmri.jmrix.can.cbus.swing.modeswitcher;\n+\n+import java.awt.GraphicsEnvironment;\n+import jmri.GlobalProgrammerManager;\n+import jmri.jmrix.can.CanSystemConnectionMemo;\n+import jmri.jmrix.can.TrafficControllerScaffold;\n+import jmri.jmrix.can.cbus.CbusDccProgrammer;\n+import jmri.jmrix.can.cbus.CbusDccProgrammerManager;\n+import jmri.jmrix.can.cbus.CbusPreferences;\n+import jmri.util.JUnitUtil;\n+import org.junit.After;\n+import org.junit.Assume;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+/**\n+ * Tests for the ModeSwitcherPane class\n+ *\n+ * @author Andrew Crosland (C) 2020\n+ */\n+public class SprogCbusModeSwitcherPaneTest extends jmri.util.JmriJFrameTestBase {\n+\n+    CanSystemConnectionMemo memo;\n+    CbusDccProgrammer prog;\n+    jmri.jmrix.can.TrafficController tc;\n+    \n+    @Test\n+    public void testInitComponents() throws Exception{\n+        Assume.assumeFalse(GraphicsEnvironment.isHeadless());\n+        // for now, just make sure there isn't an exception.\n+        ((SprogCbusModeSwitcherPane) frame).initComponents();\n+    }\n+\n+    @Before\n+    @Override\n+    public void setUp() {\n+        JUnitUtil.setUp();\n+        \n+        jmri.InstanceManager.setDefault(jmri.jmrix.can.cbus.CbusPreferences.class,new CbusPreferences() );\n+\n+        tc = new TrafficControllerScaffold();\n+        memo = new CanSystemConnectionMemo();\n+        memo.setTrafficController(tc);\n+        prog = new CbusDccProgrammer(tc);\n+        \n+        jmri.InstanceManager.setDefault(GlobalProgrammerManager.class,new CbusDccProgrammerManager(prog, memo) );\n+        if (!GraphicsEnvironment.isHeadless()) {\n+            frame = new SprogCbusModeSwitcherPane(memo);\n+        }\n+    }\n+\n+    @After\n+    @Override\n+    public void tearDown() {\n+        prog = null;\n+        tc.terminateThreads();\n+        memo.dispose();\n+        tc = null;\n+        memo = null;\n+        JUnitUtil.resetWindows(false,false);\n+        super.tearDown();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65d20bde832c6917a9c27c373ddbfabd39471c5a"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3MDU3NQ==", "bodyText": "You really don\u2019t need this test.  initComponets is called as part of testShowAndClose in the base class.", "url": "https://github.com/JMRI/JMRI/pull/8494#discussion_r424170575", "createdAt": "2020-05-13T04:50:01Z", "author": {"login": "pabender"}, "path": "java/test/jmri/jmrix/can/cbus/swing/modeswitcher/SprogCbusModeSwitcherPaneTest.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package jmri.jmrix.can.cbus.swing.modeswitcher;\n+\n+import java.awt.GraphicsEnvironment;\n+import jmri.GlobalProgrammerManager;\n+import jmri.jmrix.can.CanSystemConnectionMemo;\n+import jmri.jmrix.can.TrafficControllerScaffold;\n+import jmri.jmrix.can.cbus.CbusDccProgrammer;\n+import jmri.jmrix.can.cbus.CbusDccProgrammerManager;\n+import jmri.jmrix.can.cbus.CbusPreferences;\n+import jmri.util.JUnitUtil;\n+import org.junit.After;\n+import org.junit.Assume;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+/**\n+ * Tests for the ModeSwitcherPane class\n+ *\n+ * @author Andrew Crosland (C) 2020\n+ */\n+public class SprogCbusModeSwitcherPaneTest extends jmri.util.JmriJFrameTestBase {\n+\n+    CanSystemConnectionMemo memo;\n+    CbusDccProgrammer prog;\n+    jmri.jmrix.can.TrafficController tc;\n+    \n+    @Test\n+    public void testInitComponents() throws Exception{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65d20bde832c6917a9c27c373ddbfabd39471c5a"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53d397183d39e02356c2172ba6efef26e10ed00b", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/53d397183d39e02356c2172ba6efef26e10ed00b", "committedDate": "2020-05-13T09:00:14Z", "message": "Changes recommended by @pabender comments in PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6598f1f801848d5469266771b1857864e00bd9e6", "author": {"user": {"login": "crosland", "name": "Andrew Crosland"}}, "url": "https://github.com/JMRI/JMRI/commit/6598f1f801848d5469266771b1857864e00bd9e6", "committedDate": "2020-05-13T10:23:53Z", "message": "call super.dispose()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4064, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}