{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2NzQ5Mzg0", "number": 1772, "title": "Improved tags in Sarif output", "bodyText": "The SARIF output for the scans currently only outputs CWE and/or OWASP when those values are present in the rule meta-data. This change will use a shortened version of the CWE (cwe-xxx) and OWASP (owasp-AX) meta values as part of the SARIF output.", "createdAt": "2020-10-02T07:58:11Z", "url": "https://github.com/returntocorp/semgrep/pull/1772", "merged": true, "mergeCommit": {"oid": "65a7f25bed36c8e6730a4511fbc75dc97ab6798f"}, "closed": true, "closedAt": "2020-10-08T20:18:33Z", "author": {"login": "hunt3rkillerz"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOgJZWAH2gAyNDk2NzQ5Mzg0Ojk0Nzk4ODY3ZTcwM2EyYzM3Nzc2OWY5NmIwYWMxMGQ5MDIxOTdhZTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQncj3gFqTUwNTEzMzc2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94798867e703a2c377769f96b0ac10d902197ae4", "author": {"user": {"login": "hunt3rkillerz", "name": null}}, "url": "https://github.com/returntocorp/semgrep/commit/94798867e703a2c377769f96b0ac10d902197ae4", "committedDate": "2020-10-02T06:39:24Z", "message": "Metadata values used in Sarif output"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17d2f53dbdeaad9ea51375ab01b4234a1a5470be", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/17d2f53dbdeaad9ea51375ab01b4234a1a5470be", "committedDate": "2020-10-02T07:36:11Z", "message": "now using isdigit() to check char vals"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMjgzODQy", "url": "https://github.com/returntocorp/semgrep/pull/1772#pullrequestreview-503283842", "createdAt": "2020-10-06T19:18:35Z", "commit": {"oid": "17d2f53dbdeaad9ea51375ab01b4234a1a5470be"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxOToxODozNVrOHdWdug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxOToxODozNVrOHdWdug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzODgxMA==", "bodyText": "Hi @hunt3rkillerz, thanks for the PR. Is it reasonable to simply return the string from the metadata if it exists? This avoids all the heavy string parsing. E.g.\nif \"cwe\" in self.metadata:\n    yield self.metadata['cwe']\nif \"owasp\" in self.metadata:\n    yield f\"OWASP-{self.metadata['owasp']}\"\nNote that I prepended OWASP because our convention hasn't included it, but has for CWE:\njavascript/lang/security/audit/path-traversal/path-join-resolve-traversal.yaml\n47:    owasp: 'A5: Broken Access Control'\n48:    cwe: 'CWE-22: Improper Limitation of a Pathname to a Restricted Directory (Path Traversal)'\n\njavascript/lang/security/audit/non-constant-sql-query.yaml\n10:    owasp: 'A1: Injection'\n11:    cwe: \"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"\n\njavascript/lang/security/audit/unknown-value-with-script-tag.yaml\n14:    owasp: 'A7: Cross-site Scripting (XSS)'\n15:    cwe: \"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"", "url": "https://github.com/returntocorp/semgrep/pull/1772#discussion_r500538810", "createdAt": "2020-10-06T19:18:35Z", "author": {"login": "mschwager"}, "path": "semgrep/semgrep/rule.py", "diffHunk": "@@ -261,9 +261,25 @@ def sarif_tags(self) -> Iterator[str]:\n         Tags to display on SARIF-compliant UIs, such as GitHub security scans.\n         \"\"\"\n         if \"cwe\" in self.metadata:\n-            yield \"cwe\"\n+            # Handling unexpected formatting of CWE meta-data", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17d2f53dbdeaad9ea51375ab01b4234a1a5470be"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaffe1a527365f58fbc04ecf43a4ea2eb7270029", "author": {"user": {"login": "hunt3rkillerz", "name": null}}, "url": "https://github.com/returntocorp/semgrep/commit/aaffe1a527365f58fbc04ecf43a4ea2eb7270029", "committedDate": "2020-10-08T08:10:46Z", "message": "Directly outputting meta values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTMzNzEx", "url": "https://github.com/returntocorp/semgrep/pull/1772#pullrequestreview-505133711", "createdAt": "2020-10-08T20:17:26Z", "commit": {"oid": "aaffe1a527365f58fbc04ecf43a4ea2eb7270029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTMzNzYw", "url": "https://github.com/returntocorp/semgrep/pull/1772#pullrequestreview-505133760", "createdAt": "2020-10-08T20:17:31Z", "commit": {"oid": "aaffe1a527365f58fbc04ecf43a4ea2eb7270029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1279, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}