{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyMjE5ODMw", "number": 2182, "title": "handle invalid unicode files", "bodyText": "related to #2128\n  File \"/Users/dennison/.pyenv/versions/3.7.7/bin/semgrep\", line 10, in <module>\n    sys.exit(main())\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/__main__.py\", line 17, in main\n    cli()\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/cli.py\", line 431, in cli\n    severity=args.severity,\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/semgrep_main.py\", line 242, in main\n    ).invoke_semgrep(target_manager, filtered_rules)\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/core_runner.py\", line 537, in invoke_semgrep\n    rules, target_manager\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/core_runner.py\", line 505, in _run_rules\n    rule, target_manager, semgrep_core_ast_cache_dir, max_timeout_files\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/core_runner.py\", line 430, in _run_rule\n    rule, pattern_matches, self._allow_exec\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/evaluation.py\", line 378, in evaluate\n    message = interpolate_message_metavariables(rule, pattern_match)\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/evaluation.py\", line 398, in interpolate_message_metavariables\n    metavar, pattern_match.get_metavariable_value(metavar)\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/site-packages/semgrep/pattern_match.py\", line 80, in get_metavariable_value\n    value = file.read(length)\n  File \"/Users/dennison/.pyenv/versions/3.7.7/lib/python3.7/codecs.py\", line 322, in decode\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 7723: invalid continuation byte", "createdAt": "2020-12-04T01:15:38Z", "url": "https://github.com/returntocorp/semgrep/pull/2182", "merged": true, "mergeCommit": {"oid": "2f535926ca09e57e8895cc9800d1590cbe17c4b1"}, "closed": true, "closedAt": "2020-12-04T01:51:14Z", "author": {"login": "DrewDennison"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABditPULgH2gAyNTMyMjE5ODMwOjI1OTJlMzgyZjUzYjUzMDU4YzJjZTM4MjI0YjUyNDA3YzFlNzU5M2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABditq6yAH2gAyNTMyMjE5ODMwOjY5YjhmYmYwZTA3OTBmZTMwMWU4NzI3ZjI0ZjBjNjNmM2U1Yjc1MGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2592e382f53b53058c2ce38224b52407c1e7593a", "author": {"user": {"login": "DrewDennison", "name": "Drew Dennison"}}, "url": "https://github.com/returntocorp/semgrep/commit/2592e382f53b53058c2ce38224b52407c1e7593a", "committedDate": "2020-12-04T01:13:07Z", "message": "Update pattern_match.py"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NTk2MzU4", "url": "https://github.com/returntocorp/semgrep/pull/2182#pullrequestreview-544596358", "createdAt": "2020-12-04T01:39:13Z", "commit": {"oid": "2592e382f53b53058c2ce38224b52407c1e7593a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMTozOToxM1rOH-88mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMTozOToxM1rOH-88mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc3MjMxMw==", "bodyText": "Can you leave a comment explaining what this does and why it's needed?", "url": "https://github.com/returntocorp/semgrep/pull/2182#discussion_r535772313", "createdAt": "2020-12-04T01:39:13Z", "author": {"login": "nbrahms"}, "path": "semgrep/semgrep/pattern_match.py", "diffHunk": "@@ -75,7 +75,7 @@ def get_metavariable_value(self, metavariable: str) -> str:\n         end_offset = self.metavars[metavariable][\"end\"][\"offset\"]\n         length = end_offset - start_offset\n \n-        with open(self.path) as file:\n+        with open(self.path, errors='replace') as file:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2592e382f53b53058c2ce38224b52407c1e7593a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69b8fbf0e0790fe301e8727f24f0c63f3e5b750d", "author": {"user": {"login": "DrewDennison", "name": "Drew Dennison"}}, "url": "https://github.com/returntocorp/semgrep/commit/69b8fbf0e0790fe301e8727f24f0c63f3e5b750d", "committedDate": "2020-12-04T01:43:16Z", "message": "Update pattern_match.py"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 901, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}