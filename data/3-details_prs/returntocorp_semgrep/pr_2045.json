{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwOTM3MTU0", "number": 2045, "title": "Set default timeout of 30 seconds on semgrep-core calls from semgrep", "bodyText": "This is instead of no timeout.\nI don't know why pytest hangs for me during tests/e2e/test_semgrep_rules_repo.py. Let's see if the same thing happens in CI.\nWorks around #1981", "createdAt": "2020-11-14T01:48:47Z", "url": "https://github.com/returntocorp/semgrep/pull/2045", "merged": true, "mergeCommit": {"oid": "7b4d0556d69a9e9c9ba75e65f31662d21dad597b"}, "closed": true, "closedAt": "2020-11-18T08:36:40Z", "author": {"login": "mjambon"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddGhPxgFqTUzMTQxNzY5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddm32VABqjQwMDg3Mzc0ODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNDE3Njk5", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-531417699", "createdAt": "2020-11-16T15:16:42Z", "commit": {"oid": "c6a0c1380ce02c77551473918280c4b339211454"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNToxNjo0MlrOH0DZIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNToxNjo0MlrOH0DZIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM0MzU4Nw==", "bodyText": "Weird that you have to specify the default value here and in the main() function in semgrep_main.py\n@nbrahms some Python tricks to avoid the duplication?", "url": "https://github.com/returntocorp/semgrep/pull/2045#discussion_r524343587", "createdAt": "2020-11-16T15:16:42Z", "author": {"login": "aryx"}, "path": "semgrep/semgrep/cli.py", "diffHunk": "@@ -159,9 +160,9 @@ def cli() -> None:\n     config.add_argument(\n         \"--timeout\",\n         type=int,\n-        default=0,\n+        default=DEFAULT_TIMEOUT,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0c1380ce02c77551473918280c4b339211454"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNjIyNjk2", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-531622696", "createdAt": "2020-11-16T19:07:26Z", "commit": {"oid": "c6a0c1380ce02c77551473918280c4b339211454"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNjIzMDE4", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-531623018", "createdAt": "2020-11-16T19:07:53Z", "commit": {"oid": "c6a0c1380ce02c77551473918280c4b339211454"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTowNzo1M1rOH0NYVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTowNzo1M1rOH0NYVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDUwNzIyMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            DEFAULT_TIMEOUT = 5  # seconds\n          \n          \n            \n            DEFAULT_TIMEOUT = 30  # seconds", "url": "https://github.com/returntocorp/semgrep/pull/2045#discussion_r524507222", "createdAt": "2020-11-16T19:07:53Z", "author": {"login": "DrewDennison"}, "path": "semgrep/semgrep/constants.py", "diffHunk": "@@ -17,6 +17,8 @@\n DEFAULT_CONFIG_FILE = f\".{DEFAULT_SEMGREP_CONFIG_NAME}.yml\"\n DEFAULT_CONFIG_FOLDER = f\".{DEFAULT_SEMGREP_CONFIG_NAME}\"\n \n+DEFAULT_TIMEOUT = 5  # seconds", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0c1380ce02c77551473918280c4b339211454"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24a8399daeeb6018c42c053fd91c5651d0916701", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/24a8399daeeb6018c42c053fd91c5651d0916701", "committedDate": "2020-11-16T19:12:53Z", "message": "Increase default timeout to 30 seconds (per file)\n\nCo-authored-by: Drew Dennison <drew@returntocorp.com>"}, "afterCommit": {"oid": "fd664a2f805af1a5696e1c66bdfeb492ae206e16", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/fd664a2f805af1a5696e1c66bdfeb492ae206e16", "committedDate": "2020-11-16T19:28:14Z", "message": "Update changelog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNjUzNzU2", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-531653756", "createdAt": "2020-11-16T19:50:33Z", "commit": {"oid": "fd664a2f805af1a5696e1c66bdfeb492ae206e16"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTo1MDozM1rOH0O2yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTo1MDozM1rOH0O2yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDUzMTQwMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"Maximum time to spend running a rule on a single file in seconds. If set to 0 will not have time limit. Defaults to {} s.\".format(DEFAULT_TIMEOUT)\n          \n          \n            \n                        f\"Maximum time to spend running a rule on a single file in seconds. If set to 0 will not have time limit. Defaults to {DEFAULT_TIMEOUT} s.\"", "url": "https://github.com/returntocorp/semgrep/pull/2045#discussion_r524531402", "createdAt": "2020-11-16T19:50:33Z", "author": {"login": "brendongo"}, "path": "semgrep/semgrep/cli.py", "diffHunk": "@@ -159,9 +160,9 @@ def cli() -> None:\n     config.add_argument(\n         \"--timeout\",\n         type=int,\n-        default=0,\n+        default=DEFAULT_TIMEOUT,\n         help=(\n-            \"Maximum time to spend running a rule on a single file in seconds. If set to 0 will not have time limit. Defaults to 0.\"\n+            \"Maximum time to spend running a rule on a single file in seconds. If set to 0 will not have time limit. Defaults to {} s.\".format(DEFAULT_TIMEOUT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd664a2f805af1a5696e1c66bdfeb492ae206e16"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNjU0MTA0", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-531654104", "createdAt": "2020-11-16T19:51:03Z", "commit": {"oid": "fd664a2f805af1a5696e1c66bdfeb492ae206e16"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTo1MTowNFrOH0O34A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxOTo1MTowNFrOH0O34A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDUzMTY4MA==", "bodyText": "Should go under # Next not 0.31.1", "url": "https://github.com/returntocorp/semgrep/pull/2045#discussion_r524531680", "createdAt": "2020-11-16T19:51:04Z", "author": {"login": "brendongo"}, "path": "CHANGELOG.md", "diffHunk": "@@ -6,6 +6,10 @@ This project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html\n \n ## [0.31.1](https://github.com/returntocorp/semgrep/releases/tag/v0.31.1) - 2020-11-11\n \n+### Changed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd664a2f805af1a5696e1c66bdfeb492ae206e16"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b008a475dc229d70ab2c6729d001701e89719a8e", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/b008a475dc229d70ab2c6729d001701e89719a8e", "committedDate": "2020-11-16T19:55:55Z", "message": "Honor timeout for spacegrep calls"}, "afterCommit": {"oid": "057c3f09f20840471a053db559892bc75e8a17ca", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/057c3f09f20840471a053db559892bc75e8a17ca", "committedDate": "2020-11-16T19:56:23Z", "message": "Honor timeout for spacegrep calls.\nFixes https://github.com/returntocorp/semgrep/issues/2046"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12d61c2044feb7e7c5880d9ef476667e7bb15877", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/12d61c2044feb7e7c5880d9ef476667e7bb15877", "committedDate": "2020-11-16T20:03:31Z", "message": "Improve python style\n\nCo-authored-by: Brendon Go <brendon.go@gmail.com>"}, "afterCommit": {"oid": "661e1030cc560a6ef066a42aca1bd642db8a1828", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/661e1030cc560a6ef066a42aca1bd642db8a1828", "committedDate": "2020-11-18T03:12:59Z", "message": "Fix changelog order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6cfb3cab50667be4dcbc3f82585658ee860cf8c0", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/6cfb3cab50667be4dcbc3f82585658ee860cf8c0", "committedDate": "2020-11-18T04:29:20Z", "message": "Two tests on minified files now succeed, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}, "afterCommit": {"oid": "028f4e1e74ad88c7e409e51f0aee3595aba61d14", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/028f4e1e74ad88c7e409e51f0aee3595aba61d14", "committedDate": "2020-11-18T04:31:47Z", "message": "Two tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "028f4e1e74ad88c7e409e51f0aee3595aba61d14", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/028f4e1e74ad88c7e409e51f0aee3595aba61d14", "committedDate": "2020-11-18T04:31:47Z", "message": "Two tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}, "afterCommit": {"oid": "bb5e11348590b08f5bc0d7443525bc0d4032546b", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/bb5e11348590b08f5bc0d7443525bc0d4032546b", "committedDate": "2020-11-18T04:42:39Z", "message": "Two tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMTAxMjE2", "url": "https://github.com/returntocorp/semgrep/pull/2045#pullrequestreview-533101216", "createdAt": "2020-11-18T04:46:29Z", "commit": {"oid": "bb5e11348590b08f5bc0d7443525bc0d4032546b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb5e11348590b08f5bc0d7443525bc0d4032546b", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/bb5e11348590b08f5bc0d7443525bc0d4032546b", "committedDate": "2020-11-18T04:42:39Z", "message": "Two tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}, "afterCommit": {"oid": "6e55d5ff0abc0cac5ec0ef577921cec905e57cfb", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/6e55d5ff0abc0cac5ec0ef577921cec905e57cfb", "committedDate": "2020-11-18T04:53:33Z", "message": "Set default timeout of 5 seconds on semgrep-core calls from semgrep\ninstead of no timeout.\n\nIncrease default timeout to 30 seconds (per file)\n\nCo-authored-by: Drew Dennison <drew@returntocorp.com>\n\nUpdate changelog\n\nHonor timeout for spacegrep calls.\nFixes https://github.com/returntocorp/semgrep/issues/2046\n\nFix changelog order\n\nTwo tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85c5600e5deb7c4153d58605ff74801933a0d9c6", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/85c5600e5deb7c4153d58605ff74801933a0d9c6", "committedDate": "2020-11-18T04:58:13Z", "message": "Set default timeout of 5 seconds on semgrep-core calls from semgrep\ninstead of no timeout.\n\nIncrease default timeout to 30 seconds (per file)\n\nCo-authored-by: Drew Dennison <drew@returntocorp.com>\n\nUpdate changelog\n\nHonor timeout for spacegrep calls.\nFixes https://github.com/returntocorp/semgrep/issues/2046\n\nFix changelog order\n\nTwo tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e55d5ff0abc0cac5ec0ef577921cec905e57cfb", "author": {"user": null}, "url": "https://github.com/returntocorp/semgrep/commit/6e55d5ff0abc0cac5ec0ef577921cec905e57cfb", "committedDate": "2020-11-18T04:53:33Z", "message": "Set default timeout of 5 seconds on semgrep-core calls from semgrep\ninstead of no timeout.\n\nIncrease default timeout to 30 seconds (per file)\n\nCo-authored-by: Drew Dennison <drew@returntocorp.com>\n\nUpdate changelog\n\nHonor timeout for spacegrep calls.\nFixes https://github.com/returntocorp/semgrep/issues/2046\n\nFix changelog order\n\nTwo tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}, "afterCommit": {"oid": "85c5600e5deb7c4153d58605ff74801933a0d9c6", "author": {"user": {"login": "mjambon", "name": "Martin Jambon"}}, "url": "https://github.com/returntocorp/semgrep/commit/85c5600e5deb7c4153d58605ff74801933a0d9c6", "committedDate": "2020-11-18T04:58:13Z", "message": "Set default timeout of 5 seconds on semgrep-core calls from semgrep\ninstead of no timeout.\n\nIncrease default timeout to 30 seconds (per file)\n\nCo-authored-by: Drew Dennison <drew@returntocorp.com>\n\nUpdate changelog\n\nHonor timeout for spacegrep calls.\nFixes https://github.com/returntocorp/semgrep/issues/2046\n\nFix changelog order\n\nTwo tests on minified files now pass, presumably because of the new\n30s timeout and because a timeout doesn't result in a failure."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 853, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}