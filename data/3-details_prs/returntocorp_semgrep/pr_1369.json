{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MTMxNjc2", "number": 1369, "title": "Use -timeout for the matching process and improve debugging experience", "bodyText": "", "createdAt": "2020-07-27T12:29:28Z", "url": "https://github.com/returntocorp/semgrep/pull/1369", "merged": true, "mergeCommit": {"oid": "8f8a0811a069d2de3cad9253df5c08a42092c2bf"}, "closed": true, "closedAt": "2020-07-28T06:44:13Z", "author": {"login": "aryx"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5AuzMgH2gAyNDU3MTMxNjc2OjJiNDJlZjU2M2I2YjIxODYzYjBkZTJkNDQwNzNlMzY0ZTAxZTQ1N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5GEJ4AFqTQ1NjAyODI5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b42ef563b6b21863b0de2d44073e364e01e457f", "author": {"user": {"login": "aryx", "name": "Yoann Padioleau"}}, "url": "https://github.com/returntocorp/semgrep/commit/2b42ef563b6b21863b0de2d44073e364e01e457f", "committedDate": "2020-07-27T12:10:53Z", "message": "Timeout not only on parsing but also matching!\n\nthis should help issue #1361\n\nTest plan:\n\npad@yrax:~/semgrep/tests/PERF$ time yy -timeout 3 -lang js -rules_file ajin2_semgrepcore.yaml three.js\n+ /home/pad/github/semgrep/semgrep-core/_build/default/bin/Main.exe -timeout 3 -lang js -rules_file ajin2_semgrepcore.yaml three.js\n{\n  \"matches\": [],\n  \"errors\": [\n    {\n      \"check_id\": \"Timeout\",\n      \"path\": \"three.js\",\n      \"start\": { \"line\": 1, \"col\": 1 },\n      \"end\": { \"line\": 1, \"col\": 1 },\n      \"extra\": { \"message\": \"Timeout\", \"line\": \"/**\" }\n    }\n  ],\n  \"stats\": { \"okfiles\": 0, \"errorfiles\": 1 }\n}\n\nreal\t0m3.366s\nuser\t0m2.999s\nsys\t0m0.353s"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c395240a184663fc581717e90ea1668d84476b6", "author": {"user": {"login": "aryx", "name": "Yoann Padioleau"}}, "url": "https://github.com/returntocorp/semgrep/commit/0c395240a184663fc581717e90ea1668d84476b6", "committedDate": "2020-07-27T12:28:09Z", "message": "add new SEMGREP_CORE_EXTRA environment variable\n\nIt can be difficult to debug semgrep-core when called from semgrep.\nThis diff adds the option to add extra argument to the invocation\nof semgrep_core from anywhere (especially from the semgrep python wrapper)\nto turn on and off semgrep core flags (especially debugging flags).\n\nTest plan:\nyou need to modify core_runner.py which does not yet support\nthe -no-redirect-stderr option and write\n  core_run = sub_run(cmd, stdout=subprocess.PIPE\n\nthen:\n\n(semgrep) pad@yrax:~/semgrep/tests/PERF$ export SEMGREP_CORE_EXTRA='-max_memory 1 -timeout 3 -debug'\n(semgrep) pad@yrax:~/semgrep/tests/PERF$ semgrep -f ajin2.yaml three.js\nrunning 2 rules...\n  0%|                                                                                                                                                    |0/2Debug mode On\nExecuted as: semgrep-core -lang javascript -rules_file /tmp/tmpdi_o9tzg -j 8 -target_file /tmp/tmp_kwylvia -use_parsing_cache /tmp/tmpagptv9io\nPARSING: three.js\nreturned JSON: {\n  \"matches\": [],\n  \"errors\": [\n    {\n      \"check_id\": \"OutOfMemory\",\n      \"path\": \"three.js\",\n      \"start\": { \"line\": 1, \"col\": 1 },\n      \"end\": { \"line\": 1, \"col\": 1 },\n      \"extra\": { \"message\": \"Out of memory\", \"line\": \"/**\" }\n    }\n  ],\n  \"stats\": { \"okfiles\": 0, \"errorfiles\": 1 }\n}\n..."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5f01f0495611475fb5c5a42163e1c613faa434e", "author": {"user": {"login": "aryx", "name": "Yoann Padioleau"}}, "url": "https://github.com/returntocorp/semgrep/commit/c5f01f0495611475fb5c5a42163e1c613faa434e", "committedDate": "2020-07-27T12:45:44Z", "message": "Remove -verbose, consistently use -debug\n\nYou are not supposed to call semgrep-core directly, so any extra\ninformation is really about helping the debugging the process, not\nabout improving the output.\n\nTest plan:\nmeh"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDI4Mjk4", "url": "https://github.com/returntocorp/semgrep/pull/1369#pullrequestreview-456028298", "createdAt": "2020-07-27T18:23:44Z", "commit": {"oid": "c5f01f0495611475fb5c5a42163e1c613faa434e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxODoyMzo0NFrOG3uTcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxODoyMzo0NFrOG3uTcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA4MzUwNA==", "bodyText": "is it a flag? a mode to run the test suite? what is its semantic effect? perhaps a more descriptive name would be helpful", "url": "https://github.com/returntocorp/semgrep/pull/1369#discussion_r461083504", "createdAt": "2020-07-27T18:23:44Z", "author": {"login": "ievans"}, "path": "semgrep-core/bin/Main.ml", "diffHunk": "@@ -55,16 +55,16 @@ module J = Json_type\n let env_debug = \"SEMGREP_CORE_DEBUG\"\n let env_profile = \"SEMGREP_CORE_PROFILE\"\n \n+(* see also verbose/... flags in Flag_semgrep.ml *)\n+(* to test things *)\n+let test = ref false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5f01f0495611475fb5c5a42163e1c613faa434e"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1373, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}