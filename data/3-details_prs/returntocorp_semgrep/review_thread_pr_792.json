{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMzIyNzA3", "number": 792, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTozODo1OFrOD98fPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTo0ODo0MFrOD98r3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjgwNzY0OnYy", "diffSide": "RIGHT", "path": "semgrep/tests/qa/rules/regex-sentinel.yaml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTozODo1OFrOGXvxeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTozODo1OFrOGXvxeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1MzE0NQ==", "bodyText": "aww my lil number working his way into everyone's hearts \ud83d\ude0a", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427553145", "createdAt": "2020-05-19T19:38:58Z", "author": {"login": "underyx"}, "path": "semgrep/tests/qa/rules/regex-sentinel.yaml", "diffHunk": "@@ -0,0 +1,7 @@\n+rules:\n+  - id: test-regex\n+    patterns:\n+      - pattern-regex: '. = 87518275812375164'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjgxNDY1OnYy", "diffSide": "RIGHT", "path": "semgrep/tests/qa/test_public_repos.py", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTo0MTowMFrOGXv14g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTo0NTo1MVrOGXwADA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NDI3NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"--config=rules/regex-sentinel.yaml\",\n          \n          \n            \n                        \"--config\",\n          \n          \n            \n                        Path(TESTS_PATH / \"qa\" / \"rules\" / \"regex-sentinel.yaml\").resolve(),\n          \n      \n    \n    \n  \n\nwouldn't this work? then we wouldn't need to mess with tmp paths above.", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427554274", "createdAt": "2020-05-19T19:41:00Z", "author": {"login": "underyx"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -109,3 +114,19 @@ def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n         assert output[\"errors\"] == []\n         assert len(output[\"results\"]) == 1\n         assert output[\"results\"][0][\"path\"] == str(sentinel_path)\n+\n+    output = subprocess.check_output(\n+        [\n+            \"python3\",\n+            \"-m\",\n+            \"semgrep\",\n+            \"--config=rules/regex-sentinel.yaml\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NTI0NQ==", "bodyText": "I think you need to wrap with str(...)", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427555245", "createdAt": "2020-05-19T19:42:47Z", "author": {"login": "DrewDennison"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -109,3 +114,19 @@ def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n         assert output[\"errors\"] == []\n         assert len(output[\"results\"]) == 1\n         assert output[\"results\"][0][\"path\"] == str(sentinel_path)\n+\n+    output = subprocess.check_output(\n+        [\n+            \"python3\",\n+            \"-m\",\n+            \"semgrep\",\n+            \"--config=rules/regex-sentinel.yaml\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NDI3NA=="}, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NTYwMw==", "bodyText": "nope, subprocess functions accept Path", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427555603", "createdAt": "2020-05-19T19:43:28Z", "author": {"login": "underyx"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -109,3 +114,19 @@ def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n         assert output[\"errors\"] == []\n         assert len(output[\"results\"]) == 1\n         assert output[\"results\"][0][\"path\"] == str(sentinel_path)\n+\n+    output = subprocess.check_output(\n+        [\n+            \"python3\",\n+            \"-m\",\n+            \"semgrep\",\n+            \"--config=rules/regex-sentinel.yaml\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NDI3NA=="}, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1Njg3Ng==", "bodyText": "Ah, now I see that most of the tmp_path lines would need to stay anyway cause we got rid of the run_semgrep_in_tmp fixture which would normally set it up.", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427556876", "createdAt": "2020-05-19T19:45:51Z", "author": {"login": "underyx"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -109,3 +114,19 @@ def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n         assert output[\"errors\"] == []\n         assert len(output[\"results\"]) == 1\n         assert output[\"results\"][0][\"path\"] == str(sentinel_path)\n+\n+    output = subprocess.check_output(\n+        [\n+            \"python3\",\n+            \"-m\",\n+            \"semgrep\",\n+            \"--config=rules/regex-sentinel.yaml\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NDI3NA=="}, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjgzOTk3OnYy", "diffSide": "RIGHT", "path": "semgrep/tests/qa/test_public_repos.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxOTo0ODo0MFrOGXwGCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDowOTo0N1rOGXwyZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1ODQxMQ==", "bodyText": "Not really sure what's going on with all this path stuff - I trust @underyx's thoughts \ud83d\udc4d", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427558411", "createdAt": "2020-05-19T19:48:40Z", "author": {"login": "mschwager"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -60,7 +60,12 @@ def xfail_repo(url, *, reason=None):\n         ),\n     ],\n )\n-def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n+def test_semgrep_on_repo(monkeypatch, tmp_path, repo_url):\n+    TESTS_PATH = Path(__file__).parent.parent", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU2OTc2NA==", "bodyText": "it's just replicating the code from run_semgrep_in_tmp fixture, we good \ud83d\ude07", "url": "https://github.com/returntocorp/semgrep/pull/792#discussion_r427569764", "createdAt": "2020-05-19T20:09:47Z", "author": {"login": "underyx"}, "path": "semgrep/tests/qa/test_public_repos.py", "diffHunk": "@@ -60,7 +60,12 @@ def xfail_repo(url, *, reason=None):\n         ),\n     ],\n )\n-def test_semgrep_on_repo(run_semgrep_in_tmp, repo_url):\n+def test_semgrep_on_repo(monkeypatch, tmp_path, repo_url):\n+    TESTS_PATH = Path(__file__).parent.parent", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1ODQxMQ=="}, "originalCommit": {"oid": "4b5886c2cbae2cbb673010f7edca856904f216df"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4722, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}