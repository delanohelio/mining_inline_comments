{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyNzkwNzU3", "number": 972, "title": "Added some niceties to indicate what semgrep is about to do.", "bodyText": "Added in a message indicating how many rules will be run.\n- Added 'progress dots' while semgrep scans code.\nAdded a message that semgrep found no results if there are no results.", "createdAt": "2020-06-11T01:47:32Z", "url": "https://github.com/returntocorp/semgrep/pull/972", "merged": true, "mergeCommit": {"oid": "f1b60620f2ac3b9eb5fd496462ac278994d8430a"}, "closed": true, "closedAt": "2020-06-12T22:16:08Z", "author": {"login": "minusworld"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqEO9uAH2gAyNDMyNzkwNzU3OjBkNTA0NGRiNzhhNzM5YzNlNTczZTMyODExZWY4Zjc2MTA1YzAzNDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqote5gH2gAyNDMyNzkwNzU3OmZmZDVkMGIwZmJlZTIxMTVjODZiNTI0OWU0NGEwYmExODViMDU3ZmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d5044db78a739c3e573e32811ef8f76105c0349", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/0d5044db78a739c3e573e32811ef8f76105c0349", "committedDate": "2020-06-11T01:46:52Z", "message": "Added some niceties to indicate to the user that Semgrep is doing work.\n- Added in a message indicating how many rules will be run.\n- Added 'progress dots' while semgrep scans code.\n- Added a message that semgrep found no results if there are no results."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "915f421cdead89085bedabaeb4ed1b310ab610f5", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/915f421cdead89085bedabaeb4ed1b310ab610f5", "committedDate": "2020-06-11T01:49:01Z", "message": "Merge branch 'develop' into cli-communication-updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c36b4e075d6649dcb9d5d17a733e165af3c86d94", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/c36b4e075d6649dcb9d5d17a733e165af3c86d94", "committedDate": "2020-06-11T19:32:37Z", "message": "Updated StoppableProgressWriter to use a spinner instead of a continuous stream of dots. It also includes an accompanying message for elapsed time."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "584adcb58adee722c5bfbd9fb459e727a091a07b", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/584adcb58adee722c5bfbd9fb459e727a091a07b", "committedDate": "2020-06-11T20:38:26Z", "message": "use isatty() instead of isatty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d76c893ea0af8e1ab10f1fb2597fdae3dca76121", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/d76c893ea0af8e1ab10f1fb2597fdae3dca76121", "committedDate": "2020-06-11T20:42:31Z", "message": "Placate no-mutable-default-args"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MzAyNjUx", "url": "https://github.com/returntocorp/semgrep/pull/972#pullrequestreview-429302651", "createdAt": "2020-06-11T21:31:21Z", "commit": {"oid": "d76c893ea0af8e1ab10f1fb2597fdae3dca76121"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMTozMToyMVrOGivZWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMTozMToyMVrOGivZWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA4MTMwNA==", "bodyText": "Can drop this comment since we're no longer using dots, and the class/function names are descriptive enough we probably don't need the comments anyway.", "url": "https://github.com/returntocorp/semgrep/pull/972#discussion_r439081304", "createdAt": "2020-06-11T21:31:21Z", "author": {"login": "mschwager"}, "path": "semgrep/semgrep/semgrep_main.py", "diffHunk": "@@ -277,21 +315,32 @@ def main(\n             f\"running {len(all_rules)} rules from {len(valid_configs)} config{plural} {config_id_if_single} {invalid_msg}\"\n         )\n \n+        notify_user_of_work(all_rules, include, include_dir, exclude, exclude_dir)\n+\n         if len(valid_configs) == 0:\n             raise SemgrepError(\n                 f\"no valid configuration file found ({len(invalid_configs)} configs were invalid)\",\n                 code=MISSING_CONFIG_EXIT_CODE,\n             )\n \n-    # actually invoke semgrep\n-    rule_matches_by_rule, debug_steps_by_rule, semgrep_errors = CoreRunner(\n-        allow_exec=dangerously_allow_arbitrary_code_execution_from_rules,\n-        jobs=jobs,\n-        exclude=exclude,\n-        include=include,\n-        exclude_dir=exclude_dir,\n-        include_dir=include_dir,\n-    ).invoke_semgrep(targets, all_rules)\n+    # Start a progress writer. This will print dots until .stop() is called.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d76c893ea0af8e1ab10f1fb2597fdae3dca76121"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "519fc8f74384a8e76345de156fe53cf10c10bced", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/519fc8f74384a8e76345de156fe53cf10c10bced", "committedDate": "2020-06-11T21:54:04Z", "message": "Add isatty check in .stop() to keep it from outputting in this case as well."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5235aa65faabe883bd83a4ca768e8ddf2af30d8", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/b5235aa65faabe883bd83a4ca768e8ddf2af30d8", "committedDate": "2020-06-11T23:07:11Z", "message": "Update qa tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e404f2c04512ffe9e6ee9a161820da1229ff8bfa", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/e404f2c04512ffe9e6ee9a161820da1229ff8bfa", "committedDate": "2020-06-11T23:33:31Z", "message": "Merge remote-tracking branch 'origin' into cli-communication-updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5132dcf22a000f15b7e89457de520cef83f8235e", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/5132dcf22a000f15b7e89457de520cef83f8235e", "committedDate": "2020-06-12T00:22:48Z", "message": "Add filter for semgrep.live config URLs to allow clicking through to the display page instead of raw YAML"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d36bd3cd6f15f0de08ceb65a0048bf6a62a0c0f", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/1d36bd3cd6f15f0de08ceb65a0048bf6a62a0c0f", "committedDate": "2020-06-12T00:23:28Z", "message": "Remove StoppableProgressWriter in favor of a solution incorporating https://github.com/returntocorp/semgrep/pull/946"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2be8df2fad248e5112aa0993712ee7778d8eea5c", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/2be8df2fad248e5112aa0993712ee7778d8eea5c", "committedDate": "2020-06-12T00:34:05Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5OTQ4MDA5", "url": "https://github.com/returntocorp/semgrep/pull/972#pullrequestreview-429948009", "createdAt": "2020-06-12T18:17:50Z", "commit": {"oid": "2be8df2fad248e5112aa0993712ee7778d8eea5c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd16dc116572758f972c7df9769c910d75bf0dd8", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/dd16dc116572758f972c7df9769c910d75bf0dd8", "committedDate": "2020-06-12T19:41:21Z", "message": "Fix conflicts with develop after output_handler refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffd5d0b0fbee2115c86b5249e44a0ba185b057fb", "author": {"user": {"login": "minusworld", "name": "Grayson H"}}, "url": "https://github.com/returntocorp/semgrep/commit/ffd5d0b0fbee2115c86b5249e44a0ba185b057fb", "committedDate": "2020-06-12T20:16:47Z", "message": "Regen test snapshots"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1529, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}