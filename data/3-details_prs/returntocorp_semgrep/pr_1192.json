{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNTk5MTc3", "number": 1192, "title": "Fix #1191, #438, use '/src' as Docker code volume", "bodyText": "Trying the old directory:\n$ docker run --rm -v \"${PWD}:/home/repo\" returntocorp/semgrep:develop --config semgrep-local.yaml semgrep/setup.py\nDetected Docker environment using old code volume, please use '/src' instead of '/home/repo'\n\nSpeedup:\n$ time docker run --rm -v \"${PWD}:/src\" returntocorp/semgrep:develop --config semgrep-local.yaml semgrep/setup.py\nrunning 1 rules...\n\nreal\t0m2.239s\nuser\t0m0.041s\nsys\t0m0.049s\n\n$ time docker run --rm -v \"${PWD}:/src\" returntocorp/semgrep:develop --config semgrep-local.yaml semgrep/setup.py\nrunning 1 rules...\n\nreal\t0m1.456s\nuser\t0m0.050s\nsys\t0m0.040s", "createdAt": "2020-07-02T15:39:16Z", "url": "https://github.com/returntocorp/semgrep/pull/1192", "merged": true, "mergeCommit": {"oid": "41774067786783f28c6ff70c985ef21da73c7c3f"}, "closed": true, "closedAt": "2020-07-07T21:26:48Z", "author": {"login": "mschwager"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxAqN4gH2gAyNDQzNTk5MTc3OmZlMDNhNTIyNWE4OGVkZmVjZmRhZGM2MTQxN2JmNmQ4NDY0YzFiODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcy-Vy8gFqTQ0NTAwNDk2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fe03a5225a88edfecfdadc61417bf6d8464c1b82", "author": {"user": {"login": "mschwager", "name": null}}, "url": "https://github.com/returntocorp/semgrep/commit/fe03a5225a88edfecfdadc61417bf6d8464c1b82", "committedDate": "2020-07-02T15:34:29Z", "message": "Fix #1191, #438, use '/src' as Docker code volume"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MjUyNjIw", "url": "https://github.com/returntocorp/semgrep/pull/1192#pullrequestreview-444252620", "createdAt": "2020-07-07T21:10:47Z", "commit": {"oid": "fe03a5225a88edfecfdadc61417bf6d8464c1b82"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MDA0OTYy", "url": "https://github.com/returntocorp/semgrep/pull/1192#pullrequestreview-445004962", "createdAt": "2020-07-08T17:58:55Z", "commit": {"oid": "fe03a5225a88edfecfdadc61417bf6d8464c1b82"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNzo1ODo1NVrOGuzT2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNzo1OTo1NVrOGuzWIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcyODM0NQ==", "bodyText": "we should just symlink for now and warn?", "url": "https://github.com/returntocorp/semgrep/pull/1192#discussion_r451728345", "createdAt": "2020-07-08T17:58:55Z", "author": {"login": "DrewDennison"}, "path": "semgrep/semgrep/config_resolver.py", "diffHunk": "@@ -72,17 +73,19 @@ def resolve_targets(targets: List[str]) -> List[Path]:\n     ]\n \n \n-def adjust_for_docker(in_precommit: bool = False) -> None:\n-    repo_home = REPO_HOME_DOCKER_PRECOMMIT if in_precommit else REPO_HOME_DOCKER\n-\n+def adjust_for_docker() -> None:\n     # change into this folder so that all paths are relative to it\n     if IN_DOCKER and not IN_GH_ACTION:\n-        if not Path(repo_home).exists():\n+        if OLD_SRC_DIRECTORY.exists():\n+            raise SemgrepError(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe03a5225a88edfecfdadc61417bf6d8464c1b82"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcyODkyOA==", "bodyText": "hmm I would be surprised if a tool dropped files in my home folder. I would expect /tmp", "url": "https://github.com/returntocorp/semgrep/pull/1192#discussion_r451728928", "createdAt": "2020-07-08T17:59:55Z", "author": {"login": "DrewDennison"}, "path": "semgrep/semgrep/version.py", "diffHunk": "@@ -21,8 +21,7 @@\n )\n VERSION_CACHE_PATH = Path(\n     os.environ.get(\n-        \"SEMGREP_VERSION_CACHE_PATH\",\n-        Path(os.path.expanduser(\"~\")) / \".cache\" / \"semgrep_version\",\n+        \"SEMGREP_VERSION_CACHE_PATH\", Path.home() / \".cache\" / \"semgrep_version\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe03a5225a88edfecfdadc61417bf6d8464c1b82"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1458, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}