{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MzYzNjQ0", "number": 2996, "title": "Clustering dialog choices limit & performance improvements - fixes #695", "bodyText": "Fixes #695\n\nCaps the total number of choices displayed at 10,000 and warns when over the limit. Users can use facets to tune which clusters are displayed.\nDoubles the performance of the Javascript processing\nOnly displays count of rows for a choice if it's > 1 to DOM elements\nAdds internationalization for row count\n\nFor 41K clusters containing 118K choices, processing dropped from 3m20s to 1m20s, but with the 10K choice cap total time is ~10sec.", "createdAt": "2020-07-27T19:41:47Z", "url": "https://github.com/OpenRefine/OpenRefine/pull/2996", "merged": true, "mergeCommit": {"oid": "0ebd89c952ef6f57b716d62ceb75a271bb1c0100"}, "closed": true, "closedAt": "2020-08-01T08:59:42Z", "author": {"login": "tfmorris"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5HDHLAH2gAyNDU3MzYzNjQ0OjI4Y2Q0YjE3Y2RhN2M5NWEzY2FlNmRjNGFkMWRlNmZiYmY5MGMyMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6k_dNgFqTQ1OTU2NTM3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "28cd4b17cda7c95a3cae6dc4ad1de6fbbf90c22a", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/28cd4b17cda7c95a3cae6dc4ad1de6fbbf90c22a", "committedDate": "2020-07-27T19:32:30Z", "message": "Clustering dialog choices limit & performance improvements - fixes #695\n\nFixes #695\n- Caps the total number of choices displayed at 10,000 and warns when\n  over the limit. Users can use facets to tune which clusters are displayed.\n- Doubles the performance of the Javascript processing\n- Only displays count of rows for a choice if it's > 1 to DOM elements\n- Adds internationalization for row count\n\nFor 41K clusters containing 118K choices, processing dropped from\n3m20s to 1m20s, but with the 10K choice cap total time is ~10sec."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fbf353225b0f7abc63eef8bfc3b93c131add49d", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/2fbf353225b0f7abc63eef8bfc3b93c131add49d", "committedDate": "2020-07-27T20:00:13Z", "message": "Restore even/odd row class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2ODYwNzcw", "url": "https://github.com/OpenRefine/OpenRefine/pull/2996#pullrequestreview-456860770", "createdAt": "2020-07-28T17:37:20Z", "commit": {"oid": "2fbf353225b0f7abc63eef8bfc3b93c131add49d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNzozNzoyMFrOG4XV8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNzozNzoyMFrOG4XV8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc1NTg5MA==", "bodyText": "@wetneb If you want to experiment with the number of rows that your machine can handle, the limit is set here", "url": "https://github.com/OpenRefine/OpenRefine/pull/2996#discussion_r461755890", "createdAt": "2020-07-28T17:37:20Z", "author": {"login": "tfmorris"}, "path": "main/webapp/modules/core/scripts/dialogs/clustering-dialog.js", "diffHunk": "@@ -256,23 +272,28 @@ ClusteringDialog.prototype._renderTable = function(clusters) {\n                 editCheck.attr(\"checked\", \"true\");\n             }\n \n-            var input = $('<input type=\"text\" size=\"25\" />')\n+            $('<input type=\"text\" size=\"25\" />')\n                 .attr(\"value\", cluster.value)\n                 .bind(\"keyup change input\",function() {\n                     cluster.value = this.value;\n                 }).appendTo(tr.insertCell(4));\n+\n+            return choices.length;\n         };\n \n-        for (var i = 0; i < clusters.length; i++) {\n-            renderCluster(clusters[i]);\n+        var maxRenderRows = 10000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fbf353225b0f7abc63eef8bfc3b93c131add49d"}, "originalPosition": 110}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "committedDate": "2020-07-29T19:55:22Z", "message": "Updates from review feedback"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5af748e4f693b857daebffa99c321efe7cffff99", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/5af748e4f693b857daebffa99c321efe7cffff99", "committedDate": "2020-07-29T19:47:48Z", "message": "Updates from review feedback"}, "afterCommit": {"oid": "0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "committedDate": "2020-07-29T19:55:22Z", "message": "Updates from review feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTY1Mzcw", "url": "https://github.com/OpenRefine/OpenRefine/pull/2996#pullrequestreview-459565370", "createdAt": "2020-08-01T08:59:35Z", "commit": {"oid": "0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3079, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}