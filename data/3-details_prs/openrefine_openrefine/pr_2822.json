{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzA1OTAz", "number": 2822, "title": "Add constraint class", "bodyText": "Added constraint class that can be used as a superclass for the inner class in most of the scrutinizers.", "createdAt": "2020-06-26T17:34:43Z", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822", "merged": true, "mergeCommit": {"oid": "1b04927d1252a165d6382372451ca597b7d8479b"}, "closed": true, "closedAt": "2020-06-28T08:20:19Z", "author": {"login": "darecoder"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvG3vNAH2gAyNDQwNzA1OTAzOjY2MWQzMjIzY2ZlM2IxYjY3MDhiNzVjNmJlZWZiMmZkM2QwNWI5NGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvoDKngFqTQzODc1NjQ4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "661d3223cfe3b1b6708b75c6beefb2fd3d05b94a", "author": {"user": {"login": "darecoder", "name": "Ekta Mishra"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/661d3223cfe3b1b6708b75c6beefb2fd3d05b94a", "committedDate": "2020-06-26T17:40:50Z", "message": "Add constraint class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NjgzMjE4", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#pullrequestreview-438683218", "createdAt": "2020-06-27T08:36:15Z", "commit": {"oid": "661d3223cfe3b1b6708b75c6beefb2fd3d05b94a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QwODozNjoxNVrOGp0Tow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QwODozNzowN1rOGp0T0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwMTc5NQ==", "bodyText": "These types should be more specific: ItemIdValue and Set<EntityIdValue>", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#discussion_r446501795", "createdAt": "2020-06-27T08:36:15Z", "author": {"login": "wetneb"}, "path": "extensions/wikidata/src/org/openrefine/wikidata/qa/Constraint.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package org.openrefine.wikidata.qa;\n+\n+import org.wikidata.wdtk.datamodel.interfaces.Snak;\n+import org.wikidata.wdtk.datamodel.interfaces.SnakGroup;\n+import org.wikidata.wdtk.datamodel.interfaces.Statement;\n+import org.wikidata.wdtk.datamodel.interfaces.Value;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class Constraint {\n+\n+    public static String CONSTRAINT_STATUS = \"P2316\";\n+    public static String CONSTRAINT_EXCEPTIONS = \"P2303\";\n+\n+    Value constraintStatus;\n+    Set<Value> constraintExceptions;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661d3223cfe3b1b6708b75c6beefb2fd3d05b94a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwMTgzNg==", "bodyText": "I do not think the Statement statement parameter is necessary here, I\u00a0would remove it", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#discussion_r446501836", "createdAt": "2020-06-27T08:37:00Z", "author": {"login": "wetneb"}, "path": "extensions/wikidata/src/org/openrefine/wikidata/qa/Constraint.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package org.openrefine.wikidata.qa;\n+\n+import org.wikidata.wdtk.datamodel.interfaces.Snak;\n+import org.wikidata.wdtk.datamodel.interfaces.SnakGroup;\n+import org.wikidata.wdtk.datamodel.interfaces.Statement;\n+import org.wikidata.wdtk.datamodel.interfaces.Value;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class Constraint {\n+\n+    public static String CONSTRAINT_STATUS = \"P2316\";\n+    public static String CONSTRAINT_EXCEPTIONS = \"P2303\";\n+\n+    Value constraintStatus;\n+    Set<Value> constraintExceptions;\n+\n+    Constraint(Statement statement) {\n+        List<SnakGroup> snakGroupList = statement.getClaim().getQualifiers();\n+        for(SnakGroup group : snakGroupList) {\n+            for (Snak snak : group.getSnaks()) {\n+                if (group.getProperty().getId().equals(CONSTRAINT_STATUS)) {\n+                    constraintStatus = snak.getValue();\n+                }\n+                else if (group.getProperty().getId().equals(CONSTRAINT_EXCEPTIONS)) {\n+                    constraintExceptions.add(snak.getValue());\n+                }\n+            }\n+        }\n+    }\n+\n+    public Value getConstraintStatus(Statement statement) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661d3223cfe3b1b6708b75c6beefb2fd3d05b94a"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwMTg0MQ==", "bodyText": "How about adding Javadocs to explain the role of this class?", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#discussion_r446501841", "createdAt": "2020-06-27T08:37:07Z", "author": {"login": "wetneb"}, "path": "extensions/wikidata/src/org/openrefine/wikidata/qa/Constraint.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package org.openrefine.wikidata.qa;\n+\n+import org.wikidata.wdtk.datamodel.interfaces.Snak;\n+import org.wikidata.wdtk.datamodel.interfaces.SnakGroup;\n+import org.wikidata.wdtk.datamodel.interfaces.Statement;\n+import org.wikidata.wdtk.datamodel.interfaces.Value;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class Constraint {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661d3223cfe3b1b6708b75c6beefb2fd3d05b94a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzA0NTY5", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#pullrequestreview-438704569", "createdAt": "2020-06-27T15:09:02Z", "commit": {"oid": "27bb36c332c05d4dddf39176cfc25845751f0119"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzA0NjQ4", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#pullrequestreview-438704648", "createdAt": "2020-06-27T15:10:22Z", "commit": {"oid": "27bb36c332c05d4dddf39176cfc25845751f0119"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "405a25aaef7d091ddad20b8682a6dfce613694f7", "author": {"user": {"login": "darecoder", "name": "Ekta Mishra"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/405a25aaef7d091ddad20b8682a6dfce613694f7", "committedDate": "2020-06-27T15:57:44Z", "message": "Add constraint class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzIxNTc5", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#pullrequestreview-438721579", "createdAt": "2020-06-27T20:05:54Z", "commit": {"oid": "405a25aaef7d091ddad20b8682a6dfce613694f7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QyMDowNTo1NFrOGp4Alg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QyMDowNTo1NFrOGp4Alg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU2MjQ1NA==", "bodyText": "In general, it would be good to use better variable names: as I reader, I already know this is a Snak - this is already written as type. It would be more useful to know how it is used. Is it a main snak? A qualifier? A reference snak?\nThe same applies to all the variable names you define here.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#discussion_r446562454", "createdAt": "2020-06-27T20:05:54Z", "author": {"login": "wetneb"}, "path": "extensions/wikidata/tests/src/org/openrefine/wikidata/qa/ConstraintTest.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package org.openrefine.wikidata.qa;\n+\n+import org.testng.Assert;\n+import org.testng.annotations.BeforeMethod;\n+import org.testng.annotations.Test;\n+import org.wikidata.wdtk.datamodel.helpers.Datamodel;\n+import org.wikidata.wdtk.datamodel.interfaces.Claim;\n+import org.wikidata.wdtk.datamodel.interfaces.EntityIdValue;\n+import org.wikidata.wdtk.datamodel.interfaces.ItemIdValue;\n+import org.wikidata.wdtk.datamodel.interfaces.PropertyIdValue;\n+import org.wikidata.wdtk.datamodel.interfaces.Reference;\n+import org.wikidata.wdtk.datamodel.interfaces.Snak;\n+import org.wikidata.wdtk.datamodel.interfaces.SnakGroup;\n+import org.wikidata.wdtk.datamodel.interfaces.Statement;\n+import org.wikidata.wdtk.datamodel.interfaces.StatementRank;\n+import org.wikidata.wdtk.datamodel.interfaces.Value;\n+\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+public class ConstraintTest {\n+\n+    public static ItemIdValue itemIdValue = Datamodel.makeWikidataItemIdValue(\"Q19474404\");\n+    public static PropertyIdValue constraintException = Datamodel.makeWikidataPropertyIdValue(\"P2303\");\n+    public static Value exceptionValue = Datamodel.makeWikidataItemIdValue(\"Q7409772\");\n+    public static PropertyIdValue constraintStatus = Datamodel.makeWikidataPropertyIdValue(\"P2316\");\n+    public static Value statusValue = Datamodel.makeWikidataItemIdValue(\"Q62026391\");\n+\n+    public static Constraint constraint;\n+    public static Statement statement;\n+\n+    @BeforeMethod\n+    public void setUp() {\n+        Snak snak1 = Datamodel.makeValueSnak(constraintException, exceptionValue);\n+        List<Snak> snakList1 = Collections.singletonList(snak1);\n+        Snak snak2 = Datamodel.makeValueSnak(constraintStatus, statusValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "405a25aaef7d091ddad20b8682a6dfce613694f7"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a9299f33665ac8002053356de004678eb609317", "author": {"user": {"login": "darecoder", "name": "Ekta Mishra"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/0a9299f33665ac8002053356de004678eb609317", "committedDate": "2020-06-28T04:52:05Z", "message": "updated names"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzU2NDg1", "url": "https://github.com/OpenRefine/OpenRefine/pull/2822#pullrequestreview-438756485", "createdAt": "2020-06-28T08:20:11Z", "commit": {"oid": "0a9299f33665ac8002053356de004678eb609317"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3121, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}