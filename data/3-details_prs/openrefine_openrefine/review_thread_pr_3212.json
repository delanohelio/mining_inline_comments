{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMzk4NDY0", "number": 3212, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxOTo1NDoxNlrOE0EyXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxOTo1NDoxNlrOE0EyXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzMDM5ODM3OnYy", "diffSide": "RIGHT", "path": "server/src/com/google/refine/Refine.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxOTo1NDoxNlrOHrpoeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQxOTo1NDoxNlrOHrpoeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUzMjkyMg==", "bodyText": "I wonder if it would make sense to write one or two simple tests to show which hosts are allowed.\nYou would probably need to move this class to its own file or making it a nested class of Refine.\n(I have to admit I wasn't aware of the fact that we had multiple top-level classes in Refine.java, it looks a bit confusing to me, and does not seem to be a widely recommended practice.)", "url": "https://github.com/OpenRefine/OpenRefine/pull/3212#discussion_r515532922", "createdAt": "2020-10-31T19:54:16Z", "author": {"login": "wetneb"}, "path": "server/src/com/google/refine/Refine.java", "diffHunk": "@@ -435,32 +447,92 @@ static private String fixWindowsUnicodePath(String path) {\n             return path;\n         }\n         int pathSep = path.indexOf(File.separatorChar, q);\n-        \n+\n         String goodPath = System.getenv(\"APPDATA\");\n         if (goodPath == null || goodPath.length() == 0) {\n             goodPath = System.getenv(\"USERPROFILE\");\n             if (!goodPath.endsWith(File.separator)) {\n                 goodPath = goodPath + File.separator;\n             }\n         }\n-        \n+\n         int goodPathSep = goodPath.indexOf(File.separatorChar, q);\n-        \n+\n         return path.substring(0, q) + goodPath.substring(q, goodPathSep) + path.substring(pathSep);\n     }\n-    \n+\n+}\n+\n+/**\n+ * Validate the Host header of the HTTP request to see if it matches either a loopback IP\n+ * address, localhost or an explicitly specified hostname. This is required to avoid DNS\n+ * rebinding attacks against users running OpenRefine on their desktop computers.\n+ */\n+class ValidateHostHandler extends HandlerWrapper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "046862e92e8981f87fd473bdbd47fddc4aa84466"}, "originalPosition": 395}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2890, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}