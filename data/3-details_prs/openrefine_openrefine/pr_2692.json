{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyODAyOTE2", "number": 2692, "title": "Use Apache HTTP Commons for Fetch URL", "bodyText": "Fixes #1410 by virtue of HTTP Commons having built-in support for redirects. It also supports retries, gzip decompression, and a bunch of other stuff out of the box.\n\n\nReplaced external network tests with mockwebserver based tests which should be faster and 100% reliable. Refactored to remove redundancy and make quicker. Fixes #2680. Fixes #1904.\n\n\nReplaces use of deprecated methods in ImportingUtilities which had already been converted to use Apache HTTP Commons for project creation.", "createdAt": "2020-06-11T02:36:49Z", "url": "https://github.com/OpenRefine/OpenRefine/pull/2692", "merged": true, "mergeCommit": {"oid": "749704518c330c6f96ec3e784c45b8c055d5c6cd"}, "closed": true, "closedAt": "2020-06-16T07:38:07Z", "author": {"login": "tfmorris"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrHegegFqTQzMDE5Njg4Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrwQO8AFqTQzMTIzNjY0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTk2ODg2", "url": "https://github.com/OpenRefine/OpenRefine/pull/2692#pullrequestreview-430196886", "createdAt": "2020-06-14T08:03:32Z", "commit": {"oid": "caa159bd5720174f0977b039ce55ea3471ed2bab"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwODowMzozM1rOGjbdSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwODowNTowMVrOGjbdtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwMzIxMQ==", "bodyText": "Shouldn't checks like header.name != \"\" use equals instead?", "url": "https://github.com/OpenRefine/OpenRefine/pull/2692#discussion_r439803211", "createdAt": "2020-06-14T08:03:33Z", "author": {"login": "wetneb"}, "path": "main/src/com/google/refine/operations/column/ColumnAdditionByFetchingURLsOperation.java", "diffHunk": "@@ -134,8 +151,34 @@ public ColumnAdditionByFetchingURLsOperation(\n         _delay = delay;\n         _cacheResponses = cacheResponses;\n         _httpHeadersJson = httpHeadersJson;\n+\n+        List<Header> headers = new ArrayList<Header>();\n+        if (_httpHeadersJson != null) {\n+            for (HttpHeader header : _httpHeadersJson) {\n+                if (header.name != null && header.name != \"\" && header.value != null && header.value != \"\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "caa159bd5720174f0977b039ce55ea3471ed2bab"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwMzMxOQ==", "bodyText": "Why is this code commented out?", "url": "https://github.com/OpenRefine/OpenRefine/pull/2692#discussion_r439803319", "createdAt": "2020-06-14T08:05:01Z", "author": {"login": "wetneb"}, "path": "main/src/com/google/refine/operations/column/ColumnAdditionByFetchingURLsOperation.java", "diffHunk": "@@ -134,8 +151,34 @@ public ColumnAdditionByFetchingURLsOperation(\n         _delay = delay;\n         _cacheResponses = cacheResponses;\n         _httpHeadersJson = httpHeadersJson;\n+\n+        List<Header> headers = new ArrayList<Header>();\n+        if (_httpHeadersJson != null) {\n+            for (HttpHeader header : _httpHeadersJson) {\n+                if (header.name != null && header.name != \"\" && header.value != null && header.value != \"\") {\n+                    headers.add(new BasicHeader(header.name, header.value));\n+                }\n+            }\n+        }\n+        httpHeaders = headers.toArray(httpHeaders);\n+\n+        defaultRequestConfig = RequestConfig.custom()\n+                .setConnectTimeout(30 * 1000)\n+                .setConnectionRequestTimeout(30 * 1000)\n+                .setSocketTimeout(10 * 1000).build();\n+\n+//        CredentialsProvider credsProvider = new BasicCredentialsProvider();\n+//        credsProvider.setCredentials(new AuthScope(host, 443),\n+//                new UsernamePasswordCredentials(user, password));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "caa159bd5720174f0977b039ce55ea3471ed2bab"}, "originalPosition": 72}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "caa159bd5720174f0977b039ce55ea3471ed2bab", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/caa159bd5720174f0977b039ce55ea3471ed2bab", "committedDate": "2020-06-12T01:20:53Z", "message": "Use mockwebserver instead of live network for tests\n\nFixes #2680. Fixes #1904."}, "afterCommit": {"oid": "45865fd9fcafb1207edd00fdd632f2a92e47f14c", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/45865fd9fcafb1207edd00fdd632f2a92e47f14c", "committedDate": "2020-06-16T00:37:12Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a420d722a554f2385511ce1a78eb34375ab6bb2", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/1a420d722a554f2385511ce1a78eb34375ab6bb2", "committedDate": "2020-06-16T00:42:11Z", "message": "Use mockwebserver instead of live network for tests\n\nFixes #2680. Fixes #1904."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62aca8bd6c0b7e251a879495bd6d581e4ea47141", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/62aca8bd6c0b7e251a879495bd6d581e4ea47141", "committedDate": "2020-06-16T00:42:11Z", "message": "Remove use of deprecated methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ed99a49bf69654defd9536507f8c79fa4e316b9", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/1ed99a49bf69654defd9536507f8c79fa4e316b9", "committedDate": "2020-06-16T00:42:11Z", "message": "Convert to use Apache HTTP Components client library\n\nFixes #1410 by virtue of redirect following being a built-in\ncapability of the library, along with retries with binary backoff,\nbuilt-in decompression, etc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "045d2d8702f72eb3a39e9fcbd5fc744d7a4ca77f", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/045d2d8702f72eb3a39e9fcbd5fc744d7a4ca77f", "committedDate": "2020-06-16T00:42:11Z", "message": "Address review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45865fd9fcafb1207edd00fdd632f2a92e47f14c", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/45865fd9fcafb1207edd00fdd632f2a92e47f14c", "committedDate": "2020-06-16T00:37:12Z", "message": "Address review comments"}, "afterCommit": {"oid": "045d2d8702f72eb3a39e9fcbd5fc744d7a4ca77f", "author": {"user": {"login": "tfmorris", "name": "Tom Morris"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/045d2d8702f72eb3a39e9fcbd5fc744d7a4ca77f", "committedDate": "2020-06-16T00:42:11Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMjM2NjQ4", "url": "https://github.com/OpenRefine/OpenRefine/pull/2692#pullrequestreview-431236648", "createdAt": "2020-06-16T07:38:00Z", "commit": {"oid": "045d2d8702f72eb3a39e9fcbd5fc744d7a4ca77f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3181, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}