{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0OTcwOTM4", "number": 3436, "title": "Added confirm dialog for starred expression remove links #501", "bodyText": "Fixes #501\nUsed the built in dialog system to create the small popup asking for confirmation.\nChose the 'Remove Expression?' and the 'OK' and 'Cancel' for the text as they were already in the translation files.", "createdAt": "2020-12-23T18:20:57Z", "url": "https://github.com/OpenRefine/OpenRefine/pull/3436", "merged": true, "mergeCommit": {"oid": "c6b6616f0157123ae6f6765ad671dc257a6148af"}, "closed": true, "closedAt": "2021-01-02T08:46:25Z", "author": {"login": "CameronBedard"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdozT9fAH2gAyNTQ0OTcwOTM4OmMzMWE2YTExZmVmY2RlNmRmMTJkM2JmN2U5NDQ4YzlhMGI3OWQzZmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdsGgbMgH2gAyNTQ0OTcwOTM4OmU3ODNmMWNiNzFmYjhmYTdmYzIxOTExNzVhYWUyYmNmMmUwMWY1MjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c31a6a11fefcde6df12d3bf7e9448c9a0b79d3fe", "author": {"user": {"login": "CameronBedard", "name": "Cameron Bedard"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/c31a6a11fefcde6df12d3bf7e9448c9a0b79d3fe", "committedDate": "2020-12-22T23:41:10Z", "message": "Updated 'remove' link for starred expressions to include a confirm dialog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3d31fdc467ac78aebf52833b3afbd2fc261d802", "author": {"user": {"login": "CameronBedard", "name": "Cameron Bedard"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/e3d31fdc467ac78aebf52833b3afbd2fc261d802", "committedDate": "2020-12-23T18:14:22Z", "message": "bring remove expression dialog dismissal inline with other dialog dismissal"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODI4MTA1", "url": "https://github.com/OpenRefine/OpenRefine/pull/3436#pullrequestreview-558828105", "createdAt": "2020-12-25T16:43:34Z", "commit": {"oid": "e3d31fdc467ac78aebf52833b3afbd2fc261d802"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQxNjo0MzozNFrOILdrpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQxNjo0MzozNFrOILdrpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODg5MTU1Ng==", "bodyText": "Thanks for your attempt to reuse existing translations! However, we cannot do something like $.i18n('core-dialogs/remove') + \" \" + $.i18n('core-dialogs/expression') + \"?\" because that assumes that word order and punctuation remain identical in all languages. For instance in German you want to have the noun before the verb in this context. Or in French you want to have a space before the ? and also an article before \"expression\". So you should introduce a new bit of UI text in this context. You can add it to the English file only, and translators will take care of adding it to other languages.", "url": "https://github.com/OpenRefine/OpenRefine/pull/3436#discussion_r548891556", "createdAt": "2020-12-25T16:43:34Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/scripts/dialogs/expression-preview-dialog.js", "diffHunk": "@@ -350,15 +350,30 @@ ExpressionPreviewDialog.Widget.prototype._renderStarredExpressions = function(da\n         var o = Scripting.parse(entry.code);\n         \n         $('<a href=\"javascript:{}\">'+$.i18n('core-dialogs/remove')+'</a>').appendTo(tr.insertCell(0)).click(function() {\n-            Refine.postCSRF(\n-                \"command/core/toggle-starred-expression\",\n-                { expression: entry.code, returnList: true },\n-                function(data) {\n-                    self._renderStarredExpressions(data);\n-                    self._renderExpressionHistoryTab();\n-                },\n-                \"json\"\n-            );\n+            var removeExpression = DialogSystem.createDialog();\n+                removeExpression.width(\"250px\");\n+            var removeExpressionHead = $('<div></div>').addClass(\"dialog-header\").text($.i18n('core-dialogs/remove') + \" \" + $.i18n('core-dialogs/expression') + \"?\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d31fdc467ac78aebf52833b3afbd2fc261d802"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6221ab4a1b6802838e81e901bc6583dbeb293378", "author": {"user": {"login": "CameronBedard", "name": "Cameron Bedard"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/6221ab4a1b6802838e81e901bc6583dbeb293378", "committedDate": "2020-12-25T18:24:45Z", "message": "Changed 'unstar expression?' in translation-en.json to allow better translation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNTkzNjM0", "url": "https://github.com/OpenRefine/OpenRefine/pull/3436#pullrequestreview-560593634", "createdAt": "2021-01-01T16:12:20Z", "commit": {"oid": "6221ab4a1b6802838e81e901bc6583dbeb293378"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMVQxNjoxMjoyMVrOINRENg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMVQxNjoxMjoyMVrOINRENg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc4MjAwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \"core-dialogs/unstar-expression\": \"Unstar Expression?\",\n          \n          \n            \n                \"core-dialogs/unstar-expression\": \"Unstar expression?\",\n          \n      \n    \n    \n  \n\nWe are in the process of normalizing the case of all text in the UI (#3363), so let's get this one right from the start.", "url": "https://github.com/OpenRefine/OpenRefine/pull/3436#discussion_r550782006", "createdAt": "2021-01-01T16:12:21Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -244,6 +244,7 @@\n     \"core-dialogs/sql-exporter\": \"SQL Exporter\",\n     \"core-dialogs/custom-tab-exp\": \"Custom Tabular Exporter\",\n     \"core-dialogs/select-columns-dialog\": \"Select columns\",\n+    \"core-dialogs/unstar-expression\": \"Unstar Expression?\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6221ab4a1b6802838e81e901bc6583dbeb293378"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e783f1cb71fb8fa7fc2191175aae2bcf2e01f522", "author": {"user": {"login": "CameronBedard", "name": "Cameron Bedard"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/e783f1cb71fb8fa7fc2191175aae2bcf2e01f522", "committedDate": "2021-01-02T05:44:45Z", "message": "Update main/webapp/modules/core/langs/translation-en.json\n\nCo-authored-by: Antonin Delpeuch <antonin@delpeuch.eu>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3397, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}