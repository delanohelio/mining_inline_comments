{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5MDYxNzA2", "number": 2596, "title": "correct excel mime types", "bodyText": "#2595", "createdAt": "2020-04-26T10:51:47Z", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596", "merged": true, "mergeCommit": {"oid": "1a0e1875613bc7449bce7f13a0ae15c4b62c28f7"}, "closed": true, "closedAt": "2020-04-26T12:36:38Z", "author": {"login": "pjfanning"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbYb_eAH2gAyNDA5MDYxNzA2Ojg0YjliODk0ZTcyM2E1YTM0NTAwMDA4NThhYzY4MGQ5Yzk5ZDVlOWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbZ4dcAFqTQwMDQ5OTAwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "84b9b894e723a5a3450000858ac680d9c99d5e9d", "author": {"user": {"login": "pjfanning", "name": "PJ Fanning"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/84b9b894e723a5a3450000858ac680d9c99d5e9d", "committedDate": "2020-04-26T10:50:20Z", "message": "correct excel mime types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDk1NzY1", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#pullrequestreview-400495765", "createdAt": "2020-04-26T11:58:38Z", "commit": {"oid": "84b9b894e723a5a3450000858ac680d9c99d5e9d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxMTo1ODozOFrOGMDe9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxMTo1ODo0MlrOGMDfBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5MzE3NQ==", "bodyText": "This should be removed - we should only need to add a mapping from the MIME type to the internal format identifier, with IM.registerMimeType (see below).", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415293175", "createdAt": "2020-04-26T11:58:38Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -223,6 +223,8 @@ function registerImporting() {\n \n   IM.registerFormat(\"text/xml\", \"XML files\", \"XmlParserUI\", new Packages.com.google.refine.importers.XmlImporter());\n   IM.registerFormat(\"binary/text/xml/xls/xlsx\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());\n+  IM.registerFormat(\"application/vnd.ms-excel\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());\n+  IM.registerFormat(\"application/vnd.openxmlformats-officedocument.spreadsheetml.*\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84b9b894e723a5a3450000858ac680d9c99d5e9d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5MzE4OA==", "bodyText": "This should be kept: here, \"binary/text/xml/xls/xlsx\" serves as an internal identifier for the format, and does not need to be an official MIME type. The correct place to add the mapping is further down, with IM.registerMimeType.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415293188", "createdAt": "2020-04-26T11:58:42Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -245,8 +247,8 @@ function registerImporting() {\n   IM.registerExtension(\".json\", \"text/json\");\n   IM.registerExtension(\".js\", \"text/json\");\n \n-  IM.registerExtension(\".xls\", \"binary/text/xml/xls/xlsx\");\n-  IM.registerExtension(\".xlsx\", \"binary/text/xml/xls/xlsx\");\n+  IM.registerExtension(\".xls\", \"application/vnd.ms-excel\");\n+  IM.registerExtension(\".xlsx\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84b9b894e723a5a3450000858ac680d9c99d5e9d"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3aa130eb7ffb2969c2deced45d5a5fcc792df885", "author": {"user": {"login": "pjfanning", "name": "PJ Fanning"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/3aa130eb7ffb2969c2deced45d5a5fcc792df885", "committedDate": "2020-04-26T12:12:00Z", "message": "address PR issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDk3MjUw", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#pullrequestreview-400497250", "createdAt": "2020-04-26T12:13:55Z", "commit": {"oid": "3aa130eb7ffb2969c2deced45d5a5fcc792df885"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxMjoxMzo1NVrOGMDqUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxMjoxMzo1NVrOGMDqUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5NjA4Mg==", "bodyText": "I'm not sure if wildcards work here\napplication/vnd.ms-excel already has an entry", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415296082", "createdAt": "2020-04-26T12:13:55Z", "author": {"login": "pjfanning"}, "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -291,7 +291,8 @@ function registerImporting() {\n   IM.registerMimeType(\"application/x-excel\", \"binary/text/xml/xls/xlsx\");\n   IM.registerMimeType(\"application/xls\", \"binary/text/xml/xls/xlsx\");\n   IM.registerMimeType(\"application/x-xls\", \"binary/text/xml/xls/xlsx\");\n-  \n+  IM.registerMimeType(\"application/vnd.openxmlformats-officedocument.spreadsheetml.*\", \"binary/text/xml/xls/xlsx\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3aa130eb7ffb2969c2deced45d5a5fcc792df885"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f714ca289aba660539c0a2250563fda7400bd45", "author": {"user": {"login": "pjfanning", "name": "PJ Fanning"}}, "url": "https://github.com/OpenRefine/OpenRefine/commit/6f714ca289aba660539c0a2250563fda7400bd45", "committedDate": "2020-04-26T12:27:24Z", "message": "remove use of wildcard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDk5MDA4", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#pullrequestreview-400499008", "createdAt": "2020-04-26T12:31:20Z", "commit": {"oid": "6f714ca289aba660539c0a2250563fda7400bd45"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3243, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}