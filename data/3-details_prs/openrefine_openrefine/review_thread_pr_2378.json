{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1NDA5NDI1", "number": 2378, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNDoxNToyNVrODmsoJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNTowMjoxNFrODmuDbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxOTAzNjU0OnYy", "diffSide": "RIGHT", "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNDoxNToyNVrOF0QtgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNDo1MjoyMlrOF0Sfag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM0NDA2NQ==", "bodyText": "Localizing text in this way makes it impossible for translators to reorder the column name to a different position in the message. I am really not blaming you since there are loads of places where we do that in the UI at the moment - I'll open an issue to clean these up.\nBecause we are introducing a new message here, let's try to get this right. We use the Wikimedia jQuery i18n plugin, which lets you define templates like this:\nhttps://github.com/wikimedia/jquery.i18n#jqueryi18n-plugin\nSo you should be able to pass column.name as an extra argument to the function and insert it with $1 in the message text.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390344065", "createdAt": "2020-03-10T14:15:25Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "diffHunk": "@@ -188,6 +189,49 @@ DataTableColumnHeaderUI.extendMenu(function(column, columnHeaderUI, menu) {\n     var level = DialogSystem.showDialog(frame);\n   };\n \n+  var doAddIdcolumn = function() {\n+    var frame = $(\n+      DOM.loadHTML(\"core\", \"scripts/views/data-table/add-q-column-dialog.html\"));\n+\n+    var elmts = DOM.bind(frame);\n+    elmts.dialogHeader.text($.i18n('core-views/add-id-col')+\" \" + column.name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014bba9cd7e5e7ef079fa00cf071687b3e3a375a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM2OTU1MQ==", "bodyText": "Got it!", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390369551", "createdAt": "2020-03-10T14:47:54Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "diffHunk": "@@ -188,6 +189,49 @@ DataTableColumnHeaderUI.extendMenu(function(column, columnHeaderUI, menu) {\n     var level = DialogSystem.showDialog(frame);\n   };\n \n+  var doAddIdcolumn = function() {\n+    var frame = $(\n+      DOM.loadHTML(\"core\", \"scripts/views/data-table/add-q-column-dialog.html\"));\n+\n+    var elmts = DOM.bind(frame);\n+    elmts.dialogHeader.text($.i18n('core-views/add-id-col')+\" \" + column.name);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM0NDA2NQ=="}, "originalCommit": {"oid": "014bba9cd7e5e7ef079fa00cf071687b3e3a375a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM3MzIyNg==", "bodyText": "Not sure if I was supposed to click Resolve on my own xD Sent a final pull request!", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390373226", "createdAt": "2020-03-10T14:52:22Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "diffHunk": "@@ -188,6 +189,49 @@ DataTableColumnHeaderUI.extendMenu(function(column, columnHeaderUI, menu) {\n     var level = DialogSystem.showDialog(frame);\n   };\n \n+  var doAddIdcolumn = function() {\n+    var frame = $(\n+      DOM.loadHTML(\"core\", \"scripts/views/data-table/add-q-column-dialog.html\"));\n+\n+    var elmts = DOM.bind(frame);\n+    elmts.dialogHeader.text($.i18n('core-views/add-id-col')+\" \" + column.name);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM0NDA2NQ=="}, "originalCommit": {"oid": "014bba9cd7e5e7ef079fa00cf071687b3e3a375a"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxOTAzNjk0OnYy", "diffSide": "RIGHT", "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNDoxNToyOVrOF0Qtvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNDo0ODoxOVrOF0SSeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM0NDEyNg==", "bodyText": "I think onError is meant to determine what to store when evaluating the expression gives an error, so I don't think you can have an expression here? According to the \"Add column\" dialog it can be one of set-to-blank, store-error or keep-original (which probably only makes sense when editing an existing column). I would intuitively go for set-to-blank here.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390344126", "createdAt": "2020-03-10T14:15:29Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "diffHunk": "@@ -188,6 +189,49 @@ DataTableColumnHeaderUI.extendMenu(function(column, columnHeaderUI, menu) {\n     var level = DialogSystem.showDialog(frame);\n   };\n \n+  var doAddIdcolumn = function() {\n+    var frame = $(\n+      DOM.loadHTML(\"core\", \"scripts/views/data-table/add-q-column-dialog.html\"));\n+\n+    var elmts = DOM.bind(frame);\n+    elmts.dialogHeader.text($.i18n('core-views/add-id-col')+\" \" + column.name);\n+    \n+    elmts.or_views_newCol.text($.i18n('core-views/new-col-name'));\n+    elmts.okButton.html($.i18n('core-buttons/ok'));\n+    elmts.cancelButton.text($.i18n('core-buttons/cancel'));\n+\n+    var level = DialogSystem.showDialog(frame);\n+    var dismiss = function() { DialogSystem.dismissUntil(level - 1); };\n+\n+    var o = DataTableView.sampleVisibleRows(column);\n+    \n+    elmts.cancelButton.click(dismiss);\n+    elmts.okButton.click(function() {\n+      var columnName = $.trim(elmts.columnNameInput[0].value);\n+      if (!columnName.length) {\n+        alert($.i18n('core-views/warning-col-name'));\n+        return;\n+      }\n+\n+      Refine.postCoreProcess(\n+        \"add-column\", \n+        {\n+          baseColumnName: column.name,  \n+          newColumnName: columnName, \n+          columnInsertIndex: columnIndex + 1,\n+          onError: \"cell.recon.match.id\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014bba9cd7e5e7ef079fa00cf071687b3e3a375a"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM2OTkxMw==", "bodyText": "Oh sorry my bad. Fixed!", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390369913", "createdAt": "2020-03-10T14:48:19Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/scripts/views/data-table/menu-reconcile.js", "diffHunk": "@@ -188,6 +189,49 @@ DataTableColumnHeaderUI.extendMenu(function(column, columnHeaderUI, menu) {\n     var level = DialogSystem.showDialog(frame);\n   };\n \n+  var doAddIdcolumn = function() {\n+    var frame = $(\n+      DOM.loadHTML(\"core\", \"scripts/views/data-table/add-q-column-dialog.html\"));\n+\n+    var elmts = DOM.bind(frame);\n+    elmts.dialogHeader.text($.i18n('core-views/add-id-col')+\" \" + column.name);\n+    \n+    elmts.or_views_newCol.text($.i18n('core-views/new-col-name'));\n+    elmts.okButton.html($.i18n('core-buttons/ok'));\n+    elmts.cancelButton.text($.i18n('core-buttons/cancel'));\n+\n+    var level = DialogSystem.showDialog(frame);\n+    var dismiss = function() { DialogSystem.dismissUntil(level - 1); };\n+\n+    var o = DataTableView.sampleVisibleRows(column);\n+    \n+    elmts.cancelButton.click(dismiss);\n+    elmts.okButton.click(function() {\n+      var columnName = $.trim(elmts.columnNameInput[0].value);\n+      if (!columnName.length) {\n+        alert($.i18n('core-views/warning-col-name'));\n+        return;\n+      }\n+\n+      Refine.postCoreProcess(\n+        \"add-column\", \n+        {\n+          baseColumnName: column.name,  \n+          newColumnName: columnName, \n+          columnInsertIndex: columnIndex + 1,\n+          onError: \"cell.recon.match.id\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM0NDEyNg=="}, "originalCommit": {"oid": "014bba9cd7e5e7ef079fa00cf071687b3e3a375a"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxOTI3MDIxOnYy", "diffSide": "RIGHT", "path": "main/webapp/modules/core/langs/translation-en.json", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNTowMjoxNFrOF0S-Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNToxMToyOFrOF0TaKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MTA5NQ==", "bodyText": "Why use {{plural}} here? Isn't plural intended to be used for numbers? $1 represents a string, not a number here.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390381095", "createdAt": "2020-03-10T15:02:14Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -518,7 +518,7 @@\n     \"core-views/word-facet\": \"Word facet\",\n     \"core-views/add-id-column\": \"Add entity identifiers column\",\n     \"core-views/add-id-column2\": \"Add a column containing entity identifiers from items\",\n-    \"core-views/add-id-col\": \"Add column containing entity identifiers on column\",\n+    \"core-views/add-id-col\": \"Add column containing entity identifiers on $1 {{plural:$1|column}}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6484f085b4e60b384f4ddcd825565e40ffb88f60"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4NDM2MQ==", "bodyText": "I see. I thought that was a i18n parameter, my bad. Should I remove it all and keep just $1?", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390384361", "createdAt": "2020-03-10T15:06:33Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -518,7 +518,7 @@\n     \"core-views/word-facet\": \"Word facet\",\n     \"core-views/add-id-column\": \"Add entity identifiers column\",\n     \"core-views/add-id-column2\": \"Add a column containing entity identifiers from items\",\n-    \"core-views/add-id-col\": \"Add column containing entity identifiers on column\",\n+    \"core-views/add-id-col\": \"Add column containing entity identifiers on $1 {{plural:$1|column}}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MTA5NQ=="}, "originalCommit": {"oid": "6484f085b4e60b384f4ddcd825565e40ffb88f60"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4NjE0Ng==", "bodyText": "Add column containing entity identifiers on column $1 should do: $1 will just be replaced by the column name.", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390386146", "createdAt": "2020-03-10T15:08:44Z", "author": {"login": "wetneb"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -518,7 +518,7 @@\n     \"core-views/word-facet\": \"Word facet\",\n     \"core-views/add-id-column\": \"Add entity identifiers column\",\n     \"core-views/add-id-column2\": \"Add a column containing entity identifiers from items\",\n-    \"core-views/add-id-col\": \"Add column containing entity identifiers on column\",\n+    \"core-views/add-id-col\": \"Add column containing entity identifiers on $1 {{plural:$1|column}}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MTA5NQ=="}, "originalCommit": {"oid": "6484f085b4e60b384f4ddcd825565e40ffb88f60"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4NzQ2NA==", "bodyText": "Yep that's what I meant \ud83d\udc4d", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390387464", "createdAt": "2020-03-10T15:10:27Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -518,7 +518,7 @@\n     \"core-views/word-facet\": \"Word facet\",\n     \"core-views/add-id-column\": \"Add entity identifiers column\",\n     \"core-views/add-id-column2\": \"Add a column containing entity identifiers from items\",\n-    \"core-views/add-id-col\": \"Add column containing entity identifiers on column\",\n+    \"core-views/add-id-col\": \"Add column containing entity identifiers on $1 {{plural:$1|column}}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MTA5NQ=="}, "originalCommit": {"oid": "6484f085b4e60b384f4ddcd825565e40ffb88f60"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4ODI2NA==", "bodyText": "Fixed :)", "url": "https://github.com/OpenRefine/OpenRefine/pull/2378#discussion_r390388264", "createdAt": "2020-03-10T15:11:28Z", "author": {"login": "madham32"}, "path": "main/webapp/modules/core/langs/translation-en.json", "diffHunk": "@@ -518,7 +518,7 @@\n     \"core-views/word-facet\": \"Word facet\",\n     \"core-views/add-id-column\": \"Add entity identifiers column\",\n     \"core-views/add-id-column2\": \"Add a column containing entity identifiers from items\",\n-    \"core-views/add-id-col\": \"Add column containing entity identifiers on column\",\n+    \"core-views/add-id-col\": \"Add column containing entity identifiers on $1 {{plural:$1|column}}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MTA5NQ=="}, "originalCommit": {"oid": "6484f085b4e60b384f4ddcd825565e40ffb88f60"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2780, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}