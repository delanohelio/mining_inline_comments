{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjI5MDgy", "number": 503, "title": "Export (Vector) Tiles - UI and readability improvements", "bodyText": "With these two samples, at the moment you can start an export simultaneously as many times as you want since the button doesn't disable. What this PR does is disable the button so that only one job can run at the same time.\nI've also added some whitespace and extra comments to make the code a bit more readable.", "createdAt": "2020-04-28T16:30:40Z", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/503", "merged": true, "mergeCommit": {"oid": "e97cca23a34d291df9cad483f8a29c6fb663b3b5"}, "closed": true, "closedAt": "2020-05-18T08:37:28Z", "author": {"login": "JonLavi"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccGemegH2gAyNDEwMjI5MDgyOjYwMWJiNTUxMTlmN2FmMmVkMmIzYmQ1MGIyN2Y0Y2MxMTU1MmQzODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcibt18gH2gAyNDEwMjI5MDgyOjk4NmJhZDQ2NzFkZGQ3ZTgyMGI4NTg1MmFiZGU5M2Y2N2NjYzMzODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "601bb55119f7af2ed2b3bd50b27f4cc11552d380", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/601bb55119f7af2ed2b3bd50b27f4cc11552d380", "committedDate": "2020-04-28T16:28:49Z", "message": "disable button while job running, add whitespace and comments, move UI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ac75749d4528f20fdaf1f99e07c20f25d3ef6d", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/c4ac75749d4528f20fdaf1f99e07c20f25d3ef6d", "committedDate": "2020-04-28T16:38:44Z", "message": "Update ExportTilesSample.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5af9c0c7f4e0c9fd63726ab86fa32b4758947dc5", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/5af9c0c7f4e0c9fd63726ab86fa32b4758947dc5", "committedDate": "2020-04-28T16:39:42Z", "message": "Update ExportTilesSample.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a68b12ea22e6419ba24556b544ac61e8a34e5cc", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/0a68b12ea22e6419ba24556b544ac61e8a34e5cc", "committedDate": "2020-04-28T16:45:48Z", "message": "whitespacea, comments, UI improvements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4471659ee7947246f5d6f360bfb34b6498b71c6c", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/4471659ee7947246f5d6f360bfb34b6498b71c6c", "committedDate": "2020-04-28T16:46:35Z", "message": "Merge branch 'export_vector_tiles_update' into export_tiles_dont_allow_concurrent_jobs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6915d8b1ced7d47763ad9f17d09a18195b8e45a", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/e6915d8b1ced7d47763ad9f17d09a18195b8e45a", "committedDate": "2020-04-28T16:47:10Z", "message": "comment formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3398c8a751200379119bf6526a4c6d0376c35b61", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/3398c8a751200379119bf6526a4c6d0376c35b61", "committedDate": "2020-04-28T16:48:54Z", "message": "Merge branch 'export_tiles_dont_allow_concurrent_jobs' of github.com:Esri/arcgis-runtime-samples-java into export_tiles_dont_allow_concurrent_jobs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MTczMjUz", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/503#pullrequestreview-404173253", "createdAt": "2020-05-01T13:59:32Z", "commit": {"oid": "3398c8a751200379119bf6526a4c6d0376c35b61"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f89652ece8df4dfd143051ce438596c2899fea4", "author": {"user": {"login": "tschie", "name": "Tyler Schiewe"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/5f89652ece8df4dfd143051ce438596c2899fea4", "committedDate": "2020-05-18T05:27:33Z", "message": "Merge branch 'master' into export_tiles_dont_allow_concurrent_jobs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMjgwMTYx", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/503#pullrequestreview-413280161", "createdAt": "2020-05-18T05:28:56Z", "commit": {"oid": "5f89652ece8df4dfd143051ce438596c2899fea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwNToyODo1NlrOGWn-eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwNToyODo1NlrOGWn-eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM3NjgyNQ==", "bodyText": "looks like an extra indent here", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/503#discussion_r426376825", "createdAt": "2020-05-18T05:28:56Z", "author": {"login": "tschie"}, "path": "tiled_layers/export-tiles/src/main/java/com/esri/samples/export_tiles/ExportTilesSample.java", "diffHunk": "@@ -114,62 +115,87 @@ public void start(Stage stage) {\n \n       // when the button is clicked, export the tiles to a temporary file\n       exportTilesButton.setOnAction(e -> {\n-        try {\n-          File tempFile = File.createTempFile(\"tiles\", \".tpk\");\n-          progressBar.setVisible(true);\n-          double minScale = mapView.getMapScale();\n-          double maxScale = tiledLayer.getMaxScale();\n-          // minScale must always be larger than maxScale\n-          if (minScale <= maxScale) {\n-            minScale = maxScale + 1;\n-          }\n-          ExportTileCacheTask task = new ExportTileCacheTask(tiledLayer.getUri());\n-          ListenableFuture<ExportTileCacheParameters> createParams = task.createDefaultExportTileCacheParametersAsync\n-              (downloadArea.getGeometry(), minScale, maxScale);\n-          createParams.addDoneListener(() -> {\n-            try {\n-              ExportTileCacheParameters params = createParams.get();\n-              ExportTileCacheJob job = task.exportTileCache(params, tempFile.getAbsolutePath());\n-              job.start();\n-              job.addProgressChangedListener(() -> progressBar.setProgress(job.getProgress() / 100.0));\n-              job.addJobDoneListener(() -> {\n-                if (job.getStatus() == Job.Status.SUCCEEDED) {\n-                  //show preview of exported tiles in alert\n-                  TileCache tileCache = job.getResult();\n-                  Alert preview = new Alert(Alert.AlertType.INFORMATION);\n-                  preview.initOwner(mapView.getScene().getWindow());\n-                  preview.setTitle(\"Preview\");\n-                  preview.setHeaderText(\"Exported to \" + tileCache.getPath());\n-                  MapView mapPreview = new MapView();\n-                  mapPreview.setMinSize(400, 400);\n-                  ArcGISTiledLayer tiledLayerPreview = new ArcGISTiledLayer(tileCache);\n-                  ArcGISMap previewMap = new ArcGISMap(new Basemap(tiledLayerPreview));\n-                  mapPreview.setMap(previewMap);\n-                  preview.getDialogPane().setContent(mapPreview);\n-                  preview.show();\n-                } else {\n-                  Alert alert = new Alert(Alert.AlertType.ERROR, job.getError().getAdditionalMessage());\n-                  alert.show();\n-                }\n-                Platform.runLater(() -> progressBar.setVisible(false));\n-              });\n-            } catch (InterruptedException | ExecutionException ex) {\n-              Alert alert = new Alert(Alert.AlertType.ERROR, ex.getMessage());\n-              alert.show();\n-              progressBar.setVisible(false);\n-              progressBar.setProgress(0);\n+          try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f89652ece8df4dfd143051ce438596c2899fea4"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMjgwNDMx", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/503#pullrequestreview-413280431", "createdAt": "2020-05-18T05:29:55Z", "commit": {"oid": "5f89652ece8df4dfd143051ce438596c2899fea4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "986bad4671ddd7e820b85852abde93f67ccc3380", "author": {"user": {"login": "JonLavi", "name": "Jonathan Lavi"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/986bad4671ddd7e820b85852abde93f67ccc3380", "committedDate": "2020-05-18T08:37:01Z", "message": "indentation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3373, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}