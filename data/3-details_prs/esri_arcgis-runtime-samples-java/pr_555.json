{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3ODU2MzQ2", "number": 555, "title": "List related features sample: use correct identify workflow", "bodyText": "Description\nOriginal request (CS 2032): Several samples use an identify workflow that is not best practice. We should be using mapView.identifyLayersAsync(...) when identifying across multiple layers or mapView.identifyLayerAsync(...) when we know which layer we need to run the identify on.\nFor Java the sample needing to be update is List Related Features. I've made what I think is the correct change, but @TADraeseke  if you could check this over first as per your original issue requirements, I can then get it reviewed for merging.\nThanks!\n\nChecklist:\n\n Set target branch to master (current release) or dev (next release)\n Request a reviewer\n Assign a reviewer\n Tag reviewer in comment", "createdAt": "2020-09-16T09:29:56Z", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/555", "merged": true, "mergeCommit": {"oid": "1d540ff7003ab1935a8fc637ebef8a13a4fcc697"}, "closed": true, "closedAt": "2020-09-28T08:24:26Z", "author": {"login": "jenmerritt"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJY6T7AH2gAyNDg3ODU2MzQ2OmZjODg2YjQzZjRhZDM1ZGE0MGMzMTk0MzgzYzVlZTIwMmZiZmE3MWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMXuTTgFqTQ5NjUzNzg4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc886b43f4ad35da40c3194383c5ee202fbfa71b", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/fc886b43f4ad35da40c3194383c5ee202fbfa71b", "committedDate": "2020-09-16T09:23:58Z", "message": "update method for identify workflow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNTg2NDU2", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/555#pullrequestreview-492586456", "createdAt": "2020-09-21T13:13:51Z", "commit": {"oid": "fc886b43f4ad35da40c3194383c5ee202fbfa71b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NjEzNzUy", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/555#pullrequestreview-495613752", "createdAt": "2020-09-24T14:09:07Z", "commit": {"oid": "fc886b43f4ad35da40c3194383c5ee202fbfa71b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDowOTowOFrOHXcxVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDowOTowOFrOHXcxVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM1MDY3OA==", "bodyText": "For the sake of being extra clear which class we are dealing with here, we should write:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            for (var geoElement : identifiedLayerGeoElements) {\n          \n          \n            \n                            for (GeoElement geoElement : identifiedLayerGeoElements) {\n          \n      \n    \n    \n  \n\nThere's no harm in using var generally, but for samples we want to make sure our users know exactly which class they are dealing with at any point.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/555#discussion_r494350678", "createdAt": "2020-09-24T14:09:08Z", "author": {"login": "JonLavi"}, "path": "feature_layers/list-related-features/src/main/java/com/esri/samples/list_related_features/ListRelatedFeaturesSample.java", "diffHunk": "@@ -102,44 +99,43 @@ public void start(Stage stage) {\n           // check for primary or secondary mouse click\n           if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n \n+            // clear previous selections\n+            featureLayer.clearSelection();\n+\n             // create a point from where the user clicked\n             Point2D point = new Point2D(event.getX(), event.getY());\n \n-            // convert to map coordinate\n-            Point mapPoint = mapView.screenToLocation(point);\n-\n             // identify the clicked features\n-            QueryParameters queryParameters = new QueryParameters();\n-            queryParameters.setGeometry(GeometryEngine.buffer(mapPoint, 10));\n-            final ListenableFuture<FeatureQueryResult> selectFeatureQuery = featureLayer.selectFeaturesAsync\n-                (queryParameters, FeatureLayer.SelectionMode.NEW);\n-            selectFeatureQuery.addDoneListener(() -> {\n+            ListenableFuture<IdentifyLayerResult> identifyLayerResult =\n+              mapView.identifyLayerAsync(featureLayer, point, 10, false, 1);\n+            identifyLayerResult.addDoneListener(() -> {\n \n               try {\n-                FeatureQueryResult result = selectFeatureQuery.get();\n+                IdentifyLayerResult identifiedLayer = identifyLayerResult.get();\n+                List<GeoElement> identifiedLayerGeoElements = identifiedLayer.getElements();\n                 // get the first selected feature\n-                Iterator<Feature> iterator = result.iterator();\n-                if (iterator.hasNext()) {\n-                  ArcGISFeature selectedFeature = (ArcGISFeature) iterator.next();\n+                for (var geoElement : identifiedLayerGeoElements) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc886b43f4ad35da40c3194383c5ee202fbfa71b"}, "originalPosition": 56}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "326c20bb5d9b59856501e62411df9a759a1a58b6", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/326c20bb5d9b59856501e62411df9a759a1a58b6", "committedDate": "2020-09-25T15:18:05Z", "message": "update for loop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2NTM3ODgz", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/555#pullrequestreview-496537883", "createdAt": "2020-09-25T15:42:43Z", "commit": {"oid": "326c20bb5d9b59856501e62411df9a759a1a58b6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3492, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}